---
title: "Using Google Apps Script Web App Forms to Integrate with Github Action CI/CD Work"
author: "ZhgChgLi"
date: 2025-01-11T11:19:43.066+0000
last_modified_at: 2025-01-11T16:32:30.680+0000
categories: ["ZRealm Dev."]
tags: ["ios-app-development","google-apps-script","github-actions","slack","github"]
description: "Optimization of Github Action Workflow forms and integration with other workflow tools (Jira, Asana, Slack...) to enhance development efficiency."
image:
  path: /assets/4cb4437818f2/1*TiGXBQdPaCM6r2J1RHrgnA.png
render_with_liquid: false
---

### Using Google Apps Script Web App Forms to Integrate with Github Action CI/CD Work

Optimization of Github Action Workflow forms and integration with other workflow tools (Jira, Asana, Slack...) to enhance development efficiency.



![Left: Original Github Action Workflow Form / Right: [Final Result (GAS Web App Form)](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}](/assets/4cb4437818f2/1*TiGXBQdPaCM6r2J1RHrgnA.png)

Left: Original Github Action Workflow Form / Right: [Final Result (GAS Web App Form)](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}
### Background

The previous team used Github Action & Self-hosted Github Runner + Slack to set up a complete CI/CD service; the overall effect was good, and for app developers, building and maintaining it was relatively easy. They only needed to follow the YAML parameters provided in the official documentation to complete the setup, which would trigger automatically. On the machine side, it was also easy to use their own machines as runners. The service itself is maintained by Github, so we didn't need to worry about version upgrades and other issues, and the runner pulls tasks from Github, so there was no need to open special external network ports. The best part for the team was that running Github Action on their own runner was completely free.


> _This means enjoying a GUI YAML building method similar to Bitrise while having the flexibility and lower build costs of using self-hosted machines like Jenkins, but without the need to spend time maintaining the service itself like Jenkins does._ 





> **In the future, I will write a complete article on the process of setting up App CI/CD with Github Action when I have time.** 



#### Problem: Github Action CI/CD GUI Form


![Github Action GUI Form](/assets/4cb4437818f2/1*55tCLFvuHtTyyvSLSv1vMA.png)

Github Action GUI Form


> _In app development, when triggering the CD for packaging test versions, official versions, or submissions, it is usually necessary to provide some external parameters or select environments and branches according to requirements before the workflow can begin._ 





Unlike Jenkins, which is a self-hosted service with a complete Web GUI, Github Action does not have one. The only Web GUI Form is a simple form that can be customized by clicking "Run workflow" in Actions, allowing users to input external parameters and trigger the CI/CD workflow.

Typically, users who will use this CD packaging may not necessarily be the app developers themselves, nor do they necessarily have permissions for the project; for example, QA may need to package a specific version, and PM/Backend may need to package a certain development version for testing. The Github Action Form requires permissions for the project to use, but users may not even have project permissions, and they may not even have an engineering background.

**Moreover, we cannot create dynamic forms or data validation here.**


> _Therefore, we need to set up another GUI service for other users to operate._ 

```markdown
#### Self-Built Slack App Solution

Previously, the team had a colleague who loved automation and built a complete Slack App web service using Kotlin+Ktor, integrating Slack messages, forms, commands, etc., to receive and forward CD packaging requests, trigger GitHub Actions to perform operations, and send the results back to Slack.

> _Currently, there are no development resources to build services using Kotlin+Ktor as before._ 

#### Custom Web/iOS/macOS App Tools

Currently, the team originally used Jenkins to provide a basic web interface for other users to log in, and additionally developed an app that connects to Jenkins to package some parameters for easier use by non-engineering background users.

> **_However, after migrating to GitHub Actions, this entire setup has been abandoned._** 

#### ❌ Private GitHub Pages

There should be an opportunity to directly build GitHub Pages as a CI/CD web GUI, but currently only GitHub [Enterprise](https://docs.github.com/en/enterprise-server@3.13/admin/configuration/configuring-your-enterprise/configuring-github-pages-for-your-enterprise#enabling-public-sites-for-github-pages){:target="_blank"} can set GitHub Pages access permissions; other plans, even if they are Private Repos, will be public; there is no security to speak of.

#### ❌ Slack App, but built using Google Apps Script

Initially, it was thought to use the Slack App as a CI/CD GUI Form service based on the previous team's experience, but currently, there are no resources to build services using Kotlin+Ktor as before; therefore, it was decided to quickly try building using Function as a Service.

There are many types of Function as a Service, [Cloud Functions](https://cloud.google.com/functions?hl=zh-tw){:target="_blank"} offers more flexibility, but due to organizational IT restrictions, it is not possible to freely add Public Cloud Functions and there are cost issues; thus, we return to our old friend — Google Apps Script.

> _I have previously written several articles about automating with Google Apps Script; interested friends can refer to:_ 

> _1\. **「 [Using Google Apps Script to Achieve Daily Data Report RPA Automation](../f6713ba3fee3/) 」**_ 

> _2\. 「 [Simple 3 Steps — Create a Free GA4 Automatic Data Notification Bot](https://medium.com/zrealm-robotic-process-automation/%E7%B0%A1%E5%96%AE-3-%E6%AD%A5%E9%A9%9F-%E6%89%93%E9%80%A0%E5%85%8D%E8%B2%BB-ga4-%E8%87%AA%E5%8B%95%E6%95%B8%E6%93%9A%E9%80%9A%E7%9F%A5%E6%A9%9F%E5%99%A8%E4%BA%BA-1e85b8df2348?source=collection_home---6------1-----------------------){:target="_blank"} 」_ 

> _3\. 「 [Crashlytics + Google Analytics Automatic Query App Crash-Free Users Rate](https://medium.com/zrealm-robotic-process-automation/crashlytics-google-analytics-%E8%87%AA%E5%8B%95%E6%9F%A5%E8%A9%A2-app-crash-free-users-rate-793cb8f89b72?source=collection_home---6------8-----------------------){:target="_blank"} 」_ 

> _4\. 「 [Crashlytics + Big Query Create a More Real-Time Convenient Crash Tracking Tool](https://medium.com/zrealm-robotic-process-automation/crashlytics-big-query-%E6%89%93%E9%80%A0%E6%9B%B4%E5%8D%B3%E6%99%82%E4%BE%BF%E5%88%A9%E7%9A%84-crash-%E8%BF%BD%E8%B9%A4%E5%B7%A5%E5%85%B7-e77b80cc6f89?source=collection_home---6------9-----------------------){:target="_blank"} 」_ 
```






In summary, Google Apps Script is another Function as a Service offered by Google, characterized by its free nature and quick integration with Google services. However, it also has many limitations, such as being restricted to its own language, a maximum execution time of 6 minutes, limits on execution counts, and lack of support for multithreading, among others. For details, you can refer to [my previous article](../f6713ba3fee3/) .

The conclusion is that it is not feasible, for the following reasons:
- [Function as a Service cold start issue](https://www.cloudflare.com/zh-tw/learning/serverless/what-is-serverless/){:target="_blank"}.
If the service is not called for a period of time, it goes into sleep mode, and the next call takes longer to start (3 to ≥ 5 seconds); **Slack App has very strict requirements for API response times, and the service must respond within 3 seconds, or it is considered a failure**. In this case, Slack will directly return an error, and event listening will be considered lost, leading to duplicate sends.
- **Google Apps Script doGet and doPost methods cannot retrieve Headers.** 
**This prevents the use of [official security verification](https://api.slack.com/authentication/verifying-requests-from-slack){:target="_blank"} and disables [Slack Retry](https://api.slack.com/authentication/verifying-requests-from-slack){:target="_blank"} .**
- Google Apps Script single-threading issue.
If you need to connect to other services, the response time will exceed 3 seconds, which Slack will directly determine as a failure.


I managed to use Slack messages, Block Kit, and Forms to complete the entire process, but it was too easy to trigger the above issues, so I eventually gave up.


> **_If you want to implement this, you should set up your own server and service, rather than using Function as a Service!_** 




#### ❌ Slack Workflow Form


![](/assets/4cb4437818f2/1*KWBMdFswvl1KPdnTLStzhQ.png)



![[Slack Workflow Form](https://slack.com/intl/zh-tw/help/articles/24720245025555-%E8%87%AA%E5%8B%95%E5%8C%96%EF%BC%9A%E4%BD%BF%E7%94%A8%E7%B0%A1%E6%98%93%E8%A1%A8%E5%96%AE%E6%94%B6%E9%9B%86%E8%B3%87%E8%A8%8A){:target="_blank"} \(❌ Cannot be customized\)](/assets/4cb4437818f2/1*hnDPyOfGCTW_yJf71krMnA.png)

[Slack Workflow Form](https://slack.com/intl/zh-tw/help/articles/24720245025555-%E8%87%AA%E5%8B%95%E5%8C%96%EF%BC%9A%E4%BD%BF%E7%94%A8%E7%B0%A1%E6%98%93%E8%A1%A8%E5%96%AE%E6%94%B6%E9%9B%86%E8%B3%87%E8%A8%8A){:target="_blank"} \(❌ Cannot be customized\)

I also tried Slack's built-in automation feature, Workflow Form, but it cannot create dynamic form content (e.g., fetching branches for user selection); the only customizable part is the subsequent data submission step.
### ✅ Google Apps Script Web App GUI Form

When one path is blocked, another opens. It seems that there is no need to be fixated on integrating with Slack. While integrating with Slack is the best solution because it directly incorporates into existing team collaboration tools without needing to learn new tools, due to resource constraints, we can only seek other stable and user-friendly methods.


> _Looking back, Google Apps Script can be deployed as a Web App, which can respond with a GUI Form during Web doGet, and after submitting the form, it can trigger subsequent GitHub integration processing._ 




#### Final Result 🎉


![[Demo Web App Form](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}](/assets/4cb4437818f2/1*pzW-Yki-4HbE2nYXC4q-Aw.png)

```markdown
[Demo Web App Form](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}
#### **Workflow**

We use Google Apps Script Web App to build a CI/CD form, directly binding it to Google Workspace accounts, setting access to only users within the organization; automatically obtaining the currently logged-in user's email, using a shared account (or borrowing an account with permissions) Personal Access Token to call the GitHub API to get the branch list, and after submission, similarly calling the API to trigger GitHub Action to start executing CI/CD tasks.

Additionally, we can use the user's email to call the Slack API through the Slack App to obtain that user's Slack ID, and then send messages via the Slack App to notify the status of CI/CD task execution.

We can also integrate with other tools and development processes, such as first obtaining tickets from Asana or Jira, selecting them, and then using the GitHub API to find branches, trigger GitHub Action, and finally notify the user via Slack.
#### Step 1. Create Google Apps Script Web App Form

Go to > [Google Apps Script](https://script.google.com/home){:target="_blank"}, and create a new project.


![](/assets/4cb4437818f2/1*T3if7Dfo0iJaa4N5VZyA1Q.png)

#### Step 2. Create Form Content and GAS Program

Having not written HTML and CSS for a long time and being too lazy to design styles myself, I directly asked ChatGPT to generate an HTML form template with some design.


![](/assets/4cb4437818f2/1*IPv0afE5FAFj40F22s8Umg.png)



![](/assets/4cb4437818f2/1*F_HrfV_k16g_ojm1WIDDuA.png)


In the GAS file list on the left, click the “+” to add a file, enter the file name “ `Form.html` ”, and paste the HTML form template content generated by GPT.

`Form.html：`
```xml
<!--HTML & Style Gen by ChatGPT 4o-->
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><?=title?></title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f7f7f7;
    }
    .form-container {
      max-width: 600px;
      margin: auto;
      padding: 20px;
      background-color: #ffffff;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .form-container h2 {
      margin-bottom: 20px;
      color: #333333;
    }
    .form-group {
      margin-bottom: 15px;
    }
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #555555;
    }
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 95%;
      padding: 10px;
      border: 1px solid #cccccc;
      border-radius: 4px;
      font-size: 16px;
    }
    .form-group input[type="radio"] {
      width: auto;
      margin-right: 10px;
    }
    .form-group .radio-label {
      display: inline-block;
      margin-right: 20px;
    }
    .form-group button {
      background-color: #4CAF50;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
    }
    .form-group button:hover {
      background-color: #45a049;
    }
    .message {
      margin-top: 20px;
      padding: 15px;
      border-radius: 5px;
      font-size: 1em;
      text-align: center;
    }
    .message.success {
      background-color: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    .message.error {
      background-color: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div class="form-container">
    <h2><?=title?></h2>
    <form id="myForm">
      <div id="message-block" class="hidden"></div>
      <div class="form-group">
        <label for="email">Email:</label>
        <input type="email" value="<?=email?>" readonly/>
      </div>
      <div class="form-group">
        <label for="buildNumber">Version Number:</label>
        <input type="number" value="<?=buildNumber?>"/>
      </div>
      <div class="form-group">
        <label for="branch">PR Under Review:</label>
        <select id="branch" name="branch">
          <option>Please select</option>
          <? pullRequests.forEach(pullRequest => { ?>
            <option value="<?=pullRequest.head.ref?>">[<?=pullRequest.state?>] <?=pullRequest.title?></option>
          <? }); ?>
        </select>
      </div>
      <div class="form-group">
        <label for="message">Update Content:</label>
        <textarea id="message" name="message" rows="4" placeholder="Please enter your message"></textarea>
      </div>
      <div class="form-group">
        <button type="submit">Submit</button>
      </div>
    </form>
  </div>
  <script>
    function displayMessage(ok, message) {
      const messageBlock = document.getElementById('message-block');
      messageBlock.className = ok ? 'message success' : 'message error';
      messageBlock.innerHTML = message;
      messageBlock.classList.remove('hidden');
    }
    
    document.getElementById("myForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const formData = new FormData(this);
      const formObject = Object.fromEntries(formData);
      google.script.run.withSuccessHandler((response) => {
        displayMessage(response.ok, response.message);
      }).processForm(formObject);
    });
  </script>
</body>
</html>
```

The form content can be adjusted according to your needs.

`code.gs:`
```javascript
function doGet(e) {
  // Corresponds to the left file Form.html
  const htmlTemplate = HtmlService.createTemplateFromFile('Form');
  
  const email = Session.getActiveUser().getEmail();
  // Get the user's email, limited to execution identity: users accessing the web application settings are valid
  
  const title = "App CD Packaging Request Form";
  
  const buildNumber = genBuildNumber();

  htmlTemplate.email = email;
  htmlTemplate.title = title;
  htmlTemplate.pullRequests = []; // Next step is to connect to Github...
  htmlTemplate.buildNumber = buildNumber;

  const html = htmlTemplate.evaluate();
  html.setTitle(title);
  //html.setWidth(600) // Set page width

  return html
}

function processForm(object) {
  return {"ok": true, "message": "Request submitted successfully!"};
}

function genBuildNumber() {
  const now = new Date();
  const formattedDate = Utilities.formatDate(now, "Asia/Taipei", "yyyyMMddHHmmss");
  const milliseconds = now.getMilliseconds().toString().padStart(3, '0'); // Ensure milliseconds are 3 digits
  return `${formattedDate}${milliseconds}`; 
}
```

In this step, we will first complete the form GUI, and in the next step, we will connect to the Github API to obtain the PR branch list.

![](/assets/4cb4437818f2/1*RN9ftVBdgCA-IL8ra9jvTg.png)

#### Step 2. Deploy Google Apps Script Web App Form

We will deploy the content we just created once to check the results.

In the upper right corner of GAS, select "Deploy" -> "New deployment" -> "Web application":

![](/assets/4cb4437818f2/1*ouVO18FtOcX8vdeGCEtwCw.png)

![](/assets/4cb4437818f2/1*4BuEtIA4H_-Q9WALonYxYg.png)

![](/assets/4cb4437818f2/1*JagpVPTGD-W0lhIJ5nrRew.png)

The execution identity and who can access can be set as follows:

**Execution identity: Me**  
`The script will run as your account.`  
- Who can access: Only myself  
- Who can access: All users in the same organization as XXX  
`Only users in the same organization + logged-in Google account users can access.`  
- Who can access: All logged-in Google account users  
`All logged-in Google account users can access.`  
- Who can access: Everyone  
`No need to log in to a Google account; everyone can access publicly.`

**Execution identity: User accessing the web application**  
`The script will run as your account.`  
- Who can access: Only myself  
- Who can access: All users in the same organization as XXX  
`Only users in the same organization + logged-in Google account users can access.`  
- Who can access: All logged-in Google account users  
`All logged-in Google account users can access.`

> _We choose "Who can access: All users in the same organization as XXX" + "Execution identity: User accessing the web application" to **automatically restrict access to only organizational accounts**, and run it under their own identity!_ 

> _It's a very convenient permission control feature!_

After making your selections, click "Deploy" in the lower right corner.

![](/assets/4cb4437818f2/1*dvyqYb5kcta402j3RUYJog.png)

The URL in the web application is the access URL for the Web App.
```bash
https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec
```

> _The URL is long and ugly, but there's no way around it; you'll have to find a URL shortener tool to shorten it yourself._ 





**Click the link to open the page and see the effect:**


![](/assets/4cb4437818f2/1*jbx4IO4DEhqYfwI_UTQk5Q.png)


**Here are two additional GAS limitations to mention:**
- The warning message at the top of the GAS Web App cannot be hidden by default.
- The GAS Web App embeds our page using an IFrame, making it difficult to achieve 100% responsive design (RWD) effects. You can only use `.setWidth()` to adjust the window width.

#### Google Apps Script Authorization Warning

**The first time you use it**, clicking "Debug" or "Run" may trigger the following authorization warning:


![](/assets/4cb4437818f2/1*9q8KZGHER9vdtnbKVVQB9g.png)



![](/assets/4cb4437818f2/1*iWrkqMf8vkEGkiwkI1amIw.jpeg)


Select the account you want to use. If you see "This app isn't verified by Google," click "Advanced" -> "Go to XXX (unsafe)" and select "Allow":


![](/assets/4cb4437818f2/1*ucaqLxh-TOgJIaGyqqFd3A.png)



![](/assets/4cb4437818f2/1*l-tma_YICU24goKvZvl7Ww.png)



![](/assets/4cb4437818f2/1*JAs_3__Qt2XeDcQiKEUNhg.png)


If the permissions for the GAS program change (for example, if you add access to Google Sheets, etc.), you will need to reauthorize; otherwise, it won't appear again after you've done it once.
#### Step 3. Connect to the Github API to obtain the PR branch list

We will add a `Github.gs` script file to store the logic related to the Github API.

`Github.gs：`
```javascript
// SECRET
const githubPersonalAccessToken = ""
// Create a PAT using your Github account or a shared Github account of your organization
// https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens

// Method 1: Access via Restful API
function githubAPI(method, path, payload = null) {
  try {
    const url = "https://api.github.com"+path;  
    var options = {
      method: method,
      headers: {
        "Accept": "application/vnd.github+json",
        "Authorization": `Bearer ${githubPersonalAccessToken}`,
        "X-GitHub-Api-Version": "2022-11-28"
      }
    };

    if (method.toLowerCase().trim() == "post") {
      options.payload = JSON.stringify(payload);
    }

    const response = UrlFetchApp.fetch(url, options);
    const data = JSON.parse(response.getContentText());
    return data;
  } catch (error) {
    throw error;
  }
}

// Method 2: Access via GraphQL
// Some more detailed query functions of the Github API are only available through the GraphQL API
// https://docs.github.com/en/graphql
function githubGraphQL(query, variables) {
  const url = "https://api.github.com/graphql";
  const payload = {
    query: query,
    variables: variables
  };

  const options = {
    method: "post",
    contentType: "application/json",
    headers: {
      "Accept": "application/vnd.github+json",
      "Authorization": `Bearer ${githubPersonalAccessToken}`,
      "X-GitHub-Api-Version": "2022-11-28"
    },
    payload: JSON.stringify(payload)
  };

  try {
    const response = UrlFetchApp.fetch(url, options);
    const data = JSON.parse(response.getContentText());
    return data;
  } catch (error) {
    throw error;
  }
}

// GraphQL Example:
// const query = `
//   query($owner: String!, $repo: String!) {
//     repository(owner: $owner, name: $repo) {
//       pullRequests(states: OPEN, first: 100, orderBy: { field: CREATED_AT, direction: DESC }) {
//         nodes {
//           title
//           url
//           number
//           createdAt
//           author {
//             login
//           }
//           headRefName
//           baseRefName
//           body
//         }
//         pageInfo {
//           hasNextPage
//           endCursor
//         }
//       }
//     }
//   }
// `;
// const variables = {
//   owner: "swiftlang",
//   repo: "swift"
// };
// const response = githubGraphQL(query, variables);
```


The GitHub API has two access methods: one is the traditional Restful, and the other is the more flexible GraphQL; this article uses Restful as an example.

`code.gs:`
```kotlin
function doGet(e) {
  // Corresponds to the left file Form.html
  const htmlTemplate = HtmlService.createTemplateFromFile('Form');
  
  const email = Session.getActiveUser().getEmail();
  // Get the user's email, limited to the execution identity: the user accessing the web program must be set to valid

  const title = "App CD Packaging Request Form";
  
  const pullRequests = githubAPI("get", "/repos/swiftlang/swift/pulls");
  // For example, https://github.com/swiftlang/swift/pulls
  
  const buildNumber = genBuildNumber();

  htmlTemplate.email = email;
  htmlTemplate.title = title;
  htmlTemplate.pullRequests = pullRequests;
  htmlTemplate.buildNumber = buildNumber;

  const html = htmlTemplate.evaluate();
  html.setTitle(title);
  //html.setWidth(600) // Set the page width

  return html
}

function processForm(object) {
  if (object.buildNumber == "") {
    return {"ok": false, "message": "Please enter the version number!"};
  }
  if (object.branch == "") {
    return {"ok": false, "message": "Please select a branch version!"};
  }

  // Include the parameters you want to send to GitHub Action
  const payload = {
    ref: object.branch,
    inputs: {
      buildNumber: object.buildNumber
    }
  };
  
  //  
  try {
    const response = githubAPI("post", "/repos/zhgchgli0718/ios-project-for-github-action-ci-cd-demo/actions/workflows/CD-Job.yml/dispatches", payload);
    // For example, https://github.com/zhgchgli0718/ios-project-for-github-action-ci-cd-demo/blob/main/.github/workflows/CD-Job.yml

    return {"ok": true, "message": `Packaging request sent successfully!<br/>Corresponding branch: <strong>${object.branch}</strong><br/>Version number: <strong>${object.buildNumber}</strong>`};
  } catch (error) {
    return {"ok": false, "message": "An error occurred: " + error.message};
  }
}
```

The `processForm` method handles the content returned from the form and can also include more parameters.
#### GAS x GitHub API x GitHub Action

Here is some additional information corresponding to the GitHub Action.

`CD-Job.yml:`
```yaml
# CD Packaging Job

name: CD-Job

on:
  workflow_dispatch:
    inputs:
      buildNumber: # Corresponds to GAS payload.inputs.xxx
        description: 'Version number'
        required: false
        type: string
      # ...More
      # Input types can refer to the official documentation: https://docs.github.com/en/actions/writing-workflows/workflow-syntax-for-github-actions#onworkflow_dispatchinputs
      
jobs:
  some-job:
    runs-on: ubuntu-latest
    steps:
      - name: Print Inputs
        run: |
          echo "Release Build Number: ${{ github.event.inputs.buildNumber }}"    
```
#### Step 4. Redeploy Google Apps Script Web App Form

> **_⚠️Please note that any adjustments to the GAS code require redeployment to take effect.⚠️_** 

> **_⚠️Please note that any adjustments to the GAS code require redeployment to take effect.⚠️_** 

> **_⚠️Please note that any adjustments to the GAS code require redeployment to take effect.⚠️_** 

GAS select "Deploy" in the upper right corner -> select "Edit" in the upper right corner -> version select "Create new version"

![](/assets/4cb4437818f2/1*ZMAB_m6HmsSsGSqqfZiRpA.png)

![](/assets/4cb4437818f2/1*rUWlfzASAaeXcXUh4LavZw.png)

![](/assets/4cb4437818f2/1*HAr5TZtpnQeG-Ril0Rjf-g.png)

Click "Deploy" -> Complete.

![](/assets/4cb4437818f2/1*z6lw7R8ivUseSzR4IZgPdg.png)

![](/assets/4cb4437818f2/1*eTdgKGQ1lRM7sCRXQgZ-DA.png)

**Refresh the webpage to see the modified results:** 

![](/assets/4cb4437818f2/1*iI49OJC1uTyMEgzGTBowxQ.png)

> **_⚠️Please note that any adjustments to the GAS code require redeployment to take effect.⚠️_** 

> **_⚠️Please note that any adjustments to the GAS code require redeployment to take effect.⚠️_** 

> **_⚠️Please note that any adjustments to the GAS code require redeployment to take effect.⚠️_** 

### Done! 🎉🎉🎉

![](/assets/4cb4437818f2/1*pzW-Yki-4HbE2nYXC4q-Aw.png)

![[Demo Web App Form](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}](/assets/4cb4437818f2/1*9aaNeemezNPRlSgbLFrseA.png)

[Demo Web App Form](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}

Now you can share this link with other partners within the organization, and they can directly use this web GUI to perform CI/CD tasks.  
#### Extension (1) — Query Slack User ID using the user's email & send/update progress notifications

As mentioned earlier, we want to notify users of the CI/CD execution status in a timely manner, and we can use the email provided by the user to look up the Slack User ID.

`Slack.gs:`  
```javascript
const slackBotToken = ""
// https://medium.com/zrealm-robotic-process-automation/slack-chatgpt-integration-bd94cc88f9c9

function slackRequest(path, content) {
  const options = {
    method: "post",
    contentType: "application/json",
    headers: {
      Authorization: `Bearer ${slackBotToken}`, // Use the bot token for authorization,
      'X-Slack-No-Retry': 1
    },
    payload: JSON.stringify(content)
  };

  try {
    const response = UrlFetchApp.fetch("https://slack.com/api/"+path, options);
    const responseData = JSON.parse(response.getContentText());
    if (responseData.ok) {
      return responseData
    } else {
      throw new Error(`Slack: ${responseData.error}`);
    }
  } catch (error) {
    throw error;
  }
}

// Query Slack UID using email
function getSlackUserId(email) {
  return slackRequest(`users.lookupByEmail?email=${encodeURIComponent(email)}`)?.user?.id;
}

// Send message to target Slack UID (channelID)
function sendSlackMessage(channelId, ts = null, value)  {
  var content = {
    channel: channelId
  };

  if (ts != null) {
    content.thread_ts = ts;
  }
  
  if (typeof value === "string") {
    content.text = value;
  } else {
    content.blocks = value;
  }
  return slackRequest("chat.postMessage", content);
}

// Update the content of the sent message
function updateSlackMessage(channelId, ts = null, value)  {
  var content = {
    channel: channelId
  };

  if (ts != null) {
    content.ts = ts;
  }
  
  if (typeof value === "string") {
    content.text = value;
  } else {
    content.blocks = value;
  }
  return slackRequest("chat.update", content);
}
```


For Slack API usage, please refer to the [official documentation](https://api.slack.com/methods/chat.postMessage){:target="_blank"}.

**GitHub Action YAML can use this Action to continuously update messages and send Slack messages:**

[![](https://opengraph.githubassets.com/7e7d799a761f54de72d5dd8991c2cea3f04cf8830b7257b4932dbb5c1cb5b604/slackapi/slack-github-action)](https://github.com/slackapi/slack-github-action){:target="_blank"}

```yaml
# ...
on:
  workflow_dispatch:
    inputs:
      buildNumber: # Corresponding to GAS payload.inputs.xxx
        description: 'Version number'
        required: false
        type: string
      # ...More
      SLACK_USER_ID:
        description: 'Slack User Id for receiving action notification'
        type: string
      SLACK_CHANNEL_ID:
        description: 'Slack Channel Id for receiving action notification'
        type: string
      SLACK_THREAD_TS:
        description: 'Slack message ts'
        type: string
      
jobs:
  # some jobs...

  if-deploy-failed-message:
    runs-on: ubuntu-latest
    if: failure()
      - name: update slack message
        uses: slackapi/slack-github-action@v2.0.0
        with:
            method: chat.update
            token: ${{ secrets.SLACK_BOT_TOKEN }}
            payload: |
              channel: ${{ github.event.inputs.SLACK_CHANNEL_ID }}
              ts: ${{ github.event.inputs.SLACK_THREAD_TS }}
              text: "❌ The packaging task failed. Please check the execution status or try again later.\n<${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}|Click here to view the execution status> cc'ed <@${{ github.event.inputs.SLACK_USER_ID }}>"
```

**Effect:**

![](/assets/4cb4437818f2/1*-w5jqjkx6p2alpzlLcz_Nw.png)

> **_For details on integrating the Slack App, you can refer to my previous article: [Slack & ChatGPT Integration](../bd94cc88f9c9/)._**

#### Extension (2) — Query Jira Tickets

`Jira.gs:`
```javascript
const jiraPersonalAccessToken = ""
// https://confluence.atlassian.com/enterprise/using-personal-access-tokens-1026032365.html

function getJiraTickets() {
  const url = `https://xxx.atlassian.net/rest/api/3/search`;

  // JQL query
  const jql = `project = XXX`;
  const queryParams = {
    jql: jql,
    maxResults: 50, // Adjust as needed
  };

  const options = {
    method: "get",
    headers: {
      Authorization: "Basic " + jiraPersonalAccessToken,
      "Content-Type": "application/json",
    },
    muteHttpExceptions: true,
  };

  const queryString = Object.keys(queryParams).map(key => `${encodeURIComponent(key)}=${encodeURIComponent(queryParams[key])}`).join("&");
  const response = UrlFetchApp.fetch(url + "?" + queryString + "&fields=", options);
  // could specify only return some fields

  if (response.getResponseCode() === 200) {
    const issues = JSON.parse(response.getContentText()).issues;
    return issues;
  } else {
    Logger.log(`Error: ${response.getResponseCode()} - ${response.getContentText()}`);
    throw new Error("Failed to fetch Jira issues.");
  }
} 
```


For other Jira API usage, please refer to the [official documentation](https://developer.atlassian.com/cloud/jira/platform/rest/v3/){:target="_blank"}.
#### Extension (3) — Query Asana Tasks

`Asana.gs：`
```kotlin
const asanaPersonalAccessToken = ""
// https://developers.asana.com/docs/personal-access-token

function asanaAPI(endpoint, method = "GET", data = null) {
    var options = {
      "method" : method,
      "contentType" : "application/json",
      "headers": {
          "Authorization":  "Bearer "+asanaPersonalAccessToken
      }
    };

    if (data != null) {
      options["payload"] = JSON.stringify({"data":data});
    }

    const url = "https://app.asana.com/api/1.0"+endpoint;
    const res = UrlFetchApp.fetch(url, options);
    const data = JSON.parse(res.getContentText());
    return data;
}

// Find tasks in project
// asanaAPI("/projects/PROJECT_ID/tasks");
```

For other Asana API usage, please refer to the [official documentation](https://developers.asana.com/reference/gettasksforproject){:target="_blank"}.
### Summary

The missing element in automation, work, and development process optimization is never technology, but ideas; as long as we have ideas, we can find the right technology to implement them. Let's encourage each other!

If you have any questions or suggestions, feel free to [contact me](https://www.zhgchg.li/contact){:target="_blank"}.



_[Post](https://medium.com/zrealm-ios-dev/%E4%BD%BF%E7%94%A8-google-apps-script-web-app-%E8%A1%A8%E5%96%AE%E4%B8%B2%E6%8E%A5-github-action-ci-cd-%E5%B7%A5%E4%BD%9C-4cb4437818f2){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}._
