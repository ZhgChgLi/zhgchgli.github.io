---
author: ZhgChgLi
categories:
- ZRealm Dev.
date: 2022-07-20T14:50:44.659+0000
description: Developers seeking streamlined control over Customer Reviews and Subscriptions
  can leverage App Store Connect API 2.0+ to automate management and enhance app performance
  with precise in-app purchase handling.
image:
  path: /assets/f1365e51902c/1*hHJ66r9BgJQsGnRYqbB_8g.png
last_modified_at: 2024-04-14T02:18:42.807+0000
render_with_liquid: false
tags:
- english
- iOS App Development
- App Store Connect
- API
- App Review
- Integration
title: 'App Store Connect API: Manage Customer Reviews and Subscriptions Efficiently'
---

### App Store Connect API Now Supports Reading and Managing Customer Reviews

App Store Connect API 2.0+ Complete Update, Supporting In-app Purchases, Subscriptions, and Customer Reviews Management

### 2022/07/19 News

![[Upcoming transition from the XML feed to the App Store Connect API](https://developer.apple.com/news/?id=yqf4kgwb){:target="_blank"}](/assets/f1365e51902c/1*hHJ66r9BgJQsGnRYqbB_8g.png)

[Upcoming transition from the XML feed to the App Store Connect API](https://developer.apple.com/news/?id=yqf4kgwb){:target="_blank"}

This morning, I received the [latest news from Apple Developer](https://developer.apple.com/news/rss/news.rss){:target="_blank"}. The App Store Connect API now supports managing In-app Purchases, Subscriptions, and Customer Reviews. This allows developers to integrate Apple‚Äôs development process more flexibly and efficiently with CI/CD or business backends!

In-app purchases and Subscriptions I haven't touched, but Customer Reviews excite me greatly. I previously published an article titled "[**AppStore APP‚Äôs Reviews Slack Bot ÈÇ£‰∫õ‰∫ã**](../cb0c68c33994/)" exploring the integration of app reviews with workflow.

![Slack Review Bot ‚Äî [ZReviewsBot](https://github.com/ZhgChgLi/ZReviewsBot){:target="_blank"}](/assets/f1365e51902c/1*igukM7FTLxaX2hpVtFPMjQ.png)

Slack Review Bot ‚Äî [ZReviewsBot](https://github.com/ZhgChgLi/ZReviewsBot){:target="_blank"}

Before the App Store Connect API was supported, there were only two ways to get iOS App reviews:

**1.** Obtained through subscribing to [Public RSS](https://rss.itunes.apple.com/zh-tw){:target="_blank"}, but this RSS lacks flexible filtering, provides limited information, has quantity limits, and we occasionally encounter data inconsistencies, making it unstable.

**2.** Using [**Fastlane**](https://fastlane.tools/){:target="_blank"} **‚Äî [SpaceShip](https://github.com/fastlane/fastlane/tree/master/spaceship){:target="_blank"}** to handle complex web operations and session management for us, fetching review data from the App Store Connect backend (essentially acting as a web emulator crawler to scrape data from the backend).

- The advantage is complete and stable data; we have integrated it for a year without any data issues.

- The downside is that the session expires every month and requires manual re-login. Also, Apple ID now universally requires 2FA verification, so this step must be done manually to generate a valid session. Additionally, if the IP used to create the session differs from the IP used later, the session will expire immediately (making it difficult to run the bot on networks with dynamic IPs).

![[important-note-about-session-duration](https://docs.fastlane.tools/best-practices/continuous-integration/#important-note-about-session-duration){:target="_blank"} by Fastlane](/assets/f1365e51902c/0*iMQRza9LN3ljy2k1.png)

[important-note-about-session-duration](https://docs.fastlane.tools/best-practices/continuous-integration/#important-note-about-session-duration){:target="_blank"} by Fastlane

- It expires irregularly every month, so you need to update it from time to time, which becomes really annoying over time; moreover, this "**Know How**" is actually hard to hand over to other colleagues.

> But since there was no other way, it had to be this way until I received news this morning‚Ä¶.

> **‚ö†Ô∏è Note: The official XML (RSS) access method is planned to be discontinued in November 2022.**

### 2022/08/10 Update

I have developed a new "[ZReviewTender ‚Äî Free Open Source App Reviews Monitoring Bot](../e36e48bb9265/)" based on the new App Store Connect API.

### App Store Connect API 2.0+ Customer Reviews Trial Play

#### Create App Store Connect API Key

First, log in to the App Store Connect backend, go to "Users and Access" -> "Keys" -> "[**App Store Connect API**](https://appstoreconnect.apple.com/access/api){:target="_blank"}":

![](/assets/f1365e51902c/1*0NimMOcIqQ95nzjBBKYe8A.png)

Click the "+" button, enter the name and permissions; for detailed permission rules, refer to the official website. To minimize testing issues, select "App Manager" here to grant the highest level of permissions.

![](/assets/f1365e51902c/1*Bt8ddt7GrZs1ERaFamftVw.png)

Click "Download API Key" on the right to download and save your "AuthKey_XXX.p8" key.

> ‚ö†Ô∏è Note: This key can only be downloaded once, so please **keep it safe**. If lost, you can only revoke the existing one and create a new one. ‚ö†Ô∏è

> **‚ö†Ô∏è Do Not Leak the .p8 Key File ‚ö†Ô∏è**

#### App Store Connect API Access Methods

```bash
curl -v -H 'Authorization: Bearer [signed token]' "https://api.appstoreconnect.apple.com/v1/apps"
```

#### Signed Token (JWT, JSON Web Token) Generation Method

Refer to the [official documentation](https://developer.apple.com/documentation/appstoreconnectapi/generating_tokens_for_api_requests){:target="_blank"}.

![](/assets/f1365e51902c/1*KDv2ra17oSp5UXKy-VZA1g.png)

- JWT Header:

```json
{kid:"YOUR_KEY_ID", typ:"JWT", alg:"ES256"}
```

`YOUR_KEY_ID`: Refer to the image above.

- JWT Payload:

```json
{
  iss: 'YOUR_ISSUE_ID',
  iat: TOKEN creation time (UNIX TIMESTAMP e.g 1658326020),
  exp: TOKEN expiration time (UNIX TIMESTAMP e.g 1658327220),
  aud: 'appstoreconnect-v1'
}
```

`YOUR_ISSUE_ID`: Refer to the image above.

`exp TOKEN expiration time`: The expiration time varies depending on the access function or setting. Some can be permanent, while others expire after more than 20 minutes and require regeneration. For details, please refer to the [official documentation](https://developer.apple.com/documentation/appstoreconnectapi/generating_tokens_for_api_requests#3878467){:target="_blank"}.

#### Use [JWT.IO](https://jwt.io/){:target="_blank"} or the Ruby example below to generate a JWT

jwt.rb:

```ruby
require 'jwt'
require 'time'

keyFile = File.read('./AuthKey_XXXX.p8') # YOUR .p8 private key file path
privateKey = OpenSSL::PKey::EC.new(keyFile)

payload = {
            iss: 'YOUR_ISSUE_ID',
            iat: Time.now.to_i,
            exp: Time.now.to_i + 60*20,
            aud: 'appstoreconnect-v1'
          }

token = JWT.encode payload, privateKey, 'ES256', header_fields={kid:"YOUR_KEY_ID", typ:"JWT"}
puts token


decoded_token = JWT.decode token, privateKey, true, { algorithm: 'ES256' }
puts decoded_token
```

- Ruby JWT tool is here: <https://github.com/jwt/ruby-jwt>{:target="_blank"}

**The final result will be a JWT similar to the following:**

```
4oxjoi8j69rHQ58KqPtrFABBWHX2QH7iGFyjkc5q6AJZrKA3AcZcCFoFMTMHpM.pojTEWQufMTvfZUW1nKz66p3emsy2v5QseJX5UJmfRjpxfjgELUGJraEVtX7tVg6aicmJT96q0snP034MhfgoZAB46MGdtC6kv2Vj6VeL2geuXG87Ys6ADijhT7mfHUcbmLPJPNZNuMttcc.fuFAJZNijRHnCA2BRqq7RZEJBB7TLsm1n4WM1cW0yo67KZp-Bnwx9y45cmH82QPAgKcG-y1UhRUrxybi5b9iNN
```

#### Try it out?

With the token, we can now try using the App Store Connect API!

```bash
curl -H 'Authorization: Bearer JWT' "https://api.appstoreconnect.apple.com/v1/apps/APPID/customerReviews"
```

- `APPID` can be obtained from the App Store Connect backend:

![](/assets/f1365e51902c/1*yU4J85S6Q_e8c9NPYE8bNw.png)

Or the App Store page:

- <https://apps.apple.com/tw/app/pinkoi/id557252416>{:target="_blank"}

- APPID = `557252416`

![](/assets/f1365e51902c/1*wWIpy8Y5G2F0A2FvQzp0hQ.png)

- Success! üöÄ We can now fetch App reviews using this method. The data is complete and can be fully handled by the machine without manual routine maintenance (although the JWT expires, the Private Key does not, so we can generate a JWT signed with the Private Key for each request to access the data).

- For other filter parameters and operation methods, please refer to the [official documentation](https://developer.apple.com/documentation/appstoreconnectapi/list_all_customer_reviews_for_an_app){:target="_blank"}.

> **‚ö†Ô∏è You can only access app review data for which you have permission ‚ö†Ô∏è**

#### Complete Ruby Test Project

Using a Ruby file, the above process is implemented. You can directly clone it and fill in the data for testing.

[![](https://opengraph.githubassets.com/dc0eb76d891ed80d9f1cb1979225b4cf2ad813fe3c1344bac51a14384c8aeb00/zhgchgli0718/appstoreconnectapitester)](https://github.com/zhgchgli0718/appstoreconnectapitester){:target="_blank"}

**First Open:**

```bash
bundle install
```

**Getting Started:**

```bash
bundle exec ruby jwt.rb
```

### Next

Similarly, we can access and manage through the API ( [API Overview](https://developer.apple.com/app-store-connect/api/){:target="_blank"} ):

- **[New]** [Customer reviews](https://developer.apple.com/documentation/appstoreconnectapi/app_store/customer_reviews){:target="_blank"}

- **[New]** [Subscriptions](https://developer.apple.com/app-store/subscriptions/){:target="_blank"}

- **[New]** [In-App Purchases](https://developer.apple.com/in-app-purchase/){:target="_blank"}

- **[New]** [Xcode Cloud Workflows And Builds](https://developer.apple.com/documentation/appstoreconnectapi/xcode_cloud_workflows_and_builds){:target="_blank"}

- **[Updated]** [Improving your App‚Äôs Performance](https://developer.apple.com/documentation/metrickit/improving_your_app_s_performance){:target="_blank"}

- [TestFlight](https://developer.apple.com/testflight/){:target="_blank"}

- [Users And Roles](https://developer.apple.com/support/roles/){:target="_blank"}

- [App Clips](https://developer.apple.com/app-clips/){:target="_blank"}

- [App Management](https://help.apple.com/app-store-connect/#/dev2cd126805){:target="_blank"}

- [App Metadata](https://developer.apple.com/app-store/product-page/){:target="_blank"}

- [Pricing And Availability](https://help.apple.com/app-store-connect/#/dev9fc06e23d){:target="_blank"}

- [Provisioning](https://help.apple.com/developer-account/){:target="_blank"}

- [Sales and Trends](https://help.apple.com/app-store-connect/#/dev061699fdb){:target="_blank"}

If you have any questions or feedback, feel free to [contact me](https://www.zhgchg.li/contact){:target="_blank"}.

*[Post](https://medium.com/zrealm-ios-dev/app-store-connect-api-%E7%8F%BE%E5%B7%B2%E6%94%AF%E6%8F%B4-%E8%AE%80%E5%8F%96%E5%92%8C%E7%AE%A1%E7%90%86-customer-reviews-f1365e51902c){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}.*