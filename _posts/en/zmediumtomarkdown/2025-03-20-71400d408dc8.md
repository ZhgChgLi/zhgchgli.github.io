---
author: ZhgChgLi
categories:
- ZRealm Robotic Process Automation
date: 2025-03-20T14:12:48.523+0000
description: Developers facing complex API integrations can streamline processes by
  leveraging Google Apps Script with Firebase App Distribution API, achieving faster
  deployment and simplified management in app distribution workflows.
image:
  path: /assets/71400d408dc8/1*O6JWKIIS5oxyrOS3q9NXRQ.png
last_modified_at: 2025-07-10T13:00:24.208+0000
render_with_liquid: false
tags:
- english
- ai-translation
- ios-app-development
- firebase-app-distribution
- google-apps-script
- google-api
- google-cloud-platform
title: Google Apps Script｜Fast Integration with Google APIs Using Firebase App Distribution
  API
---

### Quick Integration Method for Google Apps Script x Google APIs

Using Google Apps Script with Firebase App Distribution API as an example

### Background

Previously, I wrote several articles about using Google Apps Script. Among them, "[Using Google Apps Script to Automate Daily Data Report RPA](../f6713ba3fee3/)" and "[Simple 3 Steps — Build a Free GA4 Auto Data Notification Bot](../1e85b8df2348/)" introduced how to connect Google Analytics with Google Sheets, Web App, Slack, Telegram using Google Apps Script to quickly build a visual data platform and notification service. Additionally, last month's article "[Using Google Apps Script Web App Form to Connect Github Action CI/CD Workflow](../4cb4437818f2/)" directly used Google Apps Script Web App to connect with the Github API as a CI/CD GUI form service. In all these cases, whether using built-in Google Apps Script services or directly connecting to external services (Slack, Github…), there was no need to connect to Google APIs.

> *This time, when optimizing the CI/CD GUI form, I want to display the Firebase Distribution download link directly on the Web App after packaging the internal test version. This can only be achieved by integrating with Google APIs.*

#### Google Apps Script x [Firebase App Distribution API v1](https://firebase.google.com/docs/reference/app-distribution/rest/){:target="_blank"}

![](/assets/71400d408dc8/1*O6JWKIIS5oxyrOS3q9NXRQ.png)

As shown in the above image, unlike the built-in "AnalyticsData" service for connecting with Google Analytics, Firebase App Distribution does not offer a built-in integration service, so an advanced method is required for integration.

> *Originally thought I had to generate and exchange the Access Token using a Service Account myself (a bit complicated, you can refer to my previous [Review Bot open-source project](https://github.com/ZhgChgLi/ZReviewTender/blob/main/lib/GoogleAPI.rb){:target="_blank"}), **but actually, it's not that complicated.***

### Google Apps Script x Google APIs Advanced Service Integration

#### Integration Settings

**Refer to the [official documentation](https://developers.google.com/apps-script/guides/services/advanced?hl=zh-tw#requirements){:target="_blank"} for details. We need to follow these steps for advanced setup:**

1. You must [enable Advanced Services](https://developers.google.com/apps-script/guides/services/advanced?hl=zh-tw#enable_advanced_services){:target="_blank"} in your script project.

2. You must ensure that the API for the corresponding advanced service is enabled in the [Cloud Platform (GCP) project](https://developers.google.com/apps-script/guides/cloud-platform-projects?hl=zh-tw){:target="_blank"} used by the script.

3. If your script project uses the [default GCP project](https://developers.google.com/apps-script/guides/cloud-platform-projects?hl=zh-tw#default_cloud_platform_projects){:target="_blank"} created on or after April 8, 2019, the API will be automatically enabled once you enable advanced services and save the script project. If you have not yet agreed, the system may also prompt you to accept the [Google Cloud](https://cloud.google.com/terms/?hl=zh-tw){:target="_blank"} and [Google API](https://developers.google.com/terms?hl=zh-tw){:target="_blank"} terms of service.

4. If your script project uses a [standard GCP project](https://developers.google.com/apps-script/guides/cloud-platform-projects?hl=zh-tw#standard_cloud_platform_projects){:target="_blank"} or an older default GCP project, you must manually [enable the corresponding API for advanced services](https://developers.google.com/apps-script/guides/cloud-platform-projects?hl=zh-tw#enabling_an_api_in_a_standard_gcp_project){:target="_blank"} in the GCP project. You need edit permissions for the GCP project to make this change.

#### 1. Project Setup — Configure the associated Google Cloud Platform (GCP) project

Google Apps Script x Google APIs advanced integration requires you to create a GCP project and link it to Google Apps Script. The usage permissions for Google APIs are based on the GCP settings.

Therefore, you need to create a GCP project (a Firebase GCP project is also acceptable), note the "Project Number" on the information homepage, and ensure that this GCP project has the Google APIs you want to use enabled, and that the currently logged-in account or the account you want to use has the necessary permissions for the GCP project and Google APIs.

![](/assets/71400d408dc8/1*-BlhyGAEtkcDRrZ86H2BHg.png)

![](/assets/71400d408dc8/1*fycqt1HNNO9qiu6RZ-WMlw.png)

> ***This article uses the [Firebase App Distribution API](https://firebase.google.com/docs/reference/app-distribution/rest/){:target="_blank"} as an example.***

![](/assets/71400d408dc8/1*T13M_lq7z-ui0_cLZtuHXg.png)

Enter the `Project Number` into the Google Cloud Platform project number field under the Google Apps Script project settings. If the current logged-in account has permission for that GCP project, it will automatically bind and set successfully.

#### 2. Project Setup — Enable Display of "appsscript.json" Manifest File in the Editor

![](/assets/71400d408dc8/1*YnhdxRSyr_CYB2CFnO_31Q.png)

After enabling, return to the editor, and the file list will show the `appsscript.json` configuration file:

![](/assets/71400d408dc8/1*r8bheyYWj-TX7vFIum2GIQ.png)

Make sure the oauthScopes include the following two descriptions:

```json
  "oauthScopes": [
    "https://www.googleapis.com/auth/script.external_request",
    "https://www.googleapis.com/auth/cloud-platform"
  ]
```

If not, please manually paste and save.

#### 3. Writing Integration Code

After setting up the GCP project, we can start writing the integration code by directly referring to the official documentation of the Google APIs we want to connect to, such as [Firebase App Distribution API v1](https://firebase.google.com/docs/reference/app-distribution/rest/){:target="_blank"}:

![](/assets/71400d408dc8/1*N0Zg4TEZQwTTLGCsaTdx8A.png)

```javascript
const project = "projects/[Firebase Project ID]/apps/[Firebase APP ID]"; // Please replace with your Project ID & App ID

function debug() {
  const releases = firebaseDistribution("");

  releases.forEach(function(release) {
    // Release Object: https://firebase.google.com/docs/reference/app-distribution/rest/v1/projects.apps.releases?hl=zh-tw#Release
    Logger.log(`${release.name} Download URL: ${release.testingUri}`);
  });
}

function firebaseDistribution(releaseNote) {
  const url = "https://firebaseappdistribution.googleapis.com/v1/"+project+"/releases?filter=releaseNotes.text%3D*"+releaseNote+"*";
  // Filter: https://firebase.google.com/docs/reference/app-distribution/rest/v1/projects.apps.releases/list?hl=zh-tw
  const headers = {
    "Content-Type": "application/json; charset=UTF-8",
    "Authorization": "Bearer " + ScriptApp.getOAuthToken(), // Use the current account to get the token directly
  };
  
  const options = {
    "method": "get",
    "headers": headers
  };
  const data = UrlFetchApp.fetch(url, options);
  const result = JSON.parse(data.getContentText()).releases;
  
  if (result == undefined) {
    return [];
  }

  return result;
}
```

`[Firebase Project ID]` **and `[Firebase APP ID]` can be found in the Firebase project settings:**

![](/assets/71400d408dc8/1*oql_FnmO7_ct8S3cOhP8lg.png)

After pasting the code, the first execution requires permission authorization.

![](/assets/71400d408dc8/1*sW3ZjQA3dKS8HhAOCDsmBA.png)

![](/assets/71400d408dc8/0*p-Zl0cob4mPrsNO6.png)

- Click "Review Permissions"

- Select the account to execute, usually the current Google Apps Script account

![](/assets/71400d408dc8/0*m7enb51ZiNlWYeoT.png)

![](/assets/71400d408dc8/0*SN-0owiePlKXIxLk.png)

- Select "Advanced" to expand -> Click "Go to XXX"  
  This is an app we created for our own use, so it does not require Google verification.

- Click "Allow"

> *The above screen may not appear and can be ignored if absent.*

**Allow then click "Debug" or "Run" later to execute the program:**

If an error occurs:

```php
Exception: Request failed for https://firebaseappdistribution.googleapis.com returned code 403. Truncated server response: {
  "error": {
    "code": 403,
    "message": "Request had insufficient authentication scopes.",
    "status": "PERMISSION_DENIED",
    "details":... (use muteHttpExceptions option to examine full response)
...
```

or

```
Exception: Specified permissions are not sufficient to call UrlFetchApp.fetch. Required permissions: https://www.googleapis.com/auth/script.external_request
```

Please ensure that the `oauthScopes` in `appsscript.json` includes the following two descriptions (refer to step 2):

```json
"oauthScopes": [
    "https://www.googleapis.com/auth/script.external_request",
    "https://www.googleapis.com/auth/cloud-platform"
  ]
```

If an error occurs:

```php
Exception: Request failed for https://firebaseappdistribution.googleapis.com returned code 401. Truncated server response: {
  "error": {
    "code": 401,
    "message": "Request had invalid authentication credentials. Expected OAuth 2 access token, login cookie or othe... (use muteHttpExceptions option to examine full response)
```

Represents a GCP project that has not been bound yet (refer to Step 1), or the GCP project has not enabled the desired Google APIs, or the current account lacks permission to use the GCP/Google APIs or the Firebase App. Please check the settings.

If an error occurs:

```
Exception: Request failed for https://firebaseappdistribution.googleapis.com returned code 404. Truncated server response:
```

or

```php
Exception: Request failed for https://firebaseappdistribution.googleapis.com returned code 400. Truncated server response: {
  "error": {
    "code": 400,
    "message": "Request contains an invalid argument.",
    "status": "INVALID_ARGUMENT"
  }
}
```

Please verify if the Google APIs request path is correct.

#### Integration Successful 🎉🎉🎉

![](/assets/71400d408dc8/1*9OyoPtblFnGGIBRvlGw10Q.png)

You can see that in less than 10 lines of code, you can seamlessly connect to Google APIs, which is very convenient. For those interested, you can compare it with [implementing it yourself](https://github.com/ZhgChgLi/ZReviewTender/blob/main/lib/GoogleAPI.rb){:target="_blank"}, where the authentication token exchange steps for connecting to Google APIs are quite complicated.

#### Next Steps:

Combined with the previous article "[Using Google Apps Script Web App Form to Connect Github Action CI/CD Workflow](../4cb4437818f2/)", this integrates the CI/CD tasks and displays the Firebase App Distribution download link on the Web App for colleagues to download directly.

![Demo Result](/assets/71400d408dc8/1*nK3H3e3KgHEg8qz-KZ9ZGA.png)

Demo Result

> *Other Google APIs can also be connected in the same way.*

### 2025/07 Update:

This feature has been integrated into the actual packaging tool. You can refer to the latest article case: "[**CI/CD Practical Guide (Part 4): Using Google Apps Script Web App to Connect GitHub Actions for Building a Free and Easy Packaging Tool Platform**](../4273e57e7148/)"

If you have any questions or feedback, feel free to [contact me](https://www.zhgchg.li/contact){:target="_blank"}.

*[Post](https://medium.com/zrealm-robotic-process-automation/google-apps-script-x-google-apis-%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5%E6%95%B4%E5%90%88%E6%96%B9%E5%BC%8F-71400d408dc8){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}.*