---
title: "What? iOS 12 Can Send Push Notifications Without User Authorization (Swift)"
author: "ZhgChgLi"
date: 2018-11-01T15:35:02.255+0000
last_modified_at: 2025-03-06T02:54:46.214+0000
categories: ["ZRealm Dev."]
tags: ["ios","swift","push-notification","ios-app-development","ios12"]
description: "UserNotifications Provisional Authorization temporary permissions, introduction to iOS 12 silent notifications"
image:
  path: /assets/ade9e745a4bf/1*NX0r7q5ikfoJnxWq_eGRWQ.jpeg
render_with_liquid: false
---

### What? iOS 12 Can Send Push Notifications Without User Authorization (Swift) ‚Äî (Updated 2019‚Äì02‚Äì06)

UserNotifications Provisional Authorization temporary permissions, introduction to iOS 12 silent notifications

### MurMur‚Ä¶‚Ä¶

Recently, I made some optimizations to address the low permission and click-through rates for APP push notifications; the initial experience was very poor, as the app would immediately prompt a window asking "The APP wants to send notifications" upon startup. Unsurprisingly, the rejection rate was very high. According to statistics from the previous article using [Notification Service Extension](../cb6eba52a342/), it was estimated that only about 10% of users allowed push notifications.

Currently, the new installation guidance process has been adjusted, and the timing for displaying the notification prompt has been optimized as follows:


![[Marriage APP](https://itunes.apple.com/tw/app/%E7%B5%90%E5%A9%9A%E5%90%A7-%E4%B8%8D%E6%89%BE%E6%9C%80%E8%B2%B4-%E5%8F%AA%E6%89%BE%E6%9C%80%E5%B0%8D/id1356057329?ls=1&mt=8){:target="_blank"}](/assets/ade9e745a4bf/1*Yehjud9-RMPTENiVQz4Ryg.gif)

[Marriage APP](https://itunes.apple.com/tw/app/%E7%B5%90%E5%A9%9A%E5%90%A7-%E4%B8%8D%E6%89%BE%E6%9C%80%E8%B2%B4-%E5%8F%AA%E6%89%BE%E6%9C%80%E5%B0%8D/id1356057329?ls=1&mt=8){:target="_blank"}

If users are still hesitant or want to try the app before deciding whether to receive notifications, they can click "Skip" in the upper right corner to avoid the irreversible result of pressing "Don't Allow" due to unfamiliarity with the app at the beginning.
### Getting to the Point

While working on the above optimization, I discovered that iOS 12 introduced a new permission called .provisional in UserNotifications, which can be understood as temporary notification permission. **You can send push notifications (silent notifications) to users without displaying the notification permission prompt.** Let's look at the actual effects and limitations next.
#### How to Request Temporary Notification Permission?
```swift
if #available(iOS 12.0, *) {
    let center = UNUserNotificationCenter.current()
    let permissiones:UNAuthorizationOptions = [.badge, .alert, .sound, .provisional]
    // You can request only the temporary permission .provisional, or also request all the permissions you need XD
    // None of these will trigger the notification prompt
    
    center.requestAuthorization(options: permissiones) { (granted, error) in
        print(granted)
    }
}
```

We add the above code to AppDelegate didFinishLaunchingWithOptions, and then open the APP, and we will find that the notification prompt does not appear; at this point, we go to **Settings** to check **APP Notification Settings**


![\(Figure 1\) Obtaining Silent Notification Permission](/assets/ade9e745a4bf/1*MvsncOUpTTh-ZTlJAUm8fA.jpeg)

\(Figure 1\) Obtaining Silent Notification Permission

We have quietly obtained silent notification permissionüèÜ

In the part of the program that checks the current push notification permission, we add the authorizationStatus .provisional item (only for iOS 12 and later):
```swift
if #available(iOS 10.0, *) {
    UNUserNotificationCenter.current().getNotificationSettings { (settings) in
        if settings.authorizationStatus == .authorized {
            // Allowed
        } else if settings.authorizationStatus == .denied {
            // Not allowed
        } else if settings.authorizationStatus == .notDetermined {
            // Not asked yet
        } else if #available(iOS 12.0, *) {
            if settings.authorizationStatus == .provisional {
                // Currently has temporary permission
            }
        }
    }
}
```

> **Please note!** If you are making a judgment regarding the current notification authorization status, `settings.authorizationStatus == .notDetermined` and `settings.authorizationStatus == .provisional` 

> both allow for a notification prompt to ask the user whether they permit receiving notifications. 

#### What can silent notifications do? How do push notifications display?

Let's start with a diagram to summarize when silent notifications will be displayed:

![](/assets/ade9e745a4bf/1*BZYhskEdvVLNsFvJV-SWkw.jpeg)

As you can see, if it is a silent push notification, when the app receives the notification in the background state, **it will not show a banner, will not have sound alerts, cannot be marked, will not appear on the lock screen, and will only appear in the notification center when the phone is unlocked**:

![](/assets/ade9e745a4bf/1*Nq6PQhG06BOrX_05i0Jb0g.jpeg)

You can see the push notifications you sent, and they will automatically aggregate into a single category.

**After clicking to expand, the user can choose:**

![This expanded prompt will only appear under silent push notifications when "temporary permissions" are granted](/assets/ade9e745a4bf/1*NX0r7q5ikfoJnxWq_eGRWQ.jpeg)

This expanded prompt will only appear under silent push notifications when "temporary permissions" are granted.
1. To "continue" receiving push notifications ‚Äî "Send important notifications": **Notification permissions will be fully enabled! Notification permissions will be fully enabled! Notification permissions will be fully enabled!** It's really important, so it's mentioned three times; at this point, the earlier code requesting permissions will effectively request all permissions.
   Or maintain receiving silent notifications.
2. "Turn off" ‚Äî "Turn off all notifications" will completely disable push notifications (including silent notifications).

#### Note: How to manually set existing apps to silent notifications?

Silent notifications are a new setting introduced in iOS 12 for optimizing notifications and are unrelated to temporary permissions; it‚Äôs just that the app can send silent notifications once it has temporary permissions. To set an app's notifications to silent is quite simple; one method is to go to "Settings" - "Notifications" - find the app and turn off all permissions, leaving only "Notification Center" (as shown in the first image), which is silent notifications.
Alternatively, when receiving an app notification, press/long press to expand, then click the top right corner "‚Ä¶" to choose to send a silent notification as well:

![](/assets/ade9e745a4bf/1*Lfx_esnpxLQ7GXVoLT710A.gif)

#### With temporary permissions, when the notification prompt is triggered later:

Removing the part that requests notification permissions \.provisional will still allow for normal inquiries to the user about whether to allow receiving notifications:
```swift
if #available(iOS 10.0, *) {
    let center = UNUserNotificationCenter.current()
    let permissiones:UNAuthorizationOptions = [.badge, .alert, .sound]
    center.requestAuthorization(options: permissiones) { (granted, error) in
        print(granted)
    }
}
```

![](/assets/ade9e745a4bf/1*Bu6H1GZPWUoAd1oSfdYi5w.jpeg)

Press "Allow" to obtain all notification permissions, or press "Don't Allow" to turn off all notification permissions (including the originally obtained silent notification permissions).
#### Overall process is as follows:

![](/assets/ade9e745a4bf/1*--o4wB9gSZ3y661GiZfEEg.jpeg)

#### Summary:

This thoughtful optimization of notifications in iOS 12 makes it easier for users and developers to establish an interactive bridge regarding notification functionality, helping to avoid situations where notifications are turned off permanently.

For users, when the notification prompt appears, they often do not know whether to press allow or deny because we do not know what kind of notifications the developer will send us; it could be advertisements or important messages. The unknown is frightening, so most people will conservatively press deny first.

For developers, we have carefully prepared many items, including important messages to push to users, but due to the aforementioned issues, they get blocked by users, and the effort we put into designing the copy goes to waste!

This feature allows developers to seize the opportunity when users first install the app, design the push process and content well, prioritize pushing items of interest to users, increase users' awareness of notifications from this app, and track push click rates, triggering inquiries to users about whether to receive notifications at the appropriate time.

Although the only exposure is in the **Notification Center**, there is still an opportunity for exposure; from another perspective, if we were users and did not press allow for notifications, if the app could send a bunch of notifications with banners + sounds + appearing on the lock screen, we would probably find it very disruptive and annoying (the other camp is just like XD), Apple's approach strikes a balance between users and developers.

The current issue is probably that... there are still too few iOS 12 users ü§ê
#### Further Reading
- [Handling Push Notification Authorization Status from iOS 9 to iOS 12 (Swift)](../fd7f92d52baa/)
- [iOS Deferred Deep Link Implementation (Swift)](../b08ef940c196/)
- [Using mitmproxy for Man-in-the-Middle Sniffing on iOS+MacOS](../46410aaada00/)
- [iOS 15 / MacOS Monterey Safari will be able to hide real IP](https://medium.com/zrealm-ios-dev/ios-15-macos-monterey-safari-%E5%B0%87%E8%83%BD%E9%9A%B1%E8%97%8F%E7%9C%9F%E5%AF%A6-ip-755a8b6acc35){:target="_blank"}

If you have any questions or suggestions, feel free to [contact me](https://www.zhgchg.li/contact){:target="_blank"}.

_[Post](https://medium.com/zrealm-ios-dev/%E4%BB%80%E9%BA%BC-ios-12-%E4%B8%8D%E9%9C%80%E4%BD%BF%E7%94%A8%E8%80%85%E6%8E%88%E6%AC%8A%E5%B0%B1%E8%83%BD%E6%94%B6%E5%88%B0%E6%8E%A8%E6%92%AD%E9%80%9A%E7%9F%A5-swift-ade9e745a4bf){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}._
