---
title: "What? iOS 12 Can Send Push Notifications Without User Authorization (Swift)"
author: "ZhgChgLi"
date: 2018-11-01T15:35:02.255+0000
last_modified_at: 2025-03-06T02:54:46.214+0000
categories: ["ZRealm Dev."]
tags: ["ios","swift","push-notification","ios-app-development","ios12"]
description: "UserNotifications Provisional Authorization Temporary Permissions, Introduction to iOS 12 Silent Notifications"
image:
  path: /assets/ade9e745a4bf/1*NX0r7q5ikfoJnxWq_eGRWQ.jpeg
render_with_liquid: false
---

### What? iOS 12 Can Send Push Notifications Without User Authorization (Swift) ‚Äî (Updated 2019-02-06)

UserNotifications Provisional Authorization Temporary Permissions, Introduction to iOS 12 Silent Notifications

### MurMur‚Ä¶‚Ä¶

Recently, I made some optimizations to address the low permission and click-through rates for push notifications in the app. The initial experience was very poor; upon installation, the app would immediately prompt the user with a "The app wants to send notifications" dialog. Unsurprisingly, the rejection rate was very high. According to the previous article using [Notification Service Extension](../cb6eba52a342/), the actual display statistics showed that only about 10% of users allowed push notifications.

Currently, I have adjusted the onboarding process for new installations and optimized the interface to change the timing of the notification prompt as follows:

![[Marriage App](https://itunes.apple.com/tw/app/%E7%B5%90%E5%A9%9A%E5%90%A7-%E4%B8%8D%E6%89%BE%E6%9C%80%E8%B2%B4-%E5%8F%AA%E6%89%BE%E6%9C%80%E5%B0%8D/id1356057329?ls=1&mt=8){:target="_blank"}](/assets/ade9e745a4bf/1*Yehjud9-RMPTENiVQz4Ryg.gif)

[Marriage App](https://itunes.apple.com/tw/app/%E7%B5%90%E5%A9%9A%E5%90%A7-%E4%B8%8D%E6%89%BE%E6%9C%80%E8%B2%B4-%E5%8F%AA%E6%89%BE%E6%9C%80%E5%B0%8D/id1356057329?ls=1&mt=8){:target="_blank"}

If users are still hesitant or want to try the app before deciding whether to receive notifications, they can click "Skip" in the upper right corner to avoid the irreversible outcome of pressing "Don't Allow" due to unfamiliarity with the app.
### Getting to the Point

While working on the above optimization, I discovered that iOS 12 introduced a new \.provisional permission in UserNotifications, which can be understood as temporary notification permission. **You can send push notifications (silent notifications) to users without displaying the notification prompt to obtain permission.** Let's take a look at the actual effects and limitations.

#### How to Request Temporary Notification Permission?
```swift
if #available(iOS 12.0, *) {
    let center = UNUserNotificationCenter.current()
    let permissiones:UNAuthorizationOptions = [.badge, .alert, .sound, .provisional]
    // You can request only the temporary permission .provisional, or request all necessary permissions at once XD
    // This will not trigger the notification prompt
    
    center.requestAuthorization(options: permissiones) { (granted, error) in
        print(granted)
    }
}
```

By adding the above code to AppDelegate's didFinishLaunchingWithOptions and then opening the app, you will notice that the notification prompt does not appear. At this point, we can check the **Settings** to view the **App Notification Settings**.

![\(Image 1\) Obtaining Silent Notification Permission](/assets/ade9e745a4bf/1*MvsncOUpTTh-ZTlJAUm8fA.jpeg)

\(Image 1\) Obtaining Silent Notification Permission

We have quietly obtained silent notification permissionüèÜ

In the part of the code that checks the current push notification permission, we add the authorizationStatus \.provisional item (only for iOS 12 and later):
```swift
if #available(iOS 10.0, *) {
    UNUserNotificationCenter.current().getNotificationSettings { (settings) in
        if settings.authorizationStatus == .authorized {
            // Allowed
        } else if settings.authorizationStatus == .denied {
            // Not allowed
        } else if settings.authorizationStatus == .notDetermined {
            // Not asked yet
        } else if #available(iOS 12.0, *) {
            if settings.authorizationStatus == .provisional {
                // Currently has temporary permission
            }
        }
    }
}
```

> **Please Note!** If you are checking the current notification permission status, `settings.authorizationStatus == .notDetermined` and `settings.authorizationStatus == .provisional` 

> Both can still trigger the notification prompt to ask the user whether to allow notifications. 

#### What Can Silent Notifications Do? How Do Push Notifications Appear?

Let's first take a look at when silent notifications will be displayed:

![](/assets/ade9e745a4bf/1*BZYhskEdvVLNsFvJV-SWkw.jpeg)

You can see that if it is a silent push notification, when the app receives the notification in the background state, **it will not display a banner, will not have sound alerts, cannot be marked, will not appear on the lock screen, and will only show up in the notification center when the phone is unlocked**:

![](/assets/ade9e745a4bf/1*Nq6PQhG06BOrX_05i0Jb0g.jpeg)

You can see the push notifications you sent, and they will automatically aggregate into one category.

**When clicked to expand, users can choose:**

![This expanded prompt will only appear under "Temporary Permission" for silent push notifications](/assets/ade9e745a4bf/1*NX0r7q5ikfoJnxWq_eGRWQ.jpeg)

This expanded prompt will only appear under "Temporary Permission" for silent push notifications.
1. To "Continue" receiving push notifications ‚Äî "Send Important Notifications": **Notification permissions will be fully enabled! Notification permissions will be fully enabled! Notification permissions will be fully enabled!** It's really important, so I mentioned it three times. At this point, the effect of the previous code requesting permissions will be significant.
Or maintain receiving silent notifications.
2. "Turn Off" ‚Äî "Turn Off All Notifications" will completely disable push notifications (including silent notifications).

#### Note: How to Manually Set Existing Apps to Silent Notifications?

Silent notifications are a new setting introduced in iOS 12 for notification optimization and are unrelated to temporary permissions. However, if the app has temporary permissions, it can send silent notifications. To set an app's notifications to silent, one method is to go to "Settings" - "Notifications" - find the app and turn off all permissions, leaving only "Notification Center" (as shown in Image 1), which will result in silent notifications.
Alternatively, when receiving app notifications, you can long-press to expand and click the upper right corner "‚Ä¶" to choose to send silent notifications as well:

![](/assets/ade9e745a4bf/1*Lfx_esnpxLQ7GXVoLT710A.gif)

#### With Temporary Permissions, When the Notification Prompt is Triggered Later:

You can remove \.provisional from the notification permission request, and it will still ask the user whether to allow notifications:
```swift
if #available(iOS 10.0, *) {
    let center = UNUserNotificationCenter.current()
    let permissiones:UNAuthorizationOptions = [.badge, .alert, .sound]
    center.requestAuthorization(options: permissiones) { (granted, error) in
        print(granted)
    }
}
```

![](/assets/ade9e745a4bf/1*Bu6H1GZPWUoAd1oSfdYi5w.jpeg)

Press "Allow" to obtain all notification permissions, or press "Don't Allow" to turn off all notification permissions (including the previously obtained silent notification permission).
#### Overall Process:

![](/assets/ade9e745a4bf/1*--o4wB9gSZ3y661GiZfEEg.jpeg)

#### Summary:

This thoughtful optimization of notifications in iOS 12 makes it easier for users and developers to interact regarding notification functionality, helping to avoid the irreversible situation of users turning off notifications.

For users, when the notification prompt appears, they often don't know whether to press allow or deny because they are unsure what kind of notifications the developer will send. It could be advertisements or important messages; the unknown can be frightening, so most people tend to conservatively press deny.

For developers, we have carefully prepared many items, including important messages to push to users, but due to the above issues, users may block them, rendering our carefully designed content wasted!

This feature allows developers to seize the opportunity when users first install the app, design a good push process and content, prioritize pushing items of interest to users, increase their awareness of notifications from this app, and track push click rates, triggering the prompt to ask users whether to receive notifications at the appropriate time.

Although the exposure is limited to the **Notification Center**, there is still an opportunity for exposure; from another perspective, if we were users and did not press allow notifications, if the app could send a bunch of notifications with banners + sounds + appearing on the lock screen, it would likely be very disruptive and annoying (the other camp is like XD). Apple's approach strikes a balance between users and developers.

The current issue is that... there are still too few iOS 12 users ü§ê
#### Further Reading
- [Handling Push Notification Permission Status from iOS 9 to iOS 12 (Swift)](../fd7f92d52baa/)
- [iOS Deferred Deep Link Implementation (Swift)](../b08ef940c196/)
- [Using mitmproxy for Man-in-the-Middle Sniffing on iOS+MacOS](../46410aaada00/)
- [iOS 15 / MacOS Monterey Safari Will Be Able to Hide Real IP](https://medium.com/zrealm-ios-dev/ios-15-macos-monterey-safari-%E5%B0%87%E8%83%BD%E9%9A%B1%E8%97%8F%E7%9C%9F%E5%AF%A6-ip-755a8b6acc35){:target="_blank"}

If you have any questions or suggestions, feel free to [contact me](https://www.zhgchg.li/contact){:target="_blank"}.

_[Post](https://medium.com/zrealm-ios-dev/%E4%BB%80%E9%BA%BC-ios-12-%E4%B8%8D%E9%9C%80%E4%BD%BF%E7%94%A8%E8%80%85%E6%8E%88%E6%AC%8A%E5%B0%B1%E8%83%BD%E6%94%B6%E5%88%B0%E6%8E%A8%E6%92%AD%E9%80%9A%E7%9F%A5-swift-ade9e745a4bf){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}._