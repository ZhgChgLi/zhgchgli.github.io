---
title: "Converting Medium Posts to Markdown"
author: "ZhgChgLi"
date: 2022-05-28T07:04:35.424+0000
last_modified_at: 2024-04-14T02:04:46.187+0000
categories: ["ZRealm Dev."]
tags: ["medium","markdown","backup","ruby","automation"]
description: "A tool to back up heartfelt Medium articles and convert them into Markdown format"
image:
  path: /assets/ddd88a84e177/1*neA7oRVPqHxs6XqtZTKmDg.jpeg
render_with_liquid: false
---

### Converting Medium Posts to Markdown

A tool to back up heartfelt Medium articles and convert them into Markdown format



![[ZhgChgLi](https://github.com/ZhgChgLi){:target="_blank"} / [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}](/assets/ddd88a84e177/1*neA7oRVPqHxs6XqtZTKmDg.jpeg)

[ZhgChgLi](https://github.com/ZhgChgLi){:target="_blank"} / [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}
### \[EN\] [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}

I’ve written a project to let you download Medium posts and convert them to markdown format easily\.
#### Features
- Support downloading posts and converting to markdown format
- Support downloading all posts and converting to markdown format from any user without login access\.
- Support downloading paid content
- Support downloading all of the post’s images to local and converting to local path
- Support parsing Twitter tweet content to blockquote
- Support downloading paid content
- Support command line interface
- Convert [Gist](https://gist.github.com/){:target="_blank"} source code to markdown code block
- Convert YouTube links embedded in posts to preview images
- Adjust post’s last modification date from Medium to the locally downloaded markdown file
- Auto skip when a post has been downloaded and the last modification date from Medium hasn’t changed \(convenient for auto\-sync or auto\-backup service, to save server’s bandwidth and execution time\)
- [Support using Github Action as auto sync/backup service](https://github.com/ZhgChgLi/ZMediumToMarkdown/tree/main#using-github-action-as-your-free-auto-syncbackup-service){:target="_blank"}
- Highly optimized markdown format for Medium
- Native Markdown Style Render Engine \(Feel free to contribute if you have any optimization ideas\! `MarkupStyleRender.rb` \)
- [jekyll](https://jekyllrb.com/){:target="_blank"} & social share \(og: tag\) friendly
- 100% Ruby @ [RubyGem](https://rubygems.org/gems/ZMediumToMarkdown){:target="_blank"}

```markdown
[![](https://repository-images.githubusercontent.com/493527574/9b5b7025-cc95-4e81-84a9-b38706093c27)](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}

### \[EN\] [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}

A small tool that can crawl the content of Medium article links and all articles by Medium users, converting them into Markdown format and downloading them along with the images in the articles as a backup.
#### \[2022/07/18 Update\]: [A Step-by-Step Guide to Seamlessly Transfer Medium to Your Self-Hosted Website](../a0c08d579ab1/)
#### Key Features
- No login or special permissions required
- Supports downloading and converting individual articles and all articles by a user into Markdown
- Supports downloading and backing up all images within articles and converting them to corresponding image paths
- Supports deep parsing of embedded [Gist](https://gist.github.com/){:target="_blank"} within articles and converting them into relative language Markdown Code Blocks
- Supports parsing Twitter content and reposting it in articles
- Supports parsing embedded YouTube videos, converting them into video preview images and links displayed in Markdown
- When downloading all articles by a user, it scans for any embedded related articles and replaces links with local ones if found
- Specially optimized for Medium's formatting styles
- Automatically changes the last modified/created time of downloaded articles to match the publication time of the corresponding Medium articles
- Automatically compares the last modified time of downloaded articles; if it is not less than the last modified time of the Medium article, it skips the download
\(This feature is convenient for users to create an automatic Sync/Backup tool, saving server traffic/time\)
- CLI operation, supports automation

[![](https://repository-images.githubusercontent.com/493527574/9b5b7025-cc95-4e81-84a9-b38706093c27)](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}

> **_This project and this article are for technical research purposes only. Please do not use it for any commercial purposes or illegal activities. The author is not responsible for any illegal actions taken by anyone using this._**

> **_Please ensure you have the rights to use and download backups of the articles._**

### Origin

After running Medium for three years, I have published over 65 articles; all articles were written directly on the Medium platform without any other backups. Honestly, I have always been worried that issues with the Medium platform or other factors could cause the culmination of my efforts over the years to disappear.

I previously backed up manually, which was very tedious and time-consuming, so I have been looking for a tool that can automatically back up all articles and ideally convert them into Markdown format.
### Backup Requirements
- Markdown format
- Automatically download all Medium posts of a user
- Article images must also be downloadable for backup
- Must be able to parse Gist into Markdown Code Blocks
\(My Medium heavily uses Gist to embed source code, so this feature is very important\)

### Backup Solutions
#### Official Medium

Although the official Medium provides an export backup feature, the export format can only be used for importing into Medium, not Markdown or common formats, and it does not handle embedded content like [Github Gist](https://gist.github.com/){:target="_blank"}.

The [API](https://github.com/Medium/medium-api-docs){:target="_blank"} provided by Medium is not well maintained and only offers the Create Post functionality.

> **_This is reasonable, as Medium does not want users to easily transfer content to other platforms._**

#### Chrome Extension

I found and tried several Chrome Extensions (most of which have been removed), but the results were poor. One issue is that you have to manually click into each article to back it up, and the parsed format has many errors and cannot deeply parse Gist source code or back up all images in the articles.
#### [medium\-to\-markdown command line](https://www.npmjs.com/package/medium-to-markdown){:target="_blank"}
```


A certain expert wrote this in JS, achieving basic download and conversion to Markdown functionality, but it still lacks image backup and deep parsing of Gist source code.
#### [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}

After struggling to find a perfect solution, I decided to write a backup conversion tool myself; it took about three weeks of after-work time to complete it using Ruby.
#### Technical Details

**How to get the article list by inputting the username?**

1. Obtain UserID: By viewing the source code of the user’s homepage \(https://medium\.com/@\# \{username\} \), you can find the `Username` corresponding to the `UserID`. 
   [Note that Medium has reopened custom domains](../d9a95d4224ea/), so you need to handle 30X redirects.

2. By sniffing network requests, you can discover that Medium uses GraphQL to obtain the article list information from the homepage.

3. Copy the Query & replace UserID in the request information.
```
HOST: https://medium.com/_/graphql
METHOD: POST
```

4. Obtain Response

You can only retrieve 10 items at a time, so pagination is necessary.
- Article list: You can find it in `result[0]->userResult->homepagePostsConnection->posts`.
- `homepagePostsFrom` pagination information: You can find it in `result[0]->userResult->homepagePostsConnection->pagingInfo->next`.
Pass `homepagePostsFrom` into the request to access pagination; `nil` indicates there are no more pages.

**How to parse the article content?**

After inspecting the article's source code, it can be found that Medium uses [Apollo Client](https://www.apollographql.com/docs/react/){:target="_blank"} for its service; the actual HTML is rendered from JS. Therefore, you can check the `<script>` section in the source code to find the `window.__APOLLO_STATE__` field, which contains the structure of the entire article's paragraphs. Medium breaks down the entire article into individual paragraphs and then renders it back to HTML through the JS engine.

![](/assets/ddd88a84e177/1*mH8iq7W-pJZrMBPpEyN6Zw.png)

What we need to do is similar: parse this JSON, compare the types with Markdown styles, and assemble the Markdown format.
#### Technical Challenges

There is a technical challenge in rendering paragraph text styles, as the structure provided by Medium is as follows:
```json
"Paragraph": {
    "text": "code in text, and link in text, and ZhgChgLi, and bold, and I, only i",
    "markups": [
      {
        "type": "CODE",
        "start": 5,
        "end": 7
      },
      {
        "start": 18,
        "end": 22,
        "href": "http://zhgchg.li",
        "type": "LINK"
      },
      {
        "type": "STRONG",
        "start": 50,
        "end": 63
      },
      {
        "type": "EM",
        "start": 55,
        "end": 69
      }
    ]
}
```

This means that for the text `code in text, and link in text, and ZhgChgLi, and bold, and I, only i`:
```
- Characters 5 to 7 should be marked as code (wrapped in `Text` format)
- Characters 18 to 22 should be marked as a link (wrapped in [Text](URL) format)
- Characters 50 to 63 should be marked as bold (wrapped in *Text* format)
- Characters 55 to 69 should be marked as italic (wrapped in _Text_ format)
```

Characters 5 to 7 & 18 to 22 are easy to handle in this example, as they do not overlap; however, 50–63 & 55–69 will have overlapping issues, as Markdown cannot represent the following overlapping format:
```markdown
code `in` text, and [link](http://zhgchg.li) in text, and ZhgChgLi, and **bold,_ and I, **only i_
```

The correct combination result is as follows:
```markdown
code `in` text, and [ink](http://zhgchg.li) in text, and ZhgChgLi, and **bold,_ and I, _**_only i_
```

50–55 STRONG 55–63 STRONG, EM 63–69 EM

Additionally, please note:
- The string at the beginning and end of the packaging format should be distinguishable. Strong just happens to have both the start and end as `**`, while for Links, the start will be `[` and the end will be `](URL)`
- When Markdown symbols are combined with strings, be careful that there are no spaces before or after, otherwise it will be invalid.

[For the complete question, please see this.](https://gist.github.com/zhgchgli0718/e8a91e81053563bd9f40da9c780fd2f6){:target="_blank"}

I have researched this for a long time, and for now, I am using an existing package to solve it: [reverse\_markdown](https://github.com/xijo/reverse_markdown){:target="_blank"}.

> **_Special thanks to former colleagues [Nick](https://medium.com/u/d713969ca7ed){:target="_blank"}, [Chun\-Hsiu Liu](https://medium.com/u/72361fccaa43){:target="_blank"}_** _,James **for their collaborative research. I will write my own version in native code when I have time.**_

### Results

[Original text](../78507a8de6a5/) \-&gt; [Converted Markdown result](https://github.com/ZhgChgLi/ZMediumToMarkdown/blob/main/example/2021-01-31-avplayer-%E5%AF%A6%E8%B8%90%E6%9C%AC%E5%9C%B0-cache-%E5%8A%9F%E8%83%BD%E5%A4%A7%E5%85%A8-6ce488898003.md){:target="_blank"}

If you have any questions or suggestions, feel free to [contact me](https://www.zhgchg.li/contact){:target="_blank"}.

_[Post](https://medium.com/zrealm-ios-dev/converting-medium-posts-to-markdown-ddd88a84e177){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}._
