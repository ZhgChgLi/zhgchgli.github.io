---
author: ZhgChgLi
categories:
- ZRealm Dev.
date: 2018-10-17T15:20:35.448+0000
description: Discover how iOS developers leverage CoreML 2.0 to train and convert
  machine learning models, enabling automatic article classification and seamless
  integration into real-world apps for improved accuracy and efficiency.
image:
  path: /assets/793bf2cdda0f/1*pOYPHRwPNLVtikVKzfIqsw.png
last_modified_at: 2024-04-13T07:17:02.794+0000
render_with_liquid: false
tags:
- english
- swift
- ios
- machine learning
- natural language processing
- ios app development
title: CoreML 2.0ÔΩúAutomate Article Classification with Custom-Trained Machine Learning
  Models
---

### Experience iOS 12 CoreML ‚Äî Use Machine Learning to Automatically Predict Article Categories, and Train the Model Yourself!

Exploring CoreML 2.0: How to Convert or Train Models and Apply Them in Real Products

Continuing from the [previous article](../9a9aa892f9a9/) on using machine learning on iOS, this article officially begins with using CoreML.

First, a brief history: Apple released the CoreML machine learning framework (including Vision introduced in the previous article) in 2017. In 2018, they followed up with CoreML 2.0, which not only improved [performance](https://www.appcoda.com.tw/core-ml-2/){:target="_blank"} but also supported **custom CoreML models**.

#### Preface

If you have only heard the term "machine learning" but don't know what it means, here is a simple explanation in one sentence:

> **"Predicting the outcome of the same event based on your past experience"**

> For example: When I eat an egg pancake, I add ketchup. After buying it a few times, the breakfast shop owner remembers and asks, "Handsome, ketchup?" I answer, "Yes" ‚Äî the owner predicts correctly. If I answer, "No, because it's radish cake + egg pancake" ‚Äî the owner remembers and corrects the question the next time the same situation occurs.

> Input data: egg pancake, cheese egg pancake, egg pancake + radish cake, radish cake, egg

> Output data: Add ketchup / Do not add ketchup

> Model: The Landlady's Memory and Judgment

Actually, my understanding of machine learning is mostly limited to knowing the basic concepts and theories, but I haven't studied it in depth. Please kindly correct me if there are any mistakes.

Speaking of which, I have to pay tribute üõê to the Apple gods for productizing machine learning. As long as you know the basic concepts, you can operate it without a vast knowledge base, lowering the entry barrier. I myself only felt a real connection to machine learning after implementing this example, which sparked a strong interest in the field.

#### Start

The first step, and the most important, is of course the "model" mentioned earlier. Where does the model come from?

There are three methods:

- Find pre-trained models online and convert them to CoreML format

[Awesome-CoreML-Models](https://github.com/likedan/Awesome-CoreML-Models){:target="_blank"} This GitHub project collects many pre-trained models from others.

Model conversion can refer to the [official website](https://developer.apple.com/machine-learning/build-run-models/){:target="_blank"} or online resources.

- At the bottom of Apple's [Machine Learning official website](https://developer.apple.com/machine-learning/build-run-models/){:target="_blank"}, under Download Core ML Models, you can download models trained by Apple (mainly for learning or testing purposes).

- **Train Your Own Model Using Tools üèÜ**

#### So, what can be done?

- Image Recognition **üèÜ**

- **Text Content Recognition and Classification üèÜ**

- Word Segmentation

- Text Language Detection

- Named Entity Recognition

For word segmentation, please refer to [Natural Language Processing in iOS Apps: An Introduction to NSLinguisticTagger](https://www.appcoda.com.tw/nslinguistictagger/){:target="_blank"}

### Today's Key Points ‚Äî Text Content Recognition and Classification + **Training Your Own Model**

Simply put, we provide the machine with "text content" and "categories" to train the computer to classify future data. For example: "Click to see the latest offers!" and "Get $1000 shopping credit now" => "Advertisement"; "Alan sent you a message" and "Your account is about to expire" => "Important matters"

Practical Applications: Spam Detection, Tag Generation, Classification Prediction

*p.s Since I haven't figured out what to train the image recognition for, I haven't explored it yet; interested friends can check out [this article](https://www.jianshu.com/p/28ed4eff68d1){:target="_blank"}, the official GUI training tool for images is very convenient!!*

**Required Tools:** MacOS Mojave‚¨Ü + Xcode 10

**Training Tool:** [BlankSpace007/TextClassiferPlayground](https://github.com/BlankSpace007/TextClassiferPlayground){:target="_blank"} (The official version only provides a **GUI training tool for images**; text training requires coding yourself. This is a third-party tool offered by an expert online.)

#### Prepare Training Data:

![The data structure is shown above, supporting .json and .csv files](/assets/793bf2cdda0f/1*bqKGHErvqhd6gIKCnvve4Q.png)

The data structure is as shown in the above image, supporting .json and .csv files.

Prepare the data for training. Here, we use Phpmyadmin (MySQL) to export the training data.

```sql
SELECT `title` AS `text`,`type` AS `label` FROM `posts` WHERE `status` = '1'
```

![Change export method to JSON format](/assets/793bf2cdda0f/1*fc10j10OzmI2TGemaqlDmw.png)

Change the export format to JSON

```json
[
  {"type":"header","version":"4.7.5","comment":"Export to JSON plugin for PHPMyAdmin"},
  {"type":"database","name":"db"},
  {"type":"table","name":"posts","database":"db","data":
    //Remove above
    [
      {
         "label":"",
         "text":""
      }
    ]
    //Remove below
  }
]
```

Open the recently downloaded JSON file and keep only the content inside the DATA structure.

#### Training Tools Used:

After downloading the training tools, click TextClassifier.playground to open the Playground

![Click the red box to execute -> Click the green box to switch View display](/assets/793bf2cdda0f/1*ct9AHpetBuEKHDGfRwvMlg.png)

Click the red box to execute -> Click the green box to switch the View display

![Drag the JSON file into the GUI tool](/assets/793bf2cdda0f/1*kV_Dh2pP94gUakcmYcI6bQ.png)

Drag the JSON file into the GUI tool

![Open the Console below to check the training progress. Seeing the line "Test Accuracy" means the model training is complete.](/assets/793bf2cdda0f/1*NIyGqbNaArovIDEPK6Ynhg.png)

Open the Console below to check the training progress. Seeing the line "Test Accuracy" means the model training is complete.

If there is too much data, it will test your computer's processing power.

![After filling in the basic information, click "Save"](/assets/793bf2cdda0f/1*-jN91i4v0ijo6_qkCH1qwg.png)

After filling in the basic information, click "Save"

Save the trained model file

![](/assets/793bf2cdda0f/1*ML0yNr3NzRwGfBjIBzCfpg.png)

![CoreML model file](/assets/793bf2cdda0f/1*WWg3yfrgNastu0U20iiCUQ.png)

CoreML Model File

Your model is now fully trained! Wasn't that easy?

**Specific Training Methods:**

1. First, perform word segmentation on the input sentence (e.g., "ÊàëÊÉ≥Áü•ÈÅìÂ©öÁ¶ÆÈúÄË¶ÅÊ∫ñÂÇô‰ªÄÈ∫º" => "ÊàëÊÉ≥", "Áü•ÈÅì", "Â©öÁ¶Æ", "ÈúÄË¶Å", "Ê∫ñÂÇô", "‰ªÄÈ∫º"), then determine its category and carry out a series of machine learning computations.

2. Group the training data, for example: 80% is used for training and the other 20% is used for testing and validation.

Up to this point, most of the work is done. Next, just add the model file to the iOS project and write a few lines of code.

![Drag and drop the model file (*.mlmodel) into the project](/assets/793bf2cdda0f/1*4Uc1elBmhEnQ-J8z_RIQHQ.png)

Drag and drop or add the model file (*.mlmodel) into the project

#### Code Section:

```swift
import CoreML

//
if #available(iOS 12.0, *), let prediction = try? textClassifier().prediction(text: "Text content to predict") {
    let type = prediction.label
    print("I think it is... \(type)")
}
```

**Completed!**

#### Questions to Explore:

1. Can it support further learning?

2. Can the mlmodel file be converted to other platforms?

3. Can you train models on iOS?

The above three points have all been found to be unfeasible based on current information.

#### Conclusion:

Currently, I apply it in practical apps to predict the category when posting articles.

![[ÁµêÂ©öÂêßAPP](https://itunes.apple.com/tw/app/%E7%B5%90%E5%A9%9A%E5%90%A7-%E4%B8%8D%E6%89%BE%E6%9C%80%E8%B2%B4-%E5%8F%AA%E6%89%BE%E6%9C%80%E5%B0%8D/id1356057329?ls=1&mt=8){:target="_blank"}](/assets/793bf2cdda0f/1*pOYPHRwPNLVtikVKzfIqsw.png)

[Marry Me APP](https://itunes.apple.com/tw/app/%E7%B5%90%E5%A9%9A%E5%90%A7-%E4%B8%8D%E6%89%BE%E6%9C%80%E8%B2%B4-%E5%8F%AA%E6%89%BE%E6%9C%80%E5%B0%8D/id1356057329?ls=1&mt=8){:target="_blank"}

I only have about 100 training data points, and the current prediction accuracy is around 35%. This is mainly for experimental purposes.

‚Äî ‚Äî ‚Äî ‚Äî ‚Äî

It's that simple‚Äîcompleting the first machine learning project in life; there is still a long way to go to learn how the background works. I hope this project can inspire everyone!

Reference: [WWDC2018 Create ML (Part 2)](https://www.jianshu.com/p/205ee896663f){:target="_blank"}

If you have any questions or feedback, feel free to [contact me](https://www.zhgchg.li/contact){:target="_blank"}.

*[Post](https://medium.com/zrealm-ios-dev/%E5%9A%90%E9%AE%AE-ios-12-coreml-%E4%BD%BF%E7%94%A8%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92%E8%87%AA%E5%8B%95%E9%A0%90%E6%B8%AC%E6%96%87%E7%AB%A0%E5%88%86%E9%A1%9E-%E9%80%A3%E6%A8%A1%E5%9E%8B%E4%B9%9F%E8%87%AA%E5%B7%B1%E8%A8%93%E7%B7%B4-793bf2cdda0f){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}.*