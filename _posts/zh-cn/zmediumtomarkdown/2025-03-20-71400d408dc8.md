---
author: ZhgChgLi
categories:
- ZRealm Robotic Process Automation
date: 2025-03-20T14:12:48.523+0000
description: ä»¥ Google Apps Script x Firebase App Distribution API ä¸²æ¥ä¸ºä¾‹
image:
  path: /assets/71400d408dc8/1*O6JWKIIS5oxyrOS3q9NXRQ.png
last_modified_at: 2025-07-10T13:00:24.208+0000
render_with_liquid: false
tags:
- ios-app-development
- firebase-app-distribution
- google-apps-script
- google-api
- google-cloud-platform
title: Google Apps Script x Google APIs å¿«é€Ÿä¸²æ¥æ•´åˆæ–¹å¼
---

### Google Apps Script x Google APIs å¿«é€Ÿä¸²æ¥æ•´åˆæ–¹å¼



ä»¥ Google Apps Script x Firebase App Distribution API ä¸²æ¥ä¸ºä¾‹



### èƒŒæ™¯



ä¹‹å‰å†™äº†ä¹‹å‰å†™äº†å¥½å‡ ç¯‡å…³äºä½¿ç”¨ Google Apps Script çš„æ–‡ç« ï¼Œå…¶ä¸­ã€Œ [ä½¿ç”¨ Google Apps Script å®ç°æ¯æ—¥æ•°æ®æŠ¥è¡¨ RPA è‡ªåŠ¨åŒ–](../f6713ba3fee3/) ã€ã€ã€Œ [ç®€å• 3 æ­¥éª¤ â€” æ‰“é€ å…è´¹ GA4 è‡ªåŠ¨æ•°æ®é€šçŸ¥æœºå™¨äºº](../1e85b8df2348/) ã€ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ Google Apps Script ä¸²æ¥ Google Analytics å’Œ Google Sheet, Web App, Slack, Telegramâ€¦ å¿«é€Ÿå»ºç½®å¯è§†åŒ–æ•°æ®ä¸­å°åŠé€šçŸ¥æœåŠ¡ï¼›å¦å¤–ä¸Šä¸ªæœˆå‘çš„æ–‡ç« ã€Œ [ä½¿ç”¨ Google Apps Script Web App è¡¨å•ä¸²æ¥ Github Action CI/CD å·¥ä½œ](../4cb4437818f2/) ã€åˆ™æ˜¯ç›´æ¥ä½¿ç”¨ Google Apps Script Web App ä¸²æ¥ Github API ä½œä¸º CI/CD GUI è¡¨å•æœåŠ¡ï¼›ä»¥ä¸Šè¦é©¬æ˜¯ç›´æ¥ä½¿ç”¨ Google Apps Script å†…å»ºçš„æœåŠ¡è¿›è¡Œä¸²æ¥æˆ–æ˜¯ç›´æ¥ä¸²æ¥å¤–éƒ¨æœåŠ¡ (Slack, Githubâ€¦) éƒ½æ²¡ç¢°åˆ°éœ€è¦ä¸²æ¥ Google APIs çš„åœºæ™¯ã€‚



> *è¿™æ¬¡åœ¨ä¼˜åŒ– CI/CD GUI è¡¨å•æ—¶å¸Œæœ›æ‰“åŒ…å†…æµ‹ç‰ˆåèƒ½åœ¨ Web App ä¸Šç›´æ¥æ˜¾ç¤º Firebase Distribution ä¸‹è½½è¿ç»“ï¼Œè¿™å—å°±åªèƒ½ä¸²æ¥ Google APIs æ‰èƒ½è¾¾æˆã€‚*



#### Google Apps Script x [Firebase App Distribution API v1](https://firebase.google.com/docs/reference/app-distribution/rest/){:target="_blank"}



![](/assets/71400d408dc8/1*O6JWKIIS5oxyrOS3q9NXRQ.png)



å¦‚ä¸Šå›¾ï¼Œä¸ä»¥å¾€ä¸²æ¥ Google Analytics æœ‰å†…å»ºæœåŠ¡ã€ŒAnalyticsDataã€ä¸åŒï¼ŒFirebase App Distribution å¹¶æ²¡æœ‰æä¾›å†…å»ºä¸²æ¥æœåŠ¡ï¼Œæ‰€ä»¥è¦ç”¨è¿›é˜¶æ–¹å¼è¿›è¡Œä¸²æ¥ã€‚



> *æœ¬æ¥ä»¥ä¸ºè¦è‡ªè¡Œä½¿ç”¨ Service Account å®Œæˆ Access Token äº§ç”Ÿã€äº¤æ¢ï¼ˆæœ‰ç‚¹éº»çƒ¦ï¼Œå¯å‚è€ƒæˆ‘ä¹‹å‰çš„ [è¯„ä»·æœºå™¨äººå¼€æºä¸“æ¡ˆ](https://github.com/ZhgChgLi/ZReviewTender/blob/main/lib/GoogleAPI.rb){:target="_blank"} ï¼‰ï¼Œ **ä½†å…¶å®ä¸ç”¨è¿™ä¹ˆéº»çƒ¦ã€‚***



### Google Apps Script x Google APIs è¿›é˜¶æœåŠ¡ä¸²æ¥



#### ä¸²æ¥è®¾å®š



**å‚è€ƒ [å®˜æ–¹æ–‡ä»¶æè¿°](https://developers.google.com/apps-script/guides/services/advanced?hl=zh-tw#requirements){:target="_blank"} ï¼Œæˆ‘ä»¬éœ€è¦ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œè¿›é˜¶è®¾å®šï¼š**



1. æ‚¨å¿…é¡»åœ¨æŒ‡ä»¤ç ä¸“æ¡ˆä¸­ [å¯ç”¨è¿›é˜¶æœåŠ¡](https://developers.google.com/apps-script/guides/services/advanced?hl=zh-tw#enable_advanced_services){:target="_blank"} ã€‚


2. æ‚¨å¿…é¡»ç¡®è®¤åœ¨æŒ‡ä»¤ç ä½¿ç”¨çš„ [Cloud Platform (GCP) ä¸“æ¡ˆ](https://developers.google.com/apps-script/guides/cloud-platform-projects?hl=zh-tw){:target="_blank"} ä¸­ï¼Œå·²å¯ç”¨å¯¹åº”è¿›é˜¶æœåŠ¡çš„ APIã€‚


3. å¦‚æœæŒ‡ä»¤ç ä¸“æ¡ˆä½¿ç”¨çš„æ˜¯ 2019 å¹´ 4 æœˆ 8 æ—¥å½“å¤©æˆ–ä¹‹åå»ºç«‹çš„ [é¢„è®¾ GCP ä¸“æ¡ˆ](https://developers.google.com/apps-script/guides/cloud-platform-projects?hl=zh-tw#default_cloud_platform_projects){:target="_blank"} ï¼Œæ‚¨å¯ç”¨è¿›é˜¶æœåŠ¡å¹¶å‚¨å­˜æŒ‡ä»¤ç ä¸“æ¡ˆåï¼ŒAPI å°±ä¼šè‡ªåŠ¨å¯ç”¨ã€‚å¦‚æœæ‚¨å°šæœªåŒæ„ï¼Œç³»ç»Ÿå¯èƒ½ä¹Ÿä¼šè¦æ±‚æ‚¨åŒæ„ã€Š [Google Cloud](https://cloud.google.com/terms/?hl=zh-tw){:target="_blank"} ã€‹å’Œã€Š [Google API](https://developers.google.com/terms?hl=zh-tw){:target="_blank"} ã€‹æœåŠ¡æ¡æ¬¾ã€‚


4. å¦‚æœæŒ‡ä»¤ç ä¸“æ¡ˆä½¿ç”¨ [æ ‡å‡† GCP ä¸“æ¡ˆ](https://developers.google.com/apps-script/guides/cloud-platform-projects?hl=zh-tw#standard_cloud_platform_projects){:target="_blank"} æˆ–è¾ƒæ—§çš„é¢„è®¾ GCP ä¸“æ¡ˆï¼Œæ‚¨å¿…é¡»æ‰‹åŠ¨åœ¨ GCP ä¸“æ¡ˆä¸­ [å¯ç”¨è¿›é˜¶æœåŠ¡çš„å¯¹åº” API](https://developers.google.com/apps-script/guides/cloud-platform-projects?hl=zh-tw#enabling_an_api_in_a_standard_gcp_project){:target="_blank"} ã€‚æ‚¨å¿…é¡»å…·å¤‡ GCP ä¸“æ¡ˆçš„ç¼–è¾‘æƒé™ï¼Œæ‰èƒ½è¿›è¡Œè¿™é¡¹å˜æ›´ã€‚



#### 1. ä¸“æ¡ˆè®¾å®š â€”è®¾å®šå…³è”çš„ Google Cloud Platform (GCP) ä¸“æ¡ˆ



Google Apps Script x Google APIs è¿›é˜¶æœåŠ¡ä¸²æ¥ä¼šéœ€è¦ä½ å»ºç«‹ GCP ä¸“æ¡ˆå¹¶å…³è”åˆ° Google Apps Scriptï¼ŒGoogle APIs ä½¿ç”¨æƒé™æ˜¯ä¾ç…§ GCP è®¾å®šã€‚



å› æ­¤ä½ éœ€è¦å»ºç«‹ä¸€ä¸ª GCP ä¸“æ¡ˆ(åŒ Firebase GCP ä¸“æ¡ˆäº¦å¯)ï¼Œè®°ä¸‹èµ„è®¯ä¸»é¡µçš„ã€Œ `ä¸“æ¡ˆç¼–å·` ã€å¹¶ç¡®å®šè¿™ä¸ª GCP ä¸“æ¡ˆæœ‰å¯ç”¨ä½ æƒ³ä½¿ç”¨çš„ Google APIs åŠå½“å‰ç™»å…¥å¸å·æˆ–æ¬²ä½¿ç”¨çš„å¸å·æ˜¯æœ‰è¯¥ GCP ä¸“æ¡ˆã€Google APIs æƒé™ã€‚



![](/assets/71400d408dc8/1*-BlhyGAEtkcDRrZ86H2BHg.png)



![](/assets/71400d408dc8/1*fycqt1HNNO9qiu6RZ-WMlw.png)



> ***æœ¬æ–‡ä»¥ã€Œ [Firebase App Distribution API](https://firebase.google.com/docs/reference/app-distribution/rest/){:target="_blank"} ã€ä¸ºä¾‹ã€‚***



![](/assets/71400d408dc8/1*T13M_lq7z-ui0_cLZtuHXg.png)



å°† `ä¸“æ¡ˆç¼–å·` è¾“å…¥åˆ° Goolge Apps Script ä¸“æ¡ˆè®¾å®šä¸‹æ–¹çš„ Google Cloud Platform ä¸“æ¡ˆç¼–å·ä¸­ï¼Œå½“å‰ç™»å…¥å¸å·æœ‰è¯¥ GCP ä¸“æ¡ˆæƒé™å°±èƒ½è‡ªåŠ¨ç»‘å®šè®¾å®šæˆåŠŸã€‚



#### 2. ä¸“æ¡ˆè®¾å®š â€” å¯ç”¨ åœ¨ç¼–è¾‘å™¨ä¸­æ˜¾ç¤ºã€Œappsscript.jsonã€èµ„è®¯æ¸…å•æ¡£æ¡ˆ



![](/assets/71400d408dc8/1*YnhdxRSyr_CYB2CFnO_31Q.png)



å¯ç”¨åå›åˆ°ç¼–è¾‘å™¨ï¼Œæ¡£æ¡ˆåˆ—è¡¨å°±ä¼šå‡ºç°ã€Œ `appsscript.json` ã€è®¾å®šæ¡£ï¼š



![](/assets/71400d408dc8/1*r8bheyYWj-TX7vFIum2GIQ.png)



ç¡®ä¿ oauthScopes ä¸­åŒ…å«ä»¥ä¸‹ä¸¤ä¸ªæè¿°è®¾å®šï¼š



```json
  "oauthScopes": [
    "https://www.googleapis.com/auth/script.external_request",
    "https://www.googleapis.com/auth/cloud-platform"
  ]
```



å¦‚æœæ²¡æœ‰è¯·æ‰‹åŠ¨è´´ä¸Šå‚¨å­˜ã€‚



#### 3.æ’°å†™ä¸²æ¥ç¨‹å¼ç 



è®¾å®šå¥½ GCP ä¸“æ¡ˆä¹‹åæˆ‘ä»¬å°±èƒ½å¼€å§‹æ’°å†™ä¸²æ¥ç¨‹å¼ç ï¼Œç›´æ¥å‚è€ƒæƒ³ä¸²æ¥çš„ Google APIs å®˜æ–¹æ–‡ä»¶ï¼Œ [Firebase App Distribution API v1](https://firebase.google.com/docs/reference/app-distribution/rest/){:target="_blank"} ï¼š



![](/assets/71400d408dc8/1*N0Zg4TEZQwTTLGCsaTdx8A.png)



```javascript
const project = "projects/[Firebase Project ID]/apps/[Firebase APP ID]"; // è¯·æ¢æˆä½ çš„ Project ID & App ID

function debug() {
  const releases = firebaseDistribution("");

  releases.forEach(function(release) {
    // Release Object: https://firebase.google.com/docs/reference/app-distribution/rest/v1/projects.apps.releases?hl=zh-tw#Release
    Logger.log(`${release.name} Download URL: ${release.testingUri}`);
  });
}

function firebaseDistribution(releaseNote) {
  const url = "https://firebaseappdistribution.googleapis.com/v1/"+project+"/releases?filter=releaseNotes.text%3D*"+releaseNote+"*";
  // Filter: https://firebase.google.com/docs/reference/app-distribution/rest/v1/projects.apps.releases/list?hl=zh-tw
  const headers = {
    "Content-Type": "application/json; charset=UTF-8",
    "Authorization": "Bearer " + ScriptApp.getOAuthToken(), // ç›´æ¥ä½¿ç”¨å½“å‰å¸å·æ¢å–æƒæ–
  };
  
  const options = {
    "method": "get",
    "headers": headers
  };
  const data = UrlFetchApp.fetch(url, options);
  const result = JSON.parse(data.getContentText()).releases;
  
  if (result == undefined) {
    return [];
  }

  return result;
}
```



`[Firebase Project ID]` **ä¸ `[Firebase APP ID]` å¯åœ¨ Firebase ä¸“æ¡ˆè®¾å®šä¸­å–å¾—ï¼š**



![](/assets/71400d408dc8/1*oql_FnmO7_ct8S3cOhP8lg.png)



è´´ä¸Šç¨‹å¼ç åï¼Œç¬¬ä¸€æ¬¡æ‰§è¡Œéœ€è¦å®Œæˆæƒé™æˆæƒã€‚



![](/assets/71400d408dc8/1*sW3ZjQA3dKS8HhAOCDsmBA.png)



![](/assets/71400d408dc8/0*p-Zl0cob4mPrsNO6.png)



- ç‚¹å‡»ã€Œå®¡æŸ¥æƒé™ã€


- é€‰æ‹©è¦æ‰§è¡Œçš„èº«ä»½å¸æˆ·ï¼Œé€šå¸¸ç­‰äºå½“å‰ Google Apps Script å¸æˆ·



![](/assets/71400d408dc8/0*m7enb51ZiNlWYeoT.png)



![](/assets/71400d408dc8/0*SN-0owiePlKXIxLk.png)



- é€‰æ‹©ã€Œè¿›é˜¶ã€å±•å¼€ -&gt; ç‚¹å‡»ã€Œå‰å¾€ XXXã€
  è¿™æ˜¯æˆ‘ä»¬è‡ªå·±å†™ç»™è‡ªå·±ç”¨çš„åº”ç”¨ç¨‹å¼ï¼Œä¸éœ€ç»è¿‡ Google éªŒè¯ã€‚


- ç‚¹å‡»ã€Œå…è®¸ã€



> *ä»¥ä¸Šç”»é¢ä¸ä¸€å®šä¼šå‡ºç°ï¼Œæ²¡æœ‰å¯å¿½ç•¥ã€‚*



**å…è®¸ä¹‹åå†ç‚¹ã€Œä¾¦é”™ã€æˆ–ã€Œæ‰§è¡Œã€å°±èƒ½æ‰§è¡Œç¨‹å¼ï¼š**



å¦‚æœå‡ºç°é”™è¯¯ï¼š



```php
Exception: Request failed for https://firebaseappdistribution.googleapis.com returned code 403. Truncated server response: {
  "error": {
    "code": 403,
    "message": "Request had insufficient authentication scopes.",
    "status": "PERMISSION_DENIED",
    "details":... (use muteHttpExceptions option to examine full response)
...
```



æˆ–



```
Exception: Specified permissions are not sufficient to call UrlFetchApp.fetch. Required permissions: https://www.googleapis.com/auth/script.external_request
```



è¯·ç¡®è®¤ `appsscript.json` çš„ oauthScopes ä¸­åŒ…å«ä»¥ä¸‹ä¸¤ä¸ªæè¿°è®¾å®š(å‚è€ƒæ­¥éª¤ 2)ï¼š



```json
"oauthScopes": [
    "https://www.googleapis.com/auth/script.external_request",
    "https://www.googleapis.com/auth/cloud-platform"
  ]
```



å¦‚æœå‡ºç°é”™è¯¯ï¼š



```php
Exception: Request failed for https://firebaseappdistribution.googleapis.com returned code 401. Truncated server response: {
  "error": {
    "code": 401,
    "message": "Request had invalid authentication credentials. Expected OAuth 2 access token, login cookie or othe... (use muteHttpExceptions option to examine full response)
```



ä»£è¡¨å°šæœªè®¾å®šç»‘å®šçš„ GCP ä¸“æ¡ˆ (å‚è€ƒæ­¥éª¤ 1. ) æˆ–æ˜¯è¯¥ GCP ä¸“æ¡ˆå°šæœªå¯ç”¨æ¬²ä½¿ç”¨çš„ Google APIs æˆ–æ˜¯å½“å‰å¸å·æ— è¯¥ GCP / Google APIs ä½¿ç”¨æƒé™æˆ–æ— è¯¥ Firebase App æƒé™ï¼Œè¯·æ£€æŸ¥è®¾å®šã€‚



å¦‚æœå‡ºç°é”™è¯¯ï¼š



```
Exception: Request failed for https://firebaseappdistribution.googleapis.com returned code 404. Truncated server response:
```



æˆ–



```php
Exception: Request failed for https://firebaseappdistribution.googleapis.com returned code 400. Truncated server response: {
  "error": {
    "code": 400,
    "message": "Request contains an invalid argument.",
    "status": "INVALID_ARGUMENT"
  }
}
```



è¯·ç¡®è®¤ Google APIs è¯·æ±‚è·¯å¾„æ˜¯å¦æ­£ç¡®ã€‚



#### ä¸²æ¥æˆåŠŸğŸ‰ğŸ‰ğŸ‰



![](/assets/71400d408dc8/1*9OyoPtblFnGGIBRvlGw10Q.png)



å¯ä»¥çœ‹åˆ°çŸ­çŸ­ä¸åˆ° 10 è¡Œç¨‹å¼ç å°±èƒ½æ— ç—›ä¸²æ¥ Google APIsï¼ŒçœŸçš„éå¸¸æ–¹ï¼›æœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥çœ‹ä¸€ä¸‹ç›¸è¾ƒä¹‹ä¸‹ï¼Œ [è‡ªå·±å®ä½œ](https://github.com/ZhgChgLi/ZReviewTender/blob/main/lib/GoogleAPI.rb){:target="_blank"} Google APIs ä¸²æ¥æ—¶èº«ä»½éªŒè¯æƒæ–äº¤æ¢çš„ç¨‹å¼æ­¥éª¤ï¼Œéå¸¸ç¹çã€‚



#### ä¸‹ä¸€æ­¥ï¼š



æ­é…ä¹‹å‰çš„æ–‡ç« ã€Œ [ä½¿ç”¨ Google Apps Script Web App è¡¨å•ä¸²æ¥ Github Action CI/CD å·¥ä½œ](../4cb4437818f2/) ã€ä¸²ä¸Š CI/CD å·¥ä½œé¡¹ç›®ï¼Œå°† Firebase App Distribution ä¸‹è½½è¿ç»“ä¹Ÿå‘ˆç°åœ¨ Web App ä¸Šæ–¹ä¾¿åŒä»ç›´æ¥åœ¨ä¸Šé¢ä¸‹è½½ã€‚



![Demo Result](/assets/71400d408dc8/1*nK3H3e3KgHEg8qz-KZ9ZGA.png)



Demo Result



> *å…¶ä»– Google APIs ä¹Ÿèƒ½ä»¥æ­¤ç±»æ¨ä¸²æ¥ã€‚*



### 2025/07 Update:



æ­¤åŠŸèƒ½å·²æ•´åˆåˆ°å®é™…æ‰“åŒ…å·¥å…·ä½¿ç”¨ï¼Œå¯å‚è€ƒæœ€æ–°æ–‡ç« æ¡ˆä¾‹ï¼šã€Œ [**CI/CD å®æˆ˜æŒ‡å—ï¼ˆå››ï¼‰ï¼šä½¿ç”¨ Google Apps Script Web App ä¸²æ¥ GitHub Actions å»ºç½®å…è´¹æ˜“ç”¨çš„æ‰“åŒ…å·¥å…·å¹³å°**](../4273e57e7148/) ã€



æœ‰ä»»ä½•é—®é¢˜åŠæŒ‡æ•™æ¬¢è¿ [ä¸æˆ‘è”ç»œ](https://www.zhgchg.li/contact){:target="_blank"} ã€‚



*[Post](https://medium.com/zrealm-robotic-process-automation/google-apps-script-x-google-apis-%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5%E6%95%B4%E5%90%88%E6%96%B9%E5%BC%8F-71400d408dc8){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}.*