---
author: ZhgChgLi
categories:
- ZRealm Dev.
date: 2025-07-02T12:22:32.788+0000
description: å¸¦æ‚¨ä»å¤´äº†è§£ GitHub Actions/Self-hosted Runner è¿ä½œæ–¹å¼ä¸æ‰‹æŠŠæ‰‹ä½¿ç”¨æ•™å­¦ã€‚
image:
  path: /assets/404bd5c70040/1*_vGYh_XSI3ZDbdeT8xCihA.jpeg
last_modified_at: 2025-07-12T14:49:01.276+0000
render_with_liquid: false
tags:
- simplified-chinese
- ios-app-development
- cicd
- github-actions
- github
- self-hosted
title: CI/CD å®æˆ˜æŒ‡å—ï¼ˆäºŒï¼‰ï¼šGitHub Actions ä¸ Self-hosted Runner ä½¿ç”¨ä¸å»ºç½®å¤§å…¨
---

### CI/CD å®æˆ˜æŒ‡å—ï¼ˆäºŒï¼‰ï¼šGitHub Actions ä¸ Self-hosted Runner ä½¿ç”¨ä¸å»ºç½®å¤§å…¨



å¸¦æ‚¨ä»å¤´äº†è§£ GitHub Actions/Self-hosted Runner è¿ä½œæ–¹å¼ä¸æ‰‹æŠŠæ‰‹ä½¿ç”¨æ•™å­¦ã€‚



![Photo by [Dan Taylor](https://unsplash.com/@theoneandonlydantaylor?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash){:target="_blank"}](/assets/404bd5c70040/1*_vGYh_XSI3ZDbdeT8xCihA.jpeg)



Photo by [Dan Taylor](https://unsplash.com/@theoneandonlydantaylor?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash){:target="_blank"}



#### å‰è¨€



å‰ç¯‡ã€Œ [**CI/CD å®æˆ˜æŒ‡å—ï¼ˆä¸€ï¼‰ï¼šCI/CD æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•é€è¿‡ CI/CD æ‰“é€ ç¨³å®šé«˜æ•ˆçš„å¼€å‘å›¢é˜Ÿï¼Ÿå·¥å…·é€‰æ‹©ï¼Ÿ**](../c008a9e8ceca/) ã€æˆ‘ä»¬ä»‹ç»äº† CI/CD æ˜¯ä»€ä¹ˆï¼Ÿèƒ½å¸¦æ¥å“ªäº›æ•ˆç›Šä¸å·¥å…·çš„é€‰æ‹©ï¼Œ **è¿™ç¯‡å°†è‘—é‡åœ¨ GitHub Actions, Self-hosted Runner çš„æ¶æ„ä¸ä½¿ç”¨ä»‹ç»** ï¼Œå¹¶æ‰‹æŠŠæ‰‹ä¸€èµ·å»ºç«‹å‡ ä¸ªæœ‰è¶£çš„è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹ï¼Œå¸¦æ‚¨æ…¢æ…¢ä¸Šæ‰‹ã€‚



### GitHub Actions æ¶æ„æµç¨‹å›¾



åœ¨å¼€å§‹ä¹‹å‰æˆ‘ä»¬å…ˆæ¥ç¡®å®šä¸€ä¸‹ GitHub Actions çš„è¿ä½œæ¶æ„æµç¨‹å…³ç³»ä¸èŒè´£ã€‚



![](/assets/404bd5c70040/1*iacfyTX_b3YTSzMcn2ldjw.png)



#### **GitHub Repo**



- åœ¨ GitHub Actions çš„ä¸–ç•Œé‡Œï¼Œæ‰€æœ‰ Actions (Workflow YAML æ¡£æ¡ˆ) éƒ½è¦å­˜æ”¾åœ¨æŸä¸ª Git Repo ä¹‹ä¸­ ( `REPO/.github/workflows/` )



#### GitHub Repo â€”Actions Secrets



Repo â†’ Settings â†’ Secrets and variables â†’ Actions â†’ Secretsã€‚



- å­˜æ”¾ Actions æ­¥éª¤ä¸­ä¼šç”¨åˆ°çš„ Secret Key, Token
  e.g. Slack Bot Tokenã€Apple Store Connect API .p8 Key


- **Secrets å†…å®¹æ— æ³•åœ¨ Action Log ä¸­æŸ¥çœ‹ï¼Œä¼šè‡ªåŠ¨ç”¨ * * * * éšè”½**


- Secrets å†…å®¹æ— æ³•æŸ¥çœ‹ã€ç¼–è¾‘ï¼Œåªèƒ½è¦†ç›–


- Secrets **ç›®å‰åªæ”¯æ´çº¯æ–‡å­—å†…å®¹ï¼Œæ— æ³•ä¸Šä¼ æ¡£æ¡ˆ**
  **-** å¦‚æœæ˜¯äºŒè¿›åˆ¶çš„é‡‘è¦è¯·å‚è€ƒ [å®˜æ–¹æ­¥éª¤ä½¿ç”¨ Base64 ç¼–ç è½¬æ¢åå‚¨å­˜](https://docs.github.com/en/actions/how-tos/security-for-github-actions/security-guides/using-secrets-in-github-actions#storing-base64-binary-blobs-as-secrets){:target="_blank"} ã€‚
  - iOS å¼€å‘å‡­è¯å‚¨å­˜æ–¹å¼å¯å‚è€ƒå®˜æ–¹æ•™å­¦ï¼š [Installing an Apple certificate on macOS runners for Xcode development](https://docs.github.com/en/actions/how-tos/use-cases-and-examples/deploying/installing-an-apple-certificate-on-macos-runners-for-xcode-development){:target="_blank"}


- å¯ä»¥å‚¨å­˜ç»„ç»‡å±‚çº§çš„ Secretsï¼Œè·¨ Repo å…±äº«



#### GitHub Repo â€” Actions Variables



Repo â†’ Settings â†’ Secrets and variables â†’ Actions â†’ Variablesã€‚



- å­˜æ”¾ Actions æ­¥éª¤ä¸­å¸¸ç”¨åˆ°çš„å˜æ•°
  e.g. æ¨¡æ‹Ÿå™¨ iOS ç‰ˆæœ¬ã€å·¥ä½œç›®å½•


- Variables å†…å®¹å¯ä»¥æŸ¥çœ‹ã€ç¼–è¾‘


- Variables å†…å®¹å¯ä»¥è¾“å‡ºåœ¨ Action Log ä¸­


- Variables åªæ”¯æ´çº¯æ–‡å­—ï¼Œä¹Ÿå¯å­˜æ”¾ json å­—ä¸²ç„¶åè‡ªå·±è§£æä½¿ç”¨


- å¯ä»¥å‚¨å­˜ç»„ç»‡å±‚çº§çš„ Variablesï¼Œè·¨ Repo å…±äº«



#### GitHub Actions â€” Trigger



- **Github Action ä¸­æœ€é‡è¦çš„èµ·å§‹ç‚¹ â€” è§¦å‘äº‹ä»¶(æ¡ä»¶)**


- ç¬¦åˆè§¦å‘äº‹ä»¶çš„ GitHub Actions æ‰ä¼šè§¦å‘æ‰§è¡Œ


- å®Œæ•´äº‹ä»¶åˆ—è¡¨å¯ [å‚è€ƒå®˜æ–¹æ–‡ä»¶](https://docs.github.com/en/actions/reference/events-that-trigger-workflows){:target="_blank"}


- åŸºæœ¬ä¸Šæ¶µç›–äº†æ‰€æœ‰ CI/CDã€è‡ªåŠ¨åŒ–ä¼šé‡åˆ°çš„äº‹ä»¶åœºæ™¯ã€‚
  ä½† **å¦‚æœæœ‰ç‰¹æ®Šåœºæ™¯æ²¡æœ‰äº‹ä»¶ï¼Œé‚£å°±åªèƒ½ç”¨å…¶ä»–äº‹ä»¶+åœ¨ Job ä¸­åˆ¤æ–­ç»„åˆæˆ–æ˜¯ç”¨ Schedule æ’ç¨‹æ‰‹åŠ¨æ£€æŸ¥äº†** ã€‚
  e.g. ä¾‹å¦‚æ²¡æœ‰ PR Merged äº‹ä»¶ï¼Œå°±åªèƒ½ç”¨ `pull_request: closed` + Job `if: github.event.pull_request.merged == true` è¾¾æˆ



**å¸¸ç”¨äº‹ä»¶ï¼š**



- `schedule` (cron)ï¼šæ’ç¨‹å®šæ—¶æ‰§è¡Œ(åŒ crontab)
  å¯ä»¥ç”¨æ¥åšè‡ªåŠ¨åŒ–ï¼šå®šæ—¶æ£€æŸ¥ PRã€å®šæ—¶æ‰“åŒ…ã€å®šæ—¶æ‰§è¡Œè‡ªåŠ¨åŒ–è„šæœ¬
  **ç»Ÿä¸€éƒ½åœ¨ main / develop (Default Branch) æ‰§è¡Œã€‚**


- `pull_request:` ï¼šPR ç›¸å…³äº‹ä»¶
  å½“ PR å¼€å¯æ—¶ã€PR Assign æ—¶ã€åŠ  Label æ—¶ã€æœ‰æ–° Push Commit æ—¶â€¦ç­‰ç­‰


- `issues` ã€ `issue_comment` ï¼šIssue ç›¸å…³äº‹ä»¶
  å½“ Issue å¼€å¯æ—¶ã€æœ‰æ–°ç•™è¨€æ—¶â€¦ç­‰ç­‰


- `workflow_dispatch` ï¼šæ‰‹åŠ¨è§¦å‘ï¼›å¯ä»¥è®¾å®šéœ€è¦æä¾›çš„æ ä½ï¼ŒGitHub Actions æä¾›ç®€æ˜“çš„è¡¨å•è®©ä½¿ç”¨è€…å¯ä»¥å¡«å†™èµ„è®¯ã€‚
  e.g.:



![](/assets/404bd5c70040/1*XogIJsCbrNPerWBto_PG8w.png)



- `workflow_call` ï¼šè§¦å‘å¦ä¸€ä¸ª Action(Workflow) æ‰§è¡Œä»»åŠ¡ã€‚


- `workflow_run` ï¼šå½“åˆ«çš„ Action(Workflow) æ‰§è¡Œä»»åŠ¡ï¼Œè§¦å‘æ‰§è¡Œæ­¤ä»»åŠ¡ã€‚



> *æ›´å¤šäº‹ä»¶ç±»å‹ã€è®¾å®šç»†èŠ‚è¯· [å‚è€ƒå®˜æ–¹æ–‡ä»¶](https://docs.github.com/en/actions/reference/events-that-trigger-workflows){:target="_blank"} ã€‚*



#### **GitHub Actions â€” Workflow**



- a.k.a Action


- ä½¿ç”¨ YAML æ’°å†™ .yaml æ¡£æ¡ˆï¼Œæ¡£æ¡ˆç»Ÿä¸€æ”¾ç½®åœ¨ `REPO/.github/workflows/` ä¹‹ä¸‹


- **ä»¥ä¸»åˆ†æ”¯å†…çš„ Workflow YAML æ¡£æ¡ˆä¸ºä¸»**
  å¦‚æœåœ¨å…¶ä»–åˆ†æ”¯çœ‹ä¸åˆ°æ­£åœ¨å¼€å‘çš„ Action æˆ–æ‰§è¡Œä¸Šæœ‰è¯¯ï¼Œå¯ä»¥å…ˆ Merge å›ä¸»åˆ†æ”¯çœ‹çœ‹ã€‚


- GitHub Actions ä¸­çš„æœ€åŸºç¡€å•ä½ï¼Œæ¯ä¸ª Workflow å°±ä»£è¡¨ä¸€é¡¹ CI/CD æˆ–è‡ªåŠ¨åŒ–æ“ä½œ


- Workflow å¯ä»¥å‘¼å«åˆ«çš„ Workflow æ‰§è¡Œä»»åŠ¡
  (å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§æ‹†å‡ºæ ¸å¿ƒ Workflow å’Œå‘¼å«çš„ Workflow)


- å½“ä¸­ä¼šå®šä¹‰ä»»åŠ¡åç§°ã€æ‰§è¡Œç­–ç•¥ã€è§¦å‘äº‹ä»¶ã€ä»»åŠ¡å·¥ä½œâ€¦ç­‰ç­‰æ‰€æœ‰ Action ç›¸å…³è®¾å®š


- ç›®å‰æ¡£æ¡ˆç»“æ„ä¸æ”¯æ´å­ç›®å½•


- Action å®Œå…¨å…è´¹ (Public and Private Repo)



#### GitHub Actions â€” Workflow â€” Job



- GitHub Actions ä¸­çš„æ‰§è¡Œå•ä½


- å®šä¹‰ Workflow ä¸­çš„ä»»åŠ¡å·¥ä½œæœ‰å“ªäº›


- æ¯ä¸ª Workflow å¯ä»¥æœ‰å¤šä¸ª Jobs


- æ¯ä¸ª Job éœ€è¦æŒ‡å®šä½¿ç”¨å“ªä¸ª Runner Labelï¼Œæ‰§è¡Œçš„æ—¶å€™ä¼šä½¿ç”¨å¯¹åº”çš„ Runner æœºå™¨æ¥æ‰§è¡Œä»»åŠ¡


- **å¤šä¸ª Jobs æ˜¯å¹¶å‘æ‰§è¡Œ** (å¦‚æœ‰é¡ºåºå¯ä»¥ç”¨ `needs` çº¦æŸ)


- **æ¯ä¸ª Job åº”è¯¥è§†ä¸ºç‹¬ç«‹æ‰§è¡Œä¸ªä½“(æ¯ä¸ªéƒ½è¦å½“æˆæ˜¯ Sandbox)** ï¼ŒJob ç»“æŸåå¦‚æœæœ‰äº§å‡ºèµ„æºæ¡£æ¡ˆè¦ç»™åç»­å…¶ä»– Job/Workflow ä½¿ç”¨ï¼Œéœ€è¦ Upload Artifacts æˆ–åœ¨ self-hosted ç§»åŠ¨åˆ°å…±ç”¨äº§å‡ºç›®å½•ã€‚


- Job åšå®Œå¯ä»¥ Output å­—ä¸²ç»™å…¶ä»– Job å‚è€ƒä½¿ç”¨ã€‚
  (ä¾‹å¦‚æ‰§è¡Œç»“æœ true or false)


- æ²¡ç‰¹åˆ«è®¾æµç¨‹æ¡ä»¶çš„è¯ï¼Œå¤šä¸ª Job å¦‚æœå…¶ä¸­æœ‰ Job å‘ç”Ÿé”™è¯¯ï¼Œ **å…¶ä»– Job ä¾ç„¶ä¼šç»§ç»­æ‰§è¡Œ**



#### GitHub Actions â€” Reuse Workflow/Job



- Workflow å®šä¹‰ `on: workflow_call` å°±èƒ½å°è£…ç»™å…¶ä»– Workflow å½“æˆ Job å¤ç”¨


- åŒä¸ªç»„ç»‡ä¸‹å¯ä»¥è·¨ Repo åˆ†äº«ä½¿ç”¨


- å› æ­¤å¯ä»¥æŠŠè·¨ Repo å…±ç”¨çš„ CI/CD å·¥ä½œæ”¾åˆ°å…±äº«çš„ Repo ä¸€èµ·ä½¿ç”¨



#### GitHub Actions â€” Workflow â€” Job â€” Step



- GitHub Actions ä¸­çš„æœ€å°æ‰§è¡Œé¡¹ç›®


- Job ä¸­å®é™…æ‰§è¡Œä»»åŠ¡çš„ç¨‹å¼


- æ¯ä¸ª Job å¯ä»¥æœ‰å¤šä¸ª Steps


- **å¤šä¸ª Steps æ˜¯ç…§é¡ºåºæ‰§è¡Œ**


- Step åšå®Œå¯ä»¥ Output å­—ä¸²ç»™åç»­ Steps å‚è€ƒä½¿ç”¨ã€‚


- **Step å¯ä»¥ç›´æ¥æ’°å†™ shell script ç¨‹å¼**
  å¯ä»¥å¼•ç”¨ [gh cli](https://cli.github.com/manual/gh){:target="_blank"} ã€å½“å‰ç¯å¢ƒå˜æ•°(ä¾‹å¦‚å–å¾— PR ç¼–å·)ï¼Œç›´æ¥åšæƒ³åšçš„äº‹


- æ²¡ç‰¹åˆ«è®¾æµç¨‹æ¡ä»¶çš„è¯ï¼ŒStep å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œ **ä¼šç›´æ¥ä¸­æ–­** ï¼Œåç»­çš„ Steps ä¸ä¼šæ‰§è¡Œ



#### GitHub Actions â€” Workflow â€” Job â€” Reuse Action Step



- **å¯ä»¥ç›´æ¥å¤ç”¨ [Marketplace](https://github.com/marketplace?type=actions){:target="_blank"} ä¸Šå„è·¯å¤§ç¥åŒ…å¥½çš„ç°æœ‰å·¥ä½œæ­¥éª¤ã€‚**
  ä¾‹å¦‚ï¼š [Comment å†…å®¹åˆ° PR](https://github.com/marketplace/actions/comment-pull-request){:target="_blank"} ã€‚


- ä¹Ÿå¯ä»¥å°†è‡ªå·±ä¸€ç³»åˆ—çš„å·¥ä½œä»»åŠ¡ Step æ‰“åŒ…æˆä¸€ä¸ª Action GitHub Repo è®©å…¶ä»–å·¥ä½œç›´æ¥å¤ç”¨


- Public Repo çš„ Action å¯ä»¥ä¸Šæ¶åˆ° Marketplace



**æ‰“åŒ… Action æ”¯æ´ä½¿ç”¨ï¼š**



- **Docker Action** â€” ä»£è¡¨ GitHub Actions ä¼šæŠŠç¯å¢ƒå˜æ•°ä¼ åˆ° Docker å®¹å™¨ä¸­ï¼Œå†çœ‹ä½ è¦æ€ä¹ˆå¤„ç†ï¼Œå¯ä»¥æ˜¯ shell scriptã€Javaã€PHPâ€¦etc.


- **JavaScript/TypeScript Action** â€” ç›´æ¥ä½¿ç”¨ node.js æ’°å†™ GitHub Actions å¤„ç†é€»è¾‘ï¼ŒåŒæ ·çš„ä¼šæŠŠç¯å¢ƒå˜æ•°éƒ½ä¼ ç»™ä½ å‚è€ƒä½¿ç”¨ã€‚
  e.g. [pozil/auto-assign-issue](https://github.com/pozil/auto-assign-issue/blob/v2/action.yml){:target="_blank"}


- **Composite (YAML) â€”** çº¯ YAML æè¿°ä»»åŠ¡æ­¥éª¤ (åŒ GitHub Actions â€” Workflow â€” Job â€” Step) å¯ä»¥å®£å‘Šæœ‰å“ªå†™æ­¥éª¤è¦åšæˆ–ç›´æ¥åœ¨ä¸Šé¢å†™ shell scriptã€‚
  e.g. [ZhgChgLi/ZReviewTender](https://github.com/ZhgChgLi/ZReviewTender/blob/main/action.yml){:target="_blank"}



> *ç¢äºç¯‡å¹…ï¼Œæœ¬ç¯‡æ–‡ç« ä¸ä¼šä»‹ç»å¦‚ä½•æ‰“åŒ… Github Actions Actionï¼Œæœ‰å…´è¶£å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡ä»¶ï¼š [tutorials/creating-a-composite-action](https://docs.github.com/en/actions/tutorials/creating-a-composite-action){:target="_blank"} ã€‚*



#### GitHub Runner



- GitHub ä¼šæ ¹æ® Runner Label æ´¾å‘å¯¹åº”çš„ Job ç»™ Runner æ‰§è¡Œ


- Runner åªåšä¸ºç›‘å¬è€…ï¼Œè½®è¯¢ç›‘å¬ GitHub æ´¾å‘ä»»åŠ¡


- åªå…³å¿ƒ Job ä¸å…³å¿ƒæ˜¯å“ªä¸ª Action(Workflow)
  å› æ­¤ä¼šå‡ºç° Action A çš„ Job-1 æ‰§è¡Œå®Œï¼Œä¸‹ä¸€ä¸ªæ¢ Action B çš„ Job-1ï¼Œè€Œä¸æ˜¯ Action A çš„ Jobs éƒ½æ‰§è¡Œå®Œæ‰æ¢ Action Bã€‚


- Runner å¯ä»¥ä½¿ç”¨ GitHub Hosted Runner æˆ– Self-hosted Runnerã€‚



#### **GitHub Hosted Runner**



- GitHub æä¾›çš„ Runnerï¼Œå¯å‚è€ƒå®˜æ–¹ Repo åˆ—è¡¨ï¼š



[![](https://opengraph.githubassets.com/b479f2537a0d7620cc8bed955bf9331e739ee02383a1715546a26bc35390a494/actions/runner-images)](https://github.com/actions/runner-images){:target="_blank"}



![[2025/06 çš„ Images åˆ—è¡¨](https://github.com/actions/runner-images){:target="_blank"}](/assets/404bd5c70040/1*KtQV4kDCWscEeaZ8jQI8Dg.png)



[2025/06 çš„ Images åˆ—è¡¨](https://github.com/actions/runner-images){:target="_blank"}



- Runner é¢„å…ˆå®‰è£…äº†ä»€ä¹ˆå¯ä»¥ç‚¹è¿›å»æŸ¥çœ‹ï¼š
  e.g. [macos-14-arm64](https://github.com/actions/runner-images/blob/main/images/macos/macos-14-arm64-Readme.md){:target="_blank"}



![[macos-14-arm64](https://github.com/actions/runner-images/blob/main/images/macos/macos-14-arm64-Readme.md){:target="_blank"}](/assets/404bd5c70040/1*svXtXH78-TvK1C_XXCyYLA.png)



[macos-14-arm64](https://github.com/actions/runner-images/blob/main/images/macos/macos-14-arm64-Readme.md){:target="_blank"}



- iOS å¼€å‘ä¼˜å…ˆä½¿ç”¨ -arm64 (Mç³»åˆ—) å¤„ç†å™¨çš„ Runnerï¼Œè·‘èµ·æ¥æ¯”è¾ƒå¿«


- åªè¦åœ¨ Job `run-on` è´´ä¸Šè¡¨æ ¼ä¸Šçš„ YAML Labelï¼Œå°±èƒ½ä½¿ç”¨è¯¥ Runner æ‰§è¡Œä»»åŠ¡


- **Public Repo æ”¶è´¹æ–¹å¼: å®Œå…¨å…è´¹æ— é™ä½¿ç”¨**


- **ï¸** Private Repo å…è´¹é¢åº¦:
  å…è´¹é¢åº¦(ä¾ç…§å¸å·ä¸åŒé¢åº¦ä¸åŒï¼Œä»¥ GitHub Free ä¸ºä¾‹)ï¼š
  ç”¨é‡ï¼šæ¯æœˆå…è´¹ 2,000 åˆ†é’Ÿ
  å‚¨å­˜ï¼š500 MB


- **âš ï¸ï¸Private Repo è®¡è´¹æ–¹å¼:**
  **è¶…è¿‡å…è´¹é¢åº¦ä¹‹åå¼€å§‹ç”¨ç”¨é‡è®¡è´¹(å¯è®¾ä¸Šé™è·Ÿé€šçŸ¥)ï¼Œä¾ç…§ Runner æ‰€å±çš„æœºå™¨ä½œä¸šç³»ç»Ÿã€æ ¸å¿ƒä¸åŒï¼Œä»·æ ¼ä¹Ÿä¸åŒï¼š**



![[about-billing-for-github-actions](https://docs.github.com/en/billing/managing-billing-for-your-products/about-billing-for-github-actions){:target="_blank"}](/assets/404bd5c70040/1*rkhRJN4ZRas_lDOJh-pjkQ.png)



[about-billing-for-github-actions](https://docs.github.com/en/billing/managing-billing-for-your-products/about-billing-for-github-actions){:target="_blank"}



å¯ä»¥çœ‹åˆ° macOS çš„ä»·æ ¼å› ä¸ºè®¾å¤‡æˆæœ¬å¾ˆé«˜æ‰€ä»¥è´µã€‚



- æœ€å¤šå¹¶å‘ä»»åŠ¡æ•°é™åˆ¶ï¼š



![[usage-limits-billing-and-administration](https://docs.github.com/en/actions/concepts/overview/usage-limits-billing-and-administration#usage-limits){:target="_blank"}](/assets/404bd5c70040/1*LU3zGSBe57NBVMfDwl0wdQ.png)



[usage-limits-billing-and-administration](https://docs.github.com/en/actions/concepts/overview/usage-limits-billing-and-administration#usage-limits){:target="_blank"}



> *è¿™è¾¹æ‰¯å¤ªå¤šäº†ï¼Œæˆ‘ä»¬çš„é‡ç‚¹æ˜¯ Self-hosted Runnerã€‚*



#### Self-hosted Runner on In-house Server



- å°†è‡ªå·±çš„æœºå™¨ä½œä¸º Runner


- **ä¸€å°å®ä½“æœºå™¨å¯ä»¥èµ·å¤šä¸ª Runner å¹¶å‘æ¥ä»»åŠ¡æ¥åš**


- **å…è´¹æ— é™é‡æ— é™åˆ¶ä½¿ç”¨**
  åªæœ‰æœºå™¨è´­ä¹°æˆæœ¬ï¼ŒèŠ±ä¸€æ¬¡ä½¿ç”¨åˆ°é¥±ï¼
  ä»¥ 32G RAM M4 Mini (=NT$40,900) è®¡ç®—ï¼Œå¦‚æœç”¨ GitHub Hosted Runner ä¸€ä¸ªæœˆè¦èŠ± 500 USDï¼› **ä¹°ä¸€å°æ¶è®¾å¥½ç”¨è¶…è¿‡ä¸‰ä¸ªæœˆå°±å›æœ¬** äº†ï¼


- æ”¯æ´ Windows, macOS, Linux (x64/ARM/ARM64)


- **åŒä¸ªç»„ç»‡å¯ä»¥è·¨ Repo å…±äº« Runner**


- **âš ï¸ç›®å‰ï¼šactions/cache, actions/upload-artifact, actions/download-artifact éƒ½åªæ”¯æ´ GitHub äº‘ç«¯æœåŠ¡ï¼Œä»£è¡¨è¿™äº›å†…å®¹è¿˜æ˜¯ä¼šä¸Šä¼ åˆ° GitHub ä¼ºæœå™¨å¹¶è®¡ç®—å‚¨å­˜é‡æ”¶è´¹ã€‚**
  å¯ä»¥åœ¨è‡ªå·±çš„æœºå™¨ä¸Šå¼€å…±ç”¨ç›®å½•å–ä»£ã€‚


- Self-hosted Runner ä¹Ÿæ”¯æ´ [Docker, k8s](https://docs.github.com/en/actions/concepts/runners/about-actions-runner-controller){:target="_blank"} åªæ˜¯æˆ‘æ²¡ç ”ç©¶ã€‚



> ***æ¶è®¾ Self-hosted Runner åªéœ€å‡ æ­¥ (10 åˆ†é’Ÿå†…è®¾å®šå¥½) å°±èƒ½ä¸Šçº¿å¼€å§‹æ¥ä»»åŠ¡æ‰§è¡Œ(æœ¬æ–‡ç¨åä¼šä»‹ç»)ã€‚***



#### GitHub Workflow x Job x Step x Runner æµç¨‹å…³ç³»å›¾



![](/assets/404bd5c70040/1*WHIVfXdVRoEsdXGfJhu2Rw.png)



è¿™è¾¹ç”¨ä¸€å¼ å›¾æ€»ç»“å·¥ä½œæµç¨‹ä¸å…³ç³»ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ª Workflowã€ä¸¤ä¸ª Runner:



- CI â€”å‡è®¾ Ræœ‰ 3 ä¸ª Jobsï¼Œæ¯ä¸ª Job å„æœ‰å‡ ä¸ª Stepsï¼ŒRunner Label(run-on) â€” `self-hosted-app`


- CD â€” æœ‰ 4 ä¸ª Jobsï¼Œæ¯ä¸ª Job å„æœ‰å‡ ä¸ª Stepsï¼ŒRunner Label(run-on) â€” `self-hosted-app`


- Runner â€” æœ‰ 2 ä¸ªï¼ŒRunner Label ä¹Ÿéƒ½æ˜¯â€” `self-hosted-app`



åŒå‰è¿°ï¼ŒRunner è·Ÿ Workflow æ˜¯ä¾ç…§ Runnler Label æ¥æ´¾å‘ã€æ¥æ”¶ä»»åŠ¡æ¥åšï¼Œè¿™ä¸ªæ¡ˆä¾‹éƒ½æ˜¯ç”¨åŒä¸ª `self-hosted-app` Runner Labelï¼ŒWorkflow çš„ Jobs é¢„è®¾æ˜¯å¹¶å‘æ‰§è¡Œã€Steps æ˜¯æ¯ä¸ª Job çš„å®é™…æ‰§è¡Œå†…å®¹ï¼Œä¸²è¡Œç…§é¡ºåºæ‰§è¡Œï¼ŒSteps éƒ½æ‰§è¡Œå®Œç­‰äº Job æ‰§è¡Œå®Œæ¯•ã€‚



> ***å› æ­¤ Workflow å®é™…æ‰§è¡Œçš„æ—¶é—´è½´ä¼šæ˜¯åœ¨ä¸¤ä¸ª Runner ä¹‹é—´ç©¿æ¢­æ‰§è¡Œ Jobï¼Œä¹Ÿä¼šå¹¶å‘æ‰§è¡Œã€å½“å‰ Job æ‰§è¡Œå®Œä¸‹ä¸€ä¸ªä¹Ÿä¸ä¸€å®šæ˜¯æ¥è‘—åŒä¸ª Worflow çš„ä¸‹ä¸€ä¸ª Jobã€‚***



> *âš ï¸ æ‰€ä»¥æ‰è¯´ç¡®ä¿æ¯ä¸ª Job æ˜¯ç‹¬ç«‹çš„å¾ˆé‡è¦ (å°¤å…¶åœ¨ Self-hosted Runner ç¯å¢ƒä¹‹ä¸‹ï¼ŒJob ç»“æŸä¹‹åå¯èƒ½ä¸ä¼šæ¸…é™¤çš„å¤ªå¹²å‡€ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šä¸‹æ„è¯†è§‰å¾—è¿™ä¸ª Job çš„äº§å‡ºï¼Œä¸‹ä¸€ä¸ª Job å¯ä»¥æ¥è‘—åšäº‹)ï¼Œä¸åº”è¯¥è¿™æ ·ç”¨ã€‚*



#### å¦‚æœ Job æœ‰äº§å‡ºè¦ç»™åç»­çš„ Job ä½¿ç”¨:



- **Job Output String** : è¾“å‡ºçº¯æ–‡å­—åˆ°å˜æ•°ç»™å…¶ä»– Job å¼•ç”¨


- **Artifact-upload/download:** Job çš„ Step æœ€åä¸€æ­¥å°†æ‰§è¡Œç»“æœä¸Šä¼ åˆ° GitHub Artifactï¼Œå¦ä¸€ä¸ª Job çš„ç¬¬ä¸€ä¸ª Step ä¸‹è½½å›æ¥ç»§ç»­å¤„ç†ä½¿ç”¨ã€‚
  e.g. ä¾‹å¦‚ Job â€” æ‰“åŒ… â†’ å°†æ‰“åŒ…ç»“æœ .ipa ä¼ åˆ° **Artifact â†’** Job â€” éƒ¨ç½² â†’ ä¸‹è½½å›æ¥ .ipa â†’ ä¸Šä¼  App Store éƒ¨ç½²
  è¦æ³¨æ„ï¼š **ç›®å‰å°±ç®—æ˜¯ Self-hosted ä¹Ÿæ˜¯ä¼šä¸Š GitHub Artifact äº‘å‚¨å­˜ã€‚**


- **AWS/GCPâ€¦äº‘ç«¯å‚¨å­˜** : åŒä¸Šï¼Œåªæ˜¯æ˜¯ç”¨è‡ªå·±çš„äº‘ç«¯å‚¨å­˜æœåŠ¡ã€‚


- **[Self-hosted Only] å…±ç”¨ç¡¬ç¢Ÿã€ç›®å½•:** Self-hosted Runner å¦‚æœéƒ½æœ‰æŒ‚è½½ä¸€ä¸ªå…±ç”¨ç›®å½•ï¼Œåˆ™å¯ç”¨è¿™ä¸ªç›®å½•ä¾ç…§ UUID å»ºç«‹èµ„æ–™å¤¹å­˜æ”¾äº§å‡ºç»“æœï¼Œç„¶ååç»­ Job å»è¯»å–å‰ä¸€ä¸ª Job Output UUID å»æ‰¾åˆ°å¯¹åº”çš„å‚¨å­˜å†æ‹¿å›æ¥ç”¨ã€‚
  è¦æ³¨æ„ï¼Œä¸åŒä¸»æœºçš„ Runner ä¹Ÿéƒ½è¦æŒ‚è½½åŒä¸ªå…±ç”¨ç›®å½•ã€‚


- åœ¨åŒä¸ª Job çš„ Steps æŠŠæ‰€æœ‰äº‹æƒ…åšå®Œã€‚



### åšä¸­å­¦ GitHub Actions â€” æ¡ˆä¾‹å®ä½œ



ã€Œåè€Œè¨€ï¼Œä¸å¦‚èµ·è€Œè¡Œã€ä»¥ä¸Šåè¯è§£é‡Šè·Ÿæµç¨‹æ¶æ„ä»‹ç»ç›¸ä¿¡å¤§å®¶ä¹Ÿæ˜¯çœ‹å¾—æ‡µæ‡µæ‡‚æ‡‚ï¼Œæ¥ä¸‹æ¥ä¼šç›´æ¥ä¸¾ä¸‰ä¸ªåŠŸèƒ½ä¾‹å­ï¼Œå¸¦å¤§å®¶å®é™…åŠ¨æ‰‹åšï¼Œå¹¶ä¸€è¾¹è§£é‡Šç¢°åˆ°çš„ä¸œè¥¿ï¼Œä»åšå½“ä¸­å­¦ä¹ ï¼Œä»¥äº†è§£ GitHub Actions åˆ°åº•æ˜¯ä»€ä¹ˆã€‚



### æ¡ˆä¾‹ â€” 1



å»ºç«‹ Pull Request åè‡ªåŠ¨æ ‡è®° File Changes Size Label è®© Reviewer æ–¹ä¾¿å®‰æ’ Review å·¥ä½œã€‚



#### æˆæœå›¾



![[Demo PR](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/pull/11){:target="_blank"}](/assets/404bd5c70040/1*vjSWeu2zB-hmVpfziMDR5Q.png)



[Demo PR](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/pull/11){:target="_blank"}



#### è¿ä½œæµç¨‹



- ä½¿ç”¨è€…å¼€ PRã€é‡å¼€ PRã€Push æ–° Commit åˆ° PR


- è§¦å‘ GitHub Actions Workflow


- shell script å–çš„ file changes æ•°é‡


- åˆ¤æ–­æ•°é‡å¯¹ PR æ ‡è®°ä¸Š Label


- å®Œæˆ



#### åŠ¨æ‰‹åš



Repo â†’ Actions â†’ New workflow â†’ set up a workflow yourselfã€‚



**æ¡£æ¡ˆåç§°ï¼š** `Automation-PullRequest.yml`



Action Workflow å¯ä»¥æ¯ä¸ªä»»åŠ¡ç‹¬ç«‹ä¸€ä¸ªæ¡£æ¡ˆï¼Œä¹Ÿå¯ä»¥ä¾ç…§è§¦å‘äº‹ä»¶ã€ç›®çš„ï¼ŒåŒä¸ªç›®çš„èšåˆåœ¨åŒä¸ªæ¡£æ¡ˆï¼Œåæ­£å¤šä¸ª Job æ˜¯å¹¶å‘æ‰§è¡Œçš„ï¼Œå¦å¤– **å› ä¸º GitHub Actions æš‚æ—¶ä¸æ”¯æ´ç›®å½•ç»“æ„ï¼Œæ‰€ä»¥æ¡£æ¡ˆå°‘ä¸€ç‚¹ã€ä½¿ç”¨é˜¶å±‚å‘½åæ¡£æ¡ˆä¼šæ¯”è¾ƒå¥½ç®¡ç†** ã€‚



è¿™è¾¹æŠŠ PR ç›¸å…³äº‹ä»¶çš„ Actions éƒ½æ”¾åœ¨åŒä¸ª Workflowã€‚



#### `Automation-PullRequest.yml`



```yaml
# Workflow(Action) åç§°
name: Pull Reqeust Automation

# Actions Log çš„æ ‡é¢˜åç§°
run-name: "[Pull Reqeust Automation] ${{ github.event.pull_request.title \\|\\| github.ref }}"

# è§¦å‘äº‹ä»¶
on:
  # PR äº‹ä»¶
  pull_request:
    # PR - å¼€å¯ã€é‡å¼€ã€æœ‰æ–° Push Commit æ—¶
    types: [opened, synchronize, reopened]


# åŒä¸ª Concurrency Group å¦‚æœæœ‰æ–°çš„ Job ä¼šå–æ¶ˆæ­£åœ¨è·‘çš„
# ä¾‹å¦‚ Push Commit è§¦å‘çš„ä»»åŠ¡è¿˜æ²¡æ‰§è¡Œå°±åˆ Push Commit æ—¶ï¼Œä¼šå–æ¶ˆå‰ä¸€ä¸ªä»»åŠ¡
concurrency:
  group: ${{ github.workflow }}-${{ github.ref_name }}
  cancel-in-progress: true

# Job å·¥ä½œé¡¹ç›®
# Job ä¼šå¹¶å‘æ‰§è¡Œ
jobs:
  # Job ID
  label-pr-by-file-count:
    # Job åç§° (å¯çœç•¥ï¼Œæœ‰è®¾å®šåœ¨ Log æ˜¾ç¤ºæ¯”è¾ƒå¥½è¯»)
    name: Label PR by changes file count

    # å¦‚æœè¿™ä¸ª Job å¤±è´¥ï¼Œä¸å½±å“æ•´ä¸ª Workflowï¼Œç»§ç»­å…¶ä»– Job
    continue-on-error: true
    
    # è®¾å®šæœ€é•¿ Timeout æ—¶é—´ï¼Œé˜²æ­¢å¼‚å¸¸æƒ…å†µå‘ç”Ÿæ—¶æ— æ­¢å°½çš„ç­‰å¾…
    timeout-minutes: 10

    # Runner Label - ä½¿ç”¨ GitHub Hosted Runner ubuntu-latest æ¥æ‰§è¡Œå·¥ä½œ
    # å¦‚æœæ˜¯ Private Repo ä¼šè®¡ç®—ç”¨é‡ï¼Œè¶…è¿‡å¯èƒ½ä¼šäº§ç”Ÿè´¹ç”¨
    runs-on: ubuntu-latest

    # å·¥ä½œæ­¥éª¤
    # å·¥ä½œæ­¥éª¤ä¼šç…§é¡ºåºæ‰§è¡Œ
    steps:
      # æ­¥éª¤åç§°
      - name: Get changed file count and apply label
        # æ­¥éª¤ ID (å¯çœç•¥ï¼Œåç»­è‹¥æ²¡æœ‰ Step è¦å¼•ç”¨ Output è¾“å‡ºåˆ™ä¸éœ€è®¾å®š)
        id: get-changed-files-count-by-gh
        # æ³¨å…¥å¤–éƒ¨ç¯å¢ƒå‚æ•°åˆ°æ‰§è¡Œé˜¶æ®µ
        env:
          # secrets.GITHUB_TOKEN æ˜¯ GitHub Actions æ‰§è¡Œæ—¶è‡ªåŠ¨äº§ç”Ÿçš„ Tokenï¼Œä¸éœ€è‡ªè¡Œåœ¨ Secrets è®¾å®šï¼Œæ‹¥æœ‰ä¸€äº› GitHub Repo API Scopes æƒé™
          # https://docs.github.com/en/actions/how-tos/security-for-github-actions/security-guides/use-github_token-in-workflows
          # gh(GitHub) cli éœ€è¦æ³¨å…¥ GH_TOKEN åˆ° ENVï¼Œgh æ‰æœ‰æƒé™æ“ä½œ  
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        # Shell script
        # GitHub Hosted Runner å†…å»ºéƒ½æœ‰å®‰è£…å¥½ gh cliï¼Œä¸éœ€è¦å®‰è£… Job å°±èƒ½ç›´æ¥ä½¿ç”¨
        run: \\|
          #   ${{ github.xxx }} æ˜¯ GitHub Actions Context è¡¨è¾¾å¼
          #   ä¸æ˜¯ Shell å˜æ•°ï¼Œè€Œæ˜¯ YAML è§£æé˜¶æ®µç”± GitHub Actions æ›¿æ¢æˆå¯¹åº”å€¼
          #   å…¶ä»–å‚æ•°ï¼šhttps://docs.github.com/en/actions/learn-github-actions/contexts#github-context
          
          # å–å¾— PR ç¼–å·:
          PR_NUMBER=${{ github.event.pull_request.number }}

          # å–å¾— Repo:
          REPO=${{ github.repository }}

          # ä½¿ç”¨ GitHub API (gh cli) å–å¾— File changed æ•°é‡
          FILE_COUNT=$(gh pr view $PR_NUMBER --repo $REPO --json files --jq '.files \\| length')
          
          # Print Log
          echo "Changed file count: $FILE_COUNT"

          # Label é€»è¾‘
          if [ "$FILE_COUNT" -lt 5 ]; then
            LABEL="XS"
          elif [ "$FILE_COUNT" -lt 10 ]; then
            LABEL="S"
          elif [ "$FILE_COUNT" -lt 30 ]; then
            LABEL="M"
          elif [ "$FILE_COUNT" -lt 80 ]; then
            LABEL="L"
          elif [ "$FILE_COUNT" -lt 200 ]; then
            LABEL="XL"
          else
            LABEL="XXL"
          fi

          # ä½¿ç”¨ GitHub API (gh cli) ç§»é™¤ç›®å‰çš„ Size Label
          EXISTING_LABELS=$(gh pr view "$PR_NUMBER" --repo "$REPO" --json labels --jq '.labels[].name')
          for EXISTING in $EXISTING_LABELS; do
            case "$EXISTING" in
              XS\\|S\\|M\\|L\\|XL\\|XXL)
                echo "ğŸ§¹ Removing existing label: $EXISTING"
                gh pr edit "$PR_NUMBER" --repo "$REPO" --remove-label "$EXISTING"
                ;;
            esac
          done

          # (å¯é€‰)å¦‚æœ Label ä¸å­˜åœ¨åˆ™å»ºç«‹
          if ! gh label list --repo "$REPO" \\| grep -q "^$LABEL"; then
            echo "ğŸ†• Creating missing label: $LABEL"
            gh label create "$LABEL" --repo "$REPO" --description "Size label: $LABEL" --color "ededed"
          else
            echo "âœ… Label '$LABEL' already exists"
          fi
          
          # ä½¿ç”¨ GitHub API (gh cli) æ ‡è®°ä¸Š Label
          gh pr edit $PR_NUMBER --repo $REPO --add-label "$LABEL"
```



Commit æ¡£æ¡ˆåˆ° Repo ä¸»åˆ†æ”¯ä¹‹åï¼Œæˆ‘ä»¬å†å¼€æ–° PR å°±ä¼šè‡ªåŠ¨è§¦å‘ GitHub Actionsï¼š



![](/assets/404bd5c70040/1*wdAztL0BgPeSZdqXxqUEXg.png)



Action æ‰§è¡ŒçŠ¶æ€æ˜¾ç¤º **Queued** ä»£è¡¨ä»»åŠ¡æ­£åœ¨ç­‰å¾… Runner æ¥ä»»åŠ¡å›å»åšã€‚



#### æ‰§è¡Œç»“æœ



![[Demo PR](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/pull/11){:target="_blank"}](/assets/404bd5c70040/1*-JoD8IQYHVrDqHmLmrXyaQ.png)



[Demo PR](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/pull/11){:target="_blank"}



æ‰§è¡Œå®Œæ¯•å¹¶ä¸”æˆåŠŸå PR ä¸Šå°±ä¼šè‡ªåŠ¨æ ‡è®°å¥½å¯¹åº”çš„ Label äº†ï¼çºªå½•ä¼šæ˜¾ç¤ºç”± `github-actions` æ ‡è®°ã€‚



**å®Œæ•´ç¨‹å¼ç ï¼š [Automation-PullRequest.yml](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/blob/main/.github/workflows/Automation-PullRequest.yml){:target="_blank"}**



#### ç›´æ¥ä½¿ç”¨åˆ«äººåŒ…å¥½çš„ Action æ­¥éª¤ï¼š [pascalgn/size-label-action](https://github.com/pascalgn/size-label-action/tree/main){:target="_blank"}



å‰é¢æœ‰è¯´åˆ°å¯ä»¥ç›´æ¥ä½¿ç”¨åˆ«äººå°è£…å¥½çš„ Actionï¼Œæ ‡è®° PR Size Label è¿™ä»»åŠ¡å·²ç»æœ‰ç°æˆçš„è½®å­å¯ä»¥ä½¿ç”¨ï¼Œä¸Šè¿°åªæ˜¯ä¸ºäº†æ•™å­¦ç›®çš„ï¼Œå®é™…ä¸Šä¸éœ€è¦è‡ªå·±é‡é€ è½®å­ã€‚



åªéœ€è¦åœ¨ Action Workflow Job Step ä¸­ç›´æ¥ä½¿ç”¨å°±èƒ½å®Œæˆä»»åŠ¡ï¼š



```yaml
# Workflow(Action) åç§°
name: Pull Reqeust Automation

# è§¦å‘äº‹ä»¶
on:
  # PR äº‹ä»¶
  pull_request:
    # PR - å¼€å¯ã€é‡å¼€ã€æœ‰æ–° Push Commit æ—¶
    types: [opened, synchronize, reopened]


# åŒä¸ª Concurrency Group å¦‚æœæœ‰æ–°çš„ Job ä¼šå–æ¶ˆæ­£åœ¨è·‘çš„
# ä¾‹å¦‚ Push Commit è§¦å‘çš„ä»»åŠ¡è¿˜æ²¡æ‰§è¡Œå°±åˆ Push Commit æ—¶ï¼Œä¼šå–æ¶ˆå‰ä¸€ä¸ªä»»åŠ¡
concurrency:
  group: ${{ github.workflow }}-${{ github.ref_name }}
  cancel-in-progress: true

# Job å·¥ä½œé¡¹ç›®
# Job ä¼šå¹¶å‘æ‰§è¡Œ
jobs:
  # Job ID
  label-pr-by-file-count:
    # Job åç§° (å¯çœç•¥ï¼Œæœ‰è®¾å®šåœ¨ Log æ˜¾ç¤ºæ¯”è¾ƒå¥½è¯»)
    name: Label PR by changes file count

    # å¦‚æœè¿™ä¸ª Job å¤±è´¥ï¼Œä¸å½±å“æ•´ä¸ª Workflowï¼Œç»§ç»­å…¶ä»– Job
    continue-on-error: true
    
    # è®¾å®šæœ€é•¿ Timeout æ—¶é—´ï¼Œé˜²æ­¢å¼‚å¸¸æƒ…å†µå‘ç”Ÿæ—¶æ— æ­¢å°½çš„ç­‰å¾…
    timeout-minutes: 10

    # Runner Label - ä½¿ç”¨ GitHub Hosted Runner ubuntu-latest æ¥æ‰§è¡Œå·¥ä½œ
    # å¦‚æœæ˜¯ Private Repo ä¼šè®¡ç®—ç”¨é‡ï¼Œè¶…è¿‡å¯èƒ½ä¼šäº§ç”Ÿè´¹ç”¨
    runs-on: ubuntu-latest

    # å·¥ä½œæ­¥éª¤
    # å·¥ä½œæ­¥éª¤ä¼šç…§é¡ºåºæ‰§è¡Œ
    steps:
      # æ­¥éª¤åç§°
      - name: Get changed file count and apply label
        # æ­¥éª¤ ID (å¯çœç•¥ï¼Œåç»­è‹¥æ²¡æœ‰ Step è¦å¼•ç”¨ Output è¾“å‡ºåˆ™ä¸éœ€è®¾å®š)
        id: get-changed-files-count-by-gh
        # ç›´æ¥ä½¿ç”¨åˆ«äººå°è£…å¥½çš„ç¨‹å¼
        uses: "pascalgn/size-label-action@v0.5.5"
        # æ³¨å…¥å¤–éƒ¨ç¯å¢ƒå‚æ•°åˆ°æ‰§è¡Œé˜¶æ®µ
        # å‚æ•°å‘½åã€å¯ç”¨å‚æ•°è¦å‚è€ƒè¯´æ˜ï¼šhttps://github.com/pascalgn/size-label-action/tree/main
        env:
          # secrets.GITHUB_TOKEN æ˜¯ GitHub Actions æ‰§è¡Œæ—¶è‡ªåŠ¨äº§ç”Ÿçš„ Token (github-actions èº«ä»½)ï¼Œä¸éœ€è‡ªè¡Œåœ¨ Secrets è®¾å®šï¼Œæ‹¥æœ‰ä¸€äº› GitHub Repo API Scopes æƒé™
          # https://docs.github.com/en/actions/how-tos/security-for-github-actions/security-guides/use-github_token-in-workflows
          GITHUB_TOKEN: "${{ secrets.GITHUB_TOKEN }}"
```



[![](https://opengraph.githubassets.com/1e5c6f52127032dc1a5fea71a498fa9cc585987880889f0306ef705de3990867/pascalgn/size-label-action)](https://github.com/pascalgn/size-label-action/tree/main){:target="_blank"}



è¿™ä¸ªåŒ…å¥½çš„ Action æ˜¯ JavaScript Actionï¼Œå®é™…æ‰§è¡Œç¨‹å¼ç å¯ä»¥å‚è€ƒä»¥ä¸‹æ¡£æ¡ˆï¼š [dist/index.js](https://github.com/pascalgn/size-label-action/blob/main/dist/index.js){:target="_blank"} ã€‚



#### name, run-name çš„è¡¥å……ï¼š



![](/assets/404bd5c70040/1*zBmjm_3AU53NN0UhTrmOBQ.png)



- name: Action Workflow çš„åç§°


- run-name: æ‰§è¡Œçºªå½•çš„æ ‡é¢˜åç§° (å¯å¸¦å…¥ PR Title or Branch or Authorâ€¦etc)
  å¦‚æœæ˜¯ on:pull_request äº‹ä»¶é¢„è®¾æ˜¯ PR Titleã€‚



### æ¡ˆä¾‹ â€” 2



å»ºç«‹ Pull Request åå¦‚æœæ²¡æœ‰ Assignee åˆ™è‡ªåŠ¨ Assign ä½œè€…è‡ªå·±å¹¶ä¸” Comment æç¤ºã€‚(åªæœ‰åœ¨åˆæ¬¡å»ºç«‹æ—¶æ‰ä¼šæ‰§è¡Œ)



#### æˆæœå›¾



![[Demo PR](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/pull/11){:target="_blank"}](/assets/404bd5c70040/1*EL-0nQF7jhP34d6ZoSkJAg.png)



[Demo PR](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/pull/11){:target="_blank"}



#### è¿ä½œæµç¨‹



- ä½¿ç”¨è€…å¼€ PR


- è§¦å‘ GitHub Actions Workflow


- github script å–å¾— assignee


- å¦‚æœæ²¡æœ‰ asignee åˆ™ assign å¼€ PR çš„ä½œè€… & Comment è®¯æ¯


- å®Œæˆ



#### åŠ¨æ‰‹åš



Repo â†’ Actions â†’ New workflow â†’ set up a workflow yourselfã€‚



**æ¡£æ¡ˆåç§°ï¼š** `Automation-PullRequest.yml` (åŒä¸Š)



#### `Automation-PullRequest.yml`



```yaml
# Workflow(Action) åç§°
name: Pull Reqeust Automation

# Actions Log çš„æ ‡é¢˜åç§°
run-name: "Pull Reqeust Automation - Daily Checker"

# è§¦å‘äº‹ä»¶
on:
  # PR äº‹ä»¶
  pull_request:
    # PR - å¼€å¯ã€é‡å¼€ã€æœ‰æ–° Push Commit æ—¶
    types: [opened, synchronize, reopened]


# åŒä¸ª Concurrency Group å¦‚æœæœ‰æ–°çš„ Job ä¼šå–æ¶ˆæ­£åœ¨è·‘çš„
# ä¾‹å¦‚ Push Commit è§¦å‘çš„ä»»åŠ¡è¿˜æ²¡æ‰§è¡Œå°±åˆ Push Commit æ—¶ï¼Œä¼šå–æ¶ˆå‰ä¸€ä¸ªä»»åŠ¡
concurrency:
  group: ${{ github.workflow }}-${{ github.ref_name }}
  cancel-in-progress: true

# Job å·¥ä½œé¡¹ç›®
# Job ä¼šå¹¶å‘æ‰§è¡Œ
jobs:
  # Job ID
  label-pr-by-file-count:
    # è¯·å‚è€ƒå‰æ–‡ï¼Œç•¥....
  # ---------
  assign-self-if-no-assignee:
    name: Automatically assign to self if no assignee is specified
    # å› ä¸ºæ˜¯å…±ç”¨è§¦å‘äº‹ä»¶ï¼Œæ‰€ä»¥åœ¨ Job ä¸Šè‡ªå·±åˆ¤æ–­ï¼Œå½“æ˜¯ Pull Request Opened(é¦–æ¬¡å»ºç«‹) æ—¶æ‰æ‰§è¡Œ Job å¦åˆ™ä¼š Skipped
    if: github.event_name == 'pull_request' && github.event.action == 'opened'

    # å¦‚æœè¿™ä¸ª Job å¤±è´¥ï¼Œä¸å½±å“æ•´ä¸ª Workflowï¼Œç»§ç»­å…¶ä»– Job
    continue-on-error: true
    
    # è®¾å®šæœ€é•¿ Timeout æ—¶é—´ï¼Œé˜²æ­¢å¼‚å¸¸æƒ…å†µå‘ç”Ÿæ—¶æ— æ­¢å°½çš„ç­‰å¾…
    timeout-minutes: 10
    
    # Runner Label - ä½¿ç”¨ GitHub Hosted Runner ubuntu-latest æ¥æ‰§è¡Œå·¥ä½œ
    # å¦‚æœæ˜¯ Private Repo ä¼šè®¡ç®—ç”¨é‡ï¼Œè¶…è¿‡å¯èƒ½ä¼šäº§ç”Ÿè´¹ç”¨
    runs-on: ubuntu-latest

    steps:
      - name: Assign self if No Assignee
        # ä½¿ç”¨ GitHub Script (JavaScript) æ’°å†™è„šæœ¬ (Node.js ç¯å¢ƒ)
        # ç›¸è¾ƒä¸Šé¢ç›´æ¥ç”¨ Shell Script å†™èµ·æ¥æ›´æ–¹ä¾¿æ¼‚äº®
        # ä¹Ÿä¸éœ€è¦è‡ªè¡Œæ³¨å…¥ç¯å¢ƒå˜æ•°ã€GITHUB_TOKEN
        uses: actions/github-script@v7
        with:
          script: \\|
            // github-script ä¸­ä¼šè‡ªåŠ¨æ³¨å…¥åˆ° context å˜æ•°ä¾› javascript ç›´æ¥å¼•ç”¨
            // https://docs.github.com/en/actions/learn-github-actions/contexts#github-context

            const issue = context.payload.pull_request; // å¦‚æœè¦è¿ Issue ä¸€èµ·æ”¯æ´å¯å†™æˆ context.payload.issue \\|\\| context.payload.pull_request
            const assignees = issue.assignees \\|\\| [];
            const me = context.actor;

            if (assignees.length === 0) {
              // Assignee è®¾æˆè‡ªå·±
              await github.rest.issues.addAssignees({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: issue.number,
                assignees: [me]
              });

              // ç•™è¨€é€šçŸ¥
              await github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: issue.number,
                body: `ğŸ”§ No assignee was set, so I have assigned this to myself (@${me}).`
              });
            }
```



è¿™æ¬¡æˆ‘ä»¬ç¤ºèŒƒæ”¹ç”¨ GitHub Script (JavaScript) æ’°å†™è„šæœ¬ï¼Œç¨‹å¼ç è¯­æ³•ä¸Šæ›´å¼¹æ€§æ›´å¥½æ’°å†™ã€‚



å½“ç„¶å¦‚æœä½ æƒ³ç…§æˆ‘ä¹‹å‰è¯´çš„æ¯ä¸ªä»»åŠ¡ä¸€ä¸ªæ¡£æ¡ˆï¼Œå°±å¯ä»¥æ‹”æ‰ Job If. . ç›´æ¥åœ¨ Action Workflow è§¦å‘æ¡ä»¶è®¾å®šï¼š



`Automation-PullRequest-Auto-Assign.yml` **ï¼š**



```yaml
# Workflow(Action) åç§°
name: Pull Reqeust Automation - Auto Assignee Self

# è§¦å‘äº‹ä»¶
on:
  # PR äº‹ä»¶
  pull_request:
    # PR - å¼€å¯æ—¶
    types: [opened]

jobs:
  assign-self-if-no-assignee:
    name: Automatically assign to self if no assignee is specified
    runs-on: ubuntu-latest
    steps:
      # è¯·å‚è€ƒå‰æ–‡ï¼Œç•¥....
```



Commit æ¡£æ¡ˆåˆ° Repo ä¸»åˆ†æ”¯ä¹‹åï¼Œæˆ‘ä»¬å†å¼€æ–° PR å°±ä¼šè‡ªåŠ¨è§¦å‘ GitHub Actionsï¼š



![](/assets/404bd5c70040/1*Y-A6owUibNEFBoRFHnqIYg.png)



ç°åœ¨æœ‰ä¸¤ä¸ª Job è¦æ‰§è¡Œäº†ï¼



#### æ‰§è¡Œç»“æœ



![[Demo PR](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/pull/11){:target="_blank"}](/assets/404bd5c70040/1*23muCVgUJKmZt746khBMFQ.png)



[Demo PR](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/pull/11){:target="_blank"}



æ‰§è¡Œå®Œæ¯•å¹¶ä¸”æˆåŠŸå PR å¦‚æœæ²¡æœ‰ Asignees ä¼šè‡ªåŠ¨ Assign PR ä½œè€…å¹¶ä¸” Comment è®¯æ¯ã€‚(éƒ½æ˜¯ç”¨ `github-actions` èº«ä»½æ“ä½œ)



**å®Œæ•´ç¨‹å¼ç ï¼š [Automation-PullRequest.yml](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/blob/main/.github/workflows/Automation-PullRequest.yml){:target="_blank"}**



#### æµ‹è¯•é‡å¼€(Reopened) PR



![](/assets/404bd5c70040/1*mcDa7TZjv6mO7HtwhOE-Vw.png)



å¯çœ‹åˆ°åªä¼šæ‰§è¡Œ Size Label Jobï¼ŒAuto Assignee Job è¢« Skipped äº†ã€‚



> *è¿™ä¸ªä»»åŠ¡ä¹Ÿæœ‰äººåŒ…å¥½ Action å¯ä»¥ç›´æ¥å¤ç”¨ï¼Œå¯å‚è€ƒï¼š [pozil/auto-assign-issue](https://github.com/pozil/auto-assign-issue){:target="_blank"} ã€‚*



### æ¡ˆä¾‹ â€” 3



æ¯æ—¥æ—©ä¸Š 9 ç‚¹è‡ªåŠ¨ç»Ÿè®¡å½“å‰ PR æ•°é‡åŠå·²å¼€å¯å¤šä¹…æ—¶é—´å‘é€é€šçŸ¥è®¯æ¯åˆ° Slack å·¥ä½œå¯»ç»„ã€è‡ªåŠ¨å…³é—­å·²å¼€å¯è¶…è¿‡ 3 ä¸ªæœˆçš„ PRã€‚



#### æˆæœå›¾



![](/assets/404bd5c70040/1*0stX9KpZi6PcXpG-90wyIg.png)



![](/assets/404bd5c70040/1*Nbg3r1zzhx24YIBEjPJnaw.png)



- Slack å·¥ä½œç¾¤ç»„æ¯å¤©æ—©ä¸Šè‡ªåŠ¨æ”¶åˆ°æŠ¥å‘Š


- è‡ªåŠ¨å…³é—­è¶…è¿‡ 90 å¤©çš„ PR



#### è¿ä½œæµç¨‹



- GitHub Actions æ¯å¤©æ—©ä¸Š 9 ç‚¹è‡ªåŠ¨è§¦å‘


- è§¦å‘ GitHub Actions Workflow


- github script å–å¾— å¼€å¯ä¸­çš„ PR åˆ—è¡¨ã€ç»Ÿè®¡å¼€å¯äº†å‡ å¤©


- ä¼ é€ç»Ÿè®¡æŠ¥å‘Šè®¯æ¯åˆ° Slack


- å…³é—­è¶…è¿‡ 90 å¤©çš„ PR


- å®Œæˆ



#### åŠ¨æ‰‹åš



Repo â†’ Actions â†’ New workflow â†’ set up a workflow yourselfã€‚



**æ¡£æ¡ˆåç§°ï¼š** `Automation-PullRequest-Daily.yml`



#### Automation-PullRequest-Daily.yml



```yaml
# Workflow(Action) åç§°
name: Pull Reqeust Automation - Daily Checker

# è§¦å‘äº‹ä»¶
on:
  # æ’ç¨‹å®šæ—¶è‡ªåŠ¨æ‰§è¡Œ
  # https://crontab.guru/
  # UTC æ—¶é—´
  schedule:
    # UTC çš„ 01:00 = æ¯å¤© UTC+8 çš„ 09:00
    - cron: '0 1 * * *'
  # æ‰‹åŠ¨è§¦å‘
  workflow_dispatch:

# Job å·¥ä½œé¡¹ç›®
# Job ä¼šå¹¶å‘æ‰§è¡Œ
jobs:
  # Job ID
  caculate-pr-status:
    # Job åç§° (å¯çœç•¥ï¼Œæœ‰è®¾å®šåœ¨ Log æ˜¾ç¤ºæ¯”è¾ƒå¥½è¯»)
    name: Caculate PR Status
    # Runner Label - ä½¿ç”¨ GitHub Hosted Runner ubuntu-latest æ¥æ‰§è¡Œå·¥ä½œ
    # å¦‚æœæ˜¯ Private Repo ä¼šè®¡ç®—ç”¨é‡ï¼Œè¶…è¿‡å¯èƒ½ä¼šäº§ç”Ÿè´¹ç”¨
    runs-on: ubuntu-latest

    # Job Output
    outputs:
      pr_list: ${{ steps.pr-info.outputs.pr_list }}

    # å·¥ä½œæ­¥éª¤
    # å·¥ä½œæ­¥éª¤ä¼šç…§é¡ºåºæ‰§è¡Œ
    steps:
      # æ­¥éª¤åç§°
      - name: Fetch open PRs and caculate
        # Step å¤–éƒ¨è¦å¼•ç”¨ Output è¾“å‡ºï¼Œéœ€è®¾å®š
        id: pr-info
        uses: actions/github-script@v7
        with:
          script: \\|
            const now = new Date();
            const per_page = 100;
            let page = 1;
            let allPRs = [];
      
            while (true) {
              const { data: prs } = await github.rest.pulls.list({
                owner: context.repo.owner,
                repo: context.repo.repo,
                state: 'open',
                per_page,
                page,
              });
              if (prs.length === 0) break;
              allPRs = allPRs.concat(prs);
              if (prs.length < per_page) break;
              page++;
            }
      
            const result = allPRs.map(pr => {
              const created = new Date(pr.created_at);
              const daysOpen = Math.floor((now - created) / (1000 * 60 * 60 * 24));
              return {
                pr: pr.number.toString(),
                title: pr.title,
                idle: daysOpen
              };
            });

            // è®¾å®šå› Outputï¼Œåªæ¥å— String
            core.setOutput('pr_list', JSON.stringify(result));
  # ----
  send-pr-summary-message-to-slack:
    name: Send PR Summary Messag to Slack
    # Job é¢„è®¾æ˜¯å¹¶å‘ï¼Œä½¿ç”¨ needs å¯ä»¥è¿«ä½¿å½“å‰ Job ç­‰åˆ° need Job å®Œæˆæ—¶æ‰ä¼šæ‰§è¡Œ
    needs: [caculate-pr-status]
    runs-on: ubuntu-latest
    
    steps:
      - name: Generate Message
        # Step å¤–éƒ¨è¦å¼•ç”¨ Output è¾“å‡ºï¼Œéœ€è®¾å®š
        id: gen-msg
        uses: actions/github-script@v7
        with:
          script: \\|
            const prList = JSON.parse(`${{ needs.caculate-pr-status.outputs.pr_list }}`);
            const blocks = [];
      
            // æ ‡é¢˜
            blocks.push({
              type: "section",
              text: {
                type: "mrkdwn",
                text: `ğŸ“¬ *Open PR Report*\nTotal: *${prList.length}* PR(s)`
              }
            });
      
            // æ¯ä¸ª PR ä¸€è¡Œ
            for (const pr of prList) {
              blocks.push({
                type: "section",
                text: {
                  type: "mrkdwn",
                  text: `â€¢ <https://github.com/${context.repo.owner}/${context.repo.repo}/pull/${pr.pr}\\|PR #${pr.pr}> *${pr.title}* - ğŸ•’ ${pr.idle} day(s)`
                }
              });
            }

            // è®¾å®šå› Outputï¼Œåªæ¥å— String
            core.setOutput('blocks', JSON.stringify(blocks));

            
      # ä½¿ç”¨ Slack å®˜æ–¹å°è£…å¥½çš„ Slack API Github Actions
      # https://tools.slack.dev/slack-github-action/sending-techniques/sending-data-slack-api-method/
      # å‘é€è®¯æ¯
      - name: Post text to a Slack channel
        uses: slackapi/slack-github-action@v2.1.0
        with:
          method: chat.postMessage
          token: ${{ secrets.SLACK_BOT_TOKEN }}
          payload: \\|
            channel: ${{ vars.SLACK_TEAM_CHANNEL_ID }}
            blocks: ${{ steps.gen-msg.outputs.blocks }}
  # ----
  auto-close-old-prs:
    name: Auto Close Old PRs
    needs: [caculate-pr-status]
    runs-on: ubuntu-latest

    steps:
      - name: Auto close PRs opened more than 90 days
        uses: actions/github-script@v7
        with:
          script: \\|
            const prList = JSON.parse(`${{ needs.caculate-pr-status.outputs.pr_list }}`);
            const oldPRs = prList.filter(pr => pr.idle > 90);

            for (const pr of oldPRs) {
              await github.rest.pulls.update({
                owner: context.repo.owner,
                repo: context.repo.repo,
                pull_number: parseInt(pr.pr),
                state: 'closed'
              });

              await github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: parseInt(pr.pr),
                body: `âš ï¸ This pull request has been automatically closed because it has been open for more than 90 days. Please reopen if needed.`
              });
            }
            console.log(`Closed ${oldPRs.length} PR(s)`);
```



åœ¨è¿™ä¸ªèŒƒä¾‹ä¸­æˆ‘ä»¬ä½¿ç”¨ï¼š



- on: schedule Crontab æ’ç¨‹è‡ªåŠ¨è§¦å‘è·Ÿ workflow_dispatch æ”¯æ´æ‰‹åŠ¨è§¦å‘


- Job output/Step output (éƒ½åªèƒ½æ˜¯å­—ä¸²)


- å¤šä¸ª Jobs é¢„è®¾æ˜¯å¹¶å‘ä½†å¯ä»¥ç”¨ `needs` æ—¶é—´ä¾èµ–ç­‰å¾…å…³ç³»


- ä» Repo Secrets/Variables å–å¾—è®¾å®š


- ä¸²æ¥ Slack API



**Repo Secrets â€” æ–°å¢** `SLACK_BOT_TOKEN`



![](/assets/404bd5c70040/1*YC4DBHtKmX5XGgcSSzaE5A.png)



- Slack App å»ºç«‹ã€å‘è®¯æ¯æƒé™è®¾å®šå¯å‚è€ƒæˆ‘ [ä¹‹å‰çš„æ–‡ç« ](../bd94cc88f9c9/)



**Repo Variables â€” æ–°å¢** `SLACK_TEAM_CHANNEL_ID`



![](/assets/404bd5c70040/1*X4gZ5_IRvsiehAL0O9AleQ.png)



Commit æ¡£æ¡ˆåˆ° Repo ä¸»åˆ†æ”¯ä¹‹åï¼Œå›åˆ° Actions æ‰‹åŠ¨è§¦å‘çœ‹çœ‹ï¼š



> *æ—¥åä¼šæ¯æ—¥è‡ªåŠ¨è§¦å‘ã€‚*



![](/assets/404bd5c70040/1*WNFKXl-QC2WGyaSWep5-DA.png)



Actions â†’ Pull Request Automation â€” Daily Checker â†’ Run workflow â†’ Branch: main â†’ Run workflowã€‚



**æ‰§è¡Œåå¯ä»¥ç‚¹å‡»è¿›å…¥æŸ¥çœ‹æ‰§è¡ŒçŠ¶å†µï¼š**



![](/assets/404bd5c70040/1*4mvOxnd1uS4ZlxnNoNdHaQ.png)



![](/assets/404bd5c70040/1*BluzFgY2tM2E7DwoVq1jQw.png)



å› ä¸ºæœ‰ `needs` çš„é™åˆ¶ï¼ŒJobs æµç¨‹å°±ä¼šæ˜¯ `Cacluate PR Status` å…ˆå®Œæˆåæ‰ä¼šå¹¶å‘æ‰§è¡Œ `Auto Close Old PRs` å’Œ `Send PR Summary Message to Slack` ã€‚



#### æ‰§è¡Œç»“æœ



**ä»»åŠ¡éƒ½æˆåŠŸæ‰§è¡Œåå¯ä»¥æŸ¥çœ‹ Slack è®¯æ¯ï¼š**



![](/assets/404bd5c70040/1*0stX9KpZi6PcXpG-90wyIg.png)



æˆåŠŸ ğŸš€ğŸš€ğŸš€



**å®Œæ•´ç¨‹å¼ç ï¼š [Automation-PullRequest-Daily.yml](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/blob/main/.github/workflows/Automation-PullRequest-Daily.yml){:target="_blank"}**



### å°ç»“



> å¸Œæœ›ä¸Šé¢ä¸‰ä¸ªæ¡ˆä¾‹èƒ½è®©æ‚¨å¯¹ GitHub Actions æœ‰ä¸ªåˆæ­¥çš„äº†è§£ä¹Ÿå¸Œæœ›æœ‰æ¿€èµ·ä½ çš„è‡ªåŠ¨åŒ–å·¥ä½œåˆ›æ„ï¼Œå¯ä»¥è‡ªå·±å‘æƒ³å·¥ä½œæµç¨‹(è¯·åŠ¡å¿…å…ˆå‚è€ƒ [è§¦å‘äº‹ä»¶](https://docs.github.com/en/actions/reference/events-that-trigger-workflows){:target="_blank"} )ï¼Œç„¶åæ’°å†™è„šæœ¬æ‰§è¡Œï¼›ä¹Ÿè®°å¾—å…ˆå» [**Marketplace**](https://github.com/marketplace?type=actions){:target="_blank"} æ‰¾æ‰¾ç°æœ‰çš„æ­¥éª¤å¯ä»¥ç«™åœ¨å·¨äººçš„è‚©è†€ç›´æ¥ä½¿ç”¨ã€‚



æœ¬ç¯‡åªæ˜¯å…¥é—¨åŸºç¡€(ç”šè‡³æ²¡ Checkout Code)ï¼Œä¸‹ä¸€ç¯‡ã€Œ [**CI/CD å®æˆ˜æŒ‡å—ï¼ˆä¸‰ï¼‰ï¼šä½¿ç”¨ GitHub Actions å®ä½œ App ä¸“æ¡ˆçš„ CI ä¸ CD å·¥ä½œæµç¨‹**](../4b001d2e8440/) ã€ä¼šåœ¨ä»‹ç»æ›´å¤æ‚æ·±å…¥çš„ GitHub Actions Workflowã€‚



#### GitHub è‡ªåŠ¨åŒ–å»¶ä¼¸è®®é¢˜



GitHub å¯ä»¥ä¸ Slack æ•´åˆï¼Œè®¢é˜… Repo çš„ PR æ›´æ–°é€šçŸ¥ã€Push Default Branch é€šçŸ¥â€¦ç­‰ç­‰ã€‚



![](/assets/404bd5c70040/1*BMTT4koRBIIsQ7_mklC86w.png)



**é—®é¢˜ 1. GitHub è®¯æ¯æ— æ³•æ ‡è®°åˆ°äººï¼Œåªæ ‡è®°äº† GitHub å¸å·ï¼ŒSlack å¸å·æ”¶ä¸åˆ°é€šçŸ¥ï¼š**



![](/assets/404bd5c70040/1*Ddp0cEtXE10hScM1rozmtg.png)



![](/assets/404bd5c70040/1*uHGJ7l__AdYoWT9KpvihLQ.png)



[Slack App](https://slack.github.com/){:target="_blank"} or Apps æœå¯» GitHub â†’ æ‰“å¼€è®¯æ¯è§†çª— â†’å®Œæˆ **Connect GitHub Account** æ­¥éª¤ï¼Œè¿™æ · GitHub æ‰çŸ¥é“ä½ å¯¹åº”çš„ Slack UID æ˜¯ä»€ä¹ˆï¼Œæ‰èƒ½æ ‡è®°ä½ ã€‚



**é—®é¢˜ 2. Pull Request Reminder**



æˆ‘è®°å¾—è¿™æœ¬æ¥æ˜¯ç¬¬ä¸‰æ–¹å¼€å‘çš„åŠŸèƒ½ï¼Œåæ¥ç›´æ¥æ•´åˆåœ¨ GitHub é‡Œé¢äº†ï¼Œä¸è¦å‚»å‚»çš„è‡ªå·±ç”¨ GitHub Actions å†™è„šæœ¬åšï¼



![](/assets/404bd5c70040/1*BpMd2K0NBDE6xB1XzFY94Q.png)



> [***GitHub å†…å»ºçš„æ˜¯ by Team è®¾ç½®ï¼Œä½ éœ€è¦å…ˆä¸ºç»„ç»‡å¢åŠ  Teamã€Repo åŠ å…¥ Team ç„¶åæ‰èƒ½è®¾ç½® Pull Request Reminderã€‚***](https://docs.github.com/en/organizations/organizing-members-into-teams/managing-scheduled-reminders-for-your-team){:target="_blank"}



- è¾“å…¥å®Œ Slack Channel è·Ÿè§„åˆ™å‚¨å­˜ä¹‹åæ¯å¤©å°±ä¼šè‡ªåŠ¨ä¼ é€æç¤ºè®¯æ¯è·Ÿæ ‡è®° Reviewer äº†ï¼Œè®¾ç½®å¯ [å‚è€ƒ](https://michaelheap.com/github-scheduled-reminders/){:target="_blank"} ï¼Œç»“æœå¦‚ä¸‹å›¾ï¼š



![<https://michaelheap.com/github-scheduled-reminders/>{:target="_blank"}](/assets/404bd5c70040/1*kvqFXkIKIxP79Wm8vIaN0Q.png)



<https://michaelheap.com/github-scheduled-reminders/>{:target="_blank"}



**é—®é¢˜ 4. GitHub PR è®¯æ¯ï¼Œä½œè€…æ”¶ä¸åˆ°é€šçŸ¥ï¼š**



![](/assets/404bd5c70040/1*wmtXwXAcQZDXqInRd0ivPw.png)



> *è¿™æ˜¯ä¸€ä¸ªä¸‡å¹´çš„é—®é¢˜ï¼Œå°±æ˜¯ PR çš„ Slack è®¯æ¯ **å…¶å®ä½œè€…å¹¶ä¸çŸ¥é“æœ‰äºº Reply Threads è®¨è®º** ï¼ŒGitHub å‘çš„è¿™åˆ™ Slack è®¯æ¯åªä¼šæ ‡è®° Reviewersï¼Œä¸ä¼šæ ‡è®° Assignee or PR ä½œè€…ã€‚*



è¿™æ—¶å€™ GitHub Actions åšè‡ªåŠ¨åŒ–å°å·¥å…·å°±æ´¾ä¸Šç”¨åœºäº†ï¼Œæˆ‘ä»¬å¯ä»¥åŠ ä¸€ä¸ª Job åœ¨ PR Description æœ€å Append æ ‡è®°ä½œè€…ï¼Œè¿™æ ·è®¯æ¯ä¼ åˆ° Slack ä¹Ÿä¼šä¸€å¹¶æ ‡è®°åˆ°ä½œè€…çš„ Slack:



```bash
# Workflow(Action) åç§°
name: Pull Reqeust Automation
# è¯·å‚è€ƒå‰æ–‡ï¼Œç•¥....

  # ---------
  append-author-to-pr-description:
    name: Append author to PR description
    # å› ä¸ºæ˜¯å…±ç”¨è§¦å‘äº‹ä»¶ï¼Œæ‰€ä»¥åœ¨ Job ä¸Šè‡ªå·±åˆ¤æ–­ï¼Œå½“æ˜¯ Pull Request Opened(é¦–æ¬¡å»ºç«‹) æ—¶æ‰æ‰§è¡Œ Job å¦åˆ™ä¼š Skipped
    if: github.event_name == 'pull_request' && github.event.action == 'opened'
    
    # å¦‚æœè¿™ä¸ª Job å¤±è´¥ï¼Œä¸å½±å“æ•´ä¸ª Workflowï¼Œç»§ç»­å…¶ä»– Job
    continue-on-error: true
    
    # è®¾å®šæœ€é•¿ Timeout æ—¶é—´ï¼Œé˜²æ­¢å¼‚å¸¸æƒ…å†µå‘ç”Ÿæ—¶æ— æ­¢å°½çš„ç­‰å¾…
    timeout-minutes: 10
    
    # Runner Label - ä½¿ç”¨ GitHub Hosted Runner ubuntu-latest æ¥æ‰§è¡Œå·¥ä½œ
    # å¦‚æœæ˜¯ Private Repo ä¼šè®¡ç®—ç”¨é‡ï¼Œè¶…è¿‡å¯èƒ½ä¼šäº§ç”Ÿè´¹ç”¨
    # ä½†è¿™ç§è‡ªåŠ¨åŒ–å°å·¥ä½œä¸å¤ªå®¹æ˜“ç”¨è¿‡é‡
    runs-on: ubuntu-latest
    steps:
      - name: Append author to PR description
        env:
          # secrets.GITHUB_TOKEN æ˜¯ GitHub Actions æ‰§è¡Œæ—¶è‡ªåŠ¨äº§ç”Ÿçš„ Tokenï¼Œä¸éœ€è‡ªè¡Œåœ¨ Secrets è®¾å®šï¼Œæ‹¥æœ‰ä¸€äº› GitHub Repo API Scopes æƒé™
          # gh(GitHub) cli éœ€è¦æ³¨å…¥ GH_TOKEN åˆ° ENVï¼Œgh æ‰æœ‰æƒé™æ“ä½œ
          # https://docs.github.com/en/actions/how-tos/security-for-github-actions/security-guides/use-github_token-in-workflows
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}

          #   ${{ github.xxx }} æ˜¯ GitHub Actions Context è¡¨è¾¾å¼
          #   ä¸æ˜¯ Shell å˜æ•°ï¼Œè€Œæ˜¯ YAML è§£æé˜¶æ®µç”± GitHub Actions æ›¿æ¢æˆå¯¹åº”å€¼
          #   å…¶ä»–å‚æ•°ï¼šhttps://docs.github.com/en/actions/learn-github-actions/contexts#github-context
          PR_NUMBER: ${{ github.event.pull_request.number }}
          AUTHOR_TAG: '@${{ github.event.pull_request.user.login }}'
        run: \\|
          PR_BODY=$(gh pr view $PR_NUMBER --repo ${{ github.repository }} --json body -q ".body")
          NEW_BODY=$(printf "%s\n\nCreated by %s" "$PR_BODY" "$AUTHOR_TAG")
          gh pr edit $PR_NUMBER --repo ${{ github.repository }} --body "$NEW_BODY"
```



**å®Œæ•´ç¨‹å¼ç ï¼š [Automation-PullRequest.yml](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/blob/main/.github/workflows/Automation-PullRequest.yml){:target="_blank"}**



å¼€ PR æ—¶ä¼šè‡ªåŠ¨åœ¨æè¿°ååŠ ä¸Šä½œè€…èµ„è®¯ã€Slack è®¯æ¯ä¹Ÿä¼šæ­£ç¡®çš„æ ‡è®°ä½œè€…ï¼š



![](/assets/404bd5c70040/1*UtTDtIQJ0vJks79UzCQSAQ.png)



![](/assets/404bd5c70040/1*MjVsFqE--xAq1zSQfCNVdQ.png)



**é—®é¢˜ 5. GitHub ç–¯ç‹‚å¯„é€šçŸ¥ä¿¡åˆ°ä¿¡ç®±å¾ˆå¹²æ‰°ï¼š**



GitHub Repo é€šçŸ¥è·Ÿ Slack éƒ½æœ‰è®¾å®šå¥½ä¹‹åï¼Œç»Ÿä¸€éƒ½åœ¨ Slack æ”¶é€šçŸ¥äº†ï¼Œå¯ä»¥å» GitHub ä¸ªäººè®¾å®šæŠŠ Email é€šçŸ¥å…³æ‰ï¼š



![](/assets/404bd5c70040/1*INgfO9B2bNFy-Nd1ZjnzOw.png)



#### å…¶ä»–



Actions ç›®å‰æ²¡æœ‰ç›®å½•ç»“æ„ï¼Œä½†å¯ä»¥åœ¨ Actions é¡µï¼Œç½®é¡¶(Pin) äº”ä¸ª Actionsï¼›ä¹Ÿå¯ä»¥ä½¿ç”¨ Disable æš‚åœæŸä¸ª Actionã€‚



![](/assets/404bd5c70040/1*ZD-5xkparhJqtnm2REeu6A.png)



å¯ä»¥åœ¨ Insights æŸ¥çœ‹ GitHub Actions ç”¨é‡è·Ÿæ‰§è¡Œæˆæ•ˆï¼š



![](/assets/404bd5c70040/1*re91ZRtQ0frOF6GVJ-MKrw.png)



### Reuse Workflow è¡¥å……



[ä¸‹ä¸€ç¯‡æ–‡ç« ](../4273e57e7148/) æœ‰ç”¨åˆ°åŒä¸ª Repo æ‹† Reuse Workflowï¼Œè¿™è¾¹è¡¥å……ä¸€ä¸‹ä¸åŒ Repo æ‹† Reuse Workflow çš„èŒƒä¾‹ã€‚



å…ˆå®šä¹‰ä¸€ä¸ª Reuse Workflow: [**Automation-label-pr-base-branch.yml:**](https://github.com/ZhgChgLi/github-actions-ci-cd-demo-share-actions/blob/main/.github/workflows/Automation-label-pr-base-branch.yml){:target="_blank"} **åœ¨ [ZhgChgLi/github-actions-ci-cd-demo-share-actions](https://github.com/ZhgChgLi/github-actions-ci-cd-demo-share-actions/blob/main/.github/workflows/Automation-label-pr-base-branch.yml){:target="_blank"} Repo** ã€‚



```yaml
name: Automation-label-pr-base-branch
run-name: "[Automation-label-pr-base-branch] ${{ github.event.inputs.PR_NUMBER \\|\\| github.ref }}"

concurrency:
  group: ${{ github.workflow }}-${{ github.event.inputs.PR_NUMBER \\|\\| github.ref }}
  cancel-in-progress: true

# è§¦å‘äº‹ä»¶
on:
  # å…¶ä»– Workflow å‘¼å«æ­¤ Workflow è§¦å‘
  workflow_call:
    # èµ„æ–™è¾“å…¥
    inputs:
      # PR Number
      PR_NUMBER:
        required: true
        type: string
    # å¯†é’¥è¾“å…¥
    secrets:
      GH_TOKEN:
        description: "GitHub token for API access"
        required: true
jobs:
  label-pr-base-branch:
    name: Label PR Base Branch
    continue-on-error: true
    timeout-minutes: 10
    runs-on: ubuntu-latest

    steps:
      - name: Label PR by Base Branch
        id: label-pr-base-branch
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: \\|
          PR_NUMBER="${{ inputs.PR_NUMBER }}"
          REPO="${{ github.repository }}"

          echo "ğŸ“¦ Processing PR #$PR_NUMBER in repo $REPO"

          # å–å¾— PR çš„ base branch
          BASE_BRANCH=$(gh pr view "$PR_NUMBER" --repo "$REPO" --json baseRefName --jq '.baseRefName')
          echo "ğŸ”– PR Base Branch: $BASE_BRANCH"

          # å…è®¸çš„ base branch labels
          BRANCH_LABELS=("develop" "main" "master")

          # Label æ˜¯å¦åœ¨å…è®¸åˆ—è¡¨
          if [[ " ${BRANCH_LABELS[@]} " =~ " ${BASE_BRANCH} " ]]; then
            LABEL="$BASE_BRANCH"
          else
            echo "âš ï¸ Base branch '$BASE_BRANCH' not in allowed list, skipping label."
            exit 0
          fi

          # ç§»é™¤ç°æœ‰çš„ base branch labels
          EXISTING_LABELS=$(gh pr view "$PR_NUMBER" --repo "$REPO" --json labels --jq '.labels[].name')
          for EXISTING in $EXISTING_LABELS; do
            if [[ " ${BRANCH_LABELS[@]} " =~ " ${EXISTING} " ]]; then
              echo "ğŸ§¹ Removing existing base branch label: $EXISTING"
              gh pr edit "$PR_NUMBER" --repo "$REPO" --remove-label "$EXISTING"
            fi
          done

          # å¦‚æœ Label ä¸å­˜åœ¨åˆ™å»ºç«‹
          if ! gh label list --repo "$REPO" \\| grep -q "^$LABEL$"; then
            echo "ğŸ†• Creating missing label: $LABEL"
            gh label create "$LABEL" --repo "$REPO" --description "PR targeting $LABEL branch" --color "ededed"
          else
            echo "âœ… Label '$LABEL' already exists"
          fi

          # åŠ ä¸Š base branch label
          echo "ğŸ·ï¸ Adding label '$LABEL' to PR #$PR_NUMBER"
          gh pr edit "$PR_NUMBER" --repo "$REPO" --add-label "$LABEL"
```



å›åˆ°æˆ‘ä»¬çš„ **ä¸» [ZhgChgLi/github-actions-ci-cd-demo](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/blob/main/.github/workflows/Demo-Reuse-Action-From-Another-Repo.yml){:target="_blank"} Repoï¼Œ** æ–°å¢ä¸€ä¸ªä¸» **Workflow [Demo-Reuse-Action-From-Another-Repo.yml](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/blob/main/.github/workflows/Demo-Reuse-Action-From-Another-Repo.yml){:target="_blank"} :**



```yaml
name: Automation-label-pr-base-branch

on:
  pull_request:
    types: [opened]

jobs:
  call-label-pr-workflow:
    name: Call Base Branch Label Workflow
    # âœ… å¦‚æœè¢«å‘¼å«çš„ workflow åœ¨åŒä¸€ä¸ª repoï¼š
    #    uses: ./.github/workflows/Automation-label-pr-base-branch.yml
    #    æ³¨æ„ï¼šè¿™ç§å†™æ³•æ— æ³•æŒ‡å®šåˆ†æ”¯ï¼ˆå›ºå®šä½¿ç”¨ caller workflow çš„ branchï¼‰
    #    å‚è€ƒèŒƒä¾‹ï¼š
    #    - CD-Deploy-Form.yml å‘¼å«æœ¬ repo workflow
    #    - CD-Deploy.yml å‘¼å«è·¨ repo workflow
    #
    # âœ… å¦‚æœè¢«å‘¼å«çš„ workflow åœ¨å…¶ä»– repoï¼š
    #    uses: {owner}/{repo}/.github/workflows/{file}.yml@{branch_or_tag}
    #    å¯ä»¥æŒ‡å®š branch æˆ– tag
    #    ref: https://github.com/ZhgChgLi/github-actions-ci-cd-demo-share-actions/blob/main/.github/workflows/Automation-label-pr-base-branch.yml
    uses: ZhgChgLi/github-actions-ci-cd-demo-share-actions/.github/workflows/Automation-label-pr-base-branch.yml@main
    with:
      PR_NUMBER: ${{ github.event.number }}
      
    # å¦‚æœæ‰€æœ‰ secrets éƒ½è¦ç»§æ‰¿ caller workflowï¼Œç›´æ¥ç”¨ `inherit`
    # secrets: inherit
    #
    # å¦‚æœåªè¦ä¼ ç‰¹å®š secretsï¼Œä¸ªåˆ«æŒ‡å®š
    secrets:
      GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```



Commit æ¡£æ¡ˆåå¼€ PR è¯•è¯•çœ‹ã€‚



**å·¥ä½œæµç¨‹ï¼šä¸» Repo çš„ [Demo-Reuse-Action-From-Another-Repo.yml](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/blob/main/.github/workflows/Demo-Reuse-Action-From-Another-Repo.yml){:target="_blank"} â†’ å‘¼å«å¹¶æŠŠå‚æ•°ä¼ åˆ°å¦ä¸€ä¸ª Repo çš„ [Automation-label-pr-base-branch.yml](https://github.com/ZhgChgLi/github-actions-ci-cd-demo-share-actions/blob/main/.github/workflows/Automation-label-pr-base-branch.yml){:target="_blank"} æ‰§è¡Œä»»åŠ¡ â†’ å›åˆ°ä¸» Repo å›æŠ¥ç»“æœã€‚**



![](/assets/404bd5c70040/1*13bqlAgpBkHM7UthTJAuOg.png)



![](/assets/404bd5c70040/1*CAF3HzS4PHBveDQYu3H73g.png)



æˆåŠŸï¼



#### Private Repo å­˜å–é—®é¢˜



è¿™è¾¹è¦æ³¨æ„ä¸€ä¸ªå®‰å…¨æ€§é—®é¢˜ï¼ŒPublic Repo å®Œå…¨æ²¡é—®é¢˜ï¼Œä½†å¦‚æœ Reuse Workflow åœ¨ Private Repo å½“ä¸­ï¼Œåªæœ‰åœ¨ **åŒä¸ªç»„ç»‡ä¸‹çš„å…¶ä»– Repo + Repo åŒæ ·ä¹Ÿæ˜¯ Private + è®¾å®šå…è®¸** =æ‰èƒ½å­˜å–ä½¿ç”¨ Private Repo Reuse Workflowã€‚



- `Public â€” ZhgChgLi/ReuseRepo` + `Private or Public-ZhgChgli or harry/myRepo` = âœ…


- `Private â€” ZhgChgLi/ReuseRepo` + `Private or Publicâ€” harry/myRepo` = âŒ


- `Private â€” ZhgChgLi/ReuseRepo` + `Public â€” ZhgChgLi/anotherRepo` = âŒ


- `Private â€” ZhgChgLi/ReuseRepo` + `Private â€” ZhgChgLi/anotherRepo` = âœ…



**è®¾å®šå…è®¸çš„æ–¹å¼ï¼Œè¦å» Reuse Workflow Repo â†’ Settings â†’ Actions â†’ General â†’ Acces:**



![](/assets/404bd5c70040/1*iZCEifgyArTJS3URMSk01g.png)



æ”¹å‹¾é€‰ï¼š



```
Accessible from repositories in the 'ZhgChgLi' organization
Workflows in other repositories that are part of the 'ZhgChgLi' organization can access the actions and reusable workflows in this repository. Access is allowed only from private repositories.
```



ç‚¹å‡»ã€ŒSaveã€å‚¨å­˜ï¼Œå®Œæˆã€‚



**å¦‚æœæ²¡æƒé™å­˜å–ä¼šå‡ºç°ä»¥ä¸‹é”™è¯¯è®¯æ¯ï¼š**



```bash
Invalid workflow file: .github/workflows/Demo-reuse-action-from-another-repo.yml#L21
error parsing called workflow
".github/workflows/Demo-reuse-action-from-another-repo.yml"
-> "ZhgChgLi/github-actions-ci-cd-demo-share-actions/.github/workflows/Automation-label-pr-base-branch.yml@main"
: workflow was not found.
```



### GitHub Actions Script è¯­æ³•è¡¥å……



è¡¥å……ä¸€ä¸‹å¤§å®¶å¯èƒ½ä¼šæ„Ÿåˆ°ç–‘æƒ‘çš„ `${{ XXX }}` or `${XXX}` or `$XXX` å˜æ•°è¯­æ³•ã€‚



**Demo-Env-Vars- .yml:**



```yaml
name: Demo-Env-Vars

on:
  workflow_dispatch:

jobs:
  print-env-vars:
    runs-on: ubuntu-latest

    steps:
      - name: print-env
        run: env
      - name: context-vars-vs-vars
        env:
          SAY_MY_NAME: "Heisenberg"
          # GitHub Actions Context è¡¨è¾¾å¼ï¼ŒåŒä¸‹æ–¹è§£é‡Š
          FROM_REF: "${{ github.ref }}"
        run: \\|
          # Sehll Script:
          # å¼•ç”¨è‡ªè®¢æ³¨å…¥çš„ ENV å˜æ•°å†…å®¹
          # ${SAY_MY_NAME} or $SAY_MY_NAME éƒ½å¯ä»¥
          # ${XX} é‡åˆ°å­—ä¸²æ‹¼æ¥æ¯”è¾ƒå¥½ç”¨:
          echo "HI: ${SAY_MY_NAME}"
          
          # ğŸ’¡ GitHub Actions Context è¡¨è¾¾å¼
          # è¿™ä¸æ˜¯ shell å˜æ•°ï¼Œè€Œæ˜¯ YAML è§£æé˜¶æ®µç”± GitHub Actions æ›¿æ¢æˆå¯¹åº”å€¼
          # âš  åœ¨æœ¬æœºæˆ–é GitHub Actions ç¯å¢ƒæ‰§è¡Œä¼šå¤±è´¥
          # ğŸ”— https://docs.github.com/en/actions/learn-github-actions/contexts#github-context
          BRANCH_NAME_FROM_CONTEXT="${{ github.ref }}"
          
          # ğŸ’¡ GitHub Actions æ‰§è¡Œé˜¶æ®µçš„ç¯å¢ƒå˜æ•°
          # è¿™äº›å˜æ•°åœ¨ runner æ‰§è¡Œ shell æ—¶ç”± GitHub Actions è‡ªåŠ¨æ³¨å…¥
          # âœ… åœ¨å…¶ä»–ç¯å¢ƒå¯ç”¨ export æˆ– ENV é¢„å…ˆå®šä¹‰ç›¸åŒå˜æ•°
          # ğŸ”— https://docs.github.com/en/actions/learn-github-actions/environment-variables
          BRANCH_NAME_FROM_ENV_VARS="${GITHUB_REF}"
          
          echo "FROM_REF: ${FROM_REF}"
          echo "BRANCH_NAME_FROM_CONTEXT: ${BRANCH_NAME_FROM_CONTEXT}"
          echo "BRANCH_NAME_FROM_ENV_VARS: ${BRANCH_NAME_FROM_ENV_VARS}"
      - name: print-github-script-env
        uses: actions/github-script@v7
        env:
          SAY_MY_NAME: "Heisenberg"
          # GitHub Actions Context è¡¨è¾¾å¼ï¼ŒåŒä¸Šæ–¹è§£é‡Š
          FROM_REF: "${{ github.ref }}"
        with:
          script: \\|
            // GitHub Script: (JavaScript (Node.js)):
            // ä» process.env å– ENV å€¼
            console.log(`HI: ${process.env.SAY_MY_NAME}`);
            console.log(`FROM_REF: ${process.env.FROM_REF}`);
            // github-script ä¸­ä¼šè‡ªåŠ¨æ³¨å…¥åˆ° context å˜æ•°ä¾› javascript ç›´æ¥å¼•ç”¨
            // https://docs.github.com/en/actions/learn-github-actions/contexts#github-context
            const branch_name_from_context_vars = context.ref;
            console.log(`branch_name_from_context_vars: ${branch_name_from_context_vars}`);
            // åŒæ ·ä¹Ÿèƒ½ç”¨ GitHub Actions Context è¡¨è¾¾å¼(åªæ˜¯æ„ä¹‰ä¸å¤§):
            const branch_name_from_context = "${{ github.ref }}";
            console.log(`branch_name_from_context: ${branch_name_from_context}`);
            
            for (const [key, value] of Object.entries(process.env)) {
              console.log(`${key}=${value}`);
            }
            // github-script ä¸­çš„ github ç‰©ä»¶æ˜¯ Octokit REST API å®ä¾‹
            // ç”¨æ¥æ“ä½œ github api ä½¿ç”¨
            // ä¾‹å¦‚ï¼š
            // await github.rest.pulls.list({
            //   owner: context.repo.owner,
            //   repo: context.repo.repo,
            //   state: "open"
            //  });
      # gh CLI does NOT use GITHUB_TOKEN by default; requires GH_TOKEN
      - name: gh CLI without GH_TOKEN (expected to fail)
        continue-on-error: true
        run: \\|
          PR_COUNT=$(gh pr list --repo $GITHUB_REPOSITORY --json number --jq 'length')
          echo "Found $PR_COUNT open pull requests"
      
      - name: gh CLI with GH_TOKEN (expected to succeed)
        env:
          # Assign GH_TOKEN so gh CLI can authenticate
          # https://docs.github.com/en/actions/how-tos/security-for-github-actions/security-guides/use-github_token-in-workflows
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: \\|
          PR_COUNT=$(gh pr list --repo $GITHUB_REPOSITORY --json number --jq 'length')
          echo "Found $PR_COUNT open pull requests"
      
      - name: github-script auto-authentication (no GH_TOKEN needed)
        uses: actions/github-script@v7
        with:
          script: \\|
            // github = Octokit REST client (auto-authenticated with GITHUB_TOKEN)
            const pulls = await github.rest.pulls.list({
              owner: context.repo.owner,
              repo: context.repo.repo,
              state: "open"
            });
            console.log(`Found ${pulls.data.length} open pull requests`);
```



#### ${ { XXX } } GitHub Actions Context è¡¨è¾¾å¼



![](/assets/404bd5c70040/1*e3jpPuwdmf005cjbaXjAwQ.png)



![](/assets/404bd5c70040/1*ed5Wm7Xk48xuP8yQzHpJ9w.png)



- `${{ XXX }}` æ˜¯ GitHub Actions Context è¡¨è¾¾å¼ï¼Œ **åœ¨YAML è§£æé˜¶æ®µç”± GitHub Actions æ›¿æ¢æˆå¯¹åº”å€¼** (å¦‚ä¸Šå›¾ `BRANCH_NAME_FROM_CONTEXT` )


- å®Œæ•´å¯ç”¨è¡¨è¾¾å¼å¯ [å‚è€ƒå®˜æ–¹æ–‡ä»¶](https://docs.github.com/en/actions/learn-github-actions/contexts#github-context){:target="_blank"}


- `${XXX}` or `$XXX` æ˜¯çœŸå®ç¯å¢ƒå˜æ•°ï¼Œ `${XXX}` åœ¨å­—ä¸²æ‹¼æ¥æ¯”è¾ƒå¥½ç”¨


- GitHub Actions é¢„è®¾ä¼šæ³¨å…¥ä¸€äº›ç¯å¢ƒå˜æ•°ï¼Œå®Œæ•´å¯ [å‚è€ƒå®˜æ–¹æ–‡ä»¶](https://docs.github.com/en/actions/learn-github-actions/environment-variables){:target="_blank"}



#### actions/github-script@v7



![](/assets/404bd5c70040/1*TjJQnlAAU3VRwS9_dFz1yA.png)



![](/assets/404bd5c70040/1*5bHEdjrGsVdWnYSQgpnsZA.png)



- åœ¨ `github-script` ä¸­åŒæ ·å¯ä»¥ç”¨ `${{ XXX }}` æ˜¯ GitHub Actions Context è¡¨è¾¾å¼ï¼Œä½†æ˜¯æ„ä¹‰ä¸å¤§ï¼›å› ä¸º **åœ¨ github-scirpt ç¯å¢ƒä¸­é¢„è®¾ä¼šæ³¨å…¥ context å˜æ•°å¯ä»¥ç›´æ¥åœ¨ javascript ä¸­å¼•ç”¨**


- åœ¨ `github-script` ä¸­ `github` ç‰©ä»¶æ˜¯ Octokit REST API å®ä¾‹


- `github-script` ä¹Ÿèƒ½ä» `env:` æ³¨å…¥å˜æ•°ï¼Œä½†æ˜¯è¦ç”¨ `${process.env.xxx}` å­˜å–


- åŒæ ·é¢„è®¾ä¼šæ³¨å…¥ä¸€äº›ç¯å¢ƒå˜æ•°ï¼Œå®Œæ•´å¯ [å‚è€ƒå®˜æ–¹æ–‡ä»¶](https://docs.github.com/en/actions/learn-github-actions/environment-variables){:target="_blank"} `${process.env.xxx}` å­˜å–ï¼›ä½†æ˜¯å·²ç»æœ‰ `context` å˜æ•°äº†ï¼Œä»è¿™å­˜å–æ„ä¹‰ä¹Ÿä¸å¤§



![](/assets/404bd5c70040/1*oW85Sju0sN4caXiaLSg32A.png)



- `github-script` ä¼šè‡ªåŠ¨å¸¦å…¥ `github-token` ï¼Œæ— éœ€æŒ‡å®š



#### gh cli GH_TOKEN



![](/assets/404bd5c70040/1*NUfaaKIobZWVBuXrGg0TPw.png)



- åœ¨ GitHub Actions Shell Script ä½¿ç”¨ `gh cli` éœ€æŒ‡å®š `GH_TOKEN` å‚æ•°


- å¯ä»¥ç›´æ¥å¸¦å…¥é¢„è®¾ Token â€” `secrets.GITHUB_TOKEN` (GitHub Actions æ‰§è¡Œæ—¶è‡ªåŠ¨äº§ç”Ÿ)


- **é¢„è®¾ Token æœ‰ä¸€äº›åŸºæœ¬æƒé™ï¼Œå¦‚æœè¦æ“ä½œçš„æŒ‡ä»¤æƒé™ä¸å¤Ÿå°±è¦æ”¹ç”¨ [Personal Access Token](https://docs.github.com/en/actions/how-tos/security-for-github-actions/security-guides/use-github_token-in-workflows){:target="_blank"}** ï¼Œå›¢é˜Ÿä½¿ç”¨å»ºè®®ç”¨å…±ç”¨å¸å·å»ºç«‹ PATã€‚



**å®Œæ•´ç¨‹å¼ç ï¼š [Demo-Env-Vars- .yml](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/blob/main/.github/workflows/Demo-Env-Vars-.yml){:target="_blank"}**



GitHub Actions å·²ç»å¼€å‘å¥½äº†ï¼Œä¸‹ä¸€æ­¥æˆ‘ä»¬å¯ä»¥æŠ½æ¢ GitHub Hosted Runner æˆè‡ªå·±çš„ Self-hosted Runnerã€‚



> *GitHub Hosted Runner æœ‰å…è´¹é¢åº¦ 2,000 åˆ†é’Ÿä¸€ä¸ªæœˆ(èµ·)ï¼Œè·‘è¿™ç§å°çš„è‡ªåŠ¨åŒ–ä»»åŠ¡èŠ±ä¸äº†å¤šå°‘æ—¶é—´ï¼Œè€Œä¸”æ˜¯è·‘åœ¨ linux æœºå™¨èŠ±è´¹å¾ˆä½ï¼Œå¯èƒ½è¿˜ç”¨ä¸åˆ°å…è´¹ä¸Šé™ï¼› **ä¸ä¸€å®šè¦æ”¹æˆ Self-hosted Runner** ï¼Œæ”¹ Runner è¿˜è¦ç¡®ä¿ Runner ç¯å¢ƒæ­£ç¡®(ä¾‹å¦‚ GitHub Hosted Runner è‡ªå¸¦ gh cliï¼Œself-hosted Runner å°±è®°å¾—è¦è‡ªå·±å®‰è£…å¥½)ï¼Œ **æœ¬æ–‡çº¯ç²¹æ˜¯å› ä¸ºæ•™å­¦æ‰ä¼šè¿™æ ·æŠ½æ¢** ã€‚*



> *å¦‚æœæ˜¯ç”¨åœ¨æ‰§è¡Œ CI/CD ä»»åŠ¡æ‰å¿…é¡»è¦ç”¨ Self-hosted Runnerã€‚*



#### æ–°å¢ Self-hosted Runner



> *æœ¬æ–‡ä»¥ **macOS M1** ä¸ºä¾‹ã€‚*



![](/assets/404bd5c70040/1*mEInaj-tLaprMAa2OfowCw.png)



- Settings â†’ Actions â†’ Runners â†’ New self-hosted runnerã€‚


- **Runner image:** macOS


- **Architecture** : M1 è®°å¾—é€‰ ARM64 æ‰§è¡Œæ¯”è¾ƒå¿«



**åœ¨å®ä½“ç”µè„‘ä¸Šå¼€ä¸€ä¸ª Termnialã€‚**



**æŒ‰ç…§ Download æ­¥éª¤åœ¨æœ¬åœ°ç”µè„‘å®Œæˆï¼š**



```bash
# åœ¨ä½ æƒ³è¦çš„è·¯å¾„ï¼Œå»ºç«‹ Runner ç›®å½•
mkdir actions-runner && cd actions-runner
# ä¸‹è½½ Runner image
curl -o actions-runner-osx-x64-2.325.0.tar.gz -L https://github.com/actions/runner/releases/download/v2.325.0/actions-runner-osx-x64-2.325.0.tar.gz

# Optional: Validate the hash
echo "0562bd934b27ca0c6d8a357df00809fbc7b4d5524d4aeb6ec152e14fd520a4c3  actions-runner-osx-x64-2.325.0.tar.gz" \\| shasum -a 256 -c

# è§£å‹ç¼©
tar xzf ./actions-runner-osx-x64-2.325.0.tar.gz
```



> *ä»¥ä¸Šåªæ˜¯å‚è€ƒï¼›å»ºè®®ç…§ä½ è®¾å®šé¡µé‡Œçš„æ­¥éª¤æ¥åšï¼Œæ‰ä¼šæ˜¯æœ€æ–°ç‰ˆæœ¬çš„ Runner imageã€‚*



![](/assets/404bd5c70040/1*Q0k0EPjrY2V4owseESe5lg.png)



**è®¾å®š Configure:**



```bash
# è¯·å‚è€ƒè®¾å®šé¡µæŒ‡ä»¤ï¼ŒToken ä¼šéšæ—¶é—´æ”¹å˜
./config.sh --url https://github.com/ORG/REPO --token XXX
```



ä¼šä¾åºè¦ä½ è¾“å…¥ï¼š



- Enter the name of the runner group to add this runner to: [press Enter for Default] **ç›´æ¥ Enter**
  *åªæœ‰æ³¨å†Œåˆ° Organization ç»„ç»‡å±‚çº§çš„ Runner æ‰æœ‰ Group åˆ†ç»„åŠŸèƒ½


- Enter the name of runner: [press Enter for ZhgChgLideMacBook-Pro] **å¯ä»¥è¾“å…¥æƒ³è®¾å®šçš„ Runner åç§° e.g.** `app-runner-1` **æˆ–ç›´æ¥ Enter**


- This runner will have the following labels: â€˜self-hostedâ€™, â€˜macOSâ€™, â€˜X64â€™
  Enter any additional labels (ex. label-1,label-2): [press Enter to skip]
  **è¾“å…¥æƒ³è¦è®¾å®šçš„ Runner labelï¼Œå¯ä»¥å¤šè¾“å…¥è‡ªè®¢ Label æ–¹ä¾¿ä¹‹åä½¿ç”¨**
  åŒå‰è¿° GitHub Acitons/Runner æ˜¯ä¾ç…§å¯¹åº” Label æ‰¾ä»»åŠ¡æ¥åšï¼Œ **å¦‚æœåªç”¨ default labelï¼ŒRunner å¯èƒ½ä¼šæ¡åˆ°ç»„ç»‡å†…çš„å…¶ä»– Runner æ¥æ‰§è¡Œå·¥ä½œï¼Œè‡ªè®¢ä¸€ä¸ªæœ€ä¿é™©** ã€‚
  è¿™è¾¹æˆ‘è‡ªå·±ä¹±å®šäº†ä¸€ä¸ª label `self-hosted-zhgchgli`


- Enter name of work folder: [press Enter for _work] **ç›´æ¥ Enter**



å‡ºç° âˆš Settings Saved. ä»£è¡¨è®¾å®šå®Œæˆäº†ã€‚



![](/assets/404bd5c70040/1*yxLfii0rWhzsiFuYVmPgFw.png)



**å¯åŠ¨ Runner:**



```bash
./run.sh
```



å‡ºç° âˆš Connected to GitHubã€Listening for Jobs å°±ä»£è¡¨å·²ç»åœ¨ç›‘å¬ Actions ä»»åŠ¡äº†ï¼š



![](/assets/404bd5c70040/1*1RmPPOosAoCxHA9tg_WE2w.png)



> ***è¿™ä¸ª Terminal è§†çª—ä¸å…³é—­å°±ä¼šæŒç»­æ¥æ”¶ä»»åŠ¡æ¥åšã€‚***



> ***ğŸš€ğŸš€ğŸš€åŒä¸€å°ç”µè„‘å¼€å¤šä¸ª Terminal åœ¨ä¸åŒç›®å½•å°±èƒ½èµ·å¤šä¸ª Runnerã€‚***



**å›åˆ° Repo è®¾å®šé¡µä¹Ÿèƒ½çœ‹åˆ° Runner æ­£åœ¨ç­‰å¾…ä»»åŠ¡ï¼š**



![](/assets/404bd5c70040/1*jjq5NTPYMuC3gH3ey_VTtg.png)



**Status:**



- Idle: é—²ç½®ï¼Œåœ¨ç­‰å¾…ä»»åŠ¡


- Active: æœ‰ä»»åŠ¡æ­£åœ¨æ‰§è¡Œ


- Offline: Runner ä¸åœ¨çº¿ä¸Š



#### Workflow(GitHub Actions) Runner æ”¹ç”¨ Self-hosted Runner



ä»¥ `Automation-PullRequest.yml` ä¸ºä¾‹ï¼š



```yaml
# è¯·å‚è€ƒå‰æ–‡ï¼Œç•¥....
jobs:
  label-pr-by-file-count:
    # è¯·å‚è€ƒå‰æ–‡ï¼Œç•¥....
    runs-on: [self-hosted-zhgchgli]
    # è¯·å‚è€ƒå‰æ–‡ï¼Œç•¥....
  # ---------
  assign-self-if-no-assignee:
    # è¯·å‚è€ƒå‰æ–‡ï¼Œç•¥....
    runs-on: [self-hosted-zhgchgli]

    steps:
      # è¯·å‚è€ƒå‰æ–‡ï¼Œç•¥....
```



Commit æ¡£æ¡ˆåˆ° Repo ä¸»åˆ†æ”¯ä¹‹åï¼Œé‡æ–°å¼€ PR è§¦å‘éªŒè¯ä¸€ä¸‹ Actionsã€‚



**å›åˆ° Runner Terminal å°±èƒ½çœ‹åˆ°æœ‰æ–°çš„ä»»åŠ¡è¿›æ¥äº†ï¼Œæ­£åœ¨æ‰§è¡Œè·Ÿæ‰§è¡Œç»“æœï¼š**



![](/assets/404bd5c70040/1*Hu0DxKQbenPmBEw8swv65A.png)



å¤±è´¥äº†ï¼Œå› ä¸ºæˆ‘æœ¬æœºç”µè„‘æ²¡æœ‰å®‰è£… [gh cli](https://github.com/cli/cli){:target="_blank"} ç¯å¢ƒï¼š



![](/assets/404bd5c70040/1*9xguacdPATIeEZdbFszmHw.png)



ä½¿ç”¨ `brew install gh` åœ¨å®ä½“ç”µè„‘ä¸Šå®‰è£…å®Œ gh åå†æ¬¡è§¦å‘æ‰§è¡Œï¼š



![](/assets/404bd5c70040/1*TbkAt00K89Ysbix33dK8ZA.png)



æˆåŠŸï¼ç°åœ¨è¿™ä¸ªä»»åŠ¡å°±å®Œå…¨æ˜¯ä½¿ç”¨æˆ‘ä»¬è‡ªå·±çš„ç”µè„‘åœ¨æ‰§è¡Œï¼Œä¸ä½¿ç”¨ GitHub Hosted Runnerã€ä¸è®¡è´¹ä½¿ç”¨ã€‚



**æˆ‘ä»¬å¯ä»¥ç‚¹è¿›å» Action Log æŸ¥çœ‹ä»»åŠ¡æ‰§è¡Œåœ¨çš„ Runnerã€æœºå™¨æ˜¯å“ªä¸€ä¸ªï¼š**



![](/assets/404bd5c70040/1*oqLcWfn6cbWsCt9fVsrikQ.png)



#### runs-on: [ **Runner Label] è®¾å®š**



è¿™é‡Œæ˜¯ AND ä¸æ˜¯ ORï¼ŒGitHub Runner æš‚ä¸æ”¯æ´ OR æŒ‘é€‰ Runner æ‰§è¡Œã€‚



ä¾‹å¦‚ï¼š `[self-hosted, macOS, app]` â†’ ä»£è¡¨ Runner è¦ **åŒæ—¶æœ‰** `self-hosted, macOS, app` è¿™ 3 ä¸ª Labels æ‰ä¼šåŒ¹é…æ¥ä»»åŠ¡æ¥æ‰§è¡Œã€‚



å¦‚æœä¸€ä¸ª Job æƒ³åŒæ—¶æµ‹è¯•ä¸åŒ Runner ç¯å¢ƒä¸‹çš„ç»“æœå¯ä»¥ä½¿ç”¨ `matrix` å‚æ•°ï¼š



```yaml
jobs:
  test:
    runs-on: ${{ matrix.runner }}
    strategy:
      matrix:
        runner:
          - [self-hosted, linux, high-memory]
          - [self-hosted, macos, xcode-15]

    steps:
      - run: echo "Running on ${{ matrix.runner }}"
```



è¿™æ ·è¿™ä¸ª Job ä¼šåœ¨ä¸‹åˆ—ä¸¤ä¸ª Runner Labels Runner ä¸­å¹¶è¡Œå„æ‰§è¡Œä¸€æ¬¡ï¼š



- self-hosted, linux, high-memory


- self-hosted, macos, xcode-15



> ***Runner æš‚ä¸æ”¯æ´ï¼š***



> *- OR æŒ‘é€‰ Runner*



> *- Runner æƒé‡è®¾å®š*



#### æ³¨å†Œ Runner æˆ Service



å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡ä»¶ã€Œ [Configuring the self-hosted runner application as a service](https://docs.github.com/en/actions/how-tos/hosting-your-own-runners/managing-self-hosted-runners/configuring-the-self-hosted-runner-application-as-a-service?platform=mac){:target="_blank"} ã€å°† Runner ç›´æ¥æ³¨å†Œæˆç³»ç»Ÿ Serviceï¼Œè¿™æ ·å°±èƒ½åœ¨èƒŒæ™¯æ‰§è¡Œ(ä¸ç”¨å¼€ Terminal åœ¨å‰æ™¯)ã€å¼€æœºåä¹Ÿä¼šè‡ªåŠ¨å¯åŠ¨ã€‚



æœ‰å¤šä¸ª Runner è®°å¾—è°ƒæ•´ã€Œ [Customizing the self-hosted runner service](https://docs.github.com/en/actions/how-tos/hosting-your-own-runners/managing-self-hosted-runners/configuring-the-self-hosted-runner-application-as-a-service?platform=mac#customizing-the-self-hosted-runner-service-1){:target="_blank"} ã€è®¾å®šæ³¨å†Œä¸åŒåç§°ã€‚



> *iOS è¿™è¾¹æˆ‘æœ‰ä¸€ä¸ªå¾…ç ”ç©¶æ’é™¤çš„é—®é¢˜ï¼Œ **å°±æ˜¯æˆ‘æ”¹ç”¨èƒŒæ™¯ Service ä¹‹ååœ¨ Archive ä¼šé‡åˆ°é”™è¯¯(ç–‘ä¼¼æ˜¯è·Ÿ keychain æƒé™æœ‰å…³)** ï¼Œå½“æ—¶æ²¡æ—¶é—´è§£å†³ï¼Œå°±å…ˆç”¨èµ·å‰æ™¯ Terminal Runner äº†ã€‚*



å¦‚æœæ˜¯ä¼ ç»Ÿå‰æ™¯è¦åšåˆ°å¼€æœºè‡ªåŠ¨å¯åŠ¨å°±è¦å» `~/Library/LaunchAgents` æ–°å¢ä¸€ä¸ªè‡ªåŠ¨å¯åŠ¨è®¾å®šæ¡£æ¡ˆï¼š



`actions.runner.REPO.RUNNER_NAME.plist` ï¼š



```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
 <dict>
  <key>Label</key>
  <string>actions.runner.REPO.RUNNER_NAME</string>
  <!-- æŒ‡å®š Terminal.app æ¥å¯åŠ¨ -->
  <key>ProgramArguments</key>
  <array>
   <string>/usr/bin/open</string>
   <string>-a</string>
   <string>Terminal</string>
   <string>/Users/zhgchgli/Documents/actions-runner/run.sh</string>
  </array>
  <key>RunAtLoad</key>
  <true/>
  <key>WorkingDirectory</key>
  <string>/Users/zhgchgli/Documents/actions-runner</string>
 </dict>
</plist>
```



> *æœ‰å…´è¶£æ·±å…¥ç ”ç©¶ DevOps çš„æœ‹å‹å¯å‚è€ƒå®˜æ–¹ [k8s Runner](https://docs.github.com/en/actions/concepts/runners/about-actions-runner-controller#scaling-runners){:target="_blank"} æ–‡ä»¶ã€‚*



#### å®Œæ•´ä¸“æ¡ˆ Repo



[![](https://opengraph.githubassets.com/8b25f8eae56bc35c92b97c5d7e7834aa5cb87673e718a1ce829f5bb80f3edebb/ZhgChgLi/github-actions-ci-cd-demo)](https://github.com/ZhgChgLi/github-actions-ci-cd-demo){:target="_blank"}



### å®˜æ–¹æ–‡ä»¶



[![](https://docs.github.com/assets/cb-345/images/social-cards/actions.png)](https://docs.github.com/en/actions/get-started/quickstart){:target="_blank"}



æ›´ç»†èŠ‚çš„è®¾ç½®æ–¹å¼è¯·åŠ¡å¿…å‚è€ƒå®˜æ–¹æ‰‹å†Œã€‚



#### AI Can Help!



![](/assets/404bd5c70040/1*JecNUCqujV1oeAvHA14X-g.png)



å®æµ‹ç»™ ChatGPT å®Œæ•´çš„æ­¥éª¤è·Ÿæ—¶æœºç‚¹å°±èƒ½å¸®ä½ å†™å¥½ GitHub Actions ç›´æ¥ä½¿ç”¨!



### æ€»ç»“



ç°åœ¨ä½ åº”è¯¥å·²ç»å¯¹ GitHub Actions + Self-hosted Runner æœ‰äº†ä¸€å®šç¨‹åº¦çš„äº†è§£ï¼Œä¸‹ä¸€ç¯‡æˆ‘å°†å¼€å§‹ä»¥ App (iOS) CI/CD ä¸ºæ¡ˆä¾‹ï¼Œæ‰‹æŠŠæ‰‹å»ºç½®æ•´å¥—æµç¨‹ã€‚



### ç³»åˆ—æ–‡ç« ï¼š



- [**CI/CD å®æˆ˜æŒ‡å—ï¼ˆä¸€ï¼‰ï¼šCI/CD æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•é€è¿‡ CI/CD æ‰“é€ ç¨³å®šé«˜æ•ˆçš„å¼€å‘å›¢é˜Ÿï¼Ÿå·¥å…·é€‰æ‹©ï¼Ÿ**](../c008a9e8ceca/)


- [**CI/CD å®æˆ˜æŒ‡å—ï¼ˆäºŒï¼‰ï¼šGitHub Actions ä¸ self-hosted Runner ä½¿ç”¨ä¸å»ºç½®å¤§å…¨**](../404bd5c70040/)


- [**CI/CD å®æˆ˜æŒ‡å—ï¼ˆä¸‰ï¼‰ï¼šä½¿ç”¨ GitHub Actions å®ä½œ App ä¸“æ¡ˆçš„ CI ä¸ CD å·¥ä½œæµç¨‹**](../4b001d2e8440/)


- [**CI/CD å®æˆ˜æŒ‡å—ï¼ˆå››ï¼‰ï¼šä½¿ç”¨ Google Apps Script Web App ä¸²æ¥ GitHub Actions å»ºç½®å…è´¹æ˜“ç”¨çš„æ‰“åŒ…å·¥å…·å¹³å°**](../4273e57e7148/)



#### [Buy me a coffee](https://www.buymeacoffee.com/zhgchgli){:target="_blank"}



> [***æœ¬ç³»åˆ—æ–‡ç« èŠ±è´¹äº†å¤§é‡çš„æ—¶é—´ç²¾åŠ›æ’°å†™ï¼Œå¦‚æœå†…å®¹å¯¹æ‚¨æœ‰å¸®åŠ©ã€å¯¹æ‚¨çš„å›¢é˜Ÿæœ‰å®è´¨æå‡å·¥ä½œæ•ˆç‡ä¸äº§å“å“è´¨ï¼›æ¬¢è¿è¯·æˆ‘å–æ¯å’–å•¡ï¼Œæ„Ÿè°¢æ”¯æŒï¼***](https://www.buymeacoffee.com/zhgchgli){:target="_blank"}



![[Buy me a coffee](https://www.buymeacoffee.com/zhgchgli){:target="_blank"}](/assets/404bd5c70040/1*QJj54G9gOjtQS-rbHVT1SQ.png)



[Buy me a coffee](https://www.buymeacoffee.com/zhgchgli){:target="_blank"}



æœ‰ä»»ä½•é—®é¢˜åŠæŒ‡æ•™æ¬¢è¿ [ä¸æˆ‘è”ç»œ](https://www.zhgchg.li/contact){:target="_blank"} ã€‚



*[Post](https://dev.zhgchg.li/ci-cd-%E5%AF%A6%E6%88%B0%E6%8C%87%E5%8D%97-%E4%BA%8C-github-actions-%E8%88%87-self-hosted-runner-%E4%BD%BF%E7%94%A8%E8%88%87%E5%BB%BA%E7%BD%AE%E5%A4%A7%E5%85%A8-404bd5c70040){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}.*