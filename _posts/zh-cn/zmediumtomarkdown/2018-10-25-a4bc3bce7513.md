---
author: ZhgChgLi
categories:
- ZRealm Dev.
date: 2018-10-25T14:26:20.002+0000
description: iPlayground 2018 å›æ¥ & UUIDé‚£äº›äº‹
image:
  path: /assets/a4bc3bce7513/1*gEmmuDOD92d2b2fLp4AKsw.jpeg
last_modified_at: 2024-04-13T07:21:43.386+0000
render_with_liquid: false
tags:
- iplayground
- swift
- ios-app-development
- uuid
- idfv
title: iOS UUID çš„é‚£äº›äº‹ (Swift/iOS â‰¥ 6)
---

### iOS UUID çš„é‚£äº›äº‹ (Swift/iOS â‰¥ 6)



iPlayground 2018 å›æ¥ & UUIDé‚£äº›äº‹



### å‰è¨€ï¼š



ä¸Šå‘¨å…­ã€æ—¥è·‘å»å‚åŠ  [iPlayground](https://iplayground.io/){:target="_blank"} Apple è½¯ä½“å¼€å‘è€…ç ”è®¨ä¼šï¼Œè¿™ä¸ªæ´»åŠ¨è®¯æ¯æ˜¯åŒäº‹PASSè¿‡æ¥çš„ï¼Œå»ä¹‹å‰æˆ‘ä¹Ÿä¸æ¸…æ¥šè¿™ä¸ªæ´»åŠ¨ã€‚



![](/assets/a4bc3bce7513/1*gEmmuDOD92d2b2fLp4AKsw.jpeg)



ä¸¤å¤©ä¸‹æ¥ï¼Œæ•´é¢˜æ´»åŠ¨è·Ÿæ—¶ç¨‹å®‰æ’æµç•…ï¼Œè®®ç¨‹å†…å®¹ï¼š



1. è¶£å‘³çš„ï¼šè„šè¸è½¦ã€å‡‹é›¶çš„Codeã€iOS/API æ¼”è¿›å²ã€å¨åˆ©åœ¨å“ªé‡Œ(CoreML Vision)


2. å®ç”¨çš„ï¼šæµ‹è¯•ç±» (XCUITestã€ä¾èµ–æ³¨å…¥)ã€SpriteKit åšåŠ¨ç”»æ•ˆæœçš„æ›¿ä»£æ–¹æ¡ˆã€GraphQL


3. çœŸåŠŸå¤«ï¼šæ·±å…¥æ‹†è§£Swiftã€iOS è¶Šç‹±/Tweakå¼€å‘ã€Redux



è„šè¸è½¦Project å°è±¡æ·±åˆ»ï¼Œç”¨iPhoneæ‰‹æœºå½“æ„Ÿæµ‹å™¨æ„Ÿæµ‹è„šè¸è½¦è¸æ¿è½¬åŠ¨ï¼Œç›´æ¥åœ¨å°ä¸Šéª‘è„šè¸è½¦åˆ‡æ¢æŠ•å½±ç‰‡(å‰è¾ˆä¸»è¦ç›®æ ‡æ˜¯è¦åšå¼€æºç‰ˆzwiftï¼Œä¹Ÿåˆ†äº«äº†è®¸å¤šåœ°é›·ï¼Œä¾‹å¦‚Client/Severé€šä¿¡ã€å»¶è¿Ÿé—®é¢˜ã€ç£åœºå¹²æ‰°)



å‡‹é›¶çš„Dirty Codeï¼›å¬å¾—å¿ƒæœ‰æˆšæˆšï¼Œåœ¨å¿ƒé‡Œä¼šå¿ƒä¸€ç¬‘ï¼›æŠ€æœ¯å€ºå°±æ˜¯è¿™æ ·ä¸€ç›´ç´¯ç§¯ä¸‹æ¥çš„ï¼Œå¼€å‘æ—¶ç¨‹èµ¶ï¼Œæ‰€ä»¥ç”¨æ¶æ„æ€§è¾ƒå·®çš„å¿«é€Ÿåšæ³•ï¼Œåäººæ¥æ‰‹æ”¹ä¹Ÿæ²¡æ—¶é—´é‡æ„ï¼Œå°±è¶Šç§¯è¶Šå¤šï¼›åˆ°æœ€åå¯èƒ½çœŸçš„åªæœ‰æ‰“æ‰è¿™æ¡è·¯äº†



æµ‹è¯•ç±»(Design Patterns in XCUITest) [KKBOXçš„å‰è¾ˆ](https://www.facebook.com/TestingWithKK/){:target="_blank"} ï¼Œå®Œå…¨æ²¡è—ç§ç›´æ¥å…¬å¼€ä»–ä»¬çš„ä½œæ³•åŠç¨‹å¼èŒƒä¾‹ç»†èŠ‚è¿˜æœ‰é‡åˆ°çš„é›·ã€è§£å†³åŠæ³•ï¼Œè¿™å ‚ä¹Ÿæ˜¯å¯¹æˆ‘ä»¬å·¥ä½œä¸Šæœ€æœ‰å¸®åŠ©çš„é¡¹ç›®ï¼›æµ‹è¯•è¿™å—æ˜¯æˆ‘ä¸€ç›´æƒ³åŠ å¼ºçš„éƒ¨åˆ†ï¼Œå¯ä»¥å›å»å¥½å¥½ç ”ç©¶ç ”ç©¶



Lighting Talkçš„éƒ¨åˆ†åœ¨å°ä¸‹å¬å¾—ä¹Ÿå¥½æƒ³ä¸Šå»åˆ†äº«ğŸ˜‚ ä¸‹æ¬¡è¦ææ—©åšå¥½å‡†å¤‡äº†!



ä¼šåçš„offical partyï¼Œé…’æ°´é£Ÿç‰©åœºåœ°éƒ½å¾ˆæœ‰è¯šæ„ï¼Œå¬å‰è¾ˆä»¬çš„çœŸå¿ƒè¯åéœ²ï¼Œå¾ˆè½»æ¾æœ‰è¶£ä¹‹å¤–è¿˜å¸æ”¶è®¸å¤šèŒåœºè½¯å®åŠ›ï¼



![å°å¤§åå°å’–å•¡](/assets/a4bc3bce7513/1*Xwk_96lVKcMKgeL7IOC70g.jpeg)



å°å¤§åå°å’–å•¡



æˆ‘æ‰çŸ¥é“åŸæ¥è¿™æ˜¯ç¬¬ä¸€å±Šï¼ŒçœŸçš„æœ‰è£å¹¸èƒ½å¤Ÿå‚åŠ ï¼Œæ‰€æœ‰å·¥ä½œäººå‘˜è·Ÿè®²è€…è¾›è‹¦äº†ï¼



å»å‚åŠ ç ”è®¨ä¼šçš„ç›®çš„ä¸å¤–ä¹å°±æ˜¯è¦ï¼š **å¢åŠ å¹¿åº¦** ï¼Œå¸æ”¶æ–°çŸ¥ã€äº†è§£ç”Ÿæ€ã€ç¢°ä¸€äº›å¹³å¸¸ä¸ä¼šæ¥è§¦çš„é¡¹ç›®è·Ÿ **å¢åŠ æ·±åº¦** ï¼Œå¦‚æœæ˜¯è‡ªå·±å·²ç»æ‘¸è¿‡çš„é¡¹ç›®å°±æ˜¯å»å¬å¬çœ‹æœ‰æ²¡æœ‰é—æ¼çš„åœ°æ–¹æˆ–æ˜¯è¿˜æœ‰å…¶ä»–åšæ³•æ²¡å‘ç°ï¼



æŠ„äº†è®¸å¤šç¬”è®°å¯ä»¥å›æ¥æ…¢æ…¢ç ”ç©¶å›å‘³ã€‚



### UUIDçš„é‚£äº›äº‹



å› ä¸ºæˆ‘å¬å®Œå›å»åé©¬ä¸Šå®é™…åº”ç”¨åˆ°APPä¸Šï¼›è¿™å ‚æ˜¯ç”±Zonbleå‰è¾ˆä¸»è®²ï¼Œæˆ‘å¬åˆ°ä»iPhone OS 2å†™åˆ°iOS 12æˆ‘å°±è·ªäº†ï¼›ç”±äºå…¥è¡Œè¾ƒæ™šï¼Œæˆ‘æ˜¯ä»iOS 11/Swift 4 æ‰å¼€å§‹å†™ï¼Œæ‰€ä»¥æ²¡ç¢°åˆ°é‚£äº›å› ä¸ºè‹¹æœä¿®æ”¹APIçš„åŠ¨ä¹±æ—¶æœŸã€‚



æƒ³æƒ³UUIDä»å¯ä»¥å–å¾—åˆ°å°é”ä¹Ÿæ˜¯è›®åˆç†çš„ï¼›å¦‚æœæ˜¯ç”¨åœ¨è‰¯å–„çš„åœ°æ–¹ï¼šè¾¨è¯†ä½¿ç”¨è€…è£…ç½®ã€å¹¿å‘Šæˆ–ç¬¬ä¸‰æ–¹è¿ç”¨å”¯ä¸€æ€§å»åšå¹¿å‘Šæ“ä½œï¼›ä½†å¦‚æœæœ‰å‚å•†æƒ³åšæ¶ï¼Œä¹Ÿå¯ä»¥é€è¿‡è¿™ä¸ªæœºåˆ¶åæŸ¥ï¼ŒçŸ¥é“ä½ è¿™åªæ‰‹æœºçš„ä¸»äººæ˜¯æ€ä¹ˆæ ·çš„äººï¼Ÿ(ä¾‹å¦‚æœ‰è£…æ—…æ¸¸+å°åŒ—ç­‰å…¬è½¦ï¼‹BMW APP+å©´å„¿ç…§æŠ¤ å°±èƒ½æ¨æµ‹ä½ å¾ˆå¸¸å‡ºå›½å®¶é‡Œæœ‰å°å­©è€Œä¸”ä½åœ¨å°åŒ— ä¹‹ç±»çš„èµ„è®¯)å†åŠ ä¸Šä½ åœ¨APPä¸Šè¾“å…¥çš„ä¸ªèµ„ï¼Œèƒ½æ‹¿å»åšä»€ä¹ˆåº”ç”¨ä¸æ•¢æƒ³åƒ



ä½†è¿™å…¶ä¸­ä¹Ÿæ³¢åŠåˆ°å¾ˆå¤šæ­£å½“å®ˆæ³•çš„ç”¨æˆ·ï¼Œåƒæ˜¯æœ¬æ¥ç”¨UUIDå½“ä½¿ç”¨è€…çš„èµ„æ–™è§£å¯†KEYæˆ–ç”¨UUIDå½“è£…ç½®åˆ¤æ–­éƒ½å—åˆ°å¾ˆå¤§çš„å½±å“ï¼›çœŸä½©æœé‚£ä¸ªæ—¶æœŸçš„å·¥ç¨‹å¸ˆå‰è¾ˆä»¬ï¼Œè¿™äº›å½±å“è€æ¿è·Ÿä½¿ç”¨è€…ä¸€å®šä¼šç‹‚éª‚ï¼Œè¦æ€¥ä¸­ç”Ÿæ™ºæ‰¾å…¶ä»–æ›¿ä»£åŠæ³•ï¼



#### æ›¿ä»£æ–¹æ¡ˆï¼š



æœ¬ç¯‡æ–‡ç« ä»¥å–å¾—UUIDè¾¨è¯†è£…ç½®å”¯ä¸€å€¼ä¸ºä¸»ï¼Œå¦‚æœæ˜¯è¦æ‰¾çŸ¥é“ä½¿ç”¨è€…è£…äº†å“ªäº›APPçš„æ›¿ä»£æ–¹æ¡ˆå¯å‚è€ƒä»¥ä¸‹å…³é”®å­—æœå¯»åšæ³•ï¼š [UIPasteboard pasteboardWithName: create: (è¿ç”¨å‰ªè´´ç°¿åœ¨APPé—´å…±äº«)](https://link.medium.com/YTheNPnHH7){:target="_blank"} ã€canOpenURL: info.plist LSApplicationQueriesSchmes (è¿ç”¨canOpenURLæ£€æŸ¥APOæœ‰æ— å®‰è£…ï¼Œè¦åœ¨info.pliståˆ—ä¸¾ï¼Œæœ€å¤š50ç¬”)



1. ç”¨MAC Addresså½“UUIDï¼Œä½†åæ¥ä¹Ÿè¢«BANäº†


2. [Finger Printing (Canvas/User-Agentâ€¦)](https://medium.com/@ravielakshmanan/web-browser-uniqueness-and-fingerprinting-7eac3c381805){:target="_blank"} ï¼šæ²¡ç ”ç©¶ï¼Œä¸è¿‡è¿™é¡¹ç›®ä¸»è¦æ‹¿æ¥è®©safariè·Ÿappèƒ½äº§ç”ŸåŒæ ·çš„UUIDï¼Œ [Deferred Deep Linking](https://www.jianshu.com/p/fa48387d56ea){:target="_blank"} (å»¶è¿Ÿæ·±åº¦è¿ç»“)ç”¨
   [AmIUnique?](https://amiunique.org/){:target="_blank"}


3. [**ID** entifier **F** or **V** endor](https://www.jianshu.com/p/b810d7e007ad){:target="_blank"} (IDFV)ï¼šç›®å‰ä¸»æµçš„è§£å†³æ–¹æ¡ˆğŸ†
   æ¦‚å¿µæ˜¯è‹¹æœä¼šæ ¹æ®ä½ çš„Bundle IDå‰è¾ä¸ºä½¿ç”¨è€…äº§ç”ŸUUIDï¼Œç›¸åŒçš„Bundle IDå‰è¾ä¼šäº§ç”Ÿç›¸åŒçš„UUIDï¼Œä¾‹å¦‚:com.518.work/com.518.job åŒä¸ªè£…ç½®ä¼šå¾—åˆ°ç›¸åŒçš„UUID
   å¦‚åŒåŸæ–‡ID For Vendorï¼Œç›¸åŒçš„å‰è¾è‹¹æœè®¤ä¸ºå³æ˜¯ç›¸åŒå‚å•†çš„APPï¼Œæ‰€ä»¥å…±äº«UUIDæ˜¯å…è®¸çš„ã€‚



#### **ID** entifier **F** or **V** endor (IDFV)ï¼š



```swift
let DEVICE_UUID:String = UIDevice.current.identifierForVendor?.uuidString ?? UUID().uuidString
```



**å”¯éœ€æ³¨æ„ï¼šå½“æ‰€æœ‰åŒVendorçš„APPéƒ½ç§»é™¤åå†é‡è£…å°±ä¼šäº§ç”Ÿæ–°çš„UUID (** com.518.workè·Ÿcom.518.jobéƒ½è¢«åˆ é™¤ï¼Œå†è£…å›com.518.workè¿™æ—¶å°±ä¼šäº§ç”Ÿæ–°çš„UUID **)**
**åŒç†å¦‚æœä½ åªæœ‰ä¸€ä¸ªAPPï¼Œåˆ æ‰é‡è£…å°±ä¼šäº§ç”Ÿæ–°çš„UUID**



å› ä¸ºè¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å…¬å¸çš„å…¶ä»–APPæ˜¯ä½¿ç”¨Key-Chainæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¬äº†è®²è€…å‰è¾ˆçš„æŒ‡ç‚¹ä¹ŸéªŒè¯äº†è¿™ä¸ªåšæ³•æ˜¯æ­£ç¡®çš„ï¼



**æµç¨‹å¦‚ä¸‹ï¼š**



![Key-Chain UUIDæ ä½æœ‰å€¼æ—¶å–å€¼ï¼Œæ— åˆ™å–IDFAçš„UUIDå€¼å¹¶å›å†™](/assets/a4bc3bce7513/1*-8rufG1QW-J5tn6ZadT17A.jpeg)



Key-Chain UUIDæ ä½æœ‰å€¼æ—¶å–å€¼ï¼Œæ— åˆ™å–IDFAçš„UUIDå€¼å¹¶å›å†™



Key-Chain å†™å…¥æ–¹å¼ï¼š



```swift
if let data = DEVICE_UUID.data(using: .utf8) {
    let query = [
        kSecClass as String       : kSecClassGenericPassword as String,
        kSecAttrAccount as String : "DEVICE_UUID",
        kSecValueData as String   : data ] as [String : Any]
    
    SecItemDelete(query as CFDictionary)
    SecItemAdd(query as CFDictionary, nil)
}
```



Key-Chain è¯»å–æ–¹å¼ï¼š



```swift
let query = [
    kSecClass as String       : kSecClassGenericPassword,
    kSecAttrAccount as String : "DEVICE_UUID",
    kSecReturnData as String  : kCFBooleanTrue,
    kSecMatchLimit as String  : kSecMatchLimitOne ] as [String : Any]

var dataTypeRef: AnyObject? = nil
let status: OSStatus = SecItemCopyMatching(query as CFDictionary, &dataTypeRef)
if status == noErr,let dataTypeRef = dataTypeRef as? Data,let uuid = String(data:dataTypeRef, encoding: .utf8) {
   //uuid
} 
```



å¦‚æœå«Œ Key-Chain æ“ä½œå¤ªç¹çå¯ä»¥è‡ªè¡Œå°è£…æˆ–ä½¿ç”¨ç¬¬ä¸‰æ–¹å¥—ä»¶ã€‚



#### å®Œæ•´CODEï¼š



```swift
let DEVICE_UUID:String = {
    let query = [
        kSecClass as String       : kSecClassGenericPassword,
        kSecAttrAccount as String : "DEVICE_UUID",
        kSecReturnData as String  : kCFBooleanTrue,
        kSecMatchLimit as String  : kSecMatchLimitOne ] as [String : Any]
    
    var dataTypeRef: AnyObject? = nil
    let status: OSStatus = SecItemCopyMatching(query as CFDictionary, &dataTypeRef)
    if status == noErr,let dataTypeRef = dataTypeRef as? Data,let uuid = String(data:dataTypeRef, encoding: .utf8) {
        return uuid
    } else {
        let DEVICE_UUID:String = UIDevice.current.identifierForVendor?.uuidString ?? UUID().uuidString
        if let data = DEVICE_UUID.data(using: .utf8) {
            let query = [
                kSecClass as String       : kSecClassGenericPassword as String,
                kSecAttrAccount as String : "DEVICE_UUID",
                kSecValueData as String   : data ] as [String : Any]
        
            SecItemDelete(query as CFDictionary)
            SecItemAdd(query as CFDictionary, nil)
        }
        return DEVICE_UUID
    }
}()
```



å› ä¸ºæˆ‘åœ¨å…¶ä»–Extension Targetä¹Ÿéœ€è¦å‚ç…§æ‰€ä»¥ç›´æ¥åŒ…æˆä¸€ä¸ªé—­åŒ…å‚æ•°ä½¿ç”¨



æœ‰ä»»ä½•é—®é¢˜åŠæŒ‡æ•™æ¬¢è¿ [ä¸æˆ‘è”ç»œ](https://www.zhgchg.li/contact){:target="_blank"} ã€‚



*[Post](https://medium.com/zrealm-ios-dev/ios-uuid-%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B-swift-ios-6-a4bc3bce7513){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}.*