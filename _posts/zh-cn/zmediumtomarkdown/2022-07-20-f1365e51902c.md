---
author: ZhgChgLi
categories:
- ZRealm Dev.
date: 2022-07-20T14:50:44.659+0000
description: App Store Connect API 2.0+ å…¨é¢æ›´æ–°ï¼Œæ”¯æ´ In-app purchasesã€Subscriptionsã€Customer
  Reviews ç®¡ç†
image:
  path: /assets/f1365e51902c/1*hHJ66r9BgJQsGnRYqbB_8g.png
last_modified_at: 2024-04-14T02:18:42.807+0000
render_with_liquid: false
tags:
- ios-app-development
- app-store-connect
- api
- app-review
- integration
title: App Store Connect API ç°å·²æ”¯æ´ è¯»å–å’Œç®¡ç† Customer Reviews
---

### App Store Connect API ç°å·²æ”¯æ´ è¯»å–å’Œç®¡ç† Customer Reviews



App Store Connect API 2.0+ å…¨é¢æ›´æ–°ï¼Œæ”¯æ´ In-app purchasesã€Subscriptionsã€Customer Reviews ç®¡ç†



### 2022/07/19 News



![[Upcoming transition from the XML feed to the App Store Connect API](https://developer.apple.com/news/?id=yqf4kgwb){:target="_blank"}](/assets/f1365e51902c/1*hHJ66r9BgJQsGnRYqbB_8g.png)



[Upcoming transition from the XML feed to the App Store Connect API](https://developer.apple.com/news/?id=yqf4kgwb){:target="_blank"}



ä»Šæ—©æ”¶åˆ° [Apple å¼€å‘è€…æœ€æ–°æ¶ˆæ¯](https://developer.apple.com/news/rss/news.rss){:target="_blank"} ï¼ŒApp Store Connect API æ–°å¢æ”¯æ´ In-app purchasesã€Subscriptionsã€Customer Reviews ç®¡ç†ä¸‰é¡¹åŠŸèƒ½ï¼›è®©å¼€å‘è€…å¯ä»¥æ›´å¼¹æ€§çš„å°† Apple å¼€å‘æµç¨‹ä¸ CI/CD æˆ–æ˜¯å•†ä¸šåå°åšæ›´å¯†åˆ‡ã€æœ‰æ•ˆç‡çš„æ•´åˆï¼



In-app purchasesã€Subscriptions æˆ‘æ²¡ç¢°ï¼ŒCustomer Reviews è®©æˆ‘å…´å¥‹ä¸å·²ï¼Œä¹‹å‰å‘è¡¨è¿‡ä¸€ç¯‡ã€Œ [**AppStore APPâ€™s Reviews Slack Bot é‚£äº›äº‹**](../cb0c68c33994/) ã€æ¢è®¨ App è¯„ä»·ä¸å·¥ä½œæµç¨‹æ•´åˆçš„æ–¹å¼ã€‚



![Slack è¯„ä»·æœºå™¨äºº â€” [ZReviewsBot](https://github.com/ZhgChgLi/ZReviewsBot){:target="_blank"}](/assets/f1365e51902c/1*igukM7FTLxaX2hpVtFPMjQ.png)



Slack è¯„ä»·æœºå™¨äºº â€” [ZReviewsBot](https://github.com/ZhgChgLi/ZReviewsBot){:target="_blank"}



åœ¨ App Store Connect API è¿˜æ²¡æ”¯æ´ä¹‹å‰ï¼Œåªæœ‰ä¸¤ç§æ–¹æ³•èƒ½è·å– iOS App è¯„ä»·ï¼š



**ä¸€ æ˜¯** é€è¿‡è®¢é˜… [Public RSS](https://rss.itunes.apple.com/zh-tw){:target="_blank"} å–å¾—ï¼Œä½†æ˜¯æ­¤ RSS æ— æ³•è®©äººå¼¹æ€§ç­›é€‰ã€ç»™çš„èµ„è®¯ä¹Ÿå°‘ã€æœ‰æ•°é‡ä¸Šé™ã€è¿˜æœ‰æˆ‘ä»¬å¶å°”ä¼šé‡åˆ°èµ„æ–™é”™ä¹±é—®é¢˜ï¼Œå¾ˆä¸ç¨³å®š



**äºŒ æ˜¯** é€è¿‡ [**Fastlane**](https://fastlane.tools/){:target="_blank"} **â€” [SpaceShip](https://github.com/fastlane/fastlane/tree/master/spaceship){:target="_blank"}** å¸®æˆ‘ä»¬å°è£…å¤æ‚çš„ç½‘é¡µæ“ä½œã€Session ç®¡ç†ï¼Œå» App Store Connection ç½‘ç«™åå°æå–è¯„ä»·èµ„æ–™ (ç­‰äºæ˜¯èµ·ä¸€ä¸ªç½‘é¡µæ¨¡æ‹Ÿå™¨çˆ¬è™«å»åå°çˆ¬èµ„æ–™)ã€‚



- å¥½å¤„æ˜¯èµ„æ–™é½å…¨ã€ç¨³å®šï¼Œæˆ‘ä»¬ä¸²æ¥äº†ä¸€å¹´æ²¡æœ‰é‡åˆ°ä»»ä½•èµ„æ–™é—®é¢˜ã€‚


- åå¤„æ˜¯ Session æ¯ä¸ªæœˆéƒ½ä¼šè¿‡æœŸï¼Œè¦æ‰‹åŠ¨é‡æ–°ç™»å…¥ï¼Œè€Œä¸” Apple ID ç›®å‰å…¨é¢éƒ½è¦ç»‘å®š 2FA éªŒè¯ï¼Œæ‰€ä»¥è¿™æ®µä¹Ÿè¦æ‰‹åŠ¨å®Œæˆï¼Œè¿™æ ·æ‰èƒ½äº§å‡ºæœ‰æ•ˆçš„ Sessionï¼›å¦å¤– Session å¦‚æœäº§çš„è·Ÿç”¨çš„ IP ä¸ä¸€æ ·ä¼šé©¬ä¸Šè¿‡æœŸ (å› æ­¤å¾ˆéš¾å°†æœºå™¨äººæ”¾ä¸Šä¸å›ºå®š IP çš„ç½‘è·¯æœåŠ¡)ã€‚



![[important-note-about-session-duration](https://docs.fastlane.tools/best-practices/continuous-integration/#important-note-about-session-duration){:target="_blank"} by Fastlane](/assets/f1365e51902c/0*iMQRza9LN3ljy2k1.png)



[important-note-about-session-duration](https://docs.fastlane.tools/best-practices/continuous-integration/#important-note-about-session-duration){:target="_blank"} by Fastlane



- æ¯ä¸ªæœˆä¸å®šæ—¶è¿‡æœŸï¼Œè¦ä¸å®šæ—¶å»æ›´æ–°ï¼Œæ—¶é—´ä¹…äº†çœŸçš„å¾ˆçƒ¦ï¼›è€Œä¸”è¿™ä¸ª ã€Œ **Know How** ã€å…¶å®ä¸å¥½äº¤æ¥ç»™å…¶ä»–åŒäº‹ã€‚



> ä½†å› ä¸ºæ²¡æœ‰å…¶ä»–æ–¹æ³•ï¼Œæ‰€ä»¥ä¹Ÿåªèƒ½è¿™æ ·ï¼Œç›´åˆ°ä»Šå¤©æ—©ä¸Šæ”¶åˆ°æ¶ˆæ¯â€¦.



> **âš ï¸ æ³¨æ„ï¼šå®˜æ–¹é¢„è®¡åœ¨ 2022/11 å–æ¶ˆåŸæœ¬çš„ XML (RSS) å­˜å–æ–¹å¼ã€‚**



### 2022/08/10 Update



æˆ‘å·²åŸºäºæ–°çš„ App Store Connect API å¼€å‘äº†æ–°çš„ ã€Œ [ZReviewTender â€” å…è´¹å¼€æºçš„ App Reviews ç›‘æ§æœºå™¨äºº](../e36e48bb9265/) ã€



### App Store Connect API 2.0+ Customer Reviews è¯•ç©



#### å»ºç«‹ App Store Connect API Key



é¦–å…ˆæˆ‘ä»¬è¦ç™»å…¥ App Store Connect åå°ï¼Œå‰å¾€ã€ŒUsers and Accessã€-&gt;ã€ŒKeysã€-&gt;ã€Œ [**App Store Connect API**](https://appstoreconnect.apple.com/access/api){:target="_blank"} ã€ï¼š



![](/assets/f1365e51902c/1*0NimMOcIqQ95nzjBBKYe8A.png)



ç‚¹å‡»ã€Œ+ã€ï¼Œè¾“å…¥åç§°å’Œæƒé™ï¼›æƒé™ç»†åˆ™å¯å‚è€ƒå®˜ç½‘è¯´æ˜ï¼Œä¸ºäº†å‡å°‘æµ‹è¯•é—®é¢˜ï¼Œè¿™è¾¹å…ˆé€‰æ‹©ã€ŒApp Managerã€æŠŠæƒé™å¼€åˆ°æœ€å¤§ã€‚



![](/assets/f1365e51902c/1*Bt8ddt7GrZs1ERaFamftVw.png)



ç‚¹å‡»å³æ–¹ã€ŒDownload API Keyã€ä¸‹è½½ä¿å­˜ä½ çš„ã€ŒAuthKey_XXX.p8ã€Keyã€‚



> âš ï¸ æ³¨æ„ï¼šè¿™ä¸ª Key åªèƒ½ä¸‹è½½ä¸€æ¬¡è¯· **å¦¥å–„ä¿å­˜** ï¼Œè‹¥é—å¤±åªèƒ½ Revoke ç°æœ‰çš„ & é‡æ–°å»ºç«‹ã€‚âš ï¸



> **âš ï¸ åˆ‡å‹¿å¤–æ³„ .p8 Key Fileâš ï¸**



#### App Store Connect API å­˜å–æ–¹å¼



```bash
curl -v -H 'Authorization: Bearer [signed token]' "https://api.appstoreconnect.apple.com/v1/apps"
```



#### Signed Token (JWT, JSON Web Token) äº§ç”Ÿæ–¹å¼



å‚è€ƒ [å®˜æ–¹æ–‡ä»¶](https://developer.apple.com/documentation/appstoreconnectapi/generating_tokens_for_api_requests){:target="_blank"} ã€‚



![](/assets/f1365e51902c/1*KDv2ra17oSp5UXKy-VZA1g.png)



- JWT Headerï¼š



```json
{kid:"YOUR_KEY_ID", typ:"JWT", alg:"ES256"}
```



`YOUR_KEY_ID` ï¼šå‚è€ƒä¸Šå›¾ã€‚



- JWT Payloadï¼š



```json
{
  iss: 'YOUR_ISSUE_ID',
  iat: TOKEN å»ºç«‹æ—¶é—´ (UNIX TIMESTAMP e.g 1658326020),
  exp: TOKEN å¤±æ•ˆæ—¶é—´ (UNIX TIMESTAMP e.g 1658327220),
  aud: 'appstoreconnect-v1'
}
```



`YOUR_ISSUE_ID` ï¼šå‚è€ƒä¸Šå›¾ã€‚



`exp TOKEN å¤±æ•ˆæ—¶é—´` ï¼šä¼šå› ä¸ºä¸åŒå­˜å–åŠŸèƒ½æˆ–è®¾å®šæœ‰ä¸åŒçš„æ—¶é—´é™åˆ¶ï¼Œæœ‰çš„å¯ä»¥æ°¸ä¹…ã€æœ‰çš„è¶…è¿‡ 20 åˆ†é’Ÿå³å¤±æ•ˆï¼Œéœ€è¦é‡æ–°äº§ç”Ÿï¼Œè¯¦ç»†å¯å‚è€ƒ [å®˜æ–¹è¯´æ˜](https://developer.apple.com/documentation/appstoreconnectapi/generating_tokens_for_api_requests#3878467){:target="_blank"} ã€‚



#### ä½¿ç”¨ [JWT.IO](https://jwt.io/){:target="_blank"} æˆ–æ˜¯ä»¥ä¸‹é™„çš„ Ruby èŒƒä¾‹äº§ç”Ÿ JWT



jwt.rb:



```ruby
require 'jwt'
require 'time'

keyFile = File.read('./AuthKey_XXXX.p8') # YOUR .p8 private key file path
privateKey = OpenSSL::PKey::EC.new(keyFile)

payload = {
            iss: 'YOUR_ISSUE_ID',
            iat: Time.now.to_i,
            exp: Time.now.to_i + 60*20,
            aud: 'appstoreconnect-v1'
          }

token = JWT.encode payload, privateKey, 'ES256', header_fields={kid:"YOUR_KEY_ID", typ:"JWT"}
puts token


decoded_token = JWT.decode token, privateKey, true, { algorithm: 'ES256' }
puts decoded_token
```



- Ruyb JWT å·¥å…·åœ¨æ­¤ï¼š <https://github.com/jwt/ruby-jwt>{:target="_blank"}



**æœ€ç»ˆä¼šå¾—åˆ°ç±»ä¼¼ä»¥ä¸‹çš„ JWT ç»“æœï¼š**



```
4oxjoi8j69rHQ58KqPtrFABBWHX2QH7iGFyjkc5q6AJZrKA3AcZcCFoFMTMHpM.pojTEWQufMTvfZUW1nKz66p3emsy2v5QseJX5UJmfRjpxfjgELUGJraEVtX7tVg6aicmJT96q0snP034MhfgoZAB46MGdtC6kv2Vj6VeL2geuXG87Ys6ADijhT7mfHUcbmLPJPNZNuMttcc.fuFAJZNijRHnCA2BRqq7RZEJBB7TLsm1n4WM1cW0yo67KZp-Bnwx9y45cmH82QPAgKcG-y1UhRUrxybi5b9iNN
```



#### æ‰“çœ‹çœ‹ï¼Ÿ



æœ‰äº† Token æˆ‘ä»¬å°±èƒ½æ¥æ‰“çœ‹çœ‹ App Store Connect APIï¼



```bash
curl -H 'Authorization: Bearer JWT' "https://api.appstoreconnect.apple.com/v1/apps/APPID/customerReviews"
```



- `APPID` å¯ä» App Store Connect åå°å–å¾—ï¼š



![](/assets/f1365e51902c/1*yU4J85S6Q_e8c9NPYE8bNw.png)



æˆ–æ˜¯ App å•†åŸé¡µé¢ï¼š



- <https://apps.apple.com/tw/app/pinkoi/id557252416>{:target="_blank"}


- APPID = `557252416`



![](/assets/f1365e51902c/1*wWIpy8Y5G2F0A2FvQzp0hQ.png)



- æˆåŠŸï¼ğŸš€ æˆ‘ä»¬ç°åœ¨å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹å¼æå– App è¯„ä»·ï¼Œèµ„æ–™å®Œæ•´ä¸”å¯ä»¥å®Œå…¨äº¤ç»™æœºå™¨æ‰§è¡Œï¼Œä¸éœ€äººå·¥ä¾‹è¡Œç»´æŠ¤ (JWT è™½ä¼šè¿‡æœŸï¼Œä½†æ˜¯ Private Key ä¸ä¼šï¼Œæˆ‘ä»¬æ¯æ¬¡è¯·æ±‚éƒ½å¯å€Ÿç”± Private Key ç­¾åäº§ç”Ÿ JWT å»å­˜å–å³å¯)ã€‚


- å…¶ä»–ç­›é€‰å‚æ•°ã€æ“ä½œæ–¹æ³•è¯·å‚è€ƒ [å®˜æ–¹æ–‡ä»¶](https://developer.apple.com/documentation/appstoreconnectapi/list_all_customer_reviews_for_an_app){:target="_blank"} ã€‚



> **âš ï¸ æ‚¨åªèƒ½å­˜å–æ‚¨æœ‰æƒé™çš„ App è¯„ä»·èµ„æ–™âš ï¸**



#### å®Œæ•´ Ruby æµ‹è¯•ä¸“æ¡ˆ



ç”¨ä¸€ä¸ª Ruby æ¡£æ¡ˆåšäº†ä»¥ä¸Šæµç¨‹ï¼Œå¯ç›´æ¥ Clone ä¸‹æ¥å¡«å…¥èµ„æ–™å³å¯æµ‹è¯•ä½¿ç”¨ã€‚



[![](https://opengraph.githubassets.com/dc0eb76d891ed80d9f1cb1979225b4cf2ad813fe3c1344bac51a14384c8aeb00/zhgchgli0718/appstoreconnectapitester)](https://github.com/zhgchgli0718/appstoreconnectapitester){:target="_blank"}



**é¦–æ¬¡æ‰“å¼€ï¼š**



```bash
bundle install
```



**å¼€å§‹ä½¿ç”¨ï¼š**



```bash
bundle exec ruby jwt.rb
```



### Next



åŒç†æˆ‘ä»¬å¯ä»¥é€è¿‡ API å»å­˜å–ç®¡ç† ( [API Overview](https://developer.apple.com/app-store-connect/api/){:target="_blank"} )ï¼š



- **[New]** [Customer reviews](https://developer.apple.com/documentation/appstoreconnectapi/app_store/customer_reviews){:target="_blank"}


- **[New]** [Subscriptions](https://developer.apple.com/app-store/subscriptions/){:target="_blank"}


- **[New]** [In-App Purchases](https://developer.apple.com/in-app-purchase/){:target="_blank"}


- **[New]** [Xcode Cloud Workflows And Builds](https://developer.apple.com/documentation/appstoreconnectapi/xcode_cloud_workflows_and_builds){:target="_blank"}


- **[Updated]** [Improving your Appâ€™s Performance](https://developer.apple.com/documentation/metrickit/improving_your_app_s_performance){:target="_blank"}


- [TestFlight](https://developer.apple.com/testflight/){:target="_blank"}


- [Users And Roles](https://developer.apple.com/support/roles/){:target="_blank"}


- [App Clips](https://developer.apple.com/app-clips/){:target="_blank"}


- [App Management](https://help.apple.com/app-store-connect/#/dev2cd126805){:target="_blank"}


- [App Metadata](https://developer.apple.com/app-store/product-page/){:target="_blank"}


- [Pricing And Availability](https://help.apple.com/app-store-connect/#/dev9fc06e23d){:target="_blank"}


- [Provisioning](https://help.apple.com/developer-account/){:target="_blank"}


- [Sales and Trends](https://help.apple.com/app-store-connect/#/dev061699fdb){:target="_blank"}



æœ‰ä»»ä½•é—®é¢˜åŠæŒ‡æ•™æ¬¢è¿ [ä¸æˆ‘è”ç»œ](https://www.zhgchg.li/contact){:target="_blank"} ã€‚



*[Post](https://medium.com/zrealm-ios-dev/app-store-connect-api-%E7%8F%BE%E5%B7%B2%E6%94%AF%E6%8F%B4-%E8%AE%80%E5%8F%96%E5%92%8C%E7%AE%A1%E7%90%86-customer-reviews-f1365e51902c){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}.*