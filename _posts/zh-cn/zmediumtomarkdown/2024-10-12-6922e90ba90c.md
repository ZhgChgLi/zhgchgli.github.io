---
author: ZhgChgLi
categories:
- ZRealm Robotic Process Automation
date: 2024-10-12T13:10:46.227+0000
description: 手把手将 Line Notify 个人通知服务迁移至同样免费、更强大的 Telegram Bot
image:
  path: /assets/6922e90ba90c/1*r59nJAx__InU09hYMenePg.jpeg
last_modified_at: 2024-10-20T08:57:41.630+0000
render_with_liquid: false
tags:
- ios-app-development
- line
- telegram
- google-apps-script
- automation
title: 10 分钟快速移转 Line Notify 到 Telegram Bot 通知
---

### 10 分钟快速移转 Line Notify 到 Telegram Bot 通知



手把手将 Line Notify 个人通知服务迁移至同样免费、更强大的 Telegram Bot



![Photo by [Lana Codes](https://unsplash.com/@lanacodes?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash){:target="_blank"}](/assets/6922e90ba90c/1*r59nJAx__InU09hYMenePg.jpeg)



Photo by [Lana Codes](https://unsplash.com/@lanacodes?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash){:target="_blank"}



#### [LINE Notify结束服务公告](https://notify-bot.line.me/closing-announce){:target="_blank"}



> *感谢您长期以来使用LINE Notify。*



> *LINE Notify自2016年9月推出以来，一直致力于为开发者提供服务。为能提供更优质的服务，并将经营资源集中于后续的类似商品服务，我们决定于2025年3月31日结束本服务。对于长期以来支持并使用LINE作为通知连动服务的所有用户，我们深表感谢。*



> *若您仍需使用LINE向用户传送通知的商品服务，建议可改用功能更丰富的Messaging API。*



撷取自 [Line Notify 官网](https://notify-bot.line.me/closing-announce){:target="_blank"} ， Line 于 2024/10/08 发文公告 Line Notify 将于 2025/04/01 完全关闭，如需继续使用 Line 做为讯息通知，只能用付费的 [Message API](https://developers.line.biz/en/services/messaging-api/){:target="_blank"} 。



Line Notify 的优点是非常容易串接，拿来做个人通知机器人非常方便好用，一些 Line Bot 或第三方服务也会使用 Line Notify 进行通知 (例如：路易莎、你订的订单通知功能)；但缺点也蛮多的，例如讯息内容单一、无法分群组(统一都是传送到 Line Notify Bot)、讯息内容长度有限…等等



随著 Line Notify 宣告终止，正好也给我了一个迁移至其他通讯、通知服务的机会：



- Slack：免费版讯息只保留 30 天、我的通知比较是个人，用 Slack 有点大材小用。(Slack 传送讯息可参考我之前的文章： [Slack & ChatGPT Integration](../bd94cc88f9c9/) )


- Discord：我的通知比较是个人，一样有点大材小用。


- **Telegram：免费、几乎无限使用。**



对我来说 Telegram 的通讯服务比较符合我原本 Line Notify 的使用需求，我需要一个能接收通知的频道，最好是能依照不同需求有不同的频道，可接受的内容、格式越丰富越好、并且能快速简单串接；Telegram 都符合上述需求，还能多实现跟 Bot 的交互功能。



#### 成果



先上最终效果图(以 [Github Star 通知、Repo Stats 通知为例](../382218e15697/) )：



![](/assets/6922e90ba90c/1*1kHJu5yZMUST-wrna6KqkA.gif)



- ✅ 有人按 Repo 星星时会触发 Webhook -&gt; Google Apps Script -&gt; Telegram Bot 发送通知到 Telegram — Github Stats Group


- ✅ Google Apps Script 每日定时 -&gt; 捞取 Github Repo Stats 状态 -&gt; Telegram Bot 发送通知到 Telegram — Github Stats Group


- ✅ 使用 `/update` Telegram Bot Command 触发捞取 Github Repo Stats 状态 -&gt; Telegram Bot 发送通知到 Telegram — Github Stats Group



#### 对比原本 Line Notify



![](/assets/6922e90ba90c/1*mTycFPe7rPh1qc0BagUXdw.png)



- ❌ 所有讯息无法分类、分群组都传到 Line Notify


- ❌ 无法针对个别讯息做特殊设定 (如通知声、静音…)


- ❌ 无法输入讯息互动



#### 本文目录



- 设定 Telegram Bot


- 移转 Line Notify 发送讯息到 Telegram Bot (Google Apps Script)


- 与 Telegram Bot 交互 (Command) x 使用 Google Apps Script



### (1/2) 设定 Telegram Bot



Telegram Bot 的申请非常简单，连网页都不需要开，只要跟官方的 [BotFather 机器人](https://t.me/BotFather){:target="_blank"} 互动就可以了。



#### Step 1. 申请 Telegram Bot



[安装、注册好 Telegram 服务](https://telegram.org/){:target="_blank"} 之后，点击加「 [BotFather 机器人](https://t.me/BotFather){:target="_blank"} 」为好友。



![](/assets/6922e90ba90c/1*-3qluwPXk-HeGRCTOd-EAA.png)



![](/assets/6922e90ba90c/1*QfzbJYQ2vVI2CNvvLU7r_w.png)



1. 打开、加入 [BotFather 机器人](https://t.me/BotFather){:target="_blank"}


2. 加入后直接传送讯息「 `/newbot` 」建立你的机器人。


3. 输入你的机器人名称


4. 输入你的机器人帐号 (不可重复、必须以 `bot` 为结尾，例如我的 `zhgchgli_bot` )


5. 你的 Bot 连结，点进进入开始使用 (e.g. t.me/harrytest56_bot)


6. 取得 `你的_BOT_API_Token` ， **请妥善保存** ⚠️⚠️⚠️



点击 4. 取得的 Bot 连结，开始使用 Bot：



![](/assets/6922e90ba90c/1*5q5PE3D9nwQPlYoY8SqCHQ.png)



![](/assets/6922e90ba90c/1*NKz9GSDlGov9q7xIlHYlCQ.png)



![](/assets/6922e90ba90c/1*VU7EyeZL2BpVnLRHQBNOPQ.png)



目前无任何功能，可以点右上角 Info，编辑名称或上传大头贴。



#### Step 2. 创建 Telegram 通知 Group & 加入机器人帐号



> *我希望不同的个人通知类型传到不同的 Group，这 **边因为 Demo 只创建一个 My Notify Group** 。*



> *你可以依据实际需求创建不同的 Group & 依照步骤加入、设定机器人。*



![](/assets/6922e90ba90c/1*geb_lwnJOUXiuLHvguuXjQ.png)



![](/assets/6922e90ba90c/1*bfXDTACy4mW3LZlq6ErKzQ.png)



![](/assets/6922e90ba90c/1*ZmsCLqEZbNN3IS2uoZV8cw.png)



1. New Group


2. 搜寻你的机器人帐号＆点击加入


3. 设定 Group 名称、大头贴



#### Step 3. 取得 Group Chat ID



Telegram Bot API 没有直接取得 Group 列表、Group Chat ID 的 Endpoint，只能透过 `/getUpdates` 取得机器人讯息列表，并从中找到 Group Chat ID：



**Request:**



```rust
curl 'https://api.telegram.org/bot你的_BOT_API_Token/getUpdates'
```



- Telegram API 格式为 `https://api.telegram.org/bot` **你的_BOT_API_Token** `/getUpdates` ， BOT API Token 字串前要加上 `bot` 字串


- 范例： `curl 'https://api.telegram.org/bot7814194578:AAEWpPJvKn06ID7D9FjV65aDKQLkGkz8cc8/getUpdates'`



**Response:**



```json
{
    "ok": true,
    "result": [
        {
            "update_id": 706454235,
            "my_chat_member": {
                "chat": {
                    "id": -4532420331,
                    "title": "My Nofify",
                    "type": "group",
                    "all_members_are_administrators": false
                },
                "from": {
                    "id": 986128250,
                    "is_bot": false,
                    "first_name": "Harry",
                    "last_name": "Li",
                    "username": "zhgchgli"
                },
                "date": 1728726861,
                "old_chat_member": {
                    "user": {
                        "id": 7814194578,
                        "is_bot": true,
                        "first_name": "Harry Test",
                        "username": "harrytest56_bot"
                    },
                    "status": "left"
                },
                "new_chat_member": {
                    "user": {
                        "id": 7814194578,
                        "is_bot": true,
                        "first_name": "Harry Test",
                        "username": "harrytest56_bot"
                    },
                    "status": "member"
                }
            }
        },
        {
            "update_id": 706454236,
            "message": {
                "message_id": 1,
                "from": {
                    "id": 986128250,
                    "is_bot": false,
                    "first_name": "Harry",
                    "last_name": "Li",
                    "username": "zhgchgli"
                },
                "chat": {
                    "id": -4532420331,
                    "title": "My Nofify",
                    "type": "group",
                    "all_members_are_administrators": true
                },
                "date": 1728726861,
                "group_chat_created": true
            }
        },
        {
            "update_id": 706454237,
            "message": {
                "message_id": 2,
                "from": {
                    "id": 986128250,
                    "is_bot": false,
                    "first_name": "Harry",
                    "last_name": "Li",
                    "username": "zhgchgli"
                },
                "chat": {
                    "id": -4532420331,
                    "title": "My Nofify",
                    "type": "group",
                    "all_members_are_administrators": true
                },
                "date": 1728726864,
                "new_chat_photo": [
                    {
                        "file_id": "AgACAgUAAxkBAAMCZwpHUEaLZSvFFYu8GiO-8qI_jVYAApfAMRu0B1BUJP-4u2wF6scBAAMCAANhAAM2BA",
                        "file_unique_id": "AQADl8AxG7QHUFQAAQ",
                        "file_size": 5922,
                        "width": 160,
                        "height": 160
                    },
                    {
                        "file_id": "AgACAgUAAxkBAAMCZwpHUEaLZSvFFYu8GiO-8qI_jVYAApfAMRu0B1BUJP-4u2wF6scBAAMCAANiAAM2BA",
                        "file_unique_id": "AQADl8AxG7QHUFRn",
                        "file_size": 15097,
                        "width": 320,
                        "height": 320
                    },
                    {
                        "file_id": "AgACAgUAAxkBAAMCZwpHUEaLZSvFFYu8GiO-8qI_jVYAApfAMRu0B1BUJP-4u2wF6scBAAMCAANjAAM2BA",
                        "file_unique_id": "AQADl8AxG7QHUFQB",
                        "file_size": 37988,
                        "width": 640,
                        "height": 640
                    }
                ]
            }
        }
    ]
}
```



可以从回应中找到对应 Group Name + type=group 的巢状 JSON 资料，其中的 id 就是 Group Chat ID:



```json
"chat": {
  "id": -4532420331,
  "title": "My Nofify",
  "type": "group",
  "all_members_are_administrators": false
}
```



- `Group Chat Id` = `-4532420331`



> ***⚠️⚠️⚠️️*** *如果你的 Response 为空 `{ "ok": true, "result": [] }` 请尝试在你的 Group 发送讯息 (e.g. `Hello` ) 再重新 Call API 应该就有了。*



#### Step 4. 发送讯息



我们可以使用 `/sendMessage` 发送讯息到 Group。



**Request:**



```rust
curl 'https://api.telegram.org/bot你的_BOT_API_Token/sendMessage' \
--form 'chat_id="Group Chat Id"' \
--form 'text="讯息内容"'
```



**范例：**



```rust
curl 'https://api.telegram.org/bot7814194578:AAEWpPJvKn06ID7D9FjV65aDKQLkGkz8cc8/sendMessage' \
--form 'chat_id="-4532420331"' \
--form 'text="test"'
```



- [**API 参数可参考官方文件**](https://core.telegram.org/bots/api#sendmessage){:target="_blank"}



**Response & Result:**



```json
{
  "ok": true,
  "result": {
    "message_id": 5,
    "from": {
      "id": 7814194578,
      "is_bot": true,
      "first_name": "Harry Test",
      "username": "harrytest56_bot"
    },
    "chat": {
      "id": -4532420331,
      "title": "My Nofify",
      "type": "group",
      "all_members_are_administrators": true
    },
    "date": 1728727847,
    "text": "test"
  }
}
```



- 发送成功取得以上 Response



![](/assets/6922e90ba90c/1*WG4ngRKKac1cICU4NvoEJA.png)



- 回 Telegram Group 就会出现刚发送的讯息内容。



### (2/2) 移转 Line Notify 发送讯息到 Telegram Bot (Google Apps Script)



我的个人通知机器人服务是使用 Google Apps Script 达成的，因此以 Google Apps Script 转换为例 (类 JavaScript)。



#### 原始的 Line Notify 发送程式码：



```javascript
const lineToken = "XXXX";

function sendLineNotifyMessage(message) {
  var url = 'https://notify-api.line.me/api/notify';
  
  var options = {
    method: 'post',
    headers: {
      'Authorization': 'Bearer '+lineToken
    },
    payload: {
      'message': message
    }
  }; 
  const response = UrlFetchApp.fetch(url, options);
  Logger.log(response.getContentText());
}
```



可以看到非常简单方便好用…



#### 移转成 Telegram Bot 发送程式码：



```javascript
const telegramToken = "你的_BOT_API_Token";
const TelegramChatId = {
  GA: -123456,
  GITHUB: -123457,
  MEDIUM: -123458
};

function sendNotifyMessage(message, chatId) {
  var url = "https://api.telegram.org/bot"+telegramToken+"/sendMessage";
  
  const payload = {
    "chat_id": chatId,
    "text": message,
    "parse_mode": "Markdown"
  } 
  const options = {
    'method': 'post',
    'contentType': 'application/json',
    'muteHttpExceptions': true,
    'payload': JSON.stringify(payload)
  };

  const response = UrlFetchApp.fetch(url, options);
  Logger.log(response.getContentText());
}
```



照前面 Telegram Bot 设定步骤取得的资讯。



- `telegramToken` = `你的_BOT_API_Token`


- `TelegramChatId` 这边是我自己多定义的方法，因为实务上我希望不同的通知分别传送到不同的 Group，因此定义了一个结构管理目标 Group 与他的 `Group Chat Id` 。



`/sendMessage` [**API 参数，更多参数、细节可参考官方文件**](https://core.telegram.org/bots/api#sendmessage){:target="_blank"} ，以下是我自己会用到的参数：



- text: 讯息内容 (必带)


- chat_id: 目标 Group Chat Id (必带)


- parse_mode: 讯息内容解析方式，这边我指定 `Markdown`


- disable_web_page_preview: 讯息内容的连结是否不要预览，这边设 `true` 关闭，可以让讯息显示更简洁。



**使用方式：**



```scss
sendNotifyMessage("Hello", TelegramChatId.MEDIUM) // 发送 Hello 讯息到 MEDIUM Group Chat Id
sendNotifyMessage("Hello", -1234) // 发送 Hello 讯息到 -1234 Group Chat Id
```



### 成果



以我的 [Github Repo Star Notifier 机器人](../382218e15697/) 为例：



![](/assets/6922e90ba90c/1*yJDcnb7n1fIJAM-AV1Qk6w.png)



![](/assets/6922e90ba90c/1*5kBotSkNf9nN8NV-lCwZoQ.png)



- 验证成功！ 当有人按我的 Repo Star 时能正确改发送通知到 Telegram Group！🎉🎉🎉


- 制作方式可参考我之前的文章「 [使用 Google Apps Script 三步骤免费建立 Github Repo Star Notifier](../382218e15697/) 」



#### 设定特殊声音或静音



![](/assets/6922e90ba90c/1*kQsYkefi0SD7e9t4PerdRA.jpeg)



比 Line Notify 更棒的事是我们还可以对不同的 Group 设定不同的通知声音或是静音。



### 与 Telegram Bot 交互 (Command) x 使用 Google Apps Script



除了替代 Notify 功能之外， Telegram Bot 还能轻易地实现与使用者交互的功能 — Telegram Bot Command。



回到我的使用场景，我的机器人会定时或是 Webhook 触发传送通知讯息送给我；但有时候我也想手动触发机器人立刻取得当前结果，以往 Line Notify 没有这个功能，以 Google Apps Script 来说就只能暴力的设定一个网址，只要打开网址就会触发，很不好用。



Telegram Bot Command 就能让我直接输入指令讯息，命令机器人立刻执行我想做的事情。



> *本文以 [Goolge Apps Script](https://script.google.com/home){:target="_blank"} 为例，Google Apps Script 详细介绍可参考我之前文章「 [**使用 Google Apps Script 实现 Google 服务 RPA 自动化**](../f6713ba3fee3/) 」。*



#### Step 1. 使用 Google Apps Script 实现 Command 处理逻辑



- 前往 Google Apps Script 首页


- 左上方「建立新专案」


- 点击「未命名专案」输入专案名称 e.g. `Telegram`


- 贴上基础程式码：



![](/assets/6922e90ba90c/1*ZeW4O7Mdgcyj0VsSLDpxeA.png)



```javascript
const telegramToken = "你的_BOT_API_Token";

function doPost(e) {
  const content = JSON.parse(e.postData.contents);
  if (content.message && content.message.text) {
    const command = content.message.text.split(' ')[0];
    const chatId = content.message.chat.id;

    if (command.startsWith("/update")) { 
      // 收到 /update 指令
      // 在这边处理你想做的事...然后回应...
      sendNotifyMessage("你好.....\n指令:"+command, chatId);
    }
  }

  return HtmlService.createHtmlOutput("OK!");
}

function sendNotifyMessage(message, chatId) {
  var url = "https://api.telegram.org/bot"+telegramToken+"/sendMessage";
  
  const payload = {
    "chat_id": chatId,
    "text": message,
    "disable_web_page_preview": true,
    "parse_mode": "Markdown"
  } 
  const options = {
    'method': 'post',
    'contentType': 'application/json',
    'muteHttpExceptions': true,
    'payload': JSON.stringify(payload)
  };

  const response = UrlFetchApp.fetch(url, options);
  Logger.log(response.getContentText());
}
```



- `telegramToken` = `你的_BOT_API_Token`


- 上述 Demo 程式我们在收到 Post 请求、Command 参数等于 `/update` 时回应 `你好…` 模拟收到指令后处理后回应的场景。



#### Step 2. 完成 Google Apps Script Web 部署



![](/assets/6922e90ba90c/1*JfJfs4bYsSfsZYGVkApCSg.png)



![](/assets/6922e90ba90c/1*TwSm45_Xwv4p7z4o9HJz2w.png)



![](/assets/6922e90ba90c/1*7RLJXZ3APnEI4V9bKqp3eg.png)



- 右上角「部署」-&gt; 「新增部署作业」


- 左上角「设定」-&gt;「网页应用程式」


- 谁可以存取选择「所有人」



![](/assets/6922e90ba90c/1*aRBaOOnhwBeK05l9e3Yv8g.png)



![](/assets/6922e90ba90c/1*FtY8NL36peDbOB4JWdzhDA.png)



![](/assets/6922e90ba90c/1*e2E41TCEf5O7nSOnVzpgbw.png)



- 新增部署作业，选择「授予存取权」


- 跳出帐号视窗，选择你的 Google 登入帐号


- 跳出警告视窗，选择「Advanced」-&gt;「Go to `专案名称` (unsafe)」


- 选择「Allow」



![](/assets/6922e90ba90c/1*n0iO-XSPqifUKUkIgVQUSg.png)



- 网页应用程式网址： `你的 Webhook 网址` **。**
  复制下来。
  e.g. `https://script.google.com/macros/s/AKfycbx2oFv-eB4LezdOk3P3aoEZVhx_PI6n_YnTNP7WVVQSaiRU52di5bKNThsvIZxus3Si/exec`



> *Google Apps Script 网页应用程式部署、更新、使用、除错可参考我之前的文章「 [**使用 Google Apps Script 实现 Google 服务 RPA 自动化**](../f6713ba3fee3/) 」。*



> ***⚠️⚠️⚠️ 请注意，如果 Google Apps Script 程式码有变更要点击部署-&gt;管理部署-&gt;选择建立新版本才会生效，细节可参考上述文章。***



> ***⚠️⚠️⚠️请注意，如果 Google Apps Script 程式码有变更要点击部署-&gt;管理部署-&gt;选择建立新版本才会生效，细节可参考上述文章。***



> ***⚠️⚠️⚠️请注意，如果 Google Apps Script 程式码有变更要点击部署-&gt;管理部署-&gt;选择建立新版本才会生效，细节可参考上述文章。***



#### Step 3. 注册 Webhook



使用 Telegram API `/setWebhook` 注册你的 Webhook 网址。



**Request:**



```rust
curl --location 'https://api.telegram.org/你的_BOT_API_Token/setWebhook' \
--form 'url="你的 Webhook 网址"'
```



**Response:**



```json
{
    "ok": true,
    "result": true,
    "description": "Webhook was set"
}
```



#### 测试



![](/assets/6922e90ba90c/1*wNhksFLSip5DC0rXqMA_0A.png)



![](/assets/6922e90ba90c/1*d_B3h3C30vI61p3ALP77yw.png)



- 我们会根据不同的 Chat Id 回应，因此不管是 1:1 对机器人或是有机器人在的 Group 群组都能回应。


- 成功 🎉🎉🎉



### 下篇：



- [简单 3 步骤 — 打造免费 GA4 自动数据通知机器人](../1e85b8df2348/)



### 其他 Google Apps Script 自动化文章



- [使用 Google Apps Script 实现 Google 服务 RPA 自动化](../f6713ba3fee3/)


- [Slack & ChatGPT Integration](../bd94cc88f9c9/)


- [使用 Google Apps Script 三步骤免费建立 Github Repo Star Notifier](../382218e15697/)



#### 附注



![](/assets/6922e90ba90c/1*zOFjvO5SSwbJgFL8kMff0w.png)



本文也是我 Medium 的第 100 篇文章(2018/10 发表 [第一篇](../b7a3fb3d5531/) ，6 年了)，坚持不懈、继续努力，详细心得跟数据等到破 1000 Followers (2024/10 目前 925) 或是总浏览数破 1,000,000 (2024/10 目前 984,549) 时再来分享。



有任何问题及指教欢迎 [与我联络](https://www.zhgchg.li/contact){:target="_blank"} 。



*[Post](https://medium.com/zrealm-robotic-process-automation/10-%E5%88%86%E9%90%98%E5%BF%AB%E9%80%9F%E7%A7%BB%E8%BD%89-line-notify-%E5%88%B0-telegram-bot-%E9%80%9A%E7%9F%A5-6922e90ba90c){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}.*