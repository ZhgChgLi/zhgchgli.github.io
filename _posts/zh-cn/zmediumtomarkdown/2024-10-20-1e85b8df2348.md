---
author: ZhgChgLi
categories:
- ZRealm Robotic Process Automation
date: 2024-10-20T08:19:52.764+0000
description: 使用 Google Apps Script 完成 RPA，自行串接 GA4 + Telegram Bot 数据通知机器人
image:
  path: /assets/1e85b8df2348/1*La0AKKSrGNP9EZUV-vrONQ.jpeg
last_modified_at: 2024-10-20T08:19:52.764+0000
render_with_liquid: false
tags:
- automation
- google-apps-script
- telegram
- google-analytics
- rpa-solutions
title: 简单 3 步骤 — 打造免费 GA4 自动数据通知机器人
---

### 简单 3 步骤 — 打造免费 GA4 自动数据通知机器人



使用 Google Apps Script 完成 RPA，自行串接 GA4 + Telegram Bot 数据通知机器人



![Photo by [BoliviaInteligente](https://unsplash.com/@boliviainteligente?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash){:target="_blank"}](/assets/1e85b8df2348/1*La0AKKSrGNP9EZUV-vrONQ.jpeg)



Photo by [BoliviaInteligente](https://unsplash.com/@boliviainteligente?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash){:target="_blank"}



### 前言



大约从 2020 年开始就自己在摸索使用手边工具实现 RPA，从一开始只是为了自动化个人例行任务，到后来工作也加入了规模更大型的组织，时常会遇到跨团队或仰赖人与人的任务、甚至是重复性任务，才发现 RPA 自动化的效益所在。



举例来说：某个重复任务每个月会发生 10 次，每次需花费 30 分钟处理，有 60 人会遇到，每年团队等于消耗 3,600 小时在这上面，如果能投资 100 小时开发成自动化，后续解放出来的时间，就能投入在更有价值的工作上；实际等于 3,600 浪费的工时＋3,600 更值得投资的产出。



#### **详细可参考我之前的文章：**



- [2021 Pinkoi Tech Career Talk — 高效率工程团队大解密](../11f6c8568154/)


- [使用 Google Apps Script 实现每日数据报表 RPA 自动化](../f6713ba3fee3/)



#### 其他做过的 RPA：



- [GMail to Slack] [运用 Google Apps Script 转发 Gmail 信件到 Slack](../d414bdbdb8c9/)


- [Google Form x Google Sheet xSlack] [Slack 打造全自动 WFH 员工健康状况回报系统](https://medium.com/zrealm-robotic-process-automation/slack-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8B%95-wfh-%E5%93%A1%E5%B7%A5%E5%81%A5%E5%BA%B7%E7%8B%80%E6%B3%81%E5%9B%9E%E5%A0%B1%E7%B3%BB%E7%B5%B1-d61062833c1a?source=collection_home---6------9-----------------------){:target="_blank"}


- [Big Query x Slack ] [Crashlytics + Big Query 打造更即时便利的 Crash 追踪工具](https://medium.com/zrealm-robotic-process-automation/crashlytics-big-query-%E6%89%93%E9%80%A0%E6%9B%B4%E5%8D%B3%E6%99%82%E4%BE%BF%E5%88%A9%E7%9A%84-crash-%E8%BF%BD%E8%B9%A4%E5%B7%A5%E5%85%B7-e77b80cc6f89?source=collection_home---6------7-----------------------){:target="_blank"}


- [Google Analytics x Slack] [Crashlytics + Google Analytics 自动查询 App Crash-Free Users Rate](https://medium.com/zrealm-robotic-process-automation/crashlytics-google-analytics-%E8%87%AA%E5%8B%95%E6%9F%A5%E8%A9%A2-app-crash-free-users-rate-793cb8f89b72?source=collection_home---6------6-----------------------){:target="_blank"}


- [Github Webhook x Line Notify] [使用 Google Apps Script 三步骤免费建立 Github Repo Star Notifier](https://medium.com/zrealm-robotic-process-automation/%E4%BD%BF%E7%94%A8-google-apps-script-%E4%B8%89%E6%AD%A5%E9%A9%9F%E5%85%8D%E8%B2%BB%E5%BB%BA%E7%AB%8B-github-repo-star-notifier-382218e15697?source=collection_home---6------5-----------------------){:target="_blank"}


- [Slack x OpenAI (ChatGTP) ] [Slack & ChatGPT Integration](https://medium.com/zrealm-robotic-process-automation/slack-chatgpt-integration-bd94cc88f9c9?source=collection_home---6------4-----------------------){:target="_blank"}


- [Google Analytics x Google Sheet] [使用 Google Apps Script 实现每日数据报表 RPA 自动化](https://medium.com/zrealm-robotic-process-automation/%E4%BD%BF%E7%94%A8-google-apps-script-%E5%AF%A6%E7%8F%BE-google-%E6%9C%8D%E5%8B%99-rpa-%E8%87%AA%E5%8B%95%E5%8C%96-f6713ba3fee3?source=collection_home---6------3-----------------------){:target="_blank"}


- [iOS Shortcut x Line x Reminders] [iOS 捷径自动化应用场景 — 自动转发简讯与自动建立提醒待办事项](https://medium.com/zrealm-robotic-process-automation/ios-%E6%8D%B7%E5%BE%91%E8%87%AA%E5%8B%95%E5%8C%96%E6%87%89%E7%94%A8%E5%A0%B4%E6%99%AF-%E8%87%AA%E5%8B%95%E8%BD%89%E7%99%BC%E7%B0%A1%E8%A8%8A%E8%88%87%E8%87%AA%E5%8B%95%E5%BB%BA%E7%AB%8B%E6%8F%90%E9%86%92%E5%BE%85%E8%BE%A6%E4%BA%8B%E9%A0%85-309d0302877b?source=collection_home---6------2-----------------------){:target="_blank"}


- [Apple Store API x Google Play Console API x Github Action] [Github Action x ZReviewTender 免费快速部署你的 App 商城评价监控机器人](https://medium.com/zrealm-robotic-process-automation/quick-start-github-action-x-zreviewtender-%E5%85%8D%E8%B2%BB%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2%E4%BD%A0%E7%9A%84-app-%E5%95%86%E5%9F%8E%E8%A9%95%E5%83%B9%E7%9B%A3%E6%8E%A7%E6%A9%9F%E5%99%A8%E4%BA%BA-0095528cf875?source=collection_home---6------1-----------------------){:target="_blank"}


- [Telegram Bot] [10 分钟快速移转 Line Notify 到 Telegram Bot 通知](https://medium.com/zrealm-robotic-process-automation/10-%E5%88%86%E9%90%98%E5%BF%AB%E9%80%9F%E7%A7%BB%E8%BD%89-line-notify-%E5%88%B0-telegram-bot-%E9%80%9A%E7%9F%A5-6922e90ba90c?source=collection_home---6------0-----------------------){:target="_blank"}


- [Medium to Jekyllrb] [无痛转移 Medium 到自架网站](../a0c08d579ab1/)



从后台数据看之前蛮多文章有被 ChatGPT 或各种 GenAI 服务收录，间接的帮助了许多非工程背景但也想尝试使用 RPA 解决问题的朋友，因此我仍会持续分享自己生活或工作上遇到的 RPA 场景跟我的解决方案与大家分享 — [ZRealm Robotic Process Automation](../d414bdbdb8c9/) 。



#### 工商时间



如果您与您的团队有自动化工具、流程串接需求，不论是 Slack App 开发、Notion、Asana、Google Sheet、Google Form、GA 数据，各种串接需求，欢迎与我 [**联络开发**](https://zhgchg.li/contact/){:target="_blank"} 。



### 本篇 Google Analytics 4 x Telegram Bot



这次要介绍的串接场景是接续上一篇「 [10 分钟快速移转 Line Notify 到 Telegram Bot 通知](https://medium.com/zrealm-robotic-process-automation/10-%E5%88%86%E9%90%98%E5%BF%AB%E9%80%9F%E7%A7%BB%E8%BD%89-line-notify-%E5%88%B0-telegram-bot-%E9%80%9A%E7%9F%A5-6922e90ba90c?source=collection_home---6------0-----------------------){:target="_blank"} 」时想到我的 Medium 备份站「 [zhgchg.li](https://zhgchg.li/){:target="_blank"} 」一直都没有关注他的 GA4 网站数据，想说好像可以多做一个通知机器人，每日传送过去 7 天的网站数据到指定的 Telegram Channel 让我知道。



本篇只是小品，如果要做完整的自动化数据报表请参考之前的文章「 [使用 Google Apps Script 实现每日数据报表 RPA 自动化](https://medium.com/zrealm-robotic-process-automation/%E4%BD%BF%E7%94%A8-google-apps-script-%E5%AF%A6%E7%8F%BE-google-%E6%9C%8D%E5%8B%99-rpa-%E8%87%AA%E5%8B%95%E5%8C%96-f6713ba3fee3?source=collection_home---6------3-----------------------){:target="_blank"} 」另外之前也曾串过 GA4 捞取 App Crash-free rate 可参考此篇文章「 [Crashlytics + Google Analytics 自动查询 App Crash-Free Users Rate](https://medium.com/zrealm-robotic-process-automation/crashlytics-google-analytics-%E8%87%AA%E5%8B%95%E6%9F%A5%E8%A9%A2-app-crash-free-users-rate-793cb8f89b72?source=collection_home---6------6-----------------------){:target="_blank"} 」。



- Google Apps Script 免费限制、详细使用、部署、功能介绍本篇不会再多介绍，请参考 [之前文章](https://medium.com/zrealm-robotic-process-automation/%E4%BD%BF%E7%94%A8-google-apps-script-%E5%AF%A6%E7%8F%BE-google-%E6%9C%8D%E5%8B%99-rpa-%E8%87%AA%E5%8B%95%E5%8C%96-f6713ba3fee3?source=collection_home---6------3-----------------------){:target="_blank"} 。


- Telegram Bot 创建、使用本篇也不会再多介绍，同样请参考 [之前文章](https://medium.com/zrealm-robotic-process-automation/10-%E5%88%86%E9%90%98%E5%BF%AB%E9%80%9F%E7%A7%BB%E8%BD%89-line-notify-%E5%88%B0-telegram-bot-%E9%80%9A%E7%9F%A5-6922e90ba90c?source=collection_home---6------0-----------------------){:target="_blank"} 。



#### 成果



![](/assets/1e85b8df2348/1*J7QdgrJRNzVFQJfW5UBBFA.png)



先上最终效果，Google Apps Script 每日下午 12–13 点之间会自动去捞取我想要的 Google Analytics 4 网站数据并组合成讯息透过 Telegram Bot 传送到我的 Telegram Channel，我可以快速检阅近 7 天网站数据。



**我想要观测的数据是：**



- 近 7 天 `7daysAgo ~ today` 总浏览数 `screenPageViews`


- 活跃使用者数 `active7DayUsers`


- 新使用者数 `newUsers`


- Top 10 浏览页面 `screenPageViews` / `pageTitle`


- 新使用者最初来源媒介 `newUsers` / `firstUserSourceMedium`



> *实际可依照你自己的需求使用 [GA Dev Tools](https://ga-dev-tools.google/ga4/query-explorer/){:target="_blank"} 产生调整。*



### Step 1. 使用 [GA4 Query Explorer 官方工具](https://ga-dev-tools.google/ga4/query-explorer/){:target="_blank"} 产生数据报表查询参数



首先，我们需要使用 [GA4 Query Explorer](https://ga-dev-tools.google/ga4/query-explorer/){:target="_blank"} 官方提供的工具产生我们需要的查询数据报表参数：



![](/assets/1e85b8df2348/1*4b1S9nYSmO7OmGgDPllxeQ.png)



1. Select Property: 记下你的 `property 编号`
   **property 编号稍后撰写 Google Apps Script 会使用。**


2. start date, end date: 报表开始～结束的日期范围，可使用 `YYYY-MM-DD` 或 `yesterday` , `today` , `NdaysAgo` 魔术变数。


3. metrics: 选择你想要查询的指标


4. dimensions: 选择你想要查询的维度


5. metric aggregations: 数据合并计算规则



这边以我的场景为例：



1. property 编号: `318495208`


2. start_date: `7daysAgo`


3. end_date: `yesterday`
   因 GA 数据报表会延迟，查询前一天～七天最准确。


4. metric aggregations: `total`



**其他 filter, limit 可依照自己需求设定：**



![](/assets/1e85b8df2348/1*g2psNn3gMZWs4OFRx7phWQ.png)



filter 我用不到留空；limit 我输入 10，因为我只想知道 Top 10。



#### **点击「MAKE REQUEST」产生对应的数据报表查询参数及结果：**



![](/assets/1e85b8df2348/1*Rj1kMTyZiEYGvAztEEngIQ.png)



#### **记下以下请求参数，稍后撰写 Google Apps Script 会使用：**



```json
{
  "dimensions": [
    {
      "name": "pageTitle"
    }
  ],
  "metrics": [
    {
      "name": "screenPageViews"
    }
  ],
  "dateRanges": [
    {
      "startDate": "7daysAgo",
      "endDate": "yesterday"
    }
  ],
  "limit": "10",
  "metricAggregations": [
    "TOTAL"
  ]
}
```



#### **结果：**



![](/assets/1e85b8df2348/1*ivAXeRTVB8Y7zbP-Gq2I2A.png)



![](/assets/1e85b8df2348/1*FFThyuptIYrGsfddHcjupQ.jpeg)



- 与 GA 上的数据比较是否正确，正确相符 ✅✅✅



### Step 2. 建立 Google Apps Script & 使用 Google Analytics Data API 查询资料



- 前往 <https://script.google.com/home>{:target="_blank"}


- 建立新专案，命名专案名称


- 点击「服务」-&gt;「+」新增服务


- 选择「Google Analytics Data API」


- 点击「新增」



![](/assets/1e85b8df2348/1*gcMDDQTXd-Gos5AdGUXIOw.png)



**贴上 Google Analytics Data API 查询程式码并组合：**



将前面步骤产生的报表查询数据参数：



```json
{
  "dimensions": [
    {
      "name": "pageTitle"
    }
  ],
  "metrics": [
    {
      "name": "screenPageViews"
    }
  ],
  "dateRanges": [
    {
      "startDate": "7daysAgo",
      "endDate": "yesterday"
    }
  ],
  "limit": "10",
  "metricAggregations": [
    "TOTAL"
  ]
}
```



**转换成程式：**



```javascript
function execute() {
  Logger.log(JSON.stringify(fetchScreenPageViews("318495208")));
}

// 拆成独立方法，方便日后重复使用...
// 预设 startDate=7daysAgo, endDate=yesterday
// 其他用法：
// e.g. fetchScreenPageViews("1111". "3daysAgo", "yesterday")
// e.g. fetchScreenPageViews("2222". "yesterday", "today")
function fetchScreenPageViews(propertyId, startDate = "7daysAgo", endDate = "yesterday") {
  const screenPageViewsMetric = AnalyticsData.newMetric();
  screenPageViewsMetric.name = "screenPageViews";

  const dateRange = AnalyticsData.newDateRange();
  dateRange.startDate = startDate;
  dateRange.endDate = endDate;

  const pageTitleDimension = AnalyticsData.newDimension();
  pageTitleDimension.name = "pageTitle";

  const request = AnalyticsData.newRunReportRequest();
  request.dimensions = [pageTitleDimension];
  request.metrics = [screenPageViewsMetric];
  request.dateRanges = dateRange;

  request.limit = 10;
  request.metricAggregations = "TOTAL";

  return AnalyticsData.Properties.runReport(request, "properties/" + propertyId);
}
```



程式码解析：



```javascript
// metric 指标，可以是多个，请分开宣告...
const screenPageViewsMetric = AnalyticsData.newMetric();
screenPageViewsMetric.name = "screenPageViews";

// 例如另一个 active1DayUsers：
const active1DayUsersMetric = AnalyticsData.newMetric();
active1DayUsersMetric.name = "active1DayUsers";

// 宣告日期范围
const dateRange = AnalyticsData.newDateRange();
dateRange.startDate = startDate;
dateRange.endDate = endDate;

// dimension 维度，可以是多个，请分开宣告...
const pageTitleDimension = AnalyticsData.newDimension();
pageTitleDimension.name = "pageTitle";

// 例如另一个 dimension：
const firstUserSourceMediumDimension = AnalyticsData.newDimension();
firstUserSourceMediumDimension.name = "firstUserSourceMedium";

//

// 产生 Request 物件
const request = AnalyticsData.newRunReportRequest();
request.metrics = [active1DayUsersMetric, active1DayUsersMetric]; // 多个就都带入...
request.dimensions = [pageTitleDimension, firstUserSourceMediumDimension]; // 多个就都带入...

request.dateRanges = dateRange;

// 只需要前 10 笔资料 (Top 10)
request.limit = 10;

// 设定数据合并计算逻辑：Total (SUM)
request.metricAggregations = "TOTAL";

// 产生查询结果
return AnalyticsData.Properties.runReport(request, "properties/" + propertyId).rows;
```



**第一次执行，会需要授权(日后若程式码有新增需要的权限也会要重新认证一次)：**



> *实际上就是授权 Google Apps Script 日后使用你的帐号身份执行这些程式，所以需要确保你选择的帐号身份有对应的 GA 报表存取权限。*



![](/assets/1e85b8df2348/1*_z-P8a4PZCozhtgssH82lA.png)



- 撰写好程式码后，点击「侦错」-&gt; 点击「审查权限」



![](/assets/1e85b8df2348/1*ehox-4AjKv3Ddf1jJ_VmTQ.png)



- 选择要执行的身份帐户，通常等于当前 Google Apps Script 帐户



![](/assets/1e85b8df2348/1*onR-n1sI4-G9KhD_fhef3Q.png)



- 选择「进阶」展开 -&gt; 点击「前往 XXX」
  这是我们自己写给自己用的应用程式，不需经过 Google 验证。



![](/assets/1e85b8df2348/1*73fQnaB__qKhO7NndQ0GyQ.png)



- 点击「允许」



**允许之后再点「侦错」或「执行」就能执行程式：**



![](/assets/1e85b8df2348/1*DbcQnfp8xdJCFnrDc778tw.png)



这边我们先使用 `Logger.log(JSON.stringify())` 取得输出结果：



```json
{
  "kind": "analyticsData#runReport",
  "dimensionHeaders": [
    {
      "name": "pageTitle"
    }
  ],
  "rowCount": 71,
  "metadata": {
    "currencyCode": "TWD",
    "timeZone": "Asia/Taipei"
  },
  "rows": [
    {
      "dimensionValues": [
        {
          "value": "ZhgChgLi"
        }
      ],
      "metricValues": [
        {
          "value": "166"
        }
      ]
    },
    {
      "metricValues": [
        {
          "value": "109"
        }
      ],
      "dimensionValues": [
        {
          "value": "Apple Watch 原厂不锈钢米兰表带开箱 \\| ZhgChgLi"
        }
      ]
    },
    {
      "dimensionValues": [
        {
          "value": "iOS ≥ 13.1 使用「捷径」自动化功能搭配米家智慧家居 \\| ZhgChgLi"
        }
      ],
      "metricValues": [
        {
          "value": "101"
        }
      ]
    },
    {
      "dimensionValues": [
        {
          "value": "Medium Partner Program 终于对全球(包含台湾)写作者开放啦！ \\| ZhgChgLi"
        }
      ],
      "metricValues": [
        {
          "value": "85"
        }
      ]
    },
    {
      "metricValues": [
        {
          "value": "77"
        }
      ],
      "dimensionValues": [
        {
          "value": "iOS 捷径自动化应用场景 — 自动转发简讯与自动建立提醒待办事项 \\| ZhgChgLi"
        }
      ]
    },
    {
      "metricValues": [
        {
          "value": "51"
        }
      ],
      "dimensionValues": [
        {
          "value": "游记 9/11 名古屋一日快闪自由行 \\| ZhgChgLi"
        }
      ]
    },
    {
      "metricValues": [
        {
          "value": "42"
        }
      ],
      "dimensionValues": [
        {
          "value": "iOS 隐私与便利的前世今生 \\| ZhgChgLi"
        }
      ]
    },
    {
      "dimensionValues": [
        {
          "value": "iOS Vision framework x WWDC 24 Discover Swift enhancements in the Vision framework Session \\| ZhgChgLi"
        }
      ],
      "metricValues": [
        {
          "value": "34"
        }
      ]
    },
    {
      "dimensionValues": [
        {
          "value": "iOS ≥ 18 NSAttributedString attributes Range 合并的一个行为改变 \\| ZhgChgLi"
        }
      ],
      "metricValues": [
        {
          "value": "30"
        }
      ]
    },
    {
      "metricValues": [
        {
          "value": "30"
        }
      ],
      "dimensionValues": [
        {
          "value": "手工打造 HTML 解析器的那些事 \\| ZhgChgLi"
        }
      ]
    }
  ],
  "metricHeaders": [
    {
      "type": "TYPE_INTEGER",
      "name": "screenPageViews"
    }
  ],
  "totals": [
    {
      "dimensionValues": [
        {
          "value": "RESERVED_TOTAL"
        }
      ],
      "metricValues": [
        {
          "value": "1229"
        }
      ]
    }
  ]
}
```



- **Google Apps Script 请求 GA 数据成功！🎉🎉🎉**



### Step 3. 组合起来！Google Apps Script + GA4 + Telegram Bot



依照上篇文章「 [10 分钟快速移转 Line Notify 到 Telegram Bot 通知](https://medium.com/zrealm-robotic-process-automation/10-%E5%88%86%E9%90%98%E5%BF%AB%E9%80%9F%E7%A7%BB%E8%BD%89-line-notify-%E5%88%B0-telegram-bot-%E9%80%9A%E7%9F%A5-6922e90ba90c?source=collection_home---6------0-----------------------){:target="_blank"} 」建立你的 Telegram Bot 取得 `Bot Token` & 想要传送到的 `Channel Chat ID` 。



```javascript
const telegramToken = "XXXX" // 带入你的 Telegram Bot Token
//

function execute() {
  const screenPageViewsReport = fetchScreenPageViews("318495208");
  
  //
  const total = parseInt(screenPageViewsReport.totals[0].metricValues[0].value);
  var message = "总浏览数："+total.toLocaleString()+"\n";

  screenPageViewsReport.rows.forEach(function(element, index) {
    const pageTitle = element.dimensionValues[0].value;
    const value = parseInt(element.metricValues[0].value);

    message += "[Top "+(index + 1)+"] "+pageTitle+": "+value.toLocaleString()+"\n";
  });

  sendNotifyMessage(message, -xxxx); // 带入你的 Channel Chat ID
}


// 发送讯息到 Telegram 指定 Channel Chat ID
function sendNotifyMessage(message, chatId) {
  var url = "https://api.telegram.org/bot"+telegramToken+"/sendMessage";
  
  const payload = {
    "chat_id": chatId,
    "text": message,
    "disable_web_page_preview": true
  } 
  const options = {
    'method': 'post',
    'contentType': 'application/json',
    'muteHttpExceptions': true,
    'payload': JSON.stringify(payload)
  };

  const response = UrlFetchApp.fetch(url, options);
  const data = JSON.parse(response.getContentText());

  if (data["ok"] == undefined \\|\\| data["ok"] != true) {
    if (data["error_code"] != undefined && data["error_code"] == 429) {
      Utilities.sleep(1000);
      sendNotifyMessage(message, chatId);
    }
  }
}

function fetchScreenPageViews(propertyId, startDate = "7daysAgo", endDate = "yesterday") {
  const screenPageViewsMetric = AnalyticsData.newMetric();
  screenPageViewsMetric.name = "screenPageViews";

  const dateRange = AnalyticsData.newDateRange();
  dateRange.startDate = startDate;
  dateRange.endDate = endDate;

  const pageTitleDimension = AnalyticsData.newDimension();
  pageTitleDimension.name = "pageTitle";

  const request = AnalyticsData.newRunReportRequest();
  request.dimensions = [pageTitleDimension];
  request.metrics = [screenPageViewsMetric];
  request.dateRanges = dateRange;

  request.limit = 10;
  request.metricAggregations = "TOTAL";

  return AnalyticsData.Properties.runReport(request, "properties/" + propertyId);
}
```



程式码解析：



```javascript
//...
  // 依照报表回传的 json 找到 total 位置，parseInt 将字串转成 INT 数字格式
  // .toLocaleString() -> 格式化数字，123456 -> 123,456
  const total = parseInt(screenPageViewsReport.totals[0].metricValues[0].value);
  var message = "总浏览数："+total.toLocaleString()+"\n";

  // 依照报表回传的 json 遍历资料，组合成讯息
  screenPageViewsReport.rows.forEach(function(element, index) {
    const pageTitle = element.dimensionValues[0].value;
    const value = parseInt(element.metricValues[0].value);

    message += "[Top "+(index + 1)+"] "+pageTitle+": "+value.toLocaleString()+"\n";
  });
//...
```



#### **执行：点击上方「执行」或「侦错」并确定方法名称是选择「 `execute` 」：**



![](/assets/1e85b8df2348/1*R7uVMGODJR2Z_GAYnyMYXA.png)



![](/assets/1e85b8df2348/1*Pl2v19Ed8COUwCc1deTYFw.png)



- **成功！🎉🎉🎉**



#### 设定排程定时自动执行



最后一步是我们希望报表机器人能定时自动执行，从左侧选单前往「触发条件」：



![](/assets/1e85b8df2348/1*SY1YKLwTvDtP1hQTRqj50w.png)



- 选择右下角「新增触发条件」按钮



![](/assets/1e85b8df2348/1*wYOwwQBTEtns8nN_7bmvNQ.png)



1. 选择镡要执行的功能：选择 「 `execute` 」方法名称


2. 选择执行的部署作业：选择「 `上端` 」


3. 选取活动来源：选择「 `时间驱动` 」


4. 选取时间型触发条件类型：选择你想要的触发频率


5. 选取时段：选择你想要每日自动触发的时间


6. 如果执行失败…通知信件的频率设定


7. 储存



> ***完成！这样时间到就会自动执行啰。*** 🎉🎉🎉



### 延伸作业



其他数据如 新使用者数、来源媒介等，同样使用前面程式码就能达成，这边就不在重复赘述，就当成给大家的回家作业啰。



有任何问题及指教欢迎 [与我联络](https://www.zhgchg.li/contact){:target="_blank"} 。



*[Post](https://medium.com/zrealm-robotic-process-automation/%E7%B0%A1%E5%96%AE-3-%E6%AD%A5%E9%A9%9F-%E6%89%93%E9%80%A0%E5%85%8D%E8%B2%BB-ga4-%E8%87%AA%E5%8B%95%E6%95%B8%E6%93%9A%E9%80%9A%E7%9F%A5%E6%A9%9F%E5%99%A8%E4%BA%BA-1e85b8df2348){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}.*