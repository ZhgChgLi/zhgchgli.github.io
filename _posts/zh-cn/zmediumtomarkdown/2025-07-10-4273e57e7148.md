---
author: ZhgChgLi
categories:
- ZRealm Dev.
date: 2025-07-10T12:30:51.530+0000
description: GAS Web App ä¸²æ¥ GitHub, Slack, Firebase æˆ– Asana/Jira APIï¼Œå»ºç½®ä¸­ç»§ç«™ï¼Œæä¾›è·¨å›¢é˜Ÿå…±ç”¨çš„æ‰“åŒ…å·¥å…·å¹³å°
image:
  path: /assets/4273e57e7148/1*kJhD4PCaIphZ9G1BG_dtNw.jpeg
last_modified_at: 2025-07-12T04:35:07.112+0000
render_with_liquid: false
tags:
- simplified-chinese
- ios-app-development
- cicd
- google-apps-script
- web-development
- tools
title: CI/CD å®æˆ˜æŒ‡å—ï¼ˆå››ï¼‰ï¼šä½¿ç”¨ Google Apps Script Web App ä¸²æ¥ GitHub Actions å»ºç½®å…è´¹æ˜“ç”¨çš„æ‰“åŒ…å·¥å…·å¹³å°
---

### CI/CD å®æˆ˜æŒ‡å—ï¼ˆå››ï¼‰ï¼šä½¿ç”¨ Google Apps Script Web App ä¸²æ¥ GitHub Actions å»ºç½®å…è´¹æ˜“ç”¨çš„æ‰“åŒ…å·¥å…·å¹³å°



GAS Web App ä¸²æ¥ GitHub, Slack, Firebase æˆ– Asana/Jira APIï¼Œå»ºç½®ä¸­ç»§ç«™ï¼Œæä¾›è·¨å›¢é˜Ÿå…±ç”¨çš„æ‰“åŒ…å·¥å…·å¹³å°



![Photo by [Lee Campbell](https://unsplash.com/@leecampbell?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash){:target="_blank"}](/assets/4273e57e7148/1*kJhD4PCaIphZ9G1BG_dtNw.jpeg)



Photo by [Lee Campbell](https://unsplash.com/@leecampbell?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash){:target="_blank"}



### å‰è¨€



å‰ç¯‡ã€Œ [**CI/CD å®æˆ˜æŒ‡å—ï¼ˆä¸‰ï¼‰ï¼šä½¿ç”¨ GitHub Actions å®ä½œ App iOS CI ä¸ CD å·¥ä½œæµç¨‹**](../4b001d2e8440/) ã€æˆ‘ä»¬å·²ç»å®Œæˆäº† App iOS ä¸“æ¡ˆçš„ CI/CD åº•å±‚åŠŸèƒ½å»ºè®¾ï¼Œç°åœ¨å·²ç»å¯ä»¥ CI è‡ªåŠ¨æµ‹è¯•éªŒè¯è·Ÿ CD æ‰“åŒ…éƒ¨ç½²ï¼›ç„¶è€Œåœ¨å®åŠ¡äº§å“å¼€å‘æµç¨‹ä¸Šï¼Œ **æ‰“åŒ…éƒ¨ç½²å·¥ä½œå¤šåŠæ˜¯ä¸ºäº†åç»­äº¤ä»˜ç»™å…¶ä»–èŒèƒ½ä¼™ä¼´** è¿› è¡Œ QA(Quality Assurance) åŠŸèƒ½éªŒè¯ï¼Œè¿™æ—¶å€™ CD åœºæ™¯å°±ä¸åœ¨åªå±€é™åœ¨å·¥ç¨‹ç«¯äº†ï¼Œå¯èƒ½è·¨è¶³ QAã€PMã€è®¾è®¡(Design QA) ç”šè‡³æ˜¯è€æ¿æƒ³å…ˆç©çœ‹çœ‹ã€‚



GitHub Actions `workflow_dispatch` æ‰‹åŠ¨è¡¨å•è§¦å‘äº‹ä»¶ï¼Œè™½ç„¶èƒ½æä¾›ç®€æ˜“çš„è¡¨å•è®©ä½¿ç”¨è€…æ“ä½œæ‰“åŒ…ï¼Œä½†å¦‚æœæ“ä½œçš„å¯¹è±¡æ˜¯éå·¥ç¨‹äººå‘˜å°±ç›¸å¯¹å¾ˆä¸å‹å–„ï¼Œä»–ä»¬ä¸æ‡‚ï¼šä»€ä¹ˆæ˜¯åˆ†æ”¯ï¼Ÿæ ä½è¦ä¸è¦å¡«ï¼Ÿæ€ä¹ˆçŸ¥é“æ‰“åŒ…å¥½äº†ï¼Ÿå¥½äº†æ€ä¹ˆä¸‹è½½ï¼Ÿâ€¦etc
å¦å¤–è¿˜æœ‰æƒé™æ§ç®¡é—®é¢˜ï¼Œå¦‚æœè¦è®©å…¶ä»–èŒèƒ½ä¼™ä¼´ç›´æ¥ä½¿ç”¨ GitHub Actions æ‰“åŒ…ï¼Œå°±éœ€è¦æŠŠä»–çš„å¸å·åŠ åˆ° Repo å½“ä¸­ï¼Œ **èµ„å®‰æ§ç®¡ä¸Šå¾ˆä¸å®‰å…¨ä¹Ÿä¸åˆç†** ï¼Œåªæ˜¯è¦æ“ä½œæ‰“åŒ…è¡¨å•å´è¦å¼€æ•´ä¸ª Source Code ç»™ä»–ã€‚



ä¸åŒäº Jenkins æœ‰ç‹¬ç«‹çš„ Web å·¥å…·å¹³å°ï¼ŒGitHub Actions å°±åªæœ‰è¿™ä¸ªåŠŸèƒ½ã€‚



![`workflow_dispatch çš„è¡¨å•æ ·å¼`](/assets/4273e57e7148/1*qDD8HAAHxDxPEU3vJPEhjA.png)



`workflow_dispatch çš„è¡¨å•æ ·å¼`



å› æ­¤ **æˆ‘ä»¬éœ€è¦ä¸€ä¸ªä¸­ç»§ç«™æ‰“åŒ…å¹³å°ï¼Œç”¨æ¥æœåŠ¡å…¶ä»–èŒèƒ½ä½¿ç”¨è€…** ï¼Œæ•´åˆ Asana/Jira çš„ä»»åŠ¡å•ï¼Œè®©ä½¿ç”¨çš„äººå¯ä»¥ç›´æ¥ç”¨ä»»åŠ¡å•æ‰“åŒ… Appï¼Œå¹¶ä¸”ç›´æ¥åœ¨ä¸Šé¢æŸ¥çœ‹è¿›åº¦ã€ä¸‹è½½æ‰“åŒ…ç»“æœã€‚



![GAS Web App ä¸­ç»§ç«™](/assets/4273e57e7148/1*bHYawmSnhqwB4TzIJVfGow.png)



GAS Web App ä¸­ç»§ç«™



[ä¸Šä¸€ç¯‡](../4b001d2e8440/) å…³æ³¨çš„æ˜¯å³è¾¹æ ¸å¿ƒ GitHub Actions CI/CD å·¥ä½œæµç¨‹å¼€å‘ï¼›æœ¬æ–‡å…³æ³¨çš„æ˜¯å·¦åŠéƒ¨ to End-User æ‰“åŒ…å·¥å…·å¹³å°ã€å¢åŠ ä½¿ç”¨è€…ä½“éªŒçš„éƒ¨åˆ†ã€‚



#### Google Apps Script â€” Web App æ‰“åŒ…å·¥å…·å¹³å° æˆæœå›¾



![](/assets/4273e57e7148/1*yXMeaOELhqdvMCxIJ5ElBw.gif)



![](/assets/4273e57e7148/1*EM0goWpuDeHGVkZoybLm8g.png)



![](/assets/4273e57e7148/1*haoGMvAUroz7rUMDEez9gA.png)



![](/assets/4273e57e7148/1*afCwKITlerG1g6swB_2wZA.png)



![](/assets/4273e57e7148/1*mvwpHBdrC73_PjL8H32nkw.jpeg)



![](/assets/4273e57e7148/1*BbbEd_thhUOdbAQqsCt-Tw.png)



![](/assets/4273e57e7148/1*HXjfMpUPssaw3sJgH6KKJQ.png)



- **æ‰“åŒ…è¡¨å•ï¼š** æ•´åˆä¸“æ¡ˆç®¡ç†å·¥å…·æå–å•å·ã€æ•´åˆ GitHub æå–å¼€å¯ä¸­çš„ Pull Request


- **æŠŠåŒ…çºªå½•ï¼š** æ˜¾ç¤ºæ‰“åŒ…å†å²çºªå½•ã€æ­£åœ¨æ‰“åŒ…çš„ä»»åŠ¡è¿›åº¦çŠ¶æ€ã€ç‚¹å‡»å–å¾—ä¸‹è½½è¿ç»“æå– Firebase App Distribution ä¸‹è½½è¿ç»“ã€èµ„è®¯


- **Runner çŠ¶æ€ï¼š** æ˜¾ç¤º Self-hosted Runner çŠ¶æ€ã€‚


- **Slack æ‰“åŒ…è¿›åº¦é€šçŸ¥ã€‚**


- æ”¯æ´æ‰‹æœºç‰ˆ


- æ”¯æ´é™åˆ¶ç»„ç»‡å›¢é˜Ÿå†…å¸å·ä½¿ç”¨



**ä¸»è¦èŒè´£**



0 çŠ¶æ€ã€0 èµ„æ–™åº“ï¼Œ **å•çº¯ä¸ºä¸­ç»§äº¤æ¢ç«™** ï¼Œæ•´åˆæ˜¾ç¤ºå„ä¸ª API èµ„æ–™ (e.g. Asana/Jira/GitHub)ã€è½¬å‘è¡¨å•è¯·æ±‚åˆ° GitHub Actionsã€‚



**æ“ä½œè¦æ±‚ï¼š** æ”¯æ´æ‰‹æœºä¸ç”µè„‘ã€‚



**æƒé™è¦æ±‚ï¼š** èƒ½é™åˆ¶åªæœ‰å›¢é˜Ÿç»„ç»‡æˆå‘˜èƒ½å­˜å–ã€‚



#### Online Demo Web App



[**Sign in**](https://script.google.com/macros/s/AKfycbxk1nYhzfBzqny34rvBlxmcWMEQbWTL5a28mBmYId0NDaCZd0S-U3ytpBoTi2wZp0d6cg/exec){:target="_blank"} 
[*Edit description* script.google.com](https://script.google.com/macros/s/AKfycbxk1nYhzfBzqny34rvBlxmcWMEQbWTL5a28mBmYId0NDaCZd0S-U3ytpBoTi2wZp0d6cg/exec){:target="_blank"}



### æŠ€æœ¯é€‰æ‹©



[ç¬¬ä¸€ç¯‡æ–‡ç« ](../c008a9e8ceca/) æœ‰æåˆ°è¿‡ï¼Œè¿™è¾¹å†è¯¦ç»†æ•´ç†ä¸€æ¬¡ã€‚



#### æ•´åˆè¿› Slack



æˆ‘ä»¬å°è¯•è¿‡è®© Slack æ‹…ä»»æ‰“åŒ…å¹³å°ï¼Œè‡ªè¡Œå¼€å‘åç«¯æœåŠ¡å¹¶æ¶è®¾åœ¨ GCP ä¸Šï¼Œä¸ Slack APIã€Asana API è¿›è¡Œä¸²æ¥æ•´åˆï¼Œå†å°† Slack é€æ¥çš„è¡¨å•è½¬æ‰‹å‘é€ç»™ GitHub API è§¦å‘åç»­ GitHub Actionsï¼›ä½“éªŒä¸Šéå¸¸çˆ½è€Œä¸”ç»Ÿä¸€åœ¨å›¢é˜Ÿçš„åä½œå·¥å…·ä¸Šï¼Œå¯ä»¥æ— ç—›ä½¿ç”¨ï¼› **ç¼ºç‚¹æ˜¯å¼€å‘åŠåç»­ç»´æŠ¤æˆæœ¬å¾ˆé«˜** ï¼Œå› ä¸ºæ˜¯è‡ªå·±ç”¨ Ktor å¼€å‘çš„åç«¯æœåŠ¡ï¼Œéœ€è¦ App å·¥ç¨‹å¸ˆåŒæ—¶å…¼åšåç«¯ã€å¤„ç† Google æœåŠ¡ OAuth æ•´åˆé—®é¢˜ã€éƒ¨åˆ†åŠŸèƒ½å¯èƒ½åœ¨è¿™åšæ‰(ä¾‹å¦‚ï¼šé€å®¡)â€¦åŠŸèƒ½å¤æ‚ï¼›å¦‚æœåæ¥çš„æ–°äººæ²¡è¡”æ¥å¥½è¿™æ•´å—å‡ ä¹æ²¡åŠæ³•ç»´æŠ¤ä¸‹å»äº†ï¼Œå¦å¤–æ¯ä¸ªæœˆè¿˜è¦èŠ± $15 USD GCP ä¼ºæœå™¨è´¹ç”¨ã€‚



åˆæœŸä¹Ÿå°è¯•è¿‡ç”¨ FaaS æœåŠ¡ä¸²æ¥ Slack APIï¼Œä¾‹å¦‚ Cloud Funtionsï¼Œä½†æ˜¯ Slack API è¦æ±‚ä¸²æ¥çš„æœåŠ¡è¦èƒ½åœ¨ 3 ç§’å†…å›åº”è¯·æ±‚ï¼Œå¦åˆ™è§†ä¸ºå¤±è´¥ï¼›FaaS ä¼šæœ‰ [å†·å¯åŠ¨é—®é¢˜](https://www.cloudflare.com/zh-tw/learning/serverless/what-is-serverless/){:target="_blank"} ï¼Œå½“æœåŠ¡ä¸€æ®µæ—¶é—´æ²¡å‘¼å«å°±ä¼šè¿›å…¥ä¼‘çœ ï¼Œå†æ¬¡å‘¼å«æ—¶ä¼šéœ€è¦è¾ƒé•¿æ—¶é—´æ‰èƒ½å“åº” (â‰¥ 5ç§’)ï¼Œä¼šé€ æˆ Slack æ‰“åŒ…è¡¨å•å¾ˆä¸ç¨³å®šï¼Œæ—¶å¸¸å‡ºç° Timeout Errorã€‚



#### æ•´åˆè¿›å†…éƒ¨ç³»ç»Ÿ



è¿™å½“ç„¶æ˜¯æœ€ä¼˜è§£ï¼Œå¦‚æœå›¢é˜Ÿæœ‰ Webã€åç«¯äººåŠ›ï¼Œç›´æ¥ä¸ç°æœ‰ç³»ç»Ÿæ•´åˆæ˜¯æœ€å¥½ä¹Ÿæœ€å®‰å…¨çš„ã€‚



> *æœ¬æ–‡çš„å‰ææ˜¯ï¼šæ²¡æœ‰ï¼ŒApp è‡ªç«‹è‡ªå¼ºã€‚*



#### Google Apps Script â€” Web App



Google Apps Script æ˜¯æˆ‘ä»¬çš„è€ä¼™ä¼´ï¼Œä¹‹å‰åšè¿‡å¾ˆå¤š RPA ä¸“æ¡ˆéƒ½æ˜¯ç”¨ä»–å»åšæ’ç¨‹è§¦å‘æ‰§è¡Œä»»åŠ¡ï¼Œä¾‹å¦‚ï¼šã€Œ [Crashlytics + Google Analytics è‡ªåŠ¨æŸ¥è¯¢ App Crash-Free Users Rate](../793cb8f89b72/) ã€ã€ã€Œ [ä½¿ç”¨ Google Apps Script å®ç°æ¯æ—¥æ•°æ®æŠ¥è¡¨ RPA è‡ªåŠ¨åŒ–](../f6713ba3fee3/) ã€ï¼Œè¿™æ—¶å€™æˆ‘åˆæƒ³èµ·äº†å®ƒï¼›GAS æœ‰ä¸€ä¸ªåŠŸèƒ½æ˜¯éƒ¨ç½²æˆ Web (App) ç›´æ¥å½“ç½‘é¡µæœåŠ¡ã€‚



**Google Apps Script ä¼˜ç‚¹ï¼š**



- âœ… å…è´¹ã€ [æ­£å¸¸ä½¿ç”¨ä¸‹å‡ ä¹æ‘¸ä¸åˆ°ä¸Šé™](https://developers.google.com/apps-script/guides/services/quotas?hl=zh-tw){:target="_blank"}


- âœ… Functions as a Service æ–¹æ³•å³æœåŠ¡ï¼Œä¸éœ€è‡ªè¡Œæ¶è®¾ç»´æŠ¤ä¼ºæœå™¨


- âœ… æƒé™æ§ç®¡åŒ Google Workspaceï¼Œå¯è®¾å®šä»…é™ç»„ç»‡å†… Google å¸å·ä½¿ç”¨


- âœ… æ— ç—›æ•´åˆ Google ç”Ÿæ€ç³»ç›¸å…³æœåŠ¡(e.g. Firebase, GAâ€¦etc)ä¸èµ„æ–™ (ä¸ç”¨è‡ªå·±åš OAuth)


- âœ… ç¨‹å¼è¯­è¨€ä½¿ç”¨ JavaScript æ˜“ä¸Šæ‰‹ (V8 Runtime æ”¯æ´ ES6+ )


- âœ… å¿«é€Ÿæ’°å†™ã€å¿«é€Ÿä¸Šçº¿ã€å¿«é€Ÿä½¿ç”¨


- âœ… æœåŠ¡ç¨³å®šã€é•¿ä¹… (å·²æ¨å‡ºè¶…è¿‡ 16 å¹´)


- **âœ… AI Can Help! å®æµ‹ä½¿ç”¨ ChatGPT è¾…åŠ©å¼€å‘ï¼Œå‡†ç¡®ç‡å¯è¾¾ 95%**



**Google Apps Script ç¼ºç‚¹ï¼š**



- âŒ å†…å»ºçš„ç‰ˆæœ¬ç®¡æ§ä¸€è¨€éš¾å°½


- âŒ å†…å»ºä¸æ”¯æ´æ¡£æ¡ˆã€èµ„æ–™å‚¨å­˜ã€é‡‘é’¥/å‡­è¯ç®¡ç†


- âŒ Web App æ— æ³•åšåˆ° 100% ä½“éªŒçš„ RWD


- âŒ ä¸“æ¡ˆåªèƒ½ç»‘åœ¨ä¸ªäººå¸å·è€Œä¸æ˜¯ç»„ç»‡


- âŒ è™½ç„¶ Google æœ‰æŒç»­åœ¨å¼€å‘ç»´æŠ¤ï¼Œä½†æ•´ä½“åŠŸèƒ½æ›´æ–°ç¼“æ…¢


- âŒ ç½‘è·¯è¯·æ±‚ `UrlFetchApp` ä¸æ”¯æ´è®¾å®š User-Agent


- âŒ Web App `doGet` / `doPost` ä¸æ”¯æ´å–å¾— Headers èµ„è®¯


- âŒ FaaS [å†·å¯åŠ¨é—®é¢˜](https://www.cloudflare.com/zh-tw/learning/serverless/what-is-serverless/){:target="_blank"}


- âŒ **ä¸æ”¯æ´å¤šäººåŒæ—¶å¼€å‘**
  ä½†åœ¨ Web App å½±å“ä¸å¤§ï¼Œé¡¶å¤šè¦å¤šç­‰å‡ ç§’æ‰è¿›å…¥ç½‘é¡µã€‚



ä»¥ä¸Šæ˜¯ GAS æœ¬èº«æœåŠ¡çš„ä¼˜ç¼ºç‚¹ï¼Œå¯¹åšæ‰“åŒ…å·¥å…· Web å½±å“ä¸å¤§ï¼›é€‰æ‹©ä½¿ç”¨æ­¤æ–¹æ¡ˆå¯¹æ¯” Slack æ–¹æ¡ˆï¼Œæ›´å¿«é€Ÿã€è½»é‡è·Ÿå®¹æ˜“äº¤æ¥ä¸Šæ‰‹ï¼Œ **ç¼ºç‚¹æ˜¯å›¢é˜Ÿéœ€è¦å¤šçŸ¥é“è¿™ä¸ªå·¥å…·çš„ç½‘å€åœ¨å“ªè·Ÿæ€ä¹ˆç”¨ã€è¿˜æœ‰å›  GAS ç¨‹å¼åº“åŠŸèƒ½æœ‰é™** (e.g. æ— å†…å»ºåŠ å¯†æ¼”ç®—æ³•åº“) åŸºæœ¬ä¸Šåªèƒ½åšçº¯ä¸­ç»§å¹³å°ï¼Œä¾‹å¦‚é€å®¡ï¼Œé‚£ä¹Ÿåªèƒ½è½¬å‘é€å®¡è¯·æ±‚è¯· GitHub Actions åšã€‚



> ***å¦å¤–ä¹Ÿä»…é€‚ç”¨æ˜¯ Google Workspace å·¥ä½œç¯å¢ƒçš„å›¢é˜Ÿï¼›*** *æƒè¡¡äº†èµ„æºä¸éœ€æ±‚ï¼Œå› æ­¤é‡‡ç”¨ Google Apps Script â€” Web App æ¥å®ç°æ‰“åŒ…å·¥å…·å¹³å°ã€‚*



#### UI Framework



[![](https://getbootstrap.com/docs/5.3/assets/brand/bootstrap-social.png)](https://getbootstrap.com/){:target="_blank"}



æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ Bootstrap CDNï¼Œä¸ç„¶è¦è‡ªå·±å¼„ CSS æ ·å¼å¤ªéº»çƒ¦äº†ï¼ŒBootstrap é—® AI æ€ä¹ˆç»„åˆä½¿ç”¨ä¹Ÿæ›´å‡†ç¡®æ–¹ä¾¿ã€‚



### åŠ¨æ‰‹åš



è¿™è¾¹å·²ç»æŠŠæ•´ä¸ªå¹³å°æ¶æ„å¼€æºäº†ï¼Œå¤§å®¶å¯ä»¥ä¾ç…§è‡ªå·±å›¢é˜Ÿçš„éœ€æ±‚åŸºäºè¿™ä¸ªç‰ˆæœ¬å†å®¢åˆ¶åŒ–å³å¯ã€‚



#### å¼€æºèŒƒä¾‹ä¸“æ¡ˆ



åœ¨ GAS ä¸Šç›´æ¥æ£€è§†ä¸“æ¡ˆï¼š



[**Google Drive: Sign-in**](https://script.google.com/d/1CBB39OMedqP9Ro1WSlvgDnMBin4-ksyhgly2h_KrbOuFiPHTalNgwHOp/edit?usp=sharing){:target="_blank"} 
[*Access Google Drive with a Google account (for personal use) or Google Workspace account (for business use) .* script.google.com](https://script.google.com/d/1CBB39OMedqP9Ro1WSlvgDnMBin4-ksyhgly2h_KrbOuFiPHTalNgwHOp/edit?usp=sharing){:target="_blank"}



![](/assets/4273e57e7148/1*Xzh2eBpVR92uZq-8POPegw.png)



GitHub Repo å¤‡ä»½ï¼š



[![](https://opengraph.githubassets.com/77054eda86ed3ccea772d92cd6ae33bcef8213c0a1f42ee5eca7e999c2607ee8/ZhgChgLi/google-apps-script-cd-web-app-demo)](https://github.com/ZhgChgLi/google-apps-script-cd-web-app-demo){:target="_blank"}



#### æ¡£æ¡ˆæ¶æ„



![](/assets/4273e57e7148/1*ohVakhlaflRXCI_3j2-cOA.png)



![](/assets/4273e57e7148/1*AyIEF0wqEFdMDBuRzQXDEQ.png)



å†™äº†ä¸€ä¸ªå¾ˆé˜³æ˜¥çš„ ç±»-MVC æ¶æ„ï¼Œå¦‚è¦è°ƒæ•´æˆ–ä¸çŸ¥é“åŠŸèƒ½é—® AI éƒ½èƒ½å¾—åˆ°å‡†ç¡®ç­”æ¡ˆã€‚



**ç³»ç»Ÿ**



- appsscript.json: GAS ç³»ç»Ÿçš„ Metadata è®¾å®šæ¡£æ¡ˆ
  **é‡ç‚¹æ˜¯ã€ŒoauthScopesã€å˜æ•°ï¼Œå®£å‘Šè¿™ä¸ª Script ä¼šç”¨åˆ°çš„å¤–éƒ¨æƒé™ã€‚**


- Entrypoint.gs: å®šä¹‰ doGet( ) è¿›å…¥ç‚¹



**Controller**



- Controller_iOS.gs: iOS æ‰“åŒ…å·¥å…·é¡µé¢ Controllerï¼Œè´Ÿè´£ææ•°æ®ç»™ View æ˜¾ç¤º



**View**



- View_index.html: æ•´ä¸ªæ‰“åŒ…å·¥å…·éª¨æ¶ã€é¦–é¡µ


- View_iOS.html: iOS æ‰“åŒ…å·¥å…·é¡µé¢éª¨æ¶


- View_iOS_Runs.html: iOS æ‰“åŒ…å·¥å…· â€” æ‰“åŒ…çºªå½•å†…å®¹é¡µé¢


- View_iOS_Form.html: iOS æ‰“åŒ…å·¥å…· â€”æ‰“åŒ…è¡¨å•é¡µé¢


- View_iOS_Runners.html: iOS æ‰“åŒ…å·¥å…· â€” Self-hosted Runner çŠ¶æ€é¡µé¢



**Model(Lib)**



- Credentials.gs: å®šä¹‰é‡‘é’¥å†…å®¹
  (âš ï¸ï¸ï¸è¯·æ³¨æ„ï¸ï¼ŒGAS å¦‚æœè¦èµ° GCP IAM ä¼šè›®å¤æ‚çš„å› æ­¤æˆ‘ä»¬ç›´æ¥å®šä¹‰é‡‘é’¥åœ¨æ­¤ï¼Œ **æ‰€ä»¥è¿™ä¸ª GAS ä¸“æ¡ˆä¼šåŒ…å«æœºå¯†èµ„è®¯ï¼Œè¯·ä¸è¦éšæ„å…±äº«ä¸“æ¡ˆæ£€è§†ç¼–è¾‘æƒé™** )


- StubData.gs: Online Demo ç”¨çš„ Stub æ–¹æ³•ã€èµ„æ–™ã€‚


- Settings.gs: ä¸€äº›å¸¸ç”¨è®¾å®šï¼Œè·Ÿ lib initã€‚


- GitHub.gs: GitHub API æ“ä½œå°è£…ã€‚


- Slack.gs: Slack API æ“ä½œå°è£…ã€‚


- Firebase.gs: Firebase â€” App Distribution API æ“ä½œå°è£…ã€‚



#### å»ºç«‹è‡ªå·±çš„æ‰“åŒ…å¹³å°



1.å»ºç«‹ä¸€ä¸ª [Google Apps Script ä¸“æ¡ˆ](https://script.google.com/home){:target="_blank"} ã€å‘½å



![](/assets/4273e57e7148/1*_uVqy6cDNvFSEL0feOS-pw.png)



åˆ°ä¸“æ¡ˆè®¾å®š â†’ å‹¾é€‰ã€Œåœ¨ç¼–è¾‘å™¨ä¸­æ˜¾ç¤ºã€Œappsscript.jsonã€èµ„è®¯æ¸…å•æ¡£æ¡ˆã€æ‰ä¼šå‡ºç°ã€Œappsscript.jsonã€Metadata æ¡£æ¡ˆã€‚



![](/assets/4273e57e7148/1*tvXsQufQs5-5UzV0bg5WLA.png)



2.å‚è€ƒæˆ‘çš„ [å¼€æºä¸“æ¡ˆæ¡£æ¡ˆ](https://script.google.com/home/projects/1CBB39OMedqP9Ro1WSlvgDnMBin4-ksyhgly2h_KrbOuFiPHTalNgwHOp/edit){:target="_blank"} ï¼ŒæŠŠæ‰€æœ‰æ¡£æ¡ˆæŒ‰ç…§èŒƒä¾‹å»ºç«‹å¥½è·ŸæŠŠå†…å®¹æ— è„‘å¤åˆ¶è¿‡æ¥



![](/assets/4273e57e7148/1*PxZvHNeW6PFaaqmZqifFfg.png)



> ***å¾ˆè ¢ï¼Œä½†æ²¡åŠæ³•ã€‚***



> *StubData.gs å…ˆä¸€èµ·å¤åˆ¶è¿‡æ¥ï¼Œç¬¬ä¸€æ¬¡éƒ¨ç½²æµ‹è¯•å¯ä»¥ä½¿ç”¨ã€‚*



> *å¦ä¸€ä¸ªæ–¹æ³•æ˜¯ç”¨ [clasp (Google Apps Script CLI)](https://developers.google.com/apps-script/guides/clasp?hl=zh-tw){:target="_blank"} git clone demo project åæŠŠ Code æ¨ä¸Šå»ã€‚*



![](/assets/4273e57e7148/1*FLM2SGIhAI7Z7OWIJpeT9A.png)



å¤åˆ¶å®Œé•¿å¾—ä¼šè·ŸèŒƒä¾‹ä¸“æ¡ˆä¸€æ¨¡ä¸€æ ·ã€‚



3. é¦–æ¬¡éƒ¨ç½²ã€Œç½‘é¡µåº”ç”¨ç¨‹å¼ã€æŸ¥çœ‹ç»“æœ



![](/assets/4273e57e7148/1*KbWpaEinVZh6M8o8bCCl6A.png)



![](/assets/4273e57e7148/1*2RrwNxZVidodX6Kq037Yvw.png)



![](/assets/4273e57e7148/1*CZSIfASW4hmQeXwTS3x7Fg.png)



ä¸“æ¡ˆå³ä¸Šè§’ã€Œéƒ¨ç½²ã€ â†’ ã€Œæ–°å¢éƒ¨ç½²ä½œä¸šã€ â†’ ç±»å‹ã€Œç½‘é¡µåº”ç”¨ç¨‹å¼ã€:



**æ‰§è¡Œèº«ä»½ï¼š**



- æˆ‘ `ç»Ÿä¸€éƒ½ç”¨ä½ çš„å¸å·èº«åˆ†æ‰§è¡Œè„šæœ¬ã€‚`


- å­˜å–ç½‘é¡µç¨‹å¼çš„ä½¿ç”¨è€… `ä¼šä»¥å½“å‰ç™»å…¥çš„ Google å¸å·ä½¿ç”¨è€…èº«ä»½æ‰§è¡Œè„šæœ¬ã€‚`



**è°å¯ä»¥å­˜å–ï¼š**



- åªæœ‰æˆ‘è‡ªå·±


- **XXX åŒä¸ªç»„ç»‡ä¸­çš„æ‰€æœ‰ä½¿ç”¨è€…** `åªæœ‰åŒç»„ç»‡ï¼‹å·²ç™»å…¥çš„ Google å¸å·ä½¿ç”¨è€…å¯ä»¥å­˜å–ã€‚`


- æ‰€æœ‰å·²ç™»å…¥ Google å¸å·çš„ä½¿ç”¨è€… `å·²ç™»å…¥çš„ Google å¸å·ä½¿ç”¨è€…éƒ½å¯ä»¥å­˜å–ã€‚`


- æ‰€æœ‰äºº `ä¸éœ€è¦ç™»å…¥ Google å¸å·ã€æ‰€æœ‰äººéƒ½å¯ä»¥å…¬å¼€å­˜å–ã€‚`



> *å¦‚æœæ˜¯å†…éƒ¨å·¥å…·ï¼šå¯ä»¥é€‰æ‹©ã€Œ **è°å¯ä»¥å­˜å–ï¼šXXX åŒä¸ªç»„ç»‡ä¸­çš„æ‰€æœ‰ä½¿ç”¨è€…ã€+ã€Œæ‰§è¡Œèº«ä»½ï¼šå­˜å–ç½‘é¡µç¨‹å¼çš„ä½¿ç”¨è€…ã€è¿›è¡Œå®‰å…¨æ§ç®¡ã€‚***



å®Œæˆéƒ¨ç½²åçš„ã€Œç½‘é¡µåº”ç”¨ç¨‹å¼ã€ç½‘å€ï¼Œå°±æ˜¯ä½ çš„ Web App æ‰“åŒ…å·¥å…·ç½‘å€ï¼Œå¯ä»¥åˆ†äº«ç»™å›¢é˜Ÿæˆå‘˜ä½¿ç”¨ã€‚(ç½‘å€å¾ˆä¸‘ï¼Œå¯ä»¥è‡ªå·±ç”¨çŸ­ç½‘å€æœåŠ¡åŒ…è£…ä¸€ä¸‹ã€ **æ›´æ–°éƒ¨ç½²å†…å®¹ä¸ä¼šå¼‚åŠ¨ç½‘å€** )



#### ä½¿ç”¨è€…é¦–æ¬¡ä½¿ç”¨éœ€è¦åŒæ„æˆæƒ



é¦–æ¬¡ç‚¹å‡» Web App ç½‘å€ï¼Œéœ€è¦å…ˆåŒæ„æˆæƒã€‚



![](/assets/4273e57e7148/1*lckRkGtc7EVqz9aTZaBIOw.png)



![](/assets/4273e57e7148/1*l1t290T_4xs1ly-RjjZXtg.png)



![](/assets/4273e57e7148/1*O9ItCSBNoBcuqepd-6ygCA.png)



- Review Permission â†’ é€‰æ‹©è¦ä½¿ç”¨æ­¤ Web App çš„å¸æˆ·èº«ä»½


- æœªéªŒè¯è­¦å‘Šè§†çª—ï¼Œç‚¹å‡»ã€Œè¿›é˜¶ã€å±•å¼€ â†’ ç‚¹å‡» å‰å¾€ã€ŒXXXã€(ä¸å®‰å…¨)



![](/assets/4273e57e7148/1*cYloLsBROLbZDPIciYUm5g.png)



- ç‚¹å‡»ã€Œå…è®¸ã€



> *å°”åå¦‚æœè„šæœ¬æƒé™æ²¡æ›´åŠ¨ä¸ç”¨é‡æ–°æˆæƒã€‚*



**å®ŒæˆæˆæƒåŒæ„åå°±ä¼šè¿›å…¥æ‰“åŒ…å·¥å…·é¦–é¡µï¼š**



![](/assets/4273e57e7148/1*vG5SsVFHPPDukc4ej0hqLA.png)



> Demo æ‰“åŒ…å·¥å…·éƒ¨ç½²æˆåŠŸ ğŸ‰ğŸ‰ğŸ‰



æ³¨:ã€Œè¿™ä¸ªåº”ç”¨ç¨‹å¼æ˜¯ç”± Google Apps Script çš„ä½¿ç”¨è€…å»ºç«‹ã€è¿™ä¸ªæç¤ºæ— æ³•è‡ªåŠ¨éšæ¬Œã€‚



#### æ›´æ–°éƒ¨ç½²



> âš ï¸æ‰€æœ‰ç¨‹å¼ç çš„å˜åŠ¨éƒ½éœ€è¦æ›´æ–°éƒ¨ç½²æ‰ä¼šç”Ÿæ•ˆã€‚



> ï¸ï¸âš ï¸æ‰€æœ‰ç¨‹å¼ç çš„å˜åŠ¨éƒ½éœ€è¦æ›´æ–°éƒ¨ç½²æ‰ä¼šç”Ÿæ•ˆã€‚



> âš ï¸æ‰€æœ‰ç¨‹å¼ç çš„å˜åŠ¨éƒ½éœ€è¦æ›´æ–°éƒ¨ç½²æ‰ä¼šç”Ÿæ•ˆã€‚



è¿™è¾¹è¦æ³¨æ„ç¨‹å¼ç å˜åŠ¨å‚¨å­˜å®Œä¸ä¼šç›´æ¥å˜åŠ¨åˆ° Web App ä¸Šï¼Œæ‰€ä»¥å‘ç°é‡æ•´æ²¡æ•ˆæœå°±æ˜¯è¿™ä¸ªåŸå› ï¼› **éœ€è¦åˆ°ã€Œéƒ¨ç½²ã€ â†’ ã€Œç®¡ç†éƒ¨ç½²ä½œä¸šã€â†’ã€Œç¼–è¾‘ã€â†’ ç‰ˆæœ¬ã€Œå»ºç«‹æ–°ç‰ˆæœ¬ã€ â†’ ç‚¹å‡»ã€Œéƒ¨ç½²ã€ â†’ ã€Œå®Œæˆã€** ã€‚



![](/assets/4273e57e7148/1*VsfCEfwnPlx9RbQ8DtXpnA.png)



![](/assets/4273e57e7148/1*n62MVd6o8W3hUtQpfn9Q0w.png)



> *æ›´æ–°éƒ¨ç½²å®Œå†é‡æ•´ç½‘é¡µå°±èƒ½çœ‹åˆ°æ”¹åŠ¨ç”Ÿæ•ˆã€‚*



#### æ–°å¢æµ‹è¯•éƒ¨ç½²æ–¹ä¾¿å¼€å‘



![](/assets/4273e57e7148/1*4fLoW6jf8z1AIXvULW-AOA.png)



![](/assets/4273e57e7148/1*yvTxeaImQ4Mr7FwESsuf5A.png)



å¦‚åŒå‰è¿°ï¼Œæ‰€æœ‰æ”¹åŠ¨è¦ç”Ÿæ•ˆéƒ½è¦æ›´æ–°éƒ¨ç½²ï¼›è¿™åœ¨å¼€å‘é˜¶æ®µéå¸¸éº»çƒ¦ï¼Œå› æ­¤åœ¨å¼€å‘é˜¶æ®µæˆ‘ä»¬å¯ä»¥ç”¨ã€Œæµ‹è¯•éƒ¨ç½²ã€æ¥å¿«é€ŸéªŒè¯æ”¹åŠ¨æ˜¯å¦æ­£ç¡®ã€‚



**åˆ°ã€Œéƒ¨ç½²ã€ â†’ ã€Œæµ‹è¯•éƒ¨ç½²ä½œä¸šã€ â†’ å–å¾—æµ‹è¯•ç”¨ã€Œç½‘é¡µåº”ç”¨ç¨‹å¼ã€ç½‘å€ã€‚**



![](/assets/4273e57e7148/1*Rt0XEw9uAev58isLEnsoPA.png)



åœ¨å¼€å‘é˜¶æ®µæˆ‘ä»¬ç›´æ¥ä½¿ç”¨æ­¤ç½‘å€å°±èƒ½å‚¨å­˜ï¼Œæ¡£æ¡ˆæ›´æ”¹å‚¨å­˜å®Œï¼Œå›åˆ°è¿™ä¸ªå¼€å‘ç”¨ç½‘å€é‡æ•´ç½‘é¡µå°±èƒ½çœ‹åˆ°æˆæœï¼



> ***éƒ½å¼€å‘å¥½ä¹‹åå†ç…§å‰æ–‡è¯´çš„æ›´æ–°éƒ¨ç½²ï¼Œé‡Šå‡ºç»™ä½¿ç”¨è€…ä½¿ç”¨ã€‚***



### ä¿®æ”¹ Demo èŒƒä¾‹ä¸“æ¡ˆä¸²æ¥çœŸå®èµ„æ–™



å†æ¥æ‰æ˜¯é‡ç‚¹ï¼Œä¸²æ¥çœŸå®èµ„æ–™ï¼ŒGitHub Actions Workflow å‚è€ƒçš„æ˜¯ [**ä¸Šä¸€ç¯‡æ–‡ç« ä¸­å»ºç«‹å¥½çš„ CI/CD æµç¨‹**](../4b001d2e8440/) ï¼Œä½ ä¹Ÿå¯ä¾ç…§å®é™…çš„ Actions Workflow è°ƒæ•´å‚æ•°ã€‚



#### âš ï¸ä¿®æ”¹å‰è¯·æ³¨æ„



Google Apps Script å¹³å°å¹¶ä¸èƒ½å¾ˆå¥½çš„æ”¯æ´å¤šäººæˆ–ç”šè‡³å¤šå¼€è§†çª—å¼€å‘ï¼Œæˆ‘è‡ªå·±è¸©è¿‡çš„é›·æ˜¯ä¸å°å¿ƒå¼€äº†ä¸¤ä¸ªç¼–è¾‘è§†çª—ï¼Œåœ¨ A ç¼–è¾‘å®Œï¼Œåæ¥åœ¨ B ç¼–è¾‘ï¼Œæ‰€ä»¥ä¿®æ”¹éƒ½è¢« B çš„æ—§ç‰ˆè¦†ç›–æ‰äº†ï¼›å› æ­¤ **å»ºè®®åŒæ—¶é—´åªæœ‰ä¸€ä¸ªäººä¸€ä¸ªè§†çª—åœ¨ç¼–è¾‘ Script** ã€‚



#### GitHub ä¸²æ¥



**å¸¦å…¥ GitHub API Token:**



GitHub -&gt; å¸å· -&gt; Settings -&gt; Developer Settings -&gt; Fine-grained personal access tokens or Personal access tokens (classic)ã€‚



å»ºè®®ä½¿ç”¨ Fine-grained personal access tokens æ¯”è¾ƒå®‰å…¨(ä½†æœ‰æœŸé™)ã€‚



**Fine-grained personal access tokens éœ€è¦çš„æƒé™å¦‚ä¸‹ï¼š**



![](/assets/4273e57e7148/1*lCNQHwC4EMU4gNXYC-zs2A.png)



- Repo: è®°å¾—é€‰è¦æ“ä½œçš„ Repo


- Permissions: `Actions (read/write)` ã€ `Administration (read only)`



> *å¦‚æœä¸æƒ³ä¾èµ–åœ¨æŸäººçš„å¸å·ä¸Šå»ºè®®å»ºç«‹ä¸€æ”¯å¹²å‡€çš„å›¢é˜Ÿ GitHub å¸å·ï¼Œä½¿ç”¨å®ƒçš„ Tokenã€‚*



åˆ° GAS ä¸“æ¡ˆ â†’ `Credentials.gs` â†’ å°† Token å¸¦å…¥åˆ° `githubToken` å˜æ•°ä¸­ã€‚



**æ›¿æ¢ GithubStub æˆ GitHub:**



åˆ° GAS ä¸“æ¡ˆ â†’ `Settings.gs` â†’ å°†ï¼š



```javascript
const iOSGitHub = new GitHubStub(githubToken, iOSRepoPath);
```



**æ”¹æˆ**



```javascript
const iOSGitHub = new GitHub(githubToken, iOSRepoPath);
```



å‚¨å­˜æ¡£æ¡ˆã€‚



**é‡æ–°æ•´ç†æµ‹è¯•ç”¨ã€Œç½‘é¡µåº”ç”¨ç¨‹å¼ã€ç½‘å€æŸ¥çœ‹æ”¹åŠ¨æ˜¯å¦æ­£ç¡®:**



![](/assets/4273e57e7148/1*30k1iDALT9WdupmuBiG2uQ.png)



> *èƒ½æ­£ç¡®æ˜¾ç¤ºèµ„æ–™ä»£è¡¨ï¼š **GitHub æ”¹ä¸²çœŸå®èµ„æ–™æˆåŠŸ** ğŸ‰ğŸ‰ğŸ‰*



ä¹Ÿèƒ½é¡ºæ‰‹åˆ‡åˆ°ã€ŒRunner çŠ¶æ€ã€æŸ¥çœ‹ Self-hosted Runner çŠ¶æ€æå–æ­£ä¸æ­£å¸¸ï¼š



![](/assets/4273e57e7148/1*K3yzISn5J7o1e1F5zhIQpg.png)



æ³¨ï¼šæˆ‘ Runner æ²¡å¼€â€¦æ‰€ä»¥æ˜¯ç¦»çº¿ä¸­ã€‚



#### Slack ä¸²æ¥



ä¸ºäº†ä¸²æ¥ Slack é€šçŸ¥ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å›åˆ° Repo â†’ GitHub Actions æ–°å¢ä¸€ä¸ªåŒ…è£¹æ‰“åŒ… Action Workflow çš„é€šçŸ¥å®¹å™¨ Actionã€‚



**CD-Deploy-Form.yml:**



```yaml
# Workflow(Action) åç§°
name: CD-Deploy-Form

# Actions Log çš„æ ‡é¢˜åç§°
run-name: "[CD-Deploy-Form] ${{ github.ref }}"

# åŒä¸ª Concurrency Group å¦‚æœæœ‰æ–°çš„ Job ä¼šå–æ¶ˆæ­£åœ¨è·‘çš„
# ä¾‹å¦‚ é‡å¤è§¦å‘ç›¸åŒåˆ†æ”¯çš„æ‰“åŒ…ä»»åŠ¡ï¼Œä¼šå–æ¶ˆå‰ä¸€ä¸ªä»»åŠ¡
concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

# è§¦å‘äº‹ä»¶
on:
  # æ‰‹åŠ¨è¡¨å•è§¦å‘
  workflow_dispatch:
    # è¡¨å• Inputs æ ä½
    inputs:
      # App ç‰ˆæœ¬å·
      VERSION_NUMBER:
        description: 'Version Number of the app (e.g., 1.0.0). Auto-detect from the Xcode project if left blank.'
        required: false
        type: string
      # App Build Number
      BUILD_NUMBER:
        description: 'Build number of the app (e.g., 1). Will use a timestamp if left blank.'
        required: false
        type: string
      # App Release Note
      RELEASE_NOTE:
        description: 'Release notes of the deployment.'
        required: false
        type: string
      # è§¦å‘è€…çš„ Slack User ID
      SLACK_USER_ID:
        description: 'Slack user id.'
        required: true
        type: string
      # è§¦å‘è€…çš„ Email
      AUTHOR:
        description: 'Trigger author email.'
        required: true
        type: string
        
# Job å·¥ä½œé¡¹ç›®
jobs:
  # å¼€å§‹æ‰“åŒ…æ—¶ä¼ é€ Slack è®¯æ¯
  # Job ID
  start-message:
    # å°å·¥ä½œç›´æ¥ç”¨ GitHub Hosted Runner è·‘ï¼Œç”¨é‡ä¸å¤§
    runs-on: ubuntu-latest
    
    # è®¾å®šæœ€é•¿ Timeout æ—¶é—´ï¼Œé˜²æ­¢å¼‚å¸¸æƒ…å†µå‘ç”Ÿæ—¶æ— æ­¢å°½çš„ç­‰å¾…
    # æ­£å¸¸æƒ…å†µä¸å¯èƒ½è·‘è¶…è¿‡ 5 åˆ†é’Ÿ
    timeout-minutes: 5

    # å·¥ä½œæ­¥éª¤
    steps:
      - name: Post a Start Slack Message
        id: slack
        uses: slackapi/slack-github-action@v2.0.0
        with:
          method: chat.postMessage
          token: ${{ secrets.SLACK_BOT_TOKEN }}
          payload: \\|
            channel: ${{ inputs.SLACK_USER_ID }}
            text: "å·²æ”¶åˆ°æ‰“åŒ…è¯·æ±‚ã€‚\nID: <${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\\|${{ github.run_id }}>\nBranch: ${{ github.ref_name }}\ncc'ed <@${{ inputs.SLACK_USER_ID }}>"
    # Job Output ç»™åç»­ Job ä½¿ç”¨
    # ts = Slack è®¯æ¯ IDï¼Œåç»­é€šçŸ¥æ‰å¯ä»¥ Reply åœ¨åŒä¸ª Threads
    outputs:
      ts: ${{ steps.slack.outputs.ts }}

  deploy:
    # Job é¢„è®¾æ˜¯å¹¶å‘æ‰§è¡Œï¼Œç”¨ needs é™åˆ¶éœ€ç­‰å¾… start-message å®Œæˆæ‰æ‰§è¡Œ
    # æ‰§è¡Œæ‰“åŒ…éƒ¨ç½²ä»»åŠ¡
    needs: start-message
    uses: ./.github/workflows/CD-Deploy.yml
    secrets: inherit
    with:
      VERSION_NUMBER: ${{ inputs.VERSION_NUMBER }}
      BUILD_NUMBER: ${{ inputs.BUILD_NUMBER }}
      RELEASE_NOTE: ${{ inputs.RELEASE_NOTE }}
      AUTHOR: ${{ inputs.AUTHOR }}

  # æ‰“åŒ…éƒ¨ç½²ä»»åŠ¡æˆåŠŸè®¯æ¯
  end-message-success:
    needs: [start-message, deploy]
    if: ${{ needs.deploy.result == 'success' }}
    runs-on: ubuntu-latest
    timeout-minutes: 5
    steps:
      - name: Post a Success Slack Message
        uses: slackapi/slack-github-action@v2.0.0
        with:
          method: chat.postMessage
          token: ${{ secrets.SLACK_BOT_TOKEN }}
          payload: \\|
            channel: ${{ inputs.SLACK_USER_ID }}
            thread_ts: "${{ needs.start-message.outputs.ts }}"
            text: "âœ… æ‰“åŒ…éƒ¨ç½²æˆåŠŸã€‚\n\ncc'ed <@${{ inputs.SLACK_USER_ID }}>"
  
  # æ‰“åŒ…éƒ¨ç½²ä»»åŠ¡å¤±è´¥è®¯æ¯
  end-message-failure:
    needs: [deploy, start-message]
    if: ${{ needs.deploy.result == 'failure' }}
    runs-on: ubuntu-latest
    timeout-minutes: 5
    steps:
      - name: Post a Failure Slack Message
        uses: slackapi/slack-github-action@v2.0.0
        with:
          method: chat.postMessage
          token: ${{ secrets.SLACK_BOT_TOKEN }}
          payload: \\|
            channel: ${{ inputs.SLACK_USER_ID }}
            thread_ts: "${{ needs.start-message.outputs.ts }}"
            text: "âŒ æ‰“åŒ…éƒ¨ç½²å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ‰§è¡ŒçŠ¶å†µç»“æœæˆ–ç¨åå†è¯•ã€‚\n\ncc'ed <@${{ inputs.SLACK_USER_ID }}>"

  # æ‰“åŒ…éƒ¨ç½²ä»»åŠ¡å–æ¶ˆè®¯æ¯
  end-message-cancelled:
    needs: [deploy, start-message]
    if: ${{ needs.deploy.result == 'cancelled' }}
    runs-on: ubuntu-latest
    timeout-minutes: 5
    steps:
      - name: Post a Cancelled Slack Message
        uses: slackapi/slack-github-action@v2.0.0
        with:
          method: chat.postMessage
          token: ${{ secrets.SLACK_BOT_TOKEN }}
          payload: \\|
            channel: ${{ inputs.SLACK_USER_ID }}
            thread_ts: "${{ needs.start-message.outputs.ts }}"
            text: ":black_square_for_stop: æ‰“åŒ…éƒ¨ç½²å·²å–æ¶ˆã€‚\n\ncc'ed <@${{ inputs.SLACK_USER_ID }}>"
```



**å®Œæ•´ç¨‹å¼ç ï¼š** [CD-Deploy-Form.yml](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/blob/main/.github/workflows/CD-Deploy-Form.yml){:target="_blank"}



![](/assets/4273e57e7148/1*NatyC_Oid4BrKYk4nehuKA.png)



è¿™ä¸ª Action åªæ˜¯ä¸ªå®¹å™¨ï¼Œä¸²æ¥ Slack é€šçŸ¥ï¼Œå®é™…æ˜¯å¤ç”¨ [ä¸Šä¸€ç¯‡æ–‡ç« ](../4b001d2e8440/) ä¸­å†™å¥½çš„ [CD-Deploy.yml](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/blob/main/.github/workflows/CD-Deploy.yml){:target="_blank"} Actionã€‚



- Slack Bot App å»ºç«‹ã€å‘è®¯æ¯æƒé™è®¾å®šå¯å‚è€ƒæˆ‘ [ä¹‹å‰çš„æ–‡ç« ](../bd94cc88f9c9/)


- è®°å¾—åˆ° Repo â†’ Secrets æ–°å¢å¯¹åº”çš„ `SLACK_BOT_TOKEN` è·Ÿå¸¦å…¥ Slack Bot App Token å€¼



å›åˆ° GAS ä¸“æ¡ˆ â†’ `Credentials.gs` â†’ å°† Token å¸¦å…¥åˆ° `slackBotToken` å˜æ•°ä¸­ã€‚



å†åˆ° GAS ä¸“æ¡ˆ â†’ `Settings.gs` â†’ å°†ï¼š



```javascript
const slack = new SlackStub(slackBotToken);
```



**æ”¹æˆ**



```javascript
const slack = new Slack(slackBotToken);
```



å‚¨å­˜æ¡£æ¡ˆã€‚



> *å¦‚æœä½ æ²¡æœ‰ç°æˆçš„ Slack Bot App å¯å‘é€šçŸ¥ä¹Ÿæ‡’å¾—å»ºç«‹ï¼Œå¯ä»¥å¿½ç•¥è¿™é‡Œçš„æ‰€æœ‰æ­¥éª¤ï¼Œå¹¶åˆ é™¤ GAS ä¸“æ¡ˆä¸­æœ‰å…³ slack çš„ä½¿ç”¨ã€‚*



#### GitHub ä¸²æ¥ â€” æ‰“åŒ…è¡¨å•



åˆ° GAS ä¸“æ¡ˆ â†’ `Controller_iOS.gs` â†’ è°ƒæ•´ `View_iOS_Form.html` å†…å®¹:
ç§»é™¤å‡ Asana Tasks ä¸²æ¥æ–¹æ³•ï¼š



```php-template
      <? tasks.forEach(function(task) { ?>
      <option value="<?=task.githubBranch?>">[<?=task.id?>] <?=task.title?></option>
      <? }) ?>
```



ä¹Ÿå¯ä»¥åœ¨è¿™è¾¹è‡ªå·±è°ƒæ•´é¢„è®¾åˆ†æ”¯(è¿™è¾¹æ˜¯ `main` )ã€‚



â€”



åˆ° GAS ä¸“æ¡ˆ â†’ `Controller_iOS.gs` â†’ è°ƒæ•´ `iOSLoadForm()` å†…å®¹:



- ç§»é™¤ `template.tasks = Stubable.fetchStubAsanaTasks();` è¿™è¡Œå‡ä¸²æ¥ Asana çš„æ–¹æ³•ã€‚
  å¦‚æœè¦ä¸² Asana/Jira å¯ä»¥ç›´æ¥é—® ChatGPT è¯·ä»–å¸®å¿™äº§ä¸²æ¥æ–¹æ³•ã€‚


- `template.prs = iOSGitHub.fetchOpenPRs();` æ˜¯çœŸçš„ä¸² GitHub API æ‹¿ Opened PR Listï¼Œå¯ä¾éœ€æ±‚ä¿ç•™ã€‚



**é€å‡ºåçš„å¤„ç†** åœ¨ `iOSSubmitForm()` å†…å®¹:



å¯ä¾ç…§å®é™… GitHub Actions Workflow æ¡£æ¡ˆåç§°ã€ `workflow_dispatch` inputs æ ä½å‚æ•°è¿›è¡Œè°ƒæ•´ï¼š



```javascript
  iOSGitHub.dispatchWorkflow("CD-Deploy-Form.yml", branch, {
    "BUILD_NUMBER": buildNumber,
    "VERSION_NUMBER": versionNumber,
    "VERSION_NUMBER": versionNumber,
    "RELEASE_NOTE": releaseNote,
    "AUTHOR": email,
    "SLACK_USER_ID": slack.fetchUserID(email)
  });
```



ä¹Ÿå¯ä»¥åŠ å…¥è‡ªå·±çš„å¿…å¡«æ¡ä»¶éªŒè¯ï¼Œè¿™è¾¹åªéªŒè¯ä¸€å®šè¦å¡«åˆ†æ”¯ï¼Œä¸ç„¶ä¼šè·³é”™è¯¯è®¯æ¯ã€‚



å¦‚æœè®¤ä¸ºè¿™æ ·ä¸å¤Ÿå®‰å…¨å¯ä»¥è‡ªå·±å†åŠ å…¥å¯†ç éªŒè¯æˆ–åªæœ‰ç‰¹æ®Šå¸å·å¯ä»¥ä½¿ç”¨ã€‚



> *æœ€åä¸€è¡Œ **Slack é€šçŸ¥åŠŸèƒ½éœ€è¦è®¾å®šå¥½ Slack** ï¼Œå¦‚æœæ²¡æœ‰ Slack Bot App æˆ–æ‡’å¾—ä¸²æ¥ Slackï¼Œåœ¨ [Demo Actions Repo](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/actions){:target="_blank"} ä¸­å¯ä»¥ç›´æ¥æ”¹ç”¨ `iOSGitHub.dispatchWorkflow("CD-Deploy.yml")` ç„¶åç§»é™¤æ‰ `SLACK_USER_ID` å‚æ•°å³å¯ã€‚*



**é‡æ–°æ•´ç†æµ‹è¯•ç”¨ã€Œç½‘é¡µåº”ç”¨ç¨‹å¼ã€ç½‘å€æŸ¥çœ‹æ”¹åŠ¨æ˜¯å¦æ­£ç¡®ï¼š**



![](/assets/4273e57e7148/1*OkJJrssZBcJPss_cMW-Qew.png)



å¯ä»¥çœ‹åˆ°æ‰“åŒ…è¡¨å•å°±åªå‰© Opened PR List äº†ã€‚



**å¡«å¥½èµ„æ–™æŒ‰ã€Œé€å‡ºè¯·æ±‚ã€æµ‹è¯•çœ‹çœ‹æ‰“åŒ…è¡¨å•ï¼š**



![](/assets/4273e57e7148/1*dl-g3j6GH0AnYL8dqvSyYA.png)



**æç¤ºé€å‡ºæˆåŠŸä»£è¡¨æ²¡é—®é¢˜ï¼Œå›åˆ°æ‰“åŒ…çºªå½•ä¹Ÿèƒ½çœ‹åˆ°ä»»åŠ¡å¼€å§‹æ‰§è¡Œäº† *ğŸ‰*** ï¼š



![](/assets/4273e57e7148/1*cByPF6T8WdXKionifRj1Ew.png)



> *é‡å¤ç‚¹æ‰“åŒ…çºªå½•èƒ½æ›´æ–°è¿›åº¦ã€‚*



**å¸¸è§é€å‡ºé”™è¯¯ï¼š**



> `Required input â€˜SLACK_USER_IDâ€™ not provided` *: GitHub Actions è¿™ä¸ªSLACK_USER_ID æ ä½ä¸ºå¿…å¡«ï¼Œä½†æ²¡æœ‰å¸¦ï¼Œå¯èƒ½æ˜¯ Slack è®¾å®šå¤±è´¥ã€å½“å‰ User Email æ‰¾ä¸åˆ°å¯¹åº”çš„ Slack UIDã€‚*



> *`Workflow does not have â€˜workflow_dispatchâ€™ trigger` ã€ `åˆ†æ”¯è¿‡æ—§ï¼Œè¯·æ›´æ–° xxx åˆ†æ”¯` : é€‰æ‹©çš„åˆ†æ”¯æ‰¾ä¸åˆ°å¯¹åº”çš„ Action Workflow æ¡£æ¡ˆ(iOSGitHub.dispatchWorkflow æŒ‡å®šçš„æ¡£æ¡ˆ)ã€‚*



> *`No ref found for` ã€ `æ‰¾ä¸åˆ°åˆ†æ”¯` : æ‰¾ä¸åˆ°æ­¤åˆ†æ”¯ã€‚*



### Firebase App Distribution â€” å–å¾—ä¸‹è½½è¿ç»“ä¸²æ¥



æœ€åä¸€ä¸ªå°åŠŸèƒ½æ˜¯ä¸²æ¥ Firebase App Distribution ç›´æ¥å–å¾—ä¸‹è½½èµ„è®¯è·Ÿè¿ç»“ï¼Œæ–¹ä¾¿åœ¨æ‰‹æœºä¸Šå¼€å¯æ‰“åŒ…å¹³å°å·¥å…·ç‚¹å‡»ç›´æ¥ä¸‹è½½å®‰è£…ã€‚



> *ä¹‹å‰ä»‹ç»è¿‡ã€Œ [Google Apps Script x Google APIs å¿«é€Ÿä¸²æ¥æ•´åˆæ–¹å¼](../71400d408dc8/) ã€GAS èƒ½å¿«é€Ÿæ— ç—›æ•´åˆ Firebaseã€‚*



#### **ä¸²æ¥åŸç†**



> ***åœ¨ä¸²æ¥ä¹‹å‰å…ˆè®²ä¸€ä¸‹è¿™ä¸ªã€ŒTrickyã€çš„ä¸²æ¥åŸç†ã€‚***



æˆ‘ä»¬çš„æ‰“åŒ…å¹³å°æ˜¯æ²¡æœ‰èµ„æ–™åº“çš„ï¼Œçº¯åš API ä¸­ç»§ç«™ï¼›æ‰€ä»¥å®é™…ä¸Šæ˜¯æˆ‘ä»¬åœ¨ [**GitHub Acitons CD-Deploy.yml**](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/actions/workflows/CD-Deploy.yml){:target="_blank"} æ‰“åŒ…ä½œä¸šæ—¶ï¼ŒæŠŠ Job Run ID å¸¦å…¥åˆ° Release Note (å½“ç„¶ä¹Ÿå¯ä»¥å¸¦åˆ° Build Number)ï¼š



```bash
ID="${{ github.run_id }}" // Job Run ID
COMMIT_SHA="${{ github.sha }}"
BRANCH_NAME="${{ github.ref_name }}"
AUTHOR="${{ env.AUTHOR }}"

# ç»„åˆ Release Note
RELEASE_NOTE="${{ env.RELEASE_NOTE }}
ID: ${ID}
Commit SHA: ${COMMIT_SHA}
Branch: ${BRANCH_NAME}
Author: ${AUTHOR}
"

# æ‰§è¡Œ Fastlane æ‰“åŒ…ï¼†éƒ¨ç½² Lane
bundle exec fastlane beta release_notes:"${RELEASE_NOTE}" version_number:"${VERSION_NUMBER}" build_number:"${BUILD_NUMBER}"
```



è¿™æ · Firebase App Distribution Release Notes å°±ä¼šæœ‰ Job Run IDã€‚



GAS Web App æ‰“åŒ…å·¥å…·å¹³å°ä¼šä¸² GitHub API å–å¾— GitHub Actions æ‰§è¡Œçºªå½•æˆ‘ä»¬ç›´æ¥ç”¨ API ç»™çš„ Job Run ID å¸¦åˆ° Firebase App Distribution API æŸ¥è¯¢ Release Notes ä¸­æœ‰åŒ…å« `*ID: XXX*` çš„ç‰ˆæœ¬ï¼Œå°±èƒ½æ‰¾åˆ°å¯¹åº”çš„æ‰“åŒ…çºªå½•äº†ã€‚



**ä¸ç”¨ä»»ä½•èµ„æ–™åº“ä¹Ÿèƒ½åšåˆ°ä¸¤ä¸ªå·¥å…·å¹³å°çš„å¯¹åº”ã€‚**



![](/assets/4273e57e7148/1*AJRMWv_rqu64H0ZrY4q6QA.png)



![](/assets/4273e57e7148/1*Sdzt1MDXh7TNnMDkpc5uJg.png)



#### ä¸²æ¥ä¸“æ¡ˆè®¾å®š



åˆ° GAS â†’ ä¸“æ¡ˆè®¾å®š â†’ Google Cloud Platform (GCP) ä¸“æ¡ˆ â†’ å˜æ›´ä¸“æ¡ˆï¼š



![](/assets/4273e57e7148/1*klclBbiBQXNBzbzzj1jH0Q.png)



![](/assets/4273e57e7148/1*gv8m_v5O_yyUrq8uQoverQ.png)



è¾“å…¥æƒ³ä¸²æ¥çš„ Firebase ä¸“æ¡ˆç¼–å·ã€‚



![](/assets/4273e57e7148/1*OEaxA6SZWYbiVstOK60hQg.png)



> ***åˆæ¬¡è®¾å®šå¯èƒ½ä¼šè·³é”™è¯¯*** *ã€Œå¦‚è¦å˜æ›´ä¸“æ¡ˆï¼Œè¯·è®¾å®š OAuth åŒæ„ç”»é¢ã€‚è®¾å®š OAuth åŒæ„ç”»é¢è¯¦ç»†èµ„æ–™ã€‚ã€æ²¡æœ‰çš„è¯å¯è·³è¿‡ä»¥ä¸‹æ­¥éª¤ã€‚*



**ç‚¹å‡»ã€ŒOAuth åŒæ„ç”»é¢è¯¦ç»†èµ„æ–™ã€è¿ç»“ â†’ ç‚¹å‡»ã€Œè®¾å®šåŒæ„ç”»é¢ã€ï¼š**



![](/assets/4273e57e7148/1*oiZeO5mEqH-D3tHrJsnE1A.png)



**ç‚¹å‡»ã€Œå¼€å§‹ã€:**



![](/assets/4273e57e7148/1*NK9RG0kaXoxJB5X-B8vhww.png)



**åº”ç”¨ç¨‹å¼èµ„è®¯:**



- åº”ç”¨ç¨‹å¼åç§°: `è¾“å…¥ä½ çš„å·¥å…·åç§°`


- ä½¿ç”¨è€…æ”¯æ´ç”µå­é‚®ä»¶: `é€‰æ‹©ç”µå­é‚®ä»¶`



**ç›®æ ‡å¯¹è±¡:**



- å†…éƒ¨ï¼šä»…é™ç»„ç»‡å†…éƒ¨ä¼™ä¼´ä½¿ç”¨


- å¤–éƒ¨ï¼šæ‰€æœ‰ Google å¸æˆ·ä½¿ç”¨è€…éƒ½èƒ½åŒæ„æˆæƒåä½¿ç”¨



**è”ç»œèµ„è®¯:**



- è¾“å…¥æ¥æ”¶é€šçŸ¥ç”¨ç”µå­é‚®ä»¶



**å‹¾é€‰åŒæ„ã€Š [Google API æœåŠ¡ï¼šä½¿ç”¨è€…èµ„æ–™æ”¿ç­–](https://developers.google.com/terms/api-services-user-data-policy?hl=zh_TW){:target="_blank"} ã€‹ã€‚**



æœ€åç‚¹å‡»ã€Œ **å»ºç«‹** ã€ã€‚



â€”



å›åˆ° GAS â†’ ä¸“æ¡ˆè®¾å®š â†’ Google Cloud Platform (GCP) ä¸“æ¡ˆ â†’ å˜æ›´ä¸“æ¡ˆï¼š



å†æ¬¡è¾“å…¥ Firebase ä¸“æ¡ˆç¼–å·ç‚¹å‡»ã€Œå˜æ›´ä¸“æ¡ˆã€ã€‚



![](/assets/4273e57e7148/1*g-Lo04WjhaDjtXeXthNtDg.png)



**æ²¡å‡ºç°é”™è¯¯å°±æ˜¯å®Œæˆç»‘å®šäº†ã€‚**



â€”



**å¦‚æœé€‰æ‹©çš„æ˜¯ã€Œå¤–éƒ¨ã€å¯èƒ½è¿˜éœ€è¦å®Œæˆä»¥ä¸‹è®¾å®šï¼š**



ç‚¹å‡»ã€Œä¸“æ¡ˆç¼–å·ã€ â†’ å±•å¼€å·¦ä¾§æ  â†’ ã€ŒAPI å’ŒæœåŠ¡ã€â†’ ã€ŒOAuth åŒæ„ç”»é¢ã€



![](/assets/4273e57e7148/1*RJNQv8v3KZoTcVwUbsXSHQ.png)



é€‰æ‹©ã€Œç›®æ ‡å¯¹è±¡ã€ â†’ æµ‹è¯• ç‚¹å‡»ã€Œå‘å¸ƒåº”ç”¨ç¨‹å¼ã€â†’ å®Œæˆã€‚



![](/assets/4273e57e7148/1*8vqrxhchsILPy4eSdvXfNg.png)



> *ä½¿ç”¨è€…å°±èƒ½ç…§å‰æ–‡çš„ã€Œ **ä½¿ç”¨è€…é¦–æ¬¡ä½¿ç”¨éœ€è¦åŒæ„æˆæƒ** ã€æ­¥éª¤å®Œæˆæˆæƒå°±èƒ½ä½¿ç”¨äº†ï¼*



**å¦‚æœä¸Šè¿°æ­¥éª¤æ²¡è®¾å®šï¼Œä½¿ç”¨è€…ä¼šé‡åˆ°ä»¥ä¸‹é”™è¯¯ï¼š**



![å·²å°é”å­˜å–æƒã€ŒXXXã€æœªå®Œæˆ Google éªŒè¯ç¨‹åº](/assets/4273e57e7148/1*2omUPFoubsrXVLHBPFkPbg.png)



å·²å°é”å­˜å–æƒã€ŒXXXã€æœªå®Œæˆ Google éªŒè¯ç¨‹åº



â€” â€” â€”



#### ä¸²æ¥ä¸“æ¡ˆ



å›åˆ°ä¸²æ¥ä¸Šï¼ŒFirebase æ˜¯ç›´æ¥ç”¨ `ScriptApp.getOAuthToken()` ä¾ç…§æ‰§è¡Œèº«ä»½åŠ¨æ€å–å¾— Token ä½¿ç”¨ï¼Œå› æ­¤ä¸éœ€è¦è®¾å®š Tokenã€‚



åªéœ€è¦åˆ° GAS ä¸“æ¡ˆ â†’ `Settings.gs` â†’ å°†ï¼š



```javascript
const iOSFirebase = new FirebaseStub(iOSFirebaseProject);
```



**æ”¹æˆ**



```javascript
const iOSFirebase = new Firebase(iOSFirebaseProject);
```



å³å¯ã€‚



**é‡æ–°æ•´ç†æµ‹è¯•ç”¨ã€Œç½‘é¡µåº”ç”¨ç¨‹å¼ã€ç½‘å€åˆ°æ‰“åŒ…çºªå½• â†’ æ‰¾ä¸€ç¬”çºªå½•ç‚¹å‡»ã€Œå–å¾—ä¸‹è½½è¿ç»“ã€ï¼š**



![](/assets/4273e57e7148/1*9z-KsIAL5jyEzQvJv3YLgg.png)



![](/assets/4273e57e7148/1*q0HUYN2W3UonQLzwxZKXdQ.png)



å¦‚æœæœ‰åœ¨ Firebase App Distribution Release Notes æ‰¾åˆ°å¯¹åº”çš„ Job Run Id æ‰“åŒ…ï¼Œå°±ä¼šç›´æ¥æ˜¾ç¤ºä¸‹è½½èµ„è®¯è·Ÿç‚¹ä¸‹è½½èƒ½ç›´æ¥å¯¼åˆ°ä¸‹è½½é¡µã€‚



> å®Œæˆï¼ğŸ‰ğŸ‰ğŸ‰



### æˆæœ



![](/assets/4273e57e7148/1*znvPmqsaivk3KhsE26sFwA.png)



è‡³æ­¤ä½ å·²ç»æŠŠèŒƒä¾‹éƒ½æ”¹æˆæ‚¨çš„å®é™…å¯ç”¨çš„æ‰“åŒ…å·¥å…·ï¼Œå‰©ä¸‹çš„å®¢åˆ¶åŒ–åŠŸèƒ½ã€æ›´å¤šç¬¬ä¸‰æ–¹ API ä¸²æ¥ã€æ›´å¤šè¡¨å•å¯ä»¥è‡ªè¡Œå»¶ä¼¸ (è·Ÿ ChatGPT è®¨è®º)ã€‚



> *æœ€åä¸è¦å¿˜è®°éƒ½å¼€å‘å¥½æµ‹è¯•å®Œæ¯•è¦ä¸Šçº¿ï¼Œéœ€è¦ç…§å‰æ–‡æ­¥éª¤ â€” **æ›´æ–°éƒ¨ç½²ä½œä¸šæ‰ä¼šç”Ÿæ•ˆå–”ï¼***



### ä¸²æ¥å»¶ä¼¸



å»¶ç»­æˆ‘ä»¬ã€Œä¸­ç»§ç«™ã€è§’è‰²çš„ç²¾ç¥ï¼Œè¿™è¾¹æä¾›å‡ ä¸ªå¿«é€Ÿä¸²æ¥çš„ CheatSheetï¼š



[**Asana API â€” å–å¾— Tasks:**](https://developers.asana.com/reference/gettasksforproject){:target="_blank"}



```javascript

function asanaAPI(endPoint, method = "GET", data = null) {
    var options = {
      "method" : method,
      "headers": {
          "Authorization":  "Bearer "+asanaToken
      },
      "payload" : data
    };

    var url = "https://app.asana.com/api/1.0"+endPoint;
    var res = UrlFetchApp.fetch(url, options);
    var data = JSON.parse(res.getContentText());
    return data;
}

asanaAPI("/projects/{project_gid}/tasks")
```



[**Jira API â€” å–å¾— Tickets (JQL):**](https://developer.atlassian.com/cloud/jira/platform/rest/v3/intro/#about){:target="_blank"}



```javascript
// jql = ç­›é€‰æ¡ä»¶
function jiraTickets(jql) {
  const url = `https://xxx.atlassian.net/rest/api/3/search`;
  const maxResults = 100;

  let allIssues = [];
  let startAt = 0;
  let total = 0;

  do {
    const queryParams = {
      jql: jql,
      startAt: startAt,
      maxResults: maxResults,
      fields: "assignee,summary,status"
    };

    const queryString = Object.keys(queryParams)
      .map(key => `${encodeURIComponent(key)}=${encodeURIComponent(queryParams[key])}`)
      .join("&");

    const options = {
      method: "get",
      headers: {
        Authorization: "Basic " + jiraToken,
        "Content-Type": "application/json",
      },
      muteHttpExceptions: true,
    };

    const response = UrlFetchApp.fetch(`${url}?${queryString}`, options);
    const json = JSON.parse(response.getContentText());
    if (response.getResponseCode() != 200) {
      throw new Error("Failed to fetch Jira issues."); 
    }

    if (json.issues && json.issues.length > 0) {
      allIssues = allIssues.concat(json.issues);
      total = json.total;
      startAt += json.issues.length;
    } else {
      break;
    }
  } while (startAt < total);

  var groupIssues = {};
  for(var i = 0; i < allIssues.length; i++) {
    const issue = allIssues[i];
    if (groupIssues[issue.fields.status.name] == null) {
      groupIssues[issue.fields.status.name] = [];
    }
    groupIssues[issue.fields.status.name].push(issue);
  }

  return groupIssues;
}

jiraTickets(`project IN(App)`);
```



**å¦‚æœçœŸçš„éœ€è¦èµ„æ–™åº“ï¼Œå¯ä»¥ä½¿ç”¨ Google Sheet ä»£æ›¿ï¼š**



```javascript
class Saveable {
  constructor(type) {
    // https://docs.google.com/spreadsheets/d/Sheet-ID/edit
    const spreadsheet = SpreadsheetApp.openById("Sheet-ID");
    this.sheet = spreadsheet.getSheetByName("Data"); // Sheet Name
    this.type = type;
  }

  write(key, value) {
    this.sheet.appendRow([
      this.type,
      key,
      JSON.stringify(value)
    ]);
  }

  read(key) {
    const data = this.sheet.getDataRange().getValues();
    const row = data.find(r => r[0] === this.type && r[1] === key);
    if (row) {
      return JSON.parse(row[2]);
    }
    return null;
  }
}

let saveable = Saveable("user");
// Write
saveable.write("birthday_zhgchgli", "0718");
// Read
saveable.read("birthday_zhgchgli"); // -> 0718
```



[**Slack API & å‘é€è®¯æ¯æ–¹æ³•ï¼š**](https://api.slack.com/methods/chat.postMessage){:target="_blank"}



```javascript
function slackSendMessage(channel, text = "", blocks = null) {
  const content = {
    channel: channel,
    unfurl_links: false,
    unfurl_media: false,
    text: text,
    blocks: blocks
  };

  try {
    const response = slackRequest("chat.postMessage", content);
    return response;
  } catch (error) {
    throw new Error(`Failed to send Slack message: ${error}`);
  }
}

function slackRequest(path, content) {
  const options = {
    method: "post",
    contentType: "application/json",
    headers: {
      Authorization: `Bearer ${slackBotToken}`,
      'X-Slack-No-Retry': 1
    },
    payload: JSON.stringify(content)
  };

  try {
    const response = UrlFetchApp.fetch("https://slack.com/api/"+path, options);
    const responseData = JSON.parse(response.getContentText());
    if (responseData.ok) {
      return responseData
    } else {
      throw new Error(`Slack: ${responseData.error}`);
    }
  } catch (error) {
    throw error;
  }
}
```



#### æ›´å¤š Google Apps Script æ¡ˆä¾‹ï¼š



- [Google Apps Script x Google APIs å¿«é€Ÿä¸²æ¥æ•´åˆæ–¹å¼](../71400d408dc8/)


- [ç®€å• 3 æ­¥éª¤ â€” æ‰“é€ å…è´¹ GA4 è‡ªåŠ¨æ•°æ®é€šçŸ¥æœºå™¨äºº](../1e85b8df2348/)


- [ä½¿ç”¨ Google Apps Script å®ç°æ¯æ—¥æ•°æ®æŠ¥è¡¨ RPA è‡ªåŠ¨åŒ–](../f6713ba3fee3/)


- [Slack & ChatGPT Integration](../bd94cc88f9c9/)


- [ä½¿ç”¨ Google Apps Script ä¸‰æ­¥éª¤å…è´¹å»ºç«‹ Github Repo Star Notifier](../382218e15697/)


- [Crashlytics + Google Analytics è‡ªåŠ¨æŸ¥è¯¢ App Crash-Free Users Rate](../793cb8f89b72/)


- [Crashlytics + Big Query æ‰“é€ æ›´å³æ—¶ä¾¿åˆ©çš„ Crash è¿½è¸ªå·¥å…·](../e77b80cc6f89/)



### æ€»ç»“



æ„Ÿè°¢æ‚¨çš„è€å¿ƒé˜…è¯»ä¸å‚ä¸ï¼ŒCI/CD ä» 0 åˆ° 1 ç³»åˆ—æ–‡ç« åˆ°æ­¤å‘Šä¸€æ®µè½ï¼›å¸Œæœ›èƒ½å®é™…å¸®åŠ©åˆ°æ‚¨ä¸æ‚¨çš„å›¢é˜Ÿå»ºç½®å®Œå–„çš„ CI/CD å·¥ä½œæµç¨‹ï¼Œæå‡æ•ˆç‡ä¸äº§å“ç¨³å®šæ€§ï¼›æœ‰ä»»ä½•å®ä½œé—®é¢˜æ¬¢è¿ç•™è¨€è®¨è®ºï¼Œè¿™å››ç¯‡æ–‡ç« å¤§çº¦èŠ±äº† 14+ å¤©æ’°å†™ï¼Œ **å¦‚æœæ‚¨è§‰å¾—ä¸é”™æ¬¢è¿ Follow æˆ‘çš„ Medium å’Œä¸æœ‹å‹åŒäº‹åˆ†äº«** ã€‚



> è°¢è°¢ã€‚



#### [Buy me a coffee](https://www.buymeacoffee.com/zhgchgli){:target="_blank"}



> [***æœ¬ç³»åˆ—æ–‡ç« èŠ±è´¹äº†å¤§é‡çš„æ—¶é—´ç²¾åŠ›æ’°å†™ï¼Œå¦‚æœå†…å®¹å¯¹æ‚¨æœ‰å¸®åŠ©ã€å¯¹æ‚¨çš„å›¢é˜Ÿæœ‰å®è´¨æå‡å·¥ä½œæ•ˆç‡ä¸äº§å“å“è´¨ï¼›æ¬¢è¿è¯·æˆ‘å–æ¯å’–å•¡ï¼Œæ„Ÿè°¢æ”¯æŒï¼***](https://www.buymeacoffee.com/zhgchgli){:target="_blank"}



![[Buy me a coffee](https://www.buymeacoffee.com/zhgchgli){:target="_blank"}](/assets/4273e57e7148/1*QJj54G9gOjtQS-rbHVT1SQ.png)



[Buy me a coffee](https://www.buymeacoffee.com/zhgchgli){:target="_blank"}



#### ç³»åˆ—æ–‡ç« ï¼š



- [**CI/CD å®æˆ˜æŒ‡å—ï¼ˆä¸€ï¼‰ï¼šCI/CD æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•é€è¿‡ CI/CD æ‰“é€ ç¨³å®šé«˜æ•ˆçš„å¼€å‘å›¢é˜Ÿï¼Ÿå·¥å…·é€‰æ‹©ï¼Ÿ**](../c008a9e8ceca/)


- [**CI/CD å®æˆ˜æŒ‡å—ï¼ˆäºŒï¼‰ï¼šGitHub Actions ä¸ self-hosted Runner ä½¿ç”¨ä¸å»ºç½®å¤§å…¨**](../404bd5c70040/)


- [**CI/CD å®æˆ˜æŒ‡å—ï¼ˆä¸‰ï¼‰ï¼šä½¿ç”¨ GitHub Actions å®ä½œ App ä¸“æ¡ˆçš„ CI ä¸ CD å·¥ä½œæµç¨‹**](../4b001d2e8440/)


- [**CI/CD å®æˆ˜æŒ‡å—ï¼ˆå››ï¼‰ï¼šä½¿ç”¨ Google Apps Script Web App ä¸²æ¥ GitHub Actions å»ºç½®å…è´¹æ˜“ç”¨çš„æ‰“åŒ…å·¥å…·å¹³å°**](../4273e57e7148/)



æœ‰ä»»ä½•é—®é¢˜åŠæŒ‡æ•™æ¬¢è¿ [ä¸æˆ‘è”ç»œ](https://www.zhgchg.li/contact){:target="_blank"} ã€‚



*[Post](https://dev.zhgchg.li/ci-cd-%E5%AF%A6%E6%88%B0%E6%8C%87%E5%8D%97-%E5%9B%9B-%E4%BD%BF%E7%94%A8-google-apps-script-web-app-%E4%B8%B2%E6%8E%A5-github-actions-%E5%BB%BA%E7%BD%AE%E5%85%8D%E8%B2%BB%E6%98%93%E7%94%A8%E7%9A%84%E6%89%93%E5%8C%85%E5%B7%A5%E5%85%B7%E5%B9%B3%E5%8F%B0-4273e57e7148){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}.*