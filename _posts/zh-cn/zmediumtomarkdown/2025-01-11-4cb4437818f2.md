---
author: ZhgChgLi
categories:
- ZRealm Dev.
date: 2025-01-11T11:19:43.066+0000
description: Github Action Workflow è¡¨å•ä¼˜åŒ–ä¸æ•´åˆå…¶ä»–å·¥ä½œæµç¨‹å·¥å…·(Jira, Asana, Slack..)æå‡å¼€å‘æ•ˆç‡ã€‚
image:
  path: /assets/4cb4437818f2/1*TiGXBQdPaCM6r2J1RHrgnA.png
last_modified_at: 2025-07-10T13:02:57.838+0000
render_with_liquid: false
tags:
- simplified-chinese
- ios-app-development
- google-apps-script
- github-actions
- slack
- github
title: ä½¿ç”¨ Google Apps Script Web App è¡¨å•ä¸²æ¥ Github Action CI/CD å·¥ä½œ
---

### ä½¿ç”¨ Google Apps Script Web App è¡¨å•ä¸²æ¥ Github Action CI/CD å·¥ä½œ



Github Action Workflow è¡¨å•ä¼˜åŒ–ä¸æ•´åˆå…¶ä»–å·¥ä½œæµç¨‹å·¥å…·(Jira, Asana, Slack. . )æå‡å¼€å‘æ•ˆç‡ã€‚



![å·¦ï¼šåŸå§‹çš„ Github Action Workflow Form / å³ï¼š [æœ€ç»ˆæˆæœ (GAS Web App Form)](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}](/assets/4cb4437818f2/1*TiGXBQdPaCM6r2J1RHrgnA.png)



å·¦ï¼šåŸå§‹çš„ Github Action Workflow Form / å³ï¼š [æœ€ç»ˆæˆæœ (GAS Web App Form)](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}



### 2025/07 Update:



æ­¤åŠŸèƒ½å·²æ•´åˆåˆ°å®é™…æ‰“åŒ…å·¥å…·ä½¿ç”¨ï¼Œå¯å‚è€ƒæœ€æ–°æ–‡ç« æ¡ˆä¾‹ï¼šã€Œ [**CI/CD å®æˆ˜æŒ‡å—ï¼ˆå››ï¼‰ï¼šä½¿ç”¨ Google Apps Script Web App ä¸²æ¥ GitHub Actions å»ºç½®å…è´¹æ˜“ç”¨çš„æ‰“åŒ…å·¥å…·å¹³å°**](../4273e57e7148/) ã€



### èƒŒæ™¯



ä¹‹å‰çš„å›¢é˜Ÿä½¿ç”¨ Github Action & Self-hosted Github Runner + Slack æ­å»ºæ•´å¥— CI/CD æœåŠ¡ï¼›æ•´ä½“æ•ˆæœä¸é”™ï¼Œå¯¹äº App å¼€å‘è€…æ¥è¯´å»ºç½®ä¸ç»´æŠ¤ç›¸å¯¹å®¹æ˜“ï¼Œåªéœ€ç…§è‘—å®˜æ–¹æ–‡ä»¶æä¾›çš„ YAML å‚æ•°å®Œæˆè®¾å®šå°±ä¼šè‡ªåŠ¨è§¦å‘ã€æœºå™¨æ–¹é¢ä¹Ÿå¯ä»¥è½»æ˜“çš„ä½¿ç”¨è‡ªå·±çš„æœºå™¨å½“æˆ Runner ä½¿ç”¨ï¼ŒæœåŠ¡æœ¬èº«éƒ½æ˜¯ç”± Github ç»´æŠ¤ï¼Œæˆ‘ä»¬ä¸éœ€åœ¨æ„ç‰ˆæœ¬å‡çº§ç­‰é—®é¢˜å¹¶ä¸” Runner æ˜¯åå‘è·Ÿ Github è¦ä»»åŠ¡ä¸‹æ¥åšï¼Œä¸éœ€è¦ç‰¹åˆ«å¼€å¯¹å¤–ç½‘è·¯å¼€å£ï¼›å¯¹å›¢é˜Ÿæ›´å¥½çš„äº‹æ˜¯ï¼Œä½¿ç”¨è‡ªå·±çš„ Runner è·‘ Github Action æ˜¯å®Œå…¨å…è´¹çš„ã€‚



> *ç­‰äºåŒæ—¶äº«å—åˆ°ç±»ä¼¼ Bitrise çš„ GUI YAML å»ºç½®æ–¹å¼åˆæœ‰åƒ Jenkins é‚£æ ·ä½¿ç”¨è‡ªæ¶æœºå™¨çš„å¼¹æ€§è·Ÿè¾ƒä½çš„å»ºç½®æˆæœ¬ï¼Œä½†ä¸ç”¨åƒ Jenkins é‚£æ ·éœ€è¦èŠ±æ—¶é—´ç»´æŠ¤æœåŠ¡æœ¬èº«ã€‚*



> **æœªæ¥æœ‰æ—¶é—´å†å†™ä¸€ç¯‡å®Œæ•´çš„ App CI/CD x Github Action æ­å»ºè¿‡ç¨‹ã€‚**



#### é—®é¢˜ï¼šGithub Action CI/CD GUI Form



![Github Action GUI Form](/assets/4cb4437818f2/1*55tCLFvuHtTyyvSLSv1vMA.png)



Github Action GUI Form



> *åœ¨ App å¼€å‘ä¸­ï¼Œåœ¨ CD è§¦å‘æ‰“åŒ…æµ‹è¯•ç‰ˆã€æ­£å¼ç‰ˆæˆ–é€å®¡æ—¶é€šå¸¸ä¼šéœ€è¦æä¾›ä¸€äº›å¤–éƒ¨å‚æ•°æˆ–æ˜¯ä¾ç…§éœ€æ±‚é€‰æ‹©ç¯å¢ƒã€åˆ†æ”¯ï¼Œæ‰ä¼šå¼€å§‹æ‰§è¡Œå·¥ä½œã€‚*



ä¸åŒäº Jenkins æ˜¯è‡ªå»ºæœåŠ¡ï¼Œæœ‰å®Œæ•´çš„ Web GUIï¼›Github Action æ²¡æœ‰ï¼Œå”¯ä¸€çš„ Web GUI Form æ˜¯åœ¨ Actions ä¸­ç‚¹å‡» Run workflow å¯ä»¥è‡ªè®¢ä¸€ä¸ªç®€æ˜“çš„è¡¨å•ä¾›ä½¿ç”¨è€…è¾“å…¥å¤–éƒ¨å‚æ•°ï¼Œç„¶åè§¦å‘ CI/CD å·¥ä½œæµç¨‹ã€‚



é€šå¸¸ä¼šä½¿ç”¨è¿™ä¸ª CD æ‰“åŒ…çš„ä½¿ç”¨è€…ï¼Œä¸ä¸€å®šæ˜¯ App å¼€å‘è€…æœ¬èº«ã€ä¹Ÿä¸ä¸€å®šæ‹¥æœ‰è¿™ä¸ªä¸“æ¡ˆçš„æƒé™ï¼›ä¾‹å¦‚ QA éœ€è¦æ‰“åŒ…æŒ‡å®šç‰ˆæœ¬ã€PM/Backend éœ€è¦æ‰“åŒ…æŸä¸ªå¼€å‘ä¸­ç‰ˆæœ¬è¿›è¡Œæµ‹è¯•ï¼›Github Action Form éœ€è¦æœ‰è¯¥ä¸“æ¡ˆçš„æƒé™æ‰èƒ½ä½¿ç”¨ï¼Œä½†ä½¿ç”¨è€…ä¸è¦è¯´èƒ½ä¸èƒ½æœ‰ä¸“æ¡ˆæƒé™ã€ç”šè‡³æ˜¯ä¸ä¸€å®šæœ‰å·¥ç¨‹èƒŒæ™¯ã€‚



**è€Œä¸”æˆ‘ä»¬æ— æ³•åœ¨è¿™è¾¹åšåŠ¨æ€è¡¨å•æˆ–èµ„æ–™éªŒè¯ã€‚**



> *å› æ­¤æˆ‘ä»¬éœ€è¦å¦å¤–æ‹‰ä¸€ä¸ª GUI æœåŠ¡ç»™å…¶ä»–ä½¿ç”¨è€…æ“ä½œä½¿ç”¨ã€‚*



#### è‡ªå»º Slack App è§£å†³



ä¹‹å‰å›¢é˜Ÿæ˜¯æœ‰çƒ­çˆ±åšè‡ªåŠ¨åŒ–çš„åŒä»è‡ªå·±ç”¨ Kotlin+Ktor æ­å»ºäº†ä¸€ä¸ªå®Œæ•´çš„ Slack App ç½‘è·¯æœåŠ¡ï¼Œä¸²æ¥ Slack è®¯æ¯ã€è¡¨å•ã€æŒ‡ä»¤â€¦ç­‰åŠŸèƒ½ï¼Œæ¥æ”¶ã€è½¬å‘ CD æ‰“åŒ…è¯·æ±‚ï¼Œè§¦å‘ Github Action æ‰§è¡Œæ“ä½œå¹¶å°†ç»“æœä¸²å› Slackã€‚



> *ç›®å‰æ²¡æœ‰å¼€å‘èµ„æºè·Ÿä¹‹å‰ä¸€æ ·ä½¿ç”¨ Kotlin+Ktor å»ºç½®æœåŠ¡*



#### è‡ªå·±å†™ Web/iOS/macOS App å·¥å…·



ç›®å‰å›¢é˜ŸåŸæœ¬æ˜¯ä½¿ç”¨ Jenkins æœ‰åŸºç¡€çš„ Web å¯ä»¥ç»™å…¶ä»–ä½¿ç”¨è€…ç™»å…¥ä½¿ç”¨ã€å¦å¤–è¿˜æœ‰è‡ªè¡Œå¼€å‘äº†ä¸€ä¸ª App ä¸²æ¥ Jenkins å°è£…ä¸€äº›å‚æ•°è®©éå·¥ç¨‹èƒŒæ™¯çš„ä½¿ç”¨è€…æ›´æ–¹ä¾¿ä½¿ç”¨ã€‚



> ***ä¸è¿‡è¿ç§»åˆ° Github Action ä¹‹åè¿™æ•´å¥—å°±åºŸå¼ƒäº†ã€‚***



#### âŒ Private Github Pages



åº”è¯¥æœ‰æœºä¼šç›´æ¥å»ºç½® Github Pages æ¥å½“ CI/CD Web GUIï¼Œä½†æ˜¯ç›®å‰åªæœ‰ Github [Enterprise](https://docs.github.com/en/enterprise-server@3.13/admin/configuration/configuring-your-enterprise/configuring-github-pages-for-your-enterprise#enabling-public-sites-for-github-pages){:target="_blank"} å¯ä»¥è®¾å®š Github Pages å­˜å–æƒé™ï¼Œå…¶ä»–æ–¹æ¡ˆå°±ç®—æ˜¯ Private Repo ä¹Ÿä¼šæ˜¯å…¬å¼€çš„ï¼›æ— å®‰å…¨æ€§å¯è¨€ã€‚



#### âŒ Slack Appï¼Œä½†ä½¿ç”¨ Google Apps Script å»ºç½®



ä¸€å¼€å§‹æƒ³è¯´ä¾ç…§ä¹‹å‰å›¢é˜Ÿçš„ç»éªŒä½¿ç”¨ Slack App åšä¸º CI/CD GUI Form æœåŠ¡ï¼Œä½†æ˜¯ç›®å‰æ²¡æœ‰èµ„æºè·Ÿä¹‹å‰ä¸€æ ·ä½¿ç”¨ Kotlin+Ktor å»ºç½®æœåŠ¡ï¼›æ‰€ä»¥æƒ³è¯´å…ˆä½¿ç”¨ Function as a Service æœåŠ¡å¿«é€Ÿå°è¯•å»ºç½®ã€‚



Function as a Service æœ‰å¾ˆå¤šç§ï¼Œ [Cloud Functions](https://cloud.google.com/functions?hl=zh-tw){:target="_blank"} çš„è‡ªç”±åº¦æ¯”è¾ƒé«˜ï¼Œä½†ç”±äºç»„ç»‡ IT é™åˆ¶ï¼Œæ— æ³•éšæ„æ–°å¢ Public Cloud Functions å¹¶ä¸”æœ‰æ”¶è´¹é—®é¢˜ï¼›å› æ­¤è¿˜æ˜¯å›åˆ°æˆ‘ä»¬çš„è€æœ‹å‹ â€” Google Apps Scriptã€‚



> *ä¹‹å‰å†™è¿‡å¥½å‡ ç¯‡å…³äº Google Apps Script åšè‡ªåŠ¨åŒ–çš„æ–‡ç« ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥å‚è€ƒï¼š*



> *1. **ã€Œ [ä½¿ç”¨ Google Apps Script å®ç°æ¯æ—¥æ•°æ®æŠ¥è¡¨ RPA è‡ªåŠ¨åŒ–](../f6713ba3fee3/) ã€***



> *2. ã€Œ [ç®€å• 3 æ­¥éª¤ â€” æ‰“é€ å…è´¹ GA4 è‡ªåŠ¨æ•°æ®é€šçŸ¥æœºå™¨äºº](https://medium.com/zrealm-robotic-process-automation/%E7%B0%A1%E5%96%AE-3-%E6%AD%A5%E9%A9%9F-%E6%89%93%E9%80%A0%E5%85%8D%E8%B2%BB-ga4-%E8%87%AA%E5%8B%95%E6%95%B8%E6%93%9A%E9%80%9A%E7%9F%A5%E6%A9%9F%E5%99%A8%E4%BA%BA-1e85b8df2348?source=collection_home---6------1-----------------------){:target="_blank"} ã€*



> *3. ã€Œ [Crashlytics + Google Analytics è‡ªåŠ¨æŸ¥è¯¢ App Crash-Free Users Rate](https://medium.com/zrealm-robotic-process-automation/crashlytics-google-analytics-%E8%87%AA%E5%8B%95%E6%9F%A5%E8%A9%A2-app-crash-free-users-rate-793cb8f89b72?source=collection_home---6------8-----------------------){:target="_blank"} ã€*



> *4. ã€Œ [Crashlytics + Big Query æ‰“é€ æ›´å³æ—¶ä¾¿åˆ©çš„ Crash è¿½è¸ªå·¥å…·](https://medium.com/zrealm-robotic-process-automation/crashlytics-big-query-%E6%89%93%E9%80%A0%E6%9B%B4%E5%8D%B3%E6%99%82%E4%BE%BF%E5%88%A9%E7%9A%84-crash-%E8%BF%BD%E8%B9%A4%E5%B7%A5%E5%85%B7-e77b80cc6f89?source=collection_home---6------9-----------------------){:target="_blank"} ã€*



æ€»è€Œè¨€ä¹‹ï¼ŒGoogle Apps Script æ˜¯ Google å¦ä¸€ä¸ª Function as a Service æœåŠ¡ï¼Œä¸»è¦ç‰¹è‰²æ˜¯å…è´¹è·Ÿä¸ Google æœåŠ¡ä¹‹é—´å¯ä»¥å¿«é€Ÿæ•´åˆï¼›ä½†æ˜¯é™åˆ¶ä¹Ÿè¾ƒå¤šï¼Œä¾‹å¦‚åªèƒ½ç”¨å®ƒçš„è¯­è¨€ã€æ‰§è¡Œæ—¶é—´ä¸èƒ½è¶…è¿‡ 6 åˆ†é’Ÿã€æœ‰æ‰§è¡Œæ¬¡æ•°ä¸Šé™ã€ä¸æ”¯æ´å¤šæ‰§è¡Œç»ªâ€¦ç­‰ç­‰ï¼Œç»†èŠ‚å¯ä»¥å‚è€ƒ [æˆ‘ä¹‹å‰çš„æ–‡ç« ](../f6713ba3fee3/) ã€‚



ç»“è®ºæ˜¯ä¸å¯è¡Œï¼ŒåŸå› æ˜¯ï¼š



- [Function as a Service å†·å¯åŠ¨é—®é¢˜](https://www.cloudflare.com/zh-tw/learning/serverless/what-is-serverless/){:target="_blank"} ã€‚
  æœåŠ¡ä¸€æ®µæ—¶é—´æ²¡å‘¼å«ä¼šè¿›å…¥ç¡çœ ï¼Œå†æ¬¡å‘¼å«è¦èŠ±è¾ƒé•¿æ—¶é—´å¯åŠ¨(3~â‰¥ 5 ç§’)ï¼› **Slack App å¯¹äº API å“åº”æ—¶é—´éå¸¸ä¸¥æ ¼ï¼ŒæœåŠ¡éœ€è¦åœ¨ 3 ç§’å†…å›åº”å¦åˆ™è§†ä¸ºå¤±è´¥** ï¼ŒSlack è¿™è¾¹å°±ä¼šç›´æ¥å–·é”™è¯¯ã€äº‹ä»¶ç›‘å¬ä¹Ÿä¼šè¢«è®¤ä¸ºä¸¢å¤±ï¼Œå¯¼è‡´é‡å¤å‘é€ã€‚


- **Google Apps Script doGet, doPost æ–¹æ³•æ— æ³•å–å¾— Headersã€‚**
  **è¿™ä¼šå¯¼è‡´æ— æ³•èµ° [å®˜æ–¹çš„å®‰å…¨éªŒè¯](https://api.slack.com/authentication/verifying-requests-from-slack){:target="_blank"} ã€æ— æ³•å…³é—­ [Slack Retry](https://api.slack.com/authentication/verifying-requests-from-slack){:target="_blank"} ã€‚**


- Google Apps Script å•æ‰§è¡Œç»ªé—®é¢˜ã€‚
  å¦‚æœè¦ä¸²æ¥å…¶ä»–æœåŠ¡å“åº”æ—¶é—´éƒ½ä¼šè¶…è¿‡ 3 ç§’ï¼Œç›´æ¥è¢« Slack åˆ¤å®šä¸ºå¤±è´¥ã€‚



æœ‰å‹‰å¼ºä½¿ç”¨ Slack è®¯æ¯ã€Block Kitã€Form ä¸²æ¥å®Œæ•´ä¸ªæµç¨‹ï¼Œä½†æ˜¯å¤ªå®¹æ˜“è§¦å‘ä¸Šè¿°é—®é¢˜ï¼Œåæ¥ç›´æ¥æ”¾å¼ƒã€‚



> ***å¦‚æœè¦åšè¿™å¥—è¿˜æ˜¯è¦èµ°è‡ªå·±èµ·ä¼ºæœå™¨ã€æœåŠ¡ï¼Œä¸è¦èµ° Function as a Service! !***



#### âŒ Slack Workflow Form



![](/assets/4cb4437818f2/1*KWBMdFswvl1KPdnTLStzhQ.png)



![[Slack Workflow Form](https://slack.com/intl/zh-tw/help/articles/24720245025555-%E8%87%AA%E5%8B%95%E5%8C%96%EF%BC%9A%E4%BD%BF%E7%94%A8%E7%B0%A1%E6%98%93%E8%A1%A8%E5%96%AE%E6%94%B6%E9%9B%86%E8%B3%87%E8%A8%8A){:target="_blank"} (âŒ æ— æ³•å®¢åˆ¶åŒ–)](/assets/4cb4437818f2/1*hnDPyOfGCTW_yJf71krMnA.png)



[Slack Workflow Form](https://slack.com/intl/zh-tw/help/articles/24720245025555-%E8%87%AA%E5%8B%95%E5%8C%96%EF%BC%9A%E4%BD%BF%E7%94%A8%E7%B0%A1%E6%98%93%E8%A1%A8%E5%96%AE%E6%94%B6%E9%9B%86%E8%B3%87%E8%A8%8A){:target="_blank"} (âŒ æ— æ³•å®¢åˆ¶åŒ–)



å¦å¤–ä¹Ÿå°è¯•è¿‡ Slack å†…å»ºçš„è‡ªåŠ¨åŒ–åŠŸèƒ½ Workflow Formï¼Œä¸è¿‡ä»–æ— æ³•åšåˆ°åŠ¨æ€è¡¨å•å†…å®¹ (e.g. æåˆ†æ”¯è®©ä½¿ç”¨è€…é€‰)ï¼Œå”¯ä¸€èƒ½å®¢åˆ¶åŒ–çš„åªæœ‰åç»­é€èµ„æ–™çš„æ­¥éª¤ã€‚



### âœ… Google Apps Script Web App GUI Form è¡¨å•



å±±ä¸è½¬è·¯è½¬ï¼Œè½¬å¿µä¸€æƒ³å¥½åƒä¹Ÿä¸ç”¨çº ç»“åœ¨ä¸€å®šè¦ç”¨ Slack æ•´åˆä¸Šï¼Œç”¨ Slack æ•´åˆæ˜¯æœ€å¥½çš„æ–¹æ¡ˆï¼Œå› ä¸ºæ˜¯ç›´æ¥æ•´è¿›æ—¢æœ‰çš„å›¢é˜Ÿåä½œå·¥å…·ï¼Œä¸éœ€è¦å‘æ•£é¢å¤–å»å­¦æ–°å·¥å…·ï¼›ä½†æ˜¯è¿«äºèµ„æºé™åˆ¶ï¼Œæˆ‘ä»¬åªèƒ½é€€è€Œæ±‚å…¶æ¬¡æ‰¾å…¶ä»–ç¨³å®šåˆå¥½ç”¨çš„æ–¹æ³•ã€‚



> *å›å¤´æƒ³åˆ° Google Apps Script æœ¬èº«å°±èƒ½éƒ¨ç½²æˆ Web Appï¼Œå¯ä»¥åœ¨ Web doGet æ—¶å›åº” GUI Form è¡¨å•ï¼Œé€å‡ºè¡¨å•åè§¦å‘åç»­çš„ Github ä¸²æ¥å¤„ç†ã€‚*



#### æœ€ç»ˆæˆæœ ğŸ‰



![[Demo Web App Form](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}](/assets/4cb4437818f2/1*pzW-Yki-4HbE2nYXC4q-Aw.png)



[Demo Web App Form](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}



#### **å·¥ä½œæµç¨‹**



æˆ‘ä»¬ä½¿ç”¨ Google Apps Script Web App å»ºç½® CI/CD è¡¨å•ï¼Œç›´æ¥ç»‘å®š Google Workspace å¸å·ï¼Œè®¾å®šåªæœ‰ç»„ç»‡å†…çš„ä½¿ç”¨è€…å¯ä»¥å­˜å–ï¼›è‡ªåŠ¨è·å–å½“å‰ç™»å…¥çš„ä½¿ç”¨è€…ä¿¡ç®±ã€ä½¿ç”¨ Github Repo å…±ç”¨å¸å·(æˆ–å€Ÿç”¨æŸä¸ªæœ‰æƒé™çš„å¸å·)çš„ Personal Access Token æ‰“ Github API è·å¾—åˆ†æ”¯åˆ—è¡¨ï¼Œé€å‡ºååŒæ ·æ‰“ API è§¦å‘ Github Action å¼€å§‹æ‰§è¡Œ CI/CD å·¥ä½œã€‚



å¦å¤–ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä½¿ç”¨è€…çš„ä¿¡ç®±é€è¿‡ Slack App å»æ‰“ Slack APIï¼Œå–å¾—è¯¥ä½¿ç”¨è€…çš„ Slack IDï¼Œå†é€è¿‡ Slack App ä¼ é€è®¯æ¯ï¼Œé€šçŸ¥ CI/CD ä»»åŠ¡æ‰§è¡Œæƒ…å†µã€‚



ä¹Ÿå¯ä»¥å†ä¸å…¶ä»–å·¥å…·ã€å¼€å‘æµç¨‹è¿›è¡Œæ•´åˆï¼Œä¾‹å¦‚å…ˆä» Asana, Jira å–å¾—å·¥å•ï¼Œé€‰æ‹©åå†é€è¿‡ Github API æŸ¥æ‰¾åˆ†æ”¯ã€è§¦å‘ Github Actionï¼Œæœ€åå†é€è¿‡ Slack é€šçŸ¥ç»™ä½¿ç”¨è€…ã€‚



#### Step 1. å»ºç«‹ Google Apps Script Web App Form



å‰å¾€ &gt; [Google Apps Script](https://script.google.com/home){:target="_blank"} ï¼Œæ–°å¢ä¸“æ¡ˆã€‚



![](/assets/4cb4437818f2/1*T3if7Dfo0iJaa4N5VZyA1Q.png)



#### Step 2. å»ºç«‹è¡¨å•å†…å®¹ã€GAS ç¨‹å¼



å¤ªä¹…æ²¡æœ‰å†™ HTML,CSS ä¹Ÿæ‡’å¾—è‡ªå·±è®¾è®¡æ ·å¼ï¼Œç›´æ¥è¯· ChatGPT äº§ä¸€ä¸ªæœ‰ä¸€ç‚¹è®¾è®¡çš„ HTML è¡¨å•èŒƒæœ¬ã€‚



![](/assets/4cb4437818f2/1*IPv0afE5FAFj40F22s8Umg.png)



![](/assets/4cb4437818f2/1*F_HrfV_k16g_ojm1WIDDuA.png)



åœ¨ GAS å·¦æ–¹æ¡£æ¡ˆåˆ—è¡¨ç‚¹ã€Œ+ã€æ–°å¢æ¡£æ¡ˆï¼Œè¾“å…¥æ¡£æ¡ˆåç§°ã€Œ `Form.html` ã€å¹¶æŠŠ GPT äº§çš„ HTML è¡¨å•èŒƒæœ¬å†…å®¹è´´ä¸Šã€‚



`Form.htmlï¼š`



```xml
<!--HTML & Style Gen by ChatGPT 4o-->
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><?=title?></title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f7f7f7;
    }
    .form-container {
      max-width: 600px;
      margin: auto;
      padding: 20px;
      background-color: #ffffff;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .form-container h2 {
      margin-bottom: 20px;
      color: #333333;
    }
    .form-group {
      margin-bottom: 15px;
    }
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #555555;
    }
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 95%;
      padding: 10px;
      border: 1px solid #cccccc;
      border-radius: 4px;
      font-size: 16px;
    }
    .form-group input[type="radio"] {
      width: auto;
      margin-right: 10px;
    }
    .form-group .radio-label {
      display: inline-block;
      margin-right: 20px;
    }
    .form-group button {
      background-color: #4CAF50;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
    }
    .form-group button:hover {
      background-color: #45a049;
    }
    .message {
      margin-top: 20px;
      padding: 15px;
      border-radius: 5px;
      font-size: 1em;
      text-align: center;
    }
    .message.success {
      background-color: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    .message.error {
      background-color: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div class="form-container">
    <h2><?=title?></h2>
    <form id="myForm">
      <div id="message-block" class="hidden"></div>
      <div class="form-group">
        <label for="email">ç”µå­é‚®ä»¶ï¼š</label>
        <input type="email" value="<?=email?>" readonly/>
      </div>
      <div class="form-group">
        <label for="buildNumber">ç‰ˆæœ¬å·ï¼š</label>
        <input type="number" value="<?=buildNumber?>"/>
      </div>
      <div class="form-group">
        <label for="branch">Review ä¸­çš„ PRï¼š</label>
        <select id="branch" name="branch">
          <option>è¯·é€‰æ‹©</option>
          <? pullRequests.forEach(pullRequest => { ?>
            <option value="<?=pullRequest.head.ref?>">[<?=pullRequest.state?>] <?=pullRequest.title?></option>
          <? }); ?>
        </select>
      </div>
      <div class="form-group">
        <label for="message">æ›´æ–°å†…å®¹ï¼š</label>
        <textarea id="message" name="message" rows="4" placeholder="è¯·è¾“å…¥æ‚¨çš„è®¯æ¯"></textarea>
      </div>
      <div class="form-group">
        <button type="submit">é€å‡º</button>
      </div>
    </form>
  </div>
  <script>
    function displayMessage(ok, message) {
      const messageBlock = document.getElementById('message-block');
      messageBlock.className = ok ? 'message success' : 'message error';
      messageBlock.innerHTML = message;
      messageBlock.classList.remove('hidden');
    }
    
    document.getElementById("myForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const formData = new FormData(this);
      const formObject = Object.fromEntries(formData);
      google.script.run.withSuccessHandler((response) => {
        displayMessage(response.ok, response.message);
      }).processForm(formObject);
    });
  </script>
</body>
</html>
```



è¡¨å•å†…å®¹å¯ä¾ç…§éœ€æ±‚è‡ªè¡Œè°ƒæ•´ã€‚



`ç¨‹å¼ç .gsï¼š`



```javascript
function doGet(e) {
  // å¯¹åº”åˆ°å·¦æ–¹æ¡£æ¡ˆ Form.html
  const htmlTemplate = HtmlService.createTemplateFromFile('Form');
  
  const email = Session.getActiveUser().getEmail();
  // å–å¾—ä½¿ç”¨è€…ä¿¡ç®±ï¼Œåªé™ æ‰§è¡Œèº«ä»½ï¼šå­˜å–ç½‘é¡µç¨‹å¼çš„ä½¿ç”¨è€… è®¾å®šæœ‰æ•ˆ
  
  const title = "App CD æ‰“åŒ…è¯·æ±‚è¡¨å•";
  
  const buildNumber = genBuildNumber();

  htmlTemplate.email = email;
  htmlTemplate.title = title;
  htmlTemplate.pullRequests = []; // ä¸‹ä¸€æ­¥åœ¨ä¸²æ¥ Github...
  htmlTemplate.buildNumber = buildNumber;

  const html = htmlTemplate.evaluate();
  html.setTitle(title);
  //html.setWidth(600) // è®¾å®šé¡µé¢å®½åº¦

  return html
}

function processForm(object) {
  return {"ok": true, "message": "è¯·æ±‚é€å‡ºæˆåŠŸï¼"};
}

function genBuildNumber() {
  const now = new Date();
  const formattedDate = Utilities.formatDate(now, "Asia/Taipei", "yyyyMMddHHmmss");
  const milliseconds = now.getMilliseconds().toString().padStart(3, '0'); // ç¡®ä¿æ¯«ç§’æ˜¯ 3 ä½æ•°
  return `${formattedDate}${milliseconds}`; 
}
```



è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å…ˆæŠŠè¡¨å• GUI å®Œæˆï¼Œä¸‹ä¸€æ­¥å†æ¥ä¸²æ¥ Github API æ‹¿åˆ° PR åˆ†æ”¯åˆ—è¡¨ã€‚



![](/assets/4cb4437818f2/1*RN9ftVBdgCA-IL8ra9jvTg.png)



#### Step 2. éƒ¨ç½² Google Apps Script Web App Form



æˆ‘ä»¬å…ˆæŠŠåˆšåˆšçš„å†…å®¹éƒ¨ç½²ä¸€æ¬¡ï¼ŒæŸ¥çœ‹ç»“æœã€‚



åœ¨ GAS å³ä¸Šè§’é€‰æ‹©ã€Œéƒ¨ç½²ã€-&gt; ã€Œæ–°å¢éƒ¨ç½²ä½œä¸šã€-&gt;ã€Œç½‘é¡µåº”ç”¨ç¨‹å¼ã€ï¼š



![](/assets/4cb4437818f2/1*ouVO18FtOcX8vdeGCEtwCw.png)



![](/assets/4cb4437818f2/1*4BuEtIA4H_-Q9WALonYxYg.png)



![](/assets/4cb4437818f2/1*JagpVPTGD-W0lhIJ5nrRew.png)



æ‰§è¡Œèº«ä»½è·Ÿè°å¯ä»¥å­˜å–åˆ†åˆ«å¯ä»¥è®¾ç½®æˆï¼š



**æ‰§è¡Œèº«ä»½ï¼š**



- æˆ‘ `ç»Ÿä¸€éƒ½ç”¨ä½ çš„å¸å·èº«åˆ†æ‰§è¡Œè„šæœ¬ã€‚`


- å­˜å–ç½‘é¡µç¨‹å¼çš„ä½¿ç”¨è€… `ä¼šä»¥å½“å‰ç™»å…¥çš„ Google å¸å·ä½¿ç”¨è€…èº«ä»½æ‰§è¡Œè„šæœ¬ã€‚`



**è°å¯ä»¥å­˜å–ï¼š**



- åªæœ‰æˆ‘è‡ªå·±


- **XXX åŒä¸ªç»„ç»‡ä¸­çš„æ‰€æœ‰ä½¿ç”¨è€…** `åªæœ‰åŒç»„ç»‡ï¼‹å·²ç™»å…¥çš„ Google å¸å·ä½¿ç”¨è€…å¯ä»¥å­˜å–ã€‚`


- æ‰€æœ‰å·²ç™»å…¥ Google å¸å·çš„ä½¿ç”¨è€… `å·²ç™»å…¥çš„ Google å¸å·ä½¿ç”¨è€…éƒ½å¯ä»¥å­˜å–ã€‚`


- æ‰€æœ‰äºº `ä¸éœ€è¦ç™»å…¥ Google å¸å·ã€æ‰€æœ‰äººéƒ½å¯ä»¥å…¬å¼€å­˜å–ã€‚`



> *æˆ‘ä»¬é€‰æ‹©ã€Œè°å¯ä»¥å­˜å–ï¼šXXX åŒä¸ªç»„ç»‡ä¸­çš„æ‰€æœ‰ä½¿ç”¨è€…ã€ï¼‹ã€Œæ‰§è¡Œèº«ä»½ï¼šå­˜å–ç½‘é¡µç¨‹å¼çš„ä½¿ç”¨è€…ã€å°±èƒ½ **è‡ªåŠ¨é™åˆ¶åªæœ‰ç»„ç»‡å¸å·çš„äººå¯ä»¥ä½¿ç”¨** ï¼Œå¹¶ä¸”ç”¨ä»–è‡ªå·±çš„èº«ä»½æ‰§è¡Œï¼*



> *æ˜¯ä¸€ä¸ªå¾ˆæ–¹ä¾¿æƒé™æ§ç®¡çš„åŠŸèƒ½ï¼*



é€‰å®Œç‚¹å‡»å³ä¸‹ã€Œéƒ¨ç½²ã€ã€‚



![](/assets/4cb4437818f2/1*dvyqYb5kcta402j3RUYJog.png)



ç½‘é¡µåº”ç”¨ç¨‹å¼ä¸­çš„ç½‘å€ï¼Œå°±æ˜¯ Web App å­˜å–ç½‘å€ã€‚



```bash
https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec
```



> *ç½‘å€å¾ˆé•¿å¾ˆä¸‘ï¼Œä½†æ˜¯æ²¡åŠæ³•ï¼Œåªèƒ½è‡ªå·±æ‰¾çŸ­ç½‘å€å·¥å…·ç¼©çŸ­ä¸€ä¸‹ã€‚*



**ç‚¹ç½‘å€æ‰“å¼€é¡µé¢æŸ¥çœ‹æ•ˆæœï¼š**



![](/assets/4cb4437818f2/1*jbx4IO4DEhqYfwI_UTQk5Q.png)



**è¿™è¾¹è¦å¤šæä¸¤ä¸ª GAS é™åˆ¶ï¼š**



- GAS Web App ä¸Šæ–¹è­¦å‘Šæç¤ºï¼Œé¢„è®¾æ— æ³•éšè—


- GAS Web App æ˜¯ç”¨ IFrame æŠŠæˆ‘ä»¬çš„é¡µé¢åµŒåœ¨é‡Œé¢ï¼Œå› æ­¤å¾ˆéš¾åšåˆ° 100% RWD æ•ˆæœ
  åªèƒ½ä½¿ç”¨ `.setWidth()` è°ƒæ•´è§†çª—å®½åº¦



#### Google Apps Script æˆæƒè­¦å‘Š



**ç¬¬ä¸€æ¬¡ä½¿ç”¨** ã€ç‚¹å‡»ã€Œä¾¦é”™ã€æˆ–ã€Œæ‰§è¡Œã€å¯èƒ½ä¼šå‡ºä¸‹ä»¥ä¸‹æˆæƒè­¦å‘Šï¼š



![](/assets/4cb4437818f2/1*9q8KZGHER9vdtnbKVVQB9g.png)



![](/assets/4cb4437818f2/1*iWrkqMf8vkEGkiwkI1amIw.jpeg)



é€‰æ‹©æƒ³è¦æ‰§è¡Œçš„èº«ä»½å¸å·ï¼Œå¦‚æœæœ‰å‡ºç°ã€Œè¿™ä¸ªåº”ç”¨ç¨‹å¼æœªç» Google éªŒè¯ã€åˆ™ç‚¹å‡»ã€Œè¿›é˜¶ã€-&gt;ã€Œå‰å¾€ XXX (ä¸å®‰å…¨)ã€ï¼Œé€‰æ‹©ã€Œå…è®¸ã€ï¼š



![](/assets/4cb4437818f2/1*ucaqLxh-TOgJIaGyqqFd3A.png)



![](/assets/4cb4437818f2/1*l-tma_YICU24goKvZvl7Ww.png)



![](/assets/4cb4437818f2/1*JAs_3__Qt2XeDcQiKEUNhg.png)



å¦‚æœ GAS ç¨‹å¼æƒé™æœ‰å˜åŠ¨(ä¾‹å¦‚ï¼šå¤šåŠ å­˜å– Google Sheetâ€¦etc)æ‰ä¼šéœ€è¦å†é‡æ–°æˆæƒï¼Œä¸ç„¶ç‚¹è¿‡ä¸€æ¬¡å°±ä¸ä¼šå†å‡ºç°ã€‚



> *å¦‚é‡åˆ°ï¼šå·²å°é”å­˜å–æƒã€ŒXXXã€æœªå®Œæˆ Google éªŒè¯ç¨‹åºï¼Œ [å¯å‚è€ƒæˆ‘æœ€æ–°æ–‡ç« çš„ GCP è®¾å®šã€‚](../4273e57e7148/)*



#### Step 3. ä¸²æ¥ Github API å–å¾— PR åˆ†æ”¯åˆ—è¡¨



æˆ‘ä»¬æ–°å¢ä¸€ä¸ª `Github.gs` ç¨‹å¼æ¡£æ¡ˆå­˜æ”¾ Github API ç›¸å…³é€»è¾‘ã€‚



`Github.gsï¼š`



```javascript
// SECRET
const githubPersonalAccessToken = ""
// ä½¿ç”¨ä½ çš„ Github å¸å·æˆ–ç»„ç»‡å…±ç”¨çš„ Github å¸å·åˆ›å»º PAT
// https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens

// æ–¹å¼ 1: Restful API å­˜å–
function githubAPI(method, path, payload = null) {
  try {
    const url = "https://api.github.com"+path;  
    var options = {
      method: method,
      headers: {
        "Accept": "application/vnd.github+json",
        "Authorization": `Bearer ${githubPersonalAccessToken}`,
        "X-GitHub-Api-Version": "2022-11-28"
      }
    };

    if (method.toLowerCase().trim() == "post") {
      options.payload = JSON.stringify(payload);
    }

    const response = UrlFetchApp.fetch(url, options);
    const data = JSON.parse(response.getContentText());
    return data;
  } catch (error) {
    throw error;
  }
}

// æ–¹å¼ 2: GraphQL å­˜å–
// Github API éƒ¨åˆ†æ›´ç»†çš„æŸ¥è¯¢åŠŸèƒ½åªæœ‰ GraphQL API æœ‰æä¾›
// https://docs.github.com/en/graphql
function githubGraphQL(query, variables) {
  const url = "https://api.github.com/graphql";
  const payload = {
    query: query,
    variables: variables
  };

  const options = {
    method: "post",
    contentType: "application/json",
    headers: {
      "Accept": "application/vnd.github+json",
      "Authorization": `Bearer ${githubPersonalAccessToken}`,
      "X-GitHub-Api-Version": "2022-11-28"
    },
    payload: JSON.stringify(payload)
  };

  try {
    const response = UrlFetchApp.fetch(url, options);
    const data = JSON.parse(response.getContentText());
    return data;
  } catch (error) {
    throw error;
  }
}

// GraphQL Example:
// const query = `
//   query($owner: String!, $repo: String!) {
//     repository(owner: $owner, name: $repo) {
//       pullRequests(states: OPEN, first: 100, orderBy: { field: CREATED_AT, direction: DESC }) {
//         nodes {
//           title
//           url
//           number
//           createdAt
//           author {
//             login
//           }
//           headRefName
//           baseRefName
//           body
//         }
//         pageInfo {
//           hasNextPage
//           endCursor
//         }
//       }
//     }
//   }
// `;
// const variables = {
//   owner: "swiftlang",
//   repo: "swift"
// };
// const response = githubGraphQL(query, variables);
```



Github API æœ‰ä¸¤ç§å­˜å–æ–¹å¼ï¼Œä¸€ç§æ˜¯ä¼ ç»Ÿçš„ Restfulï¼Œå¦ä¸€ç§æ˜¯æ›´å¼¹æ€§çš„ GraphQLï¼›æœ¬æ–‡ä»¥ Restful ä¸ºä¾‹ã€‚



`ç¨‹å¼ç .gsï¼š`



```kotlin
function doGet(e) {
  // å¯¹åº”åˆ°å·¦æ–¹æ¡£æ¡ˆ Form.html
  const htmlTemplate = HtmlService.createTemplateFromFile('Form');
  
  const email = Session.getActiveUser().getEmail();
  // å–å¾—ä½¿ç”¨è€…ä¿¡ç®±ï¼Œåªé™ æ‰§è¡Œèº«ä»½ï¼šå­˜å–ç½‘é¡µç¨‹å¼çš„ä½¿ç”¨è€… è®¾å®šæœ‰æ•ˆ

  const title = "App CD æ‰“åŒ…è¯·æ±‚è¡¨å•";
  
  const pullRequests = githubAPI("get", "/repos/swiftlang/swift/pulls");
  // ä»¥ https://github.com/swiftlang/swift/pulls ä¸ºä¾‹
  
  const buildNumber = genBuildNumber();

  htmlTemplate.email = email;
  htmlTemplate.title = title;
  htmlTemplate.pullRequests = pullRequests;
  htmlTemplate.buildNumber = buildNumber;

  const html = htmlTemplate.evaluate();
  html.setTitle(title);
  //html.setWidth(600) // è®¾å®šé¡µé¢å®½åº¦

  return html
}

function processForm(object) {
  if (object.buildNumber == "") {
    return {"ok": false, "message": "è¯·è¾“å…¥ç‰ˆæœ¬å·ï¼"};
  }
  if (object.branch == "") {
    return {"ok": false, "message": "è¯·é€‰æ‹©åˆ†æ”¯ç‰ˆæœ¬ï¼"};
  }

  // å¸¦ä¸Šä½ è¦å¸¦åˆ° Github Action çš„å‚æ•°
  const payload = {
    ref: object.branch,
    inputs: {
      buildNumber: object.buildNumber
    }
  };
  
  //  
  try {
    const response = githubAPI("post", "/repos/zhgchgli0718/ios-project-for-github-action-ci-cd-demo/actions/workflows/CD-Job.yml/dispatches", payload);
    // ä»¥ https://github.com/zhgchgli0718/ios-project-for-github-action-ci-cd-demo/blob/main/.github/workflows/CD-Job.yml ä¸ºä¾‹

    return {"ok": true, "message": `æ‰“åŒ…è¯·æ±‚å‘é€æˆåŠŸ!<br/>å¯¹åº”åˆ†æ”¯ï¼š<strong>${object.branch}</strong><br/>ç‰ˆå·ï¼š<strong>${object.buildNumber}</strong>`};
  } catch (error) {
    return {"ok": false, "message": "å‘ç”Ÿé”™è¯¯ï¼š"+error.message};
  }
}
```



`processForm` æ–¹æ³•ä¸­å¤„ç†è¡¨å•å›ä¼ çš„å†…å®¹ï¼Œä¹Ÿå¯ä»¥å¤šåŠ ä¸Šæ›´å¤šåƒ



#### GAS x Github API x Github Action



è¿™è¾¹å¤šè¡¥å……ä¸€ä¸‹å¯¹åº”åˆ°çš„ Github Actionã€‚



`CD-Job.ymlï¼š`



```yaml
# CD æ‰“åŒ…å·¥ä½œ

name: CD-Job

on:
  workflow_dispatch:
    inputs:
      buildNumber: # å¯¹åº” GAS payload.inpus.xxx
        description: 'ç‰ˆæœ¬å·ç '
        required: false
        type: string
      # ...More
      # Inputs ç±»å‹å¯å‚è€ƒå®˜æ–¹æ–‡ä»¶ï¼šhttps://docs.github.com/en/actions/writing-workflows/workflow-syntax-for-github-actions#onworkflow_dispatchinputs
      
jobs:
  some-job:
    runs-on: ubuntu-latest
    steps:
      - name: Print Inputs
        run: \\|
          echo "Release Build Number: ${{ github.event.inputs.buildNumber }}"    
```



#### Step 4. é‡æ–°éƒ¨ç½² Google Apps Script Web App Form



> ***âš ï¸è¯·æ³¨æ„ï¼ŒGAS ç¨‹å¼ç çš„ä»»ä½•è°ƒæ•´éƒ½éœ€è¦é‡æ–°éƒ¨ç½²ï¼Œæ‰ä¼šç”Ÿæ•ˆã€‚âš ï¸***



> ***âš ï¸è¯·æ³¨æ„ï¼ŒGAS ç¨‹å¼ç çš„ä»»ä½•è°ƒæ•´éƒ½éœ€è¦é‡æ–°éƒ¨ç½²ï¼Œæ‰ä¼šç”Ÿæ•ˆã€‚âš ï¸***



> ***âš ï¸è¯·æ³¨æ„ï¼ŒGAS ç¨‹å¼ç çš„ä»»ä½•è°ƒæ•´éƒ½éœ€è¦é‡æ–°éƒ¨ç½²ï¼Œæ‰ä¼šç”Ÿæ•ˆã€‚âš ï¸***



GAS å³ä¸Šè§’é€‰æ‹©ã€Œéƒ¨ç½²ã€-&gt; é€‰æ‹©å³ä¸Šè§’ã€Œç¼–è¾‘ã€-&gt; ç‰ˆæœ¬é€‰æ‹©ã€Œå»ºç«‹æ–°ç‰ˆæœ¬ã€



![](/assets/4cb4437818f2/1*ZMAB_m6HmsSsGSqqfZiRpA.png)



![](/assets/4cb4437818f2/1*rUWlfzASAaeXcXUh4LavZw.png)



![](/assets/4cb4437818f2/1*HAr5TZtpnQeG-Ril0Rjf-g.png)



ç‚¹å‡»ã€Œéƒ¨ç½²ã€-&gt; å®Œæˆã€‚



![](/assets/4cb4437818f2/1*z6lw7R8ivUseSzR4IZgPdg.png)



![](/assets/4cb4437818f2/1*eTdgKGQ1lRM7sCRXQgZ-DA.png)



**å†å›åˆ°ç½‘é¡µä¸Šé‡æ–°æ•´ç†ï¼Œå°±èƒ½çœ‹åˆ°ä¿®æ”¹åçš„ç»“æœäº†ï¼š**



![](/assets/4cb4437818f2/1*iI49OJC1uTyMEgzGTBowxQ.png)



> ***âš ï¸è¯·æ³¨æ„ï¼ŒGAS ç¨‹å¼ç çš„ä»»ä½•è°ƒæ•´éƒ½éœ€è¦é‡æ–°éƒ¨ç½²ï¼Œæ‰ä¼šç”Ÿæ•ˆã€‚âš ï¸***



> ***âš ï¸è¯·æ³¨æ„ï¼ŒGAS ç¨‹å¼ç çš„ä»»ä½•è°ƒæ•´éƒ½éœ€è¦é‡æ–°éƒ¨ç½²ï¼Œæ‰ä¼šç”Ÿæ•ˆã€‚âš ï¸***



> ***âš ï¸è¯·æ³¨æ„ï¼ŒGAS ç¨‹å¼ç çš„ä»»ä½•è°ƒæ•´éƒ½éœ€è¦é‡æ–°éƒ¨ç½²ï¼Œæ‰ä¼šç”Ÿæ•ˆã€‚âš ï¸***



### Done! ğŸ‰ğŸ‰ğŸ‰



![](/assets/4cb4437818f2/1*pzW-Yki-4HbE2nYXC4q-Aw.png)



![[Demo Web App Form](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}](/assets/4cb4437818f2/1*9aaNeemezNPRlSgbLFrseA.png)



[Demo Web App Form](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}



ç°åœ¨ä½ å¯ä»¥åœ¨ç»„ç»‡å†…åˆ†äº«è¿™ä¸ªè¿ç»“ç»™å…¶ä»–ä¼™ä¼´ï¼Œä»–ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªç½‘é¡µ GUI æ‰§è¡Œ CI/CD å·¥ä½œã€‚



#### å»¶ä¼¸ (1)â€” ç”¨ä½¿ç”¨è€…çš„ä¿¡ç®±æŸ¥è¯¢ Slack User ID & å‘é€ã€æ›´æ–°è¿›åº¦é€šçŸ¥



å‰æ–‡æœ‰æåˆ°ï¼Œæˆ‘ä»¬å¸Œæœ›åŠæ—¶é€šçŸ¥ä½¿ç”¨è€… CI/CD æ‰§è¡ŒçŠ¶å†µï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä½¿ç”¨è€…æä¾›çš„ä¿¡ç®±å»æŸ¥ Slack User IDã€‚



`Slack.gsï¼š`



```javascript
const slackBotToken = ""
// https://medium.com/zrealm-robotic-process-automation/slack-chatgpt-integration-bd94cc88f9c9

function slackRequest(path, content) {
  const options = {
    method: "post",
    contentType: "application/json",
    headers: {
      Authorization: `Bearer ${slackBotToken}`, // Use the bot token for authorization,
      'X-Slack-No-Retry': 1
    },
    payload: JSON.stringify(content)
  };

  try {
    const response = UrlFetchApp.fetch("https://slack.com/api/"+path, options);
    const responseData = JSON.parse(response.getContentText());
    if (responseData.ok) {
      return responseData
    } else {
      throw new Error(`Slack: ${responseData.error}`);
    }
  } catch (error) {
    throw error;
  }
}

// ç”¨ä¿¡ç®±æŸ¥è¯¢ Slask UID
function getSlackUserId(email) {
  return slackRequest(`users.lookupByEmail?email=${encodeURIComponent(email)}`)?.user?.id;
}

// å‘é€è®¯æ¯ç»™ç›®æ ‡ Slack UID (channelID)
function sendSlackMessage(channelId, ts = null, value)  {
  var content = {
    channel: channelId
  };

  if (ts != null) {
    content.thread_ts = ts;
  }
  
  if (typeof value === "string") {
    content.text = value;
  } else {
    content.blocks = value;
  }
  return slackRequest("chat.postMessage", content);
}

// æ›´æ–°å‘é€çš„è®¯æ¯å†…å®¹
function updateSlackMessage(channelId, ts = null, value)  {
  var content = {
    channel: channelId
  };

  if (ts != null) {
    content.ts = ts;
  }
  
  if (typeof value === "string") {
    content.text = value;
  } else {
    content.blocks = value;
  }
  return slackRequest("chat.update", content);
}
```



Slack API ä½¿ç”¨è¯·å‚è€ƒ [å®˜æ–¹æ–‡ä»¶](https://api.slack.com/methods/chat.postMessage){:target="_blank"} ã€‚



**Githun Action YAML å¯ä»¥ä½¿ç”¨è¿™ä¸ª Action æŒç»­æ›´æ–°è®¯æ¯ã€å‘é€ Slack è®¯æ¯ï¼š**



[![](https://opengraph.githubassets.com/376c992b8ee6787b9708e0b82116279ec012d41f84cafbd0975214d865cf45e9/slackapi/slack-github-action)](https://github.com/slackapi/slack-github-action){:target="_blank"}



```yaml
# ...
on:
  workflow_dispatch:
    inputs:
      buildNumber: # å¯¹åº” GAS payload.inpus.xxx
        description: 'ç‰ˆæœ¬å·ç '
        required: false
        type: string
      # ...More
      SLACK_USER_ID:
        description: 'Slack User Id for receive action notification'
        type: string
      SLACK_CHANNEL_ID:
        description: 'Slack Channel Id for receive action notification'
        type: string
      SLACK_THREAD_TS:
        description: 'Slack message ts'
        type: string
      
jobs:
  # some jobs...

  if-deploy-failed-message:
    runs-on: ubuntu-latest
    if: failure()
      - name: update slack message
        uses: slackapi/slack-github-action@v2.0.0
        with:
            method: chat.update
            token: ${{ secrets.SLACK_BOT_TOKEN }}
            payload: \\|
              channel: ${{ github.event.inputs.SLACK_CHANNEL_ID }}
              ts: ${{ github.event.inputs.SLACK_THREAD_TS }}
              text: "âŒ æ‰“åŒ…ä»»åŠ¡å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ‰§è¡ŒçŠ¶å†µç»“æœæˆ–ç¨åå†è¯•ã€‚\n<${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\\|ç‚¹æ­¤æŸ¥çœ‹æ‰§è¡ŒçŠ¶å†µ> cc'ed <@${{ github.event.inputs.SLACK_USER_ID }}>"
```



**æ•ˆæœï¼š**



![](/assets/4cb4437818f2/1*-w5jqjkx6p2alpzlLcz_Nw.png)



> ***Slack App ä¸²æ¥ç»†èŠ‚å¯å‚è€ƒæˆ‘ä¹‹å‰çš„æ–‡ç« ï¼š [Slack & ChatGPT Integration](../bd94cc88f9c9/) ã€‚***



#### å»¶ä¼¸ (2) â€”æŸ¥è¯¢ Jira å·¥å•



`Jira.gsï¼š`



```javascript
const jiraPersonalAccessToken = ""
// https://confluence.atlassian.com/enterprise/using-personal-access-tokens-1026032365.html

function getJiraTickets() {
  const url = `https://xxx.atlassian.net/rest/api/3/search`;

  // JQL query
  const jql = `project = XXX`;
  const queryParams = {
    jql: jql,
    maxResults: 50, // Adjust as needed
  };

  const options = {
    method: "get",
    headers: {
      Authorization: "Basic " + jiraPersonalAccessToken,
      "Content-Type": "application/json",
    },
    muteHttpExceptions: true,
  };

  const queryString = Object.keys(queryParams).map(key => `${encodeURIComponent(key)}=${encodeURIComponent(queryParams[key])}`).join("&");
  const response = UrlFetchApp.fetch(url + "?" + queryString + "&fields=", options);
  // could specify only return some fields

  if (response.getResponseCode() === 200) {
    const issues = JSON.parse(response.getContentText()).issues;
    return issues;
  } else {
    Logger.log(`Error: ${response.getResponseCode()} - ${response.getContentText()}`);
    throw new Error("Failed to fetch Jira issues.");
  }
} 
```



å…¶ä»– Jira API ä½¿ç”¨è¯·å‚è€ƒ [å®˜æ–¹æ–‡ä»¶](https://developer.atlassian.com/cloud/jira/platform/rest/v3/){:target="_blank"} ã€‚



#### å»¶ä¼¸ (3) â€” æŸ¥è¯¢ Asana å·¥å•



`Asana.gsï¼š`



```kotlin
const asanaPersonalAccessToken = ""
// https://developers.asana.com/docs/personal-access-token

function asanaAPI(endpoint, method = "GET", data = null) {
    var options = {
      "method" : method,
      "contentType" : "application/json",
      "headers": {
          "Authorization":  "Bearer "+asanaPersonalAccessToken
      }
    };

    if (data != null) {
      options["payload"] = JSON.stringify({"data":data});
    }

    const url = "https://app.asana.com/api/1.0"+endpoint;
    const res = UrlFetchApp.fetch(url, options);
    const data = JSON.parse(res.getContentText());
    return data;
}

// æŸ¥æ‰¾ tasks in project
// asanaAPI("/projects/PROJECT_ID/tasks");
```



å…¶ä»– Asana API ä½¿ç”¨è¯·å‚è€ƒ [å®˜æ–¹æ–‡ä»¶](https://developers.asana.com/reference/gettasksforproject){:target="_blank"} ã€‚



### æ€»ç»“



è‡ªåŠ¨åŒ–ã€å·¥ä½œåŠå¼€å‘æµç¨‹ä¼˜åŒ–ç¼ºçš„æ°¸è¿œä¸æ˜¯æŠ€æœ¯ï¼Œè€Œæ˜¯æƒ³æ³•ï¼›åªè¦æœ‰æƒ³æ³•æˆ‘ä»¬éƒ½èƒ½æ‰¾åˆ°é€‚åˆçš„æŠ€æœ¯æ¥å®ç°ï¼Œå…±å‹‰ä¹‹ï¼



### 2025/07 Update:



æ­¤åŠŸèƒ½å·²æ•´åˆåˆ°å®é™…æ‰“åŒ…å·¥å…·ä½¿ç”¨ï¼Œå¯å‚è€ƒæœ€æ–°æ–‡ç« æ¡ˆä¾‹ï¼šã€Œ [**CI/CD å®æˆ˜æŒ‡å—ï¼ˆå››ï¼‰ï¼šä½¿ç”¨ Google Apps Script Web App ä¸²æ¥ GitHub Actions å»ºç½®å…è´¹æ˜“ç”¨çš„æ‰“åŒ…å·¥å…·å¹³å°**](../4273e57e7148/) ã€



æœ‰ä»»ä½•é—®é¢˜åŠæŒ‡æ•™æ¬¢è¿ [ä¸æˆ‘è”ç»œ](https://www.zhgchg.li/contact){:target="_blank"} ã€‚



*[Post](https://dev.zhgchg.li/%E4%BD%BF%E7%94%A8-google-apps-script-web-app-%E8%A1%A8%E5%96%AE%E4%B8%B2%E6%8E%A5-github-action-ci-cd-%E5%B7%A5%E4%BD%9C-4cb4437818f2){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}.*