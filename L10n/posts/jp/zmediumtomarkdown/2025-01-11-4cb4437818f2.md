---
author: ZhgChgLi
categories:
- ZRealmã®é–‹ç™º
date: 2025-01-11T11:19:43.066+0000
description: Github Action Workflowã‚’Google Apps Script Web Appãƒ•ã‚©ãƒ¼ãƒ ã¨é€£æºã—ã€Jiraã‚„Asanaã€Slackãªã©ã®ãƒ„ãƒ¼ãƒ«ã¨çµ±åˆã€‚é–‹ç™ºåŠ¹ç‡ã‚’æœ€å¤§35%å‘ä¸Šã•ã›ã‚‹å…·ä½“çš„æ‰‹æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚
image:
  path: /assets/4cb4437818f2/1*TiGXBQdPaCM6r2J1RHrgnA.png
last_modified_at: 2025-12-17T15:45:42.355+0000
render_with_liquid: false
tags:
- iosã‚¢ãƒ—ãƒªé–‹ç™º
- google-apps-script
- github-actions
- slack
- github
- japanese
- ai-translation
title: Google Apps Script Web Appã§Github Action CI/CDã‚’åŠ¹ç‡åŒ–ï½œãƒ•ã‚©ãƒ¼ãƒ é€£æºã§é–‹ç™ºã‚¹ãƒ”ãƒ¼ãƒ‰å‘ä¸Š
---

### Google Apps Script Web App ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½¿ã£ãŸ Github Action CI/CD ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®é€£æº

Github Action ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ•ã‚©ãƒ¼ãƒ ã®æœ€é©åŒ–ã¨ä»–ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ„ãƒ¼ãƒ«ï¼ˆJiraã€Asanaã€Slack ãªã©ï¼‰ã¨ã®çµ±åˆã«ã‚ˆã‚‹é–‹ç™ºåŠ¹ç‡ã®å‘ä¸Šã€‚

![å·¦ï¼šå…ƒã® Github Action Workflow ãƒ•ã‚©ãƒ¼ãƒ  / å³ï¼š [æœ€çµ‚æˆæœ (GAS Web App ãƒ•ã‚©ãƒ¼ãƒ )](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}](/assets/4cb4437818f2/1*TiGXBQdPaCM6r2J1RHrgnA.png)

å·¦ï¼šå…ƒã® Github Action Workflow ãƒ•ã‚©ãƒ¼ãƒ  / å³ï¼š [æœ€çµ‚æˆæœ (GAS Web App ãƒ•ã‚©ãƒ¼ãƒ )](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}

### 2025/07 ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ:

ã“ã®æ©Ÿèƒ½ã¯å®Ÿéš›ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«ã«çµ±åˆã•ã‚Œã¦ã„ã¾ã™ã€‚æœ€æ–°ã®è¨˜äº‹äº‹ä¾‹ã‚’ã”å‚ç…§ãã ã•ã„ï¼šã€Œ[**CI/CD å®Ÿè·µã‚¬ã‚¤ãƒ‰ï¼ˆ4ï¼‰ï¼šGoogle Apps Script Web App ã‚’ä½¿ã£ã¦ GitHub Actions ã¨é€£æºã—ã€ç„¡æ–™ã§ä½¿ã„ã‚„ã™ã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’æ§‹ç¯‰ã™ã‚‹**](../4273e57e7148/)ã€

### èƒŒæ™¯

ä»¥å‰ã®ãƒãƒ¼ãƒ ã¯ Github Action ã¨ Self-hosted Github Runnerã€ã•ã‚‰ã« Slack ã‚’çµ„ã¿åˆã‚ã›ã¦ä¸€é€£ã® CI/CD ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ§‹ç¯‰ã—ã¦ã„ã¾ã—ãŸã€‚å…¨ä½“çš„ã«åŠ¹æœã¯è‰¯å¥½ã§ã€ã‚¢ãƒ—ãƒªé–‹ç™ºè€…ã«ã¨ã£ã¦ã¯æ§‹ç¯‰ã¨ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãŒæ¯”è¼ƒçš„ç°¡å˜ã§ã—ãŸã€‚å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã‚ã‚‹ YAML ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«å¾“ã£ã¦è¨­å®šã™ã‚Œã°è‡ªå‹•ã§ãƒˆãƒªã‚¬ãƒ¼ã•ã‚Œã€ãƒã‚·ãƒ³é¢ã§ã‚‚è‡ªåˆ†ã®ãƒã‚·ãƒ³ã‚’ Runner ã¨ã—ã¦ç°¡å˜ã«ä½¿ãˆã¾ã—ãŸã€‚ã‚µãƒ¼ãƒ“ã‚¹è‡ªä½“ã¯ Github ãŒç®¡ç†ã—ã¦ãŠã‚Šã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ãªã©ã‚’æ°—ã«ã™ã‚‹å¿…è¦ãŒãªãã€Runner ã¯é€†æ–¹å‘ã« Github ã‹ã‚‰ã‚¿ã‚¹ã‚¯ã‚’å—ã‘å–ã‚‹ãŸã‚ã€å¤–éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ãƒãƒ¼ãƒˆé–‹æ”¾ã‚‚ä¸è¦ã§ã—ãŸã€‚

> *Bitriseã®ã‚ˆã†ãªGUIã§ã®YAMLãƒ“ãƒ«ãƒ‰æ–¹å¼ã¨ã€Jenkinsã®ã‚ˆã†ã«è‡ªå‰ã®ãƒã‚·ãƒ³ã‚’ä½¿ã†æŸ”è»Ÿæ€§ã‚„ä½ã‚³ã‚¹ãƒˆã®ãƒ“ãƒ«ãƒ‰ã‚’åŒæ™‚ã«äº«å—ã§ãã‚‹ãŒã€Jenkinsã®ã‚ˆã†ã«ã‚µãƒ¼ãƒ“ã‚¹è‡ªä½“ã®ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã«æ™‚é–“ã‚’ã‹ã‘ã‚‹å¿…è¦ã¯ãªã„ã€‚*

> **æ™‚é–“ãŒã‚ã‚Œã°ã€å®Œå…¨ãª App CI/CD ã¨ GitHub Actions ã®æ§‹ç¯‰ãƒ—ãƒ­ã‚»ã‚¹ã«ã¤ã„ã¦ã®è¨˜äº‹ã‚’æ›¸ãã¾ã™ã€‚**

#### å•é¡Œï¼šGithub Action CI/CD GUI ãƒ•ã‚©ãƒ¼ãƒ 

![Github Action GUI Form](/assets/4cb4437818f2/1*55tCLFvuHtTyyvSLSv1vMA.png)

Github Action GUIãƒ•ã‚©ãƒ¼ãƒ 

> *ã‚¢ãƒ—ãƒªé–‹ç™ºã§ã¯ã€CDã§ãƒ†ã‚¹ãƒˆç‰ˆã‚„æ­£å¼ç‰ˆã®ãƒ“ãƒ«ãƒ‰ã€å¯©æŸ»ç”³è«‹ã‚’ãƒˆãƒªã‚¬ãƒ¼ã™ã‚‹éš›ã«ã€å¤–éƒ¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æä¾›ã‚„ç’°å¢ƒãƒ»ãƒ–ãƒ©ãƒ³ãƒã®é¸æŠãŒå¿…è¦ã§ã‚ã‚Šã€ãã‚Œã«å¿œã˜ã¦å‡¦ç†ãŒé–‹å§‹ã•ã‚Œã¾ã™ã€‚*

Jenkinsã¯è‡ªå‰ã§ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ§‹ç¯‰ã—ã€å®Œå…¨ãªWeb GUIã‚’æŒã£ã¦ã„ã¾ã™ãŒã€GitHub Actionsã«ã¯ãã‚ŒãŒã‚ã‚Šã¾ã›ã‚“ã€‚å”¯ä¸€ã®Web GUIãƒ•ã‚©ãƒ¼ãƒ ã¯ã€Actionså†…ã®ã€ŒRun workflowã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨è¡¨ç¤ºã•ã‚Œã‚‹ç°¡æ˜“ãƒ•ã‚©ãƒ¼ãƒ ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå¤–éƒ¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã—ã¦CI/CDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ãƒˆãƒªã‚¬ãƒ¼ã§ãã¾ã™ã€‚

é€šå¸¸ã“ã®CDãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã€å¿…ãšã—ã‚‚ã‚¢ãƒ—ãƒªé–‹ç™ºè€…æœ¬äººã‚„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ¨©é™ã‚’æŒã£ã¦ã„ã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ä¾‹ãˆã°ã€QAãŒç‰¹å®šãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åŒ–ã—ãŸã‚Šã€PMã‚„ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒé–‹ç™ºä¸­ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ãƒ†ã‚¹ãƒˆç”¨ã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åŒ–ã—ãŸã‚Šã—ã¾ã™ã€‚GitHub Actionsã®ãƒ•ã‚©ãƒ¼ãƒ ã¯ãã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ¨©é™ãŒãªã„ã¨ä½¿ç”¨ã§ãã¾ã›ã‚“ãŒã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ¨©é™ã‚’æŒã£ã¦ã„ã‚‹ã¨ã¯é™ã‚‰ãšã€ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã®ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚‚å¿…ãšã—ã‚‚å¿…è¦ã‚ã‚Šã¾ã›ã‚“ã€‚

**ãã—ã¦ã“ã“ã§ã¯å‹•çš„ãªãƒ•ã‚©ãƒ¼ãƒ ã‚„ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚**

> *ãã®ãŸã‚ã€ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ“ä½œã§ãã‚‹ã‚ˆã†ã«åˆ¥ã®GUIã‚µãƒ¼ãƒ“ã‚¹ã‚’ç”¨æ„ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚*

#### è‡ªä½œ Slack App ã§è§£æ±º

ä»¥å‰ã€ãƒãƒ¼ãƒ ã«ã¯è‡ªå‹•åŒ–ã‚’ç†±æ„›ã™ã‚‹ãƒ¡ãƒ³ãƒãƒ¼ãŒã„ã¦ã€Kotlin+Ktor ã‚’ä½¿ã£ã¦å®Œå…¨ãª Slack App ã®ã‚¦ã‚§ãƒ–ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ§‹ç¯‰ã—ã¾ã—ãŸã€‚Slack ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ãƒ•ã‚©ãƒ¼ãƒ ã€ã‚³ãƒãƒ³ãƒ‰ãªã©ã®æ©Ÿèƒ½ã¨é€£æºã—ã€CD ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡ãƒ»è»¢é€ã—ã€GitHub Actions ã‚’ãƒˆãƒªã‚¬ãƒ¼ã—ã¦æ“ä½œã‚’å®Ÿè¡Œã—ã€ãã®çµæœã‚’ Slack ã«è¿”ã™ä»•çµ„ã¿ã§ã™ã€‚

> *ç¾åœ¨ã¯é–‹ç™ºãƒªã‚½ãƒ¼ã‚¹ãŒãªãã€ä»¥å‰ã®ã‚ˆã†ã« Kotlin+Ktor ã§ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ§‹ç¯‰ã—ã¦ã„ã¾ã›ã‚“*

#### è‡ªåˆ†ã§ä½œã‚‹ Web/iOS/macOS ã‚¢ãƒ—ãƒªãƒ„ãƒ¼ãƒ«

ç¾åœ¨ã®ãƒãƒ¼ãƒ ã¯ã‚‚ã¨ã‚‚ã¨ Jenkins ã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã€åŸºæœ¬çš„ãª Web ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚ã•ã‚‰ã«ã€éã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½¿ã„ã‚„ã™ã„ã‚ˆã†ã«ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒ©ãƒƒãƒ—ã™ã‚‹ App ã‚’è‡ªä½œã—ã¦ Jenkins ã¨é€£æºã•ã›ã¦ã„ã¾ã™ã€‚

> ***ã—ã‹ã—ã€Github Action ã«ç§»è¡Œã—ãŸå¾Œã€ã“ã®ä¸€é€£ã®ä»•çµ„ã¿ã¯å»ƒæ­¢ã•ã‚Œã¾ã—ãŸã€‚***

#### âŒ ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆGithubãƒšãƒ¼ã‚¸

ç›´æ¥ Github Pages ã‚’ CI/CD Web GUI ã¨ã—ã¦æ§‹ç¯‰ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ãŒã€ç¾åœ¨ã¯ Github [Enterprise](https://docs.github.com/en/enterprise-server@3.13/admin/configuration/configuring-your-enterprise/configuring-github-pages-for-your-enterprise#enabling-public-sites-for-github-pages){:target="_blank"} ã®ã¿ãŒ Github Pages ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’è¨­å®šã§ãã¾ã™ã€‚ä»–ã®ãƒ—ãƒ©ãƒ³ã§ã¯ã€Private Repo ã§ã‚ã£ã¦ã‚‚å…¬é–‹ã•ã‚Œã¦ã—ã¾ã„ã€å®‰å…¨æ€§ãŒç¢ºä¿ã§ãã¾ã›ã‚“ã€‚

#### âŒ Slack Appã€ã—ã‹ã— Google Apps Script ã§æ§‹ç¯‰

æœ€åˆã¯ä»¥å‰ã®ãƒãƒ¼ãƒ ã®çµŒé¨“ã«åŸºã¥ã„ã¦ Slack App ã‚’ CI/CD GUI ãƒ•ã‚©ãƒ¼ãƒ ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦ä½¿ãŠã†ã¨è€ƒãˆã¾ã—ãŸãŒã€ç¾åœ¨ã¯ä»¥å‰ã®ã‚ˆã†ã« Kotlin+Ktor ã§ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ§‹ç¯‰ã™ã‚‹ãƒªã‚½ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ãã®ãŸã‚ã€ã¾ãšã¯ Function as a Service ã§æ‰‹æ—©ãæ§‹ç¯‰ã‚’è©¦ã¿ã‚ˆã†ã¨æ€ã„ã¾ã—ãŸã€‚

Function as a Service ã«ã¯å¤šãã®ç¨®é¡ãŒã‚ã‚Šã¾ã™ãŒã€[Cloud Functions](https://cloud.google.com/functions?hl=zh-tw){:target="_blank"} ã¯è‡ªç”±åº¦ãŒé«˜ã„ã§ã™ã€‚ã—ã‹ã—ã€çµ„ç¹”ã®ITåˆ¶é™ã«ã‚ˆã‚Šã€è‡ªç”±ã«ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¯ãƒ©ã‚¦ãƒ‰é–¢æ•°ã‚’è¿½åŠ ã§ããšã€æ–™é‡‘ã®å•é¡Œã‚‚ã‚ã‚‹ãŸã‚ã€ã‚„ã¯ã‚Šç§ãŸã¡ã®å¤ãã‹ã‚‰ã®å‹äººã§ã‚ã‚‹ Google Apps Script ã«æˆ»ã‚Šã¾ã™ã€‚

> *ä»¥å‰ã«Google Apps Scriptã‚’ä½¿ã£ãŸè‡ªå‹•åŒ–ã«é–¢ã™ã‚‹è¨˜äº‹ã‚’ã„ãã¤ã‹æ›¸ãã¾ã—ãŸã€‚èˆˆå‘³ã®ã‚ã‚‹æ–¹ã¯ã”å‚ç…§ãã ã•ã„ï¼š*

> *1. **ã€Œ [Google Apps Scriptã‚’ä½¿ã£ãŸæ—¥æ¬¡ãƒ‡ãƒ¼ã‚¿ãƒ¬ãƒãƒ¼ãƒˆã®RPAè‡ªå‹•åŒ–](../f6713ba3fee3/) ã€***

> *2. ã€Œ [ç°¡å˜3ã‚¹ãƒ†ãƒƒãƒ— â€” ç„¡æ–™ã§ä½œã‚‹GA4è‡ªå‹•ãƒ‡ãƒ¼ã‚¿é€šçŸ¥ãƒ­ãƒœãƒƒãƒˆ](https://medium.com/zrealm-robotic-process-automation/%E7%B0%A1%E5%96%AE-3-%E6%AD%A5%E9%A9%9F-%E6%89%93%E9%80%A0%E5%85%8D%E8%B2%BB-ga4-%E8%87%AA%E5%8B%95%E6%95%B8%E6%93%9A%E9%80%9A%E7%9F%A5%E6%A9%9F%E5%99%A8%E4%BA%BA-1e85b8df2348?source=collection_home---6------1-----------------------){:target="_blank"} ã€*

> *3. ã€Œ [Crashlytics + Google Analyticsã§è‡ªå‹•çš„ã«ã‚¢ãƒ—ãƒªã®ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒ•ãƒªãƒ¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ç‡ã‚’ç…§ä¼š](https://medium.com/zrealm-robotic-process-automation/crashlytics-google-analytics-%E8%87%AA%E5%8B%95%E6%9F%A5%E8%A9%A2-app-crash-free-users-rate-793cb8f89b72?source=collection_home---6------8-----------------------){:target="_blank"} ã€*

> *4. ã€Œ [Crashlytics + Big Query ã‚’ä½¿ã£ãŸã‚ˆã‚Šãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ä¾¿åˆ©ãªã‚¯ãƒ©ãƒƒã‚·ãƒ¥è¿½è·¡ãƒ„ãƒ¼ãƒ«ã®æ§‹ç¯‰](https://medium.com/zrealm-robotic-process-automation/crashlytics-big-query-%E6%89%93%E9%80%A0%E6%9B%B4%E5%8D%B3%E6%99%82%E4%BE%BF%E5%88%A9%E7%9A%84-crash-%E8%BF%BD%E8%B9%A4%E5%B7%A5%E5%85%B7-e77b80cc6f89?source=collection_home---6------9-----------------------){:target="_blank"} ã€*

ç·ã˜ã¦ã€Google Apps Script ã¯ Google ã®ã‚‚ã†ä¸€ã¤ã® Function as a Service ã‚µãƒ¼ãƒ“ã‚¹ã§ã€ä¸»ãªç‰¹å¾´ã¯ç„¡æ–™ã§ Google ã‚µãƒ¼ãƒ“ã‚¹ã¨ç´ æ—©ãé€£æºã§ãã‚‹ã“ã¨ã§ã™ã€‚ã—ã‹ã—åˆ¶é™ã‚‚å¤šãã€ä¾‹ãˆã°å°‚ç”¨ã®è¨€èªã—ã‹ä½¿ãˆãªã„ã€å®Ÿè¡Œæ™‚é–“ãŒ6åˆ†ã‚’è¶…ãˆã‚‰ã‚Œãªã„ã€å®Ÿè¡Œå›æ•°ã®ä¸Šé™ãŒã‚ã‚‹ã€ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ã«å¯¾å¿œã—ã¦ã„ãªã„ãªã©ãŒã‚ã‚Šã¾ã™ã€‚è©³ç´°ã¯[ç§ã®ä»¥å‰ã®è¨˜äº‹](../f6713ba3fee3/)ã‚’ã”å‚ç…§ãã ã•ã„ã€‚

çµè«–ã¯ä¸å¯èƒ½ã§ã‚ã‚‹ç†ç”±ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š

- [Function as a Service ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆå•é¡Œ](https://www.cloudflare.com/zh-tw/learning/serverless/what-is-serverless/){:target="_blank"}ã€‚  
  ã‚µãƒ¼ãƒ“ã‚¹ãŒä¸€å®šæ™‚é–“å‘¼ã³å‡ºã•ã‚Œãªã„ã¨ã‚¹ãƒªãƒ¼ãƒ—çŠ¶æ…‹ã«ãªã‚Šã€å†åº¦å‘¼ã³å‡ºã™ã¨èµ·å‹•ã«æ™‚é–“ãŒã‹ã‹ã‚‹ï¼ˆ3ã€œâ‰¥5ç§’ï¼‰ã€‚**Slack App ã¯ API ã®å¿œç­”æ™‚é–“ã«éå¸¸ã«å³ã—ãã€ã‚µãƒ¼ãƒ“ã‚¹ã¯3ç§’ä»¥å†…ã«å¿œç­”ã—ãªã„ã¨å¤±æ•—ã¨ã¿ãªã•ã‚Œã¾ã™**ã€‚ãã®ãŸã‚ã€Slack å´ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã€ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚‚å¤±ã‚ã‚ŒãŸã¨åˆ¤æ–­ã•ã‚Œã€å†é€ãŒç¹°ã‚Šè¿”ã•ã‚Œã¾ã™ã€‚

- **Google Apps Scriptã®doGetã€doPostãƒ¡ã‚½ãƒƒãƒ‰ã§ã¯Headersã‚’å–å¾—ã§ãã¾ã›ã‚“ã€‚**  
  **ã“ã‚Œã«ã‚ˆã‚Šã€[å…¬å¼ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£èªè¨¼](https://api.slack.com/authentication/verifying-requests-from-slack){:target="_blank"}ãŒåˆ©ç”¨ã§ããšã€[Slackã®ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½](https://api.slack.com/authentication/verifying-requests-from-slack){:target="_blank"}ã‚’ç„¡åŠ¹ã«ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã›ã‚“ã€‚**

- Google Apps Script ã®å˜ä¸€ã‚¹ãƒ¬ãƒƒãƒ‰å•é¡Œã€‚  
  ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹ã¨é€£æºã™ã‚‹å ´åˆã€å¿œç­”æ™‚é–“ãŒ3ç§’ã‚’è¶…ãˆã‚‹ã¨Slackã«å¤±æ•—ã¨åˆ¤æ–­ã•ã‚Œã¾ã™ã€‚

Slackã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€Block Kitã€ãƒ•ã‚©ãƒ¼ãƒ ã‚’ç„¡ç†ã‚„ã‚Šä½¿ã£ã¦ä¸€é€£ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’ã¤ãªã’ã¾ã—ãŸãŒã€ä¸Šè¿°ã®å•é¡ŒãŒé »ç™ºã—ãŸãŸã‚ã€æœ€çµ‚çš„ã«æ–­å¿µã—ã¾ã—ãŸã€‚

> ***ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã™ã‚‹å ´åˆã¯ã€ã‚„ã¯ã‚Šè‡ªåˆ†ã§ã‚µãƒ¼ãƒãƒ¼ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç«‹ã¦ã‚‹ã¹ãã§ã€Function as a Serviceã¯ä½¿ã‚ãªã„ã§ãã ã•ã„ï¼***

#### âŒ Slack ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ•ã‚©ãƒ¼ãƒ 

![](/assets/4cb4437818f2/1*KWBMdFswvl1KPdnTLStzhQ.png)

![[Slack Workflow Form](https://slack.com/intl/zh-tw/help/articles/24720245025555-%E8%87%AA%E5%8B%95%E5%8C%96%EF%BC%9A%E4%BD%BF%E7%94%A8%E7%B0%A1%E6%98%93%E8%A1%A8%E5%96%AE%E6%94%B6%E9%9B%86%E8%B3%87%E8%A8%8A){:target="_blank"} (âŒ ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºä¸å¯)](/assets/4cb4437818f2/1*hnDPyOfGCTW_yJf71krMnA.png)

[Slack Workflow Form](https://slack.com/intl/zh-tw/help/articles/24720245025555-%E8%87%AA%E5%8B%95%E5%8C%96%EF%BC%9A%E4%BD%BF%E7%94%A8%E7%B0%A1%E6%98%93%E8%A1%A8%E5%96%AE%E6%94%B6%E9%9B%86%E8%B3%87%E8%A8%8A){:target="_blank"} (âŒ ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºä¸å¯)

ã¾ãŸã€Slackå†…è”µã®è‡ªå‹•åŒ–æ©Ÿèƒ½ã§ã‚ã‚‹Workflow Formã‚‚è©¦ã—ã¾ã—ãŸãŒã€å‹•çš„ãªãƒ•ã‚©ãƒ¼ãƒ å†…å®¹ï¼ˆä¾‹ï¼šãƒ–ãƒ©ãƒ³ãƒã‚’å–å¾—ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é¸ã°ã›ã‚‹ï¼‰ã¯ã§ããšã€ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã‚‹ã®ã¯ãƒ‡ãƒ¼ã‚¿é€ä¿¡å¾Œã®ã‚¹ãƒ†ãƒƒãƒ—ã®ã¿ã§ã—ãŸã€‚

### âœ… Google Apps Script Web App GUI ãƒ•ã‚©ãƒ¼ãƒ 

å±±ãŒå‹•ã‹ãªãã¦ã‚‚é“ã¯å¤‰ã‚ã‚‹ã€è€ƒãˆã‚’å¤‰ãˆã‚Œã°å¿…ãšã—ã‚‚ Slack çµ±åˆã«ã“ã ã‚ã‚‹å¿…è¦ã¯ãªã„ã¨æ€ãˆãŸã€‚Slack çµ±åˆã¯æ—¢å­˜ã®ãƒãƒ¼ãƒ å”æ¥­ãƒ„ãƒ¼ãƒ«ã«ç›´æ¥çµ„ã¿è¾¼ã‚ã‚‹ãŸã‚æœ€è‰¯ã®æ–¹æ³•ã ãŒã€ãƒªã‚½ãƒ¼ã‚¹ã®åˆ¶ç´„ã‹ã‚‰ä»–ã®å®‰å®šã—ã¦ä½¿ã„ã‚„ã™ã„æ–¹æ³•ã‚’æ¢ã•ã–ã‚‹ã‚’å¾—ãªã‹ã£ãŸã€‚

> *æŒ¯ã‚Šè¿”ã‚‹ã¨ã€Google Apps Script è‡ªä½“ãŒ Web ã‚¢ãƒ—ãƒªã¨ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤å¯èƒ½ã§ã€Web ã® doGet æ™‚ã« GUI ãƒ•ã‚©ãƒ¼ãƒ ã‚’è¿”ã—ã€ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å¾Œã« GitHub é€£æºã®å‡¦ç†ã‚’ãƒˆãƒªã‚¬ãƒ¼ã§ãã‚‹ã€‚*

#### æœ€çµ‚æˆæœ ğŸ‰

![[Demo Web App Form](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}](/assets/4cb4437818f2/1*pzW-Yki-4HbE2nYXC4q-Aw.png)

[Demo Web App Form](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}

#### **ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼**

ç§ãŸã¡ã¯ Google Apps Script Web App ã‚’ä½¿ã£ã¦ CI/CD ãƒ•ã‚©ãƒ¼ãƒ ã‚’æ§‹ç¯‰ã—ã€Google Workspace ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ç›´æ¥ç´ä»˜ã‘ã¦ã€çµ„ç¹”å†…ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ãŒã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«è¨­å®šã—ã¦ã„ã¾ã™ã€‚ç¾åœ¨ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è‡ªå‹•å–å¾—ã—ã€GitHub ãƒªãƒã‚¸ãƒˆãƒªã®å…±æœ‰ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆã¾ãŸã¯æ¨©é™ã‚’æŒã¤ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã® Personal Access Tokenï¼‰ã‚’ä½¿ã£ã¦ GitHub API ã‹ã‚‰ãƒ–ãƒ©ãƒ³ãƒä¸€è¦§ã‚’å–å¾—ã—ã€é€ä¿¡å¾Œã«åŒã˜ã API ã‚’å‘¼ã³å‡ºã—ã¦ GitHub Actions ã‚’ãƒˆãƒªã‚¬ãƒ¼ã—ã€CI/CD ã®ã‚¸ãƒ§ãƒ–ã‚’é–‹å§‹ã—ã¾ã™ã€‚

ã¾ãŸã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä½¿ã£ã¦ Slack App çµŒç”±ã§ Slack API ã‚’å‘¼ã³å‡ºã—ã€ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã® Slack ID ã‚’å–å¾—ã—ã€Slack App ã‚’é€šã˜ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã€CI/CD ã‚¿ã‚¹ã‚¯ã®å®Ÿè¡ŒçŠ¶æ³ã‚’é€šçŸ¥ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ä»–ã®ãƒ„ãƒ¼ãƒ«ã‚„é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹ã¨é€£æºã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚ä¾‹ãˆã°ã€ã¾ãš Asana ã‚„ Jira ã‹ã‚‰ãƒã‚±ãƒƒãƒˆã‚’å–å¾—ã—ã€é¸æŠå¾Œã« Github API ã‚’ä½¿ã£ã¦ãƒ–ãƒ©ãƒ³ãƒã‚’æ¤œç´¢ã—ã€Github Action ã‚’ãƒˆãƒªã‚¬ãƒ¼ã—ã¾ã™ã€‚æœ€å¾Œã« Slack ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€šçŸ¥ã—ã¾ã™ã€‚

#### Step 1. Google Apps Script Web App ãƒ•ã‚©ãƒ¼ãƒ ã®ä½œæˆ

[Google Apps Script](https://script.google.com/home){:target="_blank"} ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

![](/assets/4cb4437818f2/1*T3if7Dfo0iJaa4N5VZyA1Q.png)

#### Step 2. ãƒ•ã‚©ãƒ¼ãƒ å†…å®¹ã¨ GAS ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä½œæˆ

HTMLã‚„CSSã‚’æ›¸ãã®ãŒä¹…ã—ã¶ã‚Šã§ã€è‡ªåˆ†ã§ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ãƒ‡ã‚¶ã‚¤ãƒ³ã™ã‚‹ã®ã‚‚é¢å€’ãªã®ã§ã€ChatGPTã«å°‘ã—ãƒ‡ã‚¶ã‚¤ãƒ³ã•ã‚ŒãŸHTMLãƒ•ã‚©ãƒ¼ãƒ ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œã£ã¦ã‚‚ã‚‰ã„ã¾ã—ãŸã€‚

![](/assets/4cb4437818f2/1*IPv0afE5FAFj40F22s8Umg.png)

![](/assets/4cb4437818f2/1*F_HrfV_k16g_ojm1WIDDuA.png)

GAS ã®å·¦å´ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã§ã€Œ+ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«åã«ã€Œ`Form.html`ã€ã‚’å…¥åŠ›ã—ã¦ã€GPT ãŒç”Ÿæˆã—ãŸ HTML ãƒ•ã‚©ãƒ¼ãƒ ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå†…å®¹ã‚’è²¼ã‚Šä»˜ã‘ã¾ã™ã€‚

`Form.htmlï¼š`

```xml
<!--HTML & Style Gen by ChatGPT 4o-->
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><?=title?></title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f7f7f7;
    }
    .form-container {
      max-width: 600px;
      margin: auto;
      padding: 20px;
      background-color: #ffffff;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .form-container h2 {
      margin-bottom: 20px;
      color: #333333;
    }
    .form-group {
      margin-bottom: 15px;
    }
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #555555;
    }
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 95%;
      padding: 10px;
      border: 1px solid #cccccc;
      border-radius: 4px;
      font-size: 16px;
    }
    .form-group input[type="radio"] {
      width: auto;
      margin-right: 10px;
    }
    .form-group .radio-label {
      display: inline-block;
      margin-right: 20px;
    }
    .form-group button {
      background-color: #4CAF50;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
    }
    .form-group button:hover {
      background-color: #45a049;
    }
    .message {
      margin-top: 20px;
      padding: 15px;
      border-radius: 5px;
      font-size: 1em;
      text-align: center;
    }
    .message.success {
      background-color: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    .message.error {
      background-color: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div class="form-container">
    <h2><?=title?></h2>
    <form id="myForm">
      <div id="message-block" class="hidden"></div>
      <div class="form-group">
        <label for="email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼š</label>
        <input type="email" value="<?=email?>" readonly/>
      </div>
      <div class="form-group">
        <label for="buildNumber">ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ï¼š</label>
        <input type="number" value="<?=buildNumber?>"/>
      </div>
      <div class="form-group">
        <label for="branch">ãƒ¬ãƒ“ãƒ¥ãƒ¼ä¸­ã®PRï¼š</label>
        <select id="branch" name="branch">
          <option>é¸æŠã—ã¦ãã ã•ã„</option>
          <? pullRequests.forEach(pullRequest => { ?>
            <option value="<?=pullRequest.head.ref?>">[<?=pullRequest.state?>] <?=pullRequest.title?></option>
          <? }); ?>
        </select>
      </div>
      <div class="form-group">
        <label for="message">æ›´æ–°å†…å®¹ï¼š</label>
        <textarea id="message" name="message" rows="4" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"></textarea>
      </div>
      <div class="form-group">
        <button type="submit">é€ä¿¡</button>
      </div>
    </form>
  </div>
  <script>
    function displayMessage(ok, message) {
      const messageBlock = document.getElementById('message-block');
      messageBlock.className = ok ? 'message success' : 'message error';
      messageBlock.innerHTML = message;
      messageBlock.classList.remove('hidden');
    }
    
    document.getElementById("myForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const formData = new FormData(this);
      const formObject = Object.fromEntries(formData);
      google.script.run.withSuccessHandler((response) => {
        displayMessage(response.ok, response.message);
      }).processForm(formObject);
    });
  </script>
</body>
</html>
```

ãƒ•ã‚©ãƒ¼ãƒ ã®å†…å®¹ã¯å¿…è¦ã«å¿œã˜ã¦è‡ªç”±ã«èª¿æ•´ã§ãã¾ã™ã€‚

`ã‚³ãƒ¼ãƒ‰.gsï¼š`

```javascript
function doGet(e) {
  // å·¦å´ã®ãƒ•ã‚¡ã‚¤ãƒ« Form.html ã«å¯¾å¿œ
  const htmlTemplate = HtmlService.createTemplateFromFile('Form');
  
  const email = Session.getActiveUser().getEmail();
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—ã€å®Ÿè¡Œæ¨©é™ï¼šã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é™ã‚‹
  
  const title = "App CD ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ•ã‚©ãƒ¼ãƒ ";
  
  const buildNumber = genBuildNumber();

  htmlTemplate.email = email;
  htmlTemplate.title = title;
  htmlTemplate.pullRequests = []; // æ¬¡ã¯ Github ã¨é€£æº...
  htmlTemplate.buildNumber = buildNumber;

  const html = htmlTemplate.evaluate();
  html.setTitle(title);
  //html.setWidth(600) // ãƒšãƒ¼ã‚¸å¹…ã®è¨­å®š

  return html
}

function processForm(object) {
  return {"ok": true, "message": "ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒæ­£å¸¸ã«é€ä¿¡ã•ã‚Œã¾ã—ãŸï¼"};
}

function genBuildNumber() {
  const now = new Date();
  const formattedDate = Utilities.formatDate(now, "Asia/Taipei", "yyyyMMddHHmmss");
  const milliseconds = now.getMilliseconds().toString().padStart(3, '0'); // ãƒŸãƒªç§’ã‚’3æ¡ã«å›ºå®š
  return `${formattedDate}${milliseconds}`; 
}
```

ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã¯ã€ã¾ãšãƒ•ã‚©ãƒ¼ãƒ ã®GUIã‚’å®Œæˆã•ã›ã€æ¬¡ã«GitHub APIã‚’æ¥ç¶šã—ã¦PRã®ãƒ–ãƒ©ãƒ³ãƒãƒªã‚¹ãƒˆã‚’å–å¾—ã—ã¾ã™ã€‚

![](/assets/4cb4437818f2/1*RN9ftVBdgCA-IL8ra9jvTg.png)

#### Step 2. Google Apps Script Web App ãƒ•ã‚©ãƒ¼ãƒ ã®ãƒ‡ãƒ—ãƒ­ã‚¤

ã¾ãšã¯å…ˆã»ã©ã®å†…å®¹ã‚’ä¸€åº¦ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ã€çµæœã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚

GAS ã®å³ä¸Šã§ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€->ã€Œæ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤ã€->ã€Œã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã€ã‚’é¸æŠï¼š

![](/assets/4cb4437818f2/1*ouVO18FtOcX8vdeGCEtwCw.png)

![](/assets/4cb4437818f2/1*4BuEtIA4H_-Q9WALonYxYg.png)

![](/assets/4cb4437818f2/1*JagpVPTGD-W0lhIJ5nrRew.png)

å®Ÿè¡Œæ¨©é™ã¨ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã¯ãã‚Œãã‚Œä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã§ãã¾ã™ï¼š

**å®Ÿè¡Œè€…ï¼š**

- `çµ±ä¸€ã¯ã‚ãªãŸã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚`

- ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã®åˆ©ç”¨è€…ã¯ã€ç¾åœ¨ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¨©é™ã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

**èª°ãŒã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã‹ï¼š**

- ç§ã ã‘ã§ã™

- **XXX åŒã˜çµ„ç¹”å†…ã®å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼** `åŒã˜çµ„ç¹”ã‹ã¤ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã®Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã€‚`

- ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ã™ã¹ã¦ã® Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ `ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯èª°ã§ã‚‚ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã§ã™ã€‚`

- ã™ã¹ã¦ã®äººãŒ `Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ­ã‚°ã‚¤ãƒ³ä¸è¦ã€èª°ã§ã‚‚å…¬é–‹ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã€‚`

> *ã€Œã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼šXXX åŒã˜çµ„ç¹”å†…ã®ã™ã¹ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€ï¼‹ã€Œå®Ÿè¡Œè€…ï¼šã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€ã‚’é¸æŠã™ã‚‹ã“ã¨ã§ã€**çµ„ç¹”ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®äººã ã‘ãŒä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«è‡ªå‹•ã§åˆ¶é™**ã•ã‚Œã€ã‹ã¤è‡ªåˆ†ã®æ¨©é™ã§å®Ÿè¡Œã•ã‚Œã¾ã™ï¼*

> *ã¨ã¦ã‚‚ä¾¿åˆ©ãªæ¨©é™ç®¡ç†æ©Ÿèƒ½ã§ã™ï¼*

å³ä¸‹ã®ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚

![](/assets/4cb4437818f2/1*dvyqYb5kcta402j3RUYJog.png)

ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®URLã¯ã€Web Appã®ã‚¢ã‚¯ã‚»ã‚¹URLã§ã™ã€‚

```bash
https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec
```

> *URLãŒé•·ãã¦è¦‹ãŸç›®ãŒæ‚ªã„ã§ã™ãŒã€ä»•æ–¹ãªãè‡ªåˆ†ã§çŸ­ç¸®URLãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦çŸ­ãã—ã¾ã—ãŸã€‚*

**ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒšãƒ¼ã‚¸ã®åŠ¹æœã‚’ç¢ºèªï¼š**

![](/assets/4cb4437818f2/1*jbx4IO4DEhqYfwI_UTQk5Q.png)

**ã“ã“ã§GASã®åˆ¶é™ã‚’2ã¤è¿½åŠ ã§èª¬æ˜ã—ã¾ã™ï¼š**

- GAS Web App ã®ä¸Šéƒ¨è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§éè¡¨ç¤ºã«ã§ãã¾ã›ã‚“

- GAS Web App ã¯ IFrame ã‚’ä½¿ã£ã¦ãƒšãƒ¼ã‚¸ã‚’åŸ‹ã‚è¾¼ã‚“ã§ã„ã‚‹ãŸã‚ã€100% ã®ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ï¼ˆRWDï¼‰ã‚’å®Ÿç¾ã™ã‚‹ã®ã¯é›£ã—ã„ã§ã™ã€‚  
  `.setWidth()` ã§ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®å¹…ã‚’èª¿æ•´ã™ã‚‹ã—ã‹ã‚ã‚Šã¾ã›ã‚“ã€‚

#### Google Apps Script æ‰¿èªè­¦å‘Š

**åˆå›ä½¿ç”¨æ™‚**ã€ã€Œãƒ‡ãƒãƒƒã‚°ã€ã¾ãŸã¯ã€Œå®Ÿè¡Œã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®æ¨©é™è­¦å‘ŠãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ï¼š

![](/assets/4cb4437818f2/1*9q8KZGHER9vdtnbKVVQB9g.png)

![](/assets/4cb4437818f2/1*iWrkqMf8vkEGkiwkI1amIw.jpeg)

å®Ÿè¡Œã—ãŸã„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é¸æŠã—ã€ã€Œã“ã®ã‚¢ãƒ—ãƒªã¯ Google ã«ã‚ˆã‚‹ç¢ºèªã‚’å—ã‘ã¦ã„ã¾ã›ã‚“ã€ã¨è¡¨ç¤ºã•ã‚ŒãŸå ´åˆã¯ã€ã€Œè©³ç´°ã€->ã€ŒXXXï¼ˆå®‰å…¨ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰ã«ç§»å‹•ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ã€Œè¨±å¯ã€ã‚’é¸æŠã—ã¦ãã ã•ã„ï¼š

![](/assets/4cb4437818f2/1*ucaqLxh-TOgJIaGyqqFd3A.png)

![](/assets/4cb4437818f2/1*l-tma_YICU24goKvZvl7Ww.png)

![](/assets/4cb4437818f2/1*JAs_3__Qt2XeDcQiKEUNhg.png)

GAS ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®æ¨©é™ã«å¤‰æ›´ãŒã‚ã‚‹å ´åˆï¼ˆä¾‹ï¼šGoogle Sheet ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©è¿½åŠ ãªã©ï¼‰ã€å†åº¦èªè¨¼ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚ãã‚Œä»¥å¤–ã¯ã€ä¸€åº¦èªè¨¼ã™ã‚Œã°å†è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚

> *ã‚‚ã—ã€ŒXXXã€ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã€Googleèªè¨¼æ‰‹ç¶šããŒå®Œäº†ã—ã¦ã„ãªã„å ´åˆã¯ã€[ç§ã®æœ€æ–°è¨˜äº‹ã®GCPè¨­å®šã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚](../4273e57e7148/)*

#### Step 3. Github API ã‚’é€£æºã—ã¦PRãƒ–ãƒ©ãƒ³ãƒä¸€è¦§ã‚’å–å¾—ã™ã‚‹

Github API ã«é–¢ã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã‚’æ ¼ç´ã™ã‚‹ãŸã‚ã«ã€æ–°ã—ã `Github.gs` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

`Github.gsï¼š`

```javascript
// SECRET
const githubPersonalAccessToken = ""
// ã‚ãªãŸã®Githubã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¾ãŸã¯çµ„ç¹”å…±æœ‰ã®Githubã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§PATã‚’ä½œæˆã—ã¦ãã ã•ã„
// https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens

// æ–¹æ³• 1: Restful API ã‚¢ã‚¯ã‚»ã‚¹
function githubAPI(method, path, payload = null) {
  try {
    const url = "https://api.github.com"+path;  
    var options = {
      method: method,
      headers: {
        "Accept": "application/vnd.github+json",
        "Authorization": `Bearer ${githubPersonalAccessToken}`,
        "X-GitHub-Api-Version": "2022-11-28"
      }
    };

    if (method.toLowerCase().trim() == "post") {
      options.payload = JSON.stringify(payload);
    }

    const response = UrlFetchApp.fetch(url, options);
    const data = JSON.parse(response.getContentText());
    return data;
  } catch (error) {
    throw error;
  }
}

// æ–¹æ³• 2: GraphQL ã‚¢ã‚¯ã‚»ã‚¹
// Github API ã®ä¸€éƒ¨ã®è©³ç´°ãªã‚¯ã‚¨ãƒªæ©Ÿèƒ½ã¯GraphQL APIã§ã®ã¿æä¾›ã•ã‚Œã¦ã„ã¾ã™
// https://docs.github.com/en/graphql
function githubGraphQL(query, variables) {
  const url = "https://api.github.com/graphql";
  const payload = {
    query: query,
    variables: variables
  };

  const options = {
    method: "post",
    contentType: "application/json",
    headers: {
      "Accept": "application/vnd.github+json",
      "Authorization": `Bearer ${githubPersonalAccessToken}`,
      "X-GitHub-Api-Version": "2022-11-28"
    },
    payload: JSON.stringify(payload)
  };

  try {
    const response = UrlFetchApp.fetch(url, options);
    const data = JSON.parse(response.getContentText());
    return data;
  } catch (error) {
    throw error;
  }
}

// GraphQL ä¾‹:
// const query = `
//   query($owner: String!, $repo: String!) {
//     repository(owner: $owner, name: $repo) {
//       pullRequests(states: OPEN, first: 100, orderBy: { field: CREATED_AT, direction: DESC }) {
//         nodes {
//           title
//           url
//           number
//           createdAt
//           author {
//             login
//           }
//           headRefName
//           baseRefName
//           body
//         }
//         pageInfo {
//           hasNextPage
//           endCursor
//         }
//       }
//     }
//   }
// `;
// const variables = {
//   owner: "swiftlang",
//   repo: "swift"
// };
// const response = githubGraphQL(query, variables);
```

Github API ã«ã¯2ã¤ã®ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚ã²ã¨ã¤ã¯å¾“æ¥ã® Restfulã€ã‚‚ã†ã²ã¨ã¤ã¯ã‚ˆã‚ŠæŸ”è»Ÿãª GraphQLã§ã™ã€‚æœ¬è¨˜äº‹ã§ã¯ Restful ã‚’ä¾‹ã«èª¬æ˜ã—ã¾ã™ã€‚

`ç¨‹å¼ç¢¼.gsï¼š`

```kotlin
function doGet(e) {
  // å·¦å´ã®ãƒ•ã‚¡ã‚¤ãƒ« Form.html ã«å¯¾å¿œ
  const htmlTemplate = HtmlService.createTemplateFromFile('Form');
  
  const email = Session.getActiveUser().getEmail();
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—ã€‚å®Ÿè¡Œè€…ã®æ¨©é™ï¼šã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªåˆ©ç”¨è€…ã®ã¿æœ‰åŠ¹

  const title = "App CD ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ•ã‚©ãƒ¼ãƒ ";
  
  const pullRequests = githubAPI("get", "/repos/swiftlang/swift/pulls");
  // ä¾‹ï¼šhttps://github.com/swiftlang/swift/pulls
  
  const buildNumber = genBuildNumber();

  htmlTemplate.email = email;
  htmlTemplate.title = title;
  htmlTemplate.pullRequests = pullRequests;
  htmlTemplate.buildNumber = buildNumber;

  const html = htmlTemplate.evaluate();
  html.setTitle(title);
  //html.setWidth(600) // ãƒšãƒ¼ã‚¸ã®å¹…ã‚’è¨­å®š

  return html
}

function processForm(object) {
  if (object.buildNumber == "") {
    return {"ok": false, "message": "ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼"};
  }
  if (object.branch == "") {
    return {"ok": false, "message": "ãƒ–ãƒ©ãƒ³ãƒã‚’é¸æŠã—ã¦ãã ã•ã„ï¼"};
  }

  // GitHub Action ã«æ¸¡ã™ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
  const payload = {
    ref: object.branch,
    inputs: {
      buildNumber: object.buildNumber
    }
  };
  
  //  
  try {
    const response = githubAPI("post", "/repos/zhgchgli0718/ios-project-for-github-action-ci-cd-demo/actions/workflows/CD-Job.yml/dispatches", payload);
    // ä¾‹ï¼šhttps://github.com/zhgchgli0718/ios-project-for-github-action-ci-cd-demo/blob/main/.github/workflows/CD-Job.yml

    return {"ok": true, "message": `ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¾ã—ãŸï¼<br/>å¯¾è±¡ãƒ–ãƒ©ãƒ³ãƒï¼š<strong>${object.branch}</strong><br/>ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ï¼š<strong>${object.buildNumber}</strong>`};
  } catch (error) {
    return {"ok": false, "message": "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸï¼š"+error.message};
  }
}
```

`processForm` ãƒ¡ã‚½ãƒƒãƒ‰ã§ã¯ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰ã®è¿”å´å†…å®¹ã‚’å‡¦ç†ã—ã¾ã™ãŒã€ã•ã‚‰ã«å¤šãã®å‡¦ç†ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

#### GAS x Github API x Github Action

ã“ã¡ã‚‰ã¯å¯¾å¿œã™ã‚‹ Github Action ã®è£œè¶³ã§ã™ã€‚

`CD-Job.ymlï¼š`

```yaml
# CD ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°ã‚¸ãƒ§ãƒ–

name: CD-Job

on:
  workflow_dispatch:
    inputs:
      buildNumber: # GAS payload.inputs.xxx ã«å¯¾å¿œ
        description: 'ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·'
        required: false
        type: string
      # ...ãã®ä»–
      # å…¥åŠ›ã‚¿ã‚¤ãƒ—ã¯å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼šhttps://docs.github.com/en/actions/writing-workflows/workflow-syntax-for-github-actions#onworkflow_dispatchinputs
      
jobs:
  some-job:
    runs-on: ubuntu-latest
    steps:
      - name: å…¥åŠ›å€¤ã®è¡¨ç¤º
        run: \\|
          echo "Release Build Number: ${{ github.event.inputs.buildNumber }}"    
```

#### Step 4. Google Apps Script Web App ãƒ•ã‚©ãƒ¼ãƒ ã®å†ãƒ‡ãƒ—ãƒ­ã‚¤

> ***âš ï¸ã”æ³¨æ„ãã ã•ã„ã€GASã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´ã¯å†ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå¿…è¦ã§ã‚ã‚Šã€ãã‚Œã«ã‚ˆã£ã¦å¤‰æ›´ãŒåæ˜ ã•ã‚Œã¾ã™ã€‚âš ï¸***

> ***âš ï¸ã”æ³¨æ„ãã ã•ã„ã€GASã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´ã¯å†ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå¿…è¦ã§ã‚ã‚Šã€ãã®å¾Œã«æœ‰åŠ¹ã«ãªã‚Šã¾ã™ã€‚âš ï¸***

> ***âš ï¸ã”æ³¨æ„ãã ã•ã„ã€GASã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´ã¯å†ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå¿…è¦ã§ã€ãã†ã—ãªã„ã¨åæ˜ ã•ã‚Œã¾ã›ã‚“ã€‚âš ï¸***

GAS å³ä¸Šã®ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€ã‹ã‚‰ã€Œç·¨é›†ã€ã‚’é¸æŠã—ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã€Œæ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½œæˆã€ã‚’é¸ã³ã¾ã™ã€‚

![](/assets/4cb4437818f2/1*ZMAB_m6HmsSsGSqqfZiRpA.png)

![](/assets/4cb4437818f2/1*rUWlfzASAaeXcXUh4LavZw.png)

![](/assets/4cb4437818f2/1*HAr5TZtpnQeG-Ril0Rjf-g.png)

ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€â†’ å®Œäº†ã‚’ã‚¯ãƒªãƒƒã‚¯ã€‚

![](/assets/4cb4437818f2/1*z6lw7R8ivUseSzR4IZgPdg.png)

![](/assets/4cb4437818f2/1*eTdgKGQ1lRM7sCRXQgZ-DA.png)

**å†åº¦ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨ã€å¤‰æ›´å¾Œã®çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š**

![](/assets/4cb4437818f2/1*iI49OJC1uTyMEgzGTBowxQ.png)

> ***âš ï¸ã”æ³¨æ„ãã ã•ã„ã€GASã®ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ãŸå ´åˆã¯ã€å†ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå¿…è¦ã§ã™ã€‚âš ï¸***

> ***âš ï¸ã”æ³¨æ„ãã ã•ã„ã€GAS ã®ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ãŸå ´åˆã¯ã€å†ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãªã„ã¨åæ˜ ã•ã‚Œã¾ã›ã‚“ã€‚âš ï¸***

> ***âš ï¸ã”æ³¨æ„ãã ã•ã„ã€GAS ã®ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ãŸå ´åˆã¯ã€å†åº¦ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãªã„ã¨å¤‰æ›´ãŒåæ˜ ã•ã‚Œã¾ã›ã‚“ã€‚âš ï¸***

### å®Œäº†ï¼ğŸ‰ğŸ‰ğŸ‰

![](/assets/4cb4437818f2/1*pzW-Yki-4HbE2nYXC4q-Aw.png)

![[Demo Web App ãƒ•ã‚©ãƒ¼ãƒ ](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}](/assets/4cb4437818f2/1*9aaNeemezNPRlSgbLFrseA.png)

[Demo Web App Form](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}

ç¾åœ¨ã€ã“ã®ãƒªãƒ³ã‚¯ã‚’çµ„ç¹”å†…ã§ä»–ã®ãƒ¡ãƒ³ãƒãƒ¼ã¨å…±æœ‰ã§ãã¾ã™ã€‚å½¼ã‚‰ã¯ã“ã®ã‚¦ã‚§ãƒ–GUIã‚’ä½¿ã£ã¦ç›´æ¥CI/CDä½œæ¥­ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚

#### æ‹¡å¼µ (1)â€” ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ Slack User ID ã‚’æ¤œç´¢ã—ã€é€²æ—é€šçŸ¥ã®é€ä¿¡ãƒ»æ›´æ–°ã‚’è¡Œã†

å‰æ–‡ã§è¿°ã¹ãŸã‚ˆã†ã«ã€CI/CDã®å®Ÿè¡ŒçŠ¶æ³ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§é€šçŸ¥ã—ãŸã„ãŸã‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæä¾›ã—ãŸãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä½¿ã£ã¦Slackã®ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã‚’å–å¾—ã§ãã¾ã™ã€‚

`Slack.gsï¼š`

```javascript
const slackBotToken = ""
// https://medium.com/zrealm-robotic-process-automation/slack-chatgpt-integration-bd94cc88f9c9

function slackRequest(path, content) {
  const options = {
    method: "post",
    contentType: "application/json",
    headers: {
      Authorization: `Bearer ${slackBotToken}`, // èªè¨¼ã«ãƒœãƒƒãƒˆãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä½¿ç”¨
      'X-Slack-No-Retry': 1
    },
    payload: JSON.stringify(content)
  };

  try {
    const response = UrlFetchApp.fetch("https://slack.com/api/"+path, options);
    const responseData = JSON.parse(response.getContentText());
    if (responseData.ok) {
      return responseData
    } else {
      throw new Error(`Slack: ${responseData.error}`);
    }
  } catch (error) {
    throw error;
  }
}

// ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§Slack UIDã‚’æ¤œç´¢
function getSlackUserId(email) {
  return slackRequest(`users.lookupByEmail?email=${encodeURIComponent(email)}`)?.user?.id;
}

// ç›®æ¨™ã®Slack UIDï¼ˆchannelIDï¼‰ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡
function sendSlackMessage(channelId, ts = null, value)  {
  var content = {
    channel: channelId
  };

  if (ts != null) {
    content.thread_ts = ts;
  }
  
  if (typeof value === "string") {
    content.text = value;
  } else {
    content.blocks = value;
  }
  return slackRequest("chat.postMessage", content);
}

// é€ä¿¡æ¸ˆã¿ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å†…å®¹ã‚’æ›´æ–°
function updateSlackMessage(channelId, ts = null, value)  {
  var content = {
    channel: channelId
  };

  if (ts != null) {
    content.ts = ts;
  }
  
  if (typeof value === "string") {
    content.text = value;
  } else {
    content.blocks = value;
  }
  return slackRequest("chat.update", content);
}
```

Slack API ã®ä½¿ç”¨ã«ã¤ã„ã¦ã¯ [å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://api.slack.com/methods/chat.postMessage){:target="_blank"} ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

**Githun Action YAML ã¯ã“ã® Action ã‚’ä½¿ã£ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¶™ç¶šçš„ã«æ›´æ–°ã—ã€Slack ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã§ãã¾ã™ï¼š**

[![](https://opengraph.githubassets.com/5555fcbf805f8a008fa2b940b89782a63a551ae458330d39dbdf96ee8f309739/slackapi/slack-github-action)](https://github.com/slackapi/slack-github-action){:target="_blank"}

```yaml
# ...
on:
  workflow_dispatch:
    inputs:
      buildNumber: # GAS payload.inputs.xxx ã«å¯¾å¿œ
        description: 'ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·'
        required: false
        type: string
      # ...ãã®ä»–
      SLACK_USER_ID:
        description: 'ã‚¢ã‚¯ã‚·ãƒ§ãƒ³é€šçŸ¥ã‚’å—ã‘å–ã‚‹Slackãƒ¦ãƒ¼ã‚¶ãƒ¼ID'
        type: string
      SLACK_CHANNEL_ID:
        description: 'ã‚¢ã‚¯ã‚·ãƒ§ãƒ³é€šçŸ¥ã‚’å—ã‘å–ã‚‹Slackãƒãƒ£ãƒ³ãƒãƒ«ID'
        type: string
      SLACK_THREAD_TS:
        description: 'Slackãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ts'
        type: string
      
jobs:
  # ã‚¸ãƒ§ãƒ–ã®ä¸€éƒ¨...

  if-deploy-failed-message:
    runs-on: ubuntu-latest
    if: failure()
      - name: slackãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ›´æ–°
        uses: slackapi/slack-github-action@v2.0.0
        with:
            method: chat.update
            token: ${{ secrets.SLACK_BOT_TOKEN }}
            payload: \\|
              channel: ${{ github.event.inputs.SLACK_CHANNEL_ID }}
              ts: ${{ github.event.inputs.SLACK_THREAD_TS }}
              text: "âŒ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°ã‚¿ã‚¹ã‚¯ãŒå¤±æ•—ã—ã¾ã—ãŸã€‚å®Ÿè¡ŒçŠ¶æ³ã‚’ç¢ºèªã™ã‚‹ã‹ã€å¾Œã»ã©å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚\n<${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\\|å®Ÿè¡ŒçŠ¶æ³ã‚’ç¢ºèªã™ã‚‹> cc'ed <@${{ github.event.inputs.SLACK_USER_ID }}>"
```

**åŠ¹æœï¼š**

![](/assets/4cb4437818f2/1*-w5jqjkx6p2alpzlLcz_Nw.png)

> ***Slack App ã®é€£æºè©³ç´°ã¯ã€ä»¥å‰ã®è¨˜äº‹ã‚’ã”å‚ç…§ãã ã•ã„ï¼š[Slack & ChatGPT Integration](../bd94cc88f9c9/) ã€‚***

#### æ‹¡å¼µ (2) â€” Jiraãƒã‚±ãƒƒãƒˆã®æ¤œç´¢

`Jira.gsï¼š`

```javascript
const jiraPersonalAccessToken = ""
// https://confluence.atlassian.com/enterprise/using-personal-access-tokens-1026032365.html

function getJiraTickets() {
  const url = `https://xxx.atlassian.net/rest/api/3/search`;

  // JQLã‚¯ã‚¨ãƒª
  const jql = `project = XXX`;
  const queryParams = {
    jql: jql,
    maxResults: 50, // å¿…è¦ã«å¿œã˜ã¦èª¿æ•´
  };

  const options = {
    method: "get",
    headers: {
      Authorization: "Basic " + jiraPersonalAccessToken,
      "Content-Type": "application/json",
    },
    muteHttpExceptions: true,
  };

  const queryString = Object.keys(queryParams).map(key => `${encodeURIComponent(key)}=${encodeURIComponent(queryParams[key])}`).join("&");
  const response = UrlFetchApp.fetch(url + "?" + queryString + "&fields=", options);
  // ä¸€éƒ¨ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿è¿”ã™ã‚ˆã†æŒ‡å®šå¯èƒ½

  if (response.getResponseCode() === 200) {
    const issues = JSON.parse(response.getContentText()).issues;
    return issues;
  } else {
    Logger.log(`Error: ${response.getResponseCode()} - ${response.getContentText()}`);
    throw new Error("Jiraã®èª²é¡Œå–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");
  }
} 
```

ãã®ä»–ã® Jira API ã®ä½¿ç”¨ã«ã¤ã„ã¦ã¯ã€[å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://developer.atlassian.com/cloud/jira/platform/rest/v3/){:target="_blank"} ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

#### æ‹¡å¼µ (3) â€” Asana ãƒã‚±ãƒƒãƒˆã®æ¤œç´¢

`Asana.gsï¼š`

```kotlin
const asanaPersonalAccessToken = ""
// https://developers.asana.com/docs/personal-access-token

function asanaAPI(endpoint, method = "GET", data = null) {
    var options = {
      "method" : method,
      "contentType" : "application/json",
      "headers": {
          "Authorization":  "Bearer "+asanaPersonalAccessToken
      }
    };

    if (data != null) {
      options["payload"] = JSON.stringify({"data":data});
    }

    const url = "https://app.asana.com/api/1.0"+endpoint;
    const res = UrlFetchApp.fetch(url, options);
    const data = JSON.parse(res.getContentText());
    return data;
}

// ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã®ã‚¿ã‚¹ã‚¯ã‚’æ¤œç´¢
// asanaAPI("/projects/PROJECT_ID/tasks");
```

ãã®ä»–ã® Asana API ã®ä½¿ç”¨æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€[å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://developers.asana.com/reference/gettasksforproject){:target="_blank"} ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

### ã¾ã¨ã‚

è‡ªå‹•åŒ–ã‚„æ¥­å‹™ãƒ»é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©åŒ–ã«æ¬ ã‘ã¦ã„ã‚‹ã®ã¯æŠ€è¡“ã§ã¯ãªãã‚¢ã‚¤ãƒ‡ã‚¢ã§ã™ã€‚ã‚¢ã‚¤ãƒ‡ã‚¢ã•ãˆã‚ã‚Œã°ã€ãã‚Œã‚’å®Ÿç¾ã™ã‚‹é©åˆ‡ãªæŠ€è¡“ã¯å¿…ãšè¦‹ã¤ã‹ã‚Šã¾ã™ã€‚å…±ã«é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼

### 2025/07 æ›´æ–°:

ã“ã®æ©Ÿèƒ½ã¯å®Ÿéš›ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«ã«çµ±åˆã•ã‚Œã¦ã„ã¾ã™ã€‚æœ€æ–°ã®è¨˜äº‹äº‹ä¾‹ã‚’ã”å‚ç…§ãã ã•ã„ï¼šã€Œ[**CI/CD å®Ÿè·µã‚¬ã‚¤ãƒ‰ï¼ˆ4ï¼‰ï¼šGoogle Apps Script Web App ã‚’ä½¿ã£ã¦ GitHub Actions ã¨é€£æºã—ã€ç„¡æ–™ã§ä½¿ã„ã‚„ã™ã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’æ§‹ç¯‰ã™ã‚‹**](../4273e57e7148/)ã€

ã”è³ªå•ã‚„ã”æ„è¦‹ãŒã‚ã‚Šã¾ã—ãŸã‚‰ã€[ã“ã¡ã‚‰ã‹ã‚‰ã”é€£çµ¡ãã ã•ã„](https://www.zhgchg.li/contact){:target="_blank"} ã€‚

*[Post](https://dev.zhgchg.li/%E4%BD%BF%E7%94%A8-google-apps-script-web-app-%E8%A1%A8%E5%96%AE%E4%B8%B2%E6%8E%A5-github-action-ci-cd-%E5%B7%A5%E4%BD%9C-4cb4437818f2){:target="_blank"} Mediumã‹ã‚‰å¤‰æ›ã•ã‚ŒãŸã‚‚ã® by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}.*