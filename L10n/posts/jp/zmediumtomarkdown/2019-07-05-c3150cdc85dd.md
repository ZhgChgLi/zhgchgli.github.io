---
author: ZhgChgLi
categories:
- ZRealmの生活
date: 2019-07-05T17:13:47.487+0000
description: スマートホーム初心者向けにApple HomeKitと小米米家の連携方法を解説。米家スマートカメラとスマートライトの設定手順で簡単導入、快適な生活を実現します。
image:
  path: /assets/c3150cdc85dd/1*Aa9zfAh7xclVOZS0IkcaMQ.jpeg
last_modified_at: 2024-04-13T07:49:52.330+0000
render_with_liquid: false
tags:
- 生活
- 開箱
- 3c
- 米家
- homekit
- japanese
- ai-translation
title: Apple HomeKitと小米米家で始めるスマートホーム｜設定と活用ガイド
---

### スマートホーム初体験 - Apple HomeKit & 小米米家

米家スマートカメラと米家スマートデスクライト、HomeKit設定ガイド

**[2020/04/20]** [**上級編公開**](../99db2a1fbfe5/) **：**
**[経験者の方はこちらへどうぞ&gt;&gt;](../99db2a1fbfe5/)** [**Raspberry PiをHomeBridgeサーバーとして使い、すべてのMi Home家電をHomeKitに連携する方法のデモ**](../99db2a1fbfe5/)

### 雑談：

最近引っ越したばかりです。以前住んでいた場所とは違い、天井はオフィスの軽鉄骨照明で、明るすぎて目が疲れるため、数本の蛍光灯を抜いてやっと目が楽になる状態でした。今住んでいるところは間接照明が設置されており、パソコン作業や読書には少し明るさが足りません。2週間経って目が乾燥しやすく不快に感じています。最初はIKEAで購入しようと思いましたが、光の色や目の保護を考慮し、コスパを比較した結果、以前から使っている小米のスマートカメラも含めて、結局小米のデスクライトを選びました。

### 本篇：

実は購入時にApple HomeKit対応かどうか特に気にしていませんでした。iOS開発者としては失格かもしれませんが、小米が対応しているとは思っていませんでした。

なので、本記事では **Apple HomeKitの使用方法**、**Apple HomeKit非対応のスマートホームをサードパーティでHomeKitに連携する方法**、および **Mi Homeを使ったスマートホーム構築方法（IFTTT連携）** をそれぞれ紹介します。

皆さんは自分のデバイスのニーズに応じて、好きな部分を飛ばしながらご覧ください。

### 購入：

私は合計で2つのデスクライトを購入しました。1つは（Pro）でパソコンデスクでの作業用、もう1つはベッドサイドに置いて読書灯として使っています。

#### [米家デスクライト Pro](https://www.mi.com/tw/mi-adjustable-smart-desk-lamp/){:target="_blank"} ：

![NT$ 1,795 支援米家、Apple HomeKit](/assets/c3150cdc85dd/1*Aa9zfAh7xclVOZS0IkcaMQ.jpeg)

NT$ 1,795 米家とApple HomeKit対応

#### [米家 LED スマートデスクライト](https://www.mi.com/tw/smartlamp/){:target="_blank"} ：

![NT$ 995 米家のみ対応](/assets/c3150cdc85dd/1*PCaRI8AroRgFELEA1elaiA.jpeg)

NT$ 995 はMi Homeのみ対応しています

詳細は公式サイトをご参照ください。両方のライトはスマート制御、色変更、明るさ調整、目に優しい機能をサポートしています。Pro版はApple HomeKit対応で、三段階の角度調整が可能です。現在の使用感としては、ライト一台の機能としては非常に満足しています。強いて欠点を挙げるとすれば、Pro版の角度調整は台座のみが水平に回転でき、ライト自体は動かせないため、光の角度調整ができない点です。

### 理想的スマートホームの目標：

#### 現在あるデバイス：

1. 米家スマートカメラパンチルト版 1080P（対応：米家）

2. 米家デスクライト Pro（対応：Apple HomeKit、米家）

3. 米家 LED スマートデスクライト（対応：米家）

#### 理想的な目標：

**帰宅時：** プライバシー保護と誤って見守りアラームを作動させないために、カメラを自動でオフにする（米家APPのバグで見守りアラームが設定時間通りにオンオフできない）、パソコンデスクのProライトをオンにする（暗闇で操作したくないため）  
**外出時：** カメラを自動でオンにする（見守りモードをデフォルトで有効にする）、すべての照明をオフにする

#### **本記事の最終成果：**

外出・帰宅時にプッシュ通知でお知らせし、スマホでワンタップ操作をトリガーする（既存のデバイスでは理想的な自動化が難しい）

### スマートホーム設定の道：

#### **Apple HomeKit の使用**

***米家ライト Pro限定！米家ライト Pro！米家ライト Pro！**

これは最も簡単な部分で、すべてネイティブ機能だからです。

![只需四步驟](/assets/c3150cdc85dd/1*pv62RZ_TjL8X6t-gXnwWtQ.jpeg)

わずか4ステップ

1. 家庭APPを見つける（もしなければApp Storeで「家庭」と検索してインストールしてください）

2. ホームアプリを開く

3. 右上の「+」をクリックしてアクセサリを追加します

4. Proランプ底部のHomeKit QRコードをスキャンしてアクセサリに追加するだけです！

![](/assets/c3150cdc85dd/1*0Rm1Ij86bD-fld-N-N1qJw.jpeg)

アクセサリの追加に成功したら、アクセサリを強く押す（3D TOUCH）／長押しして、明るさや色を調整できます。

#### Apple HomeKitに対応していないスマートホームはどうやってサードパーティでHomeKitに連携するの？

以上でHomeKitに対応しているスマートデバイス以外に、HomeKit非対応のデバイスは家庭アプリでの管理が全くできないのでしょうか？  
本章では、非対応のデバイス（カメラ、一般版デスクライト）を「ホーム」アプリに手順を追って追加する方法を解説します！

> **Macのみ、Windowsユーザーは直接米家の章へ進んでください**

> **私のデバイスはMacOS 10.14/iOS 12です**

**[HomeBridge](https://github.com/nfarina/homebridge){:target="_blank"} の使用：**

HomeBridgeはMacコンピュータをブリッジとして使用し、非対応デバイスをHomeKit対応機器としてエミュレートすることで、「ホーム」アプリのアクセサリに追加できます。

![運作比較](/assets/c3150cdc85dd/1*q2ctcxaaxLFExKXd-9NjPg.png)

動作比較

ポイントの一つは、**Macコンピュータを常に起動状態にしておく必要があり、そうしないとブリッジ接続がスムーズに保てない**ことです。一度コンピュータがシャットダウンやスリープ状態になると、HomeKitデバイスの制御ができなくなります。

もちろん、ネット上には自作でラズベリーパイを購入し、ブリッジとして使う方法もありますが、これは高度な技術が必要なため、本記事では紹介しません。

欠点を理解した上で試してみたい場合は、引き続き読み進めるか、次の「米家を直接使う」セクションへ進んでください。

**第一歩：**

[node.js](https://nodejs.org/en/){:target="_blank"} をインストール： [こちらをクリック](https://nodejs.org/dist/v12.6.0/node-v12.6.0.pkg){:target="_blank"} [ダウンロード](https://nodejs.org/dist/v12.6.0/node-v12.6.0.pkg){:target="_blank"} してインストールしてください。

**ステップ2：**

「ターミナル」を開いて入力してください

```bash
sudo npm -v
```

![](/assets/c3150cdc85dd/1*RBRWT93L_abbhzTItL9Mhg.png)

node.jsのnpmパッケージ管理ツールが正しくインストールされているか確認するには、バージョン番号が表示されれば成功です！

**ステップ3：**

npm を使って HomeBridge パッケージをインストールする：

```bash
sudo npm -g install homebridge --unsafe-perm
```

インストールが完了するのを待つと…HomeBridgeツールのインストールが完了です！

前に述べたように「HomeBridgeはMacコンピュータをブリッジとして使い、非対応デバイスをHomeKitデバイスとして模擬する」**実際にはHomeBridgeは単なるプラットフォームであり、各デバイスを追加するには別途HomeBridgeのプラグインを探す必要があります**。

とても見つけやすく、GoogleやGitHubで「mija 製品英語名 homebridge」と検索すれば多くのリソースが見つかります。ここでは私が使っている2つのデバイスのリソースを紹介します：

**1.米家カメラ雲台版リソース： [MijiaCamera](https://github.com/josepramon/homebridge-mijia-camera){:target="_blank"}**

カメラは少し扱いが難しいデバイスなので、時間をかけて調査しまとめました。必要な方の参考になれば幸いです！

まずは「ターミナル」でコマンドを使って、この MijiaCamera npmパッケージをインストールします。

```bash
sudo npm install -g homebridge-mijia-camera
```

インストールが完了したら、カメラのネットワーク **IPアドレス** と **Token** の2つの情報を取得する必要があります。

![](/assets/c3150cdc85dd/1*n0TIhqyCoKZo7--ePZwuLA.jpeg)

米家APPを開く → カメラ → 右上の「…」→ 設定 → ネットワーク情報で、**IPアドレス**を取得！

**Token** 情報は少し面倒で、スマートフォンをMacに接続する必要があります：

![Itunesのインターフェースを開く](/assets/c3150cdc85dd/1*0ewSMEH7K2rzUlUtSB61vw.png)

iTunesのインターフェースを開く

バックアップを選択し、**ローカルバックアップの暗号化はチェックしない**で、「今すぐバックアップ」をクリックしてください。

バックアップが完了したら、[ダウンロード](http://www.imactools.com/iphonebackupviewer/download/mac){:target="_blank"}してバックアップ閲覧ソフト：[iBackupViewer](http://www.imactools.com/iphonebackupviewer/download/mac){:target="_blank"}をインストールしてください。

「iBackupViewer」を開くと、初回起動時にMacの「システム環境設定」-「セキュリティとプライバシー」-「プライバシー」-「＋」から「iBackupViewer」を追加するよう求められます。  
****プライバシーが気になる場合は、ネットワークを切断してこのソフトを使用し、使用後に削除してください***

![](/assets/c3150cdc85dd/1*kEOxJCkOxDRuFfoxumssgA.png)

再度「iBackupViewer」を開き、バックアップファイルの読み込みに成功したら、右上のボタンをクリックして「Tree View」モードに切り替えます。

![](/assets/c3150cdc85dd/1*R4l6tRzDaqtiN7xutPKtQg.png)

左側にはインストールされているすべてのAPPが表示されます。米家のAPP「AppDomain-com.xiaomi.mihome」->「Documents」を見つけてください。

右側のファイルリストから「 **數字_mihome.sqlite」** ファイルを見つけて選択してください

右上の「Export」をクリック -&gt; 「Selected」

先ほどエクスポートしたsqliteファイルを <https://inloop.github.io/sqlite-viewer/>{:target="_blank"} にアップロードして内容を確認してください。

![](/assets/c3150cdc85dd/1*oRK8tHqom2tnR3CE5xz_-w.png)

米家APPのすべてのデバイス情報欄を表示し、右にスクロールして一番端まで移動し、**ZTOKEN**欄を見つけて、ダブルクリックして全選択しコピーします。

最後に <http://aes.online-domain-tools.com/>{:target="_blank"} のサイトを開き、**ZTOKEN** を最終的な **Token** に変換します。

![](/assets/c3150cdc85dd/1*ZXTe6MEFXjYhqtf9uAJWwQ.png)

1. 先ほどコピーした ZTOKEN を「Input Text」に貼り付け、「Hex」を選択します。  
2. Key に「00000000000000000000000000000000」を32個の0で入力し、同じく「Hex」を選択します。  
3. その後、「Decrypt!」を押して変換します。  
4. 全て選択して右下の青い枠をコピーし、空白を取り除くと、目的の **Token** が得られます。

> Token ここでは「miio」を使って直接スニッフィングを試みましたが、どうやら米家カメラのファームウェアが更新されており、この方法でTokenを簡単に取得することはできなくなったようです！

**HomeBridgeに戻る！設定ファイル config.json を編集**

![](/assets/c3150cdc85dd/1*Zh_BWLwMUg5pOxFEVipgiQ.png)

「Finder」->「移動」->「フォルダへ移動」-> 「~/.homebridge」と入力して移動

テキストエディタで「config.json」を開きます。ファイルがない場合は、新しく作成するか、[こちらからダウンロード](https://drive.google.com/file/d/1S67NZwXrVqOpps_Cl9l0494foDaHxuWF/view?usp=sharing){:target="_blank"}して直接配置してください。

```json
{
   "bridge":{
      "name":"Homebridge",
      "username":"CC:22:3D:E3:CE:30",
      "port":51826,
      "pin":"123-45-568"
   },
   "accessories":[
      {
         "accessory":"MijiaCamera",
         "name":"Mi Camera",
         "ip":"",
         "token":""
      }
   ]
}
```

config.jsonに上記の内容を追加し、IPおよびTokenの部分には先ほど取得した情報を入力してください。

この時点で再度「ターミナル」に戻り、以下のコマンドで HomeBridge を起動します。

```bash
sudo homebridge start
```

もし起動後にconfig.jsonの内容を変更した場合は、以下を変更してください：

```bash
sudo homebridge restart
```

再起動

![](/assets/c3150cdc85dd/1*vwCS3QHu285oCrChau9mpw.png)

この時、HomeKitのQRコードが表示され、スキャンしてアクセサリを追加できます（手順は上記のApple HomeKitデバイスの追加方法と同様です）。

![](/assets/c3150cdc85dd/1*CB76x9ryWBve2bssFd0nzA.jpeg)

下記にもステータスメッセージがあります：
[2019–7–4 23:45:03] [Mi Camera] 192.168.0.100 のカメラに接続中…
[2019–7–4 23:45:03] [Mi Camera] 現在の電源状態：オフ

これらの＆が表示され、エラーが出なければ設定は成功です！

一般的によくあるエラーはTokenの誤りです。上記の手順に漏れがないか確認してください。

今すぐ「ホーム」アプリからMi Homeスマートカメラのオンオフができます！

**2.米家 LED スマートデスクライト HomeBridge リソース： [homebridge-yeelight-wifi](https://github.com/vieira/homebridge-yeelight-wifi){:target="_blank"}**

次に、米家LEDスマートデスクライトです。Pro版のようにApple HomeKitをサポートしていないため、やはりHomeBridgeを使って追加します。手順は**IPやTokenを複雑に取得する必要がなく**、カメラに比べて簡単ですが、デスクライト特有の注意点があります。別のYeeLightアプリでペアリングし、ローカルネットワーク制御の設定を有効にする必要があります：

![](/assets/c3150cdc85dd/1*uuaLjWduzC5RrOf-gd2-Jw.jpeg)

この点については、このひどい統合性にどうしても文句を言いたいです。純正のMi Homeアプリではこの設定はできません。なので、App Storeで「 [Yeelight](https://apps.apple.com/tw/app/yeelight/id977125608){:target="_blank"} 」アプリを検索してダウンロード＆インストールしてください。

APPを開く -> 直接米家アカウントでログイン -> デバイスを追加 -> 米家デスクライト -> 指示に従ってデスクライトをYeelight APPに再バインドする

![](/assets/c3150cdc85dd/1*GTcap563FDdC0TsH09hZww.jpeg)

デバイスのバインドが完了したら、「デバイス」ページに戻り -> 「Mi Homeデスクライト」をタップ -> 右下の「△」タブをタップ -> 「ローカルネットワーク制御」をタップして設定画面へ -> ボタンをオンにしてローカルネットワーク制御を許可する

**デスクライトの設定はここまでです。このAPPでデスクライトを操作するか、再度Mi Homeに紐付け直しても構いません。**

**次にHomeBridgeの設定です。同様に「ターミナル」を開き、コマンドで [homebridge-yeelight-wifi](https://github.com/vieira/homebridge-yeelight-wifi){:target="_blank"} npmパッケージをインストールします**

```bash
sudo npm install -g homebridge-yeelight-wifi
```

インストール完了後、前述のカメラと同様に ~/.homebridge フォルダに移動し、config.json を作成または編集します。今回は最後の } の中に以下を追加するだけです。

```json
"platforms": [
   {
         "platform" : "yeelight",
         "name" : "yeelight"
   }
 ]
```

了解しました！

**最後に上述のカメラのconfig.jsonファイルを統合したものは以下の通りです：**

```json
{
 "bridge": {
  "name": "Homebridge",
  "username": "CC:22:3D:E3:CE:30",
  "port": 51826,
  "pin": "123-45-568"
 },

 "accessories": [
  {
   "accessory": "MijiaCamera",
   "name": "Mi Camera",
   "ip": "",
   "token": ""
  }
 ],

 "platforms": [
   {
         "platform" : "yeelight",
         "name" : "yeelight"
   }
 ]
}
```

そして同様に「ターミナル」に戻り：

```bash
sudo homebridge start
```

または

```bash
sudo homebridge restart
```

元々HomeKitに対応していなかった米家のLEDスマートデスクライトも「ホーム」アプリに追加されました！

![](/assets/c3150cdc85dd/1*3jm0Kd4545DcmzNtPY-dXA.jpeg)

しかも同様に色や明るさの調整にも対応しています！

#### HomeKitアクセサリを追加したら、どうやってスマート化する？

すべて設定し、ブリッジ接続が完了したら、「ホーム」アプリを開きます。

![](/assets/c3150cdc85dd/1*s33BtesqfNSUNyyR069m_Q.jpeg)

手順に従ってシーンを追加します。ここでは「帰宅」を例にします：

右上の「+」をタップ -> シーンを追加 -> カスタム -> アクセサリー名を入力（例：帰宅） -> 下の「アクセサリーを追加」をタップ -> 連携済みのHomeKitアクセサリーを選択 -> このシーンでのアクセサリーの状態を設定（カメラ：オフ／デスクライト：オン） -> 「シーンをテスト」をタップして動作確認 -> 右上の「完了」！

これでシーンの設定が完了です〜この時、ホーム画面でシーンをタップすると、中のすべてのアクセサリ設定が実行されます！

![](/assets/c3150cdc85dd/1*VSArlFmoFERbjH13Cns5TQ.jpeg)

もう一つの便利な裏技は、コントロールセンターを上にスワイプして、家の形のボタンを直接タップすることで、HomeKitの操作やシーンの実行が素早くできることです（右上でモード切替も可能）。

#### スマートになったけど、自動化はどうするの？

スマート化はすでに実現しています。次は究極の目標を達成したいです。帰宅時に自動でカメラをオフにし、照明を点ける。外出時に自動でカメラをオンにし、照明を消す。

![](/assets/c3150cdc85dd/1*tCpQ3io2Q2DDCVFxJpBm_g.png)

3番目のタブ「自動化」に切り替えると設定できます。申し訳ありませんが、ここには上記のデバイス（iPad/Apple TV/HomePod）で**” [ホームハブ](https://support.apple.com/zh-tw/HT207057){:target="_blank"} ”**として使えるものがないため、この部分は調査していません。

原理は、家に帰ると**「ホームハブ」**であるスマホや時計を感知して正確にトリガーする仕組みのようです！

#### ここでトリッキーな方法を見つけました：（GPS感知）

サードパーティ製のアプリを使って「ホーム」アプリに連携し、自動化設定を追加することで、スマホのGPS位置情報を利用して「自動化」タブの機能制限を回避し自動化が可能になります。

p.s GPSには約100メートルの誤差があります

![](/assets/c3150cdc85dd/1*Rm101LKv29Avb5wv4isg4A.jpeg)

ここで使用しているサードパーティ連携アプリは：[myHome Plus](https://apps.apple.com/us/app/myhome-plus-control-for-nest-wemo-and-homekit/id1050479330){:target="_blank"} です。

ダウンロード＆インストール後にアプリを開く -> 「ホームデータ」へのアクセスを許可 -> 「ホーム」のデータ設定が表示される -> 右上の「設定ボタン」をタップ -> 「マイホーム」を選択して入る
-> 下にスクロールして「Triggers」エリア -> 「Add Trigger」をタップ

![](/assets/c3150cdc85dd/1*Kk6AMnhSYP4sM8JD_66Iow.jpeg)

Trigger タイプで「Location」を選択 -> Name に名前を入力（例：帰宅）-> 「Set Location」をタップして位置エリアを設定 -> 次に REGION STATUS でエリアへの「入る」か「出る」を設定 -> 最後に SCENES で実行したい「シーン」（上で作成したもの）を選択

右上の「完了」を押して保存した後、「ホーム」アプリに戻ると、「オートメーション」タブが開いて利用できるようになります！

![](/assets/c3150cdc85dd/1*SXYVBHk9-pMD8YufRQA4zw.png)

この時、右上の「＋」を選択して「ホーム」アプリで直接自動化スクリプトを追加できます！！

![](/assets/c3150cdc85dd/1*qbtjNCj9mOvjuX7an6rhXw.jpeg)

手順はサードパーティのアプリと同じですが、統合性がさらに優れています！ネイティブの「ホーム」アプリで自動化を設定した後、先ほどサードパーティのアプリで作成したものをスワイプして削除することも可能です。

> ***！！注意してください、少なくとも一つは残してください；そうしないとタブは元のロック状態に戻ります！！***

**Siri 音声コントロールの部分：**

以下で紹介する米家と比べて、HomeKitの統合性は非常に高く、追加設定なしで音声操作やシーンの実行が可能です。

![](/assets/c3150cdc85dd/1*q_ui00ruJl1Fd3_5M-0EhQ.png)

HomeKitの設定紹介はここまでです。次に、Mi Homeのネイティブスマートホームの使い方を説明します。

#### **米家を使ったスマートホーム構築方法：**

ここで困った点があります。米家のデバイス追加で同じ見た目の米家のデスクライトが見つからなかったのですが、その答えは：

![看字就好，這個就是](/assets/c3150cdc85dd/1*xLM5-khndWjvEDdTaFiPfw.png)

文字を読むだけで、これがそれです。

その他のデバイス：カメラやProテーブルランプは公式の説明に従って設定・追加すればよいため、ここでは詳しく説明しません。

**シーン設定：**

![](/assets/c3150cdc85dd/1*leO3Z492pJPh3hEASYr-ww.jpeg)

「ホーム設定方法」-> 「スマート」タブに切り替え -> 「手動実行」を選択 -> 下部でデバイス操作を選択（ネイティブ対応なのでより多くの機能が選べます） -> 他のデバイス（デスクライト）を追加 -> 「保存」で完了！

> *必ず「ある場所を離れる、または到着する」を直接選ぶ理由を尋ねる人もいるでしょうが、この機能はほとんど使えません。アプリは台湾向けにGPSを最適化しておらず誤差があります。また、位置はランドマークにしか設定できません。もし正確な位置があればこの機能を直接使えますが、**この記事の続きは飛ばしても構いません！***

> ***豆知識： [Google Mapsの中国地図はすべて間違っている！](https://buzzorange.com/techorange/2019/05/09/china-map-is-wrong/){:target="_blank"}***

![](/assets/c3150cdc85dd/1*ZjdH5A0QnLq2LNh9lWvCCw.jpeg)

ショートカットスイッチは、「マイ」->「ウィジェット」からウィジェットを設定できます！

これで通知センターからシーンやデバイスを素早く実行できます！

![](/assets/c3150cdc85dd/1*DMmicpzKUIr2xtN8JtP3wQ.png)

[Apple Watch](../a2920e33e73e/) からもデバイスを操作できます！  
**もしウォッチアプリがずっと空白のままの場合は、ウォッチまたはiPhoneのアプリを削除して再インストールしてください。このアプリはバグが多いです。**

#### スマート化はできたけど、自動化はどうするの？

ここでもGPS感知方式を使用しますが、**もし上記で追加したシーンが「ある場所を離れるまたは到着する」場合は、以下の設定はすべて省略できます！**

* * * * *

#### [2019/09/26] iOS ≥ 13 で内蔵のショートカットアプリのみを使って自動化を実現：

[iOS ≥ 13.1で「ショートカット」自動化機能を使い、Mi Homeスマート家電と連携する方法はこちら&gt;&gt;](../21119db777dd/)

* * * * *

> *iOS ≥ 12、iOS < 13 のみ：*

> **内蔵のショートカットアプリとIFTTTの連携**

![](/assets/c3150cdc85dd/1*e9ld6Qn7D64CG-DZA1vAsA.jpeg)

まず「マイ」->「ラボ機能」->「iOSショートカット」->「Mi Homeシーンをショートカットに追加」へ進みます。

システムに標準搭載されている「[ショートカット](https://apps.apple.com/tw/app/%E6%8D%B7%E5%BE%91/id915249334){:target="_blank"}」アプリを開きます（見つからない場合はApp Storeで検索してダウンロードしてください）

![](/assets/c3150cdc85dd/1*-rjtmZ6PHzSzOoBvjJ-FJQ.jpeg)

右上の「+」をクリックしてショートカットを作成 -&gt; 右上の完了ボタンの下にある設定ボタンをクリック -&gt; 名前 -&gt; 名前を入力（英語推奨、後で使用します）

![](/assets/c3150cdc85dd/1*5aUsslYvZvlFiSQYJrGgRw.jpeg)

ショートカット追加ページに戻り -> 下部メニューの検索欄に「米家」と入力 -> 米家で設定した対応するシーンを追加し、「実行時に表示」をオフにする。そうしないと実行後に米家アプリが開きます。

> *もし米家が見つからない場合は、米家APPに戻り、「マイ」->「実験室機能」->「iOSショートカット」->「米家シーンをショートカットに追加」をオン・オフして、「ショートカット」APPを再起動してください。

この時、再びサードパーティのアプリを使います。IFTTTを使ってGPSの入退場をバックグラウンドトリガーに設定します。App Storeで「 [IFTTT](https://apps.apple.com/us/app/ifttt/id660944635){:target="_blank"} 」を検索してダウンロード＆インストールしてください。

![](/assets/c3150cdc85dd/1*5tXhFP4uT1ySSFAZnnDQGw.jpeg)

IFTTTを開き、アカウントにログインした後、「My Applets」タブに切り替え、右上の「+」をタップして追加-&gt;  
「+this」をタップ-&gt; 「Location」を検索-&gt; 入るか出るかを選択

![](/assets/c3150cdc85dd/1*2vs32eIxtEmvqzxOsDLGEw.jpeg)

位置を設定 -> 「Create trigger」をクリックして確定 -> 次に下の「+that」をタップ -> 「notification」を検索

![](/assets/c3150cdc85dd/1*bVmWLH5tUcko5eeOmnR3kQ.jpeg)

「IFTTTアプリからリッチ通知を送信する」を選択：

Title = 通知タイトル , Message = 通知内容

リンクURLを入力してください：shortcuts://run-shortcut?name= ***ショートカット名***

だからショートカット名はできるだけ英語にした方がいいです。

-> 「Create action」をクリック -> 「Edit title」をクリックして名前を設定できます

-> 「完了」保存が完了しました！

**次回設定したエリアの出入り時に通知が届きます（約100メートルの誤差範囲があります）。通知をタップすると、自動的にMi Homeのシーンが実行されます！**

![通知をタップするとバックグラウンドでシーンが自動実行されます](/assets/c3150cdc85dd/1*a9zXd_JSpz9IKInJlPoJ1w.png)

通知をタップすると、バックグラウンドでシーンが自動実行されます。

**Siri 音声コントロールの部分：**

米家はAppleの標準アプリではないため、Siri音声操作をサポートするには別途設定が必要です：

![](/assets/c3150cdc85dd/1*lyzEU2cKxafbnXkWnR7ltg.jpeg)

「スマート」タブ -> 「Siriに追加」-> 「対象のシーン」を選択し、「Siriに追加」を押す

-> 赤い録音ボタンを押してコマンドを録音する（例：電気を消す） -> 完了！

Siriで直接シーンを呼び出して操作できます！

### まとめ

上記の多くの設定手順をまとめると、以下のようになります：

良い体験を求めるなら、HomeKitロゴの付いた家電を高額で購入する必要があります（そうすればMacでHomeBridgeを常時起動する必要がなく、Apple純正の「ホーム」機能と完璧に連携できます）。さらに、HomePodやApple TV、iPadを家庭のハブとして購入する必要があります。HomeKit対応家電も家庭ハブもどちらも安くはありません！

技術力がある場合は、サードパーティのスマートデバイス（例：Mi Home）とラズベリーパイを使ってHomeBridgeを構築することを検討してください。

もし私のような普通の人であれば、やはり米家を直接使うのが一番手軽で便利です。現在の使い方は、帰宅や外出時に通知センターのウィジェットからシーン操作を実行しています。ショートカットAPPとIFTTTの連携は通知リマインダーとしてのみ使っており、忘れがちな時のための補助です。

現時の体験は理想の目標には達していませんが、**「スマートホーム」**に一歩近づきました！

### 上級編

[**Raspberry PiをHomeBridgeサーバーとして使用し、すべてのMi Home家電をHomeKitに接続する方法のデモ**](../99db2a1fbfe5/)

### 関連記事

1. [小米スマートホーム新規購入（AIスピーカー、温湿度センサー、体重計2、DCインバーター扇風機）](../bcff7c157941/)

2. [iOS ≥ 13.1で「ショートカット」自動化機能を使い、Mi Homeスマート家電を連携（iOS ≥ 13.1内蔵のショートカットAPPで自動化操作を直接実行）](../21119db777dd/)

3. [米家 APP / 小愛音箱の地域問題](../94a4020edb82/)

ご質問やご意見がありましたら、[こちらからご連絡ください](https://www.zhgchg.li/contact){:target="_blank"} 。

*[Post](https://medium.com/zrealm-life/%E6%99%BA%E6%85%A7%E5%AE%B6%E5%B1%85%E5%88%9D%E9%AB%94%E9%A9%97-apple-homekit-%E5%B0%8F%E7%B1%B3%E7%B1%B3%E5%AE%B6-c3150cdc85dd){:target="_blank"} Mediumから[ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}で変換。*