---
author: ZhgChgLi
categories:
- ZRealm Dev.
date: 2025-07-02T12:22:32.788+0000
description: å¸¶æ‚¨å¾é ­äº†è§£ GitHub Actions/Self-hosted Runner é‹ä½œæ–¹å¼èˆ‡æ‰‹æŠŠæ‰‹ä½¿ç”¨æ•™å­¸ã€‚
image:
  path: /assets/404bd5c70040/1*_vGYh_XSI3ZDbdeT8xCihA.jpeg
last_modified_at: 2025-07-12T14:49:01.276+0000
render_with_liquid: false
tags:
- ios-app-development
- cicd
- github-actions
- github
- self-hosted
title: CI/CD å¯¦æˆ°æŒ‡å—ï¼ˆäºŒï¼‰ï¼šGitHub Actions èˆ‡ Self-hosted Runner ä½¿ç”¨èˆ‡å»ºç½®å¤§å…¨
---

### CI/CD å¯¦æˆ°æŒ‡å—ï¼ˆäºŒï¼‰ï¼šGitHub Actions èˆ‡ Self\-hosted Runner ä½¿ç”¨èˆ‡å»ºç½®å¤§å…¨

å¸¶æ‚¨å¾é ­äº†è§£ GitHub Actions/Self\-hosted Runner é‹ä½œæ–¹å¼èˆ‡æ‰‹æŠŠæ‰‹ä½¿ç”¨æ•™å­¸ã€‚



![Photo by [Dan Taylor](https://unsplash.com/@theoneandonlydantaylor?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash){:target="_blank"}](/assets/404bd5c70040/1*_vGYh_XSI3ZDbdeT8xCihA.jpeg)

Photo by [Dan Taylor](https://unsplash.com/@theoneandonlydantaylor?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash){:target="_blank"}
#### å‰è¨€

å‰ç¯‡ã€Œ [**CI/CD å¯¦æˆ°æŒ‡å—ï¼ˆä¸€ï¼‰ï¼šCI/CD æ˜¯ä»€éº¼ï¼Ÿå¦‚ä½•é€é CI/CD æ‰“é€ ç©©å®šé«˜æ•ˆçš„é–‹ç™¼åœ˜éšŠï¼Ÿå·¥å…·é¸æ“‡ï¼Ÿ**](../c008a9e8ceca/) ã€æˆ‘å€‘ä»‹ç´¹äº† CI/CD æ˜¯ä»€éº¼ï¼Ÿèƒ½å¸¶ä¾†å“ªäº›æ•ˆç›Šèˆ‡å·¥å…·çš„é¸æ“‡ï¼Œ **é€™ç¯‡å°‡è‘—é‡åœ¨ GitHub Actions, Self\-hosted Runner çš„æ¶æ§‹èˆ‡ä½¿ç”¨ä»‹ç´¹** ï¼Œä¸¦æ‰‹æŠŠæ‰‹ä¸€èµ·å»ºç«‹å¹¾å€‹æœ‰è¶£çš„è‡ªå‹•åŒ–å·¥ä½œæµç¨‹ï¼Œå¸¶æ‚¨æ…¢æ…¢ä¸Šæ‰‹ã€‚
### GitHub Actions æ¶æ§‹æµç¨‹åœ–

åœ¨é–‹å§‹ä¹‹å‰æˆ‘å€‘å…ˆä¾†ç¢ºå®šä¸€ä¸‹ GitHub Actions çš„é‹ä½œæ¶æ§‹æµç¨‹é—œä¿‚èˆ‡è·è²¬ã€‚


![](/assets/404bd5c70040/1*iacfyTX_b3YTSzMcn2ldjw.png)

#### **GitHub Repo**
- åœ¨ GitHub Actions çš„ä¸–ç•Œè£¡ï¼Œæ‰€æœ‰ Actions \(Workflow YAML æª”æ¡ˆ\) éƒ½è¦å­˜æ”¾åœ¨æŸå€‹ Git Repo ä¹‹ä¸­ \( `REPO/.github/workflows/` \)

#### GitHub Repo â€”Actions Secrets

Repo â†’ Settings â†’ Secrets and variables â†’ Actions â†’ Secretsã€‚
- å­˜æ”¾ Actions æ­¥é©Ÿä¸­æœƒç”¨åˆ°çš„ Secret Key, Token
e\.g\. Slack Bot Tokenã€Apple Store Connect API \.p8 Key
- **Secrets å…§å®¹ç„¡æ³•åœ¨ Action Log ä¸­æŸ¥çœ‹ï¼Œæœƒè‡ªå‹•ç”¨ \* \* \* \* éš±è”½**
- Secrets å…§å®¹ç„¡æ³•æŸ¥çœ‹ã€ç·¨è¼¯ï¼Œåªèƒ½è¦†è“‹
- Secrets **ç›®å‰åªæ”¯æ´ç´”æ–‡å­—å…§å®¹ï¼Œç„¡æ³•ä¸Šå‚³æª”æ¡ˆ** 
**\-** å¦‚æœæ˜¯äºŒé€²åˆ¶çš„é‡‘è¦è«‹åƒè€ƒ [å®˜æ–¹æ­¥é©Ÿä½¿ç”¨ Base64 ç·¨ç¢¼è½‰æ›å¾Œå„²å­˜](https://docs.github.com/en/actions/how-tos/security-for-github-actions/security-guides/using-secrets-in-github-actions#storing-base64-binary-blobs-as-secrets){:target="_blank"} ã€‚
\- iOS é–‹ç™¼æ†‘è­‰å„²å­˜æ–¹å¼å¯åƒè€ƒå®˜æ–¹æ•™å­¸ï¼š [Installing an Apple certificate on macOS runners for Xcode development](https://docs.github.com/en/actions/how-tos/use-cases-and-examples/deploying/installing-an-apple-certificate-on-macos-runners-for-xcode-development){:target="_blank"}
- å¯ä»¥å„²å­˜çµ„ç¹”å±¤ç´šçš„ Secretsï¼Œè·¨ Repo å…±äº«

#### GitHub Repo â€” Actions Variables

Repo â†’ Settings â†’ Secrets and variables â†’ Actions â†’ Variablesã€‚
- å­˜æ”¾ Actions æ­¥é©Ÿä¸­å¸¸ç”¨åˆ°çš„è®Šæ•¸
e\.g\. æ¨¡æ“¬å™¨ iOS ç‰ˆæœ¬ã€å·¥ä½œç›®éŒ„
- Variables å…§å®¹å¯ä»¥æŸ¥çœ‹ã€ç·¨è¼¯
- Variables å…§å®¹å¯ä»¥è¼¸å‡ºåœ¨ Action Log ä¸­
- Variables åªæ”¯æ´ç´”æ–‡å­—ï¼Œä¹Ÿå¯å­˜æ”¾ json å­—ä¸²ç„¶å¾Œè‡ªå·±è§£æä½¿ç”¨
- å¯ä»¥å„²å­˜çµ„ç¹”å±¤ç´šçš„ Variablesï¼Œè·¨ Repo å…±äº«

#### GitHub Actions â€” Trigger
- **Github Action ä¸­æœ€é‡è¦çš„èµ·å§‹é» â€” è§¸ç™¼äº‹ä»¶\(æ¢ä»¶\)**
- ç¬¦åˆè§¸ç™¼äº‹ä»¶çš„ GitHub Actions æ‰æœƒè§¸ç™¼åŸ·è¡Œ
- å®Œæ•´äº‹ä»¶åˆ—è¡¨å¯ [åƒè€ƒå®˜æ–¹æ–‡ä»¶](https://docs.github.com/en/actions/reference/events-that-trigger-workflows){:target="_blank"}
- åŸºæœ¬ä¸Šæ¶µè“‹äº†æ‰€æœ‰ CI/CDã€è‡ªå‹•åŒ–æœƒé‡åˆ°çš„äº‹ä»¶å ´æ™¯ã€‚
ä½† **å¦‚æœæœ‰ç‰¹æ®Šå ´æ™¯æ²’æœ‰äº‹ä»¶ï¼Œé‚£å°±åªèƒ½ç”¨å…¶ä»–äº‹ä»¶\+åœ¨ Job ä¸­åˆ¤æ–·çµ„åˆæˆ–æ˜¯ç”¨ Schedule æ’ç¨‹æ‰‹å‹•æª¢æŸ¥äº†** ã€‚
e\.g\. ä¾‹å¦‚æ²’æœ‰ PR Merged äº‹ä»¶ï¼Œå°±åªèƒ½ç”¨ `pull_request: closed` \+ Job `if: github.event.pull_request.merged == true` é”æˆ


**å¸¸ç”¨äº‹ä»¶ï¼š**
- `schedule` \(cron\)ï¼šæ’ç¨‹å®šæ™‚åŸ·è¡Œ\(åŒ crontab\)
å¯ä»¥ç”¨ä¾†åšè‡ªå‹•åŒ–ï¼šå®šæ™‚æª¢æŸ¥ PRã€å®šæ™‚æ‰“åŒ…ã€å®šæ™‚åŸ·è¡Œè‡ªå‹•åŒ–è…³æœ¬
**çµ±ä¸€éƒ½åœ¨ main / develop \(Default Branch\) åŸ·è¡Œã€‚**
- `pull_request:` ï¼šPR ç›¸é—œäº‹ä»¶
ç•¶ PR é–‹å•Ÿæ™‚ã€PR Assign æ™‚ã€åŠ  Label æ™‚ã€æœ‰æ–° Push Commit æ™‚â€¦ç­‰ç­‰
- `issues` ã€ `issue_comment` ï¼šIssue ç›¸é—œäº‹ä»¶
ç•¶ Issue é–‹å•Ÿæ™‚ã€æœ‰æ–°ç•™è¨€æ™‚â€¦ç­‰ç­‰
- `workflow_dispatch` ï¼šæ‰‹å‹•è§¸ç™¼ï¼›å¯ä»¥è¨­å®šéœ€è¦æä¾›çš„æ¬„ä½ï¼ŒGitHub Actions æä¾›ç°¡æ˜“çš„è¡¨å–®è®“ä½¿ç”¨è€…å¯ä»¥å¡«å¯«è³‡è¨Šã€‚
e\.g\.:



![](/assets/404bd5c70040/1*XogIJsCbrNPerWBto_PG8w.png)

- `workflow_call` ï¼šè§¸ç™¼å¦ä¸€å€‹ Action\(Workflow\) åŸ·è¡Œä»»å‹™ã€‚
- `workflow_run` ï¼šç•¶åˆ¥çš„ Action\(Workflow\) åŸ·è¡Œä»»å‹™ï¼Œè§¸ç™¼åŸ·è¡Œæ­¤ä»»å‹™ã€‚



> _æ›´å¤šäº‹ä»¶é¡å‹ã€è¨­å®šç´°ç¯€è«‹ [åƒè€ƒå®˜æ–¹æ–‡ä»¶](https://docs.github.com/en/actions/reference/events-that-trigger-workflows){:target="_blank"} ã€‚_ 




#### **GitHub Actions â€” Workflow**
- a\.k\.a Action
- ä½¿ç”¨ YAML æ’°å¯« \.yaml æª”æ¡ˆï¼Œæª”æ¡ˆçµ±ä¸€æ”¾ç½®åœ¨ `REPO/.github/workflows/` ä¹‹ä¸‹
- **ä»¥ä¸»åˆ†æ”¯å…§çš„ Workflow YAML æª”æ¡ˆç‚ºä¸»** 
å¦‚æœåœ¨å…¶ä»–åˆ†æ”¯çœ‹ä¸åˆ°æ­£åœ¨é–‹ç™¼çš„ Action æˆ–åŸ·è¡Œä¸Šæœ‰èª¤ï¼Œå¯ä»¥å…ˆ Merge å›ä¸»åˆ†æ”¯çœ‹çœ‹ã€‚
- GitHub Actions ä¸­çš„æœ€åŸºç¤å–®ä½ï¼Œæ¯å€‹ Workflow å°±ä»£è¡¨ä¸€é … CI/CD æˆ–è‡ªå‹•åŒ–æ“ä½œ
- Workflow å¯ä»¥å‘¼å«åˆ¥çš„ Workflow åŸ·è¡Œä»»å‹™
\(å¯ä»¥åˆ©ç”¨é€™å€‹ç‰¹æ€§æ‹†å‡ºæ ¸å¿ƒ Workflow å’Œå‘¼å«çš„ Workflow\)
- ç•¶ä¸­æœƒå®šç¾©ä»»å‹™åç¨±ã€åŸ·è¡Œç­–ç•¥ã€è§¸ç™¼äº‹ä»¶ã€ä»»å‹™å·¥ä½œâ€¦ç­‰ç­‰æ‰€æœ‰ Action ç›¸é—œè¨­å®š
- ç›®å‰æª”æ¡ˆçµæ§‹ä¸æ”¯æ´å­ç›®éŒ„
- Action å®Œå…¨å…è²» \(Public and Private Repo\)

#### GitHub Actions â€” Workflow â€” Job
- GitHub Actions ä¸­çš„åŸ·è¡Œå–®ä½
- å®šç¾© Workflow ä¸­çš„ä»»å‹™å·¥ä½œæœ‰å“ªäº›
- æ¯å€‹ Workflow å¯ä»¥æœ‰å¤šå€‹ Jobs
- æ¯å€‹ Job éœ€è¦æŒ‡å®šä½¿ç”¨å“ªå€‹ Runner Labelï¼ŒåŸ·è¡Œçš„æ™‚å€™æœƒä½¿ç”¨å°æ‡‰çš„ Runner æ©Ÿå™¨ä¾†åŸ·è¡Œä»»å‹™
- **å¤šå€‹ Jobs æ˜¯ä¸¦ç™¼åŸ·è¡Œ** \(å¦‚æœ‰é †åºå¯ä»¥ç”¨ `needs` ç´„æŸ\)
- **æ¯å€‹ Job æ‡‰è©²è¦–ç‚ºç¨ç«‹åŸ·è¡Œå€‹é«”\(æ¯å€‹éƒ½è¦ç•¶æˆæ˜¯ Sandbox\)** ï¼ŒJob çµæŸå¾Œå¦‚æœæœ‰ç”¢å‡ºè³‡æºæª”æ¡ˆè¦çµ¦å¾ŒçºŒå…¶ä»– Job/Workflow ä½¿ç”¨ï¼Œéœ€è¦ Upload Artifacts æˆ–åœ¨ self\-hosted ç§»å‹•åˆ°å…±ç”¨ç”¢å‡ºç›®éŒ„ã€‚
- Job åšå®Œå¯ä»¥ Output å­—ä¸²çµ¦å…¶ä»– Job åƒè€ƒä½¿ç”¨ã€‚
\(ä¾‹å¦‚åŸ·è¡Œçµæœ true or false\)
- æ²’ç‰¹åˆ¥è¨­æµç¨‹æ¢ä»¶çš„è©±ï¼Œå¤šå€‹ Job å¦‚æœå…¶ä¸­æœ‰ Job ç™¼ç”ŸéŒ¯èª¤ï¼Œ **å…¶ä»– Job ä¾ç„¶æœƒç¹¼çºŒåŸ·è¡Œ**

#### GitHub Actions â€” Reuse Workflow/Job
- Workflow å®šç¾© `on: workflow_call` å°±èƒ½å°è£çµ¦å…¶ä»– Workflow ç•¶æˆ Job è¤‡ç”¨
- åŒå€‹çµ„ç¹”ä¸‹å¯ä»¥è·¨ Repo åˆ†äº«ä½¿ç”¨
- å› æ­¤å¯ä»¥æŠŠè·¨ Repo å…±ç”¨çš„ CI/CD å·¥ä½œæ”¾åˆ°å…±äº«çš„ Repo ä¸€èµ·ä½¿ç”¨

#### GitHub Actions â€” Workflow â€” Job â€” Step
- GitHub Actions ä¸­çš„æœ€å°åŸ·è¡Œé …ç›®
- Job ä¸­å¯¦éš›åŸ·è¡Œä»»å‹™çš„ç¨‹å¼
- æ¯å€‹ Job å¯ä»¥æœ‰å¤šå€‹ Steps
- **å¤šå€‹ Steps æ˜¯ç…§é †åºåŸ·è¡Œ**
- Step åšå®Œå¯ä»¥ Output å­—ä¸²çµ¦å¾ŒçºŒ Steps åƒè€ƒä½¿ç”¨ã€‚
- **Step å¯ä»¥ç›´æ¥æ’°å¯« shell script ç¨‹å¼** 
å¯ä»¥å¼•ç”¨ [gh cli](https://cli.github.com/manual/gh){:target="_blank"} ã€ç•¶å‰ç’°å¢ƒè®Šæ•¸\(ä¾‹å¦‚å–å¾— PR ç·¨è™Ÿ\)ï¼Œç›´æ¥åšæƒ³åšçš„äº‹
- æ²’ç‰¹åˆ¥è¨­æµç¨‹æ¢ä»¶çš„è©±ï¼ŒStep å¦‚æœç™¼ç”ŸéŒ¯èª¤ï¼Œ **æœƒç›´æ¥ä¸­æ–·** ï¼Œå¾ŒçºŒçš„ Steps ä¸æœƒåŸ·è¡Œ

#### GitHub Actions â€” Workflow â€” Job â€” Reuse Action Step
- **å¯ä»¥ç›´æ¥å¾©ç”¨ [Marketplace](https://github.com/marketplace?type=actions){:target="_blank"} ä¸Šå„è·¯å¤§ç¥åŒ…å¥½çš„ç¾æœ‰å·¥ä½œæ­¥é©Ÿã€‚** 
ä¾‹å¦‚ï¼š [Comment å…§å®¹åˆ° PR](https://github.com/marketplace/actions/comment-pull-request){:target="_blank"} ã€‚
- ä¹Ÿå¯ä»¥å°‡è‡ªå·±ä¸€ç³»åˆ—çš„å·¥ä½œä»»å‹™ Step æ‰“åŒ…æˆä¸€å€‹ Action GitHub Repo è®“å…¶ä»–å·¥ä½œç›´æ¥å¾©ç”¨
- Public Repo çš„ Action å¯ä»¥ä¸Šæ¶åˆ° Marketplace


**æ‰“åŒ… Action æ”¯æ´ä½¿ç”¨ï¼š**
- **Docker Action** â€” ä»£è¡¨ GitHub Actions æœƒæŠŠç’°å¢ƒè®Šæ•¸å‚³åˆ° Docker å®¹å™¨ä¸­ï¼Œå†çœ‹ä½ è¦æ€éº¼è™•ç†ï¼Œå¯ä»¥æ˜¯ shell scriptã€Javaã€PHPâ€¦etc\.
- **JavaScript/TypeScript Action** â€” ç›´æ¥ä½¿ç”¨ node\.js æ’°å¯« GitHub Actions è™•ç†é‚è¼¯ï¼ŒåŒæ¨£çš„æœƒæŠŠç’°å¢ƒè®Šæ•¸éƒ½å‚³çµ¦ä½ åƒè€ƒä½¿ç”¨ã€‚
e\.g\. [pozil/auto\-assign\-issue](https://github.com/pozil/auto-assign-issue/blob/v2/action.yml){:target="_blank"}
- **Composite \(YAML\) â€”** ç´” YAML æè¿°ä»»å‹™æ­¥é©Ÿ \(åŒ GitHub Actions â€” Workflow â€” Job â€” Step\) å¯ä»¥å®£å‘Šæœ‰å“ªå¯«æ­¥é©Ÿè¦åšæˆ–ç›´æ¥åœ¨ä¸Šé¢å¯« shell scriptã€‚
e\.g\. [ZhgChgLi/ZReviewTender](https://github.com/ZhgChgLi/ZReviewTender/blob/main/action.yml){:target="_blank"}



> _ç¤™æ–¼ç¯‡å¹…ï¼Œæœ¬ç¯‡æ–‡ç« ä¸æœƒä»‹ç´¹å¦‚ä½•æ‰“åŒ… Github Actions Actionï¼Œæœ‰èˆˆè¶£å¯ä»¥åƒè€ƒå®˜æ–¹æ–‡ä»¶ï¼š [tutorials/creating\-a\-composite\-action](https://docs.github.com/en/actions/tutorials/creating-a-composite-action){:target="_blank"} ã€‚_ 




#### GitHub Runner
- GitHub æœƒæ ¹æ“š Runner Label æ´¾ç™¼å°æ‡‰çš„ Job çµ¦ Runner åŸ·è¡Œ
- Runner åªåšç‚ºç›£è½è€…ï¼Œè¼ªè©¢ç›£è½ GitHub æ´¾ç™¼ä»»å‹™
- åªé—œå¿ƒ Job ä¸é—œå¿ƒæ˜¯å“ªå€‹ Action\(Workflow\)
å› æ­¤æœƒå‡ºç¾ Action A çš„ Job\-1 åŸ·è¡Œå®Œï¼Œä¸‹ä¸€å€‹æ› Action B çš„ Job\-1ï¼Œè€Œä¸æ˜¯ Action A çš„ Jobs éƒ½åŸ·è¡Œå®Œæ‰æ› Action Bã€‚
- Runner å¯ä»¥ä½¿ç”¨ GitHub Hosted Runner æˆ– Self\-hosted Runnerã€‚

#### **GitHub Hosted Runner**
- GitHub æä¾›çš„ Runnerï¼Œå¯åƒè€ƒå®˜æ–¹ Repo åˆ—è¡¨ï¼š



[![](https://opengraph.githubassets.com/b479f2537a0d7620cc8bed955bf9331e739ee02383a1715546a26bc35390a494/actions/runner-images)](https://github.com/actions/runner-images){:target="_blank"}



![[2025/06 çš„ Images åˆ—è¡¨](https://github.com/actions/runner-images){:target="_blank"}](/assets/404bd5c70040/1*KtQV4kDCWscEeaZ8jQI8Dg.png)

[2025/06 çš„ Images åˆ—è¡¨](https://github.com/actions/runner-images){:target="_blank"}
- Runner é å…ˆå®‰è£äº†ä»€éº¼å¯ä»¥é»é€²å»æŸ¥çœ‹ï¼š
e\.g\. [macos\-14\-arm64](https://github.com/actions/runner-images/blob/main/images/macos/macos-14-arm64-Readme.md){:target="_blank"}



![[macos\-14\-arm64](https://github.com/actions/runner-images/blob/main/images/macos/macos-14-arm64-Readme.md){:target="_blank"}](/assets/404bd5c70040/1*svXtXH78-TvK1C_XXCyYLA.png)

[macos\-14\-arm64](https://github.com/actions/runner-images/blob/main/images/macos/macos-14-arm64-Readme.md){:target="_blank"}
- iOS é–‹ç™¼å„ªå…ˆä½¿ç”¨ \-arm64 \(Mç³»åˆ—\) è™•ç†å™¨çš„ Runnerï¼Œè·‘èµ·ä¾†æ¯”è¼ƒå¿«
- åªè¦åœ¨ Job `run-on` è²¼ä¸Šè¡¨æ ¼ä¸Šçš„ YAML Labelï¼Œå°±èƒ½ä½¿ç”¨è©² Runner åŸ·è¡Œä»»å‹™
- **Public Repo æ”¶è²»æ–¹å¼: å®Œå…¨å…è²»ç„¡é™ä½¿ç”¨**
- **ï¸** Private Repo å…è²»é¡åº¦:
å…è²»é¡åº¦\(ä¾ç…§å¸³è™Ÿä¸åŒé¡åº¦ä¸åŒï¼Œä»¥ GitHub Free ç‚ºä¾‹\)ï¼š
ç”¨é‡ï¼šæ¯æœˆå…è²» 2,000 åˆ†é˜
å„²å­˜ï¼š500 MB
- **âš ï¸ï¸Private Repo è¨ˆè²»æ–¹å¼:** 
**è¶…éå…è²»é¡åº¦ä¹‹å¾Œé–‹å§‹ç”¨ç”¨é‡è¨ˆè²»\(å¯è¨­ä¸Šé™è·Ÿé€šçŸ¥\)ï¼Œä¾ç…§ Runner æ‰€å±¬çš„æ©Ÿå™¨ä½œæ¥­ç³»çµ±ã€æ ¸å¿ƒä¸åŒï¼Œåƒ¹æ ¼ä¹Ÿä¸åŒï¼š**



![[about\-billing\-for\-github\-actions](https://docs.github.com/en/billing/managing-billing-for-your-products/about-billing-for-github-actions){:target="_blank"}](/assets/404bd5c70040/1*rkhRJN4ZRas_lDOJh-pjkQ.png)

[about\-billing\-for\-github\-actions](https://docs.github.com/en/billing/managing-billing-for-your-products/about-billing-for-github-actions){:target="_blank"}

å¯ä»¥çœ‹åˆ° macOS çš„åƒ¹æ ¼å› ç‚ºè¨­å‚™æˆæœ¬å¾ˆé«˜æ‰€ä»¥è²´ã€‚
- æœ€å¤šä¸¦ç™¼ä»»å‹™æ•¸é™åˆ¶ï¼š



![[usage\-limits\-billing\-and\-administration](https://docs.github.com/en/actions/concepts/overview/usage-limits-billing-and-administration#usage-limits){:target="_blank"}](/assets/404bd5c70040/1*LU3zGSBe57NBVMfDwl0wdQ.png)

[usage\-limits\-billing\-and\-administration](https://docs.github.com/en/actions/concepts/overview/usage-limits-billing-and-administration#usage-limits){:target="_blank"}


> _é€™é‚Šæ‰¯å¤ªå¤šäº†ï¼Œæˆ‘å€‘çš„é‡é»æ˜¯ Self\-hosted Runnerã€‚_ 




#### Self\-hosted Runner on In\-house Server
- å°‡è‡ªå·±çš„æ©Ÿå™¨ä½œç‚º Runner
- **ä¸€å°å¯¦é«”æ©Ÿå™¨å¯ä»¥èµ·å¤šå€‹ Runner ä¸¦ç™¼æ¥ä»»å‹™ä¾†åš**
- **å…è²»ç„¡é™é‡ç„¡é™åˆ¶ä½¿ç”¨** 
åªæœ‰æ©Ÿå™¨è³¼è²·æˆæœ¬ï¼ŒèŠ±ä¸€æ¬¡ä½¿ç”¨åˆ°é£½ï¼
ä»¥ 32G RAM M4 Mini \(=NT$40,900\) è¨ˆç®—ï¼Œå¦‚æœç”¨ GitHub Hosted Runner ä¸€å€‹æœˆè¦èŠ± 500 USDï¼› **è²·ä¸€å°æ¶è¨­å¥½ç”¨è¶…éä¸‰å€‹æœˆå°±å›æœ¬** äº†ï¼
- æ”¯æ´ Windows, macOS, Linux \(x64/ARM/ARM64\)
- **åŒå€‹çµ„ç¹”å¯ä»¥è·¨ Repo å…±äº« Runner**
- **âš ï¸ç›®å‰ï¼šactions/cache, actions/upload\-artifact, actions/download\-artifact éƒ½åªæ”¯æ´ GitHub é›²ç«¯æœå‹™ï¼Œä»£è¡¨é€™äº›å…§å®¹é‚„æ˜¯æœƒä¸Šå‚³åˆ° GitHub ä¼ºæœå™¨ä¸¦è¨ˆç®—å„²å­˜é‡æ”¶è²»ã€‚** 
å¯ä»¥åœ¨è‡ªå·±çš„æ©Ÿå™¨ä¸Šé–‹å…±ç”¨ç›®éŒ„å–ä»£ã€‚
- Self\-hosted Runner ä¹Ÿæ”¯æ´ [Docker, k8s](https://docs.github.com/en/actions/concepts/runners/about-actions-runner-controller){:target="_blank"} åªæ˜¯æˆ‘æ²’ç ”ç©¶ã€‚



> **_æ¶è¨­ Self\-hosted Runner åªéœ€å¹¾æ­¥ \(10 åˆ†é˜å…§è¨­å®šå¥½\) å°±èƒ½ä¸Šç·šé–‹å§‹æ¥ä»»å‹™åŸ·è¡Œ\(æœ¬æ–‡ç¨å¾Œæœƒä»‹ç´¹\)ã€‚_** 




#### GitHub Workflow x Job x Step x Runner æµç¨‹é—œä¿‚åœ–


![](/assets/404bd5c70040/1*WHIVfXdVRoEsdXGfJhu2Rw.png)


é€™é‚Šç”¨ä¸€å¼µåœ–ç¸½çµå·¥ä½œæµç¨‹èˆ‡é—œä¿‚ï¼Œå‡è¨­æˆ‘å€‘æœ‰å…©å€‹ Workflowã€å…©å€‹ Runner:
- CI â€”å‡è¨­ Ræœ‰ 3 å€‹ Jobsï¼Œæ¯å€‹ Job å„æœ‰å¹¾å€‹ Stepsï¼ŒRunner Label\(run\-on\) â€” `self-hosted-app`
- CD â€” æœ‰ 4 å€‹ Jobsï¼Œæ¯å€‹ Job å„æœ‰å¹¾å€‹ Stepsï¼ŒRunner Label\(run\-on\) â€” `self-hosted-app`
- Runner â€” æœ‰ 2 å€‹ï¼ŒRunner Label ä¹Ÿéƒ½æ˜¯â€” `self-hosted-app`


åŒå‰è¿°ï¼ŒRunner è·Ÿ Workflow æ˜¯ä¾ç…§ Runnler Label ä¾†æ´¾ç™¼ã€æ¥æ”¶ä»»å‹™ä¾†åšï¼Œé€™å€‹æ¡ˆä¾‹éƒ½æ˜¯ç”¨åŒå€‹ `self-hosted-app` Runner Labelï¼ŒWorkflow çš„ Jobs é è¨­æ˜¯ä¸¦ç™¼åŸ·è¡Œã€Steps æ˜¯æ¯å€‹ Job çš„å¯¦éš›åŸ·è¡Œå…§å®¹ï¼Œä¸²è¡Œç…§é †åºåŸ·è¡Œï¼ŒSteps éƒ½åŸ·è¡Œå®Œç­‰æ–¼ Job åŸ·è¡Œå®Œç•¢ã€‚


> **_å› æ­¤ Workflow å¯¦éš›åŸ·è¡Œçš„æ™‚é–“è»¸æœƒæ˜¯åœ¨å…©å€‹ Runner ä¹‹é–“ç©¿æ¢­åŸ·è¡Œ Jobï¼Œä¹Ÿæœƒä¸¦ç™¼åŸ·è¡Œã€ç•¶å‰ Job åŸ·è¡Œå®Œä¸‹ä¸€å€‹ä¹Ÿä¸ä¸€å®šæ˜¯æ¥è‘—åŒå€‹ Worflow çš„ä¸‹ä¸€å€‹ Jobã€‚_** 





> _âš ï¸ æ‰€ä»¥æ‰èªªç¢ºä¿æ¯å€‹ Job æ˜¯ç¨ç«‹çš„å¾ˆé‡è¦ \(å°¤å…¶åœ¨ Self\-hosted Runner ç’°å¢ƒä¹‹ä¸‹ï¼ŒJob çµæŸä¹‹å¾Œå¯èƒ½ä¸æœƒæ¸…é™¤çš„å¤ªä¹¾æ·¨ï¼Œæˆ‘å€‘å¯èƒ½æœƒä¸‹æ„è­˜è¦ºå¾—é€™å€‹ Job çš„ç”¢å‡ºï¼Œä¸‹ä¸€å€‹ Job å¯ä»¥æ¥è‘—åšäº‹\)ï¼Œä¸æ‡‰è©²é€™æ¨£ç”¨ã€‚_ 




#### å¦‚æœ Job æœ‰ç”¢å‡ºè¦çµ¦å¾ŒçºŒçš„ Job ä½¿ç”¨:
- **Job Output String** : è¼¸å‡ºç´”æ–‡å­—åˆ°è®Šæ•¸çµ¦å…¶ä»– Job å¼•ç”¨
- **Artifact\-upload/download:** Job çš„ Step æœ€å¾Œä¸€æ­¥å°‡åŸ·è¡Œçµæœä¸Šå‚³åˆ° GitHub Artifactï¼Œå¦ä¸€å€‹ Job çš„ç¬¬ä¸€å€‹ Step ä¸‹è¼‰å›ä¾†ç¹¼çºŒè™•ç†ä½¿ç”¨ã€‚
e\.g\. ä¾‹å¦‚ Job â€” æ‰“åŒ… â†’ å°‡æ‰“åŒ…çµæœ \.ipa å‚³åˆ° **Artifact â†’** Job â€” éƒ¨ç½² â†’ ä¸‹è¼‰å›ä¾† \.ipa â†’ ä¸Šå‚³ App Store éƒ¨ç½²
è¦æ³¨æ„ï¼š **ç›®å‰å°±ç®—æ˜¯ Self\-hosted ä¹Ÿæ˜¯æœƒä¸Š GitHub Artifact é›²å„²å­˜ã€‚**
- **AWS/GCPâ€¦é›²ç«¯å„²å­˜** : åŒä¸Šï¼Œåªæ˜¯æ˜¯ç”¨è‡ªå·±çš„é›²ç«¯å„²å­˜æœå‹™ã€‚
- **\[Self\-hosted Only\] å…±ç”¨ç¡¬ç¢Ÿã€ç›®éŒ„:** Self\-hosted Runner å¦‚æœéƒ½æœ‰æ›è¼‰ä¸€å€‹å…±ç”¨ç›®éŒ„ï¼Œå‰‡å¯ç”¨é€™å€‹ç›®éŒ„ä¾ç…§ UUID å»ºç«‹è³‡æ–™å¤¾å­˜æ”¾ç”¢å‡ºçµæœï¼Œç„¶å¾Œå¾ŒçºŒ Job å»è®€å–å‰ä¸€å€‹ Job Output UUID å»æ‰¾åˆ°å°æ‡‰çš„å„²å­˜å†æ‹¿å›ä¾†ç”¨ã€‚
è¦æ³¨æ„ï¼Œä¸åŒä¸»æ©Ÿçš„ Runner ä¹Ÿéƒ½è¦æ›è¼‰åŒå€‹å…±ç”¨ç›®éŒ„ã€‚
- åœ¨åŒå€‹ Job çš„ Steps æŠŠæ‰€æœ‰äº‹æƒ…åšå®Œã€‚

### åšä¸­å­¸ GitHub Actions â€” æ¡ˆä¾‹å¯¦ä½œ

ã€Œåè€Œè¨€ï¼Œä¸å¦‚èµ·è€Œè¡Œã€ä»¥ä¸Šåè©è§£é‡‹è·Ÿæµç¨‹æ¶æ§‹ä»‹ç´¹ç›¸ä¿¡å¤§å®¶ä¹Ÿæ˜¯çœ‹å¾—æ‡µæ‡µæ‡‚æ‡‚ï¼Œæ¥ä¸‹ä¾†æœƒç›´æ¥èˆ‰ä¸‰å€‹åŠŸèƒ½ä¾‹å­ï¼Œå¸¶å¤§å®¶å¯¦éš›å‹•æ‰‹åšï¼Œä¸¦ä¸€é‚Šè§£é‡‹ç¢°åˆ°çš„æ±è¥¿ï¼Œå¾åšç•¶ä¸­å­¸ç¿’ï¼Œä»¥äº†è§£ GitHub Actions åˆ°åº•æ˜¯ä»€éº¼ã€‚
### æ¡ˆä¾‹ â€” 1

å»ºç«‹ Pull Request å¾Œè‡ªå‹•æ¨™è¨˜ File Changes Size Label è®“ Reviewer æ–¹ä¾¿å®‰æ’ Review å·¥ä½œã€‚
#### æˆæœåœ–


![[Demo PR](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/pull/11){:target="_blank"}](/assets/404bd5c70040/1*vjSWeu2zB-hmVpfziMDR5Q.png)

[Demo PR](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/pull/11){:target="_blank"}
#### é‹ä½œæµç¨‹
- ä½¿ç”¨è€…é–‹ PRã€é‡é–‹ PRã€Push æ–° Commit åˆ° PR
- è§¸ç™¼ GitHub Actions Workflow
- shell script å–çš„ file changes æ•¸é‡
- åˆ¤æ–·æ•¸é‡å° PR æ¨™è¨˜ä¸Š Label
- å®Œæˆ

#### å‹•æ‰‹åš

Repo â†’ Actions â†’ New workflow â†’ set up a workflow yourselfã€‚

**æª”æ¡ˆåç¨±ï¼š** `Automation-PullRequest.yml`

Action Workflow å¯ä»¥æ¯å€‹ä»»å‹™ç¨ç«‹ä¸€å€‹æª”æ¡ˆï¼Œä¹Ÿå¯ä»¥ä¾ç…§è§¸ç™¼äº‹ä»¶ã€ç›®çš„ï¼ŒåŒå€‹ç›®çš„èšåˆåœ¨åŒå€‹æª”æ¡ˆï¼Œåæ­£å¤šå€‹ Job æ˜¯ä¸¦ç™¼åŸ·è¡Œçš„ï¼Œå¦å¤– **å› ç‚º GitHub Actions æš«æ™‚ä¸æ”¯æ´ç›®éŒ„çµæ§‹ï¼Œæ‰€ä»¥æª”æ¡ˆå°‘ä¸€é»ã€ä½¿ç”¨éšå±¤å‘½åæª”æ¡ˆæœƒæ¯”è¼ƒå¥½ç®¡ç†** ã€‚

é€™é‚ŠæŠŠ PR ç›¸é—œäº‹ä»¶çš„ Actions éƒ½æ”¾åœ¨åŒå€‹ Workflowã€‚
#### `Automation-PullRequest.yml`
```yaml
# Workflow(Action) åç¨±
name: Pull Reqeust Automation

# Actions Log çš„æ¨™é¡Œåç¨±
run-name: "[Pull Reqeust Automation] ${{ github.event.pull_request.title || github.ref }}"

# è§¸ç™¼äº‹ä»¶
on:
  # PR äº‹ä»¶
  pull_request:
    # PR - é–‹å•Ÿã€é‡é–‹ã€æœ‰æ–° Push Commit æ™‚
    types: [opened, synchronize, reopened]


# åŒå€‹ Concurrency Group å¦‚æœæœ‰æ–°çš„ Job æœƒå–æ¶ˆæ­£åœ¨è·‘çš„
# ä¾‹å¦‚ Push Commit è§¸ç™¼çš„ä»»å‹™é‚„æ²’åŸ·è¡Œå°±åˆ Push Commit æ™‚ï¼Œæœƒå–æ¶ˆå‰ä¸€å€‹ä»»å‹™
concurrency:
  group: ${{ github.workflow }}-${{ github.ref_name }}
  cancel-in-progress: true

# Job å·¥ä½œé …ç›®
# Job æœƒä¸¦ç™¼åŸ·è¡Œ
jobs:
  # Job ID
  label-pr-by-file-count:
    # Job åç¨± (å¯çœç•¥ï¼Œæœ‰è¨­å®šåœ¨ Log é¡¯ç¤ºæ¯”è¼ƒå¥½è®€)
    name: Label PR by changes file count

    # å¦‚æœé€™å€‹ Job å¤±æ•—ï¼Œä¸å½±éŸ¿æ•´å€‹ Workflowï¼Œç¹¼çºŒå…¶ä»– Job
    continue-on-error: true
    
    # è¨­å®šæœ€é•· Timeout æ™‚é–“ï¼Œé˜²æ­¢ç•°å¸¸æƒ…æ³ç™¼ç”Ÿæ™‚ç„¡æ­¢ç›¡çš„ç­‰å¾…
    timeout-minutes: 10

    # Runner Label - ä½¿ç”¨ GitHub Hosted Runner ubuntu-latest ä¾†åŸ·è¡Œå·¥ä½œ
    # å¦‚æœæ˜¯ Private Repo æœƒè¨ˆç®—ç”¨é‡ï¼Œè¶…éå¯èƒ½æœƒç”¢ç”Ÿè²»ç”¨
    runs-on: ubuntu-latest

    # å·¥ä½œæ­¥é©Ÿ
    # å·¥ä½œæ­¥é©Ÿæœƒç…§é †åºåŸ·è¡Œ
    steps:
      # æ­¥é©Ÿåç¨±
      - name: Get changed file count and apply label
        # æ­¥é©Ÿ ID (å¯çœç•¥ï¼Œå¾ŒçºŒè‹¥æ²’æœ‰ Step è¦å¼•ç”¨ Output è¼¸å‡ºå‰‡ä¸éœ€è¨­å®š)
        id: get-changed-files-count-by-gh
        # æ³¨å…¥å¤–éƒ¨ç’°å¢ƒåƒæ•¸åˆ°åŸ·è¡Œéšæ®µ
        env:
          # secrets.GITHUB_TOKEN æ˜¯ GitHub Actions åŸ·è¡Œæ™‚è‡ªå‹•ç”¢ç”Ÿçš„ Tokenï¼Œä¸éœ€è‡ªè¡Œåœ¨ Secrets è¨­å®šï¼Œæ“æœ‰ä¸€äº› GitHub Repo API Scopes æ¬Šé™
          # https://docs.github.com/en/actions/how-tos/security-for-github-actions/security-guides/use-github_token-in-workflows
          # gh(GitHub) cli éœ€è¦æ³¨å…¥ GH_TOKEN åˆ° ENVï¼Œgh æ‰æœ‰æ¬Šé™æ“ä½œ  
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        # Shell script
        # GitHub Hosted Runner å…§å»ºéƒ½æœ‰å®‰è£å¥½ gh cliï¼Œä¸éœ€è¦å®‰è£ Job å°±èƒ½ç›´æ¥ä½¿ç”¨
        run: |
          #   ${{ github.xxx }} æ˜¯ GitHub Actions Context è¡¨é”å¼
          #   ä¸æ˜¯ Shell è®Šæ•¸ï¼Œè€Œæ˜¯ YAML è§£æéšæ®µç”± GitHub Actions æ›¿æ›æˆå°æ‡‰å€¼
          #   å…¶ä»–åƒæ•¸ï¼šhttps://docs.github.com/en/actions/learn-github-actions/contexts#github-context
          
          # å–å¾— PR ç·¨è™Ÿ:
          PR_NUMBER=${{ github.event.pull_request.number }}

          # å–å¾— Repo:
          REPO=${{ github.repository }}

          # ä½¿ç”¨ GitHub API (gh cli) å–å¾— File changed æ•¸é‡
          FILE_COUNT=$(gh pr view $PR_NUMBER --repo $REPO --json files --jq '.files | length')
          
          # Print Log
          echo "Changed file count: $FILE_COUNT"

          # Label é‚è¼¯
          if [ "$FILE_COUNT" -lt 5 ]; then
            LABEL="XS"
          elif [ "$FILE_COUNT" -lt 10 ]; then
            LABEL="S"
          elif [ "$FILE_COUNT" -lt 30 ]; then
            LABEL="M"
          elif [ "$FILE_COUNT" -lt 80 ]; then
            LABEL="L"
          elif [ "$FILE_COUNT" -lt 200 ]; then
            LABEL="XL"
          else
            LABEL="XXL"
          fi

          # ä½¿ç”¨ GitHub API (gh cli) ç§»é™¤ç›®å‰çš„ Size Label
          EXISTING_LABELS=$(gh pr view "$PR_NUMBER" --repo "$REPO" --json labels --jq '.labels[].name')
          for EXISTING in $EXISTING_LABELS; do
            case "$EXISTING" in
              XS|S|M|L|XL|XXL)
                echo "ğŸ§¹ Removing existing label: $EXISTING"
                gh pr edit "$PR_NUMBER" --repo "$REPO" --remove-label "$EXISTING"
                ;;
            esac
          done

          # (å¯é¸)å¦‚æœ Label ä¸å­˜åœ¨å‰‡å»ºç«‹
          if ! gh label list --repo "$REPO" | grep -q "^$LABEL"; then
            echo "ğŸ†• Creating missing label: $LABEL"
            gh label create "$LABEL" --repo "$REPO" --description "Size label: $LABEL" --color "ededed"
          else
            echo "âœ… Label '$LABEL' already exists"
          fi
          
          # ä½¿ç”¨ GitHub API (gh cli) æ¨™è¨˜ä¸Š Label
          gh pr edit $PR_NUMBER --repo $REPO --add-label "$LABEL"
```

Commit æª”æ¡ˆåˆ° Repo ä¸»åˆ†æ”¯ä¹‹å¾Œï¼Œæˆ‘å€‘å†é–‹æ–° PR å°±æœƒè‡ªå‹•è§¸ç™¼ GitHub Actionsï¼š


![](/assets/404bd5c70040/1*wdAztL0BgPeSZdqXxqUEXg.png)


Action åŸ·è¡Œç‹€æ…‹é¡¯ç¤º **Queued** ä»£è¡¨ä»»å‹™æ­£åœ¨ç­‰å¾… Runner æ¥ä»»å‹™å›å»åšã€‚
#### åŸ·è¡Œçµæœ


![[Demo PR](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/pull/11){:target="_blank"}](/assets/404bd5c70040/1*-JoD8IQYHVrDqHmLmrXyaQ.png)

[Demo PR](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/pull/11){:target="_blank"}

åŸ·è¡Œå®Œç•¢ä¸¦ä¸”æˆåŠŸå¾Œ PR ä¸Šå°±æœƒè‡ªå‹•æ¨™è¨˜å¥½å°æ‡‰çš„ Label äº†ï¼ç´€éŒ„æœƒé¡¯ç¤ºç”± `github-actions` æ¨™è¨˜ã€‚

**å®Œæ•´ç¨‹å¼ç¢¼ï¼š [Automation\-PullRequest\.yml](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/blob/main/.github/workflows/Automation-PullRequest.yml){:target="_blank"}**
#### ç›´æ¥ä½¿ç”¨åˆ¥äººåŒ…å¥½çš„ Action æ­¥é©Ÿï¼š [pascalgn/size\-label\-action](https://github.com/pascalgn/size-label-action/tree/main){:target="_blank"}

å‰é¢æœ‰èªªåˆ°å¯ä»¥ç›´æ¥ä½¿ç”¨åˆ¥äººå°è£å¥½çš„ Actionï¼Œæ¨™è¨˜ PR Size Label é€™ä»»å‹™å·²ç¶“æœ‰ç¾æˆçš„è¼ªå­å¯ä»¥ä½¿ç”¨ï¼Œä¸Šè¿°åªæ˜¯ç‚ºäº†æ•™å­¸ç›®çš„ï¼Œå¯¦éš›ä¸Šä¸éœ€è¦è‡ªå·±é‡é€ è¼ªå­ã€‚

åªéœ€è¦åœ¨ Action Workflow Job Step ä¸­ç›´æ¥ä½¿ç”¨å°±èƒ½å®Œæˆä»»å‹™ï¼š
```yaml
# Workflow(Action) åç¨±
name: Pull Reqeust Automation

# è§¸ç™¼äº‹ä»¶
on:
  # PR äº‹ä»¶
  pull_request:
    # PR - é–‹å•Ÿã€é‡é–‹ã€æœ‰æ–° Push Commit æ™‚
    types: [opened, synchronize, reopened]


# åŒå€‹ Concurrency Group å¦‚æœæœ‰æ–°çš„ Job æœƒå–æ¶ˆæ­£åœ¨è·‘çš„
# ä¾‹å¦‚ Push Commit è§¸ç™¼çš„ä»»å‹™é‚„æ²’åŸ·è¡Œå°±åˆ Push Commit æ™‚ï¼Œæœƒå–æ¶ˆå‰ä¸€å€‹ä»»å‹™
concurrency:
  group: ${{ github.workflow }}-${{ github.ref_name }}
  cancel-in-progress: true

# Job å·¥ä½œé …ç›®
# Job æœƒä¸¦ç™¼åŸ·è¡Œ
jobs:
  # Job ID
  label-pr-by-file-count:
    # Job åç¨± (å¯çœç•¥ï¼Œæœ‰è¨­å®šåœ¨ Log é¡¯ç¤ºæ¯”è¼ƒå¥½è®€)
    name: Label PR by changes file count

    # å¦‚æœé€™å€‹ Job å¤±æ•—ï¼Œä¸å½±éŸ¿æ•´å€‹ Workflowï¼Œç¹¼çºŒå…¶ä»– Job
    continue-on-error: true
    
    # è¨­å®šæœ€é•· Timeout æ™‚é–“ï¼Œé˜²æ­¢ç•°å¸¸æƒ…æ³ç™¼ç”Ÿæ™‚ç„¡æ­¢ç›¡çš„ç­‰å¾…
    timeout-minutes: 10

    # Runner Label - ä½¿ç”¨ GitHub Hosted Runner ubuntu-latest ä¾†åŸ·è¡Œå·¥ä½œ
    # å¦‚æœæ˜¯ Private Repo æœƒè¨ˆç®—ç”¨é‡ï¼Œè¶…éå¯èƒ½æœƒç”¢ç”Ÿè²»ç”¨
    runs-on: ubuntu-latest

    # å·¥ä½œæ­¥é©Ÿ
    # å·¥ä½œæ­¥é©Ÿæœƒç…§é †åºåŸ·è¡Œ
    steps:
      # æ­¥é©Ÿåç¨±
      - name: Get changed file count and apply label
        # æ­¥é©Ÿ ID (å¯çœç•¥ï¼Œå¾ŒçºŒè‹¥æ²’æœ‰ Step è¦å¼•ç”¨ Output è¼¸å‡ºå‰‡ä¸éœ€è¨­å®š)
        id: get-changed-files-count-by-gh
        # ç›´æ¥ä½¿ç”¨åˆ¥äººå°è£å¥½çš„ç¨‹å¼
        uses: "pascalgn/size-label-action@v0.5.5"
        # æ³¨å…¥å¤–éƒ¨ç’°å¢ƒåƒæ•¸åˆ°åŸ·è¡Œéšæ®µ
        # åƒæ•¸å‘½åã€å¯ç”¨åƒæ•¸è¦åƒè€ƒèªªæ˜ï¼šhttps://github.com/pascalgn/size-label-action/tree/main
        env:
          # secrets.GITHUB_TOKEN æ˜¯ GitHub Actions åŸ·è¡Œæ™‚è‡ªå‹•ç”¢ç”Ÿçš„ Token (github-actions èº«ä»½)ï¼Œä¸éœ€è‡ªè¡Œåœ¨ Secrets è¨­å®šï¼Œæ“æœ‰ä¸€äº› GitHub Repo API Scopes æ¬Šé™
          # https://docs.github.com/en/actions/how-tos/security-for-github-actions/security-guides/use-github_token-in-workflows
          GITHUB_TOKEN: "${{ secrets.GITHUB_TOKEN }}"
```


[![](https://opengraph.githubassets.com/1e5c6f52127032dc1a5fea71a498fa9cc585987880889f0306ef705de3990867/pascalgn/size-label-action)](https://github.com/pascalgn/size-label-action/tree/main){:target="_blank"}


é€™å€‹åŒ…å¥½çš„ Action æ˜¯ JavaScript Actionï¼Œå¯¦éš›åŸ·è¡Œç¨‹å¼ç¢¼å¯ä»¥åƒè€ƒä»¥ä¸‹æª”æ¡ˆï¼š [dist/index\.js](https://github.com/pascalgn/size-label-action/blob/main/dist/index.js){:target="_blank"} ã€‚
#### name, run\-name çš„è£œå……ï¼š


![](/assets/404bd5c70040/1*zBmjm_3AU53NN0UhTrmOBQ.png)

- name: Action Workflow çš„åç¨±
- run\-name: åŸ·è¡Œç´€éŒ„çš„æ¨™é¡Œåç¨± \(å¯å¸¶å…¥ PR Title or Branch or Authorâ€¦etc\)
å¦‚æœæ˜¯ on:pull\_request äº‹ä»¶é è¨­æ˜¯ PR Titleã€‚

### æ¡ˆä¾‹ â€” 2

å»ºç«‹ Pull Request å¾Œå¦‚æœæ²’æœ‰ Assignee å‰‡è‡ªå‹• Assign ä½œè€…è‡ªå·±ä¸¦ä¸” Comment æç¤ºã€‚\(åªæœ‰åœ¨åˆæ¬¡å»ºç«‹æ™‚æ‰æœƒåŸ·è¡Œ\)
#### æˆæœåœ–


![[Demo PR](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/pull/11){:target="_blank"}](/assets/404bd5c70040/1*EL-0nQF7jhP34d6ZoSkJAg.png)

[Demo PR](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/pull/11){:target="_blank"}
#### é‹ä½œæµç¨‹
- ä½¿ç”¨è€…é–‹ PR
- è§¸ç™¼ GitHub Actions Workflow
- github script å–å¾— assignee
- å¦‚æœæ²’æœ‰ asignee å‰‡ assign é–‹ PR çš„ä½œè€… & Comment è¨Šæ¯
- å®Œæˆ

#### å‹•æ‰‹åš

Repo â†’ Actions â†’ New workflow â†’ set up a workflow yourselfã€‚

**æª”æ¡ˆåç¨±ï¼š** `Automation-PullRequest.yml` \(åŒä¸Š\)
#### `Automation-PullRequest.yml`
```yaml
# Workflow(Action) åç¨±
name: Pull Reqeust Automation

# Actions Log çš„æ¨™é¡Œåç¨±
run-name: "Pull Reqeust Automation - Daily Checker"

# è§¸ç™¼äº‹ä»¶
on:
  # PR äº‹ä»¶
  pull_request:
    # PR - é–‹å•Ÿã€é‡é–‹ã€æœ‰æ–° Push Commit æ™‚
    types: [opened, synchronize, reopened]


# åŒå€‹ Concurrency Group å¦‚æœæœ‰æ–°çš„ Job æœƒå–æ¶ˆæ­£åœ¨è·‘çš„
# ä¾‹å¦‚ Push Commit è§¸ç™¼çš„ä»»å‹™é‚„æ²’åŸ·è¡Œå°±åˆ Push Commit æ™‚ï¼Œæœƒå–æ¶ˆå‰ä¸€å€‹ä»»å‹™
concurrency:
  group: ${{ github.workflow }}-${{ github.ref_name }}
  cancel-in-progress: true

# Job å·¥ä½œé …ç›®
# Job æœƒä¸¦ç™¼åŸ·è¡Œ
jobs:
  # Job ID
  label-pr-by-file-count:
    # è«‹åƒè€ƒå‰æ–‡ï¼Œç•¥....
  # ---------
  assign-self-if-no-assignee:
    name: Automatically assign to self if no assignee is specified
    # å› ç‚ºæ˜¯å…±ç”¨è§¸ç™¼äº‹ä»¶ï¼Œæ‰€ä»¥åœ¨ Job ä¸Šè‡ªå·±åˆ¤æ–·ï¼Œç•¶æ˜¯ Pull Request Opened(é¦–æ¬¡å»ºç«‹) æ™‚æ‰åŸ·è¡Œ Job å¦å‰‡æœƒ Skipped
    if: github.event_name == 'pull_request' && github.event.action == 'opened'

    # å¦‚æœé€™å€‹ Job å¤±æ•—ï¼Œä¸å½±éŸ¿æ•´å€‹ Workflowï¼Œç¹¼çºŒå…¶ä»– Job
    continue-on-error: true
    
    # è¨­å®šæœ€é•· Timeout æ™‚é–“ï¼Œé˜²æ­¢ç•°å¸¸æƒ…æ³ç™¼ç”Ÿæ™‚ç„¡æ­¢ç›¡çš„ç­‰å¾…
    timeout-minutes: 10
    
    # Runner Label - ä½¿ç”¨ GitHub Hosted Runner ubuntu-latest ä¾†åŸ·è¡Œå·¥ä½œ
    # å¦‚æœæ˜¯ Private Repo æœƒè¨ˆç®—ç”¨é‡ï¼Œè¶…éå¯èƒ½æœƒç”¢ç”Ÿè²»ç”¨
    runs-on: ubuntu-latest

    steps:
      - name: Assign self if No Assignee
        # ä½¿ç”¨ GitHub Script (JavaScript) æ’°å¯«è…³æœ¬ (Node.js ç’°å¢ƒ)
        # ç›¸è¼ƒä¸Šé¢ç›´æ¥ç”¨ Shell Script å¯«èµ·ä¾†æ›´æ–¹ä¾¿æ¼‚äº®
        # ä¹Ÿä¸éœ€è¦è‡ªè¡Œæ³¨å…¥ç’°å¢ƒè®Šæ•¸ã€GITHUB_TOKEN
        uses: actions/github-script@v7
        with:
          script: |
            // github-script ä¸­æœƒè‡ªå‹•æ³¨å…¥åˆ° context è®Šæ•¸ä¾› javascript ç›´æ¥å¼•ç”¨
            // https://docs.github.com/en/actions/learn-github-actions/contexts#github-context

            const issue = context.payload.pull_request; // å¦‚æœè¦é€£ Issue ä¸€èµ·æ”¯æ´å¯å¯«æˆ context.payload.issue || context.payload.pull_request
            const assignees = issue.assignees || [];
            const me = context.actor;

            if (assignees.length === 0) {
              // Assignee è¨­æˆè‡ªå·±
              await github.rest.issues.addAssignees({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: issue.number,
                assignees: [me]
              });

              // ç•™è¨€é€šçŸ¥
              await github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: issue.number,
                body: `ğŸ”§ No assignee was set, so I have assigned this to myself (@${me}).`
              });
            }
```

é€™æ¬¡æˆ‘å€‘ç¤ºç¯„æ”¹ç”¨ GitHub Script \(JavaScript\) æ’°å¯«è…³æœ¬ï¼Œç¨‹å¼ç¢¼èªæ³•ä¸Šæ›´å½ˆæ€§æ›´å¥½æ’°å¯«ã€‚

ç•¶ç„¶å¦‚æœä½ æƒ³ç…§æˆ‘ä¹‹å‰èªªçš„æ¯å€‹ä»»å‹™ä¸€å€‹æª”æ¡ˆï¼Œå°±å¯ä»¥æ‹”æ‰ Job If\. \. ç›´æ¥åœ¨ Action Workflow è§¸ç™¼æ¢ä»¶è¨­å®šï¼š

`Automation-PullRequest-Auto-Assign.yml` **ï¼š**
```yaml
# Workflow(Action) åç¨±
name: Pull Reqeust Automation - Auto Assignee Self

# è§¸ç™¼äº‹ä»¶
on:
  # PR äº‹ä»¶
  pull_request:
    # PR - é–‹å•Ÿæ™‚
    types: [opened]

jobs:
  assign-self-if-no-assignee:
    name: Automatically assign to self if no assignee is specified
    runs-on: ubuntu-latest
    steps:
      # è«‹åƒè€ƒå‰æ–‡ï¼Œç•¥....
```

Commit æª”æ¡ˆåˆ° Repo ä¸»åˆ†æ”¯ä¹‹å¾Œï¼Œæˆ‘å€‘å†é–‹æ–° PR å°±æœƒè‡ªå‹•è§¸ç™¼ GitHub Actionsï¼š


![](/assets/404bd5c70040/1*Y-A6owUibNEFBoRFHnqIYg.png)


ç¾åœ¨æœ‰å…©å€‹ Job è¦åŸ·è¡Œäº†ï¼
#### åŸ·è¡Œçµæœ


![[Demo PR](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/pull/11){:target="_blank"}](/assets/404bd5c70040/1*23muCVgUJKmZt746khBMFQ.png)

[Demo PR](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/pull/11){:target="_blank"}

åŸ·è¡Œå®Œç•¢ä¸¦ä¸”æˆåŠŸå¾Œ PR å¦‚æœæ²’æœ‰ Asignees æœƒè‡ªå‹• Assign PR ä½œè€…ä¸¦ä¸” Comment è¨Šæ¯ã€‚\(éƒ½æ˜¯ç”¨ `github-actions` èº«ä»½æ“ä½œ\)

**å®Œæ•´ç¨‹å¼ç¢¼ï¼š [Automation\-PullRequest\.yml](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/blob/main/.github/workflows/Automation-PullRequest.yml){:target="_blank"}**
#### æ¸¬è©¦é‡é–‹\(Reopened\) PR


![](/assets/404bd5c70040/1*mcDa7TZjv6mO7HtwhOE-Vw.png)


å¯çœ‹åˆ°åªæœƒåŸ·è¡Œ Size Label Jobï¼ŒAuto Assignee Job è¢« Skipped äº†ã€‚


> _é€™å€‹ä»»å‹™ä¹Ÿæœ‰äººåŒ…å¥½ Action å¯ä»¥ç›´æ¥å¾©ç”¨ï¼Œå¯åƒè€ƒï¼š [pozil/auto\-assign\-issue](https://github.com/pozil/auto-assign-issue){:target="_blank"} ã€‚_ 




### æ¡ˆä¾‹ â€” 3

æ¯æ—¥æ—©ä¸Š 9 é»è‡ªå‹•çµ±è¨ˆç•¶å‰ PR æ•¸é‡åŠå·²é–‹å•Ÿå¤šä¹…æ™‚é–“ç™¼é€é€šçŸ¥è¨Šæ¯åˆ° Slack å·¥ä½œå°‹çµ„ã€è‡ªå‹•é—œé–‰å·²é–‹å•Ÿè¶…é 3 å€‹æœˆçš„ PRã€‚
#### æˆæœåœ–


![](/assets/404bd5c70040/1*0stX9KpZi6PcXpG-90wyIg.png)



![](/assets/404bd5c70040/1*Nbg3r1zzhx24YIBEjPJnaw.png)

- Slack å·¥ä½œç¾¤çµ„æ¯å¤©æ—©ä¸Šè‡ªå‹•æ”¶åˆ°å ±å‘Š
- è‡ªå‹•é—œé–‰è¶…é 90 å¤©çš„ PR

#### é‹ä½œæµç¨‹
- GitHub Actions æ¯å¤©æ—©ä¸Š 9 é»è‡ªå‹•è§¸ç™¼
- è§¸ç™¼ GitHub Actions Workflow
- github script å–å¾— é–‹å•Ÿä¸­çš„ PR åˆ—è¡¨ã€çµ±è¨ˆé–‹å•Ÿäº†å¹¾å¤©
- å‚³é€çµ±è¨ˆå ±å‘Šè¨Šæ¯åˆ° Slack
- é—œé–‰è¶…é 90 å¤©çš„ PR
- å®Œæˆ

#### å‹•æ‰‹åš

Repo â†’ Actions â†’ New workflow â†’ set up a workflow yourselfã€‚

**æª”æ¡ˆåç¨±ï¼š** `Automation-PullRequest-Daily.yml`
#### Automation\-PullRequest\-Daily\.yml
```yaml
# Workflow(Action) åç¨±
name: Pull Reqeust Automation - Daily Checker

# è§¸ç™¼äº‹ä»¶
on:
  # æ’ç¨‹å®šæ™‚è‡ªå‹•åŸ·è¡Œ
  # https://crontab.guru/
  # UTC æ™‚é–“
  schedule:
    # UTC çš„ 01:00 = æ¯å¤© UTC+8 çš„ 09:00
    - cron: '0 1 * * *'
  # æ‰‹å‹•è§¸ç™¼
  workflow_dispatch:

# Job å·¥ä½œé …ç›®
# Job æœƒä¸¦ç™¼åŸ·è¡Œ
jobs:
  # Job ID
  caculate-pr-status:
    # Job åç¨± (å¯çœç•¥ï¼Œæœ‰è¨­å®šåœ¨ Log é¡¯ç¤ºæ¯”è¼ƒå¥½è®€)
    name: Caculate PR Status
    # Runner Label - ä½¿ç”¨ GitHub Hosted Runner ubuntu-latest ä¾†åŸ·è¡Œå·¥ä½œ
    # å¦‚æœæ˜¯ Private Repo æœƒè¨ˆç®—ç”¨é‡ï¼Œè¶…éå¯èƒ½æœƒç”¢ç”Ÿè²»ç”¨
    runs-on: ubuntu-latest

    # Job Output
    outputs:
      pr_list: ${{ steps.pr-info.outputs.pr_list }}

    # å·¥ä½œæ­¥é©Ÿ
    # å·¥ä½œæ­¥é©Ÿæœƒç…§é †åºåŸ·è¡Œ
    steps:
      # æ­¥é©Ÿåç¨±
      - name: Fetch open PRs and caculate
        # Step å¤–éƒ¨è¦å¼•ç”¨ Output è¼¸å‡ºï¼Œéœ€è¨­å®š
        id: pr-info
        uses: actions/github-script@v7
        with:
          script: |
            const now = new Date();
            const per_page = 100;
            let page = 1;
            let allPRs = [];
      
            while (true) {
              const { data: prs } = await github.rest.pulls.list({
                owner: context.repo.owner,
                repo: context.repo.repo,
                state: 'open',
                per_page,
                page,
              });
              if (prs.length === 0) break;
              allPRs = allPRs.concat(prs);
              if (prs.length < per_page) break;
              page++;
            }
      
            const result = allPRs.map(pr => {
              const created = new Date(pr.created_at);
              const daysOpen = Math.floor((now - created) / (1000 * 60 * 60 * 24));
              return {
                pr: pr.number.toString(),
                title: pr.title,
                idle: daysOpen
              };
            });

            // è¨­å®šå› Outputï¼Œåªæ¥å— String
            core.setOutput('pr_list', JSON.stringify(result));
  # ----
  send-pr-summary-message-to-slack:
    name: Send PR Summary Messag to Slack
    # Job é è¨­æ˜¯ä¸¦ç™¼ï¼Œä½¿ç”¨ needs å¯ä»¥è¿«ä½¿ç•¶å‰ Job ç­‰åˆ° need Job å®Œæˆæ™‚æ‰æœƒåŸ·è¡Œ
    needs: [caculate-pr-status]
    runs-on: ubuntu-latest
    
    steps:
      - name: Generate Message
        # Step å¤–éƒ¨è¦å¼•ç”¨ Output è¼¸å‡ºï¼Œéœ€è¨­å®š
        id: gen-msg
        uses: actions/github-script@v7
        with:
          script: |
            const prList = JSON.parse(`${{ needs.caculate-pr-status.outputs.pr_list }}`);
            const blocks = [];
      
            // æ¨™é¡Œ
            blocks.push({
              type: "section",
              text: {
                type: "mrkdwn",
                text: `ğŸ“¬ *Open PR Report*\nTotal: *${prList.length}* PR(s)`
              }
            });
      
            // æ¯å€‹ PR ä¸€è¡Œ
            for (const pr of prList) {
              blocks.push({
                type: "section",
                text: {
                  type: "mrkdwn",
                  text: `â€¢ <https://github.com/${context.repo.owner}/${context.repo.repo}/pull/${pr.pr}|PR #${pr.pr}> *${pr.title}* - ğŸ•’ ${pr.idle} day(s)`
                }
              });
            }

            // è¨­å®šå› Outputï¼Œåªæ¥å— String
            core.setOutput('blocks', JSON.stringify(blocks));

            
      # ä½¿ç”¨ Slack å®˜æ–¹å°è£å¥½çš„ Slack API Github Actions
      # https://tools.slack.dev/slack-github-action/sending-techniques/sending-data-slack-api-method/
      # ç™¼é€è¨Šæ¯
      - name: Post text to a Slack channel
        uses: slackapi/slack-github-action@v2.1.0
        with:
          method: chat.postMessage
          token: ${{ secrets.SLACK_BOT_TOKEN }}
          payload: |
            channel: ${{ vars.SLACK_TEAM_CHANNEL_ID }}
            blocks: ${{ steps.gen-msg.outputs.blocks }}
  # ----
  auto-close-old-prs:
    name: Auto Close Old PRs
    needs: [caculate-pr-status]
    runs-on: ubuntu-latest

    steps:
      - name: Auto close PRs opened more than 90 days
        uses: actions/github-script@v7
        with:
          script: |
            const prList = JSON.parse(`${{ needs.caculate-pr-status.outputs.pr_list }}`);
            const oldPRs = prList.filter(pr => pr.idle > 90);

            for (const pr of oldPRs) {
              await github.rest.pulls.update({
                owner: context.repo.owner,
                repo: context.repo.repo,
                pull_number: parseInt(pr.pr),
                state: 'closed'
              });

              await github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: parseInt(pr.pr),
                body: `âš ï¸ This pull request has been automatically closed because it has been open for more than 90 days. Please reopen if needed.`
              });
            }
            console.log(`Closed ${oldPRs.length} PR(s)`);
```

åœ¨é€™å€‹ç¯„ä¾‹ä¸­æˆ‘å€‘ä½¿ç”¨ï¼š
- on: schedule Crontab æ’ç¨‹è‡ªå‹•è§¸ç™¼è·Ÿ workflow\_dispatch æ”¯æ´æ‰‹å‹•è§¸ç™¼
- Job output/Step output \(éƒ½åªèƒ½æ˜¯å­—ä¸²\)
- å¤šå€‹ Jobs é è¨­æ˜¯ä¸¦ç™¼ä½†å¯ä»¥ç”¨ `needs` æ™‚é–“ä¾è³´ç­‰å¾…é—œä¿‚
- å¾ Repo Secrets/Variables å–å¾—è¨­å®š
- ä¸²æ¥ Slack API


**Repo Secrets â€” æ–°å¢** `SLACK_BOT_TOKEN`


![](/assets/404bd5c70040/1*YC4DBHtKmX5XGgcSSzaE5A.png)

- Slack App å»ºç«‹ã€ç™¼è¨Šæ¯æ¬Šé™è¨­å®šå¯åƒè€ƒæˆ‘ [ä¹‹å‰çš„æ–‡ç« ](../bd94cc88f9c9/)


**Repo Variables â€” æ–°å¢** `SLACK_TEAM_CHANNEL_ID`


![](/assets/404bd5c70040/1*X4gZ5_IRvsiehAL0O9AleQ.png)


Commit æª”æ¡ˆåˆ° Repo ä¸»åˆ†æ”¯ä¹‹å¾Œï¼Œå›åˆ° Actions æ‰‹å‹•è§¸ç™¼çœ‹çœ‹ï¼š


> _æ—¥å¾Œæœƒæ¯æ—¥è‡ªå‹•è§¸ç™¼ã€‚_ 






![](/assets/404bd5c70040/1*WNFKXl-QC2WGyaSWep5-DA.png)


Actions â†’ Pull Request Automation â€” Daily Checker â†’ Run workflow â†’ Branch: main â†’ Run workflowã€‚

**åŸ·è¡Œå¾Œå¯ä»¥é»æ“Šé€²å…¥æŸ¥çœ‹åŸ·è¡Œç‹€æ³ï¼š**


![](/assets/404bd5c70040/1*4mvOxnd1uS4ZlxnNoNdHaQ.png)



![](/assets/404bd5c70040/1*BluzFgY2tM2E7DwoVq1jQw.png)


å› ç‚ºæœ‰ `needs` çš„é™åˆ¶ï¼ŒJobs æµç¨‹å°±æœƒæ˜¯ `Cacluate PR Status` å…ˆå®Œæˆå¾Œæ‰æœƒä¸¦ç™¼åŸ·è¡Œ `Auto Close Old PRs` å’Œ `Send PR Summary Message to Slack` ã€‚
#### åŸ·è¡Œçµæœ

**ä»»å‹™éƒ½æˆåŠŸåŸ·è¡Œå¾Œå¯ä»¥æŸ¥çœ‹ Slack è¨Šæ¯ï¼š**


![](/assets/404bd5c70040/1*0stX9KpZi6PcXpG-90wyIg.png)


æˆåŠŸ ğŸš€ğŸš€ğŸš€

**å®Œæ•´ç¨‹å¼ç¢¼ï¼š [Automation\-PullRequest\-Daily\.yml](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/blob/main/.github/workflows/Automation-PullRequest-Daily.yml){:target="_blank"}**
### å°çµ


> å¸Œæœ›ä¸Šé¢ä¸‰å€‹æ¡ˆä¾‹èƒ½è®“æ‚¨å° GitHub Actions æœ‰å€‹åˆæ­¥çš„äº†è§£ä¹Ÿå¸Œæœ›æœ‰æ¿€èµ·ä½ çš„è‡ªå‹•åŒ–å·¥ä½œå‰µæ„ï¼Œå¯ä»¥è‡ªå·±ç™¼æƒ³å·¥ä½œæµç¨‹\(è«‹å‹™å¿…å…ˆåƒè€ƒ [è§¸ç™¼äº‹ä»¶](https://docs.github.com/en/actions/reference/events-that-trigger-workflows){:target="_blank"} \)ï¼Œç„¶å¾Œæ’°å¯«è…³æœ¬åŸ·è¡Œï¼›ä¹Ÿè¨˜å¾—å…ˆå» [**Marketplace**](https://github.com/marketplace?type=actions){:target="_blank"} æ‰¾æ‰¾ç¾æœ‰çš„æ­¥é©Ÿå¯ä»¥ç«™åœ¨å·¨äººçš„è‚©è†€ç›´æ¥ä½¿ç”¨ã€‚ 




æœ¬ç¯‡åªæ˜¯å…¥é–€åŸºç¤\(ç”šè‡³æ²’ Checkout Code\)ï¼Œä¸‹ä¸€ç¯‡ã€Œ [**CI/CD å¯¦æˆ°æŒ‡å—ï¼ˆä¸‰ï¼‰ï¼šä½¿ç”¨ GitHub Actions å¯¦ä½œ App å°ˆæ¡ˆçš„ CI èˆ‡ CD å·¥ä½œæµç¨‹**](../4b001d2e8440/) ã€æœƒåœ¨ä»‹ç´¹æ›´è¤‡é›œæ·±å…¥çš„ GitHub Actions Workflowã€‚
#### GitHub è‡ªå‹•åŒ–å»¶ä¼¸è­°é¡Œ

GitHub å¯ä»¥èˆ‡ Slack æ•´åˆï¼Œè¨‚é–± Repo çš„ PR æ›´æ–°é€šçŸ¥ã€Push Default Branch é€šçŸ¥â€¦ç­‰ç­‰ã€‚


![](/assets/404bd5c70040/1*BMTT4koRBIIsQ7_mklC86w.png)


**å•é¡Œ 1\. GitHub è¨Šæ¯ç„¡æ³•æ¨™è¨˜åˆ°äººï¼Œåªæ¨™è¨˜äº† GitHub å¸³è™Ÿï¼ŒSlack å¸³è™Ÿæ”¶ä¸åˆ°é€šçŸ¥ï¼š**


![](/assets/404bd5c70040/1*Ddp0cEtXE10hScM1rozmtg.png)



![](/assets/404bd5c70040/1*uHGJ7l__AdYoWT9KpvihLQ.png)


[Slack App](https://slack.github.com/){:target="_blank"} or Apps æœå°‹ GitHub â†’ æ‰“é–‹è¨Šæ¯è¦–çª— â†’å®Œæˆ **Connect GitHub Account** æ­¥é©Ÿï¼Œé€™æ¨£ GitHub æ‰çŸ¥é“ä½ å°æ‡‰çš„ Slack UID æ˜¯ä»€éº¼ï¼Œæ‰èƒ½æ¨™è¨˜ä½ ã€‚

**å•é¡Œ 2\. Pull Request Reminder**

æˆ‘è¨˜å¾—é€™æœ¬ä¾†æ˜¯ç¬¬ä¸‰æ–¹é–‹ç™¼çš„åŠŸèƒ½ï¼Œå¾Œä¾†ç›´æ¥æ•´åˆåœ¨ GitHub è£¡é¢äº†ï¼Œä¸è¦å‚»å‚»çš„è‡ªå·±ç”¨ GitHub Actions å¯«è…³æœ¬åšï¼


![](/assets/404bd5c70040/1*BpMd2K0NBDE6xB1XzFY94Q.png)



> [**_GitHub å…§å»ºçš„æ˜¯ by Team è¨­ç½®ï¼Œä½ éœ€è¦å…ˆç‚ºçµ„ç¹”å¢åŠ  Teamã€Repo åŠ å…¥ Team ç„¶å¾Œæ‰èƒ½è¨­ç½® Pull Request Reminderã€‚_**](https://docs.github.com/en/organizations/organizing-members-into-teams/managing-scheduled-reminders-for-your-team){:target="_blank"} 




- è¼¸å…¥å®Œ Slack Channel è·Ÿè¦å‰‡å„²å­˜ä¹‹å¾Œæ¯å¤©å°±æœƒè‡ªå‹•å‚³é€æç¤ºè¨Šæ¯è·Ÿæ¨™è¨˜ Reviewer äº†ï¼Œè¨­ç½®å¯ [åƒè€ƒ](https://michaelheap.com/github-scheduled-reminders/){:target="_blank"} ï¼Œçµæœå¦‚ä¸‹åœ–ï¼š



![[https://michaelheap\.com/github\-scheduled\-reminders/](https://michaelheap.com/github-scheduled-reminders/){:target="_blank"}](/assets/404bd5c70040/1*kvqFXkIKIxP79Wm8vIaN0Q.png)

[https://michaelheap\.com/github\-scheduled\-reminders/](https://michaelheap.com/github-scheduled-reminders/){:target="_blank"}

**å•é¡Œ 4\. GitHub PR è¨Šæ¯ï¼Œä½œè€…æ”¶ä¸åˆ°é€šçŸ¥ï¼š**


![](/assets/404bd5c70040/1*wmtXwXAcQZDXqInRd0ivPw.png)



> _é€™æ˜¯ä¸€å€‹è¬å¹´çš„å•é¡Œï¼Œå°±æ˜¯ PR çš„ Slack è¨Šæ¯ **å…¶å¯¦ä½œè€…ä¸¦ä¸çŸ¥é“æœ‰äºº Reply Threads è¨è«–** ï¼ŒGitHub ç™¼çš„é€™å‰‡ Slack è¨Šæ¯åªæœƒæ¨™è¨˜ Reviewersï¼Œä¸æœƒæ¨™è¨˜ Assignee or PR ä½œè€…ã€‚_ 





é€™æ™‚å€™ GitHub Actions åšè‡ªå‹•åŒ–å°å·¥å…·å°±æ´¾ä¸Šç”¨å ´äº†ï¼Œæˆ‘å€‘å¯ä»¥åŠ ä¸€å€‹ Job åœ¨ PR Description æœ€å¾Œ Append æ¨™è¨˜ä½œè€…ï¼Œé€™æ¨£è¨Šæ¯å‚³åˆ° Slack ä¹Ÿæœƒä¸€ä¸¦æ¨™è¨˜åˆ°ä½œè€…çš„ Slack:
```bash
# Workflow(Action) åç¨±
name: Pull Reqeust Automation
# è«‹åƒè€ƒå‰æ–‡ï¼Œç•¥....

  # ---------
  append-author-to-pr-description:
    name: Append author to PR description
    # å› ç‚ºæ˜¯å…±ç”¨è§¸ç™¼äº‹ä»¶ï¼Œæ‰€ä»¥åœ¨ Job ä¸Šè‡ªå·±åˆ¤æ–·ï¼Œç•¶æ˜¯ Pull Request Opened(é¦–æ¬¡å»ºç«‹) æ™‚æ‰åŸ·è¡Œ Job å¦å‰‡æœƒ Skipped
    if: github.event_name == 'pull_request' && github.event.action == 'opened'
    
    # å¦‚æœé€™å€‹ Job å¤±æ•—ï¼Œä¸å½±éŸ¿æ•´å€‹ Workflowï¼Œç¹¼çºŒå…¶ä»– Job
    continue-on-error: true
    
    # è¨­å®šæœ€é•· Timeout æ™‚é–“ï¼Œé˜²æ­¢ç•°å¸¸æƒ…æ³ç™¼ç”Ÿæ™‚ç„¡æ­¢ç›¡çš„ç­‰å¾…
    timeout-minutes: 10
    
    # Runner Label - ä½¿ç”¨ GitHub Hosted Runner ubuntu-latest ä¾†åŸ·è¡Œå·¥ä½œ
    # å¦‚æœæ˜¯ Private Repo æœƒè¨ˆç®—ç”¨é‡ï¼Œè¶…éå¯èƒ½æœƒç”¢ç”Ÿè²»ç”¨
    # ä½†é€™ç¨®è‡ªå‹•åŒ–å°å·¥ä½œä¸å¤ªå®¹æ˜“ç”¨éé‡
    runs-on: ubuntu-latest
    steps:
      - name: Append author to PR description
        env:
          # secrets.GITHUB_TOKEN æ˜¯ GitHub Actions åŸ·è¡Œæ™‚è‡ªå‹•ç”¢ç”Ÿçš„ Tokenï¼Œä¸éœ€è‡ªè¡Œåœ¨ Secrets è¨­å®šï¼Œæ“æœ‰ä¸€äº› GitHub Repo API Scopes æ¬Šé™
          # gh(GitHub) cli éœ€è¦æ³¨å…¥ GH_TOKEN åˆ° ENVï¼Œgh æ‰æœ‰æ¬Šé™æ“ä½œ
          # https://docs.github.com/en/actions/how-tos/security-for-github-actions/security-guides/use-github_token-in-workflows
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}

          #   ${{ github.xxx }} æ˜¯ GitHub Actions Context è¡¨é”å¼
          #   ä¸æ˜¯ Shell è®Šæ•¸ï¼Œè€Œæ˜¯ YAML è§£æéšæ®µç”± GitHub Actions æ›¿æ›æˆå°æ‡‰å€¼
          #   å…¶ä»–åƒæ•¸ï¼šhttps://docs.github.com/en/actions/learn-github-actions/contexts#github-context
          PR_NUMBER: ${{ github.event.pull_request.number }}
          AUTHOR_TAG: '@${{ github.event.pull_request.user.login }}'
        run: |
          PR_BODY=$(gh pr view $PR_NUMBER --repo ${{ github.repository }} --json body -q ".body")
          NEW_BODY=$(printf "%s\n\nCreated by %s" "$PR_BODY" "$AUTHOR_TAG")
          gh pr edit $PR_NUMBER --repo ${{ github.repository }} --body "$NEW_BODY"
```

**å®Œæ•´ç¨‹å¼ç¢¼ï¼š [Automation\-PullRequest\.yml](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/blob/main/.github/workflows/Automation-PullRequest.yml){:target="_blank"}**

é–‹ PR æ™‚æœƒè‡ªå‹•åœ¨æè¿°å¾ŒåŠ ä¸Šä½œè€…è³‡è¨Šã€Slack è¨Šæ¯ä¹Ÿæœƒæ­£ç¢ºçš„æ¨™è¨˜ä½œè€…ï¼š


![](/assets/404bd5c70040/1*UtTDtIQJ0vJks79UzCQSAQ.png)



![](/assets/404bd5c70040/1*MjVsFqE--xAq1zSQfCNVdQ.png)


**å•é¡Œ 5\. GitHub ç˜‹ç‹‚å¯„é€šçŸ¥ä¿¡åˆ°ä¿¡ç®±å¾ˆå¹²æ“¾ï¼š**

GitHub Repo é€šçŸ¥è·Ÿ Slack éƒ½æœ‰è¨­å®šå¥½ä¹‹å¾Œï¼Œçµ±ä¸€éƒ½åœ¨ Slack æ”¶é€šçŸ¥äº†ï¼Œå¯ä»¥å» GitHub å€‹äººè¨­å®šæŠŠ Email é€šçŸ¥é—œæ‰ï¼š


![](/assets/404bd5c70040/1*INgfO9B2bNFy-Nd1ZjnzOw.png)

#### å…¶ä»–

Actions ç›®å‰æ²’æœ‰ç›®éŒ„çµæ§‹ï¼Œä½†å¯ä»¥åœ¨ Actions é ï¼Œç½®é ‚\(Pin\) äº”å€‹ Actionsï¼›ä¹Ÿå¯ä»¥ä½¿ç”¨ Disable æš«åœæŸå€‹ Actionã€‚


![](/assets/404bd5c70040/1*ZD-5xkparhJqtnm2REeu6A.png)


å¯ä»¥åœ¨ Insights æŸ¥çœ‹ GitHub Actions ç”¨é‡è·ŸåŸ·è¡Œæˆæ•ˆï¼š


![](/assets/404bd5c70040/1*re91ZRtQ0frOF6GVJ-MKrw.png)

### Reuse Workflow è£œå……

[ä¸‹ä¸€ç¯‡æ–‡ç« ](../4273e57e7148/) æœ‰ç”¨åˆ°åŒå€‹ Repo æ‹† Reuse Workflowï¼Œé€™é‚Šè£œå……ä¸€ä¸‹ä¸åŒ Repo æ‹† Reuse Workflow çš„ç¯„ä¾‹ã€‚

å…ˆå®šç¾©ä¸€å€‹ Reuse Workflow: [**Automation\-label\-pr\-base\-branch\.yml:**](https://github.com/ZhgChgLi/github-actions-ci-cd-demo-share-actions/blob/main/.github/workflows/Automation-label-pr-base-branch.yml){:target="_blank"} **åœ¨ [ZhgChgLi/github\-actions\-ci\-cd\-demo\-share\-actions](https://github.com/ZhgChgLi/github-actions-ci-cd-demo-share-actions/blob/main/.github/workflows/Automation-label-pr-base-branch.yml){:target="_blank"} Repo** ã€‚
```yaml
name: Automation-label-pr-base-branch
run-name: "[Automation-label-pr-base-branch] ${{ github.event.inputs.PR_NUMBER || github.ref }}"

concurrency:
  group: ${{ github.workflow }}-${{ github.event.inputs.PR_NUMBER || github.ref }}
  cancel-in-progress: true

# è§¸ç™¼äº‹ä»¶
on:
  # å…¶ä»– Workflow å‘¼å«æ­¤ Workflow è§¸ç™¼
  workflow_call:
    # è³‡æ–™è¼¸å…¥
    inputs:
      # PR Number
      PR_NUMBER:
        required: true
        type: string
    # å¯†é‘°è¼¸å…¥
    secrets:
      GH_TOKEN:
        description: "GitHub token for API access"
        required: true
jobs:
  label-pr-base-branch:
    name: Label PR Base Branch
    continue-on-error: true
    timeout-minutes: 10
    runs-on: ubuntu-latest

    steps:
      - name: Label PR by Base Branch
        id: label-pr-base-branch
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          PR_NUMBER="${{ inputs.PR_NUMBER }}"
          REPO="${{ github.repository }}"

          echo "ğŸ“¦ Processing PR #$PR_NUMBER in repo $REPO"

          # å–å¾— PR çš„ base branch
          BASE_BRANCH=$(gh pr view "$PR_NUMBER" --repo "$REPO" --json baseRefName --jq '.baseRefName')
          echo "ğŸ”– PR Base Branch: $BASE_BRANCH"

          # å…è¨±çš„ base branch labels
          BRANCH_LABELS=("develop" "main" "master")

          # Label æ˜¯å¦åœ¨å…è¨±åˆ—è¡¨
          if [[ " ${BRANCH_LABELS[@]} " =~ " ${BASE_BRANCH} " ]]; then
            LABEL="$BASE_BRANCH"
          else
            echo "âš ï¸ Base branch '$BASE_BRANCH' not in allowed list, skipping label."
            exit 0
          fi

          # ç§»é™¤ç¾æœ‰çš„ base branch labels
          EXISTING_LABELS=$(gh pr view "$PR_NUMBER" --repo "$REPO" --json labels --jq '.labels[].name')
          for EXISTING in $EXISTING_LABELS; do
            if [[ " ${BRANCH_LABELS[@]} " =~ " ${EXISTING} " ]]; then
              echo "ğŸ§¹ Removing existing base branch label: $EXISTING"
              gh pr edit "$PR_NUMBER" --repo "$REPO" --remove-label "$EXISTING"
            fi
          done

          # å¦‚æœ Label ä¸å­˜åœ¨å‰‡å»ºç«‹
          if ! gh label list --repo "$REPO" | grep -q "^$LABEL$"; then
            echo "ğŸ†• Creating missing label: $LABEL"
            gh label create "$LABEL" --repo "$REPO" --description "PR targeting $LABEL branch" --color "ededed"
          else
            echo "âœ… Label '$LABEL' already exists"
          fi

          # åŠ ä¸Š base branch label
          echo "ğŸ·ï¸ Adding label '$LABEL' to PR #$PR_NUMBER"
          gh pr edit "$PR_NUMBER" --repo "$REPO" --add-label "$LABEL"
```

å›åˆ°æˆ‘å€‘çš„ **ä¸» [ZhgChgLi/github\-actions\-ci\-cd\-demo](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/blob/main/.github/workflows/Demo-Reuse-Action-From-Another-Repo.yml){:target="_blank"} Repoï¼Œ** æ–°å¢ä¸€å€‹ä¸» **Workflow [Demo\-Reuse\-Action\-From\-Another\-Repo\.yml](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/blob/main/.github/workflows/Demo-Reuse-Action-From-Another-Repo.yml){:target="_blank"} :**
```yaml
name: Automation-label-pr-base-branch

on:
  pull_request:
    types: [opened]

jobs:
  call-label-pr-workflow:
    name: Call Base Branch Label Workflow
    # âœ… å¦‚æœè¢«å‘¼å«çš„ workflow åœ¨åŒä¸€å€‹ repoï¼š
    #    uses: ./.github/workflows/Automation-label-pr-base-branch.yml
    #    æ³¨æ„ï¼šé€™ç¨®å¯«æ³•ç„¡æ³•æŒ‡å®šåˆ†æ”¯ï¼ˆå›ºå®šä½¿ç”¨ caller workflow çš„ branchï¼‰
    #    åƒè€ƒç¯„ä¾‹ï¼š
    #    - CD-Deploy-Form.yml å‘¼å«æœ¬ repo workflow
    #    - CD-Deploy.yml å‘¼å«è·¨ repo workflow
    #
    # âœ… å¦‚æœè¢«å‘¼å«çš„ workflow åœ¨å…¶ä»– repoï¼š
    #    uses: {owner}/{repo}/.github/workflows/{file}.yml@{branch_or_tag}
    #    å¯ä»¥æŒ‡å®š branch æˆ– tag
    #    ref: https://github.com/ZhgChgLi/github-actions-ci-cd-demo-share-actions/blob/main/.github/workflows/Automation-label-pr-base-branch.yml
    uses: ZhgChgLi/github-actions-ci-cd-demo-share-actions/.github/workflows/Automation-label-pr-base-branch.yml@main
    with:
      PR_NUMBER: ${{ github.event.number }}
      
    # å¦‚æœæ‰€æœ‰ secrets éƒ½è¦ç¹¼æ‰¿ caller workflowï¼Œç›´æ¥ç”¨ `inherit`
    # secrets: inherit
    #
    # å¦‚æœåªè¦å‚³ç‰¹å®š secretsï¼Œå€‹åˆ¥æŒ‡å®š
    secrets:
      GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```

Commit æª”æ¡ˆå¾Œé–‹ PR è©¦è©¦çœ‹ã€‚

**å·¥ä½œæµç¨‹ï¼šä¸» Repo çš„ [Demo\-Reuse\-Action\-From\-Another\-Repo\.yml](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/blob/main/.github/workflows/Demo-Reuse-Action-From-Another-Repo.yml){:target="_blank"} â†’ å‘¼å«ä¸¦æŠŠåƒæ•¸å‚³åˆ°å¦ä¸€å€‹ Repo çš„ [Automation\-label\-pr\-base\-branch\.yml](https://github.com/ZhgChgLi/github-actions-ci-cd-demo-share-actions/blob/main/.github/workflows/Automation-label-pr-base-branch.yml){:target="_blank"} åŸ·è¡Œä»»å‹™ â†’ å›åˆ°ä¸» Repo å›å ±çµæœã€‚**


![](/assets/404bd5c70040/1*13bqlAgpBkHM7UthTJAuOg.png)



![](/assets/404bd5c70040/1*CAF3HzS4PHBveDQYu3H73g.png)


æˆåŠŸï¼
#### Private Repo å­˜å–å•é¡Œ

é€™é‚Šè¦æ³¨æ„ä¸€å€‹å®‰å…¨æ€§å•é¡Œï¼ŒPublic Repo å®Œå…¨æ²’å•é¡Œï¼Œä½†å¦‚æœ Reuse Workflow åœ¨ Private Repo ç•¶ä¸­ï¼Œåªæœ‰åœ¨ **åŒå€‹çµ„ç¹”ä¸‹çš„å…¶ä»– Repo \+ Repo åŒæ¨£ä¹Ÿæ˜¯ Private \+ è¨­å®šå…è¨±** =æ‰èƒ½å­˜å–ä½¿ç”¨ Private Repo Reuse Workflowã€‚
- `Public â€” ZhgChgLi/ReuseRepo` \+ `Private or Public-ZhgChgli or harry/myRepo` = âœ…
- `Private â€” ZhgChgLi/ReuseRepo` \+ `Private or Publicâ€” harry/myRepo` = âŒ
- `Private â€” ZhgChgLi/ReuseRepo` \+ `Public â€” ZhgChgLi/anotherRepo` = âŒ
- `Private â€” ZhgChgLi/ReuseRepo` \+ `Private â€” ZhgChgLi/anotherRepo` = âœ…


**è¨­å®šå…è¨±çš„æ–¹å¼ï¼Œè¦å» Reuse Workflow Repo â†’ Settings â†’ Actions â†’ General â†’ Acces:**


![](/assets/404bd5c70040/1*iZCEifgyArTJS3URMSk01g.png)


æ”¹å‹¾é¸ï¼š
```
Accessible from repositories in the 'ZhgChgLi' organization
Workflows in other repositories that are part of the 'ZhgChgLi' organization can access the actions and reusable workflows in this repository. Access is allowed only from private repositories.
```

é»æ“Šã€ŒSaveã€å„²å­˜ï¼Œå®Œæˆã€‚

**å¦‚æœæ²’æ¬Šé™å­˜å–æœƒå‡ºç¾ä»¥ä¸‹éŒ¯èª¤è¨Šæ¯ï¼š**
```bash
Invalid workflow file: .github/workflows/Demo-reuse-action-from-another-repo.yml#L21
error parsing called workflow
".github/workflows/Demo-reuse-action-from-another-repo.yml"
-> "ZhgChgLi/github-actions-ci-cd-demo-share-actions/.github/workflows/Automation-label-pr-base-branch.yml@main"
: workflow was not found.
```
### GitHub Actions Script èªæ³•è£œå……

è£œå……ä¸€ä¸‹å¤§å®¶å¯èƒ½æœƒæ„Ÿåˆ°ç–‘æƒ‘çš„ `${{ XXX }}` or `${XXX}` or `$XXX` è®Šæ•¸èªæ³•ã€‚

**Demo\-Env\-Vars\- \.yml:**
```yaml
name: Demo-Env-Vars

on:
  workflow_dispatch:

jobs:
  print-env-vars:
    runs-on: ubuntu-latest

    steps:
      - name: print-env
        run: env
      - name: context-vars-vs-vars
        env:
          SAY_MY_NAME: "Heisenberg"
          # GitHub Actions Context è¡¨é”å¼ï¼ŒåŒä¸‹æ–¹è§£é‡‹
          FROM_REF: "${{ github.ref }}"
        run: |
          # Sehll Script:
          # å¼•ç”¨è‡ªè¨‚æ³¨å…¥çš„ ENV è®Šæ•¸å…§å®¹
          # ${SAY_MY_NAME} or $SAY_MY_NAME éƒ½å¯ä»¥
          # ${XX} é‡åˆ°å­—ä¸²æ‹¼æ¥æ¯”è¼ƒå¥½ç”¨:
          echo "HI: ${SAY_MY_NAME}"
          
          # ğŸ’¡ GitHub Actions Context è¡¨é”å¼
          # é€™ä¸æ˜¯ shell è®Šæ•¸ï¼Œè€Œæ˜¯ YAML è§£æéšæ®µç”± GitHub Actions æ›¿æ›æˆå°æ‡‰å€¼
          # âš  åœ¨æœ¬æ©Ÿæˆ–é GitHub Actions ç’°å¢ƒåŸ·è¡Œæœƒå¤±æ•—
          # ğŸ”— https://docs.github.com/en/actions/learn-github-actions/contexts#github-context
          BRANCH_NAME_FROM_CONTEXT="${{ github.ref }}"
          
          # ğŸ’¡ GitHub Actions åŸ·è¡Œéšæ®µçš„ç’°å¢ƒè®Šæ•¸
          # é€™äº›è®Šæ•¸åœ¨ runner åŸ·è¡Œ shell æ™‚ç”± GitHub Actions è‡ªå‹•æ³¨å…¥
          # âœ… åœ¨å…¶ä»–ç’°å¢ƒå¯ç”¨ export æˆ– ENV é å…ˆå®šç¾©ç›¸åŒè®Šæ•¸
          # ğŸ”— https://docs.github.com/en/actions/learn-github-actions/environment-variables
          BRANCH_NAME_FROM_ENV_VARS="${GITHUB_REF}"
          
          echo "FROM_REF: ${FROM_REF}"
          echo "BRANCH_NAME_FROM_CONTEXT: ${BRANCH_NAME_FROM_CONTEXT}"
          echo "BRANCH_NAME_FROM_ENV_VARS: ${BRANCH_NAME_FROM_ENV_VARS}"
      - name: print-github-script-env
        uses: actions/github-script@v7
        env:
          SAY_MY_NAME: "Heisenberg"
          # GitHub Actions Context è¡¨é”å¼ï¼ŒåŒä¸Šæ–¹è§£é‡‹
          FROM_REF: "${{ github.ref }}"
        with:
          script: |
            // GitHub Script: (JavaScript (Node.js)):
            // å¾ process.env å– ENV å€¼
            console.log(`HI: ${process.env.SAY_MY_NAME}`);
            console.log(`FROM_REF: ${process.env.FROM_REF}`);
            // github-script ä¸­æœƒè‡ªå‹•æ³¨å…¥åˆ° context è®Šæ•¸ä¾› javascript ç›´æ¥å¼•ç”¨
            // https://docs.github.com/en/actions/learn-github-actions/contexts#github-context
            const branch_name_from_context_vars = context.ref;
            console.log(`branch_name_from_context_vars: ${branch_name_from_context_vars}`);
            // åŒæ¨£ä¹Ÿèƒ½ç”¨ GitHub Actions Context è¡¨é”å¼(åªæ˜¯æ„ç¾©ä¸å¤§):
            const branch_name_from_context = "${{ github.ref }}";
            console.log(`branch_name_from_context: ${branch_name_from_context}`);
            
            for (const [key, value] of Object.entries(process.env)) {
              console.log(`${key}=${value}`);
            }
            // github-script ä¸­çš„ github ç‰©ä»¶æ˜¯ Octokit REST API å¯¦ä¾‹
            // ç”¨ä¾†æ“ä½œ github api ä½¿ç”¨
            // ä¾‹å¦‚ï¼š
            // await github.rest.pulls.list({
            //   owner: context.repo.owner,
            //   repo: context.repo.repo,
            //   state: "open"
            //  });
      # gh CLI does NOT use GITHUB_TOKEN by default; requires GH_TOKEN
      - name: gh CLI without GH_TOKEN (expected to fail)
        continue-on-error: true
        run: |
          PR_COUNT=$(gh pr list --repo $GITHUB_REPOSITORY --json number --jq 'length')
          echo "Found $PR_COUNT open pull requests"
      
      - name: gh CLI with GH_TOKEN (expected to succeed)
        env:
          # Assign GH_TOKEN so gh CLI can authenticate
          # https://docs.github.com/en/actions/how-tos/security-for-github-actions/security-guides/use-github_token-in-workflows
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          PR_COUNT=$(gh pr list --repo $GITHUB_REPOSITORY --json number --jq 'length')
          echo "Found $PR_COUNT open pull requests"
      
      - name: github-script auto-authentication (no GH_TOKEN needed)
        uses: actions/github-script@v7
        with:
          script: |
            // github = Octokit REST client (auto-authenticated with GITHUB_TOKEN)
            const pulls = await github.rest.pulls.list({
              owner: context.repo.owner,
              repo: context.repo.repo,
              state: "open"
            });
            console.log(`Found ${pulls.data.length} open pull requests`);
```
#### $\{ \{ XXX \} \} GitHub Actions Context è¡¨é”å¼


![](/assets/404bd5c70040/1*e3jpPuwdmf005cjbaXjAwQ.png)



![](/assets/404bd5c70040/1*ed5Wm7Xk48xuP8yQzHpJ9w.png)

- `${{ XXX }}` æ˜¯ GitHub Actions Context è¡¨é”å¼ï¼Œ **åœ¨YAML è§£æéšæ®µç”± GitHub Actions æ›¿æ›æˆå°æ‡‰å€¼** \(å¦‚ä¸Šåœ– `BRANCH_NAME_FROM_CONTEXT` \)
- å®Œæ•´å¯ç”¨è¡¨é”å¼å¯ [åƒè€ƒå®˜æ–¹æ–‡ä»¶](https://docs.github.com/en/actions/learn-github-actions/contexts#github-context){:target="_blank"}
- `${XXX}` or `$XXX` æ˜¯çœŸå¯¦ç’°å¢ƒè®Šæ•¸ï¼Œ `${XXX}` åœ¨å­—ä¸²æ‹¼æ¥æ¯”è¼ƒå¥½ç”¨
- GitHub Actions é è¨­æœƒæ³¨å…¥ä¸€äº›ç’°å¢ƒè®Šæ•¸ï¼Œå®Œæ•´å¯ [åƒè€ƒå®˜æ–¹æ–‡ä»¶](https://docs.github.com/en/actions/learn-github-actions/environment-variables){:target="_blank"}

#### actions/github\-script@v7


![](/assets/404bd5c70040/1*TjJQnlAAU3VRwS9_dFz1yA.png)



![](/assets/404bd5c70040/1*5bHEdjrGsVdWnYSQgpnsZA.png)

- åœ¨ `github-script` ä¸­åŒæ¨£å¯ä»¥ç”¨ `${{ XXX }}` æ˜¯ GitHub Actions Context è¡¨é”å¼ï¼Œä½†æ˜¯æ„ç¾©ä¸å¤§ï¼›å› ç‚º **åœ¨ github\-scirpt ç’°å¢ƒä¸­é è¨­æœƒæ³¨å…¥ context è®Šæ•¸å¯ä»¥ç›´æ¥åœ¨ javascript ä¸­å¼•ç”¨**
- åœ¨ `github-script` ä¸­ `github` ç‰©ä»¶æ˜¯ Octokit REST API å¯¦ä¾‹
- `github-script` ä¹Ÿèƒ½å¾ `env:` æ³¨å…¥è®Šæ•¸ï¼Œä½†æ˜¯è¦ç”¨ `${process.env.xxx}` å­˜å–
- åŒæ¨£é è¨­æœƒæ³¨å…¥ä¸€äº›ç’°å¢ƒè®Šæ•¸ï¼Œå®Œæ•´å¯ [åƒè€ƒå®˜æ–¹æ–‡ä»¶](https://docs.github.com/en/actions/learn-github-actions/environment-variables){:target="_blank"} `${process.env.xxx}` å­˜å–ï¼›ä½†æ˜¯å·²ç¶“æœ‰ `context` è®Šæ•¸äº†ï¼Œå¾é€™å­˜å–æ„ç¾©ä¹Ÿä¸å¤§



![](/assets/404bd5c70040/1*oW85Sju0sN4caXiaLSg32A.png)

- `github-script` æœƒè‡ªå‹•å¸¶å…¥ `github-token` ï¼Œç„¡éœ€æŒ‡å®š

#### gh cli GH\_TOKEN


![](/assets/404bd5c70040/1*NUfaaKIobZWVBuXrGg0TPw.png)

- åœ¨ GitHub Actions Shell Script ä½¿ç”¨ `gh cli` éœ€æŒ‡å®š `GH_TOKEN` åƒæ•¸
- å¯ä»¥ç›´æ¥å¸¶å…¥é è¨­ Token â€” `secrets.GITHUB_TOKEN` \(GitHub Actions åŸ·è¡Œæ™‚è‡ªå‹•ç”¢ç”Ÿ\)
- **é è¨­ Token æœ‰ä¸€äº›åŸºæœ¬æ¬Šé™ï¼Œå¦‚æœè¦æ“ä½œçš„æŒ‡ä»¤æ¬Šé™ä¸å¤ å°±è¦æ”¹ç”¨ [Personal Access Token](https://docs.github.com/en/actions/how-tos/security-for-github-actions/security-guides/use-github_token-in-workflows){:target="_blank"}** ï¼Œåœ˜éšŠä½¿ç”¨å»ºè­°ç”¨å…±ç”¨å¸³è™Ÿå»ºç«‹ PATã€‚


**å®Œæ•´ç¨‹å¼ç¢¼ï¼š [Demo\-Env\-Vars\- \.yml](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/blob/main/.github/workflows/Demo-Env-Vars-.yml){:target="_blank"}**

GitHub Actions å·²ç¶“é–‹ç™¼å¥½äº†ï¼Œä¸‹ä¸€æ­¥æˆ‘å€‘å¯ä»¥æŠ½æ› GitHub Hosted Runner æˆè‡ªå·±çš„ Self\-hosted Runnerã€‚


> _GitHub Hosted Runner æœ‰å…è²»é¡åº¦ 2,000 åˆ†é˜ä¸€å€‹æœˆ\(èµ·\)ï¼Œè·‘é€™ç¨®å°çš„è‡ªå‹•åŒ–ä»»å‹™èŠ±ä¸äº†å¤šå°‘æ™‚é–“ï¼Œè€Œä¸”æ˜¯è·‘åœ¨ linux æ©Ÿå™¨èŠ±è²»å¾ˆä½ï¼Œå¯èƒ½é‚„ç”¨ä¸åˆ°å…è²»ä¸Šé™ï¼› **ä¸ä¸€å®šè¦æ”¹æˆ Self\-hosted Runner** ï¼Œæ”¹ Runner é‚„è¦ç¢ºä¿ Runner ç’°å¢ƒæ­£ç¢º\(ä¾‹å¦‚ GitHub Hosted Runner è‡ªå¸¶ gh cliï¼Œself\-hosted Runner å°±è¨˜å¾—è¦è‡ªå·±å®‰è£å¥½\)ï¼Œ **æœ¬æ–‡ç´”ç²¹æ˜¯å› ç‚ºæ•™å­¸æ‰æœƒé€™æ¨£æŠ½æ›** ã€‚_ 
 

> _å¦‚æœæ˜¯ç”¨åœ¨åŸ·è¡Œ CI/CD ä»»å‹™æ‰å¿…é ˆè¦ç”¨ Self\-hosted Runnerã€‚_ 




#### æ–°å¢ Self\-hosted Runner


> _æœ¬æ–‡ä»¥ **macOS M1** ç‚ºä¾‹ã€‚_ 






![](/assets/404bd5c70040/1*mEInaj-tLaprMAa2OfowCw.png)

- Settings â†’ Actions â†’ Runners â†’ New self\-hosted runnerã€‚
- **Runner image:** macOS
- **Architecture** : M1 è¨˜å¾—é¸ ARM64 åŸ·è¡Œæ¯”è¼ƒå¿«


**åœ¨å¯¦é«”é›»è…¦ä¸Šé–‹ä¸€å€‹ Termnialã€‚**

**æŒ‰ç…§ Download æ­¥é©Ÿåœ¨æœ¬åœ°é›»è…¦å®Œæˆï¼š**
```bash
# åœ¨ä½ æƒ³è¦çš„è·¯å¾‘ï¼Œå»ºç«‹ Runner ç›®éŒ„
mkdir actions-runner && cd actions-runner
# ä¸‹è¼‰ Runner image
curl -o actions-runner-osx-x64-2.325.0.tar.gz -L https://github.com/actions/runner/releases/download/v2.325.0/actions-runner-osx-x64-2.325.0.tar.gz

# Optional: Validate the hash
echo "0562bd934b27ca0c6d8a357df00809fbc7b4d5524d4aeb6ec152e14fd520a4c3  actions-runner-osx-x64-2.325.0.tar.gz" | shasum -a 256 -c

# è§£å£“ç¸®
tar xzf ./actions-runner-osx-x64-2.325.0.tar.gz
```


> _ä»¥ä¸Šåªæ˜¯åƒè€ƒï¼›å»ºè­°ç…§ä½ è¨­å®šé è£¡çš„æ­¥é©Ÿä¾†åšï¼Œæ‰æœƒæ˜¯æœ€æ–°ç‰ˆæœ¬çš„ Runner imageã€‚_ 






![](/assets/404bd5c70040/1*Q0k0EPjrY2V4owseESe5lg.png)


**è¨­å®š Configure:**
```bash
# è«‹åƒè€ƒè¨­å®šé æŒ‡ä»¤ï¼ŒToken æœƒéš¨æ™‚é–“æ”¹è®Š
./config.sh --url https://github.com/ORG/REPO --token XXX
```

æœƒä¾åºè¦ä½ è¼¸å…¥ï¼š
- Enter the name of the runner group to add this runner to: \[press Enter for Default\] **ç›´æ¥ Enter** 
\*åªæœ‰è¨»å†Šåˆ° Organization çµ„ç¹”å±¤ç´šçš„ Runner æ‰æœ‰ Group åˆ†çµ„åŠŸèƒ½
- Enter the name of runner: \[press Enter for ZhgChgLideMacBook\-Pro\] **å¯ä»¥è¼¸å…¥æƒ³è¨­å®šçš„ Runner åç¨± e\.g\.** `app-runner-1` **æˆ–ç›´æ¥ Enter**
- This runner will have the following labels: â€˜self\-hostedâ€™, â€˜macOSâ€™, â€˜X64â€™
Enter any additional labels \(ex\. label\-1,label\-2\): \[press Enter to skip\] 
**è¼¸å…¥æƒ³è¦è¨­å®šçš„ Runner labelï¼Œå¯ä»¥å¤šè¼¸å…¥è‡ªè¨‚ Label æ–¹ä¾¿ä¹‹å¾Œä½¿ç”¨** 
åŒå‰è¿° GitHub Acitons/Runner æ˜¯ä¾ç…§å°æ‡‰ Label æ‰¾ä»»å‹™ä¾†åšï¼Œ **å¦‚æœåªç”¨ default labelï¼ŒRunner å¯èƒ½æœƒæ’¿åˆ°çµ„ç¹”å…§çš„å…¶ä»– Runner ä¾†åŸ·è¡Œå·¥ä½œï¼Œè‡ªè¨‚ä¸€å€‹æœ€ä¿éšª** ã€‚ 
é€™é‚Šæˆ‘è‡ªå·±äº‚å®šäº†ä¸€å€‹ label `self-hosted-zhgchgli`
- Enter name of work folder: \[press Enter for \_work\] **ç›´æ¥ Enter**


å‡ºç¾ âˆš Settings Saved\. ä»£è¡¨è¨­å®šå®Œæˆäº†ã€‚


![](/assets/404bd5c70040/1*yxLfii0rWhzsiFuYVmPgFw.png)


**å•Ÿå‹• Runner:**
```bash
./run.sh
```

å‡ºç¾ âˆš Connected to GitHubã€Listening for Jobs å°±ä»£è¡¨å·²ç¶“åœ¨ç›£è½ Actions ä»»å‹™äº†ï¼š


![](/assets/404bd5c70040/1*1RmPPOosAoCxHA9tg_WE2w.png)



> **_é€™å€‹ Terminal è¦–çª—ä¸é—œé–‰å°±æœƒæŒçºŒæ¥æ”¶ä»»å‹™ä¾†åšã€‚_** 
 

> **_ğŸš€ğŸš€ğŸš€åŒä¸€å°é›»è…¦é–‹å¤šå€‹ Terminal åœ¨ä¸åŒç›®éŒ„å°±èƒ½èµ·å¤šå€‹ Runnerã€‚_** 





**å›åˆ° Repo è¨­å®šé ä¹Ÿèƒ½çœ‹åˆ° Runner æ­£åœ¨ç­‰å¾…ä»»å‹™ï¼š**


![](/assets/404bd5c70040/1*jjq5NTPYMuC3gH3ey_VTtg.png)


**Status:**
- Idle: é–‘ç½®ï¼Œåœ¨ç­‰å¾…ä»»å‹™
- Active: æœ‰ä»»å‹™æ­£åœ¨åŸ·è¡Œ
- Offline: Runner ä¸åœ¨ç·šä¸Š

#### Workflow\(GitHub Actions\) Runner æ”¹ç”¨ Self\-hosted Runner

ä»¥ `Automation-PullRequest.yml` ç‚ºä¾‹ï¼š
```yaml
# è«‹åƒè€ƒå‰æ–‡ï¼Œç•¥....
jobs:
  label-pr-by-file-count:
    # è«‹åƒè€ƒå‰æ–‡ï¼Œç•¥....
    runs-on: [self-hosted-zhgchgli]
    # è«‹åƒè€ƒå‰æ–‡ï¼Œç•¥....
  # ---------
  assign-self-if-no-assignee:
    # è«‹åƒè€ƒå‰æ–‡ï¼Œç•¥....
    runs-on: [self-hosted-zhgchgli]

    steps:
      # è«‹åƒè€ƒå‰æ–‡ï¼Œç•¥....
```

Commit æª”æ¡ˆåˆ° Repo ä¸»åˆ†æ”¯ä¹‹å¾Œï¼Œé‡æ–°é–‹ PR è§¸ç™¼é©—è­‰ä¸€ä¸‹ Actionsã€‚

**å›åˆ° Runner Terminal å°±èƒ½çœ‹åˆ°æœ‰æ–°çš„ä»»å‹™é€²ä¾†äº†ï¼Œæ­£åœ¨åŸ·è¡Œè·ŸåŸ·è¡Œçµæœï¼š**


![](/assets/404bd5c70040/1*Hu0DxKQbenPmBEw8swv65A.png)


å¤±æ•—äº†ï¼Œå› ç‚ºæˆ‘æœ¬æ©Ÿé›»è…¦æ²’æœ‰å®‰è£ [gh cli](https://github.com/cli/cli){:target="_blank"} ç’°å¢ƒï¼š


![](/assets/404bd5c70040/1*9xguacdPATIeEZdbFszmHw.png)


ä½¿ç”¨ `brew install gh` åœ¨å¯¦é«”é›»è…¦ä¸Šå®‰è£å®Œ gh å¾Œå†æ¬¡è§¸ç™¼åŸ·è¡Œï¼š


![](/assets/404bd5c70040/1*TbkAt00K89Ysbix33dK8ZA.png)


æˆåŠŸï¼ç¾åœ¨é€™å€‹ä»»å‹™å°±å®Œå…¨æ˜¯ä½¿ç”¨æˆ‘å€‘è‡ªå·±çš„é›»è…¦åœ¨åŸ·è¡Œï¼Œä¸ä½¿ç”¨ GitHub Hosted Runnerã€ä¸è¨ˆè²»ä½¿ç”¨ã€‚

**æˆ‘å€‘å¯ä»¥é»é€²å» Action Log æŸ¥çœ‹ä»»å‹™åŸ·è¡Œåœ¨çš„ Runnerã€æ©Ÿå™¨æ˜¯å“ªä¸€å€‹ï¼š**


![](/assets/404bd5c70040/1*oqLcWfn6cbWsCt9fVsrikQ.png)

#### runs\-on: \[ **Runner Label\] è¨­å®š**

é€™è£¡æ˜¯ AND ä¸æ˜¯ ORï¼ŒGitHub Runner æš«ä¸æ”¯æ´ OR æŒ‘é¸ Runner åŸ·è¡Œã€‚

ä¾‹å¦‚ï¼š `[self-hosted, macOS, app]` â†’ ä»£è¡¨ Runner è¦ **åŒæ™‚æœ‰** `self-hosted, macOS, app` é€™ 3 å€‹ Labels æ‰æœƒåŒ¹é…æ¥ä»»å‹™ä¾†åŸ·è¡Œã€‚

å¦‚æœä¸€å€‹ Job æƒ³åŒæ™‚æ¸¬è©¦ä¸åŒ Runner ç’°å¢ƒä¸‹çš„çµæœå¯ä»¥ä½¿ç”¨ `matrix` åƒæ•¸ï¼š
```yaml
jobs:
  test:
    runs-on: ${{ matrix.runner }}
    strategy:
      matrix:
        runner:
          - [self-hosted, linux, high-memory]
          - [self-hosted, macos, xcode-15]

    steps:
      - run: echo "Running on ${{ matrix.runner }}"
```

é€™æ¨£é€™å€‹ Job æœƒåœ¨ä¸‹åˆ—å…©å€‹ Runner Labels Runner ä¸­ä¸¦è¡Œå„åŸ·è¡Œä¸€æ¬¡ï¼š
- self\-hosted, linux, high\-memory
- self\-hosted, macos, xcode\-15



> **_Runner æš«ä¸æ”¯æ´ï¼š_** 
 

> _\- OR æŒ‘é¸ Runner_ 
 

> _\- Runner æ¬Šé‡è¨­å®š_ 




#### è¨»å†Š Runner æˆ Service

å¯ä»¥åƒè€ƒå®˜æ–¹æ–‡ä»¶ã€Œ [Configuring the self\-hosted runner application as a service](https://docs.github.com/en/actions/how-tos/hosting-your-own-runners/managing-self-hosted-runners/configuring-the-self-hosted-runner-application-as-a-service?platform=mac){:target="_blank"} ã€å°‡ Runner ç›´æ¥è¨»å†Šæˆç³»çµ± Serviceï¼Œé€™æ¨£å°±èƒ½åœ¨èƒŒæ™¯åŸ·è¡Œ\(ä¸ç”¨é–‹ Terminal åœ¨å‰æ™¯\)ã€é–‹æ©Ÿå¾Œä¹Ÿæœƒè‡ªå‹•å•Ÿå‹•ã€‚

æœ‰å¤šå€‹ Runner è¨˜å¾—èª¿æ•´ã€Œ [Customizing the self\-hosted runner service](https://docs.github.com/en/actions/how-tos/hosting-your-own-runners/managing-self-hosted-runners/configuring-the-self-hosted-runner-application-as-a-service?platform=mac#customizing-the-self-hosted-runner-service-1){:target="_blank"} ã€è¨­å®šè¨»å†Šä¸åŒåç¨±ã€‚


> _iOS é€™é‚Šæˆ‘æœ‰ä¸€å€‹å¾…ç ”ç©¶æ’é™¤çš„å•é¡Œï¼Œ **å°±æ˜¯æˆ‘æ”¹ç”¨èƒŒæ™¯ Service ä¹‹å¾Œåœ¨ Archive æœƒé‡åˆ°éŒ¯èª¤\(ç–‘ä¼¼æ˜¯è·Ÿ keychain æ¬Šé™æœ‰é—œ\)** ï¼Œç•¶æ™‚æ²’æ™‚é–“è§£æ±ºï¼Œå°±å…ˆç”¨èµ·å‰æ™¯ Terminal Runner äº†ã€‚_ 





å¦‚æœæ˜¯å‚³çµ±å‰æ™¯è¦åšåˆ°é–‹æ©Ÿè‡ªå‹•å•Ÿå‹•å°±è¦å» `~/Library/LaunchAgents` æ–°å¢ä¸€å€‹è‡ªå‹•å•Ÿå‹•è¨­å®šæª”æ¡ˆï¼š

`actions.runner.REPO.RUNNER_NAME.plist` ï¼š
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
 <dict>
  <key>Label</key>
  <string>actions.runner.REPO.RUNNER_NAME</string>
  <!-- æŒ‡å®š Terminal.app ä¾†å•Ÿå‹• -->
  <key>ProgramArguments</key>
  <array>
   <string>/usr/bin/open</string>
   <string>-a</string>
   <string>Terminal</string>
   <string>/Users/zhgchgli/Documents/actions-runner/run.sh</string>
  </array>
  <key>RunAtLoad</key>
  <true/>
  <key>WorkingDirectory</key>
  <string>/Users/zhgchgli/Documents/actions-runner</string>
 </dict>
</plist>
```


> _æœ‰èˆˆè¶£æ·±å…¥ç ”ç©¶ DevOps çš„æœ‹å‹å¯åƒè€ƒå®˜æ–¹ [k8s Runner](https://docs.github.com/en/actions/concepts/runners/about-actions-runner-controller#scaling-runners){:target="_blank"} æ–‡ä»¶ã€‚_ 




#### å®Œæ•´å°ˆæ¡ˆ Repo


[![](https://opengraph.githubassets.com/8b25f8eae56bc35c92b97c5d7e7834aa5cb87673e718a1ce829f5bb80f3edebb/ZhgChgLi/github-actions-ci-cd-demo)](https://github.com/ZhgChgLi/github-actions-ci-cd-demo){:target="_blank"}

### å®˜æ–¹æ–‡ä»¶


[![](https://docs.github.com/assets/cb-345/images/social-cards/actions.png)](https://docs.github.com/en/actions/get-started/quickstart){:target="_blank"}


æ›´ç´°ç¯€çš„è¨­ç½®æ–¹å¼è«‹å‹™å¿…åƒè€ƒå®˜æ–¹æ‰‹å†Šã€‚
#### AI Can Help\!


![](/assets/404bd5c70040/1*JecNUCqujV1oeAvHA14X-g.png)


å¯¦æ¸¬çµ¦ ChatGPT å®Œæ•´çš„æ­¥é©Ÿè·Ÿæ™‚æ©Ÿé»å°±èƒ½å¹«ä½ å¯«å¥½ GitHub Actions ç›´æ¥ä½¿ç”¨\!
### ç¸½çµ

ç¾åœ¨ä½ æ‡‰è©²å·²ç¶“å° GitHub Actions \+ Self\-hosted Runner æœ‰äº†ä¸€å®šç¨‹åº¦çš„äº†è§£ï¼Œä¸‹ä¸€ç¯‡æˆ‘å°‡é–‹å§‹ä»¥ App \(iOS\) CI/CD ç‚ºæ¡ˆä¾‹ï¼Œæ‰‹æŠŠæ‰‹å»ºç½®æ•´å¥—æµç¨‹ã€‚
### ç³»åˆ—æ–‡ç« ï¼š
- [**CI/CD å¯¦æˆ°æŒ‡å—ï¼ˆä¸€ï¼‰ï¼šCI/CD æ˜¯ä»€éº¼ï¼Ÿå¦‚ä½•é€é CI/CD æ‰“é€ ç©©å®šé«˜æ•ˆçš„é–‹ç™¼åœ˜éšŠï¼Ÿå·¥å…·é¸æ“‡ï¼Ÿ**](../c008a9e8ceca/)
- [**CI/CD å¯¦æˆ°æŒ‡å—ï¼ˆäºŒï¼‰ï¼šGitHub Actions èˆ‡ self\-hosted Runner ä½¿ç”¨èˆ‡å»ºç½®å¤§å…¨**](../404bd5c70040/)
- [**CI/CD å¯¦æˆ°æŒ‡å—ï¼ˆä¸‰ï¼‰ï¼šä½¿ç”¨ GitHub Actions å¯¦ä½œ App å°ˆæ¡ˆçš„ CI èˆ‡ CD å·¥ä½œæµç¨‹**](../4b001d2e8440/)
- [**CI/CD å¯¦æˆ°æŒ‡å—ï¼ˆå››ï¼‰ï¼šä½¿ç”¨ Google Apps Script Web App ä¸²æ¥ GitHub Actions å»ºç½®å…è²»æ˜“ç”¨çš„æ‰“åŒ…å·¥å…·å¹³å°**](../4273e57e7148/)

#### [Buy me a coffee](https://www.buymeacoffee.com/zhgchgli){:target="_blank"}


> [**_æœ¬ç³»åˆ—æ–‡ç« èŠ±è²»äº†å¤§é‡çš„æ™‚é–“ç²¾åŠ›æ’°å¯«ï¼Œå¦‚æœå…§å®¹å°æ‚¨æœ‰å¹«åŠ©ã€å°æ‚¨çš„åœ˜éšŠæœ‰å¯¦è³ªæå‡å·¥ä½œæ•ˆç‡èˆ‡ç”¢å“å“è³ªï¼›æ­¡è¿è«‹æˆ‘å–æ¯å’–å•¡ï¼Œæ„Ÿè¬æ”¯æŒï¼_**](https://www.buymeacoffee.com/zhgchgli){:target="_blank"} 






![[Buy me a coffee](https://www.buymeacoffee.com/zhgchgli){:target="_blank"}](/assets/404bd5c70040/1*QJj54G9gOjtQS-rbHVT1SQ.png)

[Buy me a coffee](https://www.buymeacoffee.com/zhgchgli){:target="_blank"}


æœ‰ä»»ä½•å•é¡ŒåŠæŒ‡æ•™æ­¡è¿ [èˆ‡æˆ‘è¯çµ¡](https://www.zhgchg.li/contact){:target="_blank"} ã€‚



_[Post](https://dev.zhgchg.li/ci-cd-%E5%AF%A6%E6%88%B0%E6%8C%87%E5%8D%97-%E4%BA%8C-github-actions-%E8%88%87-self-hosted-runner-%E4%BD%BF%E7%94%A8%E8%88%87%E5%BB%BA%E7%BD%AE%E5%A4%A7%E5%85%A8-404bd5c70040){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}._