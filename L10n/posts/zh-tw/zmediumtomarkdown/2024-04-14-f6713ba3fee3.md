---
author: ZhgChgLi
categories:
- ZRealm Robotic Process Automation
date: 2024-04-14T15:16:45.469+0000
description: ä½¿ç”¨ Google Apps Script é€²è¡Œ Google Workspace ç›¸é—œæœå‹™ä¹‹ Robotic Process Automation
  è‡ªå‹•åŒ–
image:
  path: /assets/f6713ba3fee3/1*jZmdNWSYQUq6Ja9PKaawWw.jpeg
last_modified_at: 2024-10-20T06:06:10.632+0000
render_with_liquid: false
tags:
- ios-app-development
- roboticprocessautomation
- rpa-solutions
- google-apps-script
- google-sheets
title: ä½¿ç”¨ Google Apps Script å¯¦ç¾æ¯æ—¥æ•¸æ“šå ±è¡¨ RPA è‡ªå‹•åŒ–
---

### ä½¿ç”¨ Google Apps Script å¯¦ç¾æ¯æ—¥æ•¸æ“šå ±è¡¨ RPA è‡ªå‹•åŒ–

ä½¿ç”¨ Google Apps Script é€²è¡Œ Google Workspace ç›¸é—œæœå‹™ä¹‹ Robotic Process Automation è‡ªå‹•åŒ–



![Photo by [Possessed Photography](https://unsplash.com/@possessedphotography?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash){:target="_blank"}](/assets/f6713ba3fee3/1*jZmdNWSYQUq6Ja9PKaawWw.jpeg)

Photo by [Possessed Photography](https://unsplash.com/@possessedphotography?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash){:target="_blank"}
### Robotic Process Automation

RPA \(Robotic Process Automation\) ä¸­æ–‡ç¿»è­¯ç‚ºã€Œæµç¨‹è‡ªå‹•åŒ–æ©Ÿå™¨äººã€å›é¡§äººé¡ç™¼å±•æ­·å²ï¼Œå¾å¾’æ‰‹æ¡é›†åˆ°çŸ³å™¨æ™‚ä»£å†åˆ°è¾²è€•æ–‡æ˜ï¼Œå¾ä¸Šå€‹ä¸–ç´€çš„å·¥æ¥­é©å‘½é–‹å§‹åˆ°è¿‘ 20 å¹´çš„è³‡è¨Šå´›èµ·ï¼Œäººé¡çš„å·¥ä½œæ•ˆç‡èˆ‡ç”¢èƒ½æœ‰äº†æŒ‡æ•¸ç´šçš„é£›èºæˆé•·ï¼›é€™ä¸€è·¯ä¸Šç„¡è™•ä¸åœ¨ RPA æ‡‰ç”¨çš„èº«å½±ï¼Œè¾²è€•æ™‚æœŸçš„æ°´è»Š\(è‡ªå‹•åŒ–è„«ç©€å·¥ä½œ\)ã€å·¥æ¥­é©å‘½çš„ç´¡ç¹”æ©Ÿ\(è‡ªå‹•åŒ–ç´¡ç¹”å·¥ä½œ\)ã€å·¥å» æ©Ÿæ¢°æ‰‹è‡‚\(è‡ªå‹•åŒ–çµ„è£å·¥ä½œ\)ï¼Œæœ€å¾Œæ˜¯æœ¬ç¯‡è¦ä»‹ç´¹çš„ï¼Œè‡ªå‹•åŒ–è³‡è¨Šç›¸é—œå·¥ä½œï¼Œä¾‹å¦‚ï¼šè‡ªå‹•æŸ¥è©¢å ±è¡¨ã€è‡ªå‹•é€šçŸ¥â€¦ç­‰ç­‰å·¥ä½œã€‚

èªªä¾†æ…šæ„§ï¼Œæˆ‘ä¹Ÿæ˜¯æœ€è¿‘æ‰çŸ¥é“é€™å€‹åè©ï¼Œæ‰“å¾å¾ç¬¬ä¸€ä»½å·¥ä½œé–‹å§‹ \(7 å¹´å‰\)ï¼Œå°±ä¸€ç›´æœ‰åœ¨åš RPA çš„äº‹ï¼Œè«¸å¦‚æ’°å¯«çˆ¬èŸ²çµ±è¨ˆæ•¸æ“šã€è‡ªå‹•åŒ– CI/CD æµç¨‹ã€è‡ªå‹•åŒ–æŸ¥è©¢æ•¸æ“šã€è‡ªå‹•åŒ–ç©©å®šæ€§æ•¸æ“šå‘Šè­¦ã€è‡ªå‹•åŒ–æ¯æ—¥ä¾‹è¡Œæ“ä½œâ€¦ç­‰ç­‰ï¼›ä¸éä»¥å¾€æˆ‘éƒ½ä»¥ã€Œè‡ªå‹•åŒ–ã€ä¸‰å€‹å­—ä½œç‚ºä»£ç¨±ï¼Œæ˜¯æ™‚å€™çµ¦ä»–ä¸€å€‹æ­£åäº† â€” RPA \(Robotic Process Automation\)ã€‚

**ä¹‹å‰æ‰€åšçš„ RPA æ›´å¤šåªé—œæ³¨åœ¨ã€Œå‹•æ‰‹å¯«ç¨‹å¼å¯¦ç¾è‡ªå‹•åŒ–å·¥ä½œè§£æ±ºå–®ä¸€å•é¡Œã€ä¸Š** ï¼Œå°‘äº†å‰æœŸçš„å®Œæ•´è©•ä¼°èˆ‡åˆ†æã€No/Low Code å·¥å…·ä½¿ç”¨ã€æ³•è¦ã€é‹è¡Œç›£æ§ã€å¯¦éš›æ•¸æ“šçµ±è¨ˆã€æŒçºŒæ”¹é€²ã€ä¼æ¥­æ–‡åŒ–æ¨å»£â€¦ç­‰ç­‰ï¼Œé€™éƒ½æ˜¯å®Œæ•´çš„ RPA éœ€è¦åšçš„äº‹ï¼›ä¸éå¦‚åŒå‰é¢æ‰€èªªï¼Œæˆ‘ä¹Ÿæ˜¯æœ€è¿‘æ‰çŸ¥é“é€™å€‹å°ˆæ¥­é ˜åŸŸï¼Œå°±å®¹æˆ‘é‚„æ˜¯å…ˆä»¥å¯¦ä½œæ–¹é¢æ°´ä¸€ç¯‡æ–‡ç« å§ï¼

æä¾› RPA æœå‹™çš„å¹³å°æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚ Automation Anywhere,UiPath, Microsoft Power Automate, Blue Prism æˆ–æ˜¯ Zapier, IFTTT, Automate\.io â€¦
è¦ä¾ç…§å¯¦éš›æƒ³è§£æ±ºçš„å•é¡Œèˆ‡å¹³å°æŒ‘é¸é©åˆçš„æœå‹™ã€‚

æ¨è–¦ä¸€å¥—å…è²»é–‹æºåŸºæ–¼ç€è¦½å™¨çš„ RPA Tool: [Automa](https://chromewebstore.google.com/detail/automa/infppggnoaenmfagbfknfkancpbljcca){:target="_blank"} ã€‚


> **_å¦å¤–å»£ç¾©ä¾†èªªï¼Œå°‡äººèˆ‡äººæˆ–äººèˆ‡äº‹çš„ä¸»å‹•ä¾è³´è½‰åŒ–æˆäººå°å¹³å°ã€äº‹å°å¹³å°çš„ä¾è³´ä¹Ÿæ˜¯ä¸€ç¨® RPAã€‚_** 
 

> **_ä¾‹å¦‚ï¼šçµ±ä¸€ä½¿ç”¨ Asana/Jiraâ€¦ç­‰å°ˆæ¡ˆç®¡ç†å·¥å…·çµ±ä¸€ç®¡ç†å·¥ä½œäº‹é …ã€‚_** 





> **_åŸºæ–¼ä¸»å‹•è½‰è¢«å‹•çš„ç†å¿µï¼ŒåŸæœ¬éœ€è¦äººå·¥ä¸Šå»æª¢æŸ¥æœ‰ç„¡æ–°é€šçŸ¥çš„æœå‹™ï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥å¯¦ç¾ä¸€å€‹ RPAï¼Œç•¶æœ‰æ–°è®Šå‹•æ™‚è‡ªå‹•é€šçŸ¥æˆ‘å€‘ã€‚_** 
 

> **_ä¾‹å¦‚ï¼šä¹‹å‰å¯¦ç¾éçš„ [Gmail to Slack](../d414bdbdb8c9/) å°‡ç‰¹å®šé€šçŸ¥ä¿¡ä»¶è½‰ç™¼åˆ°å·¥ä½œç¾¤çµ„ã€‚_** 




#### Robotic Process Automation çš„æ•ˆç›Šè©•ä¼°

ä¹‹å‰åœ¨ã€Œ [**2021 Pinkoi Tech Career Talk â€” é«˜æ•ˆç‡å·¥ç¨‹åœ˜éšŠå¤§è§£å¯†**](../11f6c8568154/) ã€åˆ†äº«éç©å°‘æˆå¤šåŠå¿ƒæµä¸­æ–·çš„æˆæœ¬å•é¡Œï¼›å‡è¨­ä¸€ä»¶ä¾‹è¡Œé‡è¤‡æ€§çš„å·¥ä½œï¼Œæ¯æ¬¡éœ€è¦èŠ±è²» 15 åˆ†é˜è§£æ±ºï¼Œæ¯é€±æœƒç™¼ç”Ÿ 10 æ¬¡ï¼Œä¸€å¹´ä¸‹ä¾†å°±æµªè²»å°‡è¿‘ 130 å°æ™‚ï¼›å¦‚æœå†ç®—ä¸Šã€Œå¿ƒæµåˆ‡æ›ã€æˆæœ¬ï¼Œæœ€çµ‚å¯èƒ½æµªè²»è¿‘ 200 å°æ™‚ä¸€å¹´ã€‚


![[**2021 Pinkoi Tech Career Talk â€” é«˜æ•ˆç‡å·¥ç¨‹åœ˜éšŠå¤§è§£å¯†**](../11f6c8568154/)](/assets/f6713ba3fee3/1*U6bzH6b5-PRxFBktvkOa2Q.png)

[**2021 Pinkoi Tech Career Talk â€” é«˜æ•ˆç‡å·¥ç¨‹åœ˜éšŠå¤§è§£å¯†**](../11f6c8568154/)


> å¿ƒæµåˆ‡æ›çš„æ„æ€æ˜¯ï¼Œç•¶æˆ‘å€‘å°ˆæ³¨åœ¨é‡è¦çš„äº‹æƒ…ä¸Šåšå¾—æ­£ High\! æ™‚ï¼Œéœ€è¦æš«åœå»è™•ç†å…¶ä»–äº‹æƒ…ï¼Œè™•ç†å®Œç•¢å†å›ä¾†é‡æ–°é€²å…¥ç‹€æ…‹æ‰€è€—è²»çš„æ™‚é–“ã€‚ 





é–‹ç™¼ RPA çš„æ•ˆç›Šè©•ä¼°å¯åƒè€ƒä¸‹åœ–ï¼Œåªè¦é–‹ç™¼æ‰€éœ€æ™‚é–“è·Ÿé‡åˆ°çš„é »ç‡å¤§æ–¼æ‰€æµªè²»çš„æ™‚é–“ï¼Œå°±å€¼å¾—æŠ•å…¥è³‡æºå¯¦ç¾ï¼š


![[https://twitter\.com/swyx/status/1196401158744502272](https://twitter.com/swyx/status/1196401158744502272){:target="_blank"}](/assets/f6713ba3fee3/1*B8Zs8QyRv4KxQZJEBi81lA.png)

[https://twitter\.com/swyx/status/1196401158744502272](https://twitter.com/swyx/status/1196401158744502272){:target="_blank"}
- X è»¸ï¼šä»»å‹™ç™¼ç”Ÿé »ç‡ ex: 50/Day \(50æ¬¡ä¸€å¤©\)
- Y è»¸ï¼šä»»å‹™æ¯æ¬¡éœ€èŠ±è²»å¤šå°‘äººåŠ›æ™‚é–“æ‰èƒ½å®Œæˆ
- è€—è²»æ™‚é–“ Range æŠ“ 5 å¹´ä¾†ç®—ï¼Œè¡¨æ ¼ä¸­é–“è¡¨ç¤º 5 å¹´ä¸‹ä¾†æµªè²»çš„æ™‚é–“äººåŠ›æˆæœ¬
- ç™½è‰²ç‚ºå¯èƒ½æŠ•å…¥åšè‡ªå‹•åŒ–çš„æ™‚é–“æˆæœ¬å¤§æ–¼èƒ½å¾—åˆ°çš„æ•ˆç›Šï¼Œä¸å€¼å¾—æ”¹å–„
- ç¶ è‰²è¡¨ç¤ºå€¼å¾—è‡ªå‹•åŒ–çš„é …ç›®
- ç´…è‰²ç‚ºå¼·çƒˆå»ºè­°è½‰ç‚ºè‡ªå‹•åŒ–



> **_é™¤äº†ç¯€çœæ™‚é–“ä¹‹å¤–ï¼Œè‡ªå‹•çš„åˆ¶å¼åŒ–æµç¨‹ä¹Ÿèƒ½æ¸›å°‘äººå·¥å‡ºéŒ¯æ©Ÿç‡ï¼Œæå‡ç©©å®šæ€§ã€‚_** 




#### Robotic Process Automation è·Ÿ AI çš„é—œä¿‚

éš¨è‘— AI èˆˆèµ·ï¼ŒRPA ä¹Ÿç¶“å¸¸è¢«æåŠï¼›ä½†æˆ‘è¦ºå¾— RPA èˆ‡ AI ä¸¦ç„¡ç›´æ¥é—œä¿‚ï¼Œ **æ²’æœ‰ AI çš„å¹´ä»£æ—©å°±æœ‰ RPAï¼Œä¼æ¥­å°å…¥ AI çš„å¹«åŠ©å¯èƒ½é‚„æ²’æœ‰å®Œå–„ RPA çš„æ•ˆç›Šä¾†å¾—é«˜ï¼ŒRPA æ›´å¤šçš„é‚„æ˜¯ä¼æ¥­æ–‡åŒ–ã€å·¥ä½œç¿’æ…£çš„å•é¡Œ** ï¼›ä¸éä¸å¯å¦èª AI ç¢ºå¯¦èƒ½å¹«åŠ© RPA é‚å‘ä¸‹ä¸€å€‹å±¤æ¬¡ï¼Œä¾‹å¦‚ä»¥å¾€ RPA åªèƒ½åšç¢ºåˆ‡ã€ä¾‹è¡Œçš„å·¥ä½œï¼Œæœ‰äº† AI å°±èƒ½åšä¸€äº›æ¨¡ç³Šçš„ã€è¼ƒå‹•æ…‹çš„ã€æ™ºèƒ½åˆ¤æ–·çš„å·¥ä½œã€‚
### Robotic Process Automation at Google Workspace

Google Workspace \(èˆŠç¨± G Suite\)ï¼Œæ˜¯æˆ‘å€‘æ—¥å¸¸è¾¦å…¬å”ä½œçš„å¥½å¤¥ä¼´ï¼Œä¿¡ç®±ä½¿ç”¨ Gmail è¨—ç®¡ã€æ–‡ä»¶æ”¾åœ¨ Google Docã€å ±è¡¨ä½¿ç”¨ Google Sheetã€è¡¨å–®ä½¿ç”¨ Google Formâ€¦ç­‰ç­‰ï¼Œé€™äº›æœå‹™ä¹‹é–“çš„ä¸²æ¥æˆ–æ˜¯èˆ‡å…§å¤–éƒ¨ç³»çµ±çš„æºé€šï¼Œéƒ½éœ€è¦æˆ‘å€‘å¯¦ç¾ RPA ä¾†å®Œæˆã€‚

ä½† Google ä¸¦æ²’æœ‰æä¾›ç›´æ¥çš„ RPA æœå‹™ï¼Œå¯ä»¥é€éä»¥ä¸‹å¹¾å€‹æœå‹™é”æˆï¼š
- No Codeï¼š [App Sheet](https://cloud.google.com/appsheet#pricing){:target="_blank"} \(ä»˜è²»æœå‹™\)ï¼Œè®“éé–‹ç™¼äººå“¡ç›´æ¥é€é GUI æ­å»ºæœå‹™ä¸²æ¥è‡ªå‹•åŒ–ã€‚
- Low Codeï¼š [Google Apps Script](https://www.google.com/script/start/){:target="_blank"} \(å…è²»æœå‹™\)ï¼Œç°¡å–®æ’°å¯«ç¨‹å¼å°±èƒ½å¿«é€Ÿç›´æ¥çš„æ©‹æ¥ Google æœå‹™ã€å¤–éƒ¨/å…§éƒ¨ç³»çµ±ã€‚
- Function as a Serviceï¼š [Cloud Functions](https://cloud.google.com/functions?hl=zh_tw){:target="_blank"} \(ä»˜è²»æœå‹™ï¼Œæä¾›å…è²»é¡åº¦\)ï¼Œæ’°å¯«å®Œæ•´ç¨‹å¼ç¢¼ã€æœå‹™ï¼Œé€é Google Cloud éƒ¨ç½²ç›´æ¥åŸ·è¡Œã€‚


No Code å¹³å° [App Sheet](https://cloud.google.com/appsheet#pricing){:target="_blank"} æˆ‘æ²’æ¥è§¸éï¼Œ [Cloud Functions](https://cloud.google.com/functions?hl=zh_tw){:target="_blank"} èˆ‡ [Google Apps Script](https://www.google.com/script/start/){:target="_blank"} ç®—è »æœ‰ç¶“é©—çš„ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å€‹äººä¹‹å‰çš„ä½¿ç”¨èˆ‡é¸æ“‡ç¶“é©—åˆ†äº«ï¼š
#### Cloud Functions
- éœ€éƒ¨ç½²åŸ·è¡Œ
- æ”¯æ´ä½¿ç”¨å¤šç¨®ç¨‹å¼èªè¨€æ’°å¯«ï¼šNode\.js, Python, Java, Go, PHP, Rubyâ€¦
- æ”¯æ´ç¬¬ä¸‰æ–¹å¥—ä»¶ä¾è³´ç®¡ç†ã€å®‰è£ä¸¦ä½¿ç”¨
- æ”¯æ´å®Œæ•´èº«ä»½é©—è­‰æ©Ÿåˆ¶
- æœ€å¤šåŸ·è¡Œæ™‚é–“ä¸Šé™ï¼š 60 åˆ†é˜
- ç”¨å¤šå°‘ç®—å¤šå°‘ï¼šä¾ç…§æ¬¡æ•¸ã€åŸ·è¡Œæ™‚é–“ã€ä¸åŒè™•ç†å™¨ã€ä½¿ç”¨çš„è¨˜æ†¶é«”æ”¶è²»
- å—é™å†·å•Ÿå‹•å•é¡Œ\(å¤ªä¹…æ²’å‘¼å«ï¼Œå†æ¬¡å‘¼å«ï¼Œç¬¬ä¸€æ¬¡æœƒéœ€è¦è¼ƒé•·éŸ¿æ‡‰æ™‚é–“\)
- ç„¡æ³•ç›´æ¥ä¸²æ¥ Google æœå‹™ï¼Œéœ€è¦èµ° Auth/API é©—è­‰
- **å…è²»æ–¹æ¡ˆå¦‚ä¸‹** 
Cloud Functions é‡å°é‹ç®—æ™‚é–“è³‡æºæä¾›æ°¸ä¹…å…è²»æ–¹æ¡ˆï¼Œç•¶ä¸­åŒ…æ‹¬ GB/ç§’å’Œ GHz/ç§’çš„åˆ†é…æ–¹å¼ã€‚é™¤äº† 200 è¬æ¬¡å«ç”¨ä»¥å¤–ï¼Œé€™å€‹å…è²»æ–¹æ¡ˆä¹Ÿæä¾› 400,000 GB/ç§’å’Œ 200,000 GHz/ç§’çš„é‹ç®—æ™‚é–“ï¼Œä»¥åŠæ¯æœˆ 5 GB çš„ç¶²éš›ç¶²è·¯è³‡æ–™å‚³è¼¸é‡ã€‚å…è²»æ–¹æ¡ˆçš„ä½¿ç”¨é¡åº¦ï¼Œæ˜¯ä»¥ä¸Šè¿°ç´šåˆ¥ 1 åƒ¹æ ¼çš„åŒç­‰ç¾å…ƒé‡‘é¡è¨ˆç®—ã€‚ç„¡è«–åŸ·è¡Œå‡½å¼çš„å€åŸŸæ¡ç”¨çš„æ˜¯ç´šåˆ¥ 1 å’Œ/æˆ–ç´šåˆ¥ 2 åƒ¹æ ¼ï¼Œç³»çµ±éƒ½æœƒåˆ†é…åŒç­‰ç¾å…ƒé‡‘é¡çµ¦æ‚¨ã€‚ä¸éåœ¨æ‰£é™¤å…è²»æ–¹æ¡ˆçš„é¡åº¦æ™‚ï¼Œç³»çµ±å°‡ä»¥å‡½å¼åŸ·è¡Œå€åŸŸçš„ç´šåˆ¥ \(ç´šåˆ¥ 1 æˆ–ç´šåˆ¥ 2\) ç‚ºæº–ã€‚
è«‹æ³¨æ„ï¼Œå³ä¾¿æ‚¨æ¡ç”¨çš„æ˜¯å…è²»æ–¹æ¡ˆï¼Œä¹Ÿå¿…é ˆæ“æœ‰æœ‰æ•ˆçš„å¸³å–®å¸³æˆ¶ã€‚


ç¸½çµä¾†èªªï¼ŒCloud Functions å¯ä»¥æä¾›è¼ƒå®Œæ•´èˆ‡è¤‡é›œçš„ RPA ä¸²æ¥åŠŸèƒ½æˆ–æ˜¯æœ‰è¼ƒå¤šçš„å¤–éƒ¨ API ä¸²æ¥éœ€æ±‚æ™‚æ¯”è¼ƒå»ºè­°ä½¿ç”¨ Cloud Functionsã€‚

ä¹‹å‰ä½¿ç”¨é Cloud Functions çš„æ¡ˆä¾‹æœ‰ï¼š
- \[Slack ChatGPT å°è©±æ©Ÿå™¨äºº\]ï¼š [Slack & ChatGPT Integration](../bd94cc88f9c9/)
- \[è‡ªå‹•ç°½åˆ°æ©Ÿå™¨äºº\]ï¼š [ä½¿ç”¨ Python\+Google Cloud Platform\+Line Bot è‡ªå‹•åŸ·è¡Œä¾‹è¡Œç‘£äº‹](../70a1409b149a/)


éƒ½æ˜¯èˆ‡é Google Workspace æœå‹™æ•´åˆä¸”é ˆæ©‹æ¥å…¶ä»–å¤–éƒ¨æœå‹™æ™‚æˆ‘æœƒä½¿ç”¨ã€‚
#### Google Apps Script
- æ–¹ä¾¿ç°¡å–®å¿«é€Ÿ
- å®Œå…¨å…è²»
- ä¸²æ¥æœå‹™ç„¡éœ€ç¹ç‘£è¤‡é›œçš„ Auth èº«ä»½é©—è­‰
\(Google Apps Script æ˜¯ç›´æ¥ä½¿ç”¨ç•¶å‰åŸ·è¡Œçš„å¸³è™Ÿåšç‚ºåŸ·è¡Œèº«ä»½\)
- å…§å»ºæ’ç¨‹ã€è¡Œäº‹æ›†è§¸ç™¼å™¨åŠŸèƒ½
- ä½¿ç”¨ Google ç¶²è·¯åŸ·è¡Œç¶²è·¯è«‹æ±‚
- åªèƒ½ä½¿ç”¨ Google Apps Script \(åŸºæ–¼ JavaScript\) çš„èªè¨€é–‹ç™¼
- ä¸æ”¯æ´å¥—ä»¶ç®¡ç†å·¥å…·ã€ç„¡ç‰ˆæ§åŠŸèƒ½
- **åŸºæ–¼å®‰å…¨å•é¡Œï¼Œ [ç„¡æ³•å®¢è£½åŒ– Request User\-Agent è³‡è¨Š](https://issuetracker.google.com/issues/36758197){:target="_blank"}**
- **åŸ·è¡Œæ™‚é–“ä¸Šé™ï¼Œè…³æœ¬å¿…é ˆåœ¨ 6 åˆ†é˜å…§å®Œæˆå·¥ä½œï¼Œå¦å‰‡æœƒè¢«çµ‚æ­¢ã€‚**
- å…¶ä»–é™åˆ¶èˆ‡é…é¡è«‹åƒè€ƒå®˜æ–¹çš„ [GAS è³‡è¨Š](https://developers.google.com/apps-script/guides/services/quotas?hl=zh-tw){:target="_blank"} ï¼š



![](/assets/f6713ba3fee3/1*mLuy6AHDRTkUU1dJZpUEBg.png)



![](/assets/f6713ba3fee3/1*ulyNjWc-imCLKqS4EsorWg.png)


ä¹‹å‰ä½¿ç”¨é Google Apps Script çš„æ¡ˆä¾‹æœ‰ï¼š
- \[ä¸²æ¥ Slack x Google Form x Google Sheet\]ï¼š [Slack æ‰“é€ å…¨è‡ªå‹• WFH å“¡å·¥å¥åº·ç‹€æ³å›å ±ç³»çµ±](../d61062833c1a/)
- \[ä¸²æ¥ Slack x Gmail\]ï¼š [é‹ç”¨ Google Apps Script è½‰ç™¼ Gmail ä¿¡ä»¶åˆ° Slack](../d414bdbdb8c9/)
- \[ä¸²æ¥ Google Analytics x Slack\]ï¼š [Crashlytics \+ Google Analytics è‡ªå‹•æŸ¥è©¢ App Crash\-Free Users Rate](../793cb8f89b72/)
- \[ä¸²æ¥ Firebase Crashlytics x Big Query x Slack\]ï¼š [Crashlytics \+ Big Query æ‰“é€ æ›´å³æ™‚ä¾¿åˆ©çš„ Crash è¿½è¹¤å·¥å…·](../e77b80cc6f89/)
- \[ä¸²æ¥ Github x LineBot\]ï¼š [ä½¿ç”¨ Google Apps Script ä¸‰æ­¥é©Ÿå…è²»å»ºç«‹ Github Repo Star Notifier](../382218e15697/)


å—é™æ–¼åŸ·è¡Œæ™‚é–“èˆ‡ API Request å®¢è£½åŒ–é™åˆ¶ï¼Œåªæœ‰ç°¡å–®å¿«é€Ÿçš„æœå‹™æˆ‘æœƒä½¿ç”¨ Google Apps Script é”æˆï¼›æˆ–æ˜¯éœ€è¦èˆ‡ Google æœå‹™ä¸²æ¥çš„éœ€æ±‚ï¼Œæˆ‘æœƒå„ªå…ˆé¸æ“‡ä½¿ç”¨ Google Apps Script \(å› ç‚ºç”¨ Cloud Functions è¦å¤šå¯¦ç¾å®Œæ•´çš„ Google æœå‹™èº«ä»½é©—è­‰æµç¨‹\)ã€‚
### Robotic Process Automation with Google Apps Script â€” å·¥ä½œæ—¥å ±è¡¨ \(Google Sheet x Google Analytics\)

çµ‚æ–¼ä¾†åˆ°æœ¬ç¯‡çš„ä¸»é¡Œï¼Œä½¿ç”¨ Google Apps Script å¯¦ç¾ Google æœå‹™ RPA è‡ªå‹•åŒ–ã€‚
#### èƒŒæ™¯

ç”¢å“åœ˜éšŠéœ€è¦æ¯æ—¥æŸ¥è©¢ Google Analytics æ•¸æ“šä¸¦å¡«å¯«åˆ° Google Sheet æ•¸æ“šå ±è¡¨ä¸Šï¼Œå…±åœ˜éšŠåˆ†æè¶¨å‹¢ä½¿ç”¨ï¼›ä¸¦å°‡æ¯æ—¥æ•¸æ“šå…§å®¹ç™¼ä½ˆåˆ° Dashboard è¢å¹•ä¸Šï¼Œè®“æ‰€æœ‰æˆå“¡æŒæ¡ç›®å‰ç‹€æ³ã€‚

åŒäº‹æ¯æ—¥ä¸€åˆ°å…¬å¸å°±è¦èŠ±å¤§ç´„ 30 åˆ†é˜å·¦å³å®Œæˆæ­¤ä»»å‹™ï¼›å¦‚æœæœ‰å…¶ä»–äº‹è¦è™•ç†å°±éœ€è¦ç­‰åˆ°é€™ä»¶ä¾‹è¡Œå·¥ä½œå®Œæˆæ‰æœƒé–‹å§‹æˆ–æœƒå»¶å¾Œç™¼å¸ƒæ¯æ—¥æ•¸æ“šè¨Šæ¯ã€‚

**ç°¡å–®ä¼°è¨ˆä¸€ä¸‹ RPA æ•ˆç›Šï¼š**
- æ¯å¹´æ¶ˆè€—æ”¯å‡ºï¼š
1 äºº x 30 mins x 365 å¤©\(å‡æ—¥æ•¸æ“šä¹Ÿè¦è£œ\) **= 182 hours**
- å»ºç«‹è‡ªå‹•åŒ–æˆæœ¬ï¼š
ä»¥æ­¤æ¡ˆä¾‹ä¾†èªªï¼Œç´„éœ€è€—è²» 1 äºº x 5å¤© **= 40 hours**



> å› æ­¤æˆ‘å€‘åªéœ€è¦æŠ•å…¥ä¸€é€±é–‹ç™¼æ™‚é–“ï¼Œå°±èƒ½é•·é è§£æ±ºè² è²¬æŸ¥æ•¸æ“šåŒäº‹çš„å·¥ä½œæ¶ˆè€—ï¼Œä»–å°±å¯ä»¥æŠŠç²¾åŠ›æ”¾åœ¨æ›´é‡è¦çš„äº‹æƒ…ä¸Šã€‚ 




#### ç›®æ¨™

æˆ‘å€‘çš„ç›®æ¨™æ˜¯ä½¿ç”¨ Google Apps Script å»ºç«‹ä¸€å€‹ RPA è‡ªå‹•å¾ Google Analytics èˆ‡å…§éƒ¨ç³»çµ±å ±è¡¨ API æ’ˆå–æ¯æ—¥æ•¸æ“šä¸¦å¡«å…¥ Google Sheetï¼Œèˆ‡æ­å»ºä¸€å€‹ Web UI Dashboardã€‚
#### æœ€çµ‚æ•ˆæœ


![](/assets/f6713ba3fee3/1*6xAMrwENoxD0c7Hv1_RTTw.png)

- Google Sheet:
[https://docs\.google\.com/spreadsheets/d/1\-9lZCpsu3E7eDmO\-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit?usp=sharing](https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit?usp=sharing){:target="_blank"}



![](/assets/f6713ba3fee3/1*8SRT_wSe2aQGzcqpRt2Qjw.png)

- Web GUI URL:
[https://script\.google\.com/macros/s/AKfycbz2Vk\-ikU8DSXjpnLq9r6HNAn3zlNAosvDoItG0cxy0bmItRDSVyEzTdwsL2HyFUz99/exec](https://script.google.com/macros/s/AKfycbz2Vk-ikU8DSXjpnLq9r6HNAn3zlNAosvDoItG0cxy0bmItRDSVyEzTdwsL2HyFUz99/exec){:target="_blank"}



> **_æ•¸æ“šç‚ºå‡æ•¸æ“šï¼Œç´” Demo ä½¿ç”¨ï¼›å¾ 2024/04/13 é–‹å§‹æœƒç‰¹åˆ¥ä½æˆ–éƒ½ä¿æŒåœ¨ 0ï¼Œå› ç‚ºæˆ‘çš„ zhgchg\.li GA çœŸçš„æ˜¯ã€Œ0ã€æµé‡ Q\_Qã€‚_** 




#### éœ€å®Œæˆçš„ä»»å‹™
1. å»ºç«‹ Google Apps Scriptã€ç†Ÿæ‚‰ç·¨è¼¯å™¨
2. å–å¾—/å»ºç«‹å°æ‡‰æ—¥æœŸçš„ Sheet
3. ä¸²æ¥ Google Analytics æ’ˆå–æ•¸æ“š
4. å¡«å……è³‡æ–™
5. è¨­å®šæ’ç¨‹ï¼Œæ¯æ—¥è‡ªå‹•åŸ·è¡Œ

#### è²æ˜

å› æ–‡ç« èªªæ˜éœ€æ±‚ï¼Œä»¥ä¸‹ç¨‹å¼ç¢¼æœƒç›¡å¯èƒ½å°‘ä¸€é»æŠ½è±¡ï¼Œå¢åŠ èªªæ˜æ€§ï¼Œæ‚¨å¯ä¾ç…§è‡ªå·±å¯¦éš›çš„éœ€æ±‚é€²è¡Œæ”¹å¯«ã€‚


> **_æ–‡æœ«æœ‰é™„ä¸Šå®Œæ•´å…¬é–‹çš„ Google Sheet & Google Apps Scriptï¼Œå¦‚æœä½ æ‡¶å¾—ä¸€æ­¥ä¸€æ­¥èµ°ï¼Œå¯ä»¥ç›´æ¥å¾æ–‡æœ«é™„çš„ç¯„æœ¬å»ä¿®æ”¹ã€‚_** 




#### Step 1\. å»ºç«‹ Google Apps Script


![](/assets/f6713ba3fee3/1*-xYCGpKIBztRd4jvxFnrUg.png)


åªéœ€åœ¨æˆ‘å€‘è¦å°å…¥è‡ªå‹•åŒ–çš„å ±è¡¨ä¸Šé¸æ“‡ã€Œæ“´å……åŠŸèƒ½ã€\-&gt;ã€ŒApps Scriptã€å°±èƒ½è‡ªå‹•å»ºç«‹èˆ‡ Google Sheet å ±è¡¨é€£çµçš„ Google Apps Scriptã€‚

å¦å¤–ä¹Ÿå¯ä»¥ç›´æ¥å¾ Google Apps Script é¦–é å»ºç«‹ [Google Apps Script](https://www.google.com/script/start/){:target="_blank"} ï¼Œä¸éé€™æ¨£å°±ä¸æœƒèˆ‡ Google Sheet ç”¢ç”Ÿé€£çµã€‚


> **ä¸¦ééœ€è¦é€£çµæ‰èƒ½æ“ä½œå°æ‡‰ Google Sheet** ï¼Œå…©ç¨®å»ºç«‹æ–¹å¼éƒ½å¯ä»¥ï¼Œå·®åˆ¥åœ¨æ–¼ Script çš„æ‰€æœ‰æ¬Šæ­¸æ–¼èª°ï¼Œå¦‚æœæ˜¯é€£çµå ±è¡¨çš„å°±æ˜¯æ­¸å ±è¡¨æ“æœ‰è€…ï¼Œå¦‚æœæ˜¯è‡ªå·±å»ºç«‹çš„å°±æ˜¯æ­¸å»ºç«‹è‘—ï¼›æ“æœ‰è€…æœƒé—œä¿‚åˆ°å‡è¨­è©²å¸³è™Ÿå› é›¢è·åœç”¨ï¼Œè…³æœ¬æ˜¯å¦æœƒå¤±æ•ˆè¢«åˆªé™¤ã€‚ 






![](/assets/f6713ba3fee3/1*vnCPiALLTi4CIcYbASQpOg.png)


è…³æœ¬å»ºç«‹å¾Œï¼Œæˆ‘å€‘å¯ä»¥å…ˆå¾ä¸Šæ–¹ Rename æˆ‘å€‘çš„è…³æœ¬å°ˆæ¡ˆåç¨±ã€‚
#### Google Apps Script åŸºç¤çŸ¥è­˜

å†åˆ°ä¸‹ä¸€æ­¥æ’°å¯«ç¨‹å¼ä¹‹å‰ï¼Œå…ˆè£œå……ä¸€äº› Google Apps Script çš„åŸºç¤çŸ¥è­˜ã€‚

**é—œæ–¼ç·¨è¼¯å™¨**

é è¨­å¼•å…¥ Google æœå‹™çš„ SDK \(ä¸éœ€ç‰¹åˆ¥å¼•å…¥å³å¯å‘¼å«ä½¿ç”¨\)ï¼š
- CalendarApp è¡Œäº‹æ›†
- DocumentApp Google Drive
- FormApp Google Form
- SpreadsheetApp Google Sheet
- GmailApp Gmail
- [å…¶ä»–â€¦](https://developers.google.com/apps-script/reference/slides/border?hl=zh-tw#getdashstyle){:target="_blank"}



![](/assets/f6713ba3fee3/1*PKO-daNhyquINvk-_LfgQQ.png)

1. æª”æ¡ˆï¼š
å¯æ–°å¢å¤šå€‹ \.gs æª”æ¡ˆå­˜æ”¾ä¸åŒç‰©ä»¶ç¨‹å¼ç¢¼ï¼Œæ–¹ä¾¿æ•´ç†ï¼›æ‰€æœ‰æª”æ¡ˆéƒ½æœƒåœ¨åŒå€‹ Namespaceã€ç”Ÿå‘½é€±æœŸä¸‹åŸ·è¡Œï¼Œå› æ­¤è¦æ³¨æ„ç‰©ä»¶åç¨±ã€è®Šæ•¸åç¨±å¦‚æœé‡è¤‡å¯èƒ½æœƒäº’ç›¸è¦†è“‹ã€‚
é™¤ \.gs æŒ‡ä»¤ç¢¼ æª”æ¡ˆå¤–ï¼Œä¹Ÿèƒ½æ–°å¢ \.html HTML Template æª”æ¡ˆï¼Œç”¨æ–¼æ¸²æŸ“ Web UIã€‚\(å¾Œé¢æœƒå†ä»‹ç´¹\)
2. è³‡æ–™åº«ï¼š
åˆ¥äººæ’°å¯«å¥½çš„è³‡æ–™åº« \(a\.k\.a Lib\) æˆ‘å€‘å¯ä»¥é€éä»–çš„ Script ID å¼•å…¥ä½¿ç”¨ï¼Œç•¶ç„¶æˆ‘å€‘æ’°å¯«å¥½çš„ç¨‹å¼ä¹Ÿèƒ½éƒ¨ç½²æˆè³‡æ–™åº«çµ¦åˆ¥äººç”¨ã€‚
å¦å¤–ä¹Ÿæœ‰ä¸€äº›å¤§ç¥å¹«å¿™å°è£çš„å·¥å…·å¯ä»¥ç”¨ï¼Œç¼ºé»æ˜¯åªèƒ½å¾ Google æœå°‹ Script IDï¼Œå®˜æ–¹ä¸¦æ²’æœ‰æ­£å¼çš„è³‡æ–™åº«åˆ—è¡¨å…±æŸ¥è©¢ä½¿ç”¨ã€‚
e\.g\. HTML Parser Tool Cheer\.io Script ID: `1ReeQ6WO8kKNxoaA_O0XEQ589cIrRvEBA9qcWpNqdOP17i47u6N9M5Xh0`
3. æœå‹™ï¼š
Google æœå‹™çš„ SDKï¼Œé è¨­æ²’æœ‰å¼•å…¥çš„æœå‹™å¯ä»¥å†æ­¤è¿½åŠ å¼•å…¥ä½¿ç”¨ã€‚
e\.g\. Google Analytics Data
4. é‚„åŸã€ä¸‹ä¸€æ­¥æ“ä½œ
5. å„²å­˜ æˆ– Control \+ s
6. åŸ·è¡Œ æˆ– Control \+ r
é‡åˆ°éŒ¯èª¤ç›´æ¥åœ¨ Console æç¤ºä¸¦çµ‚æ­¢è…³æœ¬
7. åµéŒ¯
æœ‰ä¸‹ Break point \(10\) çš„åœ°æ–¹åŸ·è¡Œåˆ°æœƒæš«åœä¸­æ–·ä¸¦è·³å‡ºå³å´ Debug Viewï¼Œå¯æŒ‰ç¹¼çºŒåŸ·è¡Œ
é‡åˆ°éŒ¯èª¤æœƒæš«åœä¸­æ–·ä¸¦è·³å‡ºå³å´ Debug View
8. åµéŒ¯ã€åŸ·è¡Œçš„ç›®æ¨™æ–¹æ³•\(Function Name\)
åƒ…èƒ½é¸æ“‡ç•¶å‰é¸æ“‡çš„æª”æ¡ˆæ‰€æ“æœ‰çš„æ–¹æ³•ã€‚
9. æŸ¥çœ‹ç·¨è¼¯å™¨åŸ·è¡Œç´€éŒ„



> _å¦å¤–é‚„æœ‰ä¸€é»å°±æ˜¯æ’ç‰ˆï¼Œæœ‰çš„ç€è¦½å™¨æŒ‰ä¸‹ã€ŒControl \+ \[ã€é€²è¡Œç¸®æ’æ™‚æœƒè§¸ç™¼è¿”å›ä¸Šä¸€é ï¼Œé€™é»è¦æ³¨æ„ï¼_ 





[**Google Apps Script GitHub Assistant Chrome Extension ç‰ˆæ§å¤–æ›**](https://chromewebstore.google.com/detail/lfjcgcmkmjjlieihflfhjopckgpelofo){:target="_blank"}
- å»ºè­°å®‰è£æ­¤ Extension è®“ Google Apps Script èˆ‡ git ä¸²æ¥ï¼Œä½¿å…¶æœ‰ç‰ˆæœ¬æ§åˆ¶åŠŸèƒ½ï¼Œé˜²æ­¢å¿ƒè¡€ä¸å°å¿ƒæ”¹å£ã€‚



![](/assets/f6713ba3fee3/1*NIFgOdZ2EIv-FCfYOxCmsA.png)



![](/assets/f6713ba3fee3/1*JQyQCdn-FAtItaJ2qrLnng.png)



![](/assets/f6713ba3fee3/1*TqsqHeccSt8-qN4Tav0kwg.png)

- å¦‚æœé‡åˆ° Push/Pull Error æˆ–é»äº†æ²’åæ‡‰ï¼Œè«‹å…ˆæŒ‰ç…§ä¸Šé¢æ­¥é©Ÿã€Œé¸é …ã€\-&gt; é€£æ¥ Github or é‡æ–°é©—è­‰ä¸€æ¬¡ Google æˆæ¬Šï¼Œå³å¯ã€‚


**Logger Message**

å¯ä½¿ç”¨ä»¥ä¸‹ Script æ­é… Debug å°±èƒ½åœ¨åº•ä¸‹ Console Print å‡º Debug Logã€‚
```javascript
Logger.log("Hi")
```

**åŸ·è¡Œç´€éŒ„ã€éŒ¯èª¤è³‡è¨Š**

å¦‚æœåœ¨ç·¨è¼¯å™¨ä¸ŠåŸ·è¡Œæ™‚çš„ Log æˆ–å ±éŒ¯æœƒç›´æ¥é¡¯ç¤ºï¼Œå¦‚æœè¦æŸ¥è¨ŠåŸ·è¡Œç´€éŒ„æˆ–è‡ªå‹•åŸ·è¡Œæ™‚ç™¼ç”Ÿçš„éŒ¯èª¤ï¼Œå¯åˆ°ã€ŒåŸ·è¡Œé …ç›®ã€é ç±¤æŸ¥çœ‹ã€‚


![](/assets/f6713ba3fee3/1*pqn5ljYggb1lVWgYDSq6Sw.png)


**è‡ªå‹•è§¸ç™¼**


![](/assets/f6713ba3fee3/1*0DfewvWMWZ_bEC7beOPmLQ.png)



![](/assets/f6713ba3fee3/1*lh87YD-SL6VDf5pcLlB_WQ.png)


ã€Œè§¸ç™¼æ¢ä»¶ã€é ç±¤å¯è¨­å®šè…³æœ¬ä¸­çš„æ–¹æ³•è©²å¦‚ä½•è‡ªå‹•è§¸ç™¼åŸ·è¡Œï¼Œå¯ä»¥è¨­å®šçš„è‡ªå‹•è§¸ç™¼æ¢ä»¶æœ‰ï¼š
- ç•¶ Google Sheetï¼šé–‹å•Ÿæ™‚ã€ç·¨è¼¯æ™‚ã€å…§å®¹è®Šæ›´æ™‚ã€æäº¤è¡¨å–®æ™‚ åŸ·è¡Œ
- æ’ç¨‹é€±æœŸè§¸ç™¼ï¼šæ¯ X åˆ†é˜ã€X å°æ™‚ã€X æ—¥ã€X é€±ã€X æœˆ åŸ·è¡Œä¸€æ¬¡
- ç‰¹å®šæ—¥æœŸè§¸ç™¼ï¼šYYYY\-MM\-DD HH:MM æ™‚åŸ·è¡Œ
- ç•¶ è¡Œäº‹æ›†ï¼šæ›´æ–°æ™‚ åŸ·è¡Œ


éŒ¯èª¤é€šçŸ¥è¨­å®šï¼Œå¯è¨­å®šç•¶è…³æœ¬åŸ·è¡Œå‡ºéŒ¯æ™‚å¦‚ä½•é€šçŸ¥ä½ ã€‚

**æˆäºˆåŸ·è¡Œæ¬Šé™èº«ä»½**


> **_é¦–æ¬¡åŸ·è¡Œ/éƒ¨ç½²æˆ–æ–°å¢å¼•å…¥çš„æœå‹™ã€è³‡æºï¼Œéƒ½éœ€è¦é‡æ–°è·‘ä¸€æ¬¡èº«ä»½æˆæ¬Šï¼Œæˆæ¬Šå®Œä¹‹å¾Œçš„åŸ·è¡Œéƒ½æœƒç”¨ä½ æˆæ¬Šçš„èº«ä»½åŸ·è¡Œï¼Œæ‰€ä»¥ä¹Ÿè¦ç¢ºä¿ä½ æˆæ¬Š\(é€šå¸¸æ˜¯ç•¶å‰\)çš„å¸³è™Ÿæœ‰è©²è³‡æºã€æœå‹™çš„æ¬Šé™ã€‚\(e\.g\. ä¾‹å¦‚è¦æœ‰è©² Google Sheet æ¬Šé™\)ã€‚_** 





è·³å‡ºå¸³è™Ÿé¸æ“‡ Pop\-up å¾Œé¸æ“‡æˆæ¬ŠåŸ·è¡Œçš„å¸³è™Ÿ\(é€šå¸¸æ˜¯é¸ç•¶å‰ Google Apps Script å¸³è™Ÿ\)ï¼š


![](/assets/f6713ba3fee3/0*psr2krTcvVZxkxYp.png)


å‡ºç¾ã€ŒGoogle hasnâ€™t verified this appã€å› ç‚ºæˆ‘å€‘è¦é–‹ç™¼çš„ App æ˜¯çµ¦è‡ªå·±ç”¨çš„ï¼Œä¸éœ€ç¶“é Google é©—è­‰ã€‚

ç›´æ¥é»æ“Šã€ŒAdvancedã€\-&gt;ã€ŒGo to XXX \(unsafe\)ã€\-&gt;ã€ŒAllowã€å³å¯ï¼š


![](/assets/f6713ba3fee3/0*lP6NI_yUYntq7pIy.png)



![](/assets/f6713ba3fee3/0*jIQHxmmy3ziOHXR7.png)



![](/assets/f6713ba3fee3/0*F8SGw5p1RtWaIea5.png)


å®Œæˆæˆæ¬Šå¾Œå°±èƒ½æˆåŠŸåŸ·è¡Œè…³æœ¬ï¼Œå¦‚æœæ²’æœ‰æ”¹å‹•è³‡æºä¸éœ€è¦å†é‡æ–°æˆæ¬Šã€‚
#### 2\. å–å¾—/å»ºç«‹å°æ‡‰æ—¥æœŸçš„ Sheet

äº†è§£å®ŒåŸºç¤çŸ¥è­˜å¾Œï¼Œæˆ‘å€‘å°±å¯ä»¥æ’°å¯«ç¬¬ä¸€å€‹åŠŸèƒ½çš„ç¨‹å¼äº†ã€‚

æˆ‘å€‘å»ºç«‹ä»¥ä¸‹å¤šå€‹æª”æ¡ˆæ–¹ä¾¿æˆ‘å€‘å­˜æ”¾ä¸åŒç‰©ä»¶

`DailyReportStyle.gs` æ¬„ä½æ¨£å¼ç‰©ä»¶ï¼š
```javascript
class HeaderStyle {
  constructor() {
    this.color = "#ffffff";
    this.backgroundColor = "#e3284b";
    this.bold = false;
    this.size = 12;
    this.horizontalAlignment = "center";
    this.verticalAlignment = "middle";
  }
}

class ContentStyle {
  constructor() {
    this.color = "#000000";
    this.backgroundColor = "#ffffff";
    this.bold = false;
    this.size = 12;
    this.horizontalAlignment = "center";
    this.verticalAlignment = "middle";
  }
}

class HeaderDateStyle {
  constructor() {
    this.color = "#ffffff";
    this.backgroundColor = "#001a40";
    this.bold = true;
    this.size = 12;
    this.horizontalAlignment = "center";
    this.verticalAlignment = "middle";
  }
}
```

`DailyReportField.gs` æ¬„ä½è³‡æ–™ç‰©ä»¶ï¼š
```javascript
class DailyReportField {
  constructor(name, headerStyle, contentStyle, format = null, value = null) {
    this.name = name;
    this.headerStyle = headerStyle;
    this.contentStyle = contentStyle;
    this.format = format;
    this.value = value;
  }
}
```

`DailyReport.gs` å ±è¡¨ä¸»ç¨‹å¼é‚è¼¯ï¼š
```javascript
class DailyReport {
  constructor(sheetID, date) {
    this.separateSheet = SpreadsheetApp.openById(sheetID);
    this.date = date;

    this.sheetFields = [
      new DailyReportField("æ—¥æœŸ", new HeaderDateStyle(), new HeaderDateStyle()),
      new DailyReportField("æ˜ŸæœŸ", new HeaderDateStyle(), new HeaderDateStyle()),
      new DailyReportField("æ—¥æµé‡", new HeaderStyle(), new ContentStyle(), "#,##0", '=INDIRECT(SUBSTITUTE(ADDRESS(1,COLUMN(),4),"1","")&4)+INDIRECT(SUBSTITUTE(ADDRESS(1,COLUMN(),4),"1","")&5)'), // =4(PC æµé‡) + 5(Mobile æµé‡)
      new DailyReportField("PC æµé‡", new HeaderStyle(), new ContentStyle(), "#,##0"),
      new DailyReportField("Mobile æµé‡", new HeaderStyle(), new ContentStyle(), "#,##0"),
      new DailyReportField("è¨»å†Šæ•¸", new HeaderStyle(), new ContentStyle(), "#,##0")
    ]

    // æ—¥æµé‡å…¬å¼åˆ†è§£èªªæ˜ï¼š
    // 1. COLUMN() å‡½æ•¸æœƒå›å‚³ç›®å‰å–®å…ƒæ ¼çš„åˆ—è™Ÿç¢¼ã€‚
    // 2. ADDRESS(1, COLUMN(), 4) æœƒä»¥çµ¦å®šçš„è¡Œæ•¸ï¼ˆ`COLUMN()` çš„çµæœï¼‰å’Œå›ºå®šçš„åˆ—æ•¸ï¼ˆ1ï¼‰ä¾†ç”Ÿæˆä¸€å€‹çµ•å°å¼•ç”¨çš„åœ°å€ã€‚å…¶ä¸­ï¼Œç¬¬ä¸‰å€‹åƒæ•¸ 4 è¡¨ç¤ºä¸å¸¶ä»»ä½•ç¾å…ƒç¬¦è™Ÿï¼ˆ$ï¼‰çš„ç›¸å°åœ°å€ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ åœ¨ç¬¬ä¸‰åˆ—çš„ä»»ä½•å–®å…ƒæ ¼ä¸­ä½¿ç”¨é€™å€‹å‡½æ•¸ï¼Œå®ƒæœƒå›å‚³ "C1"ã€‚
    // 3. SUBSTITUTE(ADDRESS(1, COLUMN(), 4), "1", "") æœƒå°‡ ADDRESS å‡½æ•¸ç”¢ç”Ÿçš„åœ°å€ä¸­çš„æ•¸å­— 1 ç§»é™¤ï¼Œå› æ­¤åªä¿ç•™äº†åˆ—çš„è‹±æ–‡å­—æ¯ï¼Œæ¯”å¦‚ï¼š"C"ã€‚
    // 4. INDIRECT(SUBSTITUTE(ADDRESS(1, COLUMN(), 4), "1", "") & 4) é€™é‚Š & 4 å…¶å¯¦æ‡‰è©²æ˜¯ &4ã€‚`SUBSTITUTE` å‡½æ•¸çš„çµæœæœƒå’Œæ•¸å­— 4 é€£æ¥ï¼Œå½¢æˆ "C4" é€™æ¨£çš„å­—ç¬¦ä¸²ï¼Œç„¶å¾Œ INDIRECT å‡½æ•¸æœƒå°‡é€™å€‹å­—ç¬¦ä¸²è½‰æ›æˆå°æ‡‰çš„å–®å…ƒæ ¼å¼•ç”¨ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ åœ¨åˆ— C ä¸­çš„ä»»ä½•å–®å…ƒæ ¼ä½¿ç”¨æ­¤å…¬å¼ï¼Œå®ƒæœƒå¼•ç”¨ C4ã€‚
    // 5. é¡ä¼¼åœ°ï¼Œ`INDIRECT(SUBSTITUTE(ADDRESS(1, COLUMN(), 4), "1", "") & 5)` æœƒå¼•ç”¨ç›¸åŒåˆ—çš„ç¬¬äº”è¡Œçš„å–®å…ƒæ ¼ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ åœ¨åˆ— C ä¸­çš„ä»»ä½•å–®å…ƒæ ¼ä½¿ç”¨æ­¤å…¬å¼ï¼Œå®ƒæœƒå¼•ç”¨ C5ã€‚
    // 6. æœ€å¾Œï¼Œé€™å…©å€‹ INDIRECT å‡½æ•¸å¼•ç”¨çš„å–®å…ƒæ ¼å€¼ç›¸åŠ ã€‚
  }

  execute() {
    const sheet = this.getSheet();

  }

  // å–å¾—çµ¦å®šæ—¥æœŸçš„ç›®æ¨™ Sheet
  getSheet() {
    // ä»¥æœˆä¾†å€åˆ† Sheetï¼Œæ‰¾åˆ°ç•¶æœˆ Sheet
    var thisMonthSheet = this.separateSheet.getSheetByName(this.getSheetName());
    if (thisMonthSheet == null) {
      // ç„¡å‰‡å»ºç«‹æ–°çš„æœˆ Sheet
      thisMonthSheet = this.makeMonthSheet();
    }

    return thisMonthSheet;
  }

  // æœˆ Sheet å‘½åè¦å‰‡
  getSheetName() {
    return Utilities.formatDate(this.date, "GMT+8", "yyyy-MM");
  }

  // å»ºç«‹æ–°çš„æœˆ Sheet
  makeMonthSheet() {
    // æ–°å¢ç•¶æœˆ Sheetï¼Œç§»å‹•åˆ°ç¬¬ä¸€å€‹ä½å­
    var thisMonthSheet = this.separateSheet.insertSheet(this.getSheetName(), {index: 0});
    thisMonthSheet.activate();
    this.separateSheet.moveActiveSheet(1);

    // æ–°å¢ç¬¬ä¸€æ¬„ï¼Œæ¬„ä½åç¨±ã€è¨­å®š Pinnedã€å¯¬åº¦ 200
    thisMonthSheet.insertColumnsBefore(1, 1);
    thisMonthSheet.setFrozenColumns(1);
    thisMonthSheet.setColumnWidths(1, 1, 200);

    // å¡«å……æ¬„ä½åç¨±
    for(const currentRow in this.sheetFields) {
      const sheetField = this.sheetFields[currentRow];
      const text = sheetField.name;
      const style = sheetField.headerStyle;
      
      const range = thisMonthSheet.getRange(parseInt(currentRow) + 1, 1);
      this.setContent(range, text, style);
      range.setHorizontalAlignment("left");
    }

    // è¨­å®šæ¬„é«˜
    thisMonthSheet.setRowHeights(1, Object.keys(this.sheetFields).length, 30);

    // è¨­å®š Pinned ç¬¬ä¸€ã€äºŒåˆ—(æ—¥æœŸã€æ˜ŸæœŸ)
    thisMonthSheet.setFrozenRows(2);

    // æ–°å¢ç¸½è¨ˆæ¬„ä½
    thisMonthSheet.insertColumnsAfter(thisMonthSheet.getLastColumn(), 1); // æ–°å¢ä¸€æ¬„åœ¨æœ€å¾Œä¸€æ¬„
    const summaryColumnIndex = thisMonthSheet.getLastColumn() + 1;

    // å¡«å……ç¸½è¨ˆæ¬„ä½
    for(const currentRow in this.sheetFields) {
      const sheetField = this.sheetFields[currentRow];
      const summaryRowIndex = parseInt(currentRow) + 1;

      const range = thisMonthSheet.getRange(summaryRowIndex, summaryColumnIndex);
      const style = sheetField.contentStyle;

      if (summaryRowIndex == 1) {
        // æ—¥æœŸ...
        this.setContent(range, "ç¸½è¨ˆ", style);
      } else if (summaryRowIndex == 2) {
        // æ˜ŸæœŸ...merge...
        const mergeRange = thisMonthSheet.getRange(1, summaryColumnIndex, summaryRowIndex, 1);
        this.setContent(mergeRange, "ç¸½è¨ˆ", style);
        mergeRange.merge();
      } else {
        this.setContent(range, '=IFERROR(SUM(INDIRECT(SUBSTITUTE(ADDRESS(1, 1, 4), "1", "") & '+summaryRowIndex+'):INDIRECT(SUBSTITUTE(ADDRESS(1, COLUMN() - 1, 4), "1", "") & '+summaryRowIndex+')), 0)', style);

        // 1. IFERROR(value, [value_if_error]) å‡½æ•¸ç”¨æ–¼åˆ¤æ–·å…¬å¼ä¸­æ˜¯å¦å­˜åœ¨éŒ¯èª¤ï¼Œä¸¦åœ¨æœ‰éŒ¯èª¤æ™‚è¿”å›æŒ‡å®šçš„å€¼ã€‚å®ƒæ¥å—å…©å€‹åƒæ•¸ï¼š`value` æ˜¯éœ€è¦è¨ˆç®—çš„è¡¨é”å¼æˆ–å‡½æ•¸ï¼Œ`value_if_error` æ˜¯ç•¶ value ç™¼ç”ŸéŒ¯èª¤æ™‚è¿”å›çš„å€¼ã€‚åœ¨é€™å€‹æƒ…å¢ƒä¸‹ï¼Œå¦‚æœ SUM å‡½æ•¸ä¸­çš„è¨ˆç®—ç™¼ç”ŸéŒ¯èª¤ï¼Œå‰‡è¿”å› 0ã€‚
        // 2. SUM(range) å‡½æ•¸ç”¨æ–¼è¨ˆç®—ç¯„åœå…§æ‰€æœ‰æ•¸å­—çš„ç¸½å’Œã€‚
        // 3. INDIRECT(ref_text, [is_A1_notation]) å‡½æ•¸å°‡æ–‡å­—å­—ä¸²è½‰æ›æˆå–®å…ƒæ ¼å¼•ç”¨ã€‚é€™è£¡ä½¿ç”¨ INDIRECT å‡½æ•¸æ˜¯ç‚ºäº†å‹•æ…‹ç”Ÿæˆæ‰€éœ€çš„åƒç…§ç¯„åœã€‚
        // 4. SUBSTITUTE(text, old_text, new_text, [instance_num]) å‡½æ•¸åœ¨æ–‡å­—å­—ä¸²ä¸­æ›¿æ›æŒ‡å®šçš„æ–‡å­—ã€‚é€™è£¡ä½¿ç”¨ SUBSTITUTE æ˜¯ç‚ºäº†å°‡ ADDRESS å‡½æ•¸å›å‚³çš„åœ°å€ä¸­çš„ "1" æ›¿æ›æˆå…¶ä»–å…§å®¹ã€‚
        // 5. ADDRESS(row, column, [abs_num], [a1], [sheet]) å‡½æ•¸æ ¹æ“šçµ¦å®šçš„è¡Œåˆ—è™Ÿç¢¼å›å‚³å°æ‡‰çš„å–®å…ƒæ ¼åœ°å€ã€‚åœ¨é€™è£¡ï¼ŒADDRESS(1, 1, 4) ç”Ÿæˆäº†ç¬¬ä¸€è¡Œç¬¬ä¸€åˆ—çš„å–®å…ƒæ ¼åœ°å€ï¼Œä½†æ˜¯ç”±æ–¼ abs_num æ˜¯ 4ï¼Œæ‰€ä»¥åœ°å€ä¸åŒ…å«å·¥ä½œè¡¨åç¨±å’Œå›ºå®šç¬¦è™Ÿ $ã€‚é¡ä¼¼åœ°ï¼Œ`ADDRESS(1, COLUMN() - 1, 4)` ç”¢ç”Ÿäº†å¾ç¬¬ä¸€è¡Œåˆ°ç•¶å‰åˆ—å‰ä¸€åˆ—çš„å–®å…ƒæ ¼åœ°å€ã€‚
        // 6. COLUMN() å‡½æ•¸å›å‚³ç•¶å‰å–®å…ƒæ ¼çš„åˆ—è™Ÿã€‚
        // 7. summaryRowIndex = æ‰€åœ¨åˆ—     

      }
    }

    return thisMonthSheet;
  }

  setContent(range, text, style) {
    if (String(text) != "") {
      range.setValue(text);
    }

    range.setBackgroundColor(style.backgroundColor);
    range.setFontColor(style.color);

    if (style.bold) {
      range.setFontWeight("bold");
    }

    range.setHorizontalAlignment(style.horizontalAlignment);
    range.setVerticalAlignment(style.verticalAlignment);
    range.setFontSize(style.size);
    range.setBorder(true, true, true, true, true, true, "black", SpreadsheetApp.BorderStyle.SOLID);
  }
}
```

`Main.gs` åšç‚ºä¸»ç¨‹å¼å…¥å£ï¼š
```javascript
const targetGoogleSheetID = "1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE"
// https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit#gid=275710641

function debug() {
  var report = new DailyReport(targetGoogleSheetID, new Date());
  report.execute();
}
```


![](/assets/f6713ba3fee3/1*c3QsffDXeLBakupNbAClrw.png)


å®Œæˆå¾Œæˆ‘å€‘å›åˆ°ã€Œ `Main.gs` ã€é¸æ“‡ã€Œdebugã€ä¸¦æŒ‰ä¸‹åµéŒ¯ï¼ŒæŸ¥çœ‹åŸ·è¡Œçµæœæ˜¯å¦æ­£ç¢ºã€æœ‰ç„¡å‡ºéŒ¯ã€‚


![](/assets/f6713ba3fee3/1*y8kdOIBp8tvbVmOBOpsVKA.png)


åŸ·è¡Œæ­£ç¢ºå›åˆ°å ±è¡¨æœƒå‡ºç¾ç•¶å‰æ–°æœˆä»½ï¼Œä¸¦å¸¶å…¥é è¨­æ¬„ä½èˆ‡ç¸½è¨ˆæ¬„ä½ï¼Œå¦‚æœå·²å­˜åœ¨å‰‡ä¸æœƒæœ‰åæ‡‰ã€‚
#### 3\. ä¸²æ¥ Google Analytics æ’ˆå–æ•¸æ“š

é¦–å…ˆéœ€è¦æ–°å¢ã€ŒAnalyticsDataã€æœå‹™ï¼š


![](/assets/f6713ba3fee3/1*bXngqmgXbTVeQ9r7rjQAbQ.png)


ä½¿ç”¨ GA4 Debug Tool æ§‹å»ºæŸ¥è©¢æ¢ä»¶ï¼š
- [https://ga\-dev\-tools\.google/ga4/query\-explorer/](https://ga-dev-tools.google/ga4/query-explorer/){:target="_blank"}
- å¯é‚Šæ¯”ç…§ GA 4 å¾Œå°ç¯©é¸æ¢ä»¶æ§‹å»º
- **æœ¬æ–‡ä»¥æŸ¥è©¢ Sessions æ•¸ç‚ºä¾‹ï¼Œå€åˆ†è£ç½® Grouping**


ç™»å…¥æˆæ¬Šå¾Œé¸æ“‡ç›®æ¨™è³‡æºï¼š


![](/assets/f6713ba3fee3/1*M333knrSQqSxD1hCBcqU4A.png)


è¨˜ä¸‹ property åº•ä¸‹é¡¯ç¤ºçš„æ•¸å­—ï¼Œå³ç‚ºä½ è¦æŸ¥è©¢çš„è³‡æº GA Property IDã€‚

è¨­å®šæŸ¥è©¢åƒæ•¸ã€Filter æ¢ä»¶ï¼š


![](/assets/f6713ba3fee3/1*pZqC3U4WeTFGrq80TMWmRA.png)


æŒ‰ä¸‹ã€ŒMake Reqeustã€å–å¾— Response çµæœï¼š


![](/assets/f6713ba3fee3/1*UArMZH6b0LPKj8_HTFrX9g.png)


å¯åŒæ­¥æ¯”è¼ƒ GA 4 å¾Œå°åŒæ¨£æ¢ä»¶çš„æ•¸æ“šæ˜¯å¦ç›¸åŒï¼Œå¦‚æœè½å·®å¤ªå¤§å¯èƒ½æ˜¯æœ‰ Filter æ¢ä»¶æ²’æœ‰åŠ åˆ°ï¼Œè¦å†æª¢æŸ¥ä¸€ä¸‹ã€‚
#### å°è¨˜

é™„ä¸Šä¸€å€‹è¡ŒéŠ·åŒäº‹ç™¼ç¾çš„å°å‘ï¼ŒGA æœ‰äº›æ•¸æ“šæœƒæœ‰å»¶é²å•é¡Œï¼Œå¯èƒ½ä»Šå¤©æŸ¥çš„è·Ÿæ˜¨å¤©æŸ¥çš„æ•¸å­—æœƒä¸ä¸€æ¨£\(ä¾‹å¦‚è·³å‡ºç‡\)ï¼Œå› æ­¤æœ€å¥½èƒ½å°‡è³‡æ–™å›æº¯å¹¾å¤©æ‰èƒ½å»ä¿å€¼æ˜¯æœ€çµ‚çš„æ•¸å­—ã€‚


> _GA Debug Tool æ²’å•é¡Œä¹‹å¾Œæˆ‘å€‘å°±èƒ½å°‡å®ƒè½‰æ›ç‚º Google Apps Scriptã€‚_ 





æ–°å¢ä¸€å€‹ `GAData.gs` æª”æ¡ˆï¼š
```javascript
// Remeber add Google Analytics Data API to Services, or you'll see this error: ReferenceError: AnalyticsData is not defined
// GA Debug Toole: https://ga-dev-tools.web.app/ga4/query-explorer/

class GAData {
  constructor(date) {
    this.date = date;

    const traffic = this.fetchGADailyUsage();
    this.pc_traffic = traffic["desktop"];
    this.mobile_traffic = traffic["mobile"];
  }

  fetchGADailyUsage() {
    const dimensionPlatform = AnalyticsData.newDimension();
    dimensionPlatform.name = "deviceCategory";

    const metric = AnalyticsData.newMetric();
    metric.name = "sessions";

    const dateRange = AnalyticsData.newDateRange();
    // é è¨­æŸ¥è©¢çµ¦å®šæ—¥ç¯„åœå…§è³‡æ–™ e.g. 2024-01-01 ~ 2024-01-01
    dateRange.startDate = this.getDateString();
    dateRange.endDate = this.getDateString();

    // Filter Example:
    // const filterExpression = AnalyticsData.newFilterExpression();
    // const filter = AnalyticsData.newFilter();
    // filter.fieldName = "landingPagePlusQueryString";
    // const stringFilter = AnalyticsData.newStringFilter()
    // stringFilter.value = "/life|/article|/chat|/house|/event/230502|/event/230310";
    // stringFilter.matchType = "PARTIAL_REGEXP";
    // filter.stringFilter = stringFilter;
    // filterExpression.filter = filter;

    const request = AnalyticsData.newRunReportRequest();
    request.dimensions = [dimensionPlatform];
    request.metrics = [metric];
    request.dateRanges = dateRange;

    // Filter Example:
    // const filterExpression = AnalyticsData.newFilterExpression();
    // filterExpression.expression = filterExpression;
    // request.dimensionFilter = filterExpression;
    // or Not
    // const notFilterExpression = AnalyticsData.newFilterExpression();
    // notFilterExpression.notExpression = filterExpression;
    // request.dimensionFilter = notFilterExpression;

    const report = AnalyticsData.Properties.runReport(request, "properties/" + gaPropertyId).rows;
    // ç„¡è³‡æ–™
    if (report == undefined) {
      return {"desktop": 0, "mobile": 0};
    }

    // [{metricValues=[{value=4517}], dimensionValues=[{value=mobile}]}, {metricValues=[{value=3189}], dimensionValues=[{value=desktop}]}, {metricValues=[{value=63}], dimensionValues=[{value=tablet}]}]

    var result = {};
    report.forEach(function(element) {
      result[element.dimensionValues[0].value] = element.metricValues[0].value;
    });

    return result;
  }

  getDateString() {
    return Utilities.formatDate(this.date, "GMT+8", "yyyy-MM-dd");
  }
}
```

`Main.gs` æ–°å¢æ¸¬è©¦å…§å®¹ï¼š
```javascript
const targetGoogleSheetID = "1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE";
// https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit#gid=275710641

const gaPropertyId = "318495208";

function debug() {
  var report = new DailyReport(targetGoogleSheetID, new Date());
  report.execute();
  //
  var gaData = new GAData(new Date());
  Logger.log(gaData);
}
```

æŒ‰ä¸‹åŸ·è¡Œæˆ–åµéŒ¯å–å¾—ç¨‹å¼æ’ˆå–çµæœï¼š


![](/assets/f6713ba3fee3/1*jwkk0ZqsFN6QyjPLT_gmaw.png)


OK\! æ¯”å°ç›¸ç¬¦ã€‚


![](/assets/f6713ba3fee3/1*fKO7pJzsyjdUWwhyJr3czg.png)


æ­¤æ­¥é©Ÿå®Œæˆæ™‚ï¼Œç›®éŒ„æª”æ¡ˆçµæ§‹å¦‚ä¸Šåœ–ã€‚
#### 4\. å¡«å……è³‡æ–™

å»ºå¥½ Sheetã€æŸ¥å¥½è³‡æ–™å¾Œï¼Œå†ä¾†å°±æ˜¯å¡«å……è³‡æ–™åˆ°æ¬„ä½ä¸­ã€‚

èª¿æ•´ `DailyReport.gs` å¢åŠ  by æ—¥æœŸæ–°å¢æ¬„ä½ï¼†å¡«å……è³‡æ–™çš„é‚è¼¯ï¼š
```javascript
class DailyReport {
  constructor(sheetID, date, gaData, inHouseReportData) {
    this.separateSheet = SpreadsheetApp.openById(sheetID);
    this.date = date;

    const dateString = Utilities.formatDate(date, "GMT+8", "yyyy/MM/dd");
    const weekString = ["æ˜ŸæœŸæ—¥", "æ˜ŸæœŸä¸€","æ˜ŸæœŸäºŒ","æ˜ŸæœŸä¸‰","æ˜ŸæœŸå››","æ˜ŸæœŸäº”","æ˜ŸæœŸå…­"][date.getDay()]; // å–å¾—æ˜ŸæœŸï¼Œæ˜ŸæœŸæ—¥ç‚º0ï¼Œæ˜ŸæœŸä¸€ç‚º1ï¼Œä»¥æ­¤é¡

    this.sheetFields = [
      new DailyReportField("æ—¥æœŸ", new HeaderDateStyle(), new HeaderDateStyle(), null, dateString),
      new DailyReportField("æ˜ŸæœŸ", new HeaderDateStyle(), new HeaderDateStyle(), null, weekString),
      new DailyReportField("æ—¥æµé‡", new HeaderStyle(), new ContentStyle(), "#,##0", '=INDIRECT(SUBSTITUTE(ADDRESS(1,COLUMN(),4),"1","")&4)+INDIRECT(SUBSTITUTE(ADDRESS(1,COLUMN(),4),"1","")&5)'), // =4(PC æµé‡) + 5(Mobile æµé‡)
      new DailyReportField("PC æµé‡", new HeaderStyle(), new ContentStyle(), "#,##0", gaData.pc_traffic),
      new DailyReportField("Mobile æµé‡", new HeaderStyle(), new ContentStyle(), "#,##0", gaData.mobile_traffic),
      new DailyReportField("è¨»å†Šæ•¸", new HeaderStyle(), new ContentStyle(), "#,##0", inHouseReportData.registers)
    ]
  }

  execute() {
    const sheet = this.getSheet();
    const dateColumnIndex = this.makeOrGetDateColumn(sheet); // å–å¾—å·²å­˜åœ¨çš„æ›´æ–°æˆ–å»ºç«‹æ–°çš„æ¬„ä½

    // å¡«å……æ¬„ä½å…§å®¹
    for(const currentRow in this.sheetFields) {
      const sheetField = this.sheetFields[currentRow];
      const rowIndex = parseInt(currentRow) + 1;

      if (rowIndex != null) {
        const range = sheet.getRange(rowIndex, dateColumnIndex);
        const text = sheetField.value;
        const style = sheetField.contentStyle;
        this.setContent(range, text, style);
        this.setFormat(range, sheetField.format);          
      }
    }
  }

  // å–å¾—çµ¦å®šæ—¥æœŸçš„ç›®æ¨™ Sheet
  getSheet() {
    // ä»¥æœˆä¾†å€åˆ† Sheetï¼Œæ‰¾åˆ°ç•¶æœˆ Sheet
    var thisMonthSheet = this.separateSheet.getSheetByName(this.getSheetName());
    if (thisMonthSheet == null) {
      // ç„¡å‰‡å»ºç«‹æ–°çš„æœˆ Sheet
      thisMonthSheet = this.makeMonthSheet();
    }

    return thisMonthSheet;
  }

  // æœˆ Sheet å‘½å
  getSheetName() {
    return Utilities.formatDate(this.date, "GMT+8", "yyyy-MM");
  }

  // å»ºç«‹æ–°çš„æœˆ Sheet
  makeMonthSheet() {
    // æ–°å¢ç•¶æœˆ Sheetï¼Œç§»å‹•åˆ°ç¬¬ä¸€å€‹ä½å­
    var thisMonthSheet = this.separateSheet.insertSheet(this.getSheetName(), {index: 0});
    thisMonthSheet.activate();
    this.separateSheet.moveActiveSheet(1);

    // æ–°å¢ç¬¬ä¸€æ¬„ï¼Œæ¬„ä½åç¨±ã€è¨­å®š Pinnedã€å¯¬åº¦ 200
    thisMonthSheet.insertColumnsBefore(1, 1);
    thisMonthSheet.setFrozenColumns(1);
    thisMonthSheet.setColumnWidths(1, 1, 200);

    // å¡«å……æ¬„ä½åç¨±
    for(const currentRow in this.sheetFields) {
      const sheetField = this.sheetFields[currentRow];
      const text = sheetField.name;
      const style = sheetField.headerStyle;
      
      const range = thisMonthSheet.getRange(parseInt(currentRow) + 1, 1);
      this.setContent(range, text, style);
      range.setHorizontalAlignment("left");
    }

    // è¨­å®šæ¬„é«˜
    thisMonthSheet.setRowHeights(1, Object.keys(this.sheetFields).length, 30);

    // è¨­å®š Pinned ç¬¬ä¸€ã€äºŒåˆ—(æ—¥æœŸã€æ˜ŸæœŸ)
    thisMonthSheet.setFrozenRows(2);

    // æ–°å¢ç¸½è¨ˆæ¬„ä½
    thisMonthSheet.insertColumnsAfter(thisMonthSheet.getLastColumn(), 1); // æ–°å¢ä¸€æ¬„åœ¨æœ€å¾Œä¸€æ¬„
    const summaryColumnIndex = thisMonthSheet.getLastColumn() + 1;

    // å¡«å……ç¸½è¨ˆæ¬„ä½
    for(const currentRow in this.sheetFields) {
      const sheetField = this.sheetFields[currentRow];
      const summaryRowIndex = parseInt(currentRow) + 1;

      const range = thisMonthSheet.getRange(summaryRowIndex, summaryColumnIndex);
      const style = sheetField.contentStyle;

      if (summaryRowIndex == 1) {
        // æ—¥æœŸ...
        this.setContent(range, "ç¸½è¨ˆ", style);
      } else if (summaryRowIndex == 2) {
        // æ˜ŸæœŸ...merge...
        const mergeRange = thisMonthSheet.getRange(1, summaryColumnIndex, summaryRowIndex, 1);
        this.setContent(mergeRange, "ç¸½è¨ˆ", style);
        mergeRange.merge();
      } else {
        this.setContent(range, '=IFERROR(SUM(INDIRECT(SUBSTITUTE(ADDRESS(1, 1, 4), "1", "") & '+summaryRowIndex+'):INDIRECT(SUBSTITUTE(ADDRESS(1, COLUMN() - 1, 4), "1", "") & '+summaryRowIndex+')), 0)', style);
      }
    }

    return thisMonthSheet;
  }

  // å»ºç«‹æˆ–å–å¾—æ—¥æœŸçš„æ¬„ä½
  // å¾æœ€è¿‘ä¸€æ—¥å¾€å¾ŒåŠ ä¸€æ¬„ä½
  makeOrGetDateColumn(sheet) {
    const firstRowColumnsRange = sheet.getRange(1, 1, 1, sheet.getLastColumn()); // å–å¾—ç¬¬ä¸€åˆ—(æ—¥æœŸ)è³‡æ–™ç¯„åœ
    const firstRowColumns = firstRowColumnsRange.getValues()[0]; // å–å¾—è³‡æ–™ç¯„åœçš„å€¼ 0 = ç¬¬ä¸€åˆ—
    
    var columnIndex = firstRowColumns.findIndex((date) => (date instanceof Date && Utilities.formatDate(date, "GMT+8", "yyyy/MM/dd") == Utilities.formatDate(this.date, "GMT+8", "yyyy/MM/dd"))); // æ‰¾åˆ°å°æ‡‰æ—¥æœŸçš„æ¬„ä½ Index

    if (columnIndex < 0) {
      // Not Foundï¼Œæ‰¾åˆ°å‰ä¸€æ—¥çš„ä½å­
      var preDate = new Date(this.date);
      preDate.setDate(preDate.getDate() - 1);

      while(preDate.getMonth() == this.date.getMonth()) {
        columnIndex = firstRowColumns.findIndex((date) => (date instanceof Date && Utilities.formatDate(date, "GMT+8", "yyyy/MM/dd") == Utilities.formatDate(preDate, "GMT+8", "yyyy/MM/dd")));
        if (columnIndex >= 0) {
          break;
        }

        preDate.setDate(preDate.getDate() - 1);
      }

      if (columnIndex >= 0) {
        columnIndex += 1;
        sheet.insertColumnsAfter(columnIndex, 1); // åœ¨å‰ä¸€æ—¥æ¬„ä½å¾Œæ–°å¢ä¸€æ¬„
        columnIndex += 1;
      }
    } else {
      columnIndex += 1;
    }

    if (columnIndex < 0) {
        sheet.insertColumnsAfter(1, 1); // é»˜èªï¼Œç›´æ¥æ–°å¢ä¸€æ¬„åœ¨ç¬¬ä¸€æ¬„å¾Œé¢
        columnIndex = 2;
    } 

    // è¨­å®šæ¬„ä½å¯¬åº¦
    sheet.setColumnWidths(columnIndex , 1, 100);

    return columnIndex
  }

  // è¨­å®šæ¬„ä½ Format æ¨£å¼
  setFormat(range, format) {
    if (format != null) {
      range.setNumberFormat(format);
    }
  }

  // å¡«å……å…§å®¹åˆ°æ¬„ä½
  setContent(range, text, style) {
    if (String(text) != "") {
      range.setValue(text);
    }

    range.setBackgroundColor(style.backgroundColor);
    range.setFontColor(style.color);

    if (style.bold) {
      range.setFontWeight("bold");
    }

    range.setHorizontalAlignment(style.horizontalAlignment);
    range.setVerticalAlignment(style.verticalAlignment);
    range.setFontSize(style.size);
    range.setBorder(true, true, true, true, true, true, "black", SpreadsheetApp.BorderStyle.SOLID);
  }
}
```

èª¿æ•´ `Main.gs` å¢åŠ è³‡æ–™ä¸²æ¥ä¸¦åœ¨æ§‹å»ºéšæ®µè³¦å€¼ï¼š
```javascript
const targetGoogleSheetID = "1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE";
// https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit#gid=275710641

const gaPropertyId = "318495208";

function debug() {
  const date = new Date();
  const gaData = new GAData(date);
  const inHouseReportData = fetchInHouseReportData(date);
  
  const report = new DailyReport(targetGoogleSheetID, date, gaData, inHouseReportData);
  report.execute();
  
}

// æ¨¡æ“¬éƒ¨åˆ†æ•¸æ“šè³‡æ–™å¯èƒ½æ˜¯æ‰“å…¶ä»–å¹³å° API å–å¾—çš„ã€‚
function fetchInHouseReportData(date) {
  // EXMAPLE REQUEST:
  // var options = {
  //   'method' : 'get',
  //   'headers': {
  //       'Authorization':  'Bearer XXX'
  //   }
  // };
  // OR
  // var options = {
  //   'method' : 'post',
  //   'headers': {
  //       'Authorization':  'Bearer XXX'
  //   },
  //   'payload' : data
  // };

  // var res = UrlFetchApp.fetch(url, options);
  // const result = JSON.parse(res.getContentText());

  // REMEMBER, DUE TO SECURITY REASON, We can't customize user-agent.
  
  return {"registers": Math.floor(Math.random() * (180 - 30 + 1)) + 30} // MOCK DATA random 30~180
}
```

å®Œæˆå¾Œæˆ‘å€‘å›åˆ°ã€Œ `Main.gs` ã€é¸æ“‡ã€Œdebugã€ä¸¦æŒ‰ä¸‹åµéŒ¯ï¼ŒæŸ¥çœ‹åŸ·è¡Œçµæœæ˜¯å¦æ­£ç¢ºã€æœ‰ç„¡å‡ºéŒ¯ã€‚


![](/assets/f6713ba3fee3/1*0h1-vgwjvuYBkQ0QTNeDRQ.png)


å›åˆ° Google Sheet\! æˆåŠŸ\! æˆ‘å€‘æˆåŠŸçš„è‡ªå‹•æ–°å¢äº†è©²æ—¥æœŸçš„è³‡æ–™ã€‚
#### 5\. è¨­å®šæ’ç¨‹ï¼Œæ¯æ—¥è‡ªå‹•åŸ·è¡Œ

è…³æœ¬å®Œæˆå¾Œï¼Œå†ä¾†åªè¦è¨­å®šè‡ªå‹•è§¸ç™¼æ¢ä»¶ï¼Œå°±èƒ½æ¯æ—¥è‡ªå‹•å®Œæˆå›‰ã€‚

èª¿æ•´ `Main.gs` æ–°å¢ `cronjob()` function:
```javascript
const targetGoogleSheetID = "1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE";
// https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit#gid=275710641

const gaPropertyId = "318495208";

function debug() {
  cronjob();
}

// ç…§ç¾å¯¦ç‹€æ³ä¾†èªªï¼Œé€šå¸¸æ˜¯ä»Šæ—¥æŸ¥æ˜¨æ—¥æ•¸æ“šï¼Œæ‰æ˜¯å®Œæ•´çš„è³‡æ–™
function cronjob() {
  const yesterday = new Date();
  yesterday.setDate(yesterday.getDate() - 1);

  const gaData = new GAData(yesterday);
  const inHouseReportData = fetchInHouseReportData(yesterday);
  
  const report = new DailyReport(targetGoogleSheetID, yesterday, gaData, inHouseReportData);
  report.execute();
}

// æ¨¡æ“¬éƒ¨åˆ†æ•¸æ“šè³‡æ–™å¯èƒ½æ˜¯æ‰“å…¶ä»–å¹³å° API å–å¾—çš„ã€‚
function fetchInHouseReportData(date) {
  // EXMAPLE REQUEST:
  // var options = {
  //   'method' : 'get',
  //   'headers': {
  //       'Authorization':  'Bearer XXX'
  //   }
  // };
  // OR
  // var options = {
  //   'method' : 'post',
  //   'headers': {
  //       'Authorization':  'Bearer XXX'
  //   },
  //   'payload' : data
  // };

  // var res = UrlFetchApp.fetch(url, options);
  // const result = JSON.parse(res.getContentText());

  // REMEMBER, DUE TO SECURITY REASON, We can't customize user-agent.
  
  return {"registers": Math.floor(Math.random() * (180 - 30 + 1)) + 30} // MOCK DATA random 30~180
}
```

åœ¨ç·¨è¼¯å™¨ä¸Šåˆ‡æ›åˆ°ã€Œè§¸ç™¼æ¢ä»¶ã€é ç±¤ï¼Œé¸æ“‡å³ä¸‹è§’ã€Œæ–°å¢è§¸ç™¼æ¢ä»¶ã€ï¼š


![](/assets/f6713ba3fee3/1*SPBAPOufdTwde3F2_zOvVA.png)

- é¸æ“‡æ‚¨è¦åŸ·è¡Œçš„åŠŸèƒ½ï¼šå‰›æ–°å¢çš„ `Main.gs` Function `cronjob`
- é¸æ“‡æ‡‰åŸ·è¡Œçš„éƒ¨ç½²ä½œæ¥­ï¼šä¸Šç«¯ \(Head, æ„ç‚ºæœ€æ–°ç‰ˆ\)
- é¸å–æ´»å‹•ä¾†æºï¼šæ™‚é–“é©…å‹•
- é¸å–æ™‚é–“å‹è§¸ç™¼æ¢ä»¶é¡å‹ï¼šæ—¥è¨ˆæ™‚å™¨
- é¸å–æ™‚æ®µï¼šAM 4:00 â€” AM 5:00 \(GMT\+08:00\)
é€šå¸¸åœ¨ AM 4:00 ä¸€åˆ°å°±æœƒåŸ·è¡Œã€‚
- éŒ¯èª¤é€šçŸ¥è¨­å®šï¼šç•¶è…³æœ¬ç™¼ç”ŸéŒ¯èª¤æ™‚æ˜¯è¦é¦¬ä¸Šé€šçŸ¥ï¼Œé‚„æ˜¯æ¯æ—¥å½™æ•´ä¸€æ¬¡


**å„²å­˜è¨­å®šï¼Œå®Œæˆã€‚**

ä¹‹å¾Œå¯ä»¥å»ã€ŒåŸ·è¡Œé …ç›®ã€é ç±¤æŸ¥çœ‹åŸ·è¡Œç´€éŒ„çµæœï¼š


![](/assets/f6713ba3fee3/1*pqn5ljYggb1lVWgYDSq6Sw.png)



> **_è‡³æ­¤æˆ‘å€‘å·²å®Œæˆè‡ªå‹•åŒ–æŸ¥è©¢ã€æ–°å¢è³‡æ–™ã€å¡«å…¥è³‡æ–™çš„å ±è¡¨ RPA åŠŸèƒ½ï¼ğŸ‰ğŸ‰ğŸ‰_** 




#### æ­å»º Web GUI Dashboard

å†ä¾†æœ‰å€‹æ¬¡è¦éœ€æ±‚ï¼Œæˆ‘å€‘éœ€è¦å»ºç«‹ä¸€å€‹ç°¡å–®çš„ Web å‘ˆç¾æ¯æ—¥æ•¸æ“šï¼ˆé¡ä¼¼æˆ°æƒ…ä¸­å¿ƒçš„æ¦‚å¿µï¼‰æœƒåœ¨åœ˜éšŠèƒŒå¾Œç‰†ä¸Šå¤§è¢å¹•ä¸Šç›´æ¥é¡¯ç¤ºã€‚

**æ•ˆæœå¦‚ä¸‹åœ–ï¼š**


![](/assets/f6713ba3fee3/1*8SRT_wSe2aQGzcqpRt2Qjw.png)


**æ–°å¢ `Web_DailyReport.gs` æ’°å¯«è®€å– Google Sheet ä¸¦å°‡æ¬„ä½ã€æ¨£å¼è½‰æ›ç‚º HTML æ ¼å¼å‘ˆç¾ï¼š**
```javascript
class WebDailyReport {
  constructor(sheetID, dayCount) {
    this.separateSheet = SpreadsheetApp.openById(sheetID);
    this.dayCount = dayCount;
    this.sheetRows = [
      "æ—¥æœŸ",
      "æ˜ŸæœŸ",
      "æ—¥æµé‡",
      "PC æµé‡",
      "Mobile æµé‡",
      "è¨»å†Šæ•¸"
    ];
  }

  allData(startDate) {
    var sheetRowsIndexs = {};
    var count = this.dayCount;
    var result = [];
    while (count >= 0) {
      const preDate = new Date(startDate);
      preDate.setDate(preDate.getDate() - (this.dayCount - count));
      const sheetName = Utilities.formatDate(preDate, "GMT+8", "yyyy-MM");
      const targetSheet = this.separateSheet.getSheetByName(sheetName);
      if (targetSheet != null) {
        const firstRowColumnsRange = targetSheet.getRange(1, 1, 1, targetSheet.getLastColumn()); // å–å¾—ç¬¬ä¸€åˆ—(æ—¥æœŸ)è³‡æ–™ç¯„åœ
        const firstRowColumns = firstRowColumnsRange.getValues()[0]; // å–å¾—è³‡æ–™ç¯„åœçš„å€¼ 0 = ç¬¬ä¸€åˆ—
        var columnIndex = firstRowColumns.findIndex((date) => (date instanceof Date && Utilities.formatDate(date, "GMT+8", "yyyy/MM/dd") == Utilities.formatDate(preDate, "GMT+8", "yyyy/MM/dd"))); // æ‰¾åˆ°å°æ‡‰æ—¥æœŸçš„æ¬„ä½ Index
        
        if (columnIndex >= 0) {
          columnIndex = parseInt(columnIndex) + 1;
          if (sheetRowsIndexs[sheetName] == undefined || sheetRowsIndexs[sheetName] == null) {
            sheetRowsIndexs[sheetName] = this.sheetRows.map((sheetRow) => this.getFieldRow(targetSheet, sheetRow));
          }

          if (result.length == 0) {
            // æ–°å¢ç¬¬ä¸€æ¬„
            const ranges = sheetRowsIndexs[sheetName].map((rowIndex) => (rowIndex != null) ? (targetSheet.getRange(rowIndex, 1)) : (null));
            result.push(this.makeValues(ranges));
          }

          const ranges = sheetRowsIndexs[sheetName].map((rowIndex) => (rowIndex != null) ? (targetSheet.getRange(rowIndex, columnIndex)) : (null));
          result.push(this.makeValues(ranges));
        }
      }

      count -= 1;
    }

    var transformResult = {};
    for (const columnIndex in result) {
      for (const rowIndex in result[columnIndex]) {
        if (transformResult[rowIndex] == undefined) {
          transformResult[rowIndex] = [];
        }

        if (columnIndex == 0) {
          transformResult[rowIndex].unshift(result[columnIndex][rowIndex]);
        } else {
          transformResult[rowIndex].splice(1, 0, result[columnIndex][rowIndex]);
        }
        
      }
    }

    return transformResult;
  }

  // è½‰æ› æ¬„ä½å±¬æ€§ å€¼æˆ é¡¯ç¤ºç”¨ç‰©ä»¶
  makeValues(ranges) {
    const data = ranges.map((range) => (range != null) ? (range.getDisplayValues()) : (null)).map((values) => (values != null) ? (values[0][0]) : (null));
    const backgroundColors = ranges.map((range) => (range != null) ? (range.getBackgrounds()) : (null)).map((values) => (values != null) ? (values[0][0]) : (null));
    const colors = ranges.map((range) => (range != null) ? (range.getFontColorObjects()) : (null)).map((values) => (values != null) ? (values[0][0]) : (null));
    const sizes = ranges.map((range) => (range != null) ? (range.getFontSizes()) : (null)).map((values) => (values != null) ? (values[0][0]) : (null));
    const bolds = ranges.map((range) => (range != null) ? (range.getFontWeights()) : (null)).map((values) => (values != null) ? (values[0][0]) : (null));
    const horizontalAlignments = ranges.map((range) => (range != null) ? (range.getHorizontalAlignments()) : (null)).map((values) => (values != null) ? (values[0][0]) : (null));
    const verticalAlignments = ranges.map((range) => (range != null) ? (range.getVerticalAlignments()) : (null)).map((values) => (values != null) ? (values[0][0]) : (null));

    var result = [];
    for(const index in data) {
        const row = data[index];
        result.push({
          "value": row,
          "backgroundColor": backgroundColors[index],
          "color": this.colorStripper(colors[index]?.asRgbColor()?.asHexString()),
          "size": sizes[index],
          "bold": bolds[index],
          "horizontalAlignment": this.alignConventer(horizontalAlignments[index]),
          "verticalAlignment": verticalAlignments[index]
        });
    }

    return result;
  }

  colorStripper(colorString) {
    if (colorString == undefined || colorString == null) {
      return null
    }

    if (colorString.length == 9) {
      return "#"+colorString.substring(3, 9);
    } else {
      return colorString;
    }
  }

  alignConventer(horizontalAlignment) {
    if (horizontalAlignment == undefined || horizontalAlignment == null) {
      return null
    }

    return horizontalAlignment.replace('general-', '')
  }

  getFieldRow(sheet, name) {
    const firstColumnRowsRange = sheet.getRange(1, 1, sheet.getLastRow(), 1); // å–å¾—ç¬¬ä¸€æ¬„(æ¬„ä½)è³‡æ–™ç¯„åœ
    const firstColumnRows = firstColumnRowsRange.getValues(); // å–å¾—è³‡æ–™ç¯„åœçš„å€¼
    const foundIndex = firstColumnRows.findIndex((firstColumnRow) => firstColumnRow[0] == name);

    if (foundIndex < 0) {
      return null;
    } else {
      return foundIndex + 1;
    }
  }
}
```

`Main.gs` **å¢åŠ  Web è«‹æ±‚ Handleï¼š**
```javascript
const targetGoogleSheetID = "1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE";
// https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit#gid=275710641

const gaPropertyId = "318495208";

function debug() {
  cronjob();
}

function cronjob() {
  const yesterday = new Date();
  yesterday.setDate(yesterday.getDate() - 1);

  const gaData = new GAData(yesterday);
  const inHouseReportData = fetchInHouseReportData(yesterday);
  
  const report = new DailyReport(targetGoogleSheetID, yesterday, gaData, inHouseReportData);
  report.execute();
}

function doGet(e) {
  return HtmlService.createTemplateFromFile('Web_DailyReport_ Scaffolding').evaluate();
}

function getDailyReportBody() {
  const html = HtmlService.createTemplateFromFile('Web_DailyReport_Body').evaluate().getContent();
  return html;
}

// FOR POST
// function doPost(e) {
//  ref: https://developers.google.com/apps-script/guides/web?hl=zh-tw
// }


// æ¨¡æ“¬éƒ¨åˆ†æ•¸æ“šè³‡æ–™å¯èƒ½æ˜¯æ‰“å…¶ä»–å¹³å° API å–å¾—çš„ã€‚
function fetchInHouseReportData(date) {
  // EXMAPLE REQUEST:
  // var options = {
  //   'method' : 'get',
  //   'headers': {
  //       'Authorization':  'Bearer XXX'
  //   }
  // };
  // OR
  // var options = {
  //   'method' : 'post',
  //   'headers': {
  //       'Authorization':  'Bearer XXX'
  //   },
  //   'payload' : data
  // };

  // var res = UrlFetchApp.fetch(url, options);
  // const result = JSON.parse(res.getContentText());

  // REMEMBER, DUE TO SECURITY REASON, We can't customize user-agent.
  
  return {"registers": Math.floor(Math.random() * (180 - 30 + 1)) + 30} // MOCK DATA random 30~180
}
```

**æ–°å¢ `Web_DailyReport_ Scaffolding.html` Web Dashboard æ¡†æ¶ï¼Œç”±æ–¼æˆ‘å€‘çš„æˆ°æƒ…å®¤è¢å¹•è¦åšåˆ°è‡ªå‹•æ›´æ–°å…§å®¹ï¼Œå› æ­¤æˆ‘å€‘å»ºç«‹ä¸€å€‹ Web éª¨æ¶ï¼Œåœ¨å…¶ä¸­å®šæ™‚ç”¨ Ajax å»æ’ˆå– HTML å…§å®¹ï¼š**
```xml
<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <script>
      function onSuccess(html) {
        if (html != null) {
          var div = document.getElementById('result');
          div.innerHTML = html;
        }
     }
     setInterval(()=>{
       google.script.run.withSuccessHandler(onSuccess).getDailyReportBody()
     }, 1000 * 60 * 60 * 1);
     google.script.run.withSuccessHandler(onSuccess).getDailyReportBody();
    </script>
  </head>
  <body>
    <div id="result">Loading...</div>
  </body>
</html>
```

**æ–°å¢** `Web_DailyReport_Body.html` å¯¦éš›æ¸²æŸ“è³‡æ–™æˆ HTML çš„åœ°æ–¹ï¼š
```xml
<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
    table {
        border-collapse: collapse;
        width: 100%;
        text-align: center;
    }
    th, td {
        border: 1px solid #000000;
        padding: 8px;
        text-align: center;
        font-size: 36px;
    }
      </style>
  </head>
  <body>
      <h1 style="text-align:center">ZHGCHG.LI</h1>
      <table id="dataTable">
        <tbody>
          <?
          // é¡¯ç¤ºè¿‘ 7 å¤©æ•¸æ“š
          const dashboard = new WebDailyReport(targetGoogleSheetID, 7);
          // å¾æ˜¨å¤©é–‹å§‹
          const yesterday = new Date();
          yesterday.setDate(yesterday.getDate() - 1);
          const data = dashboard.allData(yesterday);
          for(const rowIndex in data) {
            const row = data[rowIndex];
            ?>
            <tr>
              <?
              for(const columnIndex in row) {
                const column = row[columnIndex];
                ?>
                <td style="background-color: <?=column["backgroundColor"]?>; color: <?=column["color"]?>; text-align: <?=column["horizontalAlignment"]?>;">
                  <?=column["value"]?>
                </td>
                <?
              }
              ?>
            </tr>
            <?
          }
          ?>
        </tbody>
      </table>
      <script>
  </body>
</html>
```


> **_è«‹æ³¨æ„ï¼Œæˆ‘å€‘æ˜¯å¾æ˜¨å¤©é–‹å§‹å¾€å¾Œæ’ˆ 7 å¤©çš„æ•¸æ“šåšæ¯”å°ï¼Œä¸æœƒé¡¯ç¤ºä»Šå¤©çš„æ•¸æ“šã€‚_** 





å®Œæˆä»¥ä¸Šæ­¥é©Ÿå¾Œçš„å°ˆæ¡ˆæª”æ¡ˆç›®éŒ„å¦‚ä¸‹ï¼š


![](/assets/f6713ba3fee3/1*G1ig9iHOyRckIf7gOMYd7Q.png)


**æ¸¬è©¦éƒ¨ç½²ï¼š**

é»æ“Šå°ˆæ¡ˆå³ä¸Šè§’ã€Œéƒ¨ç½²ã€\-&gt;ã€Œæ¸¬è©¦éƒ¨ç½²ä½œæ¥­ã€


![](/assets/f6713ba3fee3/1*0qsoN6CIATn9dU588pOrBw.png)



![](/assets/f6713ba3fee3/1*io3ugHFQfsEyCxIs0WTZ_w.png)



![](/assets/f6713ba3fee3/1*gIQHWeCPuuxHGZUyvBomNA.png)

- éƒ¨ç½²å®Œæˆé»æ“Šç¶²å€å³å¯æŸ¥çœ‹æ¸¬è©¦çµæœã€‚
- **è«‹æ³¨æ„æ­¤ç¶²å€åƒ…å…±ä¸€æ¬¡æ€§æ¸¬è©¦ä½¿ç”¨ï¼Œå¦‚æœç¨‹å¼ç¢¼æœ‰èª¿æ•´è¦å†é‡æ–°é»ä¸€æ¬¡æ¸¬è©¦éƒ¨ç½²ä½œæ¥­ã€‚**


å¡åœ¨ Loadingâ€¦ å…§å®¹æ²’å‡ºä¾†æˆ–å‡ºç¾ä¼ºæœå™¨éŒ¯èª¤ï¼Œå¯ä»¥å›åˆ°ç·¨è¼¯å™¨çš„ã€ŒåŸ·è¡Œé …ç›®ã€é ç±¤æŸ¥çœ‹éŒ¯èª¤è¨Šæ¯ï¼š


![](/assets/f6713ba3fee3/1*XPmKwym8wmI3D2-cb2gs6w.png)


**å®Œæˆæ­£å¼éƒ¨ç½²ï¼š**

å¦‚æœæ¸¬è©¦æ²’å•é¡Œå°±å¯ä»¥å®Œæˆæ­£å¼éƒ¨ç½²ï¼Œé‡‹å‡ºç¶²å€ã€‚

é»æ“Šå°ˆæ¡ˆå³ä¸Šè§’ã€Œéƒ¨ç½²ã€\-&gt;ã€Œæ–°å¢éƒ¨ç½²ä½œæ¥­ã€\-&gt; å·¦ä¸Šè§’ã€Œé¸å–é¡å‹ã€\-&gt;ã€Œç¶²é æ‡‰ç”¨ç¨‹å¼ã€ï¼š


![](/assets/f6713ba3fee3/1*SghEZm_MdxKO_lD8siKLJg.png)



![](/assets/f6713ba3fee3/1*pP1fRjkpKNBjZJ9Hnvy4XQ.png)



![](/assets/f6713ba3fee3/1*r0Tw8C30kGUn-YXfOssBtA.png)

- åŸ·è¡Œèº«ä»½ï¼šé è¨­ç‚ºç•¶å‰å¸³è™Ÿ\(åŒ Google Apps Script ä½¿ç”¨è€…\)
- èª°å¯ä»¥å­˜å–ï¼šè¨­ç‚ºæ‰€æœ‰äººåªè¦çŸ¥é“ç¶²å€çš„äººéƒ½èƒ½å­˜å–ã€ä¹Ÿå¯è¨­ç‚ºåƒ…çµ„ç¹”å¯å­˜å–ï¼Œæœƒå…ˆè¦æ±‚ Google ç™»å…¥æ‰èƒ½å­˜å–ã€‚
- éƒ¨ç½²å®Œæˆï¼Œå–å¾—ç¶²å€ã€‚


**ç¨‹å¼ç¢¼æœ‰æ›´å‹•éœ€é‡æ–°éƒ¨ç½²æ‰æœƒç”Ÿæ•ˆï¼š**

è«‹æ³¨æ„ç•¶ç¨‹å¼ç¢¼æœ‰è®Šå‹•æ™‚ï¼Œéœ€è¦é‡æ–°éƒ¨ç½²\(ç¶²å€ä¸æœƒè®Š\)ï¼Œæ›´å‹•æ‰æœƒç”Ÿæ•ˆï¼Œå¦å‰‡æœƒä¸€ç›´æ˜¯èˆŠçš„ã€‚

é»æ“Šå°ˆæ¡ˆå³ä¸Šè§’ã€Œéƒ¨ç½²ã€\-&gt;ã€Œç®¡ç†éƒ¨ç½²ä½œæ¥­ã€ï¼š


![](/assets/f6713ba3fee3/1*3y5A1ogNe9cpG_ObZt1_FA.png)



![](/assets/f6713ba3fee3/1*qqQm-XAKgiGyYClX_Z0CaA.png)



![](/assets/f6713ba3fee3/1*Ea_7NeyuRAfcHCGBvKAYhw.png)


é»æ“Šå³ä¸Šè§’ã€Œç­†ğŸ–Šï¸ ICONã€\-&gt; ã€Œç‰ˆæœ¬ã€ \-&gt;ã€Œå»ºç«‹æ–°ç‰ˆæœ¬ã€\-&gt;ã€Œéƒ¨ç½²ã€ã€‚

éƒ¨ç½²å®Œæˆå¾Œé»æ“Šç¶²å€ï¼Œæˆ–å›åˆ°åŸç¶²å€é‡æ–°æ•´ç†å³å¯çœ‹åˆ°æ–°çš„æ›´å‹•çµæœã€‚
#### ğŸ‰ğŸ‰å®Œæˆï¼è‡³æ­¤æˆ‘å€‘æ‰€æœ‰çš„ RPA éœ€æ±‚çš†å·²å®Œæˆã€‚ğŸ‰ğŸ‰

æœ€çµ‚æˆæœï¼š


![\(æ”¹ç¨‹å¼å›è£œæœ¬æœˆæ•¸æ“šï¼Œå¦å‰‡å…¨æ–°è³‡æ–™ä¸‹åªæœ‰æ˜¨æ—¥ä¸€ç­†\)](/assets/f6713ba3fee3/1*8SRT_wSe2aQGzcqpRt2Qjw.png)

\(æ”¹ç¨‹å¼å›è£œæœ¬æœˆæ•¸æ“šï¼Œå¦å‰‡å…¨æ–°è³‡æ–™ä¸‹åªæœ‰æ˜¨æ—¥ä¸€ç­†\)


> [https://script\.google\.com/macros/s/AKfycbz2Vk\-ikU8DSXjpnLq9r6HNAn3zlNAosvDoItG0cxy0bmItRDSVyEzTdwsL2HyFUz99/exec](https://script.google.com/macros/s/AKfycbz2Vk-ikU8DSXjpnLq9r6HNAn3zlNAosvDoItG0cxy0bmItRDSVyEzTdwsL2HyFUz99/exec){:target="_blank"} 




### å®Œæ•´ Google Sheet Demoï¼š
- Google Sheet:
[https://docs\.google\.com/spreadsheets/d/1\-9lZCpsu3E7eDmO\-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit?usp=sharing](https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit?usp=sharing){:target="_blank"}
- Web GUI URL:
[https://script\.google\.com/macros/s/AKfycbz2Vk\-ikU8DSXjpnLq9r6HNAn3zlNAosvDoItG0cxy0bmItRDSVyEzTdwsL2HyFUz99/exec](https://script.google.com/macros/s/AKfycbz2Vk-ikU8DSXjpnLq9r6HNAn3zlNAosvDoItG0cxy0bmItRDSVyEzTdwsL2HyFUz99/exec){:target="_blank"}
- **Google Apps Script:** 
[https://script\.google\.com/home/projects/1vHgXPTV\_q8MC75FVzAEtzD2JPVnPBpMfFXbjZR7SLMVjoEH1FcjKlo8l/edit](https://script.google.com/home/projects/1vHgXPTV_q8MC75FVzAEtzD2JPVnPBpMfFXbjZR7SLMVjoEH1FcjKlo8l/edit){:target="_blank"}

### æœ€å¾Œé™„ä¸Šå…¶ä»–æ—¥å¸¸ç”Ÿæ´»æ‡‰ç”¨ï¼š
#### Robotic Process Automation with Google Apps Script â€” Github Repo Star Notifier to Line


[![](https://miro.medium.com/v2/resize:fit:1200/1*fUtW942huwnSbPF-ar4OCQ.png)](https://medium.com/zrealm-ios-dev/%E4%BD%BF%E7%94%A8-google-apps-script-%E4%B8%89%E6%AD%A5%E9%A9%9F%E5%85%8D%E8%B2%BB%E5%BB%BA%E7%AB%8B-github-repo-star-notifier-382218e15697){:target="_blank"}

#### Robotic Process Automation with Google Apps Script â€” Notion Database to Calendar


ä¹‹å‰ç°¡æ˜“å¯¦ç¾çš„ Notion to Calendar åŠŸèƒ½ã€‚


> _å¯¦ç¾æ–¹å¼æ˜¯ï¼Œæˆ‘å»ä¸²æ¥ Notion API æ’ˆå– Database è³‡æ–™ä¸¦å¥—ç”¨ç”¢å‡º ICS æ ¼å¼ç¶²é ï¼Œéƒ¨ç½²æˆå…¬é–‹çš„ç¶²é ï¼›å°‡æ­¤ç¶²å€æ–°å¢åˆ° Apple Calendar å³å¯ã€‚_ 





`Main.gs` :
```javascript
// Constant variables
const notionToken = "XXXXX";
const safeToken = "XXXXX";

function doGet(e) {
  const ics = HtmlService.createTemplateFromFile('ics');

  if (e.parameter.token != safeToken) {
    return ContentService.createTextOutput("Access Denied!");
  }

  ics.events = getQuickNote();
  
  return ContentService.createTextOutput(ics.evaluate().getContent()).setMimeType(ContentService.MimeType.ICAL);
}

function debug() {
  const ics = HtmlService.createTemplateFromFile('ics');
  ics.events = getQuickNote();
  Logger.log(ics.evaluate().getContent());
}

function getQuickNote() {
  // YOUR FILTER Condition:
  const payload = {
    "filter": {
      "and": [
        {
          "property": "Date",
            "date": {
            "is_not_empty": true
          }
        }
        ,
        {
          "property": "Name",
            "title": {
            "is_not_empty": true
          }
        }
      ]
    }
  };
  const result = getDatabase(YOUR_DATABASE_ID, payload);
  var events = [];
  for (const index in result.results) {
    const item = result.results[index]
    const properties = item.properties;

    const id = item['id'];
    const create = toICSDate(item["created_time"]);
    const edit = toICSDate(item["last_edited_time"]);
    const startDate = properties['Date']['date']['start'];
    const start = toICSDate(startDate);
    var endDate = properties['Date']?.['date']?.['end'];
    if (endDate == null) {
      endDate = startDate;
    }
    const end = toICSDate(endDate);
    const type = properties['Type']?.['multi_select']?.[0]?.['name'];

    const title = "["+type+"] "+properties?.['Name']?.['title']?.[0]?.['plain_text'];
    const description = item['url'];
    
    events.push(
      {
        "id":id,
        "create":create,
        "edit":edit,
        "start":start,
        "end":end,
        "title":title,
        "description":description
      }
    )
  }
  return events;
}
// TO UTC Date
function toICSDate(date) {
  const icsDate = new Date(date);
  icsDate.setHours(icsDate.getHours() - 8);
  return Utilities.formatDate(icsDate, "GMT+8", "yyyyMMdd'T'HHmmss'Z'");// 20240304T132300Z
}

// Notion
function getDatabase(id, payload) {
  const url = 'https://api.notion.com/v1/databases/'+id+'/query/';
  const options = {
    method: 'post',
    headers: {
      'Authorization': 'Bearer '+notionToken,
      'Content-Type': 'application/json',
      'Notion-Version': '2022-06-28'
    },
    payload: JSON.stringify(payload)
  }; 
  const result = UrlFetchApp.fetch(url, options);
  return JSON.parse(result.getContentText());
}
```

`ics.html` :
```plaintext
BEGIN:VCALENDAR
PRODID:-//Google Inc//Google Calendar 70.9054//EN
VERSION:2.0
CALSCALE:GREGORIAN
METHOD:PUBLISH
X-WR-CALNAME:NotionCalendar
X-WR-TIMEZONE:Asia/Taipei
BEGIN:VTIMEZONE
TZID:Asia/Taipei
X-LIC-LOCATION:Asia/Taipei
BEGIN:STANDARD
TZOFFSETFROM:+0800
TZOFFSETTO:+0800
TZNAME:CST
DTSTART:19700101T000000
END:STANDARD
END:VTIMEZONE
<?
  for(const eventIndex in events) {
    const event = events[eventIndex];
    ?>
BEGIN:VEVENT
DTSTART:<?=event["start"]?>

DTEND:<?=event["end"]?>

DTSTAMP:<?=event["edit"]?>

UID:<?=event["id"]?>

CREATED:<?=event["create"]?>

LAST-MODIFIED:<?=event["edit"]?>

SEQUENCE:0
STATUS:CONFIRMED
SUMMARY:<?=event["title"]?>

DESCRIPTION:<?=event["description"]?>

TRANSP:OPAQUE
END:VEVENT
<?
  }
?>
END:VCALENDAR
```

åŒå‰æ–‡ï¼Œéƒ¨ç½²æˆç¶²é æœå‹™ï¼Œé»æ“Šå°ˆæ¡ˆå³ä¸Šè§’ã€Œéƒ¨ç½²ã€\-&gt;ã€Œæ–°å¢éƒ¨ç½²ä½œæ¥­ã€\-&gt; å·¦ä¸Šè§’ã€Œé¸å–é¡å‹ã€\-&gt;ã€Œç¶²é æ‡‰ç”¨ç¨‹å¼ã€ï¼š


![](/assets/f6713ba3fee3/1*SghEZm_MdxKO_lD8siKLJg.png)



![](/assets/f6713ba3fee3/1*pP1fRjkpKNBjZJ9Hnvy4XQ.png)



![](/assets/f6713ba3fee3/1*r0Tw8C30kGUn-YXfOssBtA.png)

- èª°å¯ä»¥å­˜å–è¦é¸æ‰€æœ‰äººï¼Œå› ç‚ºç„¡æ³•åœ¨åŠ  Calendar æ™‚é€²è¡Œ Google ç™»å…¥é©—è­‰ã€‚



![](/assets/f6713ba3fee3/1*2HFKnh4QeQ4iTlEJRSNbYw.png)



![](/assets/f6713ba3fee3/1*dVpsg748XbWwfomuT1VcWQ.png)


**å°‡ç¶²å€æ–°å¢è‡³è¡Œäº‹æ›†è¨‚é–±ï¼Œå®Œæˆ** ğŸ‰ğŸ‰ğŸ‰ğŸ‰ **ï¼**
### å·¥å•†æ™‚é–“

å¦‚æœæ‚¨èˆ‡æ‚¨çš„åœ˜éšŠæœ‰è‡ªå‹•åŒ–å·¥å…·ã€æµç¨‹ä¸²æ¥éœ€æ±‚ï¼Œä¸è«–æ˜¯ Slack App é–‹ç™¼ã€Notionã€Asanaã€Google Sheetã€Google Formã€GA æ•¸æ“šï¼Œå„ç¨®ä¸²æ¥éœ€æ±‚ï¼Œæ­¡è¿èˆ‡æˆ‘ [**è¯çµ¡é–‹ç™¼**](https://zhgchg.li/contact/){:target="_blank"} ã€‚


æœ‰ä»»ä½•å•é¡ŒåŠæŒ‡æ•™æ­¡è¿ [èˆ‡æˆ‘è¯çµ¡](https://www.zhgchg.li/contact){:target="_blank"} ã€‚



_[Post](https://medium.com/zrealm-robotic-process-automation/%E4%BD%BF%E7%94%A8-google-apps-script-%E5%AF%A6%E7%8F%BE-google-%E6%9C%8D%E5%8B%99-rpa-%E8%87%AA%E5%8B%95%E5%8C%96-f6713ba3fee3){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}._