---
author: ZhgChgLi
categories:
- ZRealm Dev.
date: 2025-01-11T11:19:43.066+0000
description: Github Action Workflow è¡¨å–®å„ªåŒ–èˆ‡æ•´åˆå…¶ä»–å·¥ä½œæµç¨‹å·¥å…·(Jira, Asana, Slack..)æå‡é–‹ç™¼æ•ˆç‡ã€‚
image:
  path: /assets/4cb4437818f2/1*TiGXBQdPaCM6r2J1RHrgnA.png
last_modified_at: 2025-12-17T15:45:42.355+0000
render_with_liquid: false
tags:
- ios-app-development
- google-apps-script
- github-actions
- slack
- github
title: ä½¿ç”¨ Google Apps Script Web App è¡¨å–®ä¸²æ¥ Github Action CI/CD å·¥ä½œ
---

### ä½¿ç”¨ Google Apps Script Web App è¡¨å–®ä¸²æ¥ Github Action CI/CD å·¥ä½œ

Github Action Workflow è¡¨å–®å„ªåŒ–èˆ‡æ•´åˆå…¶ä»–å·¥ä½œæµç¨‹å·¥å…·\(Jira, Asana, Slack\. \. \)æå‡é–‹ç™¼æ•ˆç‡ã€‚



![å·¦ï¼šåŸå§‹çš„ Github Action Workflow Form / å³ï¼š [æœ€çµ‚æˆæœ \(GAS Web App Form\)](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}](/assets/4cb4437818f2/1*TiGXBQdPaCM6r2J1RHrgnA.png)

å·¦ï¼šåŸå§‹çš„ Github Action Workflow Form / å³ï¼š [æœ€çµ‚æˆæœ \(GAS Web App Form\)](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}
### 2025/07 Update:

æ­¤åŠŸèƒ½å·²æ•´åˆåˆ°å¯¦éš›æ‰“åŒ…å·¥å…·ä½¿ç”¨ï¼Œå¯åƒè€ƒæœ€æ–°æ–‡ç« æ¡ˆä¾‹ï¼šã€Œ [**CI/CD å¯¦æˆ°æŒ‡å—ï¼ˆå››ï¼‰ï¼šä½¿ç”¨ Google Apps Script Web App ä¸²æ¥ GitHub Actions å»ºç½®å…è²»æ˜“ç”¨çš„æ‰“åŒ…å·¥å…·å¹³å°**](../4273e57e7148/) ã€
### èƒŒæ™¯

ä¹‹å‰çš„åœ˜éšŠä½¿ç”¨ Github Action & Self\-hosted Github Runner \+ Slack æ­å»ºæ•´å¥— CI/CD æœå‹™ï¼›æ•´é«”æ•ˆæœä¸éŒ¯ï¼Œå°æ–¼ App é–‹ç™¼è€…ä¾†èªªå»ºç½®èˆ‡ç¶­è­·ç›¸å°å®¹æ˜“ï¼Œåªéœ€ç…§è‘—å®˜æ–¹æ–‡ä»¶æä¾›çš„ YAML åƒæ•¸å®Œæˆè¨­å®šå°±æœƒè‡ªå‹•è§¸ç™¼ã€æ©Ÿå™¨æ–¹é¢ä¹Ÿå¯ä»¥è¼•æ˜“çš„ä½¿ç”¨è‡ªå·±çš„æ©Ÿå™¨ç•¶æˆ Runner ä½¿ç”¨ï¼Œæœå‹™æœ¬èº«éƒ½æ˜¯ç”± Github ç¶­è­·ï¼Œæˆ‘å€‘ä¸éœ€åœ¨æ„ç‰ˆæœ¬å‡ç´šç­‰å•é¡Œä¸¦ä¸” Runner æ˜¯åå‘è·Ÿ Github è¦ä»»å‹™ä¸‹ä¾†åšï¼Œä¸éœ€è¦ç‰¹åˆ¥é–‹å°å¤–ç¶²è·¯é–‹å£ã€‚


> _ç­‰æ–¼åŒæ™‚äº«å—åˆ°é¡ä¼¼ Bitrise çš„ GUI YAML å»ºç½®æ–¹å¼åˆæœ‰åƒ Jenkins é‚£æ¨£ä½¿ç”¨è‡ªæ¶æ©Ÿå™¨çš„å½ˆæ€§è·Ÿè¼ƒä½çš„å»ºç½®æˆæœ¬ï¼Œä½†ä¸ç”¨åƒ Jenkins é‚£æ¨£éœ€è¦èŠ±æ™‚é–“ç¶­è­·æœå‹™æœ¬èº«ã€‚_ 






> **æœªä¾†æœ‰æ™‚é–“å†å¯«ä¸€ç¯‡å®Œæ•´çš„ App CI/CD x Github Action æ­å»ºéç¨‹ã€‚** 



#### å•é¡Œï¼šGithub Action CI/CD GUI Form


![Github Action GUI Form](/assets/4cb4437818f2/1*55tCLFvuHtTyyvSLSv1vMA.png)

Github Action GUI Form


> _åœ¨ App é–‹ç™¼ä¸­ï¼Œåœ¨ CD è§¸ç™¼æ‰“åŒ…æ¸¬è©¦ç‰ˆã€æ­£å¼ç‰ˆæˆ–é€å¯©æ™‚é€šå¸¸æœƒéœ€è¦æä¾›ä¸€äº›å¤–éƒ¨åƒæ•¸æˆ–æ˜¯ä¾ç…§éœ€æ±‚é¸æ“‡ç’°å¢ƒã€åˆ†æ”¯ï¼Œæ‰æœƒé–‹å§‹åŸ·è¡Œå·¥ä½œã€‚_ 





ä¸åŒæ–¼ Jenkins æ˜¯è‡ªå»ºæœå‹™ï¼Œæœ‰å®Œæ•´çš„ Web GUIï¼›Github Action æ²’æœ‰ï¼Œå”¯ä¸€çš„ Web GUI Form æ˜¯åœ¨ Actions ä¸­é»æ“Š Run workflow å¯ä»¥è‡ªè¨‚ä¸€å€‹ç°¡æ˜“çš„è¡¨å–®ä¾›ä½¿ç”¨è€…è¼¸å…¥å¤–éƒ¨åƒæ•¸ï¼Œç„¶å¾Œè§¸ç™¼ CI/CD å·¥ä½œæµç¨‹ã€‚

é€šå¸¸æœƒä½¿ç”¨é€™å€‹ CD æ‰“åŒ…çš„ä½¿ç”¨è€…ï¼Œä¸ä¸€å®šæ˜¯ App é–‹ç™¼è€…æœ¬èº«ã€ä¹Ÿä¸ä¸€å®šæ“æœ‰é€™å€‹å°ˆæ¡ˆçš„æ¬Šé™ï¼›ä¾‹å¦‚ QA éœ€è¦æ‰“åŒ…æŒ‡å®šç‰ˆæœ¬ã€PM/Backend éœ€è¦æ‰“åŒ…æŸå€‹é–‹ç™¼ä¸­ç‰ˆæœ¬é€²è¡Œæ¸¬è©¦ï¼›Github Action Form éœ€è¦æœ‰è©²å°ˆæ¡ˆçš„æ¬Šé™æ‰èƒ½ä½¿ç”¨ï¼Œä½†ä½¿ç”¨è€…ä¸è¦èªªèƒ½ä¸èƒ½æœ‰å°ˆæ¡ˆæ¬Šé™ã€ç”šè‡³æ˜¯ä¸ä¸€å®šæœ‰å·¥ç¨‹èƒŒæ™¯ã€‚

**è€Œä¸”æˆ‘å€‘ç„¡æ³•åœ¨é€™é‚Šåšå‹•æ…‹è¡¨å–®æˆ–è³‡æ–™é©—è­‰ã€‚**


> _å› æ­¤æˆ‘å€‘éœ€è¦å¦å¤–æ‹‰ä¸€å€‹ GUI æœå‹™çµ¦å…¶ä»–ä½¿ç”¨è€…æ“ä½œä½¿ç”¨ã€‚_ 




#### è‡ªå»º Slack App è§£æ±º

ä¹‹å‰åœ˜éšŠæ˜¯æœ‰ç†±æ„›åšè‡ªå‹•åŒ–çš„åŒä»è‡ªå·±ç”¨ Kotlin\+Ktor æ­å»ºäº†ä¸€å€‹å®Œæ•´çš„ Slack App ç¶²è·¯æœå‹™ï¼Œä¸²æ¥ Slack è¨Šæ¯ã€è¡¨å–®ã€æŒ‡ä»¤â€¦ç­‰åŠŸèƒ½ï¼Œæ¥æ”¶ã€è½‰ç™¼ CD æ‰“åŒ…è«‹æ±‚ï¼Œè§¸ç™¼ Github Action åŸ·è¡Œæ“ä½œä¸¦å°‡çµæœä¸²å› Slackã€‚


> _ç›®å‰æ²’æœ‰é–‹ç™¼è³‡æºè·Ÿä¹‹å‰ä¸€æ¨£ä½¿ç”¨ Kotlin\+Ktor å»ºç½®æœå‹™_ 




#### è‡ªå·±å¯« Web/iOS/macOS App å·¥å…·

ç›®å‰åœ˜éšŠåŸæœ¬æ˜¯ä½¿ç”¨ Jenkins æœ‰åŸºç¤çš„ Web å¯ä»¥çµ¦å…¶ä»–ä½¿ç”¨è€…ç™»å…¥ä½¿ç”¨ã€å¦å¤–é‚„æœ‰è‡ªè¡Œé–‹ç™¼äº†ä¸€å€‹ App ä¸²æ¥ Jenkins å°è£ä¸€äº›åƒæ•¸è®“éå·¥ç¨‹èƒŒæ™¯çš„ä½¿ç”¨è€…æ›´æ–¹ä¾¿ä½¿ç”¨ã€‚


> **_ä¸éé·ç§»åˆ° Github Action ä¹‹å¾Œé€™æ•´å¥—å°±å»¢æ£„äº†ã€‚_** 




#### âŒ Private Github Pages

æ‡‰è©²æœ‰æ©Ÿæœƒç›´æ¥å»ºç½® Github Pages ä¾†ç•¶ CI/CD Web GUIï¼Œä½†æ˜¯ç›®å‰åªæœ‰ Github [Enterprise](https://docs.github.com/en/enterprise-server@3.13/admin/configuration/configuring-your-enterprise/configuring-github-pages-for-your-enterprise#enabling-public-sites-for-github-pages){:target="_blank"} å¯ä»¥è¨­å®š Github Pages å­˜å–æ¬Šé™ï¼Œå…¶ä»–æ–¹æ¡ˆå°±ç®—æ˜¯ Private Repo ä¹Ÿæœƒæ˜¯å…¬é–‹çš„ï¼›ç„¡å®‰å…¨æ€§å¯è¨€ã€‚
#### âŒ Slack Appï¼Œä½†ä½¿ç”¨ Google Apps Script å»ºç½®

ä¸€é–‹å§‹æƒ³èªªä¾ç…§ä¹‹å‰åœ˜éšŠçš„ç¶“é©—ä½¿ç”¨ Slack App åšç‚º CI/CD GUI Form æœå‹™ï¼Œä½†æ˜¯ç›®å‰æ²’æœ‰è³‡æºè·Ÿä¹‹å‰ä¸€æ¨£ä½¿ç”¨ Kotlin\+Ktor å»ºç½®æœå‹™ï¼›æ‰€ä»¥æƒ³èªªå…ˆä½¿ç”¨ Function as a Service æœå‹™å¿«é€Ÿå˜—è©¦å»ºç½®ã€‚

Function as a Service æœ‰å¾ˆå¤šç¨®ï¼Œ [Cloud Functions](https://cloud.google.com/functions?hl=zh-tw){:target="_blank"} çš„è‡ªç”±åº¦æ¯”è¼ƒé«˜ï¼Œä½†ç”±æ–¼çµ„ç¹” IT é™åˆ¶ï¼Œç„¡æ³•éš¨æ„æ–°å¢ Public Cloud Functions ä¸¦ä¸”æœ‰æ”¶è²»å•é¡Œï¼›å› æ­¤é‚„æ˜¯å›åˆ°æˆ‘å€‘çš„è€æœ‹å‹ â€” Google Apps Scriptã€‚


> _ä¹‹å‰å¯«éå¥½å¹¾ç¯‡é—œæ–¼ Google Apps Script åšè‡ªå‹•åŒ–çš„æ–‡ç« ï¼Œæœ‰èˆˆè¶£çš„æœ‹å‹å¯ä»¥åƒè€ƒï¼š_ 
 

> _1\. **ã€Œ [ä½¿ç”¨ Google Apps Script å¯¦ç¾æ¯æ—¥æ•¸æ“šå ±è¡¨ RPA è‡ªå‹•åŒ–](../f6713ba3fee3/) ã€**_ 
 

> _2\. ã€Œ [ç°¡å–® 3 æ­¥é©Ÿ â€” æ‰“é€ å…è²» GA4 è‡ªå‹•æ•¸æ“šé€šçŸ¥æ©Ÿå™¨äºº](https://medium.com/zrealm-robotic-process-automation/%E7%B0%A1%E5%96%AE-3-%E6%AD%A5%E9%A9%9F-%E6%89%93%E9%80%A0%E5%85%8D%E8%B2%BB-ga4-%E8%87%AA%E5%8B%95%E6%95%B8%E6%93%9A%E9%80%9A%E7%9F%A5%E6%A9%9F%E5%99%A8%E4%BA%BA-1e85b8df2348?source=collection_home---6------1-----------------------){:target="_blank"} ã€_ 
 

> _3\. ã€Œ [Crashlytics \+ Google Analytics è‡ªå‹•æŸ¥è©¢ App Crash\-Free Users Rate](https://medium.com/zrealm-robotic-process-automation/crashlytics-google-analytics-%E8%87%AA%E5%8B%95%E6%9F%A5%E8%A9%A2-app-crash-free-users-rate-793cb8f89b72?source=collection_home---6------8-----------------------){:target="_blank"} ã€_ 
 

> _4\. ã€Œ [Crashlytics \+ Big Query æ‰“é€ æ›´å³æ™‚ä¾¿åˆ©çš„ Crash è¿½è¹¤å·¥å…·](https://medium.com/zrealm-robotic-process-automation/crashlytics-big-query-%E6%89%93%E9%80%A0%E6%9B%B4%E5%8D%B3%E6%99%82%E4%BE%BF%E5%88%A9%E7%9A%84-crash-%E8%BF%BD%E8%B9%A4%E5%B7%A5%E5%85%B7-e77b80cc6f89?source=collection_home---6------9-----------------------){:target="_blank"} ã€_ 





ç¸½è€Œè¨€ä¹‹ï¼ŒGoogle Apps Script æ˜¯ Google å¦ä¸€å€‹ Function as a Service æœå‹™ï¼Œä¸»è¦ç‰¹è‰²æ˜¯å…è²»è·Ÿèˆ‡ Google æœå‹™ä¹‹é–“å¯ä»¥å¿«é€Ÿæ•´åˆï¼›ä½†æ˜¯é™åˆ¶ä¹Ÿè¼ƒå¤šï¼Œä¾‹å¦‚åªèƒ½ç”¨å®ƒçš„èªè¨€ã€åŸ·è¡Œæ™‚é–“ä¸èƒ½è¶…é 6 åˆ†é˜ã€æœ‰åŸ·è¡Œæ¬¡æ•¸ä¸Šé™ã€ä¸æ”¯æ´å¤šåŸ·è¡Œç·’â€¦ç­‰ç­‰ï¼Œç´°ç¯€å¯ä»¥åƒè€ƒ [æˆ‘ä¹‹å‰çš„æ–‡ç« ](../f6713ba3fee3/) ã€‚

çµè«–æ˜¯ä¸å¯è¡Œï¼ŒåŸå› æ˜¯ï¼š
- [Function as a Service å†·å•Ÿå‹•å•é¡Œ](https://www.cloudflare.com/zh-tw/learning/serverless/what-is-serverless/){:target="_blank"} ã€‚
æœå‹™ä¸€æ®µæ™‚é–“æ²’å‘¼å«æœƒé€²å…¥ç¡çœ ï¼Œå†æ¬¡å‘¼å«è¦èŠ±è¼ƒé•·æ™‚é–“å•Ÿå‹•\(3~â‰¥ 5 ç§’\)ï¼› **Slack App å°æ–¼ API éŸ¿æ‡‰æ™‚é–“éå¸¸åš´æ ¼ï¼Œæœå‹™éœ€è¦åœ¨ 3 ç§’å…§å›æ‡‰å¦å‰‡è¦–ç‚ºå¤±æ•—** ï¼ŒSlack é€™é‚Šå°±æœƒç›´æ¥å™´éŒ¯èª¤ã€äº‹ä»¶ç›£è½ä¹Ÿæœƒè¢«èªç‚ºä¸Ÿå¤±ï¼Œå°è‡´é‡è¤‡ç™¼é€ã€‚
- **Google Apps Script doGet, doPost æ–¹æ³•ç„¡æ³•å–å¾— Headersã€‚** 
**é€™æœƒå°è‡´ç„¡æ³•èµ° [å®˜æ–¹çš„å®‰å…¨é©—è­‰](https://api.slack.com/authentication/verifying-requests-from-slack){:target="_blank"} ã€ç„¡æ³•é—œé–‰ [Slack Retry](https://api.slack.com/authentication/verifying-requests-from-slack){:target="_blank"} ã€‚**
- Google Apps Script å–®åŸ·è¡Œç·’å•é¡Œã€‚
å¦‚æœè¦ä¸²æ¥å…¶ä»–æœå‹™éŸ¿æ‡‰æ™‚é–“éƒ½æœƒè¶…é 3 ç§’ï¼Œç›´æ¥è¢« Slack åˆ¤å®šç‚ºå¤±æ•—ã€‚


æœ‰å‹‰å¼·ä½¿ç”¨ Slack è¨Šæ¯ã€Block Kitã€Form ä¸²æ¥å®Œæ•´å€‹æµç¨‹ï¼Œä½†æ˜¯å¤ªå®¹æ˜“è§¸ç™¼ä¸Šè¿°å•é¡Œï¼Œå¾Œä¾†ç›´æ¥æ”¾æ£„ã€‚


> **_å¦‚æœè¦åšé€™å¥—é‚„æ˜¯è¦èµ°è‡ªå·±èµ·ä¼ºæœå™¨ã€æœå‹™ï¼Œä¸è¦èµ° Function as a Service\! \!_** 




#### âŒ Slack Workflow Form


![](/assets/4cb4437818f2/1*KWBMdFswvl1KPdnTLStzhQ.png)



![[Slack Workflow Form](https://slack.com/intl/zh-tw/help/articles/24720245025555-%E8%87%AA%E5%8B%95%E5%8C%96%EF%BC%9A%E4%BD%BF%E7%94%A8%E7%B0%A1%E6%98%93%E8%A1%A8%E5%96%AE%E6%94%B6%E9%9B%86%E8%B3%87%E8%A8%8A){:target="_blank"} \(âŒ ç„¡æ³•å®¢åˆ¶åŒ–\)](/assets/4cb4437818f2/1*hnDPyOfGCTW_yJf71krMnA.png)

[Slack Workflow Form](https://slack.com/intl/zh-tw/help/articles/24720245025555-%E8%87%AA%E5%8B%95%E5%8C%96%EF%BC%9A%E4%BD%BF%E7%94%A8%E7%B0%A1%E6%98%93%E8%A1%A8%E5%96%AE%E6%94%B6%E9%9B%86%E8%B3%87%E8%A8%8A){:target="_blank"} \(âŒ ç„¡æ³•å®¢åˆ¶åŒ–\)

å¦å¤–ä¹Ÿå˜—è©¦é Slack å…§å»ºçš„è‡ªå‹•åŒ–åŠŸèƒ½ Workflow Formï¼Œä¸éä»–ç„¡æ³•åšåˆ°å‹•æ…‹è¡¨å–®å…§å®¹ \(e\.g\. æ’ˆåˆ†æ”¯è®“ä½¿ç”¨è€…é¸\)ï¼Œå”¯ä¸€èƒ½å®¢è£½åŒ–çš„åªæœ‰å¾ŒçºŒé€è³‡æ–™çš„æ­¥é©Ÿã€‚
### âœ… Google Apps Script Web App GUI Form è¡¨å–®

å±±ä¸è½‰è·¯è½‰ï¼Œè½‰å¿µä¸€æƒ³å¥½åƒä¹Ÿä¸ç”¨ç³¾çµåœ¨ä¸€å®šè¦ç”¨ Slack æ•´åˆä¸Šï¼Œç”¨ Slack æ•´åˆæ˜¯æœ€å¥½çš„æ–¹æ¡ˆï¼Œå› ç‚ºæ˜¯ç›´æ¥æ•´é€²æ—¢æœ‰çš„åœ˜éšŠå”ä½œå·¥å…·ï¼Œä¸éœ€è¦ç™¼æ•£é¡å¤–å»å­¸æ–°å·¥å…·ï¼›ä½†æ˜¯è¿«æ–¼è³‡æºé™åˆ¶ï¼Œæˆ‘å€‘åªèƒ½é€€è€Œæ±‚å…¶æ¬¡æ‰¾å…¶ä»–ç©©å®šåˆå¥½ç”¨çš„æ–¹æ³•ã€‚


> _å›é ­æƒ³åˆ° Google Apps Script æœ¬èº«å°±èƒ½éƒ¨ç½²æˆ Web Appï¼Œå¯ä»¥åœ¨ Web doGet æ™‚å›æ‡‰ GUI Form è¡¨å–®ï¼Œé€å‡ºè¡¨å–®å¾Œè§¸ç™¼å¾ŒçºŒçš„ Github ä¸²æ¥è™•ç†ã€‚_ 




#### æœ€çµ‚æˆæœ ğŸ‰


![[Demo Web App Form](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}](/assets/4cb4437818f2/1*pzW-Yki-4HbE2nYXC4q-Aw.png)

[Demo Web App Form](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}
#### **å·¥ä½œæµç¨‹**

æˆ‘å€‘ä½¿ç”¨ Google Apps Script Web App å»ºç½® CI/CD è¡¨å–®ï¼Œç›´æ¥ç¶å®š Google Workspace å¸³è™Ÿï¼Œè¨­å®šåªæœ‰çµ„ç¹”å…§çš„ä½¿ç”¨è€…å¯ä»¥å­˜å–ï¼›è‡ªå‹•ç²å–ç•¶å‰ç™»å…¥çš„ä½¿ç”¨è€…ä¿¡ç®±ã€ä½¿ç”¨ Github Repo å…±ç”¨å¸³è™Ÿ\(æˆ–å€Ÿç”¨æŸå€‹æœ‰æ¬Šé™çš„å¸³è™Ÿ\)çš„ Personal Access Token æ‰“ Github API ç²å¾—åˆ†æ”¯åˆ—è¡¨ï¼Œé€å‡ºå¾ŒåŒæ¨£æ‰“ API è§¸ç™¼ Github Action é–‹å§‹åŸ·è¡Œ CI/CD å·¥ä½œã€‚

å¦å¤–ï¼Œæˆ‘å€‘å¯ä»¥ç”¨ä½¿ç”¨è€…çš„ä¿¡ç®±é€é Slack App å»æ‰“ Slack APIï¼Œå–å¾—è©²ä½¿ç”¨è€…çš„ Slack IDï¼Œå†é€é Slack App å‚³é€è¨Šæ¯ï¼Œé€šçŸ¥ CI/CD ä»»å‹™åŸ·è¡Œæƒ…æ³ã€‚

ä¹Ÿå¯ä»¥å†èˆ‡å…¶ä»–å·¥å…·ã€é–‹ç™¼æµç¨‹é€²è¡Œæ•´åˆï¼Œä¾‹å¦‚å…ˆå¾ Asana, Jira å–å¾—å·¥å–®ï¼Œé¸æ“‡å¾Œå†é€é Github API æŸ¥æ‰¾åˆ†æ”¯ã€è§¸ç™¼ Github Actionï¼Œæœ€å¾Œå†é€é Slack é€šçŸ¥çµ¦ä½¿ç”¨è€…ã€‚
#### Step 1\. å»ºç«‹ Google Apps Script Web App Form

å‰å¾€ &gt; [Google Apps Script](https://script.google.com/home){:target="_blank"} ï¼Œæ–°å¢å°ˆæ¡ˆã€‚


![](/assets/4cb4437818f2/1*T3if7Dfo0iJaa4N5VZyA1Q.png)

#### Step 2\. å»ºç«‹è¡¨å–®å…§å®¹ã€GAS ç¨‹å¼

å¤ªä¹…æ²’æœ‰å¯« HTML,CSS ä¹Ÿæ‡¶å¾—è‡ªå·±è¨­è¨ˆæ¨£å¼ï¼Œç›´æ¥è«‹ ChatGPT ç”¢ä¸€å€‹æœ‰ä¸€é»è¨­è¨ˆçš„ HTML è¡¨å–®ç¯„æœ¬ã€‚


![](/assets/4cb4437818f2/1*IPv0afE5FAFj40F22s8Umg.png)



![](/assets/4cb4437818f2/1*F_HrfV_k16g_ojm1WIDDuA.png)


åœ¨ GAS å·¦æ–¹æª”æ¡ˆåˆ—è¡¨é»ã€Œ\+ã€æ–°å¢æª”æ¡ˆï¼Œè¼¸å…¥æª”æ¡ˆåç¨±ã€Œ `Form.html` ã€ä¸¦æŠŠ GPT ç”¢çš„ HTML è¡¨å–®ç¯„æœ¬å…§å®¹è²¼ä¸Šã€‚

`Form.htmlï¼š`
```xml
<!--HTML & Style Gen by ChatGPT 4o-->
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><?=title?></title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f7f7f7;
    }
    .form-container {
      max-width: 600px;
      margin: auto;
      padding: 20px;
      background-color: #ffffff;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .form-container h2 {
      margin-bottom: 20px;
      color: #333333;
    }
    .form-group {
      margin-bottom: 15px;
    }
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #555555;
    }
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 95%;
      padding: 10px;
      border: 1px solid #cccccc;
      border-radius: 4px;
      font-size: 16px;
    }
    .form-group input[type="radio"] {
      width: auto;
      margin-right: 10px;
    }
    .form-group .radio-label {
      display: inline-block;
      margin-right: 20px;
    }
    .form-group button {
      background-color: #4CAF50;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
    }
    .form-group button:hover {
      background-color: #45a049;
    }
    .message {
      margin-top: 20px;
      padding: 15px;
      border-radius: 5px;
      font-size: 1em;
      text-align: center;
    }
    .message.success {
      background-color: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    .message.error {
      background-color: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div class="form-container">
    <h2><?=title?></h2>
    <form id="myForm">
      <div id="message-block" class="hidden"></div>
      <div class="form-group">
        <label for="email">é›»å­éƒµä»¶ï¼š</label>
        <input type="email" value="<?=email?>" readonly/>
      </div>
      <div class="form-group">
        <label for="buildNumber">ç‰ˆæœ¬è™Ÿï¼š</label>
        <input type="number" value="<?=buildNumber?>"/>
      </div>
      <div class="form-group">
        <label for="branch">Review ä¸­çš„ PRï¼š</label>
        <select id="branch" name="branch">
          <option>è«‹é¸æ“‡</option>
          <? pullRequests.forEach(pullRequest => { ?>
            <option value="<?=pullRequest.head.ref?>">[<?=pullRequest.state?>] <?=pullRequest.title?></option>
          <? }); ?>
        </select>
      </div>
      <div class="form-group">
        <label for="message">æ›´æ–°å…§å®¹ï¼š</label>
        <textarea id="message" name="message" rows="4" placeholder="è«‹è¼¸å…¥æ‚¨çš„è¨Šæ¯"></textarea>
      </div>
      <div class="form-group">
        <button type="submit">é€å‡º</button>
      </div>
    </form>
  </div>
  <script>
    function displayMessage(ok, message) {
      const messageBlock = document.getElementById('message-block');
      messageBlock.className = ok ? 'message success' : 'message error';
      messageBlock.innerHTML = message;
      messageBlock.classList.remove('hidden');
    }
    
    document.getElementById("myForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const formData = new FormData(this);
      const formObject = Object.fromEntries(formData);
      google.script.run.withSuccessHandler((response) => {
        displayMessage(response.ok, response.message);
      }).processForm(formObject);
    });
  </script>
</body>
</html>
```

è¡¨å–®å…§å®¹å¯ä¾ç…§éœ€æ±‚è‡ªè¡Œèª¿æ•´ã€‚

`ç¨‹å¼ç¢¼.gsï¼š`
```javascript
function doGet(e) {
  // å°æ‡‰åˆ°å·¦æ–¹æª”æ¡ˆ Form.html
  const htmlTemplate = HtmlService.createTemplateFromFile('Form');
  
  const email = Session.getActiveUser().getEmail();
  // å–å¾—ä½¿ç”¨è€…ä¿¡ç®±ï¼Œåªé™ åŸ·è¡Œèº«ä»½ï¼šå­˜å–ç¶²é ç¨‹å¼çš„ä½¿ç”¨è€… è¨­å®šæœ‰æ•ˆ
  
  const title = "App CD æ‰“åŒ…è«‹æ±‚è¡¨å–®";
  
  const buildNumber = genBuildNumber();

  htmlTemplate.email = email;
  htmlTemplate.title = title;
  htmlTemplate.pullRequests = []; // ä¸‹ä¸€æ­¥åœ¨ä¸²æ¥ Github...
  htmlTemplate.buildNumber = buildNumber;

  const html = htmlTemplate.evaluate();
  html.setTitle(title);
  //html.setWidth(600) // è¨­å®šé é¢å¯¬åº¦

  return html
}

function processForm(object) {
  return {"ok": true, "message": "è«‹æ±‚é€å‡ºæˆåŠŸï¼"};
}

function genBuildNumber() {
  const now = new Date();
  const formattedDate = Utilities.formatDate(now, "Asia/Taipei", "yyyyMMddHHmmss");
  const milliseconds = now.getMilliseconds().toString().padStart(3, '0'); // ç¢ºä¿æ¯«ç§’æ˜¯ 3 ä½æ•¸
  return `${formattedDate}${milliseconds}`; 
}
```

é€™ä¸€æ­¥ï¼Œæˆ‘å€‘å…ˆæŠŠè¡¨å–® GUI å®Œæˆï¼Œä¸‹ä¸€æ­¥å†ä¾†ä¸²æ¥ Github API æ‹¿åˆ° PR åˆ†æ”¯åˆ—è¡¨ã€‚


![](/assets/4cb4437818f2/1*RN9ftVBdgCA-IL8ra9jvTg.png)

#### Step 2\. éƒ¨ç½² Google Apps Script Web App Form

æˆ‘å€‘å…ˆæŠŠå‰›å‰›çš„å…§å®¹éƒ¨ç½²ä¸€æ¬¡ï¼ŒæŸ¥çœ‹çµæœã€‚

åœ¨ GAS å³ä¸Šè§’é¸æ“‡ã€Œéƒ¨ç½²ã€\-&gt; ã€Œæ–°å¢éƒ¨ç½²ä½œæ¥­ã€\-&gt;ã€Œç¶²é æ‡‰ç”¨ç¨‹å¼ã€ï¼š


![](/assets/4cb4437818f2/1*ouVO18FtOcX8vdeGCEtwCw.png)



![](/assets/4cb4437818f2/1*4BuEtIA4H_-Q9WALonYxYg.png)



![](/assets/4cb4437818f2/1*JagpVPTGD-W0lhIJ5nrRew.png)


åŸ·è¡Œèº«ä»½è·Ÿèª°å¯ä»¥å­˜å–åˆ†åˆ¥å¯ä»¥è¨­ç½®æˆï¼š

**åŸ·è¡Œèº«ä»½ï¼š**
- æˆ‘ `çµ±ä¸€éƒ½ç”¨ä½ çš„å¸³è™Ÿèº«åˆ†åŸ·è¡Œè…³æœ¬ã€‚`
- å­˜å–ç¶²é ç¨‹å¼çš„ä½¿ç”¨è€… `æœƒä»¥ç•¶å‰ç™»å…¥çš„ Google å¸³è™Ÿä½¿ç”¨è€…èº«ä»½åŸ·è¡Œè…³æœ¬ã€‚`


**èª°å¯ä»¥å­˜å–ï¼š**
- åªæœ‰æˆ‘è‡ªå·±
- **XXX åŒå€‹çµ„ç¹”ä¸­çš„æ‰€æœ‰ä½¿ç”¨è€…** `åªæœ‰åŒçµ„ç¹”ï¼‹å·²ç™»å…¥çš„ Google å¸³è™Ÿä½¿ç”¨è€…å¯ä»¥å­˜å–ã€‚`
- æ‰€æœ‰å·²ç™»å…¥ Google å¸³è™Ÿçš„ä½¿ç”¨è€… `å·²ç™»å…¥çš„ Google å¸³è™Ÿä½¿ç”¨è€…éƒ½å¯ä»¥å­˜å–ã€‚`
- æ‰€æœ‰äºº `ä¸éœ€è¦ç™»å…¥ Google å¸³è™Ÿã€æ‰€æœ‰äººéƒ½å¯ä»¥å…¬é–‹å­˜å–ã€‚`



> _æˆ‘å€‘é¸æ“‡ã€Œèª°å¯ä»¥å­˜å–ï¼šXXX åŒå€‹çµ„ç¹”ä¸­çš„æ‰€æœ‰ä½¿ç”¨è€…ã€ï¼‹ã€ŒåŸ·è¡Œèº«ä»½ï¼šå­˜å–ç¶²é ç¨‹å¼çš„ä½¿ç”¨è€…ã€å°±èƒ½ **è‡ªå‹•é™åˆ¶åªæœ‰çµ„ç¹”å¸³è™Ÿçš„äººå¯ä»¥ä½¿ç”¨** ï¼Œä¸¦ä¸”ç”¨ä»–è‡ªå·±çš„èº«ä»½åŸ·è¡Œï¼_ 
 

> _æ˜¯ä¸€å€‹å¾ˆæ–¹ä¾¿æ¬Šé™æ§ç®¡çš„åŠŸèƒ½ï¼_ 





é¸å®Œé»æ“Šå³ä¸‹ã€Œéƒ¨ç½²ã€ã€‚


![](/assets/4cb4437818f2/1*dvyqYb5kcta402j3RUYJog.png)


ç¶²é æ‡‰ç”¨ç¨‹å¼ä¸­çš„ç¶²å€ï¼Œå°±æ˜¯ Web App å­˜å–ç¶²å€ã€‚
```bash
https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec
```


> _ç¶²å€å¾ˆé•·å¾ˆé†œï¼Œä½†æ˜¯æ²’è¾¦æ³•ï¼Œåªèƒ½è‡ªå·±æ‰¾çŸ­ç¶²å€å·¥å…·ç¸®çŸ­ä¸€ä¸‹ã€‚_ 





**é»ç¶²å€æ‰“é–‹é é¢æŸ¥çœ‹æ•ˆæœï¼š**


![](/assets/4cb4437818f2/1*jbx4IO4DEhqYfwI_UTQk5Q.png)


**é€™é‚Šè¦å¤šæå…©å€‹ GAS é™åˆ¶ï¼š**
- GAS Web App ä¸Šæ–¹è­¦å‘Šæç¤ºï¼Œé è¨­ç„¡æ³•éš±è—
- GAS Web App æ˜¯ç”¨ IFrame æŠŠæˆ‘å€‘çš„é é¢åµŒåœ¨è£¡é¢ï¼Œå› æ­¤å¾ˆé›£åšåˆ° 100% RWD æ•ˆæœ
åªèƒ½ä½¿ç”¨ `.setWidth()` èª¿æ•´è¦–çª—å¯¬åº¦

#### Google Apps Script æˆæ¬Šè­¦å‘Š

**ç¬¬ä¸€æ¬¡ä½¿ç”¨** ã€é»æ“Šã€ŒåµéŒ¯ã€æˆ–ã€ŒåŸ·è¡Œã€å¯èƒ½æœƒå‡ºä¸‹ä»¥ä¸‹æˆæ¬Šè­¦å‘Šï¼š


![](/assets/4cb4437818f2/1*9q8KZGHER9vdtnbKVVQB9g.png)



![](/assets/4cb4437818f2/1*iWrkqMf8vkEGkiwkI1amIw.jpeg)


é¸æ“‡æƒ³è¦åŸ·è¡Œçš„èº«ä»½å¸³è™Ÿï¼Œå¦‚æœæœ‰å‡ºç¾ã€Œé€™å€‹æ‡‰ç”¨ç¨‹å¼æœªç¶“ Google é©—è­‰ã€å‰‡é»æ“Šã€Œé€²éšã€\-&gt;ã€Œå‰å¾€ XXX \(ä¸å®‰å…¨\)ã€ï¼Œé¸æ“‡ã€Œå…è¨±ã€ï¼š


![](/assets/4cb4437818f2/1*ucaqLxh-TOgJIaGyqqFd3A.png)



![](/assets/4cb4437818f2/1*l-tma_YICU24goKvZvl7Ww.png)



![](/assets/4cb4437818f2/1*JAs_3__Qt2XeDcQiKEUNhg.png)


å¦‚æœ GAS ç¨‹å¼æ¬Šé™æœ‰è®Šå‹•\(ä¾‹å¦‚ï¼šå¤šåŠ å­˜å– Google Sheetâ€¦etc\)æ‰æœƒéœ€è¦å†é‡æ–°æˆæ¬Šï¼Œä¸ç„¶é»éä¸€æ¬¡å°±ä¸æœƒå†å‡ºç¾ã€‚


> _å¦‚é‡åˆ°ï¼šå·²å°é–å­˜å–æ¬Šã€ŒXXXã€æœªå®Œæˆ Google é©—è­‰ç¨‹åºï¼Œ [å¯åƒè€ƒæˆ‘æœ€æ–°æ–‡ç« çš„ GCP è¨­å®šã€‚](../4273e57e7148/)_ 




#### Step 3\. ä¸²æ¥ Github API å–å¾— PR åˆ†æ”¯åˆ—è¡¨

æˆ‘å€‘æ–°å¢ä¸€å€‹ `Github.gs` ç¨‹å¼æª”æ¡ˆå­˜æ”¾ Github API ç›¸é—œé‚è¼¯ã€‚

`Github.gsï¼š`
```javascript
// SECRET
const githubPersonalAccessToken = ""
// ä½¿ç”¨ä½ çš„ Github å¸³è™Ÿæˆ–çµ„ç¹”å…±ç”¨çš„ Github å¸³è™Ÿå‰µå»º PAT
// https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens

// æ–¹å¼ 1: Restful API å­˜å–
function githubAPI(method, path, payload = null) {
  try {
    const url = "https://api.github.com"+path;  
    var options = {
      method: method,
      headers: {
        "Accept": "application/vnd.github+json",
        "Authorization": `Bearer ${githubPersonalAccessToken}`,
        "X-GitHub-Api-Version": "2022-11-28"
      }
    };

    if (method.toLowerCase().trim() == "post") {
      options.payload = JSON.stringify(payload);
    }

    const response = UrlFetchApp.fetch(url, options);
    const data = JSON.parse(response.getContentText());
    return data;
  } catch (error) {
    throw error;
  }
}

// æ–¹å¼ 2: GraphQL å­˜å–
// Github API éƒ¨åˆ†æ›´ç´°çš„æŸ¥è©¢åŠŸèƒ½åªæœ‰ GraphQL API æœ‰æä¾›
// https://docs.github.com/en/graphql
function githubGraphQL(query, variables) {
  const url = "https://api.github.com/graphql";
  const payload = {
    query: query,
    variables: variables
  };

  const options = {
    method: "post",
    contentType: "application/json",
    headers: {
      "Accept": "application/vnd.github+json",
      "Authorization": `Bearer ${githubPersonalAccessToken}`,
      "X-GitHub-Api-Version": "2022-11-28"
    },
    payload: JSON.stringify(payload)
  };

  try {
    const response = UrlFetchApp.fetch(url, options);
    const data = JSON.parse(response.getContentText());
    return data;
  } catch (error) {
    throw error;
  }
}

// GraphQL Example:
// const query = `
//   query($owner: String!, $repo: String!) {
//     repository(owner: $owner, name: $repo) {
//       pullRequests(states: OPEN, first: 100, orderBy: { field: CREATED_AT, direction: DESC }) {
//         nodes {
//           title
//           url
//           number
//           createdAt
//           author {
//             login
//           }
//           headRefName
//           baseRefName
//           body
//         }
//         pageInfo {
//           hasNextPage
//           endCursor
//         }
//       }
//     }
//   }
// `;
// const variables = {
//   owner: "swiftlang",
//   repo: "swift"
// };
// const response = githubGraphQL(query, variables);
```

Github API æœ‰å…©ç¨®å­˜å–æ–¹å¼ï¼Œä¸€ç¨®æ˜¯å‚³çµ±çš„ Restfulï¼Œå¦ä¸€ç¨®æ˜¯æ›´å½ˆæ€§çš„ GraphQLï¼›æœ¬æ–‡ä»¥ Restful ç‚ºä¾‹ã€‚

`ç¨‹å¼ç¢¼.gsï¼š`
```kotlin
function doGet(e) {
  // å°æ‡‰åˆ°å·¦æ–¹æª”æ¡ˆ Form.html
  const htmlTemplate = HtmlService.createTemplateFromFile('Form');
  
  const email = Session.getActiveUser().getEmail();
  // å–å¾—ä½¿ç”¨è€…ä¿¡ç®±ï¼Œåªé™ åŸ·è¡Œèº«ä»½ï¼šå­˜å–ç¶²é ç¨‹å¼çš„ä½¿ç”¨è€… è¨­å®šæœ‰æ•ˆ

  const title = "App CD æ‰“åŒ…è«‹æ±‚è¡¨å–®";
  
  const pullRequests = githubAPI("get", "/repos/swiftlang/swift/pulls");
  // ä»¥ https://github.com/swiftlang/swift/pulls ç‚ºä¾‹
  
  const buildNumber = genBuildNumber();

  htmlTemplate.email = email;
  htmlTemplate.title = title;
  htmlTemplate.pullRequests = pullRequests;
  htmlTemplate.buildNumber = buildNumber;

  const html = htmlTemplate.evaluate();
  html.setTitle(title);
  //html.setWidth(600) // è¨­å®šé é¢å¯¬åº¦

  return html
}

function processForm(object) {
  if (object.buildNumber == "") {
    return {"ok": false, "message": "è«‹è¼¸å…¥ç‰ˆæœ¬è™Ÿï¼"};
  }
  if (object.branch == "") {
    return {"ok": false, "message": "è«‹é¸æ“‡åˆ†æ”¯ç‰ˆæœ¬ï¼"};
  }

  // å¸¶ä¸Šä½ è¦å¸¶åˆ° Github Action çš„åƒæ•¸
  const payload = {
    ref: object.branch,
    inputs: {
      buildNumber: object.buildNumber
    }
  };
  
  //  
  try {
    const response = githubAPI("post", "/repos/zhgchgli0718/ios-project-for-github-action-ci-cd-demo/actions/workflows/CD-Job.yml/dispatches", payload);
    // ä»¥ https://github.com/zhgchgli0718/ios-project-for-github-action-ci-cd-demo/blob/main/.github/workflows/CD-Job.yml ç‚ºä¾‹

    return {"ok": true, "message": `æ‰“åŒ…è«‹æ±‚ç™¼é€æˆåŠŸ!<br/>å°æ‡‰åˆ†æ”¯ï¼š<strong>${object.branch}</strong><br/>ç‰ˆè™Ÿï¼š<strong>${object.buildNumber}</strong>`};
  } catch (error) {
    return {"ok": false, "message": "ç™¼ç”ŸéŒ¯èª¤ï¼š"+error.message};
  }
}
```

`processForm` æ–¹æ³•ä¸­è™•ç†è¡¨å–®å›å‚³çš„å…§å®¹ï¼Œä¹Ÿå¯ä»¥å¤šåŠ ä¸Šæ›´å¤šåƒ
#### GAS x Github API x Github Action

é€™é‚Šå¤šè£œå……ä¸€ä¸‹å°æ‡‰åˆ°çš„ Github Actionã€‚

`CD-Job.ymlï¼š`
```yaml
# CD æ‰“åŒ…å·¥ä½œ

name: CD-Job

on:
  workflow_dispatch:
    inputs:
      buildNumber: # å°æ‡‰ GAS payload.inpus.xxx
        description: 'ç‰ˆæœ¬è™Ÿç¢¼'
        required: false
        type: string
      # ...More
      # Inputs é¡å‹å¯åƒè€ƒå®˜æ–¹æ–‡ä»¶ï¼šhttps://docs.github.com/en/actions/writing-workflows/workflow-syntax-for-github-actions#onworkflow_dispatchinputs
      
jobs:
  some-job:
    runs-on: ubuntu-latest
    steps:
      - name: Print Inputs
        run: |
          echo "Release Build Number: ${{ github.event.inputs.buildNumber }}"    
```
#### Step 4\. é‡æ–°éƒ¨ç½² Google Apps Script Web App Form


> **_âš ï¸è«‹æ³¨æ„ï¼ŒGAS ç¨‹å¼ç¢¼çš„ä»»ä½•èª¿æ•´éƒ½éœ€è¦é‡æ–°éƒ¨ç½²ï¼Œæ‰æœƒç”Ÿæ•ˆã€‚âš ï¸_** 
 

> **_âš ï¸è«‹æ³¨æ„ï¼ŒGAS ç¨‹å¼ç¢¼çš„ä»»ä½•èª¿æ•´éƒ½éœ€è¦é‡æ–°éƒ¨ç½²ï¼Œæ‰æœƒç”Ÿæ•ˆã€‚âš ï¸_** 
 

> **_âš ï¸è«‹æ³¨æ„ï¼ŒGAS ç¨‹å¼ç¢¼çš„ä»»ä½•èª¿æ•´éƒ½éœ€è¦é‡æ–°éƒ¨ç½²ï¼Œæ‰æœƒç”Ÿæ•ˆã€‚âš ï¸_** 





GAS å³ä¸Šè§’é¸æ“‡ã€Œéƒ¨ç½²ã€\-&gt; é¸æ“‡å³ä¸Šè§’ã€Œç·¨è¼¯ã€\-&gt; ç‰ˆæœ¬é¸æ“‡ã€Œå»ºç«‹æ–°ç‰ˆæœ¬ã€


![](/assets/4cb4437818f2/1*ZMAB_m6HmsSsGSqqfZiRpA.png)



![](/assets/4cb4437818f2/1*rUWlfzASAaeXcXUh4LavZw.png)



![](/assets/4cb4437818f2/1*HAr5TZtpnQeG-Ril0Rjf-g.png)


é»æ“Šã€Œéƒ¨ç½²ã€\-&gt; å®Œæˆã€‚


![](/assets/4cb4437818f2/1*z6lw7R8ivUseSzR4IZgPdg.png)



![](/assets/4cb4437818f2/1*eTdgKGQ1lRM7sCRXQgZ-DA.png)


**å†å›åˆ°ç¶²é ä¸Šé‡æ–°æ•´ç†ï¼Œå°±èƒ½çœ‹åˆ°ä¿®æ”¹å¾Œçš„çµæœäº†ï¼š**


![](/assets/4cb4437818f2/1*iI49OJC1uTyMEgzGTBowxQ.png)



> **_âš ï¸è«‹æ³¨æ„ï¼ŒGAS ç¨‹å¼ç¢¼çš„ä»»ä½•èª¿æ•´éƒ½éœ€è¦é‡æ–°éƒ¨ç½²ï¼Œæ‰æœƒç”Ÿæ•ˆã€‚âš ï¸_** 
 

> **_âš ï¸è«‹æ³¨æ„ï¼ŒGAS ç¨‹å¼ç¢¼çš„ä»»ä½•èª¿æ•´éƒ½éœ€è¦é‡æ–°éƒ¨ç½²ï¼Œæ‰æœƒç”Ÿæ•ˆã€‚âš ï¸_** 
 

> **_âš ï¸è«‹æ³¨æ„ï¼ŒGAS ç¨‹å¼ç¢¼çš„ä»»ä½•èª¿æ•´éƒ½éœ€è¦é‡æ–°éƒ¨ç½²ï¼Œæ‰æœƒç”Ÿæ•ˆã€‚âš ï¸_** 




### Done\! ğŸ‰ğŸ‰ğŸ‰


![](/assets/4cb4437818f2/1*pzW-Yki-4HbE2nYXC4q-Aw.png)



![[Demo Web App Form](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}](/assets/4cb4437818f2/1*9aaNeemezNPRlSgbLFrseA.png)

[Demo Web App Form](https://script.google.com/macros/s/AKfycbw8SuK7lLLMdY86y3jxMJyzXqa5tdxJryRnteOnNi-lK--j6CmKYXj7UuU58DiS0NSVvA/exec){:target="_blank"}

ç¾åœ¨ä½ å¯ä»¥åœ¨çµ„ç¹”å…§åˆ†äº«é€™å€‹é€£çµçµ¦å…¶ä»–å¤¥ä¼´ï¼Œä»–å€‘å¯ä»¥ç›´æ¥ä½¿ç”¨é€™å€‹ç¶²é  GUI åŸ·è¡Œ CI/CD å·¥ä½œã€‚
#### å»¶ä¼¸ \(1\)â€” ç”¨ä½¿ç”¨è€…çš„ä¿¡ç®±æŸ¥è©¢ Slack User ID & ç™¼é€ã€æ›´æ–°é€²åº¦é€šçŸ¥

å‰æ–‡æœ‰æåˆ°ï¼Œæˆ‘å€‘å¸Œæœ›åŠæ™‚é€šçŸ¥ä½¿ç”¨è€… CI/CD åŸ·è¡Œç‹€æ³ï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨ä½¿ç”¨è€…æä¾›çš„ä¿¡ç®±å»æŸ¥ Slack User IDã€‚

`Slack.gsï¼š`
```javascript
const slackBotToken = ""
// https://medium.com/zrealm-robotic-process-automation/slack-chatgpt-integration-bd94cc88f9c9

function slackRequest(path, content) {
  const options = {
    method: "post",
    contentType: "application/json",
    headers: {
      Authorization: `Bearer ${slackBotToken}`, // Use the bot token for authorization,
      'X-Slack-No-Retry': 1
    },
    payload: JSON.stringify(content)
  };

  try {
    const response = UrlFetchApp.fetch("https://slack.com/api/"+path, options);
    const responseData = JSON.parse(response.getContentText());
    if (responseData.ok) {
      return responseData
    } else {
      throw new Error(`Slack: ${responseData.error}`);
    }
  } catch (error) {
    throw error;
  }
}

// ç”¨ä¿¡ç®±æŸ¥è©¢ Slask UID
function getSlackUserId(email) {
  return slackRequest(`users.lookupByEmail?email=${encodeURIComponent(email)}`)?.user?.id;
}

// ç™¼é€è¨Šæ¯çµ¦ç›®æ¨™ Slack UID (channelID)
function sendSlackMessage(channelId, ts = null, value)  {
  var content = {
    channel: channelId
  };

  if (ts != null) {
    content.thread_ts = ts;
  }
  
  if (typeof value === "string") {
    content.text = value;
  } else {
    content.blocks = value;
  }
  return slackRequest("chat.postMessage", content);
}

// æ›´æ–°ç™¼é€çš„è¨Šæ¯å…§å®¹
function updateSlackMessage(channelId, ts = null, value)  {
  var content = {
    channel: channelId
  };

  if (ts != null) {
    content.ts = ts;
  }
  
  if (typeof value === "string") {
    content.text = value;
  } else {
    content.blocks = value;
  }
  return slackRequest("chat.update", content);
}
```

Slack API ä½¿ç”¨è«‹åƒè€ƒ [å®˜æ–¹æ–‡ä»¶](https://api.slack.com/methods/chat.postMessage){:target="_blank"} ã€‚

**Githun Action YAML å¯ä»¥ä½¿ç”¨é€™å€‹ Action æŒçºŒæ›´æ–°è¨Šæ¯ã€ç™¼é€ Slack è¨Šæ¯ï¼š**


[![](https://opengraph.githubassets.com/5555fcbf805f8a008fa2b940b89782a63a551ae458330d39dbdf96ee8f309739/slackapi/slack-github-action)](https://github.com/slackapi/slack-github-action){:target="_blank"}

```yaml
# ...
on:
  workflow_dispatch:
    inputs:
      buildNumber: # å°æ‡‰ GAS payload.inpus.xxx
        description: 'ç‰ˆæœ¬è™Ÿç¢¼'
        required: false
        type: string
      # ...More
      SLACK_USER_ID:
        description: 'Slack User Id for receive action notification'
        type: string
      SLACK_CHANNEL_ID:
        description: 'Slack Channel Id for receive action notification'
        type: string
      SLACK_THREAD_TS:
        description: 'Slack message ts'
        type: string
      
jobs:
  # some jobs...

  if-deploy-failed-message:
    runs-on: ubuntu-latest
    if: failure()
      - name: update slack message
        uses: slackapi/slack-github-action@v2.0.0
        with:
            method: chat.update
            token: ${{ secrets.SLACK_BOT_TOKEN }}
            payload: |
              channel: ${{ github.event.inputs.SLACK_CHANNEL_ID }}
              ts: ${{ github.event.inputs.SLACK_THREAD_TS }}
              text: "âŒ æ‰“åŒ…ä»»å‹™å¤±æ•—ï¼Œè«‹æª¢æŸ¥åŸ·è¡Œç‹€æ³çµæœæˆ–ç¨å¾Œå†è©¦ã€‚\n<${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}|é»æ­¤æŸ¥çœ‹åŸ·è¡Œç‹€æ³> cc'ed <@${{ github.event.inputs.SLACK_USER_ID }}>"
```

**æ•ˆæœï¼š**


![](/assets/4cb4437818f2/1*-w5jqjkx6p2alpzlLcz_Nw.png)



> **_Slack App ä¸²æ¥ç´°ç¯€å¯åƒè€ƒæˆ‘ä¹‹å‰çš„æ–‡ç« ï¼š [Slack & ChatGPT Integration](../bd94cc88f9c9/) ã€‚_** 




#### å»¶ä¼¸ \(2\) â€”æŸ¥è©¢ Jira å·¥å–®

`Jira.gsï¼š`
```javascript
const jiraPersonalAccessToken = ""
// https://confluence.atlassian.com/enterprise/using-personal-access-tokens-1026032365.html

function getJiraTickets() {
  const url = `https://xxx.atlassian.net/rest/api/3/search`;

  // JQL query
  const jql = `project = XXX`;
  const queryParams = {
    jql: jql,
    maxResults: 50, // Adjust as needed
  };

  const options = {
    method: "get",
    headers: {
      Authorization: "Basic " + jiraPersonalAccessToken,
      "Content-Type": "application/json",
    },
    muteHttpExceptions: true,
  };

  const queryString = Object.keys(queryParams).map(key => `${encodeURIComponent(key)}=${encodeURIComponent(queryParams[key])}`).join("&");
  const response = UrlFetchApp.fetch(url + "?" + queryString + "&fields=", options);
  // could specify only return some fields

  if (response.getResponseCode() === 200) {
    const issues = JSON.parse(response.getContentText()).issues;
    return issues;
  } else {
    Logger.log(`Error: ${response.getResponseCode()} - ${response.getContentText()}`);
    throw new Error("Failed to fetch Jira issues.");
  }
} 
```

å…¶ä»– Jira API ä½¿ç”¨è«‹åƒè€ƒ [å®˜æ–¹æ–‡ä»¶](https://developer.atlassian.com/cloud/jira/platform/rest/v3/){:target="_blank"} ã€‚
#### å»¶ä¼¸ \(3\) â€” æŸ¥è©¢ Asana å·¥å–®

`Asana.gsï¼š`
```kotlin
const asanaPersonalAccessToken = ""
// https://developers.asana.com/docs/personal-access-token

function asanaAPI(endpoint, method = "GET", data = null) {
    var options = {
      "method" : method,
      "contentType" : "application/json",
      "headers": {
          "Authorization":  "Bearer "+asanaPersonalAccessToken
      }
    };

    if (data != null) {
      options["payload"] = JSON.stringify({"data":data});
    }

    const url = "https://app.asana.com/api/1.0"+endpoint;
    const res = UrlFetchApp.fetch(url, options);
    const data = JSON.parse(res.getContentText());
    return data;
}

// æŸ¥æ‰¾ tasks in project
// asanaAPI("/projects/PROJECT_ID/tasks");
```

å…¶ä»– Asana API ä½¿ç”¨è«‹åƒè€ƒ [å®˜æ–¹æ–‡ä»¶](https://developers.asana.com/reference/gettasksforproject){:target="_blank"} ã€‚
### ç¸½çµ

è‡ªå‹•åŒ–ã€å·¥ä½œåŠé–‹ç™¼æµç¨‹å„ªåŒ–ç¼ºçš„æ°¸é ä¸æ˜¯æŠ€è¡“ï¼Œè€Œæ˜¯æƒ³æ³•ï¼›åªè¦æœ‰æƒ³æ³•æˆ‘å€‘éƒ½èƒ½æ‰¾åˆ°é©åˆçš„æŠ€è¡“ä¾†å¯¦ç¾ï¼Œå…±å‹‰ä¹‹ï¼
### 2025/07 Update:

æ­¤åŠŸèƒ½å·²æ•´åˆåˆ°å¯¦éš›æ‰“åŒ…å·¥å…·ä½¿ç”¨ï¼Œå¯åƒè€ƒæœ€æ–°æ–‡ç« æ¡ˆä¾‹ï¼šã€Œ [**CI/CD å¯¦æˆ°æŒ‡å—ï¼ˆå››ï¼‰ï¼šä½¿ç”¨ Google Apps Script Web App ä¸²æ¥ GitHub Actions å»ºç½®å…è²»æ˜“ç”¨çš„æ‰“åŒ…å·¥å…·å¹³å°**](../4273e57e7148/) ã€


æœ‰ä»»ä½•å•é¡ŒåŠæŒ‡æ•™æ­¡è¿ [èˆ‡æˆ‘è¯çµ¡](https://www.zhgchg.li/contact){:target="_blank"} ã€‚



_[Post](https://dev.zhgchg.li/%E4%BD%BF%E7%94%A8-google-apps-script-web-app-%E8%A1%A8%E5%96%AE%E4%B8%B2%E6%8E%A5-github-action-ci-cd-%E5%B7%A5%E4%BD%9C-4cb4437818f2){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}._