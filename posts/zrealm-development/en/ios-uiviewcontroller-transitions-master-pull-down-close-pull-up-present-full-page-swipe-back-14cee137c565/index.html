<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="iOS UIViewController Transitions｜Master Pull-Down Close, Pull-Up Present &amp; Full-Page Swipe Back" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="Discover how to implement seamless UIViewController transitions in iOS, including pull-down to close, pull-up to present, and full-page right-swipe back gestures, enhancing user interaction and navigation flow efficiently." /><meta property="og:description" content="Discover how to implement seamless UIViewController transitions in iOS, including pull-down to close, pull-up to present, and full-page right-swipe back gestures, enhancing user interaction and navigation flow efficiently." /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-development/en/ios-uiviewcontroller-transitions-master-pull-down-close-pull-up-present-full-page-swipe-back-14cee137c565/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-development/en/ios-uiviewcontroller-transitions-master-pull-down-close-pull-up-present-full-page-swipe-back-14cee137c565/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/14cee137c565/1*6IQTrlT4vIKR-NjLRsvZ-A.gif" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-01-12T02:41:06+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/14cee137c565/1*6IQTrlT4vIKR-NjLRsvZ-A.gif" /><meta property="twitter:title" content="iOS UIViewController Transitions｜Master Pull-Down Close, Pull-Up Present &amp; Full-Page Swipe Back" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://medium.com/@zhgchgli/"},"dateModified":"2024-04-13T16:06:12+08:00","datePublished":"2020-01-12T02:41:06+08:00","description":"Discover how to implement seamless UIViewController transitions in iOS, including pull-down to close, pull-up to present, and full-page right-swipe back gestures, enhancing user interaction and navigation flow efficiently.","headline":"iOS UIViewController Transitions｜Master Pull-Down Close, Pull-Up Present &amp; Full-Page Swipe Back","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDg2IiBoZWlnaHQ9Ijg1MCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg==","url":"https://zhgchg.li/assets/14cee137c565/1*6IQTrlT4vIKR-NjLRsvZ-A.gif","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-development/en/ios-uiviewcontroller-transitions-master-pull-down-close-pull-up-present-full-page-swipe-back-14cee137c565/"},"url":"https://zhgchg.li/posts/zrealm-development/en/ios-uiviewcontroller-transitions-master-pull-down-close-pull-up-present-full-page-swipe-back-14cee137c565/"}</script><title>iOS UIViewController Transitions｜Master Pull-Down Close, Pull-Up Present & Full-Page Swipe Back | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0"> <a href="https://medium.com/@zhgchgli" target="_blank" style="display: block;text-align: center;font-style: normal;/* text-decoration: underline; */font-size: 1.2em;color: var(--heading-color);">1K+ Followers on Medium</a> An iOS, web, and automation developer from Taiwan 🇹🇼 who also loves sharing, traveling, and writing.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>iOS UIViewController Transitions｜Master Pull-Down Close, Pull-Up Present & Full-Page Swipe Back</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>iOS UIViewController Transitions｜Master Pull-Down Close, Pull-Up Present & Full-Page Swipe Back</h1><p class="post-desc fw-light mb-4">Discover how to implement seamless UIViewController transitions in iOS, including pull-down to close, pull-up to present, and full-page right-swipe back gestures, enhancing user interaction and navigation flow efficiently.</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1578768066" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jan 12, 2020 </time> </span> <span> Updated <time data-ts="1712995572" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 13, 2024 </time> </span><div class="mt-3 mb-3"> <a href="/assets/14cee137c565/1*6IQTrlT4vIKR-NjLRsvZ-A.gif" class="popup img-link preview-img blur"><img data-src="/assets/14cee137c565/1*6IQTrlT4vIKR-NjLRsvZ-A.gif" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDg2IiBoZWlnaHQ9Ijg1MCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://medium.com/@zhgchgli/">ZhgChgLi</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="4368 words" > <em>24 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">iOS UIViewController Transitions｜Master Pull-Down Close, Pull-Up Present & Full-Page Swipe Back</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">章節 (Chapters)🔖</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">iOS UIViewController Transitions｜Master Pull-Down Close, Pull-Up Present & Full-Page Swipe Back</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic> <script async="" src="https://widgetic.com/sdk/sdk.js"></script><blockquote class="prompt-info"><p>The following content is translated by OpenAI, <a href="/posts/14cee137c565/"><strong>Click here</strong></a> to view the original Chinese version. <a href="/posts/14cee137c565/"><strong>點此查看中文版</strong></a></p></blockquote><hr /><h3 id="ios-uiviewcontroller-transition-essentials"><span class="me-2">iOS UIViewController Transition Essentials</span><a href="#ios-uiviewcontroller-transition-essentials" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Complete Guide to Pull Down to Close / Pull Up to Show / Full-Page Right Swipe Back Effects in UIViewController</p><h3 id="preface"><span class="me-2">Preface</span><a href="#preface" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/14cee137c565/1*6IQTrlT4vIKR-NjLRsvZ-A.gif" class="popup img-link blur"><img data-src="/assets/14cee137c565/1*6IQTrlT4vIKR-NjLRsvZ-A.gif" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDg2IiBoZWlnaHQ9Ijg1MCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>I have always been curious about how popular apps like Facebook, Line, Spotify, etc., implement effects such as “pull down to dismiss a presented UIViewController,” “slide up to fade in a UIViewController,” and “full-screen swipe right to go back.”</p><p>Because these effects are not built-in, the pull-down-to-close feature is only supported with the system card style starting from iOS ≥ 13.</p><h4 id="the-path-of-exploration"><span class="me-2">The Path of Exploration</span><a href="#the-path-of-exploration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Not sure if it’s due to poor keyword choices or the scarcity of data, but I can’t find practical implementations of this feature. The information I found is vague and scattered, forcing me to piece it together from various sources.</p><p>At first, when researching on my own, I found the <code class="language-plaintext highlighter-rouge">UIPresentationController</code> API. Without digging deeper, I used this method combined with <code class="language-plaintext highlighter-rouge">UIPanGestureRecognizer</code> in a crude way to achieve the pull-down-to-close effect; I always felt something was off and thought there must be a better way.</p><p>Until recently, when working on a new project, I read <a href="https://imnotyourson.com/draggable-view-controller-interactive-view-controller/" target="_blank">this great article</a> and broadened my perspective, discovering other APIs that offer more elegant and flexible approaches.</p><blockquote><p><em>This article serves as both a personal record and a guide for friends who share the same confusion.</em></p></blockquote><blockquote><p><em>The content is a bit long. If it’s too much trouble, you can scroll down to see the example or directly download the Github project to study!</em></p></blockquote><h3 id="ios-13-card-style-presentation-page"><span class="me-2">iOS 13 Card Style Presentation Page</span><a href="#ios-13-card-style-presentation-page" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>First, let’s talk about the latest system built-in effects<br /> For iOS ≥ 13, <code class="language-plaintext highlighter-rouge">UIViewController.present(_:animated:completion:)</code><br /> The default <code class="language-plaintext highlighter-rouge">modalPresentationStyle</code> is <code class="language-plaintext highlighter-rouge">UIModalPresentationAutomatic</code>, which presents the page in a card style. To keep the previous full-screen presentation, you need to explicitly set it back to <code class="language-plaintext highlighter-rouge">UIModalPresentationFullScreen</code>.</p><p><a href="/assets/14cee137c565/1*j0NeJfAuR2fXP56KWglS7Q.gif" class="popup img-link blur"><img data-src="/assets/14cee137c565/1*j0NeJfAuR2fXP56KWglS7Q.gif" alt="Built-in calendar add event effect" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OTYiIGhlaWdodD0iODUwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Built-in Calendar Add Event Effect</p><h4 id="how-to-disable-pull-down-to-close-close-confirmation"><span class="me-2">How to Disable Pull-Down to Close? Close Confirmation?</span><a href="#how-to-disable-pull-down-to-close-close-confirmation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>A better user experience should check for any entered data when triggering the dropdown to close. If there is data, the user should be prompted whether to discard changes and leave.</p><p>Apple has already thought this through for us; we just need to implement the methods in <code class="language-plaintext highlighter-rouge">UIAdaptivePresentationControllerDelegate</code>.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">class</span> <span class="kt">DetailViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">onEdit</span><span class="p">:</span><span class="kt">Bool</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>
        
        <span class="c1">// Set delegate</span>
        <span class="k">self</span><span class="o">.</span><span class="n">presentationController</span><span class="p">?</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>
        <span class="c1">// if UIViewController is embedded in navigationController:</span>
        <span class="c1">// self.navigationController?.presentationController?.delegate = self</span>
        
        <span class="c1">// Disable swipe down to dismiss (1):</span>
        <span class="k">self</span><span class="o">.</span><span class="n">isModalInPresentation</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        
    <span class="p">}</span>
    
<span class="p">}</span>

<span class="c1">// Delegate implementation</span>
<span class="kd">extension</span> <span class="kt">DetailViewController</span><span class="p">:</span> <span class="kt">UIAdaptivePresentationControllerDelegate</span> <span class="p">{</span>
    <span class="c1">// Disable swipe down to dismiss (2):</span>
    <span class="kd">func</span> <span class="nf">presentationControllerShouldDismiss</span><span class="p">(</span><span class="n">_</span> <span class="nv">presentationController</span><span class="p">:</span> <span class="kt">UIPresentationController</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="c1">// Swipe down gesture triggered when dismissal is cancelled</span>
    <span class="kd">func</span> <span class="nf">presentationControllerDidAttemptToDismiss</span><span class="p">(</span><span class="n">_</span> <span class="nv">presentationController</span><span class="p">:</span> <span class="kt">UIPresentationController</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">onEdit</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">let</span> <span class="nv">alert</span> <span class="o">=</span> <span class="kt">UIAlertController</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"Data not saved"</span><span class="p">,</span> <span class="nv">message</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">preferredStyle</span><span class="p">:</span> <span class="o">.</span><span class="n">actionSheet</span><span class="p">)</span>
          <span class="n">alert</span><span class="o">.</span><span class="nf">addAction</span><span class="p">(</span><span class="kt">UIAlertAction</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"Discard and leave"</span><span class="p">,</span> <span class="nv">style</span><span class="p">:</span> <span class="o">.</span><span class="k">default</span><span class="p">)</span> <span class="p">{</span> <span class="n">_</span> <span class="k">in</span>
              <span class="k">self</span><span class="o">.</span><span class="nf">dismiss</span><span class="p">(</span><span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
          <span class="p">})</span>
          <span class="n">alert</span><span class="o">.</span><span class="nf">addAction</span><span class="p">(</span><span class="kt">UIAlertAction</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"Continue editing"</span><span class="p">,</span> <span class="nv">style</span><span class="p">:</span> <span class="o">.</span><span class="n">cancel</span><span class="p">,</span> <span class="nv">handler</span><span class="p">:</span> <span class="kc">nil</span><span class="p">))</span>
          <span class="k">self</span><span class="o">.</span><span class="nf">present</span><span class="p">(</span><span class="n">alert</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>      
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="k">self</span><span class="o">.</span><span class="nf">dismiss</span><span class="p">(</span><span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>To disable pull-down dismissal, you can either set the <code class="language-plaintext highlighter-rouge">UIViewController</code> variable <code class="language-plaintext highlighter-rouge">isModalInPresentation</code> to false or implement the <code class="language-plaintext highlighter-rouge">UIAdaptivePresentationControllerDelegate</code> method <code class="language-plaintext highlighter-rouge">presentationControllerShouldDismiss</code> and return true. Either approach works.</p><p><code class="language-plaintext highlighter-rouge">UIAdaptivePresentationControllerDelegate presentationControllerDidAttemptToDismiss</code> method is only called when the <strong>pull-down dismissal is canceled</strong>.</p><h4 id="by-the-way"><span class="me-2">By the way…</span><a href="#by-the-way" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The card-style display page is called a <code class="language-plaintext highlighter-rouge">Sheet</code> in the system, and its behavior differs from <code class="language-plaintext highlighter-rouge">FullScreen</code>.</p><blockquote><p><em>Assuming today <code class="language-plaintext highlighter-rouge">RootViewController</code> is <code class="language-plaintext highlighter-rouge">HomeViewController</code></em></p></blockquote><blockquote><p><em>In card style presentation (UIModalPresentationAutomatic):</em></p></blockquote><blockquote><p><code class="language-plaintext highlighter-rouge">When presenting</code> <code class="language-plaintext highlighter-rouge">DetailViewController</code> from <code class="language-plaintext highlighter-rouge">HomeViewController</code>…</p></blockquote><blockquote><p><code class="language-plaintext highlighter-rouge">viewWillDisappear</code> / <code class="language-plaintext highlighter-rouge">viewDidDisappear</code> of <code class="language-plaintext highlighter-rouge">HomeViewController</code> <strong><em>are not triggered.</em></strong></p></blockquote><blockquote><p><em>When <code class="language-plaintext highlighter-rouge">DetailViewController</code> is <code class="language-plaintext highlighter-rouge">Dismissed</code>…</em></p></blockquote><blockquote><p><code class="language-plaintext highlighter-rouge">HomeViewController</code> <strong><em>does not trigger <code class="language-plaintext highlighter-rouge">viewWillAppear</code> / <code class="language-plaintext highlighter-rouge">viewDidAppear</code>.</em></strong></p></blockquote><blockquote><p><em>⚠️ <strong>Since XCODE 11, iOS ≥ 13 apps packaged by default use card style for Present (UIModalPresentationAutomatic)</strong></em></p></blockquote><blockquote><p><em><strong>If you have placed some logic in viewWillAppear/viewWillDisappear/viewDidAppear/viewDidDisappear before, be extra careful and check thoroughly!</strong> ⚠️</em></p></blockquote><blockquote><p>After reviewing the system built-ins, let’s move on to the main highlight of this article! How to create these effects yourself?</p></blockquote><h3 id="where-can-transition-animations-be-made"><span class="me-2">Where can transition animations be made?</span><a href="#where-can-transition-animations-be-made" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>First, identify where window switching transition animations can be implemented.</p><p><a href="/assets/14cee137c565/1*G0us0AtYJCy3va1sh_bWhQ.gif" class="popup img-link blur"><img data-src="/assets/14cee137c565/1*G0us0AtYJCy3va1sh_bWhQ.gif" alt="UITabBarController/UIViewController/UINavigationController" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTU0IiBoZWlnaHQ9IjY1NiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>UITabBarController/UIViewController/UINavigationController</p><h4 id="when-switching-uitabbarcontroller"><span class="me-2">When Switching UITabBarController</span><a href="#when-switching-uitabbarcontroller" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>We can set the <code class="language-plaintext highlighter-rouge">delegate</code> in <code class="language-plaintext highlighter-rouge">UITabBarController</code> and implement the <code class="language-plaintext highlighter-rouge">animationControllerForTransitionFrom</code> method to apply custom transition effects when switching <code class="language-plaintext highlighter-rouge">UITabBarController</code> content.</p><p>The system defaults to no animation; the image above shows a fade-in fade-out transition effect.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">class</span> <span class="kt">MainTabBarViewController</span><span class="p">:</span> <span class="kt">UITabBarController</span> <span class="p">{</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>
        <span class="k">self</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>
        
    <span class="p">}</span>
    
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">MainTabBarViewController</span><span class="p">:</span> <span class="kt">UITabBarControllerDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">tabBarController</span><span class="p">(</span><span class="n">_</span> <span class="nv">tabBarController</span><span class="p">:</span> <span class="kt">UITabBarController</span><span class="p">,</span> <span class="n">animationControllerForTransitionFrom</span> <span class="nv">fromVC</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">,</span> <span class="n">to</span> <span class="nv">toVC</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UIViewControllerAnimatedTransitioning</span><span class="p">?</span> <span class="p">{</span>
        <span class="c1">//return UIViewControllerAnimatedTransitioning</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h4 id="when-presentingdismissing-uiviewcontroller"><span class="me-2">When Presenting/Dismissing UIViewController</span><a href="#when-presentingdismissing-uiviewcontroller" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Naturally, when <code class="language-plaintext highlighter-rouge">Present/Dismiss</code> a <code class="language-plaintext highlighter-rouge">UIViewController</code>, you can specify the animation effect; otherwise, this article wouldn’t exist XD. However, it’s worth mentioning that if you only need a Present animation without gesture control, you can directly use <code class="language-plaintext highlighter-rouge">UIPresentationController</code> for convenience and speed (see references at the end).</p><p>The system default is slide up to appear and slide down to disappear! For customizations, you can add fade-in, rounded corners, position control, and other effects.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">class</span> <span class="kt">HomeAddViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>

        <span class="k">self</span><span class="o">.</span><span class="n">modalPresentationStyle</span> <span class="o">=</span> <span class="o">.</span><span class="n">custom</span>
        <span class="k">self</span><span class="o">.</span><span class="n">transitioningDelegate</span> <span class="o">=</span> <span class="k">self</span>
    <span class="p">}</span>
    
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">HomeAddViewController</span><span class="p">:</span> <span class="kt">UIViewControllerTransitioningDelegate</span> <span class="p">{</span>
    
    <span class="kd">func</span> <span class="nf">animationController</span><span class="p">(</span><span class="n">forPresented</span> <span class="nv">presented</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">,</span> <span class="nv">presenting</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">,</span> <span class="nv">source</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UIViewControllerAnimatedTransitioning</span><span class="p">?</span> <span class="p">{</span>
        <span class="c1">// Returning nil uses the default animation</span>
        <span class="k">return</span> <span class="c1">// UIViewControllerAnimatedTransitioning animation to apply when presenting</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">animationController</span><span class="p">(</span><span class="n">forDismissed</span> <span class="nv">dismissed</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UIViewControllerAnimatedTransitioning</span><span class="p">?</span> <span class="p">{</span>
        <span class="c1">// Returning nil uses the default animation</span>
        <span class="k">return</span> <span class="c1">// UIViewControllerAnimatedTransitioning animation to apply when dismissing</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><blockquote><p><em>Any <code class="language-plaintext highlighter-rouge">UIViewController</code> can implement <code class="language-plaintext highlighter-rouge">transitioningDelegate</code> to specify <code class="language-plaintext highlighter-rouge">Present/Dismiss</code> animations; this applies to <code class="language-plaintext highlighter-rouge">UITabBarViewController</code>, <code class="language-plaintext highlighter-rouge">UINavigationController</code>, <code class="language-plaintext highlighter-rouge">UITableViewController</code>, and more.</em></p></blockquote><h4 id="when-uinavigationcontroller-pushespops"><span class="me-2">When UINavigationController Pushes/Pops</span><a href="#when-uinavigationcontroller-pushespops" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><code class="language-plaintext highlighter-rouge">UINavigationController</code> is probably the least likely to need animation changes because the system’s default slide-in from the left and slide-back from the right animation is already the best effect. Customizing this part might be useful for creating seamless left-right switching between <code class="language-plaintext highlighter-rouge">UIViewController</code>s.</p><p>Because we want to enable full-page swipe back gestures and use a custom POP animation, we need to implement our own back animation effect.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">class</span> <span class="kt">HomeNavigationController</span><span class="p">:</span> <span class="kt">UINavigationController</span> <span class="p">{</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>
        
        <span class="k">self</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">HomeNavigationController</span><span class="p">:</span> <span class="kt">UINavigationControllerDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">navigationController</span><span class="p">(</span><span class="n">_</span> <span class="nv">navigationController</span><span class="p">:</span> <span class="kt">UINavigationController</span><span class="p">,</span> <span class="n">animationControllerFor</span> <span class="nv">operation</span><span class="p">:</span> <span class="kt">UINavigationController</span><span class="o">.</span><span class="kt">Operation</span><span class="p">,</span> <span class="n">from</span> <span class="nv">fromVC</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">,</span> <span class="n">to</span> <span class="nv">toVC</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UIViewControllerAnimatedTransitioning</span><span class="p">?</span> <span class="p">{</span>
        
        <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="o">.</span><span class="n">pop</span> <span class="p">{</span>
            <span class="k">return</span> <span class="c1">// UIViewControllerAnimatedTransitioning animation to apply when popping</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="o">.</span><span class="n">push</span> <span class="p">{</span>
            <span class="k">return</span> <span class="c1">// UIViewControllerAnimatedTransitioning animation to apply when pushing</span>
        <span class="p">}</span>
        
        <span class="c1">// Return nil to use the default animation</span>
        <span class="k">return</span> <span class="kc">nil</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="interactive-or-non-interactive-animation"><span class="me-2">Interactive or Non-Interactive Animation?</span><a href="#interactive-or-non-interactive-animation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Before discussing animation implementation and gesture control, let’s first explain what interactive and non-interactive mean.</p><p><strong>Interactive Animation:</strong> Gesture-triggered animations, such as UIPanGestureRecognizer</p><p><strong>Non-interactive Animation:</strong> System-triggered animations, such as self.present()</p><h3 id="how-to-implement-animation-effects"><span class="me-2">How to Implement Animation Effects?</span><a href="#how-to-implement-animation-effects" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>After discussing where it can be done, let’s look at how to create animation effects.</p><p>We need to implement the <code class="language-plaintext highlighter-rouge">UIViewControllerAnimatedTransitioning</code> protocol and perform animations on the window within it.</p><h4 id="common-transition-animation-uiviewanimate"><span class="me-2">Common Transition Animation: UIView.animate</span><a href="#common-transition-animation-uiviewanimate" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Using <code class="language-plaintext highlighter-rouge">UIView.animate</code> directly for animation requires the <code class="language-plaintext highlighter-rouge">UIViewControllerAnimatedTransitioning</code> to implement two methods: <code class="language-plaintext highlighter-rouge">transitionDuration</code> to specify the animation duration, and <code class="language-plaintext highlighter-rouge">animateTransition</code> to define the animation content.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre><td class="rouge-code"><pre><span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">class</span> <span class="kt">SlideFromLeftToRightTransition</span><span class="p">:</span> <span class="kt">NSObject</span><span class="p">,</span> <span class="kt">UIViewControllerAnimatedTransitioning</span> <span class="p">{</span>
    
    <span class="kd">func</span> <span class="nf">transitionDuration</span><span class="p">(</span><span class="n">using</span> <span class="nv">transitionContext</span><span class="p">:</span> <span class="kt">UIViewControllerContextTransitioning</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">TimeInterval</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mf">0.4</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">animateTransition</span><span class="p">(</span><span class="n">using</span> <span class="nv">transitionContext</span><span class="p">:</span> <span class="kt">UIViewControllerContextTransitioning</span><span class="p">)</span> <span class="p">{</span>
        
        <span class="c1">// Available parameters:</span>
        <span class="c1">// Get the view of the target UIViewController to be displayed:</span>
        <span class="k">let</span> <span class="nv">toView</span> <span class="o">=</span> <span class="n">transitionContext</span><span class="o">.</span><span class="nf">view</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">to</span><span class="p">)</span>
        <span class="c1">// Get the target UIViewController to be displayed:</span>
        <span class="k">let</span> <span class="nv">toViewController</span> <span class="o">=</span> <span class="n">transitionContext</span><span class="o">.</span><span class="nf">viewController</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">to</span><span class="p">)</span>
        <span class="c1">// Get the initial frame info of the target UIViewController's view:</span>
        <span class="k">let</span> <span class="nv">toInitalFrame</span> <span class="o">=</span> <span class="n">transitionContext</span><span class="o">.</span><span class="nf">initialFrame</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="n">toViewController</span><span class="o">!</span><span class="p">)</span>
        <span class="c1">// Get the final frame info of the target UIViewController's view:</span>
        <span class="k">let</span> <span class="nv">toFinalFrame</span> <span class="o">=</span> <span class="n">transitionContext</span><span class="o">.</span><span class="nf">finalFrame</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="n">toViewController</span><span class="o">!</span><span class="p">)</span>
        
        <span class="c1">// Get the current UIViewController's view:</span>
        <span class="k">let</span> <span class="nv">fromView</span> <span class="o">=</span> <span class="n">transitionContext</span><span class="o">.</span><span class="nf">view</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">from</span><span class="p">)</span>
        <span class="c1">// Get the current UIViewController:</span>
        <span class="k">let</span> <span class="nv">fromViewController</span> <span class="o">=</span> <span class="n">transitionContext</span><span class="o">.</span><span class="nf">viewController</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">from</span><span class="p">)</span>
        <span class="c1">// Get the initial frame info of the current UIViewController's view:</span>
        <span class="k">let</span> <span class="nv">fromInitalFrame</span> <span class="o">=</span> <span class="n">transitionContext</span><span class="o">.</span><span class="nf">initialFrame</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="n">fromViewController</span><span class="o">!</span><span class="p">)</span>
        <span class="c1">// Get the final frame info of the current UIViewController's view: (Can get the final frame from the previous display animation when closing)</span>
        <span class="k">let</span> <span class="nv">fromFinalFrame</span> <span class="o">=</span> <span class="n">transitionContext</span><span class="o">.</span><span class="nf">finalFrame</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="n">fromViewController</span><span class="o">!</span><span class="p">)</span>
        
        <span class="c1">//toView.frame.origin.y = UIScreen.main.bounds.size.height</span>
        
        <span class="kt">UIView</span><span class="o">.</span><span class="nf">animate</span><span class="p">(</span><span class="nv">withDuration</span><span class="p">:</span> <span class="nf">transitionDuration</span><span class="p">(</span><span class="nv">using</span><span class="p">:</span> <span class="n">transitionContext</span><span class="p">),</span> <span class="nv">delay</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="n">curveLinear</span><span class="p">],</span> <span class="nv">animations</span><span class="p">:</span> <span class="p">{</span>
            <span class="c1">//toView.frame.origin.y = 0</span>
        <span class="p">})</span> <span class="p">{</span> <span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">in</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">transitionContext</span><span class="o">.</span><span class="n">transitionWasCancelled</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// Animation was not cancelled</span>
            <span class="p">}</span>
            
            <span class="c1">// Notify the system that the animation is complete</span>
            <span class="n">transitionContext</span><span class="o">.</span><span class="nf">completeTransition</span><span class="p">(</span><span class="o">!</span><span class="n">transitionContext</span><span class="o">.</span><span class="n">transitionWasCancelled</span><span class="p">)</span>
        <span class="p">}</span>
        
    <span class="p">}</span>
    
<span class="p">}</span>
</pre></table></code></div></div><blockquote><p><strong><em>To and From:</em></strong></p></blockquote><blockquote><p><em>Assuming today <code class="language-plaintext highlighter-rouge">HomeViewController</code> needs to <code class="language-plaintext highlighter-rouge">Present/Push</code> <code class="language-plaintext highlighter-rouge">DetailViewController</code>,</em></p></blockquote><blockquote><p><em>From = HomeViewController / To = DetailViewController</em></p></blockquote><blockquote><p><em>When <code class="language-plaintext highlighter-rouge">DetailViewController</code> needs to <code class="language-plaintext highlighter-rouge">Dismiss/Pop</code>,</em></p></blockquote><blockquote><p><em>From = DetailViewController / To = HomeViewController</em></p></blockquote><p>⚠️⚠️⚠️⚠️⚠️</p><blockquote><p><em>It is officially recommended to get the View from <code class="language-plaintext highlighter-rouge">transitionContext.view</code> instead of using <code class="language-plaintext highlighter-rouge">.view</code> from <code class="language-plaintext highlighter-rouge">transitionContext.viewController</code>.</em></p></blockquote><blockquote><p><em>But here is an issue: when performing Present/Dismiss animations with <code class="language-plaintext highlighter-rouge">modalPresentationStyle = .custom</code>;</em></p></blockquote><blockquote><p><em>Using <code class="language-plaintext highlighter-rouge">transitionContext.view(forKey: .from)</code> in Present will be <strong>nil</strong></em>,</p></blockquote><blockquote><p><em>Using <code class="language-plaintext highlighter-rouge">transitionContext.view(forKey: .to)</code> during Dismiss will also be <strong>nil</strong> ;</em></p></blockquote><blockquote><p><em>Still need to get values from viewController.view to use.</em></p></blockquote><p>⚠️⚠️⚠️⚠️⚠️</p><blockquote><p><code class="language-plaintext highlighter-rouge">transitionContext.completeTransition(!transitionContext.transitionWasCancelled)</code> <em>Must be called when the animation finishes, otherwise the <strong>screen will freeze</strong> ;</em></p></blockquote><blockquote><p><em>However, since <code class="language-plaintext highlighter-rouge">UIView.animate</code> will not call <code class="language-plaintext highlighter-rouge">completion</code> if there is no animation to perform, the aforementioned method may not be called; therefore, make sure the animation will actually run (e.g., y from 100 to 0).</em></p></blockquote><p>ℹ️ℹ️ℹ️ℹ️ℹ️</p><blockquote><p><em>For animations involving <code class="language-plaintext highlighter-rouge">ToView/FromView</code>, if the views are complex or cause issues during animation, you can use <code class="language-plaintext highlighter-rouge">snapshotView(afterScreenUpdates:)</code> to capture a snapshot for the animation. First, take a snapshot and add it to the layer with <code class="language-plaintext highlighter-rouge">transitionContext.containerView.addSubview(snapShotView)</code>. Then hide the original <code class="language-plaintext highlighter-rouge">ToView/FromView</code> (<code class="language-plaintext highlighter-rouge">isHidden = true</code>). At the end of the animation, remove the <code class="language-plaintext highlighter-rouge">snapShotView</code> with <code class="language-plaintext highlighter-rouge">snapShotView.removeFromSuperview()</code> and restore the original <code class="language-plaintext highlighter-rouge">ToView/FromView</code> visibility (<code class="language-plaintext highlighter-rouge">isHidden = false</code>).</em></p></blockquote><h4 id="interruptible-and-resumable-transition-animations-uiviewpropertyanimator"><span class="me-2">Interruptible and Resumable Transition Animations: UIViewPropertyAnimator</span><a href="#interruptible-and-resumable-transition-animations-uiviewpropertyanimator" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>You can also use the new animation classes introduced in <strong>iOS ≥ 10</strong> to implement animation effects.<br /> Choose based on personal preference or the level of detail needed for the animation.<br /> Although the official recommendation is to use <code class="language-plaintext highlighter-rouge">UIViewPropertyAnimator</code> for interactive animations, <strong>for both interactive and non-interactive (gesture-controlled) animations, using UIView.animate is generally sufficient</strong>.<br /> <code class="language-plaintext highlighter-rouge">UIViewPropertyAnimator</code> supports pausing and continuing transition animations. While I’m not sure about its practical applications, interested readers can refer to <a href="https://juejin.im/post/5c3aa7ff518825551e285b8d" target="_blank">this article</a>.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre><td class="rouge-code"><pre><span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">class</span> <span class="kt">FadeInFadeOutTransition</span><span class="p">:</span> <span class="kt">NSObject</span><span class="p">,</span> <span class="kt">UIViewControllerAnimatedTransitioning</span> <span class="p">{</span>
    
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">animatorForCurrentTransition</span><span class="p">:</span> <span class="kt">UIViewImplicitlyAnimating</span><span class="p">?</span>

    <span class="kd">func</span> <span class="nf">interruptibleAnimator</span><span class="p">(</span><span class="n">using</span> <span class="nv">transitionContext</span><span class="p">:</span> <span class="kt">UIViewControllerContextTransitioning</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UIViewImplicitlyAnimating</span> <span class="p">{</span>
        
        <span class="c1">// Return the current animator if there is an ongoing transition</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">animatorForCurrentTransition</span> <span class="o">=</span> <span class="n">animatorForCurrentTransition</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">animatorForCurrentTransition</span>
        <span class="p">}</span>
        
        <span class="c1">// Parameters as mentioned before</span>
        
        <span class="c1">//fromView.frame.origin.y = 100</span>
        
        <span class="k">let</span> <span class="nv">animator</span> <span class="o">=</span> <span class="kt">UIViewPropertyAnimator</span><span class="p">(</span><span class="nv">duration</span><span class="p">:</span> <span class="nf">transitionDuration</span><span class="p">(</span><span class="nv">using</span><span class="p">:</span> <span class="n">transitionContext</span><span class="p">),</span> <span class="nv">curve</span><span class="p">:</span> <span class="o">.</span><span class="n">linear</span><span class="p">)</span>
        
        <span class="n">animator</span><span class="o">.</span><span class="n">addAnimations</span> <span class="p">{</span>
            <span class="c1">//fromView.frame.origin.y = 0</span>
        <span class="p">}</span>
        
        <span class="n">animator</span><span class="o">.</span><span class="n">addCompletion</span> <span class="p">{</span> <span class="p">(</span><span class="n">position</span><span class="p">)</span> <span class="k">in</span>
            <span class="n">transitionContext</span><span class="o">.</span><span class="nf">completeTransition</span><span class="p">(</span><span class="o">!</span><span class="n">transitionContext</span><span class="o">.</span><span class="n">transitionWasCancelled</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="c1">// Keep a reference to the animator</span>
        <span class="k">self</span><span class="o">.</span><span class="n">animatorForCurrentTransition</span> <span class="o">=</span> <span class="n">animator</span>
        <span class="k">return</span> <span class="n">animator</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">transitionDuration</span><span class="p">(</span><span class="n">using</span> <span class="nv">transitionContext</span><span class="p">:</span> <span class="kt">UIViewControllerContextTransitioning</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">TimeInterval</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mf">0.4</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">animateTransition</span><span class="p">(</span><span class="n">using</span> <span class="nv">transitionContext</span><span class="p">:</span> <span class="kt">UIViewControllerContextTransitioning</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// For non-interactive transitions, use the interruptible animator as well</span>
        <span class="k">let</span> <span class="nv">animator</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="nf">interruptibleAnimator</span><span class="p">(</span><span class="nv">using</span><span class="p">:</span> <span class="n">transitionContext</span><span class="p">)</span>
        <span class="n">animator</span><span class="o">.</span><span class="nf">startAnimation</span><span class="p">()</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">animationEnded</span><span class="p">(</span><span class="n">_</span> <span class="nv">transitionCompleted</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Clear the animator when animation ends</span>
        <span class="k">self</span><span class="o">.</span><span class="n">animatorForCurrentTransition</span> <span class="o">=</span> <span class="kc">nil</span>
    <span class="p">}</span>
    
<span class="p">}</span>
</pre></table></code></div></div><blockquote><p><em>In interactive scenarios (control details will be explained later), animations use the <code class="language-plaintext highlighter-rouge">interruptibleAnimator</code> method; for non-interactive cases, the <code class="language-plaintext highlighter-rouge">animateTransition</code> method is still used.</em></p></blockquote><blockquote><p><em>Because of its resumable and interruptible nature, <code class="language-plaintext highlighter-rouge">interruptibleAnimator</code> can be called repeatedly; therefore, we need to use a global variable to store and access its return value.</em></p></blockquote><p><strong>Murmur…</strong><br /> Actually, I originally wanted to switch everything to the new <code class="language-plaintext highlighter-rouge">UIViewPropertyAnimator</code> and recommend everyone use it, but I encountered a strange issue. When doing a full-page swipe back pop animation, if the gesture is released and the animation resets, the Navigation Bar’s items at the top flicker with a fade in and out… I couldn’t find a solution. However, this issue doesn’t occur when using <code class="language-plaintext highlighter-rouge">UIView.animate</code>. If I missed something, please let me know &lt;( _ _ )&gt;.</p><p><a href="/assets/14cee137c565/1*cVg7iZ_rFC2nxm2H5ET1Gg.gif" class="popup img-link blur"><img data-src="/assets/14cee137c565/1*cVg7iZ_rFC2nxm2H5ET1Gg.gif" alt="Issue image; + button is the back button" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzODQiIGhlaWdodD0iMTA4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Problem image; + button is for the previous page</p><p>So to be safe, let’s stick with the old method!</p><p>Separate classes will be created for different animation effects. If the files feel cluttered, you can refer to the packaged solution at the end of the article; or group the same continuous (Present + Dismiss) animations together.</p><h4 id="transitioncoordinator"><span class="me-2">transitionCoordinator</span><a href="#transitioncoordinator" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>If you need finer control, such as changing a specific component in the ViewController to match the transition animation, you can use <code class="language-plaintext highlighter-rouge">transitionCoordinator</code> within <code class="language-plaintext highlighter-rouge">UIViewController</code> to coordinate. I haven’t used this part myself; if interested, you can refer to <a href="https://kemchenj.github.io/2018-12-24/" target="_blank">this article</a>.</p><h3 id="how-to-control-animation"><span class="me-2">How to Control Animation?</span><a href="#how-to-control-animation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This is the “interaction” mentioned earlier, which is essentially gesture control; this is the most important section of the article because we need to link gesture operations with transition animations to achieve the pull-down close and full-page back functions.</p><h4 id="control-proxy-settings"><span class="me-2">Control Proxy Settings:</span><a href="#control-proxy-settings" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>As with the previous <code class="language-plaintext highlighter-rouge">ViewController</code> delegate animation design, the class handling interaction also needs to inform the <code class="language-plaintext highlighter-rouge">ViewController</code> through the delegate.</p><p><strong>UITabBarController: None</strong><br /> <strong>UINavigationController (Push/Pop):</strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">class</span> <span class="kt">HomeNavigationController</span><span class="p">:</span> <span class="kt">UINavigationController</span> <span class="p">{</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>
        
        <span class="k">self</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">HomeNavigationController</span><span class="p">:</span> <span class="kt">UINavigationControllerDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">navigationController</span><span class="p">(</span><span class="n">_</span> <span class="nv">navigationController</span><span class="p">:</span> <span class="kt">UINavigationController</span><span class="p">,</span> <span class="n">animationControllerFor</span> <span class="nv">operation</span><span class="p">:</span> <span class="kt">UINavigationController</span><span class="o">.</span><span class="kt">Operation</span><span class="p">,</span> <span class="n">from</span> <span class="nv">fromVC</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">,</span> <span class="n">to</span> <span class="nv">toVC</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UIViewControllerAnimatedTransitioning</span><span class="p">?</span> <span class="p">{</span>
        
        <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="o">.</span><span class="n">pop</span> <span class="p">{</span>
            <span class="k">return</span> <span class="c1">// UIViewControllerAnimatedTransitioning animation to apply when popping</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="o">.</span><span class="n">push</span> <span class="p">{</span>
            <span class="k">return</span> <span class="c1">// UIViewControllerAnimatedTransitioning animation to apply when pushing</span>
        <span class="p">}</span>
        <span class="c1">// Return nil to use the default animation</span>
        <span class="k">return</span> <span class="kc">nil</span>
    <span class="p">}</span>
    
    <span class="c1">// Add interactive delegate method:</span>
    <span class="kd">func</span> <span class="nf">navigationController</span><span class="p">(</span><span class="n">_</span> <span class="nv">navigationController</span><span class="p">:</span> <span class="kt">UINavigationController</span><span class="p">,</span> <span class="n">interactionControllerFor</span> <span class="nv">animationController</span><span class="p">:</span> <span class="kt">UIViewControllerAnimatedTransitioning</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UIViewControllerInteractiveTransitioning</span><span class="p">?</span> <span class="p">{</span>
        <span class="c1">// Here we cannot tell if it's Pop or Push, so we judge by the animation itself</span>
        <span class="k">if</span> <span class="n">animationController</span> <span class="k">is</span> <span class="n">push</span> <span class="n">animation</span> <span class="p">{</span>
            <span class="k">return</span> <span class="c1">// UIPercentDrivenInteractiveTransition interactive control for push animation</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">animationController</span> <span class="k">is</span> <span class="n">pop</span> <span class="n">animation</span> <span class="p">{</span>
            <span class="k">return</span> <span class="c1">// UIPercentDrivenInteractiveTransition interactive control for pop animation</span>
        <span class="p">}</span>
        <span class="c1">// Return nil to disable interactive handling</span>
        <span class="k">return</span> <span class="kc">nil</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>UIViewController (Present/Dismiss):</strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">class</span> <span class="kt">HomeAddViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>

        <span class="k">self</span><span class="o">.</span><span class="n">modalPresentationStyle</span> <span class="o">=</span> <span class="o">.</span><span class="n">custom</span>
        <span class="k">self</span><span class="o">.</span><span class="n">transitioningDelegate</span> <span class="o">=</span> <span class="k">self</span>
    <span class="p">}</span>
    
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">HomeAddViewController</span><span class="p">:</span> <span class="kt">UIViewControllerTransitioningDelegate</span> <span class="p">{</span>
    
    <span class="kd">func</span> <span class="nf">interactionControllerForDismissal</span><span class="p">(</span><span class="n">using</span> <span class="nv">animator</span><span class="p">:</span> <span class="kt">UIViewControllerAnimatedTransitioning</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UIViewControllerInteractiveTransitioning</span><span class="p">?</span> <span class="p">{</span>
        <span class="c1">// return nil means no interactive handling</span>
        <span class="k">return</span> <span class="c1">// UIPercentDrivenInteractiveTransition interactive control method for Dismiss</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">interactionControllerForPresentation</span><span class="p">(</span><span class="n">using</span> <span class="nv">animator</span><span class="p">:</span> <span class="kt">UIViewControllerAnimatedTransitioning</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UIViewControllerInteractiveTransitioning</span><span class="p">?</span> <span class="p">{</span>
        <span class="c1">// return nil means no interactive handling</span>
        <span class="k">return</span> <span class="c1">// UIPercentDrivenInteractiveTransition interactive control method for Present</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">animationController</span><span class="p">(</span><span class="n">forPresented</span> <span class="nv">presented</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">,</span> <span class="nv">presenting</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">,</span> <span class="nv">source</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UIViewControllerAnimatedTransitioning</span><span class="p">?</span> <span class="p">{</span>
        <span class="c1">// returning nil uses the default animation</span>
        <span class="k">return</span> <span class="c1">// UIViewControllerAnimatedTransitioning animation to apply during Present</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">animationController</span><span class="p">(</span><span class="n">forDismissed</span> <span class="nv">dismissed</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UIViewControllerAnimatedTransitioning</span><span class="p">?</span> <span class="p">{</span>
        <span class="c1">// returning nil uses the default animation</span>
        <span class="k">return</span> <span class="c1">// UIViewControllerAnimatedTransitioning animation to apply during Dismiss</span>
    <span class="p">}</span>
    
<span class="p">}</span>
</pre></table></code></div></div><p>⚠️⚠️⚠️⚠️⚠️</p><blockquote><p><em>If you implement methods like interactionControllerFor…, these methods will be called even if the animation is non-interactive (e.g., self.present system-triggered transition); what we need to control is the <code class="language-plaintext highlighter-rouge">wantsInteractiveStart</code> parameter inside (explained below).</em></p></blockquote><h4 id="animation-interaction-handler-class-uipercentdriveninteractivetransition"><span class="me-2">Animation Interaction Handler Class UIPercentDrivenInteractiveTransition:</span><a href="#animation-interaction-handler-class-uipercentdriveninteractivetransition" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Next, let’s discuss the core implementation of <code class="language-plaintext highlighter-rouge">UIPercentDrivenInteractiveTransition</code>.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
</pre><td class="rouge-code"><pre><span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">class</span> <span class="kt">PullToDismissInteractive</span><span class="p">:</span> <span class="kt">UIPercentDrivenInteractiveTransition</span> <span class="p">{</span>
    
    <span class="c1">// The UIView to add gesture control for interaction</span>
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">interactiveView</span><span class="p">:</span> <span class="kt">UIView</span><span class="o">!</span>
    <span class="c1">// The current UIViewController</span>
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">presented</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="o">!</span>
    <span class="c1">// The threshold percentage to complete the transition, otherwise revert</span>
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">thredhold</span><span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mf">0.4</span>
    
    <span class="c1">// Different transition effects may need different info, customizable</span>
    <span class="kd">convenience</span> <span class="nf">init</span><span class="p">(</span><span class="n">_</span> <span class="nv">presented</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">,</span> <span class="n">_</span> <span class="nv">interactiveView</span><span class="p">:</span> <span class="kt">UIView</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">init</span><span class="p">()</span>
        <span class="k">self</span><span class="o">.</span><span class="n">interactiveView</span> <span class="o">=</span> <span class="n">interactiveView</span>
        <span class="k">self</span><span class="o">.</span><span class="n">presented</span> <span class="o">=</span> <span class="n">presented</span>
        <span class="nf">setupPanGesture</span><span class="p">()</span>
        
        <span class="c1">// Default value, informs the system that this is not an interactive animation initially</span>
        <span class="n">wantsInteractiveStart</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">setupPanGesture</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">panGesture</span> <span class="o">=</span> <span class="kt">UIPanGestureRecognizer</span><span class="p">(</span><span class="nv">target</span><span class="p">:</span> <span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="k">#selector</span><span class="p">(</span><span class="nf">handlePan</span><span class="p">(</span><span class="nv">_</span><span class="p">:)))</span>
        <span class="n">panGesture</span><span class="o">.</span><span class="n">maximumNumberOfTouches</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">panGesture</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>
        <span class="n">interactiveView</span><span class="o">.</span><span class="nf">addGestureRecognizer</span><span class="p">(</span><span class="n">panGesture</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">@objc</span> <span class="kd">func</span> <span class="nf">handlePan</span><span class="p">(</span><span class="n">_</span> <span class="nv">sender</span><span class="p">:</span> <span class="kt">UIPanGestureRecognizer</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="n">sender</span><span class="o">.</span><span class="n">state</span> <span class="p">{</span>
        <span class="k">case</span> <span class="o">.</span><span class="nv">began</span><span class="p">:</span>
            <span class="c1">// Reset gesture position</span>
            <span class="n">sender</span><span class="o">.</span><span class="nf">setTranslation</span><span class="p">(</span><span class="o">.</span><span class="n">zero</span><span class="p">,</span> <span class="nv">in</span><span class="p">:</span> <span class="n">interactiveView</span><span class="p">)</span>
            <span class="c1">// Inform the system that an interactive animation triggered by gesture is starting</span>
            <span class="n">wantsInteractiveStart</span> <span class="o">=</span> <span class="kc">true</span>
            
            <span class="c1">// When gesture begins, call the transition effect (won't execute immediately, system will catch it)</span>
            <span class="c1">// Then if the transition has a corresponding animation, it will jump to UIViewControllerAnimatedTransitioning to handle</span>
            <span class="c1">// animated must be true, otherwise no animation</span>
            
            <span class="c1">// Dismiss:</span>
            <span class="k">self</span><span class="o">.</span><span class="n">presented</span><span class="o">.</span><span class="nf">dismiss</span><span class="p">(</span><span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
            <span class="c1">// Present:</span>
            <span class="c1">//self.present(presenting,animated: true)</span>
            <span class="c1">// Push:</span>
            <span class="c1">//self.navigationController.push(presenting)</span>
            <span class="c1">// Pop:</span>
            <span class="c1">//self.navigationController.pop(animated: true)</span>
        
        <span class="k">case</span> <span class="o">.</span><span class="nv">changed</span><span class="p">:</span>
            <span class="c1">// Calculate the gesture sliding position corresponding to animation completion percentage 0~1</span>
            <span class="c1">// Actual calculation varies by animation type</span>
            <span class="k">let</span> <span class="nv">translation</span> <span class="o">=</span> <span class="n">sender</span><span class="o">.</span><span class="nf">translation</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="n">interactiveView</span><span class="p">)</span>
            <span class="k">guard</span> <span class="n">translation</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">sender</span><span class="o">.</span><span class="nf">setTranslation</span><span class="p">(</span><span class="o">.</span><span class="n">zero</span><span class="p">,</span> <span class="nv">in</span><span class="p">:</span> <span class="n">interactiveView</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="p">}</span>
            <span class="k">let</span> <span class="nv">percentage</span> <span class="o">=</span> <span class="nf">abs</span><span class="p">(</span><span class="n">translation</span><span class="o">.</span><span class="n">y</span> <span class="o">/</span> <span class="n">interactiveView</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
            
            <span class="c1">// Update UIViewControllerAnimatedTransitioning animation percentage</span>
            <span class="nf">update</span><span class="p">(</span><span class="n">percentage</span><span class="p">)</span>
        <span class="k">case</span> <span class="o">.</span><span class="nv">ended</span><span class="p">:</span>
            <span class="c1">// When gesture ends, check if completion exceeds threshold</span>
            <span class="n">wantsInteractiveStart</span> <span class="o">=</span> <span class="kc">false</span>
            <span class="k">if</span> <span class="n">percentComplete</span> <span class="o">&gt;=</span> <span class="n">thredhold</span> <span class="p">{</span>
              <span class="c1">// Yes, inform animation to finish</span>
              <span class="nf">finish</span><span class="p">()</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
              <span class="c1">// No, inform animation to revert</span>
              <span class="nf">cancel</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="o">.</span><span class="n">cancelled</span><span class="p">,</span> <span class="o">.</span><span class="nv">failed</span><span class="p">:</span>
          <span class="c1">// On cancel or failure</span>
          <span class="n">wantsInteractiveStart</span> <span class="o">=</span> <span class="kc">false</span>
          <span class="nf">cancel</span><span class="p">()</span>
        <span class="k">default</span><span class="p">:</span>
          <span class="n">wantsInteractiveStart</span> <span class="o">=</span> <span class="kc">false</span>
          <span class="k">return</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// When UIViewController contains UIScrollView components (UITableView/UICollectionView/WKWebView...), prevent gesture conflicts</span>
<span class="c1">// Enable interactive transition gesture only when the internal UIScrollView is scrolled to the top</span>
<span class="kd">extension</span> <span class="kt">PullToDismissInteractive</span><span class="p">:</span> <span class="kt">UIGestureRecognizerDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">gestureRecognizer</span><span class="p">(</span><span class="n">_</span> <span class="nv">gestureRecognizer</span><span class="p">:</span> <span class="kt">UIGestureRecognizer</span><span class="p">,</span> <span class="n">shouldRecognizeSimultaneouslyWith</span> <span class="nv">otherGestureRecognizer</span><span class="p">:</span> <span class="kt">UIGestureRecognizer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">scrollView</span> <span class="o">=</span> <span class="n">otherGestureRecognizer</span><span class="o">.</span><span class="n">view</span> <span class="k">as?</span> <span class="kt">UIScrollView</span> <span class="p">{</span>
            <span class="k">if</span> <span class="n">scrollView</span><span class="o">.</span><span class="n">contentOffset</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kc">true</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kc">false</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">true</span>
    <span class="p">}</span>
    
<span class="p">}</span>
</pre></table></code></div></div><p><a href="https://stackoverflow.com/questions/29558622/pan-gesture-why-need-settranslation-to-zero" target="_blank"><em>*Additional point about why sender.setTranslation(.zero, in: interactiveView) is needed&lt;</em></a></p><p>We need to implement different classes based on the effects of various gesture operations; if the operations are part of the same sequence (Present + Dismiss), they can be grouped together.</p><p>⚠️⚠️⚠️⚠️⚠️</p><blockquote><p><code class="language-plaintext highlighter-rouge">wantsInteractiveStart</code> <em><strong>must be in the correct state</strong>; setting <code class="language-plaintext highlighter-rouge">wantsInteractiveStart = false</code> during interactive animations can also cause screen freezes;</em></p></blockquote><blockquote><p><em>You need to exit and reopen the app to restore normal function.</em></p></blockquote><p>⚠️⚠️⚠️⚠️⚠️</p><blockquote><p><em>interactiveView must also have <strong>isUserInteractionEnabled = true</strong></em></p></blockquote><blockquote><p><em>You can add more settings to ensure it!</em></p></blockquote><h3 id="combination"><span class="me-2">Combination</span><a href="#combination" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>After setting up the <code class="language-plaintext highlighter-rouge">Delegate</code> here and creating the <code class="language-plaintext highlighter-rouge">Class</code>, we can achieve the desired functionality.<br /> Next, without further ado, here is the complete example.</p><h3 id="custom-dropdown-close-page-effect"><span class="me-2">Custom Dropdown Close Page Effect</span><a href="#custom-dropdown-close-page-effect" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The advantage of a custom pull-down is that it supports all iOS versions on the market, allows control over the overlay percentage, controls the trigger close position, and customizes animation effects.</p><p><a href="/assets/14cee137c565/1*Wz8y5UJSgS0IUN86upSqLw.gif" class="popup img-link blur"><img data-src="/assets/14cee137c565/1*Wz8y5UJSgS0IUN86upSqLw.gif" alt="Click the top right + Present page" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzODQiIGhlaWdodD0iNjYwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Click the + Present button at the top right corner of the page</p><p>This is an example of <code class="language-plaintext highlighter-rouge">HomeViewController</code> presenting <code class="language-plaintext highlighter-rouge">HomeAddViewController</code> and <code class="language-plaintext highlighter-rouge">HomeAddViewController</code> dismissing itself.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
</pre><td class="rouge-code"><pre>import UIKit

class HomeViewController: UIViewController {

    @IBAction func addButtonTapped(_ sender: Any) {
        guard let homeAddViewController = UIStoryboard(name: "Main", bundle: nil).instantiateViewController(identifier: "HomeAddViewController") as? HomeAddViewController else {
            return
        }
        
        //transitioningDelegate can be assigned to the target ViewController or the current ViewController
        homeAddViewController.transitioningDelegate = homeAddViewController
        homeAddViewController.modalPresentationStyle = .custom
        self.present(homeAddViewController, animated: true, completion: nil)
    }

}
import UIKit

class HomeAddViewController: UIViewController {

    private var pullToDismissInteractive:PullToDismissInteractive!
    
    override func viewDidLoad() {
        super.viewDidLoad()
        
        //Bind transition interaction info
        self.pullToDismissInteractive = PullToDismissInteractive(self, self.view)
    }
    
}

extension HomeAddViewController: UIViewControllerTransitioningDelegate {
    
    func interactionControllerForDismissal(using animator: UIViewControllerAnimatedTransitioning) -&gt; UIViewControllerInteractiveTransitioning? {
        return pullToDismissInteractive
    }
    
    func animationController(forPresented presented: UIViewController, presenting: UIViewController, source: UIViewController) -&gt; UIViewControllerAnimatedTransitioning? {
        return PresentAndDismissTransition(false)
    }
    
    func animationController(forDismissed dismissed: UIViewController) -&gt; UIViewControllerAnimatedTransitioning? {
        return PresentAndDismissTransition(true)
    }
    
    func interactionControllerForPresentation(using animator: UIViewControllerAnimatedTransitioning) -&gt; UIViewControllerInteractiveTransitioning? {
        //No present gesture here
        return nil
    }
}
import UIKit

class PullToDismissInteractive: UIPercentDrivenInteractiveTransition {
    
    private var interactiveView: UIView!
    private var presented: UIViewController!
    private var completion:(() -&gt; Void)?
    private let thredhold: CGFloat = 0.4
    
    convenience init(_ presented: UIViewController, _ interactiveView: UIView,_ completion:(() -&gt; Void)? = nil) {
        self.init()
        self.interactiveView = interactiveView
        self.completion = completion
        self.presented = presented
        setupPanGesture()
        
        wantsInteractiveStart = false
    }

    private func setupPanGesture() {
        let panGesture = UIPanGestureRecognizer(target: self, action: #selector(handlePan(_:)))
        panGesture.maximumNumberOfTouches = 1
        panGesture.delegate = self
        interactiveView.addGestureRecognizer(panGesture)
    }

    @objc func handlePan(_ sender: UIPanGestureRecognizer) {
        switch sender.state {
        case .began:
            sender.setTranslation(.zero, in: interactiveView)
            wantsInteractiveStart = true
            
            self.presented.dismiss(animated: true, completion: self.completion)
        case .changed:
            let translation = sender.translation(in: interactiveView)
            guard translation.y &gt;= 0 else {
                sender.setTranslation(.zero, in: interactiveView)
                return
            }

            let percentage = abs(translation.y / interactiveView.bounds.height)
            update(percentage)
        case .ended:
            if percentComplete &gt;= thredhold {
                finish()
            } else {
                wantsInteractiveStart = false
                cancel()
            }
        case .cancelled, .failed:
            wantsInteractiveStart = false
            cancel()
        default:
            wantsInteractiveStart = false
            return
        }
    }
}

extension PullToDismissInteractive: UIGestureRecognizerDelegate {
    func gestureRecognizer(_ gestureRecognizer: UIGestureRecognizer, shouldRecognizeSimultaneouslyWith otherGestureRecognizer: UIGestureRecognizer) -&gt; Bool {
        if let scrollView = otherGestureRecognizer.view as? UIScrollView {
            if scrollView.contentOffset.y &lt;= 0 {
                return true
            } else {
                return false
            }
        }
        return true
    }
    
}
</pre></table></code></div></div><p>The above achieves the effect shown in the image. Since this is a tutorial demonstration, I didn’t want to make the path too complicated, so the code is messy and has plenty of room for optimization and integration.</p><blockquote><p><strong><em>It is worth mentioning…</em></strong></p></blockquote><blockquote><p><em>iOS ≥ 13, if a View contains a UITextView, during the pull-down close animation, the text inside the UITextView will appear blank; this causes a flickering experience <a href="https://twitter.com/zhgchgli/status/1207851671553892352" target="_blank">(video example)</a> …</em></p></blockquote><blockquote><p><em>The solution here is to use <code class="language-plaintext highlighter-rouge">snapshotView(afterScreenUpdates:)</code> to capture a snapshot instead of the original view layer during animation.</em></p></blockquote><h3 id="full-page-right-swipe-to-go-back"><span class="me-2">Full-page right swipe to go back</span><a href="#full-page-right-swipe-to-go-back" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>When looking for a solution to enable full-screen right-swipe back gesture, I found a <strong>tricky</strong> method:<br /> Add a <code class="language-plaintext highlighter-rouge">UIPanGestureRecognizer</code> directly to the view, then set both the <code class="language-plaintext highlighter-rouge">target</code> and <code class="language-plaintext highlighter-rouge">action</code> to the native <code class="language-plaintext highlighter-rouge">interactivePopGestureRecognizer</code> with <code class="language-plaintext highlighter-rouge">action:handleNavigationTransition</code>.<br /> <a href="https://juejin.im/entry/5795809dd342d30059ed5c60" target="_blank"><em>*Click here for detailed method&lt;</em></a></p><p>That’s right! It definitely looks like a Private API, so it might be rejected during review; also, it’s uncertain if Swift can use it, as it likely relies on Objective-C runtime features.</p><h4 id="lets-stick-to-the-official-way"><span class="me-2">Let’s stick to the official way:</span><a href="#lets-stick-to-the-official-way" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Using the same approach as in this article, we handle the <code class="language-plaintext highlighter-rouge">navigationController</code> POP ourselves; just add a full-page right swipe gesture controller combined with a custom right swipe animation!</p><p>Other parts omitted, only key animation and interaction handling classes are shown:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
</pre><td class="rouge-code"><pre>import UIKit

class SwipeBackInteractive: UIPercentDrivenInteractiveTransition {
    
    private var interactiveView: UIView!
    private var navigationController: UINavigationController!

    private let thredhold: CGFloat = 0.4
    
    convenience init(_ navigationController: UINavigationController, _ interactiveView: UIView) {
        self.init()
        self.interactiveView = interactiveView
        
        self.navigationController = navigationController
        setupPanGesture()
        
        wantsInteractiveStart = false
    }

    private func setupPanGesture() {
        let panGesture = UIPanGestureRecognizer(target: self, action: #selector(handlePan(_:)))
        panGesture.maximumNumberOfTouches = 1
        interactiveView.addGestureRecognizer(panGesture)
    }

    @objc func handlePan(_ sender: UIPanGestureRecognizer) {
        
        switch sender.state {
        case .began:
            sender.setTranslation(.zero, in: interactiveView)
            wantsInteractiveStart = true
            
            self.navigationController.popViewController(animated: true)
        case .changed:
            let translation = sender.translation(in: interactiveView)
            guard translation.x &gt;= 0 else {
                sender.setTranslation(.zero, in: interactiveView)
                return
            }

            let percentage = abs(translation.x / interactiveView.bounds.width)
            update(percentage)
        case .ended:
            if percentComplete &gt;= thredhold {
                finish()
            } else {
                wantsInteractiveStart = false
                cancel()
            }
        case .cancelled, .failed:
            wantsInteractiveStart = false
            cancel()
        default:
            wantsInteractiveStart = false
            return
        }
    }
}
</pre></table></code></div></div><h3 id="pull-up-fade-in-uiviewcontroller"><span class="me-2">Pull-up Fade-in UIViewController</span><a href="#pull-up-fade-in-uiviewcontroller" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Pulling up on the view to fade in + pulling down to close creates a transition effect similar to Spotify’s player!</p><p>This part is more complicated, but the principle is the same. It will not be posted here. Interested readers can refer to the GitHub example.</p><p>The main point to note is <strong>when pulling up for fade-in, the animation must use “.curveLinear linear”</strong>; otherwise, the pull-up will feel unresponsive. The pulling distance and the display position will not be proportional.</p><h3 id="done"><span class="me-2">Done!</span><a href="#done" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/14cee137c565/1*RRAVb3p7mZpUCNOpd64-Pw.gif" class="popup img-link blur"><img data-src="/assets/14cee137c565/1*RRAVb3p7mZpUCNOpd64-Pw.gif" alt="Completed Image" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTUyIiBoZWlnaHQ9IjY1OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Completed Diagram</p><blockquote><p>This article is very long and took me a lot of time to organize and create. Thank you for your patience in reading.</p></blockquote><h4 id="download-the-full-github-examples"><span class="me-2">Download the full GitHub examples:</span><a href="#download-the-full-github-examples" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="https://github.com/zhgchgli0718/UIViewControllerTransitionDemo" target="_blank" class="img-link shimmer" ><img src="https://opengraph.githubassets.com/af405b87d71ea95f59b19f5de94bda740a12566ddf86eb5a9b34d2271d53bb20/zhgchgli0718/UIViewControllerTransitionDemo" alt="" loading="lazy"></a></p><p><strong>Reference:</strong></p><ol><li><p><a href="https://imnotyourson.com/draggable-view-controller-interactive-view-controller/" target="_blank">Draggable view controller? Interactive view controller!</a></p><li><p><a href="https://juejin.im/post/5c24745b6fb9a049d5198ce5#18-%E5%AF%BC%E8%88%AA%E6%8E%A7%E5%88%B6%E5%99%A8%E8%BD%AC%E5%9C%BA" target="_blank">Systematic Learning of iOS Animations Part 4: View Controller Transition Animations</a></p><li><p><a href="https://juejin.im/post/5c3aa7ff518825551e285b8d" target="_blank">Systematic Learning of iOS Animations Part 5: Using UIViewPropertyAnimator</a></p><li><p><a href="https://juejin.im/post/5a9651d25188257a5911f666" target="_blank">Use UIPresentationController to create a simple and elegant bottom popup control</a> (If you only want the Present animation effect, you can use this directly)</p></ol><p><strong>For reference to elegant code encapsulation usage:</strong></p><ol><li><p>Swift: <a href="https://github.com/Kharauzov/SwipeableCards" target="_blank">https://github.com/Kharauzov/SwipeableCards</a></p><li><p>Objective-C: <a href="https://github.com/saiday/DraggableViewControllerDemo" target="_blank">https://github.com/saiday/DraggableViewControllerDemo</a></p></ol><p>If you have any questions or feedback, feel free to <a href="https://www.zhgchg.li/contact" target="_blank">contact me</a>.</p><p><em><a href="https://medium.com/zrealm-ios-dev/ios-uiviewcontroller-%E8%BD%89%E5%A0%B4%E4%BA%8C%E4%B8%89%E4%BA%8B-14cee137c565" target="_blank">Post</a> converted from Medium by <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown</a>.</em></p><hr /><blockquote class="prompt-info"><p>This article was first published on Medium ➡️ <a href="https://medium.com/p/14cee137c565" target="_blank"><strong>Click Here</strong></a>, automatically converted and synchronized using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown</a> and <a href="https://github.com/ZhgChgLi/medium-to-jekyll-starter.github.io" target="_blank">Medium-to-jekyll-starter</a>.</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/en/zmediumtomarkdown/2020-01-11-14cee137c565.md" target="_blank">Improve this page on Github.</a></p></blockquote><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=🍺&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a></p><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic> <script async="" src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); border-bottom: 1px solid var(--main-border-color);transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1K+ Followers</span></a></div><div style="font-size: 0.8em; cursor:default; text-align: right;"> 6,716 <span style="font-size: 0.9em;">Total Views</span><br /> <span style="font-size: 0.8em;">Last Statistics Date: 2025-08-19 | 6,550 Views on <a href="https://medium.com/p/14cee137c565" target="_blank">Medium.</a></span></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-development/">ZRealm Development</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/ios/" class="post-tag no-text-decoration" >iOS</a> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >iOS App Development</a> <a href="/tags/swift/" class="post-tag no-text-decoration" >Swift</a> <a href="/tags/uiviewcontroller/" class="post-tag no-text-decoration" >UIViewController</a> <a href="/tags/mobile-app-development/" class="post-tag no-text-decoration" >Mobile App Development</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=iOS%20UIViewController%20Transitions%EF%BD%9CMaster%20Pull-Down%20Close,%20Pull-Up%20Present%20&%20Full-Page%20Swipe%20Back%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-development%2Fen%2Fios-uiviewcontroller-transitions-master-pull-down-close-pull-up-present-full-page-swipe-back-14cee137c565%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=iOS%20UIViewController%20Transitions%EF%BD%9CMaster%20Pull-Down%20Close,%20Pull-Up%20Present%20&%20Full-Page%20Swipe%20Back%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-development%2Fen%2Fios-uiviewcontroller-transitions-master-pull-down-close-pull-up-present-full-page-swipe-back-14cee137c565%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-development%2Fen%2Fios-uiviewcontroller-transitions-master-pull-down-close-pull-up-present-full-page-swipe-back-14cee137c565%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/en/apple-watch-stainless-steel-milanese-loop-unboxing-premium-44mm-graphite-band-review-c0f99f987d9c/">Apple Watch Stainless Steel Milanese Loop Unboxing｜Premium 44mm Graphite Band Review</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/apple-watch-%E7%B1%B3%E8%98%AD%E9%8C%B6%E5%B8%B6%E9%96%8B%E7%AE%B1-%E5%8E%9F%E5%BB%A0%E4%B8%8D%E9%8F%BD%E9%8B%BC%E7%9F%B3%E5%A2%A8%E8%89%B2%E5%84%AA%E7%BC%BA%E9%BB%9E%E5%85%A8%E8%A7%A3%E6%9E%90-c0f99f987d9c/">Apple Watch 原廠不鏽鋼米蘭錶帶開箱</a><li class="text-truncate lh-lg"> <a href="/posts/travel-journals/en/busan-travel-guide-8-day-itinerary-with-visit-busan-pass-for-seamless-exploration-8ace34a1a3d8/">Busan Travel Guide｜8-Day Itinerary with VISIT BUSAN PASS for Seamless Exploration</a><li class="text-truncate lh-lg"> <a href="/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/%E9%87%9C%E5%B1%B1%E8%87%AA%E7%94%B1%E8%A1%8C%E6%94%BB%E7%95%A5-8%E5%A4%A97%E5%A4%9C%E5%BF%85%E5%8E%BB%E6%99%AF%E9%BB%9E-%E7%BE%8E%E9%A3%9F%E8%88%87%E4%BA%A4%E9%80%9A%E5%85%A8%E8%A7%A3%E6%9E%90-%E9%87%9C%E5%B1%B1%E9%80%9A%E8%A1%8C%E8%AD%89%E7%9C%81%E9%8C%A2%E7%A7%98%E8%A8%A3-8ace34a1a3d8/">遊記 2025 韓國釜山 8 天 7 夜自由行</a><li class="text-truncate lh-lg"> <a href="/posts/travel-journals/en/nagoya-one-day-quick-trip-peach-aviation-flight-experience-and-travel-tips-7b8a0563c157/">Nagoya One-Day Quick Trip｜Peach Aviation Flight Experience and Travel Tips</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">iOS App Development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">iOS</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios app development</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">Swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">章節 (Chapters)🔖</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-development/en/ios-devicecheck-implement-one-time-offers-and-trials-seamlessly-with-swift-c5e7e580c341/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1556551801" data-df="ll" > Apr 29, 2019 </time><h4 class="pt-0 my-2">iOS DeviceCheck｜Implement One-Time Offers and Trials Seamlessly with Swift</h4><div class="text-muted"><p>iOS developers struggling with secure one-time offers or trials can leverage DeviceCheck to track user eligibility across devices, preventing abuse and ensuring fair usage. Learn how to implement t...</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-development/en/swift-native-type-extensions-elegant-namespace-implementation-for-cleaner-code-a8925ad9ed01/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1735740152" data-df="ll" > Jan 1, 2025 </time><h4 class="pt-0 my-2">Swift Native Type Extensions｜Elegant Namespace Implementation for Cleaner Code</h4><div class="text-muted"><p>Discover how to create elegant native type extensions in Swift by encapsulating methods with namespace functionality, improving code organization and maintainability for iOS developers.</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-development/en/ios-18-nsattributedstring-attributes-range-merging-equatable-behavior-change-explained-9e43897d99fc/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1726837422" data-df="ll" > Sep 20, 2024 </time><h4 class="pt-0 my-2">iOS 18 NSAttributedString Attributes Range Merging｜Equatable Behavior Change Explained</h4><div class="text-muted"><p>Discover how iOS 18 updates NSAttributedString attributes range merging by referencing Equatable, resolving inconsistencies and improving attribute handling for developers.</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-dev/ios-deferred-deep-link-%E5%BB%B6%E9%81%B2%E6%B7%B1%E5%BA%A6%E9%80%A3%E7%B5%90%E5%AF%A6%E4%BD%9C-swift-%E5%AE%8C%E6%95%B4%E6%B5%81%E7%A8%8B%E8%88%87%E6%8A%80%E5%B7%A7%E8%A7%A3%E6%9E%90-b08ef940c196/" class="btn btn-outline-primary" aria-label="Older" ><p>iOS Deferred Deep Link 延遲深度連結實作｜Swift 完整流程與技巧解析</p></a> <a href="/posts/zrealm-dev/ios-uiviewcontroller-%E8%BD%89%E5%A0%B4%E5%8B%95%E7%95%AB-%E4%B8%8B%E6%8B%89%E9%97%9C%E9%96%89-%E4%B8%8A%E6%8B%89%E6%BC%B8%E5%85%A5%E8%88%87%E5%85%A8%E9%A0%81%E5%8F%B3%E6%BB%91%E8%BF%94%E5%9B%9E%E5%AF%A6%E4%BD%9C%E6%8A%80%E5%B7%A7-14cee137c565/" class="btn btn-outline-primary" aria-label="Newer" ><p>iOS UIViewController 轉場二三事</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a><br/>Last updated: 2025-08-20 23:47:22 +08:00</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">iOS App Development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">iOS</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios app development</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">Swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
