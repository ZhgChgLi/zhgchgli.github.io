<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="iOS Vision Framework｜Explore Swift API Enhancements from WWDC 24 Session" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="Discover how iOS 18’s Vision framework Swift APIs simplify image analysis and improve development efficiency. Learn key updates and practical usage to boost your app’s computer vision capabilities seamlessly." /><meta property="og:description" content="Discover how iOS 18’s Vision framework Swift APIs simplify image analysis and improve development efficiency. Learn key updates and practical usage to boost your app’s computer vision capabilities seamlessly." /><link rel="canonical" href="https://zhgchg.li/posts/kkday-tech-blog/en/ios-vision-framework-explore-swift-api-enhancements-from-wwdc-24-session-755509180ca8/" /><meta property="og:url" content="https://zhgchg.li/posts/kkday-tech-blog/en/ios-vision-framework-explore-swift-api-enhancements-from-wwdc-24-session-755509180ca8/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/755509180ca8/1*NqN-_MAE4tt11n6MnUQWxQ.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-08-13T16:10:37+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/755509180ca8/1*NqN-_MAE4tt11n6MnUQWxQ.webp" /><meta property="twitter:title" content="iOS Vision Framework｜Explore Swift API Enhancements from WWDC 24 Session" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://medium.com/@zhgchgli/"},"dateModified":"2024-08-14T20:07:49+08:00","datePublished":"2024-08-13T16:10:37+08:00","description":"Discover how iOS 18’s Vision framework Swift APIs simplify image analysis and improve development efficiency. Learn key updates and practical usage to boost your app’s computer vision capabilities seamlessly.","headline":"iOS Vision Framework｜Explore Swift API Enhancements from WWDC 24 Session","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9Ijg3NSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg==","url":"https://zhgchg.li/assets/755509180ca8/1*NqN-_MAE4tt11n6MnUQWxQ.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/kkday-tech-blog/en/ios-vision-framework-explore-swift-api-enhancements-from-wwdc-24-session-755509180ca8/"},"url":"https://zhgchg.li/posts/kkday-tech-blog/en/ios-vision-framework-explore-swift-api-enhancements-from-wwdc-24-session-755509180ca8/"}</script><title>iOS Vision Framework｜Explore Swift API Enhancements from WWDC 24 Session | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0"> <a href="https://medium.com/@zhgchgli" target="_blank" style="display: block;text-align: center;font-style: normal;/* text-decoration: underline; */font-size: 1.2em;color: var(--heading-color);">1K+ Followers on Medium</a> An iOS, web, and automation developer from Taiwan 🇹🇼 who also loves sharing, traveling, and writing.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>iOS Vision Framework｜Explore Swift API Enhancements from WWDC 24 Session</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>iOS Vision Framework｜Explore Swift API Enhancements from WWDC 24 Session</h1><p class="post-desc fw-light mb-4">Discover how iOS 18's Vision framework Swift APIs simplify image analysis and improve development efficiency. Learn key updates and practical usage to boost your app's computer vision capabilities seamlessly.</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1723536637" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Aug 13, 2024 </time> </span> <span> Updated <time data-ts="1723637269" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Aug 14, 2024 </time> </span><div class="mt-3 mb-3"> <a href="/assets/755509180ca8/1*NqN-_MAE4tt11n6MnUQWxQ.webp" class="popup img-link preview-img blur"><img data-src="/assets/755509180ca8/1*NqN-_MAE4tt11n6MnUQWxQ.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9Ijg3NSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://medium.com/@zhgchgli/">ZhgChgLi</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="4646 words" > <em>25 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">iOS Vision Framework｜Explore Swift API Enhancements from WWDC 24 Session</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">章節 (Chapters)🔖</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">iOS Vision Framework｜Explore Swift API Enhancements from WWDC 24 Session</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic> <script async="" src="https://widgetic.com/sdk/sdk.js"></script><blockquote class="prompt-info"><p>The following content is translated by OpenAI, <a href="/posts/755509180ca8/"><strong>Click here</strong></a> to view the original Chinese version. <a href="/posts/755509180ca8/"><strong>點此查看中文版</strong></a></p></blockquote><hr /><h3 id="ios-vision-framework-x-wwdc-24-discover-swift-enhancements-in-the-vision-framework-session"><span class="me-2">iOS Vision framework x WWDC 24 Discover Swift enhancements in the Vision framework Session</span><a href="#ios-vision-framework-x-wwdc-24-discover-swift-enhancements-in-the-vision-framework-session" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Vision framework Feature Review &amp; iOS 18 New Swift API Hands-on</p><p><a href="/assets/755509180ca8/1*NqN-_MAE4tt11n6MnUQWxQ.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*NqN-_MAE4tt11n6MnUQWxQ.webp" alt="Photo by [BoliviaInteligente](https://unsplash.com/@boliviainteligente?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9Ijg3NSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Photo by <a href="https://unsplash.com/@boliviainteligente?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash" target="_blank">BoliviaInteligente</a></p><h4 id="topic"><span class="me-2">Topic</span><a href="#topic" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/755509180ca8/1*ebqm2jzCK1GSrDDY0XtrUA.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*ebqm2jzCK1GSrDDY0XtrUA.webp" alt="The relationship with Vision Pro is like that between a hot dog and a dog—completely unrelated." data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MDAiIGhlaWdodD0iNTYwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>The relationship with Vision Pro is like that between a hot dog and a dog—completely unrelated.</p><h3 id="vision-framework"><span class="me-2">Vision framework</span><a href="#vision-framework" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Vision framework is Apple’s integrated machine learning image recognition framework, allowing developers to easily and quickly implement common image recognition features. The Vision framework was first introduced in iOS 11.0+ (2017/iPhone 8) and has been continuously improved and optimized. It has enhanced integration with Swift Concurrency to boost performance, and starting from iOS 18.0, it offers a new Swift Vision framework API to fully leverage Swift Concurrency.</p><p><strong>Features of the Vision Framework</strong></p><ul><li><p>Built-in Numerous Image Recognition and Motion Tracking Methods (A Total of 31 Types up to iOS 18)</p><li><p>On-Device uses only the phone’s chip for computation. The recognition process does not rely on cloud services, making it fast and secure.</p><li><p>API is simple and easy to use</p><li><p>Apple platforms all support iOS 11.0+, iPadOS 11.0+, Mac Catalyst 13.0+, macOS 10.13+, tvOS 11.0+, visionOS 1.0+</p><li><p>Published for many years (2017~present) and continuously updated</p><li><p>Integrating Swift Language Features to Enhance Computational Performance</p></ul><blockquote><p><strong><em>Played around 6 years ago: <a href="/posts/zrealm-development/en/vision-face-detection-swift-app-auto-crop-profile-pictures-with-precision-9a9aa892f9a9/">Vision Introduction — APP Avatar Upload Automatic Face Recognition and Cropping (Swift)</a></em></strong></p></blockquote><blockquote><p><em>This time, paired with <a href="https://developer.apple.com/videos/play/wwdc2024/10163/" target="_blank">WWDC 24 Discover Swift enhancements in the Vision framework Session</a>, I reviewed and explored again with the new Swift features.</em></p></blockquote><h4 id="coreml"><span class="me-2">CoreML</span><a href="#coreml" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Apple also has another framework called <a href="https://developer.apple.com/documentation/coreml" target="_blank">CoreML</a>, which is an on-device chip-based machine learning framework. It allows you to train your own models for recognizing objects or documents and embed the models directly into your app. Interested users can try it out. (e.g. <a href="/posts/zrealm-development/en/coreml-2-0-automate-article-classification-with-custom-trained-machine-learning-models-793bf2cdda0f/">real-time article classification</a>, real-time <a href="https://apps.apple.com/tw/app/%E7%86%8A%E7%8C%AB%E5%90%83%E7%9F%AD%E4%BF%A1-%E5%9E%83%E5%9C%BE%E7%9F%AD%E4%BF%A1%E8%BF%87%E6%BB%A4/id1319191852" target="_blank">spam detection</a> …)</p><h4 id="ps"><span class="me-2">p.s.</span><a href="#ps" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="https://developer.apple.com/documentation/vision/" target="_blank"><strong>Vision</strong></a> <strong>v.s. <a href="https://developer.apple.com/documentation/visionkit" target="_blank">VisionKit</a>:</strong></p><blockquote><p><a href="https://developer.apple.com/documentation/vision/" target="*blank"><strong><em>Vision</em></strong></a> <em>: Mainly used for image analysis tasks like face recognition, barcode detection, and text recognition. It offers powerful APIs to process and analyze visual content in still images or videos.</em></p></blockquote><blockquote><p><a href="https://developer.apple.com/documentation/visionkit" target="*blank"><strong><em>VisionKit</em></strong></a> <em>: Specifically designed for handling document scanning tasks. It provides a scanner view controller that can be used to scan documents and generate high-quality PDFs or images.</em></p></blockquote><p>Vision framework cannot run on the simulator for M1 models and can only be tested on real devices; running in the simulator environment throws a <code class="language-plaintext highlighter-rouge">Could not create Espresso context</code> error. Checking the <a href="https://forums.developer.apple.com/forums/thread/675806" target="_blank">official forum discussion, no solution was found</a>.</p><blockquote><p><em>Since I do not have a physical iOS 18 device for testing, all the results in this article are based on the old (pre-iOS 18) methods; <strong>please leave a comment if there are errors with the new methods.</strong></em></p></blockquote><h3 id="wwdc-2024--discover-swift-enhancements-in-the-vision-framework"><span class="me-2">WWDC 2024 — Discover Swift enhancements in the Vision framework</span><a href="#wwdc-2024--discover-swift-enhancements-in-the-vision-framework" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/755509180ca8/1*8N5GtY1uqxP-4iAAAticOA.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*8N5GtY1uqxP-4iAAAticOA.webp" alt="[Discover Swift enhancements in the Vision framework](https://developer.apple.com/videos/play/wwdc2024/10163/?time=45){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MTEiIGhlaWdodD0iNDUyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="https://developer.apple.com/videos/play/wwdc2024/10163/?time=45" target="_blank">Discover Swift enhancements in the Vision framework</a></p><blockquote><p><em>This article summarizes WWDC 24 — <a href="https://developer.apple.com/videos/play/wwdc2024/10163/?time=45" target="_blank">Discover Swift enhancements in the Vision framework</a> session, including some personal experimentation notes.</em></p></blockquote><h3 id="introduction--vision-framework-features"><span class="me-2">Introduction — Vision framework Features</span><a href="#introduction--vision-framework-features" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="facial-recognition-and-contour-detection"><span class="me-2">Facial Recognition and Contour Detection</span><a href="#facial-recognition-and-contour-detection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/755509180ca8/1*RNGfE_EeaQhiKAPdJeFYQw.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*RNGfE_EeaQhiKAPdJeFYQw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MjYiIGhlaWdodD0iNDgyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/755509180ca8/1*iMdzeLm2aWjATVV6_Kvrjg.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*iMdzeLm2aWjATVV6_Kvrjg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MDciIGhlaWdodD0iNDQ4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><h4 id="image-text-recognition"><span class="me-2">Image Text Recognition</span><a href="#image-text-recognition" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>As of iOS 18, it supports 18 languages.</p><p><a href="/assets/755509180ca8/1*kU_OYn5w368h-ahDYU4lDw.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*kU_OYn5w368h-ahDYU4lDw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NTciIGhlaWdodD0iMzk1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="c1">// List of supported languages</span>
<span class="k">if</span> <span class="k">#available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">18.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">print</span><span class="p">(</span><span class="kt">RecognizeTextRequest</span><span class="p">()</span><span class="o">.</span><span class="n">supportedRecognitionLanguages</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="s">"</span><span class="se">\(</span><span class="nv">$0</span><span class="o">.</span><span class="n">languageCode</span><span class="o">!</span><span class="se">)</span><span class="s">-</span><span class="se">\(</span><span class="p">(</span><span class="nv">$0</span><span class="o">.</span><span class="n">region</span><span class="p">?</span><span class="o">.</span><span class="n">identifier</span> <span class="p">??</span> <span class="nv">$0</span><span class="o">.</span><span class="n">script</span><span class="p">?</span><span class="o">.</span><span class="n">identifier</span><span class="p">)</span><span class="o">!</span><span class="se">)</span><span class="s">"</span> <span class="p">})</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="nf">print</span><span class="p">(</span><span class="k">try!</span> <span class="kt">VNRecognizeTextRequest</span><span class="p">()</span><span class="o">.</span><span class="nf">supportedRecognitionLanguages</span><span class="p">())</span>
<span class="p">}</span>

<span class="c1">// The actual available recognition languages are based on this.</span>
<span class="c1">// Tested on iOS 18, the output is:</span>
<span class="c1">// ["en-US", "fr-FR", "it-IT", "de-DE", "es-ES", "pt-BR", "zh-Hans", "zh-Hant", "yue-Hans", "yue-Hant", "ko-KR", "ja-JP", "ru-RU", "uk-UA", "th-TH", "vi-VT", "ar-SA", "ars-SA"]</span>
<span class="c1">// Swedish mentioned at WWDC was not seen, unsure if it's not released yet or related to device region/language settings</span>
</pre></table></code></div></div><h4 id="dynamic-motion-capture"><span class="me-2">Dynamic Motion Capture</span><a href="#dynamic-motion-capture" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/755509180ca8/1*6TfyCcszdD1NdId0bdM16Q.gif" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*6TfyCcszdD1NdId0bdM16Q.gif" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3OTQiIGhlaWdodD0iNDEwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/755509180ca8/1*8y_XXdH36uKpfP0p6BCJQA.gif" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*8y_XXdH36uKpfP0p6BCJQA.gif" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NTgiIGhlaWdodD0iNDIwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li><p>Can achieve dynamic tracking of people and objects</p><li><p>Gesture capture enables air signature functionality</p></ul><h4 id="whats-new-in-vision-ios-18-image-rating-feature-quality-memorability"><span class="me-2">What’s new in Vision? (iOS 18)— Image rating feature (quality, memorability)</span><a href="#whats-new-in-vision-ios-18-image-rating-feature-quality-memorability" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><p>Can calculate a score for the input image, making it easy to filter high-quality photos.</p><li><p>The scoring method includes multiple dimensions, not only image quality but also lighting, angle, subject, <strong>whether it evokes memorable points</strong>, and more.</p></ul><p><a href="/assets/755509180ca8/1*XwjeaHcB6arxJhIR7cFsWg.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*XwjeaHcB6arxJhIR7cFsWg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MTIiIGhlaWdodD0iNDQ5Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/755509180ca8/1*YdhZlZBlTaIZd4nLxhBtaQ.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*YdhZlZBlTaIZd4nLxhBtaQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MDgiIGhlaWdodD0iNDUwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/755509180ca8/1*IhMDFdk6DWwTv1qIG0Gi0Q.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*IhMDFdk6DWwTv1qIG0Gi0Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MDkiIGhlaWdodD0iNDQxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>WWDC provided the above three images for illustration (under the same image quality), which are:</p><ul><li><p>High-Quality Images: Composition, Lighting, and Memorable Elements</p><li><p>Low-Quality Images: No clear subject, appear to be taken casually or accidentally</p><li><p>Image Material: Technically well taken but lacks memorable elements, resembling stock photos used for material libraries.</p></ul><p><strong>iOS ≥ 18 New API: <a href="https://developer.apple.com/documentation/vision/calculateimageaestheticsscoresrequest" target="_blank">CalculateImageAestheticsScoresRequest</a></strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">CalculateImageAestheticsScoresRequest</span><span class="p">()</span>
<span class="k">let</span> <span class="nv">result</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"https://zhgchg.li/assets/cb65fd5ab770/1*yL3vI1ADzwlovctW5WQgJw.jpeg"</span><span class="p">)</span><span class="o">!</span><span class="p">)</span>

<span class="c1">// Photo score</span>
<span class="nf">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">overallScore</span><span class="p">)</span>

<span class="c1">// Whether it is classified as a utility image</span>
<span class="nf">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">isUtility</span><span class="p">)</span>
</pre></table></code></div></div><h4 id="whats-new-in-vision-ios-18--simultaneous-body-and-hand-gesture-detection"><span class="me-2">What’s new in Vision? (iOS 18) — Simultaneous Body and Hand Gesture Detection</span><a href="#whats-new-in-vision-ios-18--simultaneous-body-and-hand-gesture-detection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/755509180ca8/1*A9320aRV-jdccgiXrmSrJw.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*A9320aRV-jdccgiXrmSrJw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MDAiIGhlaWdodD0iMzM0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Previously, only individual detection of body pose and hand pose was possible. This update allows developers to detect both body pose and hand pose simultaneously, combining them into a single request and result, making it easier to develop more application features.</p><p><strong>iOS ≥ 18 New API: <a href="https://developer.apple.com/documentation/vision/detecthumanbodyposerequest" target="_blank">DetectHumanBodyPoseRequest</a></strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="k">var</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">DetectHumanBodyPoseRequest</span><span class="p">()</span>
<span class="c1">// Also detect hand poses</span>
<span class="n">request</span><span class="o">.</span><span class="n">detectsHands</span> <span class="o">=</span> <span class="kc">true</span>

<span class="k">guard</span> <span class="k">let</span> <span class="nv">bodyPose</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">first</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>

<span class="c1">// Body pose joints</span>
<span class="k">let</span> <span class="nv">bodyJoints</span> <span class="o">=</span> <span class="n">bodyPose</span><span class="o">.</span><span class="nf">allJoints</span><span class="p">()</span>
<span class="c1">// Left hand pose joints</span>
<span class="k">let</span> <span class="nv">leftHandJoints</span> <span class="o">=</span> <span class="n">bodyPose</span><span class="o">.</span><span class="n">leftHand</span><span class="o">.</span><span class="nf">allJoints</span><span class="p">()</span>
<span class="c1">// Right hand pose joints</span>
<span class="k">let</span> <span class="nv">rightHandJoints</span> <span class="o">=</span> <span class="n">bodyPose</span><span class="o">.</span><span class="n">rightHand</span><span class="o">.</span><span class="nf">allJoints</span><span class="p">()</span>
</pre></table></code></div></div><h3 id="new-vision-api"><span class="me-2">New Vision API</span><a href="#new-vision-api" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Apple has provided a new Swift Vision API wrapper for developers in this update. Besides supporting the original features, it mainly enhances Swift 6 and Swift Concurrency capabilities, offering better performance and a more Swift-friendly API usage.</p><h3 id="get-started-with-vision"><span class="me-2">Get started with Vision</span><a href="#get-started-with-vision" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/755509180ca8/1*mv9g5jmqrS6YScxoGYJemQ.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*mv9g5jmqrS6YScxoGYJemQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NDAiIGhlaWdodD0iNDE5Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/755509180ca8/1*iidNN7nKHoskh_tcjfuHKQ.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*iidNN7nKHoskh_tcjfuHKQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MzgiIGhlaWdodD0iNDAxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Here, the speaker reintroduced the basic usage of the Vision framework. Apple has already packaged <a href="https://developer.apple.com/documentation/vision/visionrequest" target="_blank">31 types</a> (as of iOS 18) of common image recognition requests called “Request” and their corresponding returned “Observation” objects.</p><ol><li><p><strong>Request:</strong> DetectFaceRectanglesRequest Face region detection request<br /> <strong>Result:</strong> FaceObservation<br /> The previous article “<a href="/posts/zrealm-development/en/vision-face-detection-swift-app-auto-crop-profile-pictures-with-precision-9a9aa892f9a9/">Vision Introduction — APP Profile Picture Upload Automatic Face Crop Recognition (Swift)</a>” used this pair of requests.</p><li><p><strong>Request:</strong> RecognizeTextRequest text recognition request<br /> <strong>Result:</strong> RecognizedTextObservation</p><li><p><strong>Request:</strong> GenerateObjectnessBasedSaliencyImageRequest Main Object Recognition Request<br /> <strong>Result:</strong> SaliencyImageObservation</p></ol><h3 id="all-31-types-of-requests-request"><span class="me-2">All 31 Types of Requests: Request:</span><a href="#all-31-types-of-requests-request" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="https://developer.apple.com/documentation/vision/visionrequest" target="_blank">VisionRequest</a>.</p><p>\| Request Purpose \| Observation Description \| \|———————————————–\|——————————————————————\| \| CalculateImageAestheticsScoresRequest<br />Calculate the aesthetic score of an image. \| AestheticsObservation<br />Returns the aesthetic scores of the image, such as composition and color. \| \| ClassifyImageRequest<br />Classify image content. \| ClassificationObservation<br />Returns classification labels and confidence for objects or scenes in the image. \| \| CoreMLRequest<br />Analyze image using a Core ML model. \| CoreMLFeatureValueObservation<br />Generates observations based on the Core ML model output. \| \| DetectAnimalBodyPoseRequest<br />Detect animal poses in the image. \| RecognizedPointsObservation<br />Returns the animal’s skeleton points and their positions. \| \| DetectBarcodesRequest<br />Detect barcodes in the image. \| BarcodeObservation<br />Returns barcode data and type (e.g., QR code). \| \| DetectContoursRequest<br />Detect contours in the image. \| ContoursObservation<br />Returns detected contour lines in the image. \| \| DetectDocumentSegmentationRequest<br />Detect and segment documents in the image. \| RectangleObservation<br />Returns the rectangular boundary of the document. \| \| DetectFaceCaptureQualityRequest<br />Evaluate face capture quality. \| FaceObservation<br />Returns quality assessment scores of the face image. \| \| DetectFaceLandmarksRequest<br />Detect facial landmarks. \| FaceObservation<br />Returns detailed positions of facial landmarks (e.g., eyes, nose). \| \| DetectFaceRectanglesRequest<br />Detect faces in the image. \| FaceObservation<br />Returns bounding boxes of faces. \| \| DetectHorizonRequest<br />Detect horizon in the image. \| HorizonObservation<br />Returns the angle and position of the horizon. \| \| DetectHumanBodyPose3DRequest<br />Detect 3D human body poses in the image. \| RecognizedPointsObservation<br />Returns 3D human skeleton points and their spatial coordinates. \| \| DetectHumanBodyPoseRequest<br />Detect human body poses in the image. \| RecognizedPointsObservation<br />Returns human skeleton points and their coordinates. \| \| DetectHumanHandPoseRequest<br />Detect hand poses in the image. \| RecognizedPointsObservation<br />Returns hand skeleton points and their positions. \| \| DetectHumanRectanglesRequest<br />Detect humans in the image. \| HumanObservation<br />Returns bounding boxes of humans. \| \| DetectRectanglesRequest<br />Detect rectangles in the image. \| RectangleObservation<br />Returns coordinates of the four vertices of rectangles. \| \| DetectTextRectanglesRequest<br />Detect text regions in the image. \| TextObservation<br />Returns the position and bounding boxes of text areas. \| \| DetectTrajectoriesRequest<br />Detect and analyze object motion trajectories. \| TrajectoryObservation<br />Returns trajectory points and their time sequences. \| \| GenerateAttentionBasedSaliencyImageRequest<br />Generate attention-based saliency images. \| SaliencyImageObservation<br />Returns saliency maps of the most attractive areas in the image. \| \| GenerateForegroundInstanceMaskRequest<br />Generate foreground instance mask images. \| InstanceMaskObservation<br />Returns masks of foreground objects. \| \| GenerateImageFeaturePrintRequest<br />Generate image feature prints for comparison. \| FeaturePrintObservation<br />Returns feature print data of the image for similarity comparison. \| \| GenerateObjectnessBasedSaliencyImageRequest<br />Generate objectness-based saliency images. \| SaliencyImageObservation<br />Returns saliency maps of objectness areas. \| \| GeneratePersonInstanceMaskRequest<br />Generate person instance mask images. \| InstanceMaskObservation<br />Returns masks of person instances. \| \| GeneratePersonSegmentationRequest<br />Generate person segmentation images. \| SegmentationObservation<br />Returns binary masks for person segmentation. \| \| RecognizeAnimalsRequest<br />Detect and recognize animals in the image. \| RecognizedObjectObservation<br />Returns animal types and confidence levels. \| \| RecognizeTextRequest<br />Detect and recognize text in the image. \| RecognizedTextObservation<br />Returns detected text content and its region location. \| \| TrackHomographicImageRegistrationRequest<br />Track homographic image registration. \| ImageAlignmentObservation<br />Returns homography transformation matrices between images for registration. \| \| TrackObjectRequest<br />Track objects in the image. \| DetectedObjectObservation<br />Returns object positions and velocity information in the image. \| \| TrackOpticalFlowRequest<br />Track optical flow in the image. \| OpticalFlowObservation<br />Returns optical flow vector fields describing pixel movements. \| \| TrackRectangleRequest<br />Track rectangles in the image. \| RectangleObservation<br />Returns position, size, and rotation angle of rectangles in the image. \| \| TrackTranslationalImageRegistrationRequest<br />Track translational image registration. \| ImageAlignmentObservation<br />Returns translation transformation matrices between images for registration. \|</p><ul><li>Adding VN in front indicates the old API usage (versions before iOS 18).</ul><p>The speaker mentioned several commonly used Requests, as follows.</p><h4 id="classifyimagerequest"><span class="me-2">ClassifyImageRequest</span><a href="#classifyimagerequest" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Identify the input image to obtain label categories and confidence levels.</p><p><a href="/assets/755509180ca8/1*8NSQEjxGejujKLbXcILmxQ.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*8NSQEjxGejujKLbXcILmxQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjE4NjciPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p><a href="/assets/755509180ca8/1*f1rNoOIQbE33M9F9NmoTXg.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*f1rNoOIQbE33M9F9NmoTXg.webp" alt="[Travelogue] 2024 Second Visit to Kyushu 9-Day Free Travel, Entering via Busan→Hakata Cruise" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9Ijc3NyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>[Travelogue] 2024 Second Visit to Kyushu: 9-Day Independent Trip, Entering via Busan → Hakata Cruise</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre><span class="k">if</span> <span class="k">#available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">18.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// New API using Swift features</span>
    <span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">ClassifyImageRequest</span><span class="p">()</span>
    <span class="kt">Task</span> <span class="p">{</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"https://zhgchg.li/assets/cb65fd5ab770/1*yL3vI1ADzwlovctW5WQgJw.jpeg"</span><span class="p">)</span><span class="o">!</span><span class="p">)</span>
            <span class="n">observations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
                <span class="n">observation</span> <span class="k">in</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"</span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">identifier</span><span class="se">)</span><span class="s">: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">confidence</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// Old approach</span>
    <span class="k">let</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kt">VNRequestCompletionHandler</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">request</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="n">error</span><span class="p">)</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">results</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">VNClassificationObservation</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="n">observations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
            <span class="n">observation</span> <span class="k">in</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"</span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">identifier</span><span class="se">)</span><span class="s">: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">confidence</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">VNClassifyImageRequest</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="n">completionHandler</span><span class="p">)</span>
    <span class="kt">DispatchQueue</span><span class="o">.</span><span class="nf">global</span><span class="p">()</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">handler</span> <span class="o">=</span> <span class="kt">VNImageRequestHandler</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"https://zhgchg.li/assets/cb65fd5ab770/1*3_jdrLurFuUfNdW4BJaRww.jpeg"</span><span class="p">)</span><span class="o">!</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[:])</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">try</span> <span class="n">handler</span><span class="o">.</span><span class="nf">perform</span><span class="p">([</span><span class="n">request</span><span class="p">])</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>Analysis Results:</strong></p><div class="language-r highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="w"> </span><span class="err">•</span><span class="w"> </span><span class="n">outdoor</span><span class="o">:</span><span class="w"> </span><span class="m">0.75392926</span><span class="w">
 </span><span class="err">•</span><span class="w"> </span><span class="n">sky</span><span class="o">:</span><span class="w"> </span><span class="m">0.75392926</span><span class="w">
 </span><span class="err">•</span><span class="w"> </span><span class="n">blue_sky</span><span class="o">:</span><span class="w"> </span><span class="m">0.7519531</span><span class="w">
 </span><span class="err">•</span><span class="w"> </span><span class="n">machine</span><span class="o">:</span><span class="w"> </span><span class="m">0.6958008</span><span class="w">
 </span><span class="err">•</span><span class="w"> </span><span class="n">cloudy</span><span class="o">:</span><span class="w"> </span><span class="m">0.26538086</span><span class="w">
 </span><span class="err">•</span><span class="w"> </span><span class="n">structure</span><span class="o">:</span><span class="w"> </span><span class="m">0.15728651</span><span class="w">
 </span><span class="err">•</span><span class="w"> </span><span class="n">sign</span><span class="o">:</span><span class="w"> </span><span class="m">0.14224191</span><span class="w">
 </span><span class="err">•</span><span class="w"> </span><span class="n">fence</span><span class="o">:</span><span class="w"> </span><span class="m">0.118652344</span><span class="w">
 </span><span class="err">•</span><span class="w"> </span><span class="n">banner</span><span class="o">:</span><span class="w"> </span><span class="m">0.0793457</span><span class="w">
 </span><span class="err">•</span><span class="w"> </span><span class="n">material</span><span class="o">:</span><span class="w"> </span><span class="m">0.075975396</span><span class="w">
 </span><span class="err">•</span><span class="w"> </span><span class="n">plant</span><span class="o">:</span><span class="w"> </span><span class="m">0.054406323</span><span class="w">
 </span><span class="err">•</span><span class="w"> </span><span class="n">foliage</span><span class="o">:</span><span class="w"> </span><span class="m">0.05029297</span><span class="w">
 </span><span class="err">•</span><span class="w"> </span><span class="n">light</span><span class="o">:</span><span class="w"> </span><span class="m">0.048126098</span><span class="w">
 </span><span class="err">•</span><span class="w"> </span><span class="n">lamppost</span><span class="o">:</span><span class="w"> </span><span class="m">0.048095703</span><span class="w">
 </span><span class="err">•</span><span class="w"> </span><span class="n">billboards</span><span class="o">:</span><span class="w"> </span><span class="m">0.040039062</span><span class="w">
 </span><span class="err">•</span><span class="w"> </span><span class="n">art</span><span class="o">:</span><span class="w"> </span><span class="m">0.03977703</span><span class="w">
 </span><span class="err">•</span><span class="w"> </span><span class="n">branch</span><span class="o">:</span><span class="w"> </span><span class="m">0.03930664</span><span class="w">
 </span><span class="err">•</span><span class="w"> </span><span class="n">decoration</span><span class="o">:</span><span class="w"> </span><span class="m">0.036868922</span><span class="w">
 </span><span class="err">•</span><span class="w"> </span><span class="n">flag</span><span class="o">:</span><span class="w"> </span><span class="m">0.036865234</span><span class="w">
</span><span class="n">....omitted</span><span class="w">
</span></pre></table></code></div></div><h4 id="recognizetextrequest"><span class="me-2">RecognizeTextRequest</span><a href="#recognizetextrequest" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Recognize the text content in images. (a.k.a. Image to Text)</p><p><a href="/assets/755509180ca8/1*XL40lLT774PfO60rCIfnxA.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*XL40lLT774PfO60rCIfnxA.webp" alt="[[Travelogue] Tokyo 5-Day Free Trip 2023](/posts/travel-journals/en/tokyo-5-day-travel-guide-top-tips-for-food-stay-transport-9da2c51fa4f2/)" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NjgiIGhlaWdodD0iMTAyNCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/posts/travel-journals/en/tokyo-5-day-travel-guide-top-tips-for-food-stay-transport-9da2c51fa4f2/">[Travelogue] 2023 Tokyo 5-Day Independent Trip</a></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre><td class="rouge-code"><pre><span class="k">if</span> <span class="k">#available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">18.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// New API using Swift features</span>
    <span class="k">var</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">RecognizeTextRequest</span><span class="p">()</span>
    <span class="n">request</span><span class="o">.</span><span class="n">recognitionLevel</span> <span class="o">=</span> <span class="o">.</span><span class="n">accurate</span>
    <span class="n">request</span><span class="o">.</span><span class="n">recognitionLanguages</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">identifier</span><span class="p">:</span> <span class="s">"ja-JP"</span><span class="p">),</span> <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">identifier</span><span class="p">:</span> <span class="s">"en-US"</span><span class="p">)]</span> <span class="c1">// Specify language code, e.g., Traditional Chinese</span>
    <span class="kt">Task</span> <span class="p">{</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"https://zhgchg.li/assets/9da2c51fa4f2/1*fBbNbDepYioQ-3-0XUkF6Q.jpeg"</span><span class="p">)</span><span class="o">!</span><span class="p">)</span>
            <span class="n">observations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
                <span class="n">observation</span> <span class="k">in</span>
                <span class="k">let</span> <span class="nv">topCandidate</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="nf">topCandidates</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
                <span class="nf">print</span><span class="p">(</span><span class="n">topCandidate</span><span class="p">?</span><span class="o">.</span><span class="n">string</span> <span class="p">??</span> <span class="s">"No text recognized"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// Old approach</span>
    <span class="k">let</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kt">VNRequestCompletionHandler</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">request</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="n">error</span><span class="p">)</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">results</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">VNRecognizedTextObservation</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="n">observations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
            <span class="n">observation</span> <span class="k">in</span>
            <span class="k">let</span> <span class="nv">topCandidate</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="nf">topCandidates</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
            <span class="nf">print</span><span class="p">(</span><span class="n">topCandidate</span><span class="p">?</span><span class="o">.</span><span class="n">string</span> <span class="p">??</span> <span class="s">"No text recognized"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">VNRecognizeTextRequest</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="n">completionHandler</span><span class="p">)</span>
    <span class="n">request</span><span class="o">.</span><span class="n">recognitionLevel</span> <span class="o">=</span> <span class="o">.</span><span class="n">accurate</span>
    <span class="n">request</span><span class="o">.</span><span class="n">recognitionLanguages</span> <span class="o">=</span> <span class="p">[</span><span class="s">"ja-JP"</span><span class="p">,</span> <span class="s">"en-US"</span><span class="p">]</span> <span class="c1">// Specify language code, e.g., Traditional Chinese</span>
    <span class="kt">DispatchQueue</span><span class="o">.</span><span class="nf">global</span><span class="p">()</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">handler</span> <span class="o">=</span> <span class="kt">VNImageRequestHandler</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"https://zhgchg.li/assets/9da2c51fa4f2/1*fBbNbDepYioQ-3-0XUkF6Q.jpeg"</span><span class="p">)</span><span class="o">!</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[:])</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">try</span> <span class="n">handler</span><span class="o">.</span><span class="nf">perform</span><span class="p">([</span><span class="n">request</span><span class="p">])</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>Analysis Results:</strong></p><div class="language-makefile highlighter-rouge"><div class="code-header"> <span data-label-text="Makefile"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="err">LE</span> <span class="err">LABO</span> <span class="err">Aoyama</span> <span class="err">Store</span>
<span class="nl">TEL</span><span class="o">:</span><span class="nf">03-6419-7167</span>
<span class="err">＊Thank</span> <span class="err">you</span> <span class="err">for</span> <span class="err">your</span> <span class="err">purchase*</span>
<span class="nl">No</span><span class="o">:</span> <span class="nf">21347</span>
<span class="nl">Date</span><span class="o">:</span> <span class="nf">2023/06/10 14:14:57</span>
<span class="nl">Staff</span><span class="o">:</span>
<span class="err">1690370</span>
<span class="nl">Register</span><span class="o">:</span> <span class="nf">008A 1</span>
<span class="err">Product</span> <span class="err">Name</span>
<span class="err">Price</span> <span class="err">Including</span> <span class="err">Tax</span> <span class="err">Quantity</span> <span class="err">Total</span> <span class="err">Including</span> <span class="err">Tax</span>
<span class="err">Kaiak</span> <span class="err">10</span> <span class="err">EDP</span> <span class="err">FB</span> <span class="err">15ML</span>
<span class="err">J1P7010000S</span>
<span class="err">16,800</span>
<span class="err">16,800</span>
<span class="err">Another</span> <span class="err">13</span> <span class="err">EDP</span> <span class="err">FB</span> <span class="err">15ML</span>
<span class="err">J1PJ010000S</span>
<span class="err">10,700</span>
<span class="err">10,700</span>
<span class="err">Lip</span> <span class="err">Balm</span> <span class="err">15ML</span>
<span class="err">JOWC010000S</span>
<span class="err">2,000</span>
<span class="err">1</span>
<span class="err">Total</span> <span class="err">Amount</span>
<span class="err">(Tax</span> <span class="err">Included)</span>
<span class="err">CARD</span>
<span class="err">2,000</span>
<span class="err">3</span> <span class="err">items</span> <span class="err">purchased</span>
<span class="err">29,500</span>
<span class="err">0</span>
<span class="err">29,500</span>
<span class="err">29,500</span>
</pre></table></code></div></div><h4 id="detectbarcodesrequest"><span class="me-2">DetectBarcodesRequest</span><a href="#detectbarcodesrequest" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Detect barcode and QR code data in images.</p><p><a href="/assets/755509180ca8/1*Z72y9rIwIKQCmnnuwsq0uQ.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*Z72y9rIwIKQCmnnuwsq0uQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjEwNTAiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p><a href="/assets/755509180ca8/1*s3V1UQRIqto-iG1e30PK7Q.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*s3V1UQRIqto-iG1e30PK7Q.webp" alt="Locally Recommended Tiger Balm Cooling Ointment in Thailand" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MDAiIGhlaWdodD0iMTIwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Locally Recommended White Flower Embrocation in Thailand</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">filePath</span> <span class="o">=</span> <span class="kt">Bundle</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">path</span><span class="p">(</span><span class="nv">forResource</span><span class="p">:</span> <span class="s">"IMG_6777"</span><span class="p">,</span> <span class="nv">ofType</span><span class="p">:</span> <span class="s">"png"</span><span class="p">)</span><span class="o">!</span> <span class="c1">// Local test image</span>
<span class="k">let</span> <span class="nv">fileURL</span> <span class="o">=</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">filePath</span><span class="p">:</span> <span class="n">filePath</span><span class="p">)</span>
<span class="k">if</span> <span class="k">#available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">18.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// New API using Swift features</span>
    <span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">DetectBarcodesRequest</span><span class="p">()</span>
    <span class="kt">Task</span> <span class="p">{</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="n">fileURL</span><span class="p">)</span>
            <span class="n">observations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
                <span class="n">observation</span> <span class="k">in</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Payload: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">payloadString</span> <span class="p">??</span> <span class="s">"No payload"</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Symbology: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">symbology</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// Old approach</span>
    <span class="k">let</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kt">VNRequestCompletionHandler</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">request</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="n">error</span><span class="p">)</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">results</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">VNBarcodeObservation</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="n">observations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
            <span class="n">observation</span> <span class="k">in</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Payload: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">payloadStringValue</span> <span class="p">??</span> <span class="s">"No payload"</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Symbology: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">symbology</span><span class="o">.</span><span class="n">rawValue</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">VNDetectBarcodesRequest</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="n">completionHandler</span><span class="p">)</span>
    <span class="kt">DispatchQueue</span><span class="o">.</span><span class="nf">global</span><span class="p">()</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">handler</span> <span class="o">=</span> <span class="kt">VNImageRequestHandler</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">fileURL</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[:])</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">try</span> <span class="n">handler</span><span class="o">.</span><span class="nf">perform</span><span class="p">([</span><span class="n">request</span><span class="p">])</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>Analysis Results:</strong></p><div class="language-makefile highlighter-rouge"><div class="code-header"> <span data-label-text="Makefile"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nl">Payload</span><span class="o">:</span> <span class="nf">8859126000911</span>
<span class="nl">Symbology</span><span class="o">:</span> <span class="nf">VNBarcodeSymbologyEAN13</span>
<span class="nl">Payload</span><span class="o">:</span> <span class="nf">https://lin.ee/hGynbVM</span>
<span class="nl">Symbology</span><span class="o">:</span> <span class="nf">VNBarcodeSymbologyQR</span>
<span class="nl">Payload</span><span class="o">:</span> <span class="nf">http://www.hongthaipanich.com/</span>
<span class="nl">Symbology</span><span class="o">:</span> <span class="nf">VNBarcodeSymbologyQR</span>
<span class="nl">Payload</span><span class="o">:</span> <span class="nf">https://www.facebook.com/qr?id=100063856061714</span>
<span class="nl">Symbology</span><span class="o">:</span> <span class="nf">VNBarcodeSymbologyQR</span>
</pre></table></code></div></div><h4 id="recognizeanimalsrequest"><span class="me-2">RecognizeAnimalsRequest</span><a href="#recognizeanimalsrequest" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Identify the animal in the image and its confidence level.</p><p><a href="/assets/755509180ca8/1*5zF3gA3WB1Q0-_cgt6mTCw.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*5zF3gA3WB1Q0-_cgt6mTCw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjEwNTAiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p><a href="/assets/755509180ca8/1*KZ7mdE8fobP-_oj7tJf_Ww.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*KZ7mdE8fobP-_oj7tJf_Ww.webp" alt="[meme Source](https://www.redbubble.com/i/canvas-print/Funny-AI-Woman-yelling-at-a-cat-meme-design-Machine-learning-by-omolog/43039298.5Y5V7){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NTAiIGhlaWdodD0iMTAwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="https://www.redbubble.com/i/canvas-print/Funny-AI-Woman-yelling-at-a-cat-meme-design-Machine-learning-by-omolog/43039298.5Y5V7" target="_blank">meme Source</a></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">filePath</span> <span class="o">=</span> <span class="kt">Bundle</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">path</span><span class="p">(</span><span class="nv">forResource</span><span class="p">:</span> <span class="s">"IMG_5026"</span><span class="p">,</span> <span class="nv">ofType</span><span class="p">:</span> <span class="s">"png"</span><span class="p">)</span><span class="o">!</span> <span class="c1">// Local test image</span>
<span class="k">let</span> <span class="nv">fileURL</span> <span class="o">=</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">filePath</span><span class="p">:</span> <span class="n">filePath</span><span class="p">)</span>
<span class="k">if</span> <span class="k">#available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">18.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// New API using Swift features</span>
    <span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">RecognizeAnimalsRequest</span><span class="p">()</span>
    <span class="kt">Task</span> <span class="p">{</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="n">fileURL</span><span class="p">)</span>
            <span class="n">observations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
                <span class="n">observation</span> <span class="k">in</span>
                <span class="k">let</span> <span class="nv">labels</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">labels</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
                    <span class="n">label</span> <span class="k">in</span>
                    <span class="nf">print</span><span class="p">(</span><span class="s">"Detected animal: </span><span class="se">\(</span><span class="n">label</span><span class="o">.</span><span class="n">identifier</span><span class="se">)</span><span class="s"> with confidence: </span><span class="se">\(</span><span class="n">label</span><span class="o">.</span><span class="n">confidence</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// Old approach</span>
    <span class="k">let</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kt">VNRequestCompletionHandler</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">request</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="n">error</span><span class="p">)</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">results</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">VNRecognizedObjectObservation</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="n">observations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
            <span class="n">observation</span> <span class="k">in</span>
            <span class="k">let</span> <span class="nv">labels</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">labels</span>
            <span class="n">labels</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
                <span class="n">label</span> <span class="k">in</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Detected animal: </span><span class="se">\(</span><span class="n">label</span><span class="o">.</span><span class="n">identifier</span><span class="se">)</span><span class="s"> with confidence: </span><span class="se">\(</span><span class="n">label</span><span class="o">.</span><span class="n">confidence</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">VNRecognizeAnimalsRequest</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="n">completionHandler</span><span class="p">)</span>
    <span class="kt">DispatchQueue</span><span class="o">.</span><span class="nf">global</span><span class="p">()</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">handler</span> <span class="o">=</span> <span class="kt">VNImageRequestHandler</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">fileURL</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[:])</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">try</span> <span class="n">handler</span><span class="o">.</span><span class="nf">perform</span><span class="p">([</span><span class="n">request</span><span class="p">])</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Analysis Results:</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Detected</span> <span class="n">animal</span><span class="p">:</span> <span class="n">Cat</span> <span class="k">with</span> <span class="n">confidence</span><span class="p">:</span> <span class="m">0.77245045</span>
</pre></table></code></div></div><h4 id="others"><span class="me-2">Others:</span><a href="#others" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><p>Detecting Human Figures in Images: DetectHumanRectanglesRequest</p><li><p>Detect poses of humans and animals (3D or 2D): DetectAnimalBodyPoseRequest, DetectHumanBodyPose3DRequest, DetectHumanBodyPoseRequest, DetectHumanHandPoseRequest</p><li><p>Detect and track the movement trajectory of objects (in different frames of videos or animations): DetectTrajectoriesRequest, TrackObjectRequest, TrackRectangleRequest</p></ul><h4 id="ios--18-update-highlight"><span class="me-2"><strong>iOS ≥ 18 Update Highlight:</strong></span><a href="#ios--18-update-highlight" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-rust highlighter-rouge"><div class="code-header"> <span data-label-text="Rust"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">VN</span><span class="o">*</span><span class="n">Request</span> <span class="k">-&gt;</span> <span class="o">*</span><span class="nf">Request</span> <span class="p">(</span><span class="n">e</span><span class="py">.g. VNDetectBarcodesRequest</span> <span class="k">-&gt;</span> <span class="n">DetectBarcodesRequest</span><span class="p">)</span>
<span class="n">VN</span><span class="o">*</span><span class="n">Observation</span> <span class="k">-&gt;</span> <span class="o">*</span><span class="nf">Observation</span> <span class="p">(</span><span class="n">e</span><span class="py">.g. VNRecognizedObjectObservation</span> <span class="k">-&gt;</span> <span class="n">RecognizedObjectObservation</span><span class="p">)</span>
<span class="n">VNRequestCompletionHandler</span> <span class="k">-&gt;</span> <span class="k">async</span><span class="o">/</span><span class="k">await</span>
<span class="n">VNImageRequestHandler</span><span class="nf">.perform</span><span class="p">([</span><span class="n">VN</span><span class="o">*</span><span class="n">Request</span><span class="p">])</span> <span class="k">-&gt;</span> <span class="o">*</span><span class="n">Request</span><span class="nf">.perform</span><span class="p">()</span>
</pre></table></code></div></div><h3 id="wwdc-example"><span class="me-2">WWDC Example</span><a href="#wwdc-example" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>WWDC official video uses a supermarket barcode scanner as an example.</p><h4 id="first-most-products-have-barcodes-available-for-scanning"><span class="me-2">First, most products have barcodes available for scanning</span><a href="#first-most-products-have-barcodes-available-for-scanning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/755509180ca8/1*YT_Uf8eEi36Iv7zcOrmP4A.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*YT_Uf8eEi36Iv7zcOrmP4A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NDAiIGhlaWdodD0iODY2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/755509180ca8/1*J9uIwRKubLoJoC7i096AdQ.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*J9uIwRKubLoJoC7i096AdQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NTQiIGhlaWdodD0iMTIwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/755509180ca8/1*gKg-NfHYqy7uBqe5hxzBSw.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*gKg-NfHYqy7uBqe5hxzBSw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjcwNiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>We can get the barcode location from <code class="language-plaintext highlighter-rouge">observation.boundingBox</code>, but unlike the common UIView coordinate system, the origin of <code class="language-plaintext highlighter-rouge">boundingBox</code> is at the bottom-left corner, and its values range between 0 and 1.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">filePath</span> <span class="o">=</span> <span class="kt">Bundle</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">path</span><span class="p">(</span><span class="nv">forResource</span><span class="p">:</span> <span class="s">"IMG_6785"</span><span class="p">,</span> <span class="nv">ofType</span><span class="p">:</span> <span class="s">"png"</span><span class="p">)</span><span class="o">!</span> <span class="c1">// Local test image</span>
<span class="k">let</span> <span class="nv">fileURL</span> <span class="o">=</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">filePath</span><span class="p">:</span> <span class="n">filePath</span><span class="p">)</span>
<span class="k">if</span> <span class="k">#available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">18.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// New API using Swift features</span>
    <span class="k">var</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">DetectBarcodesRequest</span><span class="p">()</span>
    <span class="n">request</span><span class="o">.</span><span class="n">symbologies</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="n">ean13</span><span class="p">]</span> <span class="c1">// Specify only EAN13 Barcode to scan for better performance</span>
    <span class="kt">Task</span> <span class="p">{</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="n">fileURL</span><span class="p">)</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">observation</span> <span class="o">=</span> <span class="n">observations</span><span class="o">.</span><span class="n">first</span> <span class="p">{</span>
                <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                    <span class="k">self</span><span class="o">.</span><span class="n">infoLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">payloadString</span>
                    <span class="c1">// Marking color Layer</span>
                    <span class="k">let</span> <span class="nv">colorLayer</span> <span class="o">=</span> <span class="kt">CALayer</span><span class="p">()</span>
                    <span class="c1">// iOS &gt;=18 new coordinate conversion API toImageCoordinates</span>
                    <span class="c1">// Untested, may still need to calculate ContentMode = AspectFit offset:</span>
                    <span class="n">colorLayer</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">boundingBox</span><span class="o">.</span><span class="nf">toImageCoordinates</span><span class="p">(</span><span class="k">self</span><span class="o">.</span><span class="n">baseImageView</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="nv">origin</span><span class="p">:</span> <span class="o">.</span><span class="n">upperLeft</span><span class="p">)</span>
                    <span class="n">colorLayer</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="n">red</span><span class="o">.</span><span class="nf">withAlphaComponent</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">cgColor</span>
                    <span class="k">self</span><span class="o">.</span><span class="n">baseImageView</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="nf">addSublayer</span><span class="p">(</span><span class="n">colorLayer</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"BoundingBox: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">boundingBox</span><span class="o">.</span><span class="n">cgRect</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Payload: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">payloadString</span> <span class="p">??</span> <span class="s">"No payload"</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Symbology: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">symbology</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// Old approach</span>
    <span class="k">let</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kt">VNRequestCompletionHandler</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">request</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="n">error</span><span class="p">)</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">results</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">VNBarcodeObservation</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">observation</span> <span class="o">=</span> <span class="n">observations</span><span class="o">.</span><span class="n">first</span> <span class="p">{</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">infoLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">payloadStringValue</span>
                <span class="c1">// Marking color Layer</span>
                <span class="k">let</span> <span class="nv">colorLayer</span> <span class="o">=</span> <span class="kt">CALayer</span><span class="p">()</span>
                <span class="n">colorLayer</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="nf">convertBoundingBox</span><span class="p">(</span><span class="n">observation</span><span class="o">.</span><span class="n">boundingBox</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">baseImageView</span><span class="p">)</span>
                <span class="n">colorLayer</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="n">red</span><span class="o">.</span><span class="nf">withAlphaComponent</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">cgColor</span>
                <span class="k">self</span><span class="o">.</span><span class="n">baseImageView</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="nf">addSublayer</span><span class="p">(</span><span class="n">colorLayer</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"BoundingBox: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">boundingBox</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Payload: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">payloadStringValue</span> <span class="p">??</span> <span class="s">"No payload"</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Symbology: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">symbology</span><span class="o">.</span><span class="n">rawValue</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">VNDetectBarcodesRequest</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="n">completionHandler</span><span class="p">)</span>
    <span class="n">request</span><span class="o">.</span><span class="n">symbologies</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="n">ean13</span><span class="p">]</span> <span class="c1">// Specify only EAN13 Barcode to scan for better performance</span>
    <span class="kt">DispatchQueue</span><span class="o">.</span><span class="nf">global</span><span class="p">()</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">handler</span> <span class="o">=</span> <span class="kt">VNImageRequestHandler</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">fileURL</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[:])</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">try</span> <span class="n">handler</span><span class="o">.</span><span class="nf">perform</span><span class="p">([</span><span class="n">request</span><span class="p">])</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>iOS ≥ 18 Update Highlight:</strong></p><pre><code class="language-less">// iOS &gt;=18 new coordinate conversion API toImageCoordinates
observation.boundingBox.toImageCoordinates(CGSize, origin: .upperLeft)
// https://developer.apple.com/documentation/vision/normalizedpoint/toimagecoordinates(from:imagesize:origin:)
</code></pre><p><strong>Helper:</strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre><span class="c1">// Gen by ChatGPT 4o</span>
<span class="c1">// Because the photo's ImageView has ContentMode = AspectFit</span>
<span class="c1">// We need to calculate the vertical offset caused by the Fit's blank space</span>
<span class="kd">func</span> <span class="nf">convertBoundingBox</span><span class="p">(</span><span class="n">_</span> <span class="nv">boundingBox</span><span class="p">:</span> <span class="kt">CGRect</span><span class="p">,</span> <span class="n">to</span> <span class="nv">view</span><span class="p">:</span> <span class="kt">UIImageView</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">CGRect</span> <span class="p">{</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">image</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">image</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">.</span><span class="n">zero</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">imageSize</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">size</span>
    <span class="k">let</span> <span class="nv">viewSize</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">size</span>
    <span class="k">let</span> <span class="nv">imageRatio</span> <span class="o">=</span> <span class="n">imageSize</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="n">imageSize</span><span class="o">.</span><span class="n">height</span>
    <span class="k">let</span> <span class="nv">viewRatio</span> <span class="o">=</span> <span class="n">viewSize</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="n">viewSize</span><span class="o">.</span><span class="n">height</span>
    <span class="k">var</span> <span class="nv">scaleFactor</span><span class="p">:</span> <span class="kt">CGFloat</span>
    <span class="k">var</span> <span class="nv">offsetX</span><span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">var</span> <span class="nv">offsetY</span><span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">imageRatio</span> <span class="o">&gt;</span> <span class="n">viewRatio</span> <span class="p">{</span>
        <span class="c1">// Image fits by width</span>
        <span class="n">scaleFactor</span> <span class="o">=</span> <span class="n">viewSize</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="n">imageSize</span><span class="o">.</span><span class="n">width</span>
        <span class="n">offsetY</span> <span class="o">=</span> <span class="p">(</span><span class="n">viewSize</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">imageSize</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">scaleFactor</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="p">}</span>

    <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// Image fits by height</span>
        <span class="n">scaleFactor</span> <span class="o">=</span> <span class="n">viewSize</span><span class="o">.</span><span class="n">height</span> <span class="o">/</span> <span class="n">imageSize</span><span class="o">.</span><span class="n">height</span>
        <span class="n">offsetX</span> <span class="o">=</span> <span class="p">(</span><span class="n">viewSize</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="n">imageSize</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">scaleFactor</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">x</span> <span class="o">=</span> <span class="n">boundingBox</span><span class="o">.</span><span class="n">minX</span> <span class="o">*</span> <span class="n">imageSize</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">scaleFactor</span> <span class="o">+</span> <span class="n">offsetX</span>
    <span class="k">let</span> <span class="nv">y</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">boundingBox</span><span class="o">.</span><span class="n">maxY</span><span class="p">)</span> <span class="o">*</span> <span class="n">imageSize</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">scaleFactor</span> <span class="o">+</span> <span class="n">offsetY</span>
    <span class="k">let</span> <span class="nv">width</span> <span class="o">=</span> <span class="n">boundingBox</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">imageSize</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">scaleFactor</span>
    <span class="k">let</span> <span class="nv">height</span> <span class="o">=</span> <span class="n">boundingBox</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">imageSize</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">scaleFactor</span>
    <span class="k">return</span> <span class="kt">CGRect</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="nv">width</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="n">height</span><span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>Output</strong></p><div class="language-makefile highlighter-rouge"><div class="code-header"> <span data-label-text="Makefile"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nl">BoundingBox</span><span class="o">:</span> <span class="nf">(0.5295758928571429</span><span class="p">,</span><span class="nf"> 0.21408638121589782</span><span class="p">,</span><span class="nf"> 0.0943080357142857</span><span class="p">,</span><span class="nf"> 0.21254415360708087)</span>
<span class="nl">Payload</span><span class="o">:</span> <span class="nf">4710018183805</span>
<span class="nl">Symbology</span><span class="o">:</span> <span class="nf">VNBarcodeSymbologyEAN13</span>
</pre></table></code></div></div><h4 id="some-products-have-no-barcode-such-as-loose-fruits-with-only-product-labels"><span class="me-2">Some products have no Barcode, such as loose fruits with only product labels</span><a href="#some-products-have-no-barcode-such-as-loose-fruits-with-only-product-labels" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/755509180ca8/1*jeZhLtg9j11kgOAvKZmevg.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*jeZhLtg9j11kgOAvKZmevg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NzYiIGhlaWdodD0iODM0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/755509180ca8/1*YNokMMUewMA2kzjoGmMJPw.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*YNokMMUewMA2kzjoGmMJPw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjk2IiBoZWlnaHQ9IjY5NiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Therefore, our scanner also needs to support scanning plain text labels.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">filePath</span> <span class="o">=</span> <span class="kt">Bundle</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">path</span><span class="p">(</span><span class="nv">forResource</span><span class="p">:</span> <span class="s">"apple"</span><span class="p">,</span> <span class="nv">ofType</span><span class="p">:</span> <span class="s">"jpg"</span><span class="p">)</span><span class="o">!</span> <span class="c1">// Local test image</span>
<span class="k">let</span> <span class="nv">fileURL</span> <span class="o">=</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">filePath</span><span class="p">:</span> <span class="n">filePath</span><span class="p">)</span>
<span class="k">if</span> <span class="k">#available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">18.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// New API using Swift features</span>
    <span class="k">var</span> <span class="nv">barcodesRequest</span> <span class="o">=</span> <span class="kt">DetectBarcodesRequest</span><span class="p">()</span>
    <span class="n">barcodesRequest</span><span class="o">.</span><span class="n">symbologies</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="n">ean13</span><span class="p">]</span> <span class="c1">// Specify EAN13 Barcode only to improve performance</span>
    <span class="k">var</span> <span class="nv">textRequest</span> <span class="o">=</span> <span class="kt">RecognizeTextRequest</span><span class="p">()</span>
    <span class="n">textRequest</span><span class="o">.</span><span class="n">recognitionLanguages</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">identifier</span><span class="p">:</span> <span class="s">"zh-Hnat"</span><span class="p">),</span> <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">identifier</span><span class="p">:</span> <span class="s">"en-US"</span><span class="p">)]</span>
    <span class="kt">Task</span> <span class="p">{</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">handler</span> <span class="o">=</span> <span class="kt">ImageRequestHandler</span><span class="p">(</span><span class="n">fileURL</span><span class="p">)</span>
            <span class="c1">// parameter pack syntax and we must wait for all requests to finish before we can use their results.</span>
            <span class="c1">// let (barcodesObservation, textObservation, ...) = try await handler.perform(barcodesRequest, textRequest, ...)</span>
            <span class="k">let</span> <span class="p">(</span><span class="nv">barcodesObservation</span><span class="p">,</span> <span class="nv">textObservation</span><span class="p">)</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">handler</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="n">barcodesRequest</span><span class="p">,</span> <span class="n">textRequest</span><span class="p">)</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">observation</span> <span class="o">=</span> <span class="n">barcodesObservation</span><span class="o">.</span><span class="n">first</span> <span class="p">{</span>
                <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                    <span class="k">self</span><span class="o">.</span><span class="n">infoLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">payloadString</span>
                    <span class="c1">// Highlight color layer</span>
                    <span class="k">let</span> <span class="nv">colorLayer</span> <span class="o">=</span> <span class="kt">CALayer</span><span class="p">()</span>
                    <span class="c1">// iOS &gt;=18 new coordinate conversion API toImageCoordinates</span>
                    <span class="c1">// Untested, actual implementation may need to adjust for ContentMode = AspectFit offset:</span>
                    <span class="n">colorLayer</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">boundingBox</span><span class="o">.</span><span class="nf">toImageCoordinates</span><span class="p">(</span><span class="k">self</span><span class="o">.</span><span class="n">baseImageView</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="nv">origin</span><span class="p">:</span> <span class="o">.</span><span class="n">upperLeft</span><span class="p">)</span>
                    <span class="n">colorLayer</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="n">red</span><span class="o">.</span><span class="nf">withAlphaComponent</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">cgColor</span>
                    <span class="k">self</span><span class="o">.</span><span class="n">baseImageView</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="nf">addSublayer</span><span class="p">(</span><span class="n">colorLayer</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"BoundingBox: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">boundingBox</span><span class="o">.</span><span class="n">cgRect</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Payload: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">payloadString</span> <span class="p">??</span> <span class="s">"No payload"</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Symbology: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">symbology</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="n">textObservation</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
                <span class="n">observation</span> <span class="k">in</span>
                <span class="k">let</span> <span class="nv">topCandidate</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="nf">topCandidates</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
                <span class="nf">print</span><span class="p">(</span><span class="n">topCandidate</span><span class="p">?</span><span class="o">.</span><span class="n">string</span> <span class="p">??</span> <span class="s">"No text recognized"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// Old implementation</span>
    <span class="k">let</span> <span class="nv">barcodesCompletionHandler</span><span class="p">:</span> <span class="kt">VNRequestCompletionHandler</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">request</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="n">error</span><span class="p">)</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">results</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">VNBarcodeObservation</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">observation</span> <span class="o">=</span> <span class="n">observations</span><span class="o">.</span><span class="n">first</span> <span class="p">{</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">infoLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">payloadStringValue</span>
                <span class="c1">// Highlight color layer</span>
                <span class="k">let</span> <span class="nv">colorLayer</span> <span class="o">=</span> <span class="kt">CALayer</span><span class="p">()</span>
                <span class="n">colorLayer</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="nf">convertBoundingBox</span><span class="p">(</span><span class="n">observation</span><span class="o">.</span><span class="n">boundingBox</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">baseImageView</span><span class="p">)</span>
                <span class="n">colorLayer</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="n">red</span><span class="o">.</span><span class="nf">withAlphaComponent</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">cgColor</span>
                <span class="k">self</span><span class="o">.</span><span class="n">baseImageView</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="nf">addSublayer</span><span class="p">(</span><span class="n">colorLayer</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"BoundingBox: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">boundingBox</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Payload: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">payloadStringValue</span> <span class="p">??</span> <span class="s">"No payload"</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Symbology: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">symbology</span><span class="o">.</span><span class="n">rawValue</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">textCompletionHandler</span><span class="p">:</span> <span class="kt">VNRequestCompletionHandler</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">request</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="n">error</span><span class="p">)</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">results</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">VNRecognizedTextObservation</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="n">observations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
            <span class="n">observation</span> <span class="k">in</span>
            <span class="k">let</span> <span class="nv">topCandidate</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="nf">topCandidates</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
            <span class="nf">print</span><span class="p">(</span><span class="n">topCandidate</span><span class="p">?</span><span class="o">.</span><span class="n">string</span> <span class="p">??</span> <span class="s">"No text recognized"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">barcodesRequest</span> <span class="o">=</span> <span class="kt">VNDetectBarcodesRequest</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="n">barcodesCompletionHandler</span><span class="p">)</span>
    <span class="n">barcodesRequest</span><span class="o">.</span><span class="n">symbologies</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="n">ean13</span><span class="p">]</span> <span class="c1">// Specify EAN13 Barcode only to improve performance</span>
    <span class="k">let</span> <span class="nv">textRequest</span> <span class="o">=</span> <span class="kt">VNRecognizeTextRequest</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="n">textCompletionHandler</span><span class="p">)</span>
    <span class="n">textRequest</span><span class="o">.</span><span class="n">recognitionLevel</span> <span class="o">=</span> <span class="o">.</span><span class="n">accurate</span>
    <span class="n">textRequest</span><span class="o">.</span><span class="n">recognitionLanguages</span> <span class="o">=</span> <span class="p">[</span><span class="s">"en-US"</span><span class="p">]</span>
    <span class="kt">DispatchQueue</span><span class="o">.</span><span class="nf">global</span><span class="p">()</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">handler</span> <span class="o">=</span> <span class="kt">VNImageRequestHandler</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">fileURL</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[:])</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">try</span> <span class="n">handler</span><span class="o">.</span><span class="nf">perform</span><span class="p">([</span><span class="n">barcodesRequest</span><span class="p">,</span> <span class="n">textRequest</span><span class="p">])</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>Output:</strong></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>94128s
ORGANIC
Pink Lady®
Produce of USh
</pre></table></code></div></div><p><strong>iOS ≥ 18 Update Highlight:</strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">handler</span> <span class="o">=</span> <span class="kt">ImageRequestHandler</span><span class="p">(</span><span class="n">fileURL</span><span class="p">)</span>
<span class="c1">// parameter pack syntax and we must wait for all requests to finish before we can use their results.</span>
<span class="c1">// let (barcodesObservation, textObservation, ...) = try await handler.perform(barcodesRequest, textRequest, ...)</span>
<span class="k">let</span> <span class="p">(</span><span class="nv">barcodesObservation</span><span class="p">,</span> <span class="nv">textObservation</span><span class="p">)</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">handler</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="n">barcodesRequest</span><span class="p">,</span> <span class="n">textRequest</span><span class="p">)</span>
</pre></table></code></div></div><h4 id="ios--18-performall-changeslatest_minortarget_blank-method"><span class="me-2">iOS ≥ 18 <a href="https://developer.apple.com/documentation/vision/imagerequesthandler/performall(_:">performAll( )</a>?changes=latest_minor){:target=”_blank”} method</span><a href="#ios--18-performall-changeslatest_minortarget_blank-method" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/755509180ca8/1*z0364eYD4F4On194EgQ1kQ.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*z0364eYD4F4On194EgQ1kQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTAwIiBoZWlnaHQ9Ijc0OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>The previous <code class="language-plaintext highlighter-rouge">perform(barcodesRequest, textRequest)</code> method requires both requests to complete before continuing; starting with iOS 18, a new <code class="language-plaintext highlighter-rouge">performAll()</code> method is provided, which changes the response to streaming, allowing handling as soon as one request returns a result, such as responding immediately when a barcode is scanned.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre><span class="k">if</span> <span class="k">#available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">18.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// New API using Swift features</span>
    <span class="k">var</span> <span class="nv">barcodesRequest</span> <span class="o">=</span> <span class="kt">DetectBarcodesRequest</span><span class="p">()</span>
    <span class="n">barcodesRequest</span><span class="o">.</span><span class="n">symbologies</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="n">ean13</span><span class="p">]</span> <span class="c1">// Specify EAN13 barcode only for better performance</span>
    <span class="k">var</span> <span class="nv">textRequest</span> <span class="o">=</span> <span class="kt">RecognizeTextRequest</span><span class="p">()</span>
    <span class="n">textRequest</span><span class="o">.</span><span class="n">recognitionLanguages</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">identifier</span><span class="p">:</span> <span class="s">"zh-Hnat"</span><span class="p">),</span> <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">identifier</span><span class="p">:</span> <span class="s">"en-US"</span><span class="p">)]</span>
    <span class="kt">Task</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">handler</span> <span class="o">=</span> <span class="kt">ImageRequestHandler</span><span class="p">(</span><span class="n">fileURL</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">observation</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="nf">performAll</span><span class="p">([</span><span class="n">barcodesRequest</span><span class="p">,</span> <span class="n">textRequest</span><span class="p">]</span> <span class="k">as</span> <span class="p">[</span><span class="kd">any</span> <span class="kt">VisionRequest</span><span class="p">])</span>
        <span class="k">for</span> <span class="k">try</span> <span class="k">await</span> <span class="n">result</span> <span class="k">in</span> <span class="n">observation</span> <span class="p">{</span>
            <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
                <span class="k">case</span> <span class="o">.</span><span class="nf">detectBarcodes</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="k">let</span> <span class="nv">barcodesObservation</span><span class="p">):</span>
                <span class="k">if</span> <span class="k">let</span> <span class="nv">observation</span> <span class="o">=</span> <span class="n">barcodesObservation</span><span class="o">.</span><span class="n">first</span> <span class="p">{</span>
                    <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                        <span class="k">self</span><span class="o">.</span><span class="n">infoLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">payloadString</span>
                        <span class="c1">// Mark color Layer</span>
                        <span class="k">let</span> <span class="nv">colorLayer</span> <span class="o">=</span> <span class="kt">CALayer</span><span class="p">()</span>
                        <span class="c1">// iOS &gt;=18 new coordinate conversion API toImageCoordinates</span>
                        <span class="c1">// Untested, may still need to calculate displacement for ContentMode = AspectFit:</span>
                        <span class="n">colorLayer</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">boundingBox</span><span class="o">.</span><span class="nf">toImageCoordinates</span><span class="p">(</span><span class="k">self</span><span class="o">.</span><span class="n">baseImageView</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="nv">origin</span><span class="p">:</span> <span class="o">.</span><span class="n">upperLeft</span><span class="p">)</span>
                        <span class="n">colorLayer</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="n">red</span><span class="o">.</span><span class="nf">withAlphaComponent</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">cgColor</span>
                        <span class="k">self</span><span class="o">.</span><span class="n">baseImageView</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="nf">addSublayer</span><span class="p">(</span><span class="n">colorLayer</span><span class="p">)</span>
                    <span class="p">}</span>
                    <span class="nf">print</span><span class="p">(</span><span class="s">"BoundingBox: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">boundingBox</span><span class="o">.</span><span class="n">cgRect</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                    <span class="nf">print</span><span class="p">(</span><span class="s">"Payload: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">payloadString</span> <span class="p">??</span> <span class="s">"No payload"</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                    <span class="nf">print</span><span class="p">(</span><span class="s">"Symbology: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">symbology</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="k">case</span> <span class="o">.</span><span class="nf">recognizeText</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="k">let</span> <span class="nv">textObservation</span><span class="p">):</span>
                <span class="n">textObservation</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
                    <span class="n">observation</span> <span class="k">in</span>
                    <span class="k">let</span> <span class="nv">topCandidate</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="nf">topCandidates</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
                    <span class="nf">print</span><span class="p">(</span><span class="n">topCandidate</span><span class="p">?</span><span class="o">.</span><span class="n">string</span> <span class="p">??</span> <span class="s">"No text recognized"</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="k">default</span><span class="p">:</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Unrecognized result: </span><span class="se">\(</span><span class="n">result</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="optimize-with-swift-concurrency"><span class="me-2">Optimize with Swift Concurrency</span><a href="#optimize-with-swift-concurrency" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/755509180ca8/1*LgxxMOVS6is3n6EqPWqA6Q.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*LgxxMOVS6is3n6EqPWqA6Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDQ0IiBoZWlnaHQ9IjYxOCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/755509180ca8/1*80CFJpkb-gjy3bJs4jAC2A.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*80CFJpkb-gjy3bJs4jAC2A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NTYiIGhlaWdodD0iODQwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Assuming we have a photo wall list where each image needs automatic cropping to the main subject; in this case, Swift Concurrency can be used to improve loading efficiency.</p><h4 id="original-code"><span class="me-2"><strong>Original Code</strong></span><a href="#original-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">generateThumbnail</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="kt">URL</span><span class="p">)</span> <span class="k">async</span> <span class="k">throws</span> <span class="o">-&gt;</span> <span class="kt">UIImage</span> <span class="p">{</span>
  <span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">GenerateAttentionBasedSaliencyImageRequest</span><span class="p">()</span>
  <span class="k">let</span> <span class="nv">saliencyObservation</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="n">url</span><span class="p">)</span>
  <span class="k">return</span> <span class="nf">cropImage</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="n">saliencyObservation</span><span class="o">.</span><span class="n">salientObjects</span><span class="p">)</span>
<span class="p">}</span>
    
<span class="kd">func</span> <span class="nf">generateAllThumbnails</span><span class="p">()</span> <span class="k">async</span> <span class="k">throws</span> <span class="p">{</span>
  <span class="k">for</span> <span class="n">image</span> <span class="k">in</span> <span class="n">images</span> <span class="p">{</span>
    <span class="n">image</span><span class="o">.</span><span class="n">thumbnail</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="nf">generateThumbnail</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Execute only one at a time, resulting in slow efficiency and performance.</p><h4 id="optimization-1--taskgroup-concurrency"><span class="me-2"><strong>Optimization (1) — TaskGroup</strong> Concurrency</span><a href="#optimization-1--taskgroup-concurrency" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>
<span class="kd">func</span> <span class="nf">generateAllThumbnails</span><span class="p">()</span> <span class="k">async</span> <span class="k">throws</span> <span class="p">{</span>
  <span class="k">try</span> <span class="k">await</span> <span class="n">withThrowingDiscardingTaskGroup</span> <span class="p">{</span> <span class="n">taskGroup</span> <span class="k">in</span>
    <span class="k">for</span> <span class="n">image</span> <span class="k">in</span> <span class="n">images</span> <span class="p">{</span>
      <span class="n">image</span><span class="o">.</span><span class="n">thumbnail</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="nf">generateThumbnail</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
     <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Add each Task to a TaskGroup for concurrent execution.</p><blockquote><p><strong><em>Issue: Image recognition and screenshot operations consume a lot of memory and performance. Adding unlimited parallel tasks may cause user lag and OOM crashes.</em></strong></p></blockquote><h4 id="optimization-2--taskgroup-concurrency--limiting-parallelism"><span class="me-2">Optimization (2) — TaskGroup Concurrency + Limiting Parallelism</span><a href="#optimization-2--taskgroup-concurrency--limiting-parallelism" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">generateAllThumbnails</span><span class="p">()</span> <span class="k">async</span> <span class="k">throws</span> <span class="p">{</span>
    <span class="k">try</span> <span class="k">await</span> <span class="n">withThrowingDiscardingTaskGroup</span> <span class="p">{</span>
        <span class="n">taskGroup</span> <span class="k">in</span>
        <span class="c1">// Maximum number of concurrent tasks should not exceed 5</span>
        <span class="k">let</span> <span class="nv">maxImageTasks</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">images</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
        <span class="c1">// Initially fill with 5 tasks</span>
        <span class="k">for</span> <span class="n">index</span> <span class="k">in</span> <span class="mi">0</span><span class="o">..&lt;</span><span class="n">maxImageTasks</span> <span class="p">{</span>
            <span class="n">taskGroup</span><span class="o">.</span><span class="n">addTask</span> <span class="p">{</span>
                <span class="n">image</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">thumbnail</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="nf">generateThumbnail</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">image</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">var</span> <span class="nv">nextIndex</span> <span class="o">=</span> <span class="n">maxImageTasks</span>
        <span class="k">for</span> <span class="k">try</span> <span class="k">await</span> <span class="n">_</span> <span class="k">in</span> <span class="n">taskGroup</span> <span class="p">{</span>
            <span class="c1">// When a task in the taskGroup completes...</span>
            <span class="c1">// Check if index has reached the end</span>
            <span class="k">if</span> <span class="n">nextIndex</span> <span class="o">&lt;</span> <span class="n">images</span><span class="o">.</span><span class="n">count</span> <span class="p">{</span>
                <span class="k">let</span> <span class="nv">image</span> <span class="o">=</span> <span class="n">images</span><span class="p">[</span><span class="n">nextIndex</span><span class="p">]</span>
                <span class="c1">// Continue adding tasks one by one (keeping max at 5)</span>
                <span class="n">taskGroup</span><span class="o">.</span><span class="n">addTask</span> <span class="p">{</span>
                    <span class="n">image</span><span class="o">.</span><span class="n">thumbnail</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="nf">generateThumbnail</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="n">nextIndex</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="update-an-existing-vision-app"><span class="me-2">Update an existing Vision app</span><a href="#update-an-existing-vision-app" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/755509180ca8/1*0OhzcxQ7OpSujeyvt9918Q.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*0OhzcxQ7OpSujeyvt9918Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjYxNSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/755509180ca8/1*MH4Xa0RB2DZQ1Fl9-kItSw.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*MH4Xa0RB2DZQ1Fl9-kItSw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjIyIiBoZWlnaHQ9IjQxOCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ol><li><p>Vision will remove CPU and GPU support for some requests on devices with a neural engine. On these devices, the neural engine offers the best performance.<br /> You can check this using the <code class="language-plaintext highlighter-rouge">supportedComputeDevices()</code> API.</p><li><p>Remove all VN prefixes<br /> <code class="language-plaintext highlighter-rouge">VNXXRequest</code>, <code class="language-plaintext highlighter-rouge">VNXXXObservation</code> -&gt; <code class="language-plaintext highlighter-rouge">Request</code>, <code class="language-plaintext highlighter-rouge">Observation</code></p><li><p>Use async/await to replace the original VNRequestCompletionHandler</p><li><p>Use <code class="language-plaintext highlighter-rouge">*Request.perform()</code> directly instead of the original <code class="language-plaintext highlighter-rouge">VNImageRequestHandler.perform([VN*Request])</code></p></ol><h3 id="wrap-up"><span class="me-2">Wrap-up</span><a href="#wrap-up" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p>API Designed for Swift Language Features</p><li><p>New features and methods are Swift only, available for iOS ≥ 18</p><li><p>New Image Rating Feature, Body + Hand Motion Tracking</p></ul><h3 id="thanks"><span class="me-2">Thanks!</span><a href="#thanks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/755509180ca8/1*BK_5eH1i4-drOUOGnuQRSg.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*BK_5eH1i4-drOUOGnuQRSg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjY2NyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><h3 id="kkday-recruitment-advertisement"><span class="me-2">KKday Recruitment Advertisement</span><a href="#kkday-recruitment-advertisement" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/755509180ca8/1*kjcldhvCP1cM-QqDfRFaYg.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*kjcldhvCP1cM-QqDfRFaYg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NjgiIGhlaWdodD0iNDM5Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>👉👉👉This book club sharing originates from the weekly technical sharing sessions within the KKday App Team. <strong>The team is currently enthusiastically recruiting a <a href="https://kkday.bamboohr.com/careers/25?source=aWQ9Mjk%3D" target="_blank">Senior iOS Engineer</a>. Interested candidates are welcome to apply.</strong> 👈👈👈</p><h4 id="references"><span class="me-2">References</span><a href="#references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><h4 id="discover-swift-enhancements-in-the-vision-framework"><span class="me-2"><a href="https://developer.apple.com/videos/play/wwdc2024/10163/" target="_blank">Discover Swift enhancements in the Vision framework</a></span><a href="#discover-swift-enhancements-in-the-vision-framework" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The Vision Framework API has been redesigned to leverage modern Swift features like concurrency, making it easier and faster to integrate a wide array of Vision algorithms into your app. We’ll tour the updated API and share sample code, along with best practices, to help you get the benefits of this framework with less coding effort. We’ll also demonstrate two new features: image aesthetics and holistic body pose.</p><h3 id="chapters"><span class="me-2">Chapters</span><a href="#chapters" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p>0:00 — <a href="https://developer.apple.com/videos/play/wwdc2024/10163/?time=0" target="_blank">Introduction</a></p><li><p>1:07 — <a href="https://developer.apple.com/videos/play/wwdc2024/10163/?time=67" target="_blank">New Vision API</a></p><li><p>1:47 — <a href="https://developer.apple.com/videos/play/wwdc2024/10163/?time=107" target="_blank">Get started with Vision</a></p><li><p>8:59 — <a href="https://developer.apple.com/videos/play/wwdc2024/10163/?time=539" target="_blank">Optimize with Swift Concurrency</a></p><li><p>11:05 — <a href="https://developer.apple.com/videos/play/wwdc2024/10163/?time=665" target="_blank">Update an existing Vision app</a></p><li><p>13:46 — <a href="https://developer.apple.com/videos/play/wwdc2024/10163/?time=826" target="_blank">What’s new in Vision?</a></p></ul><h4 id="vision-framework-apple-developer-documentation"><span class="me-2"><a href="https://developer.apple.com/documentation/vision/" target="_blank">Vision framework Apple Developer Documentation</a></span><a href="#vision-framework-apple-developer-documentation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>-</p><p>If you have any questions or feedback, feel free to <a href="https://www.zhgchg.li/contact" target="_blank">contact me</a>.</p><p><em><a href="https://medium.com/kkdaytech/ios-vision-framework-x-wwdc-24-discover-swift-enhancements-in-the-vision-framework-session-755509180ca8" target="_blank">Post</a> converted from Medium by <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown</a>.</em></p><hr /><blockquote class="prompt-info"><p>This article was first published on Medium ➡️ <a href="https://medium.com/p/755509180ca8" target="_blank"><strong>Click Here</strong></a>, automatically converted and synchronized using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown</a> and <a href="https://github.com/ZhgChgLi/medium-to-jekyll-starter.github.io" target="_blank">Medium-to-jekyll-starter</a>.</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/en/zmediumtomarkdown/2024-08-13-755509180ca8.md" target="_blank">Improve this page on Github.</a></p></blockquote><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=🍺&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a></p><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic> <script async="" src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); border-bottom: 1px solid var(--main-border-color);transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1K+ Followers</span></a></div><div style="font-size: 0.8em; cursor:default; text-align: right;"> 840 <span style="font-size: 0.9em;">Total Views</span><br /> <span style="font-size: 0.8em;">Last Statistics Date: 2025-08-19 | 605 Views on <a href="https://medium.com/p/755509180ca8" target="_blank">Medium.</a></span></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/kkday-tech-blog/">KKday Tech Blog</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >iOS App Development</a> <a href="/tags/vision-framework/" class="post-tag no-text-decoration" >Vision Framework</a> <a href="/tags/apple-intelligence/" class="post-tag no-text-decoration" >Apple Intelligence</a> <a href="/tags/ai/" class="post-tag no-text-decoration" >AI</a> <a href="/tags/machine-learning/" class="post-tag no-text-decoration" >Machine Learning</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=iOS%20Vision%20Framework%EF%BD%9CExplore%20Swift%20API%20Enhancements%20from%20WWDC%2024%20Session%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fkkday-tech-blog%2Fen%2Fios-vision-framework-explore-swift-api-enhancements-from-wwdc-24-session-755509180ca8%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=iOS%20Vision%20Framework%EF%BD%9CExplore%20Swift%20API%20Enhancements%20from%20WWDC%2024%20Session%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fkkday-tech-blog%2Fen%2Fios-vision-framework-explore-swift-api-enhancements-from-wwdc-24-session-755509180ca8%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fkkday-tech-blog%2Fen%2Fios-vision-framework-explore-swift-api-enhancements-from-wwdc-24-session-755509180ca8%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/en/apple-watch-stainless-steel-milanese-loop-unboxing-premium-44mm-graphite-band-review-c0f99f987d9c/">Apple Watch Stainless Steel Milanese Loop Unboxing｜Premium 44mm Graphite Band Review</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/apple-watch-%E7%B1%B3%E8%98%AD%E9%8C%B6%E5%B8%B6%E9%96%8B%E7%AE%B1-%E5%8E%9F%E5%BB%A0%E4%B8%8D%E9%8F%BD%E9%8B%BC%E7%9F%B3%E5%A2%A8%E8%89%B2%E5%84%AA%E7%BC%BA%E9%BB%9E%E5%85%A8%E8%A7%A3%E6%9E%90-c0f99f987d9c/">Apple Watch 原廠不鏽鋼米蘭錶帶開箱</a><li class="text-truncate lh-lg"> <a href="/posts/travel-journals/en/busan-travel-guide-8-day-itinerary-with-visit-busan-pass-for-seamless-exploration-8ace34a1a3d8/">Busan Travel Guide｜8-Day Itinerary with VISIT BUSAN PASS for Seamless Exploration</a><li class="text-truncate lh-lg"> <a href="/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/%E9%87%9C%E5%B1%B1%E8%87%AA%E7%94%B1%E8%A1%8C%E6%94%BB%E7%95%A5-8%E5%A4%A97%E5%A4%9C%E5%BF%85%E5%8E%BB%E6%99%AF%E9%BB%9E-%E7%BE%8E%E9%A3%9F%E8%88%87%E4%BA%A4%E9%80%9A%E5%85%A8%E8%A7%A3%E6%9E%90-%E9%87%9C%E5%B1%B1%E9%80%9A%E8%A1%8C%E8%AD%89%E7%9C%81%E9%8C%A2%E7%A7%98%E8%A8%A3-8ace34a1a3d8/">遊記 2025 韓國釜山 8 天 7 夜自由行</a><li class="text-truncate lh-lg"> <a href="/posts/travel-journals/en/nagoya-one-day-quick-trip-peach-aviation-flight-experience-and-travel-tips-7b8a0563c157/">Nagoya One-Day Quick Trip｜Peach Aviation Flight Experience and Travel Tips</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">iOS App Development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">iOS</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios app development</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">Swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">章節 (Chapters)🔖</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-development/en/ios-button-tap-area-expansion-enhance-user-interaction-with-custom-pointinside-override-a8c2d7ed144b/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1580564749" data-df="ll" > Feb 1, 2020 </time><h4 class="pt-0 my-2">iOS Button Tap Area Expansion｜Enhance User Interaction with Custom pointInside Override</h4><div class="text-muted"><p>Improve iOS app usability by expanding button tap areas using a custom pointInside method. Solve missed taps and boost user experience with precise touch target enlargement techniques.</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-development/en/ios-uiviewcontroller-transitions-master-pull-down-close-pull-up-present-full-page-swipe-back-14cee137c565/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1578768066" data-df="ll" > Jan 12, 2020 </time><h4 class="pt-0 my-2">iOS UIViewController Transitions｜Master Pull-Down Close, Pull-Up Present & Full-Page Swipe Back</h4><div class="text-muted"><p>Discover how to implement seamless UIViewController transitions in iOS, including pull-down to close, pull-up to present, and full-page right-swipe back gestures, enhancing user interaction and nav...</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-development/en/ios-devicecheck-implement-one-time-offers-and-trials-seamlessly-with-swift-c5e7e580c341/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1556551801" data-df="ll" > Apr 29, 2019 </time><h4 class="pt-0 my-2">iOS DeviceCheck｜Implement One-Time Offers and Trials Seamlessly with Swift</h4><div class="text-muted"><p>iOS developers struggling with secure one-time offers or trials can leverage DeviceCheck to track user eligibility across devices, preventing abuse and ensuring fair usage. Learn how to implement t...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-life/medium-partner-program-%E5%85%A8%E7%90%83%E9%96%8B%E6%94%BE-%E5%8F%B0%E7%81%A3%E5%89%B5%E4%BD%9C%E8%80%85%E8%BC%95%E9%AC%86%E5%8A%A0%E5%85%A5%E8%B3%BA%E5%8F%96%E6%96%87%E7%AB%A0%E6%94%B6%E7%9B%8A-cefdf4d41746/" class="btn btn-outline-primary" aria-label="Older" ><p>Medium Partner Program 全球開放｜台灣創作者輕鬆加入賺取文章收益</p></a> <a href="/posts/kkday-tech-blog/ios-vision-framework-wwdc-24-swift-concurrency-%E8%88%87%E6%96%B0-api-%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90%E8%88%87%E5%AF%A6%E4%BD%9C%E6%8C%87%E5%8D%97-755509180ca8/" class="btn btn-outline-primary" aria-label="Newer" ><p>iOS Vision framework x WWDC 24 Discover Swift enhancements in the Vision framework Session</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a><br/>Last updated: 2025-08-20 23:47:22 +08:00</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">iOS App Development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">iOS</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios app development</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">Swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
