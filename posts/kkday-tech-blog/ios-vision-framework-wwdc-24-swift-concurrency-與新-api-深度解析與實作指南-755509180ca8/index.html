<!doctype html><html lang="zh-tw" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="iOS Vision frameworkï½œWWDC 24 Swift Concurrency èˆ‡æ–° API æ·±åº¦è§£æèˆ‡å¯¦ä½œæŒ‡å—" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="zh_tw" /><meta name="description" content="iOS é–‹ç™¼è€…é¢å° Vision framework è¤‡é›œåœ–åƒè¾¨è­˜éœ€æ±‚ï¼Œé€é WWDC 24 Swift Concurrency æ–° APIï¼ŒæŒæ¡ 31 ç¨®åœ–åƒè¾¨è­˜è«‹æ±‚èˆ‡èº«é«”æ‰‹å‹¢è¿½è¹¤ï¼Œæå‡è¾¨è­˜æ•ˆç‡èˆ‡å®‰å…¨æ€§ï¼Œå¯¦ç¾é«˜æ•ˆåœ–åƒåˆ†æèˆ‡å³æ™‚æ‡‰ç”¨ã€‚" /><meta property="og:description" content="iOS é–‹ç™¼è€…é¢å° Vision framework è¤‡é›œåœ–åƒè¾¨è­˜éœ€æ±‚ï¼Œé€é WWDC 24 Swift Concurrency æ–° APIï¼ŒæŒæ¡ 31 ç¨®åœ–åƒè¾¨è­˜è«‹æ±‚èˆ‡èº«é«”æ‰‹å‹¢è¿½è¹¤ï¼Œæå‡è¾¨è­˜æ•ˆç‡èˆ‡å®‰å…¨æ€§ï¼Œå¯¦ç¾é«˜æ•ˆåœ–åƒåˆ†æèˆ‡å³æ™‚æ‡‰ç”¨ã€‚" /><link rel="canonical" href="https://zhgchg.li/posts/kkday-tech-blog/ios-vision-framework-wwdc-24-swift-concurrency-%E8%88%87%E6%96%B0-api-%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90%E8%88%87%E5%AF%A6%E4%BD%9C%E6%8C%87%E5%8D%97-755509180ca8/" /><meta property="og:url" content="https://zhgchg.li/posts/kkday-tech-blog/ios-vision-framework-wwdc-24-swift-concurrency-%E8%88%87%E6%96%B0-api-%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90%E8%88%87%E5%AF%A6%E4%BD%9C%E6%8C%87%E5%8D%97-755509180ca8/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/755509180ca8/1*NqN-_MAE4tt11n6MnUQWxQ.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-08-13T16:10:37+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/755509180ca8/1*NqN-_MAE4tt11n6MnUQWxQ.webp" /><meta property="twitter:title" content="iOS Vision frameworkï½œWWDC 24 Swift Concurrency èˆ‡æ–° API æ·±åº¦è§£æèˆ‡å¯¦ä½œæŒ‡å—" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://www.linkedin.com/in/zhgchgli"},"dateModified":"2024-08-14T20:07:49+08:00","datePublished":"2024-08-13T16:10:37+08:00","description":"iOS é–‹ç™¼è€…é¢å° Vision framework è¤‡é›œåœ–åƒè¾¨è­˜éœ€æ±‚ï¼Œé€é WWDC 24 Swift Concurrency æ–° APIï¼ŒæŒæ¡ 31 ç¨®åœ–åƒè¾¨è­˜è«‹æ±‚èˆ‡èº«é«”æ‰‹å‹¢è¿½è¹¤ï¼Œæå‡è¾¨è­˜æ•ˆç‡èˆ‡å®‰å…¨æ€§ï¼Œå¯¦ç¾é«˜æ•ˆåœ–åƒåˆ†æèˆ‡å³æ™‚æ‡‰ç”¨ã€‚","headline":"iOS Vision frameworkï½œWWDC 24 Swift Concurrency èˆ‡æ–° API æ·±åº¦è§£æèˆ‡å¯¦ä½œæŒ‡å—","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+","url":"https://zhgchg.li/assets/755509180ca8/1*NqN-_MAE4tt11n6MnUQWxQ.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/kkday-tech-blog/ios-vision-framework-wwdc-24-swift-concurrency-%E8%88%87%E6%96%B0-api-%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90%E8%88%87%E5%AF%A6%E4%BD%9C%E6%8C%87%E5%8D%97-755509180ca8/"},"url":"https://zhgchg.li/posts/kkday-tech-blog/ios-vision-framework-wwdc-24-swift-concurrency-%E8%88%87%E6%96%B0-api-%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90%E8%88%87%E5%AF%A6%E4%BD%9C%E6%8C%87%E5%8D%97-755509180ca8/"}</script><title>iOS Vision frameworkï½œWWDC 24 Swift Concurrency èˆ‡æ–° API æ·±åº¦è§£æèˆ‡å¯¦ä½œæŒ‡å— | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/zh.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=false" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script><link rel="alternate" hreflang="en" href="https://en.zhgchg.li/posts/kkday-tech-blog/ios-vision-framework-explore-swift-api-enhancements-from-wwdc-24-session-755509180ca8/"><link rel="alternate" hreflang="ja" href="https://jp.zhgchg.li/posts/kkday-tech-blog/ios-vision-framework-wwdc-24%E3%81%A7swift%E5%BC%B7%E5%8C%96%E3%82%92%E8%A7%A3%E8%AA%AC-vision-framework%E6%9C%80%E6%96%B0%E6%A9%9F%E8%83%BD%E3%82%92%E5%BE%B9%E5%BA%95%E3%83%AC%E3%83%93%E3%83%A5%E3%83%BC-755509180ca8/"><link rel="alternate" hreflang="zh-Hans" href="https://zh-hans.zhgchg.li/posts/kkday-tech-blog/ios-vision-framework-wwdc-24-swift-concurrency-%E4%B8%8E%E6%96%B0-api-%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90%E4%B8%8E%E5%AE%9E%E4%BD%9C%E6%8C%87%E5%8D%97-755509180ca8/"><link rel="alternate" hreflang="zh-Hant" href="https://zhgchg.li/posts/kkday-tech-blog/ios-vision-framework-wwdc-24-swift-concurrency-%E8%88%87%E6%96%B0-api-%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90%E8%88%87%E5%AF%A6%E4%BD%9C%E6%8C%87%E5%8D%97-755509180ca8/"><link rel="alternate" hreflang="x-default" href="https://zhgchg.li/posts/kkday-tech-blog/ios-vision-framework-wwdc-24-swift-concurrency-%E8%88%87%E6%96%B0-api-%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90%E8%88%87%E5%AF%A6%E4%BD%9C%E6%8C%87%E5%8D%97-755509180ca8/"> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"FAQPage","mainEntity":[{"@type":"Question","name":"å¦‚ä½•åˆ©ç”¨ iOS 18 Vision framework æ–° Swift API ä¾†æå‡åœ–åƒè¾¨è­˜æ•ˆèƒ½ï¼Ÿ","acceptedAnswer":{"@type":"Answer","text":"iOS 18 Vision framework é‡æ–°è¨­è¨ˆ APIï¼Œæ¡ç”¨ Swift Concurrency èˆ‡ async/awaitï¼Œè®“åœ–åƒè¾¨è­˜æ“ä½œæ›´ç°¡æ½”ä¸”åŸ·è¡Œæ›´å¿«ï¼Œé€éæ–°æ–¹æ³•å¦‚ perform() å–ä»£èˆŠçš„ VNImageRequestHandlerï¼Œèƒ½æœ‰æ•ˆæå‡æ•ˆèƒ½èˆ‡é–‹ç™¼æ•ˆç‡ã€‚"}},{"@type":"Question","name":"Vision framework åœ¨ iOS 18 æ–°å¢äº†å“ªäº›å¯¦ç”¨çš„åœ–åƒåˆ†æåŠŸèƒ½ï¼Ÿ","acceptedAnswer":{"@type":"Answer","text":"iOS 18 æ–°å¢åœ–ç‰‡ç¾å­¸è©•åˆ†ï¼ˆCalculateImageAestheticsScoresRequestï¼‰èˆ‡èº«é«”ï¼‹æ‰‹å‹¢å§¿å‹¢åŒæ™‚åµæ¸¬ï¼ˆDetectHumanBodyPoseRequest æ”¯æ´ detectsHandsï¼‰ï¼Œæ–¹ä¾¿ç¯©é¸å„ªè³ªç…§ç‰‡åŠå¯¦ç¾æ›´å®Œæ•´çš„å‹•ä½œæ•æ‰æ‡‰ç”¨ã€‚"}},{"@type":"Question","name":"å¦‚ä½•åœ¨ Vision framework ä¸­åŒæ™‚è™•ç†å¤šå€‹åœ–åƒè¾¨è­˜è«‹æ±‚ä¸¦å³æ™‚å–å¾—çµæœï¼Ÿ","acceptedAnswer":{"@type":"Answer","text":"iOS 18 æä¾› ImageRequestHandler çš„ performAll() æ–¹æ³•ï¼Œå¯åŒæ™‚åŸ·è¡Œå¤šå€‹è«‹æ±‚ä¸¦ä»¥ä¸²æµæ–¹å¼æ¥æ”¶çµæœï¼Œè®“é–‹ç™¼è€…èƒ½å³æ™‚è™•ç†æƒæåˆ°çš„æ¢ç¢¼æˆ–æ–‡å­—ï¼Œæå‡ä½¿ç”¨è€…é«”é©—èˆ‡åæ‡‰é€Ÿåº¦ã€‚"}},{"@type":"Question","name":"ä½¿ç”¨ Swift Concurrency å„ªåŒ– Vision framework å¤§é‡åœ–ç‰‡è™•ç†æ™‚è©²æ³¨æ„ä»€éº¼ï¼Ÿ","acceptedAnswer":{"@type":"Answer","text":"é€é TaskGroup ä¸¦è¡Œè™•ç†å¤šå¼µåœ–ç‰‡å¯å¤§å¹…æå‡æ•ˆç‡ï¼Œä½†å› åœ–åƒè¾¨è­˜æ¶ˆè€—è¨˜æ†¶é«”èˆ‡æ€§èƒ½ï¼Œå»ºè­°é™åˆ¶æœ€å¤§ä¸¦è¡Œä»»å‹™æ•¸é‡ï¼ˆå¦‚æœ€å¤š 5 å€‹ï¼‰ï¼Œé¿å…é€ æˆç³»çµ±å¡é “æˆ–è¨˜æ†¶é«”æº¢ä½é–ƒé€€ã€‚"}},{"@type":"Question","name":"Vision framework èˆ‡ VisionKit æœ‰ä½•ä¸åŒï¼Œè©²å¦‚ä½•é¸æ“‡ä½¿ç”¨ï¼Ÿ","acceptedAnswer":{"@type":"Answer","text":"Vision framework èšç„¦æ–¼åœ–åƒåˆ†æèˆ‡è¾¨è­˜ï¼ˆå¦‚äººè‡‰ã€æ¢ç¢¼ã€æ–‡å­—ï¼‰ï¼Œè€Œ VisionKit å°ˆé–€ç”¨æ–¼æ–‡ä»¶æƒæä¸¦ç”Ÿæˆ PDFï¼Œé–‹ç™¼è€…æ‡‰æ ¹æ“šéœ€æ±‚é¸æ“‡ Vision é€²è¡Œè¦–è¦ºå…§å®¹åˆ†æï¼Œæˆ– VisionKit è™•ç†æ–‡ä»¶æƒæä»»å‹™ã€‚"}}]} </script><link rel="stylesheet" href="/assets/css/post-toc.css"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0">An iOS, web, and automation developer from Taiwan ğŸ‡¹ğŸ‡¼ who also loves sharing, traveling, and writing.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item" style="padding:0 15px 0 15px;"> <a href="https://medium.com/@zhgchgli" class="nav-link" target="_blank" style="background:#EDF4FF;color:#0A84FF;font-size:15px;transition:background-color .2s,color .2s;" onmouseover="this.style.backgroundColor='#0A84FF';this.style.color='#ffffff';" onmouseout="this.style.backgroundColor='#EDF4FF';this.style.color='#0A84FF';"> <i class="fa-brands fa-medium"></i> <span><span style="font-size: 18px; font-weight: boild;">Follow Me on Medium!</span><br/><u>1,053+</u> Followers</span> </a><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>é¦–é </span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>åˆ†é¡</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>æ¨™ç±¤</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>æ­¸æª”</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>é—œæ–¼æˆ‘</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>è¯çµ¡æˆ‘</span> </a><li class="nav-item"><div aria-label="Language switch" style="display:flex;align-items:center;justify-content:center;gap:5px;"> <a href="https://zhgchg.li/posts/kkday-tech-blog/ios-vision-framework-wwdc-24-swift-concurrency-%E8%88%87%E6%96%B0-api-%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90%E8%88%87%E5%AF%A6%E4%BD%9C%E6%8C%87%E5%8D%97-755509180ca8/" style="display:inline-flex;align-items:center;justify-content:center;padding:6px 10px;border-radius:999px;border:1px solid #666;background:#111;color:#fff;font-size:12px;font-weight:600;line-height:1;text-decoration:none;"> æ­£é«”ä¸­æ–‡ </a> <span style="width:1px;height:18px;background:rgba(0,0,0,.12);"></span> <a href="https://zh-hans.zhgchg.li/posts/kkday-tech-blog/ios-vision-framework-wwdc-24-swift-concurrency-%E4%B8%8E%E6%96%B0-api-%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90%E4%B8%8E%E5%AE%9E%E4%BD%9C%E6%8C%87%E5%8D%97-755509180ca8/" style="display:inline-flex;align-items:center;justify-content:center;padding:6px 10px;border-radius:999px;border:1px solid #ccc;background:#f3f3f3;color:#555;font-size:12px;font-weight:600;line-height:1;text-decoration:none;"> ç®€ä½“ä¸­æ–‡ </a></div><div aria-label="Language switch" style="display:flex;align-items:center;justify-content:center;gap:5px;margin-top:5px;"> <a href="https://en.zhgchg.li/posts/kkday-tech-blog/ios-vision-framework-explore-swift-api-enhancements-from-wwdc-24-session-755509180ca8/" style="display:inline-flex;align-items:center;justify-content:center;padding:6px 10px;border-radius:999px;border:1px solid #ccc;background:#f3f3f3;color:#555;font-size:12px;font-weight:600;line-height:1;text-decoration:none;"> English </a> <span style="width:1px;height:18px;background:rgba(0,0,0,.12);"></span> <a href="https://jp.zhgchg.li/posts/kkday-tech-blog/ios-vision-framework-wwdc-24%E3%81%A7swift%E5%BC%B7%E5%8C%96%E3%82%92%E8%A7%A3%E8%AA%AC-vision-framework%E6%9C%80%E6%96%B0%E6%A9%9F%E8%83%BD%E3%82%92%E5%BE%B9%E5%BA%95%E3%83%AC%E3%83%93%E3%83%A5%E3%83%BC-755509180ca8/" style="display:inline-flex;align-items:center;justify-content:center;padding:6px 10px;border-radius:999px;border:1px solid #ccc;background:#f3f3f3;color:#555;font-size:12px;font-weight:600;line-height:1;text-decoration:none;"> æ—¥æœ¬èª </a></div></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">é¦–é </a> </span> <span>iOS Vision frameworkï½œWWDC 24 Swift Concurrency èˆ‡æ–° API æ·±åº¦è§£æèˆ‡å¯¦ä½œæŒ‡å—</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> æ–‡ç« </div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="æœå°‹..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">å–æ¶ˆ</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>iOS Vision frameworkï½œWWDC 24 Swift Concurrency èˆ‡æ–° API æ·±åº¦è§£æèˆ‡å¯¦ä½œæŒ‡å—</h1><p class="post-desc fw-light mb-4">iOS é–‹ç™¼è€…é¢å° Vision framework è¤‡é›œåœ–åƒè¾¨è­˜éœ€æ±‚ï¼Œé€é WWDC 24 Swift Concurrency æ–° APIï¼ŒæŒæ¡ 31 ç¨®åœ–åƒè¾¨è­˜è«‹æ±‚èˆ‡èº«é«”æ‰‹å‹¢è¿½è¹¤ï¼Œæå‡è¾¨è­˜æ•ˆç‡èˆ‡å®‰å…¨æ€§ï¼Œå¯¦ç¾é«˜æ•ˆåœ–åƒåˆ†æèˆ‡å³æ™‚æ‡‰ç”¨ã€‚</p><div class="post-meta text-muted"> <span> ç™¼ä½ˆæ–¼ <time data-ts="1723536637" data-df="YYYY å¹´ M æœˆ D æ—¥" data-bs-toggle="tooltip" data-bs-placement="bottom" > 2024 å¹´ 08 æœˆ 13 æ—¥ </time> </span> <span> æ›´æ–°æ–¼ <time data-ts="1723637269" data-df="YYYY å¹´ M æœˆ D æ—¥" data-bs-toggle="tooltip" data-bs-placement="bottom" > 2024 å¹´ 08 æœˆ 14 æ—¥ </time> </span><div class="mt-3 mb-3"> <a href="/assets/755509180ca8/1*NqN-_MAE4tt11n6MnUQWxQ.webp" class="popup img-link preview-img blur"><img data-src="/assets/755509180ca8/1*NqN-_MAE4tt11n6MnUQWxQ.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></div><div class="d-flex justify-content-between"> <span style="display: inline-flex; align-items: center; gap: 4px;"> ä½œè€… <em> <a href="https://www.linkedin.com/in/zhgchgli">ZhgChgLi</a> </em> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" style="display: block; "><path fill="#007bff" d="M271.2 56C265.1 49.8 256.2 47.3 247.8 49.6C239.4 51.9 232.9 58.4 230.8 66.8L215.5 127C214.4 131.4 209.9 134 205.6 132.7L145.8 115.9C137.4 113.5 128.4 115.9 122.3 122C116.2 128.1 113.8 137.1 116.2 145.5L133.1 205.3C134.3 209.6 131.7 214.1 127.4 215.2L67.1 230.5C58.7 232.6 52.1 239.2 49.8 247.6C47.5 256 50 264.9 56.2 271L100.7 314.3C103.9 317.4 103.9 322.6 100.7 325.8L56.3 369.1C50.1 375.2 47.6 384.1 49.9 392.5C52.2 400.9 58.8 407.4 67.2 409.6L127.4 424.9C131.8 426 134.4 430.5 133.1 434.8L116.2 494.5C113.8 502.9 116.2 511.9 122.3 518C128.4 524.1 137.4 526.5 145.8 524.1L205.6 507.2C209.9 506 214.4 508.6 215.5 512.9L230.8 573.1C232.9 581.5 239.5 588.1 247.9 590.4C256.3 592.7 265.2 590.2 271.3 584L314.6 539.5C317.7 536.3 322.9 536.3 326.1 539.5L369.3 584C375.4 590.2 384.3 592.7 392.7 590.4C401.1 588.1 407.6 581.5 409.8 573.1L425.1 513C426.2 508.6 430.7 506 435 507.3L494.8 524.2C503.2 526.6 512.2 524.2 518.3 518.1C524.4 512 526.8 503 524.4 494.6L507.5 434.8C506.3 430.5 508.9 426 513.2 424.9L573.4 409.6C581.8 407.5 588.4 400.9 590.7 392.5C593 384.1 590.5 375.1 584.3 369.1L539.8 325.8C536.6 322.7 536.6 317.5 539.8 314.3L584.3 271C590.5 264.9 593 256 590.7 247.6C588.4 239.2 581.8 232.7 573.4 230.5L513.2 215.2C508.8 214.1 506.2 209.6 507.5 205.3L524.4 145.5C526.8 137.1 524.4 128.1 518.3 122C512.2 115.9 503.2 113.5 494.8 115.9L435 132.8C430.7 134 426.2 131.4 425.1 127.1L409.8 66.8C407.7 58.4 401.1 51.8 392.7 49.5C384.3 47.2 375.4 49.7 369.3 55.9L326 100.5C322.9 103.7 317.7 103.7 314.5 100.5L271.2 56z"/><path d="M250 330 l60 60 100 -140" stroke="#ffffff" stroke-width="40" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="6107 å­—" > <em>33 åˆ†é˜</em>é–±è®€</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">iOS Vision frameworkï½œWWDC 24 Swift Concurrency èˆ‡æ–° API æ·±åº¦è§£æèˆ‡å¯¦ä½œæŒ‡å—</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">ç« ç¯€ç›®éŒ„ ğŸ”–</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">iOS Vision frameworkï½œWWDC 24 Swift Concurrency èˆ‡æ–° API æ·±åº¦è§£æèˆ‡å¯¦ä½œæŒ‡å—</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><div aria-label="Language switch" style="display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;"><div aria-label="Views" style="display:inline-flex;align-items:center;gap:6px;font-size:.85rem;"> <span style="display:inline-flex;align-items:center;justify-content:center;"> ç€è¦½æ¬¡æ•¸: <span style="margin-left:4px;" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-original-title="æœ€å¾Œæ›´æ–°æ™‚é–“: 2026-01-18 11:11:57 +08:00"><u>3,631+</u></span> </span></div><div style="display:flex;align-items:center;justify-content:flex-end;gap:8px;flex-wrap:wrap;"> <a href="https://zhgchg.li/posts/kkday-tech-blog/ios-vision-framework-wwdc-24-swift-concurrency-%E8%88%87%E6%96%B0-api-%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90%E8%88%87%E5%AF%A6%E4%BD%9C%E6%8C%87%E5%8D%97-755509180ca8/" style="display:inline-flex;align-items:center;justify-content:center;padding:6px 10px;border-radius:999px;border:1px solid #dc3545;background:#dc3545;color:#fff !important;font-size:12px;font-weight:600;line-height:1;text-decoration:none;"> æ­£é«”ä¸­æ–‡ </a> <a href="https://zh-hans.zhgchg.li/posts/kkday-tech-blog/ios-vision-framework-wwdc-24-swift-concurrency-%E4%B8%8E%E6%96%B0-api-%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90%E4%B8%8E%E5%AE%9E%E4%BD%9C%E6%8C%87%E5%8D%97-755509180ca8/" style="display:inline-flex;align-items:center;justify-content:center;padding:6px 10px;border-radius:999px;border:1px solid rgba(220,53,69,.35);background:rgba(220,53,69,.08);color:#dc3545 !important;font-size:12px;font-weight:600;line-height:1;text-decoration:none;"> ç®€ä½“ä¸­æ–‡ </a> <a href="https://en.zhgchg.li/posts/kkday-tech-blog/ios-vision-framework-explore-swift-api-enhancements-from-wwdc-24-session-755509180ca8/" style="display:inline-flex;align-items:center;justify-content:center;padding:6px 10px;border-radius:999px;border:1px solid rgba(220,53,69,.35);background:rgba(220,53,69,.08);color:#dc3545 !important;font-size:12px;font-weight:600;line-height:1;text-decoration:none;"> English </a> <a href="https://jp.zhgchg.li/posts/kkday-tech-blog/ios-vision-framework-wwdc-24%E3%81%A7swift%E5%BC%B7%E5%8C%96%E3%82%92%E8%A7%A3%E8%AA%AC-vision-framework%E6%9C%80%E6%96%B0%E6%A9%9F%E8%83%BD%E3%82%92%E5%BE%B9%E5%BA%95%E3%83%AC%E3%83%93%E3%83%A5%E3%83%BC-755509180ca8/" style="display:inline-flex;align-items:center;justify-content:center;padding:6px 10px;border-radius:999px;border:1px solid rgba(220,53,69,.35);background:rgba(220,53,69,.08);color:#dc3545 !important;font-size:12px;font-weight:600;line-height:1;text-decoration:none;"> æ—¥æœ¬èª </a></div></div><blockquote class="prompt-info"><p>åŸºæ–¼ SEO è€ƒé‡ï¼Œæœ¬æ–‡æ¨™é¡Œèˆ‡æè¿°ç¶“ AI èª¿æ•´ï¼ŒåŸå§‹ç‰ˆæœ¬è«‹åƒè€ƒå…§æ–‡ã€‚</p></blockquote><h4 id="zhgchgli-table-of-contents">æ–‡ç« ç›®éŒ„</h4><nav class="zhgchgli-toc"><ul class="zhgchgli-toc-list"><li class="has-children"><details><summary>iOS Vision framework x WWDC 24 Discover Swift enhancements in the Vision framework Session <a href="#ios-vision-framework-x-wwdc-24-discover-swift-enhancements-in-the-vision-framework-session">#</a></summary><ul><li><a href="#ä¸»é¡Œ">ä¸»é¡Œ</a></li></ul></details></li><li class="has-children"><details><summary>Vision framework <a href="#vision-framework">#</a></summary><ul><li><a href="#coreml">CoreML</a></li><li><a href="#ps">p.s.</a></li></ul></details></li><li><a href="#wwdc-2024--discover-swift-enhancements-in-the-vision-framework">WWDC 2024 â€” Discover Swift enhancements in the Vision framework</a></li><li class="has-children"><details><summary>Introduction â€” Vision framework Features <a href="#introduction--vision-framework-features">#</a></summary><ul><li><a href="#äººè‡‰è¾¨è­˜è¼ªå»“è­˜åˆ¥">äººè‡‰è¾¨è­˜ã€è¼ªå»“è­˜åˆ¥</a></li><li><a href="#åœ–åƒå…§å®¹æ–‡å­—è¾¨è­˜">åœ–åƒå…§å®¹æ–‡å­—è¾¨è­˜</a></li><li><a href="#å‹•æ…‹å‹•ä½œæ•æ‰">å‹•æ…‹å‹•ä½œæ•æ‰</a></li><li><a href="#whats-new-in-vision-ios-18-åœ–ç‰‡è©•åˆ†åŠŸèƒ½-å“è³ªè¨˜æ†¶é»">Whatâ€™s new in Vision? (iOS 18)â€” åœ–ç‰‡è©•åˆ†åŠŸèƒ½ (å“è³ªã€è¨˜æ†¶é»)</a></li><li><a href="#whats-new-in-vision-ios-18--èº«é«”æ‰‹å‹¢å§¿å‹¢åŒæ™‚åµæ¸¬">Whatâ€™s new in Vision? (iOS 18) â€” èº«é«”ï¼‹æ‰‹å‹¢å§¿å‹¢åŒæ™‚åµæ¸¬</a></li></ul></details></li><li><a href="#new-vision-api">New Vision API</a></li><li><a href="#get-started-with-vision">Get started with Vision</a></li><li class="has-children"><details><summary>å…¨éƒ¨ 31 ç¨®è«‹æ±‚ Request <a href="#å…¨éƒ¨-31-ç¨®è«‹æ±‚-request">#</a></summary><ul><li><a href="#classifyimagerequest">ClassifyImageRequest</a></li><li><a href="#recognizetextrequest">RecognizeTextRequest</a></li><li><a href="#detectbarcodesrequest">DetectBarcodesRequest</a></li><li><a href="#recognizeanimalsrequest">RecognizeAnimalsRequest</a></li><li><a href="#å…¶ä»–">å…¶ä»–</a></li><li><a href="#ios--18-update-highlight">iOS â‰¥ 18 Update Highlight</a></li></ul></details></li><li class="has-children"><details><summary>WWDC Example <a href="#wwdc-example">#</a></summary><ul><li><a href="#é¦–å…ˆå¤§å¤šæ•¸çš„å•†å“éƒ½æœ‰-barcode-å¯ä¾›æƒæ">é¦–å…ˆå¤§å¤šæ•¸çš„å•†å“éƒ½æœ‰ Barcode å¯ä¾›æƒæ</a></li><li><a href="#éƒ¨åˆ†å•†å“ç„¡-barcodeå¦‚æ•£è£æ°´æœåªæœ‰å•†å“æ¨™ç±¤">éƒ¨åˆ†å•†å“ç„¡ Barcodeï¼Œå¦‚æ•£è£æ°´æœåªæœ‰å•†å“æ¨™ç±¤</a></li><li><a href="#ios--18-performall--æ–¹æ³•">iOS â‰¥ 18 performAll( ) æ–¹æ³•</a></li></ul></details></li><li class="has-children"><details><summary>Optimize with Swift Concurrency <a href="#optimize-with-swift-concurrency">#</a></summary><ul><li><a href="#åŸå§‹å¯«æ³•">åŸå§‹å¯«æ³•</a></li><li><a href="#å„ªåŒ–-1--taskgroup-concurrency">å„ªåŒ– (1) â€” TaskGroup Concurrency</a></li><li><a href="#å„ªåŒ–-2--taskgroup-concurrency--é™åˆ¶ä¸¦è¡Œæ•¸é‡">å„ªåŒ– (2) â€” TaskGroup Concurrency + é™åˆ¶ä¸¦è¡Œæ•¸é‡</a></li></ul></details></li><li><a href="#update-an-existing-vision-app">Update an existing Vision app</a></li><li><a href="#wrap-up">Wrap-up</a></li><li><a href="#thanks">Thanks!</a></li><li class="has-children"><details><summary>KKday æ‹›å‹Ÿå·¥å•† <a href="#kkday-æ‹›å‹Ÿå·¥å•†">#</a></summary><ul><li><a href="#åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™</a></li><li><a href="#discover-swift-enhancements-in-the-vision-framework">Discover Swift enhancements in the Vision framework</a></li></ul></details></li><li class="has-children"><details><summary>Chapters <a href="#chapters">#</a></summary><ul><li><a href="#vision-framework-apple-developer-documentation">Vision framework Apple Developer Documentation</a></li></ul></details></li></ul></nav><hr /><h3 id="ios-vision-framework-x-wwdc-24-discover-swift-enhancements-in-the-vision-framework-session"><span class="me-2">iOS Vision framework x WWDC 24 Discover Swift enhancements in the Vision framework Session</span><a href="#ios-vision-framework-x-wwdc-24-discover-swift-enhancements-in-the-vision-framework-session" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Vision framework åŠŸèƒ½å›é¡§ &amp; iOS 18 æ–° Swift API è©¦ç©</p><p><a href="/assets/755509180ca8/1*NqN-_MAE4tt11n6MnUQWxQ.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*NqN-_MAE4tt11n6MnUQWxQ.webp" alt="Photo by [BoliviaInteligente](https://unsplash.com/@boliviainteligente?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9Ijc1MCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Photo by <a href="https://unsplash.com/@boliviainteligente?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash" target="_blank">BoliviaInteligente</a></p><h4 id="ä¸»é¡Œ"><span class="me-2">ä¸»é¡Œ</span><a href="#ä¸»é¡Œ" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/755509180ca8/1*ebqm2jzCK1GSrDDY0XtrUA.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*ebqm2jzCK1GSrDDY0XtrUA.webp" alt="è·Ÿ Vision Pro çš„é—œä¿‚å°±è·Ÿç†±ç‹—è·Ÿç‹—çš„é—œä¿‚ä¸€æ¨£ï¼Œæ¯«ç„¡é—œä¿‚ã€‚" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MDAiIGhlaWdodD0iNTYwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>è·Ÿ Vision Pro çš„é—œä¿‚å°±è·Ÿç†±ç‹—è·Ÿç‹—çš„é—œä¿‚ä¸€æ¨£ï¼Œæ¯«ç„¡é—œä¿‚ã€‚</p><h3 id="vision-framework"><span class="me-2">Vision framework</span><a href="#vision-framework" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Vision framework æ˜¯ Apple æ•´åˆæ©Ÿå™¨å­¸ç¿’çš„åœ–åƒè¾¨è­˜æ¡†æ¶ï¼Œè®“é–‹ç™¼è€…å¯ä»¥ç°¡å–®å¿«é€Ÿåœ°å¯¦ç¾å¸¸è¦‹çš„åœ–åƒè¾¨è­˜åŠŸèƒ½ï¼›Vision framework æ—©åœ¨ iOS 11.0+ (2017/ iPhone 8) å°±å·²æ¨å‡ºï¼ŒæœŸé–“ä¸æ–·åœ°è¿­ä»£å„ªåŒ–ï¼Œä¸¦å®Œå–„èˆ‡ Swift Concurrency çš„ç‰¹æ€§æ•´åˆæå‡åŸ·è¡Œæ•ˆèƒ½ï¼Œä¸¦ä¸”å¾ iOS 18.0 æä¾›å…¨æ–°çš„ Swift Vision framework API ç™¼æ® Swift Concurrency æœ€å¤§æ•ˆæœã€‚</p><p><strong>Vision framework ç‰¹è‰²</strong></p><ul><li>å…§å»ºçœ¾å¤šåœ–ç‰‡è¾¨è­˜ã€å‹•æ…‹è¿½è¹¤æ–¹æ³• (iOS 18 ç‚ºæ­¢ä¸€å…± 31 ç¨®)<li>On-Device å–®ç´”ä½¿ç”¨æ‰‹æ©Ÿæ™¶ç‰‡é‹ç®—ï¼Œè¾¨è­˜éç¨‹ä¸ä¾è³´é›²ç«¯æœå‹™ï¼Œå¿«é€Ÿåˆå®‰å…¨<li>API ç°¡å–®å¥½æ“ä½œ<li>Apple å…¨å¹³å°å‡æ”¯æ´ iOS 11.0+, iPadOS 11.0+, Mac Catalyst 13.0+, macOS 10.13+, tvOS 11.0+, visionOS 1.0+<li>å·²ç™¼å¸ƒå¤šå¹´ (2017~ä»Š) ä¸”ä¸æ–·æ›´æ–°<li>æ•´åˆ Swift èªè¨€ç‰¹æ€§æå‡é‹ç®—æ•ˆèƒ½</ul><blockquote><p><strong><em>6 å¹´å‰æ›¾ç¶“å°ç©éï¼š <a href="https://zhgchg.li/posts/zrealm-dev/vision%E6%A1%86%E6%9E%B6swift%E6%95%99%E5%AD%B8-app%E8%87%AA%E5%8B%95%E4%BA%BA%E8%87%89%E8%AD%98%E5%88%A5%E8%A3%81%E5%9C%96%E5%AF%A6%E4%BD%9C%E6%8C%87%E5%8D%97-9a9aa892f9a9/">Vision åˆæ¢ â€” APP é ­åƒä¸Šå‚³ è‡ªå‹•è­˜åˆ¥äººè‡‰è£åœ– (Swift)</a></em></strong></p></blockquote><blockquote><p><em>é€™æ¬¡æ­é… <a href="https://developer.apple.com/videos/play/wwdc2024/10163/" target="_blank">WWDC 24 Discover Swift enhancements in the Vision framework Session</a> é‡æ–°å›é¡§ä¸¦çµåˆæ–°çš„ Swfit ç‰¹æ€§å†ç©ä¸€æ¬¡ã€‚</em></p></blockquote><h4 id="coreml"><span class="me-2">CoreML</span><a href="#coreml" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Apple é‚„æœ‰å¦å¤–ä¸€å€‹ Framework å« <a href="https://developer.apple.com/documentation/coreml" target="_blank">CoreML</a> ï¼Œä¹Ÿæ˜¯åŸºæ–¼ On-Device æ™¶ç‰‡çš„æ©Ÿå™¨å­¸ç¿’æ¡†æ¶ï¼›ä½†ä»–å¯ä»¥è®“ä½ è‡ªå·±è¨“ç·´æƒ³è¾¨è­˜çš„ç‰©ä»¶ã€æ–‡ä»¶æ¨¡å‹ï¼Œä¸¦å°‡æ¨¡å‹æ”¾åˆ° App ä¸­ç›´æ¥ä½¿ç”¨ï¼Œæœ‰èˆˆè¶£çš„æœ‹å‹ä¹Ÿå¯ä»¥ç©çœ‹çœ‹ã€‚(e.g. <a href="https://zhgchg.li/posts/zrealm-dev/ios-12-coreml-%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92%E6%96%87%E5%AD%97%E5%88%86%E9%A1%9E-%E8%87%AA%E8%A8%82%E6%A8%A1%E5%9E%8B%E8%A8%93%E7%B7%B4%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8-793bf2cdda0f/">å³æ™‚æ–‡ç« åˆ†é¡</a> ã€å³æ™‚ <a href="https://apps.apple.com/tw/app/%E7%86%8A%E7%8C%AB%E5%90%83%E7%9F%AD%E4%BF%A1-%E5%9E%83%E5%9C%BE%E7%9F%AD%E4%BF%A1%E8%BF%87%E6%BB%A4/id1319191852" target="_blank">åƒåœ¾è¨Šæ¯æª¢æ¸¬</a> â€¦)</p><h4 id="ps"><span class="me-2">p.s.</span><a href="#ps" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="https://developer.apple.com/documentation/vision/" target="_blank"><strong>Vision</strong></a> <strong>v.s. <a href="https://developer.apple.com/documentation/visionkit" target="_blank">VisionKit</a> ï¼š</strong></p><blockquote><p><a href="https://developer.apple.com/documentation/vision/" target="_blank"><strong><em>Vision</em></strong></a> <em>ï¼šä¸»è¦ç”¨æ–¼åœ–åƒåˆ†æä»»å‹™ï¼Œå¦‚è‡‰éƒ¨è­˜åˆ¥ã€æ¢ç¢¼æª¢æ¸¬ã€æ–‡æœ¬è­˜åˆ¥ç­‰ã€‚å®ƒæä¾›äº†å¼·å¤§çš„ API ä¾†è™•ç†å’Œåˆ†æéœæ…‹åœ–åƒæˆ–è¦–é »ä¸­çš„è¦–è¦ºå…§å®¹ã€‚</em></p></blockquote><blockquote><p><a href="https://developer.apple.com/documentation/visionkit" target="_blank"><strong><em>VisionKit</em></strong></a> <em>ï¼šå°ˆé–€ç”¨æ–¼è™•ç†èˆ‡æ–‡ä»¶æƒæç›¸é—œçš„ä»»å‹™ã€‚å®ƒæä¾›äº†ä¸€å€‹æƒæå„€è¦–åœ–æ§åˆ¶å™¨ï¼Œå¯ä»¥ç”¨ä¾†æƒææ–‡æª”ï¼Œä¸¦ç”Ÿæˆé«˜è³ªé‡çš„ PDF æˆ–åœ–åƒã€‚</em></p></blockquote><p>Vision framework åœ¨ M1 æ©Ÿå‹ä¸Šç„¡æ³•è·‘åœ¨æ¨¡æ“¬å™¨ï¼Œåªèƒ½æ¥å¯¦é«”æ‰‹æ©Ÿæ¸¬è©¦ï¼›åœ¨æ¨¡æ“¬å™¨ç’°å¢ƒåŸ·è¡Œæœƒæ‹‹å‡º <code class="language-plaintext highlighter-rouge">Could not create Espresso context</code> Errorï¼ŒæŸ¥ <a href="https://forums.developer.apple.com/forums/thread/675806" target="_blank">å®˜æ–¹è«–å£‡è¨è«–ï¼Œæ²’æ‰¾åˆ°è§£ç­”</a> ã€‚</p><blockquote><p><em>å› æ‰‹é‚Šæ²’æœ‰å¯¦é«” iOS 18 è£ç½®é€²è¡Œæ¸¬è©¦ï¼Œæ‰€ä»¥æœ¬æ–‡ä¸­çš„æ‰€æœ‰åŸ·è¡Œçµæœéƒ½æ˜¯ä½¿ç”¨èˆŠçš„ (iOS 18 ä»¥å‰) çš„å¯«æ³•çµæœï¼› <strong>å¦‚æ–°å¯«æ³•æœ‰å‡ºç¾éŒ¯èª¤å†éº»ç…©ç•™è¨€æŒ‡æ•™</strong> ã€‚</em></p></blockquote><h3 id="wwdc-2024--discover-swift-enhancements-in-the-vision-framework"><span class="me-2">WWDC 2024 â€” Discover Swift enhancements in the Vision framework</span><a href="#wwdc-2024--discover-swift-enhancements-in-the-vision-framework" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/755509180ca8/1*8N5GtY1uqxP-4iAAAticOA.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*8N5GtY1uqxP-4iAAAticOA.webp" alt="[Discover Swift enhancements in the Vision framework](https://developer.apple.com/videos/play/wwdc2024/10163/?time=45){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MTEiIGhlaWdodD0iNDUyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="https://developer.apple.com/videos/play/wwdc2024/10163/?time=45" target="_blank">Discover Swift enhancements in the Vision framework</a></p><blockquote><p><em>æœ¬æ–‡æ˜¯é‡å° WWDC 24 â€” <a href="https://developer.apple.com/videos/play/wwdc2024/10163/?time=45" target="_blank">Discover Swift enhancements in the Vision framework</a> Session çš„åˆ†äº«ç­†è¨˜ï¼Œè·Ÿä¸€äº›è‡ªå·±å¯¦é©—çš„å¿ƒå¾—ã€‚</em></p></blockquote><h3 id="introduction--vision-framework-features"><span class="me-2">Introduction â€” Vision framework Features</span><a href="#introduction--vision-framework-features" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="äººè‡‰è¾¨è­˜è¼ªå»“è­˜åˆ¥"><span class="me-2">äººè‡‰è¾¨è­˜ã€è¼ªå»“è­˜åˆ¥</span><a href="#äººè‡‰è¾¨è­˜è¼ªå»“è­˜åˆ¥" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/755509180ca8/1*RNGfE_EeaQhiKAPdJeFYQw.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*RNGfE_EeaQhiKAPdJeFYQw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MjYiIGhlaWdodD0iNDgyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/755509180ca8/1*iMdzeLm2aWjATVV6_Kvrjg.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*iMdzeLm2aWjATVV6_Kvrjg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MDciIGhlaWdodD0iNDQ4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><h4 id="åœ–åƒå…§å®¹æ–‡å­—è¾¨è­˜"><span class="me-2">åœ–åƒå…§å®¹æ–‡å­—è¾¨è­˜</span><a href="#åœ–åƒå…§å®¹æ–‡å­—è¾¨è­˜" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>æˆªè‡³ iOS 18 ç‚ºæ­¢ï¼Œæ”¯æ´ 18 ç¨®èªè¨€ã€‚</p><p><a href="/assets/755509180ca8/1*kU_OYn5w368h-ahDYU4lDw.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*kU_OYn5w368h-ahDYU4lDw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NTciIGhlaWdodD0iMzk1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="c1">// æ”¯æ´çš„èªç³»åˆ—è¡¨</span>
<span class="k">if</span> <span class="k">#available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">18.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">print</span><span class="p">(</span><span class="kt">RecognizeTextRequest</span><span class="p">()</span><span class="o">.</span><span class="n">supportedRecognitionLanguages</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="s">"</span><span class="se">\(</span><span class="nv">$0</span><span class="o">.</span><span class="n">languageCode</span><span class="o">!</span><span class="se">)</span><span class="s">-</span><span class="se">\(</span><span class="p">(</span><span class="nv">$0</span><span class="o">.</span><span class="n">region</span><span class="p">?</span><span class="o">.</span><span class="n">identifier</span> <span class="p">??</span> <span class="nv">$0</span><span class="o">.</span><span class="n">script</span><span class="p">?</span><span class="o">.</span><span class="n">identifier</span><span class="p">)</span><span class="o">!</span><span class="se">)</span><span class="s">"</span> <span class="p">})</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="nf">print</span><span class="p">(</span><span class="k">try!</span> <span class="kt">VNRecognizeTextRequest</span><span class="p">()</span><span class="o">.</span><span class="nf">supportedRecognitionLanguages</span><span class="p">())</span>
<span class="p">}</span>

<span class="c1">// å¯¦éš›å¯ç”¨è¾¨è­˜èªè¨€ä»¥é€™ç‚ºä¸»ã€‚</span>
<span class="c1">// å¯¦æ¸¬ iOS 18 è¼¸å‡ºä»¥ä¸‹çµæœï¼š</span>
<span class="c1">// ["en-US", "fr-FR", "it-IT", "de-DE", "es-ES", "pt-BR", "zh-Hans", "zh-Hant", "yue-Hans", "yue-Hant", "ko-KR", "ja-JP", "ru-RU", "uk-UA", "th-TH", "vi-VT", "ar-SA", "ars-SA"]</span>
<span class="c1">// æœªçœ‹åˆ° WWDC æåˆ°çš„ Swedish èªè¨€ï¼Œä¸ç¢ºå®šæ˜¯é‚„æ²’æ¨å‡ºé‚„æ˜¯è·Ÿè£ç½®åœ°å€ã€èªç³»æœ‰é—œè¯</span>
</pre></table></code></div></div><h4 id="å‹•æ…‹å‹•ä½œæ•æ‰"><span class="me-2">å‹•æ…‹å‹•ä½œæ•æ‰</span><a href="#å‹•æ…‹å‹•ä½œæ•æ‰" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/755509180ca8/1*6TfyCcszdD1NdId0bdM16Q.gif" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*6TfyCcszdD1NdId0bdM16Q.gif" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3OTQiIGhlaWdodD0iNDEwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/755509180ca8/1*8y_XXdH36uKpfP0p6BCJQA.gif" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*8y_XXdH36uKpfP0p6BCJQA.gif" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NTgiIGhlaWdodD0iNDIwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>å¯ä»¥å¯¦ç¾äººã€ç‰©ä»¶å‹•æ…‹æ•æ‰<li>æ‰‹å‹¢è£œæ‰å¯¦ç¾éš”ç©ºç°½ååŠŸèƒ½</ul><h4 id="whats-new-in-vision-ios-18-åœ–ç‰‡è©•åˆ†åŠŸèƒ½-å“è³ªè¨˜æ†¶é»"><span class="me-2">Whatâ€™s new in Vision? (iOS 18)â€” åœ–ç‰‡è©•åˆ†åŠŸèƒ½ (å“è³ªã€è¨˜æ†¶é»)</span><a href="#whats-new-in-vision-ios-18-åœ–ç‰‡è©•åˆ†åŠŸèƒ½-å“è³ªè¨˜æ†¶é»" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>å¯å°è¼¸å…¥åœ–ç‰‡å¾—è¨ˆç®—å‡ºåˆ†æ•¸ï¼Œæ–¹ä¾¿ç¯©é¸å‡ºå„ªè³ªç…§ç‰‡<li>åˆ†æ•¸è¨ˆç®—æ–¹å¼åŒ…å«å¤šå€‹ç¶­åº¦ï¼Œä¸åªæ˜¯ç•«è³ªï¼Œé‚„æœ‰å…‰ç·šã€è§’åº¦ã€æ‹æ”ä¸»é«”ã€ <strong>æ˜¯å¦æœ‰è®“äººæ„Ÿåˆ°çš„è¨˜æ†¶é»</strong> â€¦ç­‰ç­‰</ul><p><a href="/assets/755509180ca8/1*XwjeaHcB6arxJhIR7cFsWg.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*XwjeaHcB6arxJhIR7cFsWg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MTIiIGhlaWdodD0iNDQ5Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/755509180ca8/1*YdhZlZBlTaIZd4nLxhBtaQ.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*YdhZlZBlTaIZd4nLxhBtaQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MDgiIGhlaWdodD0iNDUwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/755509180ca8/1*IhMDFdk6DWwTv1qIG0Gi0Q.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*IhMDFdk6DWwTv1qIG0Gi0Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MDkiIGhlaWdodD0iNDQxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>WWDC ä¸­çµ¦äº†ä»¥ä¸Šä¸‰å¼µåœ–ç‰‡åšèªªæ˜(ç›¸åŒç•«è³ªä¹‹ä¸‹)ï¼Œåˆ†åˆ¥æ˜¯ï¼š</p><ul><li>é«˜åˆ†çš„åœ–ç‰‡ï¼šå–æ™¯ã€å…‰ç·šã€æœ‰è¨˜æ†¶é»<li>ä½åˆ†çš„åœ–ç‰‡ï¼šæ²’æœ‰ä¸»é«”ã€åƒæ˜¯éš¨æ‰‹æˆ–ä¸å°å¿ƒæ‹çš„<li>ç´ æçš„åœ–ç‰‡ï¼šæŠ€è¡“ä¸Šæ‹çš„å¾ˆå¥½ä½†æ˜¯æ²’æœ‰è¨˜æ†¶é»ï¼Œåƒæ˜¯ä½œç‚ºç´ æåœ–åº«ç”¨çš„åœ–ç‰‡</ul><p><strong>iOS â‰¥ 18 New API: <a href="https://developer.apple.com/documentation/vision/calculateimageaestheticsscoresrequest" target="_blank">CalculateImageAestheticsScoresRequest</a></strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">CalculateImageAestheticsScoresRequest</span><span class="p">()</span>
<span class="k">let</span> <span class="nv">result</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"https://zhgchg.li/assets/cb65fd5ab770/1*yL3vI1ADzwlovctW5WQgJw.jpeg"</span><span class="p">)</span><span class="o">!</span><span class="p">)</span>

<span class="c1">// ç…§ç‰‡åˆ†æ•¸</span>
<span class="nf">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">overallScore</span><span class="p">)</span>

<span class="c1">// æ˜¯å¦è¢«åˆ¤å®šç‚ºç´ æåœ–ç‰‡</span>
<span class="nf">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">isUtility</span><span class="p">)</span>
</pre></table></code></div></div><h4 id="whats-new-in-vision-ios-18--èº«é«”æ‰‹å‹¢å§¿å‹¢åŒæ™‚åµæ¸¬"><span class="me-2">Whatâ€™s new in Vision? (iOS 18) â€” èº«é«”ï¼‹æ‰‹å‹¢å§¿å‹¢åŒæ™‚åµæ¸¬</span><a href="#whats-new-in-vision-ios-18--èº«é«”æ‰‹å‹¢å§¿å‹¢åŒæ™‚åµæ¸¬" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/755509180ca8/1*A9320aRV-jdccgiXrmSrJw.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*A9320aRV-jdccgiXrmSrJw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MDAiIGhlaWdodD0iMzM0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>ä»¥å¾€åªèƒ½å€‹åˆ¥åµæ¸¬äººé«” Pose å’Œ æ‰‹éƒ¨ Poseï¼Œé€™æ¬¡æ›´æ–°å¯ä»¥è®“é–‹ç™¼è€…åŒæ™‚åµæ¸¬èº«é«” Pose + æ‰‹éƒ¨ Poseï¼ŒåˆæˆåŒä¸€å€‹è«‹æ±‚è·Ÿçµæœï¼Œæ–¹ä¾¿æˆ‘å€‘åšæ›´å¤šæ‡‰ç”¨åŠŸèƒ½é–‹ç™¼ã€‚</p><p><strong>iOS â‰¥ 18 New API: <a href="https://developer.apple.com/documentation/vision/detecthumanbodyposerequest" target="_blank">DetectHumanBodyPoseRequest</a></strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="k">var</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">DetectHumanBodyPoseRequest</span><span class="p">()</span>
<span class="c1">// ä¸€ä½µåµæ¸¬æ‰‹éƒ¨ Pose</span>
<span class="n">request</span><span class="o">.</span><span class="n">detectsHands</span> <span class="o">=</span> <span class="kc">true</span>

<span class="k">guard</span> <span class="k">let</span> <span class="nv">bodyPose</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="n">image</span><span class="p">)</span><span class="o">.</span> <span class="n">first</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>

<span class="c1">// èº«é«” Pose Joints</span>
<span class="k">let</span> <span class="nv">bodyJoints</span> <span class="o">=</span> <span class="n">bodyPose</span><span class="o">.</span><span class="nf">allJoints</span><span class="p">()</span>
<span class="c1">// å·¦æ‰‹ Pose Joints</span>
<span class="k">let</span> <span class="nv">leftHandJoints</span> <span class="o">=</span> <span class="n">bodyPose</span><span class="o">.</span><span class="n">leftHand</span><span class="o">.</span><span class="nf">allJoints</span><span class="p">()</span>
<span class="c1">// å³æ‰‹ Pose Joints</span>
<span class="k">let</span> <span class="nv">rightHandJoints</span> <span class="o">=</span> <span class="n">bodyPose</span><span class="o">.</span><span class="n">rightHand</span><span class="o">.</span><span class="nf">allJoints</span><span class="p">()</span>
</pre></table></code></div></div><h3 id="new-vision-api"><span class="me-2">New Vision API</span><a href="#new-vision-api" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Apple åœ¨é€™æ¬¡çš„æ›´æ–°ç•¶ä¸­æä¾›äº†æ–°çš„ Swift Vision API å°è£çµ¦é–‹ç™¼è€…ä½¿ç”¨ï¼Œé™¤äº†åŸºæœ¬çš„åŒ…å«åŸæœ¬çš„åŠŸèƒ½æ”¯æ´ä¹‹å¤–ï¼Œä¸»è¦é‡å°åŠ å¼· Swift 6 / Swift Concurrency çš„ç‰¹æ€§ï¼Œæä¾›æ•ˆèƒ½æ›´å„ªã€å¯«èµ·ä¾†æ›´ Swift çš„ API æ“ä½œæ–¹å¼ã€‚</p><h3 id="get-started-with-vision"><span class="me-2">Get started with Vision</span><a href="#get-started-with-vision" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/755509180ca8/1*mv9g5jmqrS6YScxoGYJemQ.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*mv9g5jmqrS6YScxoGYJemQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NDAiIGhlaWdodD0iNDE5Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/755509180ca8/1*iidNN7nKHoskh_tcjfuHKQ.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*iidNN7nKHoskh_tcjfuHKQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MzgiIGhlaWdodD0iNDAxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>é€™é‚Šè¬›è€…åˆé‡æ–°ä»‹ç´¹äº†ä¸€æ¬¡ Vision framework çš„åŸºç¤ä½¿ç”¨æ–¹å¼ï¼ŒApple å·²ç¶“å°è£å¥½äº† <a href="https://developer.apple.com/documentation/vision/visionrequest" target="_blank">31 ç¨®</a> (æˆªè‡³ iOS 18)å¸¸è¦‹çš„åœ–åƒè¾¨è­˜è«‹æ±‚ã€ŒRequestã€èˆ‡å°æ‡‰å›å‚³çš„ã€ŒObservationã€ç‰©ä»¶ã€‚</p><ol><li><strong>Request:</strong> DetectFaceRectanglesRequest äººè‡‰å€åŸŸè­˜åˆ¥è«‹æ±‚ <strong>Result:</strong> FaceObservation ä¹‹å‰çš„æ–‡ç« ã€Œ <a href="https://zhgchg.li/posts/zrealm-dev/vision%E6%A1%86%E6%9E%B6swift%E6%95%99%E5%AD%B8-app%E8%87%AA%E5%8B%95%E4%BA%BA%E8%87%89%E8%AD%98%E5%88%A5%E8%A3%81%E5%9C%96%E5%AF%A6%E4%BD%9C%E6%8C%87%E5%8D%97-9a9aa892f9a9/">Vision åˆæ¢ â€” APP é ­åƒä¸Šå‚³ è‡ªå‹•è­˜åˆ¥äººè‡‰è£åœ– (Swift)</a> ã€å°±æ˜¯ç”¨é€™å°è«‹æ±‚ã€‚<li><strong>Request:</strong> RecognizeTextRequest æ–‡å­—è¾¨è­˜è«‹æ±‚ <strong>Result:</strong> RecognizedTextObservation<li><strong>Request:</strong> GenerateObjectnessBasedSaliencyImageRequest ä¸»é«”ç‰©ä»¶è¾¨è­˜è«‹æ±‚ <strong>Result:</strong> SaliencyImageObservation</ol><h3 id="å…¨éƒ¨-31-ç¨®è«‹æ±‚-request"><span class="me-2">å…¨éƒ¨ 31 ç¨®è«‹æ±‚ Requestï¼š</span><a href="#å…¨éƒ¨-31-ç¨®è«‹æ±‚-request" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="https://developer.apple.com/documentation/vision/visionrequest" target="_blank">VisionRequest</a> ã€‚</p><div class="table-wrapper"><table><thead><tr><th>Request ç”¨é€”<th>Observation èªªæ˜<tbody><tr><td>CalculateImageAestheticsScoresRequest<br />è¨ˆç®—åœ–åƒçš„ç¾å­¸åˆ†æ•¸ã€‚<td>AestheticsObservation<br />è¿”å›åœ–åƒçš„ç¾å­¸è©•åˆ†ï¼Œå¦‚æ§‹åœ–ã€è‰²å½©ç­‰å› ç´ ã€‚<tr><td>ClassifyImageRequest<br />åˆ†é¡åœ–åƒå…§å®¹ã€‚<td>ClassificationObservation<br />è¿”å›åœ–åƒä¸­ç‰©é«”æˆ–å ´æ™¯çš„åˆ†é¡æ¨™ç±¤åŠç½®ä¿¡åº¦ã€‚<tr><td>CoreMLRequest<br />ä½¿ç”¨ Core ML æ¨¡å‹åˆ†æåœ–åƒã€‚<td>CoreMLFeatureValueObservation<br />æ ¹æ“š Core ML æ¨¡å‹çš„è¼¸å‡ºçµæœç”Ÿæˆè§€å¯Ÿå€¼ã€‚<tr><td>DetectAnimalBodyPoseRequest<br />æª¢æ¸¬åœ–åƒä¸­çš„å‹•ç‰©å§¿å‹¢ã€‚<td>RecognizedPointsObservation<br />è¿”å›å‹•ç‰©çš„éª¨æ¶é»åŠå…¶ä½ç½®ã€‚<tr><td>DetectBarcodesRequest<br />æª¢æ¸¬åœ–åƒä¸­çš„æ¢ç¢¼ã€‚<td>BarcodeObservation<br />è¿”å›æ¢ç¢¼æ•¸æ“šåŠé¡å‹ï¼ˆå¦‚ QR codeï¼‰ã€‚<tr><td>DetectContoursRequest<br />æª¢æ¸¬åœ–åƒä¸­çš„è¼ªå»“ã€‚<td>ContoursObservation<br />è¿”å›åœ–åƒä¸­æª¢æ¸¬åˆ°çš„è¼ªå»“ç·šã€‚<tr><td>DetectDocumentSegmentationRequest<br />æª¢æ¸¬ä¸¦åˆ†å‰²åœ–åƒä¸­çš„æ–‡ä»¶ã€‚<td>RectangleObservation<br />è¿”å›æ–‡ä»¶é‚Šç•Œçš„çŸ©å½¢æ¡†ä½ç½®ã€‚<tr><td>DetectFaceCaptureQualityRequest<br />è©•ä¼°é¢éƒ¨æ•æ‰è³ªé‡ã€‚<td>FaceObservation<br />è¿”å›é¢éƒ¨åœ–åƒçš„è³ªé‡è©•ä¼°åˆ†æ•¸ã€‚<tr><td>DetectFaceLandmarksRequest<br />æª¢æ¸¬é¢éƒ¨ç‰¹å¾µé»ã€‚<td>FaceObservation<br />è¿”å›é¢éƒ¨ç‰¹å¾µé»ï¼ˆå¦‚çœ¼ç›ã€é¼»å­ç­‰ï¼‰çš„è©³ç´°ä½ç½®ã€‚<tr><td>DetectFaceRectanglesRequest<br />æª¢æ¸¬åœ–åƒä¸­çš„é¢éƒ¨ã€‚<td>FaceObservation<br />è¿”å›äººè‡‰çš„é‚Šç•Œæ¡†ä½ç½®ã€‚<tr><td>DetectHorizonRequest<br />æª¢æ¸¬åœ–åƒä¸­çš„åœ°å¹³ç·šã€‚<td>HorizonObservation<br />è¿”å›åœ°å¹³ç·šçš„è§’åº¦å’Œä½ç½®ã€‚<tr><td>DetectHumanBodyPose3DRequest<br />æª¢æ¸¬åœ–åƒä¸­çš„ 3D äººé«”å§¿å‹¢ã€‚<td>RecognizedPointsObservation<br />è¿”å› 3D äººé«”éª¨æ¶é»åŠå…¶ç©ºé–“åæ¨™ã€‚<tr><td>DetectHumanBodyPoseRequest<br />æª¢æ¸¬åœ–åƒä¸­çš„äººé«”å§¿å‹¢ã€‚<td>RecognizedPointsObservation<br />è¿”å›äººé«”éª¨æ¶é»åŠå…¶åæ¨™ã€‚<tr><td>DetectHumanHandPoseRequest<br />æª¢æ¸¬åœ–åƒä¸­çš„æ‰‹éƒ¨å§¿å‹¢ã€‚<td>RecognizedPointsObservation<br />è¿”å›æ‰‹éƒ¨éª¨æ¶é»åŠå…¶ä½ç½®ã€‚<tr><td>DetectHumanRectanglesRequest<br />æª¢æ¸¬åœ–åƒä¸­çš„äººé«”ã€‚<td>HumanObservation<br />è¿”å›äººé«”çš„é‚Šç•Œæ¡†ä½ç½®ã€‚<tr><td>DetectRectanglesRequest<br />æª¢æ¸¬åœ–åƒä¸­çš„çŸ©å½¢ã€‚<td>RectangleObservation<br />è¿”å›çŸ©å½¢çš„å››å€‹é ‚é»åæ¨™ã€‚<tr><td>DetectTextRectanglesRequest<br />æª¢æ¸¬åœ–åƒä¸­çš„æ–‡æœ¬å€åŸŸã€‚<td>TextObservation<br />è¿”å›æ–‡æœ¬å€åŸŸçš„ä½ç½®å’Œé‚Šç•Œæ¡†ã€‚<tr><td>DetectTrajectoriesRequest<br />æª¢æ¸¬ä¸¦åˆ†æç‰©é«”é‹å‹•è»Œè·¡ã€‚<td>TrajectoryObservation<br />è¿”å›é‹å‹•è»Œè·¡é»åŠå…¶æ™‚é–“åºåˆ—ã€‚<tr><td>GenerateAttentionBasedSaliencyImageRequest<br />ç”ŸæˆåŸºæ–¼æ³¨æ„åŠ›çš„é¡¯è‘—æ€§åœ–åƒã€‚<td>SaliencyImageObservation<br />è¿”å›åœ–åƒä¸­æœ€å…·å¸å¼•åŠ›å€åŸŸçš„é¡¯è‘—æ€§åœ°åœ–ã€‚<tr><td>GenerateForegroundInstanceMaskRequest<br />ç”Ÿæˆå‰æ™¯å¯¦ä¾‹æ©è†œåœ–åƒã€‚<td>InstanceMaskObservation<br />è¿”å›å‰æ™¯ç‰©é«”çš„æ©è†œã€‚<tr><td>GenerateImageFeaturePrintRequest<br />ç”Ÿæˆåœ–åƒç‰¹å¾µæŒ‡ç´‹ä»¥é€²è¡Œæ¯”è¼ƒã€‚<td>FeaturePrintObservation<br />è¿”å›åœ–åƒçš„ç‰¹å¾µæŒ‡ç´‹æ•¸æ“šï¼Œç”¨æ–¼ç›¸ä¼¼åº¦æ¯”è¼ƒã€‚<tr><td>GenerateObjectnessBasedSaliencyImageRequest<br />ç”ŸæˆåŸºæ–¼ç‰©é«”é¡¯è‘—æ€§çš„åœ–åƒã€‚<td>SaliencyImageObservation<br />è¿”å›ç‰©é«”é¡¯è‘—æ€§å€åŸŸçš„é¡¯è‘—æ€§åœ°åœ–ã€‚<tr><td>GeneratePersonInstanceMaskRequest<br />ç”Ÿæˆäººç‰©å¯¦ä¾‹æ©è†œåœ–åƒã€‚<td>InstanceMaskObservation<br />è¿”å›äººç‰©å¯¦ä¾‹çš„æ©è†œã€‚<tr><td>GeneratePersonSegmentationRequest<br />ç”Ÿæˆäººç‰©åˆ†å‰²åœ–åƒã€‚<td>SegmentationObservation<br />è¿”å›äººç‰©åˆ†å‰²çš„äºŒå€¼åœ–ã€‚<tr><td>RecognizeAnimalsRequest<br />æª¢æ¸¬ä¸¦è­˜åˆ¥åœ–åƒä¸­çš„å‹•ç‰©ã€‚<td>RecognizedObjectObservation<br />è¿”å›å‹•ç‰©é¡å‹åŠå…¶ç½®ä¿¡åº¦ã€‚<tr><td>RecognizeTextRequest<br />æª¢æ¸¬ä¸¦è­˜åˆ¥åœ–åƒä¸­çš„æ–‡æœ¬ã€‚<td>RecognizedTextObservation<br />è¿”å›æª¢æ¸¬åˆ°çš„æ–‡æœ¬å…§å®¹åŠå…¶å€åŸŸä½ç½®ã€‚<tr><td>TrackHomographicImageRegistrationRequest<br />è·Ÿè¸ªåœ–åƒçš„åŒä½å½±åƒé…æº–ã€‚<td>ImageAlignmentObservation<br />è¿”å›åœ–åƒé–“çš„åŒä½è®Šæ›çŸ©é™£ï¼Œç”¨æ–¼å½±åƒé…æº–ã€‚<tr><td>TrackObjectRequest<br />è·Ÿè¸ªåœ–åƒä¸­çš„ç‰©é«”ã€‚<td>DetectedObjectObservation<br />è¿”å›ç‰©é«”åœ¨å½±åƒä¸­çš„ä½ç½®å’Œé€Ÿåº¦ä¿¡æ¯ã€‚<tr><td>TrackOpticalFlowRequest<br />è·Ÿè¸ªåœ–åƒä¸­çš„å…‰æµã€‚<td>OpticalFlowObservation<br />è¿”å›å…‰æµçŸ¢é‡å ´ï¼Œç”¨æ–¼æè¿°åƒç´ ç§»å‹•æƒ…æ³ã€‚<tr><td>TrackRectangleRequest<br />è·Ÿè¸ªåœ–åƒä¸­çš„çŸ©å½¢ã€‚<td>RectangleObservation<br />è¿”å›çŸ©å½¢åœ¨å½±åƒä¸­çš„ä½ç½®ã€å¤§å°å’Œæ—‹è½‰è§’åº¦ã€‚<tr><td>TrackTranslationalImageRegistrationRequest<br />è·Ÿè¸ªåœ–åƒçš„å¹³ç§»å½±åƒé…æº–ã€‚<td>ImageAlignmentObservation<br />è¿”å›åœ–åƒé–“çš„å¹³ç§»è®Šæ›çŸ©é™£ï¼Œç”¨æ–¼å½±åƒé…æº–ã€‚</table></div><ul><li>å‰é¢è£œä¸Š VN å°±æ˜¯èˆŠçš„ API å¯«æ³• (iOS 18 ä»¥å‰çš„ç‰ˆæœ¬)</ul><p>è¬›è€…æåˆ°äº†å¹¾å€‹å¸¸ç”¨çš„ Requestï¼Œå¦‚ä¸‹ã€‚</p><h4 id="classifyimagerequest"><span class="me-2">ClassifyImageRequest</span><a href="#classifyimagerequest" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>è¾¨è­˜è¼¸å…¥çš„åœ–ç‰‡ï¼Œå¾—åˆ°æ¨™ç±¤åˆ†é¡èˆ‡ç½®ä¿¡åº¦ã€‚</p><p><a href="/assets/755509180ca8/1*8NSQEjxGejujKLbXcILmxQ.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*8NSQEjxGejujKLbXcILmxQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MDAiIGhlaWdodD0iMTIwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/755509180ca8/1*f1rNoOIQbE33M9F9NmoTXg.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*f1rNoOIQbE33M9F9NmoTXg.webp" alt="[éŠè¨˜] 2024 äºŒè¨ªä¹å· 9 æ—¥è‡ªç”±è¡Œï¼Œç¶“é‡œå±±â†’åšå¤šéƒµè¼ªå…¥å¢ƒ" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9Ijc3NyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>[éŠè¨˜] 2024 äºŒè¨ªä¹å· 9 æ—¥è‡ªç”±è¡Œï¼Œç¶“é‡œå±±â†’åšå¤šéƒµè¼ªå…¥å¢ƒ</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre><span class="k">if</span> <span class="k">#available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">18.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// æ–°çš„ä½¿ç”¨ Swift ç‰¹æ€§çš„ API</span>
    <span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">ClassifyImageRequest</span><span class="p">()</span>
    <span class="kt">Task</span> <span class="p">{</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"https://zhgchg.li/assets/cb65fd5ab770/1*yL3vI1ADzwlovctW5WQgJw.jpeg"</span><span class="p">)</span><span class="o">!</span><span class="p">)</span>
            <span class="n">observations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
                <span class="n">observation</span> <span class="k">in</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"</span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">identifier</span><span class="se">)</span><span class="s">: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">confidence</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// èˆŠçš„å¯«æ³•</span>
    <span class="k">let</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kt">VNRequestCompletionHandler</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">request</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="n">error</span><span class="p">)</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">results</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">VNClassificationObservation</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="n">observations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
            <span class="n">observation</span> <span class="k">in</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"</span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">identifier</span><span class="se">)</span><span class="s">: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">confidence</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">VNClassifyImageRequest</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="n">completionHandler</span><span class="p">)</span>
    <span class="kt">DispatchQueue</span><span class="o">.</span><span class="nf">global</span><span class="p">()</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">handler</span> <span class="o">=</span> <span class="kt">VNImageRequestHandler</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"https://zhgchg.li/assets/cb65fd5ab770/1*3_jdrLurFuUfNdW4BJaRww.jpeg"</span><span class="p">)</span><span class="o">!</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[:])</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">try</span> <span class="n">handler</span><span class="o">.</span><span class="nf">perform</span><span class="p">([</span><span class="n">request</span><span class="p">])</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>åˆ†æçµæœï¼š</strong></p><div class="language-r highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="n">outdoor</span><span class="err">ï¼ˆ</span><span class="n">æˆ¶å¤–</span><span class="err">ï¼‰</span><span class="o">:</span><span class="w"> </span><span class="m">0.75392926</span><span class="w">
 </span><span class="err">â€¢</span><span class="w"> </span><span class="n">sky</span><span class="err">ï¼ˆ</span><span class="n">å¤©ç©º</span><span class="err">ï¼‰</span><span class="o">:</span><span class="w"> </span><span class="m">0.75392926</span><span class="w">
 </span><span class="err">â€¢</span><span class="w"> </span><span class="n">blue_sky</span><span class="err">ï¼ˆ</span><span class="n">è—å¤©</span><span class="err">ï¼‰</span><span class="o">:</span><span class="w"> </span><span class="m">0.7519531</span><span class="w">
 </span><span class="err">â€¢</span><span class="w"> </span><span class="n">machine</span><span class="err">ï¼ˆ</span><span class="n">æ©Ÿå™¨</span><span class="err">ï¼‰</span><span class="o">:</span><span class="w"> </span><span class="m">0.6958008</span><span class="w">
 </span><span class="err">â€¢</span><span class="w"> </span><span class="n">cloudy</span><span class="err">ï¼ˆ</span><span class="n">å¤šé›²</span><span class="err">ï¼‰</span><span class="o">:</span><span class="w"> </span><span class="m">0.26538086</span><span class="w">
 </span><span class="err">â€¢</span><span class="w"> </span><span class="n">structure</span><span class="err">ï¼ˆ</span><span class="n">çµæ§‹</span><span class="err">ï¼‰</span><span class="o">:</span><span class="w"> </span><span class="m">0.15728651</span><span class="w">
 </span><span class="err">â€¢</span><span class="w"> </span><span class="n">sign</span><span class="err">ï¼ˆ</span><span class="n">æ¨™èªŒ</span><span class="err">ï¼‰</span><span class="o">:</span><span class="w"> </span><span class="m">0.14224191</span><span class="w">
 </span><span class="err">â€¢</span><span class="w"> </span><span class="n">fence</span><span class="err">ï¼ˆ</span><span class="n">æŸµæ¬„</span><span class="err">ï¼‰</span><span class="o">:</span><span class="w"> </span><span class="m">0.118652344</span><span class="w">
 </span><span class="err">â€¢</span><span class="w"> </span><span class="n">banner</span><span class="err">ï¼ˆ</span><span class="n">æ©«å¹…</span><span class="err">ï¼‰</span><span class="o">:</span><span class="w"> </span><span class="m">0.0793457</span><span class="w">
 </span><span class="err">â€¢</span><span class="w"> </span><span class="n">material</span><span class="err">ï¼ˆ</span><span class="n">ææ–™</span><span class="err">ï¼‰</span><span class="o">:</span><span class="w"> </span><span class="m">0.075975396</span><span class="w">
 </span><span class="err">â€¢</span><span class="w"> </span><span class="n">plant</span><span class="err">ï¼ˆ</span><span class="n">æ¤ç‰©</span><span class="err">ï¼‰</span><span class="o">:</span><span class="w"> </span><span class="m">0.054406323</span><span class="w">
 </span><span class="err">â€¢</span><span class="w"> </span><span class="n">foliage</span><span class="err">ï¼ˆ</span><span class="n">æ¨¹è‘‰</span><span class="err">ï¼‰</span><span class="o">:</span><span class="w"> </span><span class="m">0.05029297</span><span class="w">
 </span><span class="err">â€¢</span><span class="w"> </span><span class="n">light</span><span class="err">ï¼ˆ</span><span class="n">å…‰</span><span class="err">ï¼‰</span><span class="o">:</span><span class="w"> </span><span class="m">0.048126098</span><span class="w">
 </span><span class="err">â€¢</span><span class="w"> </span><span class="n">lamppost</span><span class="err">ï¼ˆ</span><span class="n">ç‡ˆæŸ±</span><span class="err">ï¼‰</span><span class="o">:</span><span class="w"> </span><span class="m">0.048095703</span><span class="w">
 </span><span class="err">â€¢</span><span class="w"> </span><span class="n">billboards</span><span class="err">ï¼ˆ</span><span class="n">å»£å‘Šç‰Œ</span><span class="err">ï¼‰</span><span class="o">:</span><span class="w"> </span><span class="m">0.040039062</span><span class="w">
 </span><span class="err">â€¢</span><span class="w"> </span><span class="n">art</span><span class="err">ï¼ˆ</span><span class="n">è—è¡“</span><span class="err">ï¼‰</span><span class="o">:</span><span class="w"> </span><span class="m">0.03977703</span><span class="w">
 </span><span class="err">â€¢</span><span class="w"> </span><span class="n">branch</span><span class="err">ï¼ˆ</span><span class="n">æ¨¹æ</span><span class="err">ï¼‰</span><span class="o">:</span><span class="w"> </span><span class="m">0.03930664</span><span class="w">
 </span><span class="err">â€¢</span><span class="w"> </span><span class="n">decoration</span><span class="err">ï¼ˆ</span><span class="n">è£é£¾</span><span class="err">ï¼‰</span><span class="o">:</span><span class="w"> </span><span class="m">0.036868922</span><span class="w">
 </span><span class="err">â€¢</span><span class="w"> </span><span class="n">flag</span><span class="err">ï¼ˆ</span><span class="n">æ——å¹Ÿ</span><span class="err">ï¼‰</span><span class="o">:</span><span class="w"> </span><span class="m">0.036865234</span><span class="w">
</span><span class="n">....ç•¥</span><span class="w">
</span></pre></table></code></div></div><h4 id="recognizetextrequest"><span class="me-2">RecognizeTextRequest</span><a href="#recognizetextrequest" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>è¾¨è­˜åœ–ç‰‡ä¸­çš„æ–‡å­—å…§å®¹ã€‚(a.k.a åœ–ç‰‡è½‰æ–‡å­—)</p><p><a href="/assets/755509180ca8/1*XL40lLT774PfO60rCIfnxA.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*XL40lLT774PfO60rCIfnxA.webp" alt="[[éŠè¨˜] 2023 æ±äº¬ 5 æ—¥è‡ªç”±è¡Œ](https://zhgchg.li/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/%E6%9D%B1%E4%BA%AC%E8%87%AA%E7%94%B1%E8%A1%8C%E6%94%BB%E7%95%A5-5-%E5%A4%A9%E9%A3%9F%E4%BD%8F%E8%A1%8C%E5%85%A8%E8%A8%98%E9%8C%84%E8%88%87%E5%BF%85%E8%A8%AA%E6%99%AF%E9%BB%9E%E6%8E%A8%E8%96%A6-9da2c51fa4f2/)" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NjgiIGhlaWdodD0iMTAyNCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="https://zhgchg.li/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/%E6%9D%B1%E4%BA%AC%E8%87%AA%E7%94%B1%E8%A1%8C%E6%94%BB%E7%95%A5-5-%E5%A4%A9%E9%A3%9F%E4%BD%8F%E8%A1%8C%E5%85%A8%E8%A8%98%E9%8C%84%E8%88%87%E5%BF%85%E8%A8%AA%E6%99%AF%E9%BB%9E%E6%8E%A8%E8%96%A6-9da2c51fa4f2/">[éŠè¨˜] 2023 æ±äº¬ 5 æ—¥è‡ªç”±è¡Œ</a></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre><td class="rouge-code"><pre><span class="k">if</span> <span class="k">#available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">18.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// æ–°çš„ä½¿ç”¨ Swift ç‰¹æ€§çš„ API</span>
    <span class="k">var</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">RecognizeTextRequest</span><span class="p">()</span>
    <span class="n">request</span><span class="o">.</span><span class="n">recognitionLevel</span> <span class="o">=</span> <span class="o">.</span><span class="n">accurate</span>
    <span class="n">request</span><span class="o">.</span><span class="n">recognitionLanguages</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">identifier</span><span class="p">:</span> <span class="s">"ja-JP"</span><span class="p">),</span> <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">identifier</span><span class="p">:</span> <span class="s">"en-US"</span><span class="p">)]</span> <span class="c1">// Specify language code, e.g., Traditional Chinese</span>
    <span class="kt">Task</span> <span class="p">{</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"https://zhgchg.li/assets/9da2c51fa4f2/1*fBbNbDepYioQ-3-0XUkF6Q.jpeg"</span><span class="p">)</span><span class="o">!</span><span class="p">)</span>
            <span class="n">observations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
                <span class="n">observation</span> <span class="k">in</span>
                <span class="k">let</span> <span class="nv">topCandidate</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="nf">topCandidates</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
                <span class="nf">print</span><span class="p">(</span><span class="n">topCandidate</span><span class="p">?</span><span class="o">.</span><span class="n">string</span> <span class="p">??</span> <span class="s">"No text recognized"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// èˆŠçš„å¯«æ³•</span>
    <span class="k">let</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kt">VNRequestCompletionHandler</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">request</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="n">error</span><span class="p">)</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">results</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">VNRecognizedTextObservation</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="n">observations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
            <span class="n">observation</span> <span class="k">in</span>
            <span class="k">let</span> <span class="nv">topCandidate</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="nf">topCandidates</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
            <span class="nf">print</span><span class="p">(</span><span class="n">topCandidate</span><span class="p">?</span><span class="o">.</span><span class="n">string</span> <span class="p">??</span> <span class="s">"No text recognized"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">VNRecognizeTextRequest</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="n">completionHandler</span><span class="p">)</span>
    <span class="n">request</span><span class="o">.</span><span class="n">recognitionLevel</span> <span class="o">=</span> <span class="o">.</span><span class="n">accurate</span>
    <span class="n">request</span><span class="o">.</span><span class="n">recognitionLanguages</span> <span class="o">=</span> <span class="p">[</span><span class="s">"ja-JP"</span><span class="p">,</span> <span class="s">"en-US"</span><span class="p">]</span> <span class="c1">// Specify language code, e.g., Traditional Chinese</span>
    <span class="kt">DispatchQueue</span><span class="o">.</span><span class="nf">global</span><span class="p">()</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">handler</span> <span class="o">=</span> <span class="kt">VNImageRequestHandler</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"https://zhgchg.li/assets/9da2c51fa4f2/1*fBbNbDepYioQ-3-0XUkF6Q.jpeg"</span><span class="p">)</span><span class="o">!</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[:])</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">try</span> <span class="n">handler</span><span class="o">.</span><span class="nf">perform</span><span class="p">([</span><span class="n">request</span><span class="p">])</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>åˆ†æçµæœï¼š</strong></p><div class="language-makefile highlighter-rouge"><div class="code-header"> <span data-label-text="Makefile"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="err">LE</span> <span class="err">LABO</span> <span class="err">é’å±±åº—</span>
<span class="nl">TEL</span><span class="o">:</span><span class="nf">03-6419-7167</span>
<span class="err">ï¼ŠãŠè²·ã„ä¸Šã’ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™*</span>
<span class="nl">No</span><span class="o">:</span> <span class="nf">21347</span>
<span class="err">æ—¥ä»˜ï¼š2023/06/10</span> <span class="err">14.14.57</span>
<span class="err">æ‹…å½“ï¼š</span>
<span class="err">1690370</span>
<span class="err">ãƒ¬ã‚¸ï¼š008A</span> <span class="err">1</span>
<span class="err">å•†å“å</span>
<span class="err">ç¨è¾¼ä¸Šä»£æ•°é‡ç¨è¾¼åˆè¨ˆ</span>
<span class="err">ã‚«ã‚¤ã‚¢ãƒƒã‚¯</span> <span class="err">10</span> <span class="err">EDP</span> <span class="err">FB</span> <span class="err">15ML</span>
<span class="err">J1P7010000S</span>
<span class="err">16,800</span>
<span class="err">16,800</span>
<span class="err">ã‚¢ãƒŠã‚¶ãƒ¼</span> <span class="err">13</span> <span class="err">EDP</span> <span class="err">FB</span> <span class="err">15ML</span>
<span class="err">J1PJ010000S</span>
<span class="err">10,700</span>
<span class="err">10,700</span>
<span class="err">ãƒªãƒƒãƒ—ãƒ‘ãƒ¼ãƒ </span> <span class="err">15ML</span>
<span class="err">JOWC010000S</span>
<span class="err">2,000</span>
<span class="err">1</span>
<span class="err">åˆè¨ˆé‡‘é¡</span>
<span class="err">ï¼ˆå†…ç¨é¡ï¼‰</span>
<span class="err">CARD</span>
<span class="err">2,000</span>
<span class="err">3ç‚¹å¾¡è²·ä¸Šã’</span>
<span class="err">29,500</span>
<span class="err">0</span>
<span class="err">29,500</span>
<span class="err">29,500</span>
</pre></table></code></div></div><h4 id="detectbarcodesrequest"><span class="me-2">DetectBarcodesRequest</span><a href="#detectbarcodesrequest" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>åµæ¸¬åœ–ç‰‡ä¸­çš„æ¢ç¢¼ã€QRCode æ•¸æ“šã€‚</p><p><a href="/assets/755509180ca8/1*Z72y9rIwIKQCmnnuwsq0uQ.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*Z72y9rIwIKQCmnnuwsq0uQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjkwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/755509180ca8/1*s3V1UQRIqto-iG1e30PK7Q.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*s3V1UQRIqto-iG1e30PK7Q.webp" alt="æ³°åœ‹ç•¶åœ°äººæ¨è–¦éµç‰Œæ¸…æ¶¼è†" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTA4IiBoZWlnaHQ9IjE0NzciPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>æ³°åœ‹ç•¶åœ°äººæ¨è–¦éµç‰Œæ¸…æ¶¼è†</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">filePath</span> <span class="o">=</span> <span class="kt">Bundle</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">path</span><span class="p">(</span><span class="nv">forResource</span><span class="p">:</span> <span class="s">"IMG_6777"</span><span class="p">,</span> <span class="nv">ofType</span><span class="p">:</span> <span class="s">"png"</span><span class="p">)</span><span class="o">!</span> <span class="c1">// æœ¬åœ°æ¸¬è©¦åœ–ç‰‡</span>
<span class="k">let</span> <span class="nv">fileURL</span> <span class="o">=</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">filePath</span><span class="p">:</span> <span class="n">filePath</span><span class="p">)</span>
<span class="k">if</span> <span class="k">#available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">18.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// æ–°çš„ä½¿ç”¨ Swift ç‰¹æ€§çš„ API</span>
    <span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">DetectBarcodesRequest</span><span class="p">()</span>
    <span class="kt">Task</span> <span class="p">{</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="n">fileURL</span><span class="p">)</span>
            <span class="n">observations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
                <span class="n">observation</span> <span class="k">in</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Payload: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">payloadString</span> <span class="p">??</span> <span class="s">"No payload"</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Symbology: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">symbology</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// èˆŠçš„å¯«æ³•</span>
    <span class="k">let</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kt">VNRequestCompletionHandler</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">request</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="n">error</span><span class="p">)</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">results</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">VNBarcodeObservation</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="n">observations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
            <span class="n">observation</span> <span class="k">in</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Payload: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">payloadStringValue</span> <span class="p">??</span> <span class="s">"No payload"</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Symbology: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">symbology</span><span class="o">.</span><span class="n">rawValue</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">VNDetectBarcodesRequest</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="n">completionHandler</span><span class="p">)</span>
    <span class="kt">DispatchQueue</span><span class="o">.</span><span class="nf">global</span><span class="p">()</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">handler</span> <span class="o">=</span> <span class="kt">VNImageRequestHandler</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">fileURL</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[:])</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">try</span> <span class="n">handler</span><span class="o">.</span><span class="nf">perform</span><span class="p">([</span><span class="n">request</span><span class="p">])</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>åˆ†æçµæœï¼š</strong></p><div class="language-makefile highlighter-rouge"><div class="code-header"> <span data-label-text="Makefile"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nl">Payload</span><span class="o">:</span> <span class="nf">8859126000911</span>
<span class="nl">Symbology</span><span class="o">:</span> <span class="nf">VNBarcodeSymbologyEAN13</span>
<span class="nl">Payload</span><span class="o">:</span> <span class="nf">https://lin.ee/hGynbVM</span>
<span class="nl">Symbology</span><span class="o">:</span> <span class="nf">VNBarcodeSymbologyQR</span>
<span class="nl">Payload</span><span class="o">:</span> <span class="nf">http://www.hongthaipanich.com/</span>
<span class="nl">Symbology</span><span class="o">:</span> <span class="nf">VNBarcodeSymbologyQR</span>
<span class="nl">Payload</span><span class="o">:</span> <span class="nf">https://www.facebook.com/qr?id=100063856061714</span>
<span class="nl">Symbology</span><span class="o">:</span> <span class="nf">VNBarcodeSymbologyQR</span>
</pre></table></code></div></div><h4 id="recognizeanimalsrequest"><span class="me-2">RecognizeAnimalsRequest</span><a href="#recognizeanimalsrequest" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>è¾¨è­˜åœ–ç‰‡ä¸­çš„å‹•ç‰©èˆ‡ç½®ä¿¡åº¦ã€‚</p><p><a href="/assets/755509180ca8/1*5zF3gA3WB1Q0-_cgt6mTCw.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*5zF3gA3WB1Q0-_cgt6mTCw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjkwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/755509180ca8/1*KZ7mdE8fobP-_oj7tJf_Ww.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*KZ7mdE8fobP-_oj7tJf_Ww.webp" alt="[meme Source](https://www.redbubble.com/i/canvas-print/Funny-AI-Woman-yelling-at-a-cat-meme-design-Machine-learning-by-omolog/43039298.5Y5V7){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NTAiIGhlaWdodD0iMTAwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="https://www.redbubble.com/i/canvas-print/Funny-AI-Woman-yelling-at-a-cat-meme-design-Machine-learning-by-omolog/43039298.5Y5V7" target="_blank">meme Source</a></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">filePath</span> <span class="o">=</span> <span class="kt">Bundle</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">path</span><span class="p">(</span><span class="nv">forResource</span><span class="p">:</span> <span class="s">"IMG_5026"</span><span class="p">,</span> <span class="nv">ofType</span><span class="p">:</span> <span class="s">"png"</span><span class="p">)</span><span class="o">!</span> <span class="c1">// æœ¬åœ°æ¸¬è©¦åœ–ç‰‡</span>
<span class="k">let</span> <span class="nv">fileURL</span> <span class="o">=</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">filePath</span><span class="p">:</span> <span class="n">filePath</span><span class="p">)</span>
<span class="k">if</span> <span class="k">#available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">18.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// æ–°çš„ä½¿ç”¨ Swift ç‰¹æ€§çš„ API</span>
    <span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">RecognizeAnimalsRequest</span><span class="p">()</span>
    <span class="kt">Task</span> <span class="p">{</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="n">fileURL</span><span class="p">)</span>
            <span class="n">observations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
                <span class="n">observation</span> <span class="k">in</span>
                <span class="k">let</span> <span class="nv">labels</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">labels</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
                    <span class="n">label</span> <span class="k">in</span>
                    <span class="nf">print</span><span class="p">(</span><span class="s">"Detected animal: </span><span class="se">\(</span><span class="n">label</span><span class="o">.</span><span class="n">identifier</span><span class="se">)</span><span class="s"> with confidence: </span><span class="se">\(</span><span class="n">label</span><span class="o">.</span><span class="n">confidence</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// èˆŠçš„å¯«æ³•</span>
    <span class="k">let</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kt">VNRequestCompletionHandler</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">request</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="n">error</span><span class="p">)</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">results</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">VNRecognizedObjectObservation</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="n">observations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
            <span class="n">observation</span> <span class="k">in</span>
            <span class="k">let</span> <span class="nv">labels</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">labels</span>
            <span class="n">labels</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
                <span class="n">label</span> <span class="k">in</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Detected animal: </span><span class="se">\(</span><span class="n">label</span><span class="o">.</span><span class="n">identifier</span><span class="se">)</span><span class="s"> with confidence: </span><span class="se">\(</span><span class="n">label</span><span class="o">.</span><span class="n">confidence</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">VNRecognizeAnimalsRequest</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="n">completionHandler</span><span class="p">)</span>
    <span class="kt">DispatchQueue</span><span class="o">.</span><span class="nf">global</span><span class="p">()</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">handler</span> <span class="o">=</span> <span class="kt">VNImageRequestHandler</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">fileURL</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[:])</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">try</span> <span class="n">handler</span><span class="o">.</span><span class="nf">perform</span><span class="p">([</span><span class="n">request</span><span class="p">])</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>åˆ†æçµæœï¼š</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Detected</span> <span class="n">animal</span><span class="p">:</span> <span class="n">Cat</span> <span class="k">with</span> <span class="n">confidence</span><span class="p">:</span> <span class="m">0.77245045</span>
</pre></table></code></div></div><h4 id="å…¶ä»–"><span class="me-2">å…¶ä»–ï¼š</span><a href="#å…¶ä»–" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>åµæ¸¬åœ–åƒä¸­çš„äººé«”ï¼šDetectHumanRectanglesRequest<li>åµæ¸¬äººã€å‹•ç‰©çš„ Pose å‹•ä½œ (3D or 2D éƒ½å¯ä»¥)ï¼šDetectAnimalBodyPoseRequestã€DetectHumanBodyPose3DRequestã€DetectHumanBodyPoseRequestã€DetectHumanHandPoseRequest<li>æª¢æ¸¬ä¸¦è¿½è¹¤ç‰©ä»¶çš„é‹å‹•è»Œè·¡(åœ¨å½±ç‰‡ã€å‹•ç•«ä¸åŒçš„åµä¸­)ï¼šDetectTrajectoriesRequestã€TrackObjectRequestã€TrackRectangleRequest</ul><h4 id="ios--18-update-highlight"><span class="me-2"><strong>iOS â‰¥ 18 Update Highlight:</strong></span><a href="#ios--18-update-highlight" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-rust highlighter-rouge"><div class="code-header"> <span data-label-text="Rust"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">VN</span><span class="o">*</span><span class="n">Request</span> <span class="k">-&gt;</span> <span class="o">*</span><span class="nf">Request</span> <span class="p">(</span><span class="n">e</span><span class="py">.g. VNDetectBarcodesRequest</span> <span class="k">-&gt;</span> <span class="n">DetectBarcodesRequest</span><span class="p">)</span>
<span class="n">VN</span><span class="o">*</span><span class="n">Observation</span> <span class="k">-&gt;</span> <span class="o">*</span><span class="nf">Observation</span> <span class="p">(</span><span class="n">e</span><span class="py">.g. VNRecognizedObjectObservation</span> <span class="k">-&gt;</span> <span class="n">RecognizedObjectObservation</span><span class="p">)</span>
<span class="n">VNRequestCompletionHandler</span> <span class="k">-&gt;</span> <span class="k">async</span><span class="o">/</span><span class="k">await</span>
<span class="n">VNImageRequestHandler</span><span class="nf">.perform</span><span class="p">([</span><span class="n">VN</span><span class="o">*</span><span class="n">Request</span><span class="p">])</span> <span class="k">-&gt;</span> <span class="o">*</span><span class="n">Request</span><span class="nf">.perform</span><span class="p">()</span>
</pre></table></code></div></div><h3 id="wwdc-example"><span class="me-2">WWDC Example</span><a href="#wwdc-example" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>WWDC å®˜æ–¹å½±ç‰‡ä»¥è¶…å¸‚å•†å“æƒæå™¨ç‚ºä¾‹ã€‚</p><h4 id="é¦–å…ˆå¤§å¤šæ•¸çš„å•†å“éƒ½æœ‰-barcode-å¯ä¾›æƒæ"><span class="me-2">é¦–å…ˆå¤§å¤šæ•¸çš„å•†å“éƒ½æœ‰ Barcode å¯ä¾›æƒæ</span><a href="#é¦–å…ˆå¤§å¤šæ•¸çš„å•†å“éƒ½æœ‰-barcode-å¯ä¾›æƒæ" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/755509180ca8/1*YT_Uf8eEi36Iv7zcOrmP4A.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*YT_Uf8eEi36Iv7zcOrmP4A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NDAiIGhlaWdodD0iODY2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/755509180ca8/1*J9uIwRKubLoJoC7i096AdQ.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*J9uIwRKubLoJoC7i096AdQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTc5IiBoZWlnaHQ9IjI1NTYiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p><a href="/assets/755509180ca8/1*gKg-NfHYqy7uBqe5hxzBSw.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*gKg-NfHYqy7uBqe5hxzBSw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjYwNSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>æˆ‘å€‘å¯ä»¥å¾ <code class="language-plaintext highlighter-rouge">observation.boundingBox</code> å–å¾— Barcode æ‰€åœ¨ä½ç½®ï¼Œä½†ä¸åŒæ–¼å¸¸è¦‹ UIView åº§æ¨™ç³»ï¼Œ <code class="language-plaintext highlighter-rouge">BoundingBox</code> çš„ç›¸å°ä½ç½®èµ·é»æ˜¯å¾å·¦ä¸‹è§’ï¼Œå€¼çš„ç¯„åœè½åœ¨ 0~1 ä¹‹é–“ã€‚</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">filePath</span> <span class="o">=</span> <span class="kt">Bundle</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">path</span><span class="p">(</span><span class="nv">forResource</span><span class="p">:</span> <span class="s">"IMG_6785"</span><span class="p">,</span> <span class="nv">ofType</span><span class="p">:</span> <span class="s">"png"</span><span class="p">)</span><span class="o">!</span> <span class="c1">// æœ¬åœ°æ¸¬è©¦åœ–ç‰‡</span>
<span class="k">let</span> <span class="nv">fileURL</span> <span class="o">=</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">filePath</span><span class="p">:</span> <span class="n">filePath</span><span class="p">)</span>
<span class="k">if</span> <span class="k">#available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">18.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// æ–°çš„ä½¿ç”¨ Swift ç‰¹æ€§çš„ API</span>
    <span class="k">var</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">DetectBarcodesRequest</span><span class="p">()</span>
    <span class="n">request</span><span class="o">.</span><span class="n">symbologies</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="n">ean13</span><span class="p">]</span> <span class="c1">// å¦‚æœåªè¦æƒæ EAN13 Barcodeï¼Œå¯ç›´æ¥æŒ‡å®šï¼Œæå‡æ•ˆèƒ½</span>
    <span class="kt">Task</span> <span class="p">{</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="n">fileURL</span><span class="p">)</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">observation</span> <span class="o">=</span> <span class="n">observations</span><span class="o">.</span><span class="n">first</span> <span class="p">{</span>
                <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                    <span class="k">self</span><span class="o">.</span><span class="n">infoLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">payloadString</span>
                    <span class="c1">// æ¨™è¨˜é¡è‰² Layer</span>
                    <span class="k">let</span> <span class="nv">colorLayer</span> <span class="o">=</span> <span class="kt">CALayer</span><span class="p">()</span>
                    <span class="c1">// iOS &gt;=18 æ–°çš„åº§æ¨™è½‰æ› API toImageCoordinates</span>
                    <span class="c1">// æœªç¶“æ¸¬è©¦ï¼Œå¯¦éš›å¯èƒ½é‚„éœ€è¦è¨ˆç®— ContentMode = AspectFit çš„ä½ç§»:</span>
                    <span class="n">colorLayer</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">boundingBox</span><span class="o">.</span><span class="nf">toImageCoordinates</span><span class="p">(</span><span class="k">self</span><span class="o">.</span><span class="n">baseImageView</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="nv">origin</span><span class="p">:</span> <span class="o">.</span><span class="n">upperLeft</span><span class="p">)</span>
                    <span class="n">colorLayer</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="n">red</span><span class="o">.</span><span class="nf">withAlphaComponent</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">cgColor</span>
                    <span class="k">self</span><span class="o">.</span><span class="n">baseImageView</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="nf">addSublayer</span><span class="p">(</span><span class="n">colorLayer</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"BoundingBox: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">boundingBox</span><span class="o">.</span><span class="n">cgRect</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Payload: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">payloadString</span> <span class="p">??</span> <span class="s">"No payload"</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Symbology: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">symbology</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// èˆŠçš„å¯«æ³•</span>
    <span class="k">let</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kt">VNRequestCompletionHandler</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">request</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="n">error</span><span class="p">)</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">results</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">VNBarcodeObservation</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">observation</span> <span class="o">=</span> <span class="n">observations</span><span class="o">.</span><span class="n">first</span> <span class="p">{</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">infoLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">payloadStringValue</span>
                <span class="c1">// æ¨™è¨˜é¡è‰² Layer</span>
                <span class="k">let</span> <span class="nv">colorLayer</span> <span class="o">=</span> <span class="kt">CALayer</span><span class="p">()</span>
                <span class="n">colorLayer</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="nf">convertBoundingBox</span><span class="p">(</span><span class="n">observation</span><span class="o">.</span><span class="n">boundingBox</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">baseImageView</span><span class="p">)</span>
                <span class="n">colorLayer</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="n">red</span><span class="o">.</span><span class="nf">withAlphaComponent</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">cgColor</span>
                <span class="k">self</span><span class="o">.</span><span class="n">baseImageView</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="nf">addSublayer</span><span class="p">(</span><span class="n">colorLayer</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"BoundingBox: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">boundingBox</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Payload: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">payloadStringValue</span> <span class="p">??</span> <span class="s">"No payload"</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Symbology: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">symbology</span><span class="o">.</span><span class="n">rawValue</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">VNDetectBarcodesRequest</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="n">completionHandler</span><span class="p">)</span>
    <span class="n">request</span><span class="o">.</span><span class="n">symbologies</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="n">ean13</span><span class="p">]</span> <span class="c1">// å¦‚æœåªè¦æƒæ EAN13 Barcodeï¼Œå¯ç›´æ¥æŒ‡å®šï¼Œæå‡æ•ˆèƒ½</span>
    <span class="kt">DispatchQueue</span><span class="o">.</span><span class="nf">global</span><span class="p">()</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">handler</span> <span class="o">=</span> <span class="kt">VNImageRequestHandler</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">fileURL</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[:])</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">try</span> <span class="n">handler</span><span class="o">.</span><span class="nf">perform</span><span class="p">([</span><span class="n">request</span><span class="p">])</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>iOS â‰¥ 18 Update Highlight:</strong></p><pre><code class="language-less">// iOS &gt;=18 æ–°çš„åº§æ¨™è½‰æ› API toImageCoordinates
observation.boundingBox.toImageCoordinates(CGSize, origin: .upperLeft)
// https://developer.apple.com/documentation/vision/normalizedpoint/toimagecoordinates(from:imagesize:origin:)
</code></pre><p><strong>Helper:</strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre><span class="c1">// Gen by ChatGPT 4o</span>
<span class="c1">// å› ç‚ºç…§ç‰‡åœ¨ ImageView æ˜¯è¨­å®š ContentMode = AspectFit</span>
<span class="c1">// æ‰€ä»¥è¦å¤šè¨ˆç®—ä¸Šä¸‹å›  Fit é€ æˆçš„ç©ºç™½ä½ç§»</span>
<span class="kd">func</span> <span class="nf">convertBoundingBox</span><span class="p">(</span><span class="n">_</span> <span class="nv">boundingBox</span><span class="p">:</span> <span class="kt">CGRect</span><span class="p">,</span> <span class="n">to</span> <span class="nv">view</span><span class="p">:</span> <span class="kt">UIImageView</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">CGRect</span> <span class="p">{</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">image</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">image</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">.</span><span class="n">zero</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">imageSize</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">size</span>
    <span class="k">let</span> <span class="nv">viewSize</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">size</span>
    <span class="k">let</span> <span class="nv">imageRatio</span> <span class="o">=</span> <span class="n">imageSize</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="n">imageSize</span><span class="o">.</span><span class="n">height</span>
    <span class="k">let</span> <span class="nv">viewRatio</span> <span class="o">=</span> <span class="n">viewSize</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="n">viewSize</span><span class="o">.</span><span class="n">height</span>
    <span class="k">var</span> <span class="nv">scaleFactor</span><span class="p">:</span> <span class="kt">CGFloat</span>
    <span class="k">var</span> <span class="nv">offsetX</span><span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">var</span> <span class="nv">offsetY</span><span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">imageRatio</span> <span class="o">&gt;</span> <span class="n">viewRatio</span> <span class="p">{</span>
        <span class="c1">// åœ–åƒåœ¨å¯¬åº¦æ–¹å‘ä¸Šé©é…</span>
        <span class="n">scaleFactor</span> <span class="o">=</span> <span class="n">viewSize</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="n">imageSize</span><span class="o">.</span><span class="n">width</span>
        <span class="n">offsetY</span> <span class="o">=</span> <span class="p">(</span><span class="n">viewSize</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">imageSize</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">scaleFactor</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="p">}</span>

    <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// åœ–åƒåœ¨é«˜åº¦æ–¹å‘ä¸Šé©é…</span>
        <span class="n">scaleFactor</span> <span class="o">=</span> <span class="n">viewSize</span><span class="o">.</span><span class="n">height</span> <span class="o">/</span> <span class="n">imageSize</span><span class="o">.</span><span class="n">height</span>
        <span class="n">offsetX</span> <span class="o">=</span> <span class="p">(</span><span class="n">viewSize</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="n">imageSize</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">scaleFactor</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">x</span> <span class="o">=</span> <span class="n">boundingBox</span><span class="o">.</span><span class="n">minX</span> <span class="o">*</span> <span class="n">imageSize</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">scaleFactor</span> <span class="o">+</span> <span class="n">offsetX</span>
    <span class="k">let</span> <span class="nv">y</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">boundingBox</span><span class="o">.</span><span class="n">maxY</span><span class="p">)</span> <span class="o">*</span> <span class="n">imageSize</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">scaleFactor</span> <span class="o">+</span> <span class="n">offsetY</span>
    <span class="k">let</span> <span class="nv">width</span> <span class="o">=</span> <span class="n">boundingBox</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">imageSize</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">scaleFactor</span>
    <span class="k">let</span> <span class="nv">height</span> <span class="o">=</span> <span class="n">boundingBox</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">imageSize</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">scaleFactor</span>
    <span class="k">return</span> <span class="kt">CGRect</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="nv">width</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="n">height</span><span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>è¼¸å‡ºçµæœ</strong></p><div class="language-makefile highlighter-rouge"><div class="code-header"> <span data-label-text="Makefile"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nl">BoundingBox</span><span class="o">:</span> <span class="nf">(0.5295758928571429</span><span class="p">,</span><span class="nf"> 0.21408638121589782</span><span class="p">,</span><span class="nf"> 0.0943080357142857</span><span class="p">,</span><span class="nf"> 0.21254415360708087)</span>
<span class="nl">Payload</span><span class="o">:</span> <span class="nf">4710018183805</span>
<span class="nl">Symbology</span><span class="o">:</span> <span class="nf">VNBarcodeSymbologyEAN13</span>
</pre></table></code></div></div><h4 id="éƒ¨åˆ†å•†å“ç„¡-barcodeå¦‚æ•£è£æ°´æœåªæœ‰å•†å“æ¨™ç±¤"><span class="me-2">éƒ¨åˆ†å•†å“ç„¡ Barcodeï¼Œå¦‚æ•£è£æ°´æœåªæœ‰å•†å“æ¨™ç±¤</span><a href="#éƒ¨åˆ†å•†å“ç„¡-barcodeå¦‚æ•£è£æ°´æœåªæœ‰å•†å“æ¨™ç±¤" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/755509180ca8/1*jeZhLtg9j11kgOAvKZmevg.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*jeZhLtg9j11kgOAvKZmevg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NzYiIGhlaWdodD0iODM0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/755509180ca8/1*YNokMMUewMA2kzjoGmMJPw.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*YNokMMUewMA2kzjoGmMJPw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjk2IiBoZWlnaHQ9IjY5NiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>å› æ­¤æˆ‘å€‘çš„æƒç„å™¨ä¹Ÿéœ€è¦åŒæ™‚æ”¯æ´æƒæç´”æ–‡å­—æ¨™ç±¤ã€‚</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">filePath</span> <span class="o">=</span> <span class="kt">Bundle</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">path</span><span class="p">(</span><span class="nv">forResource</span><span class="p">:</span> <span class="s">"apple"</span><span class="p">,</span> <span class="nv">ofType</span><span class="p">:</span> <span class="s">"jpg"</span><span class="p">)</span><span class="o">!</span> <span class="c1">// æœ¬åœ°æ¸¬è©¦åœ–ç‰‡</span>
<span class="k">let</span> <span class="nv">fileURL</span> <span class="o">=</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">filePath</span><span class="p">:</span> <span class="n">filePath</span><span class="p">)</span>
<span class="k">if</span> <span class="k">#available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">18.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// æ–°çš„ä½¿ç”¨ Swift ç‰¹æ€§çš„ API</span>
    <span class="k">var</span> <span class="nv">barcodesRequest</span> <span class="o">=</span> <span class="kt">DetectBarcodesRequest</span><span class="p">()</span>
    <span class="n">barcodesRequest</span><span class="o">.</span><span class="n">symbologies</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="n">ean13</span><span class="p">]</span> <span class="c1">// å¦‚æœåªè¦æƒæ EAN13 Barcodeï¼Œå¯ç›´æ¥æŒ‡å®šï¼Œæå‡æ•ˆèƒ½</span>
    <span class="k">var</span> <span class="nv">textRequest</span> <span class="o">=</span> <span class="kt">RecognizeTextRequest</span><span class="p">()</span>
    <span class="n">textRequest</span><span class="o">.</span><span class="n">recognitionLanguages</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">identifier</span><span class="p">:</span> <span class="s">"zh-Hnat"</span><span class="p">),</span> <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">identifier</span><span class="p">:</span> <span class="s">"en-US"</span><span class="p">)]</span>
    <span class="kt">Task</span> <span class="p">{</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">handler</span> <span class="o">=</span> <span class="kt">ImageRequestHandler</span><span class="p">(</span><span class="n">fileURL</span><span class="p">)</span>
            <span class="c1">// parameter pack syntax and we must wait for all requests to finish before we can use their results.</span>
            <span class="c1">// let (barcodesObservation, textObservation, ...) = try await handler.perform(barcodesRequest, textRequest, ...)</span>
            <span class="k">let</span> <span class="p">(</span><span class="nv">barcodesObservation</span><span class="p">,</span> <span class="nv">textObservation</span><span class="p">)</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">handler</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="n">barcodesRequest</span><span class="p">,</span> <span class="n">textRequest</span><span class="p">)</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">observation</span> <span class="o">=</span> <span class="n">barcodesObservation</span><span class="o">.</span><span class="n">first</span> <span class="p">{</span>
                <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                    <span class="k">self</span><span class="o">.</span><span class="n">infoLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">payloadString</span>
                    <span class="c1">// æ¨™è¨˜é¡è‰² Layer</span>
                    <span class="k">let</span> <span class="nv">colorLayer</span> <span class="o">=</span> <span class="kt">CALayer</span><span class="p">()</span>
                    <span class="c1">// iOS &gt;=18 æ–°çš„åº§æ¨™è½‰æ› API toImageCoordinates</span>
                    <span class="c1">// æœªç¶“æ¸¬è©¦ï¼Œå¯¦éš›å¯èƒ½é‚„éœ€è¦è¨ˆç®— ContentMode = AspectFit çš„ä½ç§»:</span>
                    <span class="n">colorLayer</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">boundingBox</span><span class="o">.</span><span class="nf">toImageCoordinates</span><span class="p">(</span><span class="k">self</span><span class="o">.</span><span class="n">baseImageView</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="nv">origin</span><span class="p">:</span> <span class="o">.</span><span class="n">upperLeft</span><span class="p">)</span>
                    <span class="n">colorLayer</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="n">red</span><span class="o">.</span><span class="nf">withAlphaComponent</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">cgColor</span>
                    <span class="k">self</span><span class="o">.</span><span class="n">baseImageView</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="nf">addSublayer</span><span class="p">(</span><span class="n">colorLayer</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"BoundingBox: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">boundingBox</span><span class="o">.</span><span class="n">cgRect</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Payload: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">payloadString</span> <span class="p">??</span> <span class="s">"No payload"</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Symbology: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">symbology</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="n">textObservation</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
                <span class="n">observation</span> <span class="k">in</span>
                <span class="k">let</span> <span class="nv">topCandidate</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="nf">topCandidates</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
                <span class="nf">print</span><span class="p">(</span><span class="n">topCandidate</span><span class="p">?</span><span class="o">.</span><span class="n">string</span> <span class="p">??</span> <span class="s">"No text recognized"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// èˆŠçš„å¯«æ³•</span>
    <span class="k">let</span> <span class="nv">barcodesCompletionHandler</span><span class="p">:</span> <span class="kt">VNRequestCompletionHandler</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">request</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="n">error</span><span class="p">)</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">results</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">VNBarcodeObservation</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">observation</span> <span class="o">=</span> <span class="n">observations</span><span class="o">.</span><span class="n">first</span> <span class="p">{</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">infoLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">payloadStringValue</span>
                <span class="c1">// æ¨™è¨˜é¡è‰² Layer</span>
                <span class="k">let</span> <span class="nv">colorLayer</span> <span class="o">=</span> <span class="kt">CALayer</span><span class="p">()</span>
                <span class="n">colorLayer</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="nf">convertBoundingBox</span><span class="p">(</span><span class="n">observation</span><span class="o">.</span><span class="n">boundingBox</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">baseImageView</span><span class="p">)</span>
                <span class="n">colorLayer</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="n">red</span><span class="o">.</span><span class="nf">withAlphaComponent</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">cgColor</span>
                <span class="k">self</span><span class="o">.</span><span class="n">baseImageView</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="nf">addSublayer</span><span class="p">(</span><span class="n">colorLayer</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"BoundingBox: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">boundingBox</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Payload: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">payloadStringValue</span> <span class="p">??</span> <span class="s">"No payload"</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Symbology: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">symbology</span><span class="o">.</span><span class="n">rawValue</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">textCompletionHandler</span><span class="p">:</span> <span class="kt">VNRequestCompletionHandler</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">request</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="n">error</span><span class="p">)</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">observations</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">results</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">VNRecognizedTextObservation</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="n">observations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
            <span class="n">observation</span> <span class="k">in</span>
            <span class="k">let</span> <span class="nv">topCandidate</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="nf">topCandidates</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
            <span class="nf">print</span><span class="p">(</span><span class="n">topCandidate</span><span class="p">?</span><span class="o">.</span><span class="n">string</span> <span class="p">??</span> <span class="s">"No text recognized"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">barcodesRequest</span> <span class="o">=</span> <span class="kt">VNDetectBarcodesRequest</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="n">barcodesCompletionHandler</span><span class="p">)</span>
    <span class="n">barcodesRequest</span><span class="o">.</span><span class="n">symbologies</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="n">ean13</span><span class="p">]</span> <span class="c1">// å¦‚æœåªè¦æƒæ EAN13 Barcodeï¼Œå¯ç›´æ¥æŒ‡å®šï¼Œæå‡æ•ˆèƒ½</span>
    <span class="k">let</span> <span class="nv">textRequest</span> <span class="o">=</span> <span class="kt">VNRecognizeTextRequest</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="n">textCompletionHandler</span><span class="p">)</span>
    <span class="n">textRequest</span><span class="o">.</span><span class="n">recognitionLevel</span> <span class="o">=</span> <span class="o">.</span><span class="n">accurate</span>
    <span class="n">textRequest</span><span class="o">.</span><span class="n">recognitionLanguages</span> <span class="o">=</span> <span class="p">[</span><span class="s">"en-US"</span><span class="p">]</span>
    <span class="kt">DispatchQueue</span><span class="o">.</span><span class="nf">global</span><span class="p">()</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">handler</span> <span class="o">=</span> <span class="kt">VNImageRequestHandler</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">fileURL</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[:])</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">try</span> <span class="n">handler</span><span class="o">.</span><span class="nf">perform</span><span class="p">([</span><span class="n">barcodesRequest</span><span class="p">,</span> <span class="n">textRequest</span><span class="p">])</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>è¼¸å‡ºçµæœï¼š</strong></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>94128s
ORGANIC
Pink LadyÂ®
Produce of USh
</pre></table></code></div></div><p><strong>iOS â‰¥ 18 Update Highlight:</strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">handler</span> <span class="o">=</span> <span class="kt">ImageRequestHandler</span><span class="p">(</span><span class="n">fileURL</span><span class="p">)</span>
<span class="c1">// parameter pack syntax and we must wait for all requests to finish before we can use their results.</span>
<span class="c1">// let (barcodesObservation, textObservation, ...) = try await handler.perform(barcodesRequest, textRequest, ...)</span>
<span class="k">let</span> <span class="p">(</span><span class="nv">barcodesObservation</span><span class="p">,</span> <span class="nv">textObservation</span><span class="p">)</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">handler</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="n">barcodesRequest</span><span class="p">,</span> <span class="n">textRequest</span><span class="p">)</span>
</pre></table></code></div></div><h4 id="ios--18-performall--æ–¹æ³•"><span class="me-2">iOS â‰¥ 18 <a href="https://developer.apple.com/documentation/vision/imagerequesthandler/performall(_:)?changes=latest_minor" target="_blank">performAll( )</a> æ–¹æ³•</span><a href="#ios--18-performall--æ–¹æ³•" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/755509180ca8/1*z0364eYD4F4On194EgQ1kQ.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*z0364eYD4F4On194EgQ1kQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTAwIiBoZWlnaHQ9Ijc0OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>å‰é¢çš„ <code class="language-plaintext highlighter-rouge">perform(barcodesRequest, textRequest)</code> è™•ç† Barcode æƒæè·Ÿæ–‡å­—æƒæçš„æ–¹å¼éœ€è¦ç­‰åˆ°å…©å€‹ Request éƒ½å®Œæˆæ‰èƒ½ç¹¼çºŒåŸ·è¡Œï¼›iOS 18 é–‹å§‹æä¾›æ–°çš„ <code class="language-plaintext highlighter-rouge">performAll()</code> æ–¹æ³•ï¼Œå°‡å›æ‡‰æ–¹å¼æ”¹ç‚ºä¸²æµï¼Œåœ¨æ”¶åˆ°å…¶ä¸­ä¸€å€‹ Reqeust çµæœæ˜¯å°±èƒ½åšå°æ‡‰è™•ç†ï¼Œä¾‹å¦‚æƒæåˆ° Barcode å°±ç›´æ¥éŸ¿æ‡‰ã€‚</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre><span class="k">if</span> <span class="k">#available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">18.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// æ–°çš„ä½¿ç”¨ Swift ç‰¹æ€§çš„ API</span>
    <span class="k">var</span> <span class="nv">barcodesRequest</span> <span class="o">=</span> <span class="kt">DetectBarcodesRequest</span><span class="p">()</span>
    <span class="n">barcodesRequest</span><span class="o">.</span><span class="n">symbologies</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="n">ean13</span><span class="p">]</span> <span class="c1">// å¦‚æœåªè¦æƒæ EAN13 Barcodeï¼Œå¯ç›´æ¥æŒ‡å®šï¼Œæå‡æ•ˆèƒ½</span>
    <span class="k">var</span> <span class="nv">textRequest</span> <span class="o">=</span> <span class="kt">RecognizeTextRequest</span><span class="p">()</span>
    <span class="n">textRequest</span><span class="o">.</span><span class="n">recognitionLanguages</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">identifier</span><span class="p">:</span> <span class="s">"zh-Hnat"</span><span class="p">),</span> <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">identifier</span><span class="p">:</span> <span class="s">"en-US"</span><span class="p">)]</span>
    <span class="kt">Task</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">handler</span> <span class="o">=</span> <span class="kt">ImageRequestHandler</span><span class="p">(</span><span class="n">fileURL</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">observation</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="nf">performAll</span><span class="p">([</span><span class="n">barcodesRequest</span><span class="p">,</span> <span class="n">textRequest</span><span class="p">]</span> <span class="k">as</span> <span class="p">[</span><span class="kd">any</span> <span class="kt">VisionRequest</span><span class="p">])</span>
        <span class="k">for</span> <span class="k">try</span> <span class="k">await</span> <span class="n">result</span> <span class="k">in</span> <span class="n">observation</span> <span class="p">{</span>
            <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
                <span class="k">case</span> <span class="o">.</span><span class="nf">detectBarcodes</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="k">let</span> <span class="nv">barcodesObservation</span><span class="p">):</span>
                <span class="k">if</span> <span class="k">let</span> <span class="nv">observation</span> <span class="o">=</span> <span class="n">barcodesObservation</span><span class="o">.</span><span class="n">first</span> <span class="p">{</span>
                    <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                        <span class="k">self</span><span class="o">.</span><span class="n">infoLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">payloadString</span>
                        <span class="c1">// æ¨™è¨˜é¡è‰² Layer</span>
                        <span class="k">let</span> <span class="nv">colorLayer</span> <span class="o">=</span> <span class="kt">CALayer</span><span class="p">()</span>
                        <span class="c1">// iOS &gt;=18 æ–°çš„åº§æ¨™è½‰æ› API toImageCoordinates</span>
                        <span class="c1">// æœªç¶“æ¸¬è©¦ï¼Œå¯¦éš›å¯èƒ½é‚„éœ€è¦è¨ˆç®— ContentMode = AspectFit çš„ä½ç§»:</span>
                        <span class="n">colorLayer</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">boundingBox</span><span class="o">.</span><span class="nf">toImageCoordinates</span><span class="p">(</span><span class="k">self</span><span class="o">.</span><span class="n">baseImageView</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="nv">origin</span><span class="p">:</span> <span class="o">.</span><span class="n">upperLeft</span><span class="p">)</span>
                        <span class="n">colorLayer</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="n">red</span><span class="o">.</span><span class="nf">withAlphaComponent</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">cgColor</span>
                        <span class="k">self</span><span class="o">.</span><span class="n">baseImageView</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="nf">addSublayer</span><span class="p">(</span><span class="n">colorLayer</span><span class="p">)</span>
                    <span class="p">}</span>
                    <span class="nf">print</span><span class="p">(</span><span class="s">"BoundingBox: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">boundingBox</span><span class="o">.</span><span class="n">cgRect</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                    <span class="nf">print</span><span class="p">(</span><span class="s">"Payload: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">payloadString</span> <span class="p">??</span> <span class="s">"No payload"</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                    <span class="nf">print</span><span class="p">(</span><span class="s">"Symbology: </span><span class="se">\(</span><span class="n">observation</span><span class="o">.</span><span class="n">symbology</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="k">case</span> <span class="o">.</span><span class="nf">recognizeText</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="k">let</span> <span class="nv">textObservation</span><span class="p">):</span>
                <span class="n">textObservation</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
                    <span class="n">observation</span> <span class="k">in</span>
                    <span class="k">let</span> <span class="nv">topCandidate</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="nf">topCandidates</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
                    <span class="nf">print</span><span class="p">(</span><span class="n">topCandidate</span><span class="p">?</span><span class="o">.</span><span class="n">string</span> <span class="p">??</span> <span class="s">"No text recognized"</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="k">default</span><span class="p">:</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Unrecongnized result: </span><span class="se">\(</span><span class="n">result</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="optimize-with-swift-concurrency"><span class="me-2">Optimize with Swift Concurrency</span><a href="#optimize-with-swift-concurrency" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/755509180ca8/1*LgxxMOVS6is3n6EqPWqA6Q.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*LgxxMOVS6is3n6EqPWqA6Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDQ0IiBoZWlnaHQ9IjYxOCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/755509180ca8/1*80CFJpkb-gjy3bJs4jAC2A.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*80CFJpkb-gjy3bJs4jAC2A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NTYiIGhlaWdodD0iODQwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>å‡è¨­æˆ‘å€‘æœ‰ä¸€å€‹åœ–ç‰‡ç‰†åˆ—è¡¨ï¼Œæ¯å¼µåœ–ç‰‡éƒ½éœ€è¦è‡ªå‹•è£åˆ‡å‡ºç‰©ä»¶ä¸»é«”ï¼›é€™æ™‚å€™å¯ä»¥å–„ç”¨ Swift Concurrency å¢åŠ è¼‰å…¥æ•ˆç‡ã€‚</p><h4 id="åŸå§‹å¯«æ³•"><span class="me-2"><strong>åŸå§‹å¯«æ³•</strong></span><a href="#åŸå§‹å¯«æ³•" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">generateThumbnail</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="kt">URL</span><span class="p">)</span> <span class="k">async</span> <span class="k">throws</span> <span class="o">-&gt;</span> <span class="kt">UIImage</span> <span class="p">{</span>
  <span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">GenerateAttentionBasedSaliencyImageRequest</span><span class="p">()</span>
  <span class="k">let</span> <span class="nv">saliencyObservation</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="n">url</span><span class="p">)</span>
  <span class="k">return</span> <span class="nf">cropImage</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="n">saliencyObservation</span><span class="o">.</span><span class="n">salientObjects</span><span class="p">)</span>
<span class="p">}</span>
    
<span class="kd">func</span> <span class="nf">generateAllThumbnails</span><span class="p">()</span> <span class="k">async</span> <span class="k">throws</span> <span class="p">{</span>
  <span class="k">for</span> <span class="n">image</span> <span class="k">in</span> <span class="n">images</span> <span class="p">{</span>
    <span class="n">image</span><span class="o">.</span><span class="n">thumbnail</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="nf">generateThumbnail</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>ä¸€æ¬¡åªåŸ·è¡Œä¸€å€‹ï¼Œæ•ˆç‡ã€æ•ˆèƒ½ç·©æ…¢ã€‚</p><h4 id="å„ªåŒ–-1--taskgroup-concurrency"><span class="me-2"><strong>å„ªåŒ– (1) â€” TaskGroup</strong> Concurrency</span><a href="#å„ªåŒ–-1--taskgroup-concurrency" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>
<span class="kd">func</span> <span class="nf">generateAllThumbnails</span><span class="p">()</span> <span class="k">async</span> <span class="k">throws</span> <span class="p">{</span>
  <span class="k">try</span> <span class="k">await</span> <span class="n">withThrowingDiscardingTaskGroup</span> <span class="p">{</span> <span class="n">taskGroup</span> <span class="k">in</span>
    <span class="k">for</span> <span class="n">image</span> <span class="k">in</span> <span class="n">images</span> <span class="p">{</span>
      <span class="n">image</span><span class="o">.</span><span class="n">thumbnail</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="nf">generateThumbnail</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
     <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>å°‡æ¯å€‹ Task éƒ½åŠ å…¥ TaskGroup Concurrency åŸ·è¡Œã€‚</p><blockquote><p><strong><em>å•é¡Œï¼šåœ–ç‰‡è¾¨è­˜ã€æˆªåœ–æ“ä½œéå¸¸æ¶ˆè€—è¨˜æ†¶é«”æ€§èƒ½ï¼Œå¦‚æœç„¡ç¯€åˆ¶ç‹‚åŠ ä¸¦è¡Œä»»å‹™ï¼Œå¯èƒ½é€ æˆä½¿ç”¨è€…å¡é “ã€OOM é–ƒé€€å•é¡Œã€‚</em></strong></p></blockquote><h4 id="å„ªåŒ–-2--taskgroup-concurrency--é™åˆ¶ä¸¦è¡Œæ•¸é‡"><span class="me-2">å„ªåŒ– (2) â€” TaskGroup Concurrency + é™åˆ¶ä¸¦è¡Œæ•¸é‡</span><a href="#å„ªåŒ–-2--taskgroup-concurrency--é™åˆ¶ä¸¦è¡Œæ•¸é‡" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">generateAllThumbnails</span><span class="p">()</span> <span class="k">async</span> <span class="k">throws</span> <span class="p">{</span>
    <span class="k">try</span> <span class="k">await</span> <span class="n">withThrowingDiscardingTaskGroup</span> <span class="p">{</span>
        <span class="n">taskGroup</span> <span class="k">in</span>
        <span class="c1">// æœ€å¤šåŸ·è¡Œæ•¸é‡ä¸å¾—è¶…é 5</span>
        <span class="k">let</span> <span class="nv">maxImageTasks</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">images</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
        <span class="c1">// å…ˆå¡«å…… 5 å€‹ Task</span>
        <span class="k">for</span> <span class="n">index</span> <span class="k">in</span> <span class="mi">0</span><span class="o">..&lt;</span><span class="n">maxImageTasks</span> <span class="p">{</span>
            <span class="n">taskGroup</span><span class="o">.</span><span class="n">addTask</span> <span class="p">{</span>
                <span class="n">image</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">thumbnail</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="nf">generateThumbnail</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">image</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">var</span> <span class="nv">nextIndex</span> <span class="o">=</span> <span class="n">maxImageTasks</span>
        <span class="k">for</span> <span class="k">try</span> <span class="k">await</span> <span class="n">_</span> <span class="k">in</span> <span class="n">taskGroup</span> <span class="p">{</span>
            <span class="c1">// taskGroup è£¡ Task await å®Œæˆæ™‚...</span>
            <span class="c1">// æª¢æŸ¥ Index æ˜¯å¦åˆ°å°¾éƒ¨</span>
            <span class="k">if</span> <span class="n">nextIndex</span> <span class="o">&lt;</span> <span class="n">images</span><span class="o">.</span><span class="n">count</span> <span class="p">{</span>
                <span class="k">let</span> <span class="nv">image</span> <span class="o">=</span> <span class="n">images</span><span class="p">[</span><span class="n">nextIndex</span><span class="p">]</span>
                <span class="c1">// ç¹¼çºŒé€å€‹å¡«å…… Task (å°‡ç¶­æŒåœ¨æœ€å¤š 5 å€‹)</span>
                <span class="n">taskGroup</span><span class="o">.</span><span class="n">addTask</span> <span class="p">{</span>
                    <span class="n">image</span><span class="o">.</span><span class="n">thumbnail</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="nf">generateThumbnail</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="n">nextIndex</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="update-an-existing-vision-app"><span class="me-2">Update an existing Vision app</span><a href="#update-an-existing-vision-app" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/755509180ca8/1*0OhzcxQ7OpSujeyvt9918Q.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*0OhzcxQ7OpSujeyvt9918Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjYxNSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/755509180ca8/1*MH4Xa0RB2DZQ1Fl9-kItSw.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*MH4Xa0RB2DZQ1Fl9-kItSw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjQxMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ol><li>Vision å°‡åœ¨å…·å‚™ç¥ç¶“å¼•æ“çš„è¨­å‚™ä¸Šç§»é™¤å°éƒ¨åˆ†è«‹æ±‚çš„ CPU å’Œ GPU æ”¯æŒã€‚åœ¨é€™äº›è¨­å‚™ä¸Šï¼Œç¥ç¶“å¼•æ“æ˜¯æ€§èƒ½æœ€å¥½çš„é¸æ“‡ã€‚ å¯ä»¥ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">supportedComputeDevices()</code> API é€²è¡Œæª¢æŸ¥<li>ç§»é™¤æ‰€æœ‰ VN å‰ç¶´ <code class="language-plaintext highlighter-rouge">VNXXRequest</code> , <code class="language-plaintext highlighter-rouge">VNXXXObservation</code> -&gt; <code class="language-plaintext highlighter-rouge">Reqeust</code> , <code class="language-plaintext highlighter-rouge">Observation</code><li>ä½¿ç”¨ async/await å–ä»£åŸæœ¬çš„ VNRequestCompletionHandler<li>ç›´æ¥ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">*Request.perform()</code> å–ä»£åŸæœ¬çš„ <code class="language-plaintext highlighter-rouge">VNImageRequestHandler.perform([VN*Request])</code></ol><h3 id="wrap-up"><span class="me-2">Wrap-up</span><a href="#wrap-up" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>ç‚º Swift èªè¨€ç‰¹æ€§æ–°è¨­è¨ˆçš„ API<li>æ–°çš„åŠŸèƒ½ã€æ–¹æ³•éƒ½ç‚º Swift Only, iOS â‰¥ 18 å¯ç”¨<li>æ–°çš„åœ–ç‰‡è©•åˆ†åŠŸèƒ½ã€èº«é«”ï¼‹æ‰‹éƒ¨å‹•ä½œè¿½è¹¤</ul><h3 id="thanks"><span class="me-2">Thanks!</span><a href="#thanks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/755509180ca8/1*BK_5eH1i4-drOUOGnuQRSg.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*BK_5eH1i4-drOUOGnuQRSg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjY2NyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><h3 id="kkday-æ‹›å‹Ÿå·¥å•†"><span class="me-2">KKday æ‹›å‹Ÿå·¥å•†</span><a href="#kkday-æ‹›å‹Ÿå·¥å•†" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/755509180ca8/1*kjcldhvCP1cM-QqDfRFaYg.webp" class="popup img-link blur"><img data-src="/assets/755509180ca8/1*kjcldhvCP1cM-QqDfRFaYg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NjgiIGhlaWdodD0iNDM5Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>ğŸ‘‰ğŸ‘‰ğŸ‘‰æœ¬æ¬¡è®€æ›¸æœƒåˆ†äº«æºæ–¼ KKday App Team çµ„å…§æ¯é€±æŠ€è¡“åˆ†äº«æ´»å‹•ï¼Œ <strong>ç›®å‰åœ˜éšŠä¹Ÿæ­£åœ¨ç†±æƒ…æ‹›å‹Ÿ <a href="https://kkday.bamboohr.com/careers/25?source=aWQ9Mjk%3D" target="_blank">Senior iOS Engineer</a> ï¼Œæœ‰èˆˆè¶£çš„æœ‹å‹æ­¡è¿æŠ•éå±¥æ­·</strong> ã€‚ğŸ‘ˆğŸ‘ˆğŸ‘ˆ</p><h4 id="åƒè€ƒè³‡æ–™"><span class="me-2">åƒè€ƒè³‡æ–™</span><a href="#åƒè€ƒè³‡æ–™" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><h4 id="discover-swift-enhancements-in-the-vision-framework"><span class="me-2"><a href="https://developer.apple.com/videos/play/wwdc2024/10163/" target="_blank">Discover Swift enhancements in the Vision framework</a></span><a href="#discover-swift-enhancements-in-the-vision-framework" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The Vision Framework API has been redesigned to leverage modern Swift features like concurrency, making it easier and faster to integrate a wide array of Vision algorithms into your app. Weâ€™ll tour the updated API and share sample code, along with best practices, to help you get the benefits of this framework with less coding effort. Weâ€™ll also demonstrate two new features: image aesthetics and holistic body pose.</p><h3 id="chapters"><span class="me-2">Chapters</span><a href="#chapters" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>0:00 â€” <a href="https://developer.apple.com/videos/play/wwdc2024/10163/?time=0" target="_blank">Introduction</a><li>1:07 â€” <a href="https://developer.apple.com/videos/play/wwdc2024/10163/?time=67" target="_blank">New Vision API</a><li>1:47 â€” <a href="https://developer.apple.com/videos/play/wwdc2024/10163/?time=107" target="_blank">Get started with Vision</a><li>8:59 â€” <a href="https://developer.apple.com/videos/play/wwdc2024/10163/?time=539" target="_blank">Optimize with Swift Concurrency</a><li>11:05 â€” <a href="https://developer.apple.com/videos/play/wwdc2024/10163/?time=665" target="_blank">Update an existing Vision app</a><li>13:46 â€” <a href="https://developer.apple.com/videos/play/wwdc2024/10163/?time=826" target="_blank">Whatâ€™s new in Vision?</a></ul><h4 id="vision-framework-apple-developer-documentation"><span class="me-2"><a href="https://developer.apple.com/documentation/vision/" target="_blank">Vision framework Apple Developer Documentation</a></span><a href="#vision-framework-apple-developer-documentation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>-</p><p>æœ‰ä»»ä½•å•é¡ŒåŠæŒ‡æ•™æ­¡è¿ <a href="https://www.zhgchg.li/contact" target="_blank">èˆ‡æˆ‘è¯çµ¡</a> ã€‚</p><script src="/assets/clipboard.min.js"></script><div style=" display:flex; align-items:center; gap:10px; border:1px solid #e5e7eb; background:#f9fafb; padding:12px 16px; border-radius:12px; margin:18px 0; box-shadow:0 3px 8px rgba(0,0,0,0.05); width: auto;"> <input id="share-url" value="https://zhgchg.li/posts/755509180ca8/" readonly="" style=" flex:1; border:1px solid #d1d5db; border-radius:8px; padding:10px 12px; font-size:0.9rem; background:#ffffff; color:#111827; outline:none; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; " /> <button class="btn" data-clipboard-target="#share-url" id="copy-btn" style=" border:none; background:#3b82f6; color:white; padding:10px 16px; border-radius:10px; cursor:pointer; font-size:0.85rem; font-weight:600; display:flex; align-items:center; gap:6px; transition:all .15s ease; box-shadow:0 2px 5px rgba(59,130,246,0.35); " onmouseover="this.style.opacity='0.92';" onmouseout="this.style.opacity='1';"> <span style="font-size:1rem;">ğŸ”—</span> <span id="copy-btn-text">Copy link to share!</span> </button></div><script> new ClipboardJS('.btn'); var btn = document.getElementById("copy-btn"); var text = document.getElementById("copy-btn-text"); btn.addEventListener("click", function () { text.textContent = "Copied!"; btn.style.background = "#16a34a"; btn.style.boxShadow = "0 2px 6px rgba(22,163,74,0.35)"; setTimeout(() => { text.textContent = "Copy link to share!"; btn.style.background = "#3b82f6"; btn.style.boxShadow = "0 2px 5px rgba(59,130,246,0.35)"; }, 1500); });</script><hr /><p><a href="/contact" target="_blank" rel="noopener" style="display:block;margin:12px 0;text-align:center;align-items:center;justify-content:center;padding:10px 22px;border-radius:999px;text-decoration:none;background:linear-gradient(135deg,#ffd54f,#ffb300);color:#000;font-size:16px;font-weight:700;font-family:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;box-shadow:0 4px 10px rgba(0,0,0,.15);cursor:pointer;transition:all .15s ease;width:350px" onmouseover="this.style.background=&quot;linear-gradient(135deg,#FFE082,#FFC107)&quot;,this.style.transform=&quot;translateY(-1px)&quot;,this.style.boxShadow=&quot;0 6px 14px rgba(0,0,0,0.2)&quot;" onmouseout="this.style.background=&quot;linear-gradient(135deg,#FFD54F,#FFB300)&quot;,this.style.transform=&quot;translateY(0)&quot;,this.style.boxShadow=&quot;0 4px 10px rgba(0,0,0,0.15)&quot;">ğŸº Buy me a beer on PayPal</a></p><blockquote class="prompt-tip"><p>ğŸ‘‰ğŸ‘‰ğŸ‘‰ <a href="https://medium.com/@zhgchgli" target="_blank"><strong>Follow Me On Medium!</strong> (1,053+ Followers)</a> ğŸ‘ˆğŸ‘ˆğŸ‘ˆ</p></blockquote><blockquote class="prompt-info"><p>æœ¬æ–‡é¦–æ¬¡ç™¼è¡¨æ–¼ Medium (<a href="https://medium.com/p/755509180ca8" target="_blank"><strong>é»æ­¤æŸ¥çœ‹åŸå§‹ç‰ˆæœ¬</strong></a>)ï¼Œç”± <a href="/posts/tools/medium-to-jekyll/" target="_blank">ZMediumToMarkdown</a> æä¾›è‡ªå‹•è½‰æ›èˆ‡åŒæ­¥æŠ€è¡“ã€‚</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/zh-tw/zmediumtomarkdown/2024-08-13-755509180ca8.md" target="_blank">Improve this page on Github.</a></p></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/kkday-tech-blog/">KKday Tech Blog</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/vision-framework/" class="post-tag no-text-decoration" >vision-framework</a> <a href="/tags/apple-intelligence/" class="post-tag no-text-decoration" >apple-intelligence</a> <a href="/tags/ai/" class="post-tag no-text-decoration" >ai</a> <a href="/tags/machine-learning/" class="post-tag no-text-decoration" >machine-learning</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> æœ¬æ–‡ç”±ä½œè€…ä»¥ <a href="https://creativecommons.org/licenses/by/4.0/deed.zh-hant"> CC BY 4.0 </a> æˆæ¬Šã€‚</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">åˆ†äº«</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=iOS%20Vision%20framework%EF%BD%9CWWDC%2024%20Swift%20Concurrency%20%E8%88%87%E6%96%B0%20API%20%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90%E8%88%87%E5%AF%A6%E4%BD%9C%E6%8C%87%E5%8D%97%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2F755509180ca8%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=iOS%20Vision%20framework%EF%BD%9CWWDC%2024%20Swift%20Concurrency%20%E8%88%87%E6%96%B0%20API%20%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90%E8%88%87%E5%AF%A6%E4%BD%9C%E6%8C%87%E5%8D%97%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2F755509180ca8%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2F755509180ca8%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="è¤‡è£½é€£çµ" data-title-succeed="é€£çµå·²æˆåŠŸè¤‡è£½ï¼" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">æœ€è¿‘æ›´æ–°</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/%E5%B1%B1%E9%99%BD-%E5%B1%B1%E9%99%B0%E6%97%85%E9%81%8A%E5%85%A8%E6%94%BB%E7%95%A5-%E5%BB%A3%E5%B3%B6-%E5%B2%A1%E5%B1%B1%E6%99%AF%E9%BB%9E%E8%88%87%E4%BA%BA%E6%96%87%E6%AD%B7%E5%8F%B2%E4%B8%80%E6%AC%A1%E6%90%9E%E6%87%82-%E5%90%AB%E4%BA%A4%E9%80%9A-%E8%A1%8C%E7%A8%8B%E8%88%87%E6%8E%A5%E5%B1%B1%E9%99%B0%E7%8E%A9%E6%B3%95-sanin/">å±±é™½Ã—å±±é™°æ—…éŠå…¨æ”»ç•¥ï¼šå»£å³¶ã€å²¡å±±æ™¯é»èˆ‡äººæ–‡æ­·å²ä¸€æ¬¡ææ‡‚ï¼ˆå«äº¤é€šã€è¡Œç¨‹èˆ‡æ¥å±±é™°ç©æ³•ï¼‰</a><li class="text-truncate lh-lg"> <a href="/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/2026-%E7%86%B1%E6%B5%B7%E5%A4%8F%E5%AD%A3%E8%8A%B1%E7%81%AB%E5%A4%A7%E6%9C%83%E5%AE%8C%E5%85%A8%E6%94%BB%E7%95%A5-%E8%A7%80%E8%B3%9E%E5%9C%B0%E9%BB%9E-%E4%BA%A4%E9%80%9A-%E7%BE%8E%E9%A3%9F-%E4%BD%8F%E5%AE%BF-%E9%99%84%E8%BF%91%E6%99%AF%E9%BB%9E-%E4%B8%80%E6%97%A5%E9%81%8A%E8%A1%8C%E7%A8%8B-atami/">2026 ç†±æµ·å¤å­£èŠ±ç«å¤§æœƒå®Œå…¨æ”»ç•¥ï¼šè§€è³åœ°é»ã€äº¤é€šã€ç¾é£Ÿã€ä½å®¿ã€é™„è¿‘æ™¯é»ã€ä¸€æ—¥éŠè¡Œç¨‹</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/%E8%87%AA%E7%84%B6%E4%BA%BA%E6%86%91%E8%AD%89%E7%94%B3%E8%BE%A6%E8%88%87%E4%BD%BF%E7%94%A8%E5%85%A8%E6%94%BB%E7%95%A5-%E8%B2%BB%E7%94%A8-pin-%E8%AE%80%E5%8D%A1%E6%A9%9F-%E6%89%8B%E6%A9%9Fnfc-%E8%A1%8C%E5%8B%95%E8%87%AA%E7%84%B6%E4%BA%BA%E6%86%91%E8%AD%89-%E7%94%A8%E9%80%94%E4%B8%80%E6%AC%A1%E6%90%9E%E6%87%82-cdc/">è‡ªç„¶äººæ†‘è­‰ç”³è¾¦èˆ‡ä½¿ç”¨å…¨æ”»ç•¥ï¼šè²»ç”¨ã€PINã€è®€å¡æ©Ÿã€æ‰‹æ©ŸNFCã€è¡Œå‹•è‡ªç„¶äººæ†‘è­‰ã€ç”¨é€”ä¸€æ¬¡ææ‡‚</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/ios-certificates-identifiers%E8%88%87profiles%E8%A9%B3%E8%A7%A3-fastlane-match%E7%B5%B1%E4%B8%80%E7%AE%A1%E7%90%86%E6%86%91%E8%AD%89%E8%88%87ci-cd%E6%95%B4%E5%90%88%E5%AF%A6%E6%88%B0-823ac523ccc8/">iOS Certificates, Identifiers & Profiles æ˜¯ä»€éº¼åŠ Fastlane Match çµ±ä¸€ç®¡ç†æ†‘è­‰èˆ‡ CI/CD çš„ä¸€äº›ç­†è¨˜</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/line-bank-%E5%85%A5%E9%87%91-firstrade-%E6%95%99%E5%AD%B8-%E5%BF%AB%E9%80%9F%E5%88%B0%E5%B8%B3-%E4%BD%8E%E6%89%8B%E7%BA%8C%E8%B2%BB150%E5%85%83-%E5%B8%B3%E6%88%B6%E5%8D%87%E7%B4%9A%E8%88%87%E6%89%8B%E7%BA%8C%E8%B2%BB%E8%A3%9C%E5%8A%A9%E7%94%B3%E8%AB%8B%E5%85%A8%E6%94%BB%E7%95%A5-e4d139fe0685/">æ‰‹æŠŠæ‰‹æ•™å­¸ â€” LINE Bank å…¥é‡‘ Firstrade å¿«é€Ÿåˆ°å¸³ã€æ‰‹çºŒè²»åªè¦ 150 å…ƒåŠå¸³æˆ¶å‡ç´š/ç´„å®šè½‰å¸³/æ‰‹çºŒè²»è£œåŠ©ç”³è«‹æ•™å­¸</a></ul></section><section><h2 class="panel-heading">ç†±é–€æ¨™ç±¤</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">ç”Ÿæ´»</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/japan/">japan</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E9%96%8B%E7%AE%B1/">é–‹ç®±</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a> <a class="post-tag btn btn-outline-primary" href="/tags/travel/">travel</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">ç« ç¯€ç›®éŒ„ ğŸ”–</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">å»¶ä¼¸é–±è®€</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-dev/ios-12-coreml-%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92%E6%96%87%E5%AD%97%E5%88%86%E9%A1%9E-%E8%87%AA%E8%A8%82%E6%A8%A1%E5%9E%8B%E8%A8%93%E7%B7%B4%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8-793bf2cdda0f/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1539789635" data-df="YYYY å¹´ M æœˆ D æ—¥" > 2018 å¹´ 10 æœˆ 17 æ—¥ </time><h4 class="pt-0 my-2">iOS 12 CoreML æ©Ÿå™¨å­¸ç¿’æ–‡å­—åˆ†é¡ï½œè‡ªè¨‚æ¨¡å‹è¨“ç·´å¯¦æˆ°æ•™å­¸</h4><div class="text-muted"><p>é‡å°iOSé–‹ç™¼è€…ï¼Œè§£æå¦‚ä½•åˆ©ç”¨CoreML 2.0è‡ªè¨‚ä¸¦è¨“ç·´æ–‡å­—åˆ†é¡æ¨¡å‹ï¼Œè§£æ±ºæ–‡ç« åˆ†é¡è‡ªå‹•åŒ–ç—›é»ï¼Œå¯¦ç¾æº–ç¢ºç‡æå‡èˆ‡å¿«é€Ÿéƒ¨ç½²ï¼ŒåŠ©ä½ æ‰“é€ æ™ºèƒ½åˆ†é¡AppåŠŸèƒ½ã€‚</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/vision%E6%A1%86%E6%9E%B6swift%E6%95%99%E5%AD%B8-app%E8%87%AA%E5%8B%95%E4%BA%BA%E8%87%89%E8%AD%98%E5%88%A5%E8%A3%81%E5%9C%96%E5%AF%A6%E4%BD%9C%E6%8C%87%E5%8D%97-9a9aa892f9a9/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1539705684" data-df="YYYY å¹´ M æœˆ D æ—¥" > 2018 å¹´ 10 æœˆ 17 æ—¥ </time><h4 class="pt-0 my-2">Visionæ¡†æ¶Swiftæ•™å­¸ï½œAPPè‡ªå‹•äººè‡‰è­˜åˆ¥è£åœ–å¯¦ä½œæŒ‡å—</h4><div class="text-muted"><p>é‡å°iOS APPé–‹ç™¼è€…ï¼Œè§£æ±ºé ­åƒè£åœ–æ™‚äººè‡‰è¢«æˆªæ–·å•é¡Œï¼Œé€éVisionæ¡†æ¶è‡ªå‹•å®šä½äººè‡‰ä¸¦ç²¾æº–è£åˆ‡ï¼Œæå‡ç”¨æˆ¶é ­åƒå‘ˆç¾å“è³ªï¼Œå¯¦ç¾äººè‡‰ä¸­å¿ƒé»è£åœ–ï¼Œå„ªåŒ–APPä½¿ç”¨é«”é©—ã€‚</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/ios-12-%E4%BB%A5%E4%B8%8A-swift-%E5%AF%A6%E4%BD%9Capp%E9%80%9A%E7%9F%A5%E8%A8%AD%E5%AE%9A%E9%A0%81%E6%8D%B7%E5%BE%91-%E6%8F%90%E5%8D%87%E4%BD%BF%E7%94%A8%E8%80%85%E9%80%9A%E7%9F%A5%E9%AB%94%E9%A9%97-f644db1bb8bf/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1542033522" data-df="YYYY å¹´ M æœˆ D æ—¥" > 2018 å¹´ 11 æœˆ 12 æ—¥ </time><h4 class="pt-0 my-2">iOS 12 ä»¥ä¸Šï¼šSwift å¯¦ä½œAPPé€šçŸ¥è¨­å®šé æ·å¾‘ï½œæå‡ä½¿ç”¨è€…é€šçŸ¥é«”é©—</h4><div class="text-muted"><p>é‡å°iOS 12ä»¥ä¸Šç”¨æˆ¶ï¼Œé€éSwiftæ–°å¢APPé€šçŸ¥è¨­å®šæ·å¾‘ï¼Œè®“ä½¿ç”¨è€…å¯ç›´æ¥åœ¨APPå…§èª¿æ•´é€šçŸ¥åå¥½ï¼Œé¿å…ç³»çµ±ç›´æ¥é—œé–‰é€šçŸ¥å°è‡´éŒ¯éé‡è¦è¨Šæ¯ï¼Œæå‡æ¨æ’­ç²¾æº–åº¦èˆ‡ä½¿ç”¨è€…æ»¿æ„åº¦ã€‚</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-life/medium-partner-program-%E5%85%A8%E7%90%83%E9%96%8B%E6%94%BE-%E5%8F%B0%E7%81%A3%E5%89%B5%E4%BD%9C%E8%80%85%E8%BC%95%E9%AC%86%E5%8A%A0%E5%85%A5%E8%B3%BA%E5%8F%96%E6%96%87%E7%AB%A0%E6%94%B6%E7%9B%8A-cefdf4d41746/" class="btn btn-outline-primary" aria-label="ä¸Šä¸€ç¯‡" ><p>Medium Partner Program å…¨çƒé–‹æ”¾ï½œå°ç£å‰µä½œè€…è¼•é¬†åŠ å…¥è³ºå–æ–‡ç« æ”¶ç›Š</p></a> <a href="/posts/zrealm-robotic-process-automation/ios-%E6%8D%B7%E5%BE%91%E8%87%AA%E5%8B%95%E5%8C%96-3-%E6%8B%9B%E8%87%AA%E5%8B%95%E8%BD%89%E7%99%BC%E7%B0%A1%E8%A8%8A%E8%88%87%E5%BB%BA%E7%AB%8B%E6%8F%90%E9%86%92%E5%BE%85%E8%BE%A6%E4%BA%8B%E9%A0%85%E6%95%99%E5%AD%B8-309d0302877b/" class="btn btn-outline-primary" aria-label="ä¸‹ä¸€ç¯‡" ><p>iOS æ·å¾‘è‡ªå‹•åŒ–æ‡‰ç”¨å ´æ™¯â€Šâ€”â€Šè‡ªå‹•è½‰ç™¼ç°¡è¨Šèˆ‡è‡ªå‹•å»ºç«‹æé†’å¾…è¾¦äº‹é …</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>Â© <time>2026</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="é™¤éå¦æœ‰è¨»æ˜ï¼Œæœ¬ç¶²ç«™ä¸Šçš„æ‰€æœ‰æ–‡ç« çš†ç”±ä½œè€…ä¾æ“š å‰µç”¨ CC å§“åæ¨™ç¤º 4.0 åœ‹éš›æˆæ¬Šæ¢æ¬¾ï¼ˆCC BY 4.0ï¼‰æˆæ¬Šä½¿ç”¨ã€‚" >ç‰ˆæ¬Šæ‰€æœ‰ã€‚</span> <br/> ç€è¦½æ¬¡æ•¸: <u>811,854+</u>, æœ€å¾Œæ›´æ–°æ™‚é–“: <u>2026-01-18 11:11:57 +08:00</u></p><p>æœ¬ç«™ä½¿ç”¨ <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> ä¸»é¡Œå»ºç½®æ–¼ <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>ã€‚<br/> Medium æ–‡ç« ç”± <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown</a> è½‰æ›è€Œæˆã€‚</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">ç†±é–€æ¨™ç±¤</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">ç”Ÿæ´»</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/japan/">japan</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E9%96%8B%E7%AE%B1/">é–‹ç®±</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a> <a class="post-tag btn btn-outline-primary" href="/tags/travel/">travel</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">ç™¼ç¾æœ‰æ–°çš„å…§å®¹ç‰ˆæœ¬ã€‚</p><button type="button" class="btn btn-primary" aria-label="Update"> æ›´æ–° </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'zh-TW';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'General', 'data-category-id': 'DIC_kwDOHdowL84CU-q5', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">æ‰¾ä¸åˆ°ç¬¦åˆçš„çµæœã€‚</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
