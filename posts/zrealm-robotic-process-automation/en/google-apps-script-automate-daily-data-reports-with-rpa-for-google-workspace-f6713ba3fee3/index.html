<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Google Apps Script｜Automate Daily Data Reports with RPA for Google Workspace" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="Boost your productivity by automating daily data reports in Google Workspace using Google Apps Script RPA. Eliminate manual tasks, reduce errors, and generate accurate reports effortlessly every day." /><meta property="og:description" content="Boost your productivity by automating daily data reports in Google Workspace using Google Apps Script RPA. Eliminate manual tasks, reduce errors, and generate accurate reports effortlessly every day." /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-robotic-process-automation/en/google-apps-script-automate-daily-data-reports-with-rpa-for-google-workspace-f6713ba3fee3/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-robotic-process-automation/en/google-apps-script-automate-daily-data-reports-with-rpa-for-google-workspace-f6713ba3fee3/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/f6713ba3fee3/1*jZmdNWSYQUq6Ja9PKaawWw.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-04-14T23:16:45+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/f6713ba3fee3/1*jZmdNWSYQUq6Ja9PKaawWw.webp" /><meta property="twitter:title" content="Google Apps Script｜Automate Daily Data Reports with RPA for Google Workspace" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://medium.com/@zhgchgli/"},"dateModified":"2024-10-20T14:06:10+08:00","datePublished":"2024-04-14T23:16:45+08:00","description":"Boost your productivity by automating daily data reports in Google Workspace using Google Apps Script RPA. Eliminate manual tasks, reduce errors, and generate accurate reports effortlessly every day.","headline":"Google Apps Script｜Automate Daily Data Reports with RPA for Google Workspace","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+","url":"https://zhgchg.li/assets/f6713ba3fee3/1*jZmdNWSYQUq6Ja9PKaawWw.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-robotic-process-automation/en/google-apps-script-automate-daily-data-reports-with-rpa-for-google-workspace-f6713ba3fee3/"},"url":"https://zhgchg.li/posts/zrealm-robotic-process-automation/en/google-apps-script-automate-daily-data-reports-with-rpa-for-google-workspace-f6713ba3fee3/"}</script><title>Google Apps Script｜Automate Daily Data Reports with RPA for Google Workspace | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script><link rel="alternate" hreflang="zh-cn" href="/posts/zrealm-robotic-process-automation/zh-cn/google-apps-script-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E6%95%B0%E6%8D%AE%E6%8A%A5%E8%A1%A8%E8%87%AA%E5%8A%A8%E5%8C%96-rpa-%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5-google-analytics-%E4%B8%8E-google-sheet-f6713ba3fee3/"><link rel="alternate" hreflang="zh-tw" href="/posts/zrealm-robotic-process-automation/google-apps-script-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E6%95%B8%E6%93%9A%E5%A0%B1%E8%A1%A8%E8%87%AA%E5%8B%95%E5%8C%96-rpa-%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5-google-analytics-%E8%88%87-google-sheet-f6713ba3fee3/"><link rel="alternate" hreflang="x-default" href="/posts/zrealm-robotic-process-automation/en/google-apps-script-automate-daily-data-reports-with-rpa-for-google-workspace-f6713ba3fee3/"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0">An iOS, web, and automation developer from Taiwan 🇹🇼 who also loves sharing, traveling, and writing.</p><a href="https://medium.com/@zhgchgli" target="_blank" style="display: block;text-align: center;font-style: normal;/* text-decoration: underline; */font-size: 1.2em;color: var(--heading-color);">1K+ Followers on Medium</a></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/english/" class="nav-link"> <i class="fa-fw fa fa-solid fa-language"></i> <span>ENGLISH POSTS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Google Apps Script｜Automate Daily Data Reports with RPA for Google Workspace</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Google Apps Script｜Automate Daily Data Reports with RPA for Google Workspace</h1><p class="post-desc fw-light mb-4">Boost your productivity by automating daily data reports in Google Workspace using Google Apps Script RPA. Eliminate manual tasks, reduce errors, and generate accurate reports effortlessly every day.</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1713107805" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 14, 2024 </time> </span> <span> Updated <time data-ts="1729404370" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Oct 20, 2024 </time> </span><div class="mt-3 mb-3"> <a href="/assets/f6713ba3fee3/1*jZmdNWSYQUq6Ja9PKaawWw.webp" class="popup img-link preview-img blur"><img data-src="/assets/f6713ba3fee3/1*jZmdNWSYQUq6Ja9PKaawWw.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></div><div class="d-flex justify-content-between"> <span style="display: inline-flex; align-items: center; gap: 4px;"> By <em> <a href="https://medium.com/@zhgchgli/">ZhgChgLi</a> </em> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" style="display: block; "><path fill="#007bff" d="M271.2 56C265.1 49.8 256.2 47.3 247.8 49.6C239.4 51.9 232.9 58.4 230.8 66.8L215.5 127C214.4 131.4 209.9 134 205.6 132.7L145.8 115.9C137.4 113.5 128.4 115.9 122.3 122C116.2 128.1 113.8 137.1 116.2 145.5L133.1 205.3C134.3 209.6 131.7 214.1 127.4 215.2L67.1 230.5C58.7 232.6 52.1 239.2 49.8 247.6C47.5 256 50 264.9 56.2 271L100.7 314.3C103.9 317.4 103.9 322.6 100.7 325.8L56.3 369.1C50.1 375.2 47.6 384.1 49.9 392.5C52.2 400.9 58.8 407.4 67.2 409.6L127.4 424.9C131.8 426 134.4 430.5 133.1 434.8L116.2 494.5C113.8 502.9 116.2 511.9 122.3 518C128.4 524.1 137.4 526.5 145.8 524.1L205.6 507.2C209.9 506 214.4 508.6 215.5 512.9L230.8 573.1C232.9 581.5 239.5 588.1 247.9 590.4C256.3 592.7 265.2 590.2 271.3 584L314.6 539.5C317.7 536.3 322.9 536.3 326.1 539.5L369.3 584C375.4 590.2 384.3 592.7 392.7 590.4C401.1 588.1 407.6 581.5 409.8 573.1L425.1 513C426.2 508.6 430.7 506 435 507.3L494.8 524.2C503.2 526.6 512.2 524.2 518.3 518.1C524.4 512 526.8 503 524.4 494.6L507.5 434.8C506.3 430.5 508.9 426 513.2 424.9L573.4 409.6C581.8 407.5 588.4 400.9 590.7 392.5C593 384.1 590.5 375.1 584.3 369.1L539.8 325.8C536.6 322.7 536.6 317.5 539.8 314.3L584.3 271C590.5 264.9 593 256 590.7 247.6C588.4 239.2 581.8 232.7 573.4 230.5L513.2 215.2C508.8 214.1 506.2 209.6 507.5 205.3L524.4 145.5C526.8 137.1 524.4 128.1 518.3 122C512.2 115.9 503.2 113.5 494.8 115.9L435 132.8C430.7 134 426.2 131.4 425.1 127.1L409.8 66.8C407.7 58.4 401.1 51.8 392.7 49.5C384.3 47.2 375.4 49.7 369.3 55.9L326 100.5C322.9 103.7 317.7 103.7 314.5 100.5L271.2 56z"/><path d="M250 330 l60 60 100 -140" stroke="#ffffff" stroke-width="40" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="7660 words" > <em>42 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Google Apps Script｜Automate Daily Data Reports with RPA for Google Workspace</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">章節 (Chapters)🔖</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Google Apps Script｜Automate Daily Data Reports with RPA for Google Workspace</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><blockquote class="prompt-tip"><p><a href="/posts/zrealm-robotic-process-automation/zh-cn/google-apps-script-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E6%95%B0%E6%8D%AE%E6%8A%A5%E8%A1%A8%E8%87%AA%E5%8A%A8%E5%8C%96-rpa-%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5-google-analytics-%E4%B8%8E-google-sheet-f6713ba3fee3/"><strong>点击这里</strong></a>查看本文章简体中文版本。</p></blockquote><blockquote class="prompt-tip"><p><a href="/posts/zrealm-robotic-process-automation/google-apps-script-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E6%95%B8%E6%93%9A%E5%A0%B1%E8%A1%A8%E8%87%AA%E5%8B%95%E5%8C%96-rpa-%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5-google-analytics-%E8%88%87-google-sheet-f6713ba3fee3/"><strong>點擊這裡</strong></a>查看本文章正體中文版本。</p></blockquote><blockquote class="prompt-info"><p>This post was translated with AI assistance — let me know if anything sounds off!</p></blockquote><hr /><h3 id="implementing-daily-data-report-rpa-automation-with-google-apps-script"><span class="me-2">Implementing Daily Data Report RPA Automation with Google Apps Script</span><a href="#implementing-daily-data-report-rpa-automation-with-google-apps-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Using Google Apps Script for Robotic Process Automation of Google Workspace Services</p><p><a href="/assets/f6713ba3fee3/1*jZmdNWSYQUq6Ja9PKaawWw.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*jZmdNWSYQUq6Ja9PKaawWw.webp" alt="Photo by [Possessed Photography](https://unsplash.com/@possessedphotography?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9Ijk1OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Photo by <a href="https://unsplash.com/@possessedphotography?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash" target="_blank">Possessed Photography</a></p><h3 id="robotic-process-automation"><span class="me-2">Robotic Process Automation</span><a href="#robotic-process-automation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>RPA (Robotic Process Automation) translates to “Process Automation Robots” in Chinese. Looking back at human history, from gathering by hand to the Stone Age and then to agricultural civilization, from the Industrial Revolution last century to the rise of information technology in the past 20 years, human work efficiency and productivity have grown exponentially. Along this journey, RPA applications have been everywhere: water wheels in the agricultural era (automating threshing), textile machines in the Industrial Revolution (automating weaving), factory robotic arms (automating assembly), and finally, the focus of this article—automating information-related tasks such as automatic report queries and automatic notifications.</p><p>To be honest, I only recently learned this term. Since my first job (7 years ago), I have been working on RPA tasks such as writing web crawlers for data statistics, automating CI/CD processes, automating data queries, automating stability data alerts, and automating daily routine operations. However, I used to refer to all of these simply as “automation.” It’s time to give it a proper name — RPA (Robotic Process Automation).</p><p><strong>Previous RPA work mostly focused on “manually writing code to automate a single problem,”</strong> lacking comprehensive early-stage evaluation and analysis, use of No/Low Code tools, compliance, operation monitoring, real data statistics, continuous improvement, and corporate culture promotion. These are all essential parts of complete RPA. However, as mentioned earlier, I only recently learned about this professional field, so please allow me to start with a practical implementation article first!</p><p>There are many platforms offering RPA services, such as Automation Anywhere, UiPath, Microsoft Power Automate, Blue Prism, as well as Zapier, IFTTT, Automate.io, and more.<br /> Choose the right service based on the actual problem you want to solve and the platform.</p><p>Recommend a free and open-source browser-based RPA tool: <a href="https://chromewebstore.google.com/detail/automa/infppggnoaenmfagbfknfkancpbljcca" target="_blank">Automa</a>.</p><blockquote><p><strong><em>Broadly speaking, transforming active dependencies between people or between people and tasks into dependencies on platforms by people or tasks is also a form of RPA.</em></strong></p></blockquote><blockquote><p><strong><em>For example: Use Asana/Jira and other project management tools to manage tasks uniformly.</em></strong></p></blockquote><blockquote><p><strong><em>Based on the concept of shifting from active to passive, a service that originally required manual checking for new notifications can be automated with RPA to notify us automatically when there are updates.</em></strong></p></blockquote><blockquote><p><strong><em>For example: previously implemented <a href="/posts/zrealm-dev/en/google-apps-script-automate-gmail-forwarding-to-slack-channels-with-custom-filters-d414bdbdb8c9/">Gmail to Slack</a> to forward specific notification emails to the work group.</em></strong></p></blockquote><h4 id="benefits-assessment-of-robotic-process-automation"><span class="me-2">Benefits Assessment of Robotic Process Automation</span><a href="#benefits-assessment-of-robotic-process-automation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Previously, in the “<a href="/posts/pinkoi-engineering/en/high-efficiency-engineering-teams-pinkoi-tech-career-talk-insights-11f6c8568154/"><strong>2021 Pinkoi Tech Career Talk — Secrets of High-Efficiency Engineering Teams</strong></a>,” I shared about the cost of cumulative small tasks and flow interruptions; assuming a routine repetitive task takes 15 minutes each time and occurs 10 times a week, nearly 130 hours are wasted annually; adding the “flow switching” cost, the total waste could reach nearly 200 hours per year.</p><p><a href="/assets/f6713ba3fee3/1*U6bzH6b5-PRxFBktvkOa2Q.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*U6bzH6b5-PRxFBktvkOa2Q.webp" alt="[**2021 Pinkoi Tech Career Talk — Secrets of High-Efficiency Engineering Teams**](/posts/pinkoi-engineering/en/high-efficiency-engineering-teams-pinkoi-tech-career-talk-insights-11f6c8568154/)" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2OTIiIGhlaWdodD0iNTA1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/posts/pinkoi-engineering/en/high-efficiency-engineering-teams-pinkoi-tech-career-talk-insights-11f6c8568154/"><strong>2021 Pinkoi Tech Career Talk — Secrets to High-Efficiency Engineering Teams</strong></a></p><blockquote><p>Flow switching means the time it takes to pause from being fully focused and engaged in an important task, handle other matters, and then return to regain the same focused state.</p></blockquote><p>The benefits of developing RPA can be evaluated by the diagram below. As long as the development time and frequency of occurrence exceed the wasted time, it is worth investing resources to implement:</p><p><a href="/assets/f6713ba3fee3/1*B8Zs8QyRv4KxQZJEBi81lA.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*B8Zs8QyRv4KxQZJEBi81lA.webp" alt="&lt;https://twitter.com/swyx/status/1196401158744502272&gt;{:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjExMTciPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p><a href="https://twitter.com/swyx/status/1196401158744502272" target="_blank">https://twitter.com/swyx/status/1196401158744502272</a></p><ul><li><p>X-axis: Task occurrence frequency e.g., 50/Day (50 times per day)</p><li><p>Y-axis: How much manpower time is needed to complete each task</p><li><p>Time-consuming range calculated over 5 years; the middle of the table shows the labor cost of wasted time over 5 years</p><li><p>White indicates that the time cost of automation may exceed the benefits gained, making improvement not worthwhile.</p><li><p>Green indicates items worth automating</p><li><p>Red indicates a strong recommendation to automate.</p></ul><blockquote><p><strong><em>Besides saving time, automated standardized processes also reduce human error and improve stability.</em></strong></p></blockquote><h4 id="the-relationship-between-robotic-process-automation-and-ai"><span class="me-2">The Relationship Between Robotic Process Automation and AI</span><a href="#the-relationship-between-robotic-process-automation-and-ai" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>With the rise of AI, RPA is often mentioned; however, I believe RPA and AI are not directly related. <strong>RPA existed long before AI, and the benefits of implementing AI in businesses may not surpass those of improving RPA. RPA is more about corporate culture and work habits.</strong> Nonetheless, it is undeniable that AI can help RPA reach the next level. For example, RPA used to handle only precise, routine tasks, but with AI, it can perform fuzzy, more dynamic, and intelligent decision-making tasks.</p><h3 id="robotic-process-automation-at-google-workspace"><span class="me-2">Robotic Process Automation at Google Workspace</span><a href="#robotic-process-automation-at-google-workspace" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Google Workspace (formerly G Suite) is a great partner for our daily office collaboration. We use Gmail for email hosting, Google Docs for documents, Google Sheets for reports, Google Forms for surveys, and more. Connecting these services or communicating with internal and external systems requires us to implement RPA.</p><p>But Google does not offer direct RPA services; however, you can achieve this through the following services:</p><ul><li><p>No Code: <a href="https://cloud.google.com/appsheet#pricing" target="_blank">App Sheet</a> (paid service) allows non-developers to create service integration automation directly through a GUI.</p><li><p>Low Code: <a href="https://www.google.com/script/start/" target="_blank">Google Apps Script</a> (free service) enables quick and easy connection of Google services and external/internal systems with simple scripting.</p><li><p>Function as a Service: <a href="https://cloud.google.com/functions?hl=zh_tw" target="_blank">Cloud Functions</a> (paid service with free tier) lets you write full code and services, deploy, and run directly on Google Cloud.</p></ul><p>No Code platform <a href="https://cloud.google.com/appsheet#pricing" target="_blank">App Sheet</a> I haven’t used it before, but I have considerable experience with <a href="https://cloud.google.com/functions?hl=zh_tw" target="_blank">Cloud Functions</a> and <a href="https://www.google.com/script/start/" target="_blank">Google Apps Script</a>. Below are some personal experiences and choices from my past use:</p><h4 id="cloud-functions"><span class="me-2">Cloud Functions</span><a href="#cloud-functions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><p>Deployment Required</p><li><p>Supports multiple programming languages: Node.js, Python, Java, Go, PHP, Ruby…</p><li><p>Supports third-party package dependency management, installation, and usage</p><li><p>Supports full authentication mechanism</p><li><p>Maximum execution time limit: 60 minutes</p><li><p>Pay as You Go: Charges Based on Usage Count, Execution Time, Different Processors, and Memory Used</p><li><p>Cold Start Limitation (If not called for a long time, the first call will have a longer response time)</p><li><p>Cannot directly connect to Google services; must go through Auth/API verification</p><li><p><strong>Free Plan Details</strong><br /> Cloud Functions offers a permanent free plan for compute time resources, including allocations based on GB-seconds and GHz-seconds. Besides 2 million invocations, this free plan provides 400,000 GB-seconds and 200,000 GHz-seconds of compute time, along with 5 GB of internet data transfer per month. The free plan usage is calculated at the equivalent USD amount of the Tier 1 pricing mentioned above. Regardless of whether the function runs in a Tier 1 or Tier 2 pricing region, the system allocates the equivalent USD amount. However, when deducting from the free plan quota, the system uses the function execution region’s tier (Tier 1 or Tier 2) as the basis.<br /> Please note, even if you use the free plan, you must have a valid billing account.</p></ul><p>In summary, Cloud Functions are recommended when a more complete and complex RPA integration is needed or when there are multiple external API integration requirements.</p><p>Previous cases using Cloud Functions include:</p><ul><li><li></ul><p>I use it only when integrating with non-Google Workspace services and when bridging other external services is required.</p><h4 id="google-apps-script"><span class="me-2">Google Apps Script</span><a href="#google-apps-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><p>Convenient, simple, and fast</p><li><p>Completely Free</p><li><p>No complicated Auth authentication needed for service integration<br /> (Google Apps Script uses the currently logged-in account as the execution identity)</p><li><p>Built-in scheduling and calendar trigger features</p><li><p>Uses Google Network to perform web requests</p><li><p>Development is only possible with Google Apps Script (based on JavaScript)</p><li><p>No support for package managers or version control features</p><li><p><strong>Due to security concerns, <a href="https://issuetracker.google.com/issues/36758197" target="_blank">customizing the Request User-Agent information is not possible</a></strong></p><li><p><strong>Execution time limit: the script must finish within 6 minutes or it will be terminated.</strong></p><li><p>Other limits and quotas can be found in the official <a href="https://developers.google.com/apps-script/guides/services/quotas?hl=zh-tw" target="_blank">GAS Information</a>:</p></ul><p><a href="/assets/f6713ba3fee3/1*mLuy6AHDRTkUU1dJZpUEBg.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*mLuy6AHDRTkUU1dJZpUEBg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NzUiIGhlaWdodD0iMTA0NiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/f6713ba3fee3/1*ulyNjWc-imCLKqS4EsorWg.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*ulyNjWc-imCLKqS4EsorWg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NzAiIGhlaWdodD0iODMxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Previous cases using Google Apps Script include:</p><ul><li><li><li><li><li></ul><p>Due to execution time limits and API request customization restrictions, I only use Google Apps Script for simple and quick services. For needs involving integration with Google services, I prioritize Google Apps Script (because implementing full Google service authentication in Cloud Functions requires more effort).</p><h3 id="robotic-process-automation-with-google-apps-script--workday-report-google-sheet-x-google-analytics"><span class="me-2">Robotic Process Automation with Google Apps Script — Workday Report (Google Sheet x Google Analytics)</span><a href="#robotic-process-automation-with-google-apps-script--workday-report-google-sheet-x-google-analytics" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Finally, we arrive at the main topic of this article: implementing Google service RPA automation using Google Apps Script.</p><h4 id="background"><span class="me-2">Background</span><a href="#background" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The product team needs to query Google Analytics data daily and fill it into a Google Sheet report for team trend analysis. The daily data should also be published on a Dashboard screen for all members to stay updated.</p><p>Colleagues spend about 30 minutes every day upon arriving at the office to complete this task; if there are other matters to handle, they must wait until this routine work is finished before starting or may delay sending the daily data message.</p><p><strong>A Simple Estimate of RPA Benefits:</strong></p><ul><li><p>Annual consumption expenditure:<br /> 1 person x 30 mins x 365 days (including holidays) <strong>= 182 hours</strong></p><li><p>Automation Cost:<br /> In this case, it takes about 1 person x 5 days <strong>= 40 hours</strong></p></ul><blockquote><p>Therefore, we only need to invest one week of development time to handle the workload of the colleague responsible for data checking in the long term, enabling them to focus on more important tasks.</p></blockquote><h4 id="goal"><span class="me-2">Goal</span><a href="#goal" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Our goal is to use Google Apps Script to build an RPA that automatically fetches daily data from Google Analytics and internal system report APIs, then fills it into Google Sheets, along with creating a Web UI Dashboard.</p><h4 id="final-result"><span class="me-2">Final Result</span><a href="#final-result" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/f6713ba3fee3/1*6xAMrwENoxD0c7Hv1_RTTw.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*6xAMrwENoxD0c7Hv1_RTTw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjMyMSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ul><li>Google Sheet:<br /> <a href="https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit?usp=sharing" target="_blank">https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit?usp=sharing</a></ul><p><a href="/assets/f6713ba3fee3/1*8SRT_wSe2aQGzcqpRt2Qjw.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*8SRT_wSe2aQGzcqpRt2Qjw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjQzNiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ul><li>Web GUI URL:<br /> <a href="https://script.google.com/macros/s/AKfycbz2Vk-ikU8DSXjpnLq9r6HNAn3zlNAosvDoItG0cxy0bmItRDSVyEzTdwsL2HyFUz99/exec" target="_blank">https://script.google.com/macros/s/AKfycbz2Vk-ikU8DSXjpnLq9r6HNAn3zlNAosvDoItG0cxy0bmItRDSVyEzTdwsL2HyFUz99/exec</a></ul><blockquote><p><strong><em>The data is fake and for demo use only; from 2024/04/13 onward, it will be especially low or remain at 0 because my zhgchg.li GA truly has “0” traffic Q_Q.</em></strong></p></blockquote><h4 id="tasks-to-complete"><span class="me-2">Tasks to Complete</span><a href="#tasks-to-complete" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li><p>Creating Google Apps Script and Getting Familiar with the Editor</p><li><p>Get/Create the Sheet for the Corresponding Date</p><li><p>Integrate Google Analytics to Retrieve Data</p><li><p>Fill in the data</p><li><p>Set Schedule for Daily Automatic Execution</p></ol><h4 id="disclaimer"><span class="me-2">Disclaimer</span><a href="#disclaimer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Due to the article’s explanation needs, the following code minimizes abstraction to enhance clarity. You can modify it according to your actual requirements.</p><blockquote><p><strong><em>At the end of the article, there is a complete public Google Sheet &amp; Google Apps Script. If you don’t want to follow the steps one by one, you can directly modify the template attached at the end.</em></strong></p></blockquote><h4 id="step-1-create-google-apps-script"><span class="me-2">Step 1. Create Google Apps Script</span><a href="#step-1-create-google-apps-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/f6713ba3fee3/1*-xYCGpKIBztRd4jvxFnrUg.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*-xYCGpKIBztRd4jvxFnrUg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MDAiIGhlaWdodD0iMjU5Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Simply select “Extensions” -&gt; “Apps Script” on the report where we want to implement automation to automatically create a Google Apps Script linked to the Google Sheet report.</p><p>You can also create <a href="https://www.google.com/script/start/" target="_blank">Google Apps Script</a> directly from the Google Apps Script homepage, but this will not link it to Google Sheets.</p><blockquote><p><strong>Linking is not required to operate the corresponding Google Sheet.</strong> Both creation methods are possible. The difference is who owns the script: if linked to a report, the owner is the report owner; if created independently, the owner is the creator. Ownership matters because if the account is deactivated due to resignation, the script may become invalid or be deleted.</p></blockquote><p><a href="/assets/f6713ba3fee3/1*vnCPiALLTi4CIcYbASQpOg.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*vnCPiALLTi4CIcYbASQpOg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NTAiIGhlaWdodD0iMzI2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>After creating the script, we can first rename our script project from the top.</p><h4 id="basic-knowledge-of-google-apps-script"><span class="me-2">Basic Knowledge of Google Apps Script</span><a href="#basic-knowledge-of-google-apps-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Before moving on to the next step of writing the program, let’s first cover some basic knowledge of Google Apps Script.</p><p><strong>About the Editor</strong></p><p>Default import of Google service SDKs (can be called without explicit import):</p><ul><li><p>CalendarApp Calendar</p><li><p>DocumentApp Google Drive</p><li><p>FormApp Google Form</p><li><p>SpreadsheetApp Google Sheet</p><li><p>GmailApp Gmail</p><li><p><a href="https://developers.google.com/apps-script/reference/slides/border?hl=zh-tw#getdashstyle" target="_blank">Others…</a></p></ul><p><a href="/assets/f6713ba3fee3/1*PKO-daNhyquINvk-_LfgQQ.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*PKO-daNhyquINvk-_LfgQQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2ODkiIGhlaWdodD0iMzQzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ol><li><p>Files:<br /> You can add multiple .gs files to store different object codes for better organization; all files run under the same namespace and lifecycle, so be careful as duplicate object or variable names may overwrite each other.<br /> Besides .gs script files, you can also add .html HTML Template files for rendering the Web UI. (This will be explained later)</p><li><p>Database:<br /> Databases written by others (a.k.a Lib) can be imported and used via their Script ID. Of course, programs we write can also be deployed as databases for others to use.<br /> There are also some powerful tools packaged by experts available. The downside is that Script IDs can only be found through Google search, as there is no official database list for reference.<br /> e.g. HTML Parser Tool Cheer.io Script ID: <code class="language-plaintext highlighter-rouge">1ReeQ6WO8kKNxoaA_O0XEQ589cIrRvEBA9qcWpNqdOP17i47u6N9M5Xh0</code></p><li><p>Service:<br /> The SDK for Google services allows you to add and use services that are not included by default.<br /> e.g. Google Analytics Data</p><li><p>Restore, Next Step Operation</p><li><p>Save or Control + s</p><li><p>Run or Control + r<br /> If an error occurs, directly prompt in the Console and terminate the script</p><li><p>Debugging<br /> When the execution reaches a breakpoint (10), it will pause and open the Debug View on the right. You can then continue running the program.<br /> If an error occurs, the execution will pause and open the Debug View on the right.</p><li><p>Debugging and Running Target Method (Function Name)<br /> Only methods within the currently selected file can be chosen.</p><li><p>View Editor Execution Log</p></ol><blockquote><p><em>Another point is formatting: in some browsers, pressing “Control + [” to indent may trigger the back action. Be careful with this!</em></p></blockquote><p><a href="https://chromewebstore.google.com/detail/lfjcgcmkmjjlieihflfhjopckgpelofo" target="_blank"><strong>Google Apps Script GitHub Assistant Chrome Extension version control plugin</strong></a></p><ul><li>It is recommended to install this extension to connect Google Apps Script with git, enabling version control to prevent accidental loss of work.</ul><p><a href="/assets/f6713ba3fee3/1*NIFgOdZ2EIv-FCfYOxCmsA.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*NIFgOdZ2EIv-FCfYOxCmsA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDIxIiBoZWlnaHQ9IjE5OSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/f6713ba3fee3/1*JQyQCdn-FAtItaJ2qrLnng.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*JQyQCdn-FAtItaJ2qrLnng.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTkiIGhlaWdodD0iMjM1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/f6713ba3fee3/1*TqsqHeccSt8-qN4Tav0kwg.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*TqsqHeccSt8-qN4Tav0kwg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NTQiIGhlaWdodD0iNjQxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>If you encounter a Push/Pull Error or clicking has no response, please first follow the steps above: “Options” -&gt; Connect to Github or re-verify Google authorization.</ul><p><strong>Logger Message</strong></p><p>You can use the following script with Debug to print debug logs in the console below.</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nx">Logger</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Hi</span><span class="dl">"</span><span class="p">)</span>
</pre></table></code></div></div><p><strong>Execution Records and Error Information</strong></p><p>If logs or errors occur while running in the editor, they will be displayed directly. To check execution records or errors that happen during automatic runs, go to the “Executions” tab.</p><p><a href="/assets/f6713ba3fee3/1*pqn5ljYggb1lVWgYDSq6Sw.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*pqn5ljYggb1lVWgYDSq6Sw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMzUwIiBoZWlnaHQ9IjQ5OSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><strong>Automatic Trigger</strong></p><p><a href="/assets/f6713ba3fee3/1*0DfewvWMWZ_bEC7beOPmLQ.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*0DfewvWMWZ_bEC7beOPmLQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NzYiIGhlaWdodD0iMzEyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/f6713ba3fee3/1*lh87YD-SL6VDf5pcLlB_WQ.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*lh87YD-SL6VDf5pcLlB_WQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NzQiIGhlaWdodD0iNzc3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>The “Trigger Conditions” tab allows you to set how methods in the script are automatically triggered. The available automatic trigger conditions include:</p><ul><li><p>When Google Sheet: opens, edits, content changes, or form is submitted</p><li><p>Scheduled cycle trigger: Execute once every X minutes, X hours, X days, X weeks, or X months</p><li><p>Trigger on specific date: Execute at YYYY-MM-DD HH:MM</p><li><p>When Calendar: Updated Trigger</p></ul><p>Error notification settings allow you to configure how you are notified when a script execution fails.</p><p><strong>Grant Execution Permission Identity</strong></p><blockquote><p><strong><em>The first time you run/deploy or add a new service or resource, you need to reauthorize your identity. After authorization, all executions will run under your authorized identity, so make sure the account you authorize (usually the current one) has permission for the resource or service (e.g., access to the Google Sheet).</em></strong></p></blockquote><p>After the account selection pop-up appears, choose the account to authorize execution (usually the current Google Apps Script account):</p><p><a href="/assets/f6713ba3fee3/0*psr2krTcvVZxkxYp.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/0*psr2krTcvVZxkxYp.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NjQiIGhlaWdodD0iNTIwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>The message “Google hasn’t verified this app” appears because the app we are developing is for personal use and does not require Google verification.</p><p>Simply click “Advanced” -&gt; “Go to XXX (unsafe)” -&gt; “Allow”:</p><p><a href="/assets/f6713ba3fee3/0*lP6NI_yUYntq7pIy.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/0*lP6NI_yUYntq7pIy.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MjkiIGhlaWdodD0iMzMyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/f6713ba3fee3/0*jIQHxmmy3ziOHXR7.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/0*jIQHxmmy3ziOHXR7.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MTgiIGhlaWdodD0iNDU0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/f6713ba3fee3/0*F8SGw5p1RtWaIea5.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/0*F8SGw5p1RtWaIea5.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NjgiIGhlaWdodD0iNzIxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>After completing the authorization, the script can run successfully. If the resources are unchanged, re-authorization is not required.</p><h4 id="2-getcreate-the-sheet-for-the-corresponding-date"><span class="me-2">2. Get/Create the Sheet for the Corresponding Date</span><a href="#2-getcreate-the-sheet-for-the-corresponding-date" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>After understanding the basics, we can start writing the program for the first feature.</p><p>We create the following multiple files to conveniently store different objects.</p><p><code class="language-plaintext highlighter-rouge">DailyReportStyle.gs</code> Column Style Object:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">HeaderStyle</span> <span class="p">{</span>
  <span class="nf">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">#ffffff</span><span class="dl">"</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">#e3284b</span><span class="dl">"</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">bold</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">horizontalAlignment</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">center</span><span class="dl">"</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">verticalAlignment</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">middle</span><span class="dl">"</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">ContentStyle</span> <span class="p">{</span>
  <span class="nf">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">#000000</span><span class="dl">"</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">#ffffff</span><span class="dl">"</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">bold</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">horizontalAlignment</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">center</span><span class="dl">"</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">verticalAlignment</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">middle</span><span class="dl">"</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">HeaderDateStyle</span> <span class="p">{</span>
  <span class="nf">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">#ffffff</span><span class="dl">"</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">#001a40</span><span class="dl">"</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">bold</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">horizontalAlignment</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">center</span><span class="dl">"</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">verticalAlignment</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">middle</span><span class="dl">"</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">DailyReportField.gs</code> field data object:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">DailyReportField</span> <span class="p">{</span>
  <span class="nf">constructor</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">headerStyle</span><span class="p">,</span> <span class="nx">contentStyle</span><span class="p">,</span> <span class="nx">format</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">value</span> <span class="o">=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">headerStyle</span> <span class="o">=</span> <span class="nx">headerStyle</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">contentStyle</span> <span class="o">=</span> <span class="nx">contentStyle</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">format</span> <span class="o">=</span> <span class="nx">format</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">DailyReport.gs</code> main script logic for the report:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">DailyReport</span> <span class="p">{</span>
  <span class="nf">constructor</span><span class="p">(</span><span class="nx">sheetID</span><span class="p">,</span> <span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">separateSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">openById</span><span class="p">(</span><span class="nx">sheetID</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">date</span> <span class="o">=</span> <span class="nx">date</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">sheetFields</span> <span class="o">=</span> <span class="p">[</span>
      <span class="k">new</span> <span class="nc">DailyReportField</span><span class="p">(</span><span class="dl">"</span><span class="s2">Date</span><span class="dl">"</span><span class="p">,</span> <span class="k">new</span> <span class="nc">HeaderDateStyle</span><span class="p">(),</span> <span class="k">new</span> <span class="nc">HeaderDateStyle</span><span class="p">()),</span>
      <span class="k">new</span> <span class="nc">DailyReportField</span><span class="p">(</span><span class="dl">"</span><span class="s2">Day of Week</span><span class="dl">"</span><span class="p">,</span> <span class="k">new</span> <span class="nc">HeaderDateStyle</span><span class="p">(),</span> <span class="k">new</span> <span class="nc">HeaderDateStyle</span><span class="p">()),</span>
      <span class="k">new</span> <span class="nc">DailyReportField</span><span class="p">(</span><span class="dl">"</span><span class="s2">Daily Traffic</span><span class="dl">"</span><span class="p">,</span> <span class="k">new</span> <span class="nc">HeaderStyle</span><span class="p">(),</span> <span class="k">new</span> <span class="nc">ContentStyle</span><span class="p">(),</span> <span class="dl">"</span><span class="s2">#,##0</span><span class="dl">"</span><span class="p">,</span> <span class="dl">'</span><span class="s1">=INDIRECT(SUBSTITUTE(ADDRESS(1,COLUMN(),4),"1","")&amp;4)+INDIRECT(SUBSTITUTE(ADDRESS(1,COLUMN(),4),"1","")&amp;5)</span><span class="dl">'</span><span class="p">),</span> <span class="c1">// =4(PC Traffic) + 5(Mobile Traffic)</span>
      <span class="k">new</span> <span class="nc">DailyReportField</span><span class="p">(</span><span class="dl">"</span><span class="s2">PC Traffic</span><span class="dl">"</span><span class="p">,</span> <span class="k">new</span> <span class="nc">HeaderStyle</span><span class="p">(),</span> <span class="k">new</span> <span class="nc">ContentStyle</span><span class="p">(),</span> <span class="dl">"</span><span class="s2">#,##0</span><span class="dl">"</span><span class="p">),</span>
      <span class="k">new</span> <span class="nc">DailyReportField</span><span class="p">(</span><span class="dl">"</span><span class="s2">Mobile Traffic</span><span class="dl">"</span><span class="p">,</span> <span class="k">new</span> <span class="nc">HeaderStyle</span><span class="p">(),</span> <span class="k">new</span> <span class="nc">ContentStyle</span><span class="p">(),</span> <span class="dl">"</span><span class="s2">#,##0</span><span class="dl">"</span><span class="p">),</span>
      <span class="k">new</span> <span class="nc">DailyReportField</span><span class="p">(</span><span class="dl">"</span><span class="s2">Registrations</span><span class="dl">"</span><span class="p">,</span> <span class="k">new</span> <span class="nc">HeaderStyle</span><span class="p">(),</span> <span class="k">new</span> <span class="nc">ContentStyle</span><span class="p">(),</span> <span class="dl">"</span><span class="s2">#,##0</span><span class="dl">"</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="c1">// Explanation of the Daily Traffic formula:</span>
    <span class="c1">// 1. The COLUMN() function returns the current cell's column number.</span>
    <span class="c1">// 2. ADDRESS(1, COLUMN(), 4) generates a relative address without $ signs for row 1 and the current column. For example, in column 3, it returns "C1".</span>
    <span class="c1">// 3. SUBSTITUTE(ADDRESS(1, COLUMN(), 4), "1", "") removes the "1" from the address, leaving just the column letter, e.g., "C".</span>
    <span class="c1">// 4. INDIRECT(SUBSTITUTE(ADDRESS(1, COLUMN(), 4), "1", "") &amp; 4) concatenates the column letter with 4 to form a reference like "C4", which INDIRECT converts to a cell reference.</span>
    <span class="c1">// 5. Similarly, INDIRECT(SUBSTITUTE(ADDRESS(1, COLUMN(), 4), "1", "") &amp; 5) references the cell in the same column but row 5.</span>
    <span class="c1">// 6. Finally, the formula adds the values from these two INDIRECT references.</span>
  <span class="p">}</span>

  <span class="nf">execute</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">sheet</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nf">getSheet</span><span class="p">();</span>

  <span class="p">}</span>

  <span class="c1">// Get the target sheet for the given date</span>
  <span class="nf">getSheet</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Use month to identify the sheet, find the current month sheet</span>
    <span class="kd">var</span> <span class="nx">thisMonthSheet</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">separateSheet</span><span class="p">.</span><span class="nf">getSheetByName</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">getSheetName</span><span class="p">());</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">thisMonthSheet</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// If not found, create a new month sheet</span>
      <span class="nx">thisMonthSheet</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nf">makeMonthSheet</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">thisMonthSheet</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Naming rule for month sheets</span>
  <span class="nf">getSheetName</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">Utilities</span><span class="p">.</span><span class="nf">formatDate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">date</span><span class="p">,</span> <span class="dl">"</span><span class="s2">GMT+8</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">yyyy-MM</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// Create a new month sheet</span>
  <span class="nf">makeMonthSheet</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Add the current month sheet and move it to the first position</span>
    <span class="kd">var</span> <span class="nx">thisMonthSheet</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">separateSheet</span><span class="p">.</span><span class="nf">insertSheet</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">getSheetName</span><span class="p">(),</span> <span class="p">{</span><span class="na">index</span><span class="p">:</span> <span class="mi">0</span><span class="p">});</span>
    <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">activate</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">separateSheet</span><span class="p">.</span><span class="nf">moveActiveSheet</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

    <span class="c1">// Insert first column: field names, set pinned columns, width 200</span>
    <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">insertColumnsBefore</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">setFrozenColumns</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">setColumnWidths</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>

    <span class="c1">// Fill in field names</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">const</span> <span class="nx">currentRow</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">sheetFields</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">sheetField</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">sheetFields</span><span class="p">[</span><span class="nx">currentRow</span><span class="p">];</span>
      <span class="kd">const</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">sheetField</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
      <span class="kd">const</span> <span class="nx">style</span> <span class="o">=</span> <span class="nx">sheetField</span><span class="p">.</span><span class="nx">headerStyle</span><span class="p">;</span>
      
      <span class="kd">const</span> <span class="nx">range</span> <span class="o">=</span> <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">getRange</span><span class="p">(</span><span class="nf">parseInt</span><span class="p">(</span><span class="nx">currentRow</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nf">setContent</span><span class="p">(</span><span class="nx">range</span><span class="p">,</span> <span class="nx">text</span><span class="p">,</span> <span class="nx">style</span><span class="p">);</span>
      <span class="nx">range</span><span class="p">.</span><span class="nf">setHorizontalAlignment</span><span class="p">(</span><span class="dl">"</span><span class="s2">left</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Set row heights</span>
    <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">setRowHeights</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">Object</span><span class="p">.</span><span class="nf">keys</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">sheetFields</span><span class="p">).</span><span class="nx">length</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>

    <span class="c1">// Set pinned first and second rows (Date, Day of Week)</span>
    <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">setFrozenRows</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

    <span class="c1">// Add total column</span>
    <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">insertColumnsAfter</span><span class="p">(</span><span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">getLastColumn</span><span class="p">(),</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// Add one column after the last</span>
    <span class="kd">const</span> <span class="nx">summaryColumnIndex</span> <span class="o">=</span> <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">getLastColumn</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

    <span class="c1">// Fill total column</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">const</span> <span class="nx">currentRow</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">sheetFields</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">sheetField</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">sheetFields</span><span class="p">[</span><span class="nx">currentRow</span><span class="p">];</span>
      <span class="kd">const</span> <span class="nx">summaryRowIndex</span> <span class="o">=</span> <span class="nf">parseInt</span><span class="p">(</span><span class="nx">currentRow</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

      <span class="kd">const</span> <span class="nx">range</span> <span class="o">=</span> <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">getRange</span><span class="p">(</span><span class="nx">summaryRowIndex</span><span class="p">,</span> <span class="nx">summaryColumnIndex</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">style</span> <span class="o">=</span> <span class="nx">sheetField</span><span class="p">.</span><span class="nx">contentStyle</span><span class="p">;</span>

      <span class="k">if </span><span class="p">(</span><span class="nx">summaryRowIndex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Date...</span>
        <span class="k">this</span><span class="p">.</span><span class="nf">setContent</span><span class="p">(</span><span class="nx">range</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Total</span><span class="dl">"</span><span class="p">,</span> <span class="nx">style</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if </span><span class="p">(</span><span class="nx">summaryRowIndex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Day of Week... merge...</span>
        <span class="kd">const</span> <span class="nx">mergeRange</span> <span class="o">=</span> <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">getRange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">summaryColumnIndex</span><span class="p">,</span> <span class="nx">summaryRowIndex</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nf">setContent</span><span class="p">(</span><span class="nx">mergeRange</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Total</span><span class="dl">"</span><span class="p">,</span> <span class="nx">style</span><span class="p">);</span>
        <span class="nx">mergeRange</span><span class="p">.</span><span class="nf">merge</span><span class="p">();</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nf">setContent</span><span class="p">(</span><span class="nx">range</span><span class="p">,</span> <span class="dl">'</span><span class="s1">=IFERROR(SUM(INDIRECT(SUBSTITUTE(ADDRESS(1, 1, 4), "1", "") &amp; </span><span class="dl">'</span><span class="o">+</span><span class="nx">summaryRowIndex</span><span class="o">+</span><span class="dl">'</span><span class="s1">):INDIRECT(SUBSTITUTE(ADDRESS(1, COLUMN() - 1, 4), "1", "") &amp; </span><span class="dl">'</span><span class="o">+</span><span class="nx">summaryRowIndex</span><span class="o">+</span><span class="dl">'</span><span class="s1">)), 0)</span><span class="dl">'</span><span class="p">,</span> <span class="nx">style</span><span class="p">);</span>

        <span class="c1">// 1. IFERROR(value, [value_if_error]) checks for errors in the formula and returns the specified value if an error occurs. Here, it returns 0 if SUM causes an error.</span>
        <span class="c1">// 2. SUM(range) calculates the total of all numbers in the range.</span>
        <span class="c1">// 3. INDIRECT(ref_text, [is_A1_notation]) converts a string to a cell reference, used here to dynamically generate the range.</span>
        <span class="c1">// 4. SUBSTITUTE(text, old_text, new_text, [instance_num]) replaces specified text in a string. Here, it removes "1" from the ADDRESS output.</span>
        <span class="c1">// 5. ADDRESS(row, column, [abs_num], [a1], [sheet]) returns a cell address. ADDRESS(1, 1, 4) returns the cell at row 1, column 1 without $ or sheet name. ADDRESS(1, COLUMN() - 1, 4) returns the address for the first row and the column before the current one.</span>
        <span class="c1">// 6. COLUMN() returns the current cell's column number.</span>
        <span class="c1">// 7. summaryRowIndex = current row</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">thisMonthSheet</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nf">setContent</span><span class="p">(</span><span class="nx">range</span><span class="p">,</span> <span class="nx">text</span><span class="p">,</span> <span class="nx">style</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nc">String</span><span class="p">(</span><span class="nx">text</span><span class="p">)</span> <span class="o">!=</span> <span class="dl">""</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">range</span><span class="p">.</span><span class="nf">setValue</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">range</span><span class="p">.</span><span class="nf">setBackgroundColor</span><span class="p">(</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span><span class="p">);</span>
    <span class="nx">range</span><span class="p">.</span><span class="nf">setFontColor</span><span class="p">(</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span><span class="p">);</span>

    <span class="k">if </span><span class="p">(</span><span class="nx">style</span><span class="p">.</span><span class="nx">bold</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">range</span><span class="p">.</span><span class="nf">setFontWeight</span><span class="p">(</span><span class="dl">"</span><span class="s2">bold</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">range</span><span class="p">.</span><span class="nf">setHorizontalAlignment</span><span class="p">(</span><span class="nx">style</span><span class="p">.</span><span class="nx">horizontalAlignment</span><span class="p">);</span>
    <span class="nx">range</span><span class="p">.</span><span class="nf">setVerticalAlignment</span><span class="p">(</span><span class="nx">style</span><span class="p">.</span><span class="nx">verticalAlignment</span><span class="p">);</span>
    <span class="nx">range</span><span class="p">.</span><span class="nf">setFontSize</span><span class="p">(</span><span class="nx">style</span><span class="p">.</span><span class="nx">size</span><span class="p">);</span>
    <span class="nx">range</span><span class="p">.</span><span class="nf">setBorder</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="dl">"</span><span class="s2">black</span><span class="dl">"</span><span class="p">,</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">BorderStyle</span><span class="p">.</span><span class="nx">SOLID</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Main.gs</code> serves as the main program entry point:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">targetGoogleSheetID</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE</span><span class="dl">"</span>
<span class="c1">// https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit#gid=275710641</span>

<span class="kd">function</span> <span class="nf">debug</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">report</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DailyReport</span><span class="p">(</span><span class="nx">targetGoogleSheetID</span><span class="p">,</span> <span class="k">new</span> <span class="nc">Date</span><span class="p">());</span>
  <span class="nx">report</span><span class="p">.</span><span class="nf">execute</span><span class="p">();</span>
<span class="p">}</span>
</pre></table></code></div></div><p><a href="/assets/f6713ba3fee3/1*c3QsffDXeLBakupNbAClrw.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*c3QsffDXeLBakupNbAClrw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTgwIiBoZWlnaHQ9IjM1MyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>After finishing, return to <code class="language-plaintext highlighter-rouge">Main.gs</code>, select “debug,” and click debug to check if the execution results are correct and error-free.</p><p><a href="/assets/f6713ba3fee3/1*y8kdOIBp8tvbVmOBOpsVKA.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*y8kdOIBp8tvbVmOBOpsVKA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NjMiIGhlaWdodD0iMjY0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Executing correctly returns to the report showing the current new month, including default fields and total fields. If it already exists, there will be no response.</p><h4 id="3-integrate-google-analytics-to-fetch-data"><span class="me-2">3. Integrate Google Analytics to Fetch Data</span><a href="#3-integrate-google-analytics-to-fetch-data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>First, create the “AnalyticsData” service:</p><p><a href="/assets/f6713ba3fee3/1*bXngqmgXbTVeQ9r7rjQAbQ.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*bXngqmgXbTVeQ9r7rjQAbQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDQ5IiBoZWlnaHQ9Ijc1MCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Build Query Conditions Using GA4 Debug Tool:</p><ul><li><p><a href="https://ga-dev-tools.google/ga4/query-explorer/" target="_blank">https://ga-dev-tools.google/ga4/query-explorer/</a></p><li><p>Can be compared when creating filter conditions in the GA4 backend</p><li><p><strong>This article uses querying the number of Sessions as an example to distinguish device Grouping</strong></p></ul><p>After logging in and authorizing, select the target resource:</p><p><a href="/assets/f6713ba3fee3/1*M333knrSQqSxD1hCBcqU4A.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*M333knrSQqSxD1hCBcqU4A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MjQiIGhlaWdodD0iMjUyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Note down the number displayed under the property; this is the GA Property ID you need to query.</p><p>Set query parameters and filter conditions:</p><p><a href="/assets/f6713ba3fee3/1*pZqC3U4WeTFGrq80TMWmRA.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*pZqC3U4WeTFGrq80TMWmRA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NTciIGhlaWdodD0iNDczIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Press “Make Request” to get the Response result:</p><p><a href="/assets/f6713ba3fee3/1*UArMZH6b0LPKj8_HTFrX9g.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*UArMZH6b0LPKj8_HTFrX9g.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NDciIGhlaWdodD0iODg5Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>You can also compare the data under the same conditions in the GA4 backend to see if they match. If there is a large discrepancy, it might be due to missing Filter conditions, so you should check again.</p><h4 id="summary"><span class="me-2">Summary</span><a href="#summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Here is a small pitfall discovered by a marketing colleague: GA data can have delays, so the numbers you check today might differ from those checked yesterday (e.g., bounce rate). Therefore, it’s best to look back a few days to ensure the data reflects the final values.</p><blockquote><p><em>Once the GA Debug Tool works properly, we can convert it into Google Apps Script.</em></p></blockquote><p>Add a new file <code class="language-plaintext highlighter-rouge">GAData.gs</code>:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
</pre><td class="rouge-code"><pre><span class="c1">// Remember to add Google Analytics Data API to Services, or you'll see this error: ReferenceError: AnalyticsData is not defined</span>
<span class="c1">// GA Debug Tool: https://ga-dev-tools.web.app/ga4/query-explorer/</span>

<span class="kd">class</span> <span class="nc">GAData</span> <span class="p">{</span>
  <span class="nf">constructor</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">date</span> <span class="o">=</span> <span class="nx">date</span><span class="p">;</span>

    <span class="kd">const</span> <span class="nx">traffic</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nf">fetchGADailyUsage</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">pc_traffic</span> <span class="o">=</span> <span class="nx">traffic</span><span class="p">[</span><span class="dl">"</span><span class="s2">desktop</span><span class="dl">"</span><span class="p">];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">mobile_traffic</span> <span class="o">=</span> <span class="nx">traffic</span><span class="p">[</span><span class="dl">"</span><span class="s2">mobile</span><span class="dl">"</span><span class="p">];</span>
  <span class="p">}</span>

  <span class="nf">fetchGADailyUsage</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">dimensionPlatform</span> <span class="o">=</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nf">newDimension</span><span class="p">();</span>
    <span class="nx">dimensionPlatform</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">deviceCategory</span><span class="dl">"</span><span class="p">;</span>

    <span class="kd">const</span> <span class="nx">metric</span> <span class="o">=</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nf">newMetric</span><span class="p">();</span>
    <span class="nx">metric</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">sessions</span><span class="dl">"</span><span class="p">;</span>

    <span class="kd">const</span> <span class="nx">dateRange</span> <span class="o">=</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nf">newDateRange</span><span class="p">();</span>
    <span class="c1">// Default query for data within the given date range e.g. 2024-01-01 ~ 2024-01-01</span>
    <span class="nx">dateRange</span><span class="p">.</span><span class="nx">startDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nf">getDateString</span><span class="p">();</span>
    <span class="nx">dateRange</span><span class="p">.</span><span class="nx">endDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nf">getDateString</span><span class="p">();</span>

    <span class="c1">// Filter Example:</span>
    <span class="c1">// const filterExpression = AnalyticsData.newFilterExpression();</span>
    <span class="c1">// const filter = AnalyticsData.newFilter();</span>
    <span class="c1">// filter.fieldName = "landingPagePlusQueryString";</span>
    <span class="c1">// const stringFilter = AnalyticsData.newStringFilter()</span>
    <span class="c1">// stringFilter.value = "/life\|/article\|/chat\|/house\|/event/230502\|/event/230310";</span>
    <span class="c1">// stringFilter.matchType = "PARTIAL_REGEXP";</span>
    <span class="c1">// filter.stringFilter = stringFilter;</span>
    <span class="c1">// filterExpression.filter = filter;</span>

    <span class="kd">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nf">newRunReportRequest</span><span class="p">();</span>
    <span class="nx">request</span><span class="p">.</span><span class="nx">dimensions</span> <span class="o">=</span> <span class="p">[</span><span class="nx">dimensionPlatform</span><span class="p">];</span>
    <span class="nx">request</span><span class="p">.</span><span class="nx">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="nx">metric</span><span class="p">];</span>
    <span class="nx">request</span><span class="p">.</span><span class="nx">dateRanges</span> <span class="o">=</span> <span class="nx">dateRange</span><span class="p">;</span>

    <span class="c1">// Filter Example:</span>
    <span class="c1">// const filterExpression = AnalyticsData.newFilterExpression();</span>
    <span class="c1">// filterExpression.expression = filterExpression;</span>
    <span class="c1">// request.dimensionFilter = filterExpression;</span>
    <span class="c1">// or Not</span>
    <span class="c1">// const notFilterExpression = AnalyticsData.newFilterExpression();</span>
    <span class="c1">// notFilterExpression.notExpression = filterExpression;</span>
    <span class="c1">// request.dimensionFilter = notFilterExpression;</span>

    <span class="kd">const</span> <span class="nx">report</span> <span class="o">=</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nx">Properties</span><span class="p">.</span><span class="nf">runReport</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="dl">"</span><span class="s2">properties/</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">gaPropertyId</span><span class="p">).</span><span class="nx">rows</span><span class="p">;</span>
    <span class="c1">// No data</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">report</span> <span class="o">==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">{</span><span class="dl">"</span><span class="s2">desktop</span><span class="dl">"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="dl">"</span><span class="s2">mobile</span><span class="dl">"</span><span class="p">:</span> <span class="mi">0</span><span class="p">};</span>
    <span class="p">}</span>

    <span class="c1">// [{metricValues=[{value=4517}], dimensionValues=[{value=mobile}]}, {metricValues=[{value=3189}], dimensionValues=[{value=desktop}]}, {metricValues=[{value=63}], dimensionValues=[{value=tablet}]}]</span>

    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">report</span><span class="p">.</span><span class="nf">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">result</span><span class="p">[</span><span class="nx">element</span><span class="p">.</span><span class="nx">dimensionValues</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">value</span><span class="p">]</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">metricValues</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">value</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nf">getDateString</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">Utilities</span><span class="p">.</span><span class="nf">formatDate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">date</span><span class="p">,</span> <span class="dl">"</span><span class="s2">GMT+8</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">yyyy-MM-dd</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Main.gs</code> Add test content:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">targetGoogleSheetID</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE</span><span class="dl">"</span><span class="p">;</span>
<span class="c1">// https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit#gid=275710641</span>

<span class="kd">const</span> <span class="nx">gaPropertyId</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">318495208</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">function</span> <span class="nf">debug</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">report</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DailyReport</span><span class="p">(</span><span class="nx">targetGoogleSheetID</span><span class="p">,</span> <span class="k">new</span> <span class="nc">Date</span><span class="p">());</span>
  <span class="nx">report</span><span class="p">.</span><span class="nf">execute</span><span class="p">();</span>
  <span class="c1">//</span>
  <span class="kd">var</span> <span class="nx">gaData</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GAData</span><span class="p">(</span><span class="k">new</span> <span class="nc">Date</span><span class="p">());</span>
  <span class="nx">Logger</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">gaData</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Press Run or Debug to get the program fetch results:</p><p><a href="/assets/f6713ba3fee3/1*jwkk0ZqsFN6QyjPLT_gmaw.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*jwkk0ZqsFN6QyjPLT_gmaw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NDAiIGhlaWdodD0iMTU2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>OK! Match confirmed.</p><p><a href="/assets/f6713ba3fee3/1*fKO7pJzsyjdUWwhyJr3czg.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*fKO7pJzsyjdUWwhyJr3czg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMzgiIGhlaWdodD0iMzUxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>When this step is completed, the directory file structure will look like the image above.</p><h4 id="4-data-filling"><span class="me-2">4. Data Filling</span><a href="#4-data-filling" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>After setting up the sheet and gathering the data, the next step is to fill the data into the fields.</p><p>Adjust <code class="language-plaintext highlighter-rouge">DailyReport.gs</code> to add a new column by date and include logic to fill data:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">DailyReport</span> <span class="p">{</span>
  <span class="nf">constructor</span><span class="p">(</span><span class="nx">sheetID</span><span class="p">,</span> <span class="nx">date</span><span class="p">,</span> <span class="nx">gaData</span><span class="p">,</span> <span class="nx">inHouseReportData</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">separateSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">openById</span><span class="p">(</span><span class="nx">sheetID</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">date</span> <span class="o">=</span> <span class="nx">date</span><span class="p">;</span>

    <span class="kd">const</span> <span class="nx">dateString</span> <span class="o">=</span> <span class="nx">Utilities</span><span class="p">.</span><span class="nf">formatDate</span><span class="p">(</span><span class="nx">date</span><span class="p">,</span> <span class="dl">"</span><span class="s2">GMT+8</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">yyyy/MM/dd</span><span class="dl">"</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">weekString</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Sunday</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Monday</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Tuesday</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Wednesday</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Thursday</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Friday</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Saturday</span><span class="dl">"</span><span class="p">][</span><span class="nx">date</span><span class="p">.</span><span class="nf">getDay</span><span class="p">()];</span> <span class="c1">// Get the weekday, Sunday is 0, Monday is 1, etc.</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">sheetFields</span> <span class="o">=</span> <span class="p">[</span>
      <span class="k">new</span> <span class="nc">DailyReportField</span><span class="p">(</span><span class="dl">"</span><span class="s2">Date</span><span class="dl">"</span><span class="p">,</span> <span class="k">new</span> <span class="nc">HeaderDateStyle</span><span class="p">(),</span> <span class="k">new</span> <span class="nc">HeaderDateStyle</span><span class="p">(),</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">dateString</span><span class="p">),</span>
      <span class="k">new</span> <span class="nc">DailyReportField</span><span class="p">(</span><span class="dl">"</span><span class="s2">Weekday</span><span class="dl">"</span><span class="p">,</span> <span class="k">new</span> <span class="nc">HeaderDateStyle</span><span class="p">(),</span> <span class="k">new</span> <span class="nc">HeaderDateStyle</span><span class="p">(),</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">weekString</span><span class="p">),</span>
      <span class="k">new</span> <span class="nc">DailyReportField</span><span class="p">(</span><span class="dl">"</span><span class="s2">Daily Traffic</span><span class="dl">"</span><span class="p">,</span> <span class="k">new</span> <span class="nc">HeaderStyle</span><span class="p">(),</span> <span class="k">new</span> <span class="nc">ContentStyle</span><span class="p">(),</span> <span class="dl">"</span><span class="s2">#,##0</span><span class="dl">"</span><span class="p">,</span> <span class="dl">'</span><span class="s1">=INDIRECT(SUBSTITUTE(ADDRESS(1,COLUMN(),4),"1","")&amp;4)+INDIRECT(SUBSTITUTE(ADDRESS(1,COLUMN(),4),"1","")&amp;5)</span><span class="dl">'</span><span class="p">),</span> <span class="c1">// =4(PC traffic) + 5(Mobile traffic)</span>
      <span class="k">new</span> <span class="nc">DailyReportField</span><span class="p">(</span><span class="dl">"</span><span class="s2">PC Traffic</span><span class="dl">"</span><span class="p">,</span> <span class="k">new</span> <span class="nc">HeaderStyle</span><span class="p">(),</span> <span class="k">new</span> <span class="nc">ContentStyle</span><span class="p">(),</span> <span class="dl">"</span><span class="s2">#,##0</span><span class="dl">"</span><span class="p">,</span> <span class="nx">gaData</span><span class="p">.</span><span class="nx">pc_traffic</span><span class="p">),</span>
      <span class="k">new</span> <span class="nc">DailyReportField</span><span class="p">(</span><span class="dl">"</span><span class="s2">Mobile Traffic</span><span class="dl">"</span><span class="p">,</span> <span class="k">new</span> <span class="nc">HeaderStyle</span><span class="p">(),</span> <span class="k">new</span> <span class="nc">ContentStyle</span><span class="p">(),</span> <span class="dl">"</span><span class="s2">#,##0</span><span class="dl">"</span><span class="p">,</span> <span class="nx">gaData</span><span class="p">.</span><span class="nx">mobile_traffic</span><span class="p">),</span>
      <span class="k">new</span> <span class="nc">DailyReportField</span><span class="p">(</span><span class="dl">"</span><span class="s2">Registrations</span><span class="dl">"</span><span class="p">,</span> <span class="k">new</span> <span class="nc">HeaderStyle</span><span class="p">(),</span> <span class="k">new</span> <span class="nc">ContentStyle</span><span class="p">(),</span> <span class="dl">"</span><span class="s2">#,##0</span><span class="dl">"</span><span class="p">,</span> <span class="nx">inHouseReportData</span><span class="p">.</span><span class="nx">registers</span><span class="p">)</span>
    <span class="p">]</span>
  <span class="p">}</span>

  <span class="nf">execute</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">sheet</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nf">getSheet</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">dateColumnIndex</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nf">makeOrGetDateColumn</span><span class="p">(</span><span class="nx">sheet</span><span class="p">);</span> <span class="c1">// Get existing or create new column</span>

    <span class="c1">// Fill column content</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">const</span> <span class="nx">currentRow</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">sheetFields</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">sheetField</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">sheetFields</span><span class="p">[</span><span class="nx">currentRow</span><span class="p">];</span>
      <span class="kd">const</span> <span class="nx">rowIndex</span> <span class="o">=</span> <span class="nf">parseInt</span><span class="p">(</span><span class="nx">currentRow</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

      <span class="k">if </span><span class="p">(</span><span class="nx">rowIndex</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">range</span> <span class="o">=</span> <span class="nx">sheet</span><span class="p">.</span><span class="nf">getRange</span><span class="p">(</span><span class="nx">rowIndex</span><span class="p">,</span> <span class="nx">dateColumnIndex</span><span class="p">);</span>
        <span class="kd">const</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">sheetField</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
        <span class="kd">const</span> <span class="nx">style</span> <span class="o">=</span> <span class="nx">sheetField</span><span class="p">.</span><span class="nx">contentStyle</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nf">setContent</span><span class="p">(</span><span class="nx">range</span><span class="p">,</span> <span class="nx">text</span><span class="p">,</span> <span class="nx">style</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nf">setFormat</span><span class="p">(</span><span class="nx">range</span><span class="p">,</span> <span class="nx">sheetField</span><span class="p">.</span><span class="nx">format</span><span class="p">);</span>          
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// Get the target sheet for the given date</span>
  <span class="nf">getSheet</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Separate sheets by month, find sheet for current month</span>
    <span class="kd">var</span> <span class="nx">thisMonthSheet</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">separateSheet</span><span class="p">.</span><span class="nf">getSheetByName</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">getSheetName</span><span class="p">());</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">thisMonthSheet</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Create new month sheet if not found</span>
      <span class="nx">thisMonthSheet</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nf">makeMonthSheet</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">thisMonthSheet</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Month sheet naming</span>
  <span class="nf">getSheetName</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">Utilities</span><span class="p">.</span><span class="nf">formatDate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">date</span><span class="p">,</span> <span class="dl">"</span><span class="s2">GMT+8</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">yyyy-MM</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// Create new month sheet</span>
  <span class="nf">makeMonthSheet</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Add new sheet for current month, move to first position</span>
    <span class="kd">var</span> <span class="nx">thisMonthSheet</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">separateSheet</span><span class="p">.</span><span class="nf">insertSheet</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">getSheetName</span><span class="p">(),</span> <span class="p">{</span><span class="na">index</span><span class="p">:</span> <span class="mi">0</span><span class="p">});</span>
    <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">activate</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">separateSheet</span><span class="p">.</span><span class="nf">moveActiveSheet</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

    <span class="c1">// Add first column, set header name, pin, width 200</span>
    <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">insertColumnsBefore</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">setFrozenColumns</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">setColumnWidths</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>

    <span class="c1">// Fill column names</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">const</span> <span class="nx">currentRow</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">sheetFields</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">sheetField</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">sheetFields</span><span class="p">[</span><span class="nx">currentRow</span><span class="p">];</span>
      <span class="kd">const</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">sheetField</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
      <span class="kd">const</span> <span class="nx">style</span> <span class="o">=</span> <span class="nx">sheetField</span><span class="p">.</span><span class="nx">headerStyle</span><span class="p">;</span>
      
      <span class="kd">const</span> <span class="nx">range</span> <span class="o">=</span> <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">getRange</span><span class="p">(</span><span class="nf">parseInt</span><span class="p">(</span><span class="nx">currentRow</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nf">setContent</span><span class="p">(</span><span class="nx">range</span><span class="p">,</span> <span class="nx">text</span><span class="p">,</span> <span class="nx">style</span><span class="p">);</span>
      <span class="nx">range</span><span class="p">.</span><span class="nf">setHorizontalAlignment</span><span class="p">(</span><span class="dl">"</span><span class="s2">left</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Set row heights</span>
    <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">setRowHeights</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">Object</span><span class="p">.</span><span class="nf">keys</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">sheetFields</span><span class="p">).</span><span class="nx">length</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>

    <span class="c1">// Pin first and second rows (Date, Weekday)</span>
    <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">setFrozenRows</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

    <span class="c1">// Add summary column</span>
    <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">insertColumnsAfter</span><span class="p">(</span><span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">getLastColumn</span><span class="p">(),</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// Add column after last column</span>
    <span class="kd">const</span> <span class="nx">summaryColumnIndex</span> <span class="o">=</span> <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">getLastColumn</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

    <span class="c1">// Fill summary column</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">const</span> <span class="nx">currentRow</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">sheetFields</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">sheetField</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">sheetFields</span><span class="p">[</span><span class="nx">currentRow</span><span class="p">];</span>
      <span class="kd">const</span> <span class="nx">summaryRowIndex</span> <span class="o">=</span> <span class="nf">parseInt</span><span class="p">(</span><span class="nx">currentRow</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

      <span class="kd">const</span> <span class="nx">range</span> <span class="o">=</span> <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">getRange</span><span class="p">(</span><span class="nx">summaryRowIndex</span><span class="p">,</span> <span class="nx">summaryColumnIndex</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">style</span> <span class="o">=</span> <span class="nx">sheetField</span><span class="p">.</span><span class="nx">contentStyle</span><span class="p">;</span>

      <span class="k">if </span><span class="p">(</span><span class="nx">summaryRowIndex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Date...</span>
        <span class="k">this</span><span class="p">.</span><span class="nf">setContent</span><span class="p">(</span><span class="nx">range</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Total</span><span class="dl">"</span><span class="p">,</span> <span class="nx">style</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if </span><span class="p">(</span><span class="nx">summaryRowIndex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Weekday...merge...</span>
        <span class="kd">const</span> <span class="nx">mergeRange</span> <span class="o">=</span> <span class="nx">thisMonthSheet</span><span class="p">.</span><span class="nf">getRange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">summaryColumnIndex</span><span class="p">,</span> <span class="nx">summaryRowIndex</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nf">setContent</span><span class="p">(</span><span class="nx">mergeRange</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Total</span><span class="dl">"</span><span class="p">,</span> <span class="nx">style</span><span class="p">);</span>
        <span class="nx">mergeRange</span><span class="p">.</span><span class="nf">merge</span><span class="p">();</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nf">setContent</span><span class="p">(</span><span class="nx">range</span><span class="p">,</span> <span class="dl">'</span><span class="s1">=IFERROR(SUM(INDIRECT(SUBSTITUTE(ADDRESS(1, 1, 4), "1", "") &amp; </span><span class="dl">'</span><span class="o">+</span><span class="nx">summaryRowIndex</span><span class="o">+</span><span class="dl">'</span><span class="s1">):INDIRECT(SUBSTITUTE(ADDRESS(1, COLUMN() - 1, 4), "1", "") &amp; </span><span class="dl">'</span><span class="o">+</span><span class="nx">summaryRowIndex</span><span class="o">+</span><span class="dl">'</span><span class="s1">)), 0)</span><span class="dl">'</span><span class="p">,</span> <span class="nx">style</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">thisMonthSheet</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Create or get date column</span>
  <span class="c1">// Add one column after the most recent date</span>
  <span class="nf">makeOrGetDateColumn</span><span class="p">(</span><span class="nx">sheet</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">firstRowColumnsRange</span> <span class="o">=</span> <span class="nx">sheet</span><span class="p">.</span><span class="nf">getRange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">sheet</span><span class="p">.</span><span class="nf">getLastColumn</span><span class="p">());</span> <span class="c1">// Get first row (date) range</span>
    <span class="kd">const</span> <span class="nx">firstRowColumns</span> <span class="o">=</span> <span class="nx">firstRowColumnsRange</span><span class="p">.</span><span class="nf">getValues</span><span class="p">()[</span><span class="mi">0</span><span class="p">];</span> <span class="c1">// Get values of first row</span>
    
    <span class="kd">var</span> <span class="nx">columnIndex</span> <span class="o">=</span> <span class="nx">firstRowColumns</span><span class="p">.</span><span class="nf">findIndex</span><span class="p">((</span><span class="nx">date</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">date</span> <span class="k">instanceof</span> <span class="nb">Date</span> <span class="o">&amp;&amp;</span> <span class="nx">Utilities</span><span class="p">.</span><span class="nf">formatDate</span><span class="p">(</span><span class="nx">date</span><span class="p">,</span> <span class="dl">"</span><span class="s2">GMT+8</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">yyyy/MM/dd</span><span class="dl">"</span><span class="p">)</span> <span class="o">==</span> <span class="nx">Utilities</span><span class="p">.</span><span class="nf">formatDate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">date</span><span class="p">,</span> <span class="dl">"</span><span class="s2">GMT+8</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">yyyy/MM/dd</span><span class="dl">"</span><span class="p">)));</span> <span class="c1">// Find column index for matching date</span>

    <span class="k">if </span><span class="p">(</span><span class="nx">columnIndex</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Not found, find previous date's position</span>
      <span class="kd">var</span> <span class="nx">preDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">date</span><span class="p">);</span>
      <span class="nx">preDate</span><span class="p">.</span><span class="nf">setDate</span><span class="p">(</span><span class="nx">preDate</span><span class="p">.</span><span class="nf">getDate</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>

      <span class="k">while</span><span class="p">(</span><span class="nx">preDate</span><span class="p">.</span><span class="nf">getMonth</span><span class="p">()</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">date</span><span class="p">.</span><span class="nf">getMonth</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">columnIndex</span> <span class="o">=</span> <span class="nx">firstRowColumns</span><span class="p">.</span><span class="nf">findIndex</span><span class="p">((</span><span class="nx">date</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">date</span> <span class="k">instanceof</span> <span class="nb">Date</span> <span class="o">&amp;&amp;</span> <span class="nx">Utilities</span><span class="p">.</span><span class="nf">formatDate</span><span class="p">(</span><span class="nx">date</span><span class="p">,</span> <span class="dl">"</span><span class="s2">GMT+8</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">yyyy/MM/dd</span><span class="dl">"</span><span class="p">)</span> <span class="o">==</span> <span class="nx">Utilities</span><span class="p">.</span><span class="nf">formatDate</span><span class="p">(</span><span class="nx">preDate</span><span class="p">,</span> <span class="dl">"</span><span class="s2">GMT+8</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">yyyy/MM/dd</span><span class="dl">"</span><span class="p">)));</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">columnIndex</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">preDate</span><span class="p">.</span><span class="nf">setDate</span><span class="p">(</span><span class="nx">preDate</span><span class="p">.</span><span class="nf">getDate</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="k">if </span><span class="p">(</span><span class="nx">columnIndex</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">columnIndex</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="nx">sheet</span><span class="p">.</span><span class="nf">insertColumnsAfter</span><span class="p">(</span><span class="nx">columnIndex</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// Insert new column after previous date column</span>
        <span class="nx">columnIndex</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">columnIndex</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if </span><span class="p">(</span><span class="nx">columnIndex</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">sheet</span><span class="p">.</span><span class="nf">insertColumnsAfter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// Default, insert new column after first column</span>
        <span class="nx">columnIndex</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="p">}</span> 

    <span class="c1">// Set column width</span>
    <span class="nx">sheet</span><span class="p">.</span><span class="nf">setColumnWidths</span><span class="p">(</span><span class="nx">columnIndex</span> <span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">columnIndex</span>
  <span class="p">}</span>

  <span class="c1">// Set column format style</span>
  <span class="nf">setFormat</span><span class="p">(</span><span class="nx">range</span><span class="p">,</span> <span class="nx">format</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">format</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">range</span><span class="p">.</span><span class="nf">setNumberFormat</span><span class="p">(</span><span class="nx">format</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// Fill content into column</span>
  <span class="nf">setContent</span><span class="p">(</span><span class="nx">range</span><span class="p">,</span> <span class="nx">text</span><span class="p">,</span> <span class="nx">style</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nc">String</span><span class="p">(</span><span class="nx">text</span><span class="p">)</span> <span class="o">!=</span> <span class="dl">""</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">range</span><span class="p">.</span><span class="nf">setValue</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">range</span><span class="p">.</span><span class="nf">setBackgroundColor</span><span class="p">(</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span><span class="p">);</span>
    <span class="nx">range</span><span class="p">.</span><span class="nf">setFontColor</span><span class="p">(</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span><span class="p">);</span>

    <span class="k">if </span><span class="p">(</span><span class="nx">style</span><span class="p">.</span><span class="nx">bold</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">range</span><span class="p">.</span><span class="nf">setFontWeight</span><span class="p">(</span><span class="dl">"</span><span class="s2">bold</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">range</span><span class="p">.</span><span class="nf">setHorizontalAlignment</span><span class="p">(</span><span class="nx">style</span><span class="p">.</span><span class="nx">horizontalAlignment</span><span class="p">);</span>
    <span class="nx">range</span><span class="p">.</span><span class="nf">setVerticalAlignment</span><span class="p">(</span><span class="nx">style</span><span class="p">.</span><span class="nx">verticalAlignment</span><span class="p">);</span>
    <span class="nx">range</span><span class="p">.</span><span class="nf">setFontSize</span><span class="p">(</span><span class="nx">style</span><span class="p">.</span><span class="nx">size</span><span class="p">);</span>
    <span class="nx">range</span><span class="p">.</span><span class="nf">setBorder</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="dl">"</span><span class="s2">black</span><span class="dl">"</span><span class="p">,</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">BorderStyle</span><span class="p">.</span><span class="nx">SOLID</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Adjust <code class="language-plaintext highlighter-rouge">Main.gs</code> to add data connection and assign values during the build phase:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">targetGoogleSheetID</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE</span><span class="dl">"</span><span class="p">;</span>
<span class="c1">// https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit#gid=275710641</span>

<span class="kd">const</span> <span class="nx">gaPropertyId</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">318495208</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">function</span> <span class="nf">debug</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">gaData</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GAData</span><span class="p">(</span><span class="nx">date</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">inHouseReportData</span> <span class="o">=</span> <span class="nf">fetchInHouseReportData</span><span class="p">(</span><span class="nx">date</span><span class="p">);</span>
  
  <span class="kd">const</span> <span class="nx">report</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DailyReport</span><span class="p">(</span><span class="nx">targetGoogleSheetID</span><span class="p">,</span> <span class="nx">date</span><span class="p">,</span> <span class="nx">gaData</span><span class="p">,</span> <span class="nx">inHouseReportData</span><span class="p">);</span>
  <span class="nx">report</span><span class="p">.</span><span class="nf">execute</span><span class="p">();</span>
  
<span class="p">}</span>

<span class="c1">// Simulate some data which might be fetched from other platform APIs.</span>
<span class="kd">function</span> <span class="nf">fetchInHouseReportData</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// EXAMPLE REQUEST:</span>
  <span class="c1">// var options = {</span>
  <span class="c1">//   'method' : 'get',</span>
  <span class="c1">//   'headers': {</span>
  <span class="c1">//       'Authorization':  'Bearer XXX'</span>
  <span class="c1">//   }</span>
  <span class="c1">// };</span>
  <span class="c1">// OR</span>
  <span class="c1">// var options = {</span>
  <span class="c1">//   'method' : 'post',</span>
  <span class="c1">//   'headers': {</span>
  <span class="c1">//       'Authorization':  'Bearer XXX'</span>
  <span class="c1">//   },</span>
  <span class="c1">//   'payload' : data</span>
  <span class="c1">// };</span>

  <span class="c1">// var res = UrlFetchApp.fetch(url, options);</span>
  <span class="c1">// const result = JSON.parse(res.getContentText());</span>

  <span class="c1">// REMEMBER, DUE TO SECURITY REASONS, we can't customize user-agent.</span>
  
  <span class="k">return</span> <span class="p">{</span><span class="dl">"</span><span class="s2">registers</span><span class="dl">"</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="mi">180</span> <span class="o">-</span> <span class="mi">30</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mi">30</span><span class="p">}</span> <span class="c1">// MOCK DATA random 30~180</span>
<span class="p">}</span>
</pre></table></code></div></div><p>After finishing, go back to <code class="language-plaintext highlighter-rouge">Main.gs</code>, select “debug,” and click “Start Debugging” to check if the execution results are correct and error-free.</p><p><a href="/assets/f6713ba3fee3/1*0h1-vgwjvuYBkQ0QTNeDRQ.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*0h1-vgwjvuYBkQ0QTNeDRQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NjIiIGhlaWdodD0iMjQwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Back to Google Sheet! Success! We have successfully automated adding the data for that date.</p><h4 id="5-set-a-schedule-to-run-automatically-every-day"><span class="me-2">5. Set a schedule to run automatically every day</span><a href="#5-set-a-schedule-to-run-automatically-every-day" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>After the script is completed, just set the automatic trigger condition, and it will run automatically every day.</p><p>Adjust <code class="language-plaintext highlighter-rouge">Main.gs</code> to add the <code class="language-plaintext highlighter-rouge">cronjob()</code> function:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">targetGoogleSheetID</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE</span><span class="dl">"</span><span class="p">;</span>
<span class="c1">// https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit#gid=275710641</span>

<span class="kd">const</span> <span class="nx">gaPropertyId</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">318495208</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">function</span> <span class="nf">debug</span><span class="p">()</span> <span class="p">{</span>
  <span class="nf">cronjob</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// In reality, usually today's query is for yesterday's data to get complete information</span>
<span class="kd">function</span> <span class="nf">cronjob</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">yesterday</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="p">();</span>
  <span class="nx">yesterday</span><span class="p">.</span><span class="nf">setDate</span><span class="p">(</span><span class="nx">yesterday</span><span class="p">.</span><span class="nf">getDate</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">gaData</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GAData</span><span class="p">(</span><span class="nx">yesterday</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">inHouseReportData</span> <span class="o">=</span> <span class="nf">fetchInHouseReportData</span><span class="p">(</span><span class="nx">yesterday</span><span class="p">);</span>
  
  <span class="kd">const</span> <span class="nx">report</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DailyReport</span><span class="p">(</span><span class="nx">targetGoogleSheetID</span><span class="p">,</span> <span class="nx">yesterday</span><span class="p">,</span> <span class="nx">gaData</span><span class="p">,</span> <span class="nx">inHouseReportData</span><span class="p">);</span>
  <span class="nx">report</span><span class="p">.</span><span class="nf">execute</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// Simulate that some data might be obtained from other platform APIs.</span>
<span class="kd">function</span> <span class="nf">fetchInHouseReportData</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// EXAMPLE REQUEST:</span>
  <span class="c1">// var options = {</span>
  <span class="c1">//   'method' : 'get',</span>
  <span class="c1">//   'headers': {</span>
  <span class="c1">//       'Authorization':  'Bearer XXX'</span>
  <span class="c1">//   }</span>
  <span class="c1">// };</span>
  <span class="c1">// OR</span>
  <span class="c1">// var options = {</span>
  <span class="c1">//   'method' : 'post',</span>
  <span class="c1">//   'headers': {</span>
  <span class="c1">//       'Authorization':  'Bearer XXX'</span>
  <span class="c1">//   },</span>
  <span class="c1">//   'payload' : data</span>
  <span class="c1">// };</span>

  <span class="c1">// var res = UrlFetchApp.fetch(url, options);</span>
  <span class="c1">// const result = JSON.parse(res.getContentText());</span>

  <span class="c1">// REMEMBER, DUE TO SECURITY REASONS, we can't customize user-agent.</span>
  
  <span class="k">return</span> <span class="p">{</span><span class="dl">"</span><span class="s2">registers</span><span class="dl">"</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="mi">180</span> <span class="o">-</span> <span class="mi">30</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mi">30</span><span class="p">}</span> <span class="c1">// MOCK DATA random 30~180</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Switch to the “Trigger Conditions” tab in the editor, then select “Add Trigger Condition” at the bottom right:</p><p><a href="/assets/f6713ba3fee3/1*SPBAPOufdTwde3F2_zOvVA.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*SPBAPOufdTwde3F2_zOvVA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTc4IiBoZWlnaHQ9Ijg4NCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ul><li><p>Choose the function you want to execute: Newly added <code class="language-plaintext highlighter-rouge">Main.gs</code> Function <code class="language-plaintext highlighter-rouge">cronjob</code></p><li><p>Choose the deployment operation to execute: Head (meaning the latest version)</p><li><p>Select Trigger Source: Time Driven</p><li><p>Select the time-based trigger type: Daily timer</p><li><p>Selected Time Slot: AM 4:00 — AM 5:00 (GMT+08:00)<br /> Usually runs right at AM 4:00.</p><li><p>Error Notification Settings: Should notifications be sent immediately when a script error occurs, or summarized once daily?</p></ul><p><strong>Settings saved, completed.</strong></p><p>You can later check the execution records in the “Tasks” tab:</p><p><a href="/assets/f6713ba3fee3/1*pqn5ljYggb1lVWgYDSq6Sw.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*pqn5ljYggb1lVWgYDSq6Sw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMzUwIiBoZWlnaHQ9IjQ5OSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><blockquote><p><strong><em>At this point, we have completed the RPA functions for automated query, data addition, and data entry in the report. 🎉🎉🎉</em></strong></p></blockquote><h4 id="building-a-web-gui-dashboard"><span class="me-2">Building a Web GUI Dashboard</span><a href="#building-a-web-gui-dashboard" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Next, there is a secondary requirement: we need to create a simple web display for daily data (similar to a command center concept) that will be shown directly on a large screen on the team’s back wall.</p><p><strong>The effect is shown in the image below:</strong></p><p><a href="/assets/f6713ba3fee3/1*8SRT_wSe2aQGzcqpRt2Qjw.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*8SRT_wSe2aQGzcqpRt2Qjw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjQzNiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><strong>Add <code class="language-plaintext highlighter-rouge">Web_DailyReport.gs</code> to read Google Sheet and convert columns and styles into HTML format:</strong></p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">WebDailyReport</span> <span class="p">{</span>
  <span class="nf">constructor</span><span class="p">(</span><span class="nx">sheetID</span><span class="p">,</span> <span class="nx">dayCount</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">separateSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">openById</span><span class="p">(</span><span class="nx">sheetID</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dayCount</span> <span class="o">=</span> <span class="nx">dayCount</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">sheetRows</span> <span class="o">=</span> <span class="p">[</span>
      <span class="dl">"</span><span class="s2">Date</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">Weekday</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">Daily Traffic</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">PC Traffic</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">Mobile Traffic</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">Registrations</span><span class="dl">"</span>
    <span class="p">];</span>
  <span class="p">}</span>

  <span class="nf">allData</span><span class="p">(</span><span class="nx">startDate</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">sheetRowsIndexs</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="kd">var</span> <span class="nx">count</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">dayCount</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">while </span><span class="p">(</span><span class="nx">count</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">preDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="p">(</span><span class="nx">startDate</span><span class="p">);</span>
      <span class="nx">preDate</span><span class="p">.</span><span class="nf">setDate</span><span class="p">(</span><span class="nx">preDate</span><span class="p">.</span><span class="nf">getDate</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dayCount</span> <span class="o">-</span> <span class="nx">count</span><span class="p">));</span>
      <span class="kd">const</span> <span class="nx">sheetName</span> <span class="o">=</span> <span class="nx">Utilities</span><span class="p">.</span><span class="nf">formatDate</span><span class="p">(</span><span class="nx">preDate</span><span class="p">,</span> <span class="dl">"</span><span class="s2">GMT+8</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">yyyy-MM</span><span class="dl">"</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">targetSheet</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">separateSheet</span><span class="p">.</span><span class="nf">getSheetByName</span><span class="p">(</span><span class="nx">sheetName</span><span class="p">);</span>
      <span class="k">if </span><span class="p">(</span><span class="nx">targetSheet</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">firstRowColumnsRange</span> <span class="o">=</span> <span class="nx">targetSheet</span><span class="p">.</span><span class="nf">getRange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">targetSheet</span><span class="p">.</span><span class="nf">getLastColumn</span><span class="p">());</span> <span class="c1">// Get first row (date) data range</span>
        <span class="kd">const</span> <span class="nx">firstRowColumns</span> <span class="o">=</span> <span class="nx">firstRowColumnsRange</span><span class="p">.</span><span class="nf">getValues</span><span class="p">()[</span><span class="mi">0</span><span class="p">];</span> <span class="c1">// Get values of the data range, 0 = first row</span>
        <span class="kd">var</span> <span class="nx">columnIndex</span> <span class="o">=</span> <span class="nx">firstRowColumns</span><span class="p">.</span><span class="nf">findIndex</span><span class="p">((</span><span class="nx">date</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">date</span> <span class="k">instanceof</span> <span class="nb">Date</span> <span class="o">&amp;&amp;</span> <span class="nx">Utilities</span><span class="p">.</span><span class="nf">formatDate</span><span class="p">(</span><span class="nx">date</span><span class="p">,</span> <span class="dl">"</span><span class="s2">GMT+8</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">yyyy/MM/dd</span><span class="dl">"</span><span class="p">)</span> <span class="o">==</span> <span class="nx">Utilities</span><span class="p">.</span><span class="nf">formatDate</span><span class="p">(</span><span class="nx">preDate</span><span class="p">,</span> <span class="dl">"</span><span class="s2">GMT+8</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">yyyy/MM/dd</span><span class="dl">"</span><span class="p">)));</span> <span class="c1">// Find column index for the date</span>
        
        <span class="k">if </span><span class="p">(</span><span class="nx">columnIndex</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">columnIndex</span> <span class="o">=</span> <span class="nf">parseInt</span><span class="p">(</span><span class="nx">columnIndex</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
          <span class="k">if </span><span class="p">(</span><span class="nx">sheetRowsIndexs</span><span class="p">[</span><span class="nx">sheetName</span><span class="p">]</span> <span class="o">==</span> <span class="kc">undefined</span> <span class="err">\</span><span class="o">|</span><span class="err">\</span><span class="o">|</span> <span class="nx">sheetRowsIndexs</span><span class="p">[</span><span class="nx">sheetName</span><span class="p">]</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">sheetRowsIndexs</span><span class="p">[</span><span class="nx">sheetName</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">sheetRows</span><span class="p">.</span><span class="nf">map</span><span class="p">((</span><span class="nx">sheetRow</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nf">getFieldRow</span><span class="p">(</span><span class="nx">targetSheet</span><span class="p">,</span> <span class="nx">sheetRow</span><span class="p">));</span>
          <span class="p">}</span>

          <span class="k">if </span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Add first column</span>
            <span class="kd">const</span> <span class="nx">ranges</span> <span class="o">=</span> <span class="nx">sheetRowsIndexs</span><span class="p">[</span><span class="nx">sheetName</span><span class="p">].</span><span class="nf">map</span><span class="p">((</span><span class="nx">rowIndex</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">rowIndex</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="nx">targetSheet</span><span class="p">.</span><span class="nf">getRange</span><span class="p">(</span><span class="nx">rowIndex</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">:</span> <span class="p">(</span><span class="kc">null</span><span class="p">));</span>
            <span class="nx">result</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">makeValues</span><span class="p">(</span><span class="nx">ranges</span><span class="p">));</span>
          <span class="p">}</span>

          <span class="kd">const</span> <span class="nx">ranges</span> <span class="o">=</span> <span class="nx">sheetRowsIndexs</span><span class="p">[</span><span class="nx">sheetName</span><span class="p">].</span><span class="nf">map</span><span class="p">((</span><span class="nx">rowIndex</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">rowIndex</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="nx">targetSheet</span><span class="p">.</span><span class="nf">getRange</span><span class="p">(</span><span class="nx">rowIndex</span><span class="p">,</span> <span class="nx">columnIndex</span><span class="p">))</span> <span class="p">:</span> <span class="p">(</span><span class="kc">null</span><span class="p">));</span>
          <span class="nx">result</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">makeValues</span><span class="p">(</span><span class="nx">ranges</span><span class="p">));</span>
        <span class="p">}</span>
      <span class="p">}</span>

      <span class="nx">count</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">transformResult</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="k">for </span><span class="p">(</span><span class="kd">const</span> <span class="nx">columnIndex</span> <span class="k">in</span> <span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for </span><span class="p">(</span><span class="kd">const</span> <span class="nx">rowIndex</span> <span class="k">in</span> <span class="nx">result</span><span class="p">[</span><span class="nx">columnIndex</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">transformResult</span><span class="p">[</span><span class="nx">rowIndex</span><span class="p">]</span> <span class="o">==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">transformResult</span><span class="p">[</span><span class="nx">rowIndex</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="p">}</span>

        <span class="k">if </span><span class="p">(</span><span class="nx">columnIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">transformResult</span><span class="p">[</span><span class="nx">rowIndex</span><span class="p">].</span><span class="nf">unshift</span><span class="p">(</span><span class="nx">result</span><span class="p">[</span><span class="nx">columnIndex</span><span class="p">][</span><span class="nx">rowIndex</span><span class="p">]);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">transformResult</span><span class="p">[</span><span class="nx">rowIndex</span><span class="p">].</span><span class="nf">splice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">result</span><span class="p">[</span><span class="nx">columnIndex</span><span class="p">][</span><span class="nx">rowIndex</span><span class="p">]);</span>
        <span class="p">}</span>
        
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">transformResult</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Convert field attribute values into display objects</span>
  <span class="nf">makeValues</span><span class="p">(</span><span class="nx">ranges</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">ranges</span><span class="p">.</span><span class="nf">map</span><span class="p">((</span><span class="nx">range</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">range</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="nx">range</span><span class="p">.</span><span class="nf">getDisplayValues</span><span class="p">())</span> <span class="p">:</span> <span class="p">(</span><span class="kc">null</span><span class="p">)).</span><span class="nf">map</span><span class="p">((</span><span class="nx">values</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">values</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="nx">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">:</span> <span class="p">(</span><span class="kc">null</span><span class="p">));</span>
    <span class="kd">const</span> <span class="nx">backgroundColors</span> <span class="o">=</span> <span class="nx">ranges</span><span class="p">.</span><span class="nf">map</span><span class="p">((</span><span class="nx">range</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">range</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="nx">range</span><span class="p">.</span><span class="nf">getBackgrounds</span><span class="p">())</span> <span class="p">:</span> <span class="p">(</span><span class="kc">null</span><span class="p">)).</span><span class="nf">map</span><span class="p">((</span><span class="nx">values</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">values</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="nx">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">:</span> <span class="p">(</span><span class="kc">null</span><span class="p">));</span>
    <span class="kd">const</span> <span class="nx">colors</span> <span class="o">=</span> <span class="nx">ranges</span><span class="p">.</span><span class="nf">map</span><span class="p">((</span><span class="nx">range</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">range</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="nx">range</span><span class="p">.</span><span class="nf">getFontColorObjects</span><span class="p">())</span> <span class="p">:</span> <span class="p">(</span><span class="kc">null</span><span class="p">)).</span><span class="nf">map</span><span class="p">((</span><span class="nx">values</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">values</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="nx">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">:</span> <span class="p">(</span><span class="kc">null</span><span class="p">));</span>
    <span class="kd">const</span> <span class="nx">sizes</span> <span class="o">=</span> <span class="nx">ranges</span><span class="p">.</span><span class="nf">map</span><span class="p">((</span><span class="nx">range</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">range</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="nx">range</span><span class="p">.</span><span class="nf">getFontSizes</span><span class="p">())</span> <span class="p">:</span> <span class="p">(</span><span class="kc">null</span><span class="p">)).</span><span class="nf">map</span><span class="p">((</span><span class="nx">values</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">values</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="nx">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">:</span> <span class="p">(</span><span class="kc">null</span><span class="p">));</span>
    <span class="kd">const</span> <span class="nx">bolds</span> <span class="o">=</span> <span class="nx">ranges</span><span class="p">.</span><span class="nf">map</span><span class="p">((</span><span class="nx">range</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">range</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="nx">range</span><span class="p">.</span><span class="nf">getFontWeights</span><span class="p">())</span> <span class="p">:</span> <span class="p">(</span><span class="kc">null</span><span class="p">)).</span><span class="nf">map</span><span class="p">((</span><span class="nx">values</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">values</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="nx">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">:</span> <span class="p">(</span><span class="kc">null</span><span class="p">));</span>
    <span class="kd">const</span> <span class="nx">horizontalAlignments</span> <span class="o">=</span> <span class="nx">ranges</span><span class="p">.</span><span class="nf">map</span><span class="p">((</span><span class="nx">range</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">range</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="nx">range</span><span class="p">.</span><span class="nf">getHorizontalAlignments</span><span class="p">())</span> <span class="p">:</span> <span class="p">(</span><span class="kc">null</span><span class="p">)).</span><span class="nf">map</span><span class="p">((</span><span class="nx">values</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">values</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="nx">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">:</span> <span class="p">(</span><span class="kc">null</span><span class="p">));</span>
    <span class="kd">const</span> <span class="nx">verticalAlignments</span> <span class="o">=</span> <span class="nx">ranges</span><span class="p">.</span><span class="nf">map</span><span class="p">((</span><span class="nx">range</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">range</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="nx">range</span><span class="p">.</span><span class="nf">getVerticalAlignments</span><span class="p">())</span> <span class="p">:</span> <span class="p">(</span><span class="kc">null</span><span class="p">)).</span><span class="nf">map</span><span class="p">((</span><span class="nx">values</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">values</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="nx">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">:</span> <span class="p">(</span><span class="kc">null</span><span class="p">));</span>

    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">const</span> <span class="nx">index</span> <span class="k">in</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">row</span> <span class="o">=</span> <span class="nx">data</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
        <span class="nx">result</span><span class="p">.</span><span class="nf">push</span><span class="p">({</span>
          <span class="dl">"</span><span class="s2">value</span><span class="dl">"</span><span class="p">:</span> <span class="nx">row</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">backgroundColor</span><span class="dl">"</span><span class="p">:</span> <span class="nx">backgroundColors</span><span class="p">[</span><span class="nx">index</span><span class="p">],</span>
          <span class="dl">"</span><span class="s2">color</span><span class="dl">"</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nf">colorStripper</span><span class="p">(</span><span class="nx">colors</span><span class="p">[</span><span class="nx">index</span><span class="p">]?.</span><span class="nf">asRgbColor</span><span class="p">()?.</span><span class="nf">asHexString</span><span class="p">()),</span>
          <span class="dl">"</span><span class="s2">size</span><span class="dl">"</span><span class="p">:</span> <span class="nx">sizes</span><span class="p">[</span><span class="nx">index</span><span class="p">],</span>
          <span class="dl">"</span><span class="s2">bold</span><span class="dl">"</span><span class="p">:</span> <span class="nx">bolds</span><span class="p">[</span><span class="nx">index</span><span class="p">],</span>
          <span class="dl">"</span><span class="s2">horizontalAlignment</span><span class="dl">"</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nf">alignConventer</span><span class="p">(</span><span class="nx">horizontalAlignments</span><span class="p">[</span><span class="nx">index</span><span class="p">]),</span>
          <span class="dl">"</span><span class="s2">verticalAlignment</span><span class="dl">"</span><span class="p">:</span> <span class="nx">verticalAlignments</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span>
        <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nf">colorStripper</span><span class="p">(</span><span class="nx">colorString</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">colorString</span> <span class="o">==</span> <span class="kc">undefined</span> <span class="err">\</span><span class="o">|</span><span class="err">\</span><span class="o">|</span> <span class="nx">colorString</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">null</span>
    <span class="p">}</span>

    <span class="k">if </span><span class="p">(</span><span class="nx">colorString</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">9</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="dl">"</span><span class="s2">#</span><span class="dl">"</span><span class="o">+</span><span class="nx">colorString</span><span class="p">.</span><span class="nf">substring</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">colorString</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nf">alignConventer</span><span class="p">(</span><span class="nx">horizontalAlignment</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">horizontalAlignment</span> <span class="o">==</span> <span class="kc">undefined</span> <span class="err">\</span><span class="o">|</span><span class="err">\</span><span class="o">|</span> <span class="nx">horizontalAlignment</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">null</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">horizontalAlignment</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="dl">'</span><span class="s1">general-</span><span class="dl">'</span><span class="p">,</span> <span class="dl">''</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="nf">getFieldRow</span><span class="p">(</span><span class="nx">sheet</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">firstColumnRowsRange</span> <span class="o">=</span> <span class="nx">sheet</span><span class="p">.</span><span class="nf">getRange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">sheet</span><span class="p">.</span><span class="nf">getLastRow</span><span class="p">(),</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// Get first column (field) data range</span>
    <span class="kd">const</span> <span class="nx">firstColumnRows</span> <span class="o">=</span> <span class="nx">firstColumnRowsRange</span><span class="p">.</span><span class="nf">getValues</span><span class="p">();</span> <span class="c1">// Get values of the data range</span>
    <span class="kd">const</span> <span class="nx">foundIndex</span> <span class="o">=</span> <span class="nx">firstColumnRows</span><span class="p">.</span><span class="nf">findIndex</span><span class="p">((</span><span class="nx">firstColumnRow</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">firstColumnRow</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nx">name</span><span class="p">);</span>

    <span class="k">if </span><span class="p">(</span><span class="nx">foundIndex</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">foundIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Main.gs</code> <strong>Add Web Request Handler:</strong></p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">targetGoogleSheetID</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE</span><span class="dl">"</span><span class="p">;</span>
<span class="c1">// https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit#gid=275710641</span>

<span class="kd">const</span> <span class="nx">gaPropertyId</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">318495208</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">function</span> <span class="nf">debug</span><span class="p">()</span> <span class="p">{</span>
  <span class="nf">cronjob</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nf">cronjob</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">yesterday</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="p">();</span>
  <span class="nx">yesterday</span><span class="p">.</span><span class="nf">setDate</span><span class="p">(</span><span class="nx">yesterday</span><span class="p">.</span><span class="nf">getDate</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">gaData</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GAData</span><span class="p">(</span><span class="nx">yesterday</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">inHouseReportData</span> <span class="o">=</span> <span class="nf">fetchInHouseReportData</span><span class="p">(</span><span class="nx">yesterday</span><span class="p">);</span>
  
  <span class="kd">const</span> <span class="nx">report</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DailyReport</span><span class="p">(</span><span class="nx">targetGoogleSheetID</span><span class="p">,</span> <span class="nx">yesterday</span><span class="p">,</span> <span class="nx">gaData</span><span class="p">,</span> <span class="nx">inHouseReportData</span><span class="p">);</span>
  <span class="nx">report</span><span class="p">.</span><span class="nf">execute</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nf">doGet</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">HtmlService</span><span class="p">.</span><span class="nf">createTemplateFromFile</span><span class="p">(</span><span class="dl">'</span><span class="s1">Web_DailyReport_ Scaffolding</span><span class="dl">'</span><span class="p">).</span><span class="nf">evaluate</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nf">getDailyReportBody</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">html</span> <span class="o">=</span> <span class="nx">HtmlService</span><span class="p">.</span><span class="nf">createTemplateFromFile</span><span class="p">(</span><span class="dl">'</span><span class="s1">Web_DailyReport_Body</span><span class="dl">'</span><span class="p">).</span><span class="nf">evaluate</span><span class="p">().</span><span class="nf">getContent</span><span class="p">();</span>
  <span class="k">return</span> <span class="nx">html</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// FOR POST</span>
<span class="c1">// function doPost(e) {</span>
<span class="c1">//  ref: https://developers.google.com/apps-script/guides/web?hl=zh-tw</span>
<span class="c1">// }</span>


<span class="c1">// Simulate some data that might be obtained from other platform APIs.</span>
<span class="kd">function</span> <span class="nf">fetchInHouseReportData</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// EXAMPLE REQUEST:</span>
  <span class="c1">// var options = {</span>
  <span class="c1">//   'method' : 'get',</span>
  <span class="c1">//   'headers': {</span>
  <span class="c1">//       'Authorization':  'Bearer XXX'</span>
  <span class="c1">//   }</span>
  <span class="c1">// };</span>
  <span class="c1">// OR</span>
  <span class="c1">// var options = {</span>
  <span class="c1">//   'method' : 'post',</span>
  <span class="c1">//   'headers': {</span>
  <span class="c1">//       'Authorization':  'Bearer XXX'</span>
  <span class="c1">//   },</span>
  <span class="c1">//   'payload' : data</span>
  <span class="c1">// };</span>

  <span class="c1">// var res = UrlFetchApp.fetch(url, options);</span>
  <span class="c1">// const result = JSON.parse(res.getContentText());</span>

  <span class="c1">// REMEMBER, DUE TO SECURITY REASONS, we can't customize user-agent.</span>
  
  <span class="k">return</span> <span class="p">{</span><span class="dl">"</span><span class="s2">registers</span><span class="dl">"</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="mi">180</span> <span class="o">-</span> <span class="mi">30</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mi">30</span><span class="p">}</span> <span class="c1">// MOCK DATA random 30~180</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>Added <code class="language-plaintext highlighter-rouge">Web_DailyReport_ Scaffolding.html</code> Web Dashboard framework. Since our command center screens need to update content automatically, we created a web scaffold that periodically fetches HTML content using Ajax:</strong></p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;base</span> <span class="na">target=</span><span class="s">"_top"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;script&gt;</span>
      function onSuccess(html) {
        if (html != null) {
          var div = document.getElementById('result');
          div.innerHTML = html;
        }
     }
     setInterval(()=&gt;{
       google.script.run.withSuccessHandler(onSuccess).getDailyReportBody()
     }, 1000 * 60 * 60 * 1);
     google.script.run.withSuccessHandler(onSuccess).getDailyReportBody();
    <span class="nt">&lt;/script&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"result"</span><span class="nt">&gt;</span>Loading...<span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p><strong>Added</strong> <code class="language-plaintext highlighter-rouge">Web_DailyReport_Body.html</code> where data is actually rendered into HTML:</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;base</span> <span class="na">target=</span><span class="s">"_top"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;style&gt;</span>
    table {
        border-collapse: collapse;
        width: 100%;
        text-align: center;
    }
    th, td {
        border: 1px solid #000000;
        padding: 8px;
        text-align: center;
        font-size: 36px;
    }
      <span class="nt">&lt;/style&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
      <span class="nt">&lt;h1</span> <span class="na">style=</span><span class="s">"text-align:center"</span><span class="nt">&gt;</span>ZHGCHG.LI<span class="nt">&lt;/h1&gt;</span>
      <span class="nt">&lt;table</span> <span class="na">id=</span><span class="s">"dataTable"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;tbody&gt;</span>
          <span class="err">&lt;</span>?
          // Display data for the past 7 days
          const dashboard = new WebDailyReport(targetGoogleSheetID, 7);
          // Start from yesterday
          const yesterday = new Date();
          yesterday.setDate(yesterday.getDate() - 1);
          const data = dashboard.allData(yesterday);
          for(const rowIndex in data) {
            const row = data[rowIndex];
            ?&gt;
            <span class="nt">&lt;tr&gt;</span>
              <span class="err">&lt;</span>?
              for(const columnIndex in row) {
                const column = row[columnIndex];
                ?&gt;
                <span class="nt">&lt;td</span> <span class="na">style=</span><span class="s">"background-color: &lt;?=column["</span><span class="err">backgroundColor"]?</span><span class="nt">&gt;</span>; color: <span class="cp">&lt;?=column["color"]?&gt;</span>; text-align: <span class="cp">&lt;?=column["horizontalAlignment"]?&gt;</span>;"&gt;
                  <span class="cp">&lt;?=column["value"]?&gt;</span>
                <span class="nt">&lt;/td&gt;</span>
                <span class="err">&lt;</span>?
              }
              ?&gt;
            <span class="nt">&lt;/tr&gt;</span>
            <span class="err">&lt;</span>?
          }
          ?&gt;
        <span class="nt">&lt;/tbody&gt;</span>
      <span class="nt">&lt;/table&gt;</span>
      <span class="nt">&lt;script&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><blockquote><p><strong><em>Please note, we retrieve data from the past 7 days starting from yesterday, so today’s data will not be shown.</em></strong></p></blockquote><p>The project file directory after completing the above steps is as follows:</p><p><a href="/assets/f6713ba3fee3/1*G1ig9iHOyRckIf7gOMYd7Q.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*G1ig9iHOyRckIf7gOMYd7Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMjYiIGhlaWdodD0iNDM1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><strong>Test Deployment:</strong></p><p>Click the project’s top right corner “Deploy” -&gt; “Test Deployment Operation”</p><p><a href="/assets/f6713ba3fee3/1*0qsoN6CIATn9dU588pOrBw.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*0qsoN6CIATn9dU588pOrBw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAiIGhlaWdodD0iMjIxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/f6713ba3fee3/1*io3ugHFQfsEyCxIs0WTZ_w.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*io3ugHFQfsEyCxIs0WTZ_w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NTEiIGhlaWdodD0iNTkyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/f6713ba3fee3/1*gIQHWeCPuuxHGZUyvBomNA.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*gIQHWeCPuuxHGZUyvBomNA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjQ0NSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ul><li><p>After deployment, click the link to view the test results.</p><li><p><strong>Please note this URL is for one-time testing only. If the code is modified, you need to click the test deployment again.</strong></p></ul><p>If stuck on Loading… with no content or a server error appears, you can go back to the editor’s “Run Items” tab to check the error messages:</p><p><a href="/assets/f6713ba3fee3/1*XPmKwym8wmI3D2-cb2gs6w.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*XPmKwym8wmI3D2-cb2gs6w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjUzMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><strong>Complete Formal Deployment:</strong></p><p>If the testing is successful, the official deployment can be completed and the URL released.</p><p>Click the project’s top right corner “Deploy” -&gt; “New deployment” -&gt; top left “Select type” -&gt; “Web app”:</p><p><a href="/assets/f6713ba3fee3/1*SghEZm_MdxKO_lD8siKLJg.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*SghEZm_MdxKO_lD8siKLJg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNzgiIGhlaWdodD0iMjA2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/f6713ba3fee3/1*pP1fRjkpKNBjZJ9Hnvy4XQ.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*pP1fRjkpKNBjZJ9Hnvy4XQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NTAiIGhlaWdodD0iNTg1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/f6713ba3fee3/1*r0Tw8C30kGUn-YXfOssBtA.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*r0Tw8C30kGUn-YXfOssBtA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NjAiIGhlaWdodD0iNTk1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li><p>Execution identity: Default to the current account (same as the Google Apps Script user)</p><li><p>Who can access: Set to “Anyone with the link” so anyone who knows the URL can access, or set to “Organization only,” which requires Google sign-in to access.</p><li><p>Deployment completed, URL obtained.</p></ul><p><strong>Code changes require redeployment to take effect:</strong></p><p>Please note that when the code changes, redeployment is required (the URL will not change) for the changes to take effect; otherwise, the old version will persist.</p><p>Click the project’s top right corner “Deploy” -&gt; “Manage Deployments”:</p><p><a href="/assets/f6713ba3fee3/1*3y5A1ogNe9cpG_ObZt1_FA.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*3y5A1ogNe9cpG_ObZt1_FA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNzUiIGhlaWdodD0iMjExIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/f6713ba3fee3/1*qqQm-XAKgiGyYClX_Z0CaA.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*qqQm-XAKgiGyYClX_Z0CaA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NTkiIGhlaWdodD0iNTg4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/f6713ba3fee3/1*Ea_7NeyuRAfcHCGBvKAYhw.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*Ea_7NeyuRAfcHCGBvKAYhw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NTQiIGhlaWdodD0iNTg2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Click the top right “Pen 🖊️ ICON” -&gt; “Versions” -&gt; “Create New Version” -&gt; “Deploy”.</p><p>After deployment, click the URL or refresh the original URL to see the updated changes.</p><h4 id="done-all-our-rpa-requirements-have-been-completed"><span class="me-2">🎉🎉Done! All our RPA requirements have been completed.🎉🎉</span><a href="#done-all-our-rpa-requirements-have-been-completed" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Final Result:</p><p><a href="/assets/f6713ba3fee3/1*8SRT_wSe2aQGzcqpRt2Qjw.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*8SRT_wSe2aQGzcqpRt2Qjw.webp" alt="(Modify the program to backfill this month's data; otherwise, only yesterday's record will appear in the new data)" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjQzNiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>(Update the program to backfill this month’s data; otherwise, with fresh data, there will be only one record from yesterday)</p><blockquote><p><a href="https://script.google.com/macros/s/AKfycbz2Vk-ikU8DSXjpnLq9r6HNAn3zlNAosvDoItG0cxy0bmItRDSVyEzTdwsL2HyFUz99/exec" target="_blank">https://script.google.com/macros/s/AKfycbz2Vk-ikU8DSXjpnLq9r6HNAn3zlNAosvDoItG0cxy0bmItRDSVyEzTdwsL2HyFUz99/exec</a></p></blockquote><h3 id="complete-google-sheet-demo"><span class="me-2">Complete Google Sheet Demo:</span><a href="#complete-google-sheet-demo" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p>Google Sheet:<br /> <a href="https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit?usp=sharing" target="_blank">https://docs.google.com/spreadsheets/d/1-9lZCpsu3E7eDmO-lMkXJXQ6Y6KK4SiyU6uBODcDcFE/edit?usp=sharing</a></p><li><p>Web GUI URL:<br /> <a href="https://script.google.com/macros/s/AKfycbz2Vk-ikU8DSXjpnLq9r6HNAn3zlNAosvDoItG0cxy0bmItRDSVyEzTdwsL2HyFUz99/exec" target="_blank">https://script.google.com/macros/s/AKfycbz2Vk-ikU8DSXjpnLq9r6HNAn3zlNAosvDoItG0cxy0bmItRDSVyEzTdwsL2HyFUz99/exec</a></p><li><p><strong>Google Apps Script:</strong><br /> <a href="https://script.google.com/home/projects/1vHgXPTV_q8MC75FVzAEtzD2JPVnPBpMfFXbjZR7SLMVjoEH1FcjKlo8l/edit" target="_blank">https://script.google.com/home/projects/1vHgXPTV_q8MC75FVzAEtzD2JPVnPBpMfFXbjZR7SLMVjoEH1FcjKlo8l/edit</a></p></ul><h3 id="other-daily-life-applications"><span class="me-2">Other Daily Life Applications:</span><a href="#other-daily-life-applications" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="robotic-process-automation-with-google-apps-script--github-repo-star-notifier-to-line"><span class="me-2">Robotic Process Automation with Google Apps Script — Github Repo Star Notifier to Line</span><a href="#robotic-process-automation-with-google-apps-script--github-repo-star-notifier-to-line" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="https://medium.com/zrealm-ios-dev/%E4%BD%BF%E7%94%A8-google-apps-script-%E4%B8%89%E6%AD%A5%E9%A9%9F%E5%85%8D%E8%B2%BB%E5%BB%BA%E7%AB%8B-github-repo-star-notifier-382218e15697" target="_blank" class="img-link shimmer" ><img src="https://miro.medium.com/v2/resize:fit:1200/1*fUtW942huwnSbPF-ar4OCQ.png" alt="" loading="lazy"></a></p><h4 id="robotic-process-automation-with-google-apps-script--notion-database-to-calendar"><span class="me-2">Robotic Process Automation with Google Apps Script — Notion Database to Calendar</span><a href="#robotic-process-automation-with-google-apps-script--notion-database-to-calendar" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Previously implemented a simple Notion to Calendar feature.</p><blockquote><p><em>The implementation connects to the Notion API to fetch database data and generate an ICS format webpage, then deploys it as a public webpage; just add this URL to Apple Calendar.</em></p></blockquote><p><code class="language-plaintext highlighter-rouge">Main.gs</code> :</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
</pre><td class="rouge-code"><pre><span class="c1">// Constant variables</span>
<span class="kd">const</span> <span class="nx">notionToken</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">XXXXX</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">safeToken</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">XXXXX</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">function</span> <span class="nf">doGet</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">ics</span> <span class="o">=</span> <span class="nx">HtmlService</span><span class="p">.</span><span class="nf">createTemplateFromFile</span><span class="p">(</span><span class="dl">'</span><span class="s1">ics</span><span class="dl">'</span><span class="p">);</span>

  <span class="k">if </span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">parameter</span><span class="p">.</span><span class="nx">token</span> <span class="o">!=</span> <span class="nx">safeToken</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">ContentService</span><span class="p">.</span><span class="nf">createTextOutput</span><span class="p">(</span><span class="dl">"</span><span class="s2">Access Denied!</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">ics</span><span class="p">.</span><span class="nx">events</span> <span class="o">=</span> <span class="nf">getQuickNote</span><span class="p">();</span>
  
  <span class="k">return</span> <span class="nx">ContentService</span><span class="p">.</span><span class="nf">createTextOutput</span><span class="p">(</span><span class="nx">ics</span><span class="p">.</span><span class="nf">evaluate</span><span class="p">().</span><span class="nf">getContent</span><span class="p">()).</span><span class="nf">setMimeType</span><span class="p">(</span><span class="nx">ContentService</span><span class="p">.</span><span class="nx">MimeType</span><span class="p">.</span><span class="nx">ICAL</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nf">debug</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">ics</span> <span class="o">=</span> <span class="nx">HtmlService</span><span class="p">.</span><span class="nf">createTemplateFromFile</span><span class="p">(</span><span class="dl">'</span><span class="s1">ics</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">ics</span><span class="p">.</span><span class="nx">events</span> <span class="o">=</span> <span class="nf">getQuickNote</span><span class="p">();</span>
  <span class="nx">Logger</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">ics</span><span class="p">.</span><span class="nf">evaluate</span><span class="p">().</span><span class="nf">getContent</span><span class="p">());</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nf">getQuickNote</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// YOUR FILTER Condition:</span>
  <span class="kd">const</span> <span class="nx">payload</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">filter</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">and</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="dl">"</span><span class="s2">property</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Date</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">date</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">"</span><span class="s2">is_not_empty</span><span class="dl">"</span><span class="p">:</span> <span class="kc">true</span>
          <span class="p">}</span>
        <span class="p">}</span>
        <span class="p">,</span>
        <span class="p">{</span>
          <span class="dl">"</span><span class="s2">property</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Name</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">title</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">"</span><span class="s2">is_not_empty</span><span class="dl">"</span><span class="p">:</span> <span class="kc">true</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">};</span>
  <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nf">getDatabase</span><span class="p">(</span><span class="nx">YOUR_DATABASE_ID</span><span class="p">,</span> <span class="nx">payload</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">events</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">for </span><span class="p">(</span><span class="kd">const</span> <span class="nx">index</span> <span class="k">in</span> <span class="nx">result</span><span class="p">.</span><span class="nx">results</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">results</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span>
    <span class="kd">const</span> <span class="nx">properties</span> <span class="o">=</span> <span class="nx">item</span><span class="p">.</span><span class="nx">properties</span><span class="p">;</span>

    <span class="kd">const</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">item</span><span class="p">[</span><span class="dl">'</span><span class="s1">id</span><span class="dl">'</span><span class="p">];</span>
    <span class="kd">const</span> <span class="nx">create</span> <span class="o">=</span> <span class="nf">toICSDate</span><span class="p">(</span><span class="nx">item</span><span class="p">[</span><span class="dl">"</span><span class="s2">created_time</span><span class="dl">"</span><span class="p">]);</span>
    <span class="kd">const</span> <span class="nx">edit</span> <span class="o">=</span> <span class="nf">toICSDate</span><span class="p">(</span><span class="nx">item</span><span class="p">[</span><span class="dl">"</span><span class="s2">last_edited_time</span><span class="dl">"</span><span class="p">]);</span>
    <span class="kd">const</span> <span class="nx">startDate</span> <span class="o">=</span> <span class="nx">properties</span><span class="p">[</span><span class="dl">'</span><span class="s1">Date</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">date</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">start</span><span class="dl">'</span><span class="p">];</span>
    <span class="kd">const</span> <span class="nx">start</span> <span class="o">=</span> <span class="nf">toICSDate</span><span class="p">(</span><span class="nx">startDate</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">endDate</span> <span class="o">=</span> <span class="nx">properties</span><span class="p">[</span><span class="dl">'</span><span class="s1">Date</span><span class="dl">'</span><span class="p">]?.[</span><span class="dl">'</span><span class="s1">date</span><span class="dl">'</span><span class="p">]?.[</span><span class="dl">'</span><span class="s1">end</span><span class="dl">'</span><span class="p">];</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">endDate</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">endDate</span> <span class="o">=</span> <span class="nx">startDate</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">const</span> <span class="nx">end</span> <span class="o">=</span> <span class="nf">toICSDate</span><span class="p">(</span><span class="nx">endDate</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">type</span> <span class="o">=</span> <span class="nx">properties</span><span class="p">[</span><span class="dl">'</span><span class="s1">Type</span><span class="dl">'</span><span class="p">]?.[</span><span class="dl">'</span><span class="s1">multi_select</span><span class="dl">'</span><span class="p">]?.[</span><span class="mi">0</span><span class="p">]?.[</span><span class="dl">'</span><span class="s1">name</span><span class="dl">'</span><span class="p">];</span>

    <span class="kd">const</span> <span class="nx">title</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">[</span><span class="dl">"</span><span class="o">+</span><span class="nx">type</span><span class="o">+</span><span class="dl">"</span><span class="s2">] </span><span class="dl">"</span><span class="o">+</span><span class="nx">properties</span><span class="p">?.[</span><span class="dl">'</span><span class="s1">Name</span><span class="dl">'</span><span class="p">]?.[</span><span class="dl">'</span><span class="s1">title</span><span class="dl">'</span><span class="p">]?.[</span><span class="mi">0</span><span class="p">]?.[</span><span class="dl">'</span><span class="s1">plain_text</span><span class="dl">'</span><span class="p">];</span>
    <span class="kd">const</span> <span class="nx">description</span> <span class="o">=</span> <span class="nx">item</span><span class="p">[</span><span class="dl">'</span><span class="s1">url</span><span class="dl">'</span><span class="p">];</span>
    
    <span class="nx">events</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span>
      <span class="p">{</span>
        <span class="dl">"</span><span class="s2">id</span><span class="dl">"</span><span class="p">:</span><span class="nx">id</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">create</span><span class="dl">"</span><span class="p">:</span><span class="nx">create</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">edit</span><span class="dl">"</span><span class="p">:</span><span class="nx">edit</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">start</span><span class="dl">"</span><span class="p">:</span><span class="nx">start</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">end</span><span class="dl">"</span><span class="p">:</span><span class="nx">end</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">title</span><span class="dl">"</span><span class="p">:</span><span class="nx">title</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">description</span><span class="dl">"</span><span class="p">:</span><span class="nx">description</span>
      <span class="p">}</span>
    <span class="p">)</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">events</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// TO UTC Date</span>
<span class="kd">function</span> <span class="nf">toICSDate</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">icsDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="p">(</span><span class="nx">date</span><span class="p">);</span>
  <span class="nx">icsDate</span><span class="p">.</span><span class="nf">setHours</span><span class="p">(</span><span class="nx">icsDate</span><span class="p">.</span><span class="nf">getHours</span><span class="p">()</span> <span class="o">-</span> <span class="mi">8</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">Utilities</span><span class="p">.</span><span class="nf">formatDate</span><span class="p">(</span><span class="nx">icsDate</span><span class="p">,</span> <span class="dl">"</span><span class="s2">GMT+8</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">yyyyMMdd'T'HHmmss'Z'</span><span class="dl">"</span><span class="p">);</span><span class="c1">// 20240304T132300Z</span>
<span class="p">}</span>

<span class="c1">// Notion</span>
<span class="kd">function</span> <span class="nf">getDatabase</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">payload</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.notion.com/v1/databases/</span><span class="dl">'</span><span class="o">+</span><span class="nx">id</span><span class="o">+</span><span class="dl">'</span><span class="s1">/query/</span><span class="dl">'</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">method</span><span class="p">:</span> <span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
      <span class="dl">'</span><span class="s1">Authorization</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Bearer </span><span class="dl">'</span><span class="o">+</span><span class="nx">notionToken</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">Notion-Version</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">2022-06-28</span><span class="dl">'</span>
    <span class="p">},</span>
    <span class="na">payload</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">stringify</span><span class="p">(</span><span class="nx">payload</span><span class="p">)</span>
  <span class="p">};</span> 
  <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nf">getContentText</span><span class="p">());</span>
<span class="p">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">ics.html</code> :</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre>BEGIN:VCALENDAR
PRODID:-//Google Inc//Google Calendar 70.9054//EN
VERSION:2.0
CALSCALE:GREGORIAN
METHOD:PUBLISH
X-WR-CALNAME:NotionCalendar
X-WR-TIMEZONE:Asia/Taipei
BEGIN:VTIMEZONE
TZID:Asia/Taipei
X-LIC-LOCATION:Asia/Taipei
BEGIN:STANDARD
TZOFFSETFROM:+0800
TZOFFSETTO:+0800
TZNAME:CST
DTSTART:19700101T000000
END:STANDARD
END:VTIMEZONE
&lt;?
  for(const eventIndex in events) {
    const event = events[eventIndex];
    ?&gt;
BEGIN:VEVENT
DTSTART:&lt;?=event["start"]?&gt;

DTEND:&lt;?=event["end"]?&gt;

DTSTAMP:&lt;?=event["edit"]?&gt;

UID:&lt;?=event["id"]?&gt;

CREATED:&lt;?=event["create"]?&gt;

LAST-MODIFIED:&lt;?=event["edit"]?&gt;

SEQUENCE:0
STATUS:CONFIRMED
SUMMARY:&lt;?=event["title"]?&gt;

DESCRIPTION:&lt;?=event["description"]?&gt;

TRANSP:OPAQUE
END:VEVENT
&lt;?
  }
?&gt;
END:VCALENDAR
</pre></table></code></div></div><p>As before, deploy as a web service by clicking “Deploy” at the top right of the project -&gt; “New Deployment” -&gt; top left “Select Type” -&gt; “Web App”:</p><p><a href="/assets/f6713ba3fee3/1*SghEZm_MdxKO_lD8siKLJg.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*SghEZm_MdxKO_lD8siKLJg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNzgiIGhlaWdodD0iMjA2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/f6713ba3fee3/1*pP1fRjkpKNBjZJ9Hnvy4XQ.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*pP1fRjkpKNBjZJ9Hnvy4XQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NTAiIGhlaWdodD0iNTg1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/f6713ba3fee3/1*r0Tw8C30kGUn-YXfOssBtA.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*r0Tw8C30kGUn-YXfOssBtA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NjAiIGhlaWdodD0iNTk1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>Who can access should be set to Everyone, because Google login verification cannot be completed when adding the Calendar.</ul><p><a href="/assets/f6713ba3fee3/1*2HFKnh4QeQ4iTlEJRSNbYw.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*2HFKnh4QeQ4iTlEJRSNbYw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNTYiIGhlaWdodD0iMjcyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/f6713ba3fee3/1*dVpsg748XbWwfomuT1VcWQ.webp" class="popup img-link blur"><img data-src="/assets/f6713ba3fee3/1*dVpsg748XbWwfomuT1VcWQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjcxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><strong>Add the URL to your calendar subscription, done</strong> 🎉🎉🎉🎉 <strong>!</strong></p><h3 id="business-time"><span class="me-2">Business Time</span><a href="#business-time" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If you and your team need automation tools or process integration, whether it’s Slack App development, Notion, Asana, Google Sheets, Google Forms, GA data, or any other integration, feel free to <a href="https://zhgchg.li/contact/" target="_blank"><strong>contact me for development</strong></a>.</p><p>If you have any questions or feedback, feel free to <a href="https://www.zhgchg.li/contact" target="_blank">contact me</a>.</p><hr /><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=🍺&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a><br /></p><blockquote class="prompt-info"><p>This post was originally published on Medium (<a href="https://medium.com/p/f6713ba3fee3" target="_blank"><strong>View original post</strong></a>), and automatically converted and synced by <a href="/posts/tools/medium-to-jekyll/" target="_blank">ZMediumToMarkdown</a>.</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/en/zmediumtomarkdown/2024-04-14-f6713ba3fee3.md" target="_blank">Improve this page on Github.</a></p></blockquote><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1K+ Followers</span></a></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-robotic-process-automation/">ZRealm Robotic Process Automation</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/english/" class="post-tag no-text-decoration" >english</a> <a href="/tags/ai-translation/" class="post-tag no-text-decoration" >ai-translation</a> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/robotic-process-automation/" class="post-tag no-text-decoration" >robotic-process-automation</a> <a href="/tags/rpa-solutions/" class="post-tag no-text-decoration" >rpa-solutions</a> <a href="/tags/google-apps-script/" class="post-tag no-text-decoration" >google-apps-script</a> <a href="/tags/google-sheets/" class="post-tag no-text-decoration" >google-sheets</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Google%20Apps%20Script%EF%BD%9CAutomate%20Daily%20Data%20Reports%20with%20RPA%20for%20Google%20Workspace%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-robotic-process-automation%2Fen%2Fgoogle-apps-script-automate-daily-data-reports-with-rpa-for-google-workspace-f6713ba3fee3%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Google%20Apps%20Script%EF%BD%9CAutomate%20Daily%20Data%20Reports%20with%20RPA%20for%20Google%20Workspace%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-robotic-process-automation%2Fen%2Fgoogle-apps-script-automate-daily-data-reports-with-rpa-for-google-workspace-f6713ba3fee3%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-robotic-process-automation%2Fen%2Fgoogle-apps-script-automate-daily-data-reports-with-rpa-for-google-workspace-f6713ba3fee3%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/en/apple-watch-stainless-steel-milanese-loop-unboxing-premium-44mm-graphite-band-review-c0f99f987d9c/">Apple Watch Stainless Steel Milanese Loop Unboxing｜Premium 44mm Graphite Band Review</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/zh-cn/apple-watch-%E7%B1%B3%E5%85%B0%E8%A1%A8%E5%B8%A6%E5%BC%80%E7%AE%B1-%E5%8E%9F%E5%8E%82%E4%B8%8D%E9%94%88%E9%92%A2%E7%9F%B3%E5%A2%A8%E8%89%B2%E4%BC%98%E7%BC%BA%E7%82%B9%E5%85%A8%E8%A7%A3%E6%9E%90-c0f99f987d9c/">Apple Watch 原厂不锈钢米兰表带开箱</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/apple-watch-%E7%B1%B3%E8%98%AD%E9%8C%B6%E5%B8%B6%E9%96%8B%E7%AE%B1-%E5%8E%9F%E5%BB%A0%E4%B8%8D%E9%8F%BD%E9%8B%BC%E7%9F%B3%E5%A2%A8%E8%89%B2%E5%84%AA%E7%BC%BA%E9%BB%9E%E5%85%A8%E8%A7%A3%E6%9E%90-c0f99f987d9c/">Apple Watch 原廠不鏽鋼米蘭錶帶開箱</a><li class="text-truncate lh-lg"> <a href="/posts/travel-journals/en/busan-travel-guide-8-day-itinerary-with-visit-busan-pass-for-seamless-exploration-8ace34a1a3d8/">Busan Travel Guide｜8-Day Itinerary with VISIT BUSAN PASS for Seamless Exploration</a><li class="text-truncate lh-lg"> <a href="/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/zh-cn/%E9%87%9C%E5%B1%B1%E8%87%AA%E7%94%B1%E8%A1%8C%E6%94%BB%E7%95%A5-8%E5%A4%A97%E5%A4%9C%E5%BF%85%E5%8E%BB%E6%99%AF%E7%82%B9-%E7%BE%8E%E9%A3%9F%E4%B8%8E%E4%BA%A4%E9%80%9A%E5%85%A8%E8%A7%A3%E6%9E%90-%E9%87%9C%E5%B1%B1%E9%80%9A%E8%A1%8C%E8%AF%81%E7%9C%81%E9%92%B1%E7%A7%98%E8%AF%80-8ace34a1a3d8/">游记 2025 韩国釜山 8 天 7 夜自由行</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">章節 (Chapters)🔖</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-dev/en/crashlytics-google-analytics-automate-crash-free-user-rate-queries-with-google-apps-script-793cb8f89b72/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1637506030" data-df="ll" > Nov 21, 2021 </time><h4 class="pt-0 my-2">Crashlytics & Google Analytics｜Automate Crash-Free User Rate Queries with Google Apps Script</h4><div class="text-muted"><p>Discover how to automate fetching Crashlytics crash-free user rates using Google Analytics and Google Apps Script, seamlessly populating your Google Sheets for real-time app performance insights.</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/en/ci-cd-guide-integrate-google-apps-script-web-app-with-github-actions-for-free-packaging-platform-4273e57e7148/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1752150651" data-df="ll" > Jul 10, 2025 </time><h4 class="pt-0 my-2">CI/CD Guide｜Integrate Google Apps Script Web App with GitHub Actions for Free Packaging Platform</h4><div class="text-muted"><p>Developers facing complex CI/CD workflows can leverage Google Apps Script Web App integrated with GitHub Actions to build a free, user-friendly packaging tool platform that streamlines team collabo...</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/en/google-apps-script-web-app-integrate-forms-with-github-actions-ci-cd-for-streamlined-workflows-4cb4437818f2/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1736594383" data-df="ll" > Jan 11, 2025 </time><h4 class="pt-0 my-2">Google Apps Script Web App｜Integrate Forms with GitHub Actions CI/CD for Streamlined Workflows</h4><div class="text-muted"><p>Developers facing workflow inefficiencies can automate GitHub Actions CI/CD triggers using Google Apps Script Web App forms, seamlessly integrating tools like Jira, Asana, and Slack to boost produc...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-dev/slack-app-%E6%95%B4%E5%90%88-chatgpt-%E5%88%A9%E7%94%A8-openai-api-%E8%88%87-google-cloud-functions-%E8%87%AA%E5%BB%BA%E6%99%BA%E8%83%BD%E5%8A%A9%E7%90%86-bd94cc88f9c9/" class="btn btn-outline-primary" aria-label="Older" ><p>Slack App 整合 ChatGPT｜利用 OpenAI API 與 Google Cloud Functions 自建智能助理</p></a> <a href="/posts/zrealm-robotic-process-automation/zh-cn/google-apps-script-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E6%95%B0%E6%8D%AE%E6%8A%A5%E8%A1%A8%E8%87%AA%E5%8A%A8%E5%8C%96-rpa-%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5-google-analytics-%E4%B8%8E-google-sheet-f6713ba3fee3/" class="btn btn-outline-primary" aria-label="Newer" ><p>使用 Google Apps Script 实现每日数据报表 RPA 自动化</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span> <a href="/">中文</a>|<a href="/tags/simplified-chinese">简中</a>|<a href="/tags/english/">English</a></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a> <br/></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
