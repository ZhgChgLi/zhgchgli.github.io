<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="GA4 自动数据通知机器人｜3 步骤用 Google Apps Script 串接 Telegram Bot" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="针对希望即时掌握网站数据的使用者，教你用 3 步骤打造免费 GA4 自动通知机器人，结合 Google Apps Script 与 Telegram Bot，定时推送近 7 天流量与热门页面，减少人工查询时间，提升数据监控效率。" /><meta property="og:description" content="针对希望即时掌握网站数据的使用者，教你用 3 步骤打造免费 GA4 自动通知机器人，结合 Google Apps Script 与 Telegram Bot，定时推送近 7 天流量与热门页面，减少人工查询时间，提升数据监控效率。" /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-robotic-process-automation/zh-cn/ga4-%E8%87%AA%E5%8A%A8%E6%95%B0%E6%8D%AE%E9%80%9A%E7%9F%A5%E6%9C%BA%E5%99%A8%E4%BA%BA-3-%E6%AD%A5%E9%AA%A4%E7%94%A8-google-apps-script-%E4%B8%B2%E6%8E%A5-telegram-bot-1e85b8df2348/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-robotic-process-automation/zh-cn/ga4-%E8%87%AA%E5%8A%A8%E6%95%B0%E6%8D%AE%E9%80%9A%E7%9F%A5%E6%9C%BA%E5%99%A8%E4%BA%BA-3-%E6%AD%A5%E9%AA%A4%E7%94%A8-google-apps-script-%E4%B8%B2%E6%8E%A5-telegram-bot-1e85b8df2348/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/1e85b8df2348/1*La0AKKSrGNP9EZUV-vrONQ.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-10-20T16:19:52+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/1e85b8df2348/1*La0AKKSrGNP9EZUV-vrONQ.webp" /><meta property="twitter:title" content="GA4 自动数据通知机器人｜3 步骤用 Google Apps Script 串接 Telegram Bot" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://medium.com/@zhgchgli/"},"dateModified":"2024-10-20T16:19:52+08:00","datePublished":"2024-10-20T16:19:52+08:00","description":"针对希望即时掌握网站数据的使用者，教你用 3 步骤打造免费 GA4 自动通知机器人，结合 Google Apps Script 与 Telegram Bot，定时推送近 7 天流量与热门页面，减少人工查询时间，提升数据监控效率。","headline":"GA4 自动数据通知机器人｜3 步骤用 Google Apps Script 串接 Telegram Bot","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+","url":"https://zhgchg.li/assets/1e85b8df2348/1*La0AKKSrGNP9EZUV-vrONQ.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-robotic-process-automation/zh-cn/ga4-%E8%87%AA%E5%8A%A8%E6%95%B0%E6%8D%AE%E9%80%9A%E7%9F%A5%E6%9C%BA%E5%99%A8%E4%BA%BA-3-%E6%AD%A5%E9%AA%A4%E7%94%A8-google-apps-script-%E4%B8%B2%E6%8E%A5-telegram-bot-1e85b8df2348/"},"url":"https://zhgchg.li/posts/zrealm-robotic-process-automation/zh-cn/ga4-%E8%87%AA%E5%8A%A8%E6%95%B0%E6%8D%AE%E9%80%9A%E7%9F%A5%E6%9C%BA%E5%99%A8%E4%BA%BA-3-%E6%AD%A5%E9%AA%A4%E7%94%A8-google-apps-script-%E4%B8%B2%E6%8E%A5-telegram-bot-1e85b8df2348/"}</script><title>GA4 自动数据通知机器人｜3 步骤用 Google Apps Script 串接 Telegram Bot | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script><link rel="alternate" hreflang="en" href="/posts/zrealm-robotic-process-automation/en/ga4-data-alerts-automation-3-step-guide-to-build-free-telegram-bot-notifications-1e85b8df2348/"><link rel="alternate" hreflang="zh-Hant" href="/posts/zrealm-robotic-process-automation/ga4-%E8%87%AA%E5%8B%95%E6%95%B8%E6%93%9A%E9%80%9A%E7%9F%A5%E6%A9%9F%E5%99%A8%E4%BA%BA-3-%E6%AD%A5%E9%A9%9F%E7%94%A8-google-apps-script-%E4%B8%B2%E6%8E%A5-telegram-bot-1e85b8df2348/"><link rel="alternate" hreflang="zh-Hans" href="/posts/zrealm-robotic-process-automation/zh-cn/ga4-%E8%87%AA%E5%8A%A8%E6%95%B0%E6%8D%AE%E9%80%9A%E7%9F%A5%E6%9C%BA%E5%99%A8%E4%BA%BA-3-%E6%AD%A5%E9%AA%A4%E7%94%A8-google-apps-script-%E4%B8%B2%E6%8E%A5-telegram-bot-1e85b8df2348/"><link rel="alternate" hreflang="x-default" href="/posts/zrealm-robotic-process-automation/zh-cn/ga4-%E8%87%AA%E5%8A%A8%E6%95%B0%E6%8D%AE%E9%80%9A%E7%9F%A5%E6%9C%BA%E5%99%A8%E4%BA%BA-3-%E6%AD%A5%E9%AA%A4%E7%94%A8-google-apps-script-%E4%B8%B2%E6%8E%A5-telegram-bot-1e85b8df2348/"><link rel="stylesheet" href="/assets/css/post-toc.css"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0">An iOS, web, and automation developer from Taiwan 🇹🇼 who also loves sharing, traveling, and writing.</p><a href="https://medium.com/@zhgchgli" target="_blank" style="display: block;text-align: center;font-style: normal;/* text-decoration: underline; */font-size: 1.2em;color: var(--heading-color);">1K+ Followers on Medium</a></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/english/" class="nav-link"> <i class="fa-fw fa fa-solid fa-language"></i> <span>ENGLISH POSTS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>GA4 自动数据通知机器人｜3 步骤用 Google Apps Script 串接 Telegram Bot</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>GA4 自动数据通知机器人｜3 步骤用 Google Apps Script 串接 Telegram Bot</h1><p class="post-desc fw-light mb-4">针对希望即时掌握网站数据的使用者，教你用 3 步骤打造免费 GA4 自动通知机器人，结合 Google Apps Script 与 Telegram Bot，定时推送近 7 天流量与热门页面，减少人工查询时间，提升数据监控效率。</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1729412392" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Oct 20, 2024 </time> </span> <span> Updated <time data-ts="1729412392" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Oct 20, 2024 </time> </span><div class="mt-3 mb-3"> <a href="/assets/1e85b8df2348/1*La0AKKSrGNP9EZUV-vrONQ.webp" class="popup img-link preview-img blur"><img data-src="/assets/1e85b8df2348/1*La0AKKSrGNP9EZUV-vrONQ.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></div><div class="d-flex justify-content-between"> <span style="display: inline-flex; align-items: center; gap: 4px;"> By <em> <a href="https://medium.com/@zhgchgli/">ZhgChgLi</a> </em> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" style="display: block; "><path fill="#007bff" d="M271.2 56C265.1 49.8 256.2 47.3 247.8 49.6C239.4 51.9 232.9 58.4 230.8 66.8L215.5 127C214.4 131.4 209.9 134 205.6 132.7L145.8 115.9C137.4 113.5 128.4 115.9 122.3 122C116.2 128.1 113.8 137.1 116.2 145.5L133.1 205.3C134.3 209.6 131.7 214.1 127.4 215.2L67.1 230.5C58.7 232.6 52.1 239.2 49.8 247.6C47.5 256 50 264.9 56.2 271L100.7 314.3C103.9 317.4 103.9 322.6 100.7 325.8L56.3 369.1C50.1 375.2 47.6 384.1 49.9 392.5C52.2 400.9 58.8 407.4 67.2 409.6L127.4 424.9C131.8 426 134.4 430.5 133.1 434.8L116.2 494.5C113.8 502.9 116.2 511.9 122.3 518C128.4 524.1 137.4 526.5 145.8 524.1L205.6 507.2C209.9 506 214.4 508.6 215.5 512.9L230.8 573.1C232.9 581.5 239.5 588.1 247.9 590.4C256.3 592.7 265.2 590.2 271.3 584L314.6 539.5C317.7 536.3 322.9 536.3 326.1 539.5L369.3 584C375.4 590.2 384.3 592.7 392.7 590.4C401.1 588.1 407.6 581.5 409.8 573.1L425.1 513C426.2 508.6 430.7 506 435 507.3L494.8 524.2C503.2 526.6 512.2 524.2 518.3 518.1C524.4 512 526.8 503 524.4 494.6L507.5 434.8C506.3 430.5 508.9 426 513.2 424.9L573.4 409.6C581.8 407.5 588.4 400.9 590.7 392.5C593 384.1 590.5 375.1 584.3 369.1L539.8 325.8C536.6 322.7 536.6 317.5 539.8 314.3L584.3 271C590.5 264.9 593 256 590.7 247.6C588.4 239.2 581.8 232.7 573.4 230.5L513.2 215.2C508.8 214.1 506.2 209.6 507.5 205.3L524.4 145.5C526.8 137.1 524.4 128.1 518.3 122C512.2 115.9 503.2 113.5 494.8 115.9L435 132.8C430.7 134 426.2 131.4 425.1 127.1L409.8 66.8C407.7 58.4 401.1 51.8 392.7 49.5C384.3 47.2 375.4 49.7 369.3 55.9L326 100.5C322.9 103.7 317.7 103.7 314.5 100.5L271.2 56z"/><path d="M250 330 l60 60 100 -140" stroke="#ffffff" stroke-width="40" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="3484 words" > <em>19 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">GA4 自动数据通知机器人｜3 步骤用 Google Apps Script 串接 Telegram Bot</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">章節 (Chapters)🔖</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">GA4 自动数据通知机器人｜3 步骤用 Google Apps Script 串接 Telegram Bot</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><blockquote class="prompt-tip"><p><a href="/posts/zrealm-robotic-process-automation/en/ga4-data-alerts-automation-3-step-guide-to-build-free-telegram-bot-notifications-1e85b8df2348/"><strong>Click here</strong></a> to view the English version of this article.</p></blockquote><blockquote class="prompt-tip"><p><a href="/posts/zrealm-robotic-process-automation/ga4-%E8%87%AA%E5%8B%95%E6%95%B8%E6%93%9A%E9%80%9A%E7%9F%A5%E6%A9%9F%E5%99%A8%E4%BA%BA-3-%E6%AD%A5%E9%A9%9F%E7%94%A8-google-apps-script-%E4%B8%B2%E6%8E%A5-telegram-bot-1e85b8df2348/"><strong>點擊這裡</strong></a>查看本文章正體中文版本。</p></blockquote><blockquote class="prompt-info"><p>基于 SEO 考量，本文标题与描述经 AI 调整，原始版本请参考内文。</p></blockquote><h4 id="zhgchgli-table-of-contents">文章目录</h4><nav class="zhgchgli-toc"><ul class="zhgchgli-toc-list"><li><a href="#简单-3-步骤--打造免费-ga4-自动数据通知机器人">简单 3 步骤 — 打造免费 GA4 自动数据通知机器人</a></li><li class="has-children"><details><summary>前言 <a href="#前言">#</a></summary><ul><li><a href="#详细可参考我之前的文章">详细可参考我之前的文章</a></li><li><a href="#其他做过的-rpa">其他做过的 RPA</a></li><li><a href="#工商时间">工商时间</a></li></ul></details></li><li class="has-children"><details><summary>本篇 Google Analytics 4 x Telegram Bot <a href="#本篇-google-analytics-4-x-telegram-bot">#</a></summary><ul><li><a href="#成果">成果</a></li></ul></details></li><li class="has-children"><details><summary>Step 1. 使用 GA4 Query Explorer 官方工具 产生数据报表查询参数 <a href="#step-1-使用-ga4-query-explorer-官方工具-产生数据报表查询参数">#</a></summary><ul><li><a href="#点击make-request产生对应的数据报表查询参数及结果">点击「MAKE REQUEST」产生对应的数据报表查询参数及结果</a></li><li><a href="#记下以下请求参数稍后撰写-google-apps-script-会使用">记下以下请求参数，稍后撰写 Google Apps Script 会使用</a></li><li><a href="#结果">结果</a></li></ul></details></li><li><a href="#step-2-建立-google-apps-script--使用-google-analytics-data-api-查询资料">Step 2. 建立 Google Apps Script & 使用 Google Analytics Data API 查询资料</a></li><li class="has-children"><details><summary>Step 3. 组合起来！Google Apps Script + GA4 + Telegram Bot <a href="#step-3-组合起来google-apps-script--ga4--telegram-bot">#</a></summary><ul><li><a href="#执行点击上方执行或侦错并确定方法名称是选择-execute-">执行：点击上方「执行」或「侦错」并确定方法名称是选择「 execute 」</a></li><li><a href="#设定排程定时自动执行">设定排程定时自动执行</a></li></ul></details></li><li><a href="#延伸作业">延伸作业</a></li></ul></nav><hr /><h3 id="简单-3-步骤--打造免费-ga4-自动数据通知机器人"><span class="me-2">简单 3 步骤 — 打造免费 GA4 自动数据通知机器人</span><a href="#简单-3-步骤--打造免费-ga4-自动数据通知机器人" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>使用 Google Apps Script 完成 RPA，自行串接 GA4 + Telegram Bot 数据通知机器人</p><p><a href="/assets/1e85b8df2348/1*La0AKKSrGNP9EZUV-vrONQ.webp" class="popup img-link blur"><img data-src="/assets/1e85b8df2348/1*La0AKKSrGNP9EZUV-vrONQ.webp" alt="Photo by [BoliviaInteligente](https://unsplash.com/@boliviainteligente?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9Ijg3NSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Photo by <a href="https://unsplash.com/@boliviainteligente?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash" target="_blank">BoliviaInteligente</a></p><h3 id="前言"><span class="me-2">前言</span><a href="#前言" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>大约从 2020 年开始就自己在摸索使用手边工具实现 RPA，从一开始只是为了自动化个人例行任务，到后来工作也加入了规模更大型的组织，时常会遇到跨团队或仰赖人与人的任务、甚至是重复性任务，才发现 RPA 自动化的效益所在。</p><p>举例来说：某个重复任务每个月会发生 10 次，每次需花费 30 分钟处理，有 60 人会遇到，每年团队等于消耗 3,600 小时在这上面，如果能投资 100 小时开发成自动化，后续解放出来的时间，就能投入在更有价值的工作上；实际等于 3,600 浪费的工时＋3,600 更值得投资的产出。</p><h4 id="详细可参考我之前的文章"><span class="me-2"><strong>详细可参考我之前的文章：</strong></span><a href="#详细可参考我之前的文章" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><p><a href="/posts/pinkoi-engineering/zh-cn/%E9%AB%98%E6%95%88%E7%8E%87%E5%B7%A5%E7%A8%8B%E5%9B%A2%E9%98%9F%E5%A4%A7%E8%A7%A3%E5%AF%86-pinkoi-%E5%9B%A2%E9%98%9F%E5%8D%8F%E4%BD%9C%E4%B8%8E%E8%87%AA%E5%8A%A8%E5%8C%96%E5%AE%9E%E8%B7%B5%E6%8F%90%E5%8D%87%E5%B7%A5%E4%BD%9C%E6%95%88%E7%8E%87-11f6c8568154/">2021 Pinkoi Tech Career Talk — 高效率工程团队大解密</a></p><li><p><a href="/posts/zrealm-robotic-process-automation/zh-cn/google-apps-script-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E6%95%B0%E6%8D%AE%E6%8A%A5%E8%A1%A8%E8%87%AA%E5%8A%A8%E5%8C%96-rpa-%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5-google-analytics-%E4%B8%8E-google-sheet-f6713ba3fee3/">使用 Google Apps Script 实现每日数据报表 RPA 自动化</a></p></ul><h4 id="其他做过的-rpa"><span class="me-2">其他做过的 RPA：</span><a href="#其他做过的-rpa" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><p>[GMail to Slack] <a href="/posts/zrealm-dev/zh-cn/google-apps-script-%E6%95%99%E5%AD%A6-%E8%87%AA%E5%8A%A8%E8%BD%AC%E5%8F%91-gmail-%E9%82%AE%E4%BB%B6%E5%88%B0-slack-channel-%E5%AE%A2%E5%88%B6%E5%8C%96%E9%80%9A%E7%9F%A5-d414bdbdb8c9/">运用 Google Apps Script 转发 Gmail 信件到 Slack</a></p><li><p>[Google Form x Google Sheet xSlack] <a href="https://medium.com/zrealm-robotic-process-automation/slack-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8B%95-wfh-%E5%93%A1%E5%B7%A5%E5%81%A5%E5%BA%B7%E7%8B%80%E6%B3%81%E5%9B%9E%E5%A0%B1%E7%B3%BB%E7%B5%B1-d61062833c1a?source=collection_home---6------9-----------------------" target="_blank">Slack 打造全自动 WFH 员工健康状况回报系统</a></p><li><p>[Big Query x Slack ] <a href="https://medium.com/zrealm-robotic-process-automation/crashlytics-big-query-%E6%89%93%E9%80%A0%E6%9B%B4%E5%8D%B3%E6%99%82%E4%BE%BF%E5%88%A9%E7%9A%84-crash-%E8%BF%BD%E8%B9%A4%E5%B7%A5%E5%85%B7-e77b80cc6f89?source=collection_home---6------7-----------------------" target="_blank">Crashlytics + Big Query 打造更即时便利的 Crash 追踪工具</a></p><li><p>[Google Analytics x Slack] <a href="https://medium.com/zrealm-robotic-process-automation/crashlytics-google-analytics-%E8%87%AA%E5%8B%95%E6%9F%A5%E8%A9%A2-app-crash-free-users-rate-793cb8f89b72?source=collection_home---6------6-----------------------" target="_blank">Crashlytics + Google Analytics 自动查询 App Crash-Free Users Rate</a></p><li><p>[Github Webhook x Line Notify] <a href="https://medium.com/zrealm-robotic-process-automation/%E4%BD%BF%E7%94%A8-google-apps-script-%E4%B8%89%E6%AD%A5%E9%A9%9F%E5%85%8D%E8%B2%BB%E5%BB%BA%E7%AB%8B-github-repo-star-notifier-382218e15697?source=collection_home---6------5-----------------------" target="_blank">使用 Google Apps Script 三步骤免费建立 Github Repo Star Notifier</a></p><li><p>[Slack x OpenAI (ChatGTP) ] <a href="https://medium.com/zrealm-robotic-process-automation/slack-chatgpt-integration-bd94cc88f9c9?source=collection_home---6------4-----------------------" target="_blank">Slack &amp; ChatGPT Integration</a></p><li><p>[Google Analytics x Google Sheet] <a href="https://medium.com/zrealm-robotic-process-automation/%E4%BD%BF%E7%94%A8-google-apps-script-%E5%AF%A6%E7%8F%BE-google-%E6%9C%8D%E5%8B%99-rpa-%E8%87%AA%E5%8B%95%E5%8C%96-f6713ba3fee3?source=collection_home---6------3-----------------------" target="_blank">使用 Google Apps Script 实现每日数据报表 RPA 自动化</a></p><li><p>[iOS Shortcut x Line x Reminders] <a href="https://medium.com/zrealm-robotic-process-automation/ios-%E6%8D%B7%E5%BE%91%E8%87%AA%E5%8B%95%E5%8C%96%E6%87%89%E7%94%A8%E5%A0%B4%E6%99%AF-%E8%87%AA%E5%8B%95%E8%BD%89%E7%99%BC%E7%B0%A1%E8%A8%8A%E8%88%87%E8%87%AA%E5%8B%95%E5%BB%BA%E7%AB%8B%E6%8F%90%E9%86%92%E5%BE%85%E8%BE%A6%E4%BA%8B%E9%A0%85-309d0302877b?source=collection_home---6------2-----------------------" target="_blank">iOS 捷径自动化应用场景 — 自动转发简讯与自动建立提醒待办事项</a></p><li><p>[Apple Store API x Google Play Console API x Github Action] <a href="https://medium.com/zrealm-robotic-process-automation/quick-start-github-action-x-zreviewtender-%E5%85%8D%E8%B2%BB%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2%E4%BD%A0%E7%9A%84-app-%E5%95%86%E5%9F%8E%E8%A9%95%E5%83%B9%E7%9B%A3%E6%8E%A7%E6%A9%9F%E5%99%A8%E4%BA%BA-0095528cf875?source=collection_home---6------1-----------------------" target="_blank">Github Action x ZReviewTender 免费快速部署你的 App 商城评价监控机器人</a></p><li><p>[Telegram Bot] <a href="https://medium.com/zrealm-robotic-process-automation/10-%E5%88%86%E9%90%98%E5%BF%AB%E9%80%9F%E7%A7%BB%E8%BD%89-line-notify-%E5%88%B0-telegram-bot-%E9%80%9A%E7%9F%A5-6922e90ba90c?source=collection_home---6------0-----------------------" target="_blank">10 分钟快速移转 Line Notify 到 Telegram Bot 通知</a></p><li><p>[Medium to Jekyllrb] <a href="/posts/zrealm-dev/zh-cn/%E6%97%A0%E7%97%9B%E8%BD%AC%E7%A7%BB-medium-%E6%96%87%E7%AB%A0%E5%88%B0%E8%87%AA%E6%9E%B6-jekyll-%E9%9D%99%E6%80%81%E7%BD%91%E7%AB%99-%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%87%AA%E5%8A%A8%E5%90%8C%E6%AD%A5%E6%95%99%E5%AD%A6-a0c08d579ab1/">无痛转移 Medium 到自架网站</a></p></ul><p>从后台数据看之前蛮多文章有被 ChatGPT 或各种 GenAI 服务收录，间接的帮助了许多非工程背景但也想尝试使用 RPA 解决问题的朋友，因此我仍会持续分享自己生活或工作上遇到的 RPA 场景跟我的解决方案与大家分享 — <a href="/posts/zrealm-dev/zh-cn/google-apps-script-%E6%95%99%E5%AD%A6-%E8%87%AA%E5%8A%A8%E8%BD%AC%E5%8F%91-gmail-%E9%82%AE%E4%BB%B6%E5%88%B0-slack-channel-%E5%AE%A2%E5%88%B6%E5%8C%96%E9%80%9A%E7%9F%A5-d414bdbdb8c9/">ZRealm Robotic Process Automation</a> 。</p><h4 id="工商时间"><span class="me-2">工商时间</span><a href="#工商时间" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>如果您与您的团队有自动化工具、流程串接需求，不论是 Slack App 开发、Notion、Asana、Google Sheet、Google Form、GA 数据，各种串接需求，欢迎与我 <a href="https://zhgchg.li/contact/" target="_blank"><strong>联络开发</strong></a> 。</p><h3 id="本篇-google-analytics-4-x-telegram-bot"><span class="me-2">本篇 Google Analytics 4 x Telegram Bot</span><a href="#本篇-google-analytics-4-x-telegram-bot" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>这次要介绍的串接场景是接续上一篇「 <a href="https://medium.com/zrealm-robotic-process-automation/10-%E5%88%86%E9%90%98%E5%BF%AB%E9%80%9F%E7%A7%BB%E8%BD%89-line-notify-%E5%88%B0-telegram-bot-%E9%80%9A%E7%9F%A5-6922e90ba90c?source=collection_home---6------0-----------------------" target="_blank">10 分钟快速移转 Line Notify 到 Telegram Bot 通知</a> 」时想到我的 Medium 备份站「 <a href="https://zhgchg.li/" target="_blank">zhgchg.li</a> 」一直都没有关注他的 GA4 网站数据，想说好像可以多做一个通知机器人，每日传送过去 7 天的网站数据到指定的 Telegram Channel 让我知道。</p><p>本篇只是小品，如果要做完整的自动化数据报表请参考之前的文章「 <a href="https://medium.com/zrealm-robotic-process-automation/%E4%BD%BF%E7%94%A8-google-apps-script-%E5%AF%A6%E7%8F%BE-google-%E6%9C%8D%E5%8B%99-rpa-%E8%87%AA%E5%8B%95%E5%8C%96-f6713ba3fee3?source=collection_home---6------3-----------------------" target="_blank">使用 Google Apps Script 实现每日数据报表 RPA 自动化</a> 」另外之前也曾串过 GA4 捞取 App Crash-free rate 可参考此篇文章「 <a href="https://medium.com/zrealm-robotic-process-automation/crashlytics-google-analytics-%E8%87%AA%E5%8B%95%E6%9F%A5%E8%A9%A2-app-crash-free-users-rate-793cb8f89b72?source=collection_home---6------6-----------------------" target="_blank">Crashlytics + Google Analytics 自动查询 App Crash-Free Users Rate</a> 」。</p><ul><li><p>Google Apps Script 免费限制、详细使用、部署、功能介绍本篇不会再多介绍，请参考 <a href="https://medium.com/zrealm-robotic-process-automation/%E4%BD%BF%E7%94%A8-google-apps-script-%E5%AF%A6%E7%8F%BE-google-%E6%9C%8D%E5%8B%99-rpa-%E8%87%AA%E5%8B%95%E5%8C%96-f6713ba3fee3?source=collection_home---6------3-----------------------" target="_blank">之前文章</a> 。</p><li><p>Telegram Bot 创建、使用本篇也不会再多介绍，同样请参考 <a href="https://medium.com/zrealm-robotic-process-automation/10-%E5%88%86%E9%90%98%E5%BF%AB%E9%80%9F%E7%A7%BB%E8%BD%89-line-notify-%E5%88%B0-telegram-bot-%E9%80%9A%E7%9F%A5-6922e90ba90c?source=collection_home---6------0-----------------------" target="_blank">之前文章</a> 。</p></ul><h4 id="成果"><span class="me-2">成果</span><a href="#成果" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/1e85b8df2348/1*J7QdgrJRNzVFQJfW5UBBFA.webp" class="popup img-link blur"><img data-src="/assets/1e85b8df2348/1*J7QdgrJRNzVFQJfW5UBBFA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NTUiIGhlaWdodD0iNDYwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>先上最终效果，Google Apps Script 每日下午 12–13 点之间会自动去捞取我想要的 Google Analytics 4 网站数据并组合成讯息透过 Telegram Bot 传送到我的 Telegram Channel，我可以快速检阅近 7 天网站数据。</p><p><strong>我想要观测的数据是：</strong></p><ul><li><p>近 7 天 <code class="language-plaintext highlighter-rouge">7daysAgo ~ today</code> 总浏览数 <code class="language-plaintext highlighter-rouge">screenPageViews</code></p><li><p>活跃使用者数 <code class="language-plaintext highlighter-rouge">active7DayUsers</code></p><li><p>新使用者数 <code class="language-plaintext highlighter-rouge">newUsers</code></p><li><p>Top 10 浏览页面 <code class="language-plaintext highlighter-rouge">screenPageViews</code> / <code class="language-plaintext highlighter-rouge">pageTitle</code></p><li><p>新使用者最初来源媒介 <code class="language-plaintext highlighter-rouge">newUsers</code> / <code class="language-plaintext highlighter-rouge">firstUserSourceMedium</code></p></ul><blockquote><p><em>实际可依照你自己的需求使用 <a href="https://ga-dev-tools.google/ga4/query-explorer/" target="_blank">GA Dev Tools</a> 产生调整。</em></p></blockquote><h3 id="step-1-使用-ga4-query-explorer-官方工具-产生数据报表查询参数"><span class="me-2">Step 1. 使用 <a href="https://ga-dev-tools.google/ga4/query-explorer/" target="_blank">GA4 Query Explorer 官方工具</a> 产生数据报表查询参数</span><a href="#step-1-使用-ga4-query-explorer-官方工具-产生数据报表查询参数" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>首先，我们需要使用 <a href="https://ga-dev-tools.google/ga4/query-explorer/" target="_blank">GA4 Query Explorer</a> 官方提供的工具产生我们需要的查询数据报表参数：</p><p><a href="/assets/1e85b8df2348/1*4b1S9nYSmO7OmGgDPllxeQ.webp" class="popup img-link blur"><img data-src="/assets/1e85b8df2348/1*4b1S9nYSmO7OmGgDPllxeQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDYzIiBoZWlnaHQ9IjEyMDAiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><ol><li><p>Select Property: 记下你的 <code class="language-plaintext highlighter-rouge">property 编号</code> <strong>property 编号稍后撰写 Google Apps Script 会使用。</strong></p><li><p>start date, end date: 报表开始～结束的日期范围，可使用 <code class="language-plaintext highlighter-rouge">YYYY-MM-DD</code> 或 <code class="language-plaintext highlighter-rouge">yesterday</code> , <code class="language-plaintext highlighter-rouge">today</code> , <code class="language-plaintext highlighter-rouge">NdaysAgo</code> 魔术变数。</p><li><p>metrics: 选择你想要查询的指标</p><li><p>dimensions: 选择你想要查询的维度</p><li><p>metric aggregations: 数据合并计算规则</p></ol><p>这边以我的场景为例：</p><ol><li><p>property 编号: <code class="language-plaintext highlighter-rouge">318495208</code></p><li><p>start_date: <code class="language-plaintext highlighter-rouge">7daysAgo</code></p><li><p>end_date: <code class="language-plaintext highlighter-rouge">yesterday</code> 因 GA 数据报表会延迟，查询前一天～七天最准确。</p><li><p>metric aggregations: <code class="language-plaintext highlighter-rouge">total</code></p></ol><p><strong>其他 filter, limit 可依照自己需求设定：</strong></p><p><a href="/assets/1e85b8df2348/1*g2psNn3gMZWs4OFRx7phWQ.webp" class="popup img-link blur"><img data-src="/assets/1e85b8df2348/1*g2psNn3gMZWs4OFRx7phWQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MzIiIGhlaWdodD0iNjk0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>filter 我用不到留空；limit 我输入 10，因为我只想知道 Top 10。</p><h4 id="点击make-request产生对应的数据报表查询参数及结果"><span class="me-2"><strong>点击「MAKE REQUEST」产生对应的数据报表查询参数及结果：</strong></span><a href="#点击make-request产生对应的数据报表查询参数及结果" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/1e85b8df2348/1*Rj1kMTyZiEYGvAztEEngIQ.webp" class="popup img-link blur"><img data-src="/assets/1e85b8df2348/1*Rj1kMTyZiEYGvAztEEngIQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MDgiIGhlaWdodD0iNjkzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><h4 id="记下以下请求参数稍后撰写-google-apps-script-会使用"><span class="me-2"><strong>记下以下请求参数，稍后撰写 Google Apps Script 会使用：</strong></span><a href="#记下以下请求参数稍后撰写-google-apps-script-会使用" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"dimensions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pageTitle"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"metrics"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"screenPageViews"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"dateRanges"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"startDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7daysAgo"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"endDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yesterday"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"limit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"metricAggregations"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"TOTAL"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><h4 id="结果"><span class="me-2"><strong>结果：</strong></span><a href="#结果" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/1e85b8df2348/1*ivAXeRTVB8Y7zbP-Gq2I2A.webp" class="popup img-link blur"><img data-src="/assets/1e85b8df2348/1*ivAXeRTVB8Y7zbP-Gq2I2A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MDEiIGhlaWdodD0iOTAzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/1e85b8df2348/1*FFThyuptIYrGsfddHcjupQ.webp" class="popup img-link blur"><img data-src="/assets/1e85b8df2348/1*FFThyuptIYrGsfddHcjupQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTc5IiBoZWlnaHQ9IjI1NTYiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><ul><li>与 GA 上的数据比较是否正确，正确相符 ✅✅✅</ul><h3 id="step-2-建立-google-apps-script--使用-google-analytics-data-api-查询资料"><span class="me-2">Step 2. 建立 Google Apps Script &amp; 使用 Google Analytics Data API 查询资料</span><a href="#step-2-建立-google-apps-script--使用-google-analytics-data-api-查询资料" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p>前往 <a href="https://script.google.com/home" target="_blank">https://script.google.com/home</a></p><li><p>建立新专案，命名专案名称</p><li><p>点击「服务」-&gt;「+」新增服务</p><li><p>选择「Google Analytics Data API」</p><li><p>点击「新增」</p></ul><p><a href="/assets/1e85b8df2348/1*gcMDDQTXd-Gos5AdGUXIOw.webp" class="popup img-link blur"><img data-src="/assets/1e85b8df2348/1*gcMDDQTXd-Gos5AdGUXIOw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9Ijk2MyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><strong>贴上 Google Analytics Data API 查询程式码并组合：</strong></p><p>将前面步骤产生的报表查询数据参数：</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"dimensions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pageTitle"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"metrics"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"screenPageViews"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"dateRanges"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"startDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7daysAgo"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"endDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yesterday"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"limit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"metricAggregations"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"TOTAL"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p><strong>转换成程式：</strong></p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nf">execute</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">Logger</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nf">stringify</span><span class="p">(</span><span class="nf">fetchScreenPageViews</span><span class="p">(</span><span class="dl">"</span><span class="s2">318495208</span><span class="dl">"</span><span class="p">)));</span>
<span class="p">}</span>

<span class="c1">// 拆成独立方法，方便日后重复使用...</span>
<span class="c1">// 预设 startDate=7daysAgo, endDate=yesterday</span>
<span class="c1">// 其他用法：</span>
<span class="c1">// e.g. fetchScreenPageViews("1111". "3daysAgo", "yesterday")</span>
<span class="c1">// e.g. fetchScreenPageViews("2222". "yesterday", "today")</span>
<span class="kd">function</span> <span class="nf">fetchScreenPageViews</span><span class="p">(</span><span class="nx">propertyId</span><span class="p">,</span> <span class="nx">startDate</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">7daysAgo</span><span class="dl">"</span><span class="p">,</span> <span class="nx">endDate</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">yesterday</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">screenPageViewsMetric</span> <span class="o">=</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nf">newMetric</span><span class="p">();</span>
  <span class="nx">screenPageViewsMetric</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">screenPageViews</span><span class="dl">"</span><span class="p">;</span>

  <span class="kd">const</span> <span class="nx">dateRange</span> <span class="o">=</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nf">newDateRange</span><span class="p">();</span>
  <span class="nx">dateRange</span><span class="p">.</span><span class="nx">startDate</span> <span class="o">=</span> <span class="nx">startDate</span><span class="p">;</span>
  <span class="nx">dateRange</span><span class="p">.</span><span class="nx">endDate</span> <span class="o">=</span> <span class="nx">endDate</span><span class="p">;</span>

  <span class="kd">const</span> <span class="nx">pageTitleDimension</span> <span class="o">=</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nf">newDimension</span><span class="p">();</span>
  <span class="nx">pageTitleDimension</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">pageTitle</span><span class="dl">"</span><span class="p">;</span>

  <span class="kd">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nf">newRunReportRequest</span><span class="p">();</span>
  <span class="nx">request</span><span class="p">.</span><span class="nx">dimensions</span> <span class="o">=</span> <span class="p">[</span><span class="nx">pageTitleDimension</span><span class="p">];</span>
  <span class="nx">request</span><span class="p">.</span><span class="nx">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="nx">screenPageViewsMetric</span><span class="p">];</span>
  <span class="nx">request</span><span class="p">.</span><span class="nx">dateRanges</span> <span class="o">=</span> <span class="nx">dateRange</span><span class="p">;</span>

  <span class="nx">request</span><span class="p">.</span><span class="nx">limit</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="nx">request</span><span class="p">.</span><span class="nx">metricAggregations</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">TOTAL</span><span class="dl">"</span><span class="p">;</span>

  <span class="k">return</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nx">Properties</span><span class="p">.</span><span class="nf">runReport</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="dl">"</span><span class="s2">properties/</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">propertyId</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>程式码解析：</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="c1">// metric 指标，可以是多个，请分开宣告...</span>
<span class="kd">const</span> <span class="nx">screenPageViewsMetric</span> <span class="o">=</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nf">newMetric</span><span class="p">();</span>
<span class="nx">screenPageViewsMetric</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">screenPageViews</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// 例如另一个 active1DayUsers：</span>
<span class="kd">const</span> <span class="nx">active1DayUsersMetric</span> <span class="o">=</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nf">newMetric</span><span class="p">();</span>
<span class="nx">active1DayUsersMetric</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">active1DayUsers</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// 宣告日期范围</span>
<span class="kd">const</span> <span class="nx">dateRange</span> <span class="o">=</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nf">newDateRange</span><span class="p">();</span>
<span class="nx">dateRange</span><span class="p">.</span><span class="nx">startDate</span> <span class="o">=</span> <span class="nx">startDate</span><span class="p">;</span>
<span class="nx">dateRange</span><span class="p">.</span><span class="nx">endDate</span> <span class="o">=</span> <span class="nx">endDate</span><span class="p">;</span>

<span class="c1">// dimension 维度，可以是多个，请分开宣告...</span>
<span class="kd">const</span> <span class="nx">pageTitleDimension</span> <span class="o">=</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nf">newDimension</span><span class="p">();</span>
<span class="nx">pageTitleDimension</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">pageTitle</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// 例如另一个 dimension：</span>
<span class="kd">const</span> <span class="nx">firstUserSourceMediumDimension</span> <span class="o">=</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nf">newDimension</span><span class="p">();</span>
<span class="nx">firstUserSourceMediumDimension</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">firstUserSourceMedium</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">//</span>

<span class="c1">// 产生 Request 物件</span>
<span class="kd">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nf">newRunReportRequest</span><span class="p">();</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="nx">active1DayUsersMetric</span><span class="p">,</span> <span class="nx">active1DayUsersMetric</span><span class="p">];</span> <span class="c1">// 多个就都带入...</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">dimensions</span> <span class="o">=</span> <span class="p">[</span><span class="nx">pageTitleDimension</span><span class="p">,</span> <span class="nx">firstUserSourceMediumDimension</span><span class="p">];</span> <span class="c1">// 多个就都带入...</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">dateRanges</span> <span class="o">=</span> <span class="nx">dateRange</span><span class="p">;</span>

<span class="c1">// 只需要前 10 笔资料 (Top 10)</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">limit</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

<span class="c1">// 设定数据合并计算逻辑：Total (SUM)</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">metricAggregations</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">TOTAL</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// 产生查询结果</span>
<span class="k">return</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nx">Properties</span><span class="p">.</span><span class="nf">runReport</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="dl">"</span><span class="s2">properties/</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">propertyId</span><span class="p">).</span><span class="nx">rows</span><span class="p">;</span>
</pre></table></code></div></div><p><strong>第一次执行，会需要授权(日后若程式码有新增需要的权限也会要重新认证一次)：</strong></p><blockquote><p><em>实际上就是授权 Google Apps Script 日后使用你的帐号身份执行这些程式，所以需要确保你选择的帐号身份有对应的 GA 报表存取权限。</em></p></blockquote><p><a href="/assets/1e85b8df2348/1*_z-P8a4PZCozhtgssH82lA.webp" class="popup img-link blur"><img data-src="/assets/1e85b8df2348/1*_z-P8a4PZCozhtgssH82lA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NzkiIGhlaWdodD0iNDc3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>撰写好程式码后，点击「侦错」-&gt; 点击「审查权限」</ul><p><a href="/assets/1e85b8df2348/1*ehox-4AjKv3Ddf1jJ_VmTQ.webp" class="popup img-link blur"><img data-src="/assets/1e85b8df2348/1*ehox-4AjKv3Ddf1jJ_VmTQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9Ijk1NCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ul><li>选择要执行的身份帐户，通常等于当前 Google Apps Script 帐户</ul><p><a href="/assets/1e85b8df2348/1*onR-n1sI4-G9KhD_fhef3Q.webp" class="popup img-link blur"><img data-src="/assets/1e85b8df2348/1*onR-n1sI4-G9KhD_fhef3Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjY1IiBoZWlnaHQ9IjEwMDYiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><ul><li>选择「进阶」展开 -&gt; 点击「前往 XXX」 这是我们自己写给自己用的应用程式，不需经过 Google 验证。</ul><p><a href="/assets/1e85b8df2348/1*73fQnaB__qKhO7NndQ0GyQ.webp" class="popup img-link blur"><img data-src="/assets/1e85b8df2348/1*73fQnaB__qKhO7NndQ0GyQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9Ijk1NCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ul><li>点击「允许」</ul><p><strong>允许之后再点「侦错」或「执行」就能执行程式：</strong></p><p><a href="/assets/1e85b8df2348/1*DbcQnfp8xdJCFnrDc778tw.webp" class="popup img-link blur"><img data-src="/assets/1e85b8df2348/1*DbcQnfp8xdJCFnrDc778tw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjY1IiBoZWlnaHQ9IjEwMDYiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>这边我们先使用 <code class="language-plaintext highlighter-rouge">Logger.log(JSON.stringify())</code> 取得输出结果：</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"analyticsData#runReport"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"dimensionHeaders"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pageTitle"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"rowCount"</span><span class="p">:</span><span class="w"> </span><span class="mi">71</span><span class="p">,</span><span class="w">
  </span><span class="nl">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"currencyCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TWD"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"timeZone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Asia/Taipei"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"rows"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"dimensionValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ZhgChgLi"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"metricValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"166"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"metricValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"109"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"dimensionValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Apple Watch 原厂不锈钢米兰表带开箱 </span><span class="se">\\</span><span class="s2">| ZhgChgLi"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"dimensionValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iOS ≥ 13.1 使用「捷径」自动化功能搭配米家智慧家居 </span><span class="se">\\</span><span class="s2">| ZhgChgLi"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"metricValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"101"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"dimensionValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Medium Partner Program 终于对全球(包含台湾)写作者开放啦！ </span><span class="se">\\</span><span class="s2">| ZhgChgLi"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"metricValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"85"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"metricValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"77"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"dimensionValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iOS 捷径自动化应用场景 — 自动转发简讯与自动建立提醒待办事项 </span><span class="se">\\</span><span class="s2">| ZhgChgLi"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"metricValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"51"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"dimensionValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"游记 9/11 名古屋一日快闪自由行 </span><span class="se">\\</span><span class="s2">| ZhgChgLi"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"metricValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"42"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"dimensionValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iOS 隐私与便利的前世今生 </span><span class="se">\\</span><span class="s2">| ZhgChgLi"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"dimensionValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iOS Vision framework x WWDC 24 Discover Swift enhancements in the Vision framework Session </span><span class="se">\\</span><span class="s2">| ZhgChgLi"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"metricValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"dimensionValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iOS ≥ 18 NSAttributedString attributes Range 合并的一个行为改变 </span><span class="se">\\</span><span class="s2">| ZhgChgLi"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"metricValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"30"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"metricValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"30"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"dimensionValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"手工打造 HTML 解析器的那些事 </span><span class="se">\\</span><span class="s2">| ZhgChgLi"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"metricHeaders"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TYPE_INTEGER"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"screenPageViews"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"totals"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"dimensionValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RESERVED_TOTAL"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"metricValues"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1229"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><ul><li><strong>Google Apps Script 请求 GA 数据成功！🎉🎉🎉</strong></ul><h3 id="step-3-组合起来google-apps-script--ga4--telegram-bot"><span class="me-2">Step 3. 组合起来！Google Apps Script + GA4 + Telegram Bot</span><a href="#step-3-组合起来google-apps-script--ga4--telegram-bot" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>依照上篇文章「 <a href="https://medium.com/zrealm-robotic-process-automation/10-%E5%88%86%E9%90%98%E5%BF%AB%E9%80%9F%E7%A7%BB%E8%BD%89-line-notify-%E5%88%B0-telegram-bot-%E9%80%9A%E7%9F%A5-6922e90ba90c?source=collection_home---6------0-----------------------" target="_blank">10 分钟快速移转 Line Notify 到 Telegram Bot 通知</a> 」建立你的 Telegram Bot 取得 <code class="language-plaintext highlighter-rouge">Bot Token</code> &amp; 想要传送到的 <code class="language-plaintext highlighter-rouge">Channel Chat ID</code> 。</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">telegramToken</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">XXXX</span><span class="dl">"</span> <span class="c1">// 带入你的 Telegram Bot Token</span>
<span class="c1">//</span>

<span class="kd">function</span> <span class="nf">execute</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">screenPageViewsReport</span> <span class="o">=</span> <span class="nf">fetchScreenPageViews</span><span class="p">(</span><span class="dl">"</span><span class="s2">318495208</span><span class="dl">"</span><span class="p">);</span>
  
  <span class="c1">//</span>
  <span class="kd">const</span> <span class="nx">total</span> <span class="o">=</span> <span class="nf">parseInt</span><span class="p">(</span><span class="nx">screenPageViewsReport</span><span class="p">.</span><span class="nx">totals</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">metricValues</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">value</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">message</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">总浏览数：</span><span class="dl">"</span><span class="o">+</span><span class="nx">total</span><span class="p">.</span><span class="nf">toLocaleString</span><span class="p">()</span><span class="o">+</span><span class="dl">"</span><span class="se">\n</span><span class="dl">"</span><span class="p">;</span>

  <span class="nx">screenPageViewsReport</span><span class="p">.</span><span class="nx">rows</span><span class="p">.</span><span class="nf">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">pageTitle</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">dimensionValues</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">value</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">value</span> <span class="o">=</span> <span class="nf">parseInt</span><span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">metricValues</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">value</span><span class="p">);</span>

    <span class="nx">message</span> <span class="o">+=</span> <span class="dl">"</span><span class="s2">[Top </span><span class="dl">"</span><span class="o">+</span><span class="p">(</span><span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="dl">"</span><span class="s2">] </span><span class="dl">"</span><span class="o">+</span><span class="nx">pageTitle</span><span class="o">+</span><span class="dl">"</span><span class="s2">: </span><span class="dl">"</span><span class="o">+</span><span class="nx">value</span><span class="p">.</span><span class="nf">toLocaleString</span><span class="p">()</span><span class="o">+</span><span class="dl">"</span><span class="se">\n</span><span class="dl">"</span><span class="p">;</span>
  <span class="p">});</span>

  <span class="nf">sendNotifyMessage</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="o">-</span><span class="nx">xxxx</span><span class="p">);</span> <span class="c1">// 带入你的 Channel Chat ID</span>
<span class="p">}</span>


<span class="c1">// 发送讯息到 Telegram 指定 Channel Chat ID</span>
<span class="kd">function</span> <span class="nf">sendNotifyMessage</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">chatId</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.telegram.org/bot</span><span class="dl">"</span><span class="o">+</span><span class="nx">telegramToken</span><span class="o">+</span><span class="dl">"</span><span class="s2">/sendMessage</span><span class="dl">"</span><span class="p">;</span>
  
  <span class="kd">const</span> <span class="nx">payload</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">chat_id</span><span class="dl">"</span><span class="p">:</span> <span class="nx">chatId</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="nx">message</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">disable_web_page_preview</span><span class="dl">"</span><span class="p">:</span> <span class="kc">true</span>
  <span class="p">}</span> 
  <span class="kd">const</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">method</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">contentType</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">muteHttpExceptions</span><span class="dl">'</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">payload</span><span class="dl">'</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">stringify</span><span class="p">(</span><span class="nx">payload</span><span class="p">)</span>
  <span class="p">};</span>

  <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nf">getContentText</span><span class="p">());</span>

  <span class="k">if </span><span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="dl">"</span><span class="s2">ok</span><span class="dl">"</span><span class="p">]</span> <span class="o">==</span> <span class="kc">undefined</span> <span class="err">\\</span><span class="o">|</span><span class="err">\\</span><span class="o">|</span> <span class="nx">data</span><span class="p">[</span><span class="dl">"</span><span class="s2">ok</span><span class="dl">"</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="dl">"</span><span class="s2">error_code</span><span class="dl">"</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">undefined</span> <span class="o">&amp;&amp;</span> <span class="nx">data</span><span class="p">[</span><span class="dl">"</span><span class="s2">error_code</span><span class="dl">"</span><span class="p">]</span> <span class="o">==</span> <span class="mi">429</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">Utilities</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
      <span class="nf">sendNotifyMessage</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">chatId</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nf">fetchScreenPageViews</span><span class="p">(</span><span class="nx">propertyId</span><span class="p">,</span> <span class="nx">startDate</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">7daysAgo</span><span class="dl">"</span><span class="p">,</span> <span class="nx">endDate</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">yesterday</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">screenPageViewsMetric</span> <span class="o">=</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nf">newMetric</span><span class="p">();</span>
  <span class="nx">screenPageViewsMetric</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">screenPageViews</span><span class="dl">"</span><span class="p">;</span>

  <span class="kd">const</span> <span class="nx">dateRange</span> <span class="o">=</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nf">newDateRange</span><span class="p">();</span>
  <span class="nx">dateRange</span><span class="p">.</span><span class="nx">startDate</span> <span class="o">=</span> <span class="nx">startDate</span><span class="p">;</span>
  <span class="nx">dateRange</span><span class="p">.</span><span class="nx">endDate</span> <span class="o">=</span> <span class="nx">endDate</span><span class="p">;</span>

  <span class="kd">const</span> <span class="nx">pageTitleDimension</span> <span class="o">=</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nf">newDimension</span><span class="p">();</span>
  <span class="nx">pageTitleDimension</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">pageTitle</span><span class="dl">"</span><span class="p">;</span>

  <span class="kd">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nf">newRunReportRequest</span><span class="p">();</span>
  <span class="nx">request</span><span class="p">.</span><span class="nx">dimensions</span> <span class="o">=</span> <span class="p">[</span><span class="nx">pageTitleDimension</span><span class="p">];</span>
  <span class="nx">request</span><span class="p">.</span><span class="nx">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="nx">screenPageViewsMetric</span><span class="p">];</span>
  <span class="nx">request</span><span class="p">.</span><span class="nx">dateRanges</span> <span class="o">=</span> <span class="nx">dateRange</span><span class="p">;</span>

  <span class="nx">request</span><span class="p">.</span><span class="nx">limit</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="nx">request</span><span class="p">.</span><span class="nx">metricAggregations</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">TOTAL</span><span class="dl">"</span><span class="p">;</span>

  <span class="k">return</span> <span class="nx">AnalyticsData</span><span class="p">.</span><span class="nx">Properties</span><span class="p">.</span><span class="nf">runReport</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="dl">"</span><span class="s2">properties/</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">propertyId</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>程式码解析：</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1">//...</span>
  <span class="c1">// 依照报表回传的 json 找到 total 位置，parseInt 将字串转成 INT 数字格式</span>
  <span class="c1">// .toLocaleString() -&gt; 格式化数字，123456 -&gt; 123,456</span>
  <span class="kd">const</span> <span class="nx">total</span> <span class="o">=</span> <span class="nf">parseInt</span><span class="p">(</span><span class="nx">screenPageViewsReport</span><span class="p">.</span><span class="nx">totals</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">metricValues</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">value</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">message</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">总浏览数：</span><span class="dl">"</span><span class="o">+</span><span class="nx">total</span><span class="p">.</span><span class="nf">toLocaleString</span><span class="p">()</span><span class="o">+</span><span class="dl">"</span><span class="se">\n</span><span class="dl">"</span><span class="p">;</span>

  <span class="c1">// 依照报表回传的 json 遍历资料，组合成讯息</span>
  <span class="nx">screenPageViewsReport</span><span class="p">.</span><span class="nx">rows</span><span class="p">.</span><span class="nf">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">pageTitle</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">dimensionValues</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">value</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">value</span> <span class="o">=</span> <span class="nf">parseInt</span><span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">metricValues</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">value</span><span class="p">);</span>

    <span class="nx">message</span> <span class="o">+=</span> <span class="dl">"</span><span class="s2">[Top </span><span class="dl">"</span><span class="o">+</span><span class="p">(</span><span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="dl">"</span><span class="s2">] </span><span class="dl">"</span><span class="o">+</span><span class="nx">pageTitle</span><span class="o">+</span><span class="dl">"</span><span class="s2">: </span><span class="dl">"</span><span class="o">+</span><span class="nx">value</span><span class="p">.</span><span class="nf">toLocaleString</span><span class="p">()</span><span class="o">+</span><span class="dl">"</span><span class="se">\n</span><span class="dl">"</span><span class="p">;</span>
  <span class="p">});</span>
<span class="c1">//...</span>
</pre></table></code></div></div><h4 id="执行点击上方执行或侦错并确定方法名称是选择-execute-"><span class="me-2"><strong>执行：点击上方「执行」或「侦错」并确定方法名称是选择「 <code class="language-plaintext highlighter-rouge">execute</code> 」：</strong></span><a href="#执行点击上方执行或侦错并确定方法名称是选择-execute-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/1e85b8df2348/1*R7uVMGODJR2Z_GAYnyMYXA.webp" class="popup img-link blur"><img data-src="/assets/1e85b8df2348/1*R7uVMGODJR2Z_GAYnyMYXA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MTIiIGhlaWdodD0iMTA5Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/1e85b8df2348/1*Pl2v19Ed8COUwCc1deTYFw.webp" class="popup img-link blur"><img data-src="/assets/1e85b8df2348/1*Pl2v19Ed8COUwCc1deTYFw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NDMiIGhlaWdodD0iMjc0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li><strong>成功！🎉🎉🎉</strong></ul><h4 id="设定排程定时自动执行"><span class="me-2">设定排程定时自动执行</span><a href="#设定排程定时自动执行" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>最后一步是我们希望报表机器人能定时自动执行，从左侧选单前往「触发条件」：</p><p><a href="/assets/1e85b8df2348/1*SY1YKLwTvDtP1hQTRqj50w.webp" class="popup img-link blur"><img data-src="/assets/1e85b8df2348/1*SY1YKLwTvDtP1hQTRqj50w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NjYiIGhlaWdodD0iODA1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>选择右下角「新增触发条件」按钮</ul><p><a href="/assets/1e85b8df2348/1*wYOwwQBTEtns8nN_7bmvNQ.webp" class="popup img-link blur"><img data-src="/assets/1e85b8df2348/1*wYOwwQBTEtns8nN_7bmvNQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NzUiIGhlaWdodD0iODc0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ol><li><p>选择镡要执行的功能：选择 「 <code class="language-plaintext highlighter-rouge">execute</code> 」方法名称</p><li><p>选择执行的部署作业：选择「 <code class="language-plaintext highlighter-rouge">上端</code> 」</p><li><p>选取活动来源：选择「 <code class="language-plaintext highlighter-rouge">时间驱动</code> 」</p><li><p>选取时间型触发条件类型：选择你想要的触发频率</p><li><p>选取时段：选择你想要每日自动触发的时间</p><li><p>如果执行失败…通知信件的频率设定</p><li><p>储存</p></ol><blockquote><p><strong><em>完成！这样时间到就会自动执行啰。</em></strong> 🎉🎉🎉</p></blockquote><h3 id="延伸作业"><span class="me-2">延伸作业</span><a href="#延伸作业" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>其他数据如 新使用者数、来源媒介等，同样使用前面程式码就能达成，这边就不在重复赘述，就当成给大家的回家作业啰。</p><p>有任何问题及指教欢迎 <a href="https://www.zhgchg.li/contact" target="_blank">与我联络</a> 。</p><hr /><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=🍺&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a><br /></p><blockquote class="prompt-info"><p>本文首次发表于 Medium (<a href="https://medium.com/p/1e85b8df2348" target="_blank"><strong>点击查看原始版本</strong></a>)，由 <a href="/posts/tools/medium-to-jekyll/" target="_blank">ZMediumToMarkdown</a> 提供自动转换与同步技术。</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/zh-cn/zmediumtomarkdown/2024-10-20-1e85b8df2348.md" target="_blank">Improve this page on Github.</a></p></blockquote><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1K+ Followers</span></a></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-robotic-process-automation/">ZRealm Robotic Process Automation</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/simplified-chinese/" class="post-tag no-text-decoration" >simplified-chinese</a> <a href="/tags/automation/" class="post-tag no-text-decoration" >automation</a> <a href="/tags/google-apps-script/" class="post-tag no-text-decoration" >google-apps-script</a> <a href="/tags/telegram/" class="post-tag no-text-decoration" >telegram</a> <a href="/tags/google-analytics/" class="post-tag no-text-decoration" >google-analytics</a> <a href="/tags/rpa-solutions/" class="post-tag no-text-decoration" >rpa-solutions</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=GA4%20%E8%87%AA%E5%8A%A8%E6%95%B0%E6%8D%AE%E9%80%9A%E7%9F%A5%E6%9C%BA%E5%99%A8%E4%BA%BA%EF%BD%9C3%20%E6%AD%A5%E9%AA%A4%E7%94%A8%20Google%20Apps%20Script%20%E4%B8%B2%E6%8E%A5%20Telegram%20Bot%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-robotic-process-automation%2Fzh-cn%2Fga4-%25E8%2587%25AA%25E5%258A%25A8%25E6%2595%25B0%25E6%258D%25AE%25E9%2580%259A%25E7%259F%25A5%25E6%259C%25BA%25E5%2599%25A8%25E4%25BA%25BA-3-%25E6%25AD%25A5%25E9%25AA%25A4%25E7%2594%25A8-google-apps-script-%25E4%25B8%25B2%25E6%258E%25A5-telegram-bot-1e85b8df2348%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=GA4%20%E8%87%AA%E5%8A%A8%E6%95%B0%E6%8D%AE%E9%80%9A%E7%9F%A5%E6%9C%BA%E5%99%A8%E4%BA%BA%EF%BD%9C3%20%E6%AD%A5%E9%AA%A4%E7%94%A8%20Google%20Apps%20Script%20%E4%B8%B2%E6%8E%A5%20Telegram%20Bot%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-robotic-process-automation%2Fzh-cn%2Fga4-%25E8%2587%25AA%25E5%258A%25A8%25E6%2595%25B0%25E6%258D%25AE%25E9%2580%259A%25E7%259F%25A5%25E6%259C%25BA%25E5%2599%25A8%25E4%25BA%25BA-3-%25E6%25AD%25A5%25E9%25AA%25A4%25E7%2594%25A8-google-apps-script-%25E4%25B8%25B2%25E6%258E%25A5-telegram-bot-1e85b8df2348%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-robotic-process-automation%2Fzh-cn%2Fga4-%25E8%2587%25AA%25E5%258A%25A8%25E6%2595%25B0%25E6%258D%25AE%25E9%2580%259A%25E7%259F%25A5%25E6%259C%25BA%25E5%2599%25A8%25E4%25BA%25BA-3-%25E6%25AD%25A5%25E9%25AA%25A4%25E7%2594%25A8-google-apps-script-%25E4%25B8%25B2%25E6%258E%25A5-telegram-bot-1e85b8df2348%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/en/line-bank-to-firstrade-transfer-fast-deposit-150-nt-fee-guide-with-account-upgrade-fee-subsidy-e4d139fe0685/">LINE Bank to Firstrade Transfer｜Fast Deposit & 150 NT Fee Guide with Account Upgrade & Fee Subsidy</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/zh-cn/line-bank-%E5%85%A5%E9%87%91-firstrade-%E6%95%99%E5%AD%A6-%E5%BF%AB%E9%80%9F%E5%88%B0%E5%B8%90-%E4%BD%8E%E6%89%8B%E7%BB%AD%E8%B4%B9150%E5%85%83-%E5%B8%90%E6%88%B7%E5%8D%87%E7%BA%A7%E4%B8%8E%E6%89%8B%E7%BB%AD%E8%B4%B9%E8%A1%A5%E5%8A%A9%E7%94%B3%E8%AF%B7%E5%85%A8%E6%94%BB%E7%95%A5-e4d139fe0685/">手把手教学 — LINE Bank 入金 Firstrade 快速到帐、手续费只要 150 元及帐户升级/约定转帐/手续费补助申请教学</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/line-bank-%E5%85%A5%E9%87%91-firstrade-%E6%95%99%E5%AD%B8-%E5%BF%AB%E9%80%9F%E5%88%B0%E5%B8%B3-%E4%BD%8E%E6%89%8B%E7%BA%8C%E8%B2%BB150%E5%85%83-%E5%B8%B3%E6%88%B6%E5%8D%87%E7%B4%9A%E8%88%87%E6%89%8B%E7%BA%8C%E8%B2%BB%E8%A3%9C%E5%8A%A9%E7%94%B3%E8%AB%8B%E5%85%A8%E6%94%BB%E7%95%A5-e4d139fe0685/">手把手教學 — LINE Bank 入金 Firstrade 快速到帳、手續費只要 150 元及帳戶升級/約定轉帳/手續費補助申請教學</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/en/japan-overseas-shopping-rakuten-consolidated-shipping-for-taiwan-buy-from-rakuten-amazon-bea62c251f1b/">Japan Overseas Shopping｜Rakuten Consolidated Shipping for Taiwan｜Buy from Rakuten & Amazon</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/zh-cn/%E6%97%A5%E6%9C%AC%E4%B9%90%E5%A4%A9%E9%9B%86%E8%BF%90%E6%95%99%E5%AD%A6-%E5%BF%AB%E9%80%9F%E8%B4%AD%E4%B9%B0horie%E9%92%9B%E6%9D%AF%E4%B8%8Eamazon%E5%95%86%E5%93%81%E5%AF%84%E9%80%81%E5%8F%B0%E6%B9%BE%E5%85%A8%E6%94%BB%E7%95%A5-bea62c251f1b/">日本海外购物寄送台湾教学 — 使用乐天集运购买乐天拍卖与 Amazon 商品 (Horie 钛杯)</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">章節 (Chapters)🔖</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-robotic-process-automation/ga4-%E8%87%AA%E5%8B%95%E6%95%B8%E6%93%9A%E9%80%9A%E7%9F%A5%E6%A9%9F%E5%99%A8%E4%BA%BA-3-%E6%AD%A5%E9%A9%9F%E7%94%A8-google-apps-script-%E4%B8%B2%E6%8E%A5-telegram-bot-1e85b8df2348/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1729412392" data-df="ll" > Oct 20, 2024 </time><h4 class="pt-0 my-2">簡單 3 步驟 — 打造免費 GA4 自動數據通知機器人</h4><div class="text-muted"><p>使用 Google Apps Script 完成 RPA，自行串接 GA4 + Telegram Bot 數據通知機器人</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-robotic-process-automation/en/ga4-data-alerts-automation-3-step-guide-to-build-free-telegram-bot-notifications-1e85b8df2348/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1729412392" data-df="ll" > Oct 20, 2024 </time><h4 class="pt-0 my-2">GA4 Data Alerts Automation｜3-Step Guide to Build Free Telegram Bot Notifications</h4><div class="text-muted"><p>Discover how to automate GA4 data notifications using Google Apps Script in 3 simple steps. Eliminate manual monitoring with a free Telegram Bot that delivers real-time insights, boosting your data...</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-robotic-process-automation/zh-cn/line-notify-%E5%BF%AB%E9%80%9F%E7%A7%BB%E8%BD%AC-telegram-bot-10-%E5%88%86%E9%92%9F%E5%AE%8C%E6%88%90%E4%B8%AA%E4%BA%BA%E9%80%9A%E7%9F%A5%E6%9C%8D%E5%8A%A1%E5%88%87%E6%8D%A2-6922e90ba90c/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1728738646" data-df="ll" > Oct 12, 2024 </time><h4 class="pt-0 my-2">Line Notify 快速移转 Telegram Bot｜10 分钟完成个人通知服务切换</h4><div class="text-muted"><p>面对 Line Notify 即将终止服务，教你用 10 分钟快速将通知系统切换到免费且功能更强大的 Telegram Bot，实现多群组分类、丰富讯息格式与互动指令，提升通知管理效率与使用体验。</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-robotic-process-automation/en/ga4-data-alerts-automation-3-step-guide-to-build-free-telegram-bot-notifications-1e85b8df2348/" class="btn btn-outline-primary" aria-label="Older" ><p>GA4 Data Alerts Automation｜3-Step Guide to Build Free Telegram Bot Notifications</p></a> <a href="/posts/zrealm-robotic-process-automation/ga4-%E8%87%AA%E5%8B%95%E6%95%B8%E6%93%9A%E9%80%9A%E7%9F%A5%E6%A9%9F%E5%99%A8%E4%BA%BA-3-%E6%AD%A5%E9%A9%9F%E7%94%A8-google-apps-script-%E4%B8%B2%E6%8E%A5-telegram-bot-1e85b8df2348/" class="btn btn-outline-primary" aria-label="Newer" ><p>簡單 3 步驟 — 打造免費 GA4 自動數據通知機器人</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span> <a href="/">中文</a>|<a href="/tags/simplified-chinese">简中</a>|<a href="/tags/english/">English</a></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a> <br/></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
