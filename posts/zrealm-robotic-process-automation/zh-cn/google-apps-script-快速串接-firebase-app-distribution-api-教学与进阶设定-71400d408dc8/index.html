<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Google Apps Script｜快速串接 Firebase App Distribution API 教学与进阶设定" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="解决 Google Apps Script 串接 Firebase App Distribution API 权限与 GCP 专案设定问题，掌握 OAuthScopes、进阶服务启用步骤，10 行程式码轻松完成下载连结整合，提升 CI/CD 自动化效率。" /><meta property="og:description" content="解决 Google Apps Script 串接 Firebase App Distribution API 权限与 GCP 专案设定问题，掌握 OAuthScopes、进阶服务启用步骤，10 行程式码轻松完成下载连结整合，提升 CI/CD 自动化效率。" /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-robotic-process-automation/zh-cn/google-apps-script-%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5-firebase-app-distribution-api-%E6%95%99%E5%AD%A6%E4%B8%8E%E8%BF%9B%E9%98%B6%E8%AE%BE%E5%AE%9A-71400d408dc8/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-robotic-process-automation/zh-cn/google-apps-script-%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5-firebase-app-distribution-api-%E6%95%99%E5%AD%A6%E4%B8%8E%E8%BF%9B%E9%98%B6%E8%AE%BE%E5%AE%9A-71400d408dc8/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/71400d408dc8/1*O6JWKIIS5oxyrOS3q9NXRQ.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-03-20T22:12:48+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/71400d408dc8/1*O6JWKIIS5oxyrOS3q9NXRQ.webp" /><meta property="twitter:title" content="Google Apps Script｜快速串接 Firebase App Distribution API 教学与进阶设定" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://medium.com/@zhgchgli/"},"dateModified":"2025-07-10T21:00:24+08:00","datePublished":"2025-03-20T22:12:48+08:00","description":"解决 Google Apps Script 串接 Firebase App Distribution API 权限与 GCP 专案设定问题，掌握 OAuthScopes、进阶服务启用步骤，10 行程式码轻松完成下载连结整合，提升 CI/CD 自动化效率。","headline":"Google Apps Script｜快速串接 Firebase App Distribution API 教学与进阶设定","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+","url":"https://zhgchg.li/assets/71400d408dc8/1*O6JWKIIS5oxyrOS3q9NXRQ.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-robotic-process-automation/zh-cn/google-apps-script-%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5-firebase-app-distribution-api-%E6%95%99%E5%AD%A6%E4%B8%8E%E8%BF%9B%E9%98%B6%E8%AE%BE%E5%AE%9A-71400d408dc8/"},"url":"https://zhgchg.li/posts/zrealm-robotic-process-automation/zh-cn/google-apps-script-%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5-firebase-app-distribution-api-%E6%95%99%E5%AD%A6%E4%B8%8E%E8%BF%9B%E9%98%B6%E8%AE%BE%E5%AE%9A-71400d408dc8/"}</script><title>Google Apps Script｜快速串接 Firebase App Distribution API 教学与进阶设定 | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script><link rel="alternate" hreflang="en" href="/posts/zrealm-robotic-process-automation/en/google-apps-script-fast-integration-with-google-apis-using-firebase-app-distribution-api-71400d408dc8/"><link rel="alternate" hreflang="zh-Hant" href="/posts/zrealm-robotic-process-automation/google-apps-script-%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5-firebase-app-distribution-api-%E6%95%99%E5%AD%B8%E8%88%87%E9%80%B2%E9%9A%8E%E8%A8%AD%E5%AE%9A-71400d408dc8/"><link rel="alternate" hreflang="x-default" href="/posts/zrealm-robotic-process-automation/zh-cn/google-apps-script-%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5-firebase-app-distribution-api-%E6%95%99%E5%AD%A6%E4%B8%8E%E8%BF%9B%E9%98%B6%E8%AE%BE%E5%AE%9A-71400d408dc8/"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0">An iOS, web, and automation developer from Taiwan 🇹🇼 who also loves sharing, traveling, and writing.</p><a href="https://medium.com/@zhgchgli" target="_blank" style="display: block;text-align: center;font-style: normal;/* text-decoration: underline; */font-size: 1.2em;color: var(--heading-color);">1K+ Followers on Medium</a></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/english/" class="nav-link"> <i class="fa-fw fa fa-solid fa-language"></i> <span>ENGLISH POSTS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Google Apps Script｜快速串接 Firebase App Distribution API 教学与进阶设定</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Google Apps Script｜快速串接 Firebase App Distribution API 教学与进阶设定</h1><p class="post-desc fw-light mb-4">解决 Google Apps Script 串接 Firebase App Distribution API 权限与 GCP 专案设定问题，掌握 OAuthScopes、进阶服务启用步骤，10 行程式码轻松完成下载连结整合，提升 CI/CD 自动化效率。</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1742479968" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Mar 20, 2025 </time> </span> <span> Updated <time data-ts="1752152424" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jul 10, 2025 </time> </span><div class="mt-3 mb-3"> <a href="/assets/71400d408dc8/1*O6JWKIIS5oxyrOS3q9NXRQ.webp" class="popup img-link preview-img blur"><img data-src="/assets/71400d408dc8/1*O6JWKIIS5oxyrOS3q9NXRQ.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></div><div class="d-flex justify-content-between"> <span style="display: inline-flex; align-items: center; gap: 4px;"> By <em> <a href="https://medium.com/@zhgchgli/">ZhgChgLi</a> </em> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" style="display: block; "><path fill="#007bff" d="M271.2 56C265.1 49.8 256.2 47.3 247.8 49.6C239.4 51.9 232.9 58.4 230.8 66.8L215.5 127C214.4 131.4 209.9 134 205.6 132.7L145.8 115.9C137.4 113.5 128.4 115.9 122.3 122C116.2 128.1 113.8 137.1 116.2 145.5L133.1 205.3C134.3 209.6 131.7 214.1 127.4 215.2L67.1 230.5C58.7 232.6 52.1 239.2 49.8 247.6C47.5 256 50 264.9 56.2 271L100.7 314.3C103.9 317.4 103.9 322.6 100.7 325.8L56.3 369.1C50.1 375.2 47.6 384.1 49.9 392.5C52.2 400.9 58.8 407.4 67.2 409.6L127.4 424.9C131.8 426 134.4 430.5 133.1 434.8L116.2 494.5C113.8 502.9 116.2 511.9 122.3 518C128.4 524.1 137.4 526.5 145.8 524.1L205.6 507.2C209.9 506 214.4 508.6 215.5 512.9L230.8 573.1C232.9 581.5 239.5 588.1 247.9 590.4C256.3 592.7 265.2 590.2 271.3 584L314.6 539.5C317.7 536.3 322.9 536.3 326.1 539.5L369.3 584C375.4 590.2 384.3 592.7 392.7 590.4C401.1 588.1 407.6 581.5 409.8 573.1L425.1 513C426.2 508.6 430.7 506 435 507.3L494.8 524.2C503.2 526.6 512.2 524.2 518.3 518.1C524.4 512 526.8 503 524.4 494.6L507.5 434.8C506.3 430.5 508.9 426 513.2 424.9L573.4 409.6C581.8 407.5 588.4 400.9 590.7 392.5C593 384.1 590.5 375.1 584.3 369.1L539.8 325.8C536.6 322.7 536.6 317.5 539.8 314.3L584.3 271C590.5 264.9 593 256 590.7 247.6C588.4 239.2 581.8 232.7 573.4 230.5L513.2 215.2C508.8 214.1 506.2 209.6 507.5 205.3L524.4 145.5C526.8 137.1 524.4 128.1 518.3 122C512.2 115.9 503.2 113.5 494.8 115.9L435 132.8C430.7 134 426.2 131.4 425.1 127.1L409.8 66.8C407.7 58.4 401.1 51.8 392.7 49.5C384.3 47.2 375.4 49.7 369.3 55.9L326 100.5C322.9 103.7 317.7 103.7 314.5 100.5L271.2 56z"/><path d="M250 330 l60 60 100 -140" stroke="#ffffff" stroke-width="40" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1845 words" > <em>10 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Google Apps Script｜快速串接 Firebase App Distribution API 教学与进阶设定</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">章節 (Chapters)🔖</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Google Apps Script｜快速串接 Firebase App Distribution API 教学与进阶设定</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><blockquote class="prompt-tip"><p><a href="/posts/zrealm-robotic-process-automation/en/google-apps-script-fast-integration-with-google-apis-using-firebase-app-distribution-api-71400d408dc8/"><strong>Click here</strong></a> to view the English version of this article.</p></blockquote><blockquote class="prompt-tip"><p><a href="/posts/zrealm-robotic-process-automation/google-apps-script-%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5-firebase-app-distribution-api-%E6%95%99%E5%AD%B8%E8%88%87%E9%80%B2%E9%9A%8E%E8%A8%AD%E5%AE%9A-71400d408dc8/"><strong>點擊這裡</strong></a>查看本文章正體中文版本。</p></blockquote><blockquote class="prompt-info"><p>基于 SEO 考量，本文标题与描述经 AI 调整，原始版本请参考内文。</p></blockquote><hr /><h3 id="google-apps-script-x-google-apis-快速串接整合方式"><span class="me-2">Google Apps Script x Google APIs 快速串接整合方式</span><a href="#google-apps-script-x-google-apis-快速串接整合方式" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>以 Google Apps Script x Firebase App Distribution API 串接为例</p><h3 id="背景"><span class="me-2">背景</span><a href="#背景" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>之前写了之前写了好几篇关于使用 Google Apps Script 的文章，其中「 <a href="/posts/zrealm-robotic-process-automation/zh-cn/google-apps-script-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E6%95%B0%E6%8D%AE%E6%8A%A5%E8%A1%A8%E8%87%AA%E5%8A%A8%E5%8C%96-rpa-%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5-google-analytics-%E4%B8%8E-google-sheet-f6713ba3fee3/">使用 Google Apps Script 实现每日数据报表 RPA 自动化</a> 」、「 <a href="/posts/zrealm-robotic-process-automation/zh-cn/ga4-%E8%87%AA%E5%8A%A8%E6%95%B0%E6%8D%AE%E9%80%9A%E7%9F%A5%E6%9C%BA%E5%99%A8%E4%BA%BA-3-%E6%AD%A5%E9%AA%A4%E7%94%A8-google-apps-script-%E4%B8%B2%E6%8E%A5-telegram-bot-1e85b8df2348/">简单 3 步骤 — 打造免费 GA4 自动数据通知机器人</a> 」介绍了如何使用 Google Apps Script 串接 Google Analytics 和 Google Sheet, Web App, Slack, Telegram… 快速建置可视化数据中台及通知服务；另外上个月发的文章「 <a href="/posts/zrealm-dev/zh-cn/google-apps-script-web-app-%E6%89%93%E9%80%A0-github-action-ci-cd-%E8%87%AA%E8%AE%A2%E8%A1%A8%E5%8D%95%E6%8F%90%E5%8D%87%E5%BC%80%E5%8F%91%E6%95%88%E7%8E%87-4cb4437818f2/">使用 Google Apps Script Web App 表单串接 Github Action CI/CD 工作</a> 」则是直接使用 Google Apps Script Web App 串接 Github API 作为 CI/CD GUI 表单服务；以上要马是直接使用 Google Apps Script 内建的服务进行串接或是直接串接外部服务 (Slack, Github…) 都没碰到需要串接 Google APIs 的场景。</p><blockquote><p><em>这次在优化 CI/CD GUI 表单时希望打包内测版后能在 Web App 上直接显示 Firebase Distribution 下载连结，这块就只能串接 Google APIs 才能达成。</em></p></blockquote><h4 id="google-apps-script-x-firebase-app-distribution-api-v1"><span class="me-2">Google Apps Script x <a href="https://firebase.google.com/docs/reference/app-distribution/rest/" target="_blank">Firebase App Distribution API v1</a></span><a href="#google-apps-script-x-firebase-app-distribution-api-v1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/71400d408dc8/1*O6JWKIIS5oxyrOS3q9NXRQ.webp" class="popup img-link blur"><img data-src="/assets/71400d408dc8/1*O6JWKIIS5oxyrOS3q9NXRQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NzEiIGhlaWdodD0iNzQwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>如上图，与以往串接 Google Analytics 有内建服务「AnalyticsData」不同，Firebase App Distribution 并没有提供内建串接服务，所以要用进阶方式进行串接。</p><blockquote><p><em>本来以为要自行使用 Service Account 完成 Access Token 产生、交换（有点麻烦，可参考我之前的 <a href="https://github.com/ZhgChgLi/ZReviewTender/blob/main/lib/GoogleAPI.rb" target="_blank">评价机器人开源专案</a> ）， <strong>但其实不用这么麻烦。</strong></em></p></blockquote><h3 id="google-apps-script-x-google-apis-进阶服务串接"><span class="me-2">Google Apps Script x Google APIs 进阶服务串接</span><a href="#google-apps-script-x-google-apis-进阶服务串接" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="串接设定"><span class="me-2">串接设定</span><a href="#串接设定" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><strong>参考 <a href="https://developers.google.com/apps-script/guides/services/advanced?hl=zh-tw#requirements" target="_blank">官方文件描述</a> ，我们需要照以下步骤进行进阶设定：</strong></p><ol><li><p>您必须在指令码专案中 <a href="https://developers.google.com/apps-script/guides/services/advanced?hl=zh-tw#enable_advanced_services" target="_blank">启用进阶服务</a> 。</p><li><p>您必须确认在指令码使用的 <a href="https://developers.google.com/apps-script/guides/cloud-platform-projects?hl=zh-tw" target="_blank">Cloud Platform (GCP) 专案</a> 中，已启用对应进阶服务的 API。</p><li><p>如果指令码专案使用的是 2019 年 4 月 8 日当天或之后建立的 <a href="https://developers.google.com/apps-script/guides/cloud-platform-projects?hl=zh-tw#default_cloud_platform_projects" target="_blank">预设 GCP 专案</a> ，您启用进阶服务并储存指令码专案后，API 就会自动启用。如果您尚未同意，系统可能也会要求您同意《 <a href="https://cloud.google.com/terms/?hl=zh-tw" target="_blank">Google Cloud</a> 》和《 <a href="https://developers.google.com/terms?hl=zh-tw" target="_blank">Google API</a> 》服务条款。</p><li><p>如果指令码专案使用 <a href="https://developers.google.com/apps-script/guides/cloud-platform-projects?hl=zh-tw#standard_cloud_platform_projects" target="_blank">标准 GCP 专案</a> 或较旧的预设 GCP 专案，您必须手动在 GCP 专案中 <a href="https://developers.google.com/apps-script/guides/cloud-platform-projects?hl=zh-tw#enabling_an_api_in_a_standard_gcp_project" target="_blank">启用进阶服务的对应 API</a> 。您必须具备 GCP 专案的编辑权限，才能进行这项变更。</p></ol><h4 id="1-专案设定-设定关联的-google-cloud-platform-gcp-专案"><span class="me-2">1. 专案设定 —设定关联的 Google Cloud Platform (GCP) 专案</span><a href="#1-专案设定-设定关联的-google-cloud-platform-gcp-专案" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Google Apps Script x Google APIs 进阶服务串接会需要你建立 GCP 专案并关联到 Google Apps Script，Google APIs 使用权限是依照 GCP 设定。</p><p>因此你需要建立一个 GCP 专案(同 Firebase GCP 专案亦可)，记下资讯主页的「 <code class="language-plaintext highlighter-rouge">专案编号</code> 」并确定这个 GCP 专案有启用你想使用的 Google APIs 及当前登入帐号或欲使用的帐号是有该 GCP 专案、Google APIs 权限。</p><p><a href="/assets/71400d408dc8/1*-BlhyGAEtkcDRrZ86H2BHg.webp" class="popup img-link blur"><img data-src="/assets/71400d408dc8/1*-BlhyGAEtkcDRrZ86H2BHg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDEzIiBoZWlnaHQ9Ijc2NyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/71400d408dc8/1*fycqt1HNNO9qiu6RZ-WMlw.webp" class="popup img-link blur"><img data-src="/assets/71400d408dc8/1*fycqt1HNNO9qiu6RZ-WMlw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MTIiIGhlaWdodD0iODcxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><blockquote><p><strong><em>本文以「 <a href="https://firebase.google.com/docs/reference/app-distribution/rest/" target="_blank">Firebase App Distribution API</a> 」为例。</em></strong></p></blockquote><p><a href="/assets/71400d408dc8/1*T13M_lq7z-ui0_cLZtuHXg.webp" class="popup img-link blur"><img data-src="/assets/71400d408dc8/1*T13M_lq7z-ui0_cLZtuHXg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NjkiIGhlaWdodD0iODMwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>将 <code class="language-plaintext highlighter-rouge">专案编号</code> 输入到 Goolge Apps Script 专案设定下方的 Google Cloud Platform 专案编号中，当前登入帐号有该 GCP 专案权限就能自动绑定设定成功。</p><h4 id="2-专案设定--启用-在编辑器中显示appsscriptjson资讯清单档案"><span class="me-2">2. 专案设定 — 启用 在编辑器中显示「appsscript.json」资讯清单档案</span><a href="#2-专案设定--启用-在编辑器中显示appsscriptjson资讯清单档案" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/71400d408dc8/1*YnhdxRSyr_CYB2CFnO_31Q.webp" class="popup img-link blur"><img data-src="/assets/71400d408dc8/1*YnhdxRSyr_CYB2CFnO_31Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NjUiIGhlaWdodD0iNDk4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>启用后回到编辑器，档案列表就会出现「 <code class="language-plaintext highlighter-rouge">appsscript.json</code> 」设定档：</p><p><a href="/assets/71400d408dc8/1*r8bheyYWj-TX7vFIum2GIQ.webp" class="popup img-link blur"><img data-src="/assets/71400d408dc8/1*r8bheyYWj-TX7vFIum2GIQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NDUiIGhlaWdodD0iMzU4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>确保 oauthScopes 中包含以下两个描述设定：</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="w">  </span><span class="nl">"oauthScopes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"https://www.googleapis.com/auth/script.external_request"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"https://www.googleapis.com/auth/cloud-platform"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span></pre></table></code></div></div><p>如果没有请手动贴上储存。</p><h4 id="3撰写串接程式码"><span class="me-2">3.撰写串接程式码</span><a href="#3撰写串接程式码" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>设定好 GCP 专案之后我们就能开始撰写串接程式码，直接参考想串接的 Google APIs 官方文件， <a href="https://firebase.google.com/docs/reference/app-distribution/rest/" target="_blank">Firebase App Distribution API v1</a> ：</p><p><a href="/assets/71400d408dc8/1*N0Zg4TEZQwTTLGCsaTdx8A.webp" class="popup img-link blur"><img data-src="/assets/71400d408dc8/1*N0Zg4TEZQwTTLGCsaTdx8A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjExOTMiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">project</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">projects/[Firebase Project ID]/apps/[Firebase APP ID]</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// 请换成你的 Project ID &amp; App ID</span>

<span class="kd">function</span> <span class="nf">debug</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">releases</span> <span class="o">=</span> <span class="nf">firebaseDistribution</span><span class="p">(</span><span class="dl">""</span><span class="p">);</span>

  <span class="nx">releases</span><span class="p">.</span><span class="nf">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">release</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Release Object: https://firebase.google.com/docs/reference/app-distribution/rest/v1/projects.apps.releases?hl=zh-tw#Release</span>
    <span class="nx">Logger</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">release</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s2"> Download URL: </span><span class="p">${</span><span class="nx">release</span><span class="p">.</span><span class="nx">testingUri</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nf">firebaseDistribution</span><span class="p">(</span><span class="nx">releaseNote</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://firebaseappdistribution.googleapis.com/v1/</span><span class="dl">"</span><span class="o">+</span><span class="nx">project</span><span class="o">+</span><span class="dl">"</span><span class="s2">/releases?filter=releaseNotes.text%3D*</span><span class="dl">"</span><span class="o">+</span><span class="nx">releaseNote</span><span class="o">+</span><span class="dl">"</span><span class="s2">*</span><span class="dl">"</span><span class="p">;</span>
  <span class="c1">// Filter: https://firebase.google.com/docs/reference/app-distribution/rest/v1/projects.apps.releases/list?hl=zh-tw</span>
  <span class="kd">const</span> <span class="nx">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">application/json; charset=UTF-8</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">Authorization</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Bearer </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">ScriptApp</span><span class="p">.</span><span class="nf">getOAuthToken</span><span class="p">(),</span> <span class="c1">// 直接使用当前帐号换取权杖</span>
  <span class="p">};</span>
  
  <span class="kd">const</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">method</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">get</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">headers</span><span class="dl">"</span><span class="p">:</span> <span class="nx">headers</span>
  <span class="p">};</span>
  <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nf">getContentText</span><span class="p">()).</span><span class="nx">releases</span><span class="p">;</span>
  
  <span class="k">if </span><span class="p">(</span><span class="nx">result</span> <span class="o">==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">[];</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">[Firebase Project ID]</code> <strong>与 <code class="language-plaintext highlighter-rouge">[Firebase APP ID]</code> 可在 Firebase 专案设定中取得：</strong></p><p><a href="/assets/71400d408dc8/1*oql_FnmO7_ct8S3cOhP8lg.webp" class="popup img-link blur"><img data-src="/assets/71400d408dc8/1*oql_FnmO7_ct8S3cOhP8lg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjEwNTEiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>贴上程式码后，第一次执行需要完成权限授权。</p><p><a href="/assets/71400d408dc8/1*sW3ZjQA3dKS8HhAOCDsmBA.webp" class="popup img-link blur"><img data-src="/assets/71400d408dc8/1*sW3ZjQA3dKS8HhAOCDsmBA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTI1IiBoZWlnaHQ9IjY0NyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/71400d408dc8/0*p-Zl0cob4mPrsNO6.webp" class="popup img-link blur"><img data-src="/assets/71400d408dc8/0*p-Zl0cob4mPrsNO6.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MDAiIGhlaWdodD0iNTU3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li><p>点击「审查权限」</p><li><p>选择要执行的身份帐户，通常等于当前 Google Apps Script 帐户</p></ul><p><a href="/assets/71400d408dc8/0*m7enb51ZiNlWYeoT.webp" class="popup img-link blur"><img data-src="/assets/71400d408dc8/0*m7enb51ZiNlWYeoT.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MDAiIGhlaWdodD0iNTU3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/71400d408dc8/0*SN-0owiePlKXIxLk.webp" class="popup img-link blur"><img data-src="/assets/71400d408dc8/0*SN-0owiePlKXIxLk.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MDAiIGhlaWdodD0iNTU3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li><p>选择「进阶」展开 -&gt; 点击「前往 XXX」 这是我们自己写给自己用的应用程式，不需经过 Google 验证。</p><li><p>点击「允许」</p></ul><blockquote><p><em>以上画面不一定会出现，没有可忽略。</em></p></blockquote><p><strong>允许之后再点「侦错」或「执行」就能执行程式：</strong></p><p>如果出现错误：</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nc">Exception</span><span class="o">:</span> <span class="nc">Request</span> <span class="n">failed</span> <span class="k">for</span> <span class="n">https</span><span class="o">://</span><span class="n">firebaseappdistribution</span><span class="mf">.</span><span class="n">googleapis</span><span class="mf">.</span><span class="n">com</span> <span class="n">returned</span> <span class="n">code</span> <span class="mf">403.</span> <span class="nc">Truncated</span> <span class="n">server</span> <span class="n">response</span><span class="o">:</span> <span class="p">{</span>
  <span class="s2">"error"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"code"</span><span class="o">:</span> <span class="mi">403</span><span class="p">,</span>
    <span class="s2">"message"</span><span class="o">:</span> <span class="s2">"Request had insufficient authentication scopes."</span><span class="p">,</span>
    <span class="s2">"status"</span><span class="o">:</span> <span class="s2">"PERMISSION_DENIED"</span><span class="p">,</span>
    <span class="s2">"details"</span><span class="o">:...</span> <span class="p">(</span><span class="kn">use</span> <span class="n">muteHttpExceptions</span> <span class="n">option</span> <span class="n">to</span> <span class="n">examine</span> <span class="n">full</span> <span class="n">response</span><span class="p">)</span>
<span class="mf">...</span>
</pre></table></code></div></div><p>或</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Exception: Specified permissions are not sufficient to call UrlFetchApp.fetch. Required permissions: https://www.googleapis.com/auth/script.external_request
</pre></table></code></div></div><p>请确认 <code class="language-plaintext highlighter-rouge">appsscript.json</code> 的 oauthScopes 中包含以下两个描述设定(参考步骤 2)：</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nl">"oauthScopes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"https://www.googleapis.com/auth/script.external_request"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"https://www.googleapis.com/auth/cloud-platform"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span></pre></table></code></div></div><p>如果出现错误：</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nc">Exception</span><span class="o">:</span> <span class="nc">Request</span> <span class="n">failed</span> <span class="k">for</span> <span class="n">https</span><span class="o">://</span><span class="n">firebaseappdistribution</span><span class="mf">.</span><span class="n">googleapis</span><span class="mf">.</span><span class="n">com</span> <span class="n">returned</span> <span class="n">code</span> <span class="mf">401.</span> <span class="nc">Truncated</span> <span class="n">server</span> <span class="n">response</span><span class="o">:</span> <span class="p">{</span>
  <span class="s2">"error"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"code"</span><span class="o">:</span> <span class="mi">401</span><span class="p">,</span>
    <span class="s2">"message"</span><span class="o">:</span> <span class="s2">"Request had invalid authentication credentials. Expected OAuth 2 access token, login cookie or othe... (use muteHttpExceptions option to examine full response)
</span></pre></table></code></div></div><p>代表尚未设定绑定的 GCP 专案 (参考步骤 1. ) 或是该 GCP 专案尚未启用欲使用的 Google APIs 或是当前帐号无该 GCP / Google APIs 使用权限或无该 Firebase App 权限，请检查设定。</p><p>如果出现错误：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Exception: Request failed for https://firebaseappdistribution.googleapis.com returned code 404. Truncated server response:
</pre></table></code></div></div><p>或</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nc">Exception</span><span class="o">:</span> <span class="nc">Request</span> <span class="n">failed</span> <span class="k">for</span> <span class="n">https</span><span class="o">://</span><span class="n">firebaseappdistribution</span><span class="mf">.</span><span class="n">googleapis</span><span class="mf">.</span><span class="n">com</span> <span class="n">returned</span> <span class="n">code</span> <span class="mf">400.</span> <span class="nc">Truncated</span> <span class="n">server</span> <span class="n">response</span><span class="o">:</span> <span class="p">{</span>
  <span class="s2">"error"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"code"</span><span class="o">:</span> <span class="mi">400</span><span class="p">,</span>
    <span class="s2">"message"</span><span class="o">:</span> <span class="s2">"Request contains an invalid argument."</span><span class="p">,</span>
    <span class="s2">"status"</span><span class="o">:</span> <span class="s2">"INVALID_ARGUMENT"</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>请确认 Google APIs 请求路径是否正确。</p><h4 id="串接成功"><span class="me-2">串接成功🎉🎉🎉</span><a href="#串接成功" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/71400d408dc8/1*9OyoPtblFnGGIBRvlGw10Q.webp" class="popup img-link blur"><img data-src="/assets/71400d408dc8/1*9OyoPtblFnGGIBRvlGw10Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI2IiBoZWlnaHQ9IjQ3NCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>可以看到短短不到 10 行程式码就能无痛串接 Google APIs，真的非常方；有兴趣的朋友可以看一下相较之下， <a href="https://github.com/ZhgChgLi/ZReviewTender/blob/main/lib/GoogleAPI.rb" target="_blank">自己实作</a> Google APIs 串接时身份验证权杖交换的程式步骤，非常繁琐。</p><h4 id="下一步"><span class="me-2">下一步：</span><a href="#下一步" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>搭配之前的文章「 <a href="/posts/zrealm-dev/zh-cn/google-apps-script-web-app-%E6%89%93%E9%80%A0-github-action-ci-cd-%E8%87%AA%E8%AE%A2%E8%A1%A8%E5%8D%95%E6%8F%90%E5%8D%87%E5%BC%80%E5%8F%91%E6%95%88%E7%8E%87-4cb4437818f2/">使用 Google Apps Script Web App 表单串接 Github Action CI/CD 工作</a> 」串上 CI/CD 工作项目，将 Firebase App Distribution 下载连结也呈现在 Web App 上方便同仁直接在上面下载。</p><p><a href="/assets/71400d408dc8/1*nK3H3e3KgHEg8qz-KZ9ZGA.webp" class="popup img-link blur"><img data-src="/assets/71400d408dc8/1*nK3H3e3KgHEg8qz-KZ9ZGA.webp" alt="Demo Result" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3OTciIGhlaWdodD0iNzE2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Demo Result</p><blockquote><p><em>其他 Google APIs 也能以此类推串接。</em></p></blockquote><h3 id="202507-update"><span class="me-2">2025/07 Update:</span><a href="#202507-update" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>此功能已整合到实际打包工具使用，可参考最新文章案例：「 <a href="/posts/zrealm-dev/zh-cn/ci-cd-%E6%89%93%E5%8C%85%E5%B7%A5%E5%85%B7%E5%B9%B3%E5%8F%B0-%E4%BD%BF%E7%94%A8-google-apps-script-web-app-%E4%B8%B2%E6%8E%A5-github-actions-%E6%8F%90%E5%8D%87%E8%B7%A8%E5%9B%A2%E9%98%9F%E6%95%88%E7%8E%87-4273e57e7148/"><strong>CI/CD 实战指南（四）：使用 Google Apps Script Web App 串接 GitHub Actions 建置免费易用的打包工具平台</strong></a> 」</p><p>有任何问题及指教欢迎 <a href="https://www.zhgchg.li/contact" target="_blank">与我联络</a> 。</p><hr /><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=🍺&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a><br /></p><blockquote class="prompt-info"><p>本文首次发表于 Medium (<a href="https://medium.com/p/71400d408dc8" target="_blank"><strong>点击查看原始版本</strong></a>)，由 <a href="/posts/tools/medium-to-jekyll/" target="_blank">ZMediumToMarkdown</a> 提供自动转换与同步技术。</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/zh-cn/zmediumtomarkdown/2025-03-20-71400d408dc8.md" target="_blank">Improve this page on Github.</a></p></blockquote><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1K+ Followers</span></a></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-robotic-process-automation/">ZRealm Robotic Process Automation</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/simplified-chinese/" class="post-tag no-text-decoration" >simplified-chinese</a> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/firebase-app-distribution/" class="post-tag no-text-decoration" >firebase-app-distribution</a> <a href="/tags/google-apps-script/" class="post-tag no-text-decoration" >google-apps-script</a> <a href="/tags/google-api/" class="post-tag no-text-decoration" >google-api</a> <a href="/tags/google-cloud-platform/" class="post-tag no-text-decoration" >google-cloud-platform</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Google%20Apps%20Script%EF%BD%9C%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5%20Firebase%20App%20Distribution%20API%20%E6%95%99%E5%AD%A6%E4%B8%8E%E8%BF%9B%E9%98%B6%E8%AE%BE%E5%AE%9A%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-robotic-process-automation%2Fzh-cn%2Fgoogle-apps-script-%25E5%25BF%25AB%25E9%2580%259F%25E4%25B8%25B2%25E6%258E%25A5-firebase-app-distribution-api-%25E6%2595%2599%25E5%25AD%25A6%25E4%25B8%258E%25E8%25BF%259B%25E9%2598%25B6%25E8%25AE%25BE%25E5%25AE%259A-71400d408dc8%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Google%20Apps%20Script%EF%BD%9C%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5%20Firebase%20App%20Distribution%20API%20%E6%95%99%E5%AD%A6%E4%B8%8E%E8%BF%9B%E9%98%B6%E8%AE%BE%E5%AE%9A%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-robotic-process-automation%2Fzh-cn%2Fgoogle-apps-script-%25E5%25BF%25AB%25E9%2580%259F%25E4%25B8%25B2%25E6%258E%25A5-firebase-app-distribution-api-%25E6%2595%2599%25E5%25AD%25A6%25E4%25B8%258E%25E8%25BF%259B%25E9%2598%25B6%25E8%25AE%25BE%25E5%25AE%259A-71400d408dc8%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-robotic-process-automation%2Fzh-cn%2Fgoogle-apps-script-%25E5%25BF%25AB%25E9%2580%259F%25E4%25B8%25B2%25E6%258E%25A5-firebase-app-distribution-api-%25E6%2595%2599%25E5%25AD%25A6%25E4%25B8%258E%25E8%25BF%259B%25E9%2598%25B6%25E8%25AE%25BE%25E5%25AE%259A-71400d408dc8%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/en/apple-watch-stainless-steel-milanese-loop-unboxing-premium-44mm-graphite-band-review-c0f99f987d9c/">Apple Watch Stainless Steel Milanese Loop Unboxing｜Premium 44mm Graphite Band Review</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/zh-cn/apple-watch-%E7%B1%B3%E5%85%B0%E8%A1%A8%E5%B8%A6%E5%BC%80%E7%AE%B1-%E5%8E%9F%E5%8E%82%E4%B8%8D%E9%94%88%E9%92%A2%E7%9F%B3%E5%A2%A8%E8%89%B2%E4%BC%98%E7%BC%BA%E7%82%B9%E5%85%A8%E8%A7%A3%E6%9E%90-c0f99f987d9c/">Apple Watch 原厂不锈钢米兰表带开箱</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/apple-watch-%E7%B1%B3%E8%98%AD%E9%8C%B6%E5%B8%B6%E9%96%8B%E7%AE%B1-%E5%8E%9F%E5%BB%A0%E4%B8%8D%E9%8F%BD%E9%8B%BC%E7%9F%B3%E5%A2%A8%E8%89%B2%E5%84%AA%E7%BC%BA%E9%BB%9E%E5%85%A8%E8%A7%A3%E6%9E%90-c0f99f987d9c/">Apple Watch 原廠不鏽鋼米蘭錶帶開箱</a><li class="text-truncate lh-lg"> <a href="/posts/travel-journals/en/busan-travel-guide-8-day-itinerary-with-visit-busan-pass-for-seamless-exploration-8ace34a1a3d8/">Busan Travel Guide｜8-Day Itinerary with VISIT BUSAN PASS for Seamless Exploration</a><li class="text-truncate lh-lg"> <a href="/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/zh-cn/%E9%87%9C%E5%B1%B1%E8%87%AA%E7%94%B1%E8%A1%8C%E6%94%BB%E7%95%A5-8%E5%A4%A97%E5%A4%9C%E5%BF%85%E5%8E%BB%E6%99%AF%E7%82%B9-%E7%BE%8E%E9%A3%9F%E4%B8%8E%E4%BA%A4%E9%80%9A%E5%85%A8%E8%A7%A3%E6%9E%90-%E9%87%9C%E5%B1%B1%E9%80%9A%E8%A1%8C%E8%AF%81%E7%9C%81%E9%92%B1%E7%A7%98%E8%AF%80-8ace34a1a3d8/">游记 2025 韩国釜山 8 天 7 夜自由行</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">章節 (Chapters)🔖</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-robotic-process-automation/google-apps-script-%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5-firebase-app-distribution-api-%E6%95%99%E5%AD%B8%E8%88%87%E9%80%B2%E9%9A%8E%E8%A8%AD%E5%AE%9A-71400d408dc8/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1742479968" data-df="ll" > Mar 20, 2025 </time><h4 class="pt-0 my-2">Google Apps Script x Google APIs 快速串接整合方式</h4><div class="text-muted"><p>以 Google Apps Script x Firebase App Distribution API 串接為例</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-robotic-process-automation/en/google-apps-script-fast-integration-with-google-apis-using-firebase-app-distribution-api-71400d408dc8/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1742479968" data-df="ll" > Mar 20, 2025 </time><h4 class="pt-0 my-2">Google Apps Script｜Fast Integration with Google APIs Using Firebase App Distribution API</h4><div class="text-muted"><p>Developers facing complex API integrations can streamline processes by leveraging Google Apps Script with Firebase App Distribution API, achieving faster deployment and simplified management in app...</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/zh-cn/ci-cd-%E6%89%93%E5%8C%85%E5%B7%A5%E5%85%B7%E5%B9%B3%E5%8F%B0-%E4%BD%BF%E7%94%A8-google-apps-script-web-app-%E4%B8%B2%E6%8E%A5-github-actions-%E6%8F%90%E5%8D%87%E8%B7%A8%E5%9B%A2%E9%98%9F%E6%95%88%E7%8E%87-4273e57e7148/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1752150651" data-df="ll" > Jul 10, 2025 </time><h4 class="pt-0 my-2">CI/CD 实战指南（四）：使用 Google Apps Script Web App 串接 GitHub Actions 建置免费易用的打包工具平台</h4><div class="text-muted"><p>GAS Web App 串接 GitHub, Slack, Firebase 或 Asana/Jira API，建置中继站，提供跨团队共用的打包工具平台</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-robotic-process-automation/en/google-apps-script-fast-integration-with-google-apis-using-firebase-app-distribution-api-71400d408dc8/" class="btn btn-outline-primary" aria-label="Older" ><p>Google Apps Script｜Fast Integration with Google APIs Using Firebase App Distribution API</p></a> <a href="/posts/zrealm-robotic-process-automation/google-apps-script-%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5-firebase-app-distribution-api-%E6%95%99%E5%AD%B8%E8%88%87%E9%80%B2%E9%9A%8E%E8%A8%AD%E5%AE%9A-71400d408dc8/" class="btn btn-outline-primary" aria-label="Newer" ><p>Google Apps Script x Google APIs 快速串接整合方式</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span> <a href="/">中文</a>|<a href="/tags/simplified-chinese">简中</a>|<a href="/tags/english/">English</a></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a> <br/></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
