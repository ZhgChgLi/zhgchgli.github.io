<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Slack Workflow｜打造全自動 WFH 員工健康回報系統，結合 Google Sheets 與 App Script 提升效率" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="針對遠距工作團隊，解決健康回報繁瑣填寫與人工追蹤問題，透過 Slack Workflow Form 結合 Google Sheets 與 App Script，自動比對未填寫名單並傳送提醒，節省每日 20 分鐘人力，提升回報準確率與便利性。" /><meta property="og:description" content="針對遠距工作團隊，解決健康回報繁瑣填寫與人工追蹤問題，透過 Slack Workflow Form 結合 Google Sheets 與 App Script，自動比對未填寫名單並傳送提醒，節省每日 20 分鐘人力，提升回報準確率與便利性。" /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-dev/slack-workflow-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8B%95-wfh-%E5%93%A1%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E5%A0%B1%E7%B3%BB%E7%B5%B1-%E7%B5%90%E5%90%88-google-sheets-%E8%88%87-app-script-%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87-d61062833c1a/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-dev/slack-workflow-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8B%95-wfh-%E5%93%A1%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E5%A0%B1%E7%B3%BB%E7%B5%B1-%E7%B5%90%E5%90%88-google-sheets-%E8%88%87-app-script-%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87-d61062833c1a/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-06-14T00:58:21+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.webp" /><meta property="twitter:title" content="Slack Workflow｜打造全自動 WFH 員工健康回報系統，結合 Google Sheets 與 App Script 提升效率" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://www.linkedin.com/in/zhgchgli"},"dateModified":"2024-04-14T00:43:33+08:00","datePublished":"2021-06-14T00:58:21+08:00","description":"針對遠距工作團隊，解決健康回報繁瑣填寫與人工追蹤問題，透過 Slack Workflow Form 結合 Google Sheets 與 App Script，自動比對未填寫名單並傳送提醒，節省每日 20 分鐘人力，提升回報準確率與便利性。","headline":"Slack Workflow｜打造全自動 WFH 員工健康回報系統，結合 Google Sheets 與 App Script 提升效率","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+","url":"https://zhgchg.li/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-dev/slack-workflow-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8B%95-wfh-%E5%93%A1%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E5%A0%B1%E7%B3%BB%E7%B5%B1-%E7%B5%90%E5%90%88-google-sheets-%E8%88%87-app-script-%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87-d61062833c1a/"},"url":"https://zhgchg.li/posts/zrealm-dev/slack-workflow-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8B%95-wfh-%E5%93%A1%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E5%A0%B1%E7%B3%BB%E7%B5%B1-%E7%B5%90%E5%90%88-google-sheets-%E8%88%87-app-script-%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87-d61062833c1a/"}</script><title>Slack Workflow｜打造全自動 WFH 員工健康回報系統，結合 Google Sheets 與 App Script 提升效率 | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=false" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script><link rel="alternate" hreflang="en" href="https://en.zhgchg.li/posts/zrealm-dev/slack-workflow-automate-wfh-employee-health-reporting-with-google-sheets-app-script-d61062833c1a/"><link rel="alternate" hreflang="zh-Hans" href="https://zh-hans.zhgchg.li/posts/zrealm-dev/slack-workflow-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8A%A8-wfh-%E5%91%98%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E6%8A%A5%E7%B3%BB%E7%BB%9F-%E7%BB%93%E5%90%88-google-sheets-%E4%B8%8E-app-script-%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87-d61062833c1a/"><link rel="alternate" hreflang="zh-Hant" href="https://zhgchg.li/posts/zrealm-dev/slack-workflow-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8B%95-wfh-%E5%93%A1%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E5%A0%B1%E7%B3%BB%E7%B5%B1-%E7%B5%90%E5%90%88-google-sheets-%E8%88%87-app-script-%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87-d61062833c1a/"><link rel="alternate" hreflang="x-default" href="https://zhgchg.li/posts/zrealm-dev/slack-workflow-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8B%95-wfh-%E5%93%A1%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E5%A0%B1%E7%B3%BB%E7%B5%B1-%E7%B5%90%E5%90%88-google-sheets-%E8%88%87-app-script-%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87-d61062833c1a/"> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"FAQPage","mainEntity":[{"@type":"Question","name":"如何利用 Slack Workflow 與 Google Sheet 自動化員工健康回報，減少人工比對與提醒時間？","acceptedAnswer":{"@type":"Answer","text":"結合 Slack Workflow Form 直接在 Slack 內填寫健康回報，並用 App Script 將資料分類到 Google Sheet，搭配自動比對未填寫名單與 Slack API 自動標記提醒，大幅減少人力比對與提醒時間，提升整體工作效率。"}},{"@type":"Question","name":"如何在 Slack Workflow Form 中自動帶入填寫者身份並記錄填寫時間？","acceptedAnswer":{"@type":"Answer","text":"透過 Slack Workflow Form 的「Person who submitted form」變數自動帶入填寫者身份，並利用 Google Sheet 中的 App Script 更新隱藏的 Timestamp Sheet 以取得當前時間，再將該時間寫入回應資料，確保填寫時間準確記錄。"}},{"@type":"Question","name":"如何用 Google Apps Script 比對員工名單和當日填寫資料，產生未填寫名單並自動發送 Slack 提醒？","acceptedAnswer":{"@type":"Answer","text":"利用 App Script 讀取員工名單與當日健康回報 Sheet，找出未填寫員工後清除並更新未填寫名單 Sheet，再透過 Slack Incoming Webhook 或 chat.postMessage API 自動組合訊息並標記未填寫成員，發送提醒訊息到指定 Slack Channel。"}},{"@type":"Question","name":"如何將 Slack Channel 的成員名單匯入 Google Sheet 以便健康回報系統管理？","acceptedAnswer":{"@type":"Answer","text":"建立 Slack App 並設定必要 OAuth 權限（如 users:read、channels:read），使用 App Script 呼叫 Slack API conversations.members 與 users.info，取得成員資料與 Email，並自動寫入 Google Sheet 員工名單，方便後續健康回報比對。"}},{"@type":"Question","name":"在 Slack Workflow 中如何避免重複執行 App Script 導致資料錯亂？","acceptedAnswer":{"@type":"Answer","text":"在 App Script 函式開頭設定全域變數標記執行狀態，若已在執行中則跳出提示避免重複執行，函式結束時再重置狀態，確保同一時間只執行一次，避免資料錯亂與資源浪費。"}}]} </script><link rel="stylesheet" href="/assets/css/post-toc.css"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0">An iOS, web, and automation developer from Taiwan 🇹🇼 who also loves sharing, traveling, and writing.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"><div aria-label="Language switch" style="display:flex;align-items:center;justify-content:center;gap:2px"> <a href="https://zhgchg.li" style="display:inline-flex;align-items:center;justify-content:center;padding:6px 10px;border-radius:999px;border:1px solid rgba(220,53,69,.35);background:rgba(220,53,69,.08);color:#dc3545;font-size:12px;font-weight:600;line-height:1;text-decoration:none;"> 正體中文 </a> <span style="width:1px;height:18px;background:rgba(0,0,0,.12);"></span> <a href="https://zh-hans.zhgchg.li" style="display:inline-flex;align-items:center;justify-content:center;padding:6px 10px;border-radius:999px;border:1px solid rgba(220,53,69,.35);background:rgba(220,53,69,.08);color:#dc3545;font-size:12px;font-weight:600;line-height:1;text-decoration:none;"> 简体中文 </a> <span style="width:1px;height:18px;background:rgba(0,0,0,.12);"></span> <a href="https://en.zhgchg.li" style="display:inline-flex;align-items:center;justify-content:center;padding:6px 10px;border-radius:999px;border:1px solid #dc3545;background:#dc3545;color:#fff;font-size:12px;font-weight:600;line-height:1;text-decoration:none;"> English </a></div><li class="nav-item"> <a href="https://medium.com/@zhgchgli" class="nav-link" target="_blank" style="background: #EDF4FF; color: #0A84FF;"> <i class="fa-brands fa-medium"></i> <span>Follow Me!<br/><strong>1,050+</strong> Followers</span> </a><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Slack Workflow｜打造全自動 WFH 員工健康回報系統，結合 Google Sheets 與 App Script 提升效率</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Slack Workflow｜打造全自動 WFH 員工健康回報系統，結合 Google Sheets 與 App Script 提升效率</h1><p class="post-desc fw-light mb-4">針對遠距工作團隊，解決健康回報繁瑣填寫與人工追蹤問題，透過 Slack Workflow Form 結合 Google Sheets 與 App Script，自動比對未填寫名單並傳送提醒，節省每日 20 分鐘人力，提升回報準確率與便利性。</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1623603501" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 14, 2021 </time> </span> <span> Updated <time data-ts="1713026613" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 13, 2024 </time> </span><div class="mt-3 mb-3"> <a href="/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.webp" class="popup img-link preview-img blur"><img data-src="/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></div><div class="d-flex justify-content-between"> <span style="display: inline-flex; align-items: center; gap: 4px;"> By <em> <a href="https://www.linkedin.com/in/zhgchgli">ZhgChgLi</a> </em> | <em><a href="https://www.linkedin.com/in/zhgchgli" target="_blank">Senior Software Engineer</a></em><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" style="display: block; "><path fill="#007bff" d="M271.2 56C265.1 49.8 256.2 47.3 247.8 49.6C239.4 51.9 232.9 58.4 230.8 66.8L215.5 127C214.4 131.4 209.9 134 205.6 132.7L145.8 115.9C137.4 113.5 128.4 115.9 122.3 122C116.2 128.1 113.8 137.1 116.2 145.5L133.1 205.3C134.3 209.6 131.7 214.1 127.4 215.2L67.1 230.5C58.7 232.6 52.1 239.2 49.8 247.6C47.5 256 50 264.9 56.2 271L100.7 314.3C103.9 317.4 103.9 322.6 100.7 325.8L56.3 369.1C50.1 375.2 47.6 384.1 49.9 392.5C52.2 400.9 58.8 407.4 67.2 409.6L127.4 424.9C131.8 426 134.4 430.5 133.1 434.8L116.2 494.5C113.8 502.9 116.2 511.9 122.3 518C128.4 524.1 137.4 526.5 145.8 524.1L205.6 507.2C209.9 506 214.4 508.6 215.5 512.9L230.8 573.1C232.9 581.5 239.5 588.1 247.9 590.4C256.3 592.7 265.2 590.2 271.3 584L314.6 539.5C317.7 536.3 322.9 536.3 326.1 539.5L369.3 584C375.4 590.2 384.3 592.7 392.7 590.4C401.1 588.1 407.6 581.5 409.8 573.1L425.1 513C426.2 508.6 430.7 506 435 507.3L494.8 524.2C503.2 526.6 512.2 524.2 518.3 518.1C524.4 512 526.8 503 524.4 494.6L507.5 434.8C506.3 430.5 508.9 426 513.2 424.9L573.4 409.6C581.8 407.5 588.4 400.9 590.7 392.5C593 384.1 590.5 375.1 584.3 369.1L539.8 325.8C536.6 322.7 536.6 317.5 539.8 314.3L584.3 271C590.5 264.9 593 256 590.7 247.6C588.4 239.2 581.8 232.7 573.4 230.5L513.2 215.2C508.8 214.1 506.2 209.6 507.5 205.3L524.4 145.5C526.8 137.1 524.4 128.1 518.3 122C512.2 115.9 503.2 113.5 494.8 115.9L435 132.8C430.7 134 426.2 131.4 425.1 127.1L409.8 66.8C407.7 58.4 401.1 51.8 392.7 49.5C384.3 47.2 375.4 49.7 369.3 55.9L326 100.5C322.9 103.7 317.7 103.7 314.5 100.5L271.2 56z"/><path d="M250 330 l60 60 100 -140" stroke="#ffffff" stroke-width="40" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="5836 words" > <em>32 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Slack Workflow｜打造全自動 WFH 員工健康回報系統，結合 Google Sheets 與 App Script 提升效率</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Chapters 🔖</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Slack Workflow｜打造全自動 WFH 員工健康回報系統，結合 Google Sheets 與 App Script 提升效率</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><blockquote class="prompt-tip"><p><a href="https://en.zhgchg.li/posts/zrealm-dev/slack-workflow-automate-wfh-employee-health-reporting-with-google-sheets-app-script-d61062833c1a/"><strong>Click here</strong></a> to view the English version of this article.</p></blockquote><blockquote class="prompt-tip"><p><a href="https://zh-hans.zhgchg.li/posts/zrealm-dev/slack-workflow-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8A%A8-wfh-%E5%91%98%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E6%8A%A5%E7%B3%BB%E7%BB%9F-%E7%BB%93%E5%90%88-google-sheets-%E4%B8%8E-app-script-%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87-d61062833c1a/"><strong>点击这里</strong></a>查看本文章简体中文版本。</p></blockquote><blockquote class="prompt-info"><p>基於 SEO 考量，本文標題與描述經 AI 調整，原始版本請參考內文。</p></blockquote><h4 id="zhgchgli-table-of-contents">文章目錄</h4><nav class="zhgchgli-toc"><ul class="zhgchgli-toc-list"><li><a href="#slack-打造全自動-wfh-員工健康狀況回報系統">Slack 打造全自動 WFH 員工健康狀況回報系統</a></li><li class="has-children"><details><summary>前言 <a href="#前言">#</a></summary><ul><li><a href="#我們的-優化前-的-flow">我們的 優化前 的 Flow</a></li><li><a href="#問題點">問題點</a></li><li><a href="#解決方案">解決方案</a></li><li><a href="#優化後-的-flow">優化後 的 Flow</a></li><li><a href="#成效">成效</a></li></ul></details></li><li class="has-children"><details><summary>運作原理 <a href="#運作原理">#</a></summary><ul><li><a href="#身份識別">身份識別</a></li></ul></details></li><li class="has-children"><details><summary>開始動手做 <a href="#開始動手做">#</a></summary><ul><li><a href="#建立健康回報-google-form-表單--連結回覆到-google-sheet">建立健康回報 Google Form 表單 & 連結回覆到 Google Sheet</a></li><li><a href="#建立-slack-workflow-form-填寫入口">建立 Slack Workflow Form 填寫入口</a></li><li><a href="#將-slack-workflow-from-與-google-sheet-串接">將 Slack workflow from 與 Google Sheet 串接</a></li><li><a href="#slack-workflow-from-取得填寫時間">Slack workflow from 取得填寫時間</a></li><li><a href="#slack-workflow-form-增加填寫回執">Slack workflow form 增加填寫回執</a></li></ul></details></li><li class="has-children"><details><summary>Google Sheet with App Script! <a href="#google-sheet-with-app-script">#</a></summary><ul><li><a href="#將-responses-的資料依照填寫日期分發到各日期的-sheet">將 Responses 的資料依照填寫日期分發到各日期的 Sheet</a></li><li><a href="#取得當前日期的-sheet-與員工名單比對產生未填寫名單-sheet-的資料">取得當前日期的 Sheet 與員工名單比對，產生未填寫名單 Sheet 的資料</a></li><li><a href="#讀取未填寫名單-sheet-組合出訊息並發送到指定-slack-channel">讀取未填寫名單 Sheet 組合出訊息並發送到指定 Slack Channel</a></li><li><a href="#匯入員工名單">匯入員工名單</a></li><li><a href="#手動新增新員工資料">手動新增新員工資料</a></li></ul></details></li><li><a href="#done">DONE！</a></li><li><a href="#補充">補充</a></li><li><a href="#與-ios-開發相關的應用">與 iOS 開發相關的應用</a></li><li><a href="#延伸閱讀">延伸閱讀</a></li></ul></nav><hr /><h3 id="slack-打造全自動-wfh-員工健康狀況回報系統"><span class="me-2">Slack 打造全自動 WFH 員工健康狀況回報系統</span><a href="#slack-打造全自動-wfh-員工健康狀況回報系統" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>玩轉 Slack Workflow 搭配 Google Sheet with App Script 增加工作效率</p><p><a href="/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.webp" alt="Photo by [Stephen Phillips — Hostreviews.co.uk](https://unsplash.com/@hostreviews?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjgwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Photo by <a href="https://unsplash.com/@hostreviews?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank">Stephen Phillips — Hostreviews.co.uk</a></p><h3 id="前言"><span class="me-2">前言</span><a href="#前言" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>因應全面居家工作，公司關心所有成員的健康，每日均需回報身體有無狀況並由 People Operations 統一紀錄管理。</p><h4 id="我們的-優化前-的-flow"><span class="me-2">我們的 優化前 的 Flow</span><a href="#我們的-優化前-的-flow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/d61062833c1a/1*brnD44gjwyWEyK14dQYfxQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*brnD44gjwyWEyK14dQYfxQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjI1OSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ol><li>[自動化] Slack Channel 每日早上 10 點定時發送提醒大家健康表單的訊息(優化前唯一自動化的地方)<li>員工點擊連結打開 Google Form 填寫健康問題<li>資料存回 Google Sheet 回應紀錄<li>[人工] People Operations 於每日接近下班時比對名單篩出忘記填寫的員工<li>[人工] 於 Slack Channel 發送填寫提醒訊息 &amp; 一個一個 tag 忘記填寫的人</ol><blockquote><p><em>以上是敝司的健康回報追蹤流程，每間公司依照規模及運作方式一定有所不同，本文僅以此做為優化範例，學習 Slack Workflow 使用、基本 App Script 撰寫，實際還是要 by case 實作。</em></p></blockquote><h4 id="問題點"><span class="me-2">問題點</span><a href="#問題點" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>需跳出 Slack Context 使用瀏覽器打開 Google Form 網頁才能填寫，尤其在手機上更不方便<li>Google Form 僅能自動帶入 Email 訊息，無法自動加上填寫人名稱、部門資訊<li>每日人工比對、人工 tag 非常花費人力時間</ul><h4 id="解決方案"><span class="me-2">解決方案</span><a href="#解決方案" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>做過蠻多自動化的小東西，這個流程資料源固定(員工名單)、條件單純、動作很例行；一看就覺得很適合自動化，一開始沒做是因為找不到好的填寫方式(實際是找不到有趣可研究的點)；所以也就放著沒管，直到看到 <a href="https://www.facebook.com/tzangms/posts/10157880898787657" target="_blank">海總理的這則 PO 文</a> 才發現 Slack Workflow 不只是可以做定時傳訊息，還有 Form 表單的功能：</p><p><a href="/assets/d61062833c1a/1*yKBpGlHEVMj4QbjGuB7aHQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*yKBpGlHEVMj4QbjGuB7aHQ.webp" alt="圖片取自： [海總理](https://www.facebook.com/tzangms/posts/10157880898787657){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjkwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>圖片取自： <a href="https://www.facebook.com/tzangms/posts/10157880898787657" target="_blank">海總理</a></p><p>這下手就開始癢了啊！！</p><p>如果能搭配 Slack Workflow From 加上傳訊息的自動化，豈不是能解決上面提到的 <strong>所有痛點</strong> ，原理可行！於是開始著手實作。</p><h4 id="優化後-的-flow"><span class="me-2">優化後 的 Flow</span><a href="#優化後-的-flow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>首先上一下優化後的流程及結果。</p><p><a href="/assets/d61062833c1a/1*jT5dAICg85lyCF0sJwk8bQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*jT5dAICg85lyCF0sJwk8bQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjM4NyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ol><li>[自動化] Slack Channel 每日早上 10 點定時發送提醒大家健康表單的訊息<li>從 Google Form 或 Slack Workflow Form 填寫健康問題<li>資料均存回 Google Sheet 回應紀錄<li>People Operations 於每日接近下班時點擊「產生未填寫名單」按鈕<li>[自動化] 使用 App Script 比對員工名單、填寫名單篩出未填寫名單<li>[自動化] 點擊「產生＆發送訊息」自動發送未填寫提醒＆自動 tag 對象<li>收工！</ol><h4 id="成效"><span class="me-2">成效</span><a href="#成效" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>(個人預估)</p><ul><li>填寫時間每位員工每日能減少約 30 秒<li>People Operations 處理這件事每日能減少約 20 ~ 30 分鐘</ul><h3 id="運作原理"><span class="me-2">運作原理</span><a href="#運作原理" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/d61062833c1a/1*xbZD2kkoYvWifQv8qyV_MQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*xbZD2kkoYvWifQv8qyV_MQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjczNiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>透過撰寫 App Script 來管理 Sheet。</p><ol><li>將外部輸入的資料都存放在 Responses Sheet<li>撰寫 App Script Function 將 Responses 的資料依照填寫日期分發到各日期的 Sheet，若無則建立新的日期 Sheet，Sheet 名稱直接使用日期，方便辨識取用<li>取得當前日期的 Sheet 與員工名單比對，產生未填寫名單 Sheet 的資料<li>讀取未填寫名單 Sheet 組合出訊息並發送到指定 Slack Channel</ol><ul><li>串接 Slack APP API 可自動讀取指定 Channel 匯入員工名單<li>訊息內容使用 Slack UID Tag <code class="language-plaintext highlighter-rouge">&lt;@UID&gt;</code> 就能標記未填寫的成員。</ul><h4 id="身份識別"><span class="me-2">身份識別</span><a href="#身份識別" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>串起 Google From 與 Slack 的身份識別資訊是 Email，所以請確保公司同仁都是使用公司 Email 填寫 Google Form、Slack 個人資訊部分也都有填寫公司 Email。</p><h3 id="開始動手做"><span class="me-2">開始動手做</span><a href="#開始動手做" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>問題、優化方式、成果講完後，接下來來到實作環節；讓我們一起一步步完成這個自動化 Case。</p><blockquote><p><em>篇幅有點長，可依照略過自己已了解的區塊，或直接從完成結果建立副本，邊看邊改邊學。</em></p></blockquote><p>完成結果表單： <a href="https://forms.gle/aqGDCELpAiMFFoyDA" target="_blank">https://forms.gle/aqGDCELpAiMFFoyDA</a></p><p>完成結果 Google Sheet：</p><p><a href="https://docs.google.com/spreadsheets/d/1PTk7G7r4P1sGk46sYjomUbfRO9ouPRF0wbmc84ZXA4c/edit?resourcekey#gid=953539493" target="_blank" class="img-link shimmer" ><img src="https://lh7-us.googleusercontent.com/docs/AHkbwyJ1ypxX3zGwj1swDPSHovOJC_A2eW-sFDKPJO5iRD82y7adF2SKqDluUOOjqnbnezy7RyBFtsGcuKyrUWbPk-NNbMfsPl3rUmfiYLt2F611-cHP_Ig=w1200-h630-p" alt="" loading="lazy"></a></p><h4 id="建立健康回報-google-form-表單--連結回覆到-google-sheet"><span class="me-2">建立健康回報 Google Form 表單 &amp; 連結回覆到 Google Sheet</span><a href="#建立健康回報-google-form-表單--連結回覆到-google-sheet" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>步驟省略，有問題請直接 Google，這邊假定你已經建立＆連結好了健康回報表單。</p><p><strong>表單要記得勾選「Collect emails」：</strong></p><p><a href="/assets/d61062833c1a/1*DKVg1oWvx0p2K_aYslK5ZQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*DKVg1oWvx0p2K_aYslK5ZQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3ODMiIGhlaWdodD0iNzY0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>收集填寫者的 Email 以利之後比對名單用。</p><p><strong>怎麼連結回覆到 Google Sheet？</strong></p><p><a href="/assets/d61062833c1a/1*Ie0WvV5zWNubaYq_hBbeNw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*Ie0WvV5zWNubaYq_hBbeNw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MTQiIGhlaWdodD0iMzAxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>於表單的上方切換到「回覆」點擊「Google Sheet Icon」即可。</p><p><strong>更改連結的 Sheet 名稱：</strong></p><p><a href="/assets/d61062833c1a/1*1A3m2zx1hI039TgWt3iU5A.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*1A3m2zx1hI039TgWt3iU5A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NjYiIGhlaWdodD0iNTgiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>這邊建議將連結的 Sheet 名稱由 Form Responses 1 改為 Responses 方便使用。</p><h4 id="建立-slack-workflow-form-填寫入口"><span class="me-2">建立 Slack Workflow Form 填寫入口</span><a href="#建立-slack-workflow-form-填寫入口" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>傳統的 Google From 填寫入口有了之後，我們先來新增 Slack 填寫方式。</p><p><a href="/assets/d61062833c1a/1*pkCpzbA6YLORazNfQS2ntA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*pkCpzbA6YLORazNfQS2ntA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDkxIiBoZWlnaHQ9Ijk3OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>於 Slack 任意對話視窗中找到「 <strong>輸入匡 下方</strong> 」的「藍色閃電⚡️」點擊下去</p><p><a href="/assets/d61062833c1a/1*GpUOoQ2b_W7bMeeOlkosoA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*GpUOoQ2b_W7bMeeOlkosoA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDkxIiBoZWlnaHQ9Ijk3OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>在選單底下「Search shortcuts」中輸入「workflow」選擇「Open Workflow Builder」</p><p><a href="/assets/d61062833c1a/1*qgt-WjyrG_5OtaUjjt6r9Q.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*qgt-WjyrG_5OtaUjjt6r9Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>這邊會列出你建立的或參與的 Workflow，點選右上角「Create」建立新 Workflow</p><p><a href="/assets/d61062833c1a/1*3qUC2S7sskImnDmXcnqMtg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*3qUC2S7sskImnDmXcnqMtg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>第一步，輸入 workflow 名稱（Workflow Builder 介面顯示用）</p><p><a href="/assets/d61062833c1a/1*q94eI0z8ljhBrjrPEGWa8w.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*q94eI0z8ljhBrjrPEGWa8w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDkyIiBoZWlnaHQ9Ijc2OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Workflow 觸發方式，選擇「Shortcut」</p><p>目前一共有 5 種 slack workflow 觸發時間點：</p><ul><li>Shortcut：手動觸發「藍色閃電⚡️」選項，會出現在 workflow 選單中，點擊即可開始 workflow。<li>New channel member：當 Target Channel 有新成員加入時…. (EX: 歡迎訊息)<li>Emoji reactions：當有人對 Target Channel 中的訊息按下指定表情符號時…(或許可拿來做重要訊息已讀請按 XXX Emoji，以此知道誰已讀了？)<li>Scheduled date &amp; time：排程，指定時間到時…(EX: 定時發提醒回報訊息)<li>Webhook：外部 Webhook 觸發，進階功能，可與第三方或自己架 API 串起內部工作流程。</ul><p>這邊我們選擇「Shortcut」建立手動觸發選項。</p><p><a href="/assets/d61062833c1a/1*2NEcjJtkDwuQtF-DmnhgOg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*2NEcjJtkDwuQtF-DmnhgOg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>選擇這個 Workflow Shortcut 要加入在「哪一個 Channel 輸入匡」之下及輸入「要顯示的名稱」</p><blockquote><p>*一個 workflow shortcut 僅能加入在一個 channel 中</p></blockquote><p><a href="/assets/d61062833c1a/1*Qq-nJr66qoGsXxhPEsUhWw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*Qq-nJr66qoGsXxhPEsUhWw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Shortcut 建立完成！開始建立 workflow 步驟，點擊「Add Step」加入步驟</p><p><a href="/assets/d61062833c1a/1*aUerPfBPlOhkNGoeiougGA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*aUerPfBPlOhkNGoeiougGA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>選擇「Send a form」Step</p><p><a href="/assets/d61062833c1a/1*DBPCTHNyKBuJIvEJCyexyg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*DBPCTHNyKBuJIvEJCyexyg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MTYiIGhlaWdodD0iODg2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><strong>Title</strong> ：輸入表單標題</p><p><strong>Add a question</strong> ：輸入第一個問題的題目（可自行在標題標注問題編號 ex: 1.,2.,3….）</p><p><strong>Choose a question type</strong> ：</p><ul><li>Short answer：單行輸入匡<li>Long answer：多行輸入匡<li>Select from a list：單選列表<li>Select a person：選擇一位同個 Workspace 內的成員<li>Select a channel or DM：選擇一位同個 Workspace 內的成員 或 Group DM 或 Channel</ul><p><a href="/assets/d61062833c1a/1*pYIUTLaHVzHzFkAypN2_sw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*pYIUTLaHVzHzFkAypN2_sw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>「Select from a list」為例：</p><ol><li>Add list item：可新增一個選項<li>Default selection：選擇預設選項<li>Make theis required：將此問題設為必填</ol><p><a href="/assets/d61062833c1a/1*hb1l9_E8EmHgUqIvHuBqhw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*hb1l9_E8EmHgUqIvHuBqhw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ol><li>Add Question：可新增更多問題<li>右方「↓」「⬆」可調整順序、「✎」可展開編輯<li>可選擇是否要將表單填寫內容回傳至 Channel 或 某人</ol><p><a href="/assets/d61062833c1a/1*WsHqG3hxgivNfFXakMgVrQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*WsHqG3hxgivNfFXakMgVrQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>也可以選擇傳送回覆到…：</p><ul><li>Person who clicked ….：點擊這個表單的人（形同填寫的人）<li>Channel where workflow started：這個 workflow 添加到的 Channel</ul><p><a href="/assets/d61062833c1a/1*xyrdyrx9ACpWTcjAtG-rTQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*xyrdyrx9ACpWTcjAtG-rTQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>表單完成後點擊「Save」儲存步驟。</p><blockquote><p>*這邊我們取消勾選將表單填寫內容回傳，因為想要在後面步驟自行客製化訊息內容。</p></blockquote><h4 id="將-slack-workflow-from-與-google-sheet-串接"><span class="me-2">將 Slack workflow from 與 Google Sheet 串接</span><a href="#將-slack-workflow-from-與-google-sheet-串接" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>如果還沒有將 Google Sheet App 加入到 Slack 可先 <a href="https://slack.com/apps/A01AWGA48G6-google-sheets-for-workflow-builder" target="_blank">點此安裝 APP</a> 。</p><p><a href="/assets/d61062833c1a/1*da6ofGd-N0NsBs4LNDsllQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*da6ofGd-N0NsBs4LNDsllQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>繼上一步後，點擊「Add Step」加入新步驟，我們選擇 Google Sheets for Workflow Builder 的「Add a spreadsheet row」步驟。</p><p><a href="/assets/d61062833c1a/1*6h_t9tPiam735pth-n0AOw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*6h_t9tPiam735pth-n0AOw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ol><li>首先要完成 Google 帳號的授權，點擊「Connect account」<li>Select a spreadsheet：選擇目標回應的 Google Sheet，請選擇一開始建立的 Google Form 之 Google Sheet<li>Sheet：同上<li>Column name：第一個欲填入值的 Column，這邊先選問題ㄧ</ol><p><a href="/assets/d61062833c1a/1*XPwkmIHRj8WKEM27kH3YQg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*XPwkmIHRj8WKEM27kH3YQg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>點擊右下角「Insert Variable」選擇「Response to 問題一…」，插入之後可由左下角「Add Column」加入其他欄位，以此類推完成問題二、問題三….</p><p><a href="/assets/d61062833c1a/1*wX7vJDvdneYrid0nECUIeg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*wX7vJDvdneYrid0nECUIeg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>填寫人的 Email，可選擇「Person who submitted form」</p><p><a href="/assets/d61062833c1a/1*lQqJ0x7CeVK9u7g2R2VktQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*lQqJ0x7CeVK9u7g2R2VktQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>在點擊插入的變數，選擇「Email」即可自動帶入填寫人的 Email。</p><ul><li>Mention (default)：tag 該 User，Raw data 是 <code class="language-plaintext highlighter-rouge">&lt;@User ID&gt;</code><li>Name：User 名稱<li>Email：User Email</ul><p><a href="/assets/d61062833c1a/1*CYKDEtnuCKuSgSbAbunB4A.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*CYKDEtnuCKuSgSbAbunB4A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Timestamp 欄位比較 tricky 等下再補充設定方法，先點「Save」儲存後回到頁面右上角按「Publish」發布 Shortcut。</p><p><a href="/assets/d61062833c1a/1*k4rJidYWiVHgco3NYxmA3w.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*k4rJidYWiVHgco3NYxmA3w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MDEiIGhlaWdodD0iMjI2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>看到發布成功訊息後，可以回到 Slack Channel 試試看。</p><p><a href="/assets/d61062833c1a/1*XaQ75kM9BnKgcmAEl63fPg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*XaQ75kM9BnKgcmAEl63fPg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDkxIiBoZWlnaHQ9Ijk3OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>這時候點閃電之後會出現剛剛建立的 Workflow form，可以點來填寫玩玩。</p><p><a href="/assets/d61062833c1a/1*W5v-uUjhVTik05TLDwM-uQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*W5v-uUjhVTik05TLDwM-uQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MzUiIGhlaWdodD0iNDU1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/d61062833c1a/1*63CaYi-HlPWRqxExL-GseQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*63CaYi-HlPWRqxExL-GseQ.webp" alt="左：電腦 右：手機版" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTI1IiBoZWlnaHQ9IjE3MDQiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>左：電腦 / 右：手機版</p><p>我們可以填寫資訊「Submit」測試看看是否正常。</p><p><a href="/assets/d61062833c1a/1*xt7JeHRojIWgJCYrw8sKdw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*xt7JeHRojIWgJCYrw8sKdw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MzMiIGhlaWdodD0iMzMzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>成功！但可以看到 Timestamp 欄位為空，下一步我們來解決這個問題。</p><h4 id="slack-workflow-from-取得填寫時間"><span class="me-2">Slack workflow from 取得填寫時間</span><a href="#slack-workflow-from-取得填寫時間" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Slack workflow 沒有 current timestamp 的 global variable 可用，至少目前還沒有，只找到一篇 <a href="https://www.reddit.com/r/Slack/comments/l1gzhf/is_there_a_global_timestamp_variable_for_the/" target="_blank">reddit 上的許願文章</a> 。</p><p>一開始異想天開在 Column Value 輸入 <code class="language-plaintext highlighter-rouge">=NOW()</code> 但這樣所有紀錄的時間永遠是當前時間，完全錯誤。</p><p>同樣拜 <a href="https://www.reddit.com/r/Slack/comments/l1gzhf/is_there_a_global_timestamp_variable_for_the/" target="_blank">reddit 那篇文章</a> 大神網友提供的 tricky 方法，可以建一個乾淨的 Timestamp Sheet 裡面放一個列資料、欄位 <code class="language-plaintext highlighter-rouge">=NOW()</code> 先用 Update 迫使欄位變為最新，在 Select 得到當前 Timestamp。</p><p><a href="/assets/d61062833c1a/1*54QcEy5QPBt3VXuRSe7-Vw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*54QcEy5QPBt3VXuRSe7-Vw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NDUiIGhlaWdodD0iMjgzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>如上圖結構，點此 <a href="https://docs.google.com/spreadsheets/d/1PTk7G7r4P1sGk46sYjomUbfRO9ouPRF0wbmc84ZXA4c/edit?resourcekey#gid=1106265498" target="_blank">查看範例</a> 。</p><ul><li>Row： 類似 ID 的用處，直接設「1」，之後設定 Select &amp; Update 會要用到，告知資料列。<li>Timestamp：設定值 <code class="language-plaintext highlighter-rouge">=NOW()</code> 讓他永遠顯示當前時間<li>Value：用以觸發 Timestamp 欄位更新時間，內容隨意，這邊是把填寫人的 Email 塞進來放，反正只要能觸發更新就好。</ul><blockquote><p><em>可在 Sheet 上按右鍵「Hide Sheet」隱藏此 Sheet，因為沒有要讓外部使用。</em></p></blockquote><p>回到 Slack Workflow Builder 編輯剛剛 建立的 workflow form。</p><p>點擊「Add Step」新增步驟：</p><p><a href="/assets/d61062833c1a/1*5lIcdnMQnmglNxaiY8fNUQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*5lIcdnMQnmglNxaiY8fNUQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>往下滑選擇「Update a spreadsheet row」</p><p><a href="/assets/d61062833c1a/1*kRBL8iptGYd2Gsy7Lv6gGA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*kRBL8iptGYd2Gsy7Lv6gGA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>「Select a spreadsheet」選擇剛剛的 Sheet，「Sheet」選擇新建立的「Timestamp」Sheet。</p><p>「Choose a column to search」選擇「Row」，Define a cell value to find 輸入「1」。</p><p><a href="/assets/d61062833c1a/1*H8pb9TKvazhqiKKSCKcwCQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*H8pb9TKvazhqiKKSCKcwCQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>「Update these columns」「Column name」選擇「Value」、「Value」點選「Insert variable」-&gt;「Person who submitted」-&gt;「選擇 Email」。</p><p>點「Save」完成！現在已經完成觸發 Sheet 中的 timestamp 更新了，再來是讀取出來用。</p><p><a href="/assets/d61062833c1a/1*avXovKvXz9mlHOq2NWaf3A.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*avXovKvXz9mlHOq2NWaf3A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>回到編輯頁後再點一次「Add Step」加入新步驟，這次選「Select a spreadsheet row」我們要讀取 Timestamp 出來。</p><p><a href="/assets/d61062833c1a/1*xEbDUkWd3utQ9QpllqSNHg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*xEbDUkWd3utQ9QpllqSNHg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Search 部分同「Update a spreadsheet row」，按「Save」。</p><p><a href="/assets/d61062833c1a/1*VO3lfeTe1bxlL3xN3_wtwQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*VO3lfeTe1bxlL3xN3_wtwQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjkyMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Save 完回到步驟列表頁，我們可以把滑鼠移到步驟上用拖曳更改順序。</p><p>將順序改「Update a spreadsheet row」-&gt;「Select a spreadsheet」-&gt;「Add a spreadsheet row」。</p><p>意即：Update 觸發 timestamp 更新 -&gt; 讀取 Timestamp -&gt; 在新增 Row 時拿來用。</p><p>在「Add a spreadsheet row」點「Edit」編輯：</p><p><a href="/assets/d61062833c1a/1*8IH_AJZn0YHFk5obccmUYg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*8IH_AJZn0YHFk5obccmUYg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjkyMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>拉到最下面按左下角「Add Column」在點右下角「Insert a variable」，找到「Select a spreadsheet」Section 中的「Timestamp」變數，注入進去。</p><p><a href="/assets/d61062833c1a/1*-4vk8fjRwkIVSY4Pu-C6VA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*-4vk8fjRwkIVSY4Pu-C6VA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjkyMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>按「Save」儲存步驟後回到列表頁，右上角點「Publish Change」發布更改。</p><p>這時候我們再測試一次 workflow shortcut 看看 timestamp 有沒有正常寫入。</p><p><a href="/assets/d61062833c1a/1*GyJ-55XxVEcZ6Cb1Q_H-WQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*GyJ-55XxVEcZ6Cb1Q_H-WQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5NDYiIGhlaWdodD0iMTYwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>成功！</p><h4 id="slack-workflow-form-增加填寫回執"><span class="me-2">Slack workflow form 增加填寫回執</span><a href="#slack-workflow-form-增加填寫回執" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>同 Google Form 填寫回執，Slack workflow form 也可以。</p><p>在編輯步驟頁我們可以再加入一個步驟，點擊「Add Step」。</p><p><a href="/assets/d61062833c1a/1*16JMg7a_YzUHnnY6JtBrGw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*16JMg7a_YzUHnnY6JtBrGw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjkyMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>這次選擇「Send a message」</p><p><a href="/assets/d61062833c1a/1*2CJuPDtuaTM9P5wIKwPspQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*2CJuPDtuaTM9P5wIKwPspQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjkyMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>「Send this message to」選擇「Person who submitted form」</p><p><a href="/assets/d61062833c1a/1*xKh_l7A-z31B6rQPboFTAA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*xKh_l7A-z31B6rQPboFTAA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjkyMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>訊息內容依序輸入題目名稱、「Insert a variable」選擇「Response to 題目 XXX」，也可在最後插入「Timestamp」，按「Save」儲存步驟後再按「Publish Changes」即可！</p><blockquote><p><em>另外也可使用「Send a message」將填寫結果傳送到特定 Channel 或 DM。</em></p></blockquote><p><a href="/assets/d61062833c1a/1*gfTjTnaNmu-aPj0MuF6M_Q.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*gfTjTnaNmu-aPj0MuF6M_Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDkxIiBoZWlnaHQ9Ijk3OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>成功！</p><p>Slack workflow form 的設定大概到此結束，其他玩法可以自由搭配發揮。</p><h3 id="google-sheet-with-app-script"><span class="me-2">Google Sheet with App Script!</span><a href="#google-sheet-with-app-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>接下我們需要撰寫 App Script 來處理填寫資料。</p><p><a href="/assets/d61062833c1a/1*04KBQF7e4lCjQm5XeHgVrA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*04KBQF7e4lCjQm5XeHgVrA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NjIiIGhlaWdodD0iNDkwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>首先在 Google Sheet 上方工具欄選擇「Tools」-&gt;「Script editor」</p><p><a href="/assets/d61062833c1a/1*wlg8D_1DHONj__M1dSBCxw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*wlg8D_1DHONj__M1dSBCxw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3OTEiIGhlaWdodD0iMjcyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>可以點擊左上角給專案一個名稱。</p><p>現在我們可以開始撰寫 App Script！App Script 是基於 Javascript 設計，所以可以直接使用 Javascript 程式碼用法搭配 Google Sheet 的 lib。</p><h4 id="將-responses-的資料依照填寫日期分發到各日期的-sheet"><span class="me-2">將 Responses 的資料依照填寫日期分發到各日期的 Sheet</span><a href="#將-responses-的資料依照填寫日期分發到各日期的-sheet" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/d61062833c1a/1*T5ExI_5aSf7QY5Zj_gJ3eg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*T5ExI_5aSf7QY5Zj_gJ3eg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTI4IiBoZWlnaHQ9Ijc0NiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nf">formatData</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">bufferSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getActiveSpreadsheet</span><span class="p">().</span><span class="nf">getSheetByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">Responses</span><span class="dl">'</span><span class="p">)</span> <span class="c1">// 儲存回覆的 Sheet 名稱</span>
  
  <span class="kd">var</span> <span class="nx">rows</span> <span class="o">=</span> <span class="nx">bufferSheet</span><span class="p">.</span><span class="nf">getDataRange</span><span class="p">().</span><span class="nf">getValues</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">fileds</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="kd">var</span> <span class="nx">startDeleteIndex</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">deleteLength</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="nx">index</span> <span class="k">in</span> <span class="nx">rows</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">fileds</span> <span class="o">=</span> <span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">sheetName</span> <span class="o">=</span> <span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="nf">toLocaleDateString</span><span class="p">(</span><span class="dl">"</span><span class="s2">en-US</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// 將 Date 轉換成 String，使用美國日期格式 MM/DD/YYYY</span>
    <span class="kd">var</span> <span class="nx">sheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getActiveSpreadsheet</span><span class="p">().</span><span class="nf">getSheetByName</span><span class="p">(</span><span class="nx">sheetName</span><span class="p">);</span> <span class="c1">// 取得 MM/DD/YYYY Sheet</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">sheet</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 若無則新增</span>
      <span class="nx">sheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getActiveSpreadsheet</span><span class="p">().</span><span class="nf">insertSheet</span><span class="p">(</span><span class="nx">sheetName</span><span class="p">,</span> <span class="nx">bufferSheet</span><span class="p">.</span><span class="nf">getIndex</span><span class="p">());</span>
      <span class="nx">sheet</span><span class="p">.</span><span class="nf">appendRow</span><span class="p">(</span><span class="nx">fileds</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">sheet</span><span class="p">.</span><span class="nf">appendRow</span><span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">]);</span> <span class="c1">// 將資料新增至日期 Sheet</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">startDeleteIndex</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">startDeleteIndex</span> <span class="o">=</span> <span class="o">+</span><span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">deleteLength</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if </span><span class="p">(</span><span class="nx">deleteLength</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">bufferSheet</span><span class="p">.</span><span class="nf">deleteRows</span><span class="p">(</span><span class="nx">startDeleteIndex</span><span class="p">,</span> <span class="nx">deleteLength</span><span class="p">);</span> <span class="c1">// 搬移到指定 Sheet 後，移除 Responses 裡的資料</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>在 Code 區塊中貼上以上程式碼，並按「control」+「s」儲存。</p><p>再來我們要在 Sheet 中新增觸發按鈕（ <strong>只能手動按按鈕觸發，無法在資料寫入時做自動分</strong> ）</p><p><a href="/assets/d61062833c1a/1*XvugOM6drupik0wejbBnnA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*XvugOM6drupik0wejbBnnA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NDEiIGhlaWdodD0iODc0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ol><li>首先在建立一個新的 Sheet，取名「未填寫名單」<li>上方工具列選擇「Insert」-&gt;「Drawing」</ol><p><a href="/assets/d61062833c1a/1*BG70QTiE-8QNvlp31jDBMA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*BG70QTiE-8QNvlp31jDBMA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDA4IiBoZWlnaHQ9IjM0OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>使用此介面，拉出一個按鈕。</p><p><a href="/assets/d61062833c1a/1*BXXmUWkal7XjluhLcDaSIQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*BXXmUWkal7XjluhLcDaSIQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NTAiIGhlaWdodD0iMjU2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>「Save and Close」後可調整、移動按鈕；點擊右上角「…」選擇「Assign script」</p><p><a href="/assets/d61062833c1a/1*nx2qjDTUKeyorO0W9nOxKA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*nx2qjDTUKeyorO0W9nOxKA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MDIiIGhlaWdodD0iMjU4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>輸入「formatData」function 名稱。</p><p>可點擊加入的按鈕試試功能</p><p><a href="/assets/d61062833c1a/1*eZpg-qejhpuPgUY7KDg00Q.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*eZpg-qejhpuPgUY7KDg00Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NjkiIGhlaWdodD0iMTg3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>若出現 「Authorization Required」則點選「Continue」完成驗證</p><p><a href="/assets/d61062833c1a/1*hIgRtqKEFs0tsXDxfNTaOg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*hIgRtqKEFs0tsXDxfNTaOg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NjgiIGhlaWdodD0iNjI0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>在身份驗證的過程中會出現「Google hasn’t verified this app」這是正常的，因為我們寫的 App Script 沒有經過 Google 驗證，不過沒關係這是寫給自己用的。</p><p>可點選左下角「Advanced」-&gt;「Go to Health Report (Responses) (unsafe)」</p><p><a href="/assets/d61062833c1a/1*QUkmTD1WlEzw7cqW97ll6Q.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*QUkmTD1WlEzw7cqW97ll6Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MTIiIGhlaWdodD0iNjkyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>點擊「Allow」</p><p><a href="/assets/d61062833c1a/1*0ZPVBwOR2bB4QPsTGX_yCA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*0ZPVBwOR2bB4QPsTGX_yCA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMjkiIGhlaWdodD0iOTciPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><blockquote><p><em>App Script 執行中會顯示「Running Script」這時候請勿再按，避免重複執行。</em></p></blockquote><p><a href="/assets/d61062833c1a/1*i12l4Q5Y2N9bM9CzTo6XDg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*i12l4Q5Y2N9bM9CzTo6XDg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNTAiIGhlaWdodD0iNjQiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><blockquote><p><em>顯示執行成功後，才能再次執行。</em></p></blockquote><p><a href="/assets/d61062833c1a/1*NbOfqAwIYSUAtJ32hSEOCQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*NbOfqAwIYSUAtJ32hSEOCQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NDIiIGhlaWdodD0iMzI4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>成功！將填寫資料依照日期分組。</p><h4 id="取得當前日期的-sheet-與員工名單比對產生未填寫名單-sheet-的資料"><span class="me-2">取得當前日期的 Sheet 與員工名單比對，產生未填寫名單 Sheet 的資料</span><a href="#取得當前日期的-sheet-與員工名單比對產生未填寫名單-sheet-的資料" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>我們再加入一段 Code：</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="c1">// 與員工名單 Sheet ＆ 本日填寫 Sheet 比對，產出未填寫名單</span>
<span class="kd">function</span> <span class="nf">generateUnfilledList</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">listSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getActiveSpreadsheet</span><span class="p">().</span><span class="nf">getSheetByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">員工名單</span><span class="dl">'</span><span class="p">)</span> <span class="c1">// 員工名單 Sheet 名稱</span>
  <span class="kd">var</span> <span class="nx">unfilledListSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getActiveSpreadsheet</span><span class="p">().</span><span class="nf">getSheetByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">未填寫名單</span><span class="dl">'</span><span class="p">)</span> <span class="c1">// 未填寫名單 Sheet 名稱</span>
  <span class="kd">var</span> <span class="nx">today</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">todayName</span> <span class="o">=</span> <span class="nx">today</span><span class="p">.</span><span class="nf">toLocaleDateString</span><span class="p">(</span><span class="dl">"</span><span class="s2">en-US</span><span class="dl">"</span><span class="p">);</span>

  <span class="kd">var</span> <span class="nx">todayListSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getActiveSpreadsheet</span><span class="p">().</span><span class="nf">getSheetByName</span><span class="p">(</span><span class="nx">todayName</span><span class="p">)</span> <span class="c1">// 取得本日 MM/DD/YYYY Sheet</span>
  <span class="k">if </span><span class="p">(</span><span class="nx">todayListSheet</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getUi</span><span class="p">().</span><span class="nf">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">找不到</span><span class="dl">'</span><span class="o">+</span><span class="nx">todayName</span><span class="o">+</span><span class="dl">'</span><span class="s1">本日的 Sheet 或請先執行「整理填寫資料」</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">todayEmails</span> <span class="o">=</span> <span class="nx">todayListSheet</span><span class="p">.</span><span class="nf">getDataRange</span><span class="p">().</span><span class="nf">getValues</span><span class="p">().</span><span class="nf">map</span><span class="p">(</span> <span class="nx">x</span> <span class="o">=&gt;</span> <span class="nx">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="c1">// 取得本日 Sheet Email Address 欄位資料列表 (1 = Column B)</span>
  <span class="c1">// index start from 0, so 1 = Column B</span>
  <span class="c1">// output: Email Address,zhgchgli@gmail.com,alan@gamil.com,b@gmail.com...</span>
  <span class="nx">todayEmails</span><span class="p">.</span><span class="nf">shift</span><span class="p">()</span> <span class="c1">// 移除第一個資料，第一個是欄位名稱「Email Address」無意義</span>
  <span class="c1">// output: zhgchgli@gmail.com,alan@gamil.com,b@gmail.com...</span>

  <span class="nx">unfilledListSheet</span><span class="p">.</span><span class="nf">clear</span><span class="p">()</span> <span class="c1">// 清除未填寫名單...準備重新填入資料</span>
  <span class="nx">unfilledListSheet</span><span class="p">.</span><span class="nf">appendRow</span><span class="p">([</span><span class="nx">todayName</span><span class="o">+</span><span class="dl">"</span><span class="s2"> 未填寫名單</span><span class="dl">"</span><span class="p">])</span> <span class="c1">// 第一行顯示 Sheet 標題</span>

  <span class="kd">var</span> <span class="nx">rows</span> <span class="o">=</span> <span class="nx">listSheet</span><span class="p">.</span><span class="nf">getDataRange</span><span class="p">().</span><span class="nf">getValues</span><span class="p">();</span> <span class="c1">// 讀取員工名單 Sheet</span>
  <span class="k">for</span><span class="p">(</span><span class="nx">index</span> <span class="k">in</span> <span class="nx">rows</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 第一列是標題欄位列，存下來，讓後續產生資料也可補上第一列標題</span>
      <span class="nx">unfilledListSheet</span><span class="p">.</span><span class="nf">appendRow</span><span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">]);</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">if </span><span class="p">(</span><span class="nx">todayEmails</span><span class="p">.</span><span class="nf">includes</span><span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">3</span><span class="p">]))</span> <span class="p">{</span> <span class="c1">// 如果本日 Sheet Email Address 中有此員工的 Email 則代表有填寫，continue 略過... (3 = Column D)</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">unfilledListSheet</span><span class="p">.</span><span class="nf">appendRow</span><span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">]);</span> <span class="c1">// 寫入一行資料到未填寫名單 Sheet</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>一樣儲存後，照前面加入 Code 的方法，再加入一個按鈕並 Assign script — 「generateUnfilledList」。</p><p>完成後可點擊測試：</p><p><a href="/assets/d61062833c1a/1*LCvfyjnvk3yCaoFnsvVhHg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*LCvfyjnvk3yCaoFnsvVhHg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjI4MSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>未填寫名單產生成功！如果沒有出現內容請先確定：</p><ul><li>員工名單已填寫，或可先輸入測試資料<li>要先完成「整理填寫資料」動作</ul><h4 id="讀取未填寫名單-sheet-組合出訊息並發送到指定-slack-channel"><span class="me-2">讀取未填寫名單 Sheet 組合出訊息並發送到指定 Slack Channel</span><a href="#讀取未填寫名單-sheet-組合出訊息並發送到指定-slack-channel" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>首先我們要加入 Incoming WebHooks App 到 Slack Channel，我們會透過此媒介來傳送訊息。</p><p><a href="/assets/d61062833c1a/1*AgGLiLsyvenK-LRWI9rlKg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*AgGLiLsyvenK-LRWI9rlKg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDkxIiBoZWlnaHQ9Ijg5NiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ol><li>Slack 左下角「Apps」-&gt;「Add apps」<li>右邊搜尋匡搜尋「incoming」<li>點擊「Incoming WebHooks」-&gt;「Add」</ol><p><a href="/assets/d61062833c1a/1*DUcwdLTKt33Fa-jNlW8MkA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*DUcwdLTKt33Fa-jNlW8MkA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDMyIiBoZWlnaHQ9IjQ5MSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/d61062833c1a/1*v8Z-5vEM043F82TMiZk2lw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*v8Z-5vEM043F82TMiZk2lw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5OTgiIGhlaWdodD0iNDY2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>選擇未填寫訊息想要傳到的 Channel。</p><p><a href="/assets/d61062833c1a/1*SRciom_ygU0JDKK9ATY1FQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*SRciom_ygU0JDKK9ATY1FQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5NjYiIGhlaWdodD0iMjMxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>記下最上方的「Webhook URL」</p><p><a href="/assets/d61062833c1a/1*kp1QDIEwzQtmfzUwZIDTSg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*kp1QDIEwzQtmfzUwZIDTSg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MDMiIGhlaWdodD0iMjU5Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>往下滑可設定傳送訊息時，傳送 Bot 顯示的名稱及大頭貼；改完記得按「Save Settings」。</p><p>回到我們的 Google Sheet Script</p><p>再加入一段 Code：</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nf">postSlack</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">ui</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getUi</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">ui</span><span class="p">.</span><span class="nf">alert</span><span class="p">(</span>
     <span class="dl">'</span><span class="s1">您確定要發送訊息?</span><span class="dl">'</span><span class="p">,</span>
     <span class="dl">'</span><span class="s1">發送未填寫提醒訊息到 Slack Channel</span><span class="dl">'</span><span class="p">,</span>
      <span class="nx">ui</span><span class="p">.</span><span class="nx">ButtonSet</span><span class="p">.</span><span class="nx">YES_NO</span><span class="p">);</span>
  <span class="c1">// 避免誤觸，先詢問確認</span>

  <span class="k">if </span><span class="p">(</span><span class="nx">result</span> <span class="o">==</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">Button</span><span class="p">.</span><span class="nx">YES</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">unfilledListSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getActiveSpreadsheet</span><span class="p">().</span><span class="nf">getSheetByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">未填寫名單</span><span class="dl">'</span><span class="p">)</span> <span class="c1">// 未填寫名單 Sheet 名稱</span>
    <span class="kd">var</span> <span class="nx">rows</span> <span class="o">=</span> <span class="nx">unfilledListSheet</span><span class="p">.</span><span class="nf">getDataRange</span><span class="p">().</span><span class="nf">getValues</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">persons</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span><span class="p">(</span><span class="nx">index</span> <span class="k">in</span> <span class="nx">rows</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if </span><span class="p">(</span><span class="nx">index</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 略過標題、欄位標題那兩行</span>
        <span class="k">continue</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="dl">""</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="p">:</span> <span class="p">(</span><span class="dl">"</span><span class="s2">&lt;@</span><span class="dl">"</span><span class="o">+</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="dl">"</span><span class="s2">&gt;</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// 標記對象，如果有 slack uid 優先使用，沒有則單純顯示暱稱；2 = Column B / 4 = Column E</span>
      <span class="k">if </span><span class="p">(</span><span class="nx">person</span> <span class="o">==</span> <span class="dl">""</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 都沒視為異常資料，忽略</span>
        <span class="k">continue</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">persons</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span><span class="dl">"</span><span class="s2">• </span><span class="dl">"</span><span class="o">+</span><span class="nx">person</span><span class="o">+</span><span class="dl">'</span><span class="se">\n</span><span class="dl">'</span><span class="p">)</span> <span class="c1">// 將對象存入陣列</span>
    <span class="p">}</span>

    <span class="k">if </span><span class="p">(</span><span class="nx">persons</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 無對象需要被標記通知時，大家都有填，取消訊息送出</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">preText</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">*[健康回報表公告:loudspeaker:]*</span><span class="se">\n</span><span class="s2">公司關心各位的身體健康，煩請以下隊友記得每日填寫健康狀況回報，謝謝:wink:</span><span class="se">\n\n</span><span class="s2">今日未填健康狀況回報名單</span><span class="se">\n\n</span><span class="dl">"</span> <span class="c1">// 訊息開頭內容...</span>
    <span class="kd">var</span> <span class="nx">postText</span> <span class="o">=</span> <span class="dl">"</span><span class="se">\n\n</span><span class="s2">填寫健康狀況回報能讓公司了解隊友們的身體狀況，煩請隊友們每日都要確實填寫唷&gt;&lt; 謝謝大家:woman-bowing::skin-tone-2:</span><span class="dl">"</span> <span class="c1">// 訊息結尾內容...</span>
    <span class="kd">var</span> <span class="nx">payload</span> <span class="o">=</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="nx">preText</span><span class="o">+</span><span class="nx">persons</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="dl">''</span><span class="p">)</span><span class="o">+</span><span class="nx">postText</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">attachments</span><span class="dl">"</span><span class="p">:</span> <span class="p">[{</span>
          <span class="dl">"</span><span class="s2">fallback</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">這邊可放 Google Form 填寫連結</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">actions</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">form_link</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">前往健康狀況回報</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">button</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">style</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">primary</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">url</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">這邊可放 Google Form 填寫連結</span><span class="dl">"</span>
            <span class="p">}</span>
          <span class="p">],</span>
          <span class="dl">"</span><span class="s2">footer</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">:rocket:小提示：點擊輸入匡下方的「:zap:️閃電」-&gt;「Shortcut Name」，即可直接填寫。</span><span class="dl">"</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">這邊輸入你 slack incoming app 的 Webhook URL</span><span class="dl">'</span><span class="p">,{</span>
      <span class="na">method</span>             <span class="p">:</span> <span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">contentType</span>        <span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">payload</span>            <span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">stringify</span><span class="p">(</span><span class="nx">payload</span><span class="p">)</span>
    <span class="p">})</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>一樣儲存後，照前面加入 Code 的方法，再加入一個按鈕並 Assign script — 「postSlack」。</p><p>完成後可點擊測試：</p><p><a href="/assets/d61062833c1a/1*6vD5h6VQhYMRTpiT5ncfMQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*6vD5h6VQhYMRTpiT5ncfMQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NTEiIGhlaWdodD0iMzc3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/d61062833c1a/1*gwgJNkj3D4itq-xTGNctDw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*gwgJNkj3D4itq-xTGNctDw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2ODEiIGhlaWdodD0iNDY0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>成功！！！(顯示 ＠U123456 沒成功標記人是因為 ID 是我亂打的)</p><p>到此主要的功能都已完成！</p><blockquote><p><strong><em>備註</em></strong></p></blockquote><blockquote><p><em>請注意官方建議使用新的 Slack APP API 的 <a href="https://api.slack.com/methods/chat.postMessage" target="_blank">chat.postMessage</a> 來傳送訊息，Incoming Webhook 簡便的這個方式之後會棄用，這邊偷懶沒有使用，可搭配下一章「匯入員工名單」會需要 Slack App API 一起調整成新方法。</em></p></blockquote><p><a href="/assets/d61062833c1a/1*QfgJL_Xb9JhgQnPGjU2CXg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*QfgJL_Xb9JhgQnPGjU2CXg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDA2IiBoZWlnaHQ9Ijg3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><h4 id="匯入員工名單"><span class="me-2">匯入員工名單</span><a href="#匯入員工名單" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>這邊會需要我們創建一個 Slack APP。</p><p>1.前往 <a href="https://api.slack.com/apps" target="_blank">https://api.slack.com/apps</a></p><p>2. 點擊右上角「Create New App」</p><p><a href="/assets/d61062833c1a/1*38It1hdMGq-Lr6hlPIcsWQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*38It1hdMGq-Lr6hlPIcsWQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MTciIGhlaWdodD0iMzk5Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>3. 選擇「 <strong>From scratch</strong> 」</p><p><a href="/assets/d61062833c1a/1*-6FB9vEkju_NszxRrb9LKA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*-6FB9vEkju_NszxRrb9LKA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NDUiIGhlaWdodD0iMzg4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>4. 輸入「 <strong>App Name</strong> 」跟 你想要加入的 Workspace</p><p><a href="/assets/d61062833c1a/1*8OPXRdVPW5xHpe1blQDh6w.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*8OPXRdVPW5xHpe1blQDh6w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MzMiIGhlaWdodD0iNDk4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>5. 建立成功後，在左邊選單選擇「OAuth &amp; Permissions」設定頁</p><p><a href="/assets/d61062833c1a/1*ougV73wzEMnCZ1C3rtx8xg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*ougV73wzEMnCZ1C3rtx8xg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5NzMiIGhlaWdodD0iNjUwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>6. 往下滑到 Scopes 區塊</p><p><a href="/assets/d61062833c1a/1*SprZwCDHq0gtdlN7O2sc-A.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*SprZwCDHq0gtdlN7O2sc-A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NTMiIGhlaWdodD0iNDMzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>依次「Add an OAuth Scope」以下項目：</p><ul><li><a href="https://api.slack.com/scopes/channels:read" target="_blank"><strong>channels:read</strong></a><li><a href="https://api.slack.com/scopes/users:read" target="_blank"><strong>users:read</strong></a><li><a href="https://api.slack.com/scopes/users:read.email" target="_blank"><strong>users:read.email</strong></a><li>如果想改用 APP 發訊息可在此加入 <a href="https://api.slack.com/methods/chat.postMessage" target="_blank"><strong>chat.postMessage</strong></a></ul><p>7. 回到最上面點擊「Install to workspace」or「Reinstall to workspace」</p><p><a href="/assets/d61062833c1a/1*iCmyMNlLwjhR9qsk-aTfxA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*iCmyMNlLwjhR9qsk-aTfxA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NTgiIGhlaWdodD0iNTIzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><blockquote><p><em>*如果 Scopes 有新增，也要回來這點重新安裝。</em></p></blockquote><p>8. 安裝完成，取得複製 <code class="language-plaintext highlighter-rouge">Bot User OAuth Token</code></p><p>9. 使用網頁版 Slack 打開想要匯入名單的 Channel</p><p><a href="/assets/d61062833c1a/1*JK0omZIhk1fmP1TOkE2dpg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*JK0omZIhk1fmP1TOkE2dpg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjE4IiBoZWlnaHQ9IjQ2MyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>從瀏覽器取得網址：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://app.slack.com/client/TXXXX/CXXXX
</pre></table></code></div></div><p>其中 <code class="language-plaintext highlighter-rouge">CXXXX</code> 就是這個 Channel 的 Channel ID，記下此訊息。</p><p>10.</p><p>回到我們的 Google Sheet Script</p><p>再加入一段 Code：</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nf">loadEmployeeList</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">formData</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">token</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Bot User OAuth Token</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">channel</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Channel ID</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">limit</span><span class="dl">'</span><span class="p">:</span> <span class="mi">500</span>
  <span class="p">};</span>
  <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">method</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">payload</span><span class="dl">'</span> <span class="p">:</span> <span class="nx">formData</span>
  <span class="p">};</span>
  <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://slack.com/api/conversations.members</span><span class="dl">'</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nf">getContentText</span><span class="p">());</span>
  <span class="k">for </span><span class="p">(</span><span class="nx">index</span> <span class="k">in</span> <span class="nx">data</span><span class="p">[</span><span class="dl">"</span><span class="s2">members</span><span class="dl">"</span><span class="p">])</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">uid</span> <span class="o">=</span> <span class="nx">data</span><span class="p">[</span><span class="dl">"</span><span class="s2">members</span><span class="dl">"</span><span class="p">][</span><span class="nx">index</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">formData</span> <span class="o">=</span> <span class="p">{</span>
      <span class="dl">'</span><span class="s1">token</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Bot User OAuth Token</span><span class="dl">'</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">user</span><span class="dl">'</span><span class="p">:</span> <span class="nx">uid</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
      <span class="dl">'</span><span class="s1">method</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">payload</span><span class="dl">'</span> <span class="p">:</span> <span class="nx">formData</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://slack.com/api/users.info</span><span class="dl">'</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nf">getContentText</span><span class="p">());</span>

    <span class="kd">var</span> <span class="nx">email</span> <span class="o">=</span> <span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">user</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">profile</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">email</span><span class="dl">"</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">real_name</span> <span class="o">=</span> <span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">user</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">profile</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">real_name_normalized</span><span class="dl">"</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">title</span> <span class="o">=</span> <span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">user</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">profile</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">title</span><span class="dl">"</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">row</span> <span class="o">=</span> <span class="p">[</span><span class="nx">title</span><span class="p">,</span> <span class="nx">real_name</span><span class="p">,</span> <span class="nx">real_name</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">uid</span><span class="p">];</span> <span class="c1">// 依照 Column 填入</span>

    <span class="kd">var</span> <span class="nx">listSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getActiveSpreadsheet</span><span class="p">().</span><span class="nf">getSheetByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">員工名單</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 員工名單 Sheet 名稱</span>
    <span class="nx">listSheet</span><span class="p">.</span><span class="nf">appendRow</span><span class="p">(</span><span class="nx">row</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>但這次我們不需要再加入按鈕，因為匯入僅第一次需要；所以只需存擋後直接執行即可。</p><p><a href="/assets/d61062833c1a/1*rkw-79xbgd3Nn99fDnLWDQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*rkw-79xbgd3Nn99fDnLWDQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0ODUiIGhlaWdodD0iMjE2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>首先按「control」+「s」存檔，上方下拉選單改選擇「loadEmployeeList」，點擊「Run」就會開始匯入名單到員工名單 Sheet。</p><h4 id="手動新增新員工資料"><span class="me-2">手動新增新員工資料</span><a href="#手動新增新員工資料" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>爾後如果有新員工加入，可直接在員工名單 Sheet 新增一列，填入資訊，Slack UID 可在 Slack 上直接查詢：</p><p><a href="/assets/d61062833c1a/1*7EF6ghe032Pp832_61Ui0w.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*7EF6ghe032Pp832_61Ui0w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMTAiIGhlaWdodD0iNDg4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>點擊要查看 UID 的對象，點擊「View full profile」</p><p><a href="/assets/d61062833c1a/1*uKOp7Xe7AQ4ODKR2t8iDMw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*uKOp7Xe7AQ4ODKR2t8iDMw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MzAiIGhlaWdodD0iNzI0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>點擊「More」選擇「Copy member ID」即是 UID。 <code class="language-plaintext highlighter-rouge">UXXXXX</code></p><h3 id="done"><span class="me-2">DONE！</span><a href="#done" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>以上所有步驟都已完成，可以開始自動化的追縱員工的健康狀況。</p><p>完成檔如下，可直接從以下 Google Sheet 建立副本修改後使用：</p><p><a href="https://docs.google.com/spreadsheets/d/1PTk7G7r4P1sGk46sYjomUbfRO9ouPRF0wbmc84ZXA4c/edit?resourcekey#gid=922128927" target="_blank" class="img-link shimmer" ><img src="https://lh7-us.googleusercontent.com/docs/AHkbwyJ1ypxX3zGwj1swDPSHovOJC_A2eW-sFDKPJO5iRD82y7adF2SKqDluUOOjqnbnezy7RyBFtsGcuKyrUWbPk-NNbMfsPl3rUmfiYLt2F611-cHP_Ig=w1200-h630-p" alt="" loading="lazy"></a></p><h3 id="補充"><span class="me-2">補充</span><a href="#補充" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>如果想要用 Scheduled date &amp; time 定時發送 form 訊息，要注意這情況下的 form 只能被填一次，所以不適合在這邊使用…（至少目前版本還是這樣），所以 Scheduled 填寫提醒訊息依然只能用純文字＋Google Form 連結。</ul><p><a href="/assets/d61062833c1a/1*iECjTdwjrRgMswu9MQOMFA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*iECjTdwjrRgMswu9MQOMFA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0ODQiIGhlaWdodD0iNTEiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><ul><li>目前沒有辦法用超連結連到 Shortcut 打開 Form<li>Google Sheet App Script 防止重複執行：</ul><p>如果要防止不小心在執行中又再次按到導致重複執行，可在 function 一開始加上：</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">if </span><span class="p">(</span><span class="nx">PropertiesService</span><span class="p">.</span><span class="nf">getScriptProperties</span><span class="p">().</span><span class="nf">getProperty</span><span class="p">(</span><span class="dl">'</span><span class="s1">FUNCTIONNAME</span><span class="dl">'</span><span class="p">)</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">true</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getUi</span><span class="p">().</span><span class="nf">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">忙碌中...請稍後再試</span><span class="dl">'</span><span class="p">);</span>
  <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">PropertiesService</span><span class="p">.</span><span class="nf">getScriptProperties</span><span class="p">().</span><span class="nf">setProperty</span><span class="p">(</span><span class="dl">'</span><span class="s1">FUNCTIONNAME</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">true</span><span class="dl">'</span><span class="p">);</span>
</pre></table></code></div></div><p>Function 執行結束時加上：</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nx">PropertiesService</span><span class="p">.</span><span class="nf">getScriptProperties</span><span class="p">().</span><span class="nf">setProperty</span><span class="p">(</span><span class="dl">'</span><span class="s1">FUNCTIONNAME</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">true</span><span class="dl">'</span><span class="p">);</span>
</pre></table></code></div></div><p>FUNCTIONNAME 取代為目標 Function 名稱。</p><p>用一個 Global 變數管制執行。</p><h3 id="與-ios-開發相關的應用"><span class="me-2">與 iOS 開發相關的應用</span><a href="#與-ios-開發相關的應用" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>可用來串 CI/CD，用 GUI 包裝原本醜醜的指令操作，例如搭配 Slack Bitrise APP，用 Slack Workflow form 組合啟動 Build 命令：</p><p><a href="/assets/d61062833c1a/1*A6Yc9RKCHLEnCLEe591sTw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*A6Yc9RKCHLEnCLEe591sTw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MDIiIGhlaWdodD0iMjMxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/d61062833c1a/1*cPJ4JR5wVTZOSmuz635Nyg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*cPJ4JR5wVTZOSmuz635Nyg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MTAiIGhlaWdodD0iMzAxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>送出之後會發送指令到有 Bitrise APP 的 private channel，EX:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>bitrise workflow:app_store|branch:develop|ENV[version]:4.32.0
</pre></table></code></div></div><p><a href="/assets/d61062833c1a/1*hxyMW4y03udmyW0QXEuAFQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*hxyMW4y03udmyW0QXEuAFQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MTkiIGhlaWdodD0iNzQiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>就能觸發 Bitrise 執行 CI/CD Flow。</p><h3 id="延伸閱讀"><span class="me-2">延伸閱讀</span><a href="#延伸閱讀" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><a href="https://zhgchg.li/posts/zrealm-dev/python-%E6%90%AD%E9%85%8D-google-cloud-platform-%E8%88%87-line-bot-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E8%87%AA%E5%8B%95%E7%B0%BD%E5%88%B0%E8%85%B3%E6%9C%AC%E8%88%87%E6%8E%92%E7%A8%8B-70a1409b149a/">使用 Python+Google Cloud Platform+Line Bot 自動執行例行瑣事</a><li><a href="https://zhgchg.li/posts/zrealm-dev/google-apps-script-%E6%95%99%E5%AD%B8-%E8%87%AA%E5%8B%95%E8%BD%89%E7%99%BC-gmail-%E9%83%B5%E4%BB%B6%E5%88%B0-slack-channel-%E5%AE%A2%E8%A3%BD%E5%8C%96%E9%80%9A%E7%9F%A5-d414bdbdb8c9/">運用 Google Apps Script 轉發 Gmail 信件到 Slack</a><li><a href="https://zhgchg.li/posts/zrealm-dev/crashlytics-big-query-%E4%B8%B2%E6%8E%A5%E6%95%99%E5%AD%B8-%E8%87%AA%E5%8B%95%E6%9F%A5%E8%A9%A2%E4%B8%A6%E8%BD%89%E7%99%BC-ios-app-%E9%96%83%E9%80%80%E5%A0%B1%E5%91%8A%E5%88%B0-slack-e77b80cc6f89/">Crashlytics + Big Query 打造更即時便利的 Crash 追蹤工具</a><li><a href="https://zhgchg.li/posts/zrealm-dev/crashlytics%E8%88%87google-analytics%E8%87%AA%E5%8B%95%E6%9F%A5%E8%A9%A2app-crash-free-users-rate-google-apps-script%E6%95%B4%E5%90%88%E5%AF%A6%E4%BD%9C-793cb8f89b72/">Crashlytics + Google Analytics 自動查詢 App Crash-Free Users Rate</a></ul><p>有任何問題及指教歡迎 <a href="https://www.zhgchg.li/contact" target="_blank">與我聯絡</a> 。</p><p>有自動化相關優化需求也歡迎 <a href="https://www.zhgchg.li/contact" target="_blank">發案給我</a> ，謝謝。</p><script src="/assets/clipboard.min.js"></script><div style=" display:flex; align-items:center; gap:10px; border:1px solid #e5e7eb; background:#f9fafb; padding:12px 16px; border-radius:12px; margin:18px 0; box-shadow:0 3px 8px rgba(0,0,0,0.05); width: auto;"> <input id="share-url" value="https://zhgchg.lihttps://zhgchg.li/posts/zrealm-dev/slack-workflow-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8B%95-wfh-%E5%93%A1%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E5%A0%B1%E7%B3%BB%E7%B5%B1-%E7%B5%90%E5%90%88-google-sheets-%E8%88%87-app-script-%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87-d61062833c1a/" readonly="" style=" flex:1; border:1px solid #d1d5db; border-radius:8px; padding:10px 12px; font-size:0.9rem; background:#ffffff; color:#111827; outline:none; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; " /> <button class="btn" data-clipboard-target="#share-url" id="copy-btn" style=" border:none; background:#3b82f6; color:white; padding:10px 16px; border-radius:10px; cursor:pointer; font-size:0.85rem; font-weight:600; display:flex; align-items:center; gap:6px; transition:all .15s ease; box-shadow:0 2px 5px rgba(59,130,246,0.35); " onmouseover="this.style.opacity='0.92';" onmouseout="this.style.opacity='1';"> <span style="font-size:1rem;">🔗</span> <span id="copy-btn-text">Copy link to share!</span> </button></div><script> new ClipboardJS('.btn'); var btn = document.getElementById("copy-btn"); var text = document.getElementById("copy-btn-text"); btn.addEventListener("click", function () { text.textContent = "Copied!"; btn.style.background = "#16a34a"; btn.style.boxShadow = "0 2px 6px rgba(22,163,74,0.35)"; setTimeout(() => { text.textContent = "Copy link to share!"; btn.style.background = "#3b82f6"; btn.style.boxShadow = "0 2px 5px rgba(59,130,246,0.35)"; }, 1500); });</script><hr /><p><a href="https://www.paypal.com/ncp/payment/CMALMPT8UUTY2" target="_blank" rel="noopener" style="display:block;margin:12px 0;text-align:center;align-items:center;justify-content:center;padding:10px 22px;border-radius:999px;text-decoration:none;background:linear-gradient(135deg,#ffd54f,#ffb300);color:#000;font-size:16px;font-weight:700;font-family:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;box-shadow:0 4px 10px rgba(0,0,0,.15);cursor:pointer;transition:all .15s ease;width:350px" onmouseover="this.style.background=&quot;linear-gradient(135deg,#FFE082,#FFC107)&quot;,this.style.transform=&quot;translateY(-1px)&quot;,this.style.boxShadow=&quot;0 6px 14px rgba(0,0,0,0.2)&quot;" onmouseout="this.style.background=&quot;linear-gradient(135deg,#FFD54F,#FFB300)&quot;,this.style.transform=&quot;translateY(0)&quot;,this.style.boxShadow=&quot;0 4px 10px rgba(0,0,0,0.15)&quot;">🍺 Buy me a beer on PayPal</a></p><blockquote class="prompt-info"><p>本文首次發表於 Medium (<a href="https://medium.com/p/d61062833c1a" target="_blank"><strong>點此查看原始版本</strong></a>)，由 <a href="/posts/tools/medium-to-jekyll/" target="_blank">ZMediumToMarkdown</a> 提供自動轉換與同步技術。</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/zh-tw/zmediumtomarkdown/2021-06-13-d61062833c1a.md" target="_blank">Improve this page on Github.</a></p></blockquote><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1,050+ Followers</span></a></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-dev/">ZRealm Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/automation/" class="post-tag no-text-decoration" >automation</a> <a href="/tags/google-sheets/" class="post-tag no-text-decoration" >google-sheets</a> <a href="/tags/app-script/" class="post-tag no-text-decoration" >app-script</a> <a href="/tags/slack/" class="post-tag no-text-decoration" >slack</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Slack%20Workflow%EF%BD%9C%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8B%95%20WFH%20%E5%93%A1%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E5%A0%B1%E7%B3%BB%E7%B5%B1%EF%BC%8C%E7%B5%90%E5%90%88%20Google%20Sheets%20%E8%88%87%20App%20Script%20%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fslack-workflow-%25E6%2589%2593%25E9%2580%25A0%25E5%2585%25A8%25E8%2587%25AA%25E5%258B%2595-wfh-%25E5%2593%25A1%25E5%25B7%25A5%25E5%2581%25A5%25E5%25BA%25B7%25E5%259B%259E%25E5%25A0%25B1%25E7%25B3%25BB%25E7%25B5%25B1-%25E7%25B5%2590%25E5%2590%2588-google-sheets-%25E8%2588%2587-app-script-%25E6%258F%2590%25E5%258D%2587%25E6%2595%2588%25E7%258E%2587-d61062833c1a%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Slack%20Workflow%EF%BD%9C%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8B%95%20WFH%20%E5%93%A1%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E5%A0%B1%E7%B3%BB%E7%B5%B1%EF%BC%8C%E7%B5%90%E5%90%88%20Google%20Sheets%20%E8%88%87%20App%20Script%20%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fslack-workflow-%25E6%2589%2593%25E9%2580%25A0%25E5%2585%25A8%25E8%2587%25AA%25E5%258B%2595-wfh-%25E5%2593%25A1%25E5%25B7%25A5%25E5%2581%25A5%25E5%25BA%25B7%25E5%259B%259E%25E5%25A0%25B1%25E7%25B3%25BB%25E7%25B5%25B1-%25E7%25B5%2590%25E5%2590%2588-google-sheets-%25E8%2588%2587-app-script-%25E6%258F%2590%25E5%258D%2587%25E6%2595%2588%25E7%258E%2587-d61062833c1a%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fslack-workflow-%25E6%2589%2593%25E9%2580%25A0%25E5%2585%25A8%25E8%2587%25AA%25E5%258B%2595-wfh-%25E5%2593%25A1%25E5%25B7%25A5%25E5%2581%25A5%25E5%25BA%25B7%25E5%259B%259E%25E5%25A0%25B1%25E7%25B3%25BB%25E7%25B5%25B1-%25E7%25B5%2590%25E5%2590%2588-google-sheets-%25E8%2588%2587-app-script-%25E6%258F%2590%25E5%258D%2587%25E6%2595%2588%25E7%258E%2587-d61062833c1a%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/app-store-connect-api-webhook-%E4%B8%B2%E6%8E%A5-%E6%8F%90%E5%8D%87-ios-ci-cd-%E8%87%AA%E5%8B%95%E5%8C%96%E6%95%88%E7%8E%87%E8%88%87%E9%80%9A%E7%9F%A5%E6%B5%81%E7%A8%8B-7c0974856393/">CI/CD 使用 App Store Connect API Webhook 串接自動化工作流程</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/ci-cd-%E6%98%AF%E4%BB%80%E9%BA%BC-%E6%89%93%E9%80%A0%E9%AB%98%E6%95%88%E7%A9%A9%E5%AE%9A%E9%96%8B%E7%99%BC%E5%9C%98%E9%9A%8A%E7%9A%84%E9%97%9C%E9%8D%B5%E6%B5%81%E7%A8%8B%E8%88%87%E5%B7%A5%E5%85%B7%E9%81%B8%E6%93%87-c008a9e8ceca/">CI/CD 實戰指南（一）：CI/CD 是什麼？如何透過 CI/CD 打造穩定高效的開發團隊？工具選擇？</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/google-apps-script-web-app-%E6%89%93%E9%80%A0-github-action-ci-cd-%E8%87%AA%E8%A8%82%E8%A1%A8%E5%96%AE%E6%8F%90%E5%8D%87%E9%96%8B%E7%99%BC%E6%95%88%E7%8E%87-4cb4437818f2/">使用 Google Apps Script Web App 表單串接 Github Action CI/CD 工作</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-robotic-process-automation/github-action-%E5%85%8D%E8%B2%BB%E9%83%A8%E7%BD%B2-zreviewtender-app-%E5%95%86%E5%9F%8E%E8%A9%95%E5%83%B9%E7%9B%A3%E6%8E%A7%E6%A9%9F%E5%99%A8%E4%BA%BA-%E4%B8%89%E6%AD%A5%E9%A9%9F%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-0095528cf875/">Quick Start! Github Action x ZReviewTender 免費快速部署你的 App 商城評價監控機器人</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/ios-timer-%E8%88%87-dispatchsourcetimer-%E9%81%B8%E6%93%87%E8%88%87%E5%AE%89%E5%85%A8%E5%B0%81%E8%A3%9D%E6%8A%80%E5%B7%A7-%E6%9C%89%E9%99%90%E7%8B%80%E6%85%8B%E6%A9%9F%E9%98%B2%E6%AD%A2%E9%96%83%E9%80%80-62f68ebeecd3/">iOS Timer 與 DispatchSourceTimer 如何選擇與安全的使用?</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E9%96%8B%E7%AE%B1/">開箱</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a> <a class="post-tag btn btn-outline-primary" href="/tags/japan/">japan</a> <a class="post-tag btn btn-outline-primary" href="/tags/cicd/">cicd</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Chapters 🔖</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-robotic-process-automation/ios-%E6%8D%B7%E5%BE%91%E8%87%AA%E5%8B%95%E5%8C%96-3-%E6%8B%9B%E8%87%AA%E5%8B%95%E8%BD%89%E7%99%BC%E7%B0%A1%E8%A8%8A%E8%88%87%E5%BB%BA%E7%AB%8B%E6%8F%90%E9%86%92%E5%BE%85%E8%BE%A6%E4%BA%8B%E9%A0%85%E6%95%99%E5%AD%B8-309d0302877b/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1724083008" data-df="ll" > Aug 19, 2024 </time><h4 class="pt-0 my-2">iOS 捷徑自動化應用場景 — 自動轉發簡訊與自動建立提醒待辦事項</h4><div class="text-muted"><p>iOS 使用 捷徑 Shortcut 簡單幾個步驟自動轉發特定簡訊給家長和自動創建包裹到貨領取與信用卡繳費提醒代辦事項</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-robotic-process-automation/google-apps-script-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E6%95%B8%E6%93%9A%E5%A0%B1%E8%A1%A8%E8%87%AA%E5%8B%95%E5%8C%96-rpa-%E5%BF%AB%E9%80%9F%E4%B8%B2%E6%8E%A5-google-analytics-%E8%88%87-google-sheet-f6713ba3fee3/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1713107805" data-df="ll" > Apr 14, 2024 </time><h4 class="pt-0 my-2">使用 Google Apps Script 實現每日數據報表 RPA 自動化</h4><div class="text-muted"><p>使用 Google Apps Script 進行 Google Workspace 相關服務之 Robotic Process Automation 自動化</p></div></div></a></article><article class="col"> <a href="/posts/pinkoi-engineering/%E9%AB%98%E6%95%88%E7%8E%87%E5%B7%A5%E7%A8%8B%E5%9C%98%E9%9A%8A%E5%A4%A7%E8%A7%A3%E5%AF%86-pinkoi-%E5%9C%98%E9%9A%8A%E5%8D%94%E4%BD%9C%E8%88%87%E8%87%AA%E5%8B%95%E5%8C%96%E5%AF%A6%E8%B8%90%E6%8F%90%E5%8D%87%E5%B7%A5%E4%BD%9C%E6%95%88%E7%8E%87-11f6c8568154/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1631189633" data-df="ll" > Sep 9, 2021 </time><h4 class="pt-0 my-2">2021 Pinkoi Tech Career Talk —  高效率工程團隊大解密</h4><div class="text-muted"><p>Pinkoi 高效率工程團隊大解密 Tech Talk 分享</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-dev/zreviewsbot-%E5%85%8D%E8%B2%BB%E9%96%8B%E6%BA%90-slack-app-review-%E8%A9%95%E5%83%B9%E9%80%9A%E7%9F%A5%E6%A9%9F%E5%99%A8%E4%BA%BA-ios-android-%E9%9B%99%E5%B9%B3%E5%8F%B0%E6%94%AF%E6%8F%B4-33f6aabb744f/" class="btn btn-outline-primary" aria-label="Older" ><p>ZReviewsBot｜免費開源 Slack App Review 評價通知機器人，iOS & Android 雙平台支援</p></a> <a href="/posts/zrealm-dev/visitor-pattern-%E5%9C%A8-ios-swift-%E5%88%86%E4%BA%AB%E5%8A%9F%E8%83%BD%E6%87%89%E7%94%A8-%E8%A8%AD%E8%A8%88%E6%A8%A1%E5%BC%8F%E5%AF%A6%E5%8B%99%E8%A7%A3%E6%9E%90%E8%88%87%E6%9C%80%E4%BD%B3%E6%9E%B6%E6%A7%8B%E5%84%AA%E5%8C%96-ba5773a7bfea/" class="btn btn-outline-primary" aria-label="Newer" ><p>Visitor Pattern in iOS (Swift)</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span> <br/> Last updated: 2025-12-28 22:37:44 +08:00</p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E9%96%8B%E7%AE%B1/">開箱</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a> <a class="post-tag btn btn-outline-primary" href="/tags/japan/">japan</a> <a class="post-tag btn btn-outline-primary" href="/tags/cicd/">cicd</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
