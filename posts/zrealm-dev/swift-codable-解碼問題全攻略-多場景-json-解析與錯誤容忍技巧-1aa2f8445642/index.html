<!doctype html><html lang="zh-tw" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Swift Codable è§£ç¢¼å•é¡Œå…¨æ”»ç•¥ï½œå¤šå ´æ™¯ JSON è§£æèˆ‡éŒ¯èª¤å®¹å¿æŠ€å·§" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="zh_tw" /><meta name="description" content="é‡å° iOS é–‹ç™¼ä¸­ Swift Codable è§£ç¢¼å¸¸è¦‹å›°å¢ƒï¼Œæä¾›å¤šå ´æ™¯ JSON è§£æå¯¦æˆ°ç¯„ä¾‹ï¼Œè§£æ±ºæ¬„ä½å¤šå‹ã€é™£åˆ—éŒ¯èª¤å®¹å¿èˆ‡è‡ªè¨‚æ—¥æœŸæ ¼å¼ç­‰å•é¡Œï¼ŒåŠ©ä½ æ‰“é€ ç©©å¥é«˜æ•ˆçš„è³‡æ–™æ˜ å°„æµç¨‹ã€‚" /><meta property="og:description" content="é‡å° iOS é–‹ç™¼ä¸­ Swift Codable è§£ç¢¼å¸¸è¦‹å›°å¢ƒï¼Œæä¾›å¤šå ´æ™¯ JSON è§£æå¯¦æˆ°ç¯„ä¾‹ï¼Œè§£æ±ºæ¬„ä½å¤šå‹ã€é™£åˆ—éŒ¯èª¤å®¹å¿èˆ‡è‡ªè¨‚æ—¥æœŸæ ¼å¼ç­‰å•é¡Œï¼ŒåŠ©ä½ æ‰“é€ ç©©å¥é«˜æ•ˆçš„è³‡æ–™æ˜ å°„æµç¨‹ã€‚" /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-dev/swift-codable-%E8%A7%A3%E7%A2%BC%E5%95%8F%E9%A1%8C%E5%85%A8%E6%94%BB%E7%95%A5-%E5%A4%9A%E5%A0%B4%E6%99%AF-json-%E8%A7%A3%E6%9E%90%E8%88%87%E9%8C%AF%E8%AA%A4%E5%AE%B9%E5%BF%8D%E6%8A%80%E5%B7%A7-1aa2f8445642/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-dev/swift-codable-%E8%A7%A3%E7%A2%BC%E5%95%8F%E9%A1%8C%E5%85%A8%E6%94%BB%E7%95%A5-%E5%A4%9A%E5%A0%B4%E6%99%AF-json-%E8%A7%A3%E6%9E%90%E8%88%87%E9%8C%AF%E8%AA%A4%E5%AE%B9%E5%BF%8D%E6%8A%80%E5%B7%A7-1aa2f8445642/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/1aa2f8445642/1*9VYP3_Mhj9xsLKbgCwt6XQ.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-06-14T00:33:58+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/1aa2f8445642/1*9VYP3_Mhj9xsLKbgCwt6XQ.webp" /><meta property="twitter:title" content="Swift Codable è§£ç¢¼å•é¡Œå…¨æ”»ç•¥ï½œå¤šå ´æ™¯ JSON è§£æèˆ‡éŒ¯èª¤å®¹å¿æŠ€å·§" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://www.linkedin.com/in/zhgchgli"},"dateModified":"2024-04-13T16:24:35+08:00","datePublished":"2020-06-14T00:33:58+08:00","description":"é‡å° iOS é–‹ç™¼ä¸­ Swift Codable è§£ç¢¼å¸¸è¦‹å›°å¢ƒï¼Œæä¾›å¤šå ´æ™¯ JSON è§£æå¯¦æˆ°ç¯„ä¾‹ï¼Œè§£æ±ºæ¬„ä½å¤šå‹ã€é™£åˆ—éŒ¯èª¤å®¹å¿èˆ‡è‡ªè¨‚æ—¥æœŸæ ¼å¼ç­‰å•é¡Œï¼ŒåŠ©ä½ æ‰“é€ ç©©å¥é«˜æ•ˆçš„è³‡æ–™æ˜ å°„æµç¨‹ã€‚","headline":"Swift Codable è§£ç¢¼å•é¡Œå…¨æ”»ç•¥ï½œå¤šå ´æ™¯ JSON è§£æèˆ‡éŒ¯èª¤å®¹å¿æŠ€å·§","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+","url":"https://zhgchg.li/assets/1aa2f8445642/1*9VYP3_Mhj9xsLKbgCwt6XQ.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-dev/swift-codable-%E8%A7%A3%E7%A2%BC%E5%95%8F%E9%A1%8C%E5%85%A8%E6%94%BB%E7%95%A5-%E5%A4%9A%E5%A0%B4%E6%99%AF-json-%E8%A7%A3%E6%9E%90%E8%88%87%E9%8C%AF%E8%AA%A4%E5%AE%B9%E5%BF%8D%E6%8A%80%E5%B7%A7-1aa2f8445642/"},"url":"https://zhgchg.li/posts/zrealm-dev/swift-codable-%E8%A7%A3%E7%A2%BC%E5%95%8F%E9%A1%8C%E5%85%A8%E6%94%BB%E7%95%A5-%E5%A4%9A%E5%A0%B4%E6%99%AF-json-%E8%A7%A3%E6%9E%90%E8%88%87%E9%8C%AF%E8%AA%A4%E5%AE%B9%E5%BF%8D%E6%8A%80%E5%B7%A7-1aa2f8445642/"}</script><title>Swift Codable è§£ç¢¼å•é¡Œå…¨æ”»ç•¥ï½œå¤šå ´æ™¯ JSON è§£æèˆ‡éŒ¯èª¤å®¹å¿æŠ€å·§ | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/zh.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=false" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script><link rel="alternate" hreflang="en" href="https://en.zhgchg.li/posts/zrealm-dev/codable-decode-issues-explained-master-decodable-for-real-world-ios-challenges-1aa2f8445642/"><link rel="alternate" hreflang="ja" href="https://jp.zhgchg.li/posts/zrealm%E3%81%AE%E9%96%8B%E7%99%BA/codable-%E3%83%87%E3%82%B3%E3%83%BC%E3%83%89%E5%95%8F%E9%A1%8C%E3%81%AE%E5%AE%8C%E5%85%A8%E3%82%AC%E3%82%A4%E3%83%89-%E5%9F%BA%E7%A4%8E%E3%81%8B%E3%82%89%E5%BF%9C%E7%94%A8%E3%81%BE%E3%81%A7%E5%85%A8%E3%82%B7%E3%83%BC%E3%83%B3%E5%AF%BE%E5%BF%9C-1aa2f8445642/"><link rel="alternate" hreflang="zh-Hans" href="https://zh-hans.zhgchg.li/posts/zrealm-dev/swift-codable-%E8%A7%A3%E7%A0%81%E9%97%AE%E9%A2%98%E5%85%A8%E6%94%BB%E7%95%A5-%E5%A4%9A%E5%9C%BA%E6%99%AF-json-%E8%A7%A3%E6%9E%90%E4%B8%8E%E9%94%99%E8%AF%AF%E5%AE%B9%E5%BF%8D%E6%8A%80%E5%B7%A7-1aa2f8445642/"><link rel="alternate" hreflang="zh-Hant" href="https://zhgchg.li/posts/zrealm-dev/swift-codable-%E8%A7%A3%E7%A2%BC%E5%95%8F%E9%A1%8C%E5%85%A8%E6%94%BB%E7%95%A5-%E5%A4%9A%E5%A0%B4%E6%99%AF-json-%E8%A7%A3%E6%9E%90%E8%88%87%E9%8C%AF%E8%AA%A4%E5%AE%B9%E5%BF%8D%E6%8A%80%E5%B7%A7-1aa2f8445642/"><link rel="alternate" hreflang="x-default" href="https://zhgchg.li/posts/zrealm-dev/swift-codable-%E8%A7%A3%E7%A2%BC%E5%95%8F%E9%A1%8C%E5%85%A8%E6%94%BB%E7%95%A5-%E5%A4%9A%E5%A0%B4%E6%99%AF-json-%E8%A7%A3%E6%9E%90%E8%88%87%E9%8C%AF%E8%AA%A4%E5%AE%B9%E5%BF%8D%E6%8A%80%E5%B7%A7-1aa2f8445642/"> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"FAQPage","mainEntity":[{"@type":"Question","name":"å¦‚ä½•ç”¨ Codable è§£æ±º JSON ä¸­åŒä¸€æ¬„ä½å¯èƒ½å°æ‡‰å¤šç¨®ä¸åŒå‹åˆ¥çš„ç‰©ä»¶ï¼Ÿ","acceptedAnswer":{"@type":"Answer","text":"ç•¶ JSON æ¬„ä½å¦‚ targetObject å¯èƒ½æ˜¯ User æˆ– Song æ™‚ï¼Œå¯ç”¨ç¬¦åˆ Decodable çš„ Enum æ­é…è‡ªè¨‚ init(from:)ï¼Œå…ˆè§£æ type åˆ¤æ–·ï¼Œå† decode å°æ‡‰å‹åˆ¥ï¼Œç¢ºä¿æ­£ç¢º Mapping ä¸¦æ–¹ä¾¿å¾ŒçºŒä½¿ç”¨ã€‚"}},{"@type":"Question","name":"å¦‚ä½•åœ¨ä½¿ç”¨ Codable è§£ç¢¼é™£åˆ—æ™‚è·³éæ ¼å¼éŒ¯èª¤æˆ–ä¸ç¬¦çš„è³‡æ–™ï¼Œé¿å…æ•´åŒ…è§£ç¢¼å¤±æ•—ï¼Ÿ","acceptedAnswer":{"@type":"Answer","text":"åˆ©ç”¨ nestedUnkeyedContainer éæ­·é™£åˆ—å…ƒç´ ï¼Œå°æ¯ç­†è³‡æ–™ç”¨ try? decode å˜—è©¦è§£ç¢¼ï¼Œå¤±æ•—æ™‚ç”¨ç©ºçµæ§‹é«”å ä½ï¼Œè®“è§£ç¢¼æµç¨‹ç¹¼çºŒï¼Œé¿å…å› å–®ç­†éŒ¯èª¤å°è‡´æ•´å€‹é™£åˆ—è§£ç¢¼å¤±æ•—ã€‚"}},{"@type":"Question","name":"å¦‚ä½•æœ‰æ•ˆç®¡ç† Codable è§£ç¢¼å¾Œçš„è³‡æ–™èˆ‡æ¥­å‹™é‚è¼¯ï¼Œé¿å…å°‡å…§éƒ¨é‹ç®—æ¬„ä½æ··å…¥è§£ç¢¼çµæ§‹ï¼Ÿ","acceptedAnswer":{"@type":"Answer","text":"æ¡ç”¨ Entity/Model åˆ†é›¢æ¶æ§‹ï¼ŒEntity è² è²¬ Codable è§£ç¢¼ï¼ŒModel ç”¨ä¾†å°è£æ¥­å‹™é‚è¼¯èˆ‡é¡å¤–æ¬„ä½ï¼Œæå‡ç¨‹å¼ç¢¼å¯è®€æ€§èˆ‡ç¶­è­·æ€§ï¼Œä¸”æ–¹ä¾¿èˆ‡ Objective-C äº’é€šã€‚"}},{"@type":"Question","name":"å¦‚ä½•ä½¿ç”¨ JSONDecoder è‡ªè¨‚å¤šç¨®æ—¥æœŸæ ¼å¼çš„è§£ç¢¼ç­–ç•¥ï¼Ÿ","acceptedAnswer":{"@type":"Answer","text":"é€é JSONDecoder çš„ dateDecodingStrategy è¨­ç‚º .customï¼Œå¯¦ä½œè‡ªè¨‚é‚è¼¯å˜—è©¦å¤šç¨® DateFormatter æˆ– ISO8601DateFormatter è§£ç¢¼ï¼ŒæˆåŠŸå³è¿”å›æ—¥æœŸï¼Œå¤±æ•—å‰‡æ‹‹éŒ¯ï¼Œéˆæ´»è™•ç†å¤šæ ¼å¼æ—¥æœŸå­—ä¸²ã€‚"}},{"@type":"Question","name":"ç•¶ JSON æ¬„ä½åç¨±èˆ‡ Swift å±¬æ€§åç¨±ä¸ä¸€è‡´æ™‚ï¼Œå¦‚ä½•ç”¨ Codable æ­£ç¢ºå°æ‡‰ï¼Ÿ","acceptedAnswer":{"@type":"Answer","text":"å¯åœ¨ Codable çµæ§‹å…§å®šç¾© CodingKeys æšèˆ‰ï¼Œæ˜ç¢ºæŒ‡å®šå±¬æ€§å°æ‡‰çš„ JSON Keyï¼Œæˆ–åˆ©ç”¨ JSONDecoder çš„ keyDecodingStrategy è¨­å®š .convertFromSnakeCase è‡ªå‹•è½‰æ› snake_case è‡³ camelCaseï¼Œç°¡åŒ–å°æ‡‰æµç¨‹ã€‚"}}]} </script><link rel="stylesheet" href="/assets/css/post-toc.css"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0">An iOS, web, and automation developer from Taiwan ğŸ‡¹ğŸ‡¼ who also loves sharing, traveling, and writing.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item" style="padding:0 15px 0 15px;"> <a href="https://medium.com/@zhgchgli" class="nav-link" target="_blank" style="background:#EDF4FF;color:#0A84FF;font-size:15px;transition:background-color .2s,color .2s;" onmouseover="this.style.backgroundColor='#0A84FF';this.style.color='#ffffff';" onmouseout="this.style.backgroundColor='#EDF4FF';this.style.color='#0A84FF';"> <i class="fa-brands fa-medium"></i> <span><span style="font-size: 18px; font-weight: boild;">Follow Me on Medium!</span><br/><u>1,051+</u> Followers</span> </a><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>é¦–é </span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>åˆ†é¡</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>æ¨™ç±¤</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>æ­¸æª”</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>é—œæ–¼æˆ‘</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>è¯çµ¡æˆ‘</span> </a><li class="nav-item"><div aria-label="Language switch" style="display:flex;align-items:center;justify-content:center;gap:5px;"> <a href="https://zhgchg.li/posts/zrealm-dev/swift-codable-%E8%A7%A3%E7%A2%BC%E5%95%8F%E9%A1%8C%E5%85%A8%E6%94%BB%E7%95%A5-%E5%A4%9A%E5%A0%B4%E6%99%AF-json-%E8%A7%A3%E6%9E%90%E8%88%87%E9%8C%AF%E8%AA%A4%E5%AE%B9%E5%BF%8D%E6%8A%80%E5%B7%A7-1aa2f8445642/" style="display:inline-flex;align-items:center;justify-content:center;padding:6px 10px;border-radius:999px;border:1px solid #666;background:#111;color:#fff;font-size:12px;font-weight:600;line-height:1;text-decoration:none;"> æ­£é«”ä¸­æ–‡ </a> <span style="width:1px;height:18px;background:rgba(0,0,0,.12);"></span> <a href="https://zh-hans.zhgchg.li/posts/zrealm-dev/swift-codable-%E8%A7%A3%E7%A0%81%E9%97%AE%E9%A2%98%E5%85%A8%E6%94%BB%E7%95%A5-%E5%A4%9A%E5%9C%BA%E6%99%AF-json-%E8%A7%A3%E6%9E%90%E4%B8%8E%E9%94%99%E8%AF%AF%E5%AE%B9%E5%BF%8D%E6%8A%80%E5%B7%A7-1aa2f8445642/" style="display:inline-flex;align-items:center;justify-content:center;padding:6px 10px;border-radius:999px;border:1px solid #ccc;background:#f3f3f3;color:#555;font-size:12px;font-weight:600;line-height:1;text-decoration:none;"> ç®€ä½“ä¸­æ–‡ </a></div><div aria-label="Language switch" style="display:flex;align-items:center;justify-content:center;gap:5px;margin-top:5px;"> <a href="https://en.zhgchg.li/posts/zrealm-dev/codable-decode-issues-explained-master-decodable-for-real-world-ios-challenges-1aa2f8445642/" style="display:inline-flex;align-items:center;justify-content:center;padding:6px 10px;border-radius:999px;border:1px solid #ccc;background:#f3f3f3;color:#555;font-size:12px;font-weight:600;line-height:1;text-decoration:none;"> English </a> <span style="width:1px;height:18px;background:rgba(0,0,0,.12);"></span> <a href="https://jp.zhgchg.li/posts/zrealm%E3%81%AE%E9%96%8B%E7%99%BA/codable-%E3%83%87%E3%82%B3%E3%83%BC%E3%83%89%E5%95%8F%E9%A1%8C%E3%81%AE%E5%AE%8C%E5%85%A8%E3%82%AC%E3%82%A4%E3%83%89-%E5%9F%BA%E7%A4%8E%E3%81%8B%E3%82%89%E5%BF%9C%E7%94%A8%E3%81%BE%E3%81%A7%E5%85%A8%E3%82%B7%E3%83%BC%E3%83%B3%E5%AF%BE%E5%BF%9C-1aa2f8445642/" style="display:inline-flex;align-items:center;justify-content:center;padding:6px 10px;border-radius:999px;border:1px solid #ccc;background:#f3f3f3;color:#555;font-size:12px;font-weight:600;line-height:1;text-decoration:none;"> æ—¥æœ¬èª </a></div></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">é¦–é </a> </span> <span>Swift Codable è§£ç¢¼å•é¡Œå…¨æ”»ç•¥ï½œå¤šå ´æ™¯ JSON è§£æèˆ‡éŒ¯èª¤å®¹å¿æŠ€å·§</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> æ–‡ç« </div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="æœå°‹..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">å–æ¶ˆ</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Swift Codable è§£ç¢¼å•é¡Œå…¨æ”»ç•¥ï½œå¤šå ´æ™¯ JSON è§£æèˆ‡éŒ¯èª¤å®¹å¿æŠ€å·§</h1><p class="post-desc fw-light mb-4">é‡å° iOS é–‹ç™¼ä¸­ Swift Codable è§£ç¢¼å¸¸è¦‹å›°å¢ƒï¼Œæä¾›å¤šå ´æ™¯ JSON è§£æå¯¦æˆ°ç¯„ä¾‹ï¼Œè§£æ±ºæ¬„ä½å¤šå‹ã€é™£åˆ—éŒ¯èª¤å®¹å¿èˆ‡è‡ªè¨‚æ—¥æœŸæ ¼å¼ç­‰å•é¡Œï¼ŒåŠ©ä½ æ‰“é€ ç©©å¥é«˜æ•ˆçš„è³‡æ–™æ˜ å°„æµç¨‹ã€‚</p><div class="post-meta text-muted"> <span> ç™¼ä½ˆæ–¼ <time data-ts="1592066038" data-df="YYYY å¹´ M æœˆ D æ—¥" data-bs-toggle="tooltip" data-bs-placement="bottom" > 2020 å¹´ 06 æœˆ 14 æ—¥ </time> </span> <span> æ›´æ–°æ–¼ <time data-ts="1712996675" data-df="YYYY å¹´ M æœˆ D æ—¥" data-bs-toggle="tooltip" data-bs-placement="bottom" > 2024 å¹´ 04 æœˆ 13 æ—¥ </time> </span><div class="mt-3 mb-3"> <a href="/assets/1aa2f8445642/1*9VYP3_Mhj9xsLKbgCwt6XQ.webp" class="popup img-link preview-img blur"><img data-src="/assets/1aa2f8445642/1*9VYP3_Mhj9xsLKbgCwt6XQ.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></div><div class="d-flex justify-content-between"> <span style="display: inline-flex; align-items: center; gap: 4px;"> ä½œè€… <em> <a href="https://www.linkedin.com/in/zhgchgli">ZhgChgLi</a> </em> | <em><a href="https://www.linkedin.com/in/zhgchgli" target="_blank">Senior Software Engineer</a></em><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" style="display: block; "><path fill="#007bff" d="M271.2 56C265.1 49.8 256.2 47.3 247.8 49.6C239.4 51.9 232.9 58.4 230.8 66.8L215.5 127C214.4 131.4 209.9 134 205.6 132.7L145.8 115.9C137.4 113.5 128.4 115.9 122.3 122C116.2 128.1 113.8 137.1 116.2 145.5L133.1 205.3C134.3 209.6 131.7 214.1 127.4 215.2L67.1 230.5C58.7 232.6 52.1 239.2 49.8 247.6C47.5 256 50 264.9 56.2 271L100.7 314.3C103.9 317.4 103.9 322.6 100.7 325.8L56.3 369.1C50.1 375.2 47.6 384.1 49.9 392.5C52.2 400.9 58.8 407.4 67.2 409.6L127.4 424.9C131.8 426 134.4 430.5 133.1 434.8L116.2 494.5C113.8 502.9 116.2 511.9 122.3 518C128.4 524.1 137.4 526.5 145.8 524.1L205.6 507.2C209.9 506 214.4 508.6 215.5 512.9L230.8 573.1C232.9 581.5 239.5 588.1 247.9 590.4C256.3 592.7 265.2 590.2 271.3 584L314.6 539.5C317.7 536.3 322.9 536.3 326.1 539.5L369.3 584C375.4 590.2 384.3 592.7 392.7 590.4C401.1 588.1 407.6 581.5 409.8 573.1L425.1 513C426.2 508.6 430.7 506 435 507.3L494.8 524.2C503.2 526.6 512.2 524.2 518.3 518.1C524.4 512 526.8 503 524.4 494.6L507.5 434.8C506.3 430.5 508.9 426 513.2 424.9L573.4 409.6C581.8 407.5 588.4 400.9 590.7 392.5C593 384.1 590.5 375.1 584.3 369.1L539.8 325.8C536.6 322.7 536.6 317.5 539.8 314.3L584.3 271C590.5 264.9 593 256 590.7 247.6C588.4 239.2 581.8 232.7 573.4 230.5L513.2 215.2C508.8 214.1 506.2 209.6 507.5 205.3L524.4 145.5C526.8 137.1 524.4 128.1 518.3 122C512.2 115.9 503.2 113.5 494.8 115.9L435 132.8C430.7 134 426.2 131.4 425.1 127.1L409.8 66.8C407.7 58.4 401.1 51.8 392.7 49.5C384.3 47.2 375.4 49.7 369.3 55.9L326 100.5C322.9 103.7 317.7 103.7 314.5 100.5L271.2 56z"/><path d="M250 330 l60 60 100 -140" stroke="#ffffff" stroke-width="40" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="4819 å­—" > <em>26 åˆ†é˜</em>é–±è®€</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Swift Codable è§£ç¢¼å•é¡Œå…¨æ”»ç•¥ï½œå¤šå ´æ™¯ JSON è§£æèˆ‡éŒ¯èª¤å®¹å¿æŠ€å·§</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">ç« ç¯€ç›®éŒ„ ğŸ”–</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Swift Codable è§£ç¢¼å•é¡Œå…¨æ”»ç•¥ï½œå¤šå ´æ™¯ JSON è§£æèˆ‡éŒ¯èª¤å®¹å¿æŠ€å·§</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><div aria-label="Language switch" style="display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;"><div aria-label="Views" style="display:inline-flex;align-items:center;gap:6px;font-size:.85rem;"> <span style="display:inline-flex;align-items:center;justify-content:center;"> ç€è¦½æ¬¡æ•¸: <span style="margin-left:4px;" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-original-title="æœ€å¾Œæ›´æ–°æ™‚é–“: 2026-01-03 10:56:11 +08:00"><u>4,053+</u></span> </span></div><div style="display:flex;align-items:center;justify-content:flex-end;gap:8px;flex-wrap:wrap;"> <a href="https://zhgchg.li/posts/zrealm-dev/swift-codable-%E8%A7%A3%E7%A2%BC%E5%95%8F%E9%A1%8C%E5%85%A8%E6%94%BB%E7%95%A5-%E5%A4%9A%E5%A0%B4%E6%99%AF-json-%E8%A7%A3%E6%9E%90%E8%88%87%E9%8C%AF%E8%AA%A4%E5%AE%B9%E5%BF%8D%E6%8A%80%E5%B7%A7-1aa2f8445642/" style="display:inline-flex;align-items:center;justify-content:center;padding:6px 10px;border-radius:999px;border:1px solid #dc3545;background:#dc3545;color:#fff !important;font-size:12px;font-weight:600;line-height:1;text-decoration:none;"> æ­£é«”ä¸­æ–‡ </a> <a href="https://zh-hans.zhgchg.li/posts/zrealm-dev/swift-codable-%E8%A7%A3%E7%A0%81%E9%97%AE%E9%A2%98%E5%85%A8%E6%94%BB%E7%95%A5-%E5%A4%9A%E5%9C%BA%E6%99%AF-json-%E8%A7%A3%E6%9E%90%E4%B8%8E%E9%94%99%E8%AF%AF%E5%AE%B9%E5%BF%8D%E6%8A%80%E5%B7%A7-1aa2f8445642/" style="display:inline-flex;align-items:center;justify-content:center;padding:6px 10px;border-radius:999px;border:1px solid rgba(220,53,69,.35);background:rgba(220,53,69,.08);color:#dc3545 !important;font-size:12px;font-weight:600;line-height:1;text-decoration:none;"> ç®€ä½“ä¸­æ–‡ </a> <a href="https://en.zhgchg.li/posts/zrealm-dev/codable-decode-issues-explained-master-decodable-for-real-world-ios-challenges-1aa2f8445642/" style="display:inline-flex;align-items:center;justify-content:center;padding:6px 10px;border-radius:999px;border:1px solid rgba(220,53,69,.35);background:rgba(220,53,69,.08);color:#dc3545 !important;font-size:12px;font-weight:600;line-height:1;text-decoration:none;"> English </a> <a href="https://jp.zhgchg.li/posts/zrealm%E3%81%AE%E9%96%8B%E7%99%BA/codable-%E3%83%87%E3%82%B3%E3%83%BC%E3%83%89%E5%95%8F%E9%A1%8C%E3%81%AE%E5%AE%8C%E5%85%A8%E3%82%AC%E3%82%A4%E3%83%89-%E5%9F%BA%E7%A4%8E%E3%81%8B%E3%82%89%E5%BF%9C%E7%94%A8%E3%81%BE%E3%81%A7%E5%85%A8%E3%82%B7%E3%83%BC%E3%83%B3%E5%AF%BE%E5%BF%9C-1aa2f8445642/" style="display:inline-flex;align-items:center;justify-content:center;padding:6px 10px;border-radius:999px;border:1px solid rgba(220,53,69,.35);background:rgba(220,53,69,.08);color:#dc3545 !important;font-size:12px;font-weight:600;line-height:1;text-decoration:none;"> æ—¥æœ¬èª </a></div></div><blockquote class="prompt-info"><p>åŸºæ–¼ SEO è€ƒé‡ï¼Œæœ¬æ–‡æ¨™é¡Œèˆ‡æè¿°ç¶“ AI èª¿æ•´ï¼ŒåŸå§‹ç‰ˆæœ¬è«‹åƒè€ƒå…§æ–‡ã€‚</p></blockquote><h4 id="zhgchgli-table-of-contents">æ–‡ç« ç›®éŒ„</h4><nav class="zhgchgli-toc"><ul class="zhgchgli-toc-list"><li><a href="#ç¾å¯¦ä½¿ç”¨-codable-ä¸Šé‡åˆ°çš„-decode-å•é¡Œå ´æ™¯ç¸½åŒ¯ä¸Š">ç¾å¯¦ä½¿ç”¨ Codable ä¸Šé‡åˆ°çš„ Decode å•é¡Œå ´æ™¯ç¸½åŒ¯(ä¸Š)</a></li><li><a href="#å‰è¨€">å‰è¨€</a></li><li><a href="#æ­£é¡Œ">æ­£é¡Œ</a></li><li class="has-children"><details><summary>é–‹å§‹ <a href="#é–‹å§‹">#</a></summary><ul><li><a href="#codingkeys-enum">CodingKeys Enum?</a></li><li><a href="#å›å‚³è³‡æ–™æ˜¯é™£åˆ—æ™‚">å›å‚³è³‡æ–™æ˜¯é™£åˆ—æ™‚</a></li><li><a href="#ç‚º-string-åŠ ä¸Šç´„æŸ">ç‚º String åŠ ä¸Šç´„æŸ</a></li><li><a href="#å–„ç”¨æ³›å‹åŒ…è£¹å›ºå®šçµæ§‹">å–„ç”¨æ³›å‹åŒ…è£¹å›ºå®šçµæ§‹</a></li><li><a href="#datetimestamp-è‡ªå‹•-decode">Date/Timestamp è‡ªå‹• Decode</a></li><li><a href="#åŸºæœ¬-decode-å¸¸è­˜">åŸºæœ¬ Decode å¸¸è­˜</a></li></ul></details></li><li class="has-children"><details><summary>é€²éšä½¿ç”¨ <a href="#é€²éšä½¿ç”¨">#</a></summary><ul><li><a href="#initfrom-decoder-decoder">init(from decoder: Decoder)</a></li><li><a href="#container-ä¹‹ä¸‹æˆ‘å€‘é‚„èƒ½ä½¿ç”¨-nestedcontainer--nestedunkeyedcontainer-å°ç‰¹å®šæ¬„ä½æ“ä½œ">Container ä¹‹ä¸‹æˆ‘å€‘é‚„èƒ½ä½¿ç”¨ nestedContainer / nestedUnkeyedContainer å°ç‰¹å®šæ¬„ä½æ“ä½œ</a></li><li><a href="#decode--decodeifpresent">Decode & DecodeIfPresent</a></li></ul></details></li><li class="has-children"><details><summary>ç¾å¯¦å ´æ™¯ <a href="#ç¾å¯¦å ´æ™¯">#</a></summary><ul><li><a href="#å ´æ™¯1-å‡è¨­ä»Šå¤©å°èª°ç•™è¨€å¯èƒ½æ˜¯å°æ­Œæ›²æˆ–å°äººç•™è¨€-targetobject-æ¬„ä½å¯èƒ½çš„å°è±¡æ˜¯-user-æˆ–-song--é‚£è©²å¦‚ä½•è™•ç†">å ´æ™¯1. å‡è¨­ä»Šå¤©å°èª°ç•™è¨€å¯èƒ½æ˜¯å°æ­Œæ›²æˆ–å°äººç•™è¨€ï¼Œ targetObject æ¬„ä½å¯èƒ½çš„å°è±¡æ˜¯ User æˆ– Song ? é‚£è©²å¦‚ä½•è™•ç†?</a></li><li><a href="#æ–¹å¼-a">æ–¹å¼ a.</a></li><li><a href="#æ–¹å¼-b">æ–¹å¼ b.</a></li><li><a href="#å ´æ™¯2-å‡è¨­è³‡æ–™é™£åˆ—æ¬„ä½æ”¾å¤šç¨®é¡å‹çš„è³‡æ–™è©²å¦‚ä½•-decode">å ´æ™¯2. å‡è¨­è³‡æ–™é™£åˆ—æ¬„ä½æ”¾å¤šç¨®é¡å‹çš„è³‡æ–™è©²å¦‚ä½• Decode?</a></li><li><a href="#å ´æ™¯3-json-string-æ¬„ä½æœ‰çµ¦å€¼æ™‚æ‰-decode">å ´æ™¯3. JSON String æ¬„ä½æœ‰çµ¦å€¼æ™‚æ‰ Decode</a></li><li><a href="#å ´æ™¯4-é™£åˆ—è³‡æ–™ç•¥é-decode-å¤±æ•—éŒ¯èª¤çš„è³‡æ–™">å ´æ™¯4. é™£åˆ—è³‡æ–™ç•¥é Decode å¤±æ•—éŒ¯èª¤çš„è³‡æ–™</a></li><li><a href="#å ´æ™¯5-æœ‰çš„æ¬„ä½æ˜¯æˆ‘ç¨‹å¼å…§éƒ¨è¦ä½¿ç”¨çš„è€Œéè¦-decode">å ´æ™¯5. æœ‰çš„æ¬„ä½æ˜¯æˆ‘ç¨‹å¼å…§éƒ¨è¦ä½¿ç”¨çš„ï¼Œè€Œéè¦ Decode</a></li><li><a href="#æ–¹å¼a-entitymodel">æ–¹å¼a. Entity/Model</a></li><li><a href="#æ–¹å¼b-init-è™•ç†">æ–¹å¼b. init è™•ç†</a></li><li><a href="#20200626-æ›´æ–°--ä¸‹ç¯‡-å ´æ™¯6api-response-ä½¿ç”¨-01-ä»£è¡¨-boolè©²å¦‚ä½•-decode">[2020/06/26 æ›´æ–°] â€” ä¸‹ç¯‡ å ´æ™¯6.API Response ä½¿ç”¨ 0/1 ä»£è¡¨ Boolï¼Œè©²å¦‚ä½• Decode?</a></li><li><a href="#20200626-æ›´æ–°--ä¸‹ç¯‡-å ´æ™¯7ä¸æƒ³è¦æ¯æ¯éƒ½è¦é‡å¯«-init-decoder">[2020/06/26 æ›´æ–°] â€” ä¸‹ç¯‡ å ´æ™¯7.ä¸æƒ³è¦æ¯æ¯éƒ½è¦é‡å¯« init decoder</a></li><li><a href="#20200626-æ›´æ–°--ä¸‹ç¯‡-å ´æ™¯8åˆç†çš„è™•ç†-response-null-æ¬„ä½è³‡æ–™">[2020/06/26 æ›´æ–°] â€” ä¸‹ç¯‡ å ´æ™¯8.åˆç†çš„è™•ç† Response Null æ¬„ä½è³‡æ–™</a></li></ul></details></li><li><a href="#ç¶œåˆå ´æ™¯ç¯„ä¾‹">ç¶œåˆå ´æ™¯ç¯„ä¾‹</a></li><li><a href="#ä¸‹ç¯‡å…¶ä»–å ´æ™¯å·²æ›´æ–°">(ä¸‹)ç¯‡ï¼†å…¶ä»–å ´æ™¯å·²æ›´æ–°</a></li><li><a href="#ç¸½çµ">ç¸½çµ</a></li><li><a href="#å»¶ä¼¸é–±è®€">å»¶ä¼¸é–±è®€</a></li></ul></nav><hr /><h3 id="ç¾å¯¦ä½¿ç”¨-codable-ä¸Šé‡åˆ°çš„-decode-å•é¡Œå ´æ™¯ç¸½åŒ¯ä¸Š"><span class="me-2">ç¾å¯¦ä½¿ç”¨ Codable ä¸Šé‡åˆ°çš„ Decode å•é¡Œå ´æ™¯ç¸½åŒ¯(ä¸Š)</span><a href="#ç¾å¯¦ä½¿ç”¨-codable-ä¸Šé‡åˆ°çš„-decode-å•é¡Œå ´æ™¯ç¸½åŒ¯ä¸Š" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>å¾åŸºç¤åˆ°é€²éšï¼Œæ·±å…¥ä½¿ç”¨ Decodable æ»¿è¶³æ‰€æœ‰å¯èƒ½æœƒé‡åˆ°çš„å•é¡Œå ´æ™¯</p><p><a href="/assets/1aa2f8445642/1*9VYP3_Mhj9xsLKbgCwt6XQ.webp" class="popup img-link blur"><img data-src="/assets/1aa2f8445642/1*9VYP3_Mhj9xsLKbgCwt6XQ.webp" alt="Photo by [Gustas Brazaitis](https://unsplash.com/@gustasbrazaitis){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjUzNiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Photo by <a href="https://unsplash.com/@gustasbrazaitis" target="_blank">Gustas Brazaitis</a></p><h3 id="å‰è¨€"><span class="me-2">å‰è¨€</span><a href="#å‰è¨€" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>å› æ‡‰å¾Œç«¯ API å‡ç´šéœ€è¦èª¿æ•´ API è™•ç†æ¶æ§‹ï¼Œè¿‘æœŸè¶é€™å€‹æ©Ÿæœƒä¸€ä½µå°‡åŸæœ¬ä½¿ç”¨ Objective-C æ’°å¯«çš„ç¶²è·¯è™•ç†æ¶æ§‹æ›´æ–°æˆ Swiftï¼›å› èªè¨€ä¸åŒï¼Œä¹Ÿä¸åœ¨é©åˆä½¿ç”¨åŸæœ¬çš„ <a href="https://github.com/RestKit/RestKit" target="_blank">Restkit</a> å¹«æˆ‘å€‘è™•ç†ç¶²è·¯å±¤æ‡‰ç”¨ï¼Œä½†ä¸å¾—ä¸èªª Restkit çš„åŠŸèƒ½åŒ…å±±åŒ…æµ·éå¸¸å¼·å¤§ï¼Œåœ¨å°ˆæ¡ˆä¸­ä¹Ÿç”¨å¾—æ´»éˆæ´»ç¾ï¼ŒåŸºæœ¬æ²’æœ‰å¤ªå¤§çš„å•é¡Œï¼›ä½†ç›¸å°çš„éå¸¸ç¬¨é‡ã€å¹¾ä¹å·²ä¸å†ç¶­è­·ã€ç´” Objective-Cï¼›æœªä¾†å‹¢å¿…ä¹Ÿè¦æ›´æ›çš„ã€‚</p><p>Restkit å¹¾ä¹å¹«æˆ‘å€‘è™•ç†å®Œæ‰€æœ‰ç¶²è·¯è«‹æ±‚ç›¸é—œæœƒéœ€è¦åˆ°çš„åŠŸèƒ½ï¼Œå¾åŸºæœ¬çš„ç¶²è·¯è™•ç†ã€API å‘¼å«ã€ç¶²è·¯è™•ç†ï¼Œåˆ° Response è™•ç† JSON String to Object ç”šè‡³æ˜¯ Object å­˜å…¥ Core Data å®ƒéƒ½èƒ½ä¸€èµ·è™•ç†å¯¦æ‰“å¯¦çš„ä¸€å€‹ Framework æ‰“åå€‹ã€‚</p><p>éš¨è‘—æ™‚ä»£çš„æ¼”é€²ï¼Œç›®å‰çš„ Framework å·²ä¸åœ¨ä¸»æ‰“ä¸€å€‹åŒ…å…¨éƒ¨ï¼Œæ›´å¤šçš„æ˜¯éˆæ´»ã€è¼•å·§ã€çµ„åˆï¼Œå¢åŠ æ›´å¤šå½ˆæ€§å‰µé€ æ›´å¤šè®ŠåŒ–ï¼›å› æ­¤å†æ›¿æ›æˆ Swift èªè¨€çš„åŒæ™‚ï¼Œæˆ‘å€‘é¸æ“‡ä½¿ç”¨ Moya ä½œç‚ºç¶²è·¯è™•ç†éƒ¨åˆ†çš„å¥—ä»¶ï¼Œå…¶ä»–æˆ‘å€‘éœ€è¦çš„åŠŸèƒ½å†é¸æ“‡å…¶ä»–æ–¹å¼é€²è¡Œçµ„åˆã€‚</p><h3 id="æ­£é¡Œ"><span class="me-2">æ­£é¡Œ</span><a href="#æ­£é¡Œ" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>é—œæ–¼ JSON String to Object Mapping éƒ¨åˆ†ï¼Œæˆ‘å€‘ä½¿ç”¨ Swift è‡ªå¸¶çš„ Codable (Decodable) å”è­° &amp; JSONDecoder é€²è¡Œè™•ç†ï¼›ä¸¦æ‹†åˆ† Entity/Model åŠ å¼·æ¬Šè²¬å€åˆ†ã€æ“ä½œåŠé–±è®€æ€§ã€å¦å¤– Code Base æ·· Objective-C å’Œ Swift ä¹Ÿè¦è€ƒé‡é€²å»ã€‚</p><blockquote><p><em>ï¼Š Encodable çš„éƒ¨ä»½çœç•¥ã€ç¯„ä¾‹å‡åªå±•ç¤ºå¯¦ä½œ Decodableï¼Œå¤§åŒå°ç•°ï¼Œå¯ä»¥ Decode åŸºæœ¬ä¹Ÿèƒ½ Encodeã€‚</em></p></blockquote><h3 id="é–‹å§‹"><span class="me-2">é–‹å§‹</span><a href="#é–‹å§‹" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>å‡è¨­æˆ‘å€‘åˆå§‹çš„ API Response JSON String å¦‚ä¸‹:</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123456</span><span class="p">,</span><span class="w">
  </span><span class="nl">"comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æ˜¯å‘Šäº”äººï¼Œä¸æ˜¯äº”å‘Šäºº!"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"target_object"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"song"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">99</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æŠ«æ˜Ÿæˆ´æœˆçš„æƒ³ä½ "</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"commenter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhgchgli"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhgchgli@gmail.com"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>ç”±ä¸Šç¯„ä¾‹æˆ‘å€‘å¯ä»¥æ‹†æˆï¼šUser/Song/Comment ä¸‰å€‹ Entity &amp; Modelï¼Œè®“æˆ‘å€‘çµ„åˆèƒ½è¤‡ç”¨ï¼Œç‚ºæ–¹ä¾¿å±•ç¤ºå…ˆå°‡ Entity/Model å¯«åœ¨åŒå€‹æª”æ¡ˆã€‚</p><p>User:</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="c1">// Entity:</span>
<span class="kd">struct</span> <span class="kt">UserEntity</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">var</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">email</span><span class="p">:</span> <span class="kt">String</span>
<span class="p">}</span>

<span class="c1">//Model:</span>
<span class="kd">class</span> <span class="kt">UserModel</span><span class="p">:</span> <span class="kt">NSObject</span> <span class="p">{</span>
    <span class="nf">init</span><span class="p">(</span><span class="n">_</span> <span class="nv">entity</span><span class="p">:</span> <span class="kt">UserEntity</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">id</span>
      <span class="k">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">name</span>
      <span class="k">self</span><span class="o">.</span><span class="n">email</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">email</span>
    <span class="p">}</span>
    <span class="k">var</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">var</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">email</span><span class="p">:</span> <span class="kt">String</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Song:</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c1">// Entity:</span>
<span class="kd">struct</span> <span class="kt">SongEntity</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">var</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
<span class="p">}</span>

<span class="c1">//Model:</span>
<span class="kd">class</span> <span class="kt">SongModel</span><span class="p">:</span> <span class="kt">NSObject</span> <span class="p">{</span>
    <span class="nf">init</span><span class="p">(</span><span class="n">_</span> <span class="nv">entity</span><span class="p">:</span> <span class="kt">SongEntity</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">id</span>
      <span class="k">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">name</span>
    <span class="p">}</span>
    <span class="k">var</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">var</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Comment:</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="c1">// Entity:</span>
<span class="kd">struct</span> <span class="kt">CommentEntity</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
    <span class="kd">enum</span> <span class="kt">CodingKeys</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">CodingKey</span> <span class="p">{</span>
      <span class="k">case</span> <span class="n">id</span>
      <span class="k">case</span> <span class="n">comment</span>
      <span class="k">case</span> <span class="n">targetObject</span> <span class="o">=</span> <span class="s">"target_object"</span>
      <span class="k">case</span> <span class="n">commenter</span>
    <span class="p">}</span>
    
    <span class="k">var</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">var</span> <span class="nv">comment</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">targetObject</span><span class="p">:</span> <span class="kt">SongEntity</span>
    <span class="k">var</span> <span class="nv">commenter</span><span class="p">:</span> <span class="kt">UserEntity</span>
<span class="p">}</span>

<span class="c1">//Model:</span>
<span class="kd">class</span> <span class="kt">CommentModel</span><span class="p">:</span> <span class="kt">NSObject</span> <span class="p">{</span>
    <span class="nf">init</span><span class="p">(</span><span class="n">_</span> <span class="nv">entity</span><span class="p">:</span> <span class="kt">CommentEntity</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">id</span>
      <span class="k">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">comment</span>
      <span class="k">self</span><span class="o">.</span><span class="n">targetObject</span> <span class="o">=</span> <span class="kt">SongModel</span><span class="p">(</span><span class="n">entity</span><span class="o">.</span><span class="n">targetObject</span><span class="p">)</span>
      <span class="k">self</span><span class="o">.</span><span class="n">commenter</span> <span class="o">=</span> <span class="kt">UserModel</span><span class="p">(</span><span class="n">entity</span><span class="o">.</span><span class="n">commenter</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">var</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">var</span> <span class="nv">comment</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">targetObject</span><span class="p">:</span> <span class="kt">SongModel</span>
    <span class="k">var</span> <span class="nv">commenter</span><span class="p">:</span> <span class="kt">UserModel</span>
<span class="p">}</span>
</pre></table></code></div></div><p>JSONDecoder:</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">jsonString</span> <span class="o">=</span> <span class="s">"{ </span><span class="se">\"</span><span class="s">id</span><span class="se">\"</span><span class="s">: 123456, </span><span class="se">\"</span><span class="s">comment</span><span class="se">\"</span><span class="s">: </span><span class="se">\"</span><span class="s">æ˜¯å‘Šäº”äººï¼Œä¸æ˜¯äº”å‘Šäºº!</span><span class="se">\"</span><span class="s">, </span><span class="se">\"</span><span class="s">target_object</span><span class="se">\"</span><span class="s">: { </span><span class="se">\"</span><span class="s">type</span><span class="se">\"</span><span class="s">: </span><span class="se">\"</span><span class="s">song</span><span class="se">\"</span><span class="s">, </span><span class="se">\"</span><span class="s">id</span><span class="se">\"</span><span class="s">: 99, </span><span class="se">\"</span><span class="s">name</span><span class="se">\"</span><span class="s">: </span><span class="se">\"</span><span class="s">æŠ«æ˜Ÿæˆ´æœˆçš„æƒ³ä½ </span><span class="se">\"</span><span class="s"> }, </span><span class="se">\"</span><span class="s">commenter</span><span class="se">\"</span><span class="s">: { </span><span class="se">\"</span><span class="s">type</span><span class="se">\"</span><span class="s">: </span><span class="se">\"</span><span class="s">user</span><span class="se">\"</span><span class="s">, </span><span class="se">\"</span><span class="s">id</span><span class="se">\"</span><span class="s">: 1, </span><span class="se">\"</span><span class="s">name</span><span class="se">\"</span><span class="s">: </span><span class="se">\"</span><span class="s">zhgchgli</span><span class="se">\"</span><span class="s">, </span><span class="se">\"</span><span class="s">email</span><span class="se">\"</span><span class="s">: </span><span class="se">\"</span><span class="s">zhgchgli@gmail.com</span><span class="se">\"</span><span class="s"> } }"</span>
<span class="k">let</span> <span class="nv">jsonDecoder</span> <span class="o">=</span> <span class="kt">JSONDecoder</span><span class="p">()</span>
<span class="k">do</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">result</span> <span class="o">=</span> <span class="k">try</span> <span class="n">jsonDecoder</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">CommentEntity</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="n">jsonString</span><span class="o">.</span><span class="nf">data</span><span class="p">(</span><span class="nv">using</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span><span class="o">!</span><span class="p">)</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><h4 id="codingkeys-enum"><span class="me-2">CodingKeys Enum?</span><a href="#codingkeys-enum" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>ç•¶æˆ‘å€‘çš„ JSON String Key Name èˆ‡ Entity Object Property Name ä¸ç›¸åŒ¹é…æ™‚å¯ä»¥åœ¨å…§éƒ¨åŠ ä¸€å€‹ CodingKeys æšèˆ‰é€²è¡Œå°æ‡‰ï¼Œç•¢ç«Ÿå¾Œç«¯è³‡æ–™æºçš„ Naming Convention ä¸æ˜¯æˆ‘å€‘å¯ä»¥æ§åˆ¶çš„ã€‚</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">case</span> <span class="kt">PropertyKeyName</span> <span class="o">=</span> <span class="s">"å¾Œç«¯æ¬„ä½åç¨±"</span>
<span class="k">case</span> <span class="kt">PropertyKeyName</span> <span class="c1">//ä¸æŒ‡å®šå‰‡é è¨­ä½¿ç”¨ PropertyKeyName ç‚ºå¾Œç«¯æ¬„ä½åç¨±</span>
</pre></table></code></div></div><p>ä¸€æ—¦åŠ å…¥ CodingKeys æšèˆ‰ï¼Œå‰‡å¿…é ˆåˆ—èˆ‰å‡ºæ‰€æœ‰é Optional çš„æ¬„ä½ï¼Œä¸èƒ½åªåˆ—èˆ‰æƒ³è¦å®¢è£½çš„ Keyã€‚</p><p>å¦å¤–ä¸€ç¨®æ–¹å¼æ˜¯è¨­å®š JSONDecoder çš„ keyDecodingStrategyï¼Œè‹¥ Response è³‡æ–™æ¬„ä½èˆ‡ Property Name åƒ…ç‚º <code class="language-plaintext highlighter-rouge">snake_case</code> &lt;-&gt; <code class="language-plaintext highlighter-rouge">camelCase</code> å€åˆ¥ï¼Œå¯ç›´æ¥è¨­å®š <code class="language-plaintext highlighter-rouge">.keyDecodingStrategy</code> = <code class="language-plaintext highlighter-rouge">.convertFromSnakeCase</code> å°±èƒ½è‡ªå‹•åŒ¹é… Mappingã€‚</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">jsonDecoder</span> <span class="o">=</span> <span class="kt">JSONDecoder</span><span class="p">()</span>
<span class="n">jsonDecoder</span><span class="o">.</span><span class="n">keyDecodingStrategy</span> <span class="o">=</span> <span class="o">.</span><span class="n">convertFromSnakeCase</span>
<span class="k">try</span> <span class="n">jsonDecoder</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">CommentEntity</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="n">jsonString</span><span class="o">.</span><span class="nf">data</span><span class="p">(</span><span class="nv">using</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span><span class="o">!</span><span class="p">)</span>
</pre></table></code></div></div><h4 id="å›å‚³è³‡æ–™æ˜¯é™£åˆ—æ™‚"><span class="me-2">å›å‚³è³‡æ–™æ˜¯é™£åˆ—æ™‚ï¼š</span><a href="#å›å‚³è³‡æ–™æ˜¯é™£åˆ—æ™‚" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">struct</span> <span class="kt">SongListEntity</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">songs</span><span class="p">:[</span><span class="kt">SongEntity</span><span class="p">]</span>
<span class="p">}</span>
</pre></table></code></div></div><h4 id="ç‚º-string-åŠ ä¸Šç´„æŸ"><span class="me-2">ç‚º String åŠ ä¸Šç´„æŸï¼š</span><a href="#ç‚º-string-åŠ ä¸Šç´„æŸ" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="kd">struct</span> <span class="kt">SongEntity</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
  <span class="k">var</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">Int</span>
  <span class="k">var</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
  <span class="k">var</span> <span class="nv">type</span><span class="p">:</span> <span class="kt">SongType</span>
  
  <span class="kd">enum</span> <span class="kt">SongType</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">rock</span>
    <span class="k">case</span> <span class="n">pop</span>
    <span class="k">case</span> <span class="n">country</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>é©ç”¨æ–¼æœ‰é™ç¯„åœçš„å­—ä¸²é¡å‹ï¼Œå¯«æˆ Enum æ–¹ä¾¿æˆ‘å€‘å‚³éã€ä½¿ç”¨ï¼›è‹¥å‡ºç¾ç‚ºåˆ—èˆ‰çš„å€¼æœƒ Decode å¤±æ•—ï¼</p><h4 id="å–„ç”¨æ³›å‹åŒ…è£¹å›ºå®šçµæ§‹"><span class="me-2">å–„ç”¨æ³›å‹åŒ…è£¹å›ºå®šçµæ§‹ï¼š</span><a href="#å–„ç”¨æ³›å‹åŒ…è£¹å›ºå®šçµæ§‹" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>å‡è¨­å¤šç­†å›å‚³çš„ JSON String å›ºå®šæ ¼å¼ç‚ºï¼š</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="nl">"offset"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"limit"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"song"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>å³å¯ç”¨æ³›å‹æ–¹å¼åŒ…è£¹èµ·ä¾†ï¼š</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kd">struct</span> <span class="kt">PageEntity</span><span class="o">&lt;</span><span class="kt">E</span><span class="p">:</span> <span class="kt">Decodable</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">count</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">var</span> <span class="nv">offset</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">var</span> <span class="nv">limit</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">var</span> <span class="nv">results</span><span class="p">:</span> <span class="p">[</span><span class="kt">E</span><span class="p">]</span>
<span class="p">}</span>
</pre></table></code></div></div><p>ä½¿ç”¨ï¼š <code class="language-plaintext highlighter-rouge">PageEntity&lt;Song&gt;.self</code></p><h4 id="datetimestamp-è‡ªå‹•-decode"><span class="me-2">Date/Timestamp è‡ªå‹• Decodeï¼š</span><a href="#datetimestamp-è‡ªå‹•-decode" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>è¨­å®š <code class="language-plaintext highlighter-rouge">JSONDecoder</code> çš„ <code class="language-plaintext highlighter-rouge">dateDecodingStrategy</code></p><ul><li><code class="language-plaintext highlighter-rouge">.secondsSince1970/.millisecondsSince1970</code> : unix timestamp<li><code class="language-plaintext highlighter-rouge">.deferredToDate</code> : è˜‹æœçš„ timestampï¼Œç½•ç”¨ï¼Œä¸åŒæ–¼ unix timestampï¼Œé€™æ˜¯å¾ 2001/01/01 èµ·ç®—<li><code class="language-plaintext highlighter-rouge">.iso8601</code> : ISO 8601 æ—¥æœŸæ ¼å¼<li><code class="language-plaintext highlighter-rouge">.formatted(DateFormatter)</code> : ä¾ç…§å‚³å…¥çš„ DateFormatter Decode Date<li><code class="language-plaintext highlighter-rouge">.custom</code> : è‡ªè¨‚ Date Decode é‚è¼¯</ul><p><strong>.cutstom ç¯„ä¾‹ï¼šå‡è¨­ API æœƒå›å‚³ YYYY/MM/DD å’Œ ISO 8601 å…©ç¨®æ ¼å¼ï¼Œå…©ä¸­éƒ½è¦èƒ½ Decodeï¼š</strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="k">var</span> <span class="nv">dateFormatter</span> <span class="o">=</span> <span class="kt">DateFormatter</span><span class="p">()</span>
<span class="k">var</span> <span class="nv">iso8601DateFormatter</span> <span class="o">=</span> <span class="kt">ISO8601DateFormatter</span><span class="p">()</span>

<span class="k">let</span> <span class="nv">decoder</span><span class="p">:</span> <span class="kt">JSONDecoder</span> <span class="o">=</span> <span class="kt">JSONDecoder</span><span class="p">()</span>
<span class="n">decoder</span><span class="o">.</span><span class="n">dateDecodingStrategy</span> <span class="o">=</span> <span class="o">.</span><span class="nf">custom</span><span class="p">({</span> <span class="p">(</span><span class="n">decoder</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Date</span> <span class="k">in</span>
    <span class="k">let</span> <span class="nv">container</span> <span class="o">=</span> <span class="k">try</span> <span class="n">decoder</span><span class="o">.</span><span class="nf">singleValueContainer</span><span class="p">()</span>
    <span class="k">let</span> <span class="nv">dateString</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">String</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
    
    <span class="c1">//ISO8601:</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">date</span> <span class="o">=</span> <span class="n">iso8601DateFormatter</span><span class="o">.</span><span class="nf">date</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">dateString</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">date</span>
    <span class="p">}</span>
    
    <span class="c1">//YYYY-MM-DD:</span>
    <span class="n">dateFormatter</span><span class="o">.</span><span class="n">dateFormat</span> <span class="o">=</span> <span class="s">"yyyy-MM-dd"</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">date</span> <span class="o">=</span> <span class="n">dateFormatter</span><span class="o">.</span><span class="nf">date</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">dateString</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">date</span>
    <span class="p">}</span>
    
    <span class="k">throw</span> <span class="kt">DecodingError</span><span class="o">.</span><span class="nf">dataCorruptedError</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="n">container</span><span class="p">,</span> <span class="nv">debugDescription</span><span class="p">:</span> <span class="s">"Cannot decode date string </span><span class="se">\(</span><span class="n">dateString</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
<span class="p">})</span>

<span class="k">let</span> <span class="nv">result</span> <span class="o">=</span> <span class="k">try</span> <span class="n">jsonDecoder</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">CommentEntity</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="n">jsonString</span><span class="o">.</span><span class="nf">data</span><span class="p">(</span><span class="nv">using</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span><span class="o">!</span><span class="p">)</span>
</pre></table></code></div></div><blockquote><p><em>ï¼ŠDateFormatter åœ¨ init æ™‚éå¸¸æ¶ˆè€—æ€§èƒ½ï¼Œç›¡å¯èƒ½é‡è¤‡ä½¿ç”¨ã€‚</em></p></blockquote><h4 id="åŸºæœ¬-decode-å¸¸è­˜"><span class="me-2">åŸºæœ¬ Decode å¸¸è­˜ï¼š</span><a href="#åŸºæœ¬-decode-å¸¸è­˜" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li>Decodable Protocol å…§çš„çš„æ¬„ä½é¡å‹(struct/class/enum)ï¼Œéƒ½é ˆå¯¦ä½œ Decodable Protocolï¼›äº¦æˆ–æ˜¯åœ¨ init decoder æ™‚è³¦äºˆå€¼<li>æ¬„ä½é¡å‹ä¸ç›¸ç¬¦æ™‚æœƒ Decode å¤±æ•—<li>Decodable Object ä¸­æ¬„ä½è¨­ç‚º Optional çš„è©±å‰‡ç‚ºå¯æœ‰å¯ç„¡ï¼Œæœ‰çµ¦å°± Decode<li>Optional æ¬„ä½å¯æ¥å—: JSON String ç„¡æ¬„ä½ã€æœ‰çµ¦ä½†çµ¦ nil<li>ç©ºç™½ã€0 ä¸ç­‰æ–¼ nilï¼Œnil æ˜¯ nilï¼›å¼±å‹åˆ¥çš„å¾Œç«¯ API éœ€æ³¨æ„ï¼<li>é è¨­ Decodable Object ä¸­æœ‰åˆ—èˆ‰ä¸”é Optional çš„æ¬„ä½ï¼Œè‹¥ JSON String æ²’çµ¦æœƒ Decode å¤±æ•—ï¼ˆå¾ŒçºŒæœƒèªªæ˜å¦‚ä½•è™•ç†ï¼‰<li>é è¨­ é‡åˆ° Decode å¤±æ•—æœƒç›´æ¥ä¸­æ–·è·³å‡ºï¼Œç„¡æ³•å–®ç´”è·³éæœ‰èª¤çš„è³‡æ–™ï¼ˆå¾ŒçºŒæœƒèªªæ˜å¦‚ä½•è™•ç†ï¼‰</ol><p><a href="/assets/1aa2f8445642/1*B-j47uMMshXozF32msbRtg.webp" class="popup img-link blur"><img data-src="/assets/1aa2f8445642/1*B-j47uMMshXozF32msbRtg.webp" alt="[å·¦ï¼šâ€â€ å³ï¼šnil](https://josjong.com/2017/10/16/null-vs-empty-strings-why-oracle-was-right-and-apple-is-not/){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9Ijc4NSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="https://josjong.com/2017/10/16/null-vs-empty-strings-why-oracle-was-right-and-apple-is-not/" target="_blank">å·¦ï¼šâ€â€ / å³ï¼šnil</a></p><h3 id="é€²éšä½¿ç”¨"><span class="me-2">é€²éšä½¿ç”¨</span><a href="#é€²éšä½¿ç”¨" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>åˆ°æ­¤ç‚ºæ­¢åŸºæœ¬çš„ä½¿ç”¨å·²ç¶“å®Œæˆäº†ï¼Œä½†ç¾å¯¦ä¸–ç•Œä¸æœƒé‚£éº¼ç°¡å–®ï¼›ä»¥ä¸‹åˆ—èˆ‰å¹¾å€‹é€²éšæœƒé‡åˆ°çš„å ´æ™¯ä¸¦æå‡ºé©ç”¨ Codable çš„è§£æ±ºæ–¹æ¡ˆï¼Œå¾é€™é‚Šé–‹å§‹æˆ‘å€‘å°±ç„¡æ³•é åŸå§‹çš„ Decode å¹«æˆ‘å€‘è£œ Mapping äº†ï¼Œè¦è‡ªè¡Œå¯¦ä½œ <code class="language-plaintext highlighter-rouge">init(from decoder: Decoder)</code> å®¢è£½ Decode æ“ä½œã€‚</p><blockquote><p><em>ï¼Šé€™é‚Šæš«æ™‚å…ˆåªå±•ç¤º Entity çš„éƒ¨åˆ†ï¼ŒModel é‚„ç”¨ä¸åˆ°ã€‚</em></p></blockquote><h4 id="initfrom-decoder-decoder"><span class="me-2">init(from decoder: Decoder)</span><a href="#initfrom-decoder-decoder" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>init decoderï¼Œå¿…é ˆè³¦äºˆæ‰€æœ‰é Optional çš„æ¬„ä½åˆå§‹å€¼ï¼ˆå°±æ˜¯ init å•¦ï¼ï¼‰ã€‚</p><p>è‡ªè¨‚ Decode æ“ä½œæ™‚ï¼Œæˆ‘å€‘éœ€è¦å¾ <code class="language-plaintext highlighter-rouge">decoder</code> ä¸­å–å¾— <code class="language-plaintext highlighter-rouge">container</code> å‡ºä¾†æ“ä½œå–å€¼ï¼Œ <code class="language-plaintext highlighter-rouge">container</code> æœ‰ä¸‰ç¨®å–å¾—å…§å®¹çš„é¡å‹ã€‚</p><p><a href="/assets/1aa2f8445642/1*U2Rt9KZq3Vw_lkZkJl7t_Q.webp" class="popup img-link blur"><img data-src="/assets/1aa2f8445642/1*U2Rt9KZq3Vw_lkZkJl7t_Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2ODEiIGhlaWdodD0iMjQxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><strong>ç¬¬ä¸€ç¨® container(keyedBy: CodingKeys.self)</strong> <strong>ä¾ç…§ CodingKeys æ“ä½œï¼š</strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="kd">struct</span> <span class="kt">SongEntity</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">var</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
    
    <span class="kd">enum</span> <span class="kt">CodingKeys</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">CodingKey</span> <span class="p">{</span>
      <span class="k">case</span> <span class="n">id</span>
      <span class="k">case</span> <span class="n">name</span>
    <span class="p">}</span>
    
    <span class="nf">init</span><span class="p">(</span><span class="n">from</span> <span class="nv">decoder</span><span class="p">:</span> <span class="kt">Decoder</span><span class="p">)</span> <span class="k">throws</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">container</span> <span class="o">=</span> <span class="k">try</span> <span class="n">decoder</span><span class="o">.</span><span class="nf">container</span><span class="p">(</span><span class="nv">keyedBy</span><span class="p">:</span> <span class="kt">CodingKeys</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Int</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="c1">//åƒæ•¸ 1 æ¥å—æ”¯æ´ï¼šå¯¦ä½œ Decodable çš„é¡åˆ¥</span>
        <span class="c1">//åƒæ•¸ 2 CodingKeys</span>
        
        <span class="k">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">String</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>ç¬¬äºŒç¨® singleValueContainer</strong> <strong>å°‡æ•´åŒ…å–å‡ºæ“ä½œï¼ˆå–®å€¼ï¼‰ï¼š</strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="kd">enum</span> <span class="kt">HandsomeLevel</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
    <span class="k">case</span> <span class="nf">handsome</span><span class="p">(</span><span class="kt">String</span><span class="p">)</span>
    <span class="k">case</span> <span class="nf">normal</span><span class="p">(</span><span class="kt">String</span><span class="p">)</span>
    <span class="nf">init</span><span class="p">(</span><span class="n">from</span> <span class="nv">decoder</span><span class="p">:</span> <span class="kt">Decoder</span><span class="p">)</span> <span class="k">throws</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">container</span> <span class="o">=</span> <span class="k">try</span> <span class="n">decoder</span><span class="o">.</span><span class="nf">singleValueContainer</span><span class="p">()</span>
        <span class="k">let</span> <span class="nv">name</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">String</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s">"zhgchgli"</span> <span class="p">{</span>
            <span class="k">self</span> <span class="o">=</span> <span class="o">.</span><span class="nf">handsome</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">self</span> <span class="o">=</span> <span class="o">.</span><span class="nf">normal</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">UserEntity</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">var</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">HandsomeLevel</span>
    <span class="k">var</span> <span class="nv">email</span><span class="p">:</span> <span class="kt">String</span>
    
    <span class="kd">enum</span> <span class="kt">CodingKeys</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">CodingKey</span> <span class="p">{</span>
        <span class="k">case</span> <span class="n">id</span>
        <span class="k">case</span> <span class="n">name</span>
        <span class="k">case</span> <span class="n">email</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>é©ç”¨æ–¼ Associated Value Enum æ¬„ä½é¡å‹ï¼Œä¾‹å¦‚ name é‚„è‡ªå¸¶å¸¥æ°£ç¨‹åº¦ï¼</p><p><strong>ç¬¬ä¸‰ç¨® unkeyedContainer</strong> <strong>å°‡æ•´åŒ…è¦–ç‚ºä¸€åŒ…é™£åˆ—ï¼š</strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="kd">struct</span> <span class="kt">ListEntity</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">items</span><span class="p">:[</span><span class="kt">Decodable</span><span class="p">]</span>
    <span class="nf">init</span><span class="p">(</span><span class="n">from</span> <span class="nv">decoder</span><span class="p">:</span> <span class="kt">Decoder</span><span class="p">)</span> <span class="k">throws</span> <span class="p">{</span>
        <span class="k">var</span> <span class="nv">unkeyedContainer</span> <span class="o">=</span> <span class="k">try</span> <span class="n">decoder</span><span class="o">.</span><span class="nf">unkeyedContainer</span><span class="p">()</span>
        <span class="k">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="o">!</span><span class="n">unkeyedContainer</span><span class="o">.</span><span class="n">isAtEnd</span> <span class="p">{</span>
            <span class="c1">//unkeyedContainer å…§éƒ¨æŒ‡é‡æœƒè‡ªå‹•åœ¨ decode æ“ä½œå¾ŒæŒ‡å‘ä¸‹ä¸€å€‹å°è±¡</span>
            <span class="c1">//ç›´åˆ°æŒ‡å‘çµå°¾å³ä»£è¡¨éæ­·çµæŸ</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">id</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">unkeyedContainer</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Int</span><span class="o">.</span><span class="k">self</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">items</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="k">let</span> <span class="nv">name</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">unkeyedContainer</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">String</span><span class="o">.</span><span class="k">self</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">items</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">let</span> <span class="nv">jsonString</span> <span class="o">=</span> <span class="s">"[</span><span class="se">\"</span><span class="s">test</span><span class="se">\"</span><span class="s">,1234,5566]"</span>
<span class="k">let</span> <span class="nv">jsonDecoder</span> <span class="o">=</span> <span class="kt">JSONDecoder</span><span class="p">()</span>
<span class="k">let</span> <span class="nv">result</span> <span class="o">=</span> <span class="k">try</span> <span class="n">jsonDecoder</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">ListEntity</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="n">jsonString</span><span class="o">.</span><span class="nf">data</span><span class="p">(</span><span class="nv">using</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span><span class="o">!</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></table></code></div></div><p>é©ç”¨ä¸å›ºå®šé¡å‹çš„é™£åˆ—æ¬„ä½ã€‚</p><h4 id="container-ä¹‹ä¸‹æˆ‘å€‘é‚„èƒ½ä½¿ç”¨-nestedcontainer--nestedunkeyedcontainer-å°ç‰¹å®šæ¬„ä½æ“ä½œ"><span class="me-2">Container ä¹‹ä¸‹æˆ‘å€‘é‚„èƒ½ä½¿ç”¨ nestedContainer / nestedUnkeyedContainer å°ç‰¹å®šæ¬„ä½æ“ä½œï¼š</span><a href="#container-ä¹‹ä¸‹æˆ‘å€‘é‚„èƒ½ä½¿ç”¨-nestedcontainer--nestedunkeyedcontainer-å°ç‰¹å®šæ¬„ä½æ“ä½œ" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><blockquote><p><strong><em>ï¼Šå°‡è³‡æ–™æ¬„ä½æ‰å¹³åŒ–ï¼ˆé¡ä¼¼ flatMapï¼‰</em></strong></p></blockquote><p><a href="/assets/1aa2f8445642/1*IE_dCAdXGDMaW-nSNT2ITg.webp" class="popup img-link blur"><img data-src="/assets/1aa2f8445642/1*IE_dCAdXGDMaW-nSNT2ITg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTExIiBoZWlnaHQ9IjI0MSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre><span class="kd">struct</span> <span class="kt">ListEntity</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
    
    <span class="kd">enum</span> <span class="kt">CodingKeys</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">CodingKey</span> <span class="p">{</span>
        <span class="k">case</span> <span class="n">items</span>
        <span class="k">case</span> <span class="n">date</span>
        <span class="k">case</span> <span class="n">name</span>
        <span class="k">case</span> <span class="n">target</span>
    <span class="p">}</span>
    
    <span class="kd">enum</span> <span class="kt">PredictKey</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">CodingKey</span> <span class="p">{</span>
        <span class="k">case</span> <span class="n">type</span>
    <span class="p">}</span>
    
    <span class="k">var</span> <span class="nv">date</span><span class="p">:</span> <span class="kt">Date</span>
    <span class="k">var</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">items</span><span class="p">:</span> <span class="p">[</span><span class="kt">Decodable</span><span class="p">]</span>
    <span class="k">var</span> <span class="nv">target</span><span class="p">:</span> <span class="kt">Decodable</span>
    
    <span class="nf">init</span><span class="p">(</span><span class="n">from</span> <span class="nv">decoder</span><span class="p">:</span> <span class="kt">Decoder</span><span class="p">)</span> <span class="k">throws</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">container</span> <span class="o">=</span> <span class="k">try</span> <span class="n">decoder</span><span class="o">.</span><span class="nf">container</span><span class="p">(</span><span class="nv">keyedBy</span><span class="p">:</span> <span class="kt">CodingKeys</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
        
        <span class="k">self</span><span class="o">.</span><span class="n">date</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Date</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">date</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">String</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
        <span class="k">let</span> <span class="nv">nestedContainer</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">nestedContainer</span><span class="p">(</span><span class="nv">keyedBy</span><span class="p">:</span> <span class="kt">PredictKey</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">target</span><span class="p">)</span>
        
        <span class="k">let</span> <span class="nv">type</span> <span class="o">=</span> <span class="k">try</span> <span class="n">nestedContainer</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">String</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">type</span> <span class="o">==</span> <span class="s">"song"</span> <span class="p">{</span>
            <span class="k">self</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">SongEntity</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">target</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">self</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">UserEntity</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">target</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">var</span> <span class="nv">unkeyedContainer</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">nestedUnkeyedContainer</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">items</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="o">!</span><span class="n">unkeyedContainer</span><span class="o">.</span><span class="n">isAtEnd</span> <span class="p">{</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">song</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">unkeyedContainer</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">SongEntity</span><span class="o">.</span><span class="k">self</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">items</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">song</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="k">let</span> <span class="nv">user</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">unkeyedContainer</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">UserEntity</span><span class="o">.</span><span class="k">self</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">items</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>å­˜å–ã€Decode ä¸åŒéšå±¤çš„ç‰©ä»¶ï¼Œç¯„ä¾‹å±•ç¤º target/items ä½¿ç”¨ nestedContainer flat å‡º type å†ä¾ç…§ type å»åšå°æ‡‰çš„ decodeã€‚</p><h4 id="decode--decodeifpresent"><span class="me-2">Decode &amp; DecodeIfPresent</span><a href="#decode--decodeifpresent" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><strong>DecodeIfPresentï¼š</strong> Response æœ‰çµ¦è³‡æ–™æ¬„ä½æ™‚æ‰æœƒé€²è¡Œ Decodeï¼ˆCodable Property è¨­ Optional æ™‚ï¼‰<li><strong>Decodeï¼šé€²è¡Œ</strong> Decode æ“ä½œï¼Œè‹¥ Response ç„¡çµ¦è³‡æ–™æ¬„ä½æœƒæ‹‹å‡º Error</ul><blockquote><p><strong><em>ï¼Šä»¥ä¸Šåªæ˜¯ç°¡å–®ä»‹ç´¹ä¸€ä¸‹ init decoderã€container æœ‰å“ªäº›æ–¹æ³•ã€åŠŸèƒ½ï¼Œçœ‹ä¸æ‡‚ä¹Ÿæ²’é—œä¿‚ï¼Œæˆ‘å€‘ç›´æ¥é€²å…¥ç¾å¯¦å ´æ™¯ï¼›åœ¨ç¯„ä¾‹ä¸­æ„Ÿå—çµ„åˆèµ·ä¾†çš„æ“ä½œæ–¹å¼ã€‚</em></strong></p></blockquote><h3 id="ç¾å¯¦å ´æ™¯"><span class="me-2">ç¾å¯¦å ´æ™¯</span><a href="#ç¾å¯¦å ´æ™¯" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>å›åˆ°åŸæœ¬çš„ç¯„ä¾‹ JSON Stringã€‚</p><h4 id="å ´æ™¯1-å‡è¨­ä»Šå¤©å°èª°ç•™è¨€å¯èƒ½æ˜¯å°æ­Œæ›²æˆ–å°äººç•™è¨€-targetobject-æ¬„ä½å¯èƒ½çš„å°è±¡æ˜¯-user-æˆ–-song--é‚£è©²å¦‚ä½•è™•ç†"><span class="me-2">å ´æ™¯1. å‡è¨­ä»Šå¤©å°èª°ç•™è¨€å¯èƒ½æ˜¯å°æ­Œæ›²æˆ–å°äººç•™è¨€ï¼Œ <code class="language-plaintext highlighter-rouge">targetObject</code> æ¬„ä½å¯èƒ½çš„å°è±¡æ˜¯ <code class="language-plaintext highlighter-rouge">User</code> æˆ– <code class="language-plaintext highlighter-rouge">Song</code> ? é‚£è©²å¦‚ä½•è™•ç†?</span><a href="#å ´æ™¯1-å‡è¨­ä»Šå¤©å°èª°ç•™è¨€å¯èƒ½æ˜¯å°æ­Œæ›²æˆ–å°äººç•™è¨€-targetobject-æ¬„ä½å¯èƒ½çš„å°è±¡æ˜¯-user-æˆ–-song--é‚£è©²å¦‚ä½•è™•ç†" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123456</span><span class="p">,</span><span class="w">
      </span><span class="nl">"comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æ˜¯å‘Šäº”äººï¼Œä¸æ˜¯äº”å‘Šäºº!"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"target_object"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"song"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">99</span><span class="p">,</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æŠ«æ˜Ÿæˆ´æœˆçš„æƒ³ä½ "</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"commenter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhgchgli"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhgchgli@gmail.com"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">55</span><span class="p">,</span><span class="w">
      </span><span class="nl">"comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"66666!"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"target_object"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhgchgli"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"commenter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"aaaa"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"aaaa@gmail.com"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><h4 id="æ–¹å¼-a"><span class="me-2">æ–¹å¼ a.</span><a href="#æ–¹å¼-a" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>ä½¿ç”¨ Enum åšç‚ºå®¹å™¨ Decodeã€‚</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre><span class="kd">struct</span> <span class="kt">CommentEntity</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
    
    <span class="kd">enum</span> <span class="kt">CodingKeys</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">CodingKey</span> <span class="p">{</span>
      <span class="k">case</span> <span class="n">id</span>
      <span class="k">case</span> <span class="n">comment</span>
      <span class="k">case</span> <span class="n">targetObject</span> <span class="o">=</span> <span class="s">"target_object"</span>
      <span class="k">case</span> <span class="n">commenter</span>
    <span class="p">}</span>
    
    <span class="k">var</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">var</span> <span class="nv">comment</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">targetObject</span><span class="p">:</span> <span class="kt">TargetObject</span>
    <span class="k">var</span> <span class="nv">commenter</span><span class="p">:</span> <span class="kt">UserEntity</span>
    
    <span class="kd">enum</span> <span class="kt">TargetObject</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
        <span class="k">case</span> <span class="nf">song</span><span class="p">(</span><span class="kt">SongEntity</span><span class="p">)</span>
        <span class="k">case</span> <span class="nf">user</span><span class="p">(</span><span class="kt">UserEntity</span><span class="p">)</span>
        
        <span class="kd">enum</span> <span class="kt">PredictKey</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">CodingKey</span> <span class="p">{</span>
            <span class="k">case</span> <span class="n">type</span>
        <span class="p">}</span>
        
        <span class="kd">enum</span> <span class="kt">TargetObjectType</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">Decodable</span> <span class="p">{</span>
            <span class="k">case</span> <span class="n">song</span>
            <span class="k">case</span> <span class="n">user</span>
        <span class="p">}</span>
        
        <span class="nf">init</span><span class="p">(</span><span class="n">from</span> <span class="nv">decoder</span><span class="p">:</span> <span class="kt">Decoder</span><span class="p">)</span> <span class="k">throws</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">container</span> <span class="o">=</span> <span class="k">try</span> <span class="n">decoder</span><span class="o">.</span><span class="nf">container</span><span class="p">(</span><span class="nv">keyedBy</span><span class="p">:</span> <span class="kt">PredictKey</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
            <span class="k">let</span> <span class="nv">singleValueContainer</span> <span class="o">=</span> <span class="k">try</span> <span class="n">decoder</span><span class="o">.</span><span class="nf">singleValueContainer</span><span class="p">()</span>
            <span class="k">let</span> <span class="nv">targetObjectType</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">TargetObjectType</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">type</span><span class="p">)</span>
            
            <span class="k">switch</span> <span class="n">targetObjectType</span> <span class="p">{</span>
            <span class="k">case</span> <span class="o">.</span><span class="nv">song</span><span class="p">:</span>
                <span class="k">let</span> <span class="nv">song</span> <span class="o">=</span> <span class="k">try</span> <span class="n">singleValueContainer</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">SongEntity</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
                <span class="k">self</span> <span class="o">=</span> <span class="o">.</span><span class="nf">song</span><span class="p">(</span><span class="n">song</span><span class="p">)</span>
            <span class="k">case</span> <span class="o">.</span><span class="nv">user</span><span class="p">:</span>
                <span class="k">let</span> <span class="nv">user</span> <span class="o">=</span> <span class="k">try</span> <span class="n">singleValueContainer</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">UserEntity</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
                <span class="k">self</span> <span class="o">=</span> <span class="o">.</span><span class="nf">user</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>æˆ‘å€‘å°‡ <code class="language-plaintext highlighter-rouge">targetObject</code> çš„å±¬æ€§æ›æˆ Associated Value Enumï¼Œåœ¨ Decode æ™‚æ‰æ±ºå®š Enum å…§è¦æ”¾ä»€éº¼å…§å®¹ã€‚</p><p>æ ¸å¿ƒå¯¦è¸æ˜¯å»ºç«‹ä¸€å€‹ç¬¦åˆ Decodable çš„ Enum åšç‚ºå®¹å™¨ï¼Œdecode æ™‚å…ˆå–é—œéµæ¬„ä½å‡ºä¾†åˆ¤æ–·(ç¯„ä¾‹ JSON String ä¸­çš„ <code class="language-plaintext highlighter-rouge">type</code> æ¬„ä½)ï¼Œè‹¥ç‚º <code class="language-plaintext highlighter-rouge">Song</code> å‰‡ä½¿ç”¨ singleValueContainer å°‡æ•´åŒ…è§£æˆ <code class="language-plaintext highlighter-rouge">SongEntity</code> ï¼Œè‹¥ç‚º <code class="language-plaintext highlighter-rouge">User</code> äº¦ç„¶ã€‚</p><p><strong>è¦ä½¿ç”¨æ™‚å†å¾ Enum ä¸­å–å‡ºï¼š</strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1">//if case let</span>
<span class="k">if</span> <span class="k">case</span> <span class="k">let</span> <span class="nv">CommentEntity</span><span class="o">.</span><span class="kt">TargetObject</span><span class="o">.</span><span class="nf">user</span><span class="p">(</span><span class="n">user</span><span class="p">)</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">targetObject</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="k">case</span> <span class="k">let</span> <span class="nv">CommentEntity</span><span class="o">.</span><span class="kt">TargetObject</span><span class="o">.</span><span class="nf">song</span><span class="p">(</span><span class="n">song</span><span class="p">)</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">targetObject</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">song</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">//switch case let</span>
<span class="k">switch</span> <span class="n">result</span><span class="o">.</span><span class="n">targetObject</span> <span class="p">{</span>
<span class="k">case</span> <span class="o">.</span><span class="nf">song</span><span class="p">(</span><span class="k">let</span> <span class="nv">song</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">song</span><span class="p">)</span>
<span class="k">case</span> <span class="o">.</span><span class="nf">user</span><span class="p">(</span><span class="k">let</span> <span class="nv">user</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><h4 id="æ–¹å¼-b"><span class="me-2">æ–¹å¼ b.</span><a href="#æ–¹å¼-b" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>æ”¹å®£å‘Šæ¬„ä½å±¬æ€§ç‚º Base Classã€‚</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="kd">struct</span> <span class="kt">CommentEntity</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
    <span class="kd">enum</span> <span class="kt">CodingKeys</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">CodingKey</span> <span class="p">{</span>
      <span class="k">case</span> <span class="n">id</span>
      <span class="k">case</span> <span class="n">comment</span>
      <span class="k">case</span> <span class="n">targetObject</span> <span class="o">=</span> <span class="s">"target_object"</span>
      <span class="k">case</span> <span class="n">commenter</span>
    <span class="p">}</span>
    <span class="kd">enum</span> <span class="kt">PredictKey</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">CodingKey</span> <span class="p">{</span>
        <span class="k">case</span> <span class="n">type</span>
    <span class="p">}</span>
    
    <span class="k">var</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">var</span> <span class="nv">comment</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">targetObject</span><span class="p">:</span> <span class="kt">Decodable</span>
    <span class="k">var</span> <span class="nv">commenter</span><span class="p">:</span> <span class="kt">UserEntity</span>
    
    <span class="nf">init</span><span class="p">(</span><span class="n">from</span> <span class="nv">decoder</span><span class="p">:</span> <span class="kt">Decoder</span><span class="p">)</span> <span class="k">throws</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">container</span> <span class="o">=</span> <span class="k">try</span> <span class="n">decoder</span><span class="o">.</span><span class="nf">container</span><span class="p">(</span><span class="nv">keyedBy</span><span class="p">:</span> <span class="kt">CodingKeys</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Int</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">String</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">comment</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">commenter</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">UserEntity</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">commenter</span><span class="p">)</span>
        
        <span class="c1">//</span>
        <span class="k">let</span> <span class="nv">targetObjectContainer</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">nestedContainer</span><span class="p">(</span><span class="nv">keyedBy</span><span class="p">:</span> <span class="kt">PredictKey</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">targetObject</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">targetObjectType</span> <span class="o">=</span> <span class="k">try</span> <span class="n">targetObjectContainer</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">String</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">targetObjectType</span> <span class="o">==</span> <span class="s">"user"</span> <span class="p">{</span>
            <span class="k">self</span><span class="o">.</span><span class="n">targetObject</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">UserEntity</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">targetObject</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">self</span><span class="o">.</span><span class="n">targetObject</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">SongEntity</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">targetObject</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>åŸç†å·®ä¸å¤šï¼Œä½†é€™é‚Šå…ˆä½¿ç”¨ <code class="language-plaintext highlighter-rouge">nestedContainer</code> è¡é€²å» <code class="language-plaintext highlighter-rouge">targetObject</code> æ‹¿ <code class="language-plaintext highlighter-rouge">type</code> å‡ºä¾†åˆ¤æ–·ï¼Œå†æ±ºå®š <code class="language-plaintext highlighter-rouge">targetObject</code> è¦è§£ææˆä»€éº¼é¡å‹ã€‚</p><p><strong>è¦ä½¿ç”¨æ™‚å† Cast ï¼š</strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">if</span> <span class="k">let</span> <span class="nv">song</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">targetObject</span> <span class="k">as?</span> <span class="kt">Song</span> <span class="p">{</span>
  <span class="nf">print</span><span class="p">(</span><span class="n">song</span><span class="p">)</span>
<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="k">let</span> <span class="nv">user</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">targetObject</span> <span class="k">as?</span> <span class="kt">User</span> <span class="p">{</span>
  <span class="nf">print</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><h4 id="å ´æ™¯2-å‡è¨­è³‡æ–™é™£åˆ—æ¬„ä½æ”¾å¤šç¨®é¡å‹çš„è³‡æ–™è©²å¦‚ä½•-decode"><span class="me-2">å ´æ™¯2. å‡è¨­è³‡æ–™é™£åˆ—æ¬„ä½æ”¾å¤šç¨®é¡å‹çš„è³‡æ–™è©²å¦‚ä½• Decode?</span><a href="#å ´æ™¯2-å‡è¨­è³‡æ–™é™£åˆ—æ¬„ä½æ”¾å¤šç¨®é¡å‹çš„è³‡æ–™è©²å¦‚ä½•-decode" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>{
  "results": [
    {
      "type": "song",
      "id": 99,
      "name": "æŠ«æ˜Ÿæˆ´æœˆçš„æƒ³ä½ "
    },
    {
      "type": "user",
      "id": 1,
      "name": "zhgchgli",
      "email": "zhgchgli@gmail.com"
    }
  ]
}
</pre></table></code></div></div><p>çµåˆä¸Šè¿°æåˆ°çš„ <code class="language-plaintext highlighter-rouge">nestedUnkeyedContainer</code> +å ´æ™¯1. çš„è§£æ±ºæ–¹æ¡ˆå³å¯ï¼›é€™é‚Šä¹Ÿèƒ½æ”¹ç”¨ <strong>å ´æ™¯1.</strong> çš„ <strong>a.è§£æ±ºæ–¹æ¡ˆ</strong> ï¼Œç”¨ Associated Value Enum å­˜å–å€¼ã€‚</p><h4 id="å ´æ™¯3-json-string-æ¬„ä½æœ‰çµ¦å€¼æ™‚æ‰-decode"><span class="me-2">å ´æ™¯3. JSON String æ¬„ä½æœ‰çµ¦å€¼æ™‚æ‰ Decode</span><a href="#å ´æ™¯3-json-string-æ¬„ä½æœ‰çµ¦å€¼æ™‚æ‰-decode" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>[
  {
    "type": "song",
    "id": 99,
    "name": "æŠ«æ˜Ÿæˆ´æœˆçš„æƒ³ä½ "
  },
    {
    "type": "song",
    "id": 11
  }
]
</pre></table></code></div></div><p>ä½¿ç”¨ decodeIfPresent é€²è¡Œ decodeã€‚</p><h4 id="å ´æ™¯4-é™£åˆ—è³‡æ–™ç•¥é-decode-å¤±æ•—éŒ¯èª¤çš„è³‡æ–™"><span class="me-2">å ´æ™¯4. é™£åˆ—è³‡æ–™ç•¥é Decode å¤±æ•—éŒ¯èª¤çš„è³‡æ–™</span><a href="#å ´æ™¯4-é™£åˆ—è³‡æ–™ç•¥é-decode-å¤±æ•—éŒ¯èª¤çš„è³‡æ–™" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"song"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">99</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æŠ«æ˜Ÿæˆ´æœˆçš„æƒ³ä½ "</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"errro"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"song"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">19</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"å¸¶æˆ‘å»æ‰¾å¤œç”Ÿæ´»"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>å¦‚å‰è¿°ï¼ŒDecodable é è¨­æ˜¯æ‰€æœ‰è³‡æ–™å‰–æéƒ½æ­£ç¢ºæ‰èƒ½ Mapping è¼¸å‡ºï¼›æœ‰æ™‚æœƒé‡åˆ°å¾Œç«¯çµ¦çš„è³‡æ–™ä¸ç©©å®šï¼Œçµ¦ä¸€é•·ä¸² Array ä½†å°±æœ‰å¹¾ç­†è³‡æ–™ç¼ºäº†æ¬„ä½æˆ–æ¬„ä½é¡å‹ä¸ç¬¦å°è‡´ Decode å¤±æ•—ï¼›é€ æˆæ•´åŒ…å…¨éƒ¨å¤±æ•—ï¼Œç›´æ¥ nilã€‚</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre><span class="kd">struct</span> <span class="kt">ResultsEntity</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
    <span class="kd">enum</span> <span class="kt">CodingKeys</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">CodingKey</span> <span class="p">{</span>
        <span class="k">case</span> <span class="n">results</span>
    <span class="p">}</span>
    <span class="k">var</span> <span class="nv">results</span><span class="p">:</span> <span class="p">[</span><span class="kt">SongEntity</span><span class="p">]</span>
    
    <span class="nf">init</span><span class="p">(</span><span class="n">from</span> <span class="nv">decoder</span><span class="p">:</span> <span class="kt">Decoder</span><span class="p">)</span> <span class="k">throws</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">container</span> <span class="o">=</span> <span class="k">try</span> <span class="n">decoder</span><span class="o">.</span><span class="nf">container</span><span class="p">(</span><span class="nv">keyedBy</span><span class="p">:</span> <span class="kt">CodingKeys</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
        <span class="k">var</span> <span class="nv">nestedUnkeyedContainer</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">nestedUnkeyedContainer</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">results</span><span class="p">)</span>
        
        <span class="k">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="o">!</span><span class="n">nestedUnkeyedContainer</span><span class="o">.</span><span class="n">isAtEnd</span> <span class="p">{</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">song</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">nestedUnkeyedContainer</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">SongEntity</span><span class="o">.</span><span class="k">self</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">song</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">let</span> <span class="nv">_</span> <span class="o">=</span> <span class="k">try</span> <span class="n">nestedUnkeyedContainer</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">EmptyEntity</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">EmptyEntity</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span> <span class="p">}</span>

<span class="kd">struct</span> <span class="kt">SongEntity</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">type</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">var</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
<span class="p">}</span>

<span class="k">let</span> <span class="nv">jsonString</span> <span class="o">=</span> <span class="s">"{ </span><span class="se">\"</span><span class="s">results</span><span class="se">\"</span><span class="s">: [ { </span><span class="se">\"</span><span class="s">type</span><span class="se">\"</span><span class="s">: </span><span class="se">\"</span><span class="s">song</span><span class="se">\"</span><span class="s">, </span><span class="se">\"</span><span class="s">id</span><span class="se">\"</span><span class="s">: 99, </span><span class="se">\"</span><span class="s">name</span><span class="se">\"</span><span class="s">: </span><span class="se">\"</span><span class="s">æŠ«æ˜Ÿæˆ´æœˆçš„æƒ³ä½ </span><span class="se">\"</span><span class="s"> }, { </span><span class="se">\"</span><span class="s">error</span><span class="se">\"</span><span class="s">: </span><span class="se">\"</span><span class="s">errro</span><span class="se">\"</span><span class="s"> }, { </span><span class="se">\"</span><span class="s">type</span><span class="se">\"</span><span class="s">: </span><span class="se">\"</span><span class="s">song</span><span class="se">\"</span><span class="s">, </span><span class="se">\"</span><span class="s">id</span><span class="se">\"</span><span class="s">: 19, </span><span class="se">\"</span><span class="s">name</span><span class="se">\"</span><span class="s">: </span><span class="se">\"</span><span class="s">å¸¶æˆ‘å»æ‰¾å¤œç”Ÿæ´»</span><span class="se">\"</span><span class="s"> } ] }"</span>
<span class="k">let</span> <span class="nv">jsonDecoder</span> <span class="o">=</span> <span class="kt">JSONDecoder</span><span class="p">()</span>
<span class="k">let</span> <span class="nv">result</span> <span class="o">=</span> <span class="k">try</span> <span class="n">jsonDecoder</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">ResultsEntity</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="n">jsonString</span><span class="o">.</span><span class="nf">data</span><span class="p">(</span><span class="nv">using</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span><span class="o">!</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></table></code></div></div><p>è§£æ±ºæ–¹å¼ä¹Ÿé¡ä¼¼ <strong>å ´æ™¯2.çš„è§£æ±ºæ–¹æ¡ˆ</strong> ï¼› <code class="language-plaintext highlighter-rouge">nestedUnkeyedContainer</code> éæ­·æ¯å€‹å…§å®¹ï¼Œä¸¦é€²è¡Œ try? Decodeï¼Œå¦‚æœ Decode å¤±æ•—å‰‡ä½¿ç”¨ Empty Decode è®“ <code class="language-plaintext highlighter-rouge">nestedUnkeyedContainer</code> çš„å…§éƒ¨æŒ‡é‡ç¹¼çºŒåŸ·è¡Œã€‚</p><blockquote><p><em>ï¼Šæ­¤æ–¹æ³•æœ‰é» workaroundï¼Œå› æˆ‘å€‘ç„¡æ³•å° <code class="language-plaintext highlighter-rouge">nestedUnkeyedContainer</code> å‘½ä»¤è·³éï¼Œä¸” <code class="language-plaintext highlighter-rouge">nestedUnkeyedContainer</code> å¿…é ˆæœ‰æˆåŠŸ decode æ‰æœƒç¹¼çºŒåŸ·è¡Œï¼›æ‰€ä»¥æ‰é€™æ¨£åšï¼Œçœ‹ swift ç¤¾ç¾¤æœ‰äººæå¢åŠ  <a href="https://forums.swift.org/t/pitch-unkeyeddecodingcontainer-movenext-to-skip-items-in-deserialization/22151/16" target="_blank">moveNext( )</a> ï¼Œä½†ç›®å‰ç‰ˆæœ¬å°šæœªå¯¦ä½œã€‚</em></p></blockquote><h4 id="å ´æ™¯5-æœ‰çš„æ¬„ä½æ˜¯æˆ‘ç¨‹å¼å…§éƒ¨è¦ä½¿ç”¨çš„è€Œéè¦-decode"><span class="me-2">å ´æ™¯5. æœ‰çš„æ¬„ä½æ˜¯æˆ‘ç¨‹å¼å…§éƒ¨è¦ä½¿ç”¨çš„ï¼Œè€Œéè¦ Decode</span><a href="#å ´æ™¯5-æœ‰çš„æ¬„ä½æ˜¯æˆ‘ç¨‹å¼å…§éƒ¨è¦ä½¿ç”¨çš„è€Œéè¦-decode" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><h4 id="æ–¹å¼a-entitymodel"><span class="me-2">æ–¹å¼a. Entity/Model</span><a href="#æ–¹å¼a-entitymodel" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>é€™é‚Šå°±è¦æä¸€é–‹å§‹èªªçš„ï¼Œæˆ‘å€‘æ‹†åˆ† Entity/Model çš„åŠŸç”¨äº†ï¼›Entity å–®ç´”è² è²¬ JSON String to Entity(Decodable) Mappingï¼›Model initWith Entityï¼Œå¯¦éš›ç¨‹å¼å‚³éã€æ“ä½œã€å•†æ¥­é‚è¼¯éƒ½æ˜¯ä½¿ç”¨ Modelã€‚</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="kd">struct</span> <span class="kt">SongEntity</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">type</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">var</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">SongModel</span><span class="p">:</span> <span class="kt">NSObject</span> <span class="p">{</span>
    <span class="nf">init</span><span class="p">(</span><span class="n">_</span> <span class="nv">entity</span><span class="p">:</span> <span class="kt">SongEntity</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">type</span>
        <span class="k">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">id</span>
        <span class="k">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">name</span>
    <span class="p">}</span>
    
    <span class="k">var</span> <span class="nv">type</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">var</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
    
    <span class="k">var</span> <span class="nv">isSave</span><span class="p">:</span><span class="kt">Bool</span> <span class="o">=</span> <span class="kc">false</span> <span class="c1">//business logic</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>æ‹†åˆ† Entity/Model çš„å¥½è™•ï¼š</strong></p><ol><li>æ¬Šè²¬åˆ†æ˜ï¼ŒEntity: JSON String to Decodable, Model: business logic<li>ä¸€ç›®ç­ç„¶ mapping äº†å“ªäº›æ¬„ä½çœ‹ Entity å°±çŸ¥é“<li>é¿å…æ¬„ä½ä¸€å¤šå…¨å–‡åœ¨ä¸€èµ·<li><strong>Objective-C ä¹Ÿå¯ç”¨</strong> ï¼ˆå›  Model åªæ˜¯ NSObjectã€struct/Decodable Objective-C ä¸å¯è¦‹ï¼‰<li>å…§éƒ¨è¦ä½¿ç”¨çš„å•†æ¥­é‚è¼¯ã€æ¬„ä½æ”¾åœ¨ Model å³å¯</ol><h4 id="æ–¹å¼b-init-è™•ç†"><span class="me-2">æ–¹å¼b. init è™•ç†</span><a href="#æ–¹å¼b-init-è™•ç†" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>åˆ—å‡º CodingKeys ä¸¦æ’é™¤å…§éƒ¨ä½¿ç”¨çš„æ¬„ä½ï¼Œinit æ™‚çµ¦é è¨­å€¼æˆ–æ¬„ä½æœ‰çµ¦é è¨­å€¼æˆ–è¨­ç‚º Optionalï¼Œä½†éƒ½ä¸æ˜¯å¥½æ–¹æ³•ï¼Œåªæ˜¯å¯ä»¥ run è€Œå·²ã€‚</p><h4 id="20200626-æ›´æ–°--ä¸‹ç¯‡-å ´æ™¯6api-response-ä½¿ç”¨-01-ä»£è¡¨-boolè©²å¦‚ä½•-decode"><span class="me-2">[2020/06/26 æ›´æ–°] â€” ä¸‹ç¯‡ å ´æ™¯6.API Response ä½¿ç”¨ 0/1 ä»£è¡¨ Boolï¼Œè©²å¦‚ä½• Decode?</span><a href="#20200626-æ›´æ–°--ä¸‹ç¯‡-å ´æ™¯6api-response-ä½¿ç”¨-01-ä»£è¡¨-boolè©²å¦‚ä½•-decode" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://zhgchg.li/posts/zrealm-dev/codable-%E8%A7%A3%E7%A2%BC%E9%80%B2%E9%9A%8E%E6%8A%80%E5%B7%A7-%E5%8D%80%E5%88%86-null-%E8%88%87%E6%AC%84%E4%BD%8D%E7%BC%BA%E5%A4%B1-%E5%AF%A6%E7%8F%BE-core-data-%E5%A2%9E%E9%87%8F%E6%9B%B4%E6%96%B0-cb00b1977537/">ç¾å¯¦ä½¿ç”¨ Codable ä¸Šé‡åˆ°çš„ Decode å•é¡Œå ´æ™¯ç¸½åŒ¯(ä¸‹)</a></ul><h4 id="20200626-æ›´æ–°--ä¸‹ç¯‡-å ´æ™¯7ä¸æƒ³è¦æ¯æ¯éƒ½è¦é‡å¯«-init-decoder"><span class="me-2">[2020/06/26 æ›´æ–°] â€” ä¸‹ç¯‡ å ´æ™¯7.ä¸æƒ³è¦æ¯æ¯éƒ½è¦é‡å¯« init decoder</span><a href="#20200626-æ›´æ–°--ä¸‹ç¯‡-å ´æ™¯7ä¸æƒ³è¦æ¯æ¯éƒ½è¦é‡å¯«-init-decoder" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://zhgchg.li/posts/zrealm-dev/codable-%E8%A7%A3%E7%A2%BC%E9%80%B2%E9%9A%8E%E6%8A%80%E5%B7%A7-%E5%8D%80%E5%88%86-null-%E8%88%87%E6%AC%84%E4%BD%8D%E7%BC%BA%E5%A4%B1-%E5%AF%A6%E7%8F%BE-core-data-%E5%A2%9E%E9%87%8F%E6%9B%B4%E6%96%B0-cb00b1977537/">ç¾å¯¦ä½¿ç”¨ Codable ä¸Šé‡åˆ°çš„ Decode å•é¡Œå ´æ™¯ç¸½åŒ¯(ä¸‹)</a></ul><h4 id="20200626-æ›´æ–°--ä¸‹ç¯‡-å ´æ™¯8åˆç†çš„è™•ç†-response-null-æ¬„ä½è³‡æ–™"><span class="me-2">[2020/06/26 æ›´æ–°] â€” ä¸‹ç¯‡ å ´æ™¯8.åˆç†çš„è™•ç† Response Null æ¬„ä½è³‡æ–™</span><a href="#20200626-æ›´æ–°--ä¸‹ç¯‡-å ´æ™¯8åˆç†çš„è™•ç†-response-null-æ¬„ä½è³‡æ–™" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://zhgchg.li/posts/zrealm-dev/codable-%E8%A7%A3%E7%A2%BC%E9%80%B2%E9%9A%8E%E6%8A%80%E5%B7%A7-%E5%8D%80%E5%88%86-null-%E8%88%87%E6%AC%84%E4%BD%8D%E7%BC%BA%E5%A4%B1-%E5%AF%A6%E7%8F%BE-core-data-%E5%A2%9E%E9%87%8F%E6%9B%B4%E6%96%B0-cb00b1977537/">ç¾å¯¦ä½¿ç”¨ Codable ä¸Šé‡åˆ°çš„ Decode å•é¡Œå ´æ™¯ç¸½åŒ¯(ä¸‹)</a></ul><h3 id="ç¶œåˆå ´æ™¯ç¯„ä¾‹"><span class="me-2">ç¶œåˆå ´æ™¯ç¯„ä¾‹</span><a href="#ç¶œåˆå ´æ™¯ç¯„ä¾‹" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>ç¶œåˆä»¥ä¸ŠåŸºæœ¬ä½¿ç”¨åŠé€²éšä½¿ç”¨çš„å®Œæ•´ç¯„ä¾‹ï¼š</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre><td class="rouge-code"><pre>{
  "count": 5,
  "offset": 0,
  "limit": 10,
  "results": [
    {
      "id": 123456,
      "comment": "æ˜¯å‘Šäº”äººï¼Œä¸æ˜¯äº”å‘Šäºº!",
      "target_object": {
        "type": "song",
        "id": 99,
        "name": "æŠ«æ˜Ÿæˆ´æœˆçš„æƒ³ä½ ",
        "create_date": "2020-06-13T15:21:42+0800"
      },
      "commenter": {
        "type": "user",
        "id": 1,
        "name": "zhgchgli",
        "email": "zhgchgli@gmail.com",
        "birthday": "1994/07/18"
      }
    },
    {
      "error": "not found"
    },
    {
      "error": "not found"
    },
    {
      "id": 2,
      "comment": "å“ˆå“ˆï¼Œæˆ‘ä¹Ÿæ˜¯!",
      "target_object": {
        "type": "user",
        "id": 1,
        "name": "zhgchgli",
        "email": "zhgchgli@gmail.com",
        "birthday": "1994/07/18"
      },
      "commenter": {
        "type": "user",
        "id": 1,
        "name": "è·¯äººç”²",
        "email": "man@gmail.com",
        "birthday": "2000/01/12"
      }
    }
  ]
}
</pre></table></code></div></div><p><strong>Output:</strong></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¤‡è£½ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>zhgchgli:æ˜¯å‘Šäº”äººï¼Œä¸æ˜¯äº”å‘Šäºº!
</pre></table></code></div></div><p>å®Œæ•´ç¯„ä¾‹æ¼”ç¤ºå¦‚ä¸Šï¼</p><h3 id="ä¸‹ç¯‡å…¶ä»–å ´æ™¯å·²æ›´æ–°"><span class="me-2">(ä¸‹)ç¯‡ï¼†å…¶ä»–å ´æ™¯å·²æ›´æ–°ï¼š</span><a href="#ä¸‹ç¯‡å…¶ä»–å ´æ™¯å·²æ›´æ–°" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><a href="https://zhgchg.li/posts/zrealm-dev/codable-%E8%A7%A3%E7%A2%BC%E9%80%B2%E9%9A%8E%E6%8A%80%E5%B7%A7-%E5%8D%80%E5%88%86-null-%E8%88%87%E6%AC%84%E4%BD%8D%E7%BC%BA%E5%A4%B1-%E5%AF%A6%E7%8F%BE-core-data-%E5%A2%9E%E9%87%8F%E6%9B%B4%E6%96%B0-cb00b1977537/">ç¾å¯¦ä½¿ç”¨ Codable ä¸Šé‡åˆ°çš„ Decode å•é¡Œå ´æ™¯ç¸½åŒ¯(ä¸‹)</a></ul><h3 id="ç¸½çµ"><span class="me-2">ç¸½çµ</span><a href="#ç¸½çµ" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>é¸æ“‡ä½¿ç”¨ Codable çš„å¥½è™•ï¼Œç¬¬ä¸€ç•¶ç„¶æ˜¯å› ç‚ºåŸç”Ÿï¼Œä¸ç”¨æ€•å¾ŒçºŒç„¡äººç¶­è­·ã€é‚„æœ‰å¯«èµ·ä¾†æ¼‚äº®ï¼›ä½†ç›¸å°çš„é™åˆ¶è¼ƒåš´æ ¼ã€æ¯”è¼ƒä¸èƒ½éˆæ´»è§£ JSON Stringï¼Œä¸ç„¶å°±æ˜¯è¦å¦‚æœ¬æ–‡åšæ›´å¤šçš„äº‹å»å®Œæˆã€é‚„æœ‰æ•ˆèƒ½å…¶å¯¦ä¸æ¯”ä½¿ç”¨å…¶ä»– Mapping å¥—ä»¶å„ªï¼ˆDecodable ä¾ç„¶ä½¿ç”¨Objective æ™‚ä»£çš„ NSJSONSerialization é€²è¡Œè§£æï¼‰ï¼Œä½†æˆ‘æƒ³åœ¨å¾ŒçºŒçš„æ›´æ–°ä¸­æˆ–è¨±è˜‹æœæœƒå°æ­¤é€²è¡Œå„ªåŒ–ï¼Œé‚£æ™‚æˆ‘å€‘ä¹Ÿä¸å¿…æ›´å‹•ç¨‹å¼ã€‚</p><p>æ–‡ä¸­å ´æ™¯ã€ç¯„ä¾‹æˆ–è¨±æœ‰äº›å¾ˆæ¥µç«¯ï¼Œä½†æœ‰æ™‚å€™é‡åˆ°äº†ä¹Ÿæ²’è¾¦æ³•ï¼›ç•¶ç„¶å¸Œæœ›ä¸€èˆ¬æƒ…æ³ä¸‹å–®ç´”çš„ Codable å°±èƒ½æ»¿è¶³æˆ‘å€‘çš„éœ€æ±‚ï¼›ä½†æœ‰äº†ä»¥ä¸Šæ‹›å¼ä¹‹å¾Œæ‡‰è©²æ²’æœ‰æ‰“ä¸å€’çš„å•é¡Œäº†ï¼</p><blockquote><p><em>æ„Ÿè¬ <a href="https://twitter.com/saiday" target="_blank">ï¼ saiday</a> å¤§å¤§æŠ€è¡“æ”¯æ´ã€‚</em></p></blockquote><iframe class="embed-video" loading="lazy" src="https://www.youtube.com/embed/W9Fq1HC_5hg" title="å‘Šäº”äºº Accusefiveã€å¸¶æˆ‘å»æ‰¾å¤œç”Ÿæ´» Night life.Take us to the lightã€‘Official Music Video" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><h3 id="å»¶ä¼¸é–±è®€"><span class="me-2">å»¶ä¼¸é–±è®€</span><a href="#å»¶ä¼¸é–±è®€" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li><a href="https://kemchenj.github.io/2018-06-03/" target="_blank">æ·±å…¥ Decodable â€” â€” å†™ä¸€ä¸ªè¶…è¶ŠåŸç”Ÿçš„ JSON è§£æå™¨</a> æ»¿æ»¿çš„å…§å®¹ï¼Œæ·±å…¥äº†è§£ Decoder/JSONDecoderã€‚<li><a href="https://onevcat.com/2018/03/swift-meta/" target="_blank">ä¸åŒè§’åº¦çœ‹é—®é¢˜ â€” ä» Codable åˆ° Swift å…ƒç¼–ç¨‹</a><li><a href="https://medium.com/better-programming/why-model-objects-shouldnt-implement-swift-s-decodable-or-encodable-protocols-1249cb44d4b3" target="_blank">Why Model Objects Shouldnâ€™t Implement Swiftâ€™s Decodable or Encodable Protocols</a></ol><p>æœ‰ä»»ä½•å•é¡ŒåŠæŒ‡æ•™æ­¡è¿ <a href="https://www.zhgchg.li/contact" target="_blank">èˆ‡æˆ‘è¯çµ¡</a> ã€‚</p><script src="/assets/clipboard.min.js"></script><div style=" display:flex; align-items:center; gap:10px; border:1px solid #e5e7eb; background:#f9fafb; padding:12px 16px; border-radius:12px; margin:18px 0; box-shadow:0 3px 8px rgba(0,0,0,0.05); width: auto;"> <input id="share-url" value="https://zhgchg.li/posts/zrealm-dev/swift-codable-%E8%A7%A3%E7%A2%BC%E5%95%8F%E9%A1%8C%E5%85%A8%E6%94%BB%E7%95%A5-%E5%A4%9A%E5%A0%B4%E6%99%AF-json-%E8%A7%A3%E6%9E%90%E8%88%87%E9%8C%AF%E8%AA%A4%E5%AE%B9%E5%BF%8D%E6%8A%80%E5%B7%A7-1aa2f8445642/" readonly="" style=" flex:1; border:1px solid #d1d5db; border-radius:8px; padding:10px 12px; font-size:0.9rem; background:#ffffff; color:#111827; outline:none; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; " /> <button class="btn" data-clipboard-target="#share-url" id="copy-btn" style=" border:none; background:#3b82f6; color:white; padding:10px 16px; border-radius:10px; cursor:pointer; font-size:0.85rem; font-weight:600; display:flex; align-items:center; gap:6px; transition:all .15s ease; box-shadow:0 2px 5px rgba(59,130,246,0.35); " onmouseover="this.style.opacity='0.92';" onmouseout="this.style.opacity='1';"> <span style="font-size:1rem;">ğŸ”—</span> <span id="copy-btn-text">Copy link to share!</span> </button></div><script> new ClipboardJS('.btn'); var btn = document.getElementById("copy-btn"); var text = document.getElementById("copy-btn-text"); btn.addEventListener("click", function () { text.textContent = "Copied!"; btn.style.background = "#16a34a"; btn.style.boxShadow = "0 2px 6px rgba(22,163,74,0.35)"; setTimeout(() => { text.textContent = "Copy link to share!"; btn.style.background = "#3b82f6"; btn.style.boxShadow = "0 2px 5px rgba(59,130,246,0.35)"; }, 1500); });</script><hr /><p><a href="/contact" target="_blank" rel="noopener" style="display:block;margin:12px 0;text-align:center;align-items:center;justify-content:center;padding:10px 22px;border-radius:999px;text-decoration:none;background:linear-gradient(135deg,#ffd54f,#ffb300);color:#000;font-size:16px;font-weight:700;font-family:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;box-shadow:0 4px 10px rgba(0,0,0,.15);cursor:pointer;transition:all .15s ease;width:350px" onmouseover="this.style.background=&quot;linear-gradient(135deg,#FFE082,#FFC107)&quot;,this.style.transform=&quot;translateY(-1px)&quot;,this.style.boxShadow=&quot;0 6px 14px rgba(0,0,0,0.2)&quot;" onmouseout="this.style.background=&quot;linear-gradient(135deg,#FFD54F,#FFB300)&quot;,this.style.transform=&quot;translateY(0)&quot;,this.style.boxShadow=&quot;0 4px 10px rgba(0,0,0,0.15)&quot;">ğŸº Buy me a beer on PayPal</a></p><blockquote class="prompt-tip"><p>ğŸ‘‰ğŸ‘‰ğŸ‘‰ <a href="https://medium.com/@zhgchgli" target="_blank"><strong>Follow Me On Medium!</strong> (1,051+ Followers)</a> ğŸ‘ˆğŸ‘ˆğŸ‘ˆ</p></blockquote><blockquote class="prompt-info"><p>æœ¬æ–‡é¦–æ¬¡ç™¼è¡¨æ–¼ Medium (<a href="https://medium.com/p/1aa2f8445642" target="_blank"><strong>é»æ­¤æŸ¥çœ‹åŸå§‹ç‰ˆæœ¬</strong></a>)ï¼Œç”± <a href="/posts/tools/medium-to-jekyll/" target="_blank">ZMediumToMarkdown</a> æä¾›è‡ªå‹•è½‰æ›èˆ‡åŒæ­¥æŠ€è¡“ã€‚</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/zh-tw/zmediumtomarkdown/2020-06-13-1aa2f8445642.md" target="_blank">Improve this page on Github.</a></p></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-dev/">ZRealm Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/ios/" class="post-tag no-text-decoration" >ios</a> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/codable/" class="post-tag no-text-decoration" >codable</a> <a href="/tags/json/" class="post-tag no-text-decoration" >json</a> <a href="/tags/decode/" class="post-tag no-text-decoration" >decode</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> æœ¬æ–‡ç”±ä½œè€…ä»¥ <a href="https://creativecommons.org/licenses/by/4.0/deed.zh-hant"> CC BY 4.0 </a> æˆæ¬Šã€‚</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">åˆ†äº«</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Swift%20Codable%20%E8%A7%A3%E7%A2%BC%E5%95%8F%E9%A1%8C%E5%85%A8%E6%94%BB%E7%95%A5%EF%BD%9C%E5%A4%9A%E5%A0%B4%E6%99%AF%20JSON%20%E8%A7%A3%E6%9E%90%E8%88%87%E9%8C%AF%E8%AA%A4%E5%AE%B9%E5%BF%8D%E6%8A%80%E5%B7%A7%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fswift-codable-%25E8%25A7%25A3%25E7%25A2%25BC%25E5%2595%258F%25E9%25A1%258C%25E5%2585%25A8%25E6%2594%25BB%25E7%2595%25A5-%25E5%25A4%259A%25E5%25A0%25B4%25E6%2599%25AF-json-%25E8%25A7%25A3%25E6%259E%2590%25E8%2588%2587%25E9%258C%25AF%25E8%25AA%25A4%25E5%25AE%25B9%25E5%25BF%258D%25E6%258A%2580%25E5%25B7%25A7-1aa2f8445642%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Swift%20Codable%20%E8%A7%A3%E7%A2%BC%E5%95%8F%E9%A1%8C%E5%85%A8%E6%94%BB%E7%95%A5%EF%BD%9C%E5%A4%9A%E5%A0%B4%E6%99%AF%20JSON%20%E8%A7%A3%E6%9E%90%E8%88%87%E9%8C%AF%E8%AA%A4%E5%AE%B9%E5%BF%8D%E6%8A%80%E5%B7%A7%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fswift-codable-%25E8%25A7%25A3%25E7%25A2%25BC%25E5%2595%258F%25E9%25A1%258C%25E5%2585%25A8%25E6%2594%25BB%25E7%2595%25A5-%25E5%25A4%259A%25E5%25A0%25B4%25E6%2599%25AF-json-%25E8%25A7%25A3%25E6%259E%2590%25E8%2588%2587%25E9%258C%25AF%25E8%25AA%25A4%25E5%25AE%25B9%25E5%25BF%258D%25E6%258A%2580%25E5%25B7%25A7-1aa2f8445642%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fswift-codable-%25E8%25A7%25A3%25E7%25A2%25BC%25E5%2595%258F%25E9%25A1%258C%25E5%2585%25A8%25E6%2594%25BB%25E7%2595%25A5-%25E5%25A4%259A%25E5%25A0%25B4%25E6%2599%25AF-json-%25E8%25A7%25A3%25E6%259E%2590%25E8%2588%2587%25E9%258C%25AF%25E8%25AA%25A4%25E5%25AE%25B9%25E5%25BF%258D%25E6%258A%2580%25E5%25B7%25A7-1aa2f8445642%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="è¤‡è£½é€£çµ" data-title-succeed="é€£çµå·²æˆåŠŸè¤‡è£½ï¼" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">æœ€è¿‘æ›´æ–°</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/medium-api-%E7%88%AC%E5%8F%96%E8%B3%87%E6%96%99%E8%88%87%E7%AA%81%E7%A0%B4-cloudflare-%E9%98%B2%E8%AD%B7-%E5%AE%8C%E6%95%B4-graphql-%E6%93%8D%E4%BD%9C%E6%95%99%E5%AD%B8-88f0fb935120/">Medium API è³‡æ–™çˆ¬èŸ²èˆ‡ Cloudflare æ”»é˜²çš„å¿ƒè·¯æ­·ç¨‹</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/app-store-connect-api-webhook-%E4%B8%B2%E6%8E%A5-%E6%8F%90%E5%8D%87-ios-ci-cd-%E8%87%AA%E5%8B%95%E5%8C%96%E6%95%88%E7%8E%87%E8%88%87%E9%80%9A%E7%9F%A5%E6%B5%81%E7%A8%8B-7c0974856393/">CI/CD ä½¿ç”¨ App Store Connect API Webhook ä¸²æ¥è‡ªå‹•åŒ–å·¥ä½œæµç¨‹</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/ci-cd-%E6%98%AF%E4%BB%80%E9%BA%BC-%E6%89%93%E9%80%A0%E9%AB%98%E6%95%88%E7%A9%A9%E5%AE%9A%E9%96%8B%E7%99%BC%E5%9C%98%E9%9A%8A%E7%9A%84%E9%97%9C%E9%8D%B5%E6%B5%81%E7%A8%8B%E8%88%87%E5%B7%A5%E5%85%B7%E9%81%B8%E6%93%87-c008a9e8ceca/">CI/CD å¯¦æˆ°æŒ‡å—ï¼ˆä¸€ï¼‰ï¼šCI/CD æ˜¯ä»€éº¼ï¼Ÿå¦‚ä½•é€é CI/CD æ‰“é€ ç©©å®šé«˜æ•ˆçš„é–‹ç™¼åœ˜éšŠï¼Ÿå·¥å…·é¸æ“‡ï¼Ÿ</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/google-apps-script-web-app-%E6%89%93%E9%80%A0-github-action-ci-cd-%E8%87%AA%E8%A8%82%E8%A1%A8%E5%96%AE%E6%8F%90%E5%8D%87%E9%96%8B%E7%99%BC%E6%95%88%E7%8E%87-4cb4437818f2/">ä½¿ç”¨ Google Apps Script Web App è¡¨å–®ä¸²æ¥ Github Action CI/CD å·¥ä½œ</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-robotic-process-automation/github-action-%E5%85%8D%E8%B2%BB%E9%83%A8%E7%BD%B2-zreviewtender-app-%E5%95%86%E5%9F%8E%E8%A9%95%E5%83%B9%E7%9B%A3%E6%8E%A7%E6%A9%9F%E5%99%A8%E4%BA%BA-%E4%B8%89%E6%AD%A5%E9%A9%9F%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-0095528cf875/">Quick Start! Github Action x ZReviewTender å…è²»å¿«é€Ÿéƒ¨ç½²ä½ çš„ App å•†åŸè©•åƒ¹ç›£æ§æ©Ÿå™¨äºº</a></ul></section><section><h2 class="panel-heading">ç†±é–€æ¨™ç±¤</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">ç”Ÿæ´»</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E9%96%8B%E7%AE%B1/">é–‹ç®±</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a> <a class="post-tag btn btn-outline-primary" href="/tags/japan/">japan</a> <a class="post-tag btn btn-outline-primary" href="/tags/cicd/">cicd</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">ç« ç¯€ç›®éŒ„ ğŸ”–</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">å»¶ä¼¸é–±è®€</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-dev/codable-%E8%A7%A3%E7%A2%BC%E9%80%B2%E9%9A%8E%E6%8A%80%E5%B7%A7-%E5%8D%80%E5%88%86-null-%E8%88%87%E6%AC%84%E4%BD%8D%E7%BC%BA%E5%A4%B1-%E5%AF%A6%E7%8F%BE-core-data-%E5%A2%9E%E9%87%8F%E6%9B%B4%E6%96%B0-cb00b1977537/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1593107791" data-df="YYYY å¹´ M æœˆ D æ—¥" > 2020 å¹´ 06 æœˆ 26 æ—¥ </time><h4 class="pt-0 my-2">ç¾å¯¦ä½¿ç”¨ Codable ä¸Šé‡åˆ°çš„ Decode å•é¡Œå ´æ™¯ç¸½åŒ¯(ä¸‹)</h4><div class="text-muted"><p>åˆç†çš„è™•ç† Response Null æ¬„ä½è³‡æ–™ã€ä¸ä¸€å®šéƒ½è¦é‡å¯« init decoder</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-robotic-process-automation/ios-%E6%8D%B7%E5%BE%91%E8%87%AA%E5%8B%95%E5%8C%96-3-%E6%8B%9B%E8%87%AA%E5%8B%95%E8%BD%89%E7%99%BC%E7%B0%A1%E8%A8%8A%E8%88%87%E5%BB%BA%E7%AB%8B%E6%8F%90%E9%86%92%E5%BE%85%E8%BE%A6%E4%BA%8B%E9%A0%85%E6%95%99%E5%AD%B8-309d0302877b/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1724083008" data-df="YYYY å¹´ M æœˆ D æ—¥" > 2024 å¹´ 08 æœˆ 19 æ—¥ </time><h4 class="pt-0 my-2">iOS æ·å¾‘è‡ªå‹•åŒ–æ‡‰ç”¨å ´æ™¯â€Šâ€”â€Šè‡ªå‹•è½‰ç™¼ç°¡è¨Šèˆ‡è‡ªå‹•å»ºç«‹æé†’å¾…è¾¦äº‹é …</h4><div class="text-muted"><p>iOS ä½¿ç”¨ æ·å¾‘ Shortcut ç°¡å–®å¹¾å€‹æ­¥é©Ÿè‡ªå‹•è½‰ç™¼ç‰¹å®šç°¡è¨Šçµ¦å®¶é•·å’Œè‡ªå‹•å‰µå»ºåŒ…è£¹åˆ°è²¨é ˜å–èˆ‡ä¿¡ç”¨å¡ç¹³è²»æé†’ä»£è¾¦äº‹é …</p></div></div></a></article><article class="col"> <a href="/posts/avplayer-%E9%82%8A%E6%92%AD%E9%82%8A-cache-%E6%8A%80%E8%A1%93%E5%AF%A6%E6%88%B0-ios-%E6%9C%AC%E5%9C%B0%E7%B7%A9%E5%AD%98%E5%84%AA%E5%8C%96%E6%94%BB%E7%95%A5-ee47f8f1e2d2/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1609856872" data-df="YYYY å¹´ M æœˆ D æ—¥" > 2021 å¹´ 01 æœˆ 05 æ—¥ </time><h4 class="pt-0 my-2">AVPlayer é‚Šæ’­é‚Š Cache å¯¦æˆ°</h4><div class="text-muted"><p>AVPlayer/AVQueuePlayer with AVURLAsset å¯¦ä½œ AVAssetResourceLoaderDelegate é”æˆé‚Šæ’­æ”¾éŸ³æ¨‚/å½±ç‰‡é‚Šç·©å­˜</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-life/iphone-%E9%80%8F%E8%A6%96%E9%80%8F%E6%98%8E%E6%89%8B%E6%A9%9F%E6%A1%8C%E5%B8%83%E8%A3%BD%E4%BD%9C%E6%95%99%E5%AD%B8-imovie-%E7%B6%A0%E5%B9%95%E6%91%B3%E5%9C%96%E5%BF%AB%E9%80%9F%E5%90%88%E6%88%90%E6%8A%80%E5%B7%A7-2e4429f410d6/" class="btn btn-outline-primary" aria-label="ä¸Šä¸€ç¯‡" ><p>iPhone é€è¦–é€æ˜æ‰‹æ©Ÿæ¡Œå¸ƒè£½ä½œæ•™å­¸ï½œiMovie ç¶ å¹•æ‘³åœ–å¿«é€ŸåˆæˆæŠ€å·§</p></a> <a href="/posts/zrealm-life/google-site-%E5%80%8B%E4%BA%BA%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E6%95%99%E5%AD%B8-%E5%84%AA%E7%BC%BA%E9%BB%9E%E8%A7%A3%E6%9E%90%E8%88%87%E7%B6%B2%E5%9F%9F%E7%B6%81%E5%AE%9A%E8%A8%AD%E5%AE%9A%E5%85%A8%E6%94%BB%E7%95%A5-724a7fb9a364/" class="btn btn-outline-primary" aria-label="ä¸‹ä¸€ç¯‡" ><p>ä½¿ç”¨ Google Site å»ºç«‹å€‹äººç¶²ç«™é‚„è·Ÿå¾—ä¸Šæ™‚ä»£å—ï¼Ÿ</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>Â© <time>2026</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="é™¤éå¦æœ‰è¨»æ˜ï¼Œæœ¬ç¶²ç«™ä¸Šçš„æ‰€æœ‰æ–‡ç« çš†ç”±ä½œè€…ä¾æ“š å‰µç”¨ CC å§“åæ¨™ç¤º 4.0 åœ‹éš›æˆæ¬Šæ¢æ¬¾ï¼ˆCC BY 4.0ï¼‰æˆæ¬Šä½¿ç”¨ã€‚" >ç‰ˆæ¬Šæ‰€æœ‰ã€‚</span> <br/> ç€è¦½æ¬¡æ•¸: <u>783,270+</u>, æœ€å¾Œæ›´æ–°æ™‚é–“: <u>2026-01-03 10:56:11 +08:00</u></p><p>æœ¬ç«™ä½¿ç”¨ <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> ä¸»é¡Œå»ºç½®æ–¼ <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>ã€‚<br/> Medium æ–‡ç« ç”± <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown</a> è½‰æ›è€Œæˆã€‚</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">ç†±é–€æ¨™ç±¤</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">ç”Ÿæ´»</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E9%96%8B%E7%AE%B1/">é–‹ç®±</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a> <a class="post-tag btn btn-outline-primary" href="/tags/japan/">japan</a> <a class="post-tag btn btn-outline-primary" href="/tags/cicd/">cicd</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">ç™¼ç¾æœ‰æ–°çš„å…§å®¹ç‰ˆæœ¬ã€‚</p><button type="button" class="btn btn-primary" aria-label="Update"> æ›´æ–° </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'zh-TW';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'General', 'data-category-id': 'DIC_kwDOHdowL84CU-q5', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">æ‰¾ä¸åˆ°ç¬¦åˆçš„çµæœã€‚</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
