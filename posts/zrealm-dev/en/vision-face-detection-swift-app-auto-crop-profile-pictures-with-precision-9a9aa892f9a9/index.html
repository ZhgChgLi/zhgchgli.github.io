<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Vision Face DetectionÔΩúSwift App Auto Crop Profile Pictures with Precision" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="Discover how Swift developers automate face detection and cropping in profile picture uploads using Vision. Solve manual editing pain points and enhance user experience with accurate, real-time facial recognition and cropping techniques." /><meta property="og:description" content="Discover how Swift developers automate face detection and cropping in profile picture uploads using Vision. Solve manual editing pain points and enhance user experience with accurate, real-time facial recognition and cropping techniques." /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-dev/en/vision-face-detection-swift-app-auto-crop-profile-pictures-with-precision-9a9aa892f9a9/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-dev/en/vision-face-detection-swift-app-auto-crop-profile-pictures-with-precision-9a9aa892f9a9/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/9a9aa892f9a9/1*c-ioRH_Z2nMYRxSbuBD71A.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-10-17T00:01:24+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/9a9aa892f9a9/1*c-ioRH_Z2nMYRxSbuBD71A.webp" /><meta property="twitter:title" content="Vision Face DetectionÔΩúSwift App Auto Crop Profile Pictures with Precision" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://www.linkedin.com/in/zhgchgli"},"dateModified":"2024-08-13T16:17:24+08:00","datePublished":"2018-10-17T00:01:24+08:00","description":"Discover how Swift developers automate face detection and cropping in profile picture uploads using Vision. Solve manual editing pain points and enhance user experience with accurate, real-time facial recognition and cropping techniques.","headline":"Vision Face DetectionÔΩúSwift App Auto Crop Profile Pictures with Precision","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+","url":"https://zhgchg.li/assets/9a9aa892f9a9/1*c-ioRH_Z2nMYRxSbuBD71A.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-dev/en/vision-face-detection-swift-app-auto-crop-profile-pictures-with-precision-9a9aa892f9a9/"},"url":"https://zhgchg.li/posts/zrealm-dev/en/vision-face-detection-swift-app-auto-crop-profile-pictures-with-precision-9a9aa892f9a9/"}</script><title>Vision Face DetectionÔΩúSwift App Auto Crop Profile Pictures with Precision | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=false" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script><link rel="alternate" hreflang="zh-Hans" href="/posts/zrealm-dev/zh-cn/vision%E6%A1%86%E6%9E%B6swift%E6%95%99%E5%AD%A6-app%E8%87%AA%E5%8A%A8%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB%E8%A3%81%E5%9B%BE%E5%AE%9E%E4%BD%9C%E6%8C%87%E5%8D%97-9a9aa892f9a9/"><link rel="alternate" hreflang="zh-Hant" href="/posts/zrealm-dev/vision%E6%A1%86%E6%9E%B6swift%E6%95%99%E5%AD%B8-app%E8%87%AA%E5%8B%95%E4%BA%BA%E8%87%89%E8%AD%98%E5%88%A5%E8%A3%81%E5%9C%96%E5%AF%A6%E4%BD%9C%E6%8C%87%E5%8D%97-9a9aa892f9a9/"><link rel="alternate" hreflang="en" href="/posts/zrealm-dev/en/vision-face-detection-swift-app-auto-crop-profile-pictures-with-precision-9a9aa892f9a9/"><link rel="alternate" hreflang="x-default" href="/posts/zrealm-dev/en/vision-face-detection-swift-app-auto-crop-profile-pictures-with-precision-9a9aa892f9a9/"><link rel="stylesheet" href="/assets/css/post-toc.css"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0">An iOS, web, and automation developer from Taiwan üáπüáº who also loves sharing, traveling, and writing.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="https://medium.com/@zhgchgli" class="nav-link" target="_blank" style="background: #EDF4FF; color: #0A84FF;"> <i class="fa-brands fa-medium"></i> <span>Follow Me!<br/><strong>1,050+</strong> Followers</span> </a><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/english/" class="nav-link"> <i class="fa-fw fa fa-solid fa-language"></i> <span>ENGLISH POSTS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Vision Face DetectionÔΩúSwift App Auto Crop Profile Pictures with Precision</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Vision Face DetectionÔΩúSwift App Auto Crop Profile Pictures with Precision</h1><p class="post-desc fw-light mb-4">Discover how Swift developers automate face detection and cropping in profile picture uploads using Vision. Solve manual editing pain points and enhance user experience with accurate, real-time facial recognition and cropping techniques.</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1539705684" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Oct 17, 2018 </time> </span> <span> Updated <time data-ts="1723537044" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Aug 13, 2024 </time> </span><div class="mt-3 mb-3"> <a href="/assets/9a9aa892f9a9/1*c-ioRH_Z2nMYRxSbuBD71A.webp" class="popup img-link preview-img blur"><img data-src="/assets/9a9aa892f9a9/1*c-ioRH_Z2nMYRxSbuBD71A.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></div><div class="d-flex justify-content-between"> <span style="display: inline-flex; align-items: center; gap: 4px;"> By <em> <a href="https://www.linkedin.com/in/zhgchgli">ZhgChgLi</a> </em> | <em><a href="https://www.linkedin.com/in/zhgchgli" target="_blank">Senior Software Engineer</a></em><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" style="display: block; "><path fill="#007bff" d="M271.2 56C265.1 49.8 256.2 47.3 247.8 49.6C239.4 51.9 232.9 58.4 230.8 66.8L215.5 127C214.4 131.4 209.9 134 205.6 132.7L145.8 115.9C137.4 113.5 128.4 115.9 122.3 122C116.2 128.1 113.8 137.1 116.2 145.5L133.1 205.3C134.3 209.6 131.7 214.1 127.4 215.2L67.1 230.5C58.7 232.6 52.1 239.2 49.8 247.6C47.5 256 50 264.9 56.2 271L100.7 314.3C103.9 317.4 103.9 322.6 100.7 325.8L56.3 369.1C50.1 375.2 47.6 384.1 49.9 392.5C52.2 400.9 58.8 407.4 67.2 409.6L127.4 424.9C131.8 426 134.4 430.5 133.1 434.8L116.2 494.5C113.8 502.9 116.2 511.9 122.3 518C128.4 524.1 137.4 526.5 145.8 524.1L205.6 507.2C209.9 506 214.4 508.6 215.5 512.9L230.8 573.1C232.9 581.5 239.5 588.1 247.9 590.4C256.3 592.7 265.2 590.2 271.3 584L314.6 539.5C317.7 536.3 322.9 536.3 326.1 539.5L369.3 584C375.4 590.2 384.3 592.7 392.7 590.4C401.1 588.1 407.6 581.5 409.8 573.1L425.1 513C426.2 508.6 430.7 506 435 507.3L494.8 524.2C503.2 526.6 512.2 524.2 518.3 518.1C524.4 512 526.8 503 524.4 494.6L507.5 434.8C506.3 430.5 508.9 426 513.2 424.9L573.4 409.6C581.8 407.5 588.4 400.9 590.7 392.5C593 384.1 590.5 375.1 584.3 369.1L539.8 325.8C536.6 322.7 536.6 317.5 539.8 314.3L584.3 271C590.5 264.9 593 256 590.7 247.6C588.4 239.2 581.8 232.7 573.4 230.5L513.2 215.2C508.8 214.1 506.2 209.6 507.5 205.3L524.4 145.5C526.8 137.1 524.4 128.1 518.3 122C512.2 115.9 503.2 113.5 494.8 115.9L435 132.8C430.7 134 426.2 131.4 425.1 127.1L409.8 66.8C407.7 58.4 401.1 51.8 392.7 49.5C384.3 47.2 375.4 49.7 369.3 55.9L326 100.5C322.9 103.7 317.7 103.7 314.5 100.5L271.2 56z"/><path d="M250 330 l60 60 100 -140" stroke="#ffffff" stroke-width="40" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1216 words" > <em>6 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Vision Face DetectionÔΩúSwift App Auto Crop Profile Pictures with Precision</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Chapters üîñ</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Vision Face DetectionÔΩúSwift App Auto Crop Profile Pictures with Precision</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/zh-cn/vision%E6%A1%86%E6%9E%B6swift%E6%95%99%E5%AD%A6-app%E8%87%AA%E5%8A%A8%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB%E8%A3%81%E5%9B%BE%E5%AE%9E%E4%BD%9C%E6%8C%87%E5%8D%97-9a9aa892f9a9/"><strong>ÁÇπÂáªËøôÈáå</strong></a>Êü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ</p></blockquote><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/vision%E6%A1%86%E6%9E%B6swift%E6%95%99%E5%AD%B8-app%E8%87%AA%E5%8B%95%E4%BA%BA%E8%87%89%E8%AD%98%E5%88%A5%E8%A3%81%E5%9C%96%E5%AF%A6%E4%BD%9C%E6%8C%87%E5%8D%97-9a9aa892f9a9/"><strong>ÈªûÊìäÈÄôË£°</strong></a>Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ</p></blockquote><blockquote class="prompt-info"><p>This post was translated with AI assistance ‚Äî let me know if anything sounds off!</p></blockquote><h4 id="zhgchgli-table-of-contents">Table of Contents</h4><nav class="zhgchgli-toc"><ul class="zhgchgli-toc-list"><li><a href="#vision-exploration--automatic-face-detection-and-cropping-for-app-avatar-upload-swift">Vision Exploration ‚Äî Automatic Face Detection and Cropping for App Avatar Upload (Swift)</a></li><li class="has-children"><details><summary>[2024/08/13 Update] <a href="#20240813-update">#</a></summary><ul><li><a href="#without-further-ado-here-is-the-finished-product">Without further ado, here is the finished product</a></li></ul></details></li><li class="has-children"><details><summary>Let‚Äôs Get Started <a href="#lets-get-started">#</a></summary><ul><li><a href="#first-lets-create-a-function-that-can-mark-face-locations-to-get-a-basic-understanding-of-how-to-use-vision">First, let‚Äôs create a function that can mark face locations to get a basic understanding of how to use Vision.</a></li><li><a href="#next-lets-move-on-to-todays-main-task--cropping-the-profile-picture-according-to-the-face-position">Next, let‚Äôs move on to today‚Äôs main task ‚Äî cropping the profile picture according to the face position.</a></li><li><a href="#final-render">Final Render</a></li></ul></details></li><li><a href="#complete-app-example">Complete APP Example</a></li></ul></nav><hr /><h3 id="vision-exploration--automatic-face-detection-and-cropping-for-app-avatar-upload-swift"><span class="me-2">Vision Exploration ‚Äî Automatic Face Detection and Cropping for App Avatar Upload (Swift)</span><a href="#vision-exploration--automatic-face-detection-and-cropping-for-app-avatar-upload-swift" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Vision Practical Applications</p><h3 id="20240813-update"><span class="me-2">[2024/08/13 Update]</span><a href="#20240813-update" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Please refer to the new article and new API: ‚Äú<a href="/posts/kkday-tech-blog/en/ios-vision-framework-explore-swift-api-enhancements-from-wwdc-24-session-755509180ca8/">iOS Vision framework x WWDC 24 Discover Swift enhancements in the Vision framework Session</a>‚Äù</ul><h4 id="without-further-ado-here-is-the-finished-product"><span class="me-2">Without further ado, here is the finished product:</span><a href="#without-further-ado-here-is-the-finished-product" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/9a9aa892f9a9/1*c-ioRH_Z2nMYRxSbuBD71A.webp" class="popup img-link blur"><img data-src="/assets/9a9aa892f9a9/1*c-ioRH_Z2nMYRxSbuBD71A.webp" alt="Before Optimization vs After Optimization ‚Äî [ÁµêÂ©öÂêßAPP](https://itunes.apple.com/tw/app/%E7%B5%90%E5%A9%9A%E5%90%A7-%E4%B8%8D%E6%89%BE%E6%9C%80%E8%B2%B4-%E5%8F%AA%E6%89%BE%E6%9C%80%E5%B0%8D/id1356057329?ls=1&amp;mt=8){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjUyNCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Before Optimization V.S After Optimization ‚Äî <a href="https://itunes.apple.com/tw/app/%E7%B5%90%E5%A9%9A%E5%90%A7-%E4%B8%8D%E6%89%BE%E6%9C%80%E8%B2%B4-%E5%8F%AA%E6%89%BE%E6%9C%80%E5%B0%8D/id1356057329?ls=1&amp;mt=8" target="_blank">ÁµêÂ©öÂêßAPP</a></p><p>Recently, iOS 12 released an update, introducing the new CoreML machine learning framework. I found it quite interesting and started thinking about where it could be integrated into current products.</p><blockquote><p><strong>CoreML Preview Article Now Published: <a href="/posts/zrealm-dev/en/coreml-2-0-automate-article-classification-with-custom-trained-machine-learning-models-793bf2cdda0f/">Automatically Predict Article Categories Using Machine Learning, Including Training the Model Yourself</a></strong></p></blockquote><p>CoreML provides interfaces for training and integrating text and image machine learning models into apps. My original idea was to use CoreML for facial recognition to solve the problem of cropped heads or faces in the app‚Äôs image cropping feature. As shown in the left image above, if a face appears near the edge, scaling and cropping can easily cut off part of the face.</p><p>After some online research, I realized my knowledge was limited. This feature was already released in iOS 11: the ‚ÄúVision‚Äù framework, which supports text detection, face detection, image matching, QR code detection, object tracking, and more.</p><p>This uses the face detection feature, optimized as shown in the right image; it locates the face and crops the image centered on it.</p><h3 id="lets-get-started"><span class="me-2">Let‚Äôs Get Started:</span><a href="#lets-get-started" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="first-lets-create-a-function-that-can-mark-face-locations-to-get-a-basic-understanding-of-how-to-use-vision"><span class="me-2">First, let‚Äôs create a function that can mark face locations to get a basic understanding of how to use Vision.</span><a href="#first-lets-create-a-function-that-can-mark-face-locations-to-get-a-basic-understanding-of-how-to-use-vision" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/9a9aa892f9a9/1*cpGgpXsBhuiJoZI03WAGUw.webp" class="popup img-link blur"><img data-src="/assets/9a9aa892f9a9/1*cpGgpXsBhuiJoZI03WAGUw.webp" alt="Demo APP" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MzIiIGhlaWdodD0iNTcwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Demo APP</p><p>As shown in the completed image above, it can mark the positions of the faces in the photo.</p><p>p.s Only ‚Äúfaces‚Äù can be tagged; the entire head including hair is not allowed üòÖ</p><p>This code is mainly divided into two parts. The first part addresses the issue of blank spaces when scaling the original image size to fit into an ImageView. Simply put, we want the ImageView‚Äôs size to match the Image‚Äôs size exactly. Directly placing the image causes alignment problems as shown below.</p><p><a href="/assets/9a9aa892f9a9/1*Mb70Ed6pALO-8sllCpb7Qg.webp" class="popup img-link blur"><img data-src="/assets/9a9aa892f9a9/1*Mb70Ed6pALO-8sllCpb7Qg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDcwIiBoZWlnaHQ9IjEwMTQiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>You might think of directly changing ContentMode to fill, fit, or redraw, but this will cause distortion or the image to be cut off.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">ratio</span> <span class="o">=</span> <span class="kt">UIScreen</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span>
<span class="c1">// Here, because my UIImageView is set to align left and right at 0, with an aspect ratio of 1:1</span>

<span class="k">let</span> <span class="nv">sourceImage</span> <span class="o">=</span> <span class="kt">UIImage</span><span class="p">(</span><span class="nv">named</span><span class="p">:</span> <span class="s">"Demo2"</span><span class="p">)?</span><span class="o">.</span><span class="n">kf</span><span class="o">.</span><span class="nf">resize</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="kt">CGSize</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="n">ratio</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="kt">CGFloat</span><span class="o">.</span><span class="n">leastNonzeroMagnitude</span><span class="p">),</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">aspectFill</span><span class="p">)</span>
<span class="c1">// Using KingFisher's image resizing feature, width as the base, height flexible</span>

<span class="n">imageView</span><span class="o">.</span><span class="n">contentMode</span> <span class="o">=</span> <span class="o">.</span><span class="n">redraw</span>
<span class="c1">// contentMode set to redraw to fill</span>

<span class="n">imageView</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">sourceImage</span>
<span class="c1">// Assign the image</span>

<span class="n">imageViewConstraints</span><span class="o">.</span><span class="n">constant</span> <span class="o">=</span> <span class="p">(</span><span class="n">ratio</span> <span class="o">-</span> <span class="p">(</span><span class="n">sourceImage</span><span class="p">?</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">height</span> <span class="p">??</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">imageView</span><span class="o">.</span><span class="nf">layoutIfNeeded</span><span class="p">()</span>
<span class="n">imageView</span><span class="o">.</span><span class="nf">sizeToFit</span><span class="p">()</span>
<span class="c1">// This part adjusts the imageView's constraints, see the full example at the end of the article</span>
</pre></table></code></div></div><p>The above is the processing done for the image.</p><p><em>For image cropping, we use Kingfisher to assist us, but it can be replaced with other libraries or custom methods</em></p><p>Part Two, Getting Straight to the Code</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre><span class="k">if</span> <span class="k">#available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">11.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Supported only after iOS 11</span>
    <span class="k">let</span> <span class="nv">completionHandle</span><span class="p">:</span> <span class="kt">VNRequestCompletionHandler</span> <span class="o">=</span> <span class="p">{</span> <span class="n">request</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">faceObservations</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">results</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">VNFaceObservation</span><span class="p">]</span> <span class="p">{</span>
            <span class="c1">// Detected faces</span>
            
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="c1">// Operate UIView, switch back to main thread</span>
                <span class="k">let</span> <span class="nv">size</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">imageView</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">size</span>
                
                <span class="n">faceObservations</span><span class="o">.</span><span class="nf">forEach</span><span class="p">({</span> <span class="p">(</span><span class="n">faceObservation</span><span class="p">)</span> <span class="k">in</span>
                    <span class="c1">// Coordinate system transformation</span>
                    <span class="k">let</span> <span class="nv">translate</span> <span class="o">=</span> <span class="kt">CGAffineTransform</span><span class="o">.</span><span class="n">identity</span><span class="o">.</span><span class="nf">scaledBy</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="n">size</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="n">size</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
                    <span class="k">let</span> <span class="nv">transform</span> <span class="o">=</span> <span class="kt">CGAffineTransform</span><span class="p">(</span><span class="nv">scaleX</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="nf">translatedBy</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="o">-</span><span class="n">size</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
                    <span class="k">let</span> <span class="nv">transRect</span> <span class="o">=</span>  <span class="n">faceObservation</span><span class="o">.</span><span class="n">boundingBox</span><span class="o">.</span><span class="nf">applying</span><span class="p">(</span><span class="n">translate</span><span class="p">)</span><span class="o">.</span><span class="nf">applying</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>
                    
                    <span class="k">let</span> <span class="nv">markerView</span> <span class="o">=</span> <span class="kt">UIView</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="n">transRect</span><span class="p">)</span>
                    <span class="n">markerView</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">red</span><span class="p">:</span> <span class="mi">0</span><span class="sr">/255, green: 255/255, blue: 0/</span><span class="mi">255</span><span class="p">,</span> <span class="nv">alpha</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">)</span>
                    <span class="k">self</span><span class="o">.</span><span class="n">imageView</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="n">markerView</span><span class="p">)</span>
                <span class="p">})</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"No faces detected"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="c1">// Recognition request</span>
    <span class="k">let</span> <span class="nv">baseRequest</span> <span class="o">=</span> <span class="kt">VNDetectFaceRectanglesRequest</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="n">completionHandle</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">faceHandle</span> <span class="o">=</span> <span class="kt">VNImageRequestHandler</span><span class="p">(</span><span class="nv">ciImage</span><span class="p">:</span> <span class="n">ciImage</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[:])</span>
    <span class="kt">DispatchQueue</span><span class="o">.</span><span class="nf">global</span><span class="p">()</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
        <span class="c1">// Recognition takes time, so run on background thread to avoid UI blocking</span>
        <span class="k">do</span><span class="p">{</span>
            <span class="k">try</span> <span class="n">faceHandle</span><span class="o">.</span><span class="nf">perform</span><span class="p">([</span><span class="n">baseRequest</span><span class="p">])</span>
        <span class="p">}</span><span class="k">catch</span><span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Throws: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
  
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">//</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Not supported"</span><span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The main point to note is the coordinate system conversion; the recognized result is in the original coordinates of the Image. We need to convert it to the actual coordinates within the enclosing ImageView to use it correctly.</p><h4 id="next-lets-move-on-to-todays-main-task--cropping-the-profile-picture-according-to-the-face-position"><span class="me-2">Next, let‚Äôs move on to today‚Äôs main task ‚Äî cropping the profile picture according to the face position.</span><a href="#next-lets-move-on-to-todays-main-task--cropping-the-profile-picture-according-to-the-face-position" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre><span class="n">let</span> <span class="n">ratio</span> <span class="o">=</span> <span class="nc">UIScreen</span><span class="mf">.</span><span class="n">main</span><span class="mf">.</span><span class="n">bounds</span><span class="mf">.</span><span class="n">size</span><span class="mf">.</span><span class="n">width</span>
<span class="c1">// Here, because my UIImageView is set to align left and right at 0, with an aspect ratio of 1:1. See the full example at the end.</span>

<span class="n">let</span> <span class="n">sourceImage</span> <span class="o">=</span> <span class="nf">UIImage</span><span class="p">(</span><span class="n">named</span><span class="o">:</span> <span class="s2">"Demo"</span><span class="p">)</span>

<span class="n">imageView</span><span class="mf">.</span><span class="n">contentMode</span> <span class="o">=</span> <span class="mf">.</span><span class="n">scaleAspectFill</span>
<span class="c1">// Use scaleAspectFill mode to fill</span>

<span class="n">imageView</span><span class="mf">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">sourceImage</span>
<span class="c1">// Directly assign the original image, we'll manipulate it later</span>

<span class="k">if</span> <span class="n">let</span> <span class="n">image</span> <span class="o">=</span> <span class="n">sourceImage</span><span class="p">,</span> <span class="c1">#available(iOS 11.0, *), let ciImage = CIImage(image: image) {</span>
    <span class="n">let</span> <span class="n">completionHandle</span><span class="o">:</span> <span class="nc">VNRequestCompletionHandler</span> <span class="o">=</span> <span class="p">{</span> <span class="n">request</span><span class="p">,</span> <span class="n">error</span> <span class="n">in</span>
        <span class="k">if</span> <span class="n">request</span><span class="mf">.</span><span class="n">results</span><span class="o">?</span><span class="mf">.</span><span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">let</span> <span class="n">faceObservation</span> <span class="o">=</span> <span class="n">request</span><span class="mf">.</span><span class="n">results</span><span class="o">?</span><span class="mf">.</span><span class="n">first</span> <span class="k">as</span><span class="o">?</span> <span class="nc">VNFaceObservation</span> <span class="p">{</span>
            <span class="c1">// One face detected</span>
            <span class="n">let</span> <span class="n">size</span> <span class="o">=</span> <span class="nf">CGSize</span><span class="p">(</span><span class="n">width</span><span class="o">:</span> <span class="n">ratio</span><span class="p">,</span> <span class="n">height</span><span class="o">:</span> <span class="n">ratio</span><span class="p">)</span>
            
            <span class="n">let</span> <span class="n">translate</span> <span class="o">=</span> <span class="nc">CGAffineTransform</span><span class="mf">.</span><span class="n">identity</span><span class="mf">.</span><span class="nf">scaledBy</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="n">size</span><span class="mf">.</span><span class="n">width</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="n">size</span><span class="mf">.</span><span class="n">height</span><span class="p">)</span>
            <span class="n">let</span> <span class="n">transform</span> <span class="o">=</span> <span class="nf">CGAffineTransform</span><span class="p">(</span><span class="n">scaleX</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="mf">.</span><span class="nf">translatedBy</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="o">-</span><span class="n">size</span><span class="mf">.</span><span class="n">height</span><span class="p">)</span>
            <span class="n">let</span> <span class="n">finalRect</span> <span class="o">=</span> <span class="n">faceObservation</span><span class="mf">.</span><span class="n">boundingBox</span><span class="mf">.</span><span class="nf">applying</span><span class="p">(</span><span class="n">translate</span><span class="p">)</span><span class="mf">.</span><span class="nf">applying</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>
            
            <span class="n">let</span> <span class="n">center</span> <span class="o">=</span> <span class="nf">CGPoint</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="p">(</span><span class="n">finalRect</span><span class="mf">.</span><span class="n">origin</span><span class="mf">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">finalRect</span><span class="mf">.</span><span class="n">width</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">size</span><span class="mf">.</span><span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">y</span><span class="o">:</span> <span class="p">(</span><span class="n">finalRect</span><span class="mf">.</span><span class="n">origin</span><span class="mf">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">finalRect</span><span class="mf">.</span><span class="n">height</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">size</span><span class="mf">.</span><span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
            <span class="c1">// Calculate the center point of the face bounding box</span>
            
            <span class="n">let</span> <span class="n">newImage</span> <span class="o">=</span> <span class="n">image</span><span class="mf">.</span><span class="n">kf</span><span class="mf">.</span><span class="nf">resize</span><span class="p">(</span><span class="n">to</span><span class="o">:</span> <span class="n">size</span><span class="p">,</span> <span class="k">for</span><span class="o">:</span> <span class="mf">.</span><span class="n">aspectFill</span><span class="p">)</span><span class="mf">.</span><span class="n">kf</span><span class="mf">.</span><span class="nf">crop</span><span class="p">(</span><span class="n">to</span><span class="o">:</span> <span class="n">size</span><span class="p">,</span> <span class="n">anchorOn</span><span class="o">:</span> <span class="n">center</span><span class="p">)</span>
            <span class="c1">// Crop the image based on the center point</span>
            
            <span class="nc">DispatchQueue</span><span class="mf">.</span><span class="n">main</span><span class="mf">.</span><span class="n">async</span> <span class="p">{</span>
                <span class="c1">// Update UIView on the main thread</span>
                <span class="k">self</span><span class="mf">.</span><span class="n">imageView</span><span class="mf">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">newImage</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">"Detected multiple faces or no face detected"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">let</span> <span class="n">baseRequest</span> <span class="o">=</span> <span class="nf">VNDetectFaceRectanglesRequest</span><span class="p">(</span><span class="n">completionHandler</span><span class="o">:</span> <span class="n">completionHandle</span><span class="p">)</span>
    <span class="n">let</span> <span class="n">faceHandle</span> <span class="o">=</span> <span class="nf">VNImageRequestHandler</span><span class="p">(</span><span class="n">ciImage</span><span class="o">:</span> <span class="n">ciImage</span><span class="p">,</span> <span class="n">options</span><span class="o">:</span> <span class="p">[</span><span class="o">:</span><span class="p">])</span>
    <span class="nc">DispatchQueue</span><span class="mf">.</span><span class="k">global</span><span class="p">()</span><span class="mf">.</span><span class="n">async</span> <span class="p">{</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">try</span> <span class="n">faceHandle</span><span class="mf">.</span><span class="nf">perform</span><span class="p">([</span><span class="n">baseRequest</span><span class="p">])</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">"Throws: \(error)"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"Not supported"</span><span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The principle is similar to marking face positions. The difference is that the profile picture has a fixed size (e.g., 300x300), so we skip the first part where the Image needs to fit the ImageView.</p><p>Another difference is that we need to calculate the center point of the face area and use this center point as the reference to crop the image.</p><p><a href="/assets/9a9aa892f9a9/1*civytcKOguHfVFHYPVWecA.webp" class="popup img-link blur"><img data-src="/assets/9a9aa892f9a9/1*civytcKOguHfVFHYPVWecA.webp" alt="Red dot indicates the center point of the face area" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNjAiIGhlaWdodD0iMTU4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>The red dot marks the center point of the face area</p><h4 id="final-render"><span class="me-2">Final Render:</span><a href="#final-render" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/9a9aa892f9a9/1*WocYjt0xLkqtGVilxfT2LA.gif" class="popup img-link blur"><img data-src="/assets/9a9aa892f9a9/1*WocYjt0xLkqtGVilxfT2LA.gif" alt="The moment before the pause is the original image location" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNzAiIGhlaWdodD0iNDE0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>The moment just before the snap is the original image position</p><h3 id="complete-app-example"><span class="me-2">Complete APP Example:</span><a href="#complete-app-example" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/9a9aa892f9a9/1*J8oByw8gBCamIac2TkT1SA.gif" class="popup img-link blur"><img data-src="/assets/9a9aa892f9a9/1*J8oByw8gBCamIac2TkT1SA.gif" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNzAiIGhlaWdodD0iNDE0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>The code has been uploaded to Github: <a href="https://github.com/zhgchgli0718/VisionDemo" target="_blank">Click here</a></p><p>If you have any questions or feedback, feel free to <a href="https://www.zhgchg.li/contact" target="_blank">contact me</a>.</p><script src="/assets/clipboard.min.js"></script><div style=" display:flex; align-items:center; gap:10px; border:1px solid #e5e7eb; background:#f9fafb; padding:12px 16px; border-radius:12px; margin:18px 0; box-shadow:0 3px 8px rgba(0,0,0,0.05); width: auto;"> <input id="share-url" value="https://zhgchg.li/posts/zrealm-dev/en/vision-face-detection-swift-app-auto-crop-profile-pictures-with-precision-9a9aa892f9a9/" readonly="" style=" flex:1; border:1px solid #d1d5db; border-radius:8px; padding:10px 12px; font-size:0.9rem; background:#ffffff; color:#111827; outline:none; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; " /> <button class="btn" data-clipboard-target="#share-url" id="copy-btn" style=" border:none; background:#3b82f6; color:white; padding:10px 16px; border-radius:10px; cursor:pointer; font-size:0.85rem; font-weight:600; display:flex; align-items:center; gap:6px; transition:all .15s ease; box-shadow:0 2px 5px rgba(59,130,246,0.35); " onmouseover="this.style.opacity='0.92';" onmouseout="this.style.opacity='1';"> <span style="font-size:1rem;">üîó</span> <span id="copy-btn-text">Copy link to share!</span> </button></div><script> new ClipboardJS('.btn'); var btn = document.getElementById("copy-btn"); var text = document.getElementById("copy-btn-text"); btn.addEventListener("click", function () { text.textContent = "Copied!"; btn.style.background = "#16a34a"; btn.style.boxShadow = "0 2px 6px rgba(22,163,74,0.35)"; setTimeout(() => { text.textContent = "Copy link to share!"; btn.style.background = "#3b82f6"; btn.style.boxShadow = "0 2px 5px rgba(59,130,246,0.35)"; }, 1500); });</script><hr /><p><a href="https://www.paypal.com/ncp/payment/CMALMPT8UUTY2" target="_blank" rel="noopener" style="display:block;margin:12px 0;text-align:center;align-items:center;justify-content:center;padding:10px 22px;border-radius:999px;text-decoration:none;background:linear-gradient(135deg,#ffd54f,#ffb300);color:#000;font-size:16px;font-weight:700;font-family:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;box-shadow:0 4px 10px rgba(0,0,0,.15);cursor:pointer;transition:all .15s ease;width:350px" onmouseover="this.style.background=&quot;linear-gradient(135deg,#FFE082,#FFC107)&quot;,this.style.transform=&quot;translateY(-1px)&quot;,this.style.boxShadow=&quot;0 6px 14px rgba(0,0,0,0.2)&quot;" onmouseout="this.style.background=&quot;linear-gradient(135deg,#FFD54F,#FFB300)&quot;,this.style.transform=&quot;translateY(0)&quot;,this.style.boxShadow=&quot;0 4px 10px rgba(0,0,0,0.15)&quot;">üç∫ Buy me a beer on PayPal</a></p><blockquote class="prompt-info"><p>This post was originally published on Medium (<a href="https://medium.com/p/9a9aa892f9a9" target="_blank"><strong>View original post</strong></a>), and automatically converted and synced by <a href="/posts/tools/medium-to-jekyll/" target="_blank">ZMediumToMarkdown</a>.</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/en/zmediumtomarkdown/2018-10-16-9a9aa892f9a9.md" target="_blank">Improve this page on Github.</a></p></blockquote><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1,050+ Followers</span></a></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-dev/">ZRealm Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/english/" class="post-tag no-text-decoration" >english</a> <a href="/tags/ai-translation/" class="post-tag no-text-decoration" >ai-translation</a> <a href="/tags/swift/" class="post-tag no-text-decoration" >swift</a> <a href="/tags/machine-learning/" class="post-tag no-text-decoration" >machine-learning</a> <a href="/tags/face-detection/" class="post-tag no-text-decoration" >face-detection</a> <a href="/tags/ios/" class="post-tag no-text-decoration" >ios</a> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Vision%20Face%20Detection%EF%BD%9CSwift%20App%20Auto%20Crop%20Profile%20Pictures%20with%20Precision%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fen%2Fvision-face-detection-swift-app-auto-crop-profile-pictures-with-precision-9a9aa892f9a9%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Vision%20Face%20Detection%EF%BD%9CSwift%20App%20Auto%20Crop%20Profile%20Pictures%20with%20Precision%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fen%2Fvision-face-detection-swift-app-auto-crop-profile-pictures-with-precision-9a9aa892f9a9%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fen%2Fvision-face-detection-swift-app-auto-crop-profile-pictures-with-precision-9a9aa892f9a9%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/en/app-store-connect-api-webhook-automate-ci-cd-workflows-seamlessly-7c0974856393/">App Store Connect API WebhookÔΩúAutomate CI/CD Workflows Seamlessly</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/zh-cn/app-store-connect-api-webhook-%E4%B8%B2%E6%8E%A5-%E6%8F%90%E5%8D%87-ios-ci-cd-%E8%87%AA%E5%8A%A8%E5%8C%96%E6%95%88%E7%8E%87%E4%B8%8E%E9%80%9A%E7%9F%A5%E6%B5%81%E7%A8%8B-7c0974856393/">CI/CD ‰ΩøÁî® App Store Connect API Webhook ‰∏≤Êé•Ëá™Âä®ÂåñÂ∑•‰ΩúÊµÅÁ®ã</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/app-store-connect-api-webhook-%E4%B8%B2%E6%8E%A5-%E6%8F%90%E5%8D%87-ios-ci-cd-%E8%87%AA%E5%8B%95%E5%8C%96%E6%95%88%E7%8E%87%E8%88%87%E9%80%9A%E7%9F%A5%E6%B5%81%E7%A8%8B-7c0974856393/">CI/CD ‰ΩøÁî® App Store Connect API Webhook ‰∏≤Êé•Ëá™ÂãïÂåñÂ∑•‰ΩúÊµÅÁ®ã</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/en/ci-cd-explained-boost-ios-app-development-stability-and-efficiency-tool-selection-guide-c008a9e8ceca/">CI/CD Explained: Boost iOS App Development Stability and EfficiencyÔΩúTool Selection Guide</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/zh-cn/ci-cd-%E6%98%AF%E4%BB%80%E4%B9%88-%E6%89%93%E9%80%A0%E9%AB%98%E6%95%88%E7%A8%B3%E5%AE%9A%E5%BC%80%E5%8F%91%E5%9B%A2%E9%98%9F%E7%9A%84%E5%85%B3%E9%94%AE%E6%B5%81%E7%A8%8B%E4%B8%8E%E5%B7%A5%E5%85%B7%E9%80%89%E6%8B%A9-c008a9e8ceca/">CI/CD ÂÆûÊàòÊåáÂçóÔºà‰∏ÄÔºâÔºöCI/CD ÊòØ‰ªÄ‰πàÔºüÂ¶Ç‰ΩïÈÄèËøá CI/CD ÊâìÈÄ†Á®≥ÂÆöÈ´òÊïàÁöÑÂºÄÂèëÂõ¢ÈòüÔºüÂ∑•ÂÖ∑ÈÄâÊã©Ôºü</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">ÁîüÊ¥ª</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Chapters üîñ</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-dev/en/coreml-2-0-automate-article-classification-with-custom-trained-machine-learning-models-793bf2cdda0f/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1539789635" data-df="ll" > Oct 17, 2018 </time><h4 class="pt-0 my-2">CoreML 2.0ÔΩúAutomate Article Classification with Custom-Trained Machine Learning Models</h4><div class="text-muted"><p>Discover how iOS developers leverage CoreML 2.0 to train and convert machine learning models, enabling automatic article classification and seamless integration into real-world apps for improved ac...</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/en/ios-12-enable-quick-access-to-app-notification-settings-in-user-settings-with-swift-f644db1bb8bf/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1542033522" data-df="ll" > Nov 12, 2018 </time><h4 class="pt-0 my-2">iOS ‚â• 12ÔΩúEnable Quick Access to App Notification Settings in User Settings with Swift</h4><div class="text-muted"><p>Help iOS users easily manage app notifications by adding a direct shortcut to the notification settings page within the app using Swift, offering alternatives beyond system-wide notification toggle...</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/en/ios-notification-permission-handling-swift-solutions-for-ios-9-to-ios-12-fd7f92d52baa/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1541172224" data-df="ll" > Nov 2, 2018 </time><h4 class="pt-0 my-2">iOS Notification Permission HandlingÔΩúSwift Solutions for iOS 9 to iOS 12</h4><div class="text-muted"><p>Discover how to manage and request notification permissions effectively across iOS 9 to iOS 12 using Swift, ensuring seamless user experience and consistent app behavior.</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-dev/ios-notification-service-extension-swift-%E5%AF%A6%E4%BD%9C%E5%9C%96%E7%89%87%E6%8E%A8%E6%92%AD%E8%88%87%E9%A1%AF%E7%A4%BA%E7%B5%B1%E8%A8%88%E6%8A%80%E5%B7%A7-cb6eba52a342/" class="btn btn-outline-primary" aria-label="Older" ><p>iOS Notification Service ExtensionÔΩúSwift ÂØ¶‰ΩúÂúñÁâáÊé®Êí≠ËàáÈ°ØÁ§∫Áµ±Ë®àÊäÄÂ∑ß</p></a> <a href="/posts/zrealm-dev/zh-cn/vision%E6%A1%86%E6%9E%B6swift%E6%95%99%E5%AD%A6-app%E8%87%AA%E5%8A%A8%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB%E8%A3%81%E5%9B%BE%E5%AE%9E%E4%BD%9C%E6%8C%87%E5%8D%97-9a9aa892f9a9/" class="btn btn-outline-primary" aria-label="Newer" ><p>Vision ÂàùÊé¢‚Ää‚Äî‚ÄäAPP Â§¥ÂÉè‰∏ä‰º† Ëá™Âä®ËØÜÂà´‰∫∫ËÑ∏Ë£ÅÂõæ (Swift)</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>¬© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span> <a href="/">Ê≠£È´î‰∏≠Êñá</a> | <a href="/tags/simplified-chinese">ÁÆÄ‰Ωì‰∏≠Êñá</a> | <a href="/tags/english/">English</a> <br/> Last updated: 2025-12-27 17:20:05 +08:00</p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">ÁîüÊ¥ª</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
