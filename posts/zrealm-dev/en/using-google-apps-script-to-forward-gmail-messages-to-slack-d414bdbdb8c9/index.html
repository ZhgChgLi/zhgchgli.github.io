<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Using Google Apps Script to Forward Gmail Messages to Slack" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="Automatically forward customized content to a Slack Channel using Gmail Filter + Google Apps Script when receiving emails." /><meta property="og:description" content="Automatically forward customized content to a Slack Channel using Gmail Filter + Google Apps Script when receiving emails." /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-dev/en/using-google-apps-script-to-forward-gmail-messages-to-slack-d414bdbdb8c9/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-dev/en/using-google-apps-script-to-forward-gmail-messages-to-slack-d414bdbdb8c9/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/d414bdbdb8c9/1*U6CDgIAMt2l2vDoFqhwv6A.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-07T20:19:49+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/d414bdbdb8c9/1*U6CDgIAMt2l2vDoFqhwv6A.webp" /><meta property="twitter:title" content="Using Google Apps Script to Forward Gmail Messages to Slack" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://medium.com/@zhgchgli/"},"dateModified":"2024-04-14T09:54:47+08:00","datePublished":"2021-08-07T20:19:49+08:00","description":"Automatically forward customized content to a Slack Channel using Gmail Filter + Google Apps Script when receiving emails.","headline":"Using Google Apps Script to Forward Gmail Messages to Slack","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9Ijc5NSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg==","url":"https://zhgchg.li/assets/d414bdbdb8c9/1*U6CDgIAMt2l2vDoFqhwv6A.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-dev/en/using-google-apps-script-to-forward-gmail-messages-to-slack-d414bdbdb8c9/"},"url":"https://zhgchg.li/posts/zrealm-dev/en/using-google-apps-script-to-forward-gmail-messages-to-slack-d414bdbdb8c9/"}</script><title>Using Google Apps Script to Forward Gmail Messages to Slack | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0"> <a href="https://medium.com/@zhgchgli" target="_blank" style="display: block;text-align: center;font-style: normal;/* text-decoration: underline; */font-size: 1.2em;color: var(--heading-color);">1K+ Followers on Medium</a> An iOS, web, and automation developer from Taiwan 🇹🇼 who also loves sharing, traveling, and writing.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Using Google Apps Script to Forward Gmail Messages to Slack</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Using Google Apps Script to Forward Gmail Messages to Slack</h1><p class="post-desc fw-light mb-4">Automatically forward customized content to a Slack Channel using Gmail Filter + Google Apps Script when receiving emails.</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1628338789" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Aug 7, 2021 </time> </span> <span> Updated <time data-ts="1713059687" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 14, 2024 </time> </span><div class="mt-3 mb-3"> <a href="/assets/d414bdbdb8c9/1*U6CDgIAMt2l2vDoFqhwv6A.webp" class="popup img-link preview-img blur"><img data-src="/assets/d414bdbdb8c9/1*U6CDgIAMt2l2vDoFqhwv6A.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9Ijc5NSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://medium.com/@zhgchgli/">ZhgChgLi</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1575 words" > <em>8 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Using Google Apps Script to Forward Gmail Messages to Slack</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Using Google Apps Script to Forward Gmail Messages to Slack</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic> <script async="" src="https://widgetic.com/sdk/sdk.js"></script><hr /><h3 id="ℹ️ℹ️ℹ️-the-following-content-is-translated-by-openai"><span class="me-2">ℹ️ℹ️ℹ️ The following content is translated by OpenAI.</span><a href="#ℹ️ℹ️ℹ️-the-following-content-is-translated-by-openai" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="click-here-to-view-the-original-chinese-version--點此查看本文中文版"><span class="me-2"><a href="/posts/d414bdbdb8c9/">Click here</a> to view the original Chinese version. | <a href="/posts/d414bdbdb8c9/">點此查看本文中文版</a></span><a href="#click-here-to-view-the-original-chinese-version--點此查看本文中文版" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><hr /><h3 id="using-google-apps-script-to-forward-gmail-messages-to-slack"><span class="me-2">Using Google Apps Script to Forward Gmail Messages to Slack</span><a href="#using-google-apps-script-to-forward-gmail-messages-to-slack" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Automatically forward customized content to a Slack Channel using Gmail Filter + Google Apps Script when receiving emails.</p><p><a href="/assets/d414bdbdb8c9/1*U6CDgIAMt2l2vDoFqhwv6A.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*U6CDgIAMt2l2vDoFqhwv6A.webp" alt="Photo by [Lukas Blazek](https://unsplash.com/@goumbik?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9Ijc5NSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Photo by <a href="https://unsplash.com/@goumbik?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank">Lukas Blazek</a></p><h3 id="origin"><span class="me-2">Origin</span><a href="#origin" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Recently, while optimizing the CI/CD process for an iOS app, I used Fastlane as the automation tool. After packaging and uploading, if I wanted to continue with the automatic submission steps ( <code class="language-plaintext highlighter-rouge">skip_submission=false</code> ), I had to wait for Apple to complete the process, which could waste about 30-40 minutes of CI server time. This is because the Apple App Store Connect API is not very robust, and Fastlane can only check once per minute whether the uploaded build has been processed, which is a waste of resources.</p><p><a href="/assets/d414bdbdb8c9/1*JXuVoKM-gGJwfvF7tXY1nQ.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*JXuVoKM-gGJwfvF7tXY1nQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2ODIiIGhlaWdodD0iNDgzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li><strong>Bitrise CI Server:</strong> Limits the number of concurrent builds and has a maximum execution time of 90 minutes. While 90 minutes is sufficient, it can block one build from allowing others to execute.<li><strong>Travis CI Server:</strong> Charges based on build time, making it even less feasible to wait, as costs would accumulate.</ul><h4 id="a-change-in-perspective"><span class="me-2">A Change in Perspective</span><a href="#a-change-in-perspective" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>No more waiting; finish the upload and move on! Trigger subsequent actions based on the notification of the completed email.</p><p><a href="/assets/d414bdbdb8c9/1*57FOYivs5toW2aipgRVCeg.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*57FOYivs5toW2aipgRVCeg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjY3MSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><blockquote><p><strong><em>However, I haven’t received this email recently; I’m not sure if it’s a settings issue or if Apple has stopped sending such notifications.</em></strong></p></blockquote><p>This article will use the notification email for TestFlight, which is already available for testing, as an example.</p><p><a href="/assets/d414bdbdb8c9/1*2fmqWCAMiM2UeuGss7VzzA.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*2fmqWCAMiM2UeuGss7VzzA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTQwIiBoZWlnaHQ9IjU5NyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/d414bdbdb8c9/1*sndRqvnELhCshb6yyPFhqg.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*sndRqvnELhCshb6yyPFhqg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjU4OSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><blockquote><p><em>The complete process is illustrated in the image above; while the principle is feasible, it is not the focus of this article. This article will concentrate on receiving emails and using Apps Script to forward them to a Slack Channel.</em></p></blockquote><h3 id="how-to-forward-received-emails-to-a-slack-channel"><span class="me-2">How to Forward Received Emails to a Slack Channel</span><a href="#how-to-forward-received-emails-to-a-slack-channel" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Whether you have a paid or free Slack project, there are various methods to achieve email forwarding to a Slack Channel or DM.</p><p>You can refer to the official documentation for setup: <a href="https://slack.com/intl/zh-tw/help/articles/206819278-%E5%82%B3%E9%80%81%E9%9B%BB%E5%AD%90%E9%83%B5%E4%BB%B6%E8%87%B3-Slack" target="_blank">Send Emails to Slack</a></p><p><strong>Regardless of the method, the effect is as follows:</strong></p><p><a href="/assets/d414bdbdb8c9/1*qdoLTotLTaeZPsEHaJ8C7Q.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*qdoLTotLTaeZPsEHaJ8C7Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NzYiIGhlaWdodD0iNDAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><blockquote><p><em>By default, the email content is collapsed, and you can click to expand and view all content.</em></p></blockquote><p><strong>Advantages:</strong></p><ol><li>Simple and quick<li>No technical barriers<li>Instant forwarding</ol><p><strong>Disadvantages:</strong></p><ol><li>Cannot customize content<li>Display style cannot be changed</ol><h3 id="customizing-forwarded-content"><span class="me-2">Customizing Forwarded Content</span><a href="#customizing-forwarded-content" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This is the main point of this article.</p><p><a href="/assets/d414bdbdb8c9/1*w4E7wf-Kf8XVFxowmDopIw.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*w4E7wf-Kf8XVFxowmDopIw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MjYiIGhlaWdodD0iMTU3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Translate the email content into the style you want to present, as shown in the example above.</p><h4 id="first-heres-a-complete-workflow-diagram"><span class="me-2">First, here’s a complete workflow diagram:</span><a href="#first-heres-a-complete-workflow-diagram" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/d414bdbdb8c9/1*yB5s_5rBr4l6hid21huJMQ.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*yB5s_5rBr4l6hid21huJMQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjU3MyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ul><li>Use Gmail Filter to label the emails to be forwarded.<li>Apps Script periodically retrieves emails marked with that label.<li>Read the email content.<li>Render it in the desired display style.<li>Send messages to Slack via Slack Bot API or directly using Incoming Message.<li>Remove the email label (indicating it has been forwarded).<li>Done.</ul><h4 id="first-create-a-filter-in-gmail"><span class="me-2">First, create a filter in Gmail</span><a href="#first-create-a-filter-in-gmail" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Filters can automate actions when receiving emails that meet certain criteria, such as automatically marking as read, tagging, moving to spam, categorizing, etc.</p><p><a href="/assets/d414bdbdb8c9/1*qNXxtTLzEnlArl4UTTWQMw.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*qNXxtTLzEnlArl4UTTWQMw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5NzQiIGhlaWdodD0iNDk5Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>In Gmail, click the advanced search icon in the upper right, enter the criteria for the emails to be forwarded, such as from: <code class="language-plaintext highlighter-rouge">no_reply@email.apple.com</code> + subject is <code class="language-plaintext highlighter-rouge">is now available to test.</code>, click “Search” to check if the filter results are as expected; if correct, click the “Create filter” button next to Search.</p><p><a href="/assets/d414bdbdb8c9/1*i7grToZwE_ixwJTEjI9qtw.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*i7grToZwE_ixwJTEjI9qtw.webp" alt="Or directly click Filter message like these at the top of the email to quickly create filter criteria" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MjAiIGhlaWdodD0iMjQ0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Or directly click Filter message like these at the top of the email to quickly create filter criteria.</p><p><a href="/assets/d414bdbdb8c9/1*n_nbqgIlE-E1eaW5QfqkWg.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*n_nbqgIlE-E1eaW5QfqkWg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MjQiIGhlaWdodD0iNDQ1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><blockquote><p>This button is designed in a very user-unfriendly way; I couldn’t find it the first time.</p></blockquote><p><a href="/assets/d414bdbdb8c9/1*6zlooS-cMr5LEVX2TW5I_w.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*6zlooS-cMr5LEVX2TW5I_w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MTUiIGhlaWdodD0iNTc2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Next, set the action for emails that meet this filter condition. Here, we choose “Apply the label” to create a new identifying label “forward-to-slack,” and click “Create filter” to complete it.</p><p>From now on, emails marked with this label will be forwarded to Slack.</p><h3 id="obtain-incoming-webhooks-app-url"><span class="me-2">Obtain Incoming WebHooks App URL</span><a href="#obtain-incoming-webhooks-app-url" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>First, we need to add the Incoming WebHooks App to the Slack Channel, which we will use to send messages.</p><p><a href="/assets/d414bdbdb8c9/1*AgGLiLsyvenK-LRWI9rlKg.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*AgGLiLsyvenK-LRWI9rlKg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDkxIiBoZWlnaHQ9Ijg5NiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ol><li>In Slack, click “Apps” in the lower left -&gt; “Add apps”<li>Search for “incoming” in the search box on the right.<li>Click “Incoming WebHooks” -&gt; “Add”</ol><p><a href="/assets/d414bdbdb8c9/1*DUcwdLTKt33Fa-jNlW8MkA.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*DUcwdLTKt33Fa-jNlW8MkA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDMyIiBoZWlnaHQ9IjQ5MSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/d414bdbdb8c9/1*v8Z-5vEM043F82TMiZk2lw.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*v8Z-5vEM043F82TMiZk2lw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5OTgiIGhlaWdodD0iNDY2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Select the channel where you want to send messages.</p><p><a href="/assets/d414bdbdb8c9/1*SRciom_ygU0JDKK9ATY1FQ.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*SRciom_ygU0JDKK9ATY1FQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5NjYiIGhlaWdodD0iMjMxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Take note of the “Webhook URL” at the top.</p><p><a href="/assets/d414bdbdb8c9/1*kp1QDIEwzQtmfzUwZIDTSg.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*kp1QDIEwzQtmfzUwZIDTSg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MDMiIGhlaWdodD0iMjU5Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Scroll down to set the display name and avatar for the bot when sending messages; remember to click “Save Settings” after making changes.</p><blockquote><p><strong><em>Note</em></strong></p></blockquote><blockquote><p><em>Please note that the official recommendation is to use the new Slack APP Bot API’s <a href="https://api.slack.com/methods/chat.postMessage" target="_blank">chat.postMessage</a> to send messages. The simpler Incoming Webhook method will be deprecated in the future. I took a shortcut here, but it will need to be adjusted to the new method in the next chapter “Import Employee List.”</em></p></blockquote><p><a href="/assets/d414bdbdb8c9/1*QfgJL_Xb9JhgQnPGjU2CXg.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*QfgJL_Xb9JhgQnPGjU2CXg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDA2IiBoZWlnaHQ9Ijg3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><h3 id="write-the-apps-script-code"><span class="me-2">Write the Apps Script Code</span><a href="#write-the-apps-script-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><a href="https://script.google.com/home/my" target="_blank">Click here to go to my Apps Script project</a><li>Click “New Project” in the upper left.<li>After creating it, you can click the project name to rename it, e.g., ForwardEmailsToSlack.</ul><p>Paste the following basic code and modify it to your desired version:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nf">sendMessageToSlack</span><span class="p">(</span><span class="nx">content</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">payload</span> <span class="o">=</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">*You have received an email*</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">attachments</span><span class="dl">"</span><span class="p">:</span> <span class="p">[{</span>
          <span class="dl">"</span><span class="s2">pretext</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">The email content is as follows:</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="nx">content</span><span class="p">,</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">Paste your Slack incoming Webhook URL here</span><span class="dl">'</span><span class="p">,{</span>
      <span class="na">method</span>             <span class="p">:</span> <span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">contentType</span>        <span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">payload</span>            <span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">stringify</span><span class="p">(</span><span class="nx">payload</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nf">forwardEmailsToSlack</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Reference from: https://gist.github.com/andrewmwilson/5cab8367dc63d87d9aa5</span>

    <span class="kd">var</span> <span class="nx">label</span> <span class="o">=</span> <span class="nx">GmailApp</span><span class="p">.</span><span class="nf">getUserLabelByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">forward-to-slack</span><span class="dl">'</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">messages</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">threads</span> <span class="o">=</span> <span class="nx">label</span><span class="p">.</span><span class="nf">getThreads</span><span class="p">();</span>
  
    <span class="k">if </span><span class="p">(</span><span class="nx">threads</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">for </span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">threads</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">messages</span> <span class="o">=</span> <span class="nx">messages</span><span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="nx">threads</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nf">getMessages</span><span class="p">())</span>
    <span class="p">}</span>

    <span class="k">for </span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">messages</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">message</span> <span class="o">=</span> <span class="nx">messages</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="nx">Logger</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>

        <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">*New Email*</span><span class="dl">'</span><span class="p">;</span>
        <span class="nx">output</span> <span class="o">+=</span> <span class="dl">'</span><span class="se">\n</span><span class="s1">*from:* </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">message</span><span class="p">.</span><span class="nf">getFrom</span><span class="p">();</span>
        <span class="nx">output</span> <span class="o">+=</span> <span class="dl">'</span><span class="se">\n</span><span class="s1">*to:* </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">message</span><span class="p">.</span><span class="nf">getTo</span><span class="p">();</span>
        <span class="nx">output</span> <span class="o">+=</span> <span class="dl">'</span><span class="se">\n</span><span class="s1">*cc:* </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">message</span><span class="p">.</span><span class="nf">getCc</span><span class="p">();</span>
        <span class="nx">output</span> <span class="o">+=</span> <span class="dl">'</span><span class="se">\n</span><span class="s1">*date:* </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">message</span><span class="p">.</span><span class="nf">getDate</span><span class="p">();</span>
        <span class="nx">output</span> <span class="o">+=</span> <span class="dl">'</span><span class="se">\n</span><span class="s1">*subject:* </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">message</span><span class="p">.</span><span class="nf">getSubject</span><span class="p">();</span>
        <span class="nx">output</span> <span class="o">+=</span> <span class="dl">'</span><span class="se">\n</span><span class="s1">*body:* </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">message</span><span class="p">.</span><span class="nf">getPlainBody</span><span class="p">();</span>

        <span class="nf">sendMessageToSlack</span><span class="p">(</span><span class="nx">output</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="nx">label</span><span class="p">.</span><span class="nf">removeFromThreads</span><span class="p">(</span><span class="nx">threads</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>Advanced:</strong></p><ul><li><a href="https://api.slack.com/messaging/composing/layouts" target="_blank">You can refer to this official structure document for Slack message styles</a>.<li>You can use JavaScript’s Regex Match Function to match and scrape content from the email.</ul><p><strong>EX: Scraping the version number information from the TestFlight approval email:</strong></p><p>Email subject: Your app XXX has been approved for beta testing.</p><p>Email content:</p><p><a href="/assets/d414bdbdb8c9/1*aZkQGA3N1cquMLt1wyDGFg.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*aZkQGA3N1cquMLt1wyDGFg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjgxMyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>We want to obtain the <strong>Bundle Version Short String and the value after Build Number</strong>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>var results = subject.match(/(Bundle Version Short String: ){1}(\S+){1}[\S\s]*(Build Number: ){1}(\S+){1}/);
if (results == null || results.length != 5) {
  // not valid
} else {
  var version = results[2];
  var build = results[4];
}
</pre></table></code></div></div><ul><li><a href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Guide/Regular_Expressions" target="_blank">You can refer to this for Regex usage</a>.<li>You can use <a href="http://www.rubular.com/" target="_blank">this website</a> to test if your Regex is correct.</ul><h4 id="lets-run-it"><span class="me-2">Let’s Run It</span><a href="#lets-run-it" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>Go back to Gmail, find any email, and manually add the label — “forward-to-slack.”<li>In the Apps Script code editor, select “forwardEmailsToSlack” and then click the “Run” button.</ul><p><a href="/assets/d414bdbdb8c9/1*JHHTQCWNUI-aNPBB6y4iAA.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*JHHTQCWNUI-aNPBB6y4iAA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDk2IiBoZWlnaHQ9IjI3MCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/d414bdbdb8c9/1*ltXGtEVxkdde1qHGxy3wMw.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*ltXGtEVxkdde1qHGxy3wMw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NzgiIGhlaWdodD0iNDQ2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>If “Authorization Required” appears, click “Continue” to complete the verification.</p><p><a href="/assets/d414bdbdb8c9/1*hIgRtqKEFs0tsXDxfNTaOg.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*hIgRtqKEFs0tsXDxfNTaOg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NjgiIGhlaWdodD0iNjI0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>During the authentication process, you may see “Google hasn’t verified this app,” which is normal since our Apps Script has not been verified by Google. However, that’s fine since it’s for personal use.</p><p>You can click “Advanced” in the lower left -&gt; “Go to ForwardEmailsToSlack (unsafe).”</p><p><a href="/assets/d414bdbdb8c9/1*QUkmTD1WlEzw7cqW97ll6Q.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*QUkmTD1WlEzw7cqW97ll6Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MTIiIGhlaWdodD0iNjkyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Click “Allow.”</p><p><a href="/assets/d414bdbdb8c9/1*TInHsY7Fwb9jHuKJkMJIsw.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*TInHsY7Fwb9jHuKJkMJIsw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9Ijk3MiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Forwarding successful!!!</p><h3 id="set-up-a-trigger-schedule-for-automatic-checking--forwarding"><span class="me-2">Set Up a Trigger (Schedule) for Automatic Checking &amp; Forwarding</span><a href="#set-up-a-trigger-schedule-for-automatic-checking--forwarding" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/d414bdbdb8c9/1*2Ok6gD5E7F1uqyzgVpoJ8A.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*2Ok6gD5E7F1uqyzgVpoJ8A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDQ4IiBoZWlnaHQ9IjU3MiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>In the left menu of Apps Script, select “Triggers.”</p><p><a href="/assets/d414bdbdb8c9/1*1xb9xGGkgx6PkhWlWc7HiQ.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*1xb9xGGkgx6PkhWlWc7HiQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjYwNyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Click the lower left “+ Add Trigger.”</p><p><a href="/assets/d414bdbdb8c9/1*ujCxCH3f8HTvSOP5o4xvmA.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*ujCxCH3f8HTvSOP5o4xvmA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDg0IiBoZWlnaHQ9IjEyMDAiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><ul><li>Error notification settings: You can set how to notify you when the script encounters an error.<li>Choose the function you want to execute: Select the Main Function <code class="language-plaintext highlighter-rouge">sendMessageToSlack</code>.<li>Select event source: You can choose from calendar or time-driven (scheduled or specific).<li>Select time-based trigger type: You can choose to execute on a specific date or once every minute/hour/day/week/month.<li>Select interval for minutes/hours/days/weeks/months: EX: every minute, every 15 minutes…</ul><blockquote><p><em>Here, to demonstrate, I set it to execute once every minute. I think checking emails every hour would be sufficient for real-time needs.</em></p></blockquote><p><a href="/assets/d414bdbdb8c9/1*LBAlTvz46NJCYgVv1DrfYQ.webp" class="popup img-link blur"><img data-src="/assets/d414bdbdb8c9/1*LBAlTvz46NJCYgVv1DrfYQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjE5OSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ul><li>Again, go back to Gmail, find any email, and manually add the label — “forward-to-slack.”<li>Wait for the scheduled trigger.</ul><p>Automatic checking &amp; forwarding successful!</p><h3 id="completion"><span class="me-2">Completion</span><a href="#completion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>With this functionality, you can achieve customized email forwarding processing, and even use it as a trigger for actions, such as automatically executing a script when receiving a specific email.</p><p>Returning to the origin discussed in the first chapter, we can use this mechanism to enhance the CI/CD process; there’s no need to wait idly for Apple to complete processing, and we can integrate it into an automated workflow!</p><h3 id="further-reading"><span class="me-2">Further Reading</span><a href="#further-reading" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><a href="/posts/en/e77b80cc6f89/">Building a More Immediate and Convenient Crash Tracking Tool with Crashlytics + Big Query</a><li><a href="/posts/en/793cb8f89b72/">Automatically Querying App Crash-Free Users Rate with Crashlytics + Google Analytics</a><li><a href="/posts/en/70a1409b149a/">Using Python + Google Cloud Platform + Line Bot to Automate Routine Tasks</a><li><a href="/posts/en/d61062833c1a/">Creating a Fully Automated WFH Employee Health Reporting System with Slack</a><li><a href="/posts/en/46410aaada00/">The App Uses HTTPS for Transmission, but Data Still Gets Stolen.</a></ul><p>If you have any questions or suggestions, feel free to <a href="https://www.zhgchg.li/contact" target="_blank">contact me</a>.</p><hr /><p>This article was first published on Medium ➡️ <a href="https://medium.com/p/d414bdbdb8c9" target="_blank"><strong>Click Here</strong></a></p><p>Automatically converted and synchronized using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown</a> and <a href="https://github.com/ZhgChgLi/medium-to-jekyll-starter.github.io" target="_blank">Medium-to-jekyll-starter</a>.</p><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/en/zmediumtomarkdown/2021-08-07-d414bdbdb8c9.md" target="_blank">Improve this page on Github.</a></p><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=🍺&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a></p><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic> <script async="" src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); border-bottom: 1px solid var(--main-border-color);transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1K+ Followers</span></a></div><div style="font-size: 0.8em; cursor:default; text-align: right;"> 1,979 <span style="font-size: 0.9em;">Total Views</span><br /> <span style="font-size: 0.8em;">Last Statistics Date: 2025-08-14 | 1,923 Views on <a href="https://medium.com/p/d414bdbdb8c9" target="_blank">Medium.</a></span></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-dev/">ZRealm Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/google-apps-script/" class="post-tag no-text-decoration" >google-apps-script</a> <a href="/tags/cicd/" class="post-tag no-text-decoration" >cicd</a> <a href="/tags/slack/" class="post-tag no-text-decoration" >slack</a> <a href="/tags/workflow-automation/" class="post-tag no-text-decoration" >workflow-automation</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Using%20Google%20Apps%20Script%20to%20Forward%20Gmail%20Messages%20to%20Slack%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fen%2Fusing-google-apps-script-to-forward-gmail-messages-to-slack-d414bdbdb8c9%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Using%20Google%20Apps%20Script%20to%20Forward%20Gmail%20Messages%20to%20Slack%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fen%2Fusing-google-apps-script-to-forward-gmail-messages-to-slack-d414bdbdb8c9%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fen%2Fusing-google-apps-script-to-forward-gmail-messages-to-slack-d414bdbdb8c9%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/z-travel-diaries/en/travel-diary-8-days-and-7-nights-in-busan-south-korea-2025-8ace34a1a3d8/">Travel Diary: 8 Days and 7 Nights in Busan, South Korea 2025</a><li class="text-truncate lh-lg"> <a href="/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/%E9%81%8A%E8%A8%98-2025-%E9%9F%93%E5%9C%8B%E9%87%9C%E5%B1%B1-8-%E5%A4%A9-7-%E5%A4%9C%E8%87%AA%E7%94%B1%E8%A1%8C-8ace34a1a3d8/">遊記 2025 韓國釜山 8 天 7 夜自由行</a><li class="text-truncate lh-lg"> <a href="/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/%E9%81%8A%E8%A8%98-9-11-%E5%90%8D%E5%8F%A4%E5%B1%8B%E4%B8%80%E6%97%A5%E5%BF%AB%E9%96%83%E8%87%AA%E7%94%B1%E8%A1%8C-7b8a0563c157/">遊記 9/11 名古屋一日快閃自由行</a><li class="text-truncate lh-lg"> <a href="/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/%E9%81%8A%E8%A8%98-2023-%E4%B9%9D%E5%B7%9E-10-%E6%97%A5%E8%87%AA%E7%94%B1%E8%A1%8C%E7%8D%A8%E6%97%85-d78e0b15a08a/">遊記 2023 九州 10 日自由行獨旅</a><li class="text-truncate lh-lg"> <a href="/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/%E9%81%8A%E8%A8%98-2023-%E4%BA%AC%E9%98%AA%E7%A5%9E-8-%E6%97%A5%E8%87%AA%E7%94%B1%E8%A1%8C-76d66c2e34af/">遊記 2023 京阪神 8 日自由行</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a> <a class="post-tag btn btn-outline-primary" href="/tags/github/">github</a> <a class="post-tag btn btn-outline-primary" href="/tags/jekyll/">jekyll</a> <a class="post-tag btn btn-outline-primary" href="/tags/ruby/">ruby</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-dev/%E9%81%8B%E7%94%A8-google-apps-script-%E8%BD%89%E7%99%BC-gmail-%E4%BF%A1%E4%BB%B6%E5%88%B0-slack-d414bdbdb8c9/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1628338789" data-df="ll" > Aug 7, 2021 </time><h4 class="pt-0 my-2">運用 Google Apps Script 轉發 Gmail 信件到 Slack</h4><div class="text-muted"><p>使用 Gmail Filter + Google Apps Script 在收到信件時自動將客製化內容轉寄至 Slack Channel</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/ci-cd-%E5%AF%A6%E6%88%B0%E6%8C%87%E5%8D%97-%E5%9B%9B-%E4%BD%BF%E7%94%A8-google-apps-script-web-app-%E4%B8%B2%E6%8E%A5-github-actions-%E5%BB%BA%E7%BD%AE%E5%85%8D%E8%B2%BB%E6%98%93%E7%94%A8%E7%9A%84%E6%89%93%E5%8C%85%E5%B7%A5%E5%85%B7%E5%B9%B3%E5%8F%B0-4273e57e7148/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1752150651" data-df="ll" > Jul 10, 2025 </time><h4 class="pt-0 my-2">CI/CD 實戰指南（四）：使用 Google Apps Script Web App 串接 GitHub Actions 建置免費易用的打包工具平台</h4><div class="text-muted"><p>GAS Web App 串接 GitHub, Slack, Firebase 或 Asana/Jira API，建置中繼站，提供跨團隊共用的打包工具平台</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/en/ci-cd-practical-guide-part-4-building-a-free-and-user-friendly-packaging-tool-platform-with-google-apps-script-web-app-and-github-actions-4273e57e7148/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1752150651" data-df="ll" > Jul 10, 2025 </time><h4 class="pt-0 my-2">CI/CD Practical Guide (Part 4): Building a Free and User-Friendly Packaging Tool Platform with Google Apps Script Web App and GitHub Actions</h4><div class="text-muted"><p>Integrating GAS Web App with GitHub, Slack, Firebase, or Asana/Jira API to create a relay station that provides a packaging tool platform for cross-team sharing.</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-life/%E7%94%9F%E7%94%A2%E5%8A%9B%E5%B7%A5%E5%85%B7-%E6%8B%8B%E6%A3%84-chrome-%E6%8A%95%E5%85%A5-sidekick-%E7%80%8F%E8%A6%BD%E5%99%A8%E7%9A%84%E6%87%B7%E6%8A%B1-118e924a1477/" class="btn btn-outline-primary" aria-label="Older" ><p>生產力工具 拋棄 Chrome 投入 Sidekick 瀏覽器的懷抱</p></a> <a href="/posts/zrealm-dev/%E9%81%8B%E7%94%A8-google-apps-script-%E8%BD%89%E7%99%BC-gmail-%E4%BF%A1%E4%BB%B6%E5%88%B0-slack-d414bdbdb8c9/" class="btn btn-outline-primary" aria-label="Newer" ><p>運用 Google Apps Script 轉發 Gmail 信件到 Slack</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> All Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a><br/>Last updated: 2025-08-15 00:58:04 +08:00</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a> <a class="post-tag btn btn-outline-primary" href="/tags/github/">github</a> <a class="post-tag btn btn-outline-primary" href="/tags/jekyll/">jekyll</a> <a class="post-tag btn btn-outline-primary" href="/tags/ruby/">ruby</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
