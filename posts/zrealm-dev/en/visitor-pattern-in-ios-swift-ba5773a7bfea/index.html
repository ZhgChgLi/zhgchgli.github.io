<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Visitor Pattern in iOS (Swift)" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="An analysis of the practical application of the Visitor Design Pattern in iOS development" /><meta property="og:description" content="An analysis of the practical application of the Visitor Design Pattern in iOS development" /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-dev/en/visitor-pattern-in-ios-swift-ba5773a7bfea/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-dev/en/visitor-pattern-in-ios-swift-ba5773a7bfea/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/ba5773a7bfea/1*Q1BLU8QHVBLEMx6KlMSHWQ.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-06-15T23:58:36+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/ba5773a7bfea/1*Q1BLU8QHVBLEMx6KlMSHWQ.webp" /><meta property="twitter:title" content="Visitor Pattern in iOS (Swift)" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://medium.com/@zhgchgli/"},"dateModified":"2024-09-06T13:58:52+08:00","datePublished":"2021-06-15T23:58:36+08:00","description":"An analysis of the practical application of the Visitor Design Pattern in iOS development","headline":"Visitor Pattern in iOS (Swift)","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9Ijc4OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg==","url":"https://zhgchg.li/assets/ba5773a7bfea/1*Q1BLU8QHVBLEMx6KlMSHWQ.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-dev/en/visitor-pattern-in-ios-swift-ba5773a7bfea/"},"url":"https://zhgchg.li/posts/zrealm-dev/en/visitor-pattern-in-ios-swift-ba5773a7bfea/"}</script><title>Visitor Pattern in iOS (Swift) | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0"> <a href="https://medium.com/@zhgchgli" target="_blank" style="display: block;text-align: center;font-style: normal;/* text-decoration: underline; */font-size: 1.2em;color: var(--heading-color);">1K+ Followers on Medium</a> An iOS, web, and automation developer from Taiwan üáπüáº who also loves sharing, traveling, and writing.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Visitor Pattern in iOS (Swift)</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Visitor Pattern in iOS (Swift)</h1><p class="post-desc fw-light mb-4">An analysis of the practical application of the Visitor Design Pattern in iOS development</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1623772716" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 15, 2021 </time> </span> <span> Updated <time data-ts="1725602332" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Sep 6, 2024 </time> </span><div class="mt-3 mb-3"> <a href="/assets/ba5773a7bfea/1*Q1BLU8QHVBLEMx6KlMSHWQ.webp" class="popup img-link preview-img blur"><img data-src="/assets/ba5773a7bfea/1*Q1BLU8QHVBLEMx6KlMSHWQ.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9Ijc4OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://medium.com/@zhgchgli/">ZhgChgLi</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="2389 words" > <em>13 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Visitor Pattern in iOS (Swift)</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Visitor Pattern in iOS (Swift)</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic> <script async="" src="https://widgetic.com/sdk/sdk.js"></script><hr /><h3 id="‚ÑπÔ∏è‚ÑπÔ∏è‚ÑπÔ∏è-the-following-content-is-translated-by-openai"><span class="me-2">‚ÑπÔ∏è‚ÑπÔ∏è‚ÑπÔ∏è The following content is translated by OpenAI.</span><a href="#‚ÑπÔ∏è‚ÑπÔ∏è‚ÑπÔ∏è-the-following-content-is-translated-by-openai" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="click-here-to-view-the-original-chinese-version--ÈªûÊ≠§Êü•ÁúãÊú¨Êñá‰∏≠ÊñáÁâà"><span class="me-2"><a href="/posts/ba5773a7bfea/">Click here</a> to view the original Chinese version. | <a href="/posts/ba5773a7bfea/">ÈªûÊ≠§Êü•ÁúãÊú¨Êñá‰∏≠ÊñáÁâà</a></span><a href="#click-here-to-view-the-original-chinese-version--ÈªûÊ≠§Êü•ÁúãÊú¨Êñá‰∏≠ÊñáÁâà" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><hr /><h3 id="visitor-pattern-in-swift-sharing-objects-example"><span class="me-2">Visitor Pattern in Swift (Sharing Objects Example)</span><a href="#visitor-pattern-in-swift-sharing-objects-example" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>An analysis of the practical application of the Visitor Pattern (in sharing products, songs, articles, etc. to platforms like Facebook, Line, LinkedIn‚Ä¶)</p><p><a href="/assets/ba5773a7bfea/1*Q1BLU8QHVBLEMx6KlMSHWQ.webp" class="popup img-link blur"><img data-src="/assets/ba5773a7bfea/1*Q1BLU8QHVBLEMx6KlMSHWQ.webp" alt="Photo by [Daniel McCullough](https://unsplash.com/@d_mccullough?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9Ijc4OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Photo by <a href="https://unsplash.com/@d_mccullough?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank">Daniel McCullough</a></p><h4 id="introduction"><span class="me-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>It‚Äôs been over 10 years since I first learned about ‚ÄúDesign Patterns,‚Äù and I still can‚Äôt confidently say that I fully grasp them. I‚Äôve often skimmed through all the patterns multiple times, but without internalizing or applying them in practice, I quickly forget what I‚Äôve learned.</p><blockquote><p><em>I really feel useless.</em></p></blockquote><h4 id="skills-and-techniques"><span class="me-2">Skills and Techniques</span><a href="#skills-and-techniques" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>I once came across a great analogy: the techniques (like PHP, Laravel, iOS, Swift, SwiftUI, etc.) are relatively easy to switch between and learn. However, the foundational skills (like algorithms, data structures, design patterns, etc.) are much harder to master. These foundational skills and techniques complement each other; while techniques are easy to learn, foundational skills are difficult to develop. Just because someone is skilled in techniques doesn‚Äôt mean they have strong foundational skills, but those with strong foundational skills can quickly learn techniques. Therefore, rather than saying they complement each other, it‚Äôs more accurate to say that foundational skills are the basis, and techniques enhance their effectiveness.</p><h4 id="finding-a-suitable-learning-method"><span class="me-2">Finding a Suitable Learning Method</span><a href="#finding-a-suitable-learning-method" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Based on my previous learning experiences, I believe that the best way for me to learn Design Patterns is to focus on mastering a few patterns first. I need to internalize and apply them flexibly, developing an intuition for which scenarios are suitable for which patterns. Then, I can gradually accumulate new patterns until I master them all. I think the best approach is to seek out practical scenarios and learn from application.</p><h4 id="learning-resources"><span class="me-2">Learning Resources</span><a href="#learning-resources" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>I recommend two free learning resources:</p><ul><li><a href="https://refactoringguru.cn/" target="_blank">https://refactoringguru.cn/</a>: A comprehensive introduction to all pattern structures, scenarios, and relationships.<li><a href="https://shirazian.wordpress.com/2016/04/11/design-patterns-in-swift/" target="_blank">https://shirazian.wordpress.com/2016/04/11/design-patterns-in-swift/</a>: The author introduces various patterns through actual iOS development scenarios, and this article will also follow that direction.</ul><h3 id="visitor--behavioral-patterns"><span class="me-2">Visitor ‚Äî Behavioral Patterns</span><a href="#visitor--behavioral-patterns" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The first chapter documents the Visitor Pattern, which I discovered during my year at StreetVoice. The StreetVoice App has many instances where the Visitor Pattern effectively solves architectural problems. Through this experience, I grasped the essence of the Visitor Pattern, so I decided to write about it in this chapter!</p><h4 id="what-is-a-visitor"><span class="me-2">What is a Visitor?</span><a href="#what-is-a-visitor" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>First, let‚Äôs understand what a Visitor is. What problem does it aim to solve? What is its structural composition?</p><p><a href="/assets/ba5773a7bfea/1*rbswlsges8_oS3pNI1-WKA.webp" class="popup img-link blur"><img data-src="/assets/ba5773a7bfea/1*rbswlsges8_oS3pNI1-WKA.webp" alt="Image from [refactoringguru](https://refactoringguru.cn/design-patterns/visitor){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NjkiIGhlaWdodD0iNjM4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Image from <a href="https://refactoringguru.cn/design-patterns/visitor" target="_blank">refactoringguru</a></p><p>I won‚Äôt repeat the details here; please refer directly to <a href="https://refactoringguru.cn/design-patterns/visitor" target="_blank">refactoringguru‚Äôs explanation of the Visitor Pattern</a>.</p><h3 id="ios-practical-scenario--sharing-functionality"><span class="me-2">iOS Practical Scenario ‚Äî Sharing Functionality</span><a href="#ios-practical-scenario--sharing-functionality" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Let‚Äôs assume we have the following models: UserModel, SongModel, and PlaylistModel. We want to implement a sharing feature that allows sharing to Facebook, Line, and Instagram. Each model needs to present different sharing messages, and each platform requires different data:</p><p><a href="/assets/ba5773a7bfea/1*ad2ijo5Bvm9_wnM1g2LNog.webp" class="popup img-link blur"><img data-src="/assets/ba5773a7bfea/1*ad2ijo5Bvm9_wnM1g2LNog.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MzgiIGhlaWdodD0iMjk1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>The combination scenario is shown in the image above. The first table displays the customized content for each model, while the second table shows the data required by each sharing platform.</p><blockquote><p><strong><em>Especially for Instagram, sharing a Playlist requires multiple images, which is different from the data needed for other sharing types.</em></strong></p></blockquote><h4 id="defining-the-models"><span class="me-2">Defining the Models</span><a href="#defining-the-models" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>First, let‚Äôs define the properties for each model:</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="c1">// Model</span>
<span class="kd">struct</span> <span class="kt">UserModel</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">let</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">let</span> <span class="nv">profileImageURLString</span><span class="p">:</span> <span class="kt">String</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">SongModel</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">let</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">let</span> <span class="nv">user</span><span class="p">:</span> <span class="kt">UserModel</span>
    <span class="k">let</span> <span class="nv">coverImageURLString</span><span class="p">:</span> <span class="kt">String</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">PlaylistModel</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">let</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">let</span> <span class="nv">user</span><span class="p">:</span> <span class="kt">UserModel</span>
    <span class="k">let</span> <span class="nv">songs</span><span class="p">:</span> <span class="p">[</span><span class="kt">SongModel</span><span class="p">]</span>
    <span class="k">let</span> <span class="nv">coverImageURLString</span><span class="p">:</span> <span class="kt">String</span>
<span class="p">}</span>

<span class="c1">// Data</span>

<span class="k">let</span> <span class="nv">user</span> <span class="o">=</span> <span class="kt">UserModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"Avicii"</span><span class="p">,</span> <span class="nv">profileImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/profile/1.png"</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">song</span> <span class="o">=</span> <span class="kt">SongModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span>
                     <span class="nv">name</span><span class="p">:</span> <span class="s">"Wake Me Up"</span><span class="p">,</span>
                     <span class="nv">user</span><span class="p">:</span> <span class="n">user</span><span class="p">,</span>
                     <span class="nv">coverImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/cover/1.png"</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">playlist</span> <span class="o">=</span> <span class="kt">PlaylistModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span>
                            <span class="nv">name</span><span class="p">:</span> <span class="s">"Avicii Tribute Concert"</span><span class="p">,</span>
                            <span class="nv">user</span><span class="p">:</span> <span class="n">user</span><span class="p">,</span>
                            <span class="nv">songs</span><span class="p">:</span> <span class="p">[</span>
                                <span class="n">song</span><span class="p">,</span>
                                <span class="kt">SongModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"2"</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"Waiting for Love"</span><span class="p">,</span> <span class="nv">user</span><span class="p">:</span> <span class="kt">UserModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"Avicii"</span><span class="p">,</span> <span class="nv">profileImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/profile/1.png"</span><span class="p">),</span> <span class="nv">coverImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/cover/3.png"</span><span class="p">),</span>
                                <span class="kt">SongModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"3"</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"Lonely Together"</span><span class="p">,</span> <span class="nv">user</span><span class="p">:</span> <span class="kt">UserModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"Avicii"</span><span class="p">,</span> <span class="nv">profileImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/profile/1.png"</span><span class="p">),</span> <span class="nv">coverImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/cover/1.png"</span><span class="p">),</span>
                                <span class="kt">SongModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"4"</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"Heaven"</span><span class="p">,</span> <span class="nv">user</span><span class="p">:</span> <span class="kt">UserModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"Avicii"</span><span class="p">,</span> <span class="nv">profileImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/profile/1.png"</span><span class="p">),</span> <span class="nv">coverImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/cover/4.png"</span><span class="p">),</span>
                                <span class="kt">SongModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"5"</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"S.O.S"</span><span class="p">,</span> <span class="nv">user</span><span class="p">:</span> <span class="kt">UserModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"Avicii"</span><span class="p">,</span> <span class="nv">profileImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/profile/1.png"</span><span class="p">),</span> <span class="nv">coverImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/cover/5.png"</span><span class="p">)],</span>
                            <span class="nv">coverImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/playlist/1.png"</span><span class="p">)</span>
</pre></table></code></div></div><h4 id="a-poorly-designed-approach"><span class="me-2">A Poorly Designed Approach</span><a href="#a-poorly-designed-approach" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Let‚Äôs start with a very messy implementation that doesn‚Äôt consider architecture at all.</p><p><a href="/assets/ba5773a7bfea/1*5kBPDRNpaHNyW4u4YEsOGA.webp" class="popup img-link blur"><img data-src="/assets/ba5773a7bfea/1*5kBPDRNpaHNyW4u4YEsOGA.webp" alt="Stephen Chow ‚Äî The God of Cookery" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMzgxIiBoZWlnaHQ9Ijg3NCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Stephen Chow ‚Äî The God of Cookery</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="kt">ShareManager</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span>
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">urlString</span><span class="p">:</span> <span class="kt">String</span>
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">imageURLStrings</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">user</span><span class="p">:</span> <span class="kt">UserModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s">"Hi, I want to share a great artist with you: </span><span class="se">\(</span><span class="n">user</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">."</span>
        <span class="k">self</span><span class="o">.</span><span class="n">urlString</span> <span class="o">=</span> <span class="s">"https://zhgchg.li/user/</span><span class="se">\(</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">"</span>
        <span class="k">self</span><span class="o">.</span><span class="n">imageURLStrings</span> <span class="o">=</span> <span class="p">[</span><span class="n">user</span><span class="o">.</span><span class="n">profileImageURLString</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">song</span><span class="p">:</span> <span class="kt">SongModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s">"Hi, I want to share a great song I just heard: </span><span class="se">\(</span><span class="n">song</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">'s </span><span class="se">\(</span><span class="n">song</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">."</span>
        <span class="k">self</span><span class="o">.</span><span class="n">urlString</span> <span class="o">=</span> <span class="s">"https://zhgchg.li/user/</span><span class="se">\(</span><span class="n">song</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">/song/</span><span class="se">\(</span><span class="n">song</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">"</span>
        <span class="k">self</span><span class="o">.</span><span class="n">imageURLStrings</span> <span class="o">=</span> <span class="p">[</span><span class="n">song</span><span class="o">.</span><span class="n">coverImageURLString</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">playlist</span><span class="p">:</span> <span class="kt">PlaylistModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s">"Hi, I can't stop listening to this playlist: </span><span class="se">\(</span><span class="n">playlist</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">."</span>
        <span class="k">self</span><span class="o">.</span><span class="n">urlString</span> <span class="o">=</span> <span class="s">"https://zhgchg.li/user/</span><span class="se">\(</span><span class="n">playlist</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">/playlist/</span><span class="se">\(</span><span class="n">playlist</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">"</span>
        <span class="k">self</span><span class="o">.</span><span class="n">imageURLStrings</span> <span class="o">=</span> <span class="n">playlist</span><span class="o">.</span><span class="n">songs</span><span class="o">.</span><span class="nf">map</span><span class="p">({</span> <span class="nv">$0</span><span class="o">.</span><span class="n">coverImageURLString</span> <span class="p">})</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">shareToFacebook</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// call Facebook share SDK...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Sharing to Facebook..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"[![</span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">title</span><span class="se">)</span><span class="s">](</span><span class="se">\(</span><span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">imageURLStrings</span><span class="o">.</span><span class="n">first</span><span class="p">)</span><span class="se">)</span><span class="s">](</span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">urlString</span><span class="se">)</span><span class="s">)"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">shareToInstagram</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// call Instagram share SDK...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Sharing to Instagram..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">self</span><span class="o">.</span><span class="n">imageURLStrings</span><span class="o">.</span><span class="nf">joined</span><span class="p">(</span><span class="nv">separator</span><span class="p">:</span> <span class="s">","</span><span class="p">))</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">shareToLine</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// call Line share SDK...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Sharing to Line..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"[</span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">title</span><span class="se">)</span><span class="s">](</span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">urlString</span><span class="se">)</span><span class="s">)"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>There‚Äôs not much to say; this is a completely unstructured approach where everything is mixed together. If we want to add a new sharing platform, change the sharing information for a platform, or add a new shareable model, we have to modify the ShareManager. Additionally, the design of <code class="language-plaintext highlighter-rouge">imageURLStrings</code> was influenced by the need for multiple images when sharing a playlist on Instagram, which leads to a design that is reactive rather than proactive, polluting other types that don‚Äôt require multiple images.</p><h4 id="a-slight-optimization"><span class="me-2">A Slight Optimization</span><a href="#a-slight-optimization" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Let‚Äôs separate the logic a bit.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
</pre><td class="rouge-code"><pre><span class="kd">protocol</span> <span class="kt">Shareable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">getShareText</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">String</span>
    <span class="kd">func</span> <span class="nf">getShareURLString</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">String</span>
    <span class="kd">func</span> <span class="nf">getShareImageURLStrings</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">UserModel</span><span class="p">:</span> <span class="kt">Shareable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">getShareText</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">String</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">"Hi, I want to share a great artist with you: </span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">."</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">getShareURLString</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">String</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">"https://zhgchg.li/user/</span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">"</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">getShareImageURLStrings</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">[</span><span class="k">self</span><span class="o">.</span><span class="n">profileImageURLString</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">SongModel</span><span class="p">:</span> <span class="kt">Shareable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">getShareText</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">String</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">"Hi, I want to share a great song I just heard: </span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">'s </span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">."</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">getShareURLString</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">String</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">"https://zhgchg.li/user/</span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">/song/</span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">"</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">getShareImageURLStrings</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">[</span><span class="k">self</span><span class="o">.</span><span class="n">coverImageURLString</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">PlaylistModel</span><span class="p">:</span> <span class="kt">Shareable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">getShareText</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">String</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">"Hi, I can't stop listening to this playlist: </span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">."</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">getShareURLString</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">String</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">"https://zhgchg.li/user/</span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">/playlist/</span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">"</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">getShareImageURLStrings</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">[</span><span class="k">self</span><span class="o">.</span><span class="n">coverImageURLString</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">protocol</span> <span class="kt">ShareManagerProtocol</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">model</span><span class="p">:</span> <span class="kt">Shareable</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
    <span class="nf">init</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">Shareable</span><span class="p">)</span>
    <span class="kd">func</span> <span class="nf">share</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">FacebookShare</span><span class="p">:</span> <span class="kt">ShareManagerProtocol</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">model</span><span class="p">:</span> <span class="kt">Shareable</span>

    <span class="kd">required</span> <span class="nf">init</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">Shareable</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">share</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// call Facebook share SDK...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Sharing to Facebook..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"[![</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="nf">getShareText</span><span class="p">()</span><span class="se">)</span><span class="s">](</span><span class="se">\(</span><span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="nf">getShareImageURLStrings</span><span class="p">()</span><span class="o">.</span><span class="n">first</span><span class="p">)</span><span class="se">)</span><span class="s">](</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="nf">getShareURLString</span><span class="p">()</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">InstagramShare</span><span class="p">:</span> <span class="kt">ShareManagerProtocol</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">model</span><span class="p">:</span> <span class="kt">Shareable</span>

    <span class="kd">required</span> <span class="nf">init</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">Shareable</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">share</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// call Instagram share SDK...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Sharing to Instagram..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="nf">getShareImageURLStrings</span><span class="p">()</span><span class="o">.</span><span class="nf">joined</span><span class="p">(</span><span class="nv">separator</span><span class="p">:</span> <span class="s">","</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">LineShare</span><span class="p">:</span> <span class="kt">ShareManagerProtocol</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">model</span><span class="p">:</span> <span class="kt">Shareable</span>

    <span class="kd">required</span> <span class="nf">init</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">Shareable</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">share</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// call Line share SDK...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Sharing to Line..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"[</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="nf">getShareText</span><span class="p">()</span><span class="se">)</span><span class="s">](</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="nf">getShareURLString</span><span class="p">()</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>We extracted a <code class="language-plaintext highlighter-rouge">Shareable</code> protocol, allowing any model that conforms to this protocol to support sharing. The sharing logic is also separated into a <code class="language-plaintext highlighter-rouge">ShareManagerProtocol</code>, so adding new sharing options or modifying existing ones won‚Äôt affect other share managers.</p><p>However, the <code class="language-plaintext highlighter-rouge">getShareImageURLStrings</code> method still feels odd. Additionally, if a new sharing platform requires entirely different model data (like WeChat needing play counts or creation dates), it could lead to confusion.</p><h4 id="using-the-visitor-pattern"><span class="me-2">Using the Visitor Pattern</span><a href="#using-the-visitor-pattern" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Here‚Äôs how we can solve this using the Visitor Pattern.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
</pre><td class="rouge-code"><pre><span class="c1">// Visitor Version</span>
<span class="kd">protocol</span> <span class="kt">Shareable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">accept</span><span class="p">(</span><span class="nv">visitor</span><span class="p">:</span> <span class="kt">SharePolicy</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">UserModel</span><span class="p">:</span> <span class="kt">Shareable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">accept</span><span class="p">(</span><span class="nv">visitor</span><span class="p">:</span> <span class="kt">SharePolicy</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">visitor</span><span class="o">.</span><span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">SongModel</span><span class="p">:</span> <span class="kt">Shareable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">accept</span><span class="p">(</span><span class="nv">visitor</span><span class="p">:</span> <span class="kt">SharePolicy</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">visitor</span><span class="o">.</span><span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">PlaylistModel</span><span class="p">:</span> <span class="kt">Shareable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">accept</span><span class="p">(</span><span class="nv">visitor</span><span class="p">:</span> <span class="kt">SharePolicy</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">visitor</span><span class="o">.</span><span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">protocol</span> <span class="kt">SharePolicy</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">UserModel</span><span class="p">)</span>
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">SongModel</span><span class="p">)</span>
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">PlaylistModel</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">ShareToFacebookVisitor</span><span class="p">:</span> <span class="kt">SharePolicy</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">UserModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// call Facebook share SDK...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Sharing to Facebook..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"[![Hi, I want to share a great artist with you: </span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">.](</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">profileImageURLString</span><span class="se">)</span><span class="s">](https://zhgchg.li/user/</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">SongModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// call Facebook share SDK...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Sharing to Facebook..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"[![Hi, I want to share a great song I just heard: </span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">'s </span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">.](</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">coverImageURLString</span><span class="se">)</span><span class="s">)](https://zhgchg.li/user/</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">/song/</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">PlaylistModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// call Facebook share SDK...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Sharing to Facebook..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"[![Hi, I can't stop listening to this playlist: </span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">.](</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">coverImageURLString</span><span class="se">)</span><span class="s">)](https://zhgchg.li/user/</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">/playlist/</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">ShareToLineVisitor</span><span class="p">:</span> <span class="kt">SharePolicy</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">UserModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// call Line share SDK...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Sharing to Line..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"[Hi, I want to share a great artist with you: </span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">.](https://zhgchg.li/user/</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">SongModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// call Line share SDK...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Sharing to Line..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"[Hi, I want to share a great song I just heard: </span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">'s </span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">.](https://zhgchg.li/user/</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">/song/</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">PlaylistModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// call Line share SDK...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Sharing to Line..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"[Hi, I can't stop listening to this playlist: </span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">.](https://zhgchg.li/user/</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">/playlist/</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">ShareToInstagramVisitor</span><span class="p">:</span> <span class="kt">SharePolicy</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">UserModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// call Instagram share SDK...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Sharing to Instagram..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">profileImageURLString</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">SongModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// call Instagram share SDK...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Sharing to Instagram..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">coverImageURLString</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">PlaylistModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// call Instagram share SDK...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Sharing to Instagram..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">songs</span><span class="o">.</span><span class="nf">map</span><span class="p">({</span> <span class="nv">$0</span><span class="o">.</span><span class="n">coverImageURLString</span> <span class="p">})</span><span class="o">.</span><span class="nf">joined</span><span class="p">(</span><span class="nv">separator</span><span class="p">:</span> <span class="s">","</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Use case</span>
<span class="k">let</span> <span class="nv">shareToInstagramVisitor</span> <span class="o">=</span> <span class="kt">ShareToInstagramVisitor</span><span class="p">()</span>
<span class="n">user</span><span class="o">.</span><span class="nf">accept</span><span class="p">(</span><span class="nv">visitor</span><span class="p">:</span> <span class="n">shareToInstagramVisitor</span><span class="p">)</span>
<span class="n">playlist</span><span class="o">.</span><span class="nf">accept</span><span class="p">(</span><span class="nv">visitor</span><span class="p">:</span> <span class="n">shareToInstagramVisitor</span><span class="p">)</span>
</pre></table></code></div></div><p>Let‚Äôs break down what we‚Äôve done:</p><ul><li>We created a <code class="language-plaintext highlighter-rouge">Shareable</code> protocol to manage models that support sharing, providing a unified interface (though it could be left undefined).<li>The <code class="language-plaintext highlighter-rouge">UserModel</code>, <code class="language-plaintext highlighter-rouge">SongModel</code>, and <code class="language-plaintext highlighter-rouge">PlaylistModel</code> implement the <code class="language-plaintext highlighter-rouge">accept(visitor: SharePolicy)</code> method, so if we add a new model that supports sharing, we only need to implement this protocol.<li>We defined the <code class="language-plaintext highlighter-rouge">SharePolicy</code> protocol, listing the supported models. (It must be a concrete type; you might wonder why we don‚Äôt define it as <code class="language-plaintext highlighter-rouge">visit(model: Shareable)</code>. If we did, we‚Äôd fall back into the previous issues.)<li>Each sharing method implements the <code class="language-plaintext highlighter-rouge">SharePolicy</code>, combining the necessary resources based on the source.<li>If we were to add a WeChat sharing option that requires different data (like play counts or creation dates), it wouldn‚Äôt affect the existing code because it can retrieve the information it needs from the concrete model.</ul><p>This achieves the goal of low coupling and high cohesion in software development.</p><p>The above is a classic implementation of the <a href="https://refactoringguru.cn/design-patterns/visitor-double-dispatch" target="_blank">Visitor Double Dispatch</a> pattern. However, in everyday development, we might encounter this situation less frequently; typically, there may only be one Visitor. I believe this pattern is also suitable for combining scenarios. For example, if we have a requirement to save to Core Data, we can directly define <code class="language-plaintext highlighter-rouge">accept(visitor: SaveToCoreDataVisitor)</code> without needing to declare a separate Policy Protocol, which is also a good architectural approach.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">protocol</span> <span class="kt">Saveable</span> <span class="p">{</span>
  <span class="kd">func</span> <span class="nf">accept</span><span class="p">(</span><span class="nv">visitor</span><span class="p">:</span> <span class="kt">SaveToCoreDataVisitor</span><span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="kt">SaveToCoreDataVisitor</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">UserModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Map UserModel to Core Data</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">SongModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Map SongModel to Core Data</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">PlaylistModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Map PlaylistModel to Core Data</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Other applications: Save, Like, table view/collection view cell for row, etc.</p><h3 id="principles"><span class="me-2">Principles</span><a href="#principles" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Let‚Äôs discuss some common principles:</p><ul><li>Code is meant to be read by people; avoid over-designing.<li>Consistency is crucial; the same codebase should use the same architectural methods in similar scenarios.<li>If the scope is manageable or unlikely to encounter other situations, continuing to break things down further can be considered over-designing.<li>Focus on applying existing solutions rather than inventing new ones; design patterns have been established in software design for decades and are likely to cover more scenarios than a new architecture we create.<li>If you don‚Äôt understand a design pattern, it‚Äôs worth learning. However, if you create your own architecture, it may be harder to convince others to adopt it, as it might only apply to a specific case and not be common knowledge.<li>Code duplication isn‚Äôt inherently bad; overly pursuing encapsulation can lead to over-design. Remember, code should be readable, and good code is characterized by low coupling and high cohesion.<li>Avoid modifying patterns arbitrarily; there are reasons behind their design, and random changes can lead to issues in certain scenarios.<li>Once you start deviating from a clear path, it becomes increasingly difficult to return, and the code can become messier.</ul><blockquote><p><em>inspired by <a href="https://twitter.com/saiday" target="_blank">Ôº†saiday</a></em></p></blockquote><h4 id="references"><span class="me-2">References</span><a href="#references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://shirazian.wordpress.com/2016/04/22/design-patterns-in-swift-visitor/" target="_blank">Design Patterns in Swift: Visitor</a> (Another application of the Visitor pattern)<li><a href="https://github.com/kingreza/Swift-Visitor" target="_blank">https://github.com/kingreza/Swift-Visitor</a><li><a href="https://medium.com/@albertodebo/deep-linking-at-scale-on-ios-1dd8789c389f" target="_blank">Deep Linking at Scale on iOS</a> (State Pattern)</ul><h3 id="further-reading"><span class="me-2">Further Reading</span><a href="#further-reading" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Practical applications of Design Patterns ‚Äî In WKWebView with Builder, Strategy &amp; Chain of Responsibility Pattern<li><a href="/posts/en/78507a8de6a5/">Practical applications of Design Patterns</a><li><a href="/posts/en/60473cb47550/">Visitor Pattern in TableView</a></ul><p>If you have any questions or feedback, feel free to <a href="https://www.zhgchg.li/contact" target="_blank">contact me</a>.</p><hr /><p>This article was first published on Medium ‚û°Ô∏è <a href="https://medium.com/p/ba5773a7bfea" target="_blank"><strong>Click Here</strong></a></p><p>Automatically converted and synchronized using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown</a> and <a href="https://github.com/ZhgChgLi/medium-to-jekyll-starter.github.io" target="_blank">Medium-to-jekyll-starter</a>.</p><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/en/zmediumtomarkdown/2021-06-15-ba5773a7bfea.md" target="_blank">Improve this page on Github.</a></p><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=üç∫&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a></p><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic> <script async="" src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); border-bottom: 1px solid var(--main-border-color);transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1K+ Followers</span></a></div><div style="font-size: 0.8em; cursor:default; text-align: right;"> 1,112 <span style="font-size: 0.9em;">Total Views</span><br /> <span style="font-size: 0.8em;">Last Statistics Date: 2025-08-14 | 1,077 Views on <a href="https://medium.com/p/ba5773a7bfea" target="_blank">Medium.</a></span></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-dev/">ZRealm Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/swift/" class="post-tag no-text-decoration" >swift</a> <a href="/tags/design-patterns/" class="post-tag no-text-decoration" >design-patterns</a> <a href="/tags/visitor-pattern/" class="post-tag no-text-decoration" >visitor-pattern</a> <a href="/tags/double-dispatch/" class="post-tag no-text-decoration" >double-dispatch</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Visitor%20Pattern%20in%20iOS%20(Swift)%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fen%2Fvisitor-pattern-in-ios-swift-ba5773a7bfea%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Visitor%20Pattern%20in%20iOS%20(Swift)%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fen%2Fvisitor-pattern-in-ios-swift-ba5773a7bfea%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fen%2Fvisitor-pattern-in-ios-swift-ba5773a7bfea%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/z-travel-diaries/en/travel-diary-8-days-and-7-nights-in-busan-south-korea-2025-8ace34a1a3d8/">Travel Diary: 8 Days and 7 Nights in Busan, South Korea 2025</a><li class="text-truncate lh-lg"> <a href="/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/%E9%81%8A%E8%A8%98-2025-%E9%9F%93%E5%9C%8B%E9%87%9C%E5%B1%B1-8-%E5%A4%A9-7-%E5%A4%9C%E8%87%AA%E7%94%B1%E8%A1%8C-8ace34a1a3d8/">ÈÅäË®ò 2025 ÈüìÂúãÈáúÂ±± 8 Â§© 7 Â§úËá™Áî±Ë°å</a><li class="text-truncate lh-lg"> <a href="/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/%E9%81%8A%E8%A8%98-9-11-%E5%90%8D%E5%8F%A4%E5%B1%8B%E4%B8%80%E6%97%A5%E5%BF%AB%E9%96%83%E8%87%AA%E7%94%B1%E8%A1%8C-7b8a0563c157/">ÈÅäË®ò 9/11 ÂêçÂè§Â±ã‰∏ÄÊó•Âø´ÈñÉËá™Áî±Ë°å</a><li class="text-truncate lh-lg"> <a href="/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/%E9%81%8A%E8%A8%98-2023-%E4%B9%9D%E5%B7%9E-10-%E6%97%A5%E8%87%AA%E7%94%B1%E8%A1%8C%E7%8D%A8%E6%97%85-d78e0b15a08a/">ÈÅäË®ò 2023 ‰πùÂ∑û 10 Êó•Ëá™Áî±Ë°åÁç®ÊóÖ</a><li class="text-truncate lh-lg"> <a href="/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/%E9%81%8A%E8%A8%98-2023-%E4%BA%AC%E9%98%AA%E7%A5%9E-8-%E6%97%A5%E8%87%AA%E7%94%B1%E8%A1%8C-76d66c2e34af/">ÈÅäË®ò 2023 ‰∫¨Èò™Á•û 8 Êó•Ëá™Áî±Ë°å</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">ÁîüÊ¥ª</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a> <a class="post-tag btn btn-outline-primary" href="/tags/github/">github</a> <a class="post-tag btn btn-outline-primary" href="/tags/jekyll/">jekyll</a> <a class="post-tag btn btn-outline-primary" href="/tags/ruby/">ruby</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-dev/visitor-pattern-in-ios-swift-ba5773a7bfea/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1623772716" data-df="ll" > Jun 15, 2021 </time><h4 class="pt-0 my-2">Visitor Pattern in iOS (Swift)</h4><div class="text-muted"><p>Design Pattern Visitor Âú® iOS ÈñãÁôºÁöÑÂØ¶ÈöõÊáâÁî®Â†¥ÊôØÂàÜÊûê</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/visitor-pattern-in-tableview-60473cb47550/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1657267110" data-df="ll" > Jul 8, 2022 </time><h4 class="pt-0 my-2">Visitor Pattern in TableView</h4><div class="text-muted"><p>‰ΩøÁî® Visitor Pattern Â¢ûÂä† TableView ÁöÑÈñ±ËÆÄÂíåÊì¥ÂÖÖÊÄß</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/en/visitor-pattern-in-tableview-60473cb47550/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1657267110" data-df="ll" > Jul 8, 2022 </time><h4 class="pt-0 my-2">Visitor Pattern in TableView</h4><div class="text-muted"><p>Using the Visitor Pattern to enhance the readability and extensibility of TableView</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-dev/slack-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8B%95-wfh-%E5%93%A1%E5%B7%A5%E5%81%A5%E5%BA%B7%E7%8B%80%E6%B3%81%E5%9B%9E%E5%A0%B1%E7%B3%BB%E7%B5%B1-d61062833c1a/" class="btn btn-outline-primary" aria-label="Older" ><p>Slack ÊâìÈÄ†ÂÖ®Ëá™Âãï WFH Âì°Â∑•ÂÅ•Â∫∑ÁãÄÊ≥ÅÂõûÂ†±Á≥ªÁµ±</p></a> <a href="/posts/zrealm-dev/visitor-pattern-in-ios-swift-ba5773a7bfea/" class="btn btn-outline-primary" aria-label="Newer" ><p>Visitor Pattern in iOS (Swift)</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>¬© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> All Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a><br/>Last updated: 2025-08-15 15:30:35 +08:00</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">ÁîüÊ¥ª</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a> <a class="post-tag btn btn-outline-primary" href="/tags/github/">github</a> <a class="post-tag btn btn-outline-primary" href="/tags/jekyll/">jekyll</a> <a class="post-tag btn btn-outline-primary" href="/tags/ruby/">ruby</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
