<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="iOS Localization: Protect Your Localizable.strings from Accidental Corruption" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="iOS developers struggling with maintaining Localizable.strings files can prevent accidental data loss using proven backup strategies and automation, ensuring stable multi-language support and smoother app updates." /><meta property="og:description" content="iOS developers struggling with maintaining Localizable.strings files can prevent accidental data loss using proven backup strategies and automation, ensuring stable multi-language support and smoother app updates." /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-dev/en/ios-localization-protect-your-localizable-strings-from-accidental-corruption-48a8526c1300/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-dev/en/ios-localization-protect-your-localizable-strings-from-accidental-corruption-48a8526c1300/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/48a8526c1300/1*G2UsVr02o122GxI2o1WbQQ.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-15T18:10:04+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/48a8526c1300/1*G2UsVr02o122GxI2o1WbQQ.webp" /><meta property="twitter:title" content="iOS Localization: Protect Your Localizable.strings from Accidental Corruption" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://www.linkedin.com/in/zhgchgli"},"dateModified":"2024-04-14T10:14:31+08:00","datePublished":"2022-07-15T18:10:04+08:00","description":"iOS developers struggling with maintaining Localizable.strings files can prevent accidental data loss using proven backup strategies and automation, ensuring stable multi-language support and smoother app updates.","headline":"iOS Localization: Protect Your Localizable.strings from Accidental Corruption","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+","url":"https://zhgchg.li/assets/48a8526c1300/1*G2UsVr02o122GxI2o1WbQQ.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-dev/en/ios-localization-protect-your-localizable-strings-from-accidental-corruption-48a8526c1300/"},"url":"https://zhgchg.li/posts/zrealm-dev/en/ios-localization-protect-your-localizable-strings-from-accidental-corruption-48a8526c1300/"}</script><title>iOS Localization: Protect Your Localizable.strings from Accidental Corruption | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=false" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script><link rel="alternate" hreflang="zh-Hans" href="/posts/zrealm-dev/zh-cn/ios-%E5%A4%9A%E8%AF%AD%E7%B3%BB%E5%AD%97%E4%B8%B2%E4%BF%9D%E9%99%A9-swiftgen-unittest-%E7%A1%AE%E4%BF%9D-localizable-strings-%E6%97%A0%E8%AF%AF-48a8526c1300/"><link rel="alternate" hreflang="zh-Hant" href="/posts/zrealm-dev/ios-%E5%A4%9A%E8%AA%9E%E7%B3%BB%E5%AD%97%E4%B8%B2%E4%BF%9D%E9%9A%AA-swiftgen-unittest-%E7%A2%BA%E4%BF%9D-localizable-strings-%E7%84%A1%E8%AA%A4-48a8526c1300/"><link rel="alternate" hreflang="en" href="/posts/zrealm-dev/en/ios-localization-protect-your-localizable-strings-from-accidental-corruption-48a8526c1300/"><link rel="alternate" hreflang="x-default" href="/posts/zrealm-dev/en/ios-localization-protect-your-localizable-strings-from-accidental-corruption-48a8526c1300/"><link rel="stylesheet" href="/assets/css/post-toc.css"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0">An iOS, web, and automation developer from Taiwan üáπüáº who also loves sharing, traveling, and writing.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="https://medium.com/@zhgchgli" class="nav-link" target="_blank" style="background: #EDF4FF; color: #0A84FF;"> <i class="fa-brands fa-medium"></i> <span>Follow Me!<br/><strong>1,049+</strong> Followers</span> </a><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/english/" class="nav-link"> <i class="fa-fw fa fa-solid fa-language"></i> <span>ENGLISH POSTS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>iOS Localization: Protect Your Localizable.strings from Accidental Corruption</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>iOS Localization: Protect Your Localizable.strings from Accidental Corruption</h1><p class="post-desc fw-light mb-4">iOS developers struggling with maintaining Localizable.strings files can prevent accidental data loss using proven backup strategies and automation, ensuring stable multi-language support and smoother app updates.</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1657879804" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jul 15, 2022 </time> </span> <span> Updated <time data-ts="1713060871" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 14, 2024 </time> </span><div class="mt-3 mb-3"> <a href="/assets/48a8526c1300/1*G2UsVr02o122GxI2o1WbQQ.webp" class="popup img-link preview-img blur"><img data-src="/assets/48a8526c1300/1*G2UsVr02o122GxI2o1WbQQ.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></div><div class="d-flex justify-content-between"> <span style="display: inline-flex; align-items: center; gap: 4px;"> By <em> <a href="https://www.linkedin.com/in/zhgchgli">ZhgChgLi</a> </em> | <em><a href="https://www.linkedin.com/in/zhgchgli" target="_blank">Senior Software Engineer</a></em><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" style="display: block; "><path fill="#007bff" d="M271.2 56C265.1 49.8 256.2 47.3 247.8 49.6C239.4 51.9 232.9 58.4 230.8 66.8L215.5 127C214.4 131.4 209.9 134 205.6 132.7L145.8 115.9C137.4 113.5 128.4 115.9 122.3 122C116.2 128.1 113.8 137.1 116.2 145.5L133.1 205.3C134.3 209.6 131.7 214.1 127.4 215.2L67.1 230.5C58.7 232.6 52.1 239.2 49.8 247.6C47.5 256 50 264.9 56.2 271L100.7 314.3C103.9 317.4 103.9 322.6 100.7 325.8L56.3 369.1C50.1 375.2 47.6 384.1 49.9 392.5C52.2 400.9 58.8 407.4 67.2 409.6L127.4 424.9C131.8 426 134.4 430.5 133.1 434.8L116.2 494.5C113.8 502.9 116.2 511.9 122.3 518C128.4 524.1 137.4 526.5 145.8 524.1L205.6 507.2C209.9 506 214.4 508.6 215.5 512.9L230.8 573.1C232.9 581.5 239.5 588.1 247.9 590.4C256.3 592.7 265.2 590.2 271.3 584L314.6 539.5C317.7 536.3 322.9 536.3 326.1 539.5L369.3 584C375.4 590.2 384.3 592.7 392.7 590.4C401.1 588.1 407.6 581.5 409.8 573.1L425.1 513C426.2 508.6 430.7 506 435 507.3L494.8 524.2C503.2 526.6 512.2 524.2 518.3 518.1C524.4 512 526.8 503 524.4 494.6L507.5 434.8C506.3 430.5 508.9 426 513.2 424.9L573.4 409.6C581.8 407.5 588.4 400.9 590.7 392.5C593 384.1 590.5 375.1 584.3 369.1L539.8 325.8C536.6 322.7 536.6 317.5 539.8 314.3L584.3 271C590.5 264.9 593 256 590.7 247.6C588.4 239.2 581.8 232.7 573.4 230.5L513.2 215.2C508.8 214.1 506.2 209.6 507.5 205.3L524.4 145.5C526.8 137.1 524.4 128.1 518.3 122C512.2 115.9 503.2 113.5 494.8 115.9L435 132.8C430.7 134 426.2 131.4 425.1 127.1L409.8 66.8C407.7 58.4 401.1 51.8 392.7 49.5C384.3 47.2 375.4 49.7 369.3 55.9L326 100.5C322.9 103.7 317.7 103.7 314.5 100.5L271.2 56z"/><path d="M250 330 l60 60 100 -140" stroke="#ffffff" stroke-width="40" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="2825 words" > <em>15 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">iOS Localization: Protect Your Localizable.strings from Accidental Corruption</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Chapters üîñ</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">iOS Localization: Protect Your Localizable.strings from Accidental Corruption</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/zh-cn/ios-%E5%A4%9A%E8%AF%AD%E7%B3%BB%E5%AD%97%E4%B8%B2%E4%BF%9D%E9%99%A9-swiftgen-unittest-%E7%A1%AE%E4%BF%9D-localizable-strings-%E6%97%A0%E8%AF%AF-48a8526c1300/"><strong>ÁÇπÂáªËøôÈáå</strong></a>Êü•ÁúãÊú¨ÊñáÁ´†ÁÆÄ‰Ωì‰∏≠ÊñáÁâàÊú¨„ÄÇ</p></blockquote><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/ios-%E5%A4%9A%E8%AA%9E%E7%B3%BB%E5%AD%97%E4%B8%B2%E4%BF%9D%E9%9A%AA-swiftgen-unittest-%E7%A2%BA%E4%BF%9D-localizable-strings-%E7%84%A1%E8%AA%A4-48a8526c1300/"><strong>ÈªûÊìäÈÄôË£°</strong></a>Êü•ÁúãÊú¨ÊñáÁ´†Ê≠£È´î‰∏≠ÊñáÁâàÊú¨„ÄÇ</p></blockquote><blockquote class="prompt-info"><p>This post was translated with AI assistance ‚Äî let me know if anything sounds off!</p></blockquote><h4 id="zhgchgli-table-of-contents">Table of Contents</h4><nav class="zhgchgli-toc"><ul class="zhgchgli-toc-list"><li><a href="#get-insurance-for-multilingual-strings-in-ios">Get Insurance for Multilingual Strings in iOS!</a></li><li class="has-children"><details><summary>Question <a href="#question">#</a></summary><ul><li><a href="#plain-text-file">Plain Text File</a></li><li><a href="#if-there-is-a-problem-with-multilingual-support-the-key-will-be-displayed-directly-to-the-user">If there is a problem with multilingual support, the key will be displayed directly to the user</a></li></ul></details></li><li><a href="#check-requirements">Check Requirements</a></li><li class="has-children"><details><summary>Solution <a href="#solution">#</a></summary><ul><li><a href="#writing-a-complete-inspection-tool-using-swift">Writing a Complete Inspection Tool Using Swift</a></li><li><a href="#xcode-13-built-in-build-time-check-for-localizablestrings-file-format-correctness">XCode 13 Built-in Build Time Check for Localizable.strings File Format Correctness</a></li><li><a href="#using-swiftgen-to-replace-the-original-nslocalizedstring-string-base-access-method">Using SwiftGen to Replace the Original NSLocalizedString String Base Access Method</a></li><li><a href="#use-unittest-to-check-for-missing-entries-and-duplicate-keys-between-localization-files-and-the-main-language-file">Use UnitTest to check for missing entries and duplicate keys between localization files and the main language file</a></li></ul></details></li><li class="has-children"><details><summary>Summary <a href="#summary">#</a></summary><ul><li><a href="#advantages">Advantages</a></li></ul></details></li><li class="has-children"><details><summary>Advanced <a href="#advanced">#</a></summary><ul><li><a href="#localized-file-format">Localized File Format</a></li><li><a href="#stringdict">.stringdict</a></li><li><a href="#cicd">CI/CD</a></li><li><a href="#clearly-identify-which-key-is-wrong">Clearly Identify Which Key Is Wrong</a></li><li><a href="#using-third-party-tools-to-fully-free-engineers-from-multilingual-tasks">Using Third-Party Tools to Fully Free Engineers from Multilingual Tasks</a></li></ul></details></li><li><a href="#special-thanks">Special Thanks</a></li></ul></nav><hr /><h3 id="get-insurance-for-multilingual-strings-in-ios"><span class="me-2">Get Insurance for Multilingual Strings in iOS!</span><a href="#get-insurance-for-multilingual-strings-in-ios" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Using SwiftGen &amp; UnitTest to Ensure Safe Multilingual Operations</p><p><a href="/assets/48a8526c1300/1*G2UsVr02o122GxI2o1WbQQ.webp" class="popup img-link blur"><img data-src="/assets/48a8526c1300/1*G2UsVr02o122GxI2o1WbQQ.webp" alt="Photo by [Mick Haupt](https://unsplash.com/es/@rocinante_11?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjgwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Photo by <a href="https://unsplash.com/es/@rocinante_11?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank">Mick Haupt</a></p><h3 id="question"><span class="me-2">Question</span><a href="#question" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="plain-text-file"><span class="me-2">Plain Text File</span><a href="#plain-text-file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/48a8526c1300/1*9hxfi00_HcXy0wUMIyU8gA.webp" class="popup img-link blur"><img data-src="/assets/48a8526c1300/1*9hxfi00_HcXy0wUMIyU8gA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMTAiIGhlaWdodD0iMTExIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>iOS handles multiple languages using Localizable.strings plain text files, unlike Android, which manages them through XML format. This approach carries the risk of accidentally corrupting or missing entries in the language files during development. Additionally, multilingual errors are not detected at build time, often only discovered after release when users from certain regions report issues, significantly reducing user confidence.</p><p>In a previous painful case, everyone was so used to writing Swift that they forgot to add <code class="language-plaintext highlighter-rouge">;</code> in Localizable.strings. This caused the entire language version to break from the line missing the <code class="language-plaintext highlighter-rouge">;</code> after going live. It was only saved by an emergency hotfix.</p><h4 id="if-there-is-a-problem-with-multilingual-support-the-key-will-be-displayed-directly-to-the-user"><span class="me-2"><strong>If there is a problem with multilingual support, the key will be displayed directly to the user</strong></span><a href="#if-there-is-a-problem-with-multilingual-support-the-key-will-be-displayed-directly-to-the-user" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/48a8526c1300/1*BwaK_5ac2gxAmrzt4w-oBA.webp" class="popup img-link blur"><img data-src="/assets/48a8526c1300/1*BwaK_5ac2gxAmrzt4w-oBA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NzUiIGhlaWdodD0iNTg3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>As shown in the image above, if the <code class="language-plaintext highlighter-rouge">DESCRIPTION</code> key is missing, the app will directly display <code class="language-plaintext highlighter-rouge">DESCRIPTION</code> to the user.</p><h3 id="check-requirements"><span class="me-2">Check Requirements</span><a href="#check-requirements" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p>Localizable.strings Format Validation (Line endings must have <code class="language-plaintext highlighter-rouge">;</code>, valid Key-Value pairs)</p><li><p>The multilingual keys used in the code must have corresponding definitions in the Localizable.strings file.</p><li><p>Each localization in the Localizable.strings file must have the corresponding Key-Value entries.</p><li><p>Localizable.strings files cannot have duplicate keys (otherwise the value will be accidentally overwritten)</p></ul><h3 id="solution"><span class="me-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="writing-a-complete-inspection-tool-using-swift"><span class="me-2">Writing a Complete Inspection Tool Using Swift</span><a href="#writing-a-complete-inspection-tool-using-swift" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The previous approach was to ‚Äú<a href="/posts/zrealm-dev/en/swift-run-script-in-xcode-localization-image-asset-checks-automated-41c49a75a743/">Use Swift Directly in Xcode to Write Shell Scripts!</a>‚Äù referring to the <a href="https://github.com/freshOS/Localize" target="_blank">Localize üèÅ</a> tool, which uses Swift to develop a Command Line Tool for external localization file checks, then places the script in the Build Phases Run Script to run the checks during Build Time.</p><p><strong>Advantages:</strong><br /> The inspection tool is injected externally, not relying on the project. It can run checks without using XCode or building the project. The inspection can pinpoint the exact line in a specific file. Additionally, it supports formatting functions (sorting multilingual keys from A to Z).</p><p><strong>Disadvantages:</strong><br /> Increases build time (approximately +3 mins) and causes process divergence. If the script has issues or needs adjustment due to project structure changes, it is difficult to hand over and maintain. Since this part is outside the project, only those who add this check understand the entire logic, making it hard for other collaborators to handle.</p><blockquote><p>Interested readers can refer to the previous article. This article mainly explains how to use XCode 13 + SwiftGen + UnitTest to verify all functions of Localizable.strings.</p></blockquote><h4 id="xcode-13-built-in-build-time-check-for-localizablestrings-file-format-correctness"><span class="me-2">XCode 13 Built-in Build Time Check for Localizable.strings File Format Correctness</span><a href="#xcode-13-built-in-build-time-check-for-localizablestrings-file-format-correctness" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/48a8526c1300/1*p28LgNGZYh6S8T2s2UH8lg.webp" class="popup img-link blur"><img data-src="/assets/48a8526c1300/1*p28LgNGZYh6S8T2s2UH8lg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NTciIGhlaWdodD0iMjM0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>After upgrading to XCode 13, it now includes a built-in Build Time check for the Localizable.strings file format. Tests show the check is quite thorough; besides missing <code class="language-plaintext highlighter-rouge">;</code>, it also blocks extra meaningless strings.</p><h4 id="using-swiftgen-to-replace-the-original-nslocalizedstring-string-base-access-method"><span class="me-2">Using SwiftGen to Replace the Original NSLocalizedString String Base Access Method</span><a href="#using-swiftgen-to-replace-the-original-nslocalizedstring-string-base-access-method" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="https://github.com/SwiftGen/SwiftGen" target="_blank">SwiftGen</a> helps us change the original NSLocalizedString string access method to object access, preventing typos and missing key declarations.</p><p><a href="https://github.com/SwiftGen/SwiftGen" target="_blank" class="img-link shimmer" ><img src="https://repository-images.githubusercontent.com/39166950/1826ed00-d6cf-11ea-9736-34829910d1e6" alt="" loading="lazy"></a></p><p>SwiftGen is also a Command Line Tool; however, this tool is quite popular in the industry and has comprehensive documentation and community support, so there is no need to worry about maintenance issues after adopting it.</p><p><a href="https://github.com/SwiftGen/SwiftGen#installation" target="_blank"><strong>Installation</strong></a></p><p>You can choose the installation method based on your environment or CI/CD service settings. Here, the demo uses the simplest method with CocoaPods for installation.</p><blockquote><p>Please note that SwiftGen is not a real CocoaPod and does not depend on the project‚Äôs code; using CocoaPods to install SwiftGen only downloads this Command Line Tool executable.</p></blockquote><p>Add the swiftgen pod in the <code class="language-plaintext highlighter-rouge">podfile</code>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>pod 'SwiftGen', '~&gt; 6.0'
</pre></table></code></div></div><p><strong>Init</strong></p><p>After running <code class="language-plaintext highlighter-rouge">pod install</code>, open Terminal and <code class="language-plaintext highlighter-rouge">cd</code> into the project directory.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/L10NTests/Pods/SwiftGen/bin/swiftGen config init
</pre></table></code></div></div><p>Initialize the <code class="language-plaintext highlighter-rouge">swiftgen.yml</code> configuration file and open it.</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="na">strings</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">inputs</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">L10NTests/Supporting</span><span class="nv"> </span><span class="s">Files/zh-Hant.lproj/Localizable.strings"</span>
    <span class="na">outputs</span><span class="pi">:</span>
      <span class="na">templateName</span><span class="pi">:</span> <span class="s">structured-swift5</span>
      <span class="na">output</span><span class="pi">:</span> <span class="s2">"</span><span class="s">L10NTests/Supporting</span><span class="nv"> </span><span class="s">Files/SwiftGen-L10n.swift"</span>
      <span class="na">params</span><span class="pi">:</span>
        <span class="na">enumName</span><span class="pi">:</span> <span class="s2">"</span><span class="s">L10n"</span>
</pre></table></code></div></div><p>Paste and modify to fit your project‚Äôs format:</p><p><strong>inputs:</strong> Project localization file location (it is recommended to specify the DevelopmentLocalization language file)</p><p><strong>outputs:</strong> <strong>output:</strong> The location of the converted Swift file<br /> <strong>params: enumName:</strong> Object name<br /> <strong>templateName:</strong> Conversion template</p><p>You can run <code class="language-plaintext highlighter-rouge">swiftGen template list</code> to get the list of built-in templates.</p><p><a href="/assets/48a8526c1300/1*J5ZOMW6BC-fDqSlh-My2Pg.webp" class="popup img-link blur"><img data-src="/assets/48a8526c1300/1*J5ZOMW6BC-fDqSlh-My2Pg.webp" alt="flat v.s. structured" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NzMiIGhlaWdodD0iMTU0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>flat vs. structured</p><p>The difference is that if the key style is <code class="language-plaintext highlighter-rouge">XXX.YYY.ZZZ</code>, the flat template will convert it to camelCase; the structured template will keep the original style and convert it into an <code class="language-plaintext highlighter-rouge">XXX.YYY.ZZZ</code> object.</p><p>Pure Swift projects can directly use the built-in templates, but Swift mixed with Objective-C projects require custom templates:</p><p><code class="language-plaintext highlighter-rouge">flat-swift5-objc.stencil</code> :</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
</pre><td class="rouge-code"><pre><span class="c1">// swiftlint:disable all</span>
<span class="c1">// Generated using SwiftGen ‚Äî https://github.com/SwiftGen/SwiftGen</span>

<span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">tables</span><span class="mf">.</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="n">set</span> <span class="n">accessModifier</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="k">if</span> <span class="n">param</span><span class="mf">.</span><span class="n">publicAccess</span> <span class="o">%</span><span class="p">}</span><span class="k">public</span><span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span><span class="n">internal</span><span class="p">{</span><span class="o">%</span> <span class="k">endif</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="n">endset</span> <span class="o">%</span><span class="p">}</span>
<span class="n">import</span> <span class="nc">Foundation</span>

<span class="c1">// swiftlint:disable superfluous_disable_command file_length implicit_return</span>

<span class="c1">// MARK: - Strings</span>

<span class="p">{</span><span class="o">%</span> <span class="n">macro</span> <span class="n">parametersBlock</span> <span class="n">types</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="n">filter</span> <span class="n">removeNewlines</span><span class="o">:</span><span class="s2">"leading"</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">type</span> <span class="n">in</span> <span class="n">types</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">type</span> <span class="o">==</span> <span class="s2">"String"</span> <span class="o">%</span><span class="p">}</span>
    <span class="n">_</span> <span class="n">p</span><span class="p">{{</span><span class="n">forloop</span><span class="mf">.</span><span class="n">counter</span><span class="p">}}</span><span class="o">:</span> <span class="nc">Any</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span>
    <span class="n">_</span> <span class="n">p</span><span class="p">{{</span><span class="n">forloop</span><span class="mf">.</span><span class="n">counter</span><span class="p">}}</span><span class="o">:</span> <span class="p">{{</span><span class="n">type</span><span class="p">}}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">endif</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{{</span> <span class="s2">", "</span> <span class="k">if</span> <span class="n">not</span> <span class="n">forloop</span><span class="mf">.</span><span class="n">last</span> <span class="p">}}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">endfor</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endfilter</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="n">endmacro</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="n">macro</span> <span class="n">argumentsBlock</span> <span class="n">types</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="n">filter</span> <span class="n">removeNewlines</span><span class="o">:</span><span class="s2">"leading"</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">type</span> <span class="n">in</span> <span class="n">types</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">type</span> <span class="o">==</span> <span class="s2">"String"</span> <span class="o">%</span><span class="p">}</span>
    <span class="nf">String</span><span class="p">(</span><span class="n">describing</span><span class="o">:</span> <span class="n">p</span><span class="p">{{</span><span class="n">forloop</span><span class="mf">.</span><span class="n">counter</span><span class="p">}})</span>
    <span class="p">{</span><span class="o">%</span> <span class="n">elif</span> <span class="n">type</span> <span class="o">==</span> <span class="s2">"UnsafeRawPointer"</span> <span class="o">%</span><span class="p">}</span>
    <span class="nf">Int</span><span class="p">(</span><span class="n">bitPattern</span><span class="o">:</span> <span class="n">p</span><span class="p">{{</span><span class="n">forloop</span><span class="mf">.</span><span class="n">counter</span><span class="p">}})</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span>
    <span class="n">p</span><span class="p">{{</span><span class="n">forloop</span><span class="mf">.</span><span class="n">counter</span><span class="p">}}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">endif</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{{</span> <span class="s2">", "</span> <span class="k">if</span> <span class="n">not</span> <span class="n">forloop</span><span class="mf">.</span><span class="n">last</span> <span class="p">}}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">endfor</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endfilter</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="n">endmacro</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="n">macro</span> <span class="n">recursiveBlock</span> <span class="n">table</span> <span class="n">item</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">string</span> <span class="n">in</span> <span class="n">item</span><span class="mf">.</span><span class="n">strings</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">not</span> <span class="n">param</span><span class="mf">.</span><span class="n">noComments</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">line</span> <span class="n">in</span> <span class="n">string</span><span class="mf">.</span><span class="n">translation</span><span class="err">\</span><span class="o">|</span><span class="n">split</span><span class="o">:</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">%</span><span class="p">}</span>
  <span class="c1">/// {{line}}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">endfor</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">endif</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">string</span><span class="mf">.</span><span class="n">types</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{{</span><span class="n">accessModifier</span><span class="p">}}</span> <span class="k">static</span> <span class="n">func</span> <span class="p">{{</span><span class="n">string</span><span class="mf">.</span><span class="n">key</span><span class="err">\</span><span class="o">|</span><span class="n">swiftIdentifier</span><span class="o">:</span><span class="s2">"pretty"</span><span class="err">\</span><span class="o">|</span><span class="n">lowerFirstWord</span><span class="err">\</span><span class="o">|</span><span class="n">escapeReservedKeywords</span><span class="p">}}({</span><span class="o">%</span> <span class="n">call</span> <span class="n">parametersBlock</span> <span class="n">string</span><span class="mf">.</span><span class="n">types</span> <span class="o">%</span><span class="p">})</span> <span class="o">-&gt;</span> <span class="nc">String</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{{</span><span class="n">enumName</span><span class="p">}}</span><span class="mf">.</span><span class="nf">tr</span><span class="p">(</span><span class="s2">"</span><span class="si">{</span><span class="nv">{table}</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"</span><span class="si">{</span><span class="nv">{string.key}</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="p">{</span><span class="o">%</span> <span class="n">call</span> <span class="n">argumentsBlock</span> <span class="n">string</span><span class="mf">.</span><span class="n">types</span> <span class="o">%</span><span class="p">})</span>
  <span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="n">elif</span> <span class="n">param</span><span class="mf">.</span><span class="n">lookupFunction</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="c1"># custom localization function is mostly used for in-app lang selection, so we want the loc to be recomputed at each call for those (hence the computed var) #}</span>
  <span class="p">{{</span><span class="n">accessModifier</span><span class="p">}}</span> <span class="k">static</span> <span class="k">var</span> <span class="p">{{</span><span class="n">string</span><span class="mf">.</span><span class="n">key</span><span class="err">\</span><span class="o">|</span><span class="n">swiftIdentifier</span><span class="o">:</span><span class="s2">"pretty"</span><span class="err">\</span><span class="o">|</span><span class="n">lowerFirstWord</span><span class="err">\</span><span class="o">|</span><span class="n">escapeReservedKeywords</span><span class="p">}}</span><span class="o">:</span> <span class="nc">String</span> <span class="p">{</span> <span class="k">return</span> <span class="p">{{</span><span class="n">enumName</span><span class="p">}}</span><span class="mf">.</span><span class="nf">tr</span><span class="p">(</span><span class="s2">"</span><span class="si">{</span><span class="nv">{table}</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"</span><span class="si">{</span><span class="nv">{string.key}</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span> <span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{{</span><span class="n">accessModifier</span><span class="p">}}</span> <span class="k">static</span> <span class="n">let</span> <span class="p">{{</span><span class="n">string</span><span class="mf">.</span><span class="n">key</span><span class="err">\</span><span class="o">|</span><span class="n">swiftIdentifier</span><span class="o">:</span><span class="s2">"pretty"</span><span class="err">\</span><span class="o">|</span><span class="n">lowerFirstWord</span><span class="err">\</span><span class="o">|</span><span class="n">escapeReservedKeywords</span><span class="p">}}</span> <span class="o">=</span> <span class="p">{{</span><span class="n">enumName</span><span class="p">}}</span><span class="mf">.</span><span class="nf">tr</span><span class="p">(</span><span class="s2">"</span><span class="si">{</span><span class="nv">{table}</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"</span><span class="si">{</span><span class="nv">{string.key}</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">endif</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">endfor</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">child</span> <span class="n">in</span> <span class="n">item</span><span class="mf">.</span><span class="n">children</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="n">call</span> <span class="n">recursiveBlock</span> <span class="n">table</span> <span class="n">child</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">endfor</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endmacro</span> <span class="o">%</span><span class="p">}</span>
<span class="c1">// swiftlint:disable function_parameter_count identifier_name line_length type_body_length</span>
<span class="p">{</span><span class="o">%</span> <span class="n">set</span> <span class="n">enumName</span> <span class="o">%</span><span class="p">}{{</span><span class="n">param</span><span class="mf">.</span><span class="n">enumName</span><span class="err">\</span><span class="o">|</span><span class="k">default</span><span class="o">:</span><span class="s2">"L10n"</span><span class="p">}}{</span><span class="o">%</span> <span class="n">endset</span> <span class="o">%</span><span class="p">}</span>
<span class="o">@</span><span class="n">objcMembers</span> <span class="p">{{</span><span class="n">accessModifier</span><span class="p">}}</span> <span class="n">class</span> <span class="p">{{</span><span class="n">enumName</span><span class="p">}}</span><span class="o">:</span> <span class="nc">NSObject</span> <span class="p">{</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">tables</span><span class="mf">.</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">or</span> <span class="n">param</span><span class="mf">.</span><span class="n">forceFileNameEnum</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">table</span> <span class="n">in</span> <span class="n">tables</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{{</span><span class="n">accessModifier</span><span class="p">}}</span> <span class="n">enum</span> <span class="p">{{</span><span class="n">table</span><span class="mf">.</span><span class="n">name</span><span class="err">\</span><span class="o">|</span><span class="n">swiftIdentifier</span><span class="o">:</span><span class="s2">"pretty"</span><span class="err">\</span><span class="o">|</span><span class="n">escapeReservedKeywords</span><span class="p">}}</span> <span class="p">{</span>
    <span class="p">{</span><span class="o">%</span> <span class="n">filter</span> <span class="n">indent</span><span class="o">:</span><span class="mi">2</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="n">call</span> <span class="n">recursiveBlock</span> <span class="n">table</span><span class="mf">.</span><span class="n">name</span> <span class="n">table</span><span class="mf">.</span><span class="n">levels</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="n">endfilter</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">endfor</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="n">call</span> <span class="n">recursiveBlock</span> <span class="n">tables</span><span class="mf">.</span><span class="n">first</span><span class="mf">.</span><span class="n">name</span> <span class="n">tables</span><span class="mf">.</span><span class="n">first</span><span class="mf">.</span><span class="n">levels</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">endif</span> <span class="o">%</span><span class="p">}</span>
<span class="p">}</span>
<span class="c1">// swiftlint:enable function_parameter_count identifier_name line_length type_body_length</span>

<span class="c1">// MARK: - Implementation Details</span>

<span class="n">extension</span> <span class="p">{{</span><span class="n">enumName</span><span class="p">}}</span> <span class="p">{</span>
  <span class="k">private</span> <span class="k">static</span> <span class="kt">func</span> <span class="nf">tr</span><span class="p">(</span><span class="n">_</span> <span class="n">table</span><span class="o">:</span> <span class="nc">String</span><span class="p">,</span> <span class="n">_</span> <span class="n">key</span><span class="o">:</span> <span class="nc">String</span><span class="p">,</span> <span class="n">_</span> <span class="n">args</span><span class="o">:</span> <span class="nc">CVarArg</span><span class="mf">...</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nc">String</span> <span class="p">{</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">param</span><span class="mf">.</span><span class="n">lookupFunction</span> <span class="o">%</span><span class="p">}</span>
    <span class="n">let</span> <span class="n">format</span> <span class="o">=</span> <span class="p">{{</span> <span class="n">param</span><span class="mf">.</span><span class="n">lookupFunction</span> <span class="p">}}(</span><span class="n">key</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span>
    <span class="n">let</span> <span class="n">format</span> <span class="o">=</span> <span class="p">{{</span><span class="n">param</span><span class="mf">.</span><span class="n">bundle</span><span class="err">\</span><span class="o">|</span><span class="k">default</span><span class="o">:</span><span class="s2">"BundleToken.bundle"</span><span class="p">}}</span><span class="mf">.</span><span class="nf">localizedString</span><span class="p">(</span><span class="n">forKey</span><span class="o">:</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">:</span> <span class="n">nil</span><span class="p">,</span> <span class="n">table</span><span class="o">:</span> <span class="n">table</span><span class="p">)</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">endif</span> <span class="o">%</span><span class="p">}</span>
    <span class="k">return</span> <span class="nf">String</span><span class="p">(</span><span class="n">format</span><span class="o">:</span> <span class="n">format</span><span class="p">,</span> <span class="n">locale</span><span class="o">:</span> <span class="nc">Locale</span><span class="mf">.</span><span class="n">current</span><span class="p">,</span> <span class="n">arguments</span><span class="o">:</span> <span class="n">args</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">not</span> <span class="n">param</span><span class="mf">.</span><span class="n">bundle</span> <span class="k">and</span> <span class="n">not</span> <span class="n">param</span><span class="mf">.</span><span class="n">lookupFunction</span> <span class="o">%</span><span class="p">}</span>

<span class="c1">// swiftlint:disable convenience_type</span>
<span class="k">private</span> <span class="kt">final</span> <span class="kd">class</span> <span class="nc">BundleToken</span> <span class="p">{</span>
  <span class="k">static</span> <span class="n">let</span> <span class="n">bundle</span><span class="o">:</span> <span class="nc">Bundle</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1">#if SWIFT_PACKAGE</span>
    <span class="k">return</span> <span class="nc">Bundle</span><span class="mf">.</span><span class="n">module</span>
    <span class="c1">#else</span>
    <span class="k">return</span> <span class="nf">Bundle</span><span class="p">(</span><span class="k">for</span><span class="o">:</span> <span class="nc">BundleToken</span><span class="mf">.</span><span class="k">self</span><span class="p">)</span>
    <span class="c1">#endif</span>
  <span class="p">}()</span>
<span class="p">}</span>
<span class="c1">// swiftlint:enable convenience_type</span>
<span class="p">{</span><span class="o">%</span> <span class="k">endif</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span>
<span class="c1">// No string found</span>
<span class="p">{</span><span class="o">%</span> <span class="k">endif</span> <span class="o">%</span><span class="p">}</span>
</pre></table></code></div></div><p>The above provides a template collected and customized from the internet that is compatible with both Swift and Objective-C. You can create a <code class="language-plaintext highlighter-rouge">flat-swift5-objc.stencil</code> file and paste the content, or <a href="https://gist.github.com/zhgchgli0718/34cc6af6366add93f16632efd5575691/archive/bcccc0fb7367c8f9e58b8453446f0a52631aa8d1.zip" target="_blank">click here to directly download the .zip</a>.</p><p>If using a custom template, do not use templateName; instead, declare templatePath:</p><p><code class="language-plaintext highlighter-rouge">swiftgen.yml</code> :</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="na">strings</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">inputs</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">L10NTests/Supporting</span><span class="nv"> </span><span class="s">Files/zh-Hant.lproj/Localizable.strings"</span>
    <span class="na">outputs</span><span class="pi">:</span>
      <span class="na">templatePath</span><span class="pi">:</span> <span class="s2">"</span><span class="s">path/to/flat-swift5-objc.stencil"</span>
      <span class="na">output</span><span class="pi">:</span> <span class="s2">"</span><span class="s">L10NTests/Supporting</span><span class="nv"> </span><span class="s">Files/SwiftGen-L10n.swift"</span>
      <span class="na">params</span><span class="pi">:</span>
        <span class="na">enumName</span><span class="pi">:</span> <span class="s2">"</span><span class="s">L10n"</span>
</pre></table></code></div></div><p>Just set the templatePath to the location of the .stencil template within the project.</p><p><strong>Generator</strong></p><p>After setting up, you can return to the Terminal and manually run:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/L10NTests/Pods/SwiftGen/bin/swiftGen
</pre></table></code></div></div><p>Execute the conversion. After the first conversion, manually drag the converted file (SwiftGen-L10n.swift) from Finder into the project for the code to work.</p><p><strong>Run Script</strong></p><p><a href="/assets/48a8526c1300/1*jbpXqjsF9kROgIqRQG9JcA.webp" class="popup img-link blur"><img data-src="/assets/48a8526c1300/1*jbpXqjsF9kROgIqRQG9JcA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NTYiIGhlaWdodD0iNDczIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>In Project Settings -&gt; Build Phases -&gt; + -&gt; New Run Script Phase -&gt; Paste:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">if</span> <span class="o">[[</span> <span class="nt">-f</span> <span class="s2">"</span><span class="k">${</span><span class="nv">PODS_ROOT</span><span class="k">}</span><span class="s2">/SwiftGen/bin/swiftgen"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span> <span class="s2">"</span><span class="k">${</span><span class="nv">PODS_ROOT</span><span class="k">}</span><span class="s2">/SwiftGen/bin/swiftgen"</span>
  <span class="s2">"</span><span class="k">${</span><span class="nv">PODS_ROOT</span><span class="k">}</span><span class="s2">/SwiftGen/bin/swiftgen"</span>
<span class="k">else
  </span><span class="nb">echo</span> <span class="s2">"warning: SwiftGen is not installed. Run 'pod install --repo-update' to install it."</span>
<span class="k">fi</span>
</pre></table></code></div></div><p>This way, the Generator runs every time the project is built to produce the latest conversion results.</p><p><strong>How to use in CodeBase?</strong></p><p><a href="/assets/48a8526c1300/1*8AiJIfqe5C1r9ESbfF-Y7w.webp" class="popup img-link blur"><img data-src="/assets/48a8526c1300/1*8AiJIfqe5C1r9ESbfF-Y7w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3ODEiIGhlaWdodD0iMTc0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kt">L10n</span><span class="o">.</span><span class="n">homeTitle</span>
<span class="kt">L10n</span><span class="o">.</span><span class="nf">homeDescription</span><span class="p">(</span><span class="s">"ZhgChgLi"</span><span class="p">)</span> <span class="c1">// with arg</span>
</pre></table></code></div></div><blockquote><p>With Object Access, typos are impossible, and keys used in the code will never be missing from the Localizable.strings file.</p></blockquote><blockquote><p>However, SwiftGen can only generate from a specific language, so it cannot prevent a situation where a key exists in the generated language but is missing in other languages. This issue can only be protected by the UnitTest below.</p></blockquote><p><strong>Conversion</strong></p><p>The hardest part is the conversion because the completed project heavily uses NSLocalizedString, which needs to be converted to the new <code class="language-plaintext highlighter-rouge">L10n.XXX</code> format. It‚Äôs even more complicated if the strings have parameters, such as <code class="language-plaintext highlighter-rouge">String(format: NSLocalizedString</code>. Additionally, if there is mixed Objective-C, you must consider the syntax differences between Objective-C and Swift.</p><p>There is no special solution; you can only write your own Command Line Tool. You may refer to the previous article <a href="/posts/zrealm-dev/en/swift-run-script-in-xcode-localization-image-asset-checks-automated-41c49a75a743/">‰∏ä‰∏ÄÁØáÊñáÁ´†</a> where Swift is used to scan the project directory and parse NSLocalizedString with Regex to create a small tool for conversion.</p><p>It is recommended to convert one scenario at a time. Ensure it builds successfully before moving on to the next.</p><ul><li><p>Swift -&gt; NSLocalizedString without parameters</p><li><p>Swift -&gt; NSLocalizedString with Parameters Situation</p><li><p>OC -&gt; NSLocalizedString without parameters</p><li><p>OC -&gt; NSLocalizedString with Parameters Scenario</p></ul><h4 id="use-unittest-to-check-for-missing-entries-and-duplicate-keys-between-localization-files-and-the-main-language-file"><span class="me-2">Use UnitTest to check for missing entries and duplicate keys between localization files and the main language file</span><a href="#use-unittest-to-check-for-missing-entries-and-duplicate-keys-between-localization-files-and-the-main-language-file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>We can write UniTests to read the contents of <code class="language-plaintext highlighter-rouge">.strings</code> files from the Bundle and test them.</p><p><strong>Read <code class="language-plaintext highlighter-rouge">.strings</code> from Bundle and convert to object:</strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="kt">L10NTestsTests</span><span class="p">:</span> <span class="kt">XCTestCase</span> <span class="p">{</span>
    
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">localizations</span><span class="p">:</span> <span class="p">[</span><span class="kt">Bundle</span><span class="p">:</span> <span class="p">[</span><span class="kt">Localization</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[:]</span>
    
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">setUp</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">setUp</span><span class="p">()</span>
        
        <span class="k">let</span> <span class="nv">bundles</span> <span class="o">=</span> <span class="p">[</span><span class="kt">Bundle</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="nf">type</span><span class="p">(</span><span class="nv">of</span><span class="p">:</span> <span class="k">self</span><span class="p">))]</span>
        
        <span class="c1">//</span>
        <span class="n">bundles</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span> <span class="n">bundle</span> <span class="k">in</span>
            <span class="k">var</span> <span class="nv">localizations</span><span class="p">:</span> <span class="p">[</span><span class="kt">Localization</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            
            <span class="n">bundle</span><span class="o">.</span><span class="n">localizations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span> <span class="n">lang</span> <span class="k">in</span>
                <span class="k">var</span> <span class="nv">localization</span> <span class="o">=</span> <span class="kt">Localization</span><span class="p">(</span><span class="nv">lang</span><span class="p">:</span> <span class="n">lang</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="k">let</span> <span class="nv">lprojPath</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="nf">path</span><span class="p">(</span><span class="nv">forResource</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span> <span class="nv">ofType</span><span class="p">:</span> <span class="s">"lproj"</span><span class="p">),</span>
                   <span class="k">let</span> <span class="nv">lprojBundle</span> <span class="o">=</span> <span class="kt">Bundle</span><span class="p">(</span><span class="nv">path</span><span class="p">:</span> <span class="n">lprojPath</span><span class="p">)</span> <span class="p">{</span>
                    
                    <span class="k">let</span> <span class="nv">filesInLPROJ</span> <span class="o">=</span> <span class="p">(</span><span class="k">try</span><span class="p">?</span> <span class="kt">FileManager</span><span class="o">.</span><span class="k">default</span><span class="o">.</span><span class="nf">contentsOfDirectory</span><span class="p">(</span><span class="nv">atPath</span><span class="p">:</span> <span class="n">lprojBundle</span><span class="o">.</span><span class="n">bundlePath</span><span class="p">))</span> <span class="p">??</span> <span class="p">[]</span>
                    <span class="n">localization</span><span class="o">.</span><span class="n">localizableStringFiles</span> <span class="o">=</span> <span class="n">filesInLPROJ</span><span class="o">.</span><span class="n">compactMap</span> <span class="p">{</span> <span class="n">fileFullName</span> <span class="o">-&gt;</span> <span class="kt">L10NTestsTests</span><span class="o">.</span><span class="kt">Localization</span><span class="o">.</span><span class="kt">LocalizableStringFile</span><span class="p">?</span> <span class="k">in</span>
                        <span class="k">let</span> <span class="nv">fileName</span> <span class="o">=</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">fileURLWithPath</span><span class="p">:</span> <span class="n">fileFullName</span><span class="p">)</span><span class="o">.</span><span class="nf">deletingPathExtension</span><span class="p">()</span><span class="o">.</span><span class="n">lastPathComponent</span>
                        <span class="k">let</span> <span class="nv">fileExtension</span> <span class="o">=</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">fileURLWithPath</span><span class="p">:</span> <span class="n">fileFullName</span><span class="p">)</span><span class="o">.</span><span class="n">pathExtension</span>
                        <span class="k">guard</span> <span class="n">fileExtension</span> <span class="o">==</span> <span class="s">"strings"</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">nil</span> <span class="p">}</span>
                        <span class="k">guard</span> <span class="k">let</span> <span class="nv">path</span> <span class="o">=</span> <span class="n">lprojBundle</span><span class="o">.</span><span class="nf">path</span><span class="p">(</span><span class="nv">forResource</span><span class="p">:</span> <span class="n">fileName</span><span class="p">,</span> <span class="nv">ofType</span><span class="p">:</span> <span class="n">fileExtension</span><span class="p">)</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">nil</span> <span class="p">}</span>
                        
                        <span class="k">return</span> <span class="kt">L10NTestsTests</span><span class="o">.</span><span class="kt">Localization</span><span class="o">.</span><span class="kt">LocalizableStringFile</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="n">fileFullName</span><span class="p">,</span> <span class="nv">path</span><span class="p">:</span> <span class="n">path</span><span class="p">)</span>
                    <span class="p">}</span>
                    
                    <span class="n">localization</span><span class="o">.</span><span class="n">localizableStringFiles</span><span class="o">.</span><span class="nf">enumerated</span><span class="p">()</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">localizableStringFile</span><span class="p">)</span> <span class="k">in</span>
                        <span class="k">if</span> <span class="k">let</span> <span class="nv">fileContent</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="kt">String</span><span class="p">(</span><span class="nv">contentsOfFile</span><span class="p">:</span> <span class="n">localizableStringFile</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">let</span> <span class="nv">lines</span> <span class="o">=</span> <span class="n">fileContent</span><span class="o">.</span><span class="nf">components</span><span class="p">(</span><span class="nv">separatedBy</span><span class="p">:</span> <span class="o">.</span><span class="n">newlines</span><span class="p">)</span>
                            <span class="k">let</span> <span class="nv">pattern</span> <span class="o">=</span> <span class="s">"</span><span class="se">\"</span><span class="s">(.*)</span><span class="se">\"</span><span class="s">(</span><span class="se">\\</span><span class="s">s*)(=){1}(</span><span class="se">\\</span><span class="s">s*)</span><span class="se">\"</span><span class="s">(.+)</span><span class="se">\"</span><span class="s">;"</span>
                            <span class="k">let</span> <span class="nv">regex</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="kt">NSRegularExpression</span><span class="p">(</span><span class="nv">pattern</span><span class="p">:</span> <span class="n">pattern</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[])</span>
                            <span class="k">let</span> <span class="nv">values</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">compactMap</span> <span class="p">{</span> <span class="n">line</span> <span class="o">-&gt;</span> <span class="kt">Localization</span><span class="o">.</span><span class="kt">LocalizableStringFile</span><span class="o">.</span><span class="kt">Value</span><span class="p">?</span> <span class="k">in</span>
                                <span class="k">let</span> <span class="nv">range</span> <span class="o">=</span> <span class="kt">NSRange</span><span class="p">(</span><span class="nv">location</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">length</span><span class="p">:</span> <span class="p">(</span><span class="n">line</span> <span class="k">as</span> <span class="kt">NSString</span><span class="p">)</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
                                <span class="k">guard</span> <span class="k">let</span> <span class="nv">matches</span> <span class="o">=</span> <span class="n">regex</span><span class="p">?</span><span class="o">.</span><span class="nf">firstMatch</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="n">line</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[],</span> <span class="nv">range</span><span class="p">:</span> <span class="n">range</span><span class="p">)</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">nil</span> <span class="p">}</span>
                                <span class="k">let</span> <span class="nv">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span> <span class="k">as</span> <span class="kt">NSString</span><span class="p">)</span><span class="o">.</span><span class="nf">substring</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">matches</span><span class="o">.</span><span class="nf">range</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="mi">1</span><span class="p">))</span>
                                <span class="k">let</span> <span class="nv">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span> <span class="k">as</span> <span class="kt">NSString</span><span class="p">)</span><span class="o">.</span><span class="nf">substring</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">matches</span><span class="o">.</span><span class="nf">range</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="mi">5</span><span class="p">))</span>
                                <span class="k">return</span> <span class="kt">Localization</span><span class="o">.</span><span class="kt">LocalizableStringFile</span><span class="o">.</span><span class="kt">Value</span><span class="p">(</span><span class="nv">key</span><span class="p">:</span> <span class="n">key</span><span class="p">,</span> <span class="nv">value</span><span class="p">:</span> <span class="n">value</span><span class="p">)</span>
                            <span class="p">}</span>
                            <span class="n">localization</span><span class="o">.</span><span class="n">localizableStringFiles</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                    
                    <span class="n">localizations</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">localization</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
            
            <span class="k">self</span><span class="o">.</span><span class="n">localizations</span><span class="p">[</span><span class="n">bundle</span><span class="p">]</span> <span class="o">=</span> <span class="n">localizations</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">private</span> <span class="kd">extension</span> <span class="kt">L10NTestsTests</span> <span class="p">{</span>
    <span class="kd">struct</span> <span class="kt">Localization</span><span class="p">:</span> <span class="kt">Equatable</span> <span class="p">{</span>
        <span class="kd">struct</span> <span class="kt">LocalizableStringFile</span> <span class="p">{</span>
            <span class="kd">struct</span> <span class="kt">Value</span> <span class="p">{</span>
                <span class="k">let</span> <span class="nv">key</span><span class="p">:</span> <span class="kt">String</span>
                <span class="k">let</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">String</span>
            <span class="p">}</span>
            
            <span class="k">let</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
            <span class="k">let</span> <span class="nv">path</span><span class="p">:</span> <span class="kt">String</span>
            <span class="k">var</span> <span class="nv">values</span><span class="p">:</span> <span class="p">[</span><span class="kt">Value</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="p">}</span>
        
        <span class="k">let</span> <span class="nv">lang</span><span class="p">:</span> <span class="kt">String</span>
        <span class="k">var</span> <span class="nv">localizableStringFiles</span><span class="p">:</span> <span class="p">[</span><span class="kt">LocalizableStringFile</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="kd">static</span> <span class="kd">func</span> <span class="o">==</span> <span class="p">(</span><span class="nv">lhs</span><span class="p">:</span> <span class="k">Self</span><span class="p">,</span> <span class="nv">rhs</span><span class="p">:</span> <span class="k">Self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">lhs</span><span class="o">.</span><span class="n">lang</span> <span class="o">==</span> <span class="n">rhs</span><span class="o">.</span><span class="n">lang</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>We defined a <code class="language-plaintext highlighter-rouge">Localization</code> to store the parsed data. It searches for <code class="language-plaintext highlighter-rouge">lproj</code> folders in the <code class="language-plaintext highlighter-rouge">Bundle</code>, then finds <code class="language-plaintext highlighter-rouge">.strings</code> files within them. Using regular expressions, it converts multilingual strings into objects and stores them back in <code class="language-plaintext highlighter-rouge">Localization</code> for later testing.</p><p><strong>Here are a few points to note:</strong></p><ul><li><p>Using <code class="language-plaintext highlighter-rouge">Bundle(for: type(of: self))</code> to Access Resources from a Test Target</p><li><p>Remember to set the Test Target‚Äôs <a href="https://developer.apple.com/forums/thread/71779" target="_blank">STRINGS_FILE_OUTPUT_ENCODING</a> to <code class="language-plaintext highlighter-rouge">UTF-8</code>, otherwise reading file content with String will fail (the default is Binary).</p><li><p>The reason for using String reading instead of NSDictionary is that we need to test duplicate keys. Using NSDictionary will overwrite duplicate keys during reading.</p><li><p>Remember to add the <code class="language-plaintext highlighter-rouge">.strings</code> file to the Test Target</p></ul><p><a href="/assets/48a8526c1300/1*ERr-ef6R7dFHo1ucU6cPOQ.webp" class="popup img-link blur"><img data-src="/assets/48a8526c1300/1*ERr-ef6R7dFHo1ucU6cPOQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTAiIGhlaWdodD0iMTkxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><strong>TestCase 1. Test for duplicate key definitions within the same .strings file:</strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">testNoDuplicateKeysInSameFile</span><span class="p">()</span> <span class="k">throws</span> <span class="p">{</span>
    <span class="n">localizations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">localizations</span><span class="p">)</span> <span class="k">in</span>
        <span class="n">localizations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span> <span class="n">localization</span> <span class="k">in</span>
            <span class="n">localization</span><span class="o">.</span><span class="n">localizableStringFiles</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span> <span class="n">localizableStringFile</span> <span class="k">in</span>
                <span class="k">let</span> <span class="nv">keys</span> <span class="o">=</span> <span class="n">localizableStringFile</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">key</span> <span class="p">}</span>
                <span class="k">let</span> <span class="nv">uniqueKeys</span> <span class="o">=</span> <span class="kt">Set</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
                <span class="kt">XCTAssertTrue</span><span class="p">(</span><span class="n">keys</span><span class="o">.</span><span class="n">count</span> <span class="o">==</span> <span class="n">uniqueKeys</span><span class="o">.</span><span class="n">count</span><span class="p">,</span> <span class="s">"Localized Strings File: </span><span class="se">\(</span><span class="n">localizableStringFile</span><span class="o">.</span><span class="n">path</span><span class="se">)</span><span class="s"> has duplicated keys."</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Input:</p><p><a href="/assets/48a8526c1300/1*cB5nXv1wWPzbjAOrKQ835w.webp" class="popup img-link blur"><img data-src="/assets/48a8526c1300/1*cB5nXv1wWPzbjAOrKQ835w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MDYiIGhlaWdodD0iNzkiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>Result:</p><p><a href="/assets/48a8526c1300/1*6qIgcx0EkK7j_R17d6ljuw.webp" class="popup img-link blur"><img data-src="/assets/48a8526c1300/1*6qIgcx0EkK7j_R17d6ljuw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NTUiIGhlaWdodD0iODQiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p><strong>TestCase 2. Missing/extra keys compared to DevelopmentLocalization language:</strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">testCompareWithDevLangHasMissingKey</span><span class="p">()</span> <span class="k">throws</span> <span class="p">{</span>
    <span class="n">localizations</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span> <span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">localizations</span><span class="p">)</span> <span class="k">in</span>
        <span class="k">let</span> <span class="nv">developmentLang</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">developmentLocalization</span> <span class="p">??</span> <span class="s">"en"</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">developmentLocalization</span> <span class="o">=</span> <span class="n">localizations</span><span class="o">.</span><span class="nf">first</span><span class="p">(</span><span class="nv">where</span><span class="p">:</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">lang</span> <span class="o">==</span> <span class="n">developmentLang</span> <span class="p">})</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">othersLocalization</span> <span class="o">=</span> <span class="n">localizations</span><span class="o">.</span><span class="n">filter</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">lang</span> <span class="o">!=</span> <span class="n">developmentLang</span> <span class="p">}</span>
            
            <span class="n">developmentLocalization</span><span class="o">.</span><span class="n">localizableStringFiles</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span> <span class="n">developmentLocalizableStringFile</span> <span class="k">in</span>
                <span class="k">let</span> <span class="nv">developmentLocalizableKeys</span> <span class="o">=</span> <span class="kt">Set</span><span class="p">(</span><span class="n">developmentLocalizableStringFile</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">key</span> <span class="p">})</span>
                <span class="n">othersLocalization</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span> <span class="n">otherLocalization</span> <span class="k">in</span>
                    <span class="k">if</span> <span class="k">let</span> <span class="nv">otherLocalizableStringFile</span> <span class="o">=</span> <span class="n">otherLocalization</span><span class="o">.</span><span class="n">localizableStringFiles</span><span class="o">.</span><span class="nf">first</span><span class="p">(</span><span class="nv">where</span><span class="p">:</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">developmentLocalizableStringFile</span><span class="o">.</span><span class="n">name</span> <span class="p">})</span> <span class="p">{</span>
                        <span class="k">let</span> <span class="nv">otherLocalizableKeys</span> <span class="o">=</span> <span class="kt">Set</span><span class="p">(</span><span class="n">otherLocalizableStringFile</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">key</span> <span class="p">})</span>
                        <span class="k">if</span> <span class="n">developmentLocalizableKeys</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;</span> <span class="n">otherLocalizableKeys</span><span class="o">.</span><span class="n">count</span> <span class="p">{</span>
                            <span class="kt">XCTFail</span><span class="p">(</span><span class="s">"Localized Strings File: </span><span class="se">\(</span><span class="n">otherLocalizableStringFile</span><span class="o">.</span><span class="n">path</span><span class="se">)</span><span class="s"> has redundant keys."</span><span class="p">)</span>
                        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">developmentLocalizableKeys</span><span class="o">.</span><span class="n">count</span> <span class="o">&gt;</span> <span class="n">otherLocalizableKeys</span><span class="o">.</span><span class="n">count</span> <span class="p">{</span>
                            <span class="kt">XCTFail</span><span class="p">(</span><span class="s">"Localized Strings File: </span><span class="se">\(</span><span class="n">otherLocalizableStringFile</span><span class="o">.</span><span class="n">path</span><span class="se">)</span><span class="s"> has missing keys."</span><span class="p">)</span>
                        <span class="p">}</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="kt">XCTFail</span><span class="p">(</span><span class="s">"Localized Strings File not found in Lang: </span><span class="se">\(</span><span class="n">otherLocalization</span><span class="o">.</span><span class="n">lang</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="kt">XCTFail</span><span class="p">(</span><span class="s">"developmentLocalization not found in Bundle: </span><span class="se">\(</span><span class="n">bundle</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Input: (Compared to DevelopmentLocalization, other languages lack declared Keys)</p><p><a href="/assets/48a8526c1300/1*RwO-ploDVoExJmhHRpBXiA.webp" class="popup img-link blur"><img data-src="/assets/48a8526c1300/1*RwO-ploDVoExJmhHRpBXiA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzODIiIGhlaWdodD0iNTgiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>Output:</p><p><a href="/assets/48a8526c1300/1*Mdt01WLvX2KBtwUhThxOSQ.webp" class="popup img-link blur"><img data-src="/assets/48a8526c1300/1*Mdt01WLvX2KBtwUhThxOSQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4ODMiIGhlaWdodD0iMTIxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Input: (DevelopmentLocalization does not have this key, but it appears in other languages)</p><p><a href="/assets/48a8526c1300/1*RwO-ploDVoExJmhHRpBXiA.webp" class="popup img-link blur"><img data-src="/assets/48a8526c1300/1*RwO-ploDVoExJmhHRpBXiA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzODIiIGhlaWdodD0iNTgiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>Output:</p><p><a href="/assets/48a8526c1300/1*Fr-w-PXEx2N_ftYjfXTa9w.webp" class="popup img-link blur"><img data-src="/assets/48a8526c1300/1*Fr-w-PXEx2N_ftYjfXTa9w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4ODEiIGhlaWdodD0iNzkiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><h3 id="summary"><span class="me-2">Summary</span><a href="#summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Combining the above methods, we use:</p><ul><li><p>New XCode ensures the correctness of .strings file format ‚úÖ</p><li><p>SwiftGen ensures that the CodeBase does not have typos or undeclared references when using multiple languages ‚úÖ</p><li><p>UnitTest ensures the accuracy of multilingual content ‚úÖ</p></ul><p><a href="https://github.com/zhgchgli0718/L10NTests" target="_blank" class="img-link shimmer" ><img src="https://opengraph.githubassets.com/5e3a8099a333f9bf5a74339f82426afdd235c5a6ca6b9910196a4b961eb2b31a/zhgchgli0718/L10NTests" alt="" loading="lazy"></a></p><h4 id="advantages"><span class="me-2">Advantages:</span><a href="#advantages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><p>Fast execution speed, does not slow down Build Time</p><li><p>As long as you are an iOS developer, you will maintain it.</p></ul><h3 id="advanced"><span class="me-2">Advanced</span><a href="#advanced" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="localized-file-format"><span class="me-2">Localized File Format</span><a href="#localized-file-format" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>This solution cannot be achieved; you still need to use the original <a href="/posts/zrealm-dev/en/swift-run-script-in-xcode-localization-image-asset-checks-automated-41c49a75a743/">Command Line Tool written in Swift to accomplish it</a>. However, the formatting part can be done in the git pre-commit; if there is no diff, no adjustment is made to avoid running it every time you build:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c">#!/bin/sh</span>

<span class="nv">diffStaged</span><span class="o">=</span><span class="k">${</span><span class="nv">1</span><span class="k">:-</span><span class="p">\-\-staged</span><span class="k">}</span> <span class="c"># use $1 if exists, default to --staged.</span>

git diff <span class="nt">--diff-filter</span><span class="o">=</span>d <span class="nt">--name-only</span> <span class="nv">$diffStaged</span> <span class="se">\|</span> <span class="nb">grep</span> <span class="nt">-e</span> <span class="s1">'Localizable.*\.\(strings\\|stringsdict\)$'</span> <span class="se">\|</span> <span class="se">\</span>
  <span class="k">while </span><span class="nb">read </span>line<span class="p">;</span> <span class="k">do</span>
    <span class="c"># do format for ${line}</span>
<span class="k">done</span>
</pre></table></code></div></div><h4 id="stringdict"><span class="me-2">.stringdict</span><a href="#stringdict" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The same principle can also be applied to <code class="language-plaintext highlighter-rouge">.stringdict</code>.</p><h4 id="cicd"><span class="me-2">CI/CD</span><a href="#cicd" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>swiftgen does not need to be placed in the build phase because it runs every time you build, and the code only appears after the build is complete. You can change it to run the command only when there are adjustments.</p><h4 id="clearly-identify-which-key-is-wrong"><span class="me-2">Clearly Identify Which Key Is Wrong</span><a href="#clearly-identify-which-key-is-wrong" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The UnitTest code can be optimized to clearly indicate which Key is Missing/Redundant/Duplicate.</p><h4 id="using-third-party-tools-to-fully-free-engineers-from-multilingual-tasks"><span class="me-2">Using Third-Party Tools to Fully Free Engineers from Multilingual Tasks</span><a href="#using-third-party-tools-to-fully-free-engineers-from-multilingual-tasks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>As mentioned in the previous talk ‚Äú<a href="/posts/pinkoi-engineering/en/high-efficiency-engineering-teams-pinkoi-tech-career-talk-insights-11f6c8568154/">2021 Pinkoi Tech Career Talk ‚Äî Secrets of High-Efficiency Engineering Teams</a>‚Äù, multilingual work in large teams can be separated through third-party services to manage dependencies in multilingual tasks.</p><p><a href="/assets/48a8526c1300/1*YQi4ti2_MfUapUSRKnF5dg.webp" class="popup img-link blur"><img data-src="/assets/48a8526c1300/1*YQi4ti2_MfUapUSRKnF5dg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5NjAiIGhlaWdodD0iNTQwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Engineers only need to define the keys, and multilingual content will be automatically imported from the platform during the CI/CD phase, eliminating manual maintenance and reducing errors.</p><h3 id="special-thanks"><span class="me-2">Special Thanks</span><a href="#special-thanks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/48a8526c1300/1*CCGSKp2-BvATpDAuRiRuRQ.webp" class="popup img-link blur"><img data-src="/assets/48a8526c1300/1*CCGSKp2-BvATpDAuRiRuRQ.webp" alt="[Wei Cao](https://www.linkedin.com/in/wei-cao-67b5b315a/){:target=&quot;_blank&quot;} , iOS Developer @ Pinkoi" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="https://www.linkedin.com/in/wei-cao-67b5b315a/" target="_blank">Wei Cao</a> , iOS Developer @ Pinkoi</p><p>If you have any questions or feedback, feel free to <a href="https://www.zhgchg.li/contact" target="_blank">contact me</a>.</p><hr /><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=üç∫&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a><br /></p><blockquote class="prompt-info"><p>This post was originally published on Medium (<a href="https://medium.com/p/48a8526c1300" target="_blank"><strong>View original post</strong></a>), and automatically converted and synced by <a href="/posts/tools/medium-to-jekyll/" target="_blank">ZMediumToMarkdown</a>.</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/en/zmediumtomarkdown/2022-07-15-48a8526c1300.md" target="_blank">Improve this page on Github.</a></p></blockquote><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1,049+ Followers</span></a></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-dev/">ZRealm Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/english/" class="post-tag no-text-decoration" >english</a> <a href="/tags/ai-translation/" class="post-tag no-text-decoration" >ai-translation</a> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/localization/" class="post-tag no-text-decoration" >localization</a> <a href="/tags/unit-testing/" class="post-tag no-text-decoration" >unit-testing</a> <a href="/tags/xcode/" class="post-tag no-text-decoration" >xcode</a> <a href="/tags/swift/" class="post-tag no-text-decoration" >swift</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=iOS%20Localization:%20Protect%20Your%20Localizable.strings%20from%20Accidental%20Corruption%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fen%2Fios-localization-protect-your-localizable-strings-from-accidental-corruption-48a8526c1300%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=iOS%20Localization:%20Protect%20Your%20Localizable.strings%20from%20Accidental%20Corruption%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fen%2Fios-localization-protect-your-localizable-strings-from-accidental-corruption-48a8526c1300%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fen%2Fios-localization-protect-your-localizable-strings-from-accidental-corruption-48a8526c1300%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/en/ci-cd-explained-boost-ios-app-development-stability-and-efficiency-tool-selection-guide-c008a9e8ceca/">CI/CD Explained: Boost iOS App Development Stability and EfficiencyÔΩúTool Selection Guide</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/zh-cn/ci-cd-%E6%98%AF%E4%BB%80%E4%B9%88-%E6%89%93%E9%80%A0%E9%AB%98%E6%95%88%E7%A8%B3%E5%AE%9A%E5%BC%80%E5%8F%91%E5%9B%A2%E9%98%9F%E7%9A%84%E5%85%B3%E9%94%AE%E6%B5%81%E7%A8%8B%E4%B8%8E%E5%B7%A5%E5%85%B7%E9%80%89%E6%8B%A9-c008a9e8ceca/">CI/CD ÂÆûÊàòÊåáÂçóÔºà‰∏ÄÔºâÔºöCI/CD ÊòØ‰ªÄ‰πàÔºüÂ¶Ç‰ΩïÈÄèËøá CI/CD ÊâìÈÄ†Á®≥ÂÆöÈ´òÊïàÁöÑÂºÄÂèëÂõ¢ÈòüÔºüÂ∑•ÂÖ∑ÈÄâÊã©Ôºü</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/ci-cd-%E6%98%AF%E4%BB%80%E9%BA%BC-%E6%89%93%E9%80%A0%E9%AB%98%E6%95%88%E7%A9%A9%E5%AE%9A%E9%96%8B%E7%99%BC%E5%9C%98%E9%9A%8A%E7%9A%84%E9%97%9C%E9%8D%B5%E6%B5%81%E7%A8%8B%E8%88%87%E5%B7%A5%E5%85%B7%E9%81%B8%E6%93%87-c008a9e8ceca/">CI/CD ÂØ¶Êà∞ÊåáÂçóÔºà‰∏ÄÔºâÔºöCI/CD ÊòØ‰ªÄÈ∫ºÔºüÂ¶Ç‰ΩïÈÄèÈÅé CI/CD ÊâìÈÄ†Á©©ÂÆöÈ´òÊïàÁöÑÈñãÁôºÂúòÈöäÔºüÂ∑•ÂÖ∑ÈÅ∏ÊìáÔºü</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/en/google-apps-script-web-app-integrate-forms-with-github-actions-ci-cd-for-streamlined-workflows-4cb4437818f2/">Google Apps Script Web AppÔΩúIntegrate Forms with GitHub Actions CI/CD for Streamlined Workflows</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/zh-cn/google-apps-script-web-app-%E6%89%93%E9%80%A0-github-action-ci-cd-%E8%87%AA%E8%AE%A2%E8%A1%A8%E5%8D%95%E6%8F%90%E5%8D%87%E5%BC%80%E5%8F%91%E6%95%88%E7%8E%87-4cb4437818f2/">‰ΩøÁî® Google Apps Script Web App Ë°®Âçï‰∏≤Êé• Github Action CI/CD Â∑•‰Ωú</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">ÁîüÊ¥ª</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Chapters üîñ</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-dev/en/xcode-build-configuration-release-detect-ghost-crashes-logic-bugs-before-upgrade-7508328d8b8d/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1744383031" data-df="ll" > Apr 11, 2025 </time><h4 class="pt-0 my-2">XCode Build Configuration ReleaseÔΩúDetect Ghost Crashes & Logic Bugs Before Upgrade</h4><div class="text-muted"><p>iOS developers facing ghost crashes or logic issues only in Release builds can identify and fix these hidden bugs before XCode upgrades, ensuring stable app performance and avoiding unexpected fail...</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/en/xcode-virtual-directory-issues-streamline-your-project-structure-with-open-source-tools-fd719053b376/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1740918091" data-df="ll" > Mar 2, 2025 </time><h4 class="pt-0 my-2">Xcode Virtual Directory Issues: Streamline Your Project Structure with Open Source Tools</h4><div class="text-muted"><p>Developers facing Xcode virtual directory chaos can simplify integration with modern tools like XcodeGen and Tuist using a proven open source solution that restores project clarity and boosts workf...</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/ios-%E5%A4%9A%E8%AA%9E%E7%B3%BB%E5%AD%97%E4%B8%B2%E4%BF%9D%E9%9A%AA-swiftgen-unittest-%E7%A2%BA%E4%BF%9D-localizable-strings-%E7%84%A1%E8%AA%A4-48a8526c1300/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1657879804" data-df="ll" > Jul 15, 2022 </time><h4 class="pt-0 my-2">iOS ÁÇ∫Â§öË™ûÁ≥ªÂ≠ó‰∏≤Ë≤∑‰ªΩ‰øùÈö™ÂêßÔºÅ</h4><div class="text-muted"><p>Á¢∫‰øù Localizable.strings ÊñáÂ≠óÊ™î‰∏çË¢´ÊÑèÂ§ñÊîπÂ£û</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-dev/visitor-pattern-%E6%8F%90%E5%8D%87-tableview-%E5%8F%AF%E6%93%B4%E5%85%85%E6%80%A7%E8%88%87%E5%8F%AF%E7%B6%AD%E8%AD%B7%E6%80%A7%E8%A8%AD%E8%A8%88%E7%AF%84%E4%BE%8B-60473cb47550/" class="btn btn-outline-primary" aria-label="Older" ><p>Visitor PatternÔΩúÊèêÂçá TableView ÂèØÊì¥ÂÖÖÊÄßËàáÂèØÁ∂≠Ë≠∑ÊÄßË®≠Ë®àÁØÑ‰æã</p></a> <a href="/posts/zrealm-dev/zh-cn/ios-%E5%A4%9A%E8%AF%AD%E7%B3%BB%E5%AD%97%E4%B8%B2%E4%BF%9D%E9%99%A9-swiftgen-unittest-%E7%A1%AE%E4%BF%9D-localizable-strings-%E6%97%A0%E8%AF%AF-48a8526c1300/" class="btn btn-outline-primary" aria-label="Newer" ><p>iOS ‰∏∫Â§öËØ≠Á≥ªÂ≠ó‰∏≤‰π∞‰ªΩ‰øùÈô©ÂêßÔºÅ</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>¬© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span> <a href="/">Ê≠£È´î‰∏≠Êñá</a> | <a href="/tags/simplified-chinese">ÁÆÄ‰Ωì‰∏≠Êñá</a> | <a href="/tags/english/">English</a> <br/> Last updated: 2025-12-20 10:50:31 +08:00</p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">ÁîüÊ¥ª</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
