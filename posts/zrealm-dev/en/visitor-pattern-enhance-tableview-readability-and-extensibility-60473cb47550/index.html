<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Visitor Pattern｜Enhance TableView Readability and Extensibility" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="Improve TableView management with Visitor Pattern to simplify code maintenance and enable flexible feature expansion, boosting development efficiency and scalability." /><meta property="og:description" content="Improve TableView management with Visitor Pattern to simplify code maintenance and enable flexible feature expansion, boosting development efficiency and scalability." /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-dev/en/visitor-pattern-enhance-tableview-readability-and-extensibility-60473cb47550/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-dev/en/visitor-pattern-enhance-tableview-readability-and-extensibility-60473cb47550/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/60473cb47550/1*0YcpTUOCDjuV6Ii4jgbK0g.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-08T15:58:30+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/60473cb47550/1*0YcpTUOCDjuV6Ii4jgbK0g.webp" /><meta property="twitter:title" content="Visitor Pattern｜Enhance TableView Readability and Extensibility" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://medium.com/@zhgchgli/"},"dateModified":"2024-09-07T10:37:30+08:00","datePublished":"2022-07-08T15:58:30+08:00","description":"Improve TableView management with Visitor Pattern to simplify code maintenance and enable flexible feature expansion, boosting development efficiency and scalability.","headline":"Visitor Pattern｜Enhance TableView Readability and Extensibility","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+","url":"https://zhgchg.li/assets/60473cb47550/1*0YcpTUOCDjuV6Ii4jgbK0g.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-dev/en/visitor-pattern-enhance-tableview-readability-and-extensibility-60473cb47550/"},"url":"https://zhgchg.li/posts/zrealm-dev/en/visitor-pattern-enhance-tableview-readability-and-extensibility-60473cb47550/"}</script><title>Visitor Pattern｜Enhance TableView Readability and Extensibility | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script><link rel="alternate" hreflang="zh-Hans" href="/posts/zrealm-dev/zh-cn/visitor-pattern-%E6%8F%90%E5%8D%87-tableview-%E5%8F%AF%E6%89%A9%E5%85%85%E6%80%A7%E4%B8%8E%E5%8F%AF%E7%BB%B4%E6%8A%A4%E6%80%A7%E8%AE%BE%E8%AE%A1%E8%8C%83%E4%BE%8B-60473cb47550/"><link rel="alternate" hreflang="zh-Hant" href="/posts/zrealm-dev/visitor-pattern-%E6%8F%90%E5%8D%87-tableview-%E5%8F%AF%E6%93%B4%E5%85%85%E6%80%A7%E8%88%87%E5%8F%AF%E7%B6%AD%E8%AD%B7%E6%80%A7%E8%A8%AD%E8%A8%88%E7%AF%84%E4%BE%8B-60473cb47550/"><link rel="alternate" hreflang="en" href="/posts/zrealm-dev/en/visitor-pattern-enhance-tableview-readability-and-extensibility-60473cb47550/"><link rel="alternate" hreflang="x-default" href="/posts/zrealm-dev/en/visitor-pattern-enhance-tableview-readability-and-extensibility-60473cb47550/"><link rel="stylesheet" href="/assets/css/post-toc.css"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0">An iOS, web, and automation developer from Taiwan 🇹🇼 who also loves sharing, traveling, and writing.</p><a href="https://medium.com/@zhgchgli" target="_blank" style="display: block;text-align: center;font-style: normal;/* text-decoration: underline; */font-size: 1.2em;color: var(--heading-color);">1K+ Followers on Medium</a></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/english/" class="nav-link"> <i class="fa-fw fa fa-solid fa-language"></i> <span>ENGLISH POSTS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Visitor Pattern｜Enhance TableView Readability and Extensibility</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Visitor Pattern｜Enhance TableView Readability and Extensibility</h1><p class="post-desc fw-light mb-4">Improve TableView management with Visitor Pattern to simplify code maintenance and enable flexible feature expansion, boosting development efficiency and scalability.</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1657267110" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jul 8, 2022 </time> </span> <span> Updated <time data-ts="1725676650" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Sep 7, 2024 </time> </span><div class="mt-3 mb-3"> <a href="/assets/60473cb47550/1*0YcpTUOCDjuV6Ii4jgbK0g.webp" class="popup img-link preview-img blur"><img data-src="/assets/60473cb47550/1*0YcpTUOCDjuV6Ii4jgbK0g.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></div><div class="d-flex justify-content-between"> <span style="display: inline-flex; align-items: center; gap: 4px;"> By <em> <a href="https://medium.com/@zhgchgli/">ZhgChgLi</a> </em> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" style="display: block; "><path fill="#007bff" d="M271.2 56C265.1 49.8 256.2 47.3 247.8 49.6C239.4 51.9 232.9 58.4 230.8 66.8L215.5 127C214.4 131.4 209.9 134 205.6 132.7L145.8 115.9C137.4 113.5 128.4 115.9 122.3 122C116.2 128.1 113.8 137.1 116.2 145.5L133.1 205.3C134.3 209.6 131.7 214.1 127.4 215.2L67.1 230.5C58.7 232.6 52.1 239.2 49.8 247.6C47.5 256 50 264.9 56.2 271L100.7 314.3C103.9 317.4 103.9 322.6 100.7 325.8L56.3 369.1C50.1 375.2 47.6 384.1 49.9 392.5C52.2 400.9 58.8 407.4 67.2 409.6L127.4 424.9C131.8 426 134.4 430.5 133.1 434.8L116.2 494.5C113.8 502.9 116.2 511.9 122.3 518C128.4 524.1 137.4 526.5 145.8 524.1L205.6 507.2C209.9 506 214.4 508.6 215.5 512.9L230.8 573.1C232.9 581.5 239.5 588.1 247.9 590.4C256.3 592.7 265.2 590.2 271.3 584L314.6 539.5C317.7 536.3 322.9 536.3 326.1 539.5L369.3 584C375.4 590.2 384.3 592.7 392.7 590.4C401.1 588.1 407.6 581.5 409.8 573.1L425.1 513C426.2 508.6 430.7 506 435 507.3L494.8 524.2C503.2 526.6 512.2 524.2 518.3 518.1C524.4 512 526.8 503 524.4 494.6L507.5 434.8C506.3 430.5 508.9 426 513.2 424.9L573.4 409.6C581.8 407.5 588.4 400.9 590.7 392.5C593 384.1 590.5 375.1 584.3 369.1L539.8 325.8C536.6 322.7 536.6 317.5 539.8 314.3L584.3 271C590.5 264.9 593 256 590.7 247.6C588.4 239.2 581.8 232.7 573.4 230.5L513.2 215.2C508.8 214.1 506.2 209.6 507.5 205.3L524.4 145.5C526.8 137.1 524.4 128.1 518.3 122C512.2 115.9 503.2 113.5 494.8 115.9L435 132.8C430.7 134 426.2 131.4 425.1 127.1L409.8 66.8C407.7 58.4 401.1 51.8 392.7 49.5C384.3 47.2 375.4 49.7 369.3 55.9L326 100.5C322.9 103.7 317.7 103.7 314.5 100.5L271.2 56z"/><path d="M250 330 l60 60 100 -140" stroke="#ffffff" stroke-width="40" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1320 words" > <em>7 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Visitor Pattern｜Enhance TableView Readability and Extensibility</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">章節 (Chapters)🔖</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Visitor Pattern｜Enhance TableView Readability and Extensibility</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/zh-cn/visitor-pattern-%E6%8F%90%E5%8D%87-tableview-%E5%8F%AF%E6%89%A9%E5%85%85%E6%80%A7%E4%B8%8E%E5%8F%AF%E7%BB%B4%E6%8A%A4%E6%80%A7%E8%AE%BE%E8%AE%A1%E8%8C%83%E4%BE%8B-60473cb47550/"><strong>点击这里</strong></a>查看本文章简体中文版本。</p></blockquote><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/visitor-pattern-%E6%8F%90%E5%8D%87-tableview-%E5%8F%AF%E6%93%B4%E5%85%85%E6%80%A7%E8%88%87%E5%8F%AF%E7%B6%AD%E8%AD%B7%E6%80%A7%E8%A8%AD%E8%A8%88%E7%AF%84%E4%BE%8B-60473cb47550/"><strong>點擊這裡</strong></a>查看本文章正體中文版本。</p></blockquote><blockquote class="prompt-info"><p>This post was translated with AI assistance — let me know if anything sounds off!</p></blockquote><h4 id="zhgchgli-table-of-contents">Table of Contents</h4><nav class="zhgchgli-toc"><ul class="zhgchgli-toc-list"><li class="has-children"><details><summary>Visitor Pattern in TableView <a href="#visitor-pattern-in-tableview">#</a></summary><ul><li><a href="#introduction">Introduction</a></li></ul></details></li><li><a href="#use-case-scenario">Use Case Scenario</a></li><li><a href="#question">Question</a></li><li class="has-children"><details><summary>Visitor Pattern Solution <a href="#visitor-pattern-solution">#</a></summary><ul><li><a href="#why">Why?</a></li><li><a href="#how">How?</a></li><li><a href="#the-architecture-diagram-applying-the-visitor-pattern-is-as-follows">The architecture diagram applying the Visitor Pattern is as follows</a></li><li><a href="#first-define-the-visitor-interface-this-interface-abstracts-the-types-of-datasource-that-the-operator-can-accept">First, define the Visitor interface. This interface abstracts the types of DataSource that the operator can accept</a></li><li><a href="#interface-for-viewobject-binding-implementation">Interface for ViewObject Binding Implementation</a></li><li><a href="#implementation-in-uitableview">Implementation in UITableView</a></li></ul></details></li><li><a href="#results">Results</a></li><li class="has-children"><details><summary>Complete Project <a href="#complete-project">#</a></summary><ul><li><a href="#murmur">Murmur…</a></li></ul></details></li><li><a href="#further-reading">Further Reading</a></li></ul></nav><hr /><h3 id="visitor-pattern-in-tableview"><span class="me-2">Visitor Pattern in TableView</span><a href="#visitor-pattern-in-tableview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Using Visitor Pattern to Improve TableView Readability and Extensibility</p><p><a href="/assets/60473cb47550/1*0YcpTUOCDjuV6Ii4jgbK0g.webp" class="popup img-link blur"><img data-src="/assets/60473cb47550/1*0YcpTUOCDjuV6Ii4jgbK0g.webp" alt="Photo by [Alex wong](https://unsplash.com/@killerfvith?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjkzMyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Photo by <a href="https://unsplash.com/@killerfvith?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank">Alex wong</a></p><h4 id="introduction"><span class="me-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Following the previous article “<a href="/posts/zrealm-dev/en/visitor-pattern-in-ios-swift-design-pattern-practical-applications-ba5773a7bfea/">Visitor Pattern in Swift</a>” which introduced the Visitor pattern and a simple practical use case, this article will present another real-world application in iOS development.</p><h3 id="use-case-scenario"><span class="me-2">Use Case Scenario</span><a href="#use-case-scenario" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>To develop a dynamic wall feature, multiple types of blocks need to be dynamically combined and displayed.</p><p>Taking StreetVoice’s activity feed as an example:</p><p><a href="/assets/60473cb47550/1*_Liz9H0ZUD8Kk6kLKMMWjQ.webp" class="popup img-link blur"><img data-src="/assets/60473cb47550/1*_Liz9H0ZUD8Kk6kLKMMWjQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MjciIGhlaWdodD0iMTA5NiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>As shown in the above image, the dynamic wall is composed of various types of blocks dynamically combined:</p><ul><li><p>Type A: Event Updates</p><li><p>Type B: Tracking Recommendations</p><li><p>Type C: New Song Updates</p><li><p>Type D: New Album Updates</p><li><p>Type E: New Tracking Updates</p><li><p>Type …. More</p></ul><p>The types are expected to increase over time as features are iterated.</p><h3 id="question"><span class="me-2">Question</span><a href="#question" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Without any architectural design, the code might look like this:</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">tableView</span><span class="p">(</span><span class="n">_</span> <span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="p">,</span> <span class="n">cellForRowAt</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">IndexPath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UITableViewCell</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">row</span> <span class="o">=</span> <span class="n">datas</span><span class="p">[</span><span class="n">indexPath</span><span class="o">.</span><span class="n">row</span><span class="p">]</span>
    <span class="k">switch</span> <span class="n">row</span><span class="o">.</span><span class="n">type</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">.</span><span class="nv">invitation</span><span class="p">:</span>
        <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCell</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="s">"invitation"</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="n">indexPath</span><span class="p">)</span> <span class="k">as!</span> <span class="kt">InvitationCell</span>
        <span class="c1">// config cell with viewObject/viewModel...</span>
        <span class="k">return</span> <span class="n">cell</span>
    <span class="k">case</span> <span class="o">.</span><span class="nv">newSong</span><span class="p">:</span>
        <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCell</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="s">"newSong"</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="n">indexPath</span><span class="p">)</span> <span class="k">as!</span> <span class="kt">NewSongCell</span>
        <span class="c1">// config cell with viewObject/viewModel...</span>
        <span class="k">return</span> <span class="n">cell</span>
    <span class="k">case</span> <span class="o">.</span><span class="nv">newEvent</span><span class="p">:</span>
        <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCell</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="s">"newEvent"</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="n">indexPath</span><span class="p">)</span> <span class="k">as!</span> <span class="kt">NewEventCell</span>
        <span class="c1">// config cell with viewObject/viewModel...</span>
        <span class="k">return</span> <span class="n">cell</span>
    <span class="k">case</span> <span class="o">.</span><span class="nv">newText</span><span class="p">:</span>
        <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCell</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="s">"newText"</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="n">indexPath</span><span class="p">)</span> <span class="k">as!</span> <span class="kt">NewTextCell</span>
        <span class="c1">// config cell with viewObject/viewModel...</span>
        <span class="k">return</span> <span class="n">cell</span>
    <span class="k">case</span> <span class="o">.</span><span class="nv">newPhotos</span><span class="p">:</span>
        <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCell</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="s">"newPhotos"</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="n">indexPath</span><span class="p">)</span> <span class="k">as!</span> <span class="kt">NewPhotosCell</span>
        <span class="c1">// config cell with viewObject/viewModel...</span>
        <span class="k">return</span> <span class="n">cell</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">tableView</span><span class="p">(</span><span class="n">_</span> <span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="p">,</span> <span class="n">heightForRowAt</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">IndexPath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">CGFloat</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">row</span> <span class="o">=</span> <span class="n">datas</span><span class="p">[</span><span class="n">indexPath</span><span class="o">.</span><span class="n">row</span><span class="p">]</span>
    <span class="k">switch</span> <span class="n">row</span><span class="o">.</span><span class="n">type</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">.</span><span class="nv">invitation</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">{</span>
            <span class="k">return</span> <span class="mi">100</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="mi">300</span>
        <span class="p">}</span>
    <span class="k">case</span> <span class="o">.</span><span class="nv">newSong</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">100</span>
    <span class="k">case</span> <span class="o">.</span><span class="nv">newEvent</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">200</span>
    <span class="k">case</span> <span class="o">.</span><span class="nv">newText</span><span class="p">:</span>
        <span class="k">return</span> <span class="kt">UITableView</span><span class="o">.</span><span class="n">automaticDimension</span>
    <span class="k">case</span> <span class="o">.</span><span class="nv">newPhotos</span><span class="p">:</span>
        <span class="k">return</span> <span class="kt">UITableView</span><span class="o">.</span><span class="n">automaticDimension</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><ul><li><p>Hard to Test: It is difficult to test which Type corresponds to which logical output</p><li><p>Difficult to scale and maintain: Whenever a new Type needs to be added, this ViewController must be modified; cellForRow, heightForRow, willDisplay… are scattered across different functions, making it easy to forget or make mistakes when updating.</p><li><p>Hard to read: All logic is placed in the View</p></ul><h3 id="visitor-pattern-solution"><span class="me-2">Visitor Pattern Solution</span><a href="#visitor-pattern-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="why"><span class="me-2">Why?</span><a href="#why" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Here is the organized object relationship, as shown in the diagram below:</p><p><a href="/assets/60473cb47550/1*f4tscbmMV9LkRCtz9G8WRQ.webp" class="popup img-link blur"><img data-src="/assets/60473cb47550/1*f4tscbmMV9LkRCtz9G8WRQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTgzIiBoZWlnaHQ9Ijg0NSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>We have many types of DataSources (ViewObjects) that need to interact with various types of operators. This is a typical example of <a href="https://refactoringguru.cn/design-patterns/visitor-double-dispatch" target="_blank">Visitor Double Dispatch</a>.</p><h4 id="how"><span class="me-2">How?</span><a href="#how" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>To simplify the demo code, the design now uses <code class="language-plaintext highlighter-rouge">PlainTextFeedViewObject</code> for plain text feeds, <code class="language-plaintext highlighter-rouge">MemoriesFeedViewObject</code> for daily memories, and <code class="language-plaintext highlighter-rouge">MediaFeedViewObject</code> for image feeds.</p><h4 id="the-architecture-diagram-applying-the-visitor-pattern-is-as-follows"><span class="me-2"><strong>The architecture diagram applying the Visitor Pattern is as follows:</strong></span><a href="#the-architecture-diagram-applying-the-visitor-pattern-is-as-follows" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/60473cb47550/1*vFXx4MBtMsDO2ppIUQZgJA.webp" class="popup img-link blur"><img data-src="/assets/60473cb47550/1*vFXx4MBtMsDO2ppIUQZgJA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTUwIiBoZWlnaHQ9Ijc3OSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><h4 id="first-define-the-visitor-interface-this-interface-abstracts-the-types-of-datasource-that-the-operator-can-accept"><span class="me-2"><strong>First, define the Visitor interface. This interface abstracts the types of DataSource that the operator can accept:</strong></span><a href="#first-define-the-visitor-interface-this-interface-abstracts-the-types-of-datasource-that-the-operator-can-accept" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kd">protocol</span> <span class="kt">FeedVisitor</span> <span class="p">{</span>
    <span class="kd">associatedtype</span> <span class="kt">T</span>
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="n">_</span> <span class="nv">viewObject</span><span class="p">:</span> <span class="kt">PlainTextFeedViewObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">T</span><span class="p">?</span>
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="n">_</span> <span class="nv">viewObject</span><span class="p">:</span> <span class="kt">MediaFeedViewObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">T</span><span class="p">?</span>
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="n">_</span> <span class="nv">viewObject</span><span class="p">:</span> <span class="kt">MemoriesFeedViewObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">T</span><span class="p">?</span>
    <span class="c1">//...</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Each operator implements the <code class="language-plaintext highlighter-rouge">FeedVisitor</code> interface:</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="kd">struct</span> <span class="kt">FeedCellVisitor</span><span class="p">:</span> <span class="kt">FeedVisitor</span> <span class="p">{</span>
    <span class="kd">typealias</span> <span class="kt">T</span> <span class="o">=</span> <span class="kt">UITableViewCell</span><span class="o">.</span><span class="k">Type</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="n">_</span> <span class="nv">viewObject</span><span class="p">:</span> <span class="kt">MediaFeedViewObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">T</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kt">MediaFeedTableViewCell</span><span class="o">.</span><span class="k">self</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="n">_</span> <span class="nv">viewObject</span><span class="p">:</span> <span class="kt">MemoriesFeedViewObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">T</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kt">MemoriesFeedTableViewCell</span><span class="o">.</span><span class="k">self</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="n">_</span> <span class="nv">viewObject</span><span class="p">:</span> <span class="kt">PlainTextFeedViewObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">T</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kt">PlainTextFeedTableViewCell</span><span class="o">.</span><span class="k">self</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Implement ViewObject &lt;-&gt; UITableViewCell mapping.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="kd">struct</span> <span class="kt">FeedCellHeightVisitor</span><span class="p">:</span> <span class="kt">FeedVisitor</span> <span class="p">{</span>
    <span class="kd">typealias</span> <span class="kt">T</span> <span class="o">=</span> <span class="kt">CGFloat</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="n">_</span> <span class="nv">viewObject</span><span class="p">:</span> <span class="kt">MediaFeedViewObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">T</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">30</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="n">_</span> <span class="nv">viewObject</span><span class="p">:</span> <span class="kt">MemoriesFeedViewObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">T</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">10</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="n">_</span> <span class="nv">viewObject</span><span class="p">:</span> <span class="kt">PlainTextFeedViewObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">T</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">10</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Implement ViewObject &lt;-&gt; UITableViewCell Height Mapping.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="kd">struct</span> <span class="kt">FeedCellConfiguratorVisitor</span><span class="p">:</span> <span class="kt">FeedVisitor</span> <span class="p">{</span>
    
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">cell</span><span class="p">:</span> <span class="kt">UITableViewCell</span>
    
    <span class="nf">init</span><span class="p">(</span><span class="nv">cell</span><span class="p">:</span> <span class="kt">UITableViewCell</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">cell</span> <span class="o">=</span> <span class="n">cell</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="n">_</span> <span class="nv">viewObject</span><span class="p">:</span> <span class="kt">MediaFeedViewObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Any</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">cell</span> <span class="k">as?</span> <span class="kt">MediaFeedTableViewCell</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">nil</span> <span class="p">}</span>
        <span class="c1">// cell.config(viewObject)</span>
        <span class="k">return</span> <span class="kc">nil</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="n">_</span> <span class="nv">viewObject</span><span class="p">:</span> <span class="kt">MemoriesFeedViewObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Any</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">cell</span> <span class="k">as?</span> <span class="kt">MediaFeedTableViewCell</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">nil</span> <span class="p">}</span>
        <span class="c1">// cell.config(viewObject)</span>
        <span class="k">return</span> <span class="kc">nil</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="n">_</span> <span class="nv">viewObject</span><span class="p">:</span> <span class="kt">PlainTextFeedViewObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Any</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">cell</span> <span class="k">as?</span> <span class="kt">MediaFeedTableViewCell</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">nil</span> <span class="p">}</span>
        <span class="c1">// cell.config(viewObject)</span>
        <span class="k">return</span> <span class="kc">nil</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>How to Configure the Mapping Between ViewObject &lt;-&gt; Cell.</p><p>When support for a new DataSource (ViewObject) is needed, simply add an additional method to the FeedVisitor interface and implement the corresponding logic in each operator.</p><p><strong>Binding DataSource (ViewObject) with Operators:</strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">protocol</span> <span class="kt">FeedViewObject</span> <span class="p">{</span>
    <span class="kd">@discardableResult</span> <span class="kd">func</span> <span class="n">accept</span><span class="o">&lt;</span><span class="kt">V</span><span class="p">:</span> <span class="kt">FeedVisitor</span><span class="o">&gt;</span><span class="p">(</span><span class="nv">visitor</span><span class="p">:</span> <span class="kt">V</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">V</span><span class="o">.</span><span class="kt">T</span><span class="p">?</span>
<span class="p">}</span>
</pre></table></code></div></div><h4 id="interface-for-viewobject-binding-implementation"><span class="me-2"><strong>Interface for ViewObject Binding Implementation:</strong></span><a href="#interface-for-viewobject-binding-implementation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>struct PlainTextFeedViewObject: FeedViewObject {
    func accept&lt;V&gt;(visitor: V) -&gt; V.T? where V : FeedVisitor {
        return visitor.visit(self)
    }
}
struct MemoriesFeedViewObject: FeedViewObject {
    func accept&lt;V&gt;(visitor: V) -&gt; V.T? where V : FeedVisitor {
        return visitor.visit(self)
    }
}
</pre></table></code></div></div><h4 id="implementation-in-uitableview"><span class="me-2"><strong>Implementation in UITableView:</strong></span><a href="#implementation-in-uitableview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
</pre><td class="rouge-code"><pre><span class="kd">final</span> <span class="kd">class</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>

    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="o">!</span>
    
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">cellVisitor</span> <span class="o">=</span> <span class="kt">FeedCellVisitor</span><span class="p">()</span>
    
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">viewObjects</span><span class="p">:</span> <span class="p">[</span><span class="kt">FeedViewObject</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span>
            <span class="n">viewObjects</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span> <span class="n">viewObject</span> <span class="k">in</span>
                <span class="k">let</span> <span class="nv">cellName</span> <span class="o">=</span> <span class="n">viewObject</span><span class="o">.</span><span class="nf">accept</span><span class="p">(</span><span class="nv">visitor</span><span class="p">:</span> <span class="n">cellVisitor</span><span class="p">)</span>
                <span class="n">tableView</span><span class="o">.</span><span class="nf">register</span><span class="p">(</span><span class="n">cellName</span><span class="p">,</span> <span class="nv">forCellReuseIdentifier</span><span class="p">:</span> <span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="n">cellName</span><span class="p">))</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>
        
        <span class="n">tableView</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>
        <span class="n">tableView</span><span class="o">.</span><span class="n">dataSource</span> <span class="o">=</span> <span class="k">self</span>
        
        <span class="n">viewObjects</span> <span class="o">=</span> <span class="p">[</span>
            <span class="kt">MemoriesFeedViewObject</span><span class="p">(),</span>
            <span class="kt">MediaFeedViewObject</span><span class="p">(),</span>
            <span class="kt">PlainTextFeedViewObject</span><span class="p">(),</span>
            <span class="kt">MediaFeedViewObject</span><span class="p">(),</span>
            <span class="kt">PlainTextFeedViewObject</span><span class="p">(),</span>
            <span class="kt">MediaFeedViewObject</span><span class="p">(),</span>
            <span class="kt">PlainTextFeedViewObject</span><span class="p">()</span>
        <span class="p">]</span>
        <span class="c1">// Do any additional setup after loading the view.</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">UITableViewDataSource</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">numberOfSections</span><span class="p">(</span><span class="k">in</span> <span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">tableView</span><span class="p">(</span><span class="n">_</span> <span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="p">,</span> <span class="n">numberOfRowsInSection</span> <span class="nv">section</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">viewObjects</span><span class="o">.</span><span class="n">count</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">tableView</span><span class="p">(</span><span class="n">_</span> <span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="p">,</span> <span class="n">cellForRowAt</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">IndexPath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UITableViewCell</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">viewObject</span> <span class="o">=</span> <span class="n">viewObjects</span><span class="p">[</span><span class="n">indexPath</span><span class="o">.</span><span class="n">row</span><span class="p">]</span>
        <span class="k">let</span> <span class="nv">cellName</span> <span class="o">=</span> <span class="n">viewObject</span><span class="o">.</span><span class="nf">accept</span><span class="p">(</span><span class="nv">visitor</span><span class="p">:</span> <span class="n">cellVisitor</span><span class="p">)</span>
        
        <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCell</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="n">cellName</span><span class="p">),</span> <span class="nv">for</span><span class="p">:</span> <span class="n">indexPath</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">cellConfiguratorVisitor</span> <span class="o">=</span> <span class="kt">FeedCellConfiguratorVisitor</span><span class="p">(</span><span class="nv">cell</span><span class="p">:</span> <span class="n">cell</span><span class="p">)</span>
        <span class="n">viewObject</span><span class="o">.</span><span class="nf">accept</span><span class="p">(</span><span class="nv">visitor</span><span class="p">:</span> <span class="n">cellConfiguratorVisitor</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cell</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">UITableViewDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">tableView</span><span class="p">(</span><span class="n">_</span> <span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="p">,</span> <span class="n">heightForRowAt</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">IndexPath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">CGFloat</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">viewObject</span> <span class="o">=</span> <span class="n">viewObjects</span><span class="p">[</span><span class="n">indexPath</span><span class="o">.</span><span class="n">row</span><span class="p">]</span>
        <span class="k">let</span> <span class="nv">cellHeightVisitor</span> <span class="o">=</span> <span class="kt">FeedCellHeightVisitor</span><span class="p">()</span>
        <span class="k">let</span> <span class="nv">cellHeight</span> <span class="o">=</span> <span class="n">viewObject</span><span class="o">.</span><span class="nf">accept</span><span class="p">(</span><span class="nv">visitor</span><span class="p">:</span> <span class="n">cellHeightVisitor</span><span class="p">)</span> <span class="p">??</span> <span class="kt">UITableView</span><span class="o">.</span><span class="n">automaticDimension</span>
        <span class="k">return</span> <span class="n">cellHeight</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="results"><span class="me-2">Results</span><a href="#results" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p>Test: Complies with the Single Responsibility Principle, allowing testing of each data point for every operator separately</p><li><p>Extension and Maintenance: When support for a new DataSource (ViewObject) is required, just add a method to the Visitor protocol and implement it in the corresponding Visitor classes. When adding a new operator, simply create a new class to implement it.</p><li><p>Reading: Browsing through each activity object clearly shows the composition logic of the various Views on the entire page</p></ul><h3 id="complete-project"><span class="me-2">Complete Project</span><a href="#complete-project" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="https://github.com/zhgchgli0718/VisitorPatternInTableView" target="_blank" class="img-link shimmer" ><img src="https://opengraph.githubassets.com/968c942531151fa399342c0b0edb304fd0bfb066a8519b2e2d490978c894e196/zhgchgli0718/VisitorPatternInTableView" alt="" loading="lazy"></a></p><h4 id="murmur"><span class="me-2">Murmur…</span><a href="#murmur" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>2022/07 Article written during a mental low period. Please kindly forgive any inadequate descriptions or errors!</p><h3 id="further-reading"><span class="me-2">Further Reading</span><a href="#further-reading" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p>Practical Application Record of Design Patterns — In WKWebView with Builder, Strategy &amp; Chain of Responsibility Pattern</p><li><p><a href="/posts/pinkoi-engineering/en/design-patterns-practical-solutions-for-socket-io-client-library-challenges-78507a8de6a5/">Practical Application Records of Design Patterns</a></p><li><p><a href="/posts/zrealm-dev/en/visitor-pattern-in-ios-swift-design-pattern-practical-applications-ba5773a7bfea/">Visitor Pattern in Swift (Share Object to XXX Example)</a></p></ul><p>If you have any questions or feedback, feel free to <a href="https://www.zhgchg.li/contact" target="_blank">contact me</a>.</p><hr /><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=🍺&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a><br /></p><blockquote class="prompt-info"><p>This post was originally published on Medium (<a href="https://medium.com/p/60473cb47550" target="_blank"><strong>View original post</strong></a>), and automatically converted and synced by <a href="/posts/tools/medium-to-jekyll/" target="_blank">ZMediumToMarkdown</a>.</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/en/zmediumtomarkdown/2022-07-08-60473cb47550.md" target="_blank">Improve this page on Github.</a></p></blockquote><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1K+ Followers</span></a></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-dev/">ZRealm Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/english/" class="post-tag no-text-decoration" >english</a> <a href="/tags/ai-translation/" class="post-tag no-text-decoration" >ai-translation</a> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/design-patterns/" class="post-tag no-text-decoration" >design-patterns</a> <a href="/tags/visitor-pattern/" class="post-tag no-text-decoration" >visitor-pattern</a> <a href="/tags/uitableview/" class="post-tag no-text-decoration" >uitableview</a> <a href="/tags/refactoring/" class="post-tag no-text-decoration" >refactoring</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Visitor%20Pattern%EF%BD%9CEnhance%20TableView%20Readability%20and%20Extensibility%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fen%2Fvisitor-pattern-enhance-tableview-readability-and-extensibility-60473cb47550%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Visitor%20Pattern%EF%BD%9CEnhance%20TableView%20Readability%20and%20Extensibility%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fen%2Fvisitor-pattern-enhance-tableview-readability-and-extensibility-60473cb47550%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fen%2Fvisitor-pattern-enhance-tableview-readability-and-extensibility-60473cb47550%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/en/line-bank-to-firstrade-transfer-fast-deposit-150-nt-fee-guide-with-account-upgrade-fee-subsidy-e4d139fe0685/">LINE Bank to Firstrade Transfer｜Fast Deposit & 150 NT Fee Guide with Account Upgrade & Fee Subsidy</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/zh-cn/line-bank-%E5%85%A5%E9%87%91-firstrade-%E6%95%99%E5%AD%A6-%E5%BF%AB%E9%80%9F%E5%88%B0%E5%B8%90-%E4%BD%8E%E6%89%8B%E7%BB%AD%E8%B4%B9150%E5%85%83-%E5%B8%90%E6%88%B7%E5%8D%87%E7%BA%A7%E4%B8%8E%E6%89%8B%E7%BB%AD%E8%B4%B9%E8%A1%A5%E5%8A%A9%E7%94%B3%E8%AF%B7%E5%85%A8%E6%94%BB%E7%95%A5-e4d139fe0685/">手把手教学 — LINE Bank 入金 Firstrade 快速到帐、手续费只要 150 元及帐户升级/约定转帐/手续费补助申请教学</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/line-bank-%E5%85%A5%E9%87%91-firstrade-%E6%95%99%E5%AD%B8-%E5%BF%AB%E9%80%9F%E5%88%B0%E5%B8%B3-%E4%BD%8E%E6%89%8B%E7%BA%8C%E8%B2%BB150%E5%85%83-%E5%B8%B3%E6%88%B6%E5%8D%87%E7%B4%9A%E8%88%87%E6%89%8B%E7%BA%8C%E8%B2%BB%E8%A3%9C%E5%8A%A9%E7%94%B3%E8%AB%8B%E5%85%A8%E6%94%BB%E7%95%A5-e4d139fe0685/">手把手教學 — LINE Bank 入金 Firstrade 快速到帳、手續費只要 150 元及帳戶升級/約定轉帳/手續費補助申請教學</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-robotic-process-automation/en/ios-shortcut-automation-auto-forward-sms-create-reminder-tasks-effortlessly-309d0302877b/">iOS Shortcut Automation｜Auto-Forward SMS & Create Reminder Tasks Effortlessly</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-robotic-process-automation/zh-cn/ios-%E6%8D%B7%E5%BE%84%E8%87%AA%E5%8A%A8%E5%8C%96-3-%E6%8B%9B%E8%87%AA%E5%8A%A8%E8%BD%AC%E5%8F%91%E7%AE%80%E8%AE%AF%E4%B8%8E%E5%BB%BA%E7%AB%8B%E6%8F%90%E9%86%92%E5%BE%85%E5%8A%9E%E4%BA%8B%E9%A1%B9%E6%95%99%E5%AD%A6-309d0302877b/">iOS 捷径自动化应用场景 — 自动转发简讯与自动建立提醒待办事项</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">章節 (Chapters)🔖</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-dev/visitor-pattern-%E6%8F%90%E5%8D%87-tableview-%E5%8F%AF%E6%93%B4%E5%85%85%E6%80%A7%E8%88%87%E5%8F%AF%E7%B6%AD%E8%AD%B7%E6%80%A7%E8%A8%AD%E8%A8%88%E7%AF%84%E4%BE%8B-60473cb47550/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1657267110" data-df="ll" > Jul 8, 2022 </time><h4 class="pt-0 my-2">Visitor Pattern in TableView</h4><div class="text-muted"><p>使用 Visitor Pattern 增加 TableView 的閱讀和擴充性</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/zh-cn/visitor-pattern-%E6%8F%90%E5%8D%87-tableview-%E5%8F%AF%E6%89%A9%E5%85%85%E6%80%A7%E4%B8%8E%E5%8F%AF%E7%BB%B4%E6%8A%A4%E6%80%A7%E8%AE%BE%E8%AE%A1%E8%8C%83%E4%BE%8B-60473cb47550/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1657267110" data-df="ll" > Jul 8, 2022 </time><h4 class="pt-0 my-2">Visitor Pattern in TableView</h4><div class="text-muted"><p>使用 Visitor Pattern 增加 TableView 的阅读和扩充性</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/en/visitor-pattern-in-ios-swift-design-pattern-practical-applications-ba5773a7bfea/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1623772716" data-df="ll" > Jun 15, 2021 </time><h4 class="pt-0 my-2">Visitor Pattern in iOS｜Swift Design Pattern Practical Applications</h4><div class="text-muted"><p>Explore how the Visitor Pattern solves complex object structure traversal in iOS Swift development, enhancing code maintainability and scalability with clear, real-world use cases and implementatio...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-dev/ios-nsattributedstring-html-render-%E8%87%AA%E8%A1%8C%E5%AF%A6%E7%8F%BE-%E8%A7%A3%E6%B1%BA%E9%96%83%E9%80%80%E8%88%87%E6%95%88%E8%83%BD%E7%93%B6%E9%A0%B8-a8c2d26cc734/" class="btn btn-outline-primary" aria-label="Older" ><p>iOS NSAttributedString HTML Render 自行實現｜解決閃退與效能瓶頸</p></a> <a href="/posts/zrealm-dev/zh-cn/visitor-pattern-%E6%8F%90%E5%8D%87-tableview-%E5%8F%AF%E6%89%A9%E5%85%85%E6%80%A7%E4%B8%8E%E5%8F%AF%E7%BB%B4%E6%8A%A4%E6%80%A7%E8%AE%BE%E8%AE%A1%E8%8C%83%E4%BE%8B-60473cb47550/" class="btn btn-outline-primary" aria-label="Newer" ><p>Visitor Pattern in TableView</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span> <a href="/">中文</a>|<a href="/tags/simplified-chinese">简中</a>|<a href="/tags/english/">English</a></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a> <br/></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
