<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="ZMarkupParser｜Convert HTML String to NSAttributedString with Custom Style Keys" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="Developers facing challenges in converting HTML strings to NSAttributedString can utilize ZMarkupParser to apply precise style key mappings, ensuring accurate and customizable text rendering in iOS applications." /><meta property="og:description" content="Developers facing challenges in converting HTML strings to NSAttributedString can utilize ZMarkupParser to apply precise style key mappings, ensuring accurate and customizable text rendering in iOS applications." /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-dev/en/zmarkupparser-convert-html-string-to-nsattributedstring-with-custom-style-keys-a5643de271e4/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-dev/en/zmarkupparser-convert-html-string-to-nsattributedstring-with-custom-style-keys-a5643de271e4/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/a5643de271e4/1*A0yXupXW9-F9ZWe4gp2ObA.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-02-26T17:03:07+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/a5643de271e4/1*A0yXupXW9-F9ZWe4gp2ObA.webp" /><meta property="twitter:title" content="ZMarkupParser｜Convert HTML String to NSAttributedString with Custom Style Keys" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://medium.com/@zhgchgli/"},"dateModified":"2023-08-06T00:16:21+08:00","datePublished":"2023-02-26T17:03:07+08:00","description":"Developers facing challenges in converting HTML strings to NSAttributedString can utilize ZMarkupParser to apply precise style key mappings, ensuring accurate and customizable text rendering in iOS applications.","headline":"ZMarkupParser｜Convert HTML String to NSAttributedString with Custom Style Keys","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjgwIiBoZWlnaHQ9IjY0MCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg==","url":"https://zhgchg.li/assets/a5643de271e4/1*A0yXupXW9-F9ZWe4gp2ObA.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-dev/en/zmarkupparser-convert-html-string-to-nsattributedstring-with-custom-style-keys-a5643de271e4/"},"url":"https://zhgchg.li/posts/zrealm-dev/en/zmarkupparser-convert-html-string-to-nsattributedstring-with-custom-style-keys-a5643de271e4/"}</script><title>ZMarkupParser｜Convert HTML String to NSAttributedString with Custom Style Keys | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0"> <a href="https://medium.com/@zhgchgli" target="_blank" style="display: block;text-align: center;font-style: normal;/* text-decoration: underline; */font-size: 1.2em;color: var(--heading-color);">1K+ Followers on Medium</a> An iOS, web, and automation developer from Taiwan 🇹🇼 who also loves sharing, traveling, and writing.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/english/" class="nav-link"> <i class="fa-fw fa fa-globe"></i> <span>=ENGLISH POSTS=</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>ZMarkupParser｜Convert HTML String to NSAttributedString with Custom Style Keys</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>ZMarkupParser｜Convert HTML String to NSAttributedString with Custom Style Keys</h1><p class="post-desc fw-light mb-4">Developers facing challenges in converting HTML strings to NSAttributedString can utilize ZMarkupParser to apply precise style key mappings, ensuring accurate and customizable text rendering in iOS applications.</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1677402187" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Feb 26, 2023 </time> </span> <span> Updated <time data-ts="1691252181" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Aug 5, 2023 </time> </span><div class="mt-3 mb-3"> <a href="/assets/a5643de271e4/1*A0yXupXW9-F9ZWe4gp2ObA.webp" class="popup img-link preview-img blur"><img data-src="/assets/a5643de271e4/1*A0yXupXW9-F9ZWe4gp2ObA.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjgwIiBoZWlnaHQ9IjY0MCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://medium.com/@zhgchgli/">ZhgChgLi</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1069 words" > <em>5 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">ZMarkupParser｜Convert HTML String to NSAttributedString with Custom Style Keys</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">章節 (Chapters)🔖</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">ZMarkupParser｜Convert HTML String to NSAttributedString with Custom Style Keys</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic> <script async="" src="https://widgetic.com/sdk/sdk.js"></script><blockquote class="prompt-info"><p>The following content is translated by OpenAI, <a href="/posts/a5643de271e4/"><strong>Click here</strong></a> to view the original Chinese version. <a href="/posts/a5643de271e4/"><strong>點此查看中文版</strong></a></p></blockquote><blockquote class="prompt-tip"><p>For SEO purposes, the title and description of this article have been adjusted by GPT. Please refer to the main content for the original version, and feel free to point out any inappropriate wording.</p></blockquote><hr /><h3 id="zmarkupparser-html-string-to-nsattributedstring-converter-tool"><span class="me-2">ZMarkupParser HTML String to NSAttributedString Converter Tool</span><a href="#zmarkupparser-html-string-to-nsattributedstring-converter-tool" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Convert HTML String to NSAttributedString with Corresponding Key Style Settings</p><h4 id="zhgchgli--zmarkupparser"><span class="me-2"><a href="https://github.com/ZhgChgLi" target="_blank">ZhgChgLi</a> / <a href="https://github.com/ZhgChgLi/ZMarkupParser" target="_blank">ZMarkupParser</a></span><a href="#zhgchgli--zmarkupparser" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/a5643de271e4/1*A0yXupXW9-F9ZWe4gp2ObA.webp" class="popup img-link blur"><img data-src="/assets/a5643de271e4/1*A0yXupXW9-F9ZWe4gp2ObA.webp" alt="[ZhgChgLi](https://github.com/ZhgChgLi){:target=&quot;_blank&quot;} [ZMarkupParser](https://github.com/ZhgChgLi/ZMarkupParser){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjgwIiBoZWlnaHQ9IjY0MCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="https://github.com/ZhgChgLi" target="_blank">ZhgChgLi</a> / <a href="https://github.com/ZhgChgLi/ZMarkupParser" target="_blank">ZMarkupParser</a></p><p><a href="https://github.com/ZhgChgLi/ZMarkupParser" target="_blank" class="img-link shimmer" ><img src="https://repository-images.githubusercontent.com/602927147/57ce75c1-8548-449c-b44a-f4b0451ed5ea" alt="" loading="lazy"></a></p><h4 id="features"><span class="me-2">Features</span><a href="#features" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><p>Developed purely in Swift, it uses Regex to parse HTML tags and tokenize them. It analyzes and corrects tag accuracy (fixing tags without an end and misaligned tags), then converts them into an abstract syntax tree. Finally, it uses the Visitor Pattern to map HTML tags to abstract styles, producing the final NSAttributedString result. No parser libraries are used.</p><li><p>Supports HTML Render (to NSAttributedString) / Stripper (removes HTML tags) / Selector functions</p><li><p>Automatic Analysis and Correction of Tag Accuracy (Fix Missing End Tags &amp; Misplaced Tags)<br /> <code class="language-plaintext highlighter-rouge">&lt;br&gt;</code> -&gt; <code class="language-plaintext highlighter-rouge">&lt;br/&gt;</code><br /> <code class="language-plaintext highlighter-rouge">&lt;b&gt;Bold&lt;i&gt;Bold+Italic&lt;/b&gt;Italic&lt;/i&gt;</code> -&gt; <code class="language-plaintext highlighter-rouge">&lt;b&gt;Bold&lt;i&gt;Bold+Italic&lt;/i&gt;&lt;/b&gt;&lt;i&gt;Italic&lt;/i&gt;</code><br /> <code class="language-plaintext highlighter-rouge">&lt;Congratulation!&gt;</code> -&gt; <code class="language-plaintext highlighter-rouge">&lt;Congratulation!&gt;</code> (treat as String)</p><li><p>Support custom style specification<br /> e.g. <code class="language-plaintext highlighter-rouge">&lt;b&gt;&lt;/b&gt;</code> -&gt; <code class="language-plaintext highlighter-rouge">weight: .semibold &amp; underline: 1</code></p><li><p>Support custom HTML tag parsing<br /> e.g. Parse <code class="language-plaintext highlighter-rouge">&lt;zhgchgli&gt;&lt;/zhgchgli&gt;</code> into the desired style</p><li><p>Includes architecture design to facilitate expansion of HTML Tag support<br /> Currently supports basic styles as well as ul/ol/li lists and hr divider rendering. Future expansions will allow quick support for other HTML Tags.</p><li><p>Support extending style parsing from the <code class="language-plaintext highlighter-rouge">style</code> HTML Attribute<br /> HTML allows text styles to be specified via the style attribute. Similarly, this package also supports styles defined in the <code class="language-plaintext highlighter-rouge">style</code> attribute.<br /> e.g. <code class="language-plaintext highlighter-rouge">&lt;b style=”font-size: 20px”&gt;&lt;/b&gt;</code> -&gt; <code class="language-plaintext highlighter-rouge">bold + font size 20 px</code></p><li><p>Support iOS/macOS</p><li><p>Support HTML Color Name to UIColor/NSColor</p><li><p>Test Coverage: 80%+</p><li><p>Supports parsing of <code class="language-plaintext highlighter-rouge">&lt;img&gt;</code> images, <code class="language-plaintext highlighter-rouge">&lt;ul&gt;</code> item lists, <code class="language-plaintext highlighter-rouge">&lt;table&gt;</code> tables, and other HTML tags.</p><li><p>Higher Performance than <code class="language-plaintext highlighter-rouge">NSAttributedString.DocumentType.html</code></p></ul><h4 id="performance-analysis"><span class="me-2">Performance Analysis</span><a href="#performance-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/a5643de271e4/1*UPkmp2XsUjlVe_TmOur_3A.webp" class="popup img-link blur"><img data-src="/assets/a5643de271e4/1*UPkmp2XsUjlVe_TmOur_3A.webp" alt="[Performance Benchmark](https://quickchart.io/chart-maker/view/zm-73887470-e667-4ca3-8df0-fe3563832b0b){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMzc4IiBoZWlnaHQ9IjY4OSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="https://quickchart.io/chart-maker/view/zm-73887470-e667-4ca3-8df0-fe3563832b0b" target="_blank">Performance Benchmark</a></p><ul><li><p>Test Environment: 2022/M2/24GB Memory/macOS 13.2/XCode 14.1</p><li><p>X Axis: Number of HTML Characters</p><li><p>Y-axis: Rendering Time (seconds)</p></ul><p>*Additionally, <code class="language-plaintext highlighter-rouge">NSAttributedString.DocumentType.html</code> will crash (EXC_BAD_ACCESS) with strings longer than 54,600+ characters.</p><h4 id="try-it-out"><span class="me-2">Try it out</span><a href="#try-it-out" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/a5643de271e4/1*PzYcnSkW7qKeJBkaiNTKjQ.gif" class="popup img-link blur"><img data-src="/assets/a5643de271e4/1*PzYcnSkW7qKeJBkaiNTKjQ.gif" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyOTUiIGhlaWdodD0iNjQwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>You can directly download the project, open <code class="language-plaintext highlighter-rouge">ZMarkupParser.xcworkspace</code>, select the <code class="language-plaintext highlighter-rouge">ZMarkupParser-Demo</code> target, then build and run to test the functionality.</p><h4 id="installation"><span class="me-2">Installation</span><a href="#installation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Supports SPM/Cocoapods, please refer to <a href="https://github.com/ZhgChgLi/ZMarkupParser#installation" target="_blank">Readme</a>.</p><h3 id="how-to-use"><span class="me-2">How to Use</span><a href="#how-to-use" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="style-declaration"><span class="me-2">Style Declaration</span><a href="#style-declaration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>MarkupStyle/MarkupStyleColor/MarkupStyleParagraphStyle are wrappers for NSAttributedString.Key.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="k">var</span> <span class="nv">font</span><span class="p">:</span><span class="kt">MarkupStyleFont</span>
<span class="k">var</span> <span class="nv">paragraphStyle</span><span class="p">:</span><span class="kt">MarkupStyleParagraphStyle</span>
<span class="k">var</span> <span class="nv">foregroundColor</span><span class="p">:</span><span class="kt">MarkupStyleColor</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">backgroundColor</span><span class="p">:</span><span class="kt">MarkupStyleColor</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">ligature</span><span class="p">:</span><span class="kt">NSNumber</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">kern</span><span class="p">:</span><span class="kt">NSNumber</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">tracking</span><span class="p">:</span><span class="kt">NSNumber</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">strikethroughStyle</span><span class="p">:</span><span class="kt">NSUnderlineStyle</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">underlineStyle</span><span class="p">:</span><span class="kt">NSUnderlineStyle</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">strokeColor</span><span class="p">:</span><span class="kt">MarkupStyleColor</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">strokeWidth</span><span class="p">:</span><span class="kt">NSNumber</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">shadow</span><span class="p">:</span><span class="kt">NSShadow</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">textEffect</span><span class="p">:</span><span class="kt">String</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">attachment</span><span class="p">:</span><span class="kt">NSTextAttachment</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">link</span><span class="p">:</span><span class="kt">URL</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">baselineOffset</span><span class="p">:</span><span class="kt">NSNumber</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">underlineColor</span><span class="p">:</span><span class="kt">MarkupStyleColor</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">strikethroughColor</span><span class="p">:</span><span class="kt">MarkupStyleColor</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">obliqueness</span><span class="p">:</span><span class="kt">NSNumber</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">expansion</span><span class="p">:</span><span class="kt">NSNumber</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">writingDirection</span><span class="p">:</span><span class="kt">NSNumber</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">verticalGlyphForm</span><span class="p">:</span><span class="kt">NSNumber</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="o">...</span>
</pre></table></code></div></div><p>You can declare styles according to the HTML tags you want to apply them to:</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">myStyle</span> <span class="o">=</span> <span class="kt">MarkupStyle</span><span class="p">(</span><span class="nv">font</span><span class="p">:</span> <span class="kt">MarkupStyleFont</span><span class="p">(</span><span class="nv">size</span><span class="p">:</span> <span class="mi">13</span><span class="p">),</span> <span class="nv">backgroundColor</span><span class="p">:</span> <span class="kt">MarkupStyleColor</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="o">.</span><span class="n">aquamarine</span><span class="p">))</span>
</pre></table></code></div></div><h4 id="html-tag"><span class="me-2">HTML Tag</span><a href="#html-tag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Declare the HTML tags to render and their corresponding markup styles. The currently predefined HTML tag names are as follows:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>A_HTMLTagName(), // &lt;a&gt;&lt;/a&gt;
B_HTMLTagName(), // &lt;b&gt;&lt;/b&gt;
BR_HTMLTagName(), // &lt;br&gt;&lt;/br&gt;
DIV_HTMLTagName(), // &lt;div&gt;&lt;/div&gt;
HR_HTMLTagName(), // &lt;hr&gt;&lt;/hr&gt;
I_HTMLTagName(), // &lt;i&gt;&lt;/i&gt;
LI_HTMLTagName(), // &lt;li&gt;&lt;/li&gt;
OL_HTMLTagName(), // &lt;ol&gt;&lt;/ol&gt;
P_HTMLTagName(), // &lt;p&gt;&lt;/p&gt;
SPAN_HTMLTagName(), // &lt;span&gt;&lt;/span&gt;
STRONG_HTMLTagName(), // &lt;strong&gt;&lt;/strong&gt;
U_HTMLTagName(), // &lt;u&gt;&lt;/u&gt;
UL_HTMLTagName(), // &lt;ul&gt;&lt;/ul&gt;
DEL_HTMLTagName(), // &lt;del&gt;&lt;/del&gt;
IMG_HTMLTagName(handler: ZNSTextAttachmentHandler), // &lt;img&gt; and image downloader
TR_HTMLTagName(), // &lt;tr&gt;
TD_HTMLTagName(), // &lt;td&gt;
TH_HTMLTagName(), // &lt;th&gt;
...and more
...
</pre></table></code></div></div><p>This way, when parsing the <code class="language-plaintext highlighter-rouge">&lt;a&gt;</code> tag, the specified MarkupStyle will be applied.</p><p>Extend HTMLTagName:</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">zhgchgli</span> <span class="o">=</span> <span class="kt">ExtendTagName</span><span class="p">(</span><span class="s">"zhgchgli"</span><span class="p">)</span>
</pre></table></code></div></div><h4 id="html-style-attribute"><span class="me-2">HTML Style Attribute</span><a href="#html-style-attribute" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>As mentioned earlier, HTML supports specifying styles via the Style Attribute. Here, we also abstract the supported styles and extensions. The currently predefined HTML Style Attributes are as follows:</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kt">ColorHTMLTagStyleAttribute</span><span class="p">(),</span> <span class="c1">// color</span>
<span class="kt">BackgroundColorHTMLTagStyleAttribute</span><span class="p">(),</span> <span class="c1">// background-color</span>
<span class="kt">FontSizeHTMLTagStyleAttribute</span><span class="p">(),</span> <span class="c1">// font-size</span>
<span class="kt">FontWeightHTMLTagStyleAttribute</span><span class="p">(),</span> <span class="c1">// font-weight</span>
<span class="kt">LineHeightHTMLTagStyleAttribute</span><span class="p">(),</span> <span class="c1">// line-height</span>
<span class="kt">WordSpacingHTMLTagStyleAttribute</span><span class="p">(),</span> <span class="c1">// word-spacing</span>
<span class="o">...</span>
</pre></table></code></div></div><p>Extend Style Attribute:</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="kt">ExtendHTMLTagStyleAttribute</span><span class="p">(</span><span class="nv">styleName</span><span class="p">:</span> <span class="s">"text-decoration"</span><span class="p">,</span> <span class="nv">render</span><span class="p">:</span> <span class="p">{</span> <span class="n">value</span> <span class="k">in</span>
  <span class="k">var</span> <span class="nv">newStyle</span> <span class="o">=</span> <span class="kt">MarkupStyle</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s">"underline"</span> <span class="p">{</span>
    <span class="n">newStyle</span><span class="o">.</span><span class="n">underline</span> <span class="o">=</span> <span class="kt">NSUnderlineStyle</span><span class="o">.</span><span class="n">single</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// ...  </span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">newStyle</span>
<span class="p">})</span>
</pre></table></code></div></div><h3 id="usage"><span class="me-2">Usage</span><a href="#usage" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">import</span> <span class="kt">ZMarkupParser</span>

<span class="k">let</span> <span class="nv">parser</span> <span class="o">=</span> <span class="kt">ZHTMLParserBuilder</span><span class="o">.</span><span class="nf">initWithDefault</span><span class="p">()</span><span class="o">.</span><span class="nf">set</span><span class="p">(</span><span class="nv">rootStyle</span><span class="p">:</span> <span class="kt">MarkupStyle</span><span class="p">(</span><span class="nv">font</span><span class="p">:</span> <span class="kt">MarkupStyleFont</span><span class="p">(</span><span class="nv">size</span><span class="p">:</span> <span class="mi">13</span><span class="p">)))</span><span class="o">.</span><span class="nf">build</span><span class="p">()</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">initWithDefault</code> automatically adds predefined HTML Tag Names, default corresponding MarkupStyles, and predefined Style Attributes.</p><p><code class="language-plaintext highlighter-rouge">set(rootStyle:)</code> can set the default style for the entire string, or it can be left unspecified.</p><h4 id="customization"><span class="me-2">Customization</span><a href="#customization" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">parser</span> <span class="o">=</span> <span class="kt">ZHTMLParserBuilder</span><span class="o">.</span><span class="nf">initWithDefault</span><span class="p">()</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="kt">ExtendTagName</span><span class="p">(</span><span class="s">"zhgchgli"</span><span class="p">),</span> <span class="nv">withCustomStyle</span><span class="p">:</span> <span class="kt">MarkupStyle</span><span class="p">(</span><span class="nv">backgroundColor</span><span class="p">:</span> <span class="kt">MarkupStyleColor</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="o">.</span><span class="n">aquamarine</span><span class="p">)))</span><span class="o">.</span><span class="nf">build</span><span class="p">()</span> <span class="c1">// will use the markup style you specify to render the extended HTML tag &lt;zhgchgli&gt;&lt;/zhgchgli&gt;</span>
<span class="k">let</span> <span class="nv">parser</span> <span class="o">=</span> <span class="kt">ZHTMLParserBuilder</span><span class="o">.</span><span class="nf">initWithDefault</span><span class="p">()</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="kt">B_HTMLTagName</span><span class="p">(),</span> <span class="nv">withCustomStyle</span><span class="p">:</span> <span class="kt">MarkupStyle</span><span class="p">(</span><span class="nv">font</span><span class="p">:</span> <span class="kt">MarkupStyleFont</span><span class="p">(</span><span class="nv">size</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="nv">weight</span><span class="p">:</span> <span class="o">.</span><span class="nf">style</span><span class="p">(</span><span class="o">.</span><span class="n">semibold</span><span class="p">))))</span><span class="o">.</span><span class="nf">build</span><span class="p">()</span> <span class="c1">// will use the markup style you specify to render &lt;b&gt;&lt;/b&gt; instead of the default bold markup style</span>
</pre></table></code></div></div><h4 id="html-render"><span class="me-2">HTML Render</span><a href="#html-render" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">attributedString</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="nf">render</span><span class="p">(</span><span class="n">htmlString</span><span class="p">)</span> <span class="c1">// NSAttributedString</span>

<span class="c1">// work with UITextView</span>
<span class="n">textView</span><span class="o">.</span><span class="nf">setHtmlString</span><span class="p">(</span><span class="n">htmlString</span><span class="p">)</span>
<span class="c1">// work with UILabel</span>
<span class="n">label</span><span class="o">.</span><span class="nf">setHtmlString</span><span class="p">(</span><span class="n">htmlString</span><span class="p">)</span>
</pre></table></code></div></div><h4 id="html-stripper"><span class="me-2">HTML Stripper</span><a href="#html-stripper" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">parser</span><span class="o">.</span><span class="nf">stripper</span><span class="p">(</span><span class="n">htmlString</span><span class="p">)</span>
</pre></table></code></div></div><h4 id="selector-html-string"><span class="me-2">Selector HTML String</span><a href="#selector-html-string" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">selector</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="nf">selector</span><span class="p">(</span><span class="n">htmlString</span><span class="p">)</span> <span class="c1">// HTMLSelector e.g. input: &lt;a&gt;&lt;b&gt;Test&lt;/b&gt;Link&lt;/a&gt;</span>
<span class="n">selector</span><span class="o">.</span><span class="nf">first</span><span class="p">(</span><span class="s">"a"</span><span class="p">)?</span><span class="o">.</span><span class="nf">first</span><span class="p">(</span><span class="s">"b"</span><span class="p">)</span><span class="o">.</span><span class="n">attributedString</span> <span class="c1">// will return Test</span>
<span class="n">selector</span><span class="o">.</span><span class="nf">filter</span><span class="p">(</span><span class="s">"a"</span><span class="p">)</span><span class="o">.</span><span class="n">attributedString</span> <span class="c1">// will return Test Link</span>

<span class="c1">// render from selector result</span>
<span class="k">let</span> <span class="nv">selector</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="nf">selector</span><span class="p">(</span><span class="n">htmlString</span><span class="p">)</span> <span class="c1">// HTMLSelector e.g. input: &lt;a&gt;&lt;b&gt;Test&lt;/b&gt;Link&lt;/a&gt;</span>
<span class="n">parser</span><span class="o">.</span><span class="nf">render</span><span class="p">(</span><span class="n">selector</span><span class="o">.</span><span class="nf">first</span><span class="p">(</span><span class="s">"a"</span><span class="p">)?</span><span class="o">.</span><span class="nf">first</span><span class="p">(</span><span class="s">"b"</span><span class="p">))</span>
</pre></table></code></div></div><h4 id="async"><span class="me-2">Async</span><a href="#async" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Additionally, if rendering long strings, you can use async methods to prevent UI blocking.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">parser</span><span class="o">.</span><span class="nf">render</span><span class="p">(</span><span class="kt">String</span><span class="p">)</span> <span class="p">{</span> <span class="n">_</span> <span class="k">in</span> <span class="p">}</span><span class="o">...</span>
<span class="n">parser</span><span class="o">.</span><span class="nf">stripper</span><span class="p">(</span><span class="kt">String</span><span class="p">)</span> <span class="p">{</span> <span class="n">_</span> <span class="k">in</span> <span class="p">}</span><span class="o">...</span>
<span class="n">parser</span><span class="o">.</span><span class="nf">selector</span><span class="p">(</span><span class="kt">String</span><span class="p">)</span> <span class="p">{</span> <span class="n">_</span> <span class="k">in</span> <span class="p">}</span><span class="o">...</span>
</pre></table></code></div></div><h3 id="know-how"><span class="me-2">Know-how</span><a href="#know-how" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p>The hyperlink style in UITextView depends on linkTextAttributes, so there may be cases where NSAttributedString.Key is set but has no visible effect.</p><li><p>UILabel does not support specifying URL styles, so NSAttributedString.key may be set but have no visible effect.</p><li><p>If you need to render complex HTML, you still need to use WKWebView (including JS/tables rendering).</p></ul><h4 id="technical-principles-and-development-story-the-story-of-manually-building-an-html-parser"><span class="me-2">Technical Principles and Development Story: “<a href="/posts/zrealm-dev/en/html-parsing-techniques-build-custom-parsers-for-nsattributedstring-rendering-2724f02f6e7/">The Story of Manually Building an HTML Parser</a>”</span><a href="#technical-principles-and-development-story-the-story-of-manually-building-an-html-parser" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><h3 id="welcome-contributions-and-issue-reporting-for-prompt-fixes"><span class="me-2">Welcome Contributions and Issue Reporting for Prompt Fixes</span><a href="#welcome-contributions-and-issue-reporting-for-prompt-fixes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="https://github.com/ZhgChgLi/ZMarkupParser" target="_blank" class="img-link shimmer" ><img src="https://repository-images.githubusercontent.com/602927147/57ce75c1-8548-449c-b44a-f4b0451ed5ea" alt="" loading="lazy"></a></p><p>If you have any questions or feedback, feel free to <a href="https://www.zhgchg.li/contact" target="_blank">contact me</a>.</p><p><em><a href="https://medium.com/zrealm-ios-dev/zmarkupparser-html-string-%E8%BD%89%E6%8F%9B-nsattributedstring-%E5%B7%A5%E5%85%B7-a5643de271e4" target="_blank">Post</a> converted from Medium by <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown</a>.</em></p><hr /><blockquote class="prompt-info"><p>This article was first published on Medium ➡️ <a href="https://medium.com/p/a5643de271e4" target="_blank"><strong>Click Here</strong></a>, automatically converted and synchronized using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown</a> and <a href="https://github.com/ZhgChgLi/medium-to-jekyll-starter.github.io" target="_blank">Medium-to-jekyll-starter</a>.</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/en/zmediumtomarkdown/2023-02-26-a5643de271e4.md" target="_blank">Improve this page on Github.</a></p></blockquote><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=🍺&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a></p><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic> <script async="" src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); border-bottom: 1px solid var(--main-border-color);transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1K+ Followers</span></a></div><div style="font-size: 0.8em; cursor:default; text-align: right;"> 804 <span style="font-size: 0.9em;">Total Views</span><br /> <span style="font-size: 0.8em;">Last Statistics Date: 2025-08-20 | 721 Views on <a href="https://medium.com/p/a5643de271e4" target="_blank">Medium.</a></span></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-dev/">ZRealm Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/english/" class="post-tag no-text-decoration" >english</a> <a href="/tags/html-parser/" class="post-tag no-text-decoration" >html parser</a> <a href="/tags/nsattributedstring/" class="post-tag no-text-decoration" >nsattributedstring</a> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios app development</a> <a href="/tags/html/" class="post-tag no-text-decoration" >html</a> <a href="/tags/markdown/" class="post-tag no-text-decoration" >markdown</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=ZMarkupParser%EF%BD%9CConvert%20HTML%20String%20to%20NSAttributedString%20with%20Custom%20Style%20Keys%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fen%2Fzmarkupparser-convert-html-string-to-nsattributedstring-with-custom-style-keys-a5643de271e4%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=ZMarkupParser%EF%BD%9CConvert%20HTML%20String%20to%20NSAttributedString%20with%20Custom%20Style%20Keys%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fen%2Fzmarkupparser-convert-html-string-to-nsattributedstring-with-custom-style-keys-a5643de271e4%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fen%2Fzmarkupparser-convert-html-string-to-nsattributedstring-with-custom-style-keys-a5643de271e4%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/en/apple-watch-stainless-steel-milanese-loop-unboxing-premium-44mm-graphite-band-review-c0f99f987d9c/">Apple Watch Stainless Steel Milanese Loop Unboxing｜Premium 44mm Graphite Band Review</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/apple-watch-%E7%B1%B3%E8%98%AD%E9%8C%B6%E5%B8%B6%E9%96%8B%E7%AE%B1-%E5%8E%9F%E5%BB%A0%E4%B8%8D%E9%8F%BD%E9%8B%BC%E7%9F%B3%E5%A2%A8%E8%89%B2%E5%84%AA%E7%BC%BA%E9%BB%9E%E5%85%A8%E8%A7%A3%E6%9E%90-c0f99f987d9c/">Apple Watch 原廠不鏽鋼米蘭錶帶開箱</a><li class="text-truncate lh-lg"> <a href="/posts/travel-journals/en/busan-travel-guide-8-day-itinerary-with-visit-busan-pass-for-seamless-exploration-8ace34a1a3d8/">Busan Travel Guide｜8-Day Itinerary with VISIT BUSAN PASS for Seamless Exploration</a><li class="text-truncate lh-lg"> <a href="/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/%E9%87%9C%E5%B1%B1%E8%87%AA%E7%94%B1%E8%A1%8C%E6%94%BB%E7%95%A5-8%E5%A4%A97%E5%A4%9C%E5%BF%85%E5%8E%BB%E6%99%AF%E9%BB%9E-%E7%BE%8E%E9%A3%9F%E8%88%87%E4%BA%A4%E9%80%9A%E5%85%A8%E8%A7%A3%E6%9E%90-%E9%87%9C%E5%B1%B1%E9%80%9A%E8%A1%8C%E8%AD%89%E7%9C%81%E9%8C%A2%E7%A7%98%E8%A8%A3-8ace34a1a3d8/">遊記 2025 韓國釜山 8 天 7 夜自由行</a><li class="text-truncate lh-lg"> <a href="/posts/travel-journals/en/nagoya-one-day-quick-trip-peach-aviation-flight-experience-and-travel-tips-7b8a0563c157/">Nagoya One-Day Quick Trip｜Peach Aviation Flight Experience and Travel Tips</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">iOS App Development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">iOS</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios app development</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">Swift</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">章節 (Chapters)🔖</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-dev/en/zmediumtojekyll-seamlessly-migrate-and-sync-medium-posts-to-jekyll-blogs-e7c547a5be22/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1679078827" data-df="ll" > Mar 18, 2023 </time><h4 class="pt-0 my-2">ZMediumToJekyll｜Seamlessly Migrate and Sync Medium Posts to Jekyll Blogs</h4><div class="text-muted"><p>Effortlessly transfer your Medium articles to a Jekyll blog while maintaining future synchronization, solving content migration and update challenges for bloggers and developers.</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/zmarkupparser-swift-html-string-%E8%BD%89-nsattributedstring-%E5%B7%A5%E5%85%B7-%E6%94%AF%E6%8F%B4%E5%AE%A2%E8%A3%BD%E6%A8%A3%E5%BC%8F%E8%88%87%E9%AB%98%E6%95%88%E8%83%BD%E6%B8%B2%E6%9F%93-a5643de271e4/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1677402187" data-df="ll" > Feb 26, 2023 </time><h4 class="pt-0 my-2">ZMarkupParser HTML String 轉換 NSAttributedString 工具</h4><div class="text-muted"><p>轉換 HTML String 成 NSAttributedString 對應 Key 樣式設定</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/ios-nsattributedstring-html-render-%E8%87%AA%E8%A1%8C%E5%AF%A6%E7%8F%BE-%E8%A7%A3%E6%B1%BA%E9%96%83%E9%80%80%E8%88%87%E6%95%88%E8%83%BD%E7%93%B6%E9%A0%B8-a8c2d26cc734/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1654791119" data-df="ll" > Jun 10, 2022 </time><h4 class="pt-0 my-2">iOS NSAttributedString HTML Render 自行實現｜解決閃退與效能瓶頸</h4><div class="text-muted"><p>針對 iOS NSAttributedString HTML 解析閃退與效能差問題，提供純 Swift XMLParser 自行實現 HTML Render 技術，避免主線程阻塞，提升渲染速度達 5~20 倍，並支援自訂標籤樣式與擴充，確保穩定且可維護的文字渲染體驗。</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-life/google-%E5%87%BA%E7%8F%BE%E8%88%87%E6%9C%AC%E4%BA%BA%E6%9D%8E%E4%BB%B2%E6%BE%84%E7%84%A1%E9%97%9C%E4%B9%8B%E6%90%9C%E5%B0%8B%E7%B5%90%E6%9E%9C%E8%81%B2%E6%98%8E-declaration-for-google-search-result/" class="btn btn-outline-primary" aria-label="Older" ><p>Google 出現與本人李仲澄無關之搜尋結果聲明</p></a> <a href="/posts/zrealm-dev/zmarkupparser-swift-html-string-%E8%BD%89-nsattributedstring-%E5%B7%A5%E5%85%B7-%E6%94%AF%E6%8F%B4%E5%AE%A2%E8%A3%BD%E6%A8%A3%E5%BC%8F%E8%88%87%E9%AB%98%E6%95%88%E8%83%BD%E6%B8%B2%E6%9F%93-a5643de271e4/" class="btn btn-outline-primary" aria-label="Newer" ><p>ZMarkupParser HTML String 轉換 NSAttributedString 工具</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a><br/>Last updated: 2025-08-21 01:18:26 +08:00</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">iOS App Development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">iOS</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios app development</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">Swift</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
