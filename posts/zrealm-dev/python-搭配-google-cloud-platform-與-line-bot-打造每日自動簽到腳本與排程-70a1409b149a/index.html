<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Python 搭配 Google Cloud Platform 與 Line Bot｜打造每日自動簽到腳本與排程" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="透過 Python 結合 Google Cloud Function、Cloud Scheduler 及 Line Bot，自動完成每日簽到任務並即時通知，解決手動操作繁瑣問題，提升工作效率並節省時間成本。" /><meta property="og:description" content="透過 Python 結合 Google Cloud Function、Cloud Scheduler 及 Line Bot，自動完成每日簽到任務並即時通知，解決手動操作繁瑣問題，提升工作效率並節省時間成本。" /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-dev/python-%E6%90%AD%E9%85%8D-google-cloud-platform-%E8%88%87-line-bot-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E8%87%AA%E5%8B%95%E7%B0%BD%E5%88%B0%E8%85%B3%E6%9C%AC%E8%88%87%E6%8E%92%E7%A8%8B-70a1409b149a/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-dev/python-%E6%90%AD%E9%85%8D-google-cloud-platform-%E8%88%87-line-bot-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E8%87%AA%E5%8B%95%E7%B0%BD%E5%88%B0%E8%85%B3%E6%9C%AC%E8%88%87%E6%8E%92%E7%A8%8B-70a1409b149a/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/70a1409b149a/1*dFvxm6SynzYOmMEUALKJaA.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-02-20T19:55:51+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/70a1409b149a/1*dFvxm6SynzYOmMEUALKJaA.webp" /><meta property="twitter:title" content="Python 搭配 Google Cloud Platform 與 Line Bot｜打造每日自動簽到腳本與排程" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://medium.com/@zhgchgli/"},"dateModified":"2024-04-13T16:57:38+08:00","datePublished":"2021-02-20T19:55:51+08:00","description":"透過 Python 結合 Google Cloud Function、Cloud Scheduler 及 Line Bot，自動完成每日簽到任務並即時通知，解決手動操作繁瑣問題，提升工作效率並節省時間成本。","headline":"Python 搭配 Google Cloud Platform 與 Line Bot｜打造每日自動簽到腳本與排程","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+","url":"https://zhgchg.li/assets/70a1409b149a/1*dFvxm6SynzYOmMEUALKJaA.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-dev/python-%E6%90%AD%E9%85%8D-google-cloud-platform-%E8%88%87-line-bot-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E8%87%AA%E5%8B%95%E7%B0%BD%E5%88%B0%E8%85%B3%E6%9C%AC%E8%88%87%E6%8E%92%E7%A8%8B-70a1409b149a/"},"url":"https://zhgchg.li/posts/zrealm-dev/python-%E6%90%AD%E9%85%8D-google-cloud-platform-%E8%88%87-line-bot-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E8%87%AA%E5%8B%95%E7%B0%BD%E5%88%B0%E8%85%B3%E6%9C%AC%E8%88%87%E6%8E%92%E7%A8%8B-70a1409b149a/"}</script><title>Python 搭配 Google Cloud Platform 與 Line Bot｜打造每日自動簽到腳本與排程 | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script><link rel="alternate" hreflang="en" href="/posts/zrealm-dev/en/automate-routine-tasks-with-python-google-cloud-platform-line-bot-daily-check-in-script-example-70a1409b149a/"><link rel="alternate" hreflang="zh-Hans" href="/posts/zrealm-dev/zh-cn/python-%E6%90%AD%E9%85%8D-google-cloud-platform-%E4%B8%8E-line-bot-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E8%87%AA%E5%8A%A8%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%E4%B8%8E%E6%8E%92%E7%A8%8B-70a1409b149a/"><link rel="alternate" hreflang="zh-Hant" href="/posts/zrealm-dev/python-%E6%90%AD%E9%85%8D-google-cloud-platform-%E8%88%87-line-bot-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E8%87%AA%E5%8B%95%E7%B0%BD%E5%88%B0%E8%85%B3%E6%9C%AC%E8%88%87%E6%8E%92%E7%A8%8B-70a1409b149a/"><link rel="alternate" hreflang="x-default" href="/posts/zrealm-dev/python-%E6%90%AD%E9%85%8D-google-cloud-platform-%E8%88%87-line-bot-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E8%87%AA%E5%8B%95%E7%B0%BD%E5%88%B0%E8%85%B3%E6%9C%AC%E8%88%87%E6%8E%92%E7%A8%8B-70a1409b149a/"> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"FAQPage","mainEntity":[{"@type":"Question","name":"如何利用 Python 與 Google Cloud 平台打造每日自動簽到腳本並即時接收通知？","acceptedAnswer":{"@type":"Answer","text":"透過 Proxyman 嗅探 APP API，撰寫 Python 模擬簽到請求，將腳本部署到 Google Cloud Functions 並設定 Cloud Scheduler 定時觸發，最後串接 Line Bot 發送執行結果通知，實現每日自動簽到且即時收到狀態回報。"}},{"@type":"Question","name":"如何在 Google Cloud Functions 中安全管理與動態更新簽到所需的 Token？","acceptedAnswer":{"@type":"Answer","text":"可利用 Google Cloud Functions 的環境變數存放靜態 Token，若需動態讀寫則結合 Firebase Cloud Firestore 作為可讀寫的資料庫，透過服務帳戶認證安全存取並更新 Token，避免硬編碼且方便維護。"}},{"@type":"Question","name":"在將 Python 腳本部署到 Google Cloud Functions 時，如何處理第三方套件依賴問題？","acceptedAnswer":{"@type":"Answer","text":"將所需套件名稱與版本寫入 requirements.txt（如 requests、firebase-admin），部署時 Cloud Functions 會自動安裝，確保腳本執行環境完整且無缺套件錯誤。"}},{"@type":"Question","name":"如何設定 Google Cloud Scheduler 讓自動簽到腳本定時執行並確保觸發成功？","acceptedAnswer":{"@type":"Answer","text":"在 Cloud Scheduler 設定符合 crontab 語法的排程（例如每日凌晨1:15），指定 HTTP 觸發網址為 Cloud Functions 的觸發 URL，選擇適當時區與驗證設定，並可透過立即執行功能測試，確保排程能準時觸發腳本。"}},{"@type":"Question","name":"如何避免因自動化腳本執行量過大而造成 Google Cloud 與 Line Bot 費用暴增？","acceptedAnswer":{"@type":"Answer","text":"利用 Google Cloud 與 Line Bot 的免費額度管理日常執行量，並在 Google Cloud 主控台設定預算與快訊，當費用達到設定門檻時即時收到通知，避免無預警的費用暴增。"}}]} </script><link rel="stylesheet" href="/assets/css/post-toc.css"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0">An iOS, web, and automation developer from Taiwan 🇹🇼 who also loves sharing, traveling, and writing.</p><a href="https://medium.com/@zhgchgli" target="_blank" style="display: block;text-align: center;font-style: normal;/* text-decoration: underline; */font-size: 1.2em;color: var(--heading-color);">1K+ Followers on Medium</a></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/english/" class="nav-link"> <i class="fa-fw fa fa-solid fa-language"></i> <span>ENGLISH POSTS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Python 搭配 Google Cloud Platform 與 Line Bot｜打造每日自動簽到腳本與排程</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Python 搭配 Google Cloud Platform 與 Line Bot｜打造每日自動簽到腳本與排程</h1><p class="post-desc fw-light mb-4">透過 Python 結合 Google Cloud Function、Cloud Scheduler 及 Line Bot，自動完成每日簽到任務並即時通知，解決手動操作繁瑣問題，提升工作效率並節省時間成本。</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1613822151" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Feb 20, 2021 </time> </span> <span> Updated <time data-ts="1712998658" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 13, 2024 </time> </span><div class="mt-3 mb-3"> <a href="/assets/70a1409b149a/1*dFvxm6SynzYOmMEUALKJaA.webp" class="popup img-link preview-img blur"><img data-src="/assets/70a1409b149a/1*dFvxm6SynzYOmMEUALKJaA.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></div><div class="d-flex justify-content-between"> <span style="display: inline-flex; align-items: center; gap: 4px;"> By <em> <a href="https://medium.com/@zhgchgli/">ZhgChgLi</a> </em> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" style="display: block; "><path fill="#007bff" d="M271.2 56C265.1 49.8 256.2 47.3 247.8 49.6C239.4 51.9 232.9 58.4 230.8 66.8L215.5 127C214.4 131.4 209.9 134 205.6 132.7L145.8 115.9C137.4 113.5 128.4 115.9 122.3 122C116.2 128.1 113.8 137.1 116.2 145.5L133.1 205.3C134.3 209.6 131.7 214.1 127.4 215.2L67.1 230.5C58.7 232.6 52.1 239.2 49.8 247.6C47.5 256 50 264.9 56.2 271L100.7 314.3C103.9 317.4 103.9 322.6 100.7 325.8L56.3 369.1C50.1 375.2 47.6 384.1 49.9 392.5C52.2 400.9 58.8 407.4 67.2 409.6L127.4 424.9C131.8 426 134.4 430.5 133.1 434.8L116.2 494.5C113.8 502.9 116.2 511.9 122.3 518C128.4 524.1 137.4 526.5 145.8 524.1L205.6 507.2C209.9 506 214.4 508.6 215.5 512.9L230.8 573.1C232.9 581.5 239.5 588.1 247.9 590.4C256.3 592.7 265.2 590.2 271.3 584L314.6 539.5C317.7 536.3 322.9 536.3 326.1 539.5L369.3 584C375.4 590.2 384.3 592.7 392.7 590.4C401.1 588.1 407.6 581.5 409.8 573.1L425.1 513C426.2 508.6 430.7 506 435 507.3L494.8 524.2C503.2 526.6 512.2 524.2 518.3 518.1C524.4 512 526.8 503 524.4 494.6L507.5 434.8C506.3 430.5 508.9 426 513.2 424.9L573.4 409.6C581.8 407.5 588.4 400.9 590.7 392.5C593 384.1 590.5 375.1 584.3 369.1L539.8 325.8C536.6 322.7 536.6 317.5 539.8 314.3L584.3 271C590.5 264.9 593 256 590.7 247.6C588.4 239.2 581.8 232.7 573.4 230.5L513.2 215.2C508.8 214.1 506.2 209.6 507.5 205.3L524.4 145.5C526.8 137.1 524.4 128.1 518.3 122C512.2 115.9 503.2 113.5 494.8 115.9L435 132.8C430.7 134 426.2 131.4 425.1 127.1L409.8 66.8C407.7 58.4 401.1 51.8 392.7 49.5C384.3 47.2 375.4 49.7 369.3 55.9L326 100.5C322.9 103.7 317.7 103.7 314.5 100.5L271.2 56z"/><path d="M250 330 l60 60 100 -140" stroke="#ffffff" stroke-width="40" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="4561 words" > <em>25 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Python 搭配 Google Cloud Platform 與 Line Bot｜打造每日自動簽到腳本與排程</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">章節 (Chapters)🔖</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Python 搭配 Google Cloud Platform 與 Line Bot｜打造每日自動簽到腳本與排程</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/en/automate-routine-tasks-with-python-google-cloud-platform-line-bot-daily-check-in-script-example-70a1409b149a/"><strong>Click here</strong></a> to view the English version of this article.</p></blockquote><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/zh-cn/python-%E6%90%AD%E9%85%8D-google-cloud-platform-%E4%B8%8E-line-bot-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E8%87%AA%E5%8A%A8%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%E4%B8%8E%E6%8E%92%E7%A8%8B-70a1409b149a/"><strong>点击这里</strong></a>查看本文章简体中文版本。</p></blockquote><blockquote class="prompt-info"><p>基於 SEO 考量，本文標題與描述經 AI 調整，原始版本請參考內文。</p></blockquote><h4 id="zhgchgli-table-of-contents">文章目錄</h4><nav class="zhgchgli-toc"><ul class="zhgchgli-toc-list"><li><a href="#使用-pythongoogle-cloud-platformline-bot-自動執行例行瑣事">使用 Python+Google Cloud Platform+Line Bot 自動執行例行瑣事</a></li><li><a href="#起源">起源</a></li><li class="has-children"><details><summary>目標 <a href="#目標">#</a></summary><ul><li><a href="#本篇章節順序">本篇章節順序</a></li><li><a href="#使用到的工具">使用到的工具</a></li></ul></details></li><li class="has-children"><details><summary>1.使用 Proxyman 進行 Man in the middle attack API 嗅探 <a href="#1使用-proxyman-進行-man-in-the-middle-attack-api-嗅探">#</a></summary><ul><li><a href="#這邊假設我們得到的資訊如下">這邊假設我們得到的資訊如下</a></li></ul></details></li><li class="has-children"><details><summary>2. 撰寫 Python 腳本，偽造 APP API 請求（模擬簽到動作） <a href="#2-撰寫-python-腳本偽造-app-api-請求模擬簽到動作">#</a></summary><ul><li><a href="#加上執行結果-linebot-通知">加上執行結果 Linebot 通知</a></li></ul></details></li><li class="has-children"><details><summary>3. 將 Python 腳本搬到 Google Cloud 上 <a href="#3-將-python-腳本搬到-google-cloud-上">#</a></summary><ul><li><a href="#補充關於變數部分">補充關於變數部分</a></li></ul></details></li><li><a href="#4-在-google-cloud-設定自動排程">4. 在 Google Cloud 設定自動排程</a></li><li><a href="#大功告成">大功告成！</a></li><li class="has-children"><details><summary>計價方式 <a href="#計價方式">#</a></summary><ul><li><a href="#linebot">Linebot</a></li><li><a href="#google-cloud-functions">Google Cloud Functions</a></li><li><a href="#google-firebase-cloud-firestore">Google Firebase Cloud Firestore</a></li><li><a href="#google-cloud-scheduler">Google Cloud Scheduler</a></li><li><a href="#google-cloud-storage-有條件免費">Google Cloud Storage 有條件免費</a></li><li><a href="#計價預算控制通知">計價預算控制通知</a></li></ul></details></li><li><a href="#總結">總結</a></li><li><a href="#延伸閱讀">延伸閱讀</a></li></ul></nav><hr /><h3 id="使用-pythongoogle-cloud-platformline-bot-自動執行例行瑣事"><span class="me-2">使用 Python+Google Cloud Platform+Line Bot 自動執行例行瑣事</span><a href="#使用-pythongoogle-cloud-platformline-bot-自動執行例行瑣事" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>以簽到獎勵 APP 為例，打造每日自動簽到腳本</p><p><a href="/assets/70a1409b149a/1*dFvxm6SynzYOmMEUALKJaA.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*dFvxm6SynzYOmMEUALKJaA.webp" alt="Photo by [Paweł Czerwiński](https://unsplash.com/@pawel_czerwinski?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjkzMyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Photo by <a href="https://unsplash.com/@pawel_czerwinski?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank">Paweł Czerwiński</a></p><h3 id="起源"><span class="me-2">起源</span><a href="#起源" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>一直以來都有使用 Python 做小工具的習慣；有做正經的，工作上自動爬數據、產報表，也有不正經的，排程自動查想要的資訊或是交給腳本完成本來要手動執行的動作。</p><p>一直以來「自動」這件事，我都很粗暴直接開一台電腦掛著 Python 腳本讓他掛著跑；優點是簡單方便，缺點是要有台設備接著網路接著電；就算是樹莓派也是要消耗著微量的電費網路錢，還有也不能遠端控制啟動或關閉（其實可以，但很麻煩）；這次趁著工作空擋，研究了一下免費&amp;上雲端的方法。</p><h3 id="目標"><span class="me-2">目標</span><a href="#目標" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote><p>將 Python 腳本搬到雲端執行、定時自動執行、可透過網路開啟/關閉。</p></blockquote><blockquote><p><em>本篇以我耍的小聰明，針對簽到獎勵型 APP 撰寫的自動完成簽到的腳本為例，能每日自動幫我簽到，我不用在特別打開 APP 使用；並在執行完成後發通知給我。</em></p></blockquote><p><a href="/assets/70a1409b149a/1*14yKaOt2YNSMILOD_EoXLg.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*14yKaOt2YNSMILOD_EoXLg.webp" alt="完成通知！" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NTAiIGhlaWdodD0iNDUyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>完成通知！</p><h4 id="本篇章節順序"><span class="me-2">本篇章節順序</span><a href="#本篇章節順序" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li>使用 Proxyman 進行 Man in the middle attack API 嗅探<li>撰寫 Python 腳本，偽造 APP API 請求（模擬簽到動作）<li>將 Python 腳本搬到 Google Cloud 上<li>在 Google Cloud 設定自動排程</ol><ul><li>因涉及到敏感領域本篇不會告知是哪個簽到獎勵型 APP，大家可以延伸自行使用<li><strong>如果只想了解 Python 怎麼串自動執行可跳過前半段 Man in the middle attack API 嗅探部分，從第 3 章看起</strong> 。</ul><h4 id="使用到的工具"><span class="me-2">使用到的工具</span><a href="#使用到的工具" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><strong>Proxyman</strong> ：Man in the middle attack API 嗅探<li><strong>Python</strong> ：撰寫腳本<li><strong>Linebot</strong> ：發送腳本執行結果通知給自己<li><strong>Google Cloud Function</strong> ：Python 腳本寄存服務<li><strong>Google Cloud Scheduler</strong> ：自動排程服務</ul><h3 id="1使用-proxyman-進行-man-in-the-middle-attack-api-嗅探"><span class="me-2">1.使用 Proxyman 進行 Man in the middle attack API 嗅探</span><a href="#1使用-proxyman-進行-man-in-the-middle-attack-api-嗅探" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>之前有發過一篇「 <a href="/posts/zrealm-dev/app-https%E5%82%B3%E8%BC%B8%E4%BB%8D%E9%81%AD%E7%AB%8A%E5%8F%96-mitmproxy%E4%B8%AD%E9%96%93%E4%BA%BA%E6%94%BB%E6%93%8A%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8%E8%88%87%E9%98%B2%E7%AF%84%E6%8A%80%E5%B7%A7-46410aaada00/">APP有用HTTPS傳輸，但資料還是被偷了。</a> 」的文章，道理類似，不過這次改用 Proxyman 取代 mitmproxy；同樣免費，但更好用。</p><ul><li>到官網 <a href="https://proxyman.io/" target="_blank">https://proxyman.io/</a> 下載 Proxyman 工具<li>下載完後啟動 Proxyman，安裝 Root 憑證（為了做 Man in the middle attack 解包 https 流量內容）</ul><p><a href="/assets/70a1409b149a/1*jb-FAN5h1oFVFFvu1bpYgw.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*jb-FAN5h1oFVFFvu1bpYgw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MTIiIGhlaWdodD0iNDQyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>「Certificate 」-&gt;「 Install Certificate On this Mac」-&gt;「Installed &amp; Trusted」</p><p><strong>電腦的 Root 憑證裝好後換手機的：</strong></p><p>「Certificate 」-&gt;「 Install Certificate On iOS」-&gt;「Physical Devices…」</p><p><a href="/assets/70a1409b149a/1*DBi9YVmfoaPH9WSCoPXycA.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*DBi9YVmfoaPH9WSCoPXycA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NzIiIGhlaWdodD0iMTEwNyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>依照指示在手機上掛好 Proxy 並完成憑證安裝及啟用。</p><ul><li>在手機上打開想要嗅探 API 傳輸內容的 APP</ul><p><a href="/assets/70a1409b149a/1*q2wbmQ3MJ6nYfjFSBHL9fw.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*q2wbmQ3MJ6nYfjFSBHL9fw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjU0OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>這時候 Mac 上的 Proxyman 就會出現嗅探到的流量，點擊裝置 IP 下想要查看的 APP API 網域；第一次查看需要先點「Enable only this domain」之後的流量才能被解包出來。</p><p><strong>「Enable only this domain」後就能看到新攔截的流量就會出現原始的 Request、Response 資訊：</strong></p><p><a href="/assets/70a1409b149a/1*dIp1k-0u-BhJ7iTs0wEIuA.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*dIp1k-0u-BhJ7iTs0wEIuA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9Ijg4MCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><blockquote><p><em>我們使用此方法嗅探 APP 上操作簽到時打了哪隻 API EndPoint 及帶了哪些資料，將這些資訊記錄下來，等下使用 Python 直接模擬請求。</em></p></blockquote><blockquote><p><em>⚠️要注意有的 APP token 資訊可能會換，導致日後 Python 模擬請求失效，還要多了解 APP token 交換的方式。</em></p></blockquote><blockquote><p><em>⚠️如果確定 Proxyman 有正常運作，但在掛 Proxyman 的情況下 APP 無法發出請求，代表 APP 可能有做 SSL Pining；目前無解，只能放棄。</em></p></blockquote><blockquote><p><em>⚠️APP 開發者想知道怎麼防範嗅探可參考 <a href="/posts/zrealm-dev/app-https%E5%82%B3%E8%BC%B8%E4%BB%8D%E9%81%AD%E7%AB%8A%E5%8F%96-mitmproxy%E4%B8%AD%E9%96%93%E4%BA%BA%E6%94%BB%E6%93%8A%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8%E8%88%87%E9%98%B2%E7%AF%84%E6%8A%80%E5%B7%A7-46410aaada00/">之前的文章</a> 。</em></p></blockquote><h4 id="這邊假設我們得到的資訊如下"><span class="me-2"><strong>這邊假設我們得到的資訊如下：</strong></span><a href="#這邊假設我們得到的資訊如下" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>POST /usercenter HTTP/1.1
Host: zhgchg.li
Content-Type: application/x-www-form-urlencoded
Cookie: PHPSESSID=dafd27784f94904dd586d4ca19d8ae62
Connection: keep-alive
Accept: */*
User-Agent: (iPhone12,3;iOS 14.5)
Content-Length: 1076
Accept-Language: zh-tw
Accept-Encoding: gzip, deflate, br
AuthToken: 12345
</pre></table></code></div></div><h3 id="2-撰寫-python-腳本偽造-app-api-請求模擬簽到動作"><span class="me-2">2. 撰寫 Python 腳本，偽造 APP API 請求（模擬簽到動作）</span><a href="#2-撰寫-python-腳本偽造-app-api-請求模擬簽到動作" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote><p><em>在撰寫 Python 腳本之前，我們可先使用 <a href="https://www.postman.com/" target="_blank">Postman</a> 調試一下參數，觀察看看哪個參數是必要的或是有時效會改變；但要直接照搬也可以。</em></p></blockquote><p><a href="/assets/70a1409b149a/1*eVF56j1oOgXeZYbkD1m22g.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*eVF56j1oOgXeZYbkD1m22g.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NTMiIGhlaWdodD0iNTIxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>checkIn.py:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">json</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="sh">"</span><span class="s">action</span><span class="sh">"</span> <span class="p">:</span> <span class="sh">"</span><span class="s">checkIn</span><span class="sh">"</span> <span class="p">}</span>
      <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span> <span class="sh">"</span><span class="s">Cookie</span><span class="sh">"</span> <span class="p">:</span> <span class="sh">"</span><span class="s">PHPSESSID=dafd27784f94904dd586d4ca19d8ae62</span><span class="sh">"</span><span class="p">,</span> 
      <span class="sh">"</span><span class="s">AuthToken</span><span class="sh">"</span> <span class="p">:</span> <span class="sh">"</span><span class="s">12345</span><span class="sh">"</span><span class="p">,</span>
      <span class="sh">"</span><span class="s">User-Agent</span><span class="sh">"</span> <span class="p">:</span> <span class="sh">"</span><span class="s">(iPhone12,3;iOS 14.5)</span><span class="sh">"</span>
      <span class="p">}</span>
      
      <span class="n">request</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="sh">'</span><span class="s">https://zhgchg.li/usercenter</span><span class="sh">'</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">headers</span><span class="p">)</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="sh">'</span><span class="s">status_code</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">return</span> <span class="sh">"</span><span class="s">CheckIn Success!</span><span class="sh">"</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="sh">'</span><span class="s">message</span><span class="sh">'</span><span class="p">]</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="k">return</span> <span class="nf">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></table></code></div></div><blockquote><p><em>⚠️ <code class="language-plaintext highlighter-rouge">main(args)</code> 這邊的 args 用途後面會講，如果要在本地測試直接帶 <code class="language-plaintext highlighter-rouge">main(True)</code> 就好。</em></p></blockquote><p>使用 Requests 套件幫我們執行 HTTP Request，如果出現：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ImportError: No module named requests
</pre></table></code></div></div><p>請先使用 <code class="language-plaintext highlighter-rouge">pip install requests</code> 安裝套件。</p><h4 id="加上執行結果-linebot-通知"><span class="me-2">加上執行結果 Linebot 通知：</span><a href="#加上執行結果-linebot-通知" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>這部分我做的很簡單，僅共參考，僅通知自己。</p><ul><li>前往&amp;啟用 <a href="https://developers.line.biz/console/" target="_blank"><strong>Line Developers Console 開發者</strong></a><li>建立一個 Provider</ul><p><a href="/assets/70a1409b149a/1*XVYHKZXoHT-2qkbwRcK5Qw.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*XVYHKZXoHT-2qkbwRcK5Qw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NjgiIGhlaWdodD0iMjgxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>選擇「Create a Messaging API channel」</ul><p><a href="/assets/70a1409b149a/1*8l_awW31J7FlYh5EvacSmA.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*8l_awW31J7FlYh5EvacSmA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjY1NiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>下一步填好基本訊息後按「Create」送出建立。</p><ul><li>建立好之後在第一個「Basic settings」Tab 下面找到「Your user ID」區塊，這就是你的 User ID</ul><p><a href="/assets/70a1409b149a/1*JCmFicC5gXVJ6j3Vgi7CPQ.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*JCmFicC5gXVJ6j3Vgi7CPQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NTYiIGhlaWdodD0iNjkwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>建立好之後，選擇「Messaging API」Tab，掃描 QRCode 將機器人加入好友。</ul><p><a href="/assets/70a1409b149a/1*dOF0mHXz6z7be13zjIubTA.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*dOF0mHXz6z7be13zjIubTA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3ODkiIGhlaWdodD0iNTY5Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>繼續往下滾找到「Channel access token」區塊，點擊「Issue」產生 token。</ul><p><a href="/assets/70a1409b149a/1*eNiyLol6nokoOKsrGp21kw.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*eNiyLol6nokoOKsrGp21kw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MzkiIGhlaWdodD0iNjkyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>複製下來產生出來的 Token，我們有這組 Token 就能發訊息給使用者。</ul><p><a href="/assets/70a1409b149a/1*LDr_vT4urUL73Z_p--yiKA.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*LDr_vT4urUL73Z_p--yiKA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjExNiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><blockquote><p><em>有了 User Id 跟 Token 之後我們就能發訊息給自己了。</em></p></blockquote><blockquote><p><em>因沒有要做其他功能所以連 python line sdk 都不用裝，直接打 http 發。</em></p></blockquote><p><strong>串上之前的 Python 腳本後…</strong></p><p>checkIn.py:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">json</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="sh">"</span><span class="s">action</span><span class="sh">"</span> <span class="p">:</span> <span class="sh">"</span><span class="s">checkIn</span><span class="sh">"</span> <span class="p">}</span>
      <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span> <span class="sh">"</span><span class="s">Cookie</span><span class="sh">"</span> <span class="p">:</span> <span class="sh">"</span><span class="s">PHPSESSID=dafd27784f94904dd586d4ca19d8ae62</span><span class="sh">"</span><span class="p">,</span> 
      <span class="sh">"</span><span class="s">AuthToken</span><span class="sh">"</span> <span class="p">:</span> <span class="sh">"</span><span class="s">12345</span><span class="sh">"</span><span class="p">,</span>
      <span class="sh">"</span><span class="s">User-Agent</span><span class="sh">"</span> <span class="p">:</span> <span class="sh">"</span><span class="s">(iPhone12,3;iOS 14.5)</span><span class="sh">"</span>
      <span class="p">}</span>
      
      <span class="n">request</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="sh">'</span><span class="s">https://zhgchg.li/usercenter</span><span class="sh">'</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">headers</span><span class="p">)</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="sh">'</span><span class="s">status_code</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="nf">sendLineNotification</span><span class="p">(</span><span class="sh">"</span><span class="s">CheckIn Success!</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="sh">"</span><span class="s">CheckIn Success!</span><span class="sh">"</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="nf">sendLineNotification</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="sh">'</span><span class="s">message</span><span class="sh">'</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="sh">'</span><span class="s">message</span><span class="sh">'</span><span class="p">]</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="nf">sendLineNotification</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
      <span class="k">return</span> <span class="nf">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
      
<span class="k">def</span> <span class="nf">sendLineNotification</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">to</span><span class="sh">"</span> <span class="p">:</span> <span class="sh">"</span><span class="s">這邊帶你的 User ID</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">messages</span><span class="sh">"</span> <span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="sh">"</span><span class="s">type</span><span class="sh">"</span> <span class="p">:</span> <span class="sh">"</span><span class="s">text</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">text</span><span class="sh">"</span> <span class="p">:</span> <span class="n">message</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">Content-Type</span><span class="sh">"</span> <span class="p">:</span> <span class="sh">"</span><span class="s">application/json</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Authorization</span><span class="sh">"</span> <span class="p">:</span> <span class="sh">"</span><span class="s">這邊帶channel access token</span><span class="sh">"</span>
    <span class="p">}</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="sh">'</span><span class="s">https://api.line.me/v2/bot/message/push</span><span class="sh">'</span><span class="p">,</span><span class="n">json</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">headers</span><span class="p">)</span>
</pre></table></code></div></div><p><strong>測看看通知有沒有發成功：</strong></p><p><a href="/assets/70a1409b149a/1*7I7FMpQ-Gv5MKD0SWkIE0A.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*7I7FMpQ-Gv5MKD0SWkIE0A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MzQiIGhlaWdodD0iNjQiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p><strong>Success!</strong></p><blockquote><p><em>小插曲，通知部分我本來是想用 Gmail SMTP 用信件來發，結果上到 Google Cloud 後發現無法使用…</em></p></blockquote><h3 id="3-將-python-腳本搬到-google-cloud-上"><span class="me-2">3. 將 Python 腳本搬到 Google Cloud 上</span><a href="#3-將-python-腳本搬到-google-cloud-上" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>前面基本的講完了，正式進入本篇重頭戲；將 Python 腳本搬上雲端。</p><p>這部分我一開始向中的是 Google Cloud Run 但用了下覺得太複雜，我實際懶得研究，因為我的需求太小用不到這麼多功能；所以 <strong>我用的是 Google Cloud Function</strong> serverless 方案；實際上比較常用來做的是構建 serverless web 服務。</p><ul><li>如果沒使用過 Google Cloud 的朋友，請先前往 <a href="https://console.cloud.google.com/" target="_blank"><strong>主控台</strong></a> 新增好專案＆設定好帳單資訊<li>在專案主控台首頁，資源的地方點擊「Cloud Functions」</ul><p><a href="/assets/70a1409b149a/1*pWDK9AQKpbDpgDltFfS9-g.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*pWDK9AQKpbDpgDltFfS9-g.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0ODQiIGhlaWdodD0iMTczIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>上方選擇「建立函式」</ul><p><a href="/assets/70a1409b149a/1*ED2WPgfaSHEth3zWUJn05w.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*ED2WPgfaSHEth3zWUJn05w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NzciIGhlaWdodD0iMTI3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>輸入基本資訊</ul><p><a href="/assets/70a1409b149a/1*oetW_iIU9XywDbLZIa8tJQ.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*oetW_iIU9XywDbLZIa8tJQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NTEiIGhlaWdodD0iNzAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><blockquote><p><em>⚠️記下「 <strong>觸發網址」</strong></em></p></blockquote><p><strong>區域可選：</strong></p><ul><li><code class="language-plaintext highlighter-rouge">US-WEST1</code> 、 <code class="language-plaintext highlighter-rouge">US-CENTRAL1</code> 、 <code class="language-plaintext highlighter-rouge">US-EAST1</code> 可享 Cloud Storage 服務免費額度。<li><code class="language-plaintext highlighter-rouge">asia-east2</code> (Hong Kong) 靠我們比較近，但需要支付微微的 Cloud Storage 費用。</ul><blockquote><p><em>⚠️建立 Cloud Functions 時會需要 Cloud Storage 寄存程式碼。</em></p></blockquote><blockquote><p><em>⚠️詳細計價方式請參考文末。</em></p></blockquote><p><strong>觸發條件選：</strong> HTTP</p><p><strong>驗證：</strong> 依需求，我希望我能從外部點連結執行腳本，所以選擇「允許未經驗證的叫用」；如果選擇需要驗證，後續 Scheduler 服務也要做相應設定。</p><p><strong>變數、網路及進階設定可在變數中設定變數給 Python 使用（這樣參數有變動就不用改到 Python 程式碼）：</strong></p><p><a href="/assets/70a1409b149a/1*qJC7rcjOnSeKWa8NiYxbpQ.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*qJC7rcjOnSeKWa8NiYxbpQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MzUiIGhlaWdodD0iNDAyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><strong>在 Python 中調用的方式：</strong></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">os</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">test</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">DEFAULT VALUE</span><span class="sh">'</span><span class="p">)</span>
</pre></table></code></div></div><p>其他設定都不需要動，直接「儲存」-&gt;「下一步」。</p><ul><li>執行階段選「Python 3.x」並將寫好的 Python 腳本貼上，進入點改成「main」</ul><p><a href="/assets/70a1409b149a/1*zCK21j82QwsHD1nARuZkBw.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*zCK21j82QwsHD1nARuZkBw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTU1IiBoZWlnaHQ9IjgyNyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><strong>補充 main(args)</strong> ，同前述，此項服務比較是用來做 serverless web；所以 args 實際是 Request 物件，你能從其中拿到 http get query 及 http post body 資料，具體方式如下：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>取得 GET Query 資訊：
request_args = args.args
</pre></table></code></div></div><p>example: ?name=zhgchgli =&gt; request_args = [“name”:”zhgchgli”]</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>取得 POST Body 資料：
request_json = request.get_json(silent=True)
</pre></table></code></div></div><p>example: name=zhgchgli =&gt; request_json = [“name”:”zhgchgli”]</p><p><strong>如果使用 Postman 測試 POST 記得使用「Raw+JSON」POST 資料，否則不會有東西：</strong></p><p><a href="/assets/70a1409b149a/1*jl5joofEWPMLR3JuP988BQ.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*jl5joofEWPMLR3JuP988BQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MjAiIGhlaWdodD0iMjMxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>程式碼部分 OK 之後，切換到「requirements.txt」輸入有用到的套件依賴：</ul><p><a href="/assets/70a1409b149a/1*2MTOKWDWlXbfjYP1qgp7Sw.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*2MTOKWDWlXbfjYP1qgp7Sw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MDQiIGhlaWdodD0iMjE1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>我們使用「request」這個套件幫我們打 API，此套件不在原生 Python 庫裡面；所以我們要在這裡加上去：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>requests&gt;=2.25.1
</pre></table></code></div></div><p>這邊指定版本 ≥ 2.25.1，也可不指定只輸入 <code class="language-plaintext highlighter-rouge">requests</code> 安裝最新版。</p><ul><li>都 OK 之後點擊「部署」開始部署。</ul><p><a href="/assets/70a1409b149a/1*eQvtozhghRLQhxUgE9fMhw.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*eQvtozhghRLQhxUgE9fMhw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTc2IiBoZWlnaHQ9IjM3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>需要花約 1~3 分鐘的時間等他部署完成。</p><ul><li>部署完成後可由前面記下的「 <strong>觸發網址</strong> 」前去執行查看是否正確運行，或使用「動作」-&gt;「測試函式」進行測試</ul><p><a href="/assets/70a1409b149a/1*yv1wMHELWSrXiEvE44c9Sw.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*yv1wMHELWSrXiEvE44c9Sw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNTgiIGhlaWdodD0iMjQ1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>如果出現 <code class="language-plaintext highlighter-rouge">500 Internal Server Error</code> 則代表程式有錯，可點擊名稱進入查看「紀錄」，在其中找到原因：</p><p><a href="/assets/70a1409b149a/1*DeiRZT3wC1Z7Jv4WIRaM_Q.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*DeiRZT3wC1Z7Jv4WIRaM_Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjQ4MiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>UnboundLocalError: local variable 'db' referenced before assignment
</pre></table></code></div></div><ul><li>點擊名稱進入後也可按「編輯」修改腳本內容</ul><p><a href="/assets/70a1409b149a/1*KqwYbY826bdVaSIlHUnpbA.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*KqwYbY826bdVaSIlHUnpbA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjQxIiBoZWlnaHQ9IjUzNSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><blockquote><p><strong><em>測試沒問題就完成了！我們已經順利將 Python 腳本搬上雲端。</em></strong></p></blockquote><h4 id="補充關於變數部分"><span class="me-2">補充關於變數部分</span><a href="#補充關於變數部分" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>依照我們的需求，我們需要能有個地方存放、讀取簽到 APP 的 token；因為 token 可能會失效；需要重新要求並寫入共下次執行時使用。</p><p>想要從外部動態傳入變數到腳本中有以下方法：</p><ul><li>[Read Only] 前述所提到的，執行階段環境變數<li>[Temp] Cloud Functions 有提供一個 /tmp 目錄共執行時寫入、讀取檔案，但結束後就會刪除，詳情請參考 <a href="https://cloud.google.com/functions/docs/concepts/exec#file_system" target="_blank">官方文件</a> 。<li>[Read Only] GET/POST 傳送資料<li>[Read Only] 放入附加檔案</ul><p><a href="/assets/70a1409b149a/1*AAXUcDRZNnRAqIFj02RnyA.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*AAXUcDRZNnRAqIFj02RnyA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5ODYiIGhlaWdodD0iMzUyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>在程式中使用相對路徑 <code class="language-plaintext highlighter-rouge">./</code> 就能讀取到， <strong>僅限讀取無法動態修改</strong> ；要修改只能在控制台這修改＆重新部署。</p><blockquote><p><em>想要可以讀取、動態修改就需要串接其他 GCP 服務，例如：Cloud SQL、Google Storage、Firebase Cloud Firestore…</em></p></blockquote><ul><li>[Read &amp; Write] 這邊我選擇的是 Firebase Cloud <em>Firestore</em> 因為目前只有此方案有免費額度使用。</ul><p><strong>按照 <a href="https://firebase.google.com/docs/firestore/quickstart#read_data" target="_blank">入門步驟</a> ，建立好 Firebase 專案後；進入 Firebase 後台：</strong></p><p><a href="/assets/70a1409b149a/1*0DO31noJ4a3xweb1annbSQ.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*0DO31noJ4a3xweb1annbSQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjUxMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>在左方選單列找到「 <strong>Cloud Firestore</strong> 」-&gt;「 <strong>新增集合</strong> 」</p><p><a href="/assets/70a1409b149a/1*7c9sA8ZbxE6uGh6f-nfiVA.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*7c9sA8ZbxE6uGh6f-nfiVA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MDUiIGhlaWdodD0iMzc3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>輸入集合 ID。</p><p><a href="/assets/70a1409b149a/1*wcp94_25maNL9EoFJTOndA.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*wcp94_25maNL9EoFJTOndA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MTUiIGhlaWdodD0iNTIyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>輸入資料內容。</p><p>一個集合可以有多個文件，每個文件可以有各自的欄位內容；使用上非常彈性。</p><p><strong>在 Python 中使用：</strong></p><p>請先到 <a href="https://console.cloud.google.com/iam-admin/serviceaccounts" target="_blank">GCP控制台 -&gt; IAM與管理 -&gt; 服務帳戶</a> ，按照以下步驟下載身份驗證私鑰文件：</p><p>首先選擇帳號：</p><p><a href="/assets/70a1409b149a/1*JeB9m4BWzfRCZSofHq2tLg.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*JeB9m4BWzfRCZSofHq2tLg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjIzNiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>下方「新增金鑰」-&gt;「建立新的金鑰」</p><p><a href="/assets/70a1409b149a/1*xi9nQUy48-QlFI4BEdIMew.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*xi9nQUy48-QlFI4BEdIMew.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NTMiIGhlaWdodD0iNzQ3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>選擇「JSON」下載檔案。</p><p><a href="/assets/70a1409b149a/1*bsphvdEHgg0XDnHAHMXJvg.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*bsphvdEHgg0XDnHAHMXJvg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NTgiIGhlaWdodD0iMzUyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>將此 JSON 檔案放到同 Python 的專案目錄下。</p><p><strong>本地開發環境下：</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>pip <span class="nb">install</span> <span class="nt">--upgrade</span> firebase-admin
</pre></table></code></div></div><p>安裝 firebase-admin 套件。</p><p>在 Cloud Functions 上要在 <code class="language-plaintext highlighter-rouge">requirements.txt</code> 中多加入 <code class="language-plaintext highlighter-rouge">firebase-admin</code> 。</p><p><a href="/assets/70a1409b149a/1*d67oTblFFKaBHkGC77Mapw.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*d67oTblFFKaBHkGC77Mapw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI2IiBoZWlnaHQ9IjI3MSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>環境弄好後，可以來讀取我們剛剛新增的數據了：</p><p>firebase_admin.py:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">firebase_admin</span>
<span class="kn">from</span> <span class="n">firebase_admin</span> <span class="kn">import</span> <span class="n">credentials</span>
<span class="kn">from</span> <span class="n">firebase_admin</span> <span class="kn">import</span> <span class="n">firestore</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">firebase_admin</span><span class="p">.</span><span class="n">_apps</span><span class="p">:</span>
  <span class="n">cred</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">.</span><span class="nc">Certificate</span><span class="p">(</span><span class="sh">'</span><span class="s">./身份驗證.json</span><span class="sh">'</span><span class="p">)</span>
  <span class="n">firebase_admin</span><span class="p">.</span><span class="nf">initialize_app</span><span class="p">(</span><span class="n">cred</span><span class="p">)</span>
<span class="c1"># 因若重複 initialize_app 會報以下錯誤
# providing an app name as the second argument. In most cases you only need to call initialize_app() once. But if you do want to initialize multiple apps, pass a second argument to initialize_app() to give each app a unique name.
# 所以安全起見在 initialize_app 前先檢查是否已 init
</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">firestore</span><span class="p">.</span><span class="nf">client</span><span class="p">()</span>
<span class="n">ref</span> <span class="o">=</span> <span class="n">db</span><span class="p">.</span><span class="nf">collection</span><span class="p">(</span><span class="sa">u</span><span class="sh">'</span><span class="s">example</span><span class="sh">'</span><span class="p">)</span> <span class="o">//</span><span class="n">集合名稱</span>
<span class="n">stream</span> <span class="o">=</span> <span class="n">ref</span><span class="p">.</span><span class="nf">stream</span><span class="p">()</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
  <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">id:</span><span class="sh">"</span><span class="o">+</span><span class="n">data</span><span class="p">.</span><span class="nb">id</span><span class="o">+</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="o">+</span><span class="n">data</span><span class="p">.</span><span class="nf">to_dict</span><span class="p">())</span>
</pre></table></code></div></div><blockquote><p><em>如果是在 Cloud Functions 上除了可以把 身份驗證 JSON 檔一起上傳上去，也可以在使用時將連接語法改成以下使用：</em></p></blockquote><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">cred</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">.</span><span class="nc">ApplicationDefault</span><span class="p">()</span>
<span class="n">firebase_admin</span><span class="p">.</span><span class="nf">initialize_app</span><span class="p">(</span><span class="n">cred</span><span class="p">,</span> <span class="p">{</span>
  <span class="sh">'</span><span class="s">projectId</span><span class="sh">'</span><span class="p">:</span> <span class="n">project_id</span><span class="p">,</span>
<span class="p">})</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">firestore</span><span class="p">.</span><span class="nf">client</span><span class="p">()</span>
</pre></table></code></div></div><blockquote><p><em>如果出現 <code class="language-plaintext highlighter-rouge">Failed to initialize a certificate credential.</code> ，請檢查身份驗證 JSON 是否正確。</em></p></blockquote><p>新增、刪除更多操作請參考 <a href="https://firebase.google.com/docs/firestore/manage-data/add-data" target="_blank">官方文件</a> 。</p><h3 id="4-在-google-cloud-設定自動排程"><span class="me-2">4. 在 Google Cloud 設定自動排程</span><a href="#4-在-google-cloud-設定自動排程" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>有了腳本之後再來是要讓他自動執行才能達到我們的最終目標。</p><ul><li>前往 <a href="https://console.cloud.google.com/cloudscheduler/" target="_blank"><strong>Google Cloud Scheduler</strong></a> 控制台首頁<li>上方「建立工作」</ul><p><a href="/assets/70a1409b149a/1*5tNybi2HssmWoyJDQyPSJQ.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*5tNybi2HssmWoyJDQyPSJQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NDAiIGhlaWdodD0iMTU2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>輸入工作基本資料</ul><p><a href="/assets/70a1409b149a/1*yqkJnt9PVYEllOpDtK1RmQ.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*yqkJnt9PVYEllOpDtK1RmQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NTAiIGhlaWdodD0iNjUwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><strong>執行頻率：</strong> 同 crontab 輸入方式，如果你對 crontab 語法不熟，可以直接使用 <a href="https://crontab.guru/#15_1_*_*_*" target="_blank"><strong>crontab.guru 這個神器網站</strong></a> ：</p><p><a href="/assets/70a1409b149a/1*xnZBlcsMrQVJc6ewJIfAxA.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*xnZBlcsMrQVJc6ewJIfAxA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5NDciIGhlaWdodD0iMzMzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>他能很直白的翻譯給你所設定的語法實際意思。（點 <strong>next</strong> 可查看下次執行時間）</p><blockquote><p><em>這邊我設定 <code class="language-plaintext highlighter-rouge">15 1 * * *</code> ，因為簽到每天只需要執行一次，設在每日凌晨 1:15 執行。</em></p></blockquote><p><strong>網址部分：</strong> 輸入前面記下的「 <strong>觸發網址</strong> 」</p><p><strong>時區：</strong> 輸入「台灣」，選擇台北標準時間</p><p><strong>HTTP 方法：</strong> 照前面 Python 程式碼我們用 Get 就好</p><p><strong>如果前面有設「驗證」</strong> 記得展開「SHOW MORE」進行驗證設定。</p><p><strong>都填好後</strong> ，按下「 <strong>建立</strong> 」。</p><ul><li>建立成功後可選擇「立即執行」測試一下正不正常。</ul><p><a href="/assets/70a1409b149a/1*H_nsZNQ16iIKwThQpGJDmA.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*H_nsZNQ16iIKwThQpGJDmA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjM3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/70a1409b149a/1*X6pL0J4hGL_KodhsppvsJg.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*X6pL0J4hGL_KodhsppvsJg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MTEiIGhlaWdodD0iMTIzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>可查看執行結果、上次執行日期</ul><p><a href="/assets/70a1409b149a/1*pUqTo-NM1z-srXbq1BM4rA.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*pUqTo-NM1z-srXbq1BM4rA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMTAiIGhlaWdodD0iMTMyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><blockquote><p><em>⚠️ <strong>請注意，執行結果「失敗」僅針對 web status code 是 400~500 或 python 程式有錯誤。</strong></em></p></blockquote><h3 id="大功告成"><span class="me-2">大功告成！</span><a href="#大功告成" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>我們已達成將例行任務 Python 腳本上傳到雲端＆設定自動排成自動執行的目標。</p><h3 id="計價方式"><span class="me-2">計價方式</span><a href="#計價方式" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>還有一部分很重要，就是計價方式；Google Cloud、Linebot 都不是全免費服務，所以了解收費方式很重要；不然為了一個小小的腳本，付出太多的金錢那不如電腦開著掛著跑哩。</p><h4 id="linebot"><span class="me-2">Linebot</span><a href="#linebot" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/70a1409b149a/1*cfuKJxNoW4tvCEhqdC7oIQ.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*cfuKJxNoW4tvCEhqdC7oIQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTExIiBoZWlnaHQ9IjU2NCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>參考 <a href="https://tw.linebiz.com/service/account-solutions/line-official-account/" target="_blank">官方定價</a> 資訊，一個月 500 則內免費。</p><h4 id="google-cloud-functions"><span class="me-2">Google Cloud Functions</span><a href="#google-cloud-functions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/70a1409b149a/1*2431d2F1BNtEJUg845uDQg.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*2431d2F1BNtEJUg845uDQg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4ODUiIGhlaWdodD0iMjU2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>參考 <a href="https://cloud.google.com/functions/pricing?hl=zh-tw" target="_blank">官方定價</a> 資訊，每月有 200 萬次叫用、400,000 GB/秒和 200,000 GHz/秒的運算時間、 5 GB 的網際網路輸出流量。</p><h4 id="google-firebase-cloud-firestore"><span class="me-2">Google Firebase Cloud Firestore</span><a href="#google-firebase-cloud-firestore" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/70a1409b149a/1*2t1boe9DQX1NBgGyYTrVnA.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*2t1boe9DQX1NBgGyYTrVnA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4ODUiIGhlaWdodD0iNDExIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>參考 <a href="https://firebase.google.com/docs/firestore/quotas" target="_blank">官方定價</a> 資訊，有 1 GB 大小容量、每月 10 GB 流量、每天 50,000 次讀取、20,000 次寫入/刪除；輕量使用很夠用了！</p><h4 id="google-cloud-scheduler"><span class="me-2">Google Cloud Scheduler</span><a href="#google-cloud-scheduler" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/70a1409b149a/1*b9cvGpPqjKRFHa-45Yuzdw.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*b9cvGpPqjKRFHa-45Yuzdw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4ODIiIGhlaWdodD0iNDQ3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>參考 <a href="https://cloud.google.com/scheduler/pricing?hl=zh-tw" target="_blank">官方定價</a> 資訊，每個帳號有 3 項免費工作可設定。</p><blockquote><p>對腳本來說以上免費用量就綽綽有餘啦！</p></blockquote><h4 id="google-cloud-storage-有條件免費"><span class="me-2">Google Cloud Storage 有條件免費</span><a href="#google-cloud-storage-有條件免費" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>東躲西躲，還是躲不掉可能被收費的服務。</p><p>Cloud Functions 建立好之後會自動建立兩個 Cloud Storage 實體：</p><p><a href="/assets/70a1409b149a/1*OvWXsZbwnM8sNfvdtDAIOA.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*OvWXsZbwnM8sNfvdtDAIOA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjE0NiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>如果剛剛 Cloud Functions 選擇的是 US-WEST1、US-CENTRAL1 或 US-EAST1 這三個地區則可享有免費使用額度：</p><p><a href="/assets/70a1409b149a/1*arevMQGpsIumGlw_PE-hQQ.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*arevMQGpsIumGlw_PE-hQQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4ODAiIGhlaWdodD0iNTE0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>我是選擇 US-CENTRAL1 沒錯，可以看到第一個 Cloud Storage 實體的地區是 US-CENTRAL1 沒錯，但第二個是寫 <strong>美國多個地區</strong> ； <strong>我自已估計這項是會被收費的</strong> 。</p><p><a href="/assets/70a1409b149a/1*kuX9HlPTfMxbEg-sa3rJOQ.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*kuX9HlPTfMxbEg-sa3rJOQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4ODYiIGhlaWdodD0iMzQxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>參考 <a href="https://cloud.google.com/storage/pricing?hl=zh-tw" target="_blank">官方定價</a> 資訊，依照主機地區不同有不同的價格。</p><p>程式碼沒多大，估計應該就是每個月最低收費 0.0X0 元（？</p><blockquote><p><em>⚠️以上資訊均為 2021/02/21 時撰寫時紀錄，實際以當前價格為主，僅共參考。</em></p></blockquote><h4 id="計價預算控制通知"><span class="me-2">計價預算控制通知</span><a href="#計價預算控制通知" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>just in case…假設真的有狀況超出免費用量開始計價，我希望能收到通知；避免可能程式錯誤暴衝造成帳單金額報表卻渾然不知。。。</p><ul><li>前往 <a href="https://console.cloud.google.com/" target="_blank"><strong>主控台</strong></a><li>找到「 <strong>計費功能</strong> 」Card：</ul><p><a href="/assets/70a1409b149a/1*r0T8gZsaWroxhWxIxKwRWQ.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*r0T8gZsaWroxhWxIxKwRWQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NjgiIGhlaWdodD0iMjEwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>點擊「 <strong>查看詳細扣款紀錄</strong> 」進入。</p><ul><li>展開左邊選單，進入「 <strong>預算與快訊</strong> 」功能</ul><p><a href="/assets/70a1409b149a/1*GtT4Sj9Q19O_QxWTWgM5UA.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*GtT4Sj9Q19O_QxWTWgM5UA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MTYiIGhlaWdodD0iODE4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>點擊上方「 <strong>設定預算</strong> 」</ul><p><a href="/assets/70a1409b149a/1*ytmGKw4sy6b-U3XAeI_geQ.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*ytmGKw4sy6b-U3XAeI_geQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTE4IiBoZWlnaHQ9IjI4MCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ul><li>輸入自訂名稱</ul><p><a href="/assets/70a1409b149a/1*_qgQMB_WsCuoxtJ4vA6xgw.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*_qgQMB_WsCuoxtJ4vA6xgw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDg4IiBoZWlnaHQ9IjExMjYiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>下一步。</p><ul><li>金額，輸入「 <strong>目標金額</strong> 」，可輸入 $1、$10；我們不希望在小東西上花太。</ul><p><a href="/assets/70a1409b149a/1*y6fIpzReQxZZRsVpZIk-tw.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*y6fIpzReQxZZRsVpZIk-tw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NDIiIGhlaWdodD0iMjQwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>下一步。</p><p>動作這邊可以設定當預算達到多少百分比時會觸發通知。</p><p><a href="/assets/70a1409b149a/1*y4B62yjPWAy1pBQhZmiySQ.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*y4B62yjPWAy1pBQhZmiySQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NDMiIGhlaWdodD0iNDY0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><strong>勾選</strong> 「 <strong>透過電子郵件將快訊傳送給帳單管理員和使用者</strong> 」，這樣當條件處發時就能第一時間收到通知。</p><p><a href="/assets/70a1409b149a/1*PTQDG_Uffa8fvHxaeYCnrQ.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*PTQDG_Uffa8fvHxaeYCnrQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NDgiIGhlaWdodD0iMTQ4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>點擊「完成」送出儲存。</p><p><a href="/assets/70a1409b149a/1*QWH-bIlQAC7hhc4SVQOI5g.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*QWH-bIlQAC7hhc4SVQOI5g.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDQ0IiBoZWlnaHQ9IjEyOCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/70a1409b149a/1*-BAHV1lovaYgblnCCubmSQ.webp" class="popup img-link blur"><img data-src="/assets/70a1409b149a/1*-BAHV1lovaYgblnCCubmSQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4ODUiIGhlaWdodD0iMTIzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>當預算超過時我們就能馬上就能知道，避免產生更多費用。</p><h3 id="總結"><span class="me-2">總結</span><a href="#總結" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>人的精力是有限的，現今科技資訊洪流，每個平台每個服務都想要榨取我們有限的精力；如果能透過一些自動化腳本分擔我們的日常生活，聚沙成塔，讓我們省下更多精力專心在重要的事情之上！</p><h3 id="延伸閱讀"><span class="me-2">延伸閱讀</span><a href="#延伸閱讀" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><a href="/posts/zrealm-dev/slack-workflow-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8B%95-wfh-%E5%93%A1%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E5%A0%B1%E7%B3%BB%E7%B5%B1-%E7%B5%90%E5%90%88-google-sheets-%E8%88%87-app-script-%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87-d61062833c1a/">Slack 打造全自動 WFH 員工健康狀況回報系統</a><li><a href="/posts/zrealm-dev/crashlytics-big-query-%E4%B8%B2%E6%8E%A5%E6%95%99%E5%AD%B8-%E8%87%AA%E5%8B%95%E6%9F%A5%E8%A9%A2%E4%B8%A6%E8%BD%89%E7%99%BC-ios-app-%E9%96%83%E9%80%80%E5%A0%B1%E5%91%8A%E5%88%B0-slack-e77b80cc6f89/">Crashlytics + Big Query 打造更即時便利的 Crash 追蹤工具</a><li><a href="/posts/zrealm-dev/crashlytics%E8%88%87google-analytics%E8%87%AA%E5%8B%95%E6%9F%A5%E8%A9%A2app-crash-free-users-rate-google-apps-script%E6%95%B4%E5%90%88%E5%AF%A6%E4%BD%9C-793cb8f89b72/">Crashlytics + Google Analytics 自動查詢 App Crash-Free Users Rate</a><li><a href="/posts/zrealm-dev/app-https%E5%82%B3%E8%BC%B8%E4%BB%8D%E9%81%AD%E7%AB%8A%E5%8F%96-mitmproxy%E4%B8%AD%E9%96%93%E4%BA%BA%E6%94%BB%E6%93%8A%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8%E8%88%87%E9%98%B2%E7%AF%84%E6%8A%80%E5%B7%A7-46410aaada00/">APP有用HTTPS傳輸，但資料還是被偷了。</a><li><a href="/posts/zrealm-dev/%E6%89%93%E9%80%A0%E6%9C%89%E8%B6%A3%E5%B7%A5%E7%A8%8Bctf%E7%AB%B6%E8%B3%BD-%E7%B3%BB%E7%B5%B1%E5%BB%BA%E7%BD%AE%E8%88%87%E8%B7%A8%E9%A0%98%E5%9F%9F%E9%A1%8C%E7%9B%AE%E8%A8%AD%E8%A8%88%E6%94%BB%E7%95%A5-729d7b6817a4/">如何打造一場有趣的工程CTF競賽</a><li><a href="/posts/zrealm-dev/ios-14-%E5%89%AA%E8%B2%BC%E7%B0%BF%E9%9A%B1%E7%A7%81%E5%95%8F%E9%A1%8C-%E6%8F%AD%E9%9C%B2-app-%E8%AE%80%E5%8F%96%E5%8E%9F%E5%9B%A0%E8%88%87%E5%AE%89%E5%85%A8%E9%A2%A8%E9%9A%AA%E8%A7%A3%E6%9E%90-8a04443024e2/">iOS 14 剪貼簿竊資恐慌，隱私與便利的兩難</a><li><a href="/posts/zrealm-dev/google-apps-script-%E6%95%99%E5%AD%B8-%E8%87%AA%E5%8B%95%E8%BD%89%E7%99%BC-gmail-%E9%83%B5%E4%BB%B6%E5%88%B0-slack-channel-%E5%AE%A2%E8%A3%BD%E5%8C%96%E9%80%9A%E7%9F%A5-d414bdbdb8c9/">運用 Google Apps Script 轉發 Gmail 信件到 Slack</a></ul><p>有任何問題及指教歡迎 <a href="https://www.zhgchg.li/contact" target="_blank">與我聯絡</a> 。</p><p>有自動化相關優化需求也歡迎 <a href="https://www.zhgchg.li/contact" target="_blank">發案給我</a> ，謝謝。</p><hr /><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=🍺&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a><br /></p><blockquote class="prompt-info"><p>本文首次發表於 Medium (<a href="https://medium.com/p/70a1409b149a" target="_blank"><strong>點此查看原始版本</strong></a>)，由 <a href="/posts/tools/medium-to-jekyll/" target="_blank">ZMediumToMarkdown</a> 提供自動轉換與同步技術。</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/zh-tw/zmediumtomarkdown/2021-02-20-70a1409b149a.md" target="_blank">Improve this page on Github.</a></p></blockquote><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1K+ Followers</span></a></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-dev/">ZRealm Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/google-cloud-platform/" class="post-tag no-text-decoration" >google-cloud-platform</a> <a href="/tags/cloud-functions/" class="post-tag no-text-decoration" >cloud-functions</a> <a href="/tags/cloud-scheduler/" class="post-tag no-text-decoration" >cloud-scheduler</a> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Python%20%E6%90%AD%E9%85%8D%20Google%20Cloud%20Platform%20%E8%88%87%20Line%20Bot%EF%BD%9C%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E8%87%AA%E5%8B%95%E7%B0%BD%E5%88%B0%E8%85%B3%E6%9C%AC%E8%88%87%E6%8E%92%E7%A8%8B%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fpython-%25E6%2590%25AD%25E9%2585%258D-google-cloud-platform-%25E8%2588%2587-line-bot-%25E6%2589%2593%25E9%2580%25A0%25E6%25AF%258F%25E6%2597%25A5%25E8%2587%25AA%25E5%258B%2595%25E7%25B0%25BD%25E5%2588%25B0%25E8%2585%25B3%25E6%259C%25AC%25E8%2588%2587%25E6%258E%2592%25E7%25A8%258B-70a1409b149a%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Python%20%E6%90%AD%E9%85%8D%20Google%20Cloud%20Platform%20%E8%88%87%20Line%20Bot%EF%BD%9C%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E8%87%AA%E5%8B%95%E7%B0%BD%E5%88%B0%E8%85%B3%E6%9C%AC%E8%88%87%E6%8E%92%E7%A8%8B%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fpython-%25E6%2590%25AD%25E9%2585%258D-google-cloud-platform-%25E8%2588%2587-line-bot-%25E6%2589%2593%25E9%2580%25A0%25E6%25AF%258F%25E6%2597%25A5%25E8%2587%25AA%25E5%258B%2595%25E7%25B0%25BD%25E5%2588%25B0%25E8%2585%25B3%25E6%259C%25AC%25E8%2588%2587%25E6%258E%2592%25E7%25A8%258B-70a1409b149a%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fpython-%25E6%2590%25AD%25E9%2585%258D-google-cloud-platform-%25E8%2588%2587-line-bot-%25E6%2589%2593%25E9%2580%25A0%25E6%25AF%258F%25E6%2597%25A5%25E8%2587%25AA%25E5%258B%2595%25E7%25B0%25BD%25E5%2588%25B0%25E8%2585%25B3%25E6%259C%25AC%25E8%2588%2587%25E6%258E%2592%25E7%25A8%258B-70a1409b149a%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/en/tokyo-area-travel-guide-kawagoe-little-edo-atami-fireworks-festival-5-day-itinerary-958599363857/">Tokyo Area Travel Guide｜Kawagoe Little Edo & Atami Fireworks Festival 5-Day Itinerary</a><li class="text-truncate lh-lg"> <a href="/posts/zh-cn/%E4%B8%9C%E4%BA%AC%E8%87%AA%E7%94%B1%E8%A1%8C%E6%94%BB%E7%95%A5-%E5%B7%9D%E8%B6%8A%E5%B0%8F%E6%B1%9F%E6%88%B7%E4%B8%80%E6%97%A5%E6%B8%B8%E4%B8%8E%E7%83%AD%E6%B5%B7%E6%B5%B7%E4%B8%8A%E8%8A%B1%E7%81%AB%E5%A4%A7%E4%BC%9A%E5%85%A8%E7%BA%AA%E5%BD%95-958599363857/">游记 2025 东京地区 — 川越小江户与热海海上花火大会 5 日自由行</a><li class="text-truncate lh-lg"> <a href="/posts/%E6%9D%B1%E4%BA%AC%E8%87%AA%E7%94%B1%E8%A1%8C%E6%94%BB%E7%95%A5-%E5%B7%9D%E8%B6%8A%E5%B0%8F%E6%B1%9F%E6%88%B6%E4%B8%80%E6%97%A5%E9%81%8A%E8%88%87%E7%86%B1%E6%B5%B7%E6%B5%B7%E4%B8%8A%E8%8A%B1%E7%81%AB%E5%A4%A7%E6%9C%83%E5%85%A8%E7%B4%80%E9%8C%84-958599363857/">遊記 2025 東京地區 — 川越小江戶與熱海海上花火大會 5 日自由行</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/en/line-bank-to-firstrade-transfer-fast-deposit-150-nt-fee-guide-with-account-upgrade-fee-subsidy-e4d139fe0685/">LINE Bank to Firstrade Transfer｜Fast Deposit & 150 NT Fee Guide with Account Upgrade & Fee Subsidy</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/zh-cn/line-bank-%E5%85%A5%E9%87%91-firstrade-%E6%95%99%E5%AD%A6-%E5%BF%AB%E9%80%9F%E5%88%B0%E5%B8%90-%E4%BD%8E%E6%89%8B%E7%BB%AD%E8%B4%B9150%E5%85%83-%E5%B8%90%E6%88%B7%E5%8D%87%E7%BA%A7%E4%B8%8E%E6%89%8B%E7%BB%AD%E8%B4%B9%E8%A1%A5%E5%8A%A9%E7%94%B3%E8%AF%B7%E5%85%A8%E6%94%BB%E7%95%A5-e4d139fe0685/">手把手教学 — LINE Bank 入金 Firstrade 快速到帐、手续费只要 150 元及帐户升级/约定转帐/手续费补助申请教学</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">章節 (Chapters)🔖</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-dev/zh-cn/python-%E6%90%AD%E9%85%8D-google-cloud-platform-%E4%B8%8E-line-bot-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E8%87%AA%E5%8A%A8%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%E4%B8%8E%E6%8E%92%E7%A8%8B-70a1409b149a/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1613822151" data-df="ll" > Feb 20, 2021 </time><h4 class="pt-0 my-2">Python 搭配 Google Cloud Platform 与 Line Bot｜打造每日自动签到脚本与排程</h4><div class="text-muted"><p>透过 Python 结合 Google Cloud Function、Cloud Scheduler 及 Line Bot，自动完成每日签到任务并即时通知，解决手动操作繁琐问题，提升工作效率并节省时间成本。</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/en/automate-routine-tasks-with-python-google-cloud-platform-line-bot-daily-check-in-script-example-70a1409b149a/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1613822151" data-df="ll" > Feb 20, 2021 </time><h4 class="pt-0 my-2">Automate Routine Tasks with Python, Google Cloud Platform & Line Bot｜Daily Check-In Script Example</h4><div class="text-muted"><p>Discover how to automate daily check-ins using Python, Google Cloud Platform, and Line Bot to save time and boost efficiency. Learn to create a reliable script that runs automatically, ensuring con...</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/slack-app-%E6%95%B4%E5%90%88-chatgpt-%E5%88%A9%E7%94%A8-openai-api-%E8%88%87-google-cloud-functions-%E8%87%AA%E5%BB%BA%E6%99%BA%E8%83%BD%E5%8A%A9%E7%90%86-bd94cc88f9c9/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1708089421" data-df="ll" > Feb 16, 2024 </time><h4 class="pt-0 my-2">Slack & ChatGPT Integration</h4><div class="text-muted"><p>自行打造 ChatGPT OpenAI API for Slack App (Google Cloud Functions &amp; Python)</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-dev/zh-cn/python-%E6%90%AD%E9%85%8D-google-cloud-platform-%E4%B8%8E-line-bot-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E8%87%AA%E5%8A%A8%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%E4%B8%8E%E6%8E%92%E7%A8%8B-70a1409b149a/" class="btn btn-outline-primary" aria-label="Older" ><p>Python 搭配 Google Cloud Platform 与 Line Bot｜打造每日自动签到脚本与排程</p></a> <a href="/posts/zrealm-dev/en/website-security-flaws-exposed-how-combined-vulnerabilities-compromise-protection-142244e5f07a/" class="btn btn-outline-primary" aria-label="Newer" ><p>Website Security Flaws Exposed｜How Combined Vulnerabilities Compromise Protection</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span> <a href="/">中文</a>|<a href="/tags/simplified-chinese">简中</a>|<a href="/tags/english/">English</a></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a> <br/></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
