<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Universal Links iOS 開發攻略｜設定技巧與本地測試環境搭建" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="掌握 iOS Universal Links 設定與更新機制，解決 Apple CDN 快取延遲問題，並透過本地 nginx + ngrok 環境快速模擬測試，提升多域名與複雜路徑匹配準確度，確保 APP 與網站無縫串接體驗。" /><meta property="og:description" content="掌握 iOS Universal Links 設定與更新機制，解決 Apple CDN 快取延遲問題，並透過本地 nginx + ngrok 環境快速模擬測試，提升多域名與複雜路徑匹配準確度，確保 APP 與網站無縫串接體驗。" /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-dev/universal-links-ios-%E9%96%8B%E7%99%BC%E6%94%BB%E7%95%A5-%E8%A8%AD%E5%AE%9A%E6%8A%80%E5%B7%A7%E8%88%87%E6%9C%AC%E5%9C%B0%E6%B8%AC%E8%A9%A6%E7%92%B0%E5%A2%83%E6%90%AD%E5%BB%BA-12c5026da33d/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-dev/universal-links-ios-%E9%96%8B%E7%99%BC%E6%94%BB%E7%95%A5-%E8%A8%AD%E5%AE%9A%E6%8A%80%E5%B7%A7%E8%88%87%E6%9C%AC%E5%9C%B0%E6%B8%AC%E8%A9%A6%E7%92%B0%E5%A2%83%E6%90%AD%E5%BB%BA-12c5026da33d/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/12c5026da33d/1*HYAd1aal5Et1A-Qzs6VAtQ.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-02-04T11:57:25+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/12c5026da33d/1*HYAd1aal5Et1A-Qzs6VAtQ.webp" /><meta property="twitter:title" content="Universal Links iOS 開發攻略｜設定技巧與本地測試環境搭建" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://medium.com/@zhgchgli/"},"dateModified":"2024-09-13T17:31:54+08:00","datePublished":"2021-02-04T11:57:25+08:00","description":"掌握 iOS Universal Links 設定與更新機制，解決 Apple CDN 快取延遲問題，並透過本地 nginx + ngrok 環境快速模擬測試，提升多域名與複雜路徑匹配準確度，確保 APP 與網站無縫串接體驗。","headline":"Universal Links iOS 開發攻略｜設定技巧與本地測試環境搭建","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+","url":"https://zhgchg.li/assets/12c5026da33d/1*HYAd1aal5Et1A-Qzs6VAtQ.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-dev/universal-links-ios-%E9%96%8B%E7%99%BC%E6%94%BB%E7%95%A5-%E8%A8%AD%E5%AE%9A%E6%8A%80%E5%B7%A7%E8%88%87%E6%9C%AC%E5%9C%B0%E6%B8%AC%E8%A9%A6%E7%92%B0%E5%A2%83%E6%90%AD%E5%BB%BA-12c5026da33d/"},"url":"https://zhgchg.li/posts/zrealm-dev/universal-links-ios-%E9%96%8B%E7%99%BC%E6%94%BB%E7%95%A5-%E8%A8%AD%E5%AE%9A%E6%8A%80%E5%B7%A7%E8%88%87%E6%9C%AC%E5%9C%B0%E6%B8%AC%E8%A9%A6%E7%92%B0%E5%A2%83%E6%90%AD%E5%BB%BA-12c5026da33d/"}</script><title>Universal Links iOS 開發攻略｜設定技巧與本地測試環境搭建 | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script><link rel="alternate" hreflang="en" href="/posts/zrealm-dev/en/universal-links-optimization-boost-ios-13-14-integration-with-local-testing-setup-12c5026da33d/"><link rel="alternate" hreflang="zh-Hans" href="/posts/zrealm-dev/zh-cn/universal-links-ios-%E5%BC%80%E5%8F%91%E6%94%BB%E7%95%A5-%E8%AE%BE%E5%AE%9A%E6%8A%80%E5%B7%A7%E4%B8%8E%E6%9C%AC%E5%9C%B0%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-12c5026da33d/"><link rel="alternate" hreflang="zh-Hant" href="/posts/zrealm-dev/universal-links-ios-%E9%96%8B%E7%99%BC%E6%94%BB%E7%95%A5-%E8%A8%AD%E5%AE%9A%E6%8A%80%E5%B7%A7%E8%88%87%E6%9C%AC%E5%9C%B0%E6%B8%AC%E8%A9%A6%E7%92%B0%E5%A2%83%E6%90%AD%E5%BB%BA-12c5026da33d/"><link rel="alternate" hreflang="x-default" href="/posts/zrealm-dev/universal-links-ios-%E9%96%8B%E7%99%BC%E6%94%BB%E7%95%A5-%E8%A8%AD%E5%AE%9A%E6%8A%80%E5%B7%A7%E8%88%87%E6%9C%AC%E5%9C%B0%E6%B8%AC%E8%A9%A6%E7%92%B0%E5%A2%83%E6%90%AD%E5%BB%BA-12c5026da33d/"> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"FAQPage","mainEntity":[{"@type":"Question","name":"iOS 14 以上 Universal Links 的 apple-app-site-association 何時更新？","acceptedAnswer":{"@type":"Answer","text":"iOS 14 以上版本由 Apple CDN 快取並定期更新 apple-app-site-association，APP 安裝或更新時會從 Apple CDN 取得，但更新頻率不公開，建議修改後提前幾天上線以避免舊檔案問題。"}},{"@type":"Question","name":"如何在開發階段即時測試和調試 iOS 14 以上的 Universal Links？","acceptedAnswer":{"@type":"Answer","text":"開發時在 applinks 網域後加上 ?mode=developer，模擬器會直接抓取最新的 apple-app-site-association；實機需開啟「設定」→「開發者」→「Associated Domains Development」開關，確保即時更新。"}},{"@type":"Question","name":"如何建立本地測試環境來模擬 apple-app-site-association 服務？","acceptedAnswer":{"@type":"Answer","text":"可使用 nginx 在本地啟動服務，將 apple-app-site-association 放在 .well-known 目錄，搭配 ngrok 將本地服務公開成 HTTPS 網址，再將該網址加入 applinks 設定，方便在開發階段測試 Universal Links。"}},{"@type":"Question","name":"iOS 13 以後 apple-app-site-association 配置檔有何新特性？","acceptedAnswer":{"@type":"Answer","text":"iOS 13 以後支援更靈活的 components 配置，包含路徑、Query 參數、錨點匹配，支援大小寫敏感及自動編碼，並可使用預設及自訂字符集提升匹配彈性與可讀性。"}},{"@type":"Question","name":"Universal Links 的匹配規則如何設定反向排除與多 appID？","acceptedAnswer":{"@type":"Answer","text":"iOS 13 以後可用 components 中的 exclude: true 來反向排除特定路徑，且 appIDs 支援陣列格式，可同時配置多個 appID，方便多 App 共用同一域名的 Universal Links。"}}]} </script><link rel="stylesheet" href="/assets/css/post-toc.css"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0">An iOS, web, and automation developer from Taiwan 🇹🇼 who also loves sharing, traveling, and writing.</p><a href="https://medium.com/@zhgchgli" target="_blank" style="display: block;text-align: center;font-style: normal;/* text-decoration: underline; */font-size: 1.2em;color: var(--heading-color);">1K+ Followers on Medium</a></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/english/" class="nav-link"> <i class="fa-fw fa fa-solid fa-language"></i> <span>ENGLISH POSTS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Universal Links iOS 開發攻略｜設定技巧與本地測試環境搭建</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Universal Links iOS 開發攻略｜設定技巧與本地測試環境搭建</h1><p class="post-desc fw-light mb-4">掌握 iOS Universal Links 設定與更新機制，解決 Apple CDN 快取延遲問題，並透過本地 nginx + ngrok 環境快速模擬測試，提升多域名與複雜路徑匹配準確度，確保 APP 與網站無縫串接體驗。</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1612411045" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Feb 4, 2021 </time> </span> <span> Updated <time data-ts="1726219914" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Sep 13, 2024 </time> </span><div class="mt-3 mb-3"> <a href="/assets/12c5026da33d/1*HYAd1aal5Et1A-Qzs6VAtQ.webp" class="popup img-link preview-img blur"><img data-src="/assets/12c5026da33d/1*HYAd1aal5Et1A-Qzs6VAtQ.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></div><div class="d-flex justify-content-between"> <span style="display: inline-flex; align-items: center; gap: 4px;"> By <em> <a href="https://medium.com/@zhgchgli/">ZhgChgLi</a> </em> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" style="display: block; "><path fill="#007bff" d="M271.2 56C265.1 49.8 256.2 47.3 247.8 49.6C239.4 51.9 232.9 58.4 230.8 66.8L215.5 127C214.4 131.4 209.9 134 205.6 132.7L145.8 115.9C137.4 113.5 128.4 115.9 122.3 122C116.2 128.1 113.8 137.1 116.2 145.5L133.1 205.3C134.3 209.6 131.7 214.1 127.4 215.2L67.1 230.5C58.7 232.6 52.1 239.2 49.8 247.6C47.5 256 50 264.9 56.2 271L100.7 314.3C103.9 317.4 103.9 322.6 100.7 325.8L56.3 369.1C50.1 375.2 47.6 384.1 49.9 392.5C52.2 400.9 58.8 407.4 67.2 409.6L127.4 424.9C131.8 426 134.4 430.5 133.1 434.8L116.2 494.5C113.8 502.9 116.2 511.9 122.3 518C128.4 524.1 137.4 526.5 145.8 524.1L205.6 507.2C209.9 506 214.4 508.6 215.5 512.9L230.8 573.1C232.9 581.5 239.5 588.1 247.9 590.4C256.3 592.7 265.2 590.2 271.3 584L314.6 539.5C317.7 536.3 322.9 536.3 326.1 539.5L369.3 584C375.4 590.2 384.3 592.7 392.7 590.4C401.1 588.1 407.6 581.5 409.8 573.1L425.1 513C426.2 508.6 430.7 506 435 507.3L494.8 524.2C503.2 526.6 512.2 524.2 518.3 518.1C524.4 512 526.8 503 524.4 494.6L507.5 434.8C506.3 430.5 508.9 426 513.2 424.9L573.4 409.6C581.8 407.5 588.4 400.9 590.7 392.5C593 384.1 590.5 375.1 584.3 369.1L539.8 325.8C536.6 322.7 536.6 317.5 539.8 314.3L584.3 271C590.5 264.9 593 256 590.7 247.6C588.4 239.2 581.8 232.7 573.4 230.5L513.2 215.2C508.8 214.1 506.2 209.6 507.5 205.3L524.4 145.5C526.8 137.1 524.4 128.1 518.3 122C512.2 115.9 503.2 113.5 494.8 115.9L435 132.8C430.7 134 426.2 131.4 425.1 127.1L409.8 66.8C407.7 58.4 401.1 51.8 392.7 49.5C384.3 47.2 375.4 49.7 369.3 55.9L326 100.5C322.9 103.7 317.7 103.7 314.5 100.5L271.2 56z"/><path d="M250 330 l60 60 100 -140" stroke="#ffffff" stroke-width="40" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="3012 words" > <em>16 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Universal Links iOS 開發攻略｜設定技巧與本地測試環境搭建</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">章節 (Chapters)🔖</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Universal Links iOS 開發攻略｜設定技巧與本地測試環境搭建</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/en/universal-links-optimization-boost-ios-13-14-integration-with-local-testing-setup-12c5026da33d/"><strong>Click here</strong></a> to view the English version of this article.</p></blockquote><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/zh-cn/universal-links-ios-%E5%BC%80%E5%8F%91%E6%94%BB%E7%95%A5-%E8%AE%BE%E5%AE%9A%E6%8A%80%E5%B7%A7%E4%B8%8E%E6%9C%AC%E5%9C%B0%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-12c5026da33d/"><strong>点击这里</strong></a>查看本文章简体中文版本。</p></blockquote><blockquote class="prompt-info"><p>基於 SEO 考量，本文標題與描述經 AI 調整，原始版本請參考內文。</p></blockquote><h4 id="zhgchgli-table-of-contents">文章目錄</h4><nav class="zhgchgli-toc"><ul class="zhgchgli-toc-list"><li><a href="#universal-links-新鮮事">Universal Links 新鮮事</a></li><li><a href="#前言">前言</a></li><li><a href="#常見考量">常見考量</a></li><li class="has-children"><details><summary>apple-app-site-association 何時更新？ <a href="#apple-app-site-association-何時更新">#</a></summary><ul><li><a href="#apple-app-site-association-apple-cdn-確認">apple-app-site-association Apple CDN 確認</a></li><li><a href="#ios--14-debug">iOS ≥ 14 Debug</a></li></ul></details></li><li class="has-children"><details><summary>開發測試 <a href="#開發測試">#</a></summary><ul><li><a href="#在本地建一個模擬環境">在本地建一個模擬環境</a></li></ul></details></li><li class="has-children"><details><summary>Applinks 設定內容 <a href="#applinks-設定內容">#</a></summary><ul><li><a href="#ios--13-之前">iOS < 13 之前</a></li><li><a href="#ios--13-之後">iOS ≥ 13 之後</a></li><li><a href="#沒有靈感">沒有靈感？</a></li></ul></details></li><li><a href="#補充">補充</a></li><li class="has-children"><details><summary>延伸閱讀 <a href="#延伸閱讀">#</a></summary><ul><li><a href="#參考資料">參考資料</a></li></ul></details></li></ul></nav><hr /><h3 id="universal-links-新鮮事"><span class="me-2">Universal Links 新鮮事</span><a href="#universal-links-新鮮事" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>iOS 13, iOS 14 Universal Links 新鮮事＆建立本地測試環境</p><p><a href="/assets/12c5026da33d/1*HYAd1aal5Et1A-Qzs6VAtQ.webp" class="popup img-link blur"><img data-src="/assets/12c5026da33d/1*HYAd1aal5Et1A-Qzs6VAtQ.webp" alt="Photo by [NASA](https://unsplash.com/@nasa?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9Ijc5OSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Photo by <a href="https://unsplash.com/@nasa?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank">NASA</a></p><h3 id="前言"><span class="me-2">前言</span><a href="#前言" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>對於一個有網站又有 APP 的服務， Universal Links 的功能對於使用者體驗來說無比的重要，能達到 Web 與 APP 之間的無縫接軌；但一直以來都只有簡單設置，沒有太多的著墨；前陣子剛好又遇到花了點時間研究了一下，把一些有趣的事記錄下來。</p><h3 id="常見考量"><span class="me-2">常見考量</span><a href="#常見考量" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>經手過的服務，對於實作 Universal Links 的考量都是 APP 上並沒有實作完整的網站功能，Universal Links 認的是域名，只要域名匹配到就會開啟 APP；關於這個問題可以下 NOT 排除 APP 上沒有相應功能的網址，若網站服務網址很極端，那乾脆新建一個 subdomain 用來做 Universal Links。</p><h3 id="apple-app-site-association-何時更新"><span class="me-2">apple-app-site-association 何時更新？</span><a href="#apple-app-site-association-何時更新" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>iOS &lt; 14，APP 在第一次安裝、更新時會去詢問 Universal Links 網站的 apple-app-site-association。<li>iOS ≥ 14 ，則是由 Apple CDN 做快取定期更新 Universal Links 網站的 apple-app-site-association；APP 在第一次安裝、更新時會去跟 Apple CDN 拿取；但這邊就會有個問題，Apple CDN 的 apple-app-site-association 可能還是舊的。</ul><p>關於 Apple CDN 的更新機制，查了一下文件，沒有提到；查了下 <a href="https://developer.apple.com/forums/thread/651737" target="_blank">討論</a> ，官方也只回應「會定期更新」細節之後會發佈在文件…但至今依然還沒看到。</p><blockquote><p><em>我自己覺得應該最慢 48 小時，就會更新吧。。。所以下次有更改到 apple-app-site-association 的話建議在 APP 上架更新前幾天就先改好 apple-app-site-association 上線。</em></p></blockquote><h4 id="apple-app-site-association-apple-cdn-確認"><span class="me-2">apple-app-site-association Apple CDN 確認：</span><a href="#apple-app-site-association-apple-cdn-確認" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Headers: HOST=app-site-association.cdn-apple.com
GET https://app-site-association.cdn-apple.com/a/v1/你的網域
</pre></table></code></div></div><p><a href="/assets/12c5026da33d/1*dgDfMgkFPUfeuAuEhl7RFQ.webp" class="popup img-link blur"><img data-src="/assets/12c5026da33d/1*dgDfMgkFPUfeuAuEhl7RFQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjkxNiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>可以取得當前 Apple CDN 上的版本長怎樣。（記得加上 Request Header <code class="language-plaintext highlighter-rouge">Host=https://app-site-association.cdn-apple.com/</code> ）</p><h4 id="ios--14-debug"><span class="me-2">iOS ≥ 14 Debug</span><a href="#ios--14-debug" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>因前述的 CDN 問題，那我們在開發階段該如何 debug 呢？</p><p>還好這部分蘋果有給解決方法，不然沒辦法即時更新真的要吐血了；我們只需要再 <code class="language-plaintext highlighter-rouge">applinks:domain.com</code> 加上 <code class="language-plaintext highlighter-rouge">?mode=developer</code> 即可，另外還有 <code class="language-plaintext highlighter-rouge">managed(for 企業內部 APP)</code> , or <code class="language-plaintext highlighter-rouge">developer+managed</code> 模式可設定。</p><p><a href="/assets/12c5026da33d/1*z4R7wEHHAlLyF1rdAEAmew.webp" class="popup img-link blur"><img data-src="/assets/12c5026da33d/1*z4R7wEHHAlLyF1rdAEAmew.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2ODAiIGhlaWdodD0iMTM1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>加上 mode=developer 後，APP 在模擬器上每次 Build &amp; Ｒun 時都會直接跟網站拿最新的 app-site-association 來用。</p><p>如果要 Build &amp; Run 在實機則要先去「設定」-&gt;「開發者」-&gt; 打開「Associated Domains Development」選項即可。</p><p><a href="/assets/12c5026da33d/1*gj4Qm445mFERa25t6PZV1Q.webp" class="popup img-link blur"><img data-src="/assets/12c5026da33d/1*gj4Qm445mFERa25t6PZV1Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTI1IiBoZWlnaHQ9IjI0MzYiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><blockquote><p><em>⚠️ <strong>這邊有個坑</strong> ，app-site-association 可以放在網站根目錄或是 <code class="language-plaintext highlighter-rouge">./.well-known</code> 目錄下；但在 mode=developer 下他只會問 <code class="language-plaintext highlighter-rouge">./.well-known/app-site-association</code> ，害我以為怎麼沒效。</em></p></blockquote><h3 id="開發測試"><span class="me-2">開發測試</span><a href="#開發測試" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>如果是 iOS &lt;14 記得有更改過 app-site-association 的話要刪掉再重 Build &amp; Run APP 才會去抓最新的回來，iOS ≥ 14 請參考前述方法加上 mode=developer。</p><p>app-site-association 內容的修改，好一點的話可以自行修改伺服器上的檔；但對於有時候碰不到伺服器端的我們來說，如果要做 universal links 的測試會非常的麻煩，要不停的麻煩後端同事幫忙，變成要很確定 app-site-association 內容後一次上線，一直改來改去會把同事逼瘋。</p><h4 id="在本地建一個模擬環境"><span class="me-2">在本地建一個模擬環境</span><a href="#在本地建一個模擬環境" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>為了解決上述問題，我們可以在本地起一個小服務。</p><p>首先在 mac 上安裝 nginx：</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>brew <span class="nb">install </span>nginx
</pre></table></code></div></div><p>如果沒安裝過 <a href="https://brew.sh/index_zh-tw" target="_blank">brew</a> 可先安裝：</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/bin/bash <span class="nt">-c</span> <span class="s2">"</span><span class="si">$(</span>curl <span class="nt">-fsSL</span> https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh<span class="si">)</span><span class="s2">"</span>
</pre></table></code></div></div><p>安裝完 nginx 後，前往 <code class="language-plaintext highlighter-rouge">/usr/local/etc/nginx/</code> 打開編輯 <code class="language-plaintext highlighter-rouge">nginx.conf</code> 檔案：</p><div class="language-perl highlighter-rouge"><div class="code-header"> <span data-label-text="Perl"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="o">...</span><span class="err">略</span>
<span class="nv">server</span> <span class="p">{</span>
        <span class="nb">listen</span>       <span class="mi">8080</span><span class="p">;</span>
        <span class="nv">server_name</span>  <span class="nv">localhost</span><span class="p">;</span>
<span class="c1">#charset koi8-r;</span>
<span class="c1">#access_log  logs/host.access.log  main;</span>
<span class="nv">location</span> <span class="o">/</span> <span class="p">{</span>
            <span class="nv">root</span>   <span class="sr">/Users/</span><span class="nv">zhgchgli</span><span class="o">/</span><span class="nv">Documents</span><span class="p">;</span>
            <span class="nb">index</span>  <span class="nb">index</span><span class="o">.</span><span class="nv">html</span> <span class="nb">index</span><span class="o">.</span><span class="nv">htm</span><span class="p">;</span>
        <span class="p">}</span>
<span class="o">...</span><span class="err">略</span>
</pre></table></code></div></div><p>大概在第 44 行的位置將 location / 裡的 root 換成你想要的目錄位置（這邊以 Documents 為例）。</p><blockquote><p><em>listen on <strong>8080</strong> port ，如果沒有衝突則不需要修改。</em></p></blockquote><p>儲存修改完後，下指令啟動 nginx：</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nginx
</pre></table></code></div></div><p>若要停止時，則下：</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nginx <span class="nt">-s</span> stop
</pre></table></code></div></div><p>停止。</p><p>如果有更改 <code class="language-plaintext highlighter-rouge">nginx.conf</code> 記得要下：</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nginx <span class="nt">-s</span> reload
</pre></table></code></div></div><p>重新啟用服務。</p><p>建立一個 <code class="language-plaintext highlighter-rouge">./.well-known</code> 目錄在剛設定的 <code class="language-plaintext highlighter-rouge">root</code> 目錄內，並將 <code class="language-plaintext highlighter-rouge">apple-app-site-association</code> 檔案放到 <code class="language-plaintext highlighter-rouge">./.well-known</code> 內。</p><blockquote><p><em>⚠️ <code class="language-plaintext highlighter-rouge">.well-known</code> 建立後若消失，請注意 Mac 要打開「顯示隱藏資料夾」功能：</em></p></blockquote><p>在 terminal 下：</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>defaults write com.apple.finder AppleShowAllFiles TRUE
</pre></table></code></div></div><p>再下 killall finder 重啟所有 finder，即可。</p><p><a href="/assets/12c5026da33d/1*AzM6lK0kzT-M-2OdXoyIXA.webp" class="popup img-link blur"><img data-src="/assets/12c5026da33d/1*AzM6lK0kzT-M-2OdXoyIXA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzODEiIGhlaWdodD0iMTc2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><blockquote><p><em>⚠️</em> <code class="language-plaintext highlighter-rouge">apple-app-site-association</code> <em>看起來沒有副檔名，但實際還是有 .json 副檔名：</em></p></blockquote><p>在檔案上按右鍵 -&gt; 「取得資訊 Get Info」-&gt;「Name &amp; Extension」-&gt; 檢查有無副檔名＆同時可取消勾選「隱藏檔案類型 Hide extension」</p><p><a href="/assets/12c5026da33d/1*UFwnnjCot8xRqslhdQktKg.webp" class="popup img-link blur"><img data-src="/assets/12c5026da33d/1*UFwnnjCot8xRqslhdQktKg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNzciIGhlaWdodD0iNTcxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>沒問題後，打開瀏覽器測試以下連結是否正常下載 apple-app-site-association：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://localhost:8080/.well-known/apple-app-site-association
</pre></table></code></div></div><p>如果能正常下載代表本地環境模擬成功！</p><blockquote><p><em>如果出現 404/403 錯誤則請檢查 root 目錄是否正確、目錄/檔案是否有放入、apple-app-site-association 是否不小心帶了副檔名( .json)。</em></p></blockquote><p><strong>註冊＆下載 <a href="http://ngrok.com" target="_blank">Ngrok</a></strong></p><p><a href="/assets/12c5026da33d/1*Shk9u59HgRRSiMw0wt899Q.webp" class="popup img-link blur"><img data-src="/assets/12c5026da33d/1*Shk9u59HgRRSiMw0wt899Q.webp" alt="[ngrok.com](https://dashboard.ngrok.com/get-started/setup){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NjAiIGhlaWdodD0iNDY0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="https://dashboard.ngrok.com/get-started/setup" target="_blank">ngrok.com</a></p><p><a href="/assets/12c5026da33d/1*ljBqKrOFb9Gq48dO0GeIeA.webp" class="popup img-link blur"><img data-src="/assets/12c5026da33d/1*ljBqKrOFb9Gq48dO0GeIeA.webp" alt="解壓縮出 ngrok 執行檔" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDkiIGhlaWdodD0iMTY4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>解壓縮出 ngrok 執行檔</p><p><a href="/assets/12c5026da33d/1*fnEUyJMtVhUGurU5vX5K6A.webp" class="popup img-link blur"><img data-src="/assets/12c5026da33d/1*fnEUyJMtVhUGurU5vX5K6A.webp" alt="進入 [Dashboard 頁面](https://dashboard.ngrok.com/get-started/setup){:target=&quot;_blank&quot;} 執行 Config 設定" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjMzMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>進入 <a href="https://dashboard.ngrok.com/get-started/setup" target="_blank">Dashboard 頁面</a> 執行 Config 設定</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>./ngrok authtoken 你的TOKEN
</pre></table></code></div></div><p>設定好之後，下：</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>./ngrok http 8080
</pre></table></code></div></div><blockquote><p><em>因我們的 nginx 在 8080 port。</em></p></blockquote><p>啟動服務。</p><p><a href="/assets/12c5026da33d/1*8i6EP7KKwxihLZ1PG1RUGw.webp" class="popup img-link blur"><img data-src="/assets/12c5026da33d/1*8i6EP7KKwxihLZ1PG1RUGw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2ODIiIGhlaWdodD0iNDgzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>這時候我們會看到一個服務啟動狀態視窗，可以從 Forwarding 中取的此次分配到的公開網址。</p><blockquote><p><em>⚠️ <strong>每次啟動分配到的網址都會變，所以僅能作為開發測試使用。</strong></em></p></blockquote><blockquote><p><em><strong>這邊以此次分配到的網址</strong> <code class="language-plaintext highlighter-rouge">https://ec87f78bec0f.ngrok.io/</code> 為例</em></p></blockquote><p>回到瀏覽器改輸入 <code class="language-plaintext highlighter-rouge">https://ec87f78bec0f.ngrok.io/.well-known/apple-app-site-association</code> 看看能不能正常下載瀏覽 apple-app-site-association 檔案，如果沒問題則可繼續下一步。</p><p>將 ngrok 分配到的網址輸入到 Associated Domains applinks: 設定中。</p><p><a href="/assets/12c5026da33d/1*K5Eio0Yi7nNHQuLSuIsYeA.webp" class="popup img-link blur"><img data-src="/assets/12c5026da33d/1*K5Eio0Yi7nNHQuLSuIsYeA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MzMiIGhlaWdodD0iMTQxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>記得帶上 <code class="language-plaintext highlighter-rouge">?mode=developer</code> 方便我們測試。</p><p><strong>重新 Build &amp; Run APP：</strong></p><p><a href="/assets/12c5026da33d/1*VFIKU-UxCHNQVnf8DOV8Qw.webp" class="popup img-link blur"><img data-src="/assets/12c5026da33d/1*VFIKU-UxCHNQVnf8DOV8Qw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MzAiIGhlaWdodD0iNzg4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>打開瀏覽器輸入相應的 Universal Links 測試網址（EX: <code class="language-plaintext highlighter-rouge">https://ec87f78bec0f.ngrok.io/buy/123</code> ）查看效果。</p><blockquote><p><em>頁面出現 404 不要理他，因為我們實際沒有那一頁；我們只是要測 iOS 對網址匹配的功能符不符合我們預期；如果上方有出現 「Open」代表匹配成功，另外也可以測 NOT 反向的狀況。</em></p></blockquote><p>點擊「Open」後開啟 APP -&gt; 測試成功！</p><blockquote><p><em>開發階段都測試 OK 後，將確認修改過之後的 apple-app-site-association 檔案再交給後端上傳到伺服器就能確保萬無一失囉～</em></p></blockquote><blockquote><p><em>最後記得將 Associated Domains applinks: 改為正試機網址。</em></p></blockquote><p>另外我們也可以從 ngrok 運行狀態視窗中看到每次 APP Build &amp; Run 有沒有跟我們要 apple-app-site-association 檔案：</p><p><a href="/assets/12c5026da33d/1*d6yvnEaiOPbqy57PDMe2Mw.webp" class="popup img-link blur"><img data-src="/assets/12c5026da33d/1*d6yvnEaiOPbqy57PDMe2Mw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2ODIiIGhlaWdodD0iNDgzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><h3 id="applinks-設定內容"><span class="me-2">Applinks 設定內容</span><a href="#applinks-設定內容" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="ios--13-之前"><span class="me-2">iOS &lt; 13 之前：</span><a href="#ios--13-之前" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>設定檔較簡單，只有以下內容可設定：</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"applinks"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"apps"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
      </span><span class="nl">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
           </span><span class="p">{</span><span class="w">
             </span><span class="nl">"appID"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"TeamID.BundleID"</span><span class="p">,</span><span class="w">
             </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
               </span><span class="s2">"NOT /help/"</span><span class="p">,</span><span class="w">
               </span><span class="s2">"*"</span><span class="w">
             </span><span class="p">]</span><span class="w">
           </span><span class="p">}</span><span class="w">
       </span><span class="p">]</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>將 <code class="language-plaintext highlighter-rouge">TeamID.BundleId</code> 換成你的專案設定 (ex: TeamID = <code class="language-plaintext highlighter-rouge">ABCD</code> , BundleID = <code class="language-plaintext highlighter-rouge">li.zhgchg.demoapp</code> =&gt; <code class="language-plaintext highlighter-rouge">ABCD.li.zhgchg.demoapp</code> )。</p><blockquote><p><em>如果有多個 appID 則要重複加入多組。</em></p></blockquote><p><strong>paths 部分則為匹配規則，能支援以下幾種語法：</strong></p><ul><li><code class="language-plaintext highlighter-rouge">*</code> ：匹配 0~多個字元，ex: <code class="language-plaintext highlighter-rouge">/home/*</code> (home/alan…)<li><code class="language-plaintext highlighter-rouge">?</code> ：匹配 1 個字元，ex: <code class="language-plaintext highlighter-rouge">201?</code> (2010~2019)<li><code class="language-plaintext highlighter-rouge">?*</code> ：匹配 1 個~多個字元，ex: <code class="language-plaintext highlighter-rouge">/?*</code> (/test、/home. . )<li><code class="language-plaintext highlighter-rouge">NOT</code> ：反向排除，ex: <code class="language-plaintext highlighter-rouge">NOT /help</code> (any url but /help)</ul><p>更多玩法組合可自己依照實際情況決定，更多資訊可參考 <a href="https://developer.apple.com/library/archive/documentation/General/Conceptual/AppSearch/UniversalLinks.html#//apple_ref/doc/uid/TP40016308-CH12-SW1" target="_blank">官方文件</a> 。</p><blockquote><p><em>- 請注意，他不是 Regex，不支援任何 Regex 寫法。</em></p></blockquote><blockquote><p><em>- 舊版不支援 Query (?name=123)、Anchor ( #title)。</em></p></blockquote><blockquote><p><em>- 中文網址須先轉成 ASCII 後才能放在 paths 中 (所有url 字元均要是 ASCII)。</em></p></blockquote><h4 id="ios--13-之後"><span class="me-2">iOS ≥ 13 之後：</span><a href="#ios--13-之後" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>強化了設定檔內容的功能，多增加支援 Query/Anchor、字符集、編碼處理。</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="nl">"applinks"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="nl">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"appIDs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"TeamID.BundleID"</span><span class="w"> </span><span class="p">],</span><span class="w">
      </span><span class="nl">"components"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"#"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no_universal_links"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"exclude"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
          </span><span class="nl">"comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Matches any URL whose fragment equals no_universal_links and instructs the system not to open it as a universal link"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"/"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/buy/*"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Matches any URL whose path starts with /buy/"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"/"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/help/website/*"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"exclude"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
          </span><span class="nl">"comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Matches any URL whose path starts with /help/website/ and instructs the system not to open it as a universal link"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"/"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/help/*"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"?"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nl">"articleNumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"????"</span><span class="w"> </span><span class="p">},</span><span class="w">
          </span><span class="nl">"comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Matches any URL whose path starts with /help/ and that has a query item with name 'articleNumber' and a value of exactly 4 characters"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>轉貼自官方文件，可以看到格式有所改變。</p><p><code class="language-plaintext highlighter-rouge">appIDs</code> 為陣列，可放入多組 appID，這樣就不用像以前一樣只能整個區塊重複輸入。</p><blockquote><p><em>WWDC 有提到與舊版兼容， <strong>當 iOS ≥ 13 有讀到新的格式就會忽略舊的 paths</strong> 。</em></p></blockquote><p>匹配規則改放在 <code class="language-plaintext highlighter-rouge">components</code> 中；支援 3 種類型：</p><ul><li><code class="language-plaintext highlighter-rouge">/</code> ： URL<li><code class="language-plaintext highlighter-rouge">?</code> ：Query，ex: ?name=123&amp;place=tw<li><code class="language-plaintext highlighter-rouge">#</code> ：Anchor，ex: #title</ul><p>並且可以搭配使用，假設今天 <code class="language-plaintext highlighter-rouge">/user/?id=100#detail</code> 才需要跳到 APP 則可寫成：</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"/"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/user/*"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"?"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="nl">"#"</span><span class="p">:</span><span class="w"> </span><span class="s2">"detail"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>其中匹配語法同原本語法，也是支援 <code class="language-plaintext highlighter-rouge">*</code> <code class="language-plaintext highlighter-rouge">?</code> <code class="language-plaintext highlighter-rouge">?*</code> 。</p><p>新增 <code class="language-plaintext highlighter-rouge">comment</code> 註解欄位，可輸入註解方便辨識。（但請注意這是公開的，別人也看得到）</p><p>反向排除則改為指定 <code class="language-plaintext highlighter-rouge">exclude: true</code> 。</p><p>新增 <code class="language-plaintext highlighter-rouge">caseSensitive</code> 指定功能，可指定匹配規則是否對大小寫敏感， <code class="language-plaintext highlighter-rouge">預設：true</code> ，有這需求的話可以少寫許多規則。</p><p>新增 <code class="language-plaintext highlighter-rouge">percentEncoded</code> 前面說到的，舊版需要先將網址轉為 ASCII 放到 paths 中（如果是中文字會變得很醜無法辨識）；這個參數就是是否要幫我們自動 encode， <code class="language-plaintext highlighter-rouge">預設是 true</code> 。 假設是中文網址就能直接放入了(ex: <code class="language-plaintext highlighter-rouge">/客服中心</code> )。</p><p>詳細官方文件可 <a href="https://developer.apple.com/documentation/bundleresources/applinks/details/components" target="_blank">參考此</a> 。</p><p><strong>預設字符集：</strong></p><p>這算是這次更新蠻重要的功能之一，新增支援字符集。</p><p>系統幫我們定義好的字符集：</p><ul><li><code class="language-plaintext highlighter-rouge">$(alpha)</code> ：A-Z 和 a-z<li><code class="language-plaintext highlighter-rouge">$(upper)</code> ：A-Z<li><code class="language-plaintext highlighter-rouge">$(lower)</code> ：a-z<li><code class="language-plaintext highlighter-rouge">$(alnum)</code> ：A-Z 和 a-z 和 0–9<li><code class="language-plaintext highlighter-rouge">$(digit)</code> ：0–9<li><code class="language-plaintext highlighter-rouge">$(xdigit)</code> ：十六進制字符，0–9 和 a,b,c,d,e,f,A,B,C,D,E,F<li><code class="language-plaintext highlighter-rouge">$(region)</code> ：ISO 地區編碼 <a href="https://developer.apple.com/documentation/foundation/locale/2293271-isoregioncodes" target="_blank">isoRegionCodes</a> ，Ex: TW<li><code class="language-plaintext highlighter-rouge">$(lang)</code> ：ISO 語言編碼 <a href="https://developer.apple.com/documentation/foundation/locale/2293744-isolanguagecodes" target="_blank">isoLanguageCodes</a> ，Ex: zh</ul><p>假設我們的網址有多語系，我想要支援 Universal links 時，可以這樣設定：</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nl">"components"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">        
     </span><span class="p">{</span><span class="w"> </span><span class="nl">"/"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"/$(lang)-$(region)/$(food)/home"</span><span class="w"> </span><span class="p">}</span><span class="w">      
</span><span class="p">]</span><span class="w">
</span></pre></table></code></div></div><p>這樣不管是 <code class="language-plaintext highlighter-rouge">/zh-TW/home</code> 、 <code class="language-plaintext highlighter-rouge">/en-US/home</code> 都能支援，非常方便，不用自己寫一整排規則！</p><p><strong>自訂字符集：</strong></p><p>除了預設字符集之外，我們也能自訂字符集，增加設定檔復用、可讀性。</p><p>在 <code class="language-plaintext highlighter-rouge">applinks</code> 中加入 <code class="language-plaintext highlighter-rouge">substitutionVariables</code> 即可：</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"applinks"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"substitutionVariables"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"food"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"burrito"</span><span class="p">,</span><span class="w"> </span><span class="s2">"pizza"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sushi"</span><span class="p">,</span><span class="w"> </span><span class="s2">"samosa"</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
      </span><span class="nl">"appIDs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">],</span><span class="w">
      </span><span class="nl">"components"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="nl">"/"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"/$(food)/"</span><span class="w"> </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>範例中自訂了一個 <code class="language-plaintext highlighter-rouge">food</code> 字符集，並在後續 <code class="language-plaintext highlighter-rouge">components</code> 中使用。</p><p>以上範例可匹配 <code class="language-plaintext highlighter-rouge">/burrito</code> , <code class="language-plaintext highlighter-rouge">/pizza</code> , <code class="language-plaintext highlighter-rouge">/sushi</code> , <code class="language-plaintext highlighter-rouge">/samosa</code> 。</p><p>細節可參考 <a href="https://developer.apple.com/documentation/bundleresources/applinks/substitutionvariables" target="_blank">此篇</a> 官方文件。</p><h4 id="沒有靈感"><span class="me-2">沒有靈感？</span><a href="#沒有靈感" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>如果對設定檔內容沒有靈感，可偷偷參考其他網站福的內容，只要在服務網站首頁網址加上 <code class="language-plaintext highlighter-rouge">/app-site-association</code> 或 <code class="language-plaintext highlighter-rouge">/.well-known/app-site-association</code> 即可讀取他們的設定。</p><p>例如： <a href="https://www.netflix.com/apple-app-site-association" target="_blank">https://www.netflix.com/apple-app-site-association</a></p><h3 id="補充"><span class="me-2">補充</span><a href="#補充" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>在有使用 <code class="language-plaintext highlighter-rouge">SceneDelegate</code> 的情況下，open universal link 的進入點是在SceneDelegate 中：</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">scene</span><span class="p">(</span><span class="n">_</span> <span class="nv">scene</span><span class="p">:</span> <span class="kt">UIScene</span><span class="p">,</span> <span class="k">continue</span> <span class="nv">userActivity</span><span class="p">:</span> <span class="kt">NSUserActivity</span><span class="p">)</span>
</pre></table></code></div></div><p><strong>而非 AppDelegate 的：</strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="n">_</span> <span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span> <span class="k">continue</span> <span class="nv">userActivity</span><span class="p">:</span> <span class="kt">NSUserActivity</span><span class="p">,</span> <span class="nv">restorationHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">([</span><span class="kt">UIUserActivityRestoring</span><span class="p">]?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>
</pre></table></code></div></div><h3 id="延伸閱讀"><span class="me-2">延伸閱讀</span><a href="#延伸閱讀" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><a href="/posts/zrealm-dev/ios-%E8%B7%A8%E5%B9%B3%E5%8F%B0%E5%B8%B3%E8%99%9F%E5%AF%86%E7%A2%BC%E6%95%B4%E5%90%88-%E6%8F%90%E5%8D%87-app-%E8%88%87%E7%B6%B2%E7%AB%99%E7%99%BB%E5%85%A5%E9%AB%94%E9%A9%97-%E5%BF%AB%E9%80%9F%E8%87%AA%E5%8B%95%E5%A1%AB%E5%85%A5%E5%AF%86%E7%A2%BC-948ed34efa09/">iOS 跨平台帳號密碼整合，加強登入體驗</a><li><a href="/posts/zrealm-dev/ios-deferred-deep-link-%E5%BB%B6%E9%81%B2%E6%B7%B1%E5%BA%A6%E9%80%A3%E7%B5%90%E5%AF%A6%E4%BD%9C-swift-%E5%AE%8C%E6%95%B4%E6%B5%81%E7%A8%8B%E8%88%87%E6%8A%80%E5%B7%A7%E8%A7%A3%E6%9E%90-b08ef940c196/">iOS Deferred Deep Link 延遲深度連結實作(Swift)</a></ul><h4 id="參考資料"><span class="me-2">參考資料</span><a href="#參考資料" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://www.wwdcnotes.com/notes/wwdc20/10098/" target="_blank">What’s new in Universal Links</a><li><a href="https://developer.apple.com/documentation/bundleresources/applinks" target="_blank">Apple Documentation</a></ul><p>有任何問題及指教歡迎 <a href="https://www.zhgchg.li/contact" target="_blank">與我聯絡</a> 。</p><hr /><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=🍺&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a><br /></p><blockquote class="prompt-info"><p>本文首次發表於 Medium (<a href="https://medium.com/p/12c5026da33d" target="_blank"><strong>點此查看原始版本</strong></a>)，由 <a href="/posts/tools/medium-to-jekyll/" target="_blank">ZMediumToMarkdown</a> 提供自動轉換與同步技術。</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/zh-tw/zmediumtomarkdown/2021-02-04-12c5026da33d.md" target="_blank">Improve this page on Github.</a></p></blockquote><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1K+ Followers</span></a></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-dev/">ZRealm Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/ios/" class="post-tag no-text-decoration" >ios</a> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/universal-links/" class="post-tag no-text-decoration" >universal-links</a> <a href="/tags/app-store/" class="post-tag no-text-decoration" >app-store</a> <a href="/tags/deeplink/" class="post-tag no-text-decoration" >deeplink</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Universal%20Links%20iOS%20%E9%96%8B%E7%99%BC%E6%94%BB%E7%95%A5%EF%BD%9C%E8%A8%AD%E5%AE%9A%E6%8A%80%E5%B7%A7%E8%88%87%E6%9C%AC%E5%9C%B0%E6%B8%AC%E8%A9%A6%E7%92%B0%E5%A2%83%E6%90%AD%E5%BB%BA%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Funiversal-links-ios-%25E9%2596%258B%25E7%2599%25BC%25E6%2594%25BB%25E7%2595%25A5-%25E8%25A8%25AD%25E5%25AE%259A%25E6%258A%2580%25E5%25B7%25A7%25E8%2588%2587%25E6%259C%25AC%25E5%259C%25B0%25E6%25B8%25AC%25E8%25A9%25A6%25E7%2592%25B0%25E5%25A2%2583%25E6%2590%25AD%25E5%25BB%25BA-12c5026da33d%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Universal%20Links%20iOS%20%E9%96%8B%E7%99%BC%E6%94%BB%E7%95%A5%EF%BD%9C%E8%A8%AD%E5%AE%9A%E6%8A%80%E5%B7%A7%E8%88%87%E6%9C%AC%E5%9C%B0%E6%B8%AC%E8%A9%A6%E7%92%B0%E5%A2%83%E6%90%AD%E5%BB%BA%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Funiversal-links-ios-%25E9%2596%258B%25E7%2599%25BC%25E6%2594%25BB%25E7%2595%25A5-%25E8%25A8%25AD%25E5%25AE%259A%25E6%258A%2580%25E5%25B7%25A7%25E8%2588%2587%25E6%259C%25AC%25E5%259C%25B0%25E6%25B8%25AC%25E8%25A9%25A6%25E7%2592%25B0%25E5%25A2%2583%25E6%2590%25AD%25E5%25BB%25BA-12c5026da33d%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Funiversal-links-ios-%25E9%2596%258B%25E7%2599%25BC%25E6%2594%25BB%25E7%2595%25A5-%25E8%25A8%25AD%25E5%25AE%259A%25E6%258A%2580%25E5%25B7%25A7%25E8%2588%2587%25E6%259C%25AC%25E5%259C%25B0%25E6%25B8%25AC%25E8%25A9%25A6%25E7%2592%25B0%25E5%25A2%2583%25E6%2590%25AD%25E5%25BB%25BA-12c5026da33d%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/en/line-bank-to-firstrade-transfer-fast-deposit-150-nt-fee-guide-with-account-upgrade-fee-subsidy-e4d139fe0685/">LINE Bank to Firstrade Transfer｜Fast Deposit & 150 NT Fee Guide with Account Upgrade & Fee Subsidy</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/zh-cn/line-bank-%E5%85%A5%E9%87%91-firstrade-%E6%95%99%E5%AD%A6-%E5%BF%AB%E9%80%9F%E5%88%B0%E5%B8%90-%E4%BD%8E%E6%89%8B%E7%BB%AD%E8%B4%B9150%E5%85%83-%E5%B8%90%E6%88%B7%E5%8D%87%E7%BA%A7%E4%B8%8E%E6%89%8B%E7%BB%AD%E8%B4%B9%E8%A1%A5%E5%8A%A9%E7%94%B3%E8%AF%B7%E5%85%A8%E6%94%BB%E7%95%A5-e4d139fe0685/">手把手教学 — LINE Bank 入金 Firstrade 快速到帐、手续费只要 150 元及帐户升级/约定转帐/手续费补助申请教学</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/line-bank-%E5%85%A5%E9%87%91-firstrade-%E6%95%99%E5%AD%B8-%E5%BF%AB%E9%80%9F%E5%88%B0%E5%B8%B3-%E4%BD%8E%E6%89%8B%E7%BA%8C%E8%B2%BB150%E5%85%83-%E5%B8%B3%E6%88%B6%E5%8D%87%E7%B4%9A%E8%88%87%E6%89%8B%E7%BA%8C%E8%B2%BB%E8%A3%9C%E5%8A%A9%E7%94%B3%E8%AB%8B%E5%85%A8%E6%94%BB%E7%95%A5-e4d139fe0685/">手把手教學 — LINE Bank 入金 Firstrade 快速到帳、手續費只要 150 元及帳戶升級/約定轉帳/手續費補助申請教學</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/en/japan-overseas-shopping-rakuten-consolidated-shipping-for-taiwan-buy-from-rakuten-amazon-bea62c251f1b/">Japan Overseas Shopping｜Rakuten Consolidated Shipping for Taiwan｜Buy from Rakuten & Amazon</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/zh-cn/%E6%97%A5%E6%9C%AC%E4%B9%90%E5%A4%A9%E9%9B%86%E8%BF%90%E6%95%99%E5%AD%A6-%E5%BF%AB%E9%80%9F%E8%B4%AD%E4%B9%B0horie%E9%92%9B%E6%9D%AF%E4%B8%8Eamazon%E5%95%86%E5%93%81%E5%AF%84%E9%80%81%E5%8F%B0%E6%B9%BE%E5%85%A8%E6%94%BB%E7%95%A5-bea62c251f1b/">日本海外购物寄送台湾教学 — 使用乐天集运购买乐天拍卖与 Amazon 商品 (Horie 钛杯)</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">章節 (Chapters)🔖</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-dev/zh-cn/universal-links-ios-%E5%BC%80%E5%8F%91%E6%94%BB%E7%95%A5-%E8%AE%BE%E5%AE%9A%E6%8A%80%E5%B7%A7%E4%B8%8E%E6%9C%AC%E5%9C%B0%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-12c5026da33d/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1612411045" data-df="ll" > Feb 4, 2021 </time><h4 class="pt-0 my-2">Universal Links iOS 开发攻略｜设定技巧与本地测试环境搭建</h4><div class="text-muted"><p>掌握 iOS Universal Links 设定与更新机制，解决 Apple CDN 快取延迟问题，并透过本地 nginx + ngrok 环境快速模拟测试，提升多域名与复杂路径匹配准确度，确保 APP 与网站无缝串接体验。</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/ios-deferred-deep-link-%E5%BB%B6%E9%81%B2%E6%B7%B1%E5%BA%A6%E9%80%A3%E7%B5%90%E5%AF%A6%E4%BD%9C-swift-%E5%AE%8C%E6%95%B4%E6%B5%81%E7%A8%8B%E8%88%87%E6%8A%80%E5%B7%A7%E8%A7%A3%E6%9E%90-b08ef940c196/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1573482897" data-df="ll" > Nov 11, 2019 </time><h4 class="pt-0 my-2">iOS Deferred Deep Link 延遲深度連結實作｜Swift 完整流程與技巧解析</h4><div class="text-muted"><p>針對iOS App推廣，解決未安裝用戶跳轉後資料遺失問題，透過剪貼簿與Cookie共享技術，實現安裝後自動還原目標頁面，提升用戶體驗與轉換率。本文詳解Swift實作步驟與iOS版本支援策略。</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/zh-cn/ios-deferred-deep-link-%E5%BB%B6%E8%BF%9F%E6%B7%B1%E5%BA%A6%E8%BF%9E%E7%BB%93%E5%AE%9E%E4%BD%9C-swift-%E5%AE%8C%E6%95%B4%E6%B5%81%E7%A8%8B%E4%B8%8E%E6%8A%80%E5%B7%A7%E8%A7%A3%E6%9E%90-b08ef940c196/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1573482897" data-df="ll" > Nov 11, 2019 </time><h4 class="pt-0 my-2">iOS Deferred Deep Link 延迟深度连结实作｜Swift 完整流程与技巧解析</h4><div class="text-muted"><p>针对iOS App推广，解决未安装用户跳转后资料遗失问题，透过剪贴簿与Cookie共享技术，实现安装后自动还原目标页面，提升用户体验与转换率。本文详解Swift实作步骤与iOS版本支援策略。</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-dev/zh-cn/universal-links-ios-%E5%BC%80%E5%8F%91%E6%94%BB%E7%95%A5-%E8%AE%BE%E5%AE%9A%E6%8A%80%E5%B7%A7%E4%B8%8E%E6%9C%AC%E5%9C%B0%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-12c5026da33d/" class="btn btn-outline-primary" aria-label="Older" ><p>Universal Links iOS 开发攻略｜设定技巧与本地测试环境搭建</p></a> <a href="/posts/zrealm-dev/en/laravel-homestead-setup-phpmyadmin-integration-for-mysql-management-87090f101b9a/" class="btn btn-outline-primary" aria-label="Newer" ><p>Laravel Homestead Setup｜phpMyAdmin Integration for MySQL Management</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span> <a href="/">中文</a>|<a href="/tags/simplified-chinese">简中</a>|<a href="/tags/english/">English</a></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a> <br/></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
