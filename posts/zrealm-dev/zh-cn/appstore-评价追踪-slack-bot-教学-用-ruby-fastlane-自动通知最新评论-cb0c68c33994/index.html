<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="AppStore 评价追踪 Slack Bot 教学｜用 Ruby + Fastlane 自动通知最新评论" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="iOS 开发者面对 AppStore 评价难即时监控，透过 Ruby 与 Fastlane 自动化取得最新评论，搭配 Slack 通知，有效避免旧评价干扰，提升回应效率与用户体验。" /><meta property="og:description" content="iOS 开发者面对 AppStore 评价难即时监控，透过 Ruby 与 Fastlane 自动化取得最新评论，搭配 Slack 通知，有效避免旧评价干扰，提升回应效率与用户体验。" /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-dev/zh-cn/appstore-%E8%AF%84%E4%BB%B7%E8%BF%BD%E8%B8%AA-slack-bot-%E6%95%99%E5%AD%A6-%E7%94%A8-ruby-fastlane-%E8%87%AA%E5%8A%A8%E9%80%9A%E7%9F%A5%E6%9C%80%E6%96%B0%E8%AF%84%E8%AE%BA-cb0c68c33994/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-dev/zh-cn/appstore-%E8%AF%84%E4%BB%B7%E8%BF%BD%E8%B8%AA-slack-bot-%E6%95%99%E5%AD%A6-%E7%94%A8-ruby-fastlane-%E8%87%AA%E5%8A%A8%E9%80%9A%E7%9F%A5%E6%9C%80%E6%96%B0%E8%AF%84%E8%AE%BA-cb0c68c33994/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/cb0c68c33994/1*BMCG3cu21W5MbODBbhI-sA.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-04-21T23:16:31+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/cb0c68c33994/1*BMCG3cu21W5MbODBbhI-sA.webp" /><meta property="twitter:title" content="AppStore 评价追踪 Slack Bot 教学｜用 Ruby + Fastlane 自动通知最新评论" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://medium.com/@zhgchgli/"},"dateModified":"2024-04-14T00:38:28+08:00","datePublished":"2021-04-21T23:16:31+08:00","description":"iOS 开发者面对 AppStore 评价难即时监控，透过 Ruby 与 Fastlane 自动化取得最新评论，搭配 Slack 通知，有效避免旧评价干扰，提升回应效率与用户体验。","headline":"AppStore 评价追踪 Slack Bot 教学｜用 Ruby + Fastlane 自动通知最新评论","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+","url":"https://zhgchg.li/assets/cb0c68c33994/1*BMCG3cu21W5MbODBbhI-sA.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-dev/zh-cn/appstore-%E8%AF%84%E4%BB%B7%E8%BF%BD%E8%B8%AA-slack-bot-%E6%95%99%E5%AD%A6-%E7%94%A8-ruby-fastlane-%E8%87%AA%E5%8A%A8%E9%80%9A%E7%9F%A5%E6%9C%80%E6%96%B0%E8%AF%84%E8%AE%BA-cb0c68c33994/"},"url":"https://zhgchg.li/posts/zrealm-dev/zh-cn/appstore-%E8%AF%84%E4%BB%B7%E8%BF%BD%E8%B8%AA-slack-bot-%E6%95%99%E5%AD%A6-%E7%94%A8-ruby-fastlane-%E8%87%AA%E5%8A%A8%E9%80%9A%E7%9F%A5%E6%9C%80%E6%96%B0%E8%AF%84%E8%AE%BA-cb0c68c33994/"}</script><title>AppStore 评价追踪 Slack Bot 教学｜用 Ruby + Fastlane 自动通知最新评论 | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script><link rel="alternate" hreflang="en" href="/posts/zrealm-dev/en/appstore-reviews-bot-automate-app-review-tracking-with-slack-notifications-cb0c68c33994/"><link rel="alternate" hreflang="zh-Hant" href="/posts/zrealm-dev/appstore-%E8%A9%95%E5%83%B9%E8%BF%BD%E8%B9%A4-slack-bot-%E6%95%99%E5%AD%B8-%E7%94%A8-ruby-fastlane-%E8%87%AA%E5%8B%95%E9%80%9A%E7%9F%A5%E6%9C%80%E6%96%B0%E8%A9%95%E8%AB%96-cb0c68c33994/"><link rel="alternate" hreflang="zh-Hans" href="/posts/zrealm-dev/zh-cn/appstore-%E8%AF%84%E4%BB%B7%E8%BF%BD%E8%B8%AA-slack-bot-%E6%95%99%E5%AD%A6-%E7%94%A8-ruby-fastlane-%E8%87%AA%E5%8A%A8%E9%80%9A%E7%9F%A5%E6%9C%80%E6%96%B0%E8%AF%84%E8%AE%BA-cb0c68c33994/"><link rel="alternate" hreflang="x-default" href="/posts/zrealm-dev/zh-cn/appstore-%E8%AF%84%E4%BB%B7%E8%BF%BD%E8%B8%AA-slack-bot-%E6%95%99%E5%AD%A6-%E7%94%A8-ruby-fastlane-%E8%87%AA%E5%8A%A8%E9%80%9A%E7%9F%A5%E6%9C%80%E6%96%B0%E8%AF%84%E8%AE%BA-cb0c68c33994/"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0">An iOS, web, and automation developer from Taiwan 🇹🇼 who also loves sharing, traveling, and writing.</p><a href="https://medium.com/@zhgchgli" target="_blank" style="display: block;text-align: center;font-style: normal;/* text-decoration: underline; */font-size: 1.2em;color: var(--heading-color);">1K+ Followers on Medium</a></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/english/" class="nav-link"> <i class="fa-fw fa fa-solid fa-language"></i> <span>ENGLISH POSTS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>AppStore 评价追踪 Slack Bot 教学｜用 Ruby + Fastlane 自动通知最新评论</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>AppStore 评价追踪 Slack Bot 教学｜用 Ruby + Fastlane 自动通知最新评论</h1><p class="post-desc fw-light mb-4">iOS 开发者面对 AppStore 评价难即时监控，透过 Ruby 与 Fastlane 自动化取得最新评论，搭配 Slack 通知，有效避免旧评价干扰，提升回应效率与用户体验。</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1619018191" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 21, 2021 </time> </span> <span> Updated <time data-ts="1713026308" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 13, 2024 </time> </span><div class="mt-3 mb-3"> <a href="/assets/cb0c68c33994/1*BMCG3cu21W5MbODBbhI-sA.webp" class="popup img-link preview-img blur"><img data-src="/assets/cb0c68c33994/1*BMCG3cu21W5MbODBbhI-sA.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></div><div class="d-flex justify-content-between"> <span style="display: inline-flex; align-items: center; gap: 4px;"> By <em> <a href="https://medium.com/@zhgchgli/">ZhgChgLi</a> </em> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" style="display: block; "><path fill="#007bff" d="M271.2 56C265.1 49.8 256.2 47.3 247.8 49.6C239.4 51.9 232.9 58.4 230.8 66.8L215.5 127C214.4 131.4 209.9 134 205.6 132.7L145.8 115.9C137.4 113.5 128.4 115.9 122.3 122C116.2 128.1 113.8 137.1 116.2 145.5L133.1 205.3C134.3 209.6 131.7 214.1 127.4 215.2L67.1 230.5C58.7 232.6 52.1 239.2 49.8 247.6C47.5 256 50 264.9 56.2 271L100.7 314.3C103.9 317.4 103.9 322.6 100.7 325.8L56.3 369.1C50.1 375.2 47.6 384.1 49.9 392.5C52.2 400.9 58.8 407.4 67.2 409.6L127.4 424.9C131.8 426 134.4 430.5 133.1 434.8L116.2 494.5C113.8 502.9 116.2 511.9 122.3 518C128.4 524.1 137.4 526.5 145.8 524.1L205.6 507.2C209.9 506 214.4 508.6 215.5 512.9L230.8 573.1C232.9 581.5 239.5 588.1 247.9 590.4C256.3 592.7 265.2 590.2 271.3 584L314.6 539.5C317.7 536.3 322.9 536.3 326.1 539.5L369.3 584C375.4 590.2 384.3 592.7 392.7 590.4C401.1 588.1 407.6 581.5 409.8 573.1L425.1 513C426.2 508.6 430.7 506 435 507.3L494.8 524.2C503.2 526.6 512.2 524.2 518.3 518.1C524.4 512 526.8 503 524.4 494.6L507.5 434.8C506.3 430.5 508.9 426 513.2 424.9L573.4 409.6C581.8 407.5 588.4 400.9 590.7 392.5C593 384.1 590.5 375.1 584.3 369.1L539.8 325.8C536.6 322.7 536.6 317.5 539.8 314.3L584.3 271C590.5 264.9 593 256 590.7 247.6C588.4 239.2 581.8 232.7 573.4 230.5L513.2 215.2C508.8 214.1 506.2 209.6 507.5 205.3L524.4 145.5C526.8 137.1 524.4 128.1 518.3 122C512.2 115.9 503.2 113.5 494.8 115.9L435 132.8C430.7 134 426.2 131.4 425.1 127.1L409.8 66.8C407.7 58.4 401.1 51.8 392.7 49.5C384.3 47.2 375.4 49.7 369.3 55.9L326 100.5C322.9 103.7 317.7 103.7 314.5 100.5L271.2 56z"/><path d="M250 330 l60 60 100 -140" stroke="#ffffff" stroke-width="40" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="3338 words" > <em>18 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">AppStore 评价追踪 Slack Bot 教学｜用 Ruby + Fastlane 自动通知最新评论</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">章節 (Chapters)🔖</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">AppStore 评价追踪 Slack Bot 教学｜用 Ruby + Fastlane 自动通知最新评论</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/en/appstore-reviews-bot-automate-app-review-tracking-with-slack-notifications-cb0c68c33994/"><strong>Click here</strong></a> to view the English version of this article.</p></blockquote><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/appstore-%E8%A9%95%E5%83%B9%E8%BF%BD%E8%B9%A4-slack-bot-%E6%95%99%E5%AD%B8-%E7%94%A8-ruby-fastlane-%E8%87%AA%E5%8B%95%E9%80%9A%E7%9F%A5%E6%9C%80%E6%96%B0%E8%A9%95%E8%AB%96-cb0c68c33994/"><strong>點擊這裡</strong></a>查看本文章正體中文版本。</p></blockquote><blockquote class="prompt-info"><p>基于 SEO 考量，本文标题与描述经 AI 调整，原始版本请参考内文。</p></blockquote><hr /><h3 id="appstore-apps-reviews-slack-bot-那些事"><span class="me-2">AppStore APP’s Reviews Slack Bot 那些事</span><a href="#appstore-apps-reviews-slack-bot-那些事" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>使用 Ruby+Fastlane-SpaceShip 动手打造 APP 评价追踪通知 Slack 机器人</p><p><a href="/assets/cb0c68c33994/1*BMCG3cu21W5MbODBbhI-sA.webp" class="popup img-link blur"><img data-src="/assets/cb0c68c33994/1*BMCG3cu21W5MbODBbhI-sA.webp" alt="Photo by [Austin Distel](https://unsplash.com/@austindistel?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjgwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Photo by <a href="https://unsplash.com/@austindistel?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank">Austin Distel</a></p><h4 id="吃米不知米价"><span class="me-2">吃米不知米价</span><a href="#吃米不知米价" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/cb0c68c33994/1*Iv6qvrBfyv3bU1NK1hPVHg.webp" class="popup img-link blur"><img data-src="/assets/cb0c68c33994/1*Iv6qvrBfyv3bU1NK1hPVHg.webp" alt="[AppReviewBot 为例](https://appreviewbot.com){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjMiIGhlaWdodD0iMjA2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="https://appreviewbot.com" target="_blank">AppReviewBot 为例</a></p><p>最近才知道 Slack 中转发 APP 最新评价讯息的机器人是要付费的，我一直以为这功能是免费的；费用从 $5 到 $200 美金/月都有，因为各平台都不会只做「App Review Bot」的功能，其他还有数据统计、纪录、统一后台、与竞品比较…等等，费用也是照各平台能提供的服务为标准；Review Bot 只是他们的一环，但我就只想用这个功能其他不需要，如果是这样付费蛮浪费的。</p><h3 id="问题"><span class="me-2">问题</span><a href="#问题" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>本来是用免费开源的工具 <a href="https://github.com/TradeMe/ReviewMe" target="_blank">TradeMe/ReviewMe</a> 来做 Slack 通知，但这个工具已年久失修，时不时 Slack 会爆喷一些旧的评价，看得让人心惊胆颤（很多 Bug 都早已修复，害我们以为又有问题！），原因不明。</p><p>所以考虑找其他工具、方法取代。</p><h3 id="tldr-20220810-update"><span class="me-2">TL;DR [2022/08/10] Update:</span><a href="#tldr-20220810-update" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>现已改用全新的 <a href="/posts/zrealm-dev/zh-cn/app-store-connect-api-%E5%BF%AB%E9%80%9F%E8%AF%BB%E5%8F%96%E4%B8%8E%E7%AE%A1%E7%90%86-customer-reviews-%E6%8F%90%E5%8D%87-ios-app-%E8%AF%84%E4%BB%B7%E6%95%B4%E5%90%88%E6%95%88%E7%8E%87-f1365e51902c/">App Store Connect API</a> 重新设计 App Reviews Bot，并更名重新推出「 <a href="/posts/zrealm-dev/zh-cn/zreviewtender-%E5%85%8D%E8%B4%B9%E5%BC%80%E6%BA%90-app-%E8%AF%84%E4%BB%B7%E7%9B%91%E6%8E%A7%E6%9C%BA%E5%99%A8%E4%BA%BA-%E8%87%AA%E5%8A%A8%E6%95%B4%E5%90%88-slack-%E4%B8%8E-google-sheet-e36e48bb9265/">ZReviewTender — 免费开源的 App Reviews 监控机器人</a> 」。</p><p>====</p><h3 id="20220720-update"><span class="me-2">2022/07/20 Update</span><a href="#20220720-update" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/posts/zrealm-dev/zh-cn/app-store-connect-api-%E5%BF%AB%E9%80%9F%E8%AF%BB%E5%8F%96%E4%B8%8E%E7%AE%A1%E7%90%86-customer-reviews-%E6%8F%90%E5%8D%87-ios-app-%E8%AF%84%E4%BB%B7%E6%95%B4%E5%90%88%E6%95%88%E7%8E%87-f1365e51902c/">App Store Connect API 现已支援 读取和管理 Customer Reviews</a> ，App Store Connect API 原生已支援存取 App 评价， <strong>不需要再使用</strong> Fastlane — Spaceship 去后台拿评价。</p><h3 id="原理探究"><span class="me-2">原理探究</span><a href="#原理探究" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>有了动机之后，再来研究下达成目标的原理。</p><h4 id="官方-api-"><span class="me-2">官方 API ❌</span><a href="#官方-api-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>苹果有提供 <a href="https://developer.apple.com/app-store-connect/api/" target="_blank">App Store Connect API</a> ，但没提供捞取评价功能。</p><p>[2022/07/20 更新]： <a href="/posts/zrealm-dev/zh-cn/app-store-connect-api-%E5%BF%AB%E9%80%9F%E8%AF%BB%E5%8F%96%E4%B8%8E%E7%AE%A1%E7%90%86-customer-reviews-%E6%8F%90%E5%8D%87-ios-app-%E8%AF%84%E4%BB%B7%E6%95%B4%E5%90%88%E6%95%88%E7%8E%87-f1365e51902c/">App Store Connect API 现已支援 读取和管理 Customer Reviews</a></p><h4 id="public-url-api-rss-️"><span class="me-2">Public URL API (RSS) ⚠️</span><a href="#public-url-api-rss-️" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>苹果有提供公开的 APP 评价 <a href="https://rss.itunes.apple.com/zh-tw" target="_blank">RSS 订阅网址</a> ，而且除了 rss xml 还提供 json 格式。</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://itunes.apple.com/国家码/rss/customerreviews/id=APP_ID/page=1/sortBy=mostRecent/json
</pre></table></code></div></div><ul><li><p>国家码：可参考 <a href="https://help.apple.com/app-store-connect/#/dev997f9cf7c" target="_blank">这份文件</a> 。</p><li><p>APP_ID：前往 App 网页版，会得到网址：https://apps.apple.com/tw/app/APP名称/id <strong>12345678</strong> ，id 后面的数字及为 App ID（纯数字）。</p><li><p>page：可请求 1~10 页，超过无法取得。</p><li><p>sortBy： <code class="language-plaintext highlighter-rouge">mostRecent/json</code> 请求最新的＆ json 格式，也可改为 <code class="language-plaintext highlighter-rouge">mostRecent/xml</code> 则为 xml 格式。</p></ul><p><strong>评价资料回传如下：</strong></p><p>rss.json:</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"author"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"uri"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://itunes.apple.com/tw/reviews/id123456789"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"im:version"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4.27.1"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"im:rating"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456789"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"很棒的存在！"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"人生值得了～"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"link"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"rel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"related"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://itunes.apple.com/tw/review?id=123456789&amp;type=Purple%20Software"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"im:voteSum"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"im:contentType"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"term"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Application"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"应用程式"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"im:voteCount"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p><strong>优点：</strong></p><ol><li><p>公开、不需身份验证步骤即可存取</p><li><p>简单好用</p></ol><p><strong>缺点：</strong></p><ol><li><p>此 RSS API 很老旧都没更新</p><li><p>回传评价的资讯太少（没留言时间、已编辑过评价？、已回复？）</p><li><p>遇到资料错乱问题（后面几页偶尔会突然喷旧资料）</p><li><p>最多存取 10 页</p></ol><blockquote><p><em>关于我们遇到的最大问题是 3；但这部分不确定是我们用的 <a href="https://github.com/TradeMe/ReviewMe" target="_blank">Bot 工具</a> 问题，还是这个 RSS URL 资料有问题。</em></p></blockquote><h4 id="private-url-api-"><span class="me-2">Private URL API ✅</span><a href="#private-url-api-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>这个方法说来有点旁门左道，也是我突发奇想发现的；但在后续参考了其他 Review Bot 做法之后发现很多网站也都是这样用，应该没什么问题而且我 4~5 年前就看过有工具这样做了，只是当时没深入研究。</p><p><strong>优点：</strong></p><ol><li><p>同苹果后台资料</p><li><p>资料完整且最新</p><li><p>可做更多细节筛选</p><li><p>具备深度整合的 APP 工具也是用这个方法（AppRadar/AppReviewBot…）</p></ol><p><strong>缺点：</strong></p><ol><li><p>非官方公布方法（旁门左道）</p><li><p>因苹果实行全面两步骤登入，所以登入 session 需要定期更新。</p></ol><p><strong>第一步 — 嗅探 App Store Connect 后台评论区块 Load 资料的 API：</strong></p><p><a href="/assets/cb0c68c33994/1*74lbicQ_vPzrLfm1imk7Pg.webp" class="popup img-link blur"><img data-src="/assets/cb0c68c33994/1*74lbicQ_vPzrLfm1imk7Pg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MDAiIGhlaWdodD0iMzY3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>得到苹果后台是透过打：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://appstoreconnect.apple.com/WebObjects/iTunesConnect.woa/ra/apps/APP_ID/platforms/ios/reviews?index=0&amp;sort=REVIEW_SORT_ORDER_MOST_RECENT
</pre></table></code></div></div><p>这个 endpoint 取得评价列表：</p><p><a href="/assets/cb0c68c33994/1*I00Znmzaivm_-7ous0-4Pw.webp" class="popup img-link blur"><img data-src="/assets/cb0c68c33994/1*I00Znmzaivm_-7ous0-4Pw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MDAiIGhlaWdodD0iMzI2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>index = 分页 offset，一次最多显示 100 笔。</p><p><strong>评价资料回传如下：</strong></p><p>private.json:</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123456789</span><span class="p">,</span><span class="w">
    </span><span class="nl">"rating"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
    </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"很棒的存在！"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"review"</span><span class="p">:</span><span class="w"> </span><span class="s2">"人生值得了～"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"created"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"nickname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"storeFront"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TW"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"appVersionString"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4.27.1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"lastModified"</span><span class="p">:</span><span class="w"> </span><span class="mi">1618836654000</span><span class="p">,</span><span class="w">
    </span><span class="nl">"helpfulViews"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"totalViews"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"edited"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nl">"developerResponse"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"isEditable"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"isRequired"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nl">"errorKeys"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>另外经过测试后发现，只需要在带上 <code class="language-plaintext highlighter-rouge">cookie: myacinfo=&lt;Token&gt;</code> 即可伪造请求得到资料：</p><p><a href="/assets/cb0c68c33994/1*b_vINNRMrAIQrkuouN7X1Q.webp" class="popup img-link blur"><img data-src="/assets/cb0c68c33994/1*b_vINNRMrAIQrkuouN7X1Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MDAiIGhlaWdodD0iNjU3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>API 有了、要求的 header 知道了，再来就要想办法自动化取得后台这个 cookie 资讯。</p><p><strong>第二步 —万能 Fastlane</strong></p><p>因苹果现在实行全 Two-Step Verification，所以对于登入验证自动化变得更加烦琐，幸好与苹果斗智斗勇的 <a href="https://docs.fastlane.tools/best-practices/continuous-integration/" target="_blank">Fastlane</a> ，除了正规的 App Store Connect API、iTMSTransporter、网页认证(包含两步骤认证)全都有实作；我们可以直接使用 Fastlane 的指令：</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>fastlane spaceauth <span class="nt">-u</span> &lt;App Store Connect 帐号<span class="o">(</span>Email<span class="o">)&gt;</span>
</pre></table></code></div></div><p>此指令会完成网页登入验证(包含两步骤认证)，然后将 cookie 存入 FASTLANE_SESSION 档案之中。</p><p>会得到类似如下字串：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>!ruby/object:HTTP::Cookie
name: myacinfo  value: &lt;token&gt;  
domain: apple.com for_domain: true  path: "/"  
secure: true  httponly: true  expires: max_age: 
created_at: 2021-04-21 20:42:36.818821000 +08:00  
accessed_at: 2021-04-21 22:02:45.923016000 +08:00
!ruby/object:HTTP::Cookie
name: &lt;hash&gt;  value: &lt;token&gt;
domain: idmsa.apple.com for_domain: true  path: "/"
secure: true  httponly: true  expires: max_age: 2592000
created_at: 2021-04-19 23:21:05.851853000 +08:00
accessed_at: 2021-04-21 20:42:35.735921000 +08:00
</pre></table></code></div></div><p>将 <code class="language-plaintext highlighter-rouge">myacinfo = value</code> 带入就能取得评价列表。</p><p><strong>第三步 — SpaceShip</strong></p><p>本来以为 Fastlane 只能帮我们到这了，再来要自己串起从 Fastlane 拿到 cookie 然后打 api 的 flow；没想到经过一番探索发现 Fastlane 关于验证这块的模组 <code class="language-plaintext highlighter-rouge">SpaceShip</code> 还有更多强大的功能！</p><p><a href="/assets/cb0c68c33994/1*OlYQLNXAOk1oNqDP7LSlrA.webp" class="popup img-link blur"><img data-src="/assets/cb0c68c33994/1*OlYQLNXAOk1oNqDP7LSlrA.webp" alt="`SpaceShip`" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTYxIiBoZWlnaHQ9IjU2MSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><code class="language-plaintext highlighter-rouge">SpaceShip</code></p><p>SpaceShip 里面已经帮我们打包好捞评价列表的方法 <a href="https://www.rubydoc.info/gems/spaceship/0.39.0/Spaceship/TunesClient#get_reviews-instance_method" target="_blank"><strong>Class: Spaceship::TunesClient::get_reviews</strong></a> 了！</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">app</span> <span class="o">=</span> <span class="no">Spaceship</span><span class="o">::</span><span class="no">Tunes</span><span class="o">::</span><span class="n">login</span><span class="p">(</span><span class="n">appstore_account</span><span class="p">,</span> <span class="n">appstore_password</span><span class="p">)</span>
<span class="n">reviews</span> <span class="o">=</span> <span class="n">app</span><span class="p">.</span><span class="nf">get_reviews</span><span class="p">(</span><span class="n">app_id</span><span class="p">,</span> <span class="n">platform</span><span class="p">,</span> <span class="n">storefront</span><span class="p">,</span> <span class="n">versionId</span> <span class="o">=</span> <span class="s1">''</span><span class="p">)</span>
</pre></table></code></div></div><p>*storefront = 地区</p><p><strong>第四步 — 组装</strong></p><p>Fastlane、Spaceship 都是由 ruby 撰写，所以我们也要用 ruby 来制作这个 Bot 小工具。</p><p>我们可以建立一个 <code class="language-plaintext highlighter-rouge">reviewBot.rb</code> 档案，编译执行时只需在 Terminal 输入：</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ruby reviewBot.rb
</pre></table></code></div></div><p>即可。 <em>( *更多 ruby 环境问题可参考文末提示)</em></p><p><strong>首先</strong> ，因原本的 get_reviews 口的参数不符合我们需求；我想要的是全地区、全版本的评价资料、不需要筛选、支援分页：</p><p>extension.rb:</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="c1"># Extension Spaceship-&gt;TunesClient</span>
<span class="k">module</span> <span class="nn">Spaceship</span>
  <span class="k">class</span> <span class="nc">TunesClient</span> <span class="o">&lt;</span> <span class="no">Spaceship</span><span class="o">::</span><span class="no">Client</span>
    <span class="k">def</span> <span class="nf">get_recent_reviews</span><span class="p">(</span><span class="n">app_id</span><span class="p">,</span> <span class="n">platform</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
      <span class="n">r</span> <span class="o">=</span> <span class="n">request</span><span class="p">(</span><span class="ss">:get</span><span class="p">,</span> <span class="s2">"ra/apps/</span><span class="si">#{</span><span class="n">app_id</span><span class="si">}</span><span class="s2">/platforms/</span><span class="si">#{</span><span class="n">platform</span><span class="si">}</span><span class="s2">/reviews?index=</span><span class="si">#{</span><span class="n">index</span><span class="si">}</span><span class="s2">&amp;sort=REVIEW_SORT_ORDER_MOST_RECENT"</span><span class="p">)</span>
      <span class="n">parse_response</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s1">'data'</span><span class="p">)[</span><span class="s1">'reviews'</span><span class="p">]</span>
     <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></table></code></div></div><p>所以我们自己在 TunesClient 中扩充一个方法，里面参数只带 app_id、platform = <code class="language-plaintext highlighter-rouge">ios</code> ( <strong>全小写</strong> )、index = 分页 offset。</p><p><strong>再来组装登入验证、捞评价列表：</strong></p><p>get_recent_reviews.rb:</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">breakWhile</span> <span class="o">=</span> <span class="kp">true</span>
<span class="k">while</span> <span class="n">breakWhile</span>
  <span class="n">app</span> <span class="o">=</span> <span class="no">Spaceship</span><span class="o">::</span><span class="no">Tunes</span><span class="o">::</span><span class="n">login</span><span class="p">(</span><span class="no">APPStoreConnect</span> <span class="n">帐号</span><span class="p">(</span><span class="no">Email</span><span class="p">),</span> <span class="no">APPStoreConnect</span> <span class="n">密码</span><span class="p">)</span>
  <span class="n">reviews</span> <span class="o">=</span> <span class="n">app</span><span class="p">.</span><span class="nf">get_recent_reviews</span><span class="p">(</span><span class="vg">$app_id</span><span class="p">,</span> <span class="vg">$platform</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">reviews</span><span class="p">.</span><span class="nf">length</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">0</span>
    <span class="n">breakWhile</span> <span class="o">=</span> <span class="kp">false</span>
    <span class="k">break</span>
  <span class="k">end</span>
  <span class="n">reviews</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="p">\\</span><span class="o">|</span><span class="n">review</span><span class="p">\\</span><span class="o">|</span>
    <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">puts</span> <span class="n">review</span><span class="p">[</span><span class="s2">"value"</span><span class="p">]</span>
  <span class="p">}</span>
<span class="k">end</span>
</pre></table></code></div></div><p>使用 while 遍历所有分页，当跑到无内容时终止。</p><p><strong>再来要加上纪录上次最新一笔的时间，只通知没通知过的最新讯息：</strong></p><p>lastModified.rb:</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="n">lastModified</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">if</span> <span class="no">File</span><span class="p">.</span><span class="nf">exists?</span><span class="p">(</span><span class="s2">".lastModified"</span><span class="p">)</span>
  <span class="n">lastModifiedFile</span> <span class="o">=</span> <span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="s2">".lastModified"</span><span class="p">)</span>
  <span class="n">lastModified</span> <span class="o">=</span> <span class="n">lastModifiedFile</span><span class="p">.</span><span class="nf">read</span><span class="p">.</span><span class="nf">to_i</span>
<span class="k">end</span>
<span class="n">newLastModified</span> <span class="o">=</span> <span class="n">lastModified</span>
<span class="n">isFirst</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">messages</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">breakWhile</span> <span class="o">=</span> <span class="kp">true</span>
<span class="k">while</span> <span class="n">breakWhile</span>
  <span class="n">app</span> <span class="o">=</span> <span class="no">Spaceship</span><span class="o">::</span><span class="no">Tunes</span><span class="o">::</span><span class="n">login</span><span class="p">(</span><span class="no">APPStoreConnect</span> <span class="n">帐号</span><span class="p">(</span><span class="no">Email</span><span class="p">),</span> <span class="no">APPStoreConnect</span> <span class="n">密码</span><span class="p">)</span>
  <span class="n">reviews</span> <span class="o">=</span> <span class="n">app</span><span class="p">.</span><span class="nf">get_recent_reviews</span><span class="p">(</span><span class="vg">$app_id</span><span class="p">,</span> <span class="vg">$platform</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">reviews</span><span class="p">.</span><span class="nf">length</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">0</span>
    <span class="n">breakWhile</span> <span class="o">=</span> <span class="kp">false</span>
    <span class="k">break</span>
  <span class="k">end</span>
  <span class="n">reviews</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="p">\\</span><span class="o">|</span><span class="n">review</span><span class="p">\\</span><span class="o">|</span>
    <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">isFirst</span>
      <span class="n">isFirst</span> <span class="o">=</span> <span class="kp">false</span>
      <span class="n">newLastModified</span> <span class="o">=</span> <span class="n">review</span><span class="p">[</span><span class="s2">"value"</span><span class="p">][</span><span class="s2">"lastModified"</span><span class="p">]</span>
    <span class="k">end</span>

    <span class="k">if</span> <span class="n">review</span><span class="p">[</span><span class="s2">"value"</span><span class="p">][</span><span class="s2">"lastModified"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">lastModified</span> <span class="o">&amp;&amp;</span> <span class="n">lastModified</span> <span class="o">!=</span> <span class="mi">0</span>  
      <span class="c1"># 第一次使用不发通知</span>
      <span class="n">messages</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">review</span><span class="p">[</span><span class="s2">"value"</span><span class="p">])</span>
    <span class="k">else</span>
      <span class="n">breakWhile</span> <span class="o">=</span> <span class="kp">false</span>
      <span class="k">break</span>
    <span class="k">end</span>
  <span class="p">}</span>
<span class="k">end</span>

<span class="n">messages</span><span class="p">.</span><span class="nf">sort!</span> <span class="p">{</span> <span class="p">\\</span><span class="o">|</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">\\</span><span class="o">|</span>  <span class="n">a</span><span class="p">[</span><span class="s2">"lastModified"</span><span class="p">]</span> <span class="o">&lt;=&gt;</span> <span class="n">b</span><span class="p">[</span><span class="s2">"lastModified"</span><span class="p">]</span> <span class="p">}</span>
<span class="n">messages</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="p">\\</span><span class="o">|</span><span class="n">message</span><span class="p">\\</span><span class="o">|</span>
    <span class="n">notify_slack</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<span class="p">}</span>

<span class="no">File</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="s2">".lastModified"</span><span class="p">,</span> <span class="n">newLastModified</span><span class="p">,</span> <span class="ss">mode: </span><span class="s2">"w+"</span><span class="p">)</span>
</pre></table></code></div></div><p>单纯用一个 <code class="language-plaintext highlighter-rouge">.lastModified</code> 纪录上一次执行时拿到的时间。</p><p><em>*第一次使用不发通知，否则会一次狂喷</em></p><p><strong>最后一步，组合推播讯息 &amp; 发到 Slack：</strong></p><p>slack.rb:</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="c1"># Slack Bot</span>
<span class="k">def</span> <span class="nf">notify_slack</span><span class="p">(</span><span class="n">review</span><span class="p">)</span>
  <span class="n">rating</span> <span class="o">=</span> <span class="n">review</span><span class="p">[</span><span class="s2">"rating"</span><span class="p">].</span><span class="nf">to_i</span>
  <span class="n">color</span> <span class="o">=</span> <span class="n">rating</span> <span class="o">&gt;=</span> <span class="mi">4</span> <span class="p">?</span> <span class="s2">"good"</span> <span class="p">:</span> <span class="p">(</span><span class="n">rating</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="p">?</span> <span class="s2">"warning"</span> <span class="p">:</span> <span class="s2">"danger"</span><span class="p">)</span>
  <span class="n">like</span> <span class="o">=</span> <span class="n">review</span><span class="p">[</span><span class="s2">"helpfulViews"</span><span class="p">].</span><span class="nf">to_i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">?</span> <span class="s2">" - </span><span class="si">#{</span><span class="n">review</span><span class="p">[</span><span class="s2">"helpfulViews"</span><span class="p">]</span><span class="si">}</span><span class="s2"> :thumbsup:"</span> <span class="p">:</span> <span class="s2">""</span>
  <span class="n">date</span> <span class="o">=</span> <span class="n">review</span><span class="p">[</span><span class="s2">"edited"</span><span class="p">]</span> <span class="o">==</span> <span class="kp">false</span> <span class="p">?</span> <span class="s2">"Created at: </span><span class="si">#{</span><span class="no">Time</span><span class="p">.</span><span class="nf">at</span><span class="p">(</span><span class="n">review</span><span class="p">[</span><span class="s2">"lastModified"</span><span class="p">].</span><span class="nf">to_i</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">).</span><span class="nf">to_datetime</span><span class="si">}</span><span class="s2">"</span> <span class="p">:</span> <span class="s2">"Updated at: </span><span class="si">#{</span><span class="no">Time</span><span class="p">.</span><span class="nf">at</span><span class="p">(</span><span class="n">review</span><span class="p">[</span><span class="s2">"lastModified"</span><span class="p">].</span><span class="nf">to_i</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">).</span><span class="nf">to_datetime</span><span class="si">}</span><span class="s2">"</span>
  
    
  <span class="n">isResponse</span> <span class="o">=</span> <span class="s2">""</span>
  <span class="k">if</span> <span class="n">review</span><span class="p">[</span><span class="s2">"developerResponse"</span><span class="p">]</span> <span class="o">!=</span> <span class="kp">nil</span> <span class="o">&amp;&amp;</span> <span class="n">review</span><span class="p">[</span><span class="s2">"developerResponse"</span><span class="p">][</span><span class="s1">'lastModified'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">review</span><span class="p">[</span><span class="s2">"lastModified"</span><span class="p">]</span>
    <span class="n">isResponse</span> <span class="o">=</span> <span class="s2">" (回复已过时)"</span>
  <span class="k">end</span>
  
  <span class="n">edited</span> <span class="o">=</span> <span class="n">review</span><span class="p">[</span><span class="s2">"edited"</span><span class="p">]</span> <span class="o">==</span> <span class="kp">false</span> <span class="p">?</span> <span class="s2">""</span> <span class="p">:</span> <span class="s2">":memo: 使用者更新评论</span><span class="si">#{</span><span class="n">isResponse</span><span class="si">}</span><span class="s2">："</span>

  <span class="n">stars</span> <span class="o">=</span> <span class="s2">"★"</span> <span class="o">*</span> <span class="n">rating</span> <span class="o">+</span> <span class="s2">"☆"</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="n">rating</span><span class="p">)</span>
  <span class="n">attachments</span> <span class="o">=</span> <span class="p">{</span>
    <span class="ss">:pretext</span> <span class="o">=&gt;</span> <span class="n">edited</span><span class="p">,</span>
    <span class="ss">:color</span> <span class="o">=&gt;</span> <span class="n">color</span><span class="p">,</span>
    <span class="ss">:fallback</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="si">#{</span><span class="n">review</span><span class="p">[</span><span class="s2">"title"</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">#{</span><span class="n">stars</span><span class="si">}#{</span><span class="n">like</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
    <span class="ss">:title</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="si">#{</span><span class="n">review</span><span class="p">[</span><span class="s2">"title"</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">#{</span><span class="n">stars</span><span class="si">}#{</span><span class="n">like</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
    <span class="ss">:text</span> <span class="o">=&gt;</span> <span class="n">review</span><span class="p">[</span><span class="s2">"review"</span><span class="p">],</span>
    <span class="ss">:author_name</span> <span class="o">=&gt;</span> <span class="n">review</span><span class="p">[</span><span class="s2">"nickname"</span><span class="p">],</span>
    <span class="ss">:footer</span> <span class="o">=&gt;</span> <span class="s2">"iOS - v</span><span class="si">#{</span><span class="n">review</span><span class="p">[</span><span class="s2">"appVersionString"</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">#{</span><span class="n">review</span><span class="p">[</span><span class="s2">"storeFront"</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">#{</span><span class="n">date</span><span class="si">}</span><span class="s2"> - &lt;https://appstoreconnect.apple.com/apps/APP_ID/appstore/activity/ios/ratingsResponses</span><span class="se">\\</span><span class="s2">|Go To App Store&gt;"</span>
  <span class="p">}</span>
  <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
   <span class="ss">:attachments</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="n">attachments</span><span class="p">],</span>
   <span class="ss">:icon_emoji</span> <span class="o">=&gt;</span> <span class="s2">":storm_trooper:"</span><span class="p">,</span>
   <span class="ss">:username</span> <span class="o">=&gt;</span> <span class="s2">"ZhgChgLi iOS Review Bot"</span>
  <span class="p">}.</span><span class="nf">to_json</span>
  <span class="n">cmd</span> <span class="o">=</span> <span class="s2">"curl -X POST --data-urlencode 'payload=</span><span class="si">#{</span><span class="n">payload</span><span class="si">}</span><span class="s2">' SLACK_WEB_HOOK_URL"</span>
  <span class="nb">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="ss">:err</span> <span class="o">=&gt;</span> <span class="no">File</span><span class="o">::</span><span class="no">NULL</span><span class="p">)</span>
  <span class="nb">puts</span> <span class="s2">"</span><span class="si">#{</span><span class="n">review</span><span class="p">[</span><span class="s2">"id"</span><span class="p">]</span><span class="si">}</span><span class="s2"> send Notify Success!"</span>
 <span class="k">end</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">SLACK_WEB_HOOK_URL</code> = <a href="https://slack.com/apps/A0F7XDUAZ-incoming-webhooks" target="_blank"><strong>Incoming WebHook URL</strong></a></p><h3 id="最终结果"><span class="me-2"><strong>最终结果</strong></span><a href="#最终结果" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>appreviewbot.rb:</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
</pre><td class="rouge-code"><pre><span class="nb">require</span> <span class="s2">"Spaceship"</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="nb">require</span> <span class="s1">'date'</span>

<span class="c1"># Config</span>
<span class="vg">$slack_web_hook</span> <span class="o">=</span> <span class="s2">"目标通知的 web hook url"</span>
<span class="vg">$slack_debug_web_hook</span> <span class="o">=</span> <span class="s2">"机器人有错误时的通知 web hook url"</span>
<span class="vg">$appstore_account</span> <span class="o">=</span> <span class="s2">"APPStoreConnect 帐号(Email)"</span>
<span class="vg">$appstore_password</span> <span class="o">=</span> <span class="s2">"APPStoreConnect 密码"</span>
<span class="vg">$app_id</span> <span class="o">=</span> <span class="s2">"APP_ID"</span>
<span class="vg">$platform</span> <span class="o">=</span> <span class="s2">"ios"</span>

<span class="c1"># Extension Spaceship-&gt;TunesClient</span>
<span class="k">module</span> <span class="nn">Spaceship</span>
  <span class="k">class</span> <span class="nc">TunesClient</span> <span class="o">&lt;</span> <span class="no">Spaceship</span><span class="o">::</span><span class="no">Client</span>
    <span class="k">def</span> <span class="nf">get_recent_reviews</span><span class="p">(</span><span class="n">app_id</span><span class="p">,</span> <span class="n">platform</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
      <span class="n">r</span> <span class="o">=</span> <span class="n">request</span><span class="p">(</span><span class="ss">:get</span><span class="p">,</span> <span class="s2">"ra/apps/</span><span class="si">#{</span><span class="n">app_id</span><span class="si">}</span><span class="s2">/platforms/</span><span class="si">#{</span><span class="n">platform</span><span class="si">}</span><span class="s2">/reviews?index=</span><span class="si">#{</span><span class="n">index</span><span class="si">}</span><span class="s2">&amp;sort=REVIEW_SORT_ORDER_MOST_RECENT"</span><span class="p">)</span>
      <span class="n">parse_response</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s1">'data'</span><span class="p">)[</span><span class="s1">'reviews'</span><span class="p">]</span>
     <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># Slack Bot</span>
<span class="k">def</span> <span class="nf">notify_slack</span><span class="p">(</span><span class="n">review</span><span class="p">)</span>
  <span class="n">rating</span> <span class="o">=</span> <span class="n">review</span><span class="p">[</span><span class="s2">"rating"</span><span class="p">].</span><span class="nf">to_i</span>
  <span class="n">color</span> <span class="o">=</span> <span class="n">rating</span> <span class="o">&gt;=</span> <span class="mi">4</span> <span class="p">?</span> <span class="s2">"good"</span> <span class="p">:</span> <span class="p">(</span><span class="n">rating</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="p">?</span> <span class="s2">"warning"</span> <span class="p">:</span> <span class="s2">"danger"</span><span class="p">)</span>
  <span class="n">like</span> <span class="o">=</span> <span class="n">review</span><span class="p">[</span><span class="s2">"helpfulViews"</span><span class="p">].</span><span class="nf">to_i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">?</span> <span class="s2">" - </span><span class="si">#{</span><span class="n">review</span><span class="p">[</span><span class="s2">"helpfulViews"</span><span class="p">]</span><span class="si">}</span><span class="s2"> :thumbsup:"</span> <span class="p">:</span> <span class="s2">""</span>
  <span class="n">date</span> <span class="o">=</span> <span class="n">review</span><span class="p">[</span><span class="s2">"edited"</span><span class="p">]</span> <span class="o">==</span> <span class="kp">false</span> <span class="p">?</span> <span class="s2">"Created at: </span><span class="si">#{</span><span class="no">Time</span><span class="p">.</span><span class="nf">at</span><span class="p">(</span><span class="n">review</span><span class="p">[</span><span class="s2">"lastModified"</span><span class="p">].</span><span class="nf">to_i</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">).</span><span class="nf">to_datetime</span><span class="si">}</span><span class="s2">"</span> <span class="p">:</span> <span class="s2">"Updated at: </span><span class="si">#{</span><span class="no">Time</span><span class="p">.</span><span class="nf">at</span><span class="p">(</span><span class="n">review</span><span class="p">[</span><span class="s2">"lastModified"</span><span class="p">].</span><span class="nf">to_i</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">).</span><span class="nf">to_datetime</span><span class="si">}</span><span class="s2">"</span>
  
    
  <span class="n">isResponse</span> <span class="o">=</span> <span class="s2">""</span>
  <span class="k">if</span> <span class="n">review</span><span class="p">[</span><span class="s2">"developerResponse"</span><span class="p">]</span> <span class="o">!=</span> <span class="kp">nil</span> <span class="o">&amp;&amp;</span> <span class="n">review</span><span class="p">[</span><span class="s2">"developerResponse"</span><span class="p">][</span><span class="s1">'lastModified'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">review</span><span class="p">[</span><span class="s2">"lastModified"</span><span class="p">]</span>
    <span class="n">isResponse</span> <span class="o">=</span> <span class="s2">" (客服回复已过时)"</span>
  <span class="k">end</span>
  
  <span class="n">edited</span> <span class="o">=</span> <span class="n">review</span><span class="p">[</span><span class="s2">"edited"</span><span class="p">]</span> <span class="o">==</span> <span class="kp">false</span> <span class="p">?</span> <span class="s2">""</span> <span class="p">:</span> <span class="s2">":memo: 使用者更新评论</span><span class="si">#{</span><span class="n">isResponse</span><span class="si">}</span><span class="s2">："</span>

  <span class="n">stars</span> <span class="o">=</span> <span class="s2">"★"</span> <span class="o">*</span> <span class="n">rating</span> <span class="o">+</span> <span class="s2">"☆"</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="n">rating</span><span class="p">)</span>
  <span class="n">attachments</span> <span class="o">=</span> <span class="p">{</span>
    <span class="ss">:pretext</span> <span class="o">=&gt;</span> <span class="n">edited</span><span class="p">,</span>
    <span class="ss">:color</span> <span class="o">=&gt;</span> <span class="n">color</span><span class="p">,</span>
    <span class="ss">:fallback</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="si">#{</span><span class="n">review</span><span class="p">[</span><span class="s2">"title"</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">#{</span><span class="n">stars</span><span class="si">}#{</span><span class="n">like</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
    <span class="ss">:title</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="si">#{</span><span class="n">review</span><span class="p">[</span><span class="s2">"title"</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">#{</span><span class="n">stars</span><span class="si">}#{</span><span class="n">like</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
    <span class="ss">:text</span> <span class="o">=&gt;</span> <span class="n">review</span><span class="p">[</span><span class="s2">"review"</span><span class="p">],</span>
    <span class="ss">:author_name</span> <span class="o">=&gt;</span> <span class="n">review</span><span class="p">[</span><span class="s2">"nickname"</span><span class="p">],</span>
    <span class="ss">:footer</span> <span class="o">=&gt;</span> <span class="s2">"iOS - v</span><span class="si">#{</span><span class="n">review</span><span class="p">[</span><span class="s2">"appVersionString"</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">#{</span><span class="n">review</span><span class="p">[</span><span class="s2">"storeFront"</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">#{</span><span class="n">date</span><span class="si">}</span><span class="s2"> - &lt;https://appstoreconnect.apple.com/apps/APP_ID/appstore/activity/ios/ratingsResponses</span><span class="se">\\</span><span class="s2">|Go To App Store&gt;"</span>
  <span class="p">}</span>
  <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
   <span class="ss">:attachments</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="n">attachments</span><span class="p">],</span>
   <span class="ss">:icon_emoji</span> <span class="o">=&gt;</span> <span class="s2">":storm_trooper:"</span><span class="p">,</span>
   <span class="ss">:username</span> <span class="o">=&gt;</span> <span class="s2">"ZhgChgLi iOS Review Bot"</span>
  <span class="p">}.</span><span class="nf">to_json</span>
  <span class="n">cmd</span> <span class="o">=</span> <span class="s2">"curl -X POST --data-urlencode 'payload=</span><span class="si">#{</span><span class="n">payload</span><span class="si">}</span><span class="s2">' </span><span class="si">#{</span><span class="vg">$slack_web_hook</span><span class="si">}</span><span class="s2">"</span>
  <span class="nb">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="ss">:err</span> <span class="o">=&gt;</span> <span class="no">File</span><span class="o">::</span><span class="no">NULL</span><span class="p">)</span>
  <span class="nb">puts</span> <span class="s2">"</span><span class="si">#{</span><span class="n">review</span><span class="p">[</span><span class="s2">"id"</span><span class="p">]</span><span class="si">}</span><span class="s2"> send Notify Success!"</span>
 <span class="k">end</span>

<span class="k">begin</span>
    <span class="n">lastModified</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="no">File</span><span class="p">.</span><span class="nf">exists?</span><span class="p">(</span><span class="s2">".lastModified"</span><span class="p">)</span>
      <span class="n">lastModifiedFile</span> <span class="o">=</span> <span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="s2">".lastModified"</span><span class="p">)</span>
      <span class="n">lastModified</span> <span class="o">=</span> <span class="n">lastModifiedFile</span><span class="p">.</span><span class="nf">read</span><span class="p">.</span><span class="nf">to_i</span>
    <span class="k">end</span>
    <span class="n">newLastModified</span> <span class="o">=</span> <span class="n">lastModified</span>
    <span class="n">isFirst</span> <span class="o">=</span> <span class="kp">true</span>
    <span class="n">messages</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">breakWhile</span> <span class="o">=</span> <span class="kp">true</span>
    <span class="k">while</span> <span class="n">breakWhile</span>
      <span class="n">app</span> <span class="o">=</span> <span class="no">Spaceship</span><span class="o">::</span><span class="no">Tunes</span><span class="o">::</span><span class="n">login</span><span class="p">(</span><span class="vg">$appstore_account</span><span class="p">,</span> <span class="vg">$appstore_password</span><span class="p">)</span>
      <span class="n">reviews</span> <span class="o">=</span> <span class="n">app</span><span class="p">.</span><span class="nf">get_recent_reviews</span><span class="p">(</span><span class="vg">$app_id</span><span class="p">,</span> <span class="vg">$platform</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">reviews</span><span class="p">.</span><span class="nf">length</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">0</span>
        <span class="n">breakWhile</span> <span class="o">=</span> <span class="kp">false</span>
        <span class="k">break</span>
      <span class="k">end</span>
      <span class="n">reviews</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="p">\\</span><span class="o">|</span><span class="n">review</span><span class="p">\\</span><span class="o">|</span>
        <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">isFirst</span>
          <span class="n">isFirst</span> <span class="o">=</span> <span class="kp">false</span>
          <span class="n">newLastModified</span> <span class="o">=</span> <span class="n">review</span><span class="p">[</span><span class="s2">"value"</span><span class="p">][</span><span class="s2">"lastModified"</span><span class="p">]</span>
        <span class="k">end</span>

        <span class="k">if</span> <span class="n">review</span><span class="p">[</span><span class="s2">"value"</span><span class="p">][</span><span class="s2">"lastModified"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">lastModified</span> <span class="o">&amp;&amp;</span> <span class="n">lastModified</span> <span class="o">!=</span> <span class="mi">0</span>  
          <span class="c1"># 第一次使用不发通知</span>
          <span class="n">messages</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">review</span><span class="p">[</span><span class="s2">"value"</span><span class="p">])</span>
        <span class="k">else</span>
          <span class="n">breakWhile</span> <span class="o">=</span> <span class="kp">false</span>
          <span class="k">break</span>
        <span class="k">end</span>
      <span class="p">}</span>
    <span class="k">end</span>
    
    <span class="n">messages</span><span class="p">.</span><span class="nf">sort!</span> <span class="p">{</span> <span class="p">\\</span><span class="o">|</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">\\</span><span class="o">|</span>  <span class="n">a</span><span class="p">[</span><span class="s2">"lastModified"</span><span class="p">]</span> <span class="o">&lt;=&gt;</span> <span class="n">b</span><span class="p">[</span><span class="s2">"lastModified"</span><span class="p">]</span> <span class="p">}</span>
    <span class="n">messages</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="p">\\</span><span class="o">|</span><span class="n">message</span><span class="p">\\</span><span class="o">|</span>
        <span class="n">notify_slack</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="no">File</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="s2">".lastModified"</span><span class="p">,</span> <span class="n">newLastModified</span><span class="p">,</span> <span class="ss">mode: </span><span class="s2">"w+"</span><span class="p">)</span>
<span class="k">rescue</span> <span class="o">=&gt;</span> <span class="n">error</span>
    <span class="n">attachments</span> <span class="o">=</span> <span class="p">{</span>
        <span class="ss">:color</span> <span class="o">=&gt;</span> <span class="s2">"danger"</span><span class="p">,</span>
        <span class="ss">:title</span> <span class="o">=&gt;</span> <span class="s2">"AppStoreReviewBot Error occurs!"</span><span class="p">,</span>
        <span class="ss">:text</span> <span class="o">=&gt;</span> <span class="n">error</span><span class="p">,</span>
        <span class="ss">:footer</span> <span class="o">=&gt;</span> <span class="s2">"*因苹果技术限制，精准评价爬取功能约每一个月需要重新登入设定，敬请见谅。"</span>
    <span class="p">}</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
        <span class="ss">:attachments</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="n">attachments</span><span class="p">],</span>
        <span class="ss">:icon_emoji</span> <span class="o">=&gt;</span> <span class="s2">":storm_trooper:"</span><span class="p">,</span>
        <span class="ss">:username</span> <span class="o">=&gt;</span> <span class="s2">"ZhgChgLi iOS Review Bot"</span>
    <span class="p">}.</span><span class="nf">to_json</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="s2">"curl -X POST --data-urlencode 'payload=</span><span class="si">#{</span><span class="n">payload</span><span class="si">}</span><span class="s2">' </span><span class="si">#{</span><span class="vg">$slack_debug_web_hook</span><span class="si">}</span><span class="s2">"</span>
    <span class="nb">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="ss">:err</span> <span class="o">=&gt;</span> <span class="no">File</span><span class="o">::</span><span class="no">NULL</span><span class="p">)</span>
    <span class="nb">puts</span> <span class="n">error</span>
<span class="k">end</span>
</pre></table></code></div></div><p>另外还加上了 begin…rescue (try…catch) 保护，如果有出现错误则发 Slack 通知我们回来检查（多半是 session 过期）。</p><blockquote><p><strong><em>最后只要将此脚本加到 crontab / schedule 等排程工具定时执行即可！</em></strong></p></blockquote><p><strong>效果图：</strong></p><p><a href="/assets/cb0c68c33994/1*B0xW1CXU-avz2j8_ny3Ang.webp" class="popup img-link blur"><img data-src="/assets/cb0c68c33994/1*B0xW1CXU-avz2j8_ny3Ang.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MTQiIGhlaWdodD0iMTMwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><h3 id="免费的其他选择"><span class="me-2">免费的其他选择</span><a href="#免费的其他选择" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li><p><a href="https://appfollow.io/" target="_blank">AppFollow</a> ：使用 Public URL API (RSS)，只能说堪用吧。</p><li><p><a href="https://feedis.io/product/proxime/features" target="_blank">feedis.io</a> ：使用 Private URL API，需要把帐号密码给他们。</p><li><p><a href="https://github.com/TradeMe/ReviewMe" target="_blank">TradeMe/ReviewMe</a> ：自架服务(node.js)，我们原先用这个，但遇到前述问题。</p><li><p><a href="https://github.com/saiday/JonSnow" target="_blank">JonSnow</a> ：自架服务(GO)，支援一键部署到 heroku，作者： <a href="https://twitter.com/saiday" target="_blank">@saiday</a></p></ol><h3 id="温馨提示"><span class="me-2">温馨提示</span><a href="#温馨提示" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>1.⚠️Private URL API 方法，如果用有二阶段验证的帐号，最长每 30 天都需要重新验证才能使用且目前无解；如果有办法生出没二阶段的帐号就可以无痛爽爽用。</p><p><a href="/assets/cb0c68c33994/1*EE2J5HmdiIogMwC3Iiy0KA.webp" class="popup img-link blur"><img data-src="/assets/cb0c68c33994/1*EE2J5HmdiIogMwC3Iiy0KA.webp" alt="[#important-note-about-session-duration](https://docs.fastlane.tools/best-practices/continuous-integration/#important-note-about-session-duration){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAyIiBoZWlnaHQ9IjcxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="https://docs.fastlane.tools/best-practices/continuous-integration/#important-note-about-session-duration" target="_blank">#important-note-about-session-duration</a></p><p>2.⚠️不论是免费、付费、本文的自架；切勿使用开发者帐号，务必开一个独立的 App Store Connect 帐号使用，权限只开放「Customer Support」；防止资安问题。</p><p>3.Ruby 建议使用 <a href="https://gist.github.com/sandyxu/8aceec7e436a6ab9621f" target="_blank">rbenv</a> 进行管理，因系统自带 2.6 版容易造成冲突。</p><p>4.在 macOS Catalina 如遇到 GEM、Ruby 环境错误问题，可参考 <a href="https://github.com/orta/cocoapods-keys/issues/198#issuecomment-510909030" target="_blank">此回复</a> 解决。</p><h3 id="problem-solved"><span class="me-2">Problem Solved!</span><a href="#problem-solved" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>经过以上心路历程，更了解的 Slack Bot 的运作方式；还有 iOS App Store 是如何爬取评价内容的，另外也摸了下 ruby！写起来真不错！</p><p>有任何问题及指教欢迎 <a href="https://www.zhgchg.li/contact" target="_blank">与我联络</a> 。</p><hr /><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=🍺&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a><br /></p><blockquote class="prompt-info"><p>本文首次发表于 Medium (<a href="https://medium.com/p/cb0c68c33994" target="_blank"><strong>点击查看原始版本</strong></a>)，由 <a href="/posts/tools/medium-to-jekyll/" target="_blank">ZMediumToMarkdown</a> 提供自动转换与同步技术。</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/zh-cn/zmediumtomarkdown/2021-04-21-cb0c68c33994.md" target="_blank">Improve this page on Github.</a></p></blockquote><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1K+ Followers</span></a></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-dev/">ZRealm Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/simplified-chinese/" class="post-tag no-text-decoration" >simplified-chinese</a> <a href="/tags/slackbot/" class="post-tag no-text-decoration" >slackbot</a> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/ruby/" class="post-tag no-text-decoration" >ruby</a> <a href="/tags/fastlane/" class="post-tag no-text-decoration" >fastlane</a> <a href="/tags/automator/" class="post-tag no-text-decoration" >automator</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=AppStore%20%E8%AF%84%E4%BB%B7%E8%BF%BD%E8%B8%AA%20Slack%20Bot%20%E6%95%99%E5%AD%A6%EF%BD%9C%E7%94%A8%20Ruby%20+%20Fastlane%20%E8%87%AA%E5%8A%A8%E9%80%9A%E7%9F%A5%E6%9C%80%E6%96%B0%E8%AF%84%E8%AE%BA%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fappstore-%25E8%25AF%2584%25E4%25BB%25B7%25E8%25BF%25BD%25E8%25B8%25AA-slack-bot-%25E6%2595%2599%25E5%25AD%25A6-%25E7%2594%25A8-ruby-fastlane-%25E8%2587%25AA%25E5%258A%25A8%25E9%2580%259A%25E7%259F%25A5%25E6%259C%2580%25E6%2596%25B0%25E8%25AF%2584%25E8%25AE%25BA-cb0c68c33994%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=AppStore%20%E8%AF%84%E4%BB%B7%E8%BF%BD%E8%B8%AA%20Slack%20Bot%20%E6%95%99%E5%AD%A6%EF%BD%9C%E7%94%A8%20Ruby%20+%20Fastlane%20%E8%87%AA%E5%8A%A8%E9%80%9A%E7%9F%A5%E6%9C%80%E6%96%B0%E8%AF%84%E8%AE%BA%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fappstore-%25E8%25AF%2584%25E4%25BB%25B7%25E8%25BF%25BD%25E8%25B8%25AA-slack-bot-%25E6%2595%2599%25E5%25AD%25A6-%25E7%2594%25A8-ruby-fastlane-%25E8%2587%25AA%25E5%258A%25A8%25E9%2580%259A%25E7%259F%25A5%25E6%259C%2580%25E6%2596%25B0%25E8%25AF%2584%25E8%25AE%25BA-cb0c68c33994%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fappstore-%25E8%25AF%2584%25E4%25BB%25B7%25E8%25BF%25BD%25E8%25B8%25AA-slack-bot-%25E6%2595%2599%25E5%25AD%25A6-%25E7%2594%25A8-ruby-fastlane-%25E8%2587%25AA%25E5%258A%25A8%25E9%2580%259A%25E7%259F%25A5%25E6%259C%2580%25E6%2596%25B0%25E8%25AF%2584%25E8%25AE%25BA-cb0c68c33994%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/en/apple-watch-stainless-steel-milanese-loop-unboxing-premium-44mm-graphite-band-review-c0f99f987d9c/">Apple Watch Stainless Steel Milanese Loop Unboxing｜Premium 44mm Graphite Band Review</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/zh-cn/apple-watch-%E7%B1%B3%E5%85%B0%E8%A1%A8%E5%B8%A6%E5%BC%80%E7%AE%B1-%E5%8E%9F%E5%8E%82%E4%B8%8D%E9%94%88%E9%92%A2%E7%9F%B3%E5%A2%A8%E8%89%B2%E4%BC%98%E7%BC%BA%E7%82%B9%E5%85%A8%E8%A7%A3%E6%9E%90-c0f99f987d9c/">Apple Watch 原厂不锈钢米兰表带开箱</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/apple-watch-%E7%B1%B3%E8%98%AD%E9%8C%B6%E5%B8%B6%E9%96%8B%E7%AE%B1-%E5%8E%9F%E5%BB%A0%E4%B8%8D%E9%8F%BD%E9%8B%BC%E7%9F%B3%E5%A2%A8%E8%89%B2%E5%84%AA%E7%BC%BA%E9%BB%9E%E5%85%A8%E8%A7%A3%E6%9E%90-c0f99f987d9c/">Apple Watch 原廠不鏽鋼米蘭錶帶開箱</a><li class="text-truncate lh-lg"> <a href="/posts/travel-journals/en/busan-travel-guide-8-day-itinerary-with-visit-busan-pass-for-seamless-exploration-8ace34a1a3d8/">Busan Travel Guide｜8-Day Itinerary with VISIT BUSAN PASS for Seamless Exploration</a><li class="text-truncate lh-lg"> <a href="/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/zh-cn/%E9%87%9C%E5%B1%B1%E8%87%AA%E7%94%B1%E8%A1%8C%E6%94%BB%E7%95%A5-8%E5%A4%A97%E5%A4%9C%E5%BF%85%E5%8E%BB%E6%99%AF%E7%82%B9-%E7%BE%8E%E9%A3%9F%E4%B8%8E%E4%BA%A4%E9%80%9A%E5%85%A8%E8%A7%A3%E6%9E%90-%E9%87%9C%E5%B1%B1%E9%80%9A%E8%A1%8C%E8%AF%81%E7%9C%81%E9%92%B1%E7%A7%98%E8%AF%80-8ace34a1a3d8/">游记 2025 韩国釜山 8 天 7 夜自由行</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">章節 (Chapters)🔖</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-dev/appstore-%E8%A9%95%E5%83%B9%E8%BF%BD%E8%B9%A4-slack-bot-%E6%95%99%E5%AD%B8-%E7%94%A8-ruby-fastlane-%E8%87%AA%E5%8B%95%E9%80%9A%E7%9F%A5%E6%9C%80%E6%96%B0%E8%A9%95%E8%AB%96-cb0c68c33994/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1619018191" data-df="ll" > Apr 21, 2021 </time><h4 class="pt-0 my-2">AppStore APP’s Reviews Bot 那些事</h4><div class="text-muted"><p>動手打造 APP 評價追蹤通知 Slack 機器人</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/en/appstore-reviews-bot-automate-app-review-tracking-with-slack-notifications-cb0c68c33994/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1619018191" data-df="ll" > Apr 21, 2021 </time><h4 class="pt-0 my-2">AppStore Reviews Bot｜Automate APP Review Tracking with Slack Notifications</h4><div class="text-muted"><p>Develop an AppStore review tracking bot that sends real-time Slack alerts, solving manual monitoring delays and boosting your app&#39;s responsiveness to user feedback effectively.</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/zh-cn/zreviewsbot-%E5%85%8D%E8%B4%B9%E5%BC%80%E6%BA%90-slack-app-review-%E8%AF%84%E4%BB%B7%E9%80%9A%E7%9F%A5%E6%9C%BA%E5%99%A8%E4%BA%BA-ios-android-%E5%8F%8C%E5%B9%B3%E5%8F%B0%E6%94%AF%E6%8F%B4-33f6aabb744f/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1620222679" data-df="ll" > May 5, 2021 </time><h4 class="pt-0 my-2">ZReviewsBot — Slack App Review 通知机器人</h4><div class="text-muted"><p></p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-dev/en/appstore-reviews-bot-automate-app-review-tracking-with-slack-notifications-cb0c68c33994/" class="btn btn-outline-primary" aria-label="Older" ><p>AppStore Reviews Bot｜Automate APP Review Tracking with Slack Notifications</p></a> <a href="/posts/zrealm-dev/appstore-%E8%A9%95%E5%83%B9%E8%BF%BD%E8%B9%A4-slack-bot-%E6%95%99%E5%AD%B8-%E7%94%A8-ruby-fastlane-%E8%87%AA%E5%8B%95%E9%80%9A%E7%9F%A5%E6%9C%80%E6%96%B0%E8%A9%95%E8%AB%96-cb0c68c33994/" class="btn btn-outline-primary" aria-label="Newer" ><p>AppStore APP’s Reviews Bot 那些事</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span> <a href="/">中文</a>|<a href="/tags/simplified-chinese">简中</a>|<a href="/tags/english/">English</a></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a> <br/></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
