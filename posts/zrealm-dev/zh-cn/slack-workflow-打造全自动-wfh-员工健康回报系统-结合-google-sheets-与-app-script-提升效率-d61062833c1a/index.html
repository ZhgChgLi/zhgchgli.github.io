<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Slack Workflow｜打造全自动 WFH 员工健康回报系统，结合 Google Sheets 与 App Script 提升效率" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="针对远距工作团队，解决健康回报繁琐填写与人工追踪问题，透过 Slack Workflow Form 结合 Google Sheets 与 App Script，自动比对未填写名单并传送提醒，节省每日 20 分钟人力，提升回报准确率与便利性。" /><meta property="og:description" content="针对远距工作团队，解决健康回报繁琐填写与人工追踪问题，透过 Slack Workflow Form 结合 Google Sheets 与 App Script，自动比对未填写名单并传送提醒，节省每日 20 分钟人力，提升回报准确率与便利性。" /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-dev/zh-cn/slack-workflow-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8A%A8-wfh-%E5%91%98%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E6%8A%A5%E7%B3%BB%E7%BB%9F-%E7%BB%93%E5%90%88-google-sheets-%E4%B8%8E-app-script-%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87-d61062833c1a/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-dev/zh-cn/slack-workflow-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8A%A8-wfh-%E5%91%98%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E6%8A%A5%E7%B3%BB%E7%BB%9F-%E7%BB%93%E5%90%88-google-sheets-%E4%B8%8E-app-script-%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87-d61062833c1a/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-06-14T00:58:21+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.webp" /><meta property="twitter:title" content="Slack Workflow｜打造全自动 WFH 员工健康回报系统，结合 Google Sheets 与 App Script 提升效率" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://medium.com/@zhgchgli/"},"dateModified":"2024-04-14T00:43:33+08:00","datePublished":"2021-06-14T00:58:21+08:00","description":"针对远距工作团队，解决健康回报繁琐填写与人工追踪问题，透过 Slack Workflow Form 结合 Google Sheets 与 App Script，自动比对未填写名单并传送提醒，节省每日 20 分钟人力，提升回报准确率与便利性。","headline":"Slack Workflow｜打造全自动 WFH 员工健康回报系统，结合 Google Sheets 与 App Script 提升效率","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+","url":"https://zhgchg.li/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-dev/zh-cn/slack-workflow-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8A%A8-wfh-%E5%91%98%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E6%8A%A5%E7%B3%BB%E7%BB%9F-%E7%BB%93%E5%90%88-google-sheets-%E4%B8%8E-app-script-%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87-d61062833c1a/"},"url":"https://zhgchg.li/posts/zrealm-dev/zh-cn/slack-workflow-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8A%A8-wfh-%E5%91%98%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E6%8A%A5%E7%B3%BB%E7%BB%9F-%E7%BB%93%E5%90%88-google-sheets-%E4%B8%8E-app-script-%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87-d61062833c1a/"}</script><title>Slack Workflow｜打造全自动 WFH 员工健康回报系统，结合 Google Sheets 与 App Script 提升效率 | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script><link rel="alternate" hreflang="en" href="/posts/zrealm-dev/en/slack-workflow-automate-wfh-employee-health-reporting-with-google-sheets-app-script-d61062833c1a/"><link rel="alternate" hreflang="zh-Hant" href="/posts/zrealm-dev/slack-workflow-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8B%95-wfh-%E5%93%A1%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E5%A0%B1%E7%B3%BB%E7%B5%B1-%E7%B5%90%E5%90%88-google-sheets-%E8%88%87-app-script-%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87-d61062833c1a/"><link rel="alternate" hreflang="zh-Hans" href="/posts/zrealm-dev/zh-cn/slack-workflow-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8A%A8-wfh-%E5%91%98%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E6%8A%A5%E7%B3%BB%E7%BB%9F-%E7%BB%93%E5%90%88-google-sheets-%E4%B8%8E-app-script-%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87-d61062833c1a/"><link rel="alternate" hreflang="x-default" href="/posts/zrealm-dev/zh-cn/slack-workflow-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8A%A8-wfh-%E5%91%98%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E6%8A%A5%E7%B3%BB%E7%BB%9F-%E7%BB%93%E5%90%88-google-sheets-%E4%B8%8E-app-script-%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87-d61062833c1a/"><link rel="stylesheet" href="/assets/css/post-toc.css"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0">An iOS, web, and automation developer from Taiwan 🇹🇼 who also loves sharing, traveling, and writing.</p><a href="https://medium.com/@zhgchgli" target="_blank" style="display: block;text-align: center;font-style: normal;/* text-decoration: underline; */font-size: 1.2em;color: var(--heading-color);">1K+ Followers on Medium</a></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/english/" class="nav-link"> <i class="fa-fw fa fa-solid fa-language"></i> <span>ENGLISH POSTS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Slack Workflow｜打造全自动 WFH 员工健康回报系统，结合 Google Sheets 与 App Script 提升效率</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Slack Workflow｜打造全自动 WFH 员工健康回报系统，结合 Google Sheets 与 App Script 提升效率</h1><p class="post-desc fw-light mb-4">针对远距工作团队，解决健康回报繁琐填写与人工追踪问题，透过 Slack Workflow Form 结合 Google Sheets 与 App Script，自动比对未填写名单并传送提醒，节省每日 20 分钟人力，提升回报准确率与便利性。</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1623603501" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 14, 2021 </time> </span> <span> Updated <time data-ts="1713026613" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 13, 2024 </time> </span><div class="mt-3 mb-3"> <a href="/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.webp" class="popup img-link preview-img blur"><img data-src="/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></div><div class="d-flex justify-content-between"> <span style="display: inline-flex; align-items: center; gap: 4px;"> By <em> <a href="https://medium.com/@zhgchgli/">ZhgChgLi</a> </em> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" style="display: block; "><path fill="#007bff" d="M271.2 56C265.1 49.8 256.2 47.3 247.8 49.6C239.4 51.9 232.9 58.4 230.8 66.8L215.5 127C214.4 131.4 209.9 134 205.6 132.7L145.8 115.9C137.4 113.5 128.4 115.9 122.3 122C116.2 128.1 113.8 137.1 116.2 145.5L133.1 205.3C134.3 209.6 131.7 214.1 127.4 215.2L67.1 230.5C58.7 232.6 52.1 239.2 49.8 247.6C47.5 256 50 264.9 56.2 271L100.7 314.3C103.9 317.4 103.9 322.6 100.7 325.8L56.3 369.1C50.1 375.2 47.6 384.1 49.9 392.5C52.2 400.9 58.8 407.4 67.2 409.6L127.4 424.9C131.8 426 134.4 430.5 133.1 434.8L116.2 494.5C113.8 502.9 116.2 511.9 122.3 518C128.4 524.1 137.4 526.5 145.8 524.1L205.6 507.2C209.9 506 214.4 508.6 215.5 512.9L230.8 573.1C232.9 581.5 239.5 588.1 247.9 590.4C256.3 592.7 265.2 590.2 271.3 584L314.6 539.5C317.7 536.3 322.9 536.3 326.1 539.5L369.3 584C375.4 590.2 384.3 592.7 392.7 590.4C401.1 588.1 407.6 581.5 409.8 573.1L425.1 513C426.2 508.6 430.7 506 435 507.3L494.8 524.2C503.2 526.6 512.2 524.2 518.3 518.1C524.4 512 526.8 503 524.4 494.6L507.5 434.8C506.3 430.5 508.9 426 513.2 424.9L573.4 409.6C581.8 407.5 588.4 400.9 590.7 392.5C593 384.1 590.5 375.1 584.3 369.1L539.8 325.8C536.6 322.7 536.6 317.5 539.8 314.3L584.3 271C590.5 264.9 593 256 590.7 247.6C588.4 239.2 581.8 232.7 573.4 230.5L513.2 215.2C508.8 214.1 506.2 209.6 507.5 205.3L524.4 145.5C526.8 137.1 524.4 128.1 518.3 122C512.2 115.9 503.2 113.5 494.8 115.9L435 132.8C430.7 134 426.2 131.4 425.1 127.1L409.8 66.8C407.7 58.4 401.1 51.8 392.7 49.5C384.3 47.2 375.4 49.7 369.3 55.9L326 100.5C322.9 103.7 317.7 103.7 314.5 100.5L271.2 56z"/><path d="M250 330 l60 60 100 -140" stroke="#ffffff" stroke-width="40" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="5816 words" > <em>32 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Slack Workflow｜打造全自动 WFH 员工健康回报系统，结合 Google Sheets 与 App Script 提升效率</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">章節 (Chapters)🔖</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Slack Workflow｜打造全自动 WFH 员工健康回报系统，结合 Google Sheets 与 App Script 提升效率</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/en/slack-workflow-automate-wfh-employee-health-reporting-with-google-sheets-app-script-d61062833c1a/"><strong>Click here</strong></a> to view the English version of this article.</p></blockquote><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/slack-workflow-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8B%95-wfh-%E5%93%A1%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E5%A0%B1%E7%B3%BB%E7%B5%B1-%E7%B5%90%E5%90%88-google-sheets-%E8%88%87-app-script-%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87-d61062833c1a/"><strong>點擊這裡</strong></a>查看本文章正體中文版本。</p></blockquote><blockquote class="prompt-info"><p>基于 SEO 考量，本文标题与描述经 AI 调整，原始版本请参考内文。</p></blockquote><h4 id="zhgchgli-table-of-contents">文章目录</h4><nav class="zhgchgli-toc"><ul class="zhgchgli-toc-list"><li><a href="#slack-打造全自动-wfh-员工健康状况回报系统">Slack 打造全自动 WFH 员工健康状况回报系统</a></li><li class="has-children"><details><summary>前言 <a href="#前言">#</a></summary><ul><li><a href="#我们的-优化前-的-flow">我们的 优化前 的 Flow</a></li><li><a href="#问题点">问题点</a></li><li><a href="#解决方案">解决方案</a></li><li><a href="#优化后-的-flow">优化后 的 Flow</a></li><li><a href="#成效">成效</a></li></ul></details></li><li class="has-children"><details><summary>运作原理 <a href="#运作原理">#</a></summary><ul><li><a href="#身份识别">身份识别</a></li></ul></details></li><li class="has-children"><details><summary>开始动手做 <a href="#开始动手做">#</a></summary><ul><li><a href="#建立健康回报-google-form-表单--连结回复到-google-sheet">建立健康回报 Google Form 表单 & 连结回复到 Google Sheet</a></li><li><a href="#建立-slack-workflow-form-填写入口">建立 Slack Workflow Form 填写入口</a></li><li><a href="#将-slack-workflow-from-与-google-sheet-串接">将 Slack workflow from 与 Google Sheet 串接</a></li><li><a href="#slack-workflow-from-取得填写时间">Slack workflow from 取得填写时间</a></li><li><a href="#slack-workflow-form-增加填写回执">Slack workflow form 增加填写回执</a></li></ul></details></li><li class="has-children"><details><summary>Google Sheet with App Script! <a href="#google-sheet-with-app-script">#</a></summary><ul><li><a href="#将-responses-的资料依照填写日期分发到各日期的-sheet">将 Responses 的资料依照填写日期分发到各日期的 Sheet</a></li><li><a href="#取得当前日期的-sheet-与员工名单比对产生未填写名单-sheet-的资料">取得当前日期的 Sheet 与员工名单比对，产生未填写名单 Sheet 的资料</a></li><li><a href="#读取未填写名单-sheet-组合出讯息并发送到指定-slack-channel">读取未填写名单 Sheet 组合出讯息并发送到指定 Slack Channel</a></li><li><a href="#汇入员工名单">汇入员工名单</a></li><li><a href="#手动新增新员工资料">手动新增新员工资料</a></li></ul></details></li><li><a href="#done">DONE！</a></li><li><a href="#补充">补充</a></li><li><a href="#与-ios-开发相关的应用">与 iOS 开发相关的应用</a></li><li><a href="#延伸阅读">延伸阅读</a></li></ul></nav><hr /><h3 id="slack-打造全自动-wfh-员工健康状况回报系统"><span class="me-2">Slack 打造全自动 WFH 员工健康状况回报系统</span><a href="#slack-打造全自动-wfh-员工健康状况回报系统" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>玩转 Slack Workflow 搭配 Google Sheet with App Script 增加工作效率</p><p><a href="/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.webp" alt="Photo by [Stephen Phillips — Hostreviews.co.uk](https://unsplash.com/@hostreviews?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjkzMyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Photo by <a href="https://unsplash.com/@hostreviews?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank">Stephen Phillips — Hostreviews.co.uk</a></p><h3 id="前言"><span class="me-2">前言</span><a href="#前言" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>因应全面居家工作，公司关心所有成员的健康，每日均需回报身体有无状况并由 People Operations 统一纪录管理。</p><h4 id="我们的-优化前-的-flow"><span class="me-2">我们的 优化前 的 Flow</span><a href="#我们的-优化前-的-flow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/d61062833c1a/1*brnD44gjwyWEyK14dQYfxQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*brnD44gjwyWEyK14dQYfxQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjIyMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ol><li><p>[自动化] Slack Channel 每日早上 10 点定时发送提醒大家健康表单的讯息(优化前唯一自动化的地方)</p><li><p>员工点击连结打开 Google Form 填写健康问题</p><li><p>资料存回 Google Sheet 回应纪录</p><li><p>[人工] People Operations 于每日接近下班时比对名单筛出忘记填写的员工</p><li><p>[人工] 于 Slack Channel 发送填写提醒讯息 &amp; 一个一个 tag 忘记填写的人</p></ol><blockquote><p><em>以上是敝司的健康回报追踪流程，每间公司依照规模及运作方式一定有所不同，本文仅以此做为优化范例，学习 Slack Workflow 使用、基本 App Script 撰写，实际还是要 by case 实作。</em></p></blockquote><h4 id="问题点"><span class="me-2">问题点</span><a href="#问题点" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><p>需跳出 Slack Context 使用浏览器打开 Google Form 网页才能填写，尤其在手机上更不方便</p><li><p>Google Form 仅能自动带入 Email 讯息，无法自动加上填写人名称、部门资讯</p><li><p>每日人工比对、人工 tag 非常花费人力时间</p></ul><h4 id="解决方案"><span class="me-2">解决方案</span><a href="#解决方案" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>做过蛮多自动化的小东西，这个流程资料源固定(员工名单)、条件单纯、动作很例行；一看就觉得很适合自动化，一开始没做是因为找不到好的填写方式(实际是找不到有趣可研究的点)；所以也就放著没管，直到看到 <a href="https://www.facebook.com/tzangms/posts/10157880898787657" target="_blank">海总理的这则 PO 文</a> 才发现 Slack Workflow 不只是可以做定时传讯息，还有 Form 表单的功能：</p><p><a href="/assets/d61062833c1a/1*yKBpGlHEVMj4QbjGuB7aHQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*yKBpGlHEVMj4QbjGuB7aHQ.webp" alt="图片取自： [海总理](https://www.facebook.com/tzangms/posts/10157880898787657){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjEwNTAiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>图片取自： <a href="https://www.facebook.com/tzangms/posts/10157880898787657" target="_blank">海总理</a></p><p>这下手就开始痒了啊！！</p><p>如果能搭配 Slack Workflow From 加上传讯息的自动化，岂不是能解决上面提到的 <strong>所有痛点</strong> ，原理可行！于是开始著手实作。</p><h4 id="优化后-的-flow"><span class="me-2">优化后 的 Flow</span><a href="#优化后-的-flow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>首先上一下优化后的流程及结果。</p><p><a href="/assets/d61062833c1a/1*jT5dAICg85lyCF0sJwk8bQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*jT5dAICg85lyCF0sJwk8bQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjM4NyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ol><li><p>[自动化] Slack Channel 每日早上 10 点定时发送提醒大家健康表单的讯息</p><li><p>从 Google Form 或 Slack Workflow Form 填写健康问题</p><li><p>资料均存回 Google Sheet 回应纪录</p><li><p>People Operations 于每日接近下班时点击「产生未填写名单」按钮</p><li><p>[自动化] 使用 App Script 比对员工名单、填写名单筛出未填写名单</p><li><p>[自动化] 点击「产生＆发送讯息」自动发送未填写提醒＆自动 tag 对象</p><li><p>收工！</p></ol><h4 id="成效"><span class="me-2">成效</span><a href="#成效" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>(个人预估)</p><ul><li><p>填写时间每位员工每日能减少约 30 秒</p><li><p>People Operations 处理这件事每日能减少约 20 ~ 30 分钟</p></ul><h3 id="运作原理"><span class="me-2">运作原理</span><a href="#运作原理" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/d61062833c1a/1*xbZD2kkoYvWifQv8qyV_MQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*xbZD2kkoYvWifQv8qyV_MQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjczNiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>透过撰写 App Script 来管理 Sheet。</p><ol><li><p>将外部输入的资料都存放在 Responses Sheet</p><li><p>撰写 App Script Function 将 Responses 的资料依照填写日期分发到各日期的 Sheet，若无则建立新的日期 Sheet，Sheet 名称直接使用日期，方便辨识取用</p><li><p>取得当前日期的 Sheet 与员工名单比对，产生未填写名单 Sheet 的资料</p><li><p>读取未填写名单 Sheet 组合出讯息并发送到指定 Slack Channel</p></ol><ul><li><p>串接 Slack APP API 可自动读取指定 Channel 汇入员工名单</p><li><p>讯息内容使用 Slack UID Tag <code class="language-plaintext highlighter-rouge">&lt;@UID&gt;</code> 就能标记未填写的成员。</p></ul><h4 id="身份识别"><span class="me-2">身份识别</span><a href="#身份识别" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>串起 Google From 与 Slack 的身份识别资讯是 Email，所以请确保公司同仁都是使用公司 Email 填写 Google Form、Slack 个人资讯部分也都有填写公司 Email。</p><h3 id="开始动手做"><span class="me-2">开始动手做</span><a href="#开始动手做" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>问题、优化方式、成果讲完后，接下来来到实作环节；让我们一起一步步完成这个自动化 Case。</p><blockquote><p><em>篇幅有点长，可依照略过自己已了解的区块，或直接从完成结果建立副本，边看边改边学。</em></p></blockquote><p>完成结果表单： <a href="https://forms.gle/aqGDCELpAiMFFoyDA" target="_blank">https://forms.gle/aqGDCELpAiMFFoyDA</a></p><p>完成结果 Google Sheet：</p><p><a href="https://docs.google.com/spreadsheets/d/1PTk7G7r4P1sGk46sYjomUbfRO9ouPRF0wbmc84ZXA4c/edit?resourcekey#gid=953539493" target="_blank" class="img-link shimmer" ><img src="https://lh7-us.googleusercontent.com/docs/AHkbwyJ1ypxX3zGwj1swDPSHovOJC_A2eW-sFDKPJO5iRD82y7adF2SKqDluUOOjqnbnezy7RyBFtsGcuKyrUWbPk-NNbMfsPl3rUmfiYLt2F611-cHP_Ig=w1200-h630-p" alt="" loading="lazy"></a></p><h4 id="建立健康回报-google-form-表单--连结回复到-google-sheet"><span class="me-2">建立健康回报 Google Form 表单 &amp; 连结回复到 Google Sheet</span><a href="#建立健康回报-google-form-表单--连结回复到-google-sheet" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>步骤省略，有问题请直接 Google，这边假定你已经建立＆连结好了健康回报表单。</p><p><strong>表单要记得勾选「Collect emails」：</strong></p><p><a href="/assets/d61062833c1a/1*DKVg1oWvx0p2K_aYslK5ZQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*DKVg1oWvx0p2K_aYslK5ZQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3ODMiIGhlaWdodD0iNzY0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>收集填写者的 Email 以利之后比对名单用。</p><p><strong>怎么连结回复到 Google Sheet？</strong></p><p><a href="/assets/d61062833c1a/1*Ie0WvV5zWNubaYq_hBbeNw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*Ie0WvV5zWNubaYq_hBbeNw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MTQiIGhlaWdodD0iMzAxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>于表单的上方切换到「回复」点击「Google Sheet Icon」即可。</p><p><strong>更改连结的 Sheet 名称：</strong></p><p><a href="/assets/d61062833c1a/1*1A3m2zx1hI039TgWt3iU5A.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*1A3m2zx1hI039TgWt3iU5A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NjYiIGhlaWdodD0iNTgiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>这边建议将连结的 Sheet 名称由 Form Responses 1 改为 Responses 方便使用。</p><h4 id="建立-slack-workflow-form-填写入口"><span class="me-2">建立 Slack Workflow Form 填写入口</span><a href="#建立-slack-workflow-form-填写入口" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>传统的 Google From 填写入口有了之后，我们先来新增 Slack 填写方式。</p><p><a href="/assets/d61062833c1a/1*pkCpzbA6YLORazNfQS2ntA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*pkCpzbA6YLORazNfQS2ntA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDkxIiBoZWlnaHQ9Ijk3OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>于 Slack 任意对话视窗中找到「 <strong>输入匡 下方</strong> 」的「蓝色闪电⚡️」点击下去</p><p><a href="/assets/d61062833c1a/1*GpUOoQ2b_W7bMeeOlkosoA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*GpUOoQ2b_W7bMeeOlkosoA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDkxIiBoZWlnaHQ9Ijk3OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>在选单底下「Search shortcuts」中输入「workflow」选择「Open Workflow Builder」</p><p><a href="/assets/d61062833c1a/1*qgt-WjyrG_5OtaUjjt6r9Q.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*qgt-WjyrG_5OtaUjjt6r9Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>这边会列出你建立的或参与的 Workflow，点选右上角「Create」建立新 Workflow</p><p><a href="/assets/d61062833c1a/1*3qUC2S7sskImnDmXcnqMtg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*3qUC2S7sskImnDmXcnqMtg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>第一步，输入 workflow 名称（Workflow Builder 介面显示用）</p><p><a href="/assets/d61062833c1a/1*q94eI0z8ljhBrjrPEGWa8w.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*q94eI0z8ljhBrjrPEGWa8w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDkyIiBoZWlnaHQ9Ijc2OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Workflow 触发方式，选择「Shortcut」</p><p>目前一共有 5 种 slack workflow 触发时间点：</p><ul><li><p>Shortcut：手动触发「蓝色闪电⚡️」选项，会出现在 workflow 选单中，点击即可开始 workflow。</p><li><p>New channel member：当 Target Channel 有新成员加入时…. (EX: 欢迎讯息)</p><li><p>Emoji reactions：当有人对 Target Channel 中的讯息按下指定表情符号时…(或许可拿来做重要讯息已读请按 XXX Emoji，以此知道谁已读了？)</p><li><p>Scheduled date &amp; time：排程，指定时间到时…(EX: 定时发提醒回报讯息)</p><li><p>Webhook：外部 Webhook 触发，进阶功能，可与第三方或自己架 API 串起内部工作流程。</p></ul><p>这边我们选择「Shortcut」建立手动触发选项。</p><p><a href="/assets/d61062833c1a/1*2NEcjJtkDwuQtF-DmnhgOg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*2NEcjJtkDwuQtF-DmnhgOg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>选择这个 Workflow Shortcut 要加入在「哪一个 Channel 输入匡」之下及输入「要显示的名称」</p><blockquote><p>*一个 workflow shortcut 仅能加入在一个 channel 中</p></blockquote><p><a href="/assets/d61062833c1a/1*Qq-nJr66qoGsXxhPEsUhWw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*Qq-nJr66qoGsXxhPEsUhWw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Shortcut 建立完成！开始建立 workflow 步骤，点击「Add Step」加入步骤</p><p><a href="/assets/d61062833c1a/1*aUerPfBPlOhkNGoeiougGA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*aUerPfBPlOhkNGoeiougGA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>选择「Send a form」Step</p><p><a href="/assets/d61062833c1a/1*DBPCTHNyKBuJIvEJCyexyg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*DBPCTHNyKBuJIvEJCyexyg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MTYiIGhlaWdodD0iODg2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><strong>Title</strong> ：输入表单标题</p><p><strong>Add a question</strong> ：输入第一个问题的题目（可自行在标题标注问题编号 ex: 1.,2.,3….）</p><p><strong>Choose a question type</strong> ：</p><ul><li><p>Short answer：单行输入匡</p><li><p>Long answer：多行输入匡</p><li><p>Select from a list：单选列表</p><li><p>Select a person：选择一位同个 Workspace 内的成员</p><li><p>Select a channel or DM：选择一位同个 Workspace 内的成员 或 Group DM 或 Channel</p></ul><p><a href="/assets/d61062833c1a/1*pYIUTLaHVzHzFkAypN2_sw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*pYIUTLaHVzHzFkAypN2_sw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>「Select from a list」为例：</p><ol><li><p>Add list item：可新增一个选项</p><li><p>Default selection：选择预设选项</p><li><p>Make theis required：将此问题设为必填</p></ol><p><a href="/assets/d61062833c1a/1*hb1l9_E8EmHgUqIvHuBqhw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*hb1l9_E8EmHgUqIvHuBqhw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ol><li><p>Add Question：可新增更多问题</p><li><p>右方「↓」「⬆」可调整顺序、「✎」可展开编辑</p><li><p>可选择是否要将表单填写内容回传至 Channel 或 某人</p></ol><p><a href="/assets/d61062833c1a/1*WsHqG3hxgivNfFXakMgVrQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*WsHqG3hxgivNfFXakMgVrQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>也可以选择传送回复到…：</p><ul><li><p>Person who clicked ….：点击这个表单的人（形同填写的人）</p><li><p>Channel where workflow started：这个 workflow 添加到的 Channel</p></ul><p><a href="/assets/d61062833c1a/1*xyrdyrx9ACpWTcjAtG-rTQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*xyrdyrx9ACpWTcjAtG-rTQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>表单完成后点击「Save」储存步骤。</p><blockquote><p>*这边我们取消勾选将表单填写内容回传，因为想要在后面步骤自行客制化讯息内容。</p></blockquote><h4 id="将-slack-workflow-from-与-google-sheet-串接"><span class="me-2">将 Slack workflow from 与 Google Sheet 串接</span><a href="#将-slack-workflow-from-与-google-sheet-串接" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>如果还没有将 Google Sheet App 加入到 Slack 可先 <a href="https://slack.com/apps/A01AWGA48G6-google-sheets-for-workflow-builder" target="_blank">点此安装 APP</a> 。</p><p><a href="/assets/d61062833c1a/1*da6ofGd-N0NsBs4LNDsllQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*da6ofGd-N0NsBs4LNDsllQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>继上一步后，点击「Add Step」加入新步骤，我们选择 Google Sheets for Workflow Builder 的「Add a spreadsheet row」步骤。</p><p><a href="/assets/d61062833c1a/1*6h_t9tPiam735pth-n0AOw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*6h_t9tPiam735pth-n0AOw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ol><li><p>首先要完成 Google 帐号的授权，点击「Connect account」</p><li><p>Select a spreadsheet：选择目标回应的 Google Sheet，请选择一开始建立的 Google Form 之 Google Sheet</p><li><p>Sheet：同上</p><li><p>Column name：第一个欲填入值的 Column，这边先选问题ㄧ</p></ol><p><a href="/assets/d61062833c1a/1*XPwkmIHRj8WKEM27kH3YQg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*XPwkmIHRj8WKEM27kH3YQg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>点击右下角「Insert Variable」选择「Response to 问题一…」，插入之后可由左下角「Add Column」加入其他栏位，以此类推完成问题二、问题三….</p><p><a href="/assets/d61062833c1a/1*wX7vJDvdneYrid0nECUIeg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*wX7vJDvdneYrid0nECUIeg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>填写人的 Email，可选择「Person who submitted form」</p><p><a href="/assets/d61062833c1a/1*lQqJ0x7CeVK9u7g2R2VktQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*lQqJ0x7CeVK9u7g2R2VktQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>在点击插入的变数，选择「Email」即可自动带入填写人的 Email。</p><ul><li><p>Mention (default)：tag 该 User，Raw data 是 <code class="language-plaintext highlighter-rouge">&lt;@User ID&gt;</code></p><li><p>Name：User 名称</p><li><p>Email：User Email</p></ul><p><a href="/assets/d61062833c1a/1*CYKDEtnuCKuSgSbAbunB4A.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*CYKDEtnuCKuSgSbAbunB4A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Timestamp 栏位比较 tricky 等下再补充设定方法，先点「Save」储存后回到页面右上角按「Publish」发布 Shortcut。</p><p><a href="/assets/d61062833c1a/1*k4rJidYWiVHgco3NYxmA3w.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*k4rJidYWiVHgco3NYxmA3w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MDEiIGhlaWdodD0iMjI2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>看到发布成功讯息后，可以回到 Slack Channel 试试看。</p><p><a href="/assets/d61062833c1a/1*XaQ75kM9BnKgcmAEl63fPg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*XaQ75kM9BnKgcmAEl63fPg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDkxIiBoZWlnaHQ9Ijk3OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>这时候点闪电之后会出现刚刚建立的 Workflow form，可以点来填写玩玩。</p><p><a href="/assets/d61062833c1a/1*W5v-uUjhVTik05TLDwM-uQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*W5v-uUjhVTik05TLDwM-uQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MzUiIGhlaWdodD0iNDU1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/d61062833c1a/1*63CaYi-HlPWRqxExL-GseQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*63CaYi-HlPWRqxExL-GseQ.webp" alt="左：电脑 右：手机版" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3OTIiIGhlaWdodD0iMTIwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>左：电脑 / 右：手机版</p><p>我们可以填写资讯「Submit」测试看看是否正常。</p><p><a href="/assets/d61062833c1a/1*xt7JeHRojIWgJCYrw8sKdw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*xt7JeHRojIWgJCYrw8sKdw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MzMiIGhlaWdodD0iMzMzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>成功！但可以看到 Timestamp 栏位为空，下一步我们来解决这个问题。</p><h4 id="slack-workflow-from-取得填写时间"><span class="me-2">Slack workflow from 取得填写时间</span><a href="#slack-workflow-from-取得填写时间" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Slack workflow 没有 current timestamp 的 global variable 可用，至少目前还没有，只找到一篇 <a href="https://www.reddit.com/r/Slack/comments/l1gzhf/is_there_a_global_timestamp_variable_for_the/" target="_blank">reddit 上的许愿文章</a> 。</p><p>一开始异想天开在 Column Value 输入 <code class="language-plaintext highlighter-rouge">=NOW()</code> 但这样所有纪录的时间永远是当前时间，完全错误。</p><p>同样拜 <a href="https://www.reddit.com/r/Slack/comments/l1gzhf/is_there_a_global_timestamp_variable_for_the/" target="_blank">reddit 那篇文章</a> 大神网友提供的 tricky 方法，可以建一个干净的 Timestamp Sheet 里面放一个列资料、栏位 <code class="language-plaintext highlighter-rouge">=NOW()</code> 先用 Update 迫使栏位变为最新，在 Select 得到当前 Timestamp。</p><p><a href="/assets/d61062833c1a/1*54QcEy5QPBt3VXuRSe7-Vw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*54QcEy5QPBt3VXuRSe7-Vw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NDUiIGhlaWdodD0iMjgzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>如上图结构，点此 <a href="https://docs.google.com/spreadsheets/d/1PTk7G7r4P1sGk46sYjomUbfRO9ouPRF0wbmc84ZXA4c/edit?resourcekey#gid=1106265498" target="_blank">查看范例</a> 。</p><ul><li><p>Row： 类似 ID 的用处，直接设「1」，之后设定 Select &amp; Update 会要用到，告知资料列。</p><li><p>Timestamp：设定值 <code class="language-plaintext highlighter-rouge">=NOW()</code> 让他永远显示当前时间</p><li><p>Value：用以触发 Timestamp 栏位更新时间，内容随意，这边是把填写人的 Email 塞进来放，反正只要能触发更新就好。</p></ul><blockquote><p><em>可在 Sheet 上按右键「Hide Sheet」隐藏此 Sheet，因为没有要让外部使用。</em></p></blockquote><p>回到 Slack Workflow Builder 编辑刚刚 建立的 workflow form。</p><p>点击「Add Step」新增步骤：</p><p><a href="/assets/d61062833c1a/1*5lIcdnMQnmglNxaiY8fNUQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*5lIcdnMQnmglNxaiY8fNUQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>往下滑选择「Update a spreadsheet row」</p><p><a href="/assets/d61062833c1a/1*kRBL8iptGYd2Gsy7Lv6gGA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*kRBL8iptGYd2Gsy7Lv6gGA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>「Select a spreadsheet」选择刚刚的 Sheet，「Sheet」选择新建立的「Timestamp」Sheet。</p><p>「Choose a column to search」选择「Row」，Define a cell value to find 输入「1」。</p><p><a href="/assets/d61062833c1a/1*H8pb9TKvazhqiKKSCKcwCQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*H8pb9TKvazhqiKKSCKcwCQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>「Update these columns」「Column name」选择「Value」、「Value」点选「Insert variable」-&gt;「Person who submitted」-&gt;「选择 Email」。</p><p>点「Save」完成！现在已经完成触发 Sheet 中的 timestamp 更新了，再来是读取出来用。</p><p><a href="/assets/d61062833c1a/1*avXovKvXz9mlHOq2NWaf3A.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*avXovKvXz9mlHOq2NWaf3A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>回到编辑页后再点一次「Add Step」加入新步骤，这次选「Select a spreadsheet row」我们要读取 Timestamp 出来。</p><p><a href="/assets/d61062833c1a/1*xEbDUkWd3utQ9QpllqSNHg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*xEbDUkWd3utQ9QpllqSNHg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjgxMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Search 部分同「Update a spreadsheet row」，按「Save」。</p><p><a href="/assets/d61062833c1a/1*VO3lfeTe1bxlL3xN3_wtwQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*VO3lfeTe1bxlL3xN3_wtwQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjkyMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Save 完回到步骤列表页，我们可以把滑鼠移到步骤上用拖曳更改顺序。</p><p>将顺序改「Update a spreadsheet row」-&gt;「Select a spreadsheet」-&gt;「Add a spreadsheet row」。</p><p>意即：Update 触发 timestamp 更新 -&gt; 读取 Timestamp -&gt; 在新增 Row 时拿来用。</p><p>在「Add a spreadsheet row」点「Edit」编辑：</p><p><a href="/assets/d61062833c1a/1*8IH_AJZn0YHFk5obccmUYg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*8IH_AJZn0YHFk5obccmUYg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjkyMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>拉到最下面按左下角「Add Column」在点右下角「Insert a variable」，找到「Select a spreadsheet」Section 中的「Timestamp」变数，注入进去。</p><p><a href="/assets/d61062833c1a/1*-4vk8fjRwkIVSY4Pu-C6VA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*-4vk8fjRwkIVSY4Pu-C6VA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjkyMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>按「Save」储存步骤后回到列表页，右上角点「Publish Change」发布更改。</p><p>这时候我们再测试一次 workflow shortcut 看看 timestamp 有没有正常写入。</p><p><a href="/assets/d61062833c1a/1*GyJ-55XxVEcZ6Cb1Q_H-WQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*GyJ-55XxVEcZ6Cb1Q_H-WQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5NDYiIGhlaWdodD0iMTYwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>成功！</p><h4 id="slack-workflow-form-增加填写回执"><span class="me-2">Slack workflow form 增加填写回执</span><a href="#slack-workflow-form-增加填写回执" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>同 Google Form 填写回执，Slack workflow form 也可以。</p><p>在编辑步骤页我们可以再加入一个步骤，点击「Add Step」。</p><p><a href="/assets/d61062833c1a/1*16JMg7a_YzUHnnY6JtBrGw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*16JMg7a_YzUHnnY6JtBrGw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjkyMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>这次选择「Send a message」</p><p><a href="/assets/d61062833c1a/1*2CJuPDtuaTM9P5wIKwPspQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*2CJuPDtuaTM9P5wIKwPspQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjkyMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>「Send this message to」选择「Person who submitted form」</p><p><a href="/assets/d61062833c1a/1*xKh_l7A-z31B6rQPboFTAA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*xKh_l7A-z31B6rQPboFTAA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTM2IiBoZWlnaHQ9IjkyMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>讯息内容依序输入题目名称、「Insert a variable」选择「Response to 题目 XXX」，也可在最后插入「Timestamp」，按「Save」储存步骤后再按「Publish Changes」即可！</p><blockquote><p><em>另外也可使用「Send a message」将填写结果传送到特定 Channel 或 DM。</em></p></blockquote><p><a href="/assets/d61062833c1a/1*gfTjTnaNmu-aPj0MuF6M_Q.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*gfTjTnaNmu-aPj0MuF6M_Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDkxIiBoZWlnaHQ9Ijk3OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>成功！</p><p>Slack workflow form 的设定大概到此结束，其他玩法可以自由搭配发挥。</p><h3 id="google-sheet-with-app-script"><span class="me-2">Google Sheet with App Script!</span><a href="#google-sheet-with-app-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>接下我们需要撰写 App Script 来处理填写资料。</p><p><a href="/assets/d61062833c1a/1*04KBQF7e4lCjQm5XeHgVrA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*04KBQF7e4lCjQm5XeHgVrA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NjIiIGhlaWdodD0iNDkwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>首先在 Google Sheet 上方工具栏选择「Tools」-&gt;「Script editor」</p><p><a href="/assets/d61062833c1a/1*wlg8D_1DHONj__M1dSBCxw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*wlg8D_1DHONj__M1dSBCxw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3OTEiIGhlaWdodD0iMjcyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>可以点击左上角给专案一个名称。</p><p>现在我们可以开始撰写 App Script！App Script 是基于 Javascript 设计，所以可以直接使用 Javascript 程式码用法搭配 Google Sheet 的 lib。</p><h4 id="将-responses-的资料依照填写日期分发到各日期的-sheet"><span class="me-2">将 Responses 的资料依照填写日期分发到各日期的 Sheet</span><a href="#将-responses-的资料依照填写日期分发到各日期的-sheet" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/d61062833c1a/1*T5ExI_5aSf7QY5Zj_gJ3eg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*T5ExI_5aSf7QY5Zj_gJ3eg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTI4IiBoZWlnaHQ9Ijc0NiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nf">formatData</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">bufferSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getActiveSpreadsheet</span><span class="p">().</span><span class="nf">getSheetByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">Responses</span><span class="dl">'</span><span class="p">)</span> <span class="c1">// 储存回复的 Sheet 名称</span>
  
  <span class="kd">var</span> <span class="nx">rows</span> <span class="o">=</span> <span class="nx">bufferSheet</span><span class="p">.</span><span class="nf">getDataRange</span><span class="p">().</span><span class="nf">getValues</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">fileds</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="kd">var</span> <span class="nx">startDeleteIndex</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">deleteLength</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="nx">index</span> <span class="k">in</span> <span class="nx">rows</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">fileds</span> <span class="o">=</span> <span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">sheetName</span> <span class="o">=</span> <span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="nf">toLocaleDateString</span><span class="p">(</span><span class="dl">"</span><span class="s2">en-US</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// 将 Date 转换成 String，使用美国日期格式 MM/DD/YYYY</span>
    <span class="kd">var</span> <span class="nx">sheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getActiveSpreadsheet</span><span class="p">().</span><span class="nf">getSheetByName</span><span class="p">(</span><span class="nx">sheetName</span><span class="p">);</span> <span class="c1">// 取得 MM/DD/YYYY Sheet</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">sheet</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 若无则新增</span>
      <span class="nx">sheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getActiveSpreadsheet</span><span class="p">().</span><span class="nf">insertSheet</span><span class="p">(</span><span class="nx">sheetName</span><span class="p">,</span> <span class="nx">bufferSheet</span><span class="p">.</span><span class="nf">getIndex</span><span class="p">());</span>
      <span class="nx">sheet</span><span class="p">.</span><span class="nf">appendRow</span><span class="p">(</span><span class="nx">fileds</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">sheet</span><span class="p">.</span><span class="nf">appendRow</span><span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">]);</span> <span class="c1">// 将资料新增至日期 Sheet</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">startDeleteIndex</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">startDeleteIndex</span> <span class="o">=</span> <span class="o">+</span><span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">deleteLength</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if </span><span class="p">(</span><span class="nx">deleteLength</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">bufferSheet</span><span class="p">.</span><span class="nf">deleteRows</span><span class="p">(</span><span class="nx">startDeleteIndex</span><span class="p">,</span> <span class="nx">deleteLength</span><span class="p">);</span> <span class="c1">// 搬移到指定 Sheet 后，移除 Responses 里的资料</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>在 Code 区块中贴上以上程式码，并按「control」+「s」储存。</p><p>再来我们要在 Sheet 中新增触发按钮（ <strong>只能手动按按钮触发，无法在资料写入时做自动分</strong> ）</p><p><a href="/assets/d61062833c1a/1*XvugOM6drupik0wejbBnnA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*XvugOM6drupik0wejbBnnA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NDEiIGhlaWdodD0iODc0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ol><li><p>首先在建立一个新的 Sheet，取名「未填写名单」</p><li><p>上方工具列选择「Insert」-&gt;「Drawing」</p></ol><p><a href="/assets/d61062833c1a/1*BG70QTiE-8QNvlp31jDBMA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*BG70QTiE-8QNvlp31jDBMA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDA4IiBoZWlnaHQ9IjM0OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>使用此介面，拉出一个按钮。</p><p><a href="/assets/d61062833c1a/1*BXXmUWkal7XjluhLcDaSIQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*BXXmUWkal7XjluhLcDaSIQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NTAiIGhlaWdodD0iMjU2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>「Save and Close」后可调整、移动按钮；点击右上角「…」选择「Assign script」</p><p><a href="/assets/d61062833c1a/1*nx2qjDTUKeyorO0W9nOxKA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*nx2qjDTUKeyorO0W9nOxKA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MDIiIGhlaWdodD0iMjU4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>输入「formatData」function 名称。</p><p>可点击加入的按钮试试功能</p><p><a href="/assets/d61062833c1a/1*eZpg-qejhpuPgUY7KDg00Q.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*eZpg-qejhpuPgUY7KDg00Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NjkiIGhlaWdodD0iMTg3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>若出现 「Authorization Required」则点选「Continue」完成验证</p><p><a href="/assets/d61062833c1a/1*hIgRtqKEFs0tsXDxfNTaOg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*hIgRtqKEFs0tsXDxfNTaOg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NjgiIGhlaWdodD0iNjI0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>在身份验证的过程中会出现「Google hasn’t verified this app」这是正常的，因为我们写的 App Script 没有经过 Google 验证，不过没关系这是写给自己用的。</p><p>可点选左下角「Advanced」-&gt;「Go to Health Report (Responses) (unsafe)」</p><p><a href="/assets/d61062833c1a/1*QUkmTD1WlEzw7cqW97ll6Q.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*QUkmTD1WlEzw7cqW97ll6Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MTIiIGhlaWdodD0iNjkyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>点击「Allow」</p><p><a href="/assets/d61062833c1a/1*0ZPVBwOR2bB4QPsTGX_yCA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*0ZPVBwOR2bB4QPsTGX_yCA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMjkiIGhlaWdodD0iOTciPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><blockquote><p><em>App Script 执行中会显示「Running Script」这时候请勿再按，避免重复执行。</em></p></blockquote><p><a href="/assets/d61062833c1a/1*i12l4Q5Y2N9bM9CzTo6XDg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*i12l4Q5Y2N9bM9CzTo6XDg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNTAiIGhlaWdodD0iNjQiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><blockquote><p><em>显示执行成功后，才能再次执行。</em></p></blockquote><p><a href="/assets/d61062833c1a/1*NbOfqAwIYSUAtJ32hSEOCQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*NbOfqAwIYSUAtJ32hSEOCQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NDIiIGhlaWdodD0iMzI4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>成功！将填写资料依照日期分组。</p><h4 id="取得当前日期的-sheet-与员工名单比对产生未填写名单-sheet-的资料"><span class="me-2">取得当前日期的 Sheet 与员工名单比对，产生未填写名单 Sheet 的资料</span><a href="#取得当前日期的-sheet-与员工名单比对产生未填写名单-sheet-的资料" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>我们再加入一段 Code：</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="c1">// 与员工名单 Sheet ＆ 本日填写 Sheet 比对，产出未填写名单</span>
<span class="kd">function</span> <span class="nf">generateUnfilledList</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">listSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getActiveSpreadsheet</span><span class="p">().</span><span class="nf">getSheetByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">员工名单</span><span class="dl">'</span><span class="p">)</span> <span class="c1">// 员工名单 Sheet 名称</span>
  <span class="kd">var</span> <span class="nx">unfilledListSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getActiveSpreadsheet</span><span class="p">().</span><span class="nf">getSheetByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">未填写名单</span><span class="dl">'</span><span class="p">)</span> <span class="c1">// 未填写名单 Sheet 名称</span>
  <span class="kd">var</span> <span class="nx">today</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">todayName</span> <span class="o">=</span> <span class="nx">today</span><span class="p">.</span><span class="nf">toLocaleDateString</span><span class="p">(</span><span class="dl">"</span><span class="s2">en-US</span><span class="dl">"</span><span class="p">);</span>

  <span class="kd">var</span> <span class="nx">todayListSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getActiveSpreadsheet</span><span class="p">().</span><span class="nf">getSheetByName</span><span class="p">(</span><span class="nx">todayName</span><span class="p">)</span> <span class="c1">// 取得本日 MM/DD/YYYY Sheet</span>
  <span class="k">if </span><span class="p">(</span><span class="nx">todayListSheet</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getUi</span><span class="p">().</span><span class="nf">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">找不到</span><span class="dl">'</span><span class="o">+</span><span class="nx">todayName</span><span class="o">+</span><span class="dl">'</span><span class="s1">本日的 Sheet 或请先执行「整理填写资料」</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">todayEmails</span> <span class="o">=</span> <span class="nx">todayListSheet</span><span class="p">.</span><span class="nf">getDataRange</span><span class="p">().</span><span class="nf">getValues</span><span class="p">().</span><span class="nf">map</span><span class="p">(</span> <span class="nx">x</span> <span class="o">=&gt;</span> <span class="nx">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="c1">// 取得本日 Sheet Email Address 栏位资料列表 (1 = Column B)</span>
  <span class="c1">// index start from 0, so 1 = Column B</span>
  <span class="c1">// output: Email Address,zhgchgli@gmail.com,alan@gamil.com,b@gmail.com...</span>
  <span class="nx">todayEmails</span><span class="p">.</span><span class="nf">shift</span><span class="p">()</span> <span class="c1">// 移除第一个资料，第一个是栏位名称「Email Address」无意义</span>
  <span class="c1">// output: zhgchgli@gmail.com,alan@gamil.com,b@gmail.com...</span>

  <span class="nx">unfilledListSheet</span><span class="p">.</span><span class="nf">clear</span><span class="p">()</span> <span class="c1">// 清除未填写名单...准备重新填入资料</span>
  <span class="nx">unfilledListSheet</span><span class="p">.</span><span class="nf">appendRow</span><span class="p">([</span><span class="nx">todayName</span><span class="o">+</span><span class="dl">"</span><span class="s2"> 未填写名单</span><span class="dl">"</span><span class="p">])</span> <span class="c1">// 第一行显示 Sheet 标题</span>

  <span class="kd">var</span> <span class="nx">rows</span> <span class="o">=</span> <span class="nx">listSheet</span><span class="p">.</span><span class="nf">getDataRange</span><span class="p">().</span><span class="nf">getValues</span><span class="p">();</span> <span class="c1">// 读取员工名单 Sheet</span>
  <span class="k">for</span><span class="p">(</span><span class="nx">index</span> <span class="k">in</span> <span class="nx">rows</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 第一列是标题栏位列，存下来，让后续产生资料也可补上第一列标题</span>
      <span class="nx">unfilledListSheet</span><span class="p">.</span><span class="nf">appendRow</span><span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">]);</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">if </span><span class="p">(</span><span class="nx">todayEmails</span><span class="p">.</span><span class="nf">includes</span><span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">3</span><span class="p">]))</span> <span class="p">{</span> <span class="c1">// 如果本日 Sheet Email Address 中有此员工的 Email 则代表有填写，continue 略过... (3 = Column D)</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">unfilledListSheet</span><span class="p">.</span><span class="nf">appendRow</span><span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">]);</span> <span class="c1">// 写入一行资料到未填写名单 Sheet</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>一样储存后，照前面加入 Code 的方法，再加入一个按钮并 Assign script — 「generateUnfilledList」。</p><p>完成后可点击测试：</p><p><a href="/assets/d61062833c1a/1*LCvfyjnvk3yCaoFnsvVhHg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*LCvfyjnvk3yCaoFnsvVhHg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjI4MSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>未填写名单产生成功！如果没有出现内容请先确定：</p><ul><li><p>员工名单已填写，或可先输入测试资料</p><li><p>要先完成「整理填写资料」动作</p></ul><h4 id="读取未填写名单-sheet-组合出讯息并发送到指定-slack-channel"><span class="me-2">读取未填写名单 Sheet 组合出讯息并发送到指定 Slack Channel</span><a href="#读取未填写名单-sheet-组合出讯息并发送到指定-slack-channel" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>首先我们要加入 Incoming WebHooks App 到 Slack Channel，我们会透过此媒介来传送讯息。</p><p><a href="/assets/d61062833c1a/1*AgGLiLsyvenK-LRWI9rlKg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*AgGLiLsyvenK-LRWI9rlKg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDkxIiBoZWlnaHQ9Ijg5NiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ol><li><p>Slack 左下角「Apps」-&gt;「Add apps」</p><li><p>右边搜寻匡搜寻「incoming」</p><li><p>点击「Incoming WebHooks」-&gt;「Add」</p></ol><p><a href="/assets/d61062833c1a/1*DUcwdLTKt33Fa-jNlW8MkA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*DUcwdLTKt33Fa-jNlW8MkA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDMyIiBoZWlnaHQ9IjQ5MSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/d61062833c1a/1*v8Z-5vEM043F82TMiZk2lw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*v8Z-5vEM043F82TMiZk2lw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5OTgiIGhlaWdodD0iNDY2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>选择未填写讯息想要传到的 Channel。</p><p><a href="/assets/d61062833c1a/1*SRciom_ygU0JDKK9ATY1FQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*SRciom_ygU0JDKK9ATY1FQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5NjYiIGhlaWdodD0iMjMxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>记下最上方的「Webhook URL」</p><p><a href="/assets/d61062833c1a/1*kp1QDIEwzQtmfzUwZIDTSg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*kp1QDIEwzQtmfzUwZIDTSg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MDMiIGhlaWdodD0iMjU5Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>往下滑可设定传送讯息时，传送 Bot 显示的名称及大头贴；改完记得按「Save Settings」。</p><p>回到我们的 Google Sheet Script</p><p>再加入一段 Code：</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nf">postSlack</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">ui</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getUi</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">ui</span><span class="p">.</span><span class="nf">alert</span><span class="p">(</span>
     <span class="dl">'</span><span class="s1">您确定要发送讯息?</span><span class="dl">'</span><span class="p">,</span>
     <span class="dl">'</span><span class="s1">发送未填写提醒讯息到 Slack Channel</span><span class="dl">'</span><span class="p">,</span>
      <span class="nx">ui</span><span class="p">.</span><span class="nx">ButtonSet</span><span class="p">.</span><span class="nx">YES_NO</span><span class="p">);</span>
  <span class="c1">// 避免误触，先询问确认</span>

  <span class="k">if </span><span class="p">(</span><span class="nx">result</span> <span class="o">==</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">Button</span><span class="p">.</span><span class="nx">YES</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">unfilledListSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getActiveSpreadsheet</span><span class="p">().</span><span class="nf">getSheetByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">未填写名单</span><span class="dl">'</span><span class="p">)</span> <span class="c1">// 未填写名单 Sheet 名称</span>
    <span class="kd">var</span> <span class="nx">rows</span> <span class="o">=</span> <span class="nx">unfilledListSheet</span><span class="p">.</span><span class="nf">getDataRange</span><span class="p">().</span><span class="nf">getValues</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">persons</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span><span class="p">(</span><span class="nx">index</span> <span class="k">in</span> <span class="nx">rows</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if </span><span class="p">(</span><span class="nx">index</span> <span class="o">==</span> <span class="mi">0</span> <span class="err">\\</span><span class="o">|</span><span class="err">\\</span><span class="o">|</span> <span class="nx">index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 略过标题、栏位标题那两行</span>
        <span class="k">continue</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="dl">""</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="p">:</span> <span class="p">(</span><span class="dl">"</span><span class="s2">&lt;@</span><span class="dl">"</span><span class="o">+</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="dl">"</span><span class="s2">&gt;</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// 标记对象，如果有 slack uid 优先使用，没有则单纯显示暱称；2 = Column B / 4 = Column E</span>
      <span class="k">if </span><span class="p">(</span><span class="nx">person</span> <span class="o">==</span> <span class="dl">""</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 都没视为异常资料，忽略</span>
        <span class="k">continue</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">persons</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span><span class="dl">"</span><span class="s2">• </span><span class="dl">"</span><span class="o">+</span><span class="nx">person</span><span class="o">+</span><span class="dl">'</span><span class="se">\n</span><span class="dl">'</span><span class="p">)</span> <span class="c1">// 将对象存入阵列</span>
    <span class="p">}</span>

    <span class="k">if </span><span class="p">(</span><span class="nx">persons</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 无对象需要被标记通知时，大家都有填，取消讯息送出</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">preText</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">*[健康回报表公告:loudspeaker:]*</span><span class="se">\n</span><span class="s2">公司关心各位的身体健康，烦请以下队友记得每日填写健康状况回报，谢谢:wink:</span><span class="se">\n\n</span><span class="s2">今日未填健康状况回报名单</span><span class="se">\n\n</span><span class="dl">"</span> <span class="c1">// 讯息开头内容...</span>
    <span class="kd">var</span> <span class="nx">postText</span> <span class="o">=</span> <span class="dl">"</span><span class="se">\n\n</span><span class="s2">填写健康状况回报能让公司了解队友们的身体状况，烦请队友们每日都要确实填写唷&gt;&lt; 谢谢大家:woman-bowing::skin-tone-2:</span><span class="dl">"</span> <span class="c1">// 讯息结尾内容...</span>
    <span class="kd">var</span> <span class="nx">payload</span> <span class="o">=</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="nx">preText</span><span class="o">+</span><span class="nx">persons</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="dl">''</span><span class="p">)</span><span class="o">+</span><span class="nx">postText</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">attachments</span><span class="dl">"</span><span class="p">:</span> <span class="p">[{</span>
          <span class="dl">"</span><span class="s2">fallback</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">这边可放 Google Form 填写连结</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">actions</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">form_link</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">前往健康状况回报</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">button</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">style</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">primary</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">url</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">这边可放 Google Form 填写连结</span><span class="dl">"</span>
            <span class="p">}</span>
          <span class="p">],</span>
          <span class="dl">"</span><span class="s2">footer</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">:rocket:小提示：点击输入匡下方的「:zap:️闪电」-&gt;「Shortcut Name」，即可直接填写。</span><span class="dl">"</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">这边输入你 slack incoming app 的 Webhook URL</span><span class="dl">'</span><span class="p">,{</span>
      <span class="na">method</span>             <span class="p">:</span> <span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">contentType</span>        <span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">payload</span>            <span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">stringify</span><span class="p">(</span><span class="nx">payload</span><span class="p">)</span>
    <span class="p">})</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>一样储存后，照前面加入 Code 的方法，再加入一个按钮并 Assign script — 「postSlack」。</p><p>完成后可点击测试：</p><p><a href="/assets/d61062833c1a/1*6vD5h6VQhYMRTpiT5ncfMQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*6vD5h6VQhYMRTpiT5ncfMQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NTEiIGhlaWdodD0iMzc3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/d61062833c1a/1*gwgJNkj3D4itq-xTGNctDw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*gwgJNkj3D4itq-xTGNctDw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2ODEiIGhlaWdodD0iNDY0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>成功！！！(显示 ＠U123456 没成功标记人是因为 ID 是我乱打的)</p><p>到此主要的功能都已完成！</p><blockquote><p><strong><em>备注</em></strong></p></blockquote><blockquote><p><em>请注意官方建议使用新的 Slack APP API 的 <a href="https://api.slack.com/methods/chat.postMessage" target="_blank">chat.postMessage</a> 来传送讯息，Incoming Webhook 简便的这个方式之后会弃用，这边偷懒没有使用，可搭配下一章「汇入员工名单」会需要 Slack App API 一起调整成新方法。</em></p></blockquote><p><a href="/assets/d61062833c1a/1*QfgJL_Xb9JhgQnPGjU2CXg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*QfgJL_Xb9JhgQnPGjU2CXg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDA2IiBoZWlnaHQ9Ijg3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><h4 id="汇入员工名单"><span class="me-2">汇入员工名单</span><a href="#汇入员工名单" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>这边会需要我们创建一个 Slack APP。</p><p>1.前往 <a href="https://api.slack.com/apps" target="_blank">https://api.slack.com/apps</a></p><ol><li>点击右上角「Create New App」</ol><p><a href="/assets/d61062833c1a/1*38It1hdMGq-Lr6hlPIcsWQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*38It1hdMGq-Lr6hlPIcsWQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MTciIGhlaWdodD0iMzk5Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ol><li>选择「 <strong>From scratch</strong> 」</ol><p><a href="/assets/d61062833c1a/1*-6FB9vEkju_NszxRrb9LKA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*-6FB9vEkju_NszxRrb9LKA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NDUiIGhlaWdodD0iMzg4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ol><li>输入「 <strong>App Name</strong> 」跟 你想要加入的 Workspace</ol><p><a href="/assets/d61062833c1a/1*8OPXRdVPW5xHpe1blQDh6w.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*8OPXRdVPW5xHpe1blQDh6w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MzMiIGhlaWdodD0iNDk4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ol><li>建立成功后，在左边选单选择「OAuth &amp; Permissions」设定页</ol><p><a href="/assets/d61062833c1a/1*ougV73wzEMnCZ1C3rtx8xg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*ougV73wzEMnCZ1C3rtx8xg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5NzMiIGhlaWdodD0iNjUwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ol><li>往下滑到 Scopes 区块</ol><p><a href="/assets/d61062833c1a/1*SprZwCDHq0gtdlN7O2sc-A.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*SprZwCDHq0gtdlN7O2sc-A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NTMiIGhlaWdodD0iNDMzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>依次「Add an OAuth Scope」以下项目：</p><ul><li><p><a href="https://api.slack.com/scopes/channels:read" target="_blank"><strong>channels:read</strong></a></p><li><p><a href="https://api.slack.com/scopes/users:read" target="_blank"><strong>users:read</strong></a></p><li><p><a href="https://api.slack.com/scopes/users:read.email" target="_blank"><strong>users:read.email</strong></a></p><li><p>如果想改用 APP 发讯息可在此加入 <a href="https://api.slack.com/methods/chat.postMessage" target="_blank"><strong>chat.postMessage</strong></a></p></ul><ol><li>回到最上面点击「Install to workspace」or「Reinstall to workspace」</ol><p><a href="/assets/d61062833c1a/1*iCmyMNlLwjhR9qsk-aTfxA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*iCmyMNlLwjhR9qsk-aTfxA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NTgiIGhlaWdodD0iNTIzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><blockquote><p><em>*如果 Scopes 有新增，也要回来这点重新安装。</em></p></blockquote><ol><li><p>安装完成，取得复制 <code class="language-plaintext highlighter-rouge">Bot User OAuth Token</code></p><li><p>使用网页版 Slack 打开想要汇入名单的 Channel</p></ol><p><a href="/assets/d61062833c1a/1*JK0omZIhk1fmP1TOkE2dpg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*JK0omZIhk1fmP1TOkE2dpg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjQ1NiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>从浏览器取得网址：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://app.slack.com/client/TXXXX/CXXXX
</pre></table></code></div></div><p>其中 <code class="language-plaintext highlighter-rouge">CXXXX</code> 就是这个 Channel 的 Channel ID，记下此讯息。</p><p>10.</p><p>回到我们的 Google Sheet Script</p><p>再加入一段 Code：</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nf">loadEmployeeList</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">formData</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">token</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Bot User OAuth Token</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">channel</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Channel ID</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">limit</span><span class="dl">'</span><span class="p">:</span> <span class="mi">500</span>
  <span class="p">};</span>
  <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">method</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">payload</span><span class="dl">'</span> <span class="p">:</span> <span class="nx">formData</span>
  <span class="p">};</span>
  <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://slack.com/api/conversations.members</span><span class="dl">'</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nf">getContentText</span><span class="p">());</span>
  <span class="k">for </span><span class="p">(</span><span class="nx">index</span> <span class="k">in</span> <span class="nx">data</span><span class="p">[</span><span class="dl">"</span><span class="s2">members</span><span class="dl">"</span><span class="p">])</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">uid</span> <span class="o">=</span> <span class="nx">data</span><span class="p">[</span><span class="dl">"</span><span class="s2">members</span><span class="dl">"</span><span class="p">][</span><span class="nx">index</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">formData</span> <span class="o">=</span> <span class="p">{</span>
      <span class="dl">'</span><span class="s1">token</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Bot User OAuth Token</span><span class="dl">'</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">user</span><span class="dl">'</span><span class="p">:</span> <span class="nx">uid</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
      <span class="dl">'</span><span class="s1">method</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">payload</span><span class="dl">'</span> <span class="p">:</span> <span class="nx">formData</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://slack.com/api/users.info</span><span class="dl">'</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nf">getContentText</span><span class="p">());</span>

    <span class="kd">var</span> <span class="nx">email</span> <span class="o">=</span> <span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">user</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">profile</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">email</span><span class="dl">"</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">real_name</span> <span class="o">=</span> <span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">user</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">profile</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">real_name_normalized</span><span class="dl">"</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">title</span> <span class="o">=</span> <span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">user</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">profile</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">title</span><span class="dl">"</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">row</span> <span class="o">=</span> <span class="p">[</span><span class="nx">title</span><span class="p">,</span> <span class="nx">real_name</span><span class="p">,</span> <span class="nx">real_name</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">uid</span><span class="p">];</span> <span class="c1">// 依照 Column 填入</span>

    <span class="kd">var</span> <span class="nx">listSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getActiveSpreadsheet</span><span class="p">().</span><span class="nf">getSheetByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">员工名单</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 员工名单 Sheet 名称</span>
    <span class="nx">listSheet</span><span class="p">.</span><span class="nf">appendRow</span><span class="p">(</span><span class="nx">row</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>但这次我们不需要再加入按钮，因为汇入仅第一次需要；所以只需存挡后直接执行即可。</p><p><a href="/assets/d61062833c1a/1*rkw-79xbgd3Nn99fDnLWDQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*rkw-79xbgd3Nn99fDnLWDQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0ODUiIGhlaWdodD0iMjE2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>首先按「control」+「s」存档，上方下拉选单改选择「loadEmployeeList」，点击「Run」就会开始汇入名单到员工名单 Sheet。</p><h4 id="手动新增新员工资料"><span class="me-2">手动新增新员工资料</span><a href="#手动新增新员工资料" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>尔后如果有新员工加入，可直接在员工名单 Sheet 新增一列，填入资讯，Slack UID 可在 Slack 上直接查询：</p><p><a href="/assets/d61062833c1a/1*7EF6ghe032Pp832_61Ui0w.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*7EF6ghe032Pp832_61Ui0w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMTAiIGhlaWdodD0iNDg4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>点击要查看 UID 的对象，点击「View full profile」</p><p><a href="/assets/d61062833c1a/1*uKOp7Xe7AQ4ODKR2t8iDMw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*uKOp7Xe7AQ4ODKR2t8iDMw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MzAiIGhlaWdodD0iNzI0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>点击「More」选择「Copy member ID」即是 UID。 <code class="language-plaintext highlighter-rouge">UXXXXX</code></p><h3 id="done"><span class="me-2">DONE！</span><a href="#done" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>以上所有步骤都已完成，可以开始自动化的追纵员工的健康状况。</p><p>完成档如下，可直接从以下 Google Sheet 建立副本修改后使用：</p><p><a href="https://docs.google.com/spreadsheets/d/1PTk7G7r4P1sGk46sYjomUbfRO9ouPRF0wbmc84ZXA4c/edit?resourcekey#gid=922128927" target="_blank" class="img-link shimmer" ><img src="https://lh7-us.googleusercontent.com/docs/AHkbwyJ1ypxX3zGwj1swDPSHovOJC_A2eW-sFDKPJO5iRD82y7adF2SKqDluUOOjqnbnezy7RyBFtsGcuKyrUWbPk-NNbMfsPl3rUmfiYLt2F611-cHP_Ig=w1200-h630-p" alt="" loading="lazy"></a></p><h3 id="补充"><span class="me-2">补充</span><a href="#补充" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>如果想要用 Scheduled date &amp; time 定时发送 form 讯息，要注意这情况下的 form 只能被填一次，所以不适合在这边使用…（至少目前版本还是这样），所以 Scheduled 填写提醒讯息依然只能用纯文字＋Google Form 连结。</ul><p><a href="/assets/d61062833c1a/1*iECjTdwjrRgMswu9MQOMFA.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*iECjTdwjrRgMswu9MQOMFA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0ODQiIGhlaWdodD0iNTEiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><ul><li><p>目前没有办法用超连结连到 Shortcut 打开 Form</p><li><p>Google Sheet App Script 防止重复执行：</p></ul><p>如果要防止不小心在执行中又再次按到导致重复执行，可在 function 一开始加上：</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">if </span><span class="p">(</span><span class="nx">PropertiesService</span><span class="p">.</span><span class="nf">getScriptProperties</span><span class="p">().</span><span class="nf">getProperty</span><span class="p">(</span><span class="dl">'</span><span class="s1">FUNCTIONNAME</span><span class="dl">'</span><span class="p">)</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">true</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nf">getUi</span><span class="p">().</span><span class="nf">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">忙碌中...请稍后再试</span><span class="dl">'</span><span class="p">);</span>
  <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">PropertiesService</span><span class="p">.</span><span class="nf">getScriptProperties</span><span class="p">().</span><span class="nf">setProperty</span><span class="p">(</span><span class="dl">'</span><span class="s1">FUNCTIONNAME</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">true</span><span class="dl">'</span><span class="p">);</span>
</pre></table></code></div></div><p>Function 执行结束时加上：</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nx">PropertiesService</span><span class="p">.</span><span class="nf">getScriptProperties</span><span class="p">().</span><span class="nf">setProperty</span><span class="p">(</span><span class="dl">'</span><span class="s1">FUNCTIONNAME</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">true</span><span class="dl">'</span><span class="p">);</span>
</pre></table></code></div></div><p>FUNCTIONNAME 取代为目标 Function 名称。</p><p>用一个 Global 变数管制执行。</p><h3 id="与-ios-开发相关的应用"><span class="me-2">与 iOS 开发相关的应用</span><a href="#与-ios-开发相关的应用" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>可用来串 CI/CD，用 GUI 包装原本丑丑的指令操作，例如搭配 Slack Bitrise APP，用 Slack Workflow form 组合启动 Build 命令：</p><p><a href="/assets/d61062833c1a/1*A6Yc9RKCHLEnCLEe591sTw.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*A6Yc9RKCHLEnCLEe591sTw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MDIiIGhlaWdodD0iMjMxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/d61062833c1a/1*cPJ4JR5wVTZOSmuz635Nyg.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*cPJ4JR5wVTZOSmuz635Nyg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MTAiIGhlaWdodD0iMzAxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>送出之后会发送指令到有 Bitrise APP 的 private channel，EX:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>bitrise workflow:app_store<span class="se">\\</span>|branch:develop<span class="se">\\</span>|ENV[version]:4.32.0
</pre></table></code></div></div><p><a href="/assets/d61062833c1a/1*hxyMW4y03udmyW0QXEuAFQ.webp" class="popup img-link blur"><img data-src="/assets/d61062833c1a/1*hxyMW4y03udmyW0QXEuAFQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MTkiIGhlaWdodD0iNzQiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>就能触发 Bitrise 执行 CI/CD Flow。</p><h3 id="延伸阅读"><span class="me-2">延伸阅读</span><a href="#延伸阅读" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p><a href="/posts/zrealm-dev/zh-cn/python-%E6%90%AD%E9%85%8D-google-cloud-platform-%E4%B8%8E-line-bot-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E8%87%AA%E5%8A%A8%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%E4%B8%8E%E6%8E%92%E7%A8%8B-70a1409b149a/">使用 Python+Google Cloud Platform+Line Bot 自动执行例行琐事</a></p><li><p><a href="/posts/zrealm-dev/zh-cn/google-apps-script-%E6%95%99%E5%AD%A6-%E8%87%AA%E5%8A%A8%E8%BD%AC%E5%8F%91-gmail-%E9%82%AE%E4%BB%B6%E5%88%B0-slack-channel-%E5%AE%A2%E5%88%B6%E5%8C%96%E9%80%9A%E7%9F%A5-d414bdbdb8c9/">运用 Google Apps Script 转发 Gmail 信件到 Slack</a></p><li><p><a href="/posts/zrealm-dev/zh-cn/crashlytics-big-query-%E4%B8%B2%E6%8E%A5%E6%95%99%E5%AD%A6-%E8%87%AA%E5%8A%A8%E6%9F%A5%E8%AF%A2%E5%B9%B6%E8%BD%AC%E5%8F%91-ios-app-%E9%97%AA%E9%80%80%E6%8A%A5%E5%91%8A%E5%88%B0-slack-e77b80cc6f89/">Crashlytics + Big Query 打造更即时便利的 Crash 追踪工具</a></p><li><p><a href="/posts/zrealm-dev/zh-cn/crashlytics%E4%B8%8Egoogle-analytics%E8%87%AA%E5%8A%A8%E6%9F%A5%E8%AF%A2app-crash-free-users-rate-google-apps-script%E6%95%B4%E5%90%88%E5%AE%9E%E4%BD%9C-793cb8f89b72/">Crashlytics + Google Analytics 自动查询 App Crash-Free Users Rate</a></p></ul><p>有任何问题及指教欢迎 <a href="https://www.zhgchg.li/contact" target="_blank">与我联络</a> 。</p><p>有自动化相关优化需求也欢迎 <a href="https://www.zhgchg.li/contact" target="_blank">发案给我</a> ，谢谢。</p><hr /><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=🍺&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a><br /></p><blockquote class="prompt-info"><p>本文首次发表于 Medium (<a href="https://medium.com/p/d61062833c1a" target="_blank"><strong>点击查看原始版本</strong></a>)，由 <a href="/posts/tools/medium-to-jekyll/" target="_blank">ZMediumToMarkdown</a> 提供自动转换与同步技术。</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/zh-cn/zmediumtomarkdown/2021-06-13-d61062833c1a.md" target="_blank">Improve this page on Github.</a></p></blockquote><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1K+ Followers</span></a></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-dev/">ZRealm Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/simplified-chinese/" class="post-tag no-text-decoration" >simplified-chinese</a> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/automation/" class="post-tag no-text-decoration" >automation</a> <a href="/tags/google-sheets/" class="post-tag no-text-decoration" >google-sheets</a> <a href="/tags/app-script/" class="post-tag no-text-decoration" >app-script</a> <a href="/tags/slack/" class="post-tag no-text-decoration" >slack</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Slack%20Workflow%EF%BD%9C%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8A%A8%20WFH%20%E5%91%98%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E6%8A%A5%E7%B3%BB%E7%BB%9F%EF%BC%8C%E7%BB%93%E5%90%88%20Google%20Sheets%20%E4%B8%8E%20App%20Script%20%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fslack-workflow-%25E6%2589%2593%25E9%2580%25A0%25E5%2585%25A8%25E8%2587%25AA%25E5%258A%25A8-wfh-%25E5%2591%2598%25E5%25B7%25A5%25E5%2581%25A5%25E5%25BA%25B7%25E5%259B%259E%25E6%258A%25A5%25E7%25B3%25BB%25E7%25BB%259F-%25E7%25BB%2593%25E5%2590%2588-google-sheets-%25E4%25B8%258E-app-script-%25E6%258F%2590%25E5%258D%2587%25E6%2595%2588%25E7%258E%2587-d61062833c1a%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Slack%20Workflow%EF%BD%9C%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8A%A8%20WFH%20%E5%91%98%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E6%8A%A5%E7%B3%BB%E7%BB%9F%EF%BC%8C%E7%BB%93%E5%90%88%20Google%20Sheets%20%E4%B8%8E%20App%20Script%20%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fslack-workflow-%25E6%2589%2593%25E9%2580%25A0%25E5%2585%25A8%25E8%2587%25AA%25E5%258A%25A8-wfh-%25E5%2591%2598%25E5%25B7%25A5%25E5%2581%25A5%25E5%25BA%25B7%25E5%259B%259E%25E6%258A%25A5%25E7%25B3%25BB%25E7%25BB%259F-%25E7%25BB%2593%25E5%2590%2588-google-sheets-%25E4%25B8%258E-app-script-%25E6%258F%2590%25E5%258D%2587%25E6%2595%2588%25E7%258E%2587-d61062833c1a%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fslack-workflow-%25E6%2589%2593%25E9%2580%25A0%25E5%2585%25A8%25E8%2587%25AA%25E5%258A%25A8-wfh-%25E5%2591%2598%25E5%25B7%25A5%25E5%2581%25A5%25E5%25BA%25B7%25E5%259B%259E%25E6%258A%25A5%25E7%25B3%25BB%25E7%25BB%259F-%25E7%25BB%2593%25E5%2590%2588-google-sheets-%25E4%25B8%258E-app-script-%25E6%258F%2590%25E5%258D%2587%25E6%2595%2588%25E7%258E%2587-d61062833c1a%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/en/line-bank-to-firstrade-transfer-fast-deposit-150-nt-fee-guide-with-account-upgrade-fee-subsidy-e4d139fe0685/">LINE Bank to Firstrade Transfer｜Fast Deposit & 150 NT Fee Guide with Account Upgrade & Fee Subsidy</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/zh-cn/line-bank-%E5%85%A5%E9%87%91-firstrade-%E6%95%99%E5%AD%A6-%E5%BF%AB%E9%80%9F%E5%88%B0%E5%B8%90-%E4%BD%8E%E6%89%8B%E7%BB%AD%E8%B4%B9150%E5%85%83-%E5%B8%90%E6%88%B7%E5%8D%87%E7%BA%A7%E4%B8%8E%E6%89%8B%E7%BB%AD%E8%B4%B9%E8%A1%A5%E5%8A%A9%E7%94%B3%E8%AF%B7%E5%85%A8%E6%94%BB%E7%95%A5-e4d139fe0685/">手把手教学 — LINE Bank 入金 Firstrade 快速到帐、手续费只要 150 元及帐户升级/约定转帐/手续费补助申请教学</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/line-bank-%E5%85%A5%E9%87%91-firstrade-%E6%95%99%E5%AD%B8-%E5%BF%AB%E9%80%9F%E5%88%B0%E5%B8%B3-%E4%BD%8E%E6%89%8B%E7%BA%8C%E8%B2%BB150%E5%85%83-%E5%B8%B3%E6%88%B6%E5%8D%87%E7%B4%9A%E8%88%87%E6%89%8B%E7%BA%8C%E8%B2%BB%E8%A3%9C%E5%8A%A9%E7%94%B3%E8%AB%8B%E5%85%A8%E6%94%BB%E7%95%A5-e4d139fe0685/">手把手教學 — LINE Bank 入金 Firstrade 快速到帳、手續費只要 150 元及帳戶升級/約定轉帳/手續費補助申請教學</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-robotic-process-automation/en/ios-shortcut-automation-auto-forward-sms-create-reminder-tasks-effortlessly-309d0302877b/">iOS Shortcut Automation｜Auto-Forward SMS & Create Reminder Tasks Effortlessly</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-robotic-process-automation/zh-cn/ios-%E6%8D%B7%E5%BE%84%E8%87%AA%E5%8A%A8%E5%8C%96-3-%E6%8B%9B%E8%87%AA%E5%8A%A8%E8%BD%AC%E5%8F%91%E7%AE%80%E8%AE%AF%E4%B8%8E%E5%BB%BA%E7%AB%8B%E6%8F%90%E9%86%92%E5%BE%85%E5%8A%9E%E4%BA%8B%E9%A1%B9%E6%95%99%E5%AD%A6-309d0302877b/">iOS 捷径自动化应用场景 — 自动转发简讯与自动建立提醒待办事项</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">章節 (Chapters)🔖</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-dev/slack-workflow-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8B%95-wfh-%E5%93%A1%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E5%A0%B1%E7%B3%BB%E7%B5%B1-%E7%B5%90%E5%90%88-google-sheets-%E8%88%87-app-script-%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87-d61062833c1a/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1623603501" data-df="ll" > Jun 14, 2021 </time><h4 class="pt-0 my-2">Slack 打造全自動 WFH 員工健康狀況回報系統</h4><div class="text-muted"><p>玩轉 Slack Workflow 搭配 Google Sheet with App Script 增加工作效率</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/en/slack-workflow-automate-wfh-employee-health-reporting-with-google-sheets-app-script-d61062833c1a/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1623603501" data-df="ll" > Jun 14, 2021 </time><h4 class="pt-0 my-2">Slack Workflow｜Automate WFH Employee Health Reporting with Google Sheets & App Script</h4><div class="text-muted"><p>Enhance remote work efficiency by automating employee health status updates using Slack Workflow integrated with Google Sheets and App Script, streamlining data collection and reducing manual track...</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-robotic-process-automation/zh-cn/line-notify-%E5%BF%AB%E9%80%9F%E7%A7%BB%E8%BD%AC-telegram-bot-10-%E5%88%86%E9%92%9F%E5%AE%8C%E6%88%90%E4%B8%AA%E4%BA%BA%E9%80%9A%E7%9F%A5%E6%9C%8D%E5%8A%A1%E5%88%87%E6%8D%A2-6922e90ba90c/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1728738646" data-df="ll" > Oct 12, 2024 </time><h4 class="pt-0 my-2">10 分钟快速移转 Line Notify 到 Telegram Bot 通知</h4><div class="text-muted"><p>手把手将 Line Notify 个人通知服务迁移至同样免费、更强大的 Telegram Bot</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-dev/en/slack-workflow-automate-wfh-employee-health-reporting-with-google-sheets-app-script-d61062833c1a/" class="btn btn-outline-primary" aria-label="Older" ><p>Slack Workflow｜Automate WFH Employee Health Reporting with Google Sheets & App Script</p></a> <a href="/posts/zrealm-dev/slack-workflow-%E6%89%93%E9%80%A0%E5%85%A8%E8%87%AA%E5%8B%95-wfh-%E5%93%A1%E5%B7%A5%E5%81%A5%E5%BA%B7%E5%9B%9E%E5%A0%B1%E7%B3%BB%E7%B5%B1-%E7%B5%90%E5%90%88-google-sheets-%E8%88%87-app-script-%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87-d61062833c1a/" class="btn btn-outline-primary" aria-label="Newer" ><p>Slack 打造全自動 WFH 員工健康狀況回報系統</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span> <a href="/">中文</a>|<a href="/tags/simplified-chinese">简中</a>|<a href="/tags/english/">English</a></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a> <br/></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
