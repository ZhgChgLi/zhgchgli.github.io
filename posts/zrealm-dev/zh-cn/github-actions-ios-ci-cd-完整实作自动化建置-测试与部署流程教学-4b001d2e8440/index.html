<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="GitHub Actions iOS CI/CDï½œå®Œæ•´å®ä½œè‡ªåŠ¨åŒ–å»ºç½®ã€æµ‹è¯•ä¸éƒ¨ç½²æµç¨‹æ•™å­¦" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="é’ˆå¯¹iOSå¼€å‘è€…æ‰“é€ çš„GitHub Actions CI/CDæµç¨‹ï¼Œè§£å†³æ‰‹åŠ¨å»ºç½®ä¸æµ‹è¯•ç¹çé—®é¢˜ï¼Œç»“åˆFastlaneä¸Firebaseå®ç°è‡ªåŠ¨åŒ–æ‰“åŒ…ä¸éƒ¨ç½²ï¼Œæå‡å›¢é˜Ÿå¼€å‘æ•ˆç‡ä¸äº§å“å“è´¨ã€‚" /><meta property="og:description" content="é’ˆå¯¹iOSå¼€å‘è€…æ‰“é€ çš„GitHub Actions CI/CDæµç¨‹ï¼Œè§£å†³æ‰‹åŠ¨å»ºç½®ä¸æµ‹è¯•ç¹çé—®é¢˜ï¼Œç»“åˆFastlaneä¸Firebaseå®ç°è‡ªåŠ¨åŒ–æ‰“åŒ…ä¸éƒ¨ç½²ï¼Œæå‡å›¢é˜Ÿå¼€å‘æ•ˆç‡ä¸äº§å“å“è´¨ã€‚" /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-dev/zh-cn/github-actions-ios-ci-cd-%E5%AE%8C%E6%95%B4%E5%AE%9E%E4%BD%9C%E8%87%AA%E5%8A%A8%E5%8C%96%E5%BB%BA%E7%BD%AE-%E6%B5%8B%E8%AF%95%E4%B8%8E%E9%83%A8%E7%BD%B2%E6%B5%81%E7%A8%8B%E6%95%99%E5%AD%A6-4b001d2e8440/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-dev/zh-cn/github-actions-ios-ci-cd-%E5%AE%8C%E6%95%B4%E5%AE%9E%E4%BD%9C%E8%87%AA%E5%8A%A8%E5%8C%96%E5%BB%BA%E7%BD%AE-%E6%B5%8B%E8%AF%95%E4%B8%8E%E9%83%A8%E7%BD%B2%E6%B5%81%E7%A8%8B%E6%95%99%E5%AD%A6-4b001d2e8440/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/4b001d2e8440/1*0LK6m6CTImL6rcsrliiOQA.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-07-07T23:02:24+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/4b001d2e8440/1*0LK6m6CTImL6rcsrliiOQA.webp" /><meta property="twitter:title" content="GitHub Actions iOS CI/CDï½œå®Œæ•´å®ä½œè‡ªåŠ¨åŒ–å»ºç½®ã€æµ‹è¯•ä¸éƒ¨ç½²æµç¨‹æ•™å­¦" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://www.linkedin.com/in/zhgchgli"},"dateModified":"2025-07-12T10:52:21+08:00","datePublished":"2025-07-07T23:02:24+08:00","description":"é’ˆå¯¹iOSå¼€å‘è€…æ‰“é€ çš„GitHub Actions CI/CDæµç¨‹ï¼Œè§£å†³æ‰‹åŠ¨å»ºç½®ä¸æµ‹è¯•ç¹çé—®é¢˜ï¼Œç»“åˆFastlaneä¸Firebaseå®ç°è‡ªåŠ¨åŒ–æ‰“åŒ…ä¸éƒ¨ç½²ï¼Œæå‡å›¢é˜Ÿå¼€å‘æ•ˆç‡ä¸äº§å“å“è´¨ã€‚","headline":"GitHub Actions iOS CI/CDï½œå®Œæ•´å®ä½œè‡ªåŠ¨åŒ–å»ºç½®ã€æµ‹è¯•ä¸éƒ¨ç½²æµç¨‹æ•™å­¦","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+","url":"https://zhgchg.li/assets/4b001d2e8440/1*0LK6m6CTImL6rcsrliiOQA.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-dev/zh-cn/github-actions-ios-ci-cd-%E5%AE%8C%E6%95%B4%E5%AE%9E%E4%BD%9C%E8%87%AA%E5%8A%A8%E5%8C%96%E5%BB%BA%E7%BD%AE-%E6%B5%8B%E8%AF%95%E4%B8%8E%E9%83%A8%E7%BD%B2%E6%B5%81%E7%A8%8B%E6%95%99%E5%AD%A6-4b001d2e8440/"},"url":"https://zhgchg.li/posts/zrealm-dev/zh-cn/github-actions-ios-ci-cd-%E5%AE%8C%E6%95%B4%E5%AE%9E%E4%BD%9C%E8%87%AA%E5%8A%A8%E5%8C%96%E5%BB%BA%E7%BD%AE-%E6%B5%8B%E8%AF%95%E4%B8%8E%E9%83%A8%E7%BD%B2%E6%B5%81%E7%A8%8B%E6%95%99%E5%AD%A6-4b001d2e8440/"}</script><title>GitHub Actions iOS CI/CDï½œå®Œæ•´å®ä½œè‡ªåŠ¨åŒ–å»ºç½®ã€æµ‹è¯•ä¸éƒ¨ç½²æµç¨‹æ•™å­¦ | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=false" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script><link rel="alternate" hreflang="en" href="/posts/zrealm-dev/en/github-actions-ios-app-ci-cd-workflow-automation-for-faster-builds-and-deployments-4b001d2e8440/"><link rel="alternate" hreflang="zh-Hant" href="/posts/zrealm-dev/github-actions-ios-ci-cd-%E5%AE%8C%E6%95%B4%E5%AF%A6%E4%BD%9C%E8%87%AA%E5%8B%95%E5%8C%96%E5%BB%BA%E7%BD%AE-%E6%B8%AC%E8%A9%A6%E8%88%87%E9%83%A8%E7%BD%B2%E6%B5%81%E7%A8%8B%E6%95%99%E5%AD%B8-4b001d2e8440/"><link rel="alternate" hreflang="zh-Hans" href="/posts/zrealm-dev/zh-cn/github-actions-ios-ci-cd-%E5%AE%8C%E6%95%B4%E5%AE%9E%E4%BD%9C%E8%87%AA%E5%8A%A8%E5%8C%96%E5%BB%BA%E7%BD%AE-%E6%B5%8B%E8%AF%95%E4%B8%8E%E9%83%A8%E7%BD%B2%E6%B5%81%E7%A8%8B%E6%95%99%E5%AD%A6-4b001d2e8440/"><link rel="alternate" hreflang="x-default" href="/posts/zrealm-dev/zh-cn/github-actions-ios-ci-cd-%E5%AE%8C%E6%95%B4%E5%AE%9E%E4%BD%9C%E8%87%AA%E5%8A%A8%E5%8C%96%E5%BB%BA%E7%BD%AE-%E6%B5%8B%E8%AF%95%E4%B8%8E%E9%83%A8%E7%BD%B2%E6%B5%81%E7%A8%8B%E6%95%99%E5%AD%A6-4b001d2e8440/"><link rel="stylesheet" href="/assets/css/post-toc.css"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0">An iOS, web, and automation developer from Taiwan ğŸ‡¹ğŸ‡¼ who also loves sharing, traveling, and writing.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="https://medium.com/@zhgchgli" class="nav-link" target="_blank" style="background: #EDF4FF; color: #0A84FF;"> <i class="fa-brands fa-medium"></i> <span>Follow Me!<br/><strong>1,049+</strong> Followers</span> </a><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/english/" class="nav-link"> <i class="fa-fw fa fa-solid fa-language"></i> <span>ENGLISH POSTS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>GitHub Actions iOS CI/CDï½œå®Œæ•´å®ä½œè‡ªåŠ¨åŒ–å»ºç½®ã€æµ‹è¯•ä¸éƒ¨ç½²æµç¨‹æ•™å­¦</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>GitHub Actions iOS CI/CDï½œå®Œæ•´å®ä½œè‡ªåŠ¨åŒ–å»ºç½®ã€æµ‹è¯•ä¸éƒ¨ç½²æµç¨‹æ•™å­¦</h1><p class="post-desc fw-light mb-4">é’ˆå¯¹iOSå¼€å‘è€…æ‰“é€ çš„GitHub Actions CI/CDæµç¨‹ï¼Œè§£å†³æ‰‹åŠ¨å»ºç½®ä¸æµ‹è¯•ç¹çé—®é¢˜ï¼Œç»“åˆFastlaneä¸Firebaseå®ç°è‡ªåŠ¨åŒ–æ‰“åŒ…ä¸éƒ¨ç½²ï¼Œæå‡å›¢é˜Ÿå¼€å‘æ•ˆç‡ä¸äº§å“å“è´¨ã€‚</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1751900544" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jul 7, 2025 </time> </span> <span> Updated <time data-ts="1752288741" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jul 12, 2025 </time> </span><div class="mt-3 mb-3"> <a href="/assets/4b001d2e8440/1*0LK6m6CTImL6rcsrliiOQA.webp" class="popup img-link preview-img blur"><img data-src="/assets/4b001d2e8440/1*0LK6m6CTImL6rcsrliiOQA.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></div><div class="d-flex justify-content-between"> <span style="display: inline-flex; align-items: center; gap: 4px;"> By <em> <a href="https://www.linkedin.com/in/zhgchgli">ZhgChgLi</a> </em> | <em><a href="https://www.linkedin.com/in/zhgchgli" target="_blank">Senior Software Engineer</a></em><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" style="display: block; "><path fill="#007bff" d="M271.2 56C265.1 49.8 256.2 47.3 247.8 49.6C239.4 51.9 232.9 58.4 230.8 66.8L215.5 127C214.4 131.4 209.9 134 205.6 132.7L145.8 115.9C137.4 113.5 128.4 115.9 122.3 122C116.2 128.1 113.8 137.1 116.2 145.5L133.1 205.3C134.3 209.6 131.7 214.1 127.4 215.2L67.1 230.5C58.7 232.6 52.1 239.2 49.8 247.6C47.5 256 50 264.9 56.2 271L100.7 314.3C103.9 317.4 103.9 322.6 100.7 325.8L56.3 369.1C50.1 375.2 47.6 384.1 49.9 392.5C52.2 400.9 58.8 407.4 67.2 409.6L127.4 424.9C131.8 426 134.4 430.5 133.1 434.8L116.2 494.5C113.8 502.9 116.2 511.9 122.3 518C128.4 524.1 137.4 526.5 145.8 524.1L205.6 507.2C209.9 506 214.4 508.6 215.5 512.9L230.8 573.1C232.9 581.5 239.5 588.1 247.9 590.4C256.3 592.7 265.2 590.2 271.3 584L314.6 539.5C317.7 536.3 322.9 536.3 326.1 539.5L369.3 584C375.4 590.2 384.3 592.7 392.7 590.4C401.1 588.1 407.6 581.5 409.8 573.1L425.1 513C426.2 508.6 430.7 506 435 507.3L494.8 524.2C503.2 526.6 512.2 524.2 518.3 518.1C524.4 512 526.8 503 524.4 494.6L507.5 434.8C506.3 430.5 508.9 426 513.2 424.9L573.4 409.6C581.8 407.5 588.4 400.9 590.7 392.5C593 384.1 590.5 375.1 584.3 369.1L539.8 325.8C536.6 322.7 536.6 317.5 539.8 314.3L584.3 271C590.5 264.9 593 256 590.7 247.6C588.4 239.2 581.8 232.7 573.4 230.5L513.2 215.2C508.8 214.1 506.2 209.6 507.5 205.3L524.4 145.5C526.8 137.1 524.4 128.1 518.3 122C512.2 115.9 503.2 113.5 494.8 115.9L435 132.8C430.7 134 426.2 131.4 425.1 127.1L409.8 66.8C407.7 58.4 401.1 51.8 392.7 49.5C384.3 47.2 375.4 49.7 369.3 55.9L326 100.5C322.9 103.7 317.7 103.7 314.5 100.5L271.2 56z"/><path d="M250 330 l60 60 100 -140" stroke="#ffffff" stroke-width="40" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="11619 words" > <em>64 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">GitHub Actions iOS CI/CDï½œå®Œæ•´å®ä½œè‡ªåŠ¨åŒ–å»ºç½®ã€æµ‹è¯•ä¸éƒ¨ç½²æµç¨‹æ•™å­¦</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Chapters ğŸ”–</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">GitHub Actions iOS CI/CDï½œå®Œæ•´å®ä½œè‡ªåŠ¨åŒ–å»ºç½®ã€æµ‹è¯•ä¸éƒ¨ç½²æµç¨‹æ•™å­¦</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/en/github-actions-ios-app-ci-cd-workflow-automation-for-faster-builds-and-deployments-4b001d2e8440/"><strong>Click here</strong></a> to view the English version of this article.</p></blockquote><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/github-actions-ios-ci-cd-%E5%AE%8C%E6%95%B4%E5%AF%A6%E4%BD%9C%E8%87%AA%E5%8B%95%E5%8C%96%E5%BB%BA%E7%BD%AE-%E6%B8%AC%E8%A9%A6%E8%88%87%E9%83%A8%E7%BD%B2%E6%B5%81%E7%A8%8B%E6%95%99%E5%AD%B8-4b001d2e8440/"><strong>é»æ“Šé€™è£¡</strong></a>æŸ¥çœ‹æœ¬æ–‡ç« æ­£é«”ä¸­æ–‡ç‰ˆæœ¬ã€‚</p></blockquote><blockquote class="prompt-info"><p>åŸºäº SEO è€ƒé‡ï¼Œæœ¬æ–‡æ ‡é¢˜ä¸æè¿°ç» AI è°ƒæ•´ï¼ŒåŸå§‹ç‰ˆæœ¬è¯·å‚è€ƒå†…æ–‡ã€‚</p></blockquote><h4 id="zhgchgli-table-of-contents">æ–‡ç« ç›®å½•</h4><nav class="zhgchgli-toc"><ul class="zhgchgli-toc-list"><li class="has-children"><details><summary>CI/CD å®æˆ˜æŒ‡å—ï¼ˆä¸‰ï¼‰ï¼šä½¿ç”¨ GitHub Actions å®ä½œ App iOS CI ä¸ CD å·¥ä½œæµç¨‹ <a href="#cicd-å®æˆ˜æŒ‡å—ä¸‰ä½¿ç”¨-github-actions-å®ä½œ-app-ios-ci-ä¸-cd-å·¥ä½œæµç¨‹">#</a></summary><ul><li><a href="#å‰è¨€">å‰è¨€</a></li></ul></details></li><li class="has-children"><details><summary>App CI/CD æµç¨‹å…³ç³»å›¾ <a href="#app-cicd-æµç¨‹å…³ç³»å›¾">#</a></summary><ul><li><a href="#è¿ä½œæµç¨‹">è¿ä½œæµç¨‹</a></li><li><a href="#github-actions-æˆæœå›¾">GitHub Actions æˆæœå›¾</a></li></ul></details></li><li><a href="#github-actions-x-self-hosted-runner-åŸºç¡€çŸ¥è¯†">GitHub Actions x Self-hosted Runner åŸºç¡€çŸ¥è¯†</a></li><li class="has-children"><details><summary>iOS Demo ä¸“æ¡ˆçš„ Infra æ¶æ„ <a href="#ios-demo-ä¸“æ¡ˆçš„-infra-æ¶æ„">#</a></summary><ul><li><a href="#mint">Mint</a></li><li><a href="#bundle">Bundle</a></li><li><a href="#cocoapods">Cocoapods</a></li><li><a href="#xcodegen">XCodeGen</a></li><li><a href="#fastlane">Fastlane</a></li><li><a href="#fastlane--match">Fastlane â€” Match</a></li><li><a href="#makefile">Makefile</a></li></ul></details></li><li><a href="#æœ¬ç¯‡-github-actions-cicd-æ¡ˆä¾‹">æœ¬ç¯‡ GitHub Actions CI/CD æ¡ˆä¾‹</a></li><li class="has-children"><details><summary>CI â€” å‘ Pull Request æ‰§è¡Œå•å…ƒæµ‹è¯• <a href="#ci--å‘-pull-request-æ‰§è¡Œå•å…ƒæµ‹è¯•">#</a></summary><ul><li><a href="#æµç¨‹">æµç¨‹</a></li><li><a href="#ci-testingyml">CI-Testing.yml</a></li><li><a href="#github-æµç¨‹è®¾å®š">GitHub æµç¨‹è®¾å®š</a></li></ul></details></li><li class="has-children"><details><summary>CD â€” æ‰“åŒ…+éƒ¨ç½²åˆ° Firebase App Distribution <a href="#cd--æ‰“åŒ…éƒ¨ç½²åˆ°-firebase-app-distribution">#</a></summary><ul><li><a href="#æµç¨‹-1">æµç¨‹</a></li><li><a href="#cd-deployyml">CD-Deploy.yml</a></li><li><a href="#æŠ€æœ¯ç»†èŠ‚--firebase-cli-token-å–å¾—è®¾å®š">æŠ€æœ¯ç»†èŠ‚ â€” Firebase CLI Token å–å¾—ï¼†è®¾å®š</a></li><li><a href="#æŠ€æœ¯ç»†èŠ‚--install-the-apple-certificate-and-provisioning-profile">æŠ€æœ¯ç»†èŠ‚ â€” Install the Apple certificate and provisioning profile</a></li><li><a href="#æŠ€æœ¯ç»†èŠ‚-app-store-connect-api-key">æŠ€æœ¯ç»†èŠ‚ â€”App Store Connect API Key</a></li><li><a href="#æŠ€æœ¯å»¶ä¼¸--reuse-action-workflow-æ‹†åˆ†æ‰“åŒ…å’Œéƒ¨ç½²åŠ¨ä½œ">æŠ€æœ¯å»¶ä¼¸ â€” Reuse Action Workflow æ‹†åˆ†æ‰“åŒ…å’Œéƒ¨ç½²åŠ¨ä½œ</a></li><li><a href="#github-actions--artifact">GitHub Actions â€” Artifact</a></li></ul></details></li><li class="has-children"><details><summary>CIâ€” Nightly Build æ‰§è¡Œå¿«ç…§+å•å…ƒæµ‹è¯•+æ‰“åŒ…+CD éƒ¨ç½²åˆ° Firebase App Distribution <a href="#ci-nightly-build-æ‰§è¡Œå¿«ç…§å•å…ƒæµ‹è¯•æ‰“åŒ…cd-éƒ¨ç½²åˆ°-firebase-app-distribution">#</a></summary><ul><li><a href="#æµç¨‹-2">æµç¨‹</a></li><li><a href="#ci-nightly-build-and-deployyml">CI-Nightly-Build-And-Deploy.yml</a></li><li><a href="#æŠ€æœ¯ç»†èŠ‚">æŠ€æœ¯ç»†èŠ‚</a></li></ul></details></li><li class="has-children"><details><summary>Self-hosted Runner æ³¨æ„äº‹é¡¹ <a href="#self-hosted-runner-æ³¨æ„äº‹é¡¹">#</a></summary><ul><li><a href="#å¤šä¸ª-runner-åœ¨åŒå°æœºå™¨çš„æ¨¡æ‹Ÿå™¨è®¾å®š">å¤šä¸ª Runner åœ¨åŒå°æœºå™¨çš„æ¨¡æ‹Ÿå™¨è®¾å®š</a></li><li><a href="#å®Œæ•´ä¸“æ¡ˆ-repo">å®Œæ•´ä¸“æ¡ˆ Repo</a></li></ul></details></li><li class="has-children"><details><summary>è¡¥å…… SSH Agent è®¾å®š â€” For Fastlane Match or Private CocoaPods Repo <a href="#è¡¥å……-ssh-agent-è®¾å®š--for-fastlane-match-or-private-cocoapods-repo">#</a></summary><ul><li><a href="#step-1-äº§ç”Ÿ-ssh-key">Step 1. äº§ç”Ÿ SSH Key</a></li><li><a href="#step-2-åˆ°-private-repo-è®¾å®š-deploy-key">Step 2. åˆ° Private Repo è®¾å®š Deploy Key</a></li><li><a href="#step-3-å›-action-çš„-repo-è®¾å®š-ssh-private-key-to-secrets">Step 3. å› Action çš„ Repo è®¾å®š SSH Private Key to Secrets</a></li><li><a href="#step-4-ssh-agent-è®¾å®šå®Œæˆæ¥éªŒè¯ä¸€ä¸‹-git-clone-private-repo-çš„æƒé™">Step 4. SSH Agent è®¾å®šå®Œæˆï¼Œæ¥éªŒè¯ä¸€ä¸‹ Git Clone Private Repo çš„æƒé™</a></li></ul></details></li><li><a href="#æ€»ç»“">æ€»ç»“</a></li><li class="has-children"><details><summary>ç³»åˆ—æ–‡ç«  <a href="#ç³»åˆ—æ–‡ç« ">#</a></summary><ul><li><a href="#buy-me-a-coffee">Buy me a coffee</a></li></ul></details></li></ul></nav><hr /><h3 id="cicd-å®æˆ˜æŒ‡å—ä¸‰ä½¿ç”¨-github-actions-å®ä½œ-app-ios-ci-ä¸-cd-å·¥ä½œæµç¨‹"><span class="me-2">CI/CD å®æˆ˜æŒ‡å—ï¼ˆä¸‰ï¼‰ï¼šä½¿ç”¨ GitHub Actions å®ä½œ App iOS CI ä¸ CD å·¥ä½œæµç¨‹</span><a href="#cicd-å®æˆ˜æŒ‡å—ä¸‰ä½¿ç”¨-github-actions-å®ä½œ-app-ios-ci-ä¸-cd-å·¥ä½œæµç¨‹" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>iOS App è‡ªåŠ¨åŒ–å»ºç½®ã€æµ‹è¯•ã€éƒ¨ç½²çš„ GitHub Actions å®ä½œæ­¥éª¤å®Œæ•´æ•™å­¦</p><p><a href="/assets/4b001d2e8440/1*0LK6m6CTImL6rcsrliiOQA.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*0LK6m6CTImL6rcsrliiOQA.webp" alt="Photo by [Robs](https://unsplash.com/@robinne?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjkzNCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Photo by <a href="https://unsplash.com/@robinne?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash" target="_blank">Robs</a></p><h4 id="å‰è¨€"><span class="me-2">å‰è¨€</span><a href="#å‰è¨€" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>å‰ç¯‡ã€Œ <a href="/posts/zrealm-dev/zh-cn/github-actions-self-hosted-runner-%E8%AF%A6%E8%A7%A3%E4%B8%8E%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B-ci-cd-%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%E5%BB%BA%E7%BD%AE-404bd5c70040/"><strong>CI/CD å®æˆ˜æŒ‡å—ï¼ˆäºŒï¼‰ï¼šGitHub Actions ä¸ Self-hosted Runner ä½¿ç”¨ä¸å»ºç½®å¤§å…¨</strong></a> ã€æˆ‘ä»¬ä»‹ç»äº† GitHub Actions çš„åŸºç¡€çŸ¥è¯†ä¸è¿ä½œæµç¨‹è¿˜æœ‰å¦‚ä½•ä½¿ç”¨è‡ªå·±çš„æœºå™¨å½“æˆ Runnerã€å¸¦å¤§å®¶å®ç°äº†ä¸‰ä¸ªç®€å•çš„è‡ªåŠ¨åŒ– Actionsï¼› <strong>æœ¬ç¯‡å°†æ·±å…¥è‘—é‡åœ¨ç°å®ä½¿ç”¨ GitHub Actions å»ºç½® App (iOS) CI/CD å·¥ä½œæµç¨‹ä¸Š</strong> ï¼Œä¸€æ ·æ‰‹æŠŠæ‰‹å¸¦å¤§å®¶ä¸€æ­¥ä¸€æ­¥å®Œæˆå¹¶ä¸€è¾¹è¡¥è¶³ GitHub Actions ç›¸å…³çŸ¥è¯†ã€‚</p><h3 id="app-cicd-æµç¨‹å…³ç³»å›¾"><span class="me-2">App CI/CD æµç¨‹å…³ç³»å›¾</span><a href="#app-cicd-æµç¨‹å…³ç³»å›¾" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/4b001d2e8440/1*VRygfRAkBRNEDAC4RyGzRA.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*VRygfRAkBRNEDAC4RyGzRA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjU3MyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>æœ¬ç¯‡å°†å…³æ³¨åœ¨ GitHub Actions å»ºç½® CI/CD çš„åŒºå—ï¼Œä¸‹ä¸€ç¯‡ã€Œ <a href="/posts/zrealm-dev/zh-cn/ci-cd-%E6%89%93%E5%8C%85%E5%B7%A5%E5%85%B7%E5%B9%B3%E5%8F%B0-%E4%BD%BF%E7%94%A8-google-apps-script-web-app-%E4%B8%B2%E6%8E%A5-github-actions-%E6%8F%90%E5%8D%87%E8%B7%A8%E5%9B%A2%E9%98%9F%E6%95%88%E7%8E%87-4273e57e7148/">CI/CD å®æˆ˜æŒ‡å—ï¼ˆå››ï¼‰ï¼šä½¿ç”¨ Google Apps Script Web App ä¸²æ¥ GitHub Actions å»ºç½®å…è´¹æ˜“ç”¨çš„æ‰“åŒ…å·¥å…·å¹³å°</a> ã€æ‰ä¼šä»‹ç»å³åŠéƒ¨åˆ†çš„ä½¿ç”¨ Google Apps Script Web App å»ºç½®è·¨å›¢é˜Ÿåä½œæ‰“åŒ…å¹³å°ã€‚</p><h4 id="è¿ä½œæµç¨‹"><span class="me-2">è¿ä½œæµç¨‹ï¼š</span><a href="#è¿ä½œæµç¨‹" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li><p>GitHub Actions å¼€ Pull Request è§¦å‘ or è¡¨å•è§¦å‘ or å®šæ—¶è§¦å‘</p><li><p>æ‰§è¡Œå¯¹åº” Workflow Jobs/Steps</p><li><p>Step æ‰§è¡Œå¯¹åº” Fastlane (iOS) or (Android Gradle) è„šæœ¬</p><li><p>Fastlane æ‰§è¡Œå¯¹åº” xcodebuild (iOS) æŒ‡ä»¤</p><li><p>å–å¾—æ‰§è¡Œç»“æœ</p><li><p>åç»­ Workflow Jobs/Steps å¤„ç†ç»“æœ</p><li><p>å®Œæˆ</p></ol><h4 id="github-actions-æˆæœå›¾"><span class="me-2">GitHub Actions æˆæœå›¾</span><a href="#github-actions-æˆæœå›¾" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>å…ˆä¸Šæœ€ç»ˆæˆæœç»™å¤§å®¶ä¸€ç‚¹å®ä½œåŠ¨åŠ›ï¼</p><p><a href="/assets/4b001d2e8440/1*5gnQYdVAOtGR-bMK4ZrOhA.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*5gnQYdVAOtGR-bMK4ZrOhA.webp" alt="[CI Testing](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/pull/11){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MTEiIGhlaWdodD0iNTY2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="https://github.com/ZhgChgLi/github-actions-ci-cd-demo/pull/11" target="_blank">CI Testing</a></p><p><a href="/assets/4b001d2e8440/1*u6A77KwkXS2SY5-DPPPR9A.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*u6A77KwkXS2SY5-DPPPR9A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMzczIiBoZWlnaHQ9IjkxOCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/4b001d2e8440/1*t9PrQfcTANyvG7gfXXC-bw.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*t9PrQfcTANyvG7gfXXC-bw.webp" alt="[CI Nightly Build, CD Deploy](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/actions/runs/16119750747){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NTQiIGhlaWdodD0iMTIwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="https://github.com/ZhgChgLi/github-actions-ci-cd-demo/actions/runs/16119750747" target="_blank">CI Nightly Build, CD Deploy</a></p><h3 id="github-actions-x-self-hosted-runner-åŸºç¡€çŸ¥è¯†"><span class="me-2">GitHub Actions x Self-hosted Runner åŸºç¡€çŸ¥è¯†</span><a href="#github-actions-x-self-hosted-runner-åŸºç¡€çŸ¥è¯†" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>å¦‚æœä½ å¯¹ GitHub Actions ä¸æ¶è®¾ Self-hosted Runner è¿˜ä¸ç†Ÿæ‚‰å¼ºçƒˆå»ºè®®å…ˆçœ‹è¿‡ä¸Šç¯‡ã€Œ <a href="/posts/zrealm-dev/zh-cn/github-actions-self-hosted-runner-%E8%AF%A6%E8%A7%A3%E4%B8%8E%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B-ci-cd-%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%E5%BB%BA%E7%BD%AE-404bd5c70040/"><strong>CI/CD å®æˆ˜æŒ‡å—ï¼ˆäºŒï¼‰ï¼šGitHub Actions ä¸ Self-hosted Runner ä½¿ç”¨ä¸å»ºç½®å¤§å…¨</strong></a> ã€æˆ–æ˜¯æ­é…ä¸Šç¯‡çŸ¥è¯†ä¸€èµ·å®ä½œã€‚</p><blockquote><p><strong><em>å®ä½œå¼€å§‹ï¼</em></strong></p></blockquote><h3 id="ios-demo-ä¸“æ¡ˆçš„-infra-æ¶æ„"><span class="me-2">iOS Demo ä¸“æ¡ˆçš„ Infra æ¶æ„</span><a href="#ios-demo-ä¸“æ¡ˆçš„-infra-æ¶æ„" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="https://github.com/ZhgChgLi/github-actions-ci-cd-demo" target="_blank" class="img-link shimmer" ><img src="https://opengraph.githubassets.com/5952f3220c95ced947b9ee50d9c542b2edbb424be50c51c582cb226ce5f5df63/ZhgChgLi/github-actions-ci-cd-demo" alt="" loading="lazy"></a></p><p><strong>æœ¬æ–‡ç”¨åˆ°çš„ iOS ä¸“æ¡ˆå†…å®¹åŒ…å«æµ‹è¯•é¡¹ç›®éƒ½æ˜¯ç”¨ AI äº§ç”Ÿçš„</strong> ï¼Œä¸éœ€åœ¨æ„ iOS çš„ç¨‹å¼ç»†èŠ‚ï¼Œåªé’ˆå¯¹ Infra &amp; CI/CD éƒ¨åˆ†åšè®¨è®ºã€‚</p><blockquote><p><strong><em>ä»¥ä¸‹å·¥å…·åªæ˜¯å‡­ä»¥å¾€ç»éªŒï¼Œå¦‚æœæ˜¯æ–°ä¸“æ¡ˆå¯ä»¥è€ƒè™‘ä½¿ç”¨æ›´æ–°çš„ <a href="https://github.com/jdx/mise" target="_blank">mise</a> å’Œ <a href="https://github.com/tuist/tuist" target="_blank">tuist</a> ã€‚</em></strong></p></blockquote><h4 id="mint"><span class="me-2">Mint</span><a href="#mint" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="https://github.com/yonaskolb/Mint" target="_blank" class="img-link shimmer" ><img src="https://opengraph.githubassets.com/cfba5c7658c860d0ee4e97df8176a3fc6bbfd9f84c2e8334eaa30988c2700d63/yonaskolb/Mint" alt="" loading="lazy"></a></p><p>Mint å·¥å…·å¯ä»¥å¸®æˆ‘ä»¬ç»Ÿä¸€ç®¡ç†ä¾èµ–å·¥å…·çš„ç‰ˆæœ¬(Gemfile åªèƒ½ç®¡ç† Ruby Gems)ï¼Œä¾‹å¦‚ XCodeGenã€XCodeGenã€SwiftFormatã€SwiftLintã€Periphery</p><p>â€¦etc</p><p><strong>Mintfile:</strong></p><div class="language-graphql highlighter-rouge"><div class="code-header"> <span data-label-text="GraphQL"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="err">yonaskolb/Mint@0.17.5</span><span class="w">
</span><span class="err">yonaskolb/XcodeGen@2.35.0</span><span class="w">
</span><span class="err">nicklockwood/SwiftFormat@0.51.13</span><span class="w">
</span></pre></table></code></div></div><p>è¿™è¾¹æˆ‘ä»¬åªç”¨åˆ°ä¸‰ä¸ªã€‚</p><blockquote><p><strong><em>è§‰å¾—å¤ªå¤æ‚ä¸ä½¿ç”¨ä¹Ÿå¯ä»¥ï¼Œç›´æ¥åœ¨ Action Workflow Step ä¸­ç”¨ brew install å®‰è£…éœ€è¦çš„å·¥å…·å³å¯ã€‚</em></strong></p></blockquote><h4 id="bundle"><span class="me-2">Bundle</span><a href="#bundle" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><strong>Gemfile:</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nb">source</span> <span class="s1">'https://rubygems.org'</span>
gem <span class="s1">'cocoapods'</span>, <span class="s1">'~&gt;1.16.0'</span>
gem <span class="s1">'fastlane'</span>, <span class="s1">'~&gt;2.228.0'</span>

plugins_path <span class="o">=</span> File.join<span class="o">(</span>File.dirname<span class="o">(</span>__FILE__<span class="o">)</span>, <span class="s1">'Product'</span>, <span class="s1">'fastlane'</span>, <span class="s1">'Pluginfile'</span><span class="o">)</span>
eval_gemfile<span class="o">(</span>plugins_path<span class="o">)</span> <span class="k">if </span>File.exist?<span class="o">(</span>plugins_path<span class="o">)</span>
</pre></table></code></div></div><p>ç®¡ç† Ruby (Gems) ç›¸å…³ä¾èµ–ï¼Œä¸€èˆ¬ iOS ä¸“æ¡ˆæœ€å¸¸ç”¨çš„å°±æ˜¯è¿™ä¸¤ä¸ª <code class="language-plaintext highlighter-rouge">cocoapods</code> è·Ÿ <code class="language-plaintext highlighter-rouge">fastlane</code> ã€‚</p><h4 id="cocoapods"><span class="me-2">Cocoapods</span><a href="#cocoapods" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><strong>Product/podfile:</strong></p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">platform</span> <span class="ss">:ios</span><span class="p">,</span> <span class="s1">'13.0'</span>
<span class="n">use_frameworks!</span>

<span class="n">target</span> <span class="s1">'app-ci-cd-github-actions-demo'</span> <span class="k">do</span>
  <span class="n">pod</span> <span class="s1">'SnapKit'</span>
<span class="k">end</span> 
</pre></table></code></div></div><p>è™½ç„¶å·²å®£å‘Š <a href="https://blog.cocoapods.org/CocoaPods-Specs-Repo/" target="_blank">å³å°†åœæ­¢ç»´æŠ¤</a> ï¼Œä½† Cocoapods åœ¨æœ‰å¹´ä»£çš„ iOS ä¸“æ¡ˆä¸­ä»å¾ˆå¸¸è§ï¼Œè¿™è¾¹ç®€å•åŠ ä¸€ä¸ª Snapkit å½“ Demoã€‚</p><h4 id="xcodegen"><span class="me-2">XCodeGen</span><a href="#xcodegen" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>é¿å…å¤šäººå¼€å‘ä¸­ <code class="language-plaintext highlighter-rouge">.xcodeproj</code> / <code class="language-plaintext highlighter-rouge">.xcworkspace</code> å¼‚åŠ¨é€ æˆçš„å†²çªï¼Œç»Ÿä¸€ä½¿ç”¨ Project.yaml å®šä¹‰ XCode Project å†…å®¹ï¼Œç„¶ååœ¨æœ¬åœ°è‡ªå·± Gen Project æ¡£æ¡ˆ(ä¸ä¸Š Git)ã€‚</p><p><strong>Product/project.yaml:</strong></p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
</pre><td class="rouge-code"><pre><span class="na">name</span><span class="pi">:</span> <span class="s">app-ci-cd-github-actions-demo</span>
<span class="na">options</span><span class="pi">:</span>
  <span class="na">bundleIdPrefix</span><span class="pi">:</span> <span class="s">com.example</span>
  <span class="na">deploymentTarget</span><span class="pi">:</span>
    <span class="na">iOS</span><span class="pi">:</span> <span class="s1">'</span><span class="s">13.0'</span>
  <span class="na">usesTabs</span><span class="pi">:</span> <span class="kc">false</span>
  <span class="na">indentWidth</span><span class="pi">:</span> <span class="m">2</span>
  <span class="na">tabWidth</span><span class="pi">:</span> <span class="m">2</span>

<span class="na">configs</span><span class="pi">:</span>
  <span class="na">Debug</span><span class="pi">:</span> <span class="s">debug</span>
  <span class="na">Release</span><span class="pi">:</span> <span class="s">release</span>

<span class="na">targets</span><span class="pi">:</span>
  <span class="na">app-ci-cd-github-actions-demo</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">application</span>
    <span class="na">platform</span><span class="pi">:</span> <span class="s">iOS</span>
    <span class="na">sources</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">app-ci-cd-github-actions-demo</span>
    <span class="na">resources</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">app-ci-cd-github-actions-demo/Assets.xcassets</span>
      <span class="pi">-</span> <span class="s">app-ci-cd-github-actions-demo/Base.lproj</span>
    <span class="na">info</span><span class="pi">:</span>
      <span class="na">path</span><span class="pi">:</span> <span class="s">app-ci-cd-github-actions-demo/Info.plist</span>
      <span class="na">properties</span><span class="pi">:</span>
        <span class="na">CFBundleIdentifier</span><span class="pi">:</span> <span class="s">$(PRODUCT_BUNDLE_IDENTIFIER)</span>
    <span class="na">settings</span><span class="pi">:</span>
      <span class="na">base</span><span class="pi">:</span>
        <span class="na">PRODUCT_BUNDLE_IDENTIFIER</span><span class="pi">:</span> <span class="s">com.test.appcicdgithubactionsdemo</span>
    <span class="na">cocoapods</span><span class="pi">:</span> <span class="kc">true</span>

  <span class="na">app-ci-cd-github-actions-demoTests</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">bundle.unit-test</span>
    <span class="na">platform</span><span class="pi">:</span> <span class="s">iOS</span>
    <span class="na">sources</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">app-ci-cd-github-actions-demoTests</span>
    <span class="na">dependencies</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">target</span><span class="pi">:</span> <span class="s">app-ci-cd-github-actions-demo</span>
    <span class="na">info</span><span class="pi">:</span>
      <span class="na">path</span><span class="pi">:</span> <span class="s">app-ci-cd-github-actions-demoTests/Info.plist</span>
    <span class="na">settings</span><span class="pi">:</span>
      <span class="na">base</span><span class="pi">:</span>
        <span class="na">PRODUCT_BUNDLE_IDENTIFIER</span><span class="pi">:</span> <span class="s">com.test.appcicdgithubactionsdemo.tests</span>

  <span class="na">app-ci-cd-github-actions-demoUITests</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">bundle.ui-testing</span>
    <span class="na">platform</span><span class="pi">:</span> <span class="s">iOS</span>
    <span class="na">sources</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">app-ci-cd-github-actions-demoUITests</span>
    <span class="na">dependencies</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">target</span><span class="pi">:</span> <span class="s">app-ci-cd-github-actions-demo</span>
    <span class="na">info</span><span class="pi">:</span>
      <span class="na">path</span><span class="pi">:</span> <span class="s">app-ci-cd-github-actions-demoUITests/Info.plist</span>
    <span class="na">settings</span><span class="pi">:</span>
      <span class="na">base</span><span class="pi">:</span>
        <span class="na">PRODUCT_BUNDLE_IDENTIFIER</span><span class="pi">:</span> <span class="s">com.test.appcicdgithubactionsdemo.uitests</span>

  <span class="na">app-ci-cd-github-actions-demoSnapshotTests</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">bundle.unit-test</span>
    <span class="na">platform</span><span class="pi">:</span> <span class="s">iOS</span>
    <span class="na">sources</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">path</span><span class="pi">:</span> <span class="s">app-ci-cd-github-actions-demoSnapshotTests</span>
        <span class="na">excludes</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s2">"</span><span class="s">**/__Snapshots__/**"</span>
    <span class="na">dependencies</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">target</span><span class="pi">:</span> <span class="s">app-ci-cd-github-actions-demo</span>
      <span class="pi">-</span> <span class="na">product</span><span class="pi">:</span> <span class="s">SnapshotTesting</span>
        <span class="na">package</span><span class="pi">:</span> <span class="s">SnapshotTesting</span>
    <span class="na">info</span><span class="pi">:</span>
      <span class="na">path</span><span class="pi">:</span> <span class="s">app-ci-cd-github-actions-demoSnapshotTests/Info.plist</span>
      <span class="na">settings</span><span class="pi">:</span>
        <span class="na">base</span><span class="pi">:</span>
          <span class="na">PRODUCT_BUNDLE_IDENTIFIER</span><span class="pi">:</span> <span class="s">com.test.appcicdgithubactionsdemo.snapshottests</span>

<span class="na">packages</span><span class="pi">:</span>
  <span class="na">SnapshotTesting</span><span class="pi">:</span>
    <span class="na">url</span><span class="pi">:</span> <span class="s">https://github.com/pointfreeco/swift-snapshot-testing</span>
    <span class="na">from</span><span class="pi">:</span> <span class="s">1.18.4</span>
</pre></table></code></div></div><p>SnapshotTesting: ä½¿ç”¨ Swift Package Manager ç®¡ç†ã€‚</p><h4 id="fastlane"><span class="me-2">Fastlane</span><a href="#fastlane" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>å°è£… xcodebuild æŒ‡ä»¤ã€å°è£…ä¸²æ¥ App Store Connect APIã€Firebase API. .ç­‰æœåŠ¡çš„å¤æ‚æ­¥éª¤ã€‚</p><p><strong>Product/fastlane/Fastfile:</strong></p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
</pre><td class="rouge-code"><pre>
<span class="nf">default_platform</span><span class="p">(</span><span class="o">:</span><span class="n">ios</span><span class="p">)</span>

<span class="n">platform</span> <span class="o">:</span><span class="n">ios</span> <span class="k">do</span>
  <span class="n">desc</span> <span class="s2">"Run all tests (Unit Tests + UI Tests)"</span>
  <span class="n">lane</span> <span class="o">:</span><span class="n">run_all_tests</span> <span class="k">do</span> <span class="err">\\</span><span class="o">|</span><span class="n">options</span><span class="err">\\</span><span class="o">|</span>
    <span class="n">device</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="o">:</span><span class="n">device</span><span class="p">]</span>
    <span class="nf">scan</span><span class="p">(</span>
      <span class="n">scheme</span><span class="o">:</span> <span class="s2">"app-ci-cd-github-actions-demo"</span><span class="p">,</span>
      <span class="n">device</span><span class="o">:</span> <span class="n">device</span><span class="p">,</span>
      <span class="n">clean</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="n">output_directory</span><span class="o">:</span> <span class="s2">"fastlane/test_output"</span><span class="p">,</span>
      <span class="n">output_types</span><span class="o">:</span> <span class="s2">"junit"</span>
    <span class="p">)</span>
  <span class="n">end</span>

  <span class="n">desc</span> <span class="s2">"Run only Unit Tests"</span>
  <span class="n">lane</span> <span class="o">:</span><span class="n">run_unit_tests</span> <span class="k">do</span> <span class="err">\\</span><span class="o">|</span><span class="n">options</span><span class="err">\\</span><span class="o">|</span>
    <span class="n">device</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="o">:</span><span class="n">device</span><span class="p">]</span>
    <span class="nf">scan</span><span class="p">(</span>
      <span class="n">scheme</span><span class="o">:</span> <span class="s2">"app-ci-cd-github-actions-demo"</span><span class="p">,</span>
      <span class="n">device</span><span class="o">:</span> <span class="n">device</span><span class="p">,</span>
      <span class="n">clean</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="n">only_testing</span><span class="o">:</span> <span class="p">[</span>
        <span class="s2">"app-ci-cd-github-actions-demoTests"</span>
      <span class="p">],</span>
      <span class="n">output_directory</span><span class="o">:</span> <span class="s2">"fastlane/test_output"</span><span class="p">,</span>
      <span class="n">output_types</span><span class="o">:</span> <span class="s2">"junit"</span>
    <span class="p">)</span>
  <span class="n">end</span>

  <span class="n">desc</span> <span class="s2">"Build and upload to Firebase App Distribution"</span>
  <span class="n">lane</span> <span class="o">:</span><span class="n">beta</span> <span class="k">do</span> <span class="err">\\</span><span class="o">|</span><span class="n">options</span><span class="err">\\</span><span class="o">|</span>
    
    <span class="k">if</span> <span class="n">options</span><span class="p">[</span><span class="o">:</span><span class="n">version_number</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">options</span><span class="p">[</span><span class="o">:</span><span class="n">version_number</span><span class="p">]</span><span class="mf">.</span><span class="n">to_s</span><span class="mf">.</span><span class="n">strip</span> <span class="o">!=</span> <span class="s2">""</span>
      <span class="nf">increment_version_number</span><span class="p">(</span><span class="n">version_number</span><span class="o">:</span> <span class="n">options</span><span class="p">[</span><span class="o">:</span><span class="n">version_number</span><span class="p">])</span>
    <span class="n">end</span>

    <span class="k">if</span> <span class="n">options</span><span class="p">[</span><span class="o">:</span><span class="n">build_number</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">options</span><span class="p">[</span><span class="o">:</span><span class="n">build_number</span><span class="p">]</span><span class="mf">.</span><span class="n">to_s</span><span class="mf">.</span><span class="n">strip</span> <span class="o">!=</span> <span class="s2">""</span>
      <span class="nf">increment_build_number</span><span class="p">(</span><span class="n">build_number</span><span class="o">:</span> <span class="n">options</span><span class="p">[</span><span class="o">:</span><span class="n">build_number</span><span class="p">])</span>
    <span class="n">end</span>

    <span class="nf">update_code_signing_settings</span><span class="p">(</span>
      <span class="n">use_automatic_signing</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="n">path</span><span class="o">:</span> <span class="s2">"app-ci-cd-github-actions-demo.xcodeproj"</span><span class="p">,</span>
      <span class="n">team_id</span><span class="o">:</span> <span class="no">ENV</span><span class="p">[</span><span class="s1">'TEAM_ID'</span><span class="p">],</span>
      <span class="n">code_sign_identity</span><span class="o">:</span> <span class="s2">"iPhone Developer"</span><span class="p">,</span>
      <span class="n">sdk</span><span class="o">:</span> <span class="s2">"iphoneos*"</span><span class="p">,</span>
      <span class="n">profile_name</span><span class="o">:</span> <span class="s2">"cicd"</span>
    <span class="p">)</span>

    <span class="nf">gym</span><span class="p">(</span>
      <span class="n">scheme</span><span class="o">:</span> <span class="s2">"app-ci-cd-github-actions-demo"</span><span class="p">,</span>
      <span class="n">clean</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="n">export_method</span><span class="o">:</span> <span class="s2">"development"</span><span class="p">,</span>
      <span class="n">output_directory</span><span class="o">:</span> <span class="s2">"fastlane/build"</span><span class="p">,</span>
      <span class="n">output_name</span><span class="o">:</span> <span class="s2">"app-ci-cd-github-actions-demo.ipa"</span><span class="p">,</span>
      <span class="n">export_options</span><span class="o">:</span> <span class="p">{</span>
          <span class="n">provisioningProfiles</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"com.test.appcicdgithubactionsdemo"</span> <span class="o">=&gt;</span> <span class="s2">"cicd"</span><span class="p">,</span>
          <span class="p">},</span>
      <span class="p">}</span>
    <span class="p">)</span>

    <span class="nf">firebase_app_distribution</span><span class="p">(</span>
      <span class="n">app</span><span class="o">:</span> <span class="s2">"1:127683058219:ios:98896929fa131c7a80686e"</span><span class="p">,</span>
      <span class="n">firebase_cli_token</span><span class="o">:</span> <span class="no">ENV</span><span class="p">[</span><span class="s2">"FIREBASE_CLI_TOKEN"</span><span class="p">],</span>
      <span class="n">release_notes</span><span class="o">:</span> <span class="n">options</span><span class="p">[</span><span class="o">:</span><span class="n">release_notes</span><span class="p">]</span> <span class="err">\\</span><span class="o">|</span><span class="err">\\</span><span class="o">|</span> <span class="s2">"New beta build"</span>
    <span class="p">)</span>
  <span class="n">end</span>
<span class="n">end</span>
</pre></table></code></div></div><p>æ³¨: provisioningProfilesã€profile_name å¯¹åº”çš„æ˜¯ <a href="https://developer.apple.com/account/resources/certificates/list" target="_blank">App Developer ä¸­çš„ Profiles å‡­è¯åç§°</a> ã€‚(å¦‚æœæœ‰ç”¨ match åˆ™ä¹Ÿä¸éœ€è¦è¿™äº›æŒ‡å®šã€‚)</p><p><a href="/assets/4b001d2e8440/1*WXqqnErto3nn8rnNg6TXgw.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*WXqqnErto3nn8rnNg6TXgw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTE3IiBoZWlnaHQ9IjYxNiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><strong>Fastlane æ˜¯ iOS CI/CD å½“ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†</strong> ï¼Œç›´æ¥ä½¿ç”¨å®ƒå°è£…å¥½çš„æ–¹æ³•å°±èƒ½å¿«é€Ÿå¼€å‘ CI/CD å®é™…æ‰§è¡Œçš„æ­¥éª¤ï¼›æˆ‘ä»¬åªéœ€å…³æ³¨åœ¨æ•´ä½“çš„è„šæœ¬è®¾è®¡ï¼Œè€Œä¸éœ€å»å¤„ç†å¤æ‚çš„ API ä¸²æ¥æˆ–æŒ‡ä»¤æ’°å†™ã€‚</p><p>ä¾‹å¦‚ï¼šFastlane åªéœ€è¦å†™ã€Œscan(xxx)ã€å°±èƒ½æ‰§è¡Œæµ‹è¯•ï¼Œå¦‚æœè¦å†™æˆ xcodebuild åˆ™éœ€è¦ã€Œ <code class="language-plaintext highlighter-rouge">xcodebuild -workspace ./xxx.xcworkspace -scheme xxx -derivedDataPath xxx â€˜platform=iOS Simulator,id=xxxâ€™ clean build test</code> ã€ï¼Œæ‰“åŒ…éƒ¨ç½²è¦è‡ªå·±åšæ›´æ˜¯éº»çƒ¦ï¼Œè¦è‡ªè¡Œä¸²æ¥ App Store Connect/Firebase APIï¼Œå…‰é‡‘é’¥éªŒè¯éƒ½è¦å†™è¶…è¿‡ 10 è¡Œç¨‹å¼äº†ã€‚</p><p><strong>Demo ä¸“æ¡ˆæˆ‘ä»¬åªæœ‰ä¸‰ä¸ª Lane:</strong></p><ul><li><p>run_all_tests: è·‘æ‰€æœ‰ç±»å‹çš„æµ‹è¯• (Snapshot+Unit)</p><li><p>run_unit_tests: åªè·‘å•å…ƒæµ‹è¯• (Unit)</p><li><p>beta: æ‰“åŒ…éƒ¨ç½²åˆ° Firebase App Distribution</p></ul><h4 id="fastlane--match"><span class="me-2">Fastlane â€” Match</span><a href="#fastlane--match" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>å›  Demo ä¸“æ¡ˆé™åˆ¶ï¼Œè¿™è¾¹æ²¡ç”¨åˆ° Match ç®¡ç†å›¢é˜Ÿå¼€å‘ã€éƒ¨ç½²å‡­è¯ï¼Œä½†è¿™è¾¹è¿˜æ˜¯è¦æä¸€ä¸‹ï¼Œå»ºè®®ä½¿ç”¨ Match å»ç®¡ç†å›¢é˜Ÿçš„æ‰€æœ‰å¼€å‘ã€éƒ¨ç½²å‡­è¯ï¼Œæ–¹ä¾¿æ§ç®¡è·Ÿç»Ÿä¸€æ›´æ–°ã€‚</p><blockquote><p><em>æœ‰ç”¨ Match å°±èƒ½åœ¨ä¸“æ¡ˆ Setup æ­¥éª¤ç›´æ¥ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">match all</code> ä¹‹ç±»çš„æŒ‡ä»¤ä¸€é”®å®‰è£…å¥½æ‰€æœ‰å¼€å‘éœ€è¦çš„å‡­è¯ã€‚</em></p></blockquote><ul><li><strong>Fastlane Match ä¼šä½¿ç”¨å¦ä¸€ä¸ª Private Repo ç®¡ç†å‡­è¯é‡‘é’¥ï¼Œåœ¨ GitHub Actions ä¸­éœ€è¦è®¾å®šå¥½ SSH Agent æ‰èƒ½ Clone å¦ä¸€ä¸ª Private Repoã€‚</strong> (è¯·å‚è€ƒæ–‡æœ«è¡¥å……)</ul><p>â€” â€” â€”</p><h4 id="makefile"><span class="me-2">Makefile</span><a href="#makefile" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/4b001d2e8440/1*jYACUYFP3MkeHCgeUY7j3w.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*jYACUYFP3MkeHCgeUY7j3w.webp" alt="Makefile" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjQyMyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Makefile</p><p>è®©å¼€å‘ç«¯ä¸ CI/CD ç»Ÿä¸€éƒ½ä½¿ç”¨ Makefile æ‰§è¡ŒæŒ‡ä»¤ï¼Œæ–¹ä¾¿æˆ‘ä»¬å°è£…åŒæ ·çš„ç¯å¢ƒã€è·¯å¾„ä¸æ“ä½œè¡Œä¸ºã€‚</p><blockquote><p><em>ç»å…¸çš„æ¡ˆä¾‹æ˜¯æœ‰çš„äººä½¿ç”¨çš„æ˜¯æœ¬æœºå®‰è£…çš„ <code class="language-plaintext highlighter-rouge">pod install</code> æœ‰çš„äººåˆ™ä½¿ç”¨çš„æ˜¯ Bundel ç®¡ç†çš„ <code class="language-plaintext highlighter-rouge">bundle exec pod install</code> å¦‚æœç‰ˆæœ¬ä¸åŒå°±å¯èƒ½äº§ç”Ÿå·®å¼‚ã€‚</em></p></blockquote><blockquote><p><strong><em>è§‰å¾—å¤ªå¤æ‚ä¸ä½¿ç”¨ä¹Ÿå¯ä»¥ï¼Œé‚£å°±æ˜¯åœ¨ Action Workflow Step ä¸­ç›´æ¥å†™è¦æ‰§è¡Œçš„æŒ‡ä»¤å³å¯ã€‚</em></strong></p></blockquote><p><strong>Makefile:</strong></p><div class="language-makefile highlighter-rouge"><div class="code-header"> <span data-label-text="Makefile"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
</pre><td class="rouge-code"><pre><span class="c">#!make
</span><span class="nv">PRODUCT_FOLDER</span> <span class="o">=</span> ./Product/
<span class="nv">SHELL</span>         <span class="o">:=</span> /bin/zsh
<span class="nv">.DEFAULT_GOAL</span> <span class="o">:=</span> <span class="nb">install</span>
<span class="nv">MINT_DIRECTORY</span> <span class="o">:=</span> ./mint/

<span class="k">export </span><span class="nv">MINT_PATH</span><span class="o">=</span><span class="p">$(</span>MINT_DIRECTORY<span class="p">)</span>

<span class="c">## ğŸ‘‡ Help function
</span><span class="nl">.PHONY</span><span class="o">:</span> <span class="nf">help</span>
<span class="nl">help</span><span class="o">:</span>
 <span class="err">@echo</span> <span class="s2">""</span>
 <span class="nl">@echo "ğŸ“– å¯ç”¨æŒ‡ä»¤</span><span class="o">:</span><span class="nf">"</span>
 <span class="nl">@grep -E '^[a-zA-Z_-]+</span><span class="o">:</span><span class="nf">.*?</span><span class="c">##</span><span class="nf"> .*$$' $(MAKEFILE_LIST) </span>\\<span class="nf">| </span>\
<span class="nf">  awk 'BEGIN {FS = ":.*?</span><span class="c">##</span><span class="nf"> "}; {printf "  </span>\0<span class="nf">33[36m%-20s</span>\0<span class="nf">33[0m %s</span>\n<span class="nf">"</span><span class="p">,</span><span class="nf"> $$1</span><span class="p">,</span><span class="nf"> $$2}'</span>
 <span class="err">@echo</span> <span class="s2">""</span>

<span class="c">## Setup
</span><span class="nl">.PHONY</span><span class="o">:</span> <span class="nf">setup</span>
<span class="nl">setup</span><span class="o">:</span> <span class="nf">check-mint </span><span class="c">##</span><span class="nf"> å®‰è£… Ruby å’Œ Mint ä¾èµ–</span>
 <span class="err">@echo</span> <span class="s2">"ğŸ”¨ Installing Ruby dependencies..."</span>
 <span class="err">bundle</span> <span class="err">config</span> <span class="err">set</span> <span class="err">path</span> <span class="s1">'vendor/bundle'</span>
 <span class="err">bundle</span> <span class="err">install</span>
 <span class="err">@echo</span> <span class="s2">"ğŸ”¨ Installing Mint dependencies..."</span>
 <span class="err">mint</span> <span class="err">bootstrap</span>

<span class="c">## Install
</span><span class="nl">.PHONY</span><span class="o">:</span> <span class="nf">install</span>
<span class="nl">install</span><span class="o">:</span> <span class="nf">XcodeGen PodInstall </span><span class="c">##</span><span class="nf"> æ‰§è¡Œ XcodeGen å’Œ CocoaPods å®‰è£…</span>

<span class="nl">.PHONY</span><span class="o">:</span> <span class="nf">XcodeGen</span>
<span class="nl">XcodeGen</span><span class="o">:</span> <span class="nf">check-mint </span><span class="c">##</span><span class="nf"> ç”¨ XcodeGen äº§ç”Ÿ .xcodeproj</span>
 <span class="err">@echo</span> <span class="s2">"ğŸ”¨ Execute XcodeGen"</span>
 <span class="err">cd</span> <span class="err">$(PRODUCT_FOLDER)</span> <span class="err">&amp;&amp;</span> <span class="err">\</span>
 <span class="err">mint</span> <span class="err">run</span> <span class="err">yonaskolb/XcodeGen</span> <span class="err">--quiet</span>

<span class="nl">.PHONY</span><span class="o">:</span> <span class="nf">PodInstall</span>
<span class="nl">PodInstall</span><span class="o">:</span> <span class="c">##</span><span class="nf"> å®‰è£… CocoaPods ä¾èµ–</span>
 <span class="err">@echo</span> <span class="s2">"ğŸ“¦ Installing CocoaPods dependencies..."</span>
 <span class="err">cd</span> <span class="err">$(PRODUCT_FOLDER)</span> <span class="err">&amp;&amp;</span> <span class="err">\</span>
 <span class="err">bundle</span> <span class="err">exec</span> <span class="err">pod</span> <span class="err">install</span>

<span class="c">### Mint
</span><span class="nl">check-mint</span><span class="o">:</span> <span class="nf">check-brew </span><span class="c">##</span><span class="nf"> æ£€æŸ¥ Mint æ˜¯å¦å®‰è£…ï¼Œæ²¡æœ‰å°±è‡ªåŠ¨å®‰è£…</span>
 <span class="err">@if</span> <span class="err">!</span> <span class="err">command</span> <span class="err">-v</span> <span class="err">mint</span> <span class="err">&amp;&gt;</span> <span class="err">/dev/null;</span> <span class="err">then</span> <span class="err">\</span>
  <span class="err">echo</span> <span class="s2">"ğŸ”¨ Installing mint..."</span><span class="err">;</span> <span class="err">\</span>
  <span class="err">brew</span> <span class="err">install</span> <span class="err">mint;</span> <span class="err">\</span>
 <span class="err">fi</span>

<span class="c">### Brew
</span><span class="nl">check-brew</span><span class="o">:</span> <span class="c">##</span><span class="nf"> æ£€æŸ¥ Homebrew æ˜¯å¦å®‰è£…ï¼Œæ²¡æœ‰å°±è‡ªåŠ¨å®‰è£…</span>
 <span class="err">@if</span> <span class="err">!</span> <span class="err">command</span> <span class="err">-v</span> <span class="err">brew</span> <span class="err">&amp;&gt;</span> <span class="err">/dev/null;</span> <span class="err">then</span> <span class="err">\</span>
  <span class="err">echo</span> <span class="s2">"ğŸ”¨ Installing Homebrew..."</span><span class="err">;</span> <span class="err">\</span>
  <span class="nl">/bin/bash -c "$$(curl -fsSL https</span><span class="o">:</span><span class="nf">//raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"; </span>\
<span class="nf"> fi</span>

<span class="c">## Format only git swift files
</span><span class="nl">.PHONY</span><span class="o">:</span> <span class="nf">format</span>
<span class="nl">format</span><span class="o">:</span> <span class="nf">check-mint </span><span class="c">##</span><span class="nf"> æ ¼å¼åŒ– Product/ ä¸‹æ‰€æœ‰ Swift æ¡£</span>
 <span class="err">mint</span> <span class="err">run</span> <span class="err">swiftformat</span> <span class="err">$(PRODUCT_FOLDER)</span>
</pre></table></code></div></div><p>ä¸ºäº†é¿å…æ±¡æŸ“æ•´ä¸ªç³»ç»Ÿæˆ–å…¶ä»–ä¸“æ¡ˆï¼Œæˆ‘ä»¬å°½å¯èƒ½æŠŠ Dependency å¥—ä»¶(e.g. mint, bundleâ€¦etc)çš„è·¯å¾„éƒ½æ”¹æŒ‡å®šåœ¨ä¸“æ¡ˆç›®å½•ä¹‹ä¸‹ (å†æ­é… <code class="language-plaintext highlighter-rouge">.gitignore</code> æ’é™¤)ã€‚</p><div class="language-scss highlighter-rouge"><div class="code-header"> <span data-label-text="SCSS"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="err">â”œâ”€â”€</span> <span class="nt">mint</span> <span class="o">(</span><span class="nt">Mint</span> <span class="err">ä¾èµ–</span><span class="o">)</span>
<span class="err">â”‚</span>   <span class="err">â””â”€â”€</span> <span class="nt">packages</span>
<span class="err">â”œâ”€â”€</span> <span class="nt">Product</span>
<span class="err">â”‚</span>   <span class="err">â”œâ”€â”€</span> <span class="nt">app-ci-cd-github-actions-demo</span>
<span class="err">â”‚</span>   <span class="err">â”œâ”€â”€</span> <span class="nt">app-ci-cd-github-actions-demo</span><span class="nc">.xcodeproj</span>
<span class="err">â”‚</span>   <span class="err">â”œâ”€â”€</span> <span class="nt">app-ci-cd-github-actions-demo</span><span class="nc">.xcworkspace</span>
<span class="err">â”‚</span>   <span class="err">â”œâ”€â”€</span> <span class="nt">app-ci-cd-github-actions-demoSnapshotTests</span>
<span class="err">â”‚</span>   <span class="err">â”œâ”€â”€</span> <span class="nt">app-ci-cd-github-actions-demoTests</span>
<span class="err">â”‚</span>   <span class="err">â”œâ”€â”€</span> <span class="nt">app-ci-cd-github-actions-demoUITests</span>
<span class="err">â”‚</span>   <span class="err">â”œâ”€â”€</span> <span class="nt">fastlane</span>
<span class="err">â”‚</span>   <span class="err">â””â”€â”€</span> <span class="nt">Pods</span> <span class="o">(</span><span class="nt">Cocoapods</span> <span class="err">ä¾èµ–</span><span class="o">)</span>
<span class="err">â””â”€â”€</span> <span class="nt">vendor</span> <span class="o">(</span><span class="nt">Bundle</span> <span class="err">ä¾èµ–</span><span class="o">)</span>
    <span class="err">â””â”€â”€</span> <span class="nt">bundle</span>
</pre></table></code></div></div><p><a href="/assets/4b001d2e8440/1*F1KFntT8bCZzyYm9JahiuA.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*F1KFntT8bCZzyYm9JahiuA.webp" alt="make help" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NDkiIGhlaWdodD0iMTQyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>make help</p><p><strong>ä½¿ç”¨ Makefine çš„ç»Ÿä¸€ä¸“æ¡ˆ Setup æ­¥éª¤ï¼š</strong></p><ol><li><p><code class="language-plaintext highlighter-rouge">git clone repo</code></p><li><p><code class="language-plaintext highlighter-rouge">cd ./repo</code></p><li><p><code class="language-plaintext highlighter-rouge">make setup</code> å®‰è£…å¿…è¦çš„å·¥å…·ä¾èµ– ( <strong>brew</strong> , <strong>mint</strong> , <strong>bundle</strong> , xcodegen, swiftformat,â€¦)</p><li><p><code class="language-plaintext highlighter-rouge">make install</code> äº§ç”Ÿä¸“æ¡ˆ (æ‰§è¡Œ pod install, xcodegen)</p><li><p>å®Œæˆ</p><li><p>æ‰“å¼€ã€æ‰§è¡Œä¸“æ¡ˆ</p></ol><blockquote><p><strong><em>ä¸ç®¡æ˜¯ CI/CD æˆ–æ–°äºº onboard éƒ½æ˜¯ç…§ä»¥ä¸Šæ­¥éª¤æŠŠä¸“æ¡ˆå»ºç½®èµ·æ¥ã€‚</em></strong></p></blockquote><h3 id="æœ¬ç¯‡-github-actions-cicd-æ¡ˆä¾‹"><span class="me-2">æœ¬ç¯‡ GitHub Actions CI/CD æ¡ˆä¾‹</span><a href="#æœ¬ç¯‡-github-actions-cicd-æ¡ˆä¾‹" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>æœ¬ç¯‡ä¼šä»‹ç»ä¸‰ä¸ª GitHub Actions CI/CD å·¥ä½œæµç¨‹å»ºç½®æ¡ˆä¾‹ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥å‚è€ƒå…¶ä¸­çš„æ­¥éª¤å»ºç½®ç¬¦åˆè‡ªå·±å›¢é˜Ÿå·¥ä½œæµç¨‹çš„ CI/CDã€‚</p><ol><li><p>CI â€” å‘ Pull Request æ‰§è¡Œå•å…ƒæµ‹è¯•</p><li><p>CD â€” æ‰“åŒ…+éƒ¨ç½²åˆ° Firebase App Distribution</p><li><p>CI +CDâ€” Nightly Build æ‰§è¡Œå¿«ç…§+å•å…ƒæµ‹è¯•+æ‰“åŒ…+éƒ¨ç½²åˆ° Firebase App Distribution</p></ol><blockquote><p><em>å›  Demo é™åˆ¶ï¼Œæœ¬æ–‡åªä¼šä¸²æ¥ æ‰“åŒ…éƒ¨ç½²åˆ° Firebase App Distributionï¼Œæ‰“åŒ…åˆ° Testflight æˆ–æ˜¯ App Store ä¹Ÿæ˜¯åŒæ ·æ­¥éª¤åªå·®åˆ«åœ¨ Fastlane é‡Œçš„è„šæœ¬ä¸åŒï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œå‘æŒ¥ã€‚</em></p></blockquote><h3 id="ci--å‘-pull-request-æ‰§è¡Œå•å…ƒæµ‹è¯•"><span class="me-2">CI â€” å‘ Pull Request æ‰§è¡Œå•å…ƒæµ‹è¯•</span><a href="#ci--å‘-pull-request-æ‰§è¡Œå•å…ƒæµ‹è¯•" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="æµç¨‹"><span class="me-2">æµç¨‹</span><a href="#æµç¨‹" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Develop åˆ†æ”¯ <strong>æ— æ³•ç›´æ¥æ¨é€</strong> ï¼Œå¿…é¡»å‘ Pull Request æ‰èƒ½æ›´æ–°ï¼›æ‰€æœ‰ Pull Request <strong>å‡éœ€ Review é€šè¿‡åŠ ä¸Šå•å…ƒæµ‹è¯•é€šè¿‡æ‰èƒ½ Merge</strong> ã€æœ‰æ–° Commit Push ä¼šé‡æ–°æµ‹è¯•ã€‚</p><h4 id="ci-testingyml"><span class="me-2">CI-Testing.yml</span><a href="#ci-testingyml" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Repo â†’ Actions â†’ New workflow â†’ set up a workflow yourselfã€‚</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
</pre><td class="rouge-code"><pre><span class="c1"># Workflow(Action) åç§°</span>
<span class="na">name</span><span class="pi">:</span> <span class="s">CI-Testing</span>

<span class="c1"># Actions Log çš„æ ‡é¢˜åç§°</span>
<span class="na">run-name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">[CI-Testing]</span><span class="nv"> </span><span class="s">${{</span><span class="nv"> </span><span class="s">github.event.pull_request.title</span><span class="nv"> </span><span class="se">\\</span><span class="s">|</span><span class="se">\\</span><span class="s">|</span><span class="nv"> </span><span class="s">github.ref</span><span class="nv"> </span><span class="s">}}"</span>

<span class="c1"># åŒä¸ª Concurrency Group å¦‚æœæœ‰æ–°çš„ Job ä¼šå–æ¶ˆæ­£åœ¨è·‘çš„</span>
<span class="c1"># ä¾‹å¦‚ Push Commit è§¦å‘çš„ä»»åŠ¡è¿˜æ²¡æ‰§è¡Œå°±åˆ Push Commit æ—¶ï¼Œä¼šå–æ¶ˆå‰ä¸€ä¸ªä»»åŠ¡</span>
<span class="na">concurrency</span><span class="pi">:</span>
  <span class="na">group</span><span class="pi">:</span> <span class="s">${{ github.workflow }}-${{ github.event_name }}-${{ github.event.pull_request.number \\|\\| github.ref }}</span>
  <span class="na">cancel-in-progress</span><span class="pi">:</span> <span class="kc">true</span>

<span class="c1"># è§¦å‘äº‹ä»¶</span>
<span class="na">on</span><span class="pi">:</span>
  <span class="c1"># PR äº‹ä»¶</span>
  <span class="na">pull_request</span><span class="pi">:</span>
    <span class="c1"># PR - å¼€å¯ã€é‡å¼€ã€æœ‰æ–° Push Commit æ—¶</span>
    <span class="na">types</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">opened</span><span class="pi">,</span> <span class="nv">synchronize</span><span class="pi">,</span> <span class="nv">reopened</span><span class="pi">]</span>
  <span class="c1"># æ‰‹åŠ¨è¡¨å•è§¦å‘</span>
  <span class="na">workflow_dispatch</span><span class="pi">:</span>
    <span class="c1"># è¡¨å• Inputs æ ä½</span>
    <span class="na">inputs</span><span class="pi">:</span>
      <span class="c1"># æ‰§è¡Œçš„ Test Fastlane Lane</span>
      <span class="na">TEST_LANE</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Test</span><span class="nv"> </span><span class="s">Lane'</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s1">'</span><span class="s">run_unit_tests'</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">choice</span>
        <span class="na">options</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">run_unit_tests</span>
          <span class="pi">-</span> <span class="s">run_all_tests</span>
  <span class="c1"># å…¶ä»– Workflow å‘¼å«æ­¤ Workflow è§¦å‘</span>
  <span class="c1"># Nightly Build ä¼šå‘¼å«ä½¿ç”¨</span>
  <span class="na">workflow_call</span><span class="pi">:</span>
    <span class="c1"># è¡¨å• Inputs æ ä½</span>
    <span class="na">inputs</span><span class="pi">:</span>
      <span class="c1"># æ‰§è¡Œçš„ Test Fastlane Lane</span>
      <span class="na">TEST_LANE</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Test</span><span class="nv"> </span><span class="s">Lane'</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s1">'</span><span class="s">run_unit_tests'</span>
        <span class="c1"># workflow_call inputs ä¸æ”¯æ´ choice</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
      <span class="na">BRANCH</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Branch'</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
  
<span class="c1"># Job å·¥ä½œé¡¹ç›®</span>
<span class="c1"># Job ä¼šå¹¶å‘æ‰§è¡Œ</span>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="c1"># Job ID</span>
  <span class="na">testing</span><span class="pi">:</span>
    <span class="c1"># Job åç§° (å¯çœç•¥ï¼Œæœ‰è®¾å®šåœ¨ Log æ˜¾ç¤ºæ¯”è¾ƒå¥½è¯»)</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">Testing</span>
    
    <span class="c1"># Runner Label - ä½¿ç”¨ GitHub Hosted Runner macos-15 æ¥æ‰§è¡Œå·¥ä½œ</span>
    <span class="c1"># è¯·æ³¨æ„ï¼šå› ä¸ºæ­¤ä¸“æ¡ˆæ˜¯ Public Repo å¯ä»¥æ— é™å…è´¹ä½¿ç”¨</span>
    <span class="c1"># è¯·æ³¨æ„ï¼šå› ä¸ºæ­¤ä¸“æ¡ˆæ˜¯ Public Repo å¯ä»¥æ— é™å…è´¹ä½¿ç”¨</span>
    <span class="c1"># è¯·æ³¨æ„ï¼šå› ä¸ºæ­¤ä¸“æ¡ˆæ˜¯ Public Repo å¯ä»¥æ— é™å…è´¹ä½¿ç”¨</span>
    <span class="c1"># å¦‚æœæ˜¯ Private Repo éœ€è¦æŒ‰è®¡é‡æ”¶è´¹ï¼ŒmacOS æœºå™¨æ˜¯æœ€è´µçš„(10å€)ï¼Œå¯èƒ½è·‘ 10 æ¬¡å°±è¾¾åˆ° 2,000 åˆ†é’Ÿå…è´¹ä¸Šé™</span>
    <span class="c1"># å»ºè®®ä½¿ç”¨ self-hosted Runner</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">macos-15</span>

    <span class="c1"># è®¾å®šæœ€é•¿ Timeout æ—¶é—´ï¼Œé˜²æ­¢å¼‚å¸¸æƒ…å†µå‘ç”Ÿæ—¶æ— æ­¢å°½çš„ç­‰å¾…</span>
    <span class="na">timeout-minutes</span><span class="pi">:</span> <span class="m">30</span>

    <span class="c1"># use zsh</span>
    <span class="c1"># å¯çœç•¥ï¼Œåªæ˜¯æˆ‘ä¹ æƒ¯ç”¨ zshï¼Œé¢„è®¾æ˜¯ bash</span>
    <span class="na">defaults</span><span class="pi">:</span>
      <span class="na">run</span><span class="pi">:</span>
        <span class="na">shell</span><span class="pi">:</span> <span class="s">zsh {0}</span>
          
    <span class="c1"># å·¥ä½œæ­¥éª¤</span>
    <span class="c1"># å·¥ä½œæ­¥éª¤ä¼šç…§é¡ºåºæ‰§è¡Œ  </span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="c1"># git clone å½“å‰ä¸“æ¡ˆ &amp; checkout åˆ°æ‰§è¡Œçš„åˆ†æ”¯</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Checkout repository</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v3</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="c1"># Git Large File Storageï¼Œæˆ‘ä»¬çš„æµ‹è¯•ç¯å¢ƒç”¨ä¸åˆ°</span>
          <span class="c1"># default: false</span>
          <span class="na">lfs</span><span class="pi">:</span> <span class="kc">false</span>
          
          <span class="c1"># å¦‚æœæœ‰æŒ‡å®šåˆ™ Checkout æŒ‡å®šåˆ†æ”¯ï¼Œæ²¡æœ‰åˆ™ä½¿ç”¨é¢„è®¾(å½“å‰åˆ†æ”¯)</span>
          <span class="c1"># å›  on: schedule äº‹ä»¶åªèƒ½åœ¨ main ä¸»åˆ†æ”¯æ‰§è¡Œï¼Œå› æ­¤æƒ³åš Nightly Build ä¹‹ç±»çš„å·¥ä½œå°±éœ€è¦æŒ‡å®šåˆ†æ”¯</span>
          <span class="c1"># e.g. on: schedule -&gt; main åˆ†æ”¯ï¼ŒNightly Build master åˆ†æ”¯</span>
          <span class="na">ref</span><span class="pi">:</span> <span class="s">${{ github.event.inputs.BRANCH \\|\\| '' }}</span>

      <span class="c1"># ========== Env Setup Steps ==========</span>
      
      <span class="c1"># è¯»å–ä¸“æ¡ˆæŒ‡å®šçš„ XCode ç‰ˆæœ¬</span>
      <span class="c1"># åœ¨åç»­ä¹‹ä¸­ï¼Œæˆ‘ä»¬è‡ªå·±æ‰‹åŠ¨æŒ‡å®šä½¿ç”¨çš„ XCode_x.x.x.app</span>
      <span class="c1"># è€Œä¸ä½¿ç”¨ xcversionï¼Œå› ä¸º xcversion å·²ç» sunset ä¸ç¨³å®šã€‚ </span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Read .xcode-version</span>
        <span class="na">id</span><span class="pi">:</span> <span class="s">read_xcode_version</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
          <span class="s">XCODE_VERSION=$(cat .xcode-version)</span>
          <span class="s">echo "XCODE_VERSION</span><span class="err">:</span> <span class="s">${XCODE_VERSION}"</span>
          <span class="s">echo "xcode_version=${XCODE_VERSION}" &gt;&gt; $GITHUB_OUTPUT</span>

          <span class="s"># ä¹Ÿå¯ä»¥ç›´æ¥åœ¨è¿™æŒ‡å®šå…¨åŸŸ XCode ç‰ˆæœ¬ï¼Œè¿™æ ·å°±ä¸ç”¨åœ¨åç»­æ­¥éª¤æŒ‡å®š DEVELOPER_DIR</span>
          <span class="s"># ä½†æ­¤æŒ‡ä»¤éœ€è¦ sudoer æƒé™ï¼Œå¦‚æœæ˜¯ self-hosted runner å°±è¦ç¡®å®š runner æ‰§è¡Œç¯å¢ƒæœ‰ sudo æƒé™</span>
          <span class="s"># sudo xcode-select -s "/Applications/Xcode_${XCODE_VERSION}.app/Contents/Developer"</span>

      <span class="c1"># è¯»å–ä¸“æ¡ˆæŒ‡å®šçš„ Ruby ç‰ˆæœ¬</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Read .ruby-version</span>
        <span class="na">id</span><span class="pi">:</span> <span class="s">read_ruby_version</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
          <span class="s">RUBY_VERSION=$(cat .ruby-version)</span>
          <span class="s">echo "RUBY_VERSION</span><span class="err">:</span> <span class="s">${RUBY_VERSION}"</span>
          <span class="s">echo "ruby_version=${RUBY_VERSION}" &gt;&gt; $GITHUB_OUTPUT</span>

      <span class="c1"># å®‰è£…æˆ–è®¾å®š Runner Ruby ç‰ˆæœ¬æˆä¸“æ¡ˆæŒ‡å®šç‰ˆæœ¬</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Set up Ruby</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">ruby/setup-ruby@v1</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">ruby-version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${{</span><span class="nv"> </span><span class="s">steps.read_ruby_version.outputs.ruby_version</span><span class="nv"> </span><span class="s">}}"</span>

      <span class="c1"># å¯è®¾å¯ä¸è®¾ï¼ŒåŸå› æ˜¯ä¹‹å‰åœ¨ self-hosted èµ·å¤šä¸ª runner è·‘ CI/CD å› ä¸º cocoapods repos æ˜¯å…±ç”¨ç›®å½•</span>
      <span class="c1"># è§£å†³çš„é—®é¢˜æ˜¯ï¼šæœ‰å¾ˆå°çš„æœºç‡ä¼šå‡ºç°åœ¨åŒæ—¶ pod install æ—¶æ‹‰ cocoapods repos å‡ºç°å†²çª(å› ä¸ºé¢„è®¾éƒ½æ˜¯ç”¨) $HOME/.cocoapods/</span>
      <span class="c1"># GitHub Hosted Runner åˆ™ä¸éœ€æ­¤è®¾å®š</span>
      <span class="c1"># - name: Change Cocoapods Repos Folder</span>
      <span class="c1">#   if: contains(runner.labels, 'self-hosted')</span>
      <span class="c1">#   run: \\|</span>
      <span class="c1">#     # æ¯ä¸ª Runner ç”¨è‡ªå·±çš„ .cocoapods èµ„æ–™å¤¹ï¼Œé˜²æ­¢èµ„æºå†²çª</span>
      <span class="c1">#     mkdir -p "$HOME/.cocoapods-${{ env.RUNNER_NAME }}/"</span>
      <span class="c1">#     export CP_HOME_DIR="$HOME/.cocoapods-${{ env.RUNNER_NAME }}"</span>
      <span class="c1">#     rm -f "$HOME/.cocoapods-${{ env.RUNNER_NAME }}/repos/cocoapods/.git/index.lock"</span>

      <span class="c1"># ========== Cache Setting Steps ==========</span>
      <span class="c1"># è¯·æ³¨æ„ï¼Œå°±ç®—æ˜¯ self-hostedï¼ŒCache ç›®å‰ä¹Ÿæ˜¯ Cloud Cache ä¼šè®¡ç®—ç”¨é‡</span>
      <span class="c1"># è§„åˆ™ï¼š7 å¤©æœª hit è‡ªåŠ¨åˆ é™¤ã€å•ä¸ª Cache ä¸Šé™ 10 GBã€Action æˆåŠŸæ‰ä¼š Cache</span>
      <span class="c1"># Public Repo: å…è´¹æ— é™åˆ¶</span>
      <span class="c1"># Private Repo: 5 GB èµ·</span>
      <span class="c1"># Self-hosted å¯ä»¥è‡ªå·±ç”¨ shell script æ’°å†™ Cache &amp; Restore ç­–ç•¥æˆ–ä½¿ç”¨å…¶ä»–å·¥å…·ååŠ©</span>
      
      <span class="c1"># Bundle Cache (Gemfile)</span>
      <span class="c1"># å¯¹åº” Makefile ä¸­æˆ‘ä»¬æŒ‡å®šäº† Bundle  å®‰è£…è·¯å¾„ ./vendor ä¸‹</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Cache Bundle</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/cache@v3</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">path</span><span class="pi">:</span> <span class="s">\\|</span>
            <span class="s">./vendor</span>
          <span class="na">key</span><span class="pi">:</span> <span class="s">${{ runner.os }}-bundle-${{ hashFiles('Gemfile.lock') }}</span>
          <span class="na">restore-keys</span><span class="pi">:</span> <span class="s">\\|</span>
            <span class="s">${{ runner.os }}-bundle-</span>

      <span class="c1"># CocoaPods Cache (Podfile)</span>
      <span class="c1"># é»˜è®¤å°±æ˜¯ ä¸“æ¡ˆ/Pods ä¸‹</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Cache CocoaPods</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/cache@v3</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">path</span><span class="pi">:</span> <span class="s">\\|</span>
            <span class="s">./Product/Pods</span>
          <span class="na">key</span><span class="pi">:</span> <span class="s">${{ runner.os }}-cocoapods-${{ hashFiles('Product/Podfile.lock') }}</span>
          <span class="na">restore-keys</span><span class="pi">:</span> <span class="s">\\|</span>
            <span class="s">${{ runner.os }}-cocoapods-</span>

      <span class="c1"># Mint cache</span>
      <span class="c1"># å¯¹åº” Makefile ä¸­æˆ‘ä»¬æŒ‡å®šçš„ Mint å®‰è£…è·¯å¾„ ./mint ä¸‹</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Cache Mint</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/cache@v3</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">path</span><span class="pi">:</span> <span class="s">./mint</span>
          <span class="na">key</span><span class="pi">:</span> <span class="s">${{ runner.os }}-mint-${{ hashFiles('Mintfile') }}</span>
          <span class="na">restore-keys</span><span class="pi">:</span> <span class="s">\\|</span>
            <span class="s">${{ runner.os }}-mint-</span>

      <span class="c1"># ====================</span>

      <span class="c1"># ä¸“æ¡ˆ Setup &amp; ä¾èµ–å®‰è£…</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Setup &amp; Install Dependency</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
          <span class="s"># æ‰§è¡Œ Makefile ä¸­å°è£…çš„ Setup æŒ‡ä»¤ï¼Œå¯¹åº”æˆæŒ‡ä»¤å¤§æ¦‚æ˜¯ï¼š</span>
          <span class="s"># brew install mint</span>
          <span class="s"># bundle config set path 'vendor/bundle'</span>
          <span class="s"># bundle install</span>
          <span class="s"># mint bootstrap</span>
          <span class="s"># ...</span>
          <span class="s"># ç­‰ç­‰ setup æŒ‡ä»¤</span>
          <span class="s">make setup</span>

          <span class="s"># æ‰§è¡Œ Makefile ä¸­å°è£…çš„ Install æŒ‡ä»¤ï¼Œå¯¹åº”æˆæŒ‡ä»¤å¤§æ¦‚æ˜¯ï¼š</span>
          <span class="s"># mint run yonaskolb/XcodeGen --quiet</span>
          <span class="s"># bundle exec pod install</span>
          <span class="s"># ...</span>
          <span class="s"># ç­‰ç­‰ install æŒ‡ä»¤</span>
          <span class="s">make install</span>

      <span class="c1"># æ‰§è¡Œ Fastlane Unit æµ‹è¯• Lane</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Run Tests</span>
        <span class="na">id</span><span class="pi">:</span> <span class="s">testing</span>
        <span class="c1"># æŒ‡å®šå·¥ä½œç›®å½•ï¼Œè¿™æ ·åç»­æŒ‡ä»¤å°±ä¸ç”¨åœ¨ç‰¹åˆ« cd ./Product/</span>
        <span class="na">working-directory</span><span class="pi">:</span> <span class="s">./Product/</span>
        <span class="na">env</span><span class="pi">:</span>
          <span class="c1"># æµ‹è¯•è®¡åˆ’ï¼Œå…¨è·‘è¿˜æ˜¯åªè·‘å•å…ƒæµ‹è¯•</span>
          <span class="c1"># å¦‚ä¸ºå¼€ PR è§¦å‘åˆ™ä½¿ç”¨ run_unit_testsï¼Œå¦åˆ™çœ‹ inputs.TEST_LANE çš„å€¼ï¼Œé¢„è®¾å€¼ run_all_tests</span>
          <span class="na">TEST_LANE</span><span class="pi">:</span> <span class="s">${{ github.event_name == 'pull_request' &amp;&amp; 'run_unit_tests' \\|\\| github.event.inputs.TEST_LANE \\|\\| 'run_all_tests' }}</span>
          
          <span class="c1"># æŒ‡å®šè¿™ä¸ª Job è¦ä½¿ç”¨ XCode_x.x.x æŒ‡å®šçš„ç‰ˆæœ¬æ‰§è¡Œ</span>
          <span class="na">DEVELOPER_DIR</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/Applications/Xcode_${{</span><span class="nv"> </span><span class="s">steps.read_xcode_version.outputs.xcode_version</span><span class="nv"> </span><span class="s">}}.app/Contents/Developer"</span>
          
          <span class="c1"># Repo -&gt; Settings -&gt; Actions secrets and variables -&gt; variables</span>
          <span class="c1"># ä½¿ç”¨çš„æ¨¡æ‹Ÿå™¨åç§°</span>
          <span class="na">SIMULATOR_NAME</span><span class="pi">:</span> <span class="s">${{ vars.SIMULATOR_NAME }}</span>
          <span class="c1"># æ¨¡æ‹Ÿå™¨çš„ iOS ç‰ˆæœ¬</span>
          <span class="na">SIMULATOR_IOS_VERSION</span><span class="pi">:</span> <span class="s">${{ vars.SIMULATOR_IOS_VERSION }}</span>

          <span class="c1"># å½“å‰ Runner åç§°</span>
          <span class="na">RUNNER_NAME</span><span class="pi">:</span> <span class="s">${{ runner.name }}</span>
          
          <span class="c1"># æå‡ XCodebuild æŒ‡ä»¤ timeout æ—¶é—´, retry æ¬¡æ•°</span>
          <span class="c1"># å› ä¸ºæœºå™¨ Loading æ¯”è¾ƒå¤§çš„æ—¶å€™å¯èƒ½ 3 æ¬¡å°±å¤±è´¥äº†</span>
          <span class="na">FASTLANE_XCODEBUILD_SETTINGS_TIMEOUT</span><span class="pi">:</span> <span class="m">60</span>
          <span class="na">FASTLANE_XCODEBUILD_SETTINGS_RETRIES</span><span class="pi">:</span> <span class="m">10</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>

          <span class="s"># å¦‚æœæ˜¯ self-hosted åœ¨åŒä¸€å°æœºå™¨èµ·å¤šä¸ª Runner ä¼šå‡ºç°æŠ¢æ¨¡æ‹Ÿå™¨çš„é—®é¢˜ (æ–‡ç« åä¼šè®²)</span>
          <span class="s"># è¦é¿å…è¿™é—®é¢˜å»ºè®®å°†æ¨¡æ‹Ÿåç§°å‘½åæˆ Runner åç§°ï¼Œæ¯ä¸ª Runner éƒ½è®¾ä¸€ä¸ªæ¨¡æ‹Ÿå™¨ï¼Œè¿™æ ·å°±ä¸ä¼šäº’æŠ¢å¯¼è‡´æµ‹è¯•å¤±è´¥</span>
          <span class="s"># e.g. bundle exec fastlane run_unit_tests device:"${RUNNER_NAME} (${SIMULATOR_IOS_VERSION})"</span>
          <span class="s"># è¿™è¾¹æ˜¯ç”¨ GitHub Hosted Runner æ²¡è¿™é—®é¢˜ï¼Œæ‰€ä»¥ç›´æ¥ç”¨ device:"${SIMULATOR_NAME} (${SIMULATOR_IOS_VERSION})"</span>

          <span class="s"># å‘ç”Ÿé”™è¯¯ä¸ç›´æ¥é€€å‡ºå¹¶å°†æ‰€æœ‰è¾“å‡ºéƒ½å†™å…¥ temp/testing_output.txt æ¡£æ¡ˆ</span>
          <span class="s"># åç»­æˆ‘ä»¬ä¼šåˆ†ææ¡£æ¡ˆå†…å®¹åŒºåˆ†å‡ºæ˜¯ Build Failed è¿˜æ˜¯ Test Failedï¼ŒComment ä¸åŒè®¯æ¯åˆ° PR</span>
          <span class="s">set +e</span>
          
          <span class="s"># EXIT_CODE å‚¨å­˜æ‰§è¡Œç»“æœçš„ exit code.</span>
          <span class="s"># 0 = OK</span>
          <span class="s"># 1 = exit</span>
          <span class="s">EXIT_CODE=0</span>
          
          <span class="s"># æ‰€æœ‰è¾“å‡ºéƒ½å†™å…¥æ¡£æ¡ˆ</span>
          <span class="s">bundle exec fastlane ${TEST_LANE} device:"${SIMULATOR_NAME} (${SIMULATOR_IOS_VERSION})" \\| tee "$RUNNER_TEMP/testing_output.txt"</span>
          <span class="s"># å¦‚æœç›®å‰ EXIT_CODE æ˜¯ 0ï¼Œåˆ™å°† ${pipestatus[1]} èµ‹å€¼ç»™ EXIT_CODE</span>
          <span class="s">[[ $EXIT_CODE -eq 0 ]] &amp;&amp; EXIT_CODE=${pipestatus[1]}</span>

          <span class="s"># æ¢å¤å‡ºé”™å°±é€€å‡º</span>
          <span class="s">set -e</span>

          <span class="s"># æ£€æŸ¥ Testing Output</span>
          <span class="s"># å¦‚æœ Testing Output åŒ…å« "Error building"ï¼Œåˆ™è®¾ is_build_error=true ç»™ Actions ç¯å¢ƒå˜æ•°ï¼Œä¸º Build å°±å¤±è´¥</span>
          <span class="s"># å¦‚æœ Testing Output åŒ…å« "Tests have failed"ï¼Œåˆ™è®¾ is_test_error=true ç»™ Actions ç¯å¢ƒå˜æ•°ï¼Œä¸ºæµ‹è¯•å¤±è´¥</span>
          
          <span class="s">if grep -q "Error building" "$RUNNER_TEMP/testing_output.txt"; then</span>
            <span class="s">echo "is_build_error=true" &gt;&gt; $GITHUB_OUTPUT</span>
            <span class="s">echo "âŒ Detected Build Error"</span>
          <span class="s">elif grep -q "Tests have failed" "$RUNNER_TEMP/testing_output.txt"; then</span>
            <span class="s">echo "is_test_error=true" &gt;&gt; $GITHUB_OUTPUT</span>
            <span class="s">echo "âŒ Detected Test Error"</span>
          <span class="s">fi</span>

          <span class="s"># æ¢å¤ Exit Code Output</span>
          <span class="s">exit $EXIT_CODE</span>
          
      <span class="c1"># ========== Handle Result Steps ==========</span>
      
      <span class="c1"># è§£æ *.junit æµ‹è¯•æŠ¥å‘Šï¼Œå¹¶æ ‡è®°ç»“æœã€Comment(å¦‚æœæ˜¯ PR çš„è¯)</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Publish Test Report</span>
        <span class="c1"># ç›´æ¥å¤ç”¨åˆ«äººå†™å¥½çš„ .junit Paser Actions: https://github.com/mikepenz/action-junit-report</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">mikepenz/action-junit-report@v5</span>
        <span class="c1"># if:</span>
        <span class="c1"># ä¸Šä¸€æ­¥(Testing) success or</span>
        <span class="c1"># ä¸Šä¸€æ­¥(Testing) failed and is_test_error (build failed ä¸æ‰§è¡Œè¿™ä¸ª step)</span>
        <span class="na">if</span><span class="pi">:</span> <span class="s">${{ (failure() &amp;&amp; steps.testing.outputs.is_test_error == 'true') \\|\\| success() }}</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">check_name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Testing</span><span class="nv"> </span><span class="s">Report"</span>
          <span class="na">comment</span><span class="pi">:</span> <span class="kc">true</span>
          <span class="na">updateComment</span><span class="pi">:</span> <span class="kc">false</span>
          <span class="na">require_tests</span><span class="pi">:</span> <span class="kc">true</span>
          <span class="na">detailed_summary</span><span class="pi">:</span> <span class="kc">true</span>
          <span class="na">report_paths</span><span class="pi">:</span> <span class="s2">"</span><span class="s">./Product/fastlane/test_output/*.junit"</span>

      <span class="c1"># æµ‹è¯•å»ºç½®å¤±è´¥ Comment</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Build Failure Comment</span>
        <span class="c1"># if:</span>
        <span class="c1"># ä¸Šä¸€æ­¥(Testing) failed and is_build_error and æœ‰ PR Number</span>
        <span class="c1"># </span>
        <span class="na">if</span><span class="pi">:</span> <span class="s">${{ failure() &amp;&amp; steps.testing.outputs.is_build_error == 'true' &amp;&amp; github.event.pull_request.number }}</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/github-script@v6</span>
        <span class="na">env</span><span class="pi">:</span>
          <span class="na">action_url</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${{</span><span class="nv"> </span><span class="s">github.server_url</span><span class="nv"> </span><span class="s">}}/${{</span><span class="nv"> </span><span class="s">github.repository</span><span class="nv"> </span><span class="s">}}/actions/runs/${{</span><span class="nv"> </span><span class="s">github.run_id</span><span class="nv"> </span><span class="s">}}/attempts/${{</span><span class="nv"> </span><span class="s">github.run_attempt</span><span class="nv"> </span><span class="s">}}"</span>
        <span class="na">with</span><span class="pi">:</span>
            <span class="na">script</span><span class="pi">:</span> <span class="s">\\|</span>
              <span class="s">const action_url = process.env.action_url</span>
              <span class="s">const pullRequest = context.payload.pull_request \\|\\| {}</span>
              <span class="s">const commitSha = pullRequest.head?.sha \\|\\| context.sha</span>
              <span class="s">const creator = pullRequest.user?.login \\|\\| context.actor</span>
        
              <span class="s">const commentBody = [</span>
                <span class="s">`# ä¸“æ¡ˆæˆ–æµ‹è¯•å»ºç½®å¤±è´¥ âŒ`,</span>
                <span class="s">`è¯·ç¡®è®¤æ‚¨çš„ Pull Request æ˜¯å¦å¯ä»¥æ­£ç¡®ç¼–è¯‘ä¸æ‰§è¡Œæµ‹è¯•ã€‚`,</span>
                <span class="s">``,</span>
                <span class="s">`ğŸ”— **Action**</span><span class="err">:</span> <span class="pi">[</span><span class="nv">View Workflow Run</span><span class="pi">]</span><span class="s">(${action_url})`,</span>
                <span class="s">`ğŸ“ **Commit**</span><span class="err">:</span> <span class="s">${commitSha}`,</span>
                <span class="s">`ğŸ‘¤ **Author**</span><span class="err">:</span> <span class="err">@</span><span class="s">${creator}`</span>
              <span class="s">].join('\n')</span>
        
              <span class="s">await github.rest.issues.createComment({</span>
                <span class="s">owner</span><span class="err">:</span> <span class="s">context.repo.owner,</span>
                <span class="s">repo</span><span class="err">:</span> <span class="s">context.repo.repo,</span>
                <span class="s">issue_number</span><span class="err">:</span> <span class="s">context.payload.pull_request.number,</span>
                <span class="s">body</span><span class="err">:</span> <span class="s">commentBody</span>
              <span class="s">})</span>
</pre></table></code></div></div><p><strong>æŠ€æœ¯é‡ç‚¹è¯´æ˜ï¼š</strong></p><ul><li><p>runs-on: å»ºè®®æ”¹ç”¨ self-hosted Runnerï¼Œ <a href="https://docs.github.com/en/billing/managing-billing-for-your-products/about-billing-for-github-actions#per-minute-rates" target="_blank">GitHub Hosted Runner macOS å¾ˆè´µçš„</a> ã€‚</p><li><p>æ‰‹åŠ¨è¯»å– <code class="language-plaintext highlighter-rouge">.xcode-version</code> æ¡£æ¡ˆå–å¾—æŒ‡å®šçš„ XCode ç‰ˆæœ¬å¹¶åœ¨éœ€è¦æŒ‡å®š XCode çš„ Step è®¾å®š <code class="language-plaintext highlighter-rouge">DEVELOPER_DIR</code> env å¯ä»¥è½»æ¾å… Sudo åˆ‡æ¢ XCode</p><li><p>Cache: å¯ä»¥åŠ é€Ÿä¾èµ–å®‰è£…é€Ÿåº¦ï¼Œä½†éœ€æ³¨æ„å°±ç®—æ˜¯ self-hosted Runner ä¾ç„¶ä¼šä½¿ç”¨ GitHub Cloud Cacheï¼Œå—åˆ°æ”¶è´¹é™åˆ¶</p><li><p>ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">set +e</code> ä½¿æŒ‡ä»¤æ‰§è¡Œå¤±è´¥ä¸ä¼šé©¬ä¸Šé€€å‡º+å°† output éƒ½è¾“å‡ºåˆ°æ¡£æ¡ˆ+è¯»å–æ¡£æ¡ˆåˆ¤æ–­æ˜¯ Build Failed or Test Failedï¼›å¦‚æœä¸è¿™æ ·åšè®¯æ¯ç»Ÿä¸€éƒ½ä¼šæ˜¯ Test Failedã€‚ ä¹Ÿå¯ä»¥å»¶ä¼¸å»åˆ¤æ–­å…¶ä»–é”™è¯¯ï¼Œä¾‹å¦‚ï¼š <code class="language-plaintext highlighter-rouge">Underlying Error: Unable to boot the Simulator.</code> æ¨¡æ‹Ÿå™¨å¯åŠ¨å¤±è´¥ï¼Œè¯·é‡æ–°å°è¯•ã€‚</p><li><p>Checkout Code å¯æ¥å—æŒ‡å®šåˆ†æ”¯ï¼šå› ä¸º <code class="language-plaintext highlighter-rouge">on: schedule</code> äº‹ä»¶åªèƒ½åœ¨ main (Default Branch) è§¦å‘ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›æ’ç¨‹å¯¹æŸä¸ªå…¶ä»–åˆ†æ”¯æ“ä½œï¼Œå°±éœ€è¦æŒ‡å®šåˆ†æ”¯ã€‚</p><li><p>æŒ‡å®š .cocoapods Repo è·¯å¾„å¯åšå¯ä¸åšï¼Œä¹‹å‰æ˜¯é‡è¿‡ self-hosted åŒä¸€å°æœºå™¨ä¸¤ä¸ª Runner åŒæ—¶å¡åœ¨ pod install å°±æ˜¯å› ä¸ºåˆšå¥½éƒ½åœ¨é’ˆå¯¹ .cocoapods Repo æ“ä½œé€ æˆ git lockã€‚ (ä½†æœºç‡å¾ˆä½å°±æ˜¯äº†)</p><li><p><strong>å¦‚æœä½ æœ‰ Private Pods Repo éœ€è¦è®¾å®š SSH Agent æ‰æœ‰æƒé™ Cloneã€‚</strong> <strong>(è¯·å‚è€ƒæ–‡æœ«è¡¥å……)</strong></p><li><p>è®°å¾—åˆ° Repo -&gt; Settings -&gt; Actions secrets and variables -&gt; variables æ–°å¢ï¼š <code class="language-plaintext highlighter-rouge">SIMULATOR_IOS_VERSION</code> æ¨¡æ‹Ÿå™¨ iOS ç‰ˆæœ¬ <code class="language-plaintext highlighter-rouge">SIMULATOR_NAME</code> æ¨¡æ‹Ÿå™¨åç§°</p></ul><p><a href="/assets/4b001d2e8440/1*Vj37P9vZ6KL5wWNvU3Cq3Q.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*Vj37P9vZ6KL5wWNvU3Cq3Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTU2IiBoZWlnaHQ9IjU0OSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><strong>Commit æ¡£æ¡ˆåˆ° Repo ä¸»åˆ†æ”¯ï¼Œæ‰‹åŠ¨è§¦å‘ä¸€æ¬¡éªŒè¯æ­£ä¸æ­£ç¡®ï¼š</strong></p><p><a href="/assets/4b001d2e8440/1*tA2nKehTJ7aURSGgU7MM0g.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*tA2nKehTJ7aURSGgU7MM0g.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjQ4MiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/4b001d2e8440/1*Qap3KmhIJrLov2O7GneV3w.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*Qap3KmhIJrLov2O7GneV3w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDMxIiBoZWlnaHQ9IjkxMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>æ­£ç¡®åç»§ç»­è®¾å®šã€‚</p><h4 id="github-æµç¨‹è®¾å®š"><span class="me-2">GitHub æµç¨‹è®¾å®š</span><a href="#github-æµç¨‹è®¾å®š" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Repo â†’ Settins â†’ Rules â†’ Rulesetsã€‚</p><p><a href="/assets/4b001d2e8440/1*cf_M6NnakdcbzvC2VHSfpw.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*cf_M6NnakdcbzvC2VHSfpw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9Ijk2MiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ul><li><p>Ruleset Name: è§„åˆ™åç§°</p><li><p>Enforcement status: å¯ç”¨/åœç”¨ æ­¤è§„åˆ™é™åˆ¶</p><li><p>Target branches: ç›®æ ‡çš„ Base åˆ†æ”¯ï¼Œè®¾ Default Branch å°±æ˜¯æ‰€æœ‰æƒ³åˆè¿›åˆ° main or develop çš„åˆ†æ”¯éƒ½å—åˆ°æ­¤è§„åˆ™é™åˆ¶</p><li><p>Bypass list: å¯æŒ‡å®šç‰¹æ®Šèº«ä»½ã€Team å¯ä»¥ä¸å—æ­¤é™</p><li><p>Branch rules:</p></ul><p><a href="/assets/4b001d2e8440/1*Hzd9CCTsu18kyDR1goRWag.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*Hzd9CCTsu18kyDR1goRWag.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MTIiIGhlaWdodD0iMTIzMSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ul><li><p>Restrict deletions: ç¦æ­¢åˆ é™¤åˆ†æ”¯</p><li><p>Require a pull request before mergin: åªèƒ½é€è¿‡ PR Merge Required approvals: é™åˆ¶éœ€è¦å‡ äºº Approve</p><li><p>Require status checks to pass: é™åˆ¶å“ªäº› Checks è¦ Passed æ‰èƒ½ Merge ç‚¹ + Add checks è¾“å…¥ <code class="language-plaintext highlighter-rouge">Testing</code> é€‰æ‹©æœ‰ GitHub Actions æ ‡å¿—çš„ã€‚ <strong>è¿™è¾¹æœ‰ä¸ªå°é—®é¢˜ï¼Œå¦‚æœ Suggestions</strong> <strong>æ‰¾ä¸åˆ° <code class="language-plaintext highlighter-rouge">Testing</code> é‚£éœ€è¦å…ˆå›åˆ° Actions è§¦å‘(å¼€ PR è¯•è¯•)æˆåŠŸä¸€æ¬¡ï¼Œè¿™é‡Œæ‰ä¼šå‡ºç°ã€‚</strong></p></ul><p><a href="/assets/4b001d2e8440/1*MRPwUEVVbbz8nH0sS2hFfQ.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*MRPwUEVVbbz8nH0sS2hFfQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MzQiIGhlaWdodD0iMzk0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>Block force pushes: ç¦æ­¢ Force push</ul><p>å‚¨å­˜ã€ç¡®å®š Enforcement status æ˜¯ Active åï¼Œè§„åˆ™å°±ä¼šç”Ÿæ•ˆäº†ã€‚</p><p><strong>éƒ½è®¾å®šå¥½ä¹‹åï¼Œå¼€ PR æµ‹è¯•çœ‹çœ‹ï¼š</strong></p><p><a href="/assets/4b001d2e8440/1*iPETBWx6Boq12rY1fHXmuQ.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*iPETBWx6Boq12rY1fHXmuQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MTkiIGhlaWdodD0iNTQ2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>Checks æœ‰å‡ºç° CI-Testing ( <strong>Requried</strong> )ã€Merging is blockedã€At least X approving review is required by reviewers with write access. ä»£è¡¨è®¾ç½®æˆåŠŸäº†ã€‚</ul><p><strong>å¦‚æœä¸“æ¡ˆå»ºç½®å¤±è´¥ (Build Failed) ä¼š Commentï¼š</strong></p><p><a href="/assets/4b001d2e8440/1*4E35VRPo--pI8uqrR4UZNA.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*4E35VRPo--pI8uqrR4UZNA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MTUiIGhlaWdodD0iMjk1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><strong>å¦‚æœä¸“æ¡ˆå»ºç½®æˆåŠŸä½†æµ‹è¯•æ¡ˆä¾‹å¤±è´¥ (Test Failed) ä¼š Commentï¼š</strong></p><p><a href="/assets/4b001d2e8440/1*wYFzsn5a_yvi8CbZxi-QdQ.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*wYFzsn5a_yvi8CbZxi-QdQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MjEiIGhlaWdodD0iMzg5Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><strong>å¦‚æœä¸“æ¡ˆå»ºç½®æˆåŠŸæµ‹è¯•ä¹ŸæˆåŠŸ(Test Success) ä¼š Commentï¼š</strong></p><p><a href="/assets/4b001d2e8440/1*WqPK1629jYdYTEWCWBHWqg.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*WqPK1629jYdYTEWCWBHWqg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MTUiIGhlaWdodD0iMzIxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><strong>å®Œæˆ Review Approve + Check æµ‹è¯•é€šè¿‡åï¼š</strong></p><p><a href="/assets/4b001d2e8440/1*5gnQYdVAOtGR-bMK4ZrOhA.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*5gnQYdVAOtGR-bMK4ZrOhA.webp" alt="[Demo PR](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/pull/11){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MTEiIGhlaWdodD0iNTY2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="https://github.com/ZhgChgLi/github-actions-ci-cd-demo/pull/11" target="_blank">Demo PR</a></p><p>å°±èƒ½ Merge PRã€‚</p><ul><li>å¦‚æœæœ‰ Push New Commit ä¼šè‡ªåŠ¨é‡è·‘ Checks æµ‹è¯•ã€‚</ul><p><strong>å®Œæ•´ç¨‹å¼ç ï¼š <a href="https://github.com/ZhgChgLi/github-actions-ci-cd-demo/blob/main/.github/workflows/CI-Testing.yml" target="_blank">CI-Testing.yml</a></strong></p><p><strong>Auto-merge:</strong></p><p>å¦å¤–ï¼Œä¹Ÿå¯ä»¥æ‰“å¼€ Repo Settings â†’ General â†’ Pull Request ä¸­çš„ï¼š</p><p><a href="/assets/4b001d2e8440/1*hl6mfqnnv_zAA3YVrI_M0w.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*hl6mfqnnv_zAA3YVrI_M0w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NTYiIGhlaWdodD0iMjU3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li><p>Automatically delete head branches: Merge PR åè‡ªåŠ¨åˆ é™¤åˆ†æ”¯</p><li><p>Allow Auto-merge: å½“ Checks é€šè¿‡ï¼‹ç¬¦åˆæ¡ä»¶çš„ Approvals è¾¾æˆä¼šè‡ªåŠ¨ Merge PR <strong>åªæœ‰å½“æœ‰è®¾æ¡ä»¶ï¼‹å½“å‰æ¡ä»¶è¿˜ä¸èƒ½ Merge æ—¶æ‰ä¼šå‡ºç° Enable auto-merge æŒ‰é’®ã€‚</strong></p></ul><p><a href="/assets/4b001d2e8440/1*gi0LaaMVXit-DGKnsxS1lQ.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*gi0LaaMVXit-DGKnsxS1lQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MjciIGhlaWdodD0iNDMxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><h3 id="cd--æ‰“åŒ…éƒ¨ç½²åˆ°-firebase-app-distribution"><span class="me-2">CD â€” æ‰“åŒ…+éƒ¨ç½²åˆ° Firebase App Distribution</span><a href="#cd--æ‰“åŒ…éƒ¨ç½²åˆ°-firebase-app-distribution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="æµç¨‹-1"><span class="me-2">æµç¨‹</span><a href="#æµç¨‹-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>ä½¿ç”¨ GitHub Actions è¡¨å•è§¦å‘æ‰“åŒ…å·¥ä½œï¼Œå¯æŒ‡å®šç‰ˆæœ¬å·ã€Release Notesï¼Œæ‰“åŒ…å®Œä¼šè‡ªåŠ¨ä¸Šä¼ åˆ° Firebase App Distribution ä¾›å›¢é˜Ÿä¸‹è½½æµ‹è¯•ä½¿ç”¨ã€‚</p><h4 id="cd-deployyml"><span class="me-2">CD-Deploy.yml</span><a href="#cd-deployyml" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Repo â†’ Actions â†’ New workflow â†’ set up a workflow yourselfã€‚</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
</pre><td class="rouge-code"><pre><span class="c1"># Workflow(Action) åç§°</span>
<span class="na">name</span><span class="pi">:</span> <span class="s">CD-Deploy</span>

<span class="c1"># Actions Log çš„æ ‡é¢˜åç§°</span>
<span class="na">run-name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">[CD-Deploy]</span><span class="nv"> </span><span class="s">${{</span><span class="nv"> </span><span class="s">github.ref</span><span class="nv"> </span><span class="s">}}"</span>

<span class="c1"># åŒä¸ª Concurrency Group å¦‚æœæœ‰æ–°çš„ Job ä¼šå–æ¶ˆæ­£åœ¨è·‘çš„</span>
<span class="c1"># ä¾‹å¦‚ é‡å¤è§¦å‘ç›¸åŒåˆ†æ”¯çš„æ‰“åŒ…ä»»åŠ¡ï¼Œä¼šå–æ¶ˆå‰ä¸€ä¸ªä»»åŠ¡</span>
<span class="na">concurrency</span><span class="pi">:</span>
  <span class="na">group</span><span class="pi">:</span> <span class="s">${{ github.workflow }}-${{ github.event_name }}-${{ github.ref }}</span>
  <span class="na">cancel-in-progress</span><span class="pi">:</span> <span class="kc">true</span>

<span class="c1"># è§¦å‘äº‹ä»¶</span>
<span class="na">on</span><span class="pi">:</span>
  <span class="c1"># æ‰‹åŠ¨è¡¨å•è§¦å‘</span>
  <span class="na">workflow_dispatch</span><span class="pi">:</span>
    <span class="c1"># è¡¨å• Inputs æ ä½</span>
    <span class="na">inputs</span><span class="pi">:</span>
      <span class="c1"># App ç‰ˆæœ¬å·</span>
      <span class="na">VERSION_NUMBER</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Version</span><span class="nv"> </span><span class="s">Number</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">app</span><span class="nv"> </span><span class="s">(e.g.,</span><span class="nv"> </span><span class="s">1.0.0).</span><span class="nv"> </span><span class="s">Auto-detect</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">Xcode</span><span class="nv"> </span><span class="s">project</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">left</span><span class="nv"> </span><span class="s">blank.'</span>
        <span class="na">required</span><span class="pi">:</span> <span class="kc">false</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
      <span class="c1"># App Build Number</span>
      <span class="na">BUILD_NUMBER</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Build</span><span class="nv"> </span><span class="s">number</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">app</span><span class="nv"> </span><span class="s">(e.g.,</span><span class="nv"> </span><span class="s">1).</span><span class="nv"> </span><span class="s">Will</span><span class="nv"> </span><span class="s">use</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">timestamp</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">left</span><span class="nv"> </span><span class="s">blank.'</span>
        <span class="na">required</span><span class="pi">:</span> <span class="kc">false</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
      <span class="c1"># App Release Note</span>
      <span class="na">RELEASE_NOTE</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Release</span><span class="nv"> </span><span class="s">notes</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">deployment.'</span>
        <span class="na">required</span><span class="pi">:</span> <span class="kc">false</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
  <span class="c1"># å…¶ä»– Workflow å‘¼å«æ­¤ Workflow è§¦å‘</span>
  <span class="c1"># Nightly Build ä¼šå‘¼å«ä½¿ç”¨</span>
  <span class="na">workflow_call</span><span class="pi">:</span>
    <span class="na">inputs</span><span class="pi">:</span>
      <span class="c1"># App ç‰ˆæœ¬å·</span>
      <span class="na">VERSION_NUMBER</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Version</span><span class="nv"> </span><span class="s">Number</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">app</span><span class="nv"> </span><span class="s">(e.g.,</span><span class="nv"> </span><span class="s">1.0.0).</span><span class="nv"> </span><span class="s">Auto-detect</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">Xcode</span><span class="nv"> </span><span class="s">project</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">left</span><span class="nv"> </span><span class="s">blank.'</span>
        <span class="na">required</span><span class="pi">:</span> <span class="kc">false</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
      <span class="c1"># App Build Number</span>
      <span class="na">BUILD_NUMBER</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Build</span><span class="nv"> </span><span class="s">number</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">app</span><span class="nv"> </span><span class="s">(e.g.,</span><span class="nv"> </span><span class="s">1).</span><span class="nv"> </span><span class="s">Will</span><span class="nv"> </span><span class="s">use</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">timestamp</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">left</span><span class="nv"> </span><span class="s">blank.'</span>
        <span class="na">required</span><span class="pi">:</span> <span class="kc">false</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
      <span class="c1"># App Release Note</span>
      <span class="na">RELEASE_NOTE</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Release</span><span class="nv"> </span><span class="s">notes</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">deployment.'</span>
        <span class="na">required</span><span class="pi">:</span> <span class="kc">false</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
      <span class="na">BRANCH</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Branch'</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>


<span class="c1"># å®šä¹‰å…¨åŸŸé™æ€å˜æ•°</span>
<span class="na">env</span><span class="pi">:</span>
  <span class="na">APP_STORE_CONNECT_API_KEY_FILE_NAME</span><span class="pi">:</span> <span class="s2">"</span><span class="s">app_store_connect_api_key.json"</span>

<span class="c1"># Job å·¥ä½œé¡¹ç›®</span>
<span class="c1"># Job ä¼šå¹¶å‘æ‰§è¡Œ</span>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="c1"># Job ID</span>
  <span class="na">deploy</span><span class="pi">:</span>
    <span class="c1"># Job åç§° (å¯çœç•¥ï¼Œæœ‰è®¾å®šåœ¨ Log æ˜¾ç¤ºæ¯”è¾ƒå¥½è¯»)</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">Deploy - Firebase App Distribution</span>
    
    <span class="c1"># Runner Label - ä½¿ç”¨ GitHub Hosted Runner macos-15 æ¥æ‰§è¡Œå·¥ä½œ</span>
    <span class="c1"># è¯·æ³¨æ„ï¼šå› ä¸ºæ­¤ä¸“æ¡ˆæ˜¯ Public Repo å¯ä»¥æ— é™å…è´¹ä½¿ç”¨</span>
    <span class="c1"># è¯·æ³¨æ„ï¼šå› ä¸ºæ­¤ä¸“æ¡ˆæ˜¯ Public Repo å¯ä»¥æ— é™å…è´¹ä½¿ç”¨</span>
    <span class="c1"># è¯·æ³¨æ„ï¼šå› ä¸ºæ­¤ä¸“æ¡ˆæ˜¯ Public Repo å¯ä»¥æ— é™å…è´¹ä½¿ç”¨</span>
    <span class="c1"># å¦‚æœæ˜¯ Private Repo éœ€è¦æŒ‰è®¡é‡æ”¶è´¹ï¼ŒmacOS æœºå™¨æ˜¯æœ€è´µçš„(10å€)ï¼Œå¯èƒ½è·‘ 10 æ¬¡å°±è¾¾åˆ° 2,000 åˆ†é’Ÿå…è´¹ä¸Šé™</span>
    <span class="c1"># å»ºè®®ä½¿ç”¨ self-hosted Runner</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">macos-15</span>

    <span class="c1"># è®¾å®šæœ€é•¿ Timeout æ—¶é—´ï¼Œé˜²æ­¢å¼‚å¸¸æƒ…å†µå‘ç”Ÿæ—¶æ— æ­¢å°½çš„ç­‰å¾…</span>
    <span class="na">timeout-minutes</span><span class="pi">:</span> <span class="m">30</span>

    <span class="c1"># use zsh</span>
    <span class="c1"># å¯çœç•¥ï¼Œåªæ˜¯æˆ‘ä¹ æƒ¯ç”¨ zshï¼Œé¢„è®¾æ˜¯ bash</span>
    <span class="na">defaults</span><span class="pi">:</span>
      <span class="na">run</span><span class="pi">:</span>
        <span class="na">shell</span><span class="pi">:</span> <span class="s">zsh {0}</span>

    <span class="c1"># å·¥ä½œæ­¥éª¤</span>
    <span class="c1"># å·¥ä½œæ­¥éª¤ä¼šç…§é¡ºåºæ‰§è¡Œ  </span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="c1"># git clone å½“å‰ä¸“æ¡ˆ &amp; checkout åˆ°æ‰§è¡Œçš„åˆ†æ”¯</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Checkout repository</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v3</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="c1"># Git Large File Storageï¼Œæˆ‘ä»¬çš„æµ‹è¯•ç¯å¢ƒç”¨ä¸åˆ°</span>
          <span class="c1"># default: false</span>
          <span class="na">lfs</span><span class="pi">:</span> <span class="kc">false</span>
          
          <span class="c1"># å¦‚æœæœ‰æŒ‡å®šåˆ™ Checkout æŒ‡å®šåˆ†æ”¯ï¼Œæ²¡æœ‰åˆ™ä½¿ç”¨é¢„è®¾(å½“å‰åˆ†æ”¯)</span>
          <span class="c1"># å›  on: schedule äº‹ä»¶åªèƒ½åœ¨ main ä¸»åˆ†æ”¯æ‰§è¡Œï¼Œå› æ­¤æƒ³åš Nightly Build ä¹‹ç±»çš„å·¥ä½œå°±éœ€è¦æŒ‡å®šåˆ†æ”¯</span>
          <span class="c1"># e.g. on: schedule -&gt; main åˆ†æ”¯ï¼ŒNightly Build master åˆ†æ”¯</span>
          <span class="na">ref</span><span class="pi">:</span> <span class="s">${{ github.event.inputs.BRANCH \\|\\| '' }}</span>

      <span class="c1"># ========== Certificates Steps ==========</span>
      
      <span class="c1"># å»ºè®®æ˜¯ä½¿ç”¨ Fastlnae - Match ç®¡ç†å¼€å‘å‡­è¯å¹¶åœ¨ Lane ä¸­ç›´æ¥æ‰§è¡Œ match å®‰è£…è®¾å®šå¥½</span>
      <span class="c1"># Match ä¼šç”¨å¦ä¸€ä¸ª Private Repo ç®¡ç†å‡­è¯ï¼Œä½†è¦è®¾å®šå¥½ SSH Agent æ‰æœ‰æƒé™ git clone private repo</span>
      <span class="c1"># ref: https://stackoverflow.com/questions/57612428/cloning-private-github-repository-within-organisation-in-actions</span>
      <span class="c1">#</span>
      <span class="c1">#</span>
      <span class="c1"># --- ä»¥ä¸‹æ˜¯æ²¡æœ‰ä½¿ç”¨ Fastlane - Match çš„æƒ…å†µä¸‹ç›´æ¥ä¸‹è½½ &amp; Import å‡­è¯ç»™ Runner çš„åšæ³• ---</span>
      <span class="c1"># ref: https://docs.github.com/en/actions/how-tos/use-cases-and-examples/deploying/installing-an-apple-certificate-on-macos-runners-for-xcode-development</span>
      <span class="c1">#</span>
      <span class="c1"># GitHub Actions Secret æ— æ³•å‚¨å­˜æ¡£æ¡ˆï¼Œå› æ­¤æ‰€æœ‰å‡­è¯æ¡£æ¡ˆéƒ½è¦å…ˆè½¬æˆ Base64 Encoded æ–‡å­—æ ¼å¼å­˜åœ¨ Secret</span>
      <span class="c1"># åœ¨ GitHub Actions Step ä¸­å†åŠ¨æ€è¯»å‡ºæ¥å†™å…¥ TEMP æ¡£æ¡ˆå¹¶ç§»åŠ¨åˆ°æ­£ç¡®ä½ç½®ç»™ç³»ç»Ÿè¯»å–ä½¿ç”¨</span>
      <span class="c1"># å…¶ä»–è®¾å®šç»†èŠ‚è¯·å‚è€ƒæ–‡ç« </span>
      <span class="c1">#</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install the Apple certificate and provisioning profile</span>
        <span class="na">env</span><span class="pi">:</span>
          <span class="na">BUILD_CERTIFICATE_BASE64</span><span class="pi">:</span> <span class="s">${{ secrets.BUILD_CERTIFICATE_BASE64 }}</span>
          <span class="na">P12_PASSWORD</span><span class="pi">:</span> <span class="s">${{ secrets.BUILD_CERTIFICATE_P12_PASSWORD }}</span>
          <span class="na">BUILD_PROVISION_PROFILE_BASE64</span><span class="pi">:</span> <span class="s">${{ secrets.BUILD_PROVISION_PROFILE_BASE64 }}</span>
          <span class="c1"># GitHub Hosted Runner ä¸ºè‡ªå®šä¹‰å­—ä¸²</span>
          <span class="c1"># Self-hosted Runner ä¸ºæœºå™¨ç™»å…¥å¯†ç </span>
          <span class="na">KEYCHAIN_PASSWORD</span><span class="pi">:</span> <span class="s">${{ secrets.KEYCHAIN_PASSWORD }}</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
          <span class="s"># create variables</span>
          <span class="s">CERTIFICATE_PATH=$RUNNER_TEMP/build_certificate.p12</span>
          <span class="s">PP_PATH=$RUNNER_TEMP/build_pp.mobileprovision</span>
          <span class="s">KEYCHAIN_PATH=$RUNNER_TEMP/app-signing.keychain-db</span>

          <span class="s"># import certificate and provisioning profile from secrets</span>
          <span class="s">echo -n "$BUILD_CERTIFICATE_BASE64" \\| base64 --decode -o $CERTIFICATE_PATH</span>
          <span class="s">echo -n "$BUILD_PROVISION_PROFILE_BASE64" \\| base64 --decode -o $PP_PATH</span>

          <span class="s"># create temporary keychain</span>
          <span class="s">security create-keychain -p "$KEYCHAIN_PASSWORD" $KEYCHAIN_PATH</span>
          <span class="s">security set-keychain-settings -lut 21600 $KEYCHAIN_PATH</span>
          <span class="s">security unlock-keychain -p "$KEYCHAIN_PASSWORD" $KEYCHAIN_PATH</span>

          <span class="s"># import certificate to keychain</span>
          <span class="s">security import $CERTIFICATE_PATH -P "$P12_PASSWORD" -A -t cert -f pkcs12 -k $KEYCHAIN_PATH</span>
          <span class="s">security set-key-partition-list -S apple-tool:,apple: -k "$KEYCHAIN_PASSWORD" $KEYCHAIN_PATH</span>
          <span class="s">security list-keychain -d user -s $KEYCHAIN_PATH</span>

          <span class="s"># apply provisioning profile</span>
          <span class="s">mkdir -p ~/Library/MobileDevice/Provisioning\ Profiles</span>
          <span class="s">cp $PP_PATH ~/Library/MobileDevice/Provisioning\ Profiles</span>

      <span class="c1"># App Store Connect API Fastlane JSON Key</span>
      <span class="c1"># å¦ä¸€ä¸ªåœ¨æ‰“åŒ…ç¯å¢ƒå‡ ä¹æ˜¯å¿…é¡»çš„ App Store Connect API Fastlane JSON Key (.json)</span>
      <span class="c1"># format: .json å†…å®¹æ ¼å¼ï¼šhttps://docs.fastlane.tools/app-store-connect-api/</span>
      <span class="c1"># é‡Œé¢åŒ…å« App Store Connect API .p8 Key</span>
      <span class="c1"># ä¼šåœ¨åç»­å¸¦ç»™ Fastlaneï¼Œç”¨äºä¸Šä¼ åˆ° Testflightã€App Store API ä½¿ç”¨</span>
      <span class="c1">#</span>
      <span class="c1"># GitHub Actions Secret æ— æ³•å‚¨å­˜æ¡£æ¡ˆï¼Œå› æ­¤æ‰€æœ‰å‡­è¯æ¡£æ¡ˆéƒ½è¦å…ˆè½¬æˆ Base64 Encoded æ–‡å­—æ ¼å¼å­˜åœ¨ Secret</span>
      <span class="c1"># åœ¨ GitHub Actions Step ä¸­å†åŠ¨æ€è¯»å‡ºæ¥å†™å…¥ TEMP æ¡£æ¡ˆä¾›å…¶ä»–æ­¥éª¤å¼•ç”¨ä½¿ç”¨</span>
      <span class="c1"># å…¶ä»–è®¾å®šç»†èŠ‚è¯·å‚è€ƒæ–‡ç« </span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Read and Write Apple Store Connect API Key to Temp</span>
        <span class="na">env</span><span class="pi">:</span>
          <span class="na">APP_STORE_CONNECT_API_KEY_BASE64</span><span class="pi">:</span> <span class="s">${{ secrets.APP_STORE_CONNECT_API_KEY_BASE64 }}</span>
          <span class="na">APP_STORE_CONNECT_API_KEY_PATH</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${{</span><span class="nv"> </span><span class="s">runner.temp</span><span class="nv"> </span><span class="s">}}/${{</span><span class="nv"> </span><span class="s">env.APP_STORE_CONNECT_API_KEY_FILE_NAME</span><span class="nv"> </span><span class="s">}}"</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
          <span class="s"># import certificate and provisioning profile from secrets</span>
          <span class="s">echo -n "$APP_STORE_CONNECT_API_KEY_BASE64" \\| base64 --decode -o $APP_STORE_CONNECT_API_KEY_PATH</span>

      <span class="c1"># ========== Env Setup Steps ==========</span>
      
      <span class="c1"># è¯»å–ä¸“æ¡ˆæŒ‡å®šçš„ XCode ç‰ˆæœ¬</span>
      <span class="c1"># åœ¨åç»­ä¹‹ä¸­ï¼Œæˆ‘ä»¬è‡ªå·±æ‰‹åŠ¨æŒ‡å®šä½¿ç”¨çš„ XCode_x.x.x.app</span>
      <span class="c1"># è€Œä¸ä½¿ç”¨ xcversionï¼Œå› ä¸º xcversion å·²ç» sunset ä¸ç¨³å®šã€‚ </span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Read .xcode-version</span>
        <span class="na">id</span><span class="pi">:</span> <span class="s">read_xcode_version</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
          <span class="s">XCODE_VERSION=$(cat .xcode-version)</span>
          <span class="s">echo "XCODE_VERSION</span><span class="err">:</span> <span class="s">${XCODE_VERSION}"</span>
          <span class="s">echo "xcode_version=${XCODE_VERSION}" &gt;&gt; $GITHUB_OUTPUT</span>

          <span class="s"># ä¹Ÿå¯ä»¥ç›´æ¥åœ¨è¿™æŒ‡å®šå…¨åŸŸ XCode ç‰ˆæœ¬ï¼Œè¿™æ ·å°±ä¸ç”¨åœ¨åç»­æ­¥éª¤æŒ‡å®š DEVELOPER_DIR</span>
          <span class="s"># ä½†æ­¤æŒ‡ä»¤éœ€è¦ sudoer æƒé™ï¼Œå¦‚æœæ˜¯ self-hosted runner å°±è¦ç¡®å®š runner æ‰§è¡Œç¯å¢ƒæœ‰ sudo æƒé™</span>
          <span class="s"># sudo xcode-select -s "/Applications/Xcode_${XCODE_VERSION}.app/Contents/Developer"</span>

      <span class="c1"># è¯»å–ä¸“æ¡ˆæŒ‡å®šçš„ Ruby ç‰ˆæœ¬</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Read .ruby-version</span>
        <span class="na">id</span><span class="pi">:</span> <span class="s">read_ruby_version</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
          <span class="s">RUBY_VERSION=$(cat .ruby-version)</span>
          <span class="s">echo "RUBY_VERSION</span><span class="err">:</span> <span class="s">${RUBY_VERSION}"</span>
          <span class="s">echo "ruby_version=${RUBY_VERSION}" &gt;&gt; $GITHUB_OUTPUT</span>

      <span class="c1"># å®‰è£…æˆ–è®¾å®š Runner Ruby ç‰ˆæœ¬æˆä¸“æ¡ˆæŒ‡å®šç‰ˆæœ¬</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Set up Ruby</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">ruby/setup-ruby@v1</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">ruby-version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${{</span><span class="nv"> </span><span class="s">steps.read_ruby_version.outputs.ruby_version</span><span class="nv"> </span><span class="s">}}"</span>

      <span class="c1"># å¯è®¾å¯ä¸è®¾ï¼ŒåŸå› æ˜¯ä¹‹å‰åœ¨ self-hosted èµ·å¤šä¸ª runner è·‘ CI/CD å› ä¸º cocoapods repos æ˜¯å…±ç”¨ç›®å½•</span>
      <span class="c1"># è§£å†³çš„é—®é¢˜æ˜¯ï¼šæœ‰å¾ˆå°çš„æœºç‡ä¼šå‡ºç°åœ¨åŒæ—¶ pod install æ—¶æ‹‰ cocoapods repos å‡ºç°å†²çª(å› ä¸ºé¢„è®¾éƒ½æ˜¯ç”¨) $HOME/.cocoapods/</span>
      <span class="c1"># GitHub Hosted Runner åˆ™ä¸éœ€æ­¤è®¾å®š</span>
      <span class="c1"># - name: Change Cocoapods Repos Folder</span>
      <span class="c1">#   if: contains(runner.labels, 'self-hosted')</span>
      <span class="c1">#   run: \\|</span>
      <span class="c1">#     # æ¯ä¸ª Runner ç”¨è‡ªå·±çš„ .cocoapods èµ„æ–™å¤¹ï¼Œé˜²æ­¢èµ„æºå†²çª</span>
      <span class="c1">#     mkdir -p "$HOME/.cocoapods-${{ env.RUNNER_NAME }}/"</span>
      <span class="c1">#     export CP_HOME_DIR="$HOME/.cocoapods-${{ env.RUNNER_NAME }}"</span>
      <span class="c1">#     rm -f "$HOME/.cocoapods-${{ env.RUNNER_NAME }}/repos/cocoapods/.git/index.lock"</span>

      <span class="c1"># ========== Cache Setting Steps ==========</span>
      <span class="c1"># è¯·æ³¨æ„ï¼Œå°±ç®—æ˜¯ self-hostedï¼ŒCache ç›®å‰ä¹Ÿæ˜¯ Cloud Cache ä¼šè®¡ç®—ç”¨é‡</span>
      <span class="c1"># è§„åˆ™ï¼š7 å¤©æœª hit è‡ªåŠ¨åˆ é™¤ã€å•ä¸ª Cache ä¸Šé™ 10 GBã€Action æˆåŠŸæ‰ä¼š Cache</span>
      <span class="c1"># Public Repo: å…è´¹æ— é™åˆ¶</span>
      <span class="c1"># Private Repo: 5 GB èµ·</span>
      <span class="c1"># Self-hosted å¯ä»¥è‡ªå·±ç”¨ shell script æ’°å†™ Cache &amp; Restore ç­–ç•¥æˆ–ä½¿ç”¨å…¶ä»–å·¥å…·ååŠ©</span>
      
      <span class="c1"># Bundle Cache (Gemfile)</span>
      <span class="c1"># å¯¹åº” Makefile ä¸­æˆ‘ä»¬æŒ‡å®šäº† Bundle  å®‰è£…è·¯å¾„ ./vendor ä¸‹</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Cache Bundle</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/cache@v3</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">path</span><span class="pi">:</span> <span class="s">\\|</span>
            <span class="s">./vendor</span>
          <span class="na">key</span><span class="pi">:</span> <span class="s">${{ runner.os }}-bundle-${{ hashFiles('Gemfile.lock') }}</span>
          <span class="na">restore-keys</span><span class="pi">:</span> <span class="s">\\|</span>
            <span class="s">${{ runner.os }}-bundle-</span>

      <span class="c1"># CocoaPods Cache (Podfile)</span>
      <span class="c1"># é»˜è®¤å°±æ˜¯ ä¸“æ¡ˆ/Pods ä¸‹</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Cache CocoaPods</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/cache@v3</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">path</span><span class="pi">:</span> <span class="s">\\|</span>
            <span class="s">./Product/Pods</span>
          <span class="na">key</span><span class="pi">:</span> <span class="s">${{ runner.os }}-cocoapods-${{ hashFiles('Product/Podfile.lock') }}</span>
          <span class="na">restore-keys</span><span class="pi">:</span> <span class="s">\\|</span>
            <span class="s">${{ runner.os }}-cocoapods-</span>

      <span class="c1"># Mint cache</span>
      <span class="c1"># å¯¹åº” Makefile ä¸­æˆ‘ä»¬æŒ‡å®šçš„ Mint å®‰è£…è·¯å¾„ ./mint ä¸‹</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Cache Mint</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/cache@v3</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">path</span><span class="pi">:</span> <span class="s">./mint</span>
          <span class="na">key</span><span class="pi">:</span> <span class="s">${{ runner.os }}-mint-${{ hashFiles('Mintfile') }}</span>
          <span class="na">restore-keys</span><span class="pi">:</span> <span class="s">\\|</span>
            <span class="s">${{ runner.os }}-mint-</span>

      <span class="c1"># ====================</span>

      <span class="c1"># ä¸“æ¡ˆ Setup &amp; ä¾èµ–å®‰è£…</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Setup &amp; Install Dependency</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
          <span class="s"># æ‰§è¡Œ Makefile ä¸­å°è£…çš„ Setup æŒ‡ä»¤ï¼Œå¯¹åº”æˆæŒ‡ä»¤å¤§æ¦‚æ˜¯ï¼š</span>
          <span class="s"># brew install mint</span>
          <span class="s"># bundle config set path 'vendor/bundle'</span>
          <span class="s"># bundle install</span>
          <span class="s"># mint bootstrap</span>
          <span class="s"># ...</span>
          <span class="s"># ç­‰ç­‰ setup æŒ‡ä»¤</span>
          <span class="s">make setup</span>

          <span class="s"># æ‰§è¡Œ Makefile ä¸­å°è£…çš„ Install æŒ‡ä»¤ï¼Œå¯¹åº”æˆæŒ‡ä»¤å¤§æ¦‚æ˜¯ï¼š</span>
          <span class="s"># mint run yonaskolb/XcodeGen --quiet</span>
          <span class="s"># bundle exec pod install</span>
          <span class="s"># ...</span>
          <span class="s"># ç­‰ç­‰ install æŒ‡ä»¤</span>
          <span class="s">make install</span>

      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Deploy Beta</span>
        <span class="na">id</span><span class="pi">:</span> <span class="s">deploy</span>
        <span class="c1"># æŒ‡å®šå·¥ä½œç›®å½•ï¼Œè¿™æ ·åç»­æŒ‡ä»¤å°±ä¸ç”¨åœ¨ç‰¹åˆ« cd ./Product/</span>
        <span class="na">working-directory</span><span class="pi">:</span> <span class="s">./Product/</span>
        <span class="na">env</span><span class="pi">:</span>
          <span class="c1"># æ‰“åŒ… Input å‚æ•°</span>
          <span class="na">VERSION_NUMBER</span><span class="pi">:</span> <span class="s">${{ inputs.VERSION_NUMBER \\|\\| '' }}</span>
          <span class="na">BUILD_NUMBER</span><span class="pi">:</span> <span class="s">${{ inputs.BUILD_NUMBER \\|\\| '' }}</span>
          <span class="na">RELEASE_NOTE</span><span class="pi">:</span> <span class="s">${{ inputs.RELEASE_NOTE \\|\\| '' }}</span>
          <span class="na">AUTHOR</span><span class="pi">:</span> <span class="s">${{ github.actor }}</span>

          <span class="c1"># Repo -&gt; Settings -&gt; Actions secrets and variables -&gt; secrets</span>
          <span class="c1"># Firebase CLI Token å¯†é’¥ (å–å¾—æ–¹å¼è¯·å‚è€ƒæ–‡ç« )</span>
          <span class="na">FIREBASE_CLI_TOKEN</span><span class="pi">:</span> <span class="s">${{ secrets.FIREBASE_CLI_TOKEN }}</span>
          <span class="c1"># Apple Developer Program Team ID</span>
          <span class="na">TEAM_ID</span><span class="pi">:</span> <span class="s">${{ secrets.TEAM_ID }}</span>
                    
          <span class="c1"># æŒ‡å®šè¿™ä¸ª Job è¦ä½¿ç”¨ XCode_x.x.x æŒ‡å®šçš„ç‰ˆæœ¬æ‰§è¡Œ</span>
          <span class="na">DEVELOPER_DIR</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/Applications/Xcode_${{</span><span class="nv"> </span><span class="s">steps.read_xcode_version.outputs.xcode_version</span><span class="nv"> </span><span class="s">}}.app/Contents/Developer"</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
          <span class="s"># å–å¾—å½“å‰ Timestamp</span>
          <span class="s">BUILD_TIMESTAMP=$(date +'%Y%m%d%H%M%S')</span>

          <span class="s"># å¦‚æœ BUILD_NUMBER æ²¡æœ‰å€¼ï¼Œç”¨ Timestamp å½“ App Build Number</span>
          <span class="s">BUILD_NUMBER="${BUILD_NUMBER:-$BUILD_TIMESTAMP}"</span>
  
          <span class="s">ID="${{ github.run_id }}"</span>
          <span class="s">COMMIT_SHA="${{ github.sha }}"</span>
          <span class="s">BRANCH_NAME="${{ github.ref_name }}"</span>
          <span class="s">AUTHOR="${{ env.AUTHOR }}"</span>

          <span class="s"># ç»„åˆ Release Note</span>
          <span class="s">RELEASE_NOTE="${{ env.RELEASE_NOTE }}</span>
          <span class="s">ID</span><span class="err">:</span> <span class="s">${ID}</span>
          <span class="s">Commit SHA</span><span class="err">:</span> <span class="s">${COMMIT_SHA}</span>
          <span class="s">Branch</span><span class="err">:</span> <span class="s">${BRANCH_NAME}</span>
          <span class="s">Author</span><span class="err">:</span> <span class="s">${AUTHOR}</span>
          <span class="s">"</span>

          <span class="s"># æ‰§è¡Œ Fastlane æ‰“åŒ…ï¼†éƒ¨ç½² Lane</span>
          <span class="s">bundle exec fastlane beta release_notes:"${RELEASE_NOTE}" version_number:"${VERSION_NUMBER}" build_number:"${BUILD_NUMBER}"</span>

      <span class="c1"># GitHub Actions å»ºè®®çš„ self-hosted å®‰å…¨æ€§è®¾å®šï¼š</span>
      <span class="c1"># ref: https://docs.github.com/en/actions/how-tos/use-cases-and-examples/deploying/installing-an-apple-certificate-on-macos-runners-for-xcode-development#required-clean-up-on-self-hosted-runners</span>
      <span class="c1"># å¯¹åº” Step: Install the Apple certificate and provisioning profile</span>
      <span class="c1"># ç”¨é€”æ˜¯åˆ é™¤æœºå™¨ä¸Šä¸‹è½½ä¸‹æ¥çš„é‡‘é’¥å‡­è¯</span>
      <span class="c1"># å¦‚æœä½ æ˜¯ç”¨ Match åˆ™éœ€è¦æ”¹å†™æˆ Match çš„ Clean</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Clean up keychain and provisioning profile</span>
        <span class="na">if</span><span class="pi">:</span> <span class="s">${{ always() &amp;&amp; contains(runner.labels, 'self-hosted') }}</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
          <span class="s">security delete-keychain $RUNNER_TEMP/app-signing.keychain-db</span>
          <span class="s">rm ~/Library/MobileDevice/Provisioning\ Profiles/build_pp.mobileprovision</span>
</pre></table></code></div></div><ul><li>è®°å¾—åˆ° Repo -&gt; Settings -&gt; Actions secrets and variables -&gt; secrets æ–°å¢ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">TEAM_ID</code> å˜æ•°ï¼Œå†…å®¹æ˜¯ Apple Developer Team ID å­—ä¸²ã€‚</ul><p><a href="/assets/4b001d2e8440/1*dxdmT_N_w_VUd56f6GRLSQ.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*dxdmT_N_w_VUd56f6GRLSQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTgxIiBoZWlnaHQ9IjQ5OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><strong>Commit æ¡£æ¡ˆåˆ° Repo ä¸»åˆ†æ”¯ï¼Œæµ‹è¯•çœ‹çœ‹æ‰“åŒ…åŠŸèƒ½ï¼š</strong></p><p><a href="/assets/4b001d2e8440/1*Z_UAfWAsJSIoWxeTRMvtDQ.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*Z_UAfWAsJSIoWxeTRMvtDQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDcyIiBoZWlnaHQ9IjY4NSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><blockquote><p><em>è¯·æ³¨æ„è‹¥å…¶ä»–åˆ†æ”¯è¦ä½¿ç”¨æ­¤ Action éœ€è¦å…ˆ Merge ä¸»åˆ†æ”¯çš„ CD-Deploy.yml æ¡£æ¡ˆã€‚</em></p></blockquote><p><strong>ç­‰å¾…ä»»åŠ¡è·‘å®Œï¼š</strong></p><p><a href="/assets/4b001d2e8440/1*Q-c2IUlJpssooiqcqcm_Bg.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*Q-c2IUlJpssooiqcqcm_Bg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMzg2IiBoZWlnaHQ9IjEyODgiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p><a href="/assets/4b001d2e8440/1*W8PBkatfsITMDFSlp7xpjg.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*W8PBkatfsITMDFSlp7xpjg.webp" alt="[Demo](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/actions/runs/16114046420){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9Ijk3NSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="https://github.com/ZhgChgLi/github-actions-ci-cd-demo/actions/runs/16114046420" target="_blank">Demo</a></p><blockquote><p><strong><em>æ‰“åŒ…ï¼‹éƒ¨ç½²æˆåŠŸ âœ…</em></strong></p></blockquote><p><strong>å®Œæ•´ç¨‹å¼ç ï¼š <a href="https://github.com/ZhgChgLi/github-actions-ci-cd-demo/blob/main/.github/workflows/CD-Deploy.yml" target="_blank">CD-Deploy.yml</a></strong></p><h4 id="æŠ€æœ¯ç»†èŠ‚--firebase-cli-token-å–å¾—è®¾å®š"><span class="me-2">æŠ€æœ¯ç»†èŠ‚ â€” Firebase CLI Token å–å¾—ï¼†è®¾å®š</span><a href="#æŠ€æœ¯ç»†èŠ‚--firebase-cli-token-å–å¾—è®¾å®š" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>æŒ‰ç…§ <a href="https://firebase.google.com/docs/cli?hl=zh-tw#install-cli-mac-linux" target="_blank">Firebase å®˜æ–¹æ–‡ä»¶æ­¥éª¤</a> ï¼š</p><p>å…ˆå®‰è£…å¥½ Firebase CLI å·¥å…·ï¼š</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl <span class="nt">-sL</span> https://firebase.tools <span class="se">\\</span>| bash
</pre></table></code></div></div><p>æ‰§è¡Œï¼š</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>firebase login:ci
</pre></table></code></div></div><p>å®Œæˆç™»å…¥ã€æˆæƒï¼š</p><p><a href="/assets/4b001d2e8440/1*Jex5aYzRSs7Trfx6z_e1Aw.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*Jex5aYzRSs7Trfx6z_e1Aw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDYzIiBoZWlnaHQ9IjcwMSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/4b001d2e8440/1*S-1ckn9WC6j0DIqZGSdUUg.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*S-1ckn9WC6j0DIqZGSdUUg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MjciIGhlaWdodD0iMjEzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>å›åˆ° Terminal å¤åˆ¶ Firebase CLI Token:</p><p><a href="/assets/4b001d2e8440/1*sa_h8L08JbeC2nA0kACQtQ.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*sa_h8L08JbeC2nA0kACQtQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2ODIiIGhlaWdodD0iNDgzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>åˆ° Repo â†’ Settings â†’ Secrets and variables â†’ Actions â†’ æ–°å¢ä¸€ä¸ª Secret: <code class="language-plaintext highlighter-rouge">FIREBASE_CLI_TOKEN</code> å¹¶è´´ä¸Š Firebase CLI Tokenã€‚</p><p><a href="/assets/4b001d2e8440/1*Lc6yGPu7L_0z6u1HH2PB5A.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*Lc6yGPu7L_0z6u1HH2PB5A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTcxIiBoZWlnaHQ9IjUxNSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><blockquote><p><strong><em>è¿™ä¸ª Token = ä½ çš„ç™»å…¥èº«ä»½</em></strong> <em>ï¼Œè¯·å¦¥å–„ä¿å­˜ï¼Œå¦‚æœå¸å·ç¦»èŒä¹Ÿéœ€è¦è¿›è¡Œæ›´æ¢ã€‚</em></p></blockquote><h4 id="æŠ€æœ¯ç»†èŠ‚--install-the-apple-certificate-and-provisioning-profile"><span class="me-2">æŠ€æœ¯ç»†èŠ‚ â€” Install the Apple certificate and provisioning profile</span><a href="#æŠ€æœ¯ç»†èŠ‚--install-the-apple-certificate-and-provisioning-profile" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>è¡¥å……å¼€å‘å‡­è¯æ±‡å…¥ Runner çš„æ­¥éª¤ç»†èŠ‚ã€‚</p><p>å›  GitHub Actions Secret æ— æ³•å‚¨å­˜æ¡£æ¡ˆï¼Œå› æ­¤æ‰€æœ‰å‡­è¯æ¡£æ¡ˆéƒ½è¦å…ˆè½¬æˆ Base64 Encoded æ–‡å­—æ ¼å¼å­˜åœ¨ Secretsï¼ŒGitHub Actions Step ä¸­å†åŠ¨æ€è¯»å‡ºæ¥å†™å…¥ TEMP æ¡£æ¡ˆå¹¶ç§»åŠ¨åˆ°æ­£ç¡®ä½ç½®ç»™ç³»ç»Ÿè¯»å–ä½¿ç”¨ã€‚</p><p><strong>æ‰“åŒ… Development éœ€è¦ä¸¤æŠŠé‡‘é’¥å‡­è¯ï¼š</strong></p><ul><li><p><a href="https://developer.apple.com/account/resources/certificates/list" target="_blank">Provision Profile ( .mobileprovision)</a></p><li><p><a href="https://developer.apple.com/account/resources/certificates/list" target="_blank">Development Certifcate ( .p12)</a></p></ul><p><a href="/assets/4b001d2e8440/1*WXqqnErto3nn8rnNg6TXgw.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*WXqqnErto3nn8rnNg6TXgw.webp" alt="cicd.mobileprovision" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTE3IiBoZWlnaHQ9IjYxNiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>cicd.mobileprovision</p><p><a href="/assets/4b001d2e8440/1*RkeZ1PkXeY9Nt1kSRJKEQw.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*RkeZ1PkXeY9Nt1kSRJKEQw.webp" alt="development.cer" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDc4IiBoZWlnaHQ9IjczOCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>development.cer</p><p>ä» <a href="https://developer.apple.com/account/resources/certificates/list" target="_blank">Apple Developer</a> ä¸­ä¸‹è½½çš„ Certificate æ˜¯ .cer æ ¼å¼ï¼Œè€Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ .p12 æ ¼å¼ï¼Œå¯ä»¥å…ˆæŠŠä¸‹è½½ä¸‹æ¥çš„ .cer ç‚¹ä¸¤ä¸‹å®‰è£…åˆ° Keychainï¼Œç„¶åæ‰“å¼€ Keychain é€‰æ‹©è¯¥å‡­è¯å³é”® Export æ±‡å‡ºã€‚</p><p><a href="/assets/4b001d2e8440/1*HJMxwM3IDjxT-UGqnoUtWw.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*HJMxwM3IDjxT-UGqnoUtWw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MjQiIGhlaWdodD0iNTI2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>æ¡£æ¡ˆåç§°ï¼šcicd.p12ã€æ ¼å¼ .p12</p><p>P12 é‡‘é’¥å¯†ç ï¼šè¾“å…¥ä¸€ç»„å®‰å…¨çš„è‡ªè®¢ä¹‰å­—ä¸² (èŒƒä¾‹æ˜¯ä¸å¥½çš„ç¤ºèŒƒï¼Œç”¨ <code class="language-plaintext highlighter-rouge">123456</code> )</p><p><a href="/assets/4b001d2e8440/1*tyH0XqDVPGPWFJPL4dxksw.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*tyH0XqDVPGPWFJPL4dxksw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NzIiIGhlaWdodD0iMzU2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/4b001d2e8440/1*qKeZWel3w_5wW7meMtHmLA.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*qKeZWel3w_5wW7meMtHmLA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NTYiIGhlaWdodD0iMzgxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><strong>ç°åœ¨ä¸¤ä¸ªæ¡£æ¡ˆï¼š</strong> cicd.p12ã€cicd.mobileprovision éƒ½å‡†å¤‡å¥½äº†</p><p><strong>è½¬æ¢æˆ BASE64 æ ¼å¼å­—ä¸²å¹¶å­˜åˆ° Repo Secretsï¼š</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">base64</span> <span class="nt">-i</span> cicd.mobileprovision <span class="se">\\</span>| pbcopy
</pre></table></code></div></div><p>åˆ° Repo â†’ Settings â†’ Secrets and variables â†’ Actions â†’ æ–°å¢ä¸€ä¸ª Secret: <code class="language-plaintext highlighter-rouge">BUILD_PROVISION_PROFILE_BASE64</code> å¹¶è´´ä¸Šä»¥ä¸Šå†…å®¹ã€‚</p><p>-</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">base64</span> <span class="nt">-i</span> cicd.p12 <span class="se">\\</span>| pbcopy
</pre></table></code></div></div><p>åˆ° Repo â†’ Settings â†’ Secrets and variables â†’ Actions â†’ æ–°å¢ä¸€ä¸ª Secret: <code class="language-plaintext highlighter-rouge">BUILD_CERTIFICATE_BASE64</code> å¹¶è´´ä¸Šä»¥ä¸Šå†…å®¹ã€‚</p><p>-</p><p>åˆ° Repo â†’ Settings â†’ Secrets and variables â†’ Actions â†’ æ–°å¢ä¸€ä¸ª Secret: <code class="language-plaintext highlighter-rouge">P12_PASSWORD</code> å†…å®¹æ˜¯åˆšæ±‡å‡º P12 é‡‘é’¥è®¾å®šçš„å¯†ç ã€‚</p><p>- åˆ° Repo â†’ Settings â†’ Secrets and variables â†’ Actions â†’ æ–°å¢ä¸€ä¸ª Secret: <code class="language-plaintext highlighter-rouge">KEYCHAIN_PASSWORD</code> ï¼š å¦‚æœæ˜¯ GitHub Hosted Runner åˆ™éšä¾¿è¾“å…¥ä¸€ä¸ªä»»æ„å­—ä¸²ï¼Œ <strong>å¦‚æœæ˜¯ Self-hosted Runner åˆ™ä¸º macOS Runner ä½¿ç”¨è€…çš„ç™»å…¥å¯†ç </strong> ã€‚</p><p><a href="/assets/4b001d2e8440/1*JZCkFUJCQsggqYtW8acjTw.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*JZCkFUJCQsggqYtW8acjTw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDg4IiBoZWlnaHQ9IjQ5MyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><h4 id="æŠ€æœ¯ç»†èŠ‚-app-store-connect-api-key"><span class="me-2">æŠ€æœ¯ç»†èŠ‚ â€”App Store Connect API Key</span><a href="#æŠ€æœ¯ç»†èŠ‚-app-store-connect-api-key" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Fastlane æ‰“åŒ…éƒ¨ç½²åˆ° App Store, Testflight <a href="https://docs.fastlane.tools/app-store-connect-api/" target="_blank">å¿…é¡»æä¾›çš„ .json é‡‘é’¥</a> ï¼ŒåŒæ ·å—é™ GitHub Actions Secrets åªèƒ½å­˜å­—ä¸²ä¸èƒ½å­˜æ¡£æ¡ˆï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿè¦æŠŠé‡‘é’¥å†…å®¹è½¬æˆ Base64 å­—ä¸²ï¼ŒGitHub Actions Step ä¸­å†åŠ¨æ€è¯»å‡ºæ¥å†™å…¥ TEMP æ¡£æ¡ˆå¹¶æŠŠæ¡£æ¡ˆè·¯å¾„ç»™ Fastlane å¼•ç”¨ä½¿ç”¨ã€‚</p><p><strong>é¦–å…ˆåˆ° <a href="/posts/zrealm-dev/zh-cn/app-store-connect-api-%E5%BF%AB%E9%80%9F%E8%AF%BB%E5%8F%96%E4%B8%8E%E7%AE%A1%E7%90%86-customer-reviews-%E6%8F%90%E5%8D%87-ios-app-%E8%AF%84%E4%BB%B7%E6%95%B4%E5%90%88%E6%95%88%E7%8E%87-f1365e51902c/">App Store Connect å»ºç«‹&amp;ä¸‹è½½å¥½ App Store Connect API Key</a> ( .p8) ï¼š</strong></p><pre><code class="language-vbnet">-----BEGIN PRIVATE KEY-----
sss
axzzvcxz
zxzvzcxv
vzxcvzxvczxcvz
-----END PRIVATE KEY-----
</code></pre><p>æ–°å¢ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">app_store_connect_api.json</code> æ¡£æ¡ˆ( <a href="https://docs.fastlane.tools/app-store-connect-api/" target="_blank">å†…å®¹å‚è€ƒ</a> )ï¼š</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="o">{</span>
  <span class="s2">"key_id"</span>: <span class="s2">"App Store Connect ä¸Šå†™çš„ Key ID"</span>,
  <span class="s2">"issuer_id"</span>: <span class="s2">"App Store Connect ä¸Šå†™çš„ Issuer ID"</span>,
  <span class="s2">"key"</span>: <span class="s2">"-----BEGIN PRIVATE KEY-----è®°å¾—æŠŠæ¢è¡Œæ”¹æˆ</span><span class="se">\n</span><span class="s2">-----END PRIVATE KEY-----"</span>,
  <span class="s2">"duration"</span>: 1200, <span class="c"># optional (maximum 1200)</span>
  <span class="s2">"in_house"</span>: <span class="nb">false</span> <span class="c"># optional but may be required if using match/sigh</span>
<span class="o">}</span>
</pre></table></code></div></div><p>å‚¨å­˜æ¡£æ¡ˆåæ‰§è¡Œï¼š</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">base64</span> <span class="nt">-i</span> app_store_connect_api.json <span class="se">\\</span>| pbcopy
</pre></table></code></div></div><p>å°†å­—ä¸²å†…å®¹è´´åˆ° Repo â†’ Settings â†’ Secrets and variables â†’ Actions â†’ æ–°å¢ä¸€ä¸ª Secret: <code class="language-plaintext highlighter-rouge">APP_STORE_CONNECT_API_KEY_BASE64</code> å¹¶è´´ä¸Šä»¥ä¸Šå†…å®¹ã€‚</p><p><a href="/assets/4b001d2e8440/1*QxRuxEPEfWbJ383hhnxGkA.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*QxRuxEPEfWbJ383hhnxGkA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTU5IiBoZWlnaHQ9IjU0OSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><code class="language-plaintext highlighter-rouge">Read and Write Apple Store Connect API Key to Temp</code> Step å®Œæˆä¹‹ååœ¨åç»­çš„ Step åªè¦ä¼ å…¥ env <code class="language-plaintext highlighter-rouge">APP_STORE_CONNECT_API_KEY_PATH</code> :</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Deploy</span>
  <span class="na">env</span><span class="pi">:</span>
    <span class="na">APP_STORE_CONNECT_API_KEY_PATH</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${{</span><span class="nv"> </span><span class="s">runner.temp</span><span class="nv"> </span><span class="s">}}/${{</span><span class="nv"> </span><span class="s">env.APP_STORE_CONNECT_API_KEY_FILE_NAME</span><span class="nv"> </span><span class="s">}}"</span>
  <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
    <span class="s">....</span>
</pre></table></code></div></div><p>Fastlane å°±èƒ½è‡ªåŠ¨å–å¾—ä½¿ç”¨ã€‚</p><h4 id="æŠ€æœ¯å»¶ä¼¸--reuse-action-workflow-æ‹†åˆ†æ‰“åŒ…å’Œéƒ¨ç½²åŠ¨ä½œ"><span class="me-2">æŠ€æœ¯å»¶ä¼¸ â€” Reuse Action Workflow æ‹†åˆ†æ‰“åŒ…å’Œéƒ¨ç½²åŠ¨ä½œ</span><a href="#æŠ€æœ¯å»¶ä¼¸--reuse-action-workflow-æ‹†åˆ†æ‰“åŒ…å’Œéƒ¨ç½²åŠ¨ä½œ" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ Fastlane <code class="language-plaintext highlighter-rouge">beta</code> Lane æ‰§è¡Œæ‰“åŒ…ï¼‹éƒ¨ç½²ä¸¤ä¸ªåŠ¨ä½œã€‚</p><p>åœ¨å®é™…æ¡ˆä¾‹ä¸­æˆ‘ä»¬å¯èƒ½éœ€è¦å°†åŒä¸€åŒ…æ‰“åŒ…ç»“æœåˆ†åˆ«éƒ¨ç½²åˆ°ä¸åŒå¹³å°ä¸Š(Firebase, Testflightâ€¦etc) å› æ­¤æ¯”è¾ƒå¥½çš„åšæ³•æ˜¯æ‰“åŒ…æ˜¯ä¸€ä¸ª Actionã€éƒ¨ç½²æ˜¯ä¸€ä¸ª Actionï¼Œä¸ç„¶ä¼šé‡å¤è·‘ä¸¤æ¬¡æ‰“åŒ…ï¼›è€Œä¸”ä¹Ÿæ›´ç¬¦åˆ CI/CD çš„æƒè´£åˆ’åˆ†ã€‚</p><blockquote><p><strong><em>ä»¥ä¸‹ä¸ºèŒƒä¾‹ä»‹ç»ï¼š</em></strong></p></blockquote><p><strong>CI-Build.yml:</strong></p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="na">name</span><span class="pi">:</span> <span class="s">Build</span>

<span class="na">on</span><span class="pi">:</span>
  <span class="na">push</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">main</span>
  <span class="na">workflow_call</span><span class="pi">:</span>
     <span class="na">inputs</span><span class="pi">:</span>
        <span class="na">RELEASE_NOTE</span><span class="pi">:</span>
          <span class="na">description</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Release</span><span class="nv"> </span><span class="s">notes</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">deployment.'</span>
          <span class="na">required</span><span class="pi">:</span> <span class="kc">false</span>
          <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build</span><span class="pi">:</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">macos-latest</span>

    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Checkout Code</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v4</span>

      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install Dependencies</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
          <span class="s">make steup</span>
          <span class="s">make instal</span>

      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Build Project</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">bundle exec fastlane build</span>

      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Upload Build Artifact</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/upload-artifact@v4</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">name</span><span class="pi">:</span> <span class="s">build-artifact</span>
          <span class="na">path</span><span class="pi">:</span> <span class="s">./fastlane/build/</span>
</pre></table></code></div></div><p><strong>CD-Deploy-Firebase.yml:</strong></p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="na">name</span><span class="pi">:</span> <span class="s">Deploy Firebase</span>

<span class="na">on</span><span class="pi">:</span>
  <span class="c1"># å½“ Build Action å®Œæˆæ—¶è‡ªåŠ¨è§¦å‘æ‰§è¡Œ</span>
  <span class="na">workflow_run</span><span class="pi">:</span>
    <span class="na">workflows</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">Build"</span><span class="pi">]</span>
    <span class="na">types</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">completed</span>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">deploy</span><span class="pi">:</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="c1"># å®Œæˆï¼‹æ‰§è¡ŒæˆåŠŸæ‰æ‰§è¡Œéƒ¨ç½²</span>
    <span class="na">if</span><span class="pi">:</span> <span class="s">${{ github.event.workflow_run.conclusion == 'success' }}</span>

    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Checkout Code</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v4</span>

      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install Dependencies</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
          <span class="s">make steup</span>

      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Download Build Artifact</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/download-artifact@v4</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">name</span><span class="pi">:</span> <span class="s">build-artifact</span>
          <span class="na">path</span><span class="pi">:</span> <span class="s">./fastlane/build/</span>

      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Deploy to Production</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
          <span class="s">bundle exec fastlane deploy-firebase</span>
</pre></table></code></div></div><p><strong>CD-Deploy-Testflight.yml:</strong></p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="na">name</span><span class="pi">:</span> <span class="s">Deploy Testflight</span>

<span class="na">on</span><span class="pi">:</span>
  <span class="c1"># å½“ Build Action å®Œæˆæ—¶è‡ªåŠ¨è§¦å‘æ‰§è¡Œ</span>
  <span class="na">workflow_run</span><span class="pi">:</span>
    <span class="na">workflows</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">Build"</span><span class="pi">]</span>
    <span class="na">types</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">completed</span>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">deploy</span><span class="pi">:</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="c1"># å®Œæˆï¼‹æ‰§è¡ŒæˆåŠŸæ‰æ‰§è¡Œéƒ¨ç½²</span>
    <span class="na">if</span><span class="pi">:</span> <span class="s">${{ github.event.workflow_run.conclusion == 'success' }}</span>

    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Checkout Code</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v4</span>

      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install Dependencies</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
          <span class="s">make steup</span>

      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Download Build Artifact</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/download-artifact@v4</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">name</span><span class="pi">:</span> <span class="s">build-artifact</span>
          <span class="na">path</span><span class="pi">:</span> <span class="s">./fastlane/build/</span>

      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Deploy to Production</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
          <span class="s">bundle exec fastlane deploy-testflight</span>
</pre></table></code></div></div><p><strong>å¦å¤–ä¹Ÿå¯ä»¥ç”¨ <a href="https://docs.github.com/en/actions/how-tos/sharing-automations/reusing-workflows" target="_blank">Reusing Workflow</a> :</strong></p><p><strong>CD-Deploy-Firebase.yml:</strong></p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="na">name</span><span class="pi">:</span> <span class="s">Deploy Firebase</span>

<span class="na">on</span><span class="pi">:</span>
  <span class="c1"># ä»»æ„çš„è§¦å‘æ¡ä»¶ï¼Œè¿™é‡Œä»¥æ‰‹åŠ¨è¡¨å•è§¦å‘ä¸ºä¾‹</span>
  <span class="na">workflow_dispatch</span><span class="pi">:</span>
    <span class="na">inputs</span><span class="pi">:</span>
      <span class="na">RELEASE_NOTE</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Release</span><span class="nv"> </span><span class="s">notes</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">deployment.'</span>
        <span class="na">required</span><span class="pi">:</span> <span class="kc">false</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build</span><span class="pi">:</span>
    <span class="na">needs</span><span class="pi">:</span> <span class="s">Build</span>
    <span class="na">uses</span><span class="pi">:</span> <span class="s">./.github/workflows/CD-Build.yml</span>
    <span class="na">secrets</span><span class="pi">:</span> <span class="s">inherit</span>
    <span class="na">with</span><span class="pi">:</span>
      <span class="na">RELEASE_NOTE</span><span class="pi">:</span> <span class="s">${{ inputs.RELEASE_NOTE }}</span>

  <span class="na">deploy</span><span class="pi">:</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="c1"># Job é¢„è®¾æ˜¯å¹¶å‘æ‰§è¡Œï¼Œç”¨ needs é™åˆ¶éœ€ç­‰å¾… build å®Œæˆæ‰æ‰§è¡Œ</span>
    <span class="na">needs</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">build</span><span class="pi">]</span>
    <span class="c1"># æ‰§è¡ŒæˆåŠŸï¼Œæ‰éƒ¨ç½²</span>
    <span class="na">if</span><span class="pi">:</span> <span class="s">${{ always() &amp;&amp; needs.deploy.result == 'success' }}</span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Checkout Code</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v4</span>

      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install Dependencies</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
          <span class="s">make steup</span>

      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Download Build Artifact</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/download-artifact@v4</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">name</span><span class="pi">:</span> <span class="s">build-artifact</span>
          <span class="na">path</span><span class="pi">:</span> <span class="s">./fastlane/build/</span>

      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Deploy to Production</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
          <span class="s">bundle exec fastlane deploy-firebase</span>
</pre></table></code></div></div><h4 id="github-actions--artifact"><span class="me-2">GitHub Actions â€” Artifact</span><a href="#github-actions--artifact" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>åŒ Cacheï¼Œç›®å‰ <strong>å°±ç®—æ˜¯ Self-hosted Runner Artifcact åŠŸèƒ½ä¾ç„¶ä¼šèµ° GitHub Cloud</strong> å—åˆ°ä½¿ç”¨é‡é™åˆ¶ ( <a href="https://docs.github.com/en/billing/managing-billing-for-your-products/about-billing-for-github-actions#included-storage-and-minutes" target="_blank">å…è´¹å¸å· 500MB èµ·</a> )ã€‚</p><blockquote><p><em>Self-hosted Runner è¦è¾¾åˆ°ç±»ä¼¼çš„æ•ˆæœå¯ä»¥è‡ªè¡Œå»ºç«‹å…±äº«ä¸»æœºç›®å½•æˆ–æ‰¾å…¶ä»–å·¥å…·æ›¿ä»£ã€‚</em></p></blockquote><p>å› æ­¤ç›®å‰ Artifact å®é™…æˆ‘åªç”¨æ¥å­˜æ”¾å°èµ„æ–™ï¼Œä¾‹å¦‚ Snapshot Tests çš„é”™è¯¯ç»“æœã€æµ‹è¯•æŠ¥å‘Šâ€¦ç­‰ç­‰</p><h3 id="ci-nightly-build-æ‰§è¡Œå¿«ç…§å•å…ƒæµ‹è¯•æ‰“åŒ…cd-éƒ¨ç½²åˆ°-firebase-app-distribution"><span class="me-2">CIâ€” Nightly Build æ‰§è¡Œå¿«ç…§+å•å…ƒæµ‹è¯•+æ‰“åŒ…+CD éƒ¨ç½²åˆ° Firebase App Distribution</span><a href="#ci-nightly-build-æ‰§è¡Œå¿«ç…§å•å…ƒæµ‹è¯•æ‰“åŒ…cd-éƒ¨ç½²åˆ°-firebase-app-distribution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="æµç¨‹-2"><span class="me-2">æµç¨‹</span><a href="#æµç¨‹-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>æ¯å¤©å‡Œæ™¨ 3 ç‚¹è‡ªåŠ¨é’ˆå¯¹ main(develop or master) åˆ†æ”¯è·‘å…¨éƒ¨æµ‹è¯•(unit+snapshot tests)ï¼Œå¦‚æœå¤±è´¥åˆ™ä¼ é€å¤±è´¥é€šçŸ¥åˆ° Slack å·¥ä½œç¾¤ç»„ï¼›å¦‚æœæˆåŠŸåˆ™æ‰“åŒ…+éƒ¨ç½²ä¸€ä¸ªç‰ˆæœ¬åˆ° Firebase App Disturbutionï¼Œæ‰“åŒ…æˆåŠŸ/å¤±è´¥éƒ½ä¼šä¼ é€ Slack é€šçŸ¥ã€‚</p><h4 id="ci-nightly-build-and-deployyml"><span class="me-2">CI-Nightly-Build-And-Deploy.yml</span><a href="#ci-nightly-build-and-deployyml" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Repo â†’ Actions â†’ New workflow â†’ set up a workflow yourselfã€‚</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
</pre><td class="rouge-code"><pre><span class="c1"># Workflow(Action) åç§°</span>
<span class="na">name</span><span class="pi">:</span> <span class="s">CI-Nightly Build And Deploy</span>

<span class="c1"># Actions Log çš„æ ‡é¢˜åç§°</span>
<span class="na">run-name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">[CI-Nightly</span><span class="nv"> </span><span class="s">Build</span><span class="nv"> </span><span class="s">And</span><span class="nv"> </span><span class="s">Deploy]</span><span class="nv"> </span><span class="s">${{</span><span class="nv"> </span><span class="s">github.ref</span><span class="nv"> </span><span class="s">}}"</span>

<span class="c1"># è§¦å‘äº‹ä»¶</span>
<span class="na">on</span><span class="pi">:</span>
  <span class="c1"># æ’ç¨‹å®šæ—¶è‡ªåŠ¨æ‰§è¡Œ</span>
  <span class="c1"># https://crontab.guru/</span>
  <span class="c1"># UTC æ—¶é—´</span>
  <span class="na">schedule</span><span class="pi">:</span>
    <span class="c1"># UTC çš„ 19:00 = æ¯å¤© UTC+8 çš„ 03:00</span>
    <span class="pi">-</span> <span class="na">cron</span><span class="pi">:</span> <span class="s1">'</span><span class="s">0</span><span class="nv"> </span><span class="s">19</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*'</span>
  <span class="c1"># æ‰‹åŠ¨è§¦å‘</span>
  <span class="na">workflow_dispatch</span><span class="pi">:</span>

<span class="c1"># Job å·¥ä½œé¡¹ç›®</span>
<span class="c1"># Job ä¼šå¹¶å‘æ‰§è¡Œ</span>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="c1"># æµ‹è¯•å·¥ä½œ</span>
  <span class="na">testing</span><span class="pi">:</span>
    <span class="c1"># Reuse Workflow (workflow_call)</span>
    <span class="na">uses</span><span class="pi">:</span> <span class="s">./.github/workflows/CI-Testing.yml</span>
    <span class="c1"># ä¼ é€’æ‰€æœ‰ Secrets ç»™ CD-Testing.yml</span>
    <span class="na">secrets</span><span class="pi">:</span> <span class="s">inherit</span>
    <span class="na">with</span><span class="pi">:</span>
      <span class="c1"># æ‰§è¡Œå…¨éƒ¨æµ‹è¯•</span>
      <span class="na">TEST_LANE</span><span class="pi">:</span> <span class="s2">"</span><span class="s">run_all_tests"</span>
      <span class="c1"># ç›®æ ‡åˆ†æ”¯ï¼šmain, develop or master...etc</span>
      <span class="na">BRANCH</span><span class="pi">:</span> <span class="s2">"</span><span class="s">main"</span>

  <span class="na">deploy-env</span><span class="pi">:</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">outputs</span><span class="pi">:</span>
      <span class="na">DATE_STRING</span><span class="pi">:</span> <span class="s">${{ steps.get_date.outputs.DATE_STRING }}</span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Get Date String</span>
        <span class="na">id</span><span class="pi">:</span> <span class="s">get_date</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
          <span class="s">VERSION_DATE=$(date -u '+%Y%m%d')</span>
          <span class="s">echo "${VERSION_DATE}"</span>
          <span class="s">echo "DATE_STRING=${VERSION_DATE}" &gt;&gt; $GITHUB_ENV</span>
          <span class="s">echo "DATE_STRING=${VERSION_DATE}" &gt;&gt; $GITHUB_OUTPUT</span>
    
  <span class="na">deploy</span><span class="pi">:</span>
    <span class="c1"># Job é¢„è®¾æ˜¯å¹¶å‘æ‰§è¡Œï¼Œç”¨ needs é™åˆ¶éœ€ç­‰å¾… testing å’Œ deploy-env å®Œæˆæ‰æ‰§è¡Œ</span>
    <span class="na">needs</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">testing</span><span class="pi">,</span> <span class="nv">deploy-env</span><span class="pi">]</span>
    <span class="c1"># å¦‚æœæµ‹è¯•æˆåŠŸæ‰æ‰§è¡Œ</span>
    <span class="na">if</span><span class="pi">:</span> <span class="s">${{ needs.testing.result == 'success' }}</span>
    <span class="c1"># Reuse Workflow (workflow_call)</span>
    <span class="na">uses</span><span class="pi">:</span> <span class="s">./.github/workflows/CD-Deploy.yml</span>
    <span class="c1"># ä¼ é€’æ‰€æœ‰ Secrets ç»™ CD-Deploy.yml</span>
    <span class="na">secrets</span><span class="pi">:</span> <span class="s">inherit</span>
    <span class="na">with</span><span class="pi">:</span>
      <span class="na">VERSION_NUMBER</span><span class="pi">:</span> <span class="s">NightlyBuild-${{ needs.deploy-env.outputs.DATE_STRING }}</span>
      <span class="na">RELEASE_NOTE</span><span class="pi">:</span> <span class="s">NightlyBuild-${{ needs.deploy-env.outputs.DATE_STRING }}</span>
      <span class="c1"># ç›®æ ‡åˆ†æ”¯ï¼šmain, develop or master...etc</span>
      <span class="na">BRANCH</span><span class="pi">:</span> <span class="s2">"</span><span class="s">main"</span>

<span class="c1"># ----- Slack Notify -----</span>
  <span class="na">testing-failed-slack-notify</span><span class="pi">:</span>
    <span class="na">needs</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">testing</span><span class="pi">]</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">if</span><span class="pi">:</span> <span class="s">${{ needs.testing.result == 'failure' }}</span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Post text to a Slack channel</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">slackapi/slack-github-action@v2.1.0</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">method</span><span class="pi">:</span> <span class="s">chat.postMessage</span>
          <span class="na">token</span><span class="pi">:</span> <span class="s">${{ secrets.SLACK_BOT_TOKEN }}</span>
          <span class="na">payload</span><span class="pi">:</span> <span class="s">\\|</span>
            <span class="s">channel</span><span class="err">:</span> <span class="s">${{ vars.SLACK_TEAM_CHANNEL_ID }}</span>
            <span class="s">text</span><span class="err">:</span> <span class="s2">"</span><span class="s">:x:</span><span class="nv"> </span><span class="s">Nightly</span><span class="nv"> </span><span class="s">Build</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Testing</span><span class="nv"> </span><span class="s">å¤±è´¥</span><span class="se">\n</span><span class="s">Workflow:</span><span class="nv"> </span><span class="s">&lt;${{</span><span class="nv"> </span><span class="s">github.server_url</span><span class="nv"> </span><span class="s">}}/${{</span><span class="nv"> </span><span class="s">github.repository</span><span class="nv"> </span><span class="s">}}/actions/runs/${{</span><span class="nv"> </span><span class="s">github.run_id</span><span class="nv"> </span><span class="s">}}</span><span class="se">\\</span><span class="s">|View</span><span class="nv"> </span><span class="s">Run&gt;"</span>

  <span class="na">deploy-failed-slack-notify</span><span class="pi">:</span>
    <span class="na">needs</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">deploy</span><span class="pi">]</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">if</span><span class="pi">:</span> <span class="s">${{ needs.deploy.result == 'failure' }}</span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Post text to a Slack channel</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">slackapi/slack-github-action@v2.1.0</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">method</span><span class="pi">:</span> <span class="s">chat.postMessage</span>
          <span class="na">token</span><span class="pi">:</span> <span class="s">${{ secrets.SLACK_BOT_TOKEN }}</span>
          <span class="na">payload</span><span class="pi">:</span> <span class="s">\\|</span>
            <span class="s">channel</span><span class="err">:</span> <span class="s">${{ vars.SLACK_TEAM_CHANNEL_ID }}</span>
            <span class="s">text</span><span class="err">:</span> <span class="s2">"</span><span class="s">:x:</span><span class="nv"> </span><span class="s">Nightly</span><span class="nv"> </span><span class="s">Build</span><span class="nv"> </span><span class="s">Deploy</span><span class="nv"> </span><span class="s">å¤±è´¥</span><span class="se">\n</span><span class="s">Workflow:</span><span class="nv"> </span><span class="s">&lt;${{</span><span class="nv"> </span><span class="s">github.server_url</span><span class="nv"> </span><span class="s">}}/${{</span><span class="nv"> </span><span class="s">github.repository</span><span class="nv"> </span><span class="s">}}/actions/runs/${{</span><span class="nv"> </span><span class="s">github.run_id</span><span class="nv"> </span><span class="s">}}</span><span class="se">\\</span><span class="s">|View</span><span class="nv"> </span><span class="s">Run&gt;"</span>

  <span class="na">deploy-success-slack-notify</span><span class="pi">:</span>
    <span class="na">needs</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">deploy</span><span class="pi">]</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">if</span><span class="pi">:</span> <span class="s">${{ needs.deploy.result == 'success' }}</span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Post text to a Slack channel</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">slackapi/slack-github-action@v2.1.0</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">method</span><span class="pi">:</span> <span class="s">chat.postMessage</span>
          <span class="na">token</span><span class="pi">:</span> <span class="s">${{ secrets.SLACK_BOT_TOKEN }}</span>
          <span class="na">payload</span><span class="pi">:</span> <span class="s">\\|</span>
            <span class="s">channel</span><span class="err">:</span> <span class="s">${{ vars.SLACK_TEAM_CHANNEL_ID }}</span>
            <span class="s">text</span><span class="err">:</span> <span class="s2">"</span><span class="s">:white_check_mark:</span><span class="nv"> </span><span class="s">Nightly</span><span class="nv"> </span><span class="s">Build</span><span class="nv"> </span><span class="s">Deploy</span><span class="nv"> </span><span class="s">æˆåŠŸ</span><span class="se">\n</span><span class="s">Workflow:</span><span class="nv"> </span><span class="s">&lt;${{</span><span class="nv"> </span><span class="s">github.server_url</span><span class="nv"> </span><span class="s">}}/${{</span><span class="nv"> </span><span class="s">github.repository</span><span class="nv"> </span><span class="s">}}/actions/runs/${{</span><span class="nv"> </span><span class="s">github.run_id</span><span class="nv"> </span><span class="s">}}</span><span class="se">\\</span><span class="s">|View</span><span class="nv"> </span><span class="s">Run&gt;"</span>
</pre></table></code></div></div><p><strong>Commit æ¡£æ¡ˆåˆ° Repo ä¸»åˆ†æ”¯ï¼Œæ‰‹åŠ¨è§¦å‘æµ‹è¯•ã€æ‰“åŒ…åŠŸèƒ½çœ‹çœ‹ç»“æœï¼š</strong></p><p><a href="/assets/4b001d2e8440/1*l71fL8oLoeAv-JX_FgkqzQ.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*l71fL8oLoeAv-JX_FgkqzQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjU2NCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><blockquote><p><em>æ—¥åä¼šæ¯æ—¥è‡ªåŠ¨è§¦å‘ã€‚</em></p></blockquote><p><a href="/assets/4b001d2e8440/1*u6A77KwkXS2SY5-DPPPR9A.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*u6A77KwkXS2SY5-DPPPR9A.webp" alt="[Demo](https://github.com/ZhgChgLi/github-actions-ci-cd-demo/actions/runs/16119750747){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMzczIiBoZWlnaHQ9IjkxOCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="https://github.com/ZhgChgLi/github-actions-ci-cd-demo/actions/runs/16119750747" target="_blank">Demo</a></p><p><a href="/assets/4b001d2e8440/1*6DQL_v4eahSqSuVJZRPrEA.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*6DQL_v4eahSqSuVJZRPrEA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMTAiIGhlaWdodD0iOTIiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>ç­‰å¾…æµ‹è¯•ä»»åŠ¡ã€æ‰“åŒ…éƒ¨ç½²ä»»åŠ¡ã€é€šçŸ¥ä»»åŠ¡éƒ½å®Œæˆåï¼ŒæŸ¥çœ‹ç»“æœã€‚</p><p><a href="/assets/4b001d2e8440/1*4UVgyCQljqZQgzxHpXPB4g.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*4UVgyCQljqZQgzxHpXPB4g.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MDMiIGhlaWdodD0iOTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/4b001d2e8440/1*t9PrQfcTANyvG7gfXXC-bw.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*t9PrQfcTANyvG7gfXXC-bw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NTQiIGhlaWdodD0iMTIwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>æˆ‘ä»¬å°±èƒ½ç›´æ¥åœ¨æ‰‹æœºä¸Šå®‰è£… Nightly Build ç‰ˆæœ¬æ¥è¿›è¡ŒæŠ¢å…ˆä½“éªŒæµ‹è¯•ã€‚</p><h4 id="æŠ€æœ¯ç»†èŠ‚"><span class="me-2">æŠ€æœ¯ç»†èŠ‚</span><a href="#æŠ€æœ¯ç»†èŠ‚" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>è¿™ä¸ª Action æˆ‘ä»¬ç›´æ¥å¤ç”¨å‰é¢è®¾è®¡çš„ CI-Testing å’Œ CD-Deployï¼Œç»„åˆæˆæˆ‘ä»¬çš„ Nightly Buildï¼Œéå¸¸å¼¹æ€§å¥½ç”¨ï¼</p><p><strong>å®Œæ•´ç¨‹å¼ç ï¼š <a href="https://github.com/ZhgChgLi/github-actions-ci-cd-demo/actions/workflows/CI-Nightly-Build-And-Deploy.yml" target="_blank">CI-Nightly-Build-And-Deploy.yml</a></strong></p><h3 id="self-hosted-runner-æ³¨æ„äº‹é¡¹"><span class="me-2">Self-hosted Runner æ³¨æ„äº‹é¡¹</span><a href="#self-hosted-runner-æ³¨æ„äº‹é¡¹" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>æœ¬æ–‡æ˜¯ Public Repo å› æ­¤ç›´æ¥ä½¿ç”¨ GitHub Hosted çš„ macOS Runnerï¼Œä½†åœ¨å®é™…å·¥ä½œä¸Šæˆ‘ä»¬çš„ Repo ä¸€å®šæ˜¯ Privateï¼Œç›´æ¥ä½¿ç”¨ GitHub Hosted Runner è¶…è´µä¸åˆ’ç®—(çº¦ä¸€ä¸ªæœˆå°±èƒ½ä¹°ä¸€å° Mac Mini æ”¾åœ¨å…¬å¸åƒåˆ°é¥±çˆ½çˆ½è·‘)ï¼Œæ¯ä¸€å°ä¾ç…§æ•ˆèƒ½å¯ä»¥èµ·å¤šä¸ª Runner åŒæ—¶å¹¶å‘æ¥ä»»åŠ¡æ¥åšã€‚</p><blockquote><p><strong><em>ç»†èŠ‚å¯å‚è€ƒ <a href="/posts/zrealm-dev/zh-cn/github-actions-self-hosted-runner-%E8%AF%A6%E8%A7%A3%E4%B8%8E%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B-ci-cd-%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%E5%BB%BA%E7%BD%AE-404bd5c70040/">ä¸Šä¸€ç¯‡</a> ã€Œ <a href="/posts/zrealm-dev/zh-cn/github-actions-self-hosted-runner-%E8%AF%A6%E8%A7%A3%E4%B8%8E%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B-ci-cd-%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%E5%BB%BA%E7%BD%AE-404bd5c70040/">Self-hosted Runner å»ºç½®ä¸æ”¹ç”¨</a> ã€éƒ¨åˆ†</em></strong> <em>ï¼Œåœ¨æœ¬åœ°ç”µè„‘å®‰è£…å¥½ XCode è·ŸåŸºæœ¬ç¯å¢ƒåæ³¨å†Œã€å¯ç”¨ Runnerã€Action Worflow YAML ä¸­æŠŠ <code class="language-plaintext highlighter-rouge">runs-on</code> æ”¹æˆ <code class="language-plaintext highlighter-rouge">[self-hosted]</code> å³å¯ã€‚</em></p></blockquote><p>å¤šä¸ª Runner åœ¨åŒä¸€å°ç”µè„‘çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¤šåŠå·²åœ¨ä¸Šé¢çš„ Actions é‡Œè§£å†³äº†ï¼Œä¾‹å¦‚æŠŠæ‰€æœ‰ä¾èµ–çš„å…±ç”¨ç›®å½•éƒ½æ”¹æˆæœ¬åœ°ç›®å½•ï¼Œè¿˜æœ‰ä¸€ä¸ªæµ‹è¯•ä¼šé‡åˆ°çš„é—®é¢˜è¦è§£å†³ï¼Œå°±æ˜¯æŠ¢æ¨¡æ‹Ÿå™¨é—®é¢˜ï¼šã€Œ <strong>å½“ä¸¤ä¸ªæµ‹è¯• Job è¢«ä¸¤ä¸ª Runner åœ¨åŒä¸€å°æœºå™¨ä¸ŠåŒæ—¶æ£€æ¥åšï¼Œå¦‚æœæŒ‡å®šåŒä¸ªæ¨¡æ‹Ÿå™¨å°±ä¼šäº’ç›¸å¹²æ‰°å¯¼è‡´æµ‹è¯•å¤±è´¥ã€‚ã€</strong></p><p>è§£å†³æ–¹æ³•ä¹Ÿå¾ˆå®¹æ˜“ï¼Œå°±æ˜¯ä¸ºä¸ªåˆ« Runner éƒ½è®¾å®šä¸€å°æ¨¡æ‹Ÿå™¨ã€‚</p><h4 id="å¤šä¸ª-runner-åœ¨åŒå°æœºå™¨çš„æ¨¡æ‹Ÿå™¨è®¾å®š"><span class="me-2">å¤šä¸ª Runner åœ¨åŒå°æœºå™¨çš„æ¨¡æ‹Ÿå™¨è®¾å®š</span><a href="#å¤šä¸ª-runner-åœ¨åŒå°æœºå™¨çš„æ¨¡æ‹Ÿå™¨è®¾å®š" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>å‡è®¾æˆ‘ <strong>åŒä¸€å°ç”µè„‘ä¸Šæœ‰ä¸¤ä¸ª Runner</strong> åœ¨å¹¶è¡Œæ¥æ”¶ä»»åŠ¡ï¼š</p><ul><li><p><code class="language-plaintext highlighter-rouge">ZhgChgLideMacBook-Pro-Runner-A</code></p><li><p><code class="language-plaintext highlighter-rouge">ZhgChgLideMacBook-Pro-Runner-B</code></p></ul><p><a href="/assets/4b001d2e8440/1*3ptg9Tl5fBbEIYB4kgh0kw.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*3ptg9Tl5fBbEIYB4kgh0kw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MTkiIGhlaWdodD0iMzMzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>åœ¨ XCode æ¨¡æ‹Ÿå™¨è®¾å®šæˆ‘ä»¬å°±éœ€è¦æ–°å¢ä¸¤ä¸ªæ¨¡æ‹Ÿå™¨ï¼š</p><p><a href="/assets/4b001d2e8440/1*k9bR2C12Wk11HAKKiYJ2zg.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*k9bR2C12Wk11HAKKiYJ2zg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDM3IiBoZWlnaHQ9IjY5NSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="/assets/4b001d2e8440/1*iigArewZEW0063Q6xwZn7g.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*iigArewZEW0063Q6xwZn7g.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMjIiIGhlaWdodD0iMjgxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>å‹å·ã€iOS ç‰ˆæœ¬åŒæµ‹è¯•ç¯å¢ƒ</ul><p><strong>CI-Testing.yml ä¸­æµ‹è¯•æ­¥éª¤æ”¹æˆï¼š</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="c"># æ‰§è¡Œ Fastlane Unit æµ‹è¯• Lane</span>
      - name: Run Tests
        <span class="nb">id</span>: testing
        <span class="c"># æŒ‡å®šå·¥ä½œç›®å½•ï¼Œè¿™æ ·åç»­æŒ‡ä»¤å°±ä¸ç”¨åœ¨ç‰¹åˆ« cd ./Product/</span>
        working-directory: ./Product/
        <span class="nb">env</span>:
          <span class="c"># ...</span>
          <span class="c"># Repo -&gt; Settings -&gt; Actions secrets and variables -&gt; variables</span>
          <span class="c"># æ¨¡æ‹Ÿå™¨çš„ iOS ç‰ˆæœ¬</span>
          SIMULATOR_IOS_VERSION: <span class="k">${</span><span class="p">{ vars.SIMULATOR_IOS_VERSION </span><span class="k">}</span><span class="o">}</span>

          <span class="c"># å½“å‰ Runner åç§°</span>
          RUNNER_NAME: <span class="k">${</span><span class="p">{ runner.name </span><span class="k">}</span><span class="o">}</span>
          
          <span class="c"># ...</span>
        run: <span class="se">\\</span>|

          <span class="c"># ...</span>
          bundle <span class="nb">exec </span>fastlane <span class="k">${</span><span class="nv">TEST_LANE</span><span class="k">}</span> device:<span class="s2">"</span><span class="k">${</span><span class="nv">RUNNER_NAME</span><span class="k">}</span><span class="s2"> (</span><span class="k">${</span><span class="nv">SIMULATOR_IOS_VERSION</span><span class="k">}</span><span class="s2">)"</span> <span class="se">\\</span>| <span class="nb">tee</span> <span class="s2">"</span><span class="nv">$RUNNER_TEMP</span><span class="s2">/testing_output.txt"</span>
          <span class="c"># ...</span>
</pre></table></code></div></div><ul><li><p><code class="language-plaintext highlighter-rouge">device</code> <strong>æ”¹æˆ</strong> <code class="language-plaintext highlighter-rouge">${RUNNER_NAME} (${SIMULATOR_IOS_VERSION})</code></p><li><p><code class="language-plaintext highlighter-rouge">SIMULATOR_IOS_VERSION</code> è¿˜æ˜¯ç»Ÿä¸€çœ‹ Repo variables å˜æ•°</p></ul><p><strong>ç»„åˆç»“æœå°±ä¼šæ˜¯(ä»¥ 18.4 ä¸ºä¾‹)ï¼š</strong></p><ul><li><p>Runner: <code class="language-plaintext highlighter-rouge">ZhgChgLideMacBook-Pro-Runner-A</code> æ¨¡æ‹Ÿå™¨: <strong>ZhgChgLideMacBook-Pro-Runner-A(18.4)</strong></p><li><p>Runner: <code class="language-plaintext highlighter-rouge">ZhgChgLideMacBook-Pro-Runner-B</code> æ¨¡æ‹Ÿå™¨: <strong>ZhgChgLideMacBook-Pro-Runner-B(18.4)</strong></p></ul><p>è¿™æ ·ä¸¤ä¸ª Runner åŒæ—¶åœ¨æ‰§è¡Œæµ‹è¯•æ—¶å°±ä¼šèµ·ä¸¤ä¸ªæ¨¡æ‹Ÿå™¨è‡ªå·±è·‘è‡ªå·±çš„äº†ã€‚</p><h4 id="å®Œæ•´ä¸“æ¡ˆ-repo"><span class="me-2">å®Œæ•´ä¸“æ¡ˆ Repo</span><a href="#å®Œæ•´ä¸“æ¡ˆ-repo" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="https://github.com/ZhgChgLi/github-actions-ci-cd-demo" target="_blank" class="img-link shimmer" ><img src="https://opengraph.githubassets.com/5952f3220c95ced947b9ee50d9c542b2edbb424be50c51c582cb226ce5f5df63/ZhgChgLi/github-actions-ci-cd-demo" alt="" loading="lazy"></a></p><h3 id="è¡¥å……-ssh-agent-è®¾å®š--for-fastlane-match-or-private-cocoapods-repo"><span class="me-2">è¡¥å…… SSH Agent è®¾å®š â€” For Fastlane Match or Private CocoaPods Repo</span><a href="#è¡¥å……-ssh-agent-è®¾å®š--for-fastlane-match-or-private-cocoapods-repo" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>åœ¨ä½¿ç”¨ Fastlane Match æˆ– Private CocoaPods Repoï¼Œå› ä¸ºæ˜¯åœ¨å¦ä¸€ä¸ª Private Repo å½“ä¸­ï¼Œå½“å‰ Repo/Action ç¯å¢ƒæ— æ³•ç›´æ¥ git cloneï¼Œéœ€è¦ä½¿ç”¨ ssh agent è®¾å®šå¥½ç¯å¢ƒï¼Œåœ¨ Action æ‰§è¡Œæ—¶æ‰æœ‰æƒé™æ“ä½œã€‚</p><h4 id="step-1-äº§ç”Ÿ-ssh-key"><span class="me-2">Step 1. äº§ç”Ÿ SSH Key</span><a href="#step-1-äº§ç”Ÿ-ssh-key" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/4b001d2e8440/1*kPWl9hombBgQ15i-n2sY2A.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*kPWl9hombBgQ15i-n2sY2A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2ODIiIGhlaWdodD0iNDgzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ssh-keygen <span class="nt">-t</span> ed25519 <span class="nt">-C</span> <span class="s2">"zhgchgli@gmail.com"</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Enter file in which to save the key (/Users/zhgchgli/.ssh/id_ed25519):</code> /Users/zhgchgli/Downloads/zhgchgli</p><ul><li>è¾“å…¥åˆ°ä¸‹è½½è·¯å¾„æ–¹ä¾¿æˆ‘ä»¬æ‹·è´å†…å®¹</ul><p><code class="language-plaintext highlighter-rouge">Enter passphrase for â€œ/Users/zhgchgli/Downloads/zhgchgliâ€ (empty for no passphrase):</code></p><ul><li><p><strong>ç•™ç©ºï¼š</strong> CI/CD ä½¿ç”¨ï¼Œæ— æ³•åœ¨ CLI äº¤äº’ä¸‹è¾“å…¥ Passphraseï¼Œ <strong>å› æ­¤è¯·ç•™ç©º</strong></p><li><p>äº§ç”Ÿå®Œæ¯• ( .pub/private_key)</p></ul><p><a href="/assets/4b001d2e8440/1*aF5P6EK9Hfv-CI3MRZ8MCA.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*aF5P6EK9Hfv-CI3MRZ8MCA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMjAiIGhlaWdodD0iNTEiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><h4 id="step-2-åˆ°-private-repo-è®¾å®š-deploy-key"><span class="me-2">Step 2. åˆ° Private Repo è®¾å®š Deploy Key</span><a href="#step-2-åˆ°-private-repo-è®¾å®š-deploy-key" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/4b001d2e8440/1*3K6JvCHa23QfvWoNq2xdBQ.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*3K6JvCHa23QfvWoNq2xdBQ.webp" alt="github-actions-ci-cd-demo-certificates Repo" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTcyIiBoZWlnaHQ9Ijc4MSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>github-actions-ci-cd-demo-certificates Repo</p><p>Settings â†’ Security â†’ Deploy keys â†’ Add deploy keyã€‚</p><ul><li><p>Title: è¾“å…¥ Key åç§°</p><li><p>Key: <code class="language-plaintext highlighter-rouge">è´´ä¸Š .pub Key å†…å®¹</code></p></ul><p>å®Œæˆã€‚</p><p><a href="/assets/4b001d2e8440/1*Xo_g-AchEk0j4SGXOmBuxg.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*Xo_g-AchEk0j4SGXOmBuxg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTY4IiBoZWlnaHQ9IjgxNCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><h4 id="step-3-å›-action-çš„-repo-è®¾å®š-ssh-private-key-to-secrets"><span class="me-2">Step 3. å› Action çš„ Repo è®¾å®š SSH Private Key to Secrets</span><a href="#step-3-å›-action-çš„-repo-è®¾å®š-ssh-private-key-to-secrets" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/4b001d2e8440/1*Jm92pQHMOImQzZtmmvd1ng.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*Jm92pQHMOImQzZtmmvd1ng.webp" alt="github-actions-ci-cd-demo Repo" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTc0IiBoZWlnaHQ9Ijg5OSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>github-actions-ci-cd-demo Repo</p><p>Settings â†’ Secrets and variables â†’ Actions â†’ New repository secretã€‚</p><ul><li><p>Name: è¾“å…¥å¯†é’¥å˜æ•°åç§° <code class="language-plaintext highlighter-rouge">SSH_PRIVATE_KEY</code></p><li><p>Secret: <code class="language-plaintext highlighter-rouge">è´´ä¸Š private_key å†…å®¹</code></p></ul><p>å®Œæˆã€‚</p><h4 id="step-4-ssh-agent-è®¾å®šå®Œæˆæ¥éªŒè¯ä¸€ä¸‹-git-clone-private-repo-çš„æƒé™"><span class="me-2">Step 4. SSH Agent è®¾å®šå®Œæˆï¼Œæ¥éªŒè¯ä¸€ä¸‹ Git Clone Private Repo çš„æƒé™</span><a href="#step-4-ssh-agent-è®¾å®šå®Œæˆæ¥éªŒè¯ä¸€ä¸‹-git-clone-private-repo-çš„æƒé™" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="https://github.com/ZhgChgLi/github-actions-ci-cd-demo/actions/workflows/Demo-Git-Clone-Private-Repo.yml" target="_blank"><strong>Demo-Git-Clone-Private-Repo.yml</strong></a> <strong>:</strong></p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="na">name</span><span class="pi">:</span> <span class="s">Demo Git Clone Private Repo</span>

<span class="na">on</span><span class="pi">:</span>
  <span class="na">workflow_dispatch</span><span class="pi">:</span>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">clone-private-repo</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">Git Clone Private Repo</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">timeout-minutes</span><span class="pi">:</span> <span class="m">30</span>

    <span class="na">steps</span><span class="pi">:</span>
      <span class="c1"># ğŸ” å¯ç”¨ SSH Agent å¹¶åŠ å…¥ç§é’¥</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Setup SSH Agent</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">webfactory/ssh-agent@v0.9.0</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">ssh-private-key</span><span class="pi">:</span> <span class="s">${{ secrets.SSH_PRIVATE_KEY }}</span>

      <span class="c1"># ğŸ›¡ï¸ å°† github.com åŠ å…¥ known_hosts ä»¥é¿å… host verification é”™è¯¯</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Add GitHub to known_hosts</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
          <span class="s">mkdir -p ~/.ssh</span>
          <span class="s">ssh-keyscan github.com &gt;&gt; ~/.ssh/known_hosts</span>
      <span class="c1"># ğŸ“¦ ä½¿ç”¨ SSH clone private repo å¹¶éªŒè¯</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Clone and Verify Private Repo</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">\\|</span>
          <span class="s">git clone git@github.com:ZhgChgLi/github-actions-ci-cd-demo-certificates.git ./fakeMatch/</span>
          <span class="s">if [ -d "./fakeMatch/.git" ]; then</span>
            <span class="s">echo "âœ… Repo cloned successfully into ./fakeMatch/"</span>
            <span class="s">cd ./fakeMatch</span>
            <span class="s">echo "ğŸ“Œ Current commit</span><span class="err">:</span> <span class="s">$(git rev-parse --short HEAD)"</span>
          <span class="s">else</span>
            <span class="s">echo "âŒ Clone failed. SSH Agent may not be configured properly."</span>
            <span class="s">exit </span><span class="m">1</span>
          <span class="s">fi</span>
</pre></table></code></div></div><p>å¯ä»¥ç”¨ä»¥ä¸Š Action éªŒè¯ä¸€ä¸‹æ˜¯å¦è®¾å®šæˆåŠŸã€‚</p><p><a href="/assets/4b001d2e8440/1*YLbr7l0FBSOYx_fQT-tiCA.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*YLbr7l0FBSOYx_fQT-tiCA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjY5MCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>æˆåŠŸï¼Œåç»­ <code class="language-plaintext highlighter-rouge">fastlane match</code> or <code class="language-plaintext highlighter-rouge">pod install</code> private pods åº”è¯¥å°±èƒ½æ­£ç¡®æ‰§è¡Œã€‚</p><h3 id="æ€»ç»“"><span class="me-2">æ€»ç»“</span><a href="#æ€»ç»“" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>è¿™ç¯‡æ–‡ç« è¯¦ç»†çºªå½•äº†ä½¿ç”¨ GitHub Actions å¼€å‘å®Œæ•´çš„ iOS CI/CD æµç¨‹ï¼Œä¸‹ä¸€ç¯‡å°†ä¼˜åŒ–ä½¿ç”¨è€…ç«¯(å·¥ç¨‹å¸ˆ/PM/è®¾è®¡å¸ˆ)ä½“éªŒï¼Œ <strong>å®Œå–„ Slack é€šçŸ¥åŠä½¿ç”¨ Google Apps Script Web App ä¸²æ¥ GitHub Actions æ‰“é€ å…è´¹æ˜“ç”¨çš„è·¨å›¢é˜Ÿæ‰“åŒ…å¹³å°å·¥å…·ã€‚</strong></p><h3 id="ç³»åˆ—æ–‡ç« "><span class="me-2">ç³»åˆ—æ–‡ç« ï¼š</span><a href="#ç³»åˆ—æ–‡ç« " class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p><a href="/posts/zrealm-dev/zh-cn/ci-cd-%E6%98%AF%E4%BB%80%E4%B9%88-%E6%89%93%E9%80%A0%E9%AB%98%E6%95%88%E7%A8%B3%E5%AE%9A%E5%BC%80%E5%8F%91%E5%9B%A2%E9%98%9F%E7%9A%84%E5%85%B3%E9%94%AE%E6%B5%81%E7%A8%8B%E4%B8%8E%E5%B7%A5%E5%85%B7%E9%80%89%E6%8B%A9-c008a9e8ceca/"><strong>CI/CD å®æˆ˜æŒ‡å—ï¼ˆä¸€ï¼‰ï¼šCI/CD æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•é€è¿‡ CI/CD æ‰“é€ ç¨³å®šé«˜æ•ˆçš„å¼€å‘å›¢é˜Ÿï¼Ÿå·¥å…·é€‰æ‹©ï¼Ÿ</strong></a></p><li><p><a href="/posts/zrealm-dev/zh-cn/github-actions-self-hosted-runner-%E8%AF%A6%E8%A7%A3%E4%B8%8E%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B-ci-cd-%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%E5%BB%BA%E7%BD%AE-404bd5c70040/"><strong>CI/CD å®æˆ˜æŒ‡å—ï¼ˆäºŒï¼‰ï¼šGitHub Actions ä¸ self-hosted Runner ä½¿ç”¨ä¸å»ºç½®å¤§å…¨</strong></a></p><li><p><a href="/posts/zrealm-dev/zh-cn/github-actions-ios-ci-cd-%E5%AE%8C%E6%95%B4%E5%AE%9E%E4%BD%9C%E8%87%AA%E5%8A%A8%E5%8C%96%E5%BB%BA%E7%BD%AE-%E6%B5%8B%E8%AF%95%E4%B8%8E%E9%83%A8%E7%BD%B2%E6%B5%81%E7%A8%8B%E6%95%99%E5%AD%A6-4b001d2e8440/"><strong>CI/CD å®æˆ˜æŒ‡å—ï¼ˆä¸‰ï¼‰ï¼šä½¿ç”¨ GitHub Actions å®ä½œ App ä¸“æ¡ˆçš„ CI ä¸ CD å·¥ä½œæµç¨‹</strong></a></p><li><p><a href="/posts/zrealm-dev/zh-cn/ci-cd-%E6%89%93%E5%8C%85%E5%B7%A5%E5%85%B7%E5%B9%B3%E5%8F%B0-%E4%BD%BF%E7%94%A8-google-apps-script-web-app-%E4%B8%B2%E6%8E%A5-github-actions-%E6%8F%90%E5%8D%87%E8%B7%A8%E5%9B%A2%E9%98%9F%E6%95%88%E7%8E%87-4273e57e7148/"><strong>CI/CD å®æˆ˜æŒ‡å—ï¼ˆå››ï¼‰ï¼šä½¿ç”¨ Google Apps Script Web App ä¸²æ¥ GitHub Actions å»ºç½®å…è´¹æ˜“ç”¨çš„æ‰“åŒ…å·¥å…·å¹³å°</strong></a></p></ul><h4 id="buy-me-a-coffee"><span class="me-2"><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank">Buy me a coffee</a></span><a href="#buy-me-a-coffee" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><blockquote><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank"><strong><em>æœ¬ç³»åˆ—æ–‡ç« èŠ±è´¹äº†å¤§é‡çš„æ—¶é—´ç²¾åŠ›æ’°å†™ï¼Œå¦‚æœå†…å®¹å¯¹æ‚¨æœ‰å¸®åŠ©ã€å¯¹æ‚¨çš„å›¢é˜Ÿæœ‰å®è´¨æå‡å·¥ä½œæ•ˆç‡ä¸äº§å“å“è´¨ï¼›æ¬¢è¿è¯·æˆ‘å–æ¯å’–å•¡ï¼Œæ„Ÿè°¢æ”¯æŒï¼</em></strong></a></p></blockquote><p><a href="/assets/4b001d2e8440/1*QJj54G9gOjtQS-rbHVT1SQ.webp" class="popup img-link blur"><img data-src="/assets/4b001d2e8440/1*QJj54G9gOjtQS-rbHVT1SQ.webp" alt="[Buy me a coffee](https://www.buymeacoffee.com/zhgchgli){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MDAiIGhlaWdodD0iNzAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank">Buy me a coffee</a></p><p>æœ‰ä»»ä½•é—®é¢˜åŠæŒ‡æ•™æ¬¢è¿ <a href="https://www.zhgchg.li/contact" target="_blank">ä¸æˆ‘è”ç»œ</a> ã€‚</p><hr /><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=ğŸº&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a><br /></p><blockquote class="prompt-info"><p>æœ¬æ–‡é¦–æ¬¡å‘è¡¨äº Medium (<a href="https://medium.com/p/4b001d2e8440" target="_blank"><strong>ç‚¹å‡»æŸ¥çœ‹åŸå§‹ç‰ˆæœ¬</strong></a>)ï¼Œç”± <a href="/posts/tools/medium-to-jekyll/" target="_blank">ZMediumToMarkdown</a> æä¾›è‡ªåŠ¨è½¬æ¢ä¸åŒæ­¥æŠ€æœ¯ã€‚</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/zh-cn/zmediumtomarkdown/2025-07-07-4b001d2e8440.md" target="_blank">Improve this page on Github.</a></p></blockquote><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1,049+ Followers</span></a></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-dev/">ZRealm Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/simplified-chinese/" class="post-tag no-text-decoration" >simplified-chinese</a> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/cicd/" class="post-tag no-text-decoration" >cicd</a> <a href="/tags/github-actions/" class="post-tag no-text-decoration" >github-actions</a> <a href="/tags/firebase/" class="post-tag no-text-decoration" >firebase</a> <a href="/tags/cicd-pipeline/" class="post-tag no-text-decoration" >cicd-pipeline</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=GitHub%20Actions%20iOS%20CI/CD%EF%BD%9C%E5%AE%8C%E6%95%B4%E5%AE%9E%E4%BD%9C%E8%87%AA%E5%8A%A8%E5%8C%96%E5%BB%BA%E7%BD%AE%E3%80%81%E6%B5%8B%E8%AF%95%E4%B8%8E%E9%83%A8%E7%BD%B2%E6%B5%81%E7%A8%8B%E6%95%99%E5%AD%A6%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fgithub-actions-ios-ci-cd-%25E5%25AE%258C%25E6%2595%25B4%25E5%25AE%259E%25E4%25BD%259C%25E8%2587%25AA%25E5%258A%25A8%25E5%258C%2596%25E5%25BB%25BA%25E7%25BD%25AE-%25E6%25B5%258B%25E8%25AF%2595%25E4%25B8%258E%25E9%2583%25A8%25E7%25BD%25B2%25E6%25B5%2581%25E7%25A8%258B%25E6%2595%2599%25E5%25AD%25A6-4b001d2e8440%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=GitHub%20Actions%20iOS%20CI/CD%EF%BD%9C%E5%AE%8C%E6%95%B4%E5%AE%9E%E4%BD%9C%E8%87%AA%E5%8A%A8%E5%8C%96%E5%BB%BA%E7%BD%AE%E3%80%81%E6%B5%8B%E8%AF%95%E4%B8%8E%E9%83%A8%E7%BD%B2%E6%B5%81%E7%A8%8B%E6%95%99%E5%AD%A6%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fgithub-actions-ios-ci-cd-%25E5%25AE%258C%25E6%2595%25B4%25E5%25AE%259E%25E4%25BD%259C%25E8%2587%25AA%25E5%258A%25A8%25E5%258C%2596%25E5%25BB%25BA%25E7%25BD%25AE-%25E6%25B5%258B%25E8%25AF%2595%25E4%25B8%258E%25E9%2583%25A8%25E7%25BD%25B2%25E6%25B5%2581%25E7%25A8%258B%25E6%2595%2599%25E5%25AD%25A6-4b001d2e8440%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fgithub-actions-ios-ci-cd-%25E5%25AE%258C%25E6%2595%25B4%25E5%25AE%259E%25E4%25BD%259C%25E8%2587%25AA%25E5%258A%25A8%25E5%258C%2596%25E5%25BB%25BA%25E7%25BD%25AE-%25E6%25B5%258B%25E8%25AF%2595%25E4%25B8%258E%25E9%2583%25A8%25E7%25BD%25B2%25E6%25B5%2581%25E7%25A8%258B%25E6%2595%2599%25E5%25AD%25A6-4b001d2e8440%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/en/ci-cd-explained-boost-ios-app-development-stability-and-efficiency-tool-selection-guide-c008a9e8ceca/">CI/CD Explained: Boost iOS App Development Stability and Efficiencyï½œTool Selection Guide</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/zh-cn/ci-cd-%E6%98%AF%E4%BB%80%E4%B9%88-%E6%89%93%E9%80%A0%E9%AB%98%E6%95%88%E7%A8%B3%E5%AE%9A%E5%BC%80%E5%8F%91%E5%9B%A2%E9%98%9F%E7%9A%84%E5%85%B3%E9%94%AE%E6%B5%81%E7%A8%8B%E4%B8%8E%E5%B7%A5%E5%85%B7%E9%80%89%E6%8B%A9-c008a9e8ceca/">CI/CD å®æˆ˜æŒ‡å—ï¼ˆä¸€ï¼‰ï¼šCI/CD æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•é€è¿‡ CI/CD æ‰“é€ ç¨³å®šé«˜æ•ˆçš„å¼€å‘å›¢é˜Ÿï¼Ÿå·¥å…·é€‰æ‹©ï¼Ÿ</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/ci-cd-%E6%98%AF%E4%BB%80%E9%BA%BC-%E6%89%93%E9%80%A0%E9%AB%98%E6%95%88%E7%A9%A9%E5%AE%9A%E9%96%8B%E7%99%BC%E5%9C%98%E9%9A%8A%E7%9A%84%E9%97%9C%E9%8D%B5%E6%B5%81%E7%A8%8B%E8%88%87%E5%B7%A5%E5%85%B7%E9%81%B8%E6%93%87-c008a9e8ceca/">CI/CD å¯¦æˆ°æŒ‡å—ï¼ˆä¸€ï¼‰ï¼šCI/CD æ˜¯ä»€éº¼ï¼Ÿå¦‚ä½•é€é CI/CD æ‰“é€ ç©©å®šé«˜æ•ˆçš„é–‹ç™¼åœ˜éšŠï¼Ÿå·¥å…·é¸æ“‡ï¼Ÿ</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/en/google-apps-script-web-app-integrate-forms-with-github-actions-ci-cd-for-streamlined-workflows-4cb4437818f2/">Google Apps Script Web Appï½œIntegrate Forms with GitHub Actions CI/CD for Streamlined Workflows</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/zh-cn/google-apps-script-web-app-%E6%89%93%E9%80%A0-github-action-ci-cd-%E8%87%AA%E8%AE%A2%E8%A1%A8%E5%8D%95%E6%8F%90%E5%8D%87%E5%BC%80%E5%8F%91%E6%95%88%E7%8E%87-4cb4437818f2/">ä½¿ç”¨ Google Apps Script Web App è¡¨å•ä¸²æ¥ Github Action CI/CD å·¥ä½œ</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">ç”Ÿæ´»</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Chapters ğŸ”–</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-dev/github-actions-ios-ci-cd-%E5%AE%8C%E6%95%B4%E5%AF%A6%E4%BD%9C%E8%87%AA%E5%8B%95%E5%8C%96%E5%BB%BA%E7%BD%AE-%E6%B8%AC%E8%A9%A6%E8%88%87%E9%83%A8%E7%BD%B2%E6%B5%81%E7%A8%8B%E6%95%99%E5%AD%B8-4b001d2e8440/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1751900544" data-df="ll" > Jul 7, 2025 </time><h4 class="pt-0 my-2">CI/CD å¯¦æˆ°æŒ‡å—ï¼ˆä¸‰ï¼‰ï¼šä½¿ç”¨ GitHub Actions å¯¦ä½œ App iOS CI èˆ‡ CD å·¥ä½œæµç¨‹</h4><div class="text-muted"><p>iOS App è‡ªå‹•åŒ–å»ºç½®ã€æ¸¬è©¦ã€éƒ¨ç½²çš„ GitHub Actions å¯¦ä½œæ­¥é©Ÿå®Œæ•´æ•™å­¸</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/zh-cn/github-actions-self-hosted-runner-%E8%AF%A6%E8%A7%A3%E4%B8%8E%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B-ci-cd-%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%E5%BB%BA%E7%BD%AE-404bd5c70040/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1751458952" data-df="ll" > Jul 2, 2025 </time><h4 class="pt-0 my-2">GitHub Actionsï½œSelf-hosted Runner è¯¦è§£ä¸å®æˆ˜æ¡ˆä¾‹ï½œCI/CD è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹å»ºç½®</h4><div class="text-muted"><p>é’ˆå¯¹å¼€å‘å›¢é˜Ÿè‡ªåŠ¨åŒ–éœ€æ±‚ï¼Œè§£æ GitHub Actions ä¸ Self-hosted Runner æ¶æ„ä¸è®¾å®šï¼Œå¹¶é€è¿‡ä¸‰å¤§å®æˆ˜æ¡ˆä¾‹æ•™ä½ å¿«é€Ÿå»ºç«‹è‡ªåŠ¨æ ‡è®° PRã€æŒ‡æ´¾è´Ÿè´£äººåŠæ¯æ—¥ PR ç»Ÿè®¡é€šçŸ¥ï¼Œæå‡ CI/CD æ‰§è¡Œæ•ˆç‡ä¸æˆæœ¬ä¼˜åŒ–ã€‚</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/zh-cn/ci-cd-%E6%98%AF%E4%BB%80%E4%B9%88-%E6%89%93%E9%80%A0%E9%AB%98%E6%95%88%E7%A8%B3%E5%AE%9A%E5%BC%80%E5%8F%91%E5%9B%A2%E9%98%9F%E7%9A%84%E5%85%B3%E9%94%AE%E6%B5%81%E7%A8%8B%E4%B8%8E%E5%B7%A5%E5%85%B7%E9%80%89%E6%8B%A9-c008a9e8ceca/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1751267416" data-df="ll" > Jun 30, 2025 </time><h4 class="pt-0 my-2">CI/CD æ˜¯ä»€ä¹ˆï½œæ‰“é€ é«˜æ•ˆç¨³å®šå¼€å‘å›¢é˜Ÿçš„å…³é”®æµç¨‹ä¸å·¥å…·é€‰æ‹©</h4><div class="text-muted"><p>é’ˆå¯¹ iOS App å›¢é˜Ÿï¼Œè§£ææ—  CI/CD æµç¨‹çš„ç—›ç‚¹ï¼Œé€è¿‡ GitHub Actions ä¸ self-hosted Runner è‡ªåŠ¨åŒ–æµ‹è¯•ä¸æ‰“åŒ…ï¼Œå‡å°‘äººåŠ›æµªè´¹ä¸é”™è¯¯ï¼Œæå‡å›¢é˜Ÿç¨³å®šæ€§ä¸å¼€å‘æ•ˆç‡ï¼Œæ­é… Google Apps Script Web App å®ç°è·¨èŒèƒ½ä¾¿æ·æ“ä½œã€‚</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-dev/en/github-actions-ios-app-ci-cd-workflow-automation-for-faster-builds-and-deployments-4b001d2e8440/" class="btn btn-outline-primary" aria-label="Older" ><p>GitHub Actionsï½œiOS App CI/CD Workflow Automation for Faster Builds and Deployments</p></a> <a href="/posts/zrealm-dev/github-actions-ios-ci-cd-%E5%AE%8C%E6%95%B4%E5%AF%A6%E4%BD%9C%E8%87%AA%E5%8B%95%E5%8C%96%E5%BB%BA%E7%BD%AE-%E6%B8%AC%E8%A9%A6%E8%88%87%E9%83%A8%E7%BD%B2%E6%B5%81%E7%A8%8B%E6%95%99%E5%AD%B8-4b001d2e8440/" class="btn btn-outline-primary" aria-label="Newer" ><p>CI/CD å¯¦æˆ°æŒ‡å—ï¼ˆä¸‰ï¼‰ï¼šä½¿ç”¨ GitHub Actions å¯¦ä½œ App iOS CI èˆ‡ CD å·¥ä½œæµç¨‹</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>Â© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span> <a href="/">æ­£é«”ä¸­æ–‡</a> | <a href="/tags/simplified-chinese">ç®€ä½“ä¸­æ–‡</a> | <a href="/tags/english/">English</a> <br/> Last updated: 2025-12-20 10:50:31 +08:00</p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">ç”Ÿæ´»</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
