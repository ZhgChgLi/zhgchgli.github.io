<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="App 下架备份攻略｜mitmproxy 与 Apple Configurator 技术保存与还原教学" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="iOS App 即将下架？透过 mitmproxy 嗅探 API 资料与 Apple Configurator 备份 .ipa 档，实现 App 永久留存与资料回放，保存产品生命周期最后回忆，避免资料遗失。" /><meta property="og:description" content="iOS App 即将下架？透过 mitmproxy 嗅探 API 资料与 Apple Configurator 备份 .ipa 档，实现 App 永久留存与资料回放，保存产品生命周期最后回忆，避免资料遗失。" /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-dev/zh-cn/app-%E4%B8%8B%E6%9E%B6%E5%A4%87%E4%BB%BD%E6%94%BB%E7%95%A5-mitmproxy-%E4%B8%8E-apple-configurator-%E6%8A%80%E6%9C%AF%E4%BF%9D%E5%AD%98%E4%B8%8E%E8%BF%98%E5%8E%9F%E6%95%99%E5%AD%A6-b04f4fba3cf2/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-dev/zh-cn/app-%E4%B8%8B%E6%9E%B6%E5%A4%87%E4%BB%BD%E6%94%BB%E7%95%A5-mitmproxy-%E4%B8%8E-apple-configurator-%E6%8A%80%E6%9C%AF%E4%BF%9D%E5%AD%98%E4%B8%8E%E8%BF%98%E5%8E%9F%E6%95%99%E5%AD%A6-b04f4fba3cf2/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/b04f4fba3cf2/1*8RN-xVJROfLwtovgkvHDwA.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-05-15T00:20:45+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/b04f4fba3cf2/1*8RN-xVJROfLwtovgkvHDwA.webp" /><meta property="twitter:title" content="App 下架备份攻略｜mitmproxy 与 Apple Configurator 技术保存与还原教学" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://medium.com/@zhgchgli/"},"dateModified":"2024-05-15T00:20:45+08:00","datePublished":"2024-05-15T00:20:45+08:00","description":"iOS App 即将下架？透过 mitmproxy 嗅探 API 资料与 Apple Configurator 备份 .ipa 档，实现 App 永久留存与资料回放，保存产品生命周期最后回忆，避免资料遗失。","headline":"App 下架备份攻略｜mitmproxy 与 Apple Configurator 技术保存与还原教学","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+","url":"https://zhgchg.li/assets/b04f4fba3cf2/1*8RN-xVJROfLwtovgkvHDwA.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-dev/zh-cn/app-%E4%B8%8B%E6%9E%B6%E5%A4%87%E4%BB%BD%E6%94%BB%E7%95%A5-mitmproxy-%E4%B8%8E-apple-configurator-%E6%8A%80%E6%9C%AF%E4%BF%9D%E5%AD%98%E4%B8%8E%E8%BF%98%E5%8E%9F%E6%95%99%E5%AD%A6-b04f4fba3cf2/"},"url":"https://zhgchg.li/posts/zrealm-dev/zh-cn/app-%E4%B8%8B%E6%9E%B6%E5%A4%87%E4%BB%BD%E6%94%BB%E7%95%A5-mitmproxy-%E4%B8%8E-apple-configurator-%E6%8A%80%E6%9C%AF%E4%BF%9D%E5%AD%98%E4%B8%8E%E8%BF%98%E5%8E%9F%E6%95%99%E5%AD%A6-b04f4fba3cf2/"}</script><title>App 下架备份攻略｜mitmproxy 与 Apple Configurator 技术保存与还原教学 | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script><link rel="alternate" hreflang="en" href="/posts/zrealm-dev/en/app-lifecycle-management-mitmproxy-apple-configurator-for-preserving-removed-apps-b04f4fba3cf2/"><link rel="alternate" hreflang="zh-Hant" href="/posts/zrealm-dev/app-%E4%B8%8B%E6%9E%B6%E5%82%99%E4%BB%BD%E6%94%BB%E7%95%A5-mitmproxy-%E8%88%87-apple-configurator-%E6%8A%80%E8%A1%93%E4%BF%9D%E5%AD%98%E8%88%87%E9%82%84%E5%8E%9F%E6%95%99%E5%AD%B8-b04f4fba3cf2/"><link rel="alternate" hreflang="zh-Hans" href="/posts/zrealm-dev/zh-cn/app-%E4%B8%8B%E6%9E%B6%E5%A4%87%E4%BB%BD%E6%94%BB%E7%95%A5-mitmproxy-%E4%B8%8E-apple-configurator-%E6%8A%80%E6%9C%AF%E4%BF%9D%E5%AD%98%E4%B8%8E%E8%BF%98%E5%8E%9F%E6%95%99%E5%AD%A6-b04f4fba3cf2/"><link rel="alternate" hreflang="x-default" href="/posts/zrealm-dev/zh-cn/app-%E4%B8%8B%E6%9E%B6%E5%A4%87%E4%BB%BD%E6%94%BB%E7%95%A5-mitmproxy-%E4%B8%8E-apple-configurator-%E6%8A%80%E6%9C%AF%E4%BF%9D%E5%AD%98%E4%B8%8E%E8%BF%98%E5%8E%9F%E6%95%99%E5%AD%A6-b04f4fba3cf2/"><link rel="stylesheet" href="/assets/css/post-toc.css"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0">An iOS, web, and automation developer from Taiwan 🇹🇼 who also loves sharing, traveling, and writing.</p><a href="https://medium.com/@zhgchgli" target="_blank" style="display: block;text-align: center;font-style: normal;/* text-decoration: underline; */font-size: 1.2em;color: var(--heading-color);">1K+ Followers on Medium</a></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/english/" class="nav-link"> <i class="fa-fw fa fa-solid fa-language"></i> <span>ENGLISH POSTS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>App 下架备份攻略｜mitmproxy 与 Apple Configurator 技术保存与还原教学</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>App 下架备份攻略｜mitmproxy 与 Apple Configurator 技术保存与还原教学</h1><p class="post-desc fw-light mb-4">iOS App 即将下架？透过 mitmproxy 嗅探 API 资料与 Apple Configurator 备份 .ipa 档，实现 App 永久留存与资料回放，保存产品生命周期最后回忆，避免资料遗失。</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1715703645" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > May 15, 2024 </time> </span> <span> Updated <time data-ts="1715703645" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > May 14, 2024 </time> </span><div class="mt-3 mb-3"> <a href="/assets/b04f4fba3cf2/1*8RN-xVJROfLwtovgkvHDwA.webp" class="popup img-link preview-img blur"><img data-src="/assets/b04f4fba3cf2/1*8RN-xVJROfLwtovgkvHDwA.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></div><div class="d-flex justify-content-between"> <span style="display: inline-flex; align-items: center; gap: 4px;"> By <em> <a href="https://medium.com/@zhgchgli/">ZhgChgLi</a> </em> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" style="display: block; "><path fill="#007bff" d="M271.2 56C265.1 49.8 256.2 47.3 247.8 49.6C239.4 51.9 232.9 58.4 230.8 66.8L215.5 127C214.4 131.4 209.9 134 205.6 132.7L145.8 115.9C137.4 113.5 128.4 115.9 122.3 122C116.2 128.1 113.8 137.1 116.2 145.5L133.1 205.3C134.3 209.6 131.7 214.1 127.4 215.2L67.1 230.5C58.7 232.6 52.1 239.2 49.8 247.6C47.5 256 50 264.9 56.2 271L100.7 314.3C103.9 317.4 103.9 322.6 100.7 325.8L56.3 369.1C50.1 375.2 47.6 384.1 49.9 392.5C52.2 400.9 58.8 407.4 67.2 409.6L127.4 424.9C131.8 426 134.4 430.5 133.1 434.8L116.2 494.5C113.8 502.9 116.2 511.9 122.3 518C128.4 524.1 137.4 526.5 145.8 524.1L205.6 507.2C209.9 506 214.4 508.6 215.5 512.9L230.8 573.1C232.9 581.5 239.5 588.1 247.9 590.4C256.3 592.7 265.2 590.2 271.3 584L314.6 539.5C317.7 536.3 322.9 536.3 326.1 539.5L369.3 584C375.4 590.2 384.3 592.7 392.7 590.4C401.1 588.1 407.6 581.5 409.8 573.1L425.1 513C426.2 508.6 430.7 506 435 507.3L494.8 524.2C503.2 526.6 512.2 524.2 518.3 518.1C524.4 512 526.8 503 524.4 494.6L507.5 434.8C506.3 430.5 508.9 426 513.2 424.9L573.4 409.6C581.8 407.5 588.4 400.9 590.7 392.5C593 384.1 590.5 375.1 584.3 369.1L539.8 325.8C536.6 322.7 536.6 317.5 539.8 314.3L584.3 271C590.5 264.9 593 256 590.7 247.6C588.4 239.2 581.8 232.7 573.4 230.5L513.2 215.2C508.8 214.1 506.2 209.6 507.5 205.3L524.4 145.5C526.8 137.1 524.4 128.1 518.3 122C512.2 115.9 503.2 113.5 494.8 115.9L435 132.8C430.7 134 426.2 131.4 425.1 127.1L409.8 66.8C407.7 58.4 401.1 51.8 392.7 49.5C384.3 47.2 375.4 49.7 369.3 55.9L326 100.5C322.9 103.7 317.7 103.7 314.5 100.5L271.2 56z"/><path d="M250 330 l60 60 100 -140" stroke="#ffffff" stroke-width="40" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="3389 words" > <em>18 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">App 下架备份攻略｜mitmproxy 与 Apple Configurator 技术保存与还原教学</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">章節 (Chapters)🔖</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">App 下架备份攻略｜mitmproxy 与 Apple Configurator 技术保存与还原教学</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/en/app-lifecycle-management-mitmproxy-apple-configurator-for-preserving-removed-apps-b04f4fba3cf2/"><strong>Click here</strong></a> to view the English version of this article.</p></blockquote><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/app-%E4%B8%8B%E6%9E%B6%E5%82%99%E4%BB%BD%E6%94%BB%E7%95%A5-mitmproxy-%E8%88%87-apple-configurator-%E6%8A%80%E8%A1%93%E4%BF%9D%E5%AD%98%E8%88%87%E9%82%84%E5%8E%9F%E6%95%99%E5%AD%B8-b04f4fba3cf2/"><strong>點擊這裡</strong></a>查看本文章正體中文版本。</p></blockquote><blockquote class="prompt-info"><p>基于 SEO 考量，本文标题与描述经 AI 调整，原始版本请参考内文。</p></blockquote><h4 id="zhgchgli-table-of-contents">文章目录</h4><nav class="zhgchgli-toc"><ul class="zhgchgli-toc-list"><li><a href="#app-产品进入终点站能做什么事缅怀">App 产品进入终点站，能做什么事缅怀？</a></li><li class="has-children"><details><summary>前言 <a href="#前言">#</a></summary><ul><li><a href="#缅怀">缅怀</a></li></ul></details></li><li><a href="#非技术方式--录影">非技术方式 — 录影</a></li><li class="has-children"><details><summary>技术方式 <a href="#技术方式">#</a></summary><ul><li><a href="#声明">声明</a></li><li><a href="#骨-备份-ipa-app-安装档">[骨] 备份 .ipa App 安装档</a></li><li><a href="#骨-还原-ipa-app-安装档">[骨] 还原 .ipa App 安装档</a></li><li><a href="#肉-备份最后的-api-response-data">[肉] 备份最后的 API Response Data</a></li><li><a href="#肉-回放撷取到的-api-response-data">[肉] 回放撷取到的 API Response Data</a></li></ul></details></li><li class="has-children"><details><summary>缅怀 <a href="#缅怀-1">#</a></summary><ul><li><a href="#欢迎协助贡献">欢迎协助贡献</a></li></ul></details></li></ul></nav><hr /><h3 id="app-产品进入终点站能做什么事缅怀"><span class="me-2">App 产品进入终点站，能做什么事缅怀？</span><a href="#app-产品进入终点站能做什么事缅怀" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>使用 mitmproxy + apple configurator 让 App 永远停留在下架前的状态</p><h3 id="前言"><span class="me-2">前言</span><a href="#前言" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/b04f4fba3cf2/1*8RN-xVJROfLwtovgkvHDwA.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*8RN-xVJROfLwtovgkvHDwA.webp" alt="咒术回战" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDgwIiBoZWlnaHQ9IjU0MCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>咒术回战</p><p>工作时间久、经手过的产品多，也开始遇到有曾经参与过的产品要进入终点站(下架)；从零到有开发一个产品如同孕育一个新生命，团队一起努力了 3–4 个月将孩子生下来；虽然后期已交由其他保母(工程师)继续培养，最近听到它即将进入产品生命周期的终点还是有些许遗憾。</p><blockquote><p><strong><em>人生也是如此，我们永远都不知道明天是太阳先升起还是意外先来临；唯一能做的就是珍惜当下，把事情做好。</em></strong></p></blockquote><h4 id="缅怀"><span class="me-2">缅怀</span><a href="#缅怀" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>凡走过必留下痕迹，我们希望能在产品进入终点站之前做些什么，让大家还有机会回忆也让它至少留下存在过的证明；以下方式都需要 App 还在线上，如果已经下架就真的只剩回忆了。</p><h3 id="非技术方式--录影"><span class="me-2">非技术方式 — 录影</span><a href="#非技术方式--录影" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>除了直接用 <a href="https://support.apple.com/zh-tw/102653" target="_blank">iPhone 内建的萤幕录影功能</a> 之外，我们也可以使用 QuickTime Player 将手机接上 Mac 使用电脑进行录影、汇出影片。</p><ol><li>在 Mac 上打开 QuickTime Player App</ol><p><a href="/assets/b04f4fba3cf2/1*UVkfiLbcYU8YuZEPdbJaOg.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*UVkfiLbcYU8YuZEPdbJaOg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNjIiIGhlaWdodD0iMTc3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ol><li>左上角工具列选择「档案」-&gt;「新增影片录制」</ol><p><a href="/assets/b04f4fba3cf2/1*VcRN0FExy-CA7sExHtMT6w.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*VcRN0FExy-CA7sExHtMT6w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMjQiIGhlaWdodD0iMzc0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ol><li>跳出录影介面后点击 🔴 旁的「v」，萤幕与扬声器选择您接上的手机</ol><p><a href="/assets/b04f4fba3cf2/1*SN0XL8Zt0UlBizXiIqZiyA.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*SN0XL8Zt0UlBizXiIqZiyA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzODciIGhlaWdodD0iNDE1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ol><li>此时录影介面就会出现手机画面</ol><p><a href="/assets/b04f4fba3cf2/1*MSuecaACmg3ZNMnGpDkRFQ.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*MSuecaACmg3ZNMnGpDkRFQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NTYiIGhlaWdodD0iOTkxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>点击「🔴」开始录影，回到手机上操作要录影的内容。</p><p><a href="/assets/b04f4fba3cf2/1*bxL9Dq1IWgbrlSfKO6skLQ.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*bxL9Dq1IWgbrlSfKO6skLQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMTMiIGhlaWdodD0iNzMiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>录影中会显示当前影片大小，欲结束录影再按一次「🔴」即可停止。</p><p><a href="/assets/b04f4fba3cf2/1*VxWQNHF_PX5CZAkjJEXPbQ.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*VxWQNHF_PX5CZAkjJEXPbQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NDciIGhlaWdodD0iOTg3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>可以透过 QuickTime Player 工具列简单的裁剪影片，最后按下「Command」+「s」汇出储存影片到指定位置，即完成录影留念。</p><p>影片留念的好处是未来回忆比图片更容易串连起来，录的越深就纪录的越仔细，若要将更别画面转成图片也可以直接截图，很方便。</p><h3 id="技术方式"><span class="me-2">技术方式</span><a href="#技术方式" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>App 技术备份可分为两个方向；「骨」App 本身其实只是个骨架、「肉」由 API Response Data 组成才是 App 内容资料的核心。</p><ul><li><p>骨会随著 App 从 App Store 商城下架而消失。</p><li><p>肉会随著 API 主机、伺服器关闭而消失。</p></ul><p>因此我们也分成备份骨跟肉两个技术方式。</p><h4 id="声明"><span class="me-2">声明</span><a href="#声明" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><blockquote><p><em>本文仅为技术研究分享，不鼓励利用任何技术进行非法、侵权行为。</em></p></blockquote><h4 id="骨-备份-ipa-app-安装档"><span class="me-2">[骨] 备份 .ipa App 安装档</span><a href="#骨-备份-ipa-app-安装档" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>App 在商城下架后已下载 App 的手机只要不主动删除 App，就会一直存在在该手机上，换手机用转移的方式也会一并转移过去。</p><p>但如果我们不小心删除该 App 或是换手机没转移，那就真的永远跟他说再见了；此时如果有手动备份商城的 .ipa 档案就能再次续命。</p><p>很久以前 <a href="/posts/zrealm-dev/zh-cn/ios-%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E5%85%A8%E6%94%BB%E7%95%A5-%E8%B6%8A%E7%8B%B1%E6%8F%90%E5%8F%96ipa%E6%A1%A3-ui%E5%88%86%E6%9E%90%E5%88%B0%E5%8F%8D%E7%BC%96%E8%AF%91%E6%8A%80%E6%9C%AF%E8%AF%A6%E8%A7%A3-7498e1ff93ce/">逆向工程的文章</a> 有提到过，但这次只需单纯备份 .ipa 档案不需敲壳，全部都是使用 Apple 官方提供的工具完成。</p><p><strong>1.安装 <a href="https://apps.apple.com/tw/app/apple-configurator/id1037126344?mt=12" target="_blank">Apple Configurator 2</a></strong></p><p><a href="/assets/b04f4fba3cf2/1*_RzuFIVGV9T_-xJ53H8fGA.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*_RzuFIVGV9T_-xJ53H8fGA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9Ijc3NiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>首先去 Mac App Store 下载安装「 <a href="https://apps.apple.com/tw/app/apple-configurator/id1037126344?mt=12" target="_blank">Apple Configurator 2</a> 」</p><p><strong>2. 将 iPhone 接上 Mac 并点击信任电脑</strong></p><p><a href="/assets/b04f4fba3cf2/1*EiSQmOkDCW73kYhJWbTipQ.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*EiSQmOkDCW73kYhJWbTipQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDY4IiBoZWlnaHQ9IjY5NiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>接上成功后就会出现 iPhone 的主画面。</p><p><strong>3. 确认你的手机已安装欲备份 .ipa 档案的 App</strong></p><p><a href="/assets/b04f4fba3cf2/1*QD9M4uM9eyKSixzu8AdKbw.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*QD9M4uM9eyKSixzu8AdKbw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MjgiIGhlaWdodD0iMTA2MiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>我们需要在 Apple Configurator 2 卡出取代画面，才能取得下载到暂存中的 .ipa 档案，因此我们要先确保手机上有安装目标 App。</p><p><strong>4. 回到 Mac 上的 Apple Configurator 2</strong></p><p>点两下上面显示的 iPhone 主画面进入资讯页。</p><p><a href="/assets/b04f4fba3cf2/1*X_y5uGhRRIq7VQuW4PkYBg.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*X_y5uGhRRIq7VQuW4PkYBg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5OTIiIGhlaWdodD0iNjI1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>切换到「App」-&gt; 右上角「+ 加入」-&gt;「App」</p><p>完成 App Store 帐号登入后可以取得您曾经购买过的 App 列表。</p><p><a href="/assets/b04f4fba3cf2/1*uAyjPD75-MGokHCbDoC_4g.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*uAyjPD75-MGokHCbDoC_4g.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MjMiIGhlaWdodD0iNTExIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>搜寻找到欲备份的目标 App，选择后点「加入」。</p><p><a href="/assets/b04f4fba3cf2/1*T-v1CNrmc7T4MpeyAX0c7A.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*T-v1CNrmc7T4MpeyAX0c7A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NzUiIGhlaWdodD0iMjUyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>此时会出现等待视窗，正在 XXX 上加入 App、正在下载「XXX」。</p><p><strong>5. 提取 .ipa 档案</strong></p><blockquote><p><strong><em>放著等他下载完成后，会跳出询问是否要取代现有已安装 App 视窗。</em></strong></p></blockquote><p><a href="/assets/b04f4fba3cf2/1*9f54be4lixn4ezKhwRJrtg.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*9f54be4lixn4ezKhwRJrtg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzOTAiIGhlaWdodD0iNDMwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><blockquote><p><strong><em>此时不要按任何动作。此时不要按任何动作。此时不要按任何动作。</em></strong></p></blockquote><p>我们打开一个 Finder：</p><p>左上角工具列选择「前往」-&gt; 「前往档案夹」</p><p><a href="/assets/b04f4fba3cf2/1*JgXWca5hKROuoOgLThkQnw.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*JgXWca5hKROuoOgLThkQnw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMTciIGhlaWdodD0iNDkyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>贴上以下路径：</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>~/Library/Group Containers/K36BKF7T3D.group.com.apple.configurator/Library/Caches/Assets/TemporaryItems/MobileApps
</pre></table></code></div></div><p>就可以找到下载下来正准备要安装的目标 App .ipa 档案：</p><p><a href="/assets/b04f4fba3cf2/1*zV5yWozKqXtwekI33NWwVg.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*zV5yWozKqXtwekI33NWwVg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDMyIiBoZWlnaHQ9IjU2NCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>将其复制出来即可完成 App .ipa 档案备份。</p><p>完成档案复制后再回去 Apple Configurator 2 点击停止，终止操作。</p><h4 id="骨-还原-ipa-app-安装档"><span class="me-2">[骨] 还原 .ipa App 安装档</span><a href="#骨-还原-ipa-app-安装档" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>一样是将欲还原 App 的手机接上 Mac 并打开 Apple Configurator 2，进入 App 加入介面。</p><p><a href="/assets/b04f4fba3cf2/1*6miYYw5QL6iqLQqrtHOi2A.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*6miYYw5QL6iqLQqrtHOi2A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MjMiIGhlaWdodD0iNTExIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>还原的话要选择左下角「从我的 Mac 选择…」</p><p><a href="/assets/b04f4fba3cf2/1*7a_25rE2eDpMFZqBC3sP6g.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*7a_25rE2eDpMFZqBC3sP6g.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MTIiIGhlaWdodD0iNTYwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>选择备份的 App .ipa 档案，按「加入」。</p><p><a href="/assets/b04f4fba3cf2/1*AcGEAuowmvvGRb-E22wu2g.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*AcGEAuowmvvGRb-E22wu2g.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NzUiIGhlaWdodD0iMjUyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>等待传送、安装完成，回到手机上就能重新打开 App，复活成功！</p><h4 id="肉-备份最后的-api-response-data"><span class="me-2">[肉] 备份最后的 API Response Data</span><a href="#肉-备份最后的-api-response-data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>这边会运用到之前在 <a href="/posts/zrealm-dev/zh-cn/end-to-end-testing-%E7%94%A8-snapshot-api-local-mock-server-%E8%A7%A3%E5%86%B3-ios-app-%E6%B5%8B%E8%AF%95%E8%B5%84%E6%96%99%E4%B8%8D%E7%A8%B3%E5%AE%9A%E9%97%AE%E9%A2%98-5a5c4b25a83d/"><strong>App End-to-End Testing Local Snapshot API Mock Server</strong></a> <strong>文章(细节原理可参考)</strong> 中所使用到的方式跟当时弄的开源专案：</p><p><a href="https://github.com/ZhgChgLi/mitmproxy-rodo/tree/main" target="_blank" class="img-link shimmer" ><img src="https://repository-images.githubusercontent.com/686628812/44cf2ec7-4de1-4a10-b213-bf7dd30748a4" alt="" loading="lazy"></a></p><p>同之前用录制 API Request &amp; Response 来跑 E2E Testing 的技术，我们也可以用它来纪录 App 下架、停机前最后的 API Request &amp; Response Data。</p><p><strong>1. 安装 <a href="https://mitmproxy.org/" target="_blank">mitmproxy</a></strong></p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nx">brew</span> <span class="nx">install</span> <span class="nx">mitmproxy</span>
</pre></table></code></div></div><p>mitmproxy 是一套开源的中间人攻击，网路请求嗅探工具。</p><p>如果你不熟悉 Mitmproxy 中间人攻击的工作原理可先参考我之前的文章：「 <a href="/posts/zrealm-dev/zh-cn/app-https%E4%BC%A0%E8%BE%93%E4%BB%8D%E9%81%AD%E7%AA%83%E5%8F%96-mitmproxy%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB%E5%AE%9E%E6%88%98%E6%95%99%E5%AD%A6%E4%B8%8E%E9%98%B2%E8%8C%83%E6%8A%80%E5%B7%A7-46410aaada00/">APP有用HTTPS传输，但资料还是被偷了。</a> 」或 <a href="https://docs.mitmproxy.org/stable/overview-getting-started/" target="_blank">Mimproxy 官方文件</a> 。</p><p>如果是用在纯网路请求嗅探，用不习惯 mimproxy 介面也可以改用「 <a href="https://proxyman.io/" target="_blank">Proxyman</a> 」可参考之前 <a href="/posts/zrealm-dev/zh-cn/python-%E6%90%AD%E9%85%8D-google-cloud-platform-%E4%B8%8E-line-bot-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E8%87%AA%E5%8A%A8%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%E4%B8%8E%E6%8E%92%E7%A8%8B-70a1409b149a/">另一篇文章</a> 的用法。</p><p><strong>2. 完成 mitmproxy 凭证设定</strong></p><blockquote><p><em>针对 HTTPS 加密连线我们需要使用根凭证抽换进行中间人攻击，因此第一次使用须先完成手机端根凭证下载与启用。</em></p></blockquote><blockquote><p><em>*如果您的 App &amp; API Server 有实作 SSL Pinning 也需要将 Pinning 凭证加入到 mitmproxy。</em></p></blockquote><ul><li><p>首先确保 iPhone 手机与 Mac 电脑是连接在相同的网路环境</p><li><p>若无 WiFi 电脑连接实体网路，也可以 <a href="https://applealmond.com/posts/92291" target="_blank">打开 Mac 的 WiFi 分享功能</a> 让手机连到 Mac 的网路</p></ul><p>在 Terminal 启动 <code class="language-plaintext highlighter-rouge">mitmproxy</code> or <code class="language-plaintext highlighter-rouge">mitmweb</code> (Web GUI 版)。</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nx">mitmproxy</span>
</pre></table></code></div></div><p><a href="/assets/b04f4fba3cf2/1*xruNW5ZUPNuxVJvKOyPQTA.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*xruNW5ZUPNuxVJvKOyPQTA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5NTEiIGhlaWdodD0iMzkwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>看到这画面代表 mitmproxy 服务已启动，目前没有流量进来所以是空的，挂在这个画面不要关闭 Terminal。</p><ul><li>到 Mac 网路设定查看 Mac 的 IP 位址</ul><p>回到手机 WiFi 设定点击「i」进入详细设定，找到最下方「设定代理伺服器」：</p><p><a href="/assets/b04f4fba3cf2/1*zXVilpUXnXakpWib007BPA.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*zXVilpUXnXakpWib007BPA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1OTAiIGhlaWdodD0iOTk1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/b04f4fba3cf2/1*QV6reSNc0AJg7sQa2qiCjQ.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*QV6reSNc0AJg7sQa2qiCjQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1OTAiIGhlaWdodD0iOTk1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li><p>伺服器输入 Mac 电脑的 IP 位址</p><li><p>连接埠输入 8080</p><li><p>储存</p></ul><p><strong>在手机上打开 Safari 输入： <a href="http://mitm.it/" target="_blank">http://mitm.it/</a></strong></p><p>如果出现：</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nc">If</span> <span class="n">you</span> <span class="n">can</span> <span class="n">see</span> <span class="k">this</span><span class="p">,</span> <span class="n">traffic</span> <span class="k">is</span> <span class="n">not</span> <span class="n">passing</span> <span class="n">through</span> <span class="n">mitmproxy</span><span class="p">.</span>
</pre></table></code></div></div><p>代表手机的网路代理伺服器没有设定成功或是 Mac 上没启动 <code class="language-plaintext highlighter-rouge">mitmproxy</code> 。</p><p>正常情况会出现：</p><p><a href="/assets/b04f4fba3cf2/1*Ks5IHpi2AoPj4wXu5ZH9VA.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*Ks5IHpi2AoPj4wXu5ZH9VA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1OTAiIGhlaWdodD0iOTk1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><blockquote><p><em>此时只有 HTTP 流量能被嗅探，HTTPS 流量会报错，我们继续往下设定。</em></p></blockquote><p>代表连接成功，我们找到 iOS 区块点击「Get mimproxy-ca-cert.pem」</p><p><a href="/assets/b04f4fba3cf2/1*HvIg0jtUQ5ops519YUA52A.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*HvIg0jtUQ5ops519YUA52A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1OTAiIGhlaWdodD0iOTk1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/b04f4fba3cf2/1*tU3gi3PBvrbUc-tqKjUD9w.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*tU3gi3PBvrbUc-tqKjUD9w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1OTAiIGhlaWdodD0iOTk1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>点击「允许」</ul><p>下载完成后进入到手机的设定，会出现「已下载描述档」点击进入。</p><p><a href="/assets/b04f4fba3cf2/1*JzX7U1jCtda915mGz5CPjw.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*JzX7U1jCtda915mGz5CPjw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1OTAiIGhlaWdodD0iOTk1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/b04f4fba3cf2/1*mWmVPZ-au302NGHXgCxAow.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*mWmVPZ-au302NGHXgCxAow.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1OTAiIGhlaWdodD0iOTk1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/b04f4fba3cf2/1*SMnr82MEIo4YaYOvTpILeQ.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*SMnr82MEIo4YaYOvTpILeQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1OTAiIGhlaWdodD0iOTk1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>点击进入，右上角「安装」，输入手机密码完成安装。</ul><p>回到设定 -&gt; 「一般」-&gt;「关于本机」-&gt; 最下方「凭证信任设定」-&gt; 启用「mitmproxy」。</p><p><a href="/assets/b04f4fba3cf2/1*UOcYlpOolfWithLb517__g.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*UOcYlpOolfWithLb517__g.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1OTAiIGhlaWdodD0iOTk1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/b04f4fba3cf2/1*LAoe10TplFdfWXEHMRAvWw.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*LAoe10TplFdfWXEHMRAvWw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1OTAiIGhlaWdodD0iOTk1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li>「继续」完成启用。</ul><p>至此我们就完成中间人攻击所有的前置准备工作。</p><blockquote><p><em>要记得当前你手机所有的流量都会经过代理从你的 Mac 电脑出去， <strong>操作完毕记得回到手机上的网路设定把代理伺服器设定关掉</strong> ，否则手机网路 WiFi 会全部连不上对外网路。</em></p></blockquote><p>回到 Terminal mitmproxy，一边操做手机上的 App 就能看到所有被捕捉的 API 请求纪录。</p><p><a href="/assets/b04f4fba3cf2/1*-aRzC2HWRCvGok-L9jbjHA.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*-aRzC2HWRCvGok-L9jbjHA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MzYiIGhlaWdodD0iMzg0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>每个请求都能进入查看详细 Request &amp; Response 内容：</p><p><a href="/assets/b04f4fba3cf2/1*IyO00OEpAadapGKNtOV_Mg.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*IyO00OEpAadapGKNtOV_Mg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MzYiIGhlaWdodD0iMzc5Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>以上是 mitmproxy 基础设定与实际工作。</p><p><strong>3. 嗅探、了解 API 架构</strong></p><p>再来就要透过 mitmproxy 的 <code class="language-plaintext highlighter-rouge">mitmdump</code> 服务结合我之前开发的 <a href="https://github.com/ZhgChgLi/mitmproxy-rodo/tree/main" target="_blank"><strong>mitmproxy-rodo</strong></a> <a href="https://docs.mitmproxy.org/stable/addons-overview/" target="_blank">addons</a> 录制请求和回放请求。</p><blockquote><p><a href="/posts/zrealm-dev/zh-cn/end-to-end-testing-%E7%94%A8-snapshot-api-local-mock-server-%E8%A7%A3%E5%86%B3-ios-app-%E6%B5%8B%E8%AF%95%E8%B5%84%E6%96%99%E4%B8%8D%E7%A8%B3%E5%AE%9A%E9%97%AE%E9%A2%98-5a5c4b25a83d/"><em>我的实现原理</em></a> <em>是将 Request 请求参数计算成 Hash 值，在回放时再次将请求拿去计算 Hash 如果在本地有找到相同 Hash 值的备份 Response 则返回，如果有多个相同 Hash 值的请求会按照顺序储存＆回放。</em></p></blockquote><p>我们可以先透过以上方法嗅探 App 的 API (或使用 <a href="https://proxyman.io/" target="_blank">Proxyman</a> )，观察有哪些栏位跟哪些栏位可能会影响 Hash Mapping，可以将其记录下来，在后续设定排除， <strong>例如有的 API 固定会带 <code class="language-plaintext highlighter-rouge">?ts</code> 这参数不影响回传内容，但会影响 Hash 值计算导致无法找到本地的备份，我们就需要挑出来在后面的设定中排除掉</strong> 。</p><p><strong>4.设定 <a href="https://github.com/ZhgChgLi/mitmproxy-rodo/tree/main" target="_blank">mitmproxy-rodo</a> :</strong></p><p>使用我写好的录制、回放开源 Script。</p><blockquote><p><strong><em>细节参数设定请参考该开源专案的说明。</em></strong></p></blockquote><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>git clone git@github.com:ZhgChgLi/mitmproxy-rodo.git
<span class="nb">cd </span>mitmproxy-rodo
</pre></table></code></div></div><p>将上一步骤 3. 挑出来的参数填入到 config.json 设定档案中：</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"ignored"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"*"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"*"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"*"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"iterable"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
          </span><span class="nl">"enables"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"query"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"formData"</span><span class="w">
          </span><span class="p">],</span><span class="w">
          </span><span class="nl">"rules"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"query"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nl">"parameters"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"ts"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"connect_id"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"device_id"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"device_name"</span><span class="p">,</span><span class="w">
              </span><span class="p">]</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"formData"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nl">"parameters"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"aidck"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"device_id"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"ver_name"</span><span class="p">,</span><span class="w">
              </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>以上参数在计算 Hash 值时都会被排除，也能针对个别 Endpoint 路径设定特定排除规则。</p><p><strong>5. 启用录制，在 Terminal 下改执行：</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>mitmdump <span class="nt">-s</span> rodo.py <span class="nt">--set</span> <span class="nv">dumper_folder</span><span class="o">=</span>zhgchgli <span class="nt">--set</span> <span class="nv">config_file</span><span class="o">=</span>config.json <span class="nt">--set</span> <span class="nv">record</span><span class="o">=</span><span class="nb">true</span> <span class="s2">"~d zhgchg.li"</span>
</pre></table></code></div></div><ul><li><p>结尾的 <code class="language-plaintext highlighter-rouge">"~d zhgchg.li"</code> 意思是只截取 * .zhgchg.li 的流量。</p><li><p><code class="language-plaintext highlighter-rouge">dumper_folder</code> : 输出目的目录名称</p></ul><p><strong>6. 回到手机上操作目标 App 执行欲录制的流程路径</strong></p><ul><li><p>建议重启、重安装 App 用最干净的方式开始操作</p><li><p>建议可以搭配录影，以利记得复现步骤</p></ul><p><a href="/assets/b04f4fba3cf2/1*SeivG1XaRcd5uq2uMkyrSA.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*SeivG1XaRcd5uq2uMkyrSA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MjciIGhlaWdodD0iMzU2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>边操作的同时，就能看到输出目录会有很多撷取下来的 API Response Data，会照著 Domain -&gt; API 路径 -&gt; HTTP 方法 -&gt; Hash 值 -&gt; Header-X / Content-X 存放(若相同 Hash 请求两次，会按照顺序储存下来)。</p><ul><li><p>重新录制可以直接删出输出目录，让他重新撷取。</p><li><p><strong>如果回传的资料包含个资，请记得调整撷取内容去识别化。</strong></p></ul><h4 id="肉-回放撷取到的-api-response-data"><span class="me-2">[肉] 回放撷取到的 API Response Data</span><a href="#肉-回放撷取到的-api-response-data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>录制完毕后请务必要尝试回放一次，测试资料是否正常，若 Hash Hit 很低(回放时几乎都没找到对应的 Response)，可以重复嗅探步骤找到那个每次执行 App 都不确定影响 Hash 值的变数并将其排除。</p><p><strong>执行回放：</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>mitmdump <span class="nt">-s</span> rodo.py <span class="nt">--set</span> <span class="nv">dumper_folder</span><span class="o">=</span>zhgchgli <span class="nt">--set</span> <span class="nv">config_file</span><span class="o">=</span>config.json
</pre></table></code></div></div><ul><li><p><code class="language-plaintext highlighter-rouge">dumper_folder</code> : 输出目的目录名称</p><li><p>预设本地没有 Hash Mapping 到的 Response Data 会直接回传 404 让 App 空白，这样才能知道撷取的资料有没有效。</p></ul><p><a href="/assets/b04f4fba3cf2/1*0Cjy_5RZRq3tvE1Pc0lQ9A.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*0Cjy_5RZRq3tvE1Pc0lQ9A.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1OTAiIGhlaWdodD0iOTk1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/b04f4fba3cf2/1*JKorlo3EBeSWXhB9Exw4ZA.webp" class="popup img-link blur"><img data-src="/assets/b04f4fba3cf2/1*JKorlo3EBeSWXhB9Exw4ZA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1OTAiIGhlaWdodD0iOTk1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li><p>录制撷取时有经过过的路径页面，回放时能重新显示：OK!</p><li><p>录制撷取时没经过过的路径页面，回放时显示网路错误：OK!</p></ul><h3 id="缅怀-1"><span class="me-2">缅怀</span><a href="#缅怀-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>至此，我们已经可以自行透过还原骨与最后的肉，来复现当年 App 走进终点站前的最后时光，以此缅怀那个大家一起同心协力生产出来的时光。</p><p>以此篇文章纪念第一份工作的团队与当年从网页后端开发边做边学转职 iOS App 开发，独立从无到有在 3–4 个月的短暂时间，与 Android、设计、PM 主管、后端同事一同顺利生产出的产品，虽然它即将进入生命周期的终点站，但我永远都会记得当年的酸甜苦辣与第一次看到他上线、有人使用的那个感动。</p><blockquote><p>「谢谢」</p></blockquote><h4 id="欢迎协助贡献"><span class="me-2">欢迎协助贡献</span><a href="#欢迎协助贡献" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>如果你也有相同的遗憾，希望本篇文章也能帮助到你，因为 <a href="https://github.com/ZhgChgLi/mitmproxy-rodo/tree/main" target="_blank">mitmproxy-rodo</a> 当初只是 POC 概念验证下开发出的工具，欢迎协助贡献、提出遇到的 Bug 或开 PR 修改 Bug。</p><p><a href="https://github.com/ZhgChgLi/mitmproxy-rodo/tree/main?source=post_page-----5a5c4b25a83d--------------------------------" target="_blank" class="img-link shimmer" ><img src="https://repository-images.githubusercontent.com/686628812/44cf2ec7-4de1-4a10-b213-bf7dd30748a4" alt="" loading="lazy"></a></p><p>有任何问题及指教欢迎 <a href="https://www.zhgchg.li/contact" target="_blank">与我联络</a> 。</p><hr /><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=🍺&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a><br /></p><blockquote class="prompt-info"><p>本文首次发表于 Medium (<a href="https://medium.com/p/b04f4fba3cf2" target="_blank"><strong>点击查看原始版本</strong></a>)，由 <a href="/posts/tools/medium-to-jekyll/" target="_blank">ZMediumToMarkdown</a> 提供自动转换与同步技术。</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/zh-cn/zmediumtomarkdown/2024-05-14-b04f4fba3cf2.md" target="_blank">Improve this page on Github.</a></p></blockquote><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1K+ Followers</span></a></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-dev/">ZRealm Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/simplified-chinese/" class="post-tag no-text-decoration" >simplified-chinese</a> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/man-in-the-middle-attack/" class="post-tag no-text-decoration" >man-in-the-middle-attack</a> <a href="/tags/mitmproxy/" class="post-tag no-text-decoration" >mitmproxy</a> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a> <a href="/tags/app-development/" class="post-tag no-text-decoration" >app-development</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=App%20%E4%B8%8B%E6%9E%B6%E5%A4%87%E4%BB%BD%E6%94%BB%E7%95%A5%EF%BD%9Cmitmproxy%20%E4%B8%8E%20Apple%20Configurator%20%E6%8A%80%E6%9C%AF%E4%BF%9D%E5%AD%98%E4%B8%8E%E8%BF%98%E5%8E%9F%E6%95%99%E5%AD%A6%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fapp-%25E4%25B8%258B%25E6%259E%25B6%25E5%25A4%2587%25E4%25BB%25BD%25E6%2594%25BB%25E7%2595%25A5-mitmproxy-%25E4%25B8%258E-apple-configurator-%25E6%258A%2580%25E6%259C%25AF%25E4%25BF%259D%25E5%25AD%2598%25E4%25B8%258E%25E8%25BF%2598%25E5%258E%259F%25E6%2595%2599%25E5%25AD%25A6-b04f4fba3cf2%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=App%20%E4%B8%8B%E6%9E%B6%E5%A4%87%E4%BB%BD%E6%94%BB%E7%95%A5%EF%BD%9Cmitmproxy%20%E4%B8%8E%20Apple%20Configurator%20%E6%8A%80%E6%9C%AF%E4%BF%9D%E5%AD%98%E4%B8%8E%E8%BF%98%E5%8E%9F%E6%95%99%E5%AD%A6%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fapp-%25E4%25B8%258B%25E6%259E%25B6%25E5%25A4%2587%25E4%25BB%25BD%25E6%2594%25BB%25E7%2595%25A5-mitmproxy-%25E4%25B8%258E-apple-configurator-%25E6%258A%2580%25E6%259C%25AF%25E4%25BF%259D%25E5%25AD%2598%25E4%25B8%258E%25E8%25BF%2598%25E5%258E%259F%25E6%2595%2599%25E5%25AD%25A6-b04f4fba3cf2%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fapp-%25E4%25B8%258B%25E6%259E%25B6%25E5%25A4%2587%25E4%25BB%25BD%25E6%2594%25BB%25E7%2595%25A5-mitmproxy-%25E4%25B8%258E-apple-configurator-%25E6%258A%2580%25E6%259C%25AF%25E4%25BF%259D%25E5%25AD%2598%25E4%25B8%258E%25E8%25BF%2598%25E5%258E%259F%25E6%2595%2599%25E5%25AD%25A6-b04f4fba3cf2%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/travel-journals/en/tokyo-area-travel-guide-kawagoe-little-edo-atami-fireworks-festival-5-day-itinerary-958599363857/">Tokyo Area Travel Guide｜Kawagoe Little Edo & Atami Fireworks Festival 5-Day Itinerary</a><li class="text-truncate lh-lg"> <a href="/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/zh-cn/%E4%B8%9C%E4%BA%AC%E8%87%AA%E7%94%B1%E8%A1%8C%E6%94%BB%E7%95%A5-%E5%B7%9D%E8%B6%8A%E5%B0%8F%E6%B1%9F%E6%88%B7%E4%B8%80%E6%97%A5%E6%B8%B8%E4%B8%8E%E7%83%AD%E6%B5%B7%E6%B5%B7%E4%B8%8A%E8%8A%B1%E7%81%AB%E5%A4%A7%E4%BC%9A%E5%85%A8%E7%BA%AA%E5%BD%95-958599363857/">游记 2025 东京地区 — 川越小江户与热海海上花火大会 5 日自由行</a><li class="text-truncate lh-lg"> <a href="/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/%E6%9D%B1%E4%BA%AC%E8%87%AA%E7%94%B1%E8%A1%8C%E6%94%BB%E7%95%A5-%E5%B7%9D%E8%B6%8A%E5%B0%8F%E6%B1%9F%E6%88%B6%E4%B8%80%E6%97%A5%E9%81%8A%E8%88%87%E7%86%B1%E6%B5%B7%E6%B5%B7%E4%B8%8A%E8%8A%B1%E7%81%AB%E5%A4%A7%E6%9C%83%E5%85%A8%E7%B4%80%E9%8C%84-958599363857/">遊記 2025 東京地區 — 川越小江戶與熱海海上花火大會 5 日自由行</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/en/line-bank-to-firstrade-transfer-fast-deposit-150-nt-fee-guide-with-account-upgrade-fee-subsidy-e4d139fe0685/">LINE Bank to Firstrade Transfer｜Fast Deposit & 150 NT Fee Guide with Account Upgrade & Fee Subsidy</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/zh-cn/line-bank-%E5%85%A5%E9%87%91-firstrade-%E6%95%99%E5%AD%A6-%E5%BF%AB%E9%80%9F%E5%88%B0%E5%B8%90-%E4%BD%8E%E6%89%8B%E7%BB%AD%E8%B4%B9150%E5%85%83-%E5%B8%90%E6%88%B7%E5%8D%87%E7%BA%A7%E4%B8%8E%E6%89%8B%E7%BB%AD%E8%B4%B9%E8%A1%A5%E5%8A%A9%E7%94%B3%E8%AF%B7%E5%85%A8%E6%94%BB%E7%95%A5-e4d139fe0685/">手把手教学 — LINE Bank 入金 Firstrade 快速到帐、手续费只要 150 元及帐户升级/约定转帐/手续费补助申请教学</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">章節 (Chapters)🔖</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-dev/app-%E4%B8%8B%E6%9E%B6%E5%82%99%E4%BB%BD%E6%94%BB%E7%95%A5-mitmproxy-%E8%88%87-apple-configurator-%E6%8A%80%E8%A1%93%E4%BF%9D%E5%AD%98%E8%88%87%E9%82%84%E5%8E%9F%E6%95%99%E5%AD%B8-b04f4fba3cf2/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1715703645" data-df="ll" > May 15, 2024 </time><h4 class="pt-0 my-2">App 產品進入終點站，能做什麼事緬懷？</h4><div class="text-muted"><p>使用 mitmproxy + apple configurator 讓 App 永遠停留在下架前的狀態</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/en/app-lifecycle-management-mitmproxy-apple-configurator-for-preserving-removed-apps-b04f4fba3cf2/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1715703645" data-df="ll" > May 15, 2024 </time><h4 class="pt-0 my-2">App Lifecycle Management｜Mitmproxy & Apple Configurator for Preserving Removed Apps</h4><div class="text-muted"><p>Developers and users facing app discontinuation can use mitmproxy combined with Apple Configurator to keep apps permanently accessible in their last available state, preventing loss of functionalit...</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/zh-cn/slack-app-%E6%95%B4%E5%90%88-chatgpt-%E5%88%A9%E7%94%A8-openai-api-%E4%B8%8E-google-cloud-functions-%E8%87%AA%E5%BB%BA%E6%99%BA%E8%83%BD%E5%8A%A9%E7%90%86-bd94cc88f9c9/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1708089421" data-df="ll" > Feb 16, 2024 </time><h4 class="pt-0 my-2">Slack App 整合 ChatGPT｜利用 OpenAI API 与 Google Cloud Functions 自建智能助理</h4><div class="text-muted"><p>针对团队协作痛点，打造可自订 OpenAI API Key 的 Slack ChatGPT 机器人，运用 Google Cloud Functions 快速部署，实现即时问答与上下文串接，提升工作效率并保障资料安全。</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-dev/en/app-lifecycle-management-mitmproxy-apple-configurator-for-preserving-removed-apps-b04f4fba3cf2/" class="btn btn-outline-primary" aria-label="Older" ><p>App Lifecycle Management｜Mitmproxy & Apple Configurator for Preserving Removed Apps</p></a> <a href="/posts/zrealm-dev/app-%E4%B8%8B%E6%9E%B6%E5%82%99%E4%BB%BD%E6%94%BB%E7%95%A5-mitmproxy-%E8%88%87-apple-configurator-%E6%8A%80%E8%A1%93%E4%BF%9D%E5%AD%98%E8%88%87%E9%82%84%E5%8E%9F%E6%95%99%E5%AD%B8-b04f4fba3cf2/" class="btn btn-outline-primary" aria-label="Newer" ><p>App 產品進入終點站，能做什麼事緬懷？</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span> <a href="/">中文</a>|<a href="/tags/simplified-chinese">简中</a>|<a href="/tags/english/">English</a></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a> <br/></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
