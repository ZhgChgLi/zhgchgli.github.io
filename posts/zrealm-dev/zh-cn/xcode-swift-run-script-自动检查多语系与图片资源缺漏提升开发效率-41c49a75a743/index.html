<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Xcode Swift Run Script｜自动检查多语系与图片资源缺漏提升开发效率" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="iOS 开发者常遇多语系与图片资源错漏问题，透过 Swift 撰写 Run Script 自动检查语系重复、缺漏及图片未使用状态，快速定位错误并减少冗余，让专案建置更稳定且节省时间。" /><meta property="og:description" content="iOS 开发者常遇多语系与图片资源错漏问题，透过 Swift 撰写 Run Script 自动检查语系重复、缺漏及图片未使用状态，快速定位错误并减少冗余，让专案建置更稳定且节省时间。" /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-dev/zh-cn/xcode-swift-run-script-%E8%87%AA%E5%8A%A8%E6%A3%80%E6%9F%A5%E5%A4%9A%E8%AF%AD%E7%B3%BB%E4%B8%8E%E5%9B%BE%E7%89%87%E8%B5%84%E6%BA%90%E7%BC%BA%E6%BC%8F%E6%8F%90%E5%8D%87%E5%BC%80%E5%8F%91%E6%95%88%E7%8E%87-41c49a75a743/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-dev/zh-cn/xcode-swift-run-script-%E8%87%AA%E5%8A%A8%E6%A3%80%E6%9F%A5%E5%A4%9A%E8%AF%AD%E7%B3%BB%E4%B8%8E%E5%9B%BE%E7%89%87%E8%B5%84%E6%BA%90%E7%BC%BA%E6%BC%8F%E6%8F%90%E5%8D%87%E5%BC%80%E5%8F%91%E6%95%88%E7%8E%87-41c49a75a743/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/41c49a75a743/1*RU89TcfRAR5mmclMX9x57w.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-09-17T23:53:20+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/41c49a75a743/1*RU89TcfRAR5mmclMX9x57w.webp" /><meta property="twitter:title" content="Xcode Swift Run Script｜自动检查多语系与图片资源缺漏提升开发效率" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://medium.com/@zhgchgli/"},"dateModified":"2024-04-13T16:35:25+08:00","datePublished":"2020-09-17T23:53:20+08:00","description":"iOS 开发者常遇多语系与图片资源错漏问题，透过 Swift 撰写 Run Script 自动检查语系重复、缺漏及图片未使用状态，快速定位错误并减少冗余，让专案建置更稳定且节省时间。","headline":"Xcode Swift Run Script｜自动检查多语系与图片资源缺漏提升开发效率","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+","url":"https://zhgchg.li/assets/41c49a75a743/1*RU89TcfRAR5mmclMX9x57w.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-dev/zh-cn/xcode-swift-run-script-%E8%87%AA%E5%8A%A8%E6%A3%80%E6%9F%A5%E5%A4%9A%E8%AF%AD%E7%B3%BB%E4%B8%8E%E5%9B%BE%E7%89%87%E8%B5%84%E6%BA%90%E7%BC%BA%E6%BC%8F%E6%8F%90%E5%8D%87%E5%BC%80%E5%8F%91%E6%95%88%E7%8E%87-41c49a75a743/"},"url":"https://zhgchg.li/posts/zrealm-dev/zh-cn/xcode-swift-run-script-%E8%87%AA%E5%8A%A8%E6%A3%80%E6%9F%A5%E5%A4%9A%E8%AF%AD%E7%B3%BB%E4%B8%8E%E5%9B%BE%E7%89%87%E8%B5%84%E6%BA%90%E7%BC%BA%E6%BC%8F%E6%8F%90%E5%8D%87%E5%BC%80%E5%8F%91%E6%95%88%E7%8E%87-41c49a75a743/"}</script><title>Xcode Swift Run Script｜自动检查多语系与图片资源缺漏提升开发效率 | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script><link rel="alternate" hreflang="en" href="/posts/zrealm-dev/en/swift-run-script-in-xcode-localization-image-asset-checks-automated-41c49a75a743/"><link rel="alternate" hreflang="zh-Hant" href="/posts/zrealm-dev/xcode-swift-run-script-%E8%87%AA%E5%8B%95%E6%AA%A2%E6%9F%A5%E5%A4%9A%E8%AA%9E%E7%B3%BB%E8%88%87%E5%9C%96%E7%89%87%E8%B3%87%E6%BA%90%E7%BC%BA%E6%BC%8F%E6%8F%90%E5%8D%87%E9%96%8B%E7%99%BC%E6%95%88%E7%8E%87-41c49a75a743/"><link rel="alternate" hreflang="x-default" href="/posts/zrealm-dev/zh-cn/xcode-swift-run-script-%E8%87%AA%E5%8A%A8%E6%A3%80%E6%9F%A5%E5%A4%9A%E8%AF%AD%E7%B3%BB%E4%B8%8E%E5%9B%BE%E7%89%87%E8%B5%84%E6%BA%90%E7%BC%BA%E6%BC%8F%E6%8F%90%E5%8D%87%E5%BC%80%E5%8F%91%E6%95%88%E7%8E%87-41c49a75a743/"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0">An iOS, web, and automation developer from Taiwan 🇹🇼 who also loves sharing, traveling, and writing.</p><a href="https://medium.com/@zhgchgli" target="_blank" style="display: block;text-align: center;font-style: normal;/* text-decoration: underline; */font-size: 1.2em;color: var(--heading-color);">1K+ Followers on Medium</a></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/english/" class="nav-link"> <i class="fa-fw fa fa-solid fa-language"></i> <span>ENGLISH POSTS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Xcode Swift Run Script｜自动检查多语系与图片资源缺漏提升开发效率</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Xcode Swift Run Script｜自动检查多语系与图片资源缺漏提升开发效率</h1><p class="post-desc fw-light mb-4">iOS 开发者常遇多语系与图片资源错漏问题，透过 Swift 撰写 Run Script 自动检查语系重复、缺漏及图片未使用状态，快速定位错误并减少冗余，让专案建置更稳定且节省时间。</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1600358000" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Sep 17, 2020 </time> </span> <span> Updated <time data-ts="1712997325" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 13, 2024 </time> </span><div class="mt-3 mb-3"> <a href="/assets/41c49a75a743/1*RU89TcfRAR5mmclMX9x57w.webp" class="popup img-link preview-img blur"><img data-src="/assets/41c49a75a743/1*RU89TcfRAR5mmclMX9x57w.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></div><div class="d-flex justify-content-between"> <span style="display: inline-flex; align-items: center; gap: 4px;"> By <em> <a href="https://medium.com/@zhgchgli/">ZhgChgLi</a> </em> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" style="display: block; "><path fill="#007bff" d="M271.2 56C265.1 49.8 256.2 47.3 247.8 49.6C239.4 51.9 232.9 58.4 230.8 66.8L215.5 127C214.4 131.4 209.9 134 205.6 132.7L145.8 115.9C137.4 113.5 128.4 115.9 122.3 122C116.2 128.1 113.8 137.1 116.2 145.5L133.1 205.3C134.3 209.6 131.7 214.1 127.4 215.2L67.1 230.5C58.7 232.6 52.1 239.2 49.8 247.6C47.5 256 50 264.9 56.2 271L100.7 314.3C103.9 317.4 103.9 322.6 100.7 325.8L56.3 369.1C50.1 375.2 47.6 384.1 49.9 392.5C52.2 400.9 58.8 407.4 67.2 409.6L127.4 424.9C131.8 426 134.4 430.5 133.1 434.8L116.2 494.5C113.8 502.9 116.2 511.9 122.3 518C128.4 524.1 137.4 526.5 145.8 524.1L205.6 507.2C209.9 506 214.4 508.6 215.5 512.9L230.8 573.1C232.9 581.5 239.5 588.1 247.9 590.4C256.3 592.7 265.2 590.2 271.3 584L314.6 539.5C317.7 536.3 322.9 536.3 326.1 539.5L369.3 584C375.4 590.2 384.3 592.7 392.7 590.4C401.1 588.1 407.6 581.5 409.8 573.1L425.1 513C426.2 508.6 430.7 506 435 507.3L494.8 524.2C503.2 526.6 512.2 524.2 518.3 518.1C524.4 512 526.8 503 524.4 494.6L507.5 434.8C506.3 430.5 508.9 426 513.2 424.9L573.4 409.6C581.8 407.5 588.4 400.9 590.7 392.5C593 384.1 590.5 375.1 584.3 369.1L539.8 325.8C536.6 322.7 536.6 317.5 539.8 314.3L584.3 271C590.5 264.9 593 256 590.7 247.6C588.4 239.2 581.8 232.7 573.4 230.5L513.2 215.2C508.8 214.1 506.2 209.6 507.5 205.3L524.4 145.5C526.8 137.1 524.4 128.1 518.3 122C512.2 115.9 503.2 113.5 494.8 115.9L435 132.8C430.7 134 426.2 131.4 425.1 127.1L409.8 66.8C407.7 58.4 401.1 51.8 392.7 49.5C384.3 47.2 375.4 49.7 369.3 55.9L326 100.5C322.9 103.7 317.7 103.7 314.5 100.5L271.2 56z"/><path d="M250 330 l60 60 100 -140" stroke="#ffffff" stroke-width="40" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="5020 words" > <em>27 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Xcode Swift Run Script｜自动检查多语系与图片资源缺漏提升开发效率</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">章節 (Chapters)🔖</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Xcode Swift Run Script｜自动检查多语系与图片资源缺漏提升开发效率</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/en/swift-run-script-in-xcode-localization-image-asset-checks-automated-41c49a75a743/"><strong>Click here</strong></a> to view the English version of this article.</p></blockquote><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/xcode-swift-run-script-%E8%87%AA%E5%8B%95%E6%AA%A2%E6%9F%A5%E5%A4%9A%E8%AA%9E%E7%B3%BB%E8%88%87%E5%9C%96%E7%89%87%E8%B3%87%E6%BA%90%E7%BC%BA%E6%BC%8F%E6%8F%90%E5%8D%87%E9%96%8B%E7%99%BC%E6%95%88%E7%8E%87-41c49a75a743/"><strong>點擊這裡</strong></a>查看本文章正體中文版本。</p></blockquote><blockquote class="prompt-info"><p>基于 SEO 考量，本文标题与描述经 AI 调整，原始版本请参考内文。</p></blockquote><hr /><h3 id="xcode-直接使用-swift-撰写-shell-script"><span class="me-2">Xcode 直接使用 Swift 撰写 Shell Script！</span><a href="#xcode-直接使用-swift-撰写-shell-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>导入 Localization 多语系及 Image Assets 缺漏检查、使用 Swift 打造 Shell Script 脚本</p><p><a href="/assets/41c49a75a743/1*RU89TcfRAR5mmclMX9x57w.webp" class="popup img-link blur"><img data-src="/assets/41c49a75a743/1*RU89TcfRAR5mmclMX9x57w.webp" alt="Photo by [Glenn Carstens-Peters](https://unsplash.com/@glenncarstenspeters?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjkzMiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Photo by <a href="https://unsplash.com/@glenncarstenspeters?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank">Glenn Carstens-Peters</a></p><h3 id="缘由"><span class="me-2">缘由</span><a href="#缘由" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>因为自己手残，时常在编辑多语系档案时遗漏「;」导致 app build 出来语言显示出错再加上随著开发的推移语系档案越来越庞大，重复的、已没用到的语句都夹杂再一起，非常混乱（Image Assets 同样状况）。</p><p>一直以来都想找工具协助处理这方面的问题，之前是用 <a href="https://github.com/igorkulman/iOSLocalizationEditor" target="_blank">iOSLocalizationEditor</a> 这个 Mac APP，但它比较像是语系档案编辑器，读取语系档案内容＆编辑，没有自动检查的功能。</p><h3 id="期望功能"><span class="me-2">期望功能</span><a href="#期望功能" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>build 专案时能自动检查多语系有无错误、缺露、重复、Image Assets 有无缺漏。</p><h3 id="解决方案"><span class="me-2">解决方案</span><a href="#解决方案" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>要达到我们的期望功能就要在 Build Phases 加入 Run Script 检查脚本。</p><p>但检查脚本需要使用 shell script 撰写，因自己对 shell script 的掌握度并不太高，想说站在巨人的肩膀上从网路搜寻现有脚本也找不太到完全符合期望功能的 script，再快要放弃的时候突然想到：</p><blockquote><p><strong>Shell Script 可以用 Swift 来写啊</strong> ！</p></blockquote><p>相对 shell script 来说更熟悉、掌握度更高！依照这个方向果然让我找到两个现有的工具脚本！</p><p>由 <a href="https://freshos.github.io/" target="_blank">freshOS</a> 这个团队撰写的两个检查工具：</p><ul><li><p><a href="https://github.com/freshOS/Localize" target="_blank"><strong>Localize 🏁</strong></a></p><li><p><a href="https://github.com/s4cha/AssetChecker" target="_blank"><strong>Asset Checker 👮</strong></a></p></ul><p>完全符合我们的期望功能需求! ! 并且他们使用 swift 撰写，要客制化魔改都很容易。</p><h4 id="localize--多语系档检查工具"><span class="me-2"><a href="https://github.com/freshOS/Localize" target="_blank">Localize 🏁</a> 多语系档检查工具</span><a href="#localize--多语系档检查工具" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><strong>功能：</strong></p><ul><li><p>build 时自动检查</p><li><p>语系档自动排版、整理</p><li><p>检查多语系与主要语系之缺漏、多余</p><li><p>检查多语系重复语句</p><li><p>检查多语系未经翻译语句</p><li><p>检查多语系未使用的语句</p></ul><p><strong>安装方法：</strong></p><ol><li><p><a href="https://github.com/freshOS/Localize/blob/master/Localize.swift" target="_blank">下载工具的 Swift Script 档案</a></p><li><p>放到专案目录下 EX: <code class="language-plaintext highlighter-rouge">${SRCROOT}/Localize.swift</code></p><li><p>打开专案设定 → iOS Target → Build Phases →左上角「+」 → New Run Script Phases → 在 Script 内容贴上路径 EX: <code class="language-plaintext highlighter-rouge">${SRCROOT}/Localize.swift</code></p></ol><p><a href="/assets/41c49a75a743/1*k2OHjrcQaQIWLqV7G57TgA.webp" class="popup img-link blur"><img data-src="/assets/41c49a75a743/1*k2OHjrcQaQIWLqV7G57TgA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjQwNyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><ol><li>使用 Xcode 打开编辑 <code class="language-plaintext highlighter-rouge">Localize.swift</code> 档案进行设定，可以在档案上半部看到可更动的设定项目：</ol><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="c1">//启用检查脚本</span>
<span class="k">let</span> <span class="nv">enabled</span> <span class="o">=</span> <span class="kc">true</span>

<span class="c1">//语系档案目录</span>
<span class="k">let</span> <span class="nv">relativeLocalizableFolders</span> <span class="o">=</span> <span class="s">"/Resources/Languages"</span>

<span class="c1">//专案目录（用来搜索语句有没有在程式码中使用到）</span>
<span class="k">let</span> <span class="nv">relativeSourceFolder</span> <span class="o">=</span> <span class="s">"/Sources"</span>

<span class="c1">//程式码中的 NSLocalized 语系档案使用正规匹配表示法</span>
<span class="c1">//可自行增加、无需变动</span>
<span class="k">let</span> <span class="nv">patterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">"NSLocalized(Format)?String</span><span class="se">\\</span><span class="s">(</span><span class="se">\\</span><span class="s">s*@?</span><span class="se">\"</span><span class="s">([</span><span class="se">\\</span><span class="s">w</span><span class="se">\\</span><span class="s">.]+)</span><span class="se">\"</span><span class="s">"</span><span class="p">,</span> <span class="c1">// Swift and Objc Native</span>
    <span class="s">"Localizations</span><span class="se">\\</span><span class="s">.((?:[A-Z]{1}[a-z]*[A-z]*)*(?:</span><span class="se">\\</span><span class="s">.[A-Z]{1}[a-z]*[A-z]*)*)"</span><span class="p">,</span> <span class="c1">// Laurine Calls</span>
    <span class="s">"L10n.tr</span><span class="se">\\</span><span class="s">(key: </span><span class="se">\"</span><span class="s">(</span><span class="se">\\</span><span class="s">w+)</span><span class="se">\"</span><span class="s">"</span><span class="p">,</span> <span class="c1">// SwiftGen generation</span>
    <span class="s">"ypLocalized</span><span class="se">\\</span><span class="s">(</span><span class="se">\"</span><span class="s">(.*)</span><span class="se">\"\\</span><span class="s">)"</span><span class="p">,</span>
    <span class="s">"</span><span class="se">\"</span><span class="s">(.*)</span><span class="se">\"</span><span class="s">.localized"</span> <span class="c1">// "key".localized pattern</span>
<span class="p">]</span>

<span class="c1">//要忽略「语句未使用警告」的语句</span>
<span class="k">let</span> <span class="nv">ignoredFromUnusedKeys</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="cm">/* example
let ignoredFromUnusedKeys = [
    "NotificationNoOne",
    "NotificationCommentPhoto",
    "NotificationCommentHisPhoto",
    "NotificationCommentHerPhoto"
]
*/</span>

<span class="c1">//主要语系</span>
<span class="k">let</span> <span class="nv">masterLanguage</span> <span class="o">=</span> <span class="s">"en"</span>

<span class="c1">//开启与系档案a-z排序、整理功能</span>
<span class="k">let</span> <span class="nv">sanitizeFiles</span> <span class="o">=</span> <span class="kc">false</span>

<span class="c1">//专案是单一or多语系</span>
<span class="k">let</span> <span class="nv">singleLanguage</span> <span class="o">=</span> <span class="kc">false</span>

<span class="c1">//启用检查未翻译语句功能</span>
<span class="k">let</span> <span class="nv">checkForUntranslated</span> <span class="o">=</span> <span class="kc">true</span>
</pre></table></code></div></div><ol><li>Build！成功！</ol><p><a href="/assets/41c49a75a743/1*74osParg9RRi2gcRx9ELuw.webp" class="popup img-link blur"><img data-src="/assets/41c49a75a743/1*74osParg9RRi2gcRx9ELuw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNjQiIGhlaWdodD0iNDA0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><strong>检查结果提示类型：</strong></p><ul><li><strong>Build Error</strong> ❌ <strong>：</strong><ul><li>[Duplication] 项目在语系档案内存在重复<li>[Unused Key] 项目在语系档案内有定义，但实际程式中未使用到<li>[Missing] 项目在语系档案内未定义，但实际程式中有使用到<li>[Redundant] 项目在此语系档相较于主要语系档是多余的<li>[Missing Translation] 项目在主要语系档有，但在此语系档缺漏</ul><li><strong>Build Warning</strong> ⚠️ <strong>：</strong><ul><li>[Potentially Untranslated] 此项目未经翻译（与主语系档项目内容相同）</ul></ul><blockquote><p><strong><em>还没结束，现在自动检查提示有了，但我们还需要自行魔改一下。</em></strong></p></blockquote><p><strong>客制化匹配正规表示：</strong></p><p>回头看检查脚本 <code class="language-plaintext highlighter-rouge">Localize.swift</code> 顶部设定区块 patterns 部分的第一项：</p><p><code class="language-plaintext highlighter-rouge">"NSLocalized(Format)?String\\(\\s*@?\"([\\w\\.]+)\""</code></p><p>匹配 Swift/ObjC的 <code class="language-plaintext highlighter-rouge">NSLocalizedString()</code> 方法，这个正规表示式只能匹配 <code class="language-plaintext highlighter-rouge">"Home.Title"</code> 这种格式的语句；假设我们是完整句子或有带 Format 参数，则会被当误当成 [Unused Key]。</p><p>EX: <code class="language-plaintext highlighter-rouge">"Hi, %@ welcome to my app"、"Hello World!"</code> <strong>&lt;- 这些语句都无法匹配</strong></p><p>我们可以新增一条 patterns 设定、或更改原本的 patterns 成：</p><p><code class="language-plaintext highlighter-rouge">"NSLocalized(Format)?String\\(\\s*@?\"([^(\")]+)\""</code></p><p>主要是调整 <code class="language-plaintext highlighter-rouge">NSLocalizedString</code> 方法后的匹配语句，变成取任意字串直到 <code class="language-plaintext highlighter-rouge">"</code> 出现就中止，你也可以 <a href="https://rubular.com/r/5eXvGy3svsAHyT" target="_blank">点此</a> 依照自己的需求进行客制。</p><p><strong>加上语系档案格式检查功能：</strong></p><p>此脚本仅针对语系档做内容对应检查，不会检查档案格式是否正确（是否有忘记加「 <strong>;</strong> 」），如果需要这个功能要自己加上！</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="c1">//....</span>
<span class="k">let</span> <span class="nv">formatResult</span> <span class="o">=</span> <span class="nf">shell</span><span class="p">(</span><span class="s">"plutil -lint </span><span class="se">\(</span><span class="n">location</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
<span class="k">guard</span> <span class="n">formatResult</span><span class="o">.</span><span class="nf">trimmingCharacters</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="o">.</span><span class="n">whitespacesAndNewlines</span><span class="p">)</span><span class="o">.</span><span class="nf">suffix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="s">"OK"</span> <span class="k">else</span> <span class="p">{</span>
  <span class="k">let</span> <span class="nv">str</span> <span class="o">=</span> <span class="s">"</span><span class="se">\(</span><span class="n">path</span><span class="se">)</span><span class="s">/</span><span class="se">\(</span><span class="n">name</span><span class="se">)</span><span class="s">.lproj"</span>
            <span class="o">+</span> <span class="s">"/Localizable.strings:1: "</span>
            <span class="o">+</span> <span class="s">"error: [File Invaild] "</span>
            <span class="o">+</span> <span class="s">"This Localizable.strings file format is invalid."</span>
  <span class="nf">print</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
  <span class="n">numberOfErrors</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="k">return</span>
<span class="p">}</span>
<span class="c1">//....</span>

<span class="kd">func</span> <span class="nf">shell</span><span class="p">(</span><span class="n">_</span> <span class="nv">command</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">String</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">task</span> <span class="o">=</span> <span class="kt">Process</span><span class="p">()</span>
    <span class="k">let</span> <span class="nv">pipe</span> <span class="o">=</span> <span class="kt">Pipe</span><span class="p">()</span>

    <span class="n">task</span><span class="o">.</span><span class="n">standardOutput</span> <span class="o">=</span> <span class="n">pipe</span>
    <span class="n">task</span><span class="o">.</span><span class="n">arguments</span> <span class="o">=</span> <span class="p">[</span><span class="s">"-c"</span><span class="p">,</span> <span class="n">command</span><span class="p">]</span>
    <span class="n">task</span><span class="o">.</span><span class="n">launchPath</span> <span class="o">=</span> <span class="s">"/bin/bash"</span>
    <span class="n">task</span><span class="o">.</span><span class="nf">launch</span><span class="p">()</span>

    <span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">fileHandleForReading</span><span class="o">.</span><span class="nf">readDataToEndOfFile</span><span class="p">()</span>
    <span class="k">let</span> <span class="nv">output</span> <span class="o">=</span> <span class="kt">String</span><span class="p">(</span><span class="nv">data</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span> <span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span><span class="o">!</span>

    <span class="k">return</span> <span class="n">output</span>
<span class="p">}</span>
</pre></table></code></div></div><p>增加 <code class="language-plaintext highlighter-rouge">shell()</code> 执行 shell script，使用 <code class="language-plaintext highlighter-rouge">plutil -lint</code> 检查 plist 语系档案格式正确性，有错、少「;」会回传错误，没错会回传 <code class="language-plaintext highlighter-rouge">OK</code> 以此作为判断！</p><p>检查的地方可加在 LocalizationFiles-&gt;process( ) -&gt; <code class="language-plaintext highlighter-rouge">let location = singleLanguage…</code> 后，约 135 行的地方或参考我最后提供的完整魔改版。</p><p><strong>其他客制化：</strong></p><p>我们可以依照自己的需求进行客制，例如把 error 换成 warning 或是拔掉某个检查功能 (EX: Potentially Untranslated、Unused Key)；脚本就是 swift 我们都很熟悉！不怕改坏改错！</p><p>要让 build 时出现 Error ❌：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>print("Project档案.lproj" + "/档案:行: " + "error: 错误讯息")
</pre></table></code></div></div><p>要让 build 时出现 Warning ⚠️：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>print("Project档案.lproj" + "/档案:行: " + "warning: 警告讯息")
</pre></table></code></div></div><p><strong>最终魔改版：</strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
</pre><td class="rouge-code"><pre><span class="cp">#!/usr/bin/env xcrun --sdk macosx swift</span>

<span class="kd">import</span> <span class="kt">Foundation</span>

<span class="c1">// WHAT</span>
<span class="c1">// 1. Find Missing keys in other Localisation files</span>
<span class="c1">// 2. Find potentially untranslated keys</span>
<span class="c1">// 3. Find Duplicate keys</span>
<span class="c1">// 4. Find Unused keys and generate script to delete them all at once</span>

<span class="c1">// MARK: Start Of Configurable Section</span>

<span class="cm">/*
 You can enable or disable the script whenever you want
 */</span>
<span class="k">let</span> <span class="nv">enabled</span> <span class="o">=</span> <span class="kc">true</span>

<span class="cm">/*
 Put your path here, example -&gt;  Resources/Localizations/Languages
 */</span>
<span class="k">let</span> <span class="nv">relativeLocalizableFolders</span> <span class="o">=</span> <span class="s">"/streetvoice/SupportingFiles"</span>

<span class="cm">/*
 This is the path of your source folder which will be used in searching
 for the localization keys you actually use in your project
 */</span>
<span class="k">let</span> <span class="nv">relativeSourceFolder</span> <span class="o">=</span> <span class="s">"/streetvoice"</span>

<span class="cm">/*
 Those are the regex patterns to recognize localizations.
 */</span>
<span class="k">let</span> <span class="nv">patterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">"NSLocalized(Format)?String</span><span class="se">\\</span><span class="s">(</span><span class="se">\\</span><span class="s">s*@?</span><span class="se">\"</span><span class="s">([^(</span><span class="se">\"</span><span class="s">)]+)</span><span class="se">\"</span><span class="s">"</span><span class="p">,</span> <span class="c1">// Swift and Objc Native</span>
    <span class="s">"Localizations</span><span class="se">\\</span><span class="s">.((?:[A-Z]{1}[a-z]*[A-z]*)*(?:</span><span class="se">\\</span><span class="s">.[A-Z]{1}[a-z]*[A-z]*)*)"</span><span class="p">,</span> <span class="c1">// Laurine Calls</span>
    <span class="s">"L10n.tr</span><span class="se">\\</span><span class="s">(key: </span><span class="se">\"</span><span class="s">(</span><span class="se">\\</span><span class="s">w+)</span><span class="se">\"</span><span class="s">"</span><span class="p">,</span> <span class="c1">// SwiftGen generation</span>
    <span class="s">"ypLocalized</span><span class="se">\\</span><span class="s">(</span><span class="se">\"</span><span class="s">(.*)</span><span class="se">\"\\</span><span class="s">)"</span><span class="p">,</span>
    <span class="s">"</span><span class="se">\"</span><span class="s">(.*)</span><span class="se">\"</span><span class="s">.localized"</span> <span class="c1">// "key".localized pattern</span>
<span class="p">]</span>

<span class="cm">/*
 Those are the keys you don't want to be recognized as "unused"
 For instance, Keys that you concatenate will not be detected by the parsing
 so you want to add them here in order not to create false positives :)
 */</span>
<span class="k">let</span> <span class="nv">ignoredFromUnusedKeys</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="cm">/* example
let ignoredFromUnusedKeys = [
    "NotificationNoOne",
    "NotificationCommentPhoto",
    "NotificationCommentHisPhoto",
    "NotificationCommentHerPhoto"
]
*/</span>

<span class="k">let</span> <span class="nv">masterLanguage</span> <span class="o">=</span> <span class="s">"base"</span>

<span class="cm">/*
 Sanitizing files will remove comments, empty lines and order your keys alphabetically.
 */</span>
<span class="k">let</span> <span class="nv">sanitizeFiles</span> <span class="o">=</span> <span class="kc">false</span>

<span class="cm">/*
 Determines if there are multiple localizations or not.
 */</span>
<span class="k">let</span> <span class="nv">singleLanguage</span> <span class="o">=</span> <span class="kc">false</span>

<span class="cm">/*
 Determines if we should show errors if there's a key within the app
 that does not appear in master translations.
*/</span>
<span class="k">let</span> <span class="nv">checkForUntranslated</span> <span class="o">=</span> <span class="kc">false</span>

<span class="c1">// MARK: End Of Configurable Section</span>

<span class="k">if</span> <span class="n">enabled</span> <span class="o">==</span> <span class="kc">false</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Localization check cancelled"</span><span class="p">)</span>
    <span class="nf">exit</span><span class="p">(</span><span class="mo">000</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// Detect list of supported languages automatically</span>
<span class="kd">func</span> <span class="nf">listSupportedLanguages</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">sl</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">let</span> <span class="nv">path</span> <span class="o">=</span> <span class="kt">FileManager</span><span class="o">.</span><span class="k">default</span><span class="o">.</span><span class="n">currentDirectoryPath</span> <span class="o">+</span> <span class="n">relativeLocalizableFolders</span>
    <span class="k">if</span> <span class="o">!</span><span class="kt">FileManager</span><span class="o">.</span><span class="k">default</span><span class="o">.</span><span class="nf">fileExists</span><span class="p">(</span><span class="nv">atPath</span><span class="p">:</span> <span class="n">path</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Invalid configuration: </span><span class="se">\(</span><span class="n">path</span><span class="se">)</span><span class="s"> does not exist."</span><span class="p">)</span>
        <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">let</span> <span class="nv">enumerator</span> <span class="o">=</span> <span class="kt">FileManager</span><span class="o">.</span><span class="k">default</span><span class="o">.</span><span class="nf">enumerator</span><span class="p">(</span><span class="nv">atPath</span><span class="p">:</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">extensionName</span> <span class="o">=</span> <span class="s">"lproj"</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Found these languages:"</span><span class="p">)</span>
    <span class="k">while</span> <span class="k">let</span> <span class="nv">element</span> <span class="o">=</span> <span class="n">enumerator</span><span class="p">?</span><span class="o">.</span><span class="nf">nextObject</span><span class="p">()</span> <span class="k">as?</span> <span class="kt">String</span> <span class="p">{</span>
        <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="n">extensionName</span><span class="p">)</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
            <span class="k">let</span> <span class="nv">name</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="nf">replacingOccurrences</span><span class="p">(</span><span class="nv">of</span><span class="p">:</span> <span class="s">".</span><span class="se">\(</span><span class="n">extensionName</span><span class="se">)</span><span class="s">"</span><span class="p">,</span> <span class="nv">with</span><span class="p">:</span> <span class="s">""</span><span class="p">)</span>
            <span class="n">sl</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">sl</span>
<span class="p">}</span>

<span class="k">let</span> <span class="nv">supportedLanguages</span> <span class="o">=</span> <span class="nf">listSupportedLanguages</span><span class="p">()</span>
<span class="k">var</span> <span class="nv">ignoredFromSameTranslation</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[:]</span>
<span class="k">let</span> <span class="nv">path</span> <span class="o">=</span> <span class="kt">FileManager</span><span class="o">.</span><span class="k">default</span><span class="o">.</span><span class="n">currentDirectoryPath</span> <span class="o">+</span> <span class="n">relativeLocalizableFolders</span>
<span class="k">var</span> <span class="nv">numberOfWarnings</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">var</span> <span class="nv">numberOfErrors</span> <span class="o">=</span> <span class="mi">0</span>

<span class="kd">struct</span> <span class="kt">LocalizationFiles</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">name</span> <span class="o">=</span> <span class="s">""</span>
    <span class="k">var</span> <span class="nv">keyValue</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">String</span><span class="p">]</span> <span class="o">=</span> <span class="p">[:]</span>
    <span class="k">var</span> <span class="nv">linesNumbers</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">Int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[:]</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="nf">process</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="k">mutating</span> <span class="kd">func</span> <span class="nf">process</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="n">sanitizeFiles</span> <span class="p">{</span>
            <span class="nf">removeCommentsFromFile</span><span class="p">()</span>
            <span class="nf">removeEmptyLinesFromFile</span><span class="p">()</span>
            <span class="nf">sortLinesAlphabetically</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="k">let</span> <span class="nv">location</span> <span class="o">=</span> <span class="n">singleLanguage</span> <span class="p">?</span> <span class="s">"</span><span class="se">\(</span><span class="n">path</span><span class="se">)</span><span class="s">/Localizable.strings"</span> <span class="p">:</span> <span class="s">"</span><span class="se">\(</span><span class="n">path</span><span class="se">)</span><span class="s">/</span><span class="se">\(</span><span class="n">name</span><span class="se">)</span><span class="s">.lproj/Localizable.strings"</span>
        
        <span class="k">let</span> <span class="nv">formatResult</span> <span class="o">=</span> <span class="nf">shell</span><span class="p">(</span><span class="s">"plutil -lint </span><span class="se">\(</span><span class="n">location</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="k">guard</span> <span class="n">formatResult</span><span class="o">.</span><span class="nf">trimmingCharacters</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="o">.</span><span class="n">whitespacesAndNewlines</span><span class="p">)</span><span class="o">.</span><span class="nf">suffix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="s">"OK"</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">str</span> <span class="o">=</span> <span class="s">"</span><span class="se">\(</span><span class="n">path</span><span class="se">)</span><span class="s">/</span><span class="se">\(</span><span class="n">name</span><span class="se">)</span><span class="s">.lproj"</span>
                <span class="o">+</span> <span class="s">"/Localizable.strings:1: "</span>
                <span class="o">+</span> <span class="s">"error: [File Invaild] "</span>
                <span class="o">+</span> <span class="s">"This Localizable.strings file format is invalid."</span>
            <span class="nf">print</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
            <span class="n">numberOfErrors</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span>
        <span class="p">}</span>
        
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">string</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="kt">String</span><span class="p">(</span><span class="nv">contentsOfFile</span><span class="p">:</span> <span class="n">location</span><span class="p">,</span> <span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>

        <span class="k">let</span> <span class="nv">lines</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="nf">components</span><span class="p">(</span><span class="nv">separatedBy</span><span class="p">:</span> <span class="o">.</span><span class="n">newlines</span><span class="p">)</span>
        <span class="n">keyValue</span> <span class="o">=</span> <span class="p">[:]</span>

        <span class="k">let</span> <span class="nv">pattern</span> <span class="o">=</span> <span class="s">"</span><span class="se">\"</span><span class="s">(.*)</span><span class="se">\"</span><span class="s"> = </span><span class="se">\"</span><span class="s">(.+)</span><span class="se">\"</span><span class="s">;"</span>
        <span class="k">let</span> <span class="nv">regex</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="kt">NSRegularExpression</span><span class="p">(</span><span class="nv">pattern</span><span class="p">:</span> <span class="n">pattern</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[])</span>
        <span class="k">var</span> <span class="nv">ignoredTranslation</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="p">(</span><span class="n">lineNumber</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span> <span class="k">in</span> <span class="n">lines</span><span class="o">.</span><span class="nf">enumerated</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">range</span> <span class="o">=</span> <span class="kt">NSRange</span><span class="p">(</span><span class="nv">location</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">length</span><span class="p">:</span> <span class="p">(</span><span class="n">line</span> <span class="k">as</span> <span class="kt">NSString</span><span class="p">)</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>

            <span class="c1">// Ignored pattern</span>
            <span class="k">let</span> <span class="nv">ignoredPattern</span> <span class="o">=</span> <span class="s">"</span><span class="se">\"</span><span class="s">(.*)</span><span class="se">\"</span><span class="s"> = </span><span class="se">\"</span><span class="s">(.+)</span><span class="se">\"</span><span class="s">; *</span><span class="se">\\</span><span class="s">/</span><span class="se">\\</span><span class="s">/ *ignore-same-translation-warning"</span>
            <span class="k">let</span> <span class="nv">ignoredRegex</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="kt">NSRegularExpression</span><span class="p">(</span><span class="nv">pattern</span><span class="p">:</span> <span class="n">ignoredPattern</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[])</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">ignoredMatch</span> <span class="o">=</span> <span class="n">ignoredRegex</span><span class="p">?</span><span class="o">.</span><span class="nf">firstMatch</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="n">line</span><span class="p">,</span>
                                                           <span class="nv">options</span><span class="p">:</span> <span class="p">[],</span>
                                                           <span class="nv">range</span><span class="p">:</span> <span class="n">range</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">let</span> <span class="nv">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span> <span class="k">as</span> <span class="kt">NSString</span><span class="p">)</span><span class="o">.</span><span class="nf">substring</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">ignoredMatch</span><span class="o">.</span><span class="nf">range</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="mi">1</span><span class="p">))</span>
                <span class="n">ignoredTranslation</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="k">let</span> <span class="nv">firstMatch</span> <span class="o">=</span> <span class="n">regex</span><span class="p">?</span><span class="o">.</span><span class="nf">firstMatch</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="n">line</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[],</span> <span class="nv">range</span><span class="p">:</span> <span class="n">range</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">let</span> <span class="nv">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span> <span class="k">as</span> <span class="kt">NSString</span><span class="p">)</span><span class="o">.</span><span class="nf">substring</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">firstMatch</span><span class="o">.</span><span class="nf">range</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="mi">1</span><span class="p">))</span>
                <span class="k">let</span> <span class="nv">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span> <span class="k">as</span> <span class="kt">NSString</span><span class="p">)</span><span class="o">.</span><span class="nf">substring</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">firstMatch</span><span class="o">.</span><span class="nf">range</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="mi">2</span><span class="p">))</span>

                <span class="k">if</span> <span class="n">keyValue</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
                    <span class="k">let</span> <span class="nv">str</span> <span class="o">=</span> <span class="s">"</span><span class="se">\(</span><span class="n">path</span><span class="se">)</span><span class="s">/</span><span class="se">\(</span><span class="n">name</span><span class="se">)</span><span class="s">.lproj"</span>
                        <span class="o">+</span> <span class="s">"/Localizable.strings:</span><span class="se">\(</span><span class="n">linesNumbers</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">!</span><span class="se">)</span><span class="s">: "</span>
                        <span class="o">+</span> <span class="s">"error: [Duplication] </span><span class="se">\"\(</span><span class="n">key</span><span class="se">)\"</span><span class="s"> "</span>
                        <span class="o">+</span> <span class="s">"is duplicated in </span><span class="se">\(</span><span class="n">name</span><span class="o">.</span><span class="nf">uppercased</span><span class="p">()</span><span class="se">)</span><span class="s"> file"</span>
                    <span class="nf">print</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
                    <span class="n">numberOfErrors</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="n">keyValue</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="n">linesNumbers</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">lineNumber</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">ignoredFromSameTranslation</span><span class="p">)</span>
        <span class="n">ignoredFromSameTranslation</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ignoredTranslation</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">rebuildFileString</span><span class="p">(</span><span class="n">from</span> <span class="nv">lines</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kt">String</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">lines</span><span class="o">.</span><span class="nf">reduce</span><span class="p">(</span><span class="s">""</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="nv">r</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">s</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">String</span> <span class="nf">in</span>
            <span class="p">(</span><span class="n">r</span> <span class="o">==</span> <span class="s">""</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span> <span class="p">:</span> <span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">removeEmptyLinesFromFile</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">location</span> <span class="o">=</span> <span class="s">"</span><span class="se">\(</span><span class="n">path</span><span class="se">)</span><span class="s">/</span><span class="se">\(</span><span class="n">name</span><span class="se">)</span><span class="s">.lproj/Localizable.strings"</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">string</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="kt">String</span><span class="p">(</span><span class="nv">contentsOfFile</span><span class="p">:</span> <span class="n">location</span><span class="p">,</span> <span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">var</span> <span class="nv">lines</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="nf">components</span><span class="p">(</span><span class="nv">separatedBy</span><span class="p">:</span> <span class="o">.</span><span class="n">newlines</span><span class="p">)</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">filter</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">trimmingCharacters</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="o">.</span><span class="n">whitespaces</span><span class="p">)</span> <span class="o">!=</span> <span class="s">""</span> <span class="p">}</span>
            <span class="k">let</span> <span class="nv">s</span> <span class="o">=</span> <span class="nf">rebuildFileString</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">lines</span><span class="p">)</span>
            <span class="k">try</span><span class="p">?</span> <span class="n">s</span><span class="o">.</span><span class="nf">write</span><span class="p">(</span><span class="nv">toFile</span><span class="p">:</span> <span class="n">location</span><span class="p">,</span> <span class="nv">atomically</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">removeCommentsFromFile</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">location</span> <span class="o">=</span> <span class="s">"</span><span class="se">\(</span><span class="n">path</span><span class="se">)</span><span class="s">/</span><span class="se">\(</span><span class="n">name</span><span class="se">)</span><span class="s">.lproj/Localizable.strings"</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">string</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="kt">String</span><span class="p">(</span><span class="nv">contentsOfFile</span><span class="p">:</span> <span class="n">location</span><span class="p">,</span> <span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">var</span> <span class="nv">lines</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="nf">components</span><span class="p">(</span><span class="nv">separatedBy</span><span class="p">:</span> <span class="o">.</span><span class="n">newlines</span><span class="p">)</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">filter</span> <span class="p">{</span> <span class="o">!</span><span class="nv">$0</span><span class="o">.</span><span class="nf">hasPrefix</span><span class="p">(</span><span class="s">"//"</span><span class="p">)</span> <span class="p">}</span>
            <span class="k">let</span> <span class="nv">s</span> <span class="o">=</span> <span class="nf">rebuildFileString</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">lines</span><span class="p">)</span>
            <span class="k">try</span><span class="p">?</span> <span class="n">s</span><span class="o">.</span><span class="nf">write</span><span class="p">(</span><span class="nv">toFile</span><span class="p">:</span> <span class="n">location</span><span class="p">,</span> <span class="nv">atomically</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">sortLinesAlphabetically</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">location</span> <span class="o">=</span> <span class="s">"</span><span class="se">\(</span><span class="n">path</span><span class="se">)</span><span class="s">/</span><span class="se">\(</span><span class="n">name</span><span class="se">)</span><span class="s">.lproj/Localizable.strings"</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">string</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="kt">String</span><span class="p">(</span><span class="nv">contentsOfFile</span><span class="p">:</span> <span class="n">location</span><span class="p">,</span> <span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">lines</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="nf">components</span><span class="p">(</span><span class="nv">separatedBy</span><span class="p">:</span> <span class="o">.</span><span class="n">newlines</span><span class="p">)</span>

            <span class="k">var</span> <span class="nv">s</span> <span class="o">=</span> <span class="s">""</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="k">in</span> <span class="nf">sortAlphabetically</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span><span class="o">.</span><span class="nf">enumerated</span><span class="p">()</span> <span class="p">{</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="n">l</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">lines</span><span class="o">.</span><span class="n">count</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">{</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">try</span><span class="p">?</span> <span class="n">s</span><span class="o">.</span><span class="nf">write</span><span class="p">(</span><span class="nv">toFile</span><span class="p">:</span> <span class="n">location</span><span class="p">,</span> <span class="nv">atomically</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">removeEmptyLinesFromLines</span><span class="p">(</span><span class="n">_</span> <span class="nv">lines</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">lines</span><span class="o">.</span><span class="n">filter</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">trimmingCharacters</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="o">.</span><span class="n">whitespaces</span><span class="p">)</span> <span class="o">!=</span> <span class="s">""</span> <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">sortAlphabetically</span><span class="p">(</span><span class="n">_</span> <span class="nv">lines</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">lines</span><span class="o">.</span><span class="nf">sorted</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// MARK: - Load Localisation Files in memory</span>

<span class="k">let</span> <span class="nv">masterLocalizationFile</span> <span class="o">=</span> <span class="kt">LocalizationFiles</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="n">masterLanguage</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">localizationFiles</span> <span class="o">=</span> <span class="n">supportedLanguages</span>
    <span class="o">.</span><span class="n">filter</span> <span class="p">{</span> <span class="nv">$0</span> <span class="o">!=</span> <span class="n">masterLanguage</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="kt">LocalizationFiles</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="nv">$0</span><span class="p">)</span> <span class="p">}</span>

<span class="c1">// MARK: - Detect Unused Keys</span>

<span class="k">let</span> <span class="nv">sourcesPath</span> <span class="o">=</span> <span class="kt">FileManager</span><span class="o">.</span><span class="k">default</span><span class="o">.</span><span class="n">currentDirectoryPath</span> <span class="o">+</span> <span class="n">relativeSourceFolder</span>
<span class="k">let</span> <span class="nv">fileManager</span> <span class="o">=</span> <span class="kt">FileManager</span><span class="o">.</span><span class="k">default</span>
<span class="k">let</span> <span class="nv">enumerator</span> <span class="o">=</span> <span class="n">fileManager</span><span class="o">.</span><span class="nf">enumerator</span><span class="p">(</span><span class="nv">atPath</span><span class="p">:</span> <span class="n">sourcesPath</span><span class="p">)</span>
<span class="k">var</span> <span class="nv">localizedStrings</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">while</span> <span class="k">let</span> <span class="nv">swiftFileLocation</span> <span class="o">=</span> <span class="n">enumerator</span><span class="p">?</span><span class="o">.</span><span class="nf">nextObject</span><span class="p">()</span> <span class="k">as?</span> <span class="kt">String</span> <span class="p">{</span>
    <span class="c1">// checks the extension</span>
    <span class="k">if</span> <span class="n">swiftFileLocation</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="s">".swift"</span><span class="p">)</span> <span class="p">\\</span><span class="o">|</span><span class="p">\\</span><span class="o">|</span> <span class="n">swiftFileLocation</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="s">".m"</span><span class="p">)</span> <span class="p">\\</span><span class="o">|</span><span class="p">\\</span><span class="o">|</span> <span class="n">swiftFileLocation</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="s">".mm"</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">location</span> <span class="o">=</span> <span class="s">"</span><span class="se">\(</span><span class="n">sourcesPath</span><span class="se">)</span><span class="s">/</span><span class="se">\(</span><span class="n">swiftFileLocation</span><span class="se">)</span><span class="s">"</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">string</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="kt">String</span><span class="p">(</span><span class="nv">contentsOfFile</span><span class="p">:</span> <span class="n">location</span><span class="p">,</span> <span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="n">p</span> <span class="k">in</span> <span class="n">patterns</span> <span class="p">{</span>
                <span class="k">let</span> <span class="nv">regex</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="kt">NSRegularExpression</span><span class="p">(</span><span class="nv">pattern</span><span class="p">:</span> <span class="n">p</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[])</span>
                <span class="k">let</span> <span class="nv">range</span> <span class="o">=</span> <span class="kt">NSRange</span><span class="p">(</span><span class="nv">location</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">length</span><span class="p">:</span> <span class="p">(</span><span class="n">string</span> <span class="k">as</span> <span class="kt">NSString</span><span class="p">)</span><span class="o">.</span><span class="n">length</span><span class="p">)</span> <span class="c1">// Obj c wa</span>
                <span class="n">regex</span><span class="p">?</span><span class="o">.</span><span class="nf">enumerateMatches</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="n">string</span><span class="p">,</span>
                                        <span class="nv">options</span><span class="p">:</span> <span class="p">[],</span>
                                        <span class="nv">range</span><span class="p">:</span> <span class="n">range</span><span class="p">,</span>
                                        <span class="nv">using</span><span class="p">:</span> <span class="p">{</span> <span class="n">result</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="k">in</span>
                                            <span class="k">if</span> <span class="k">let</span> <span class="nv">r</span> <span class="o">=</span> <span class="n">result</span> <span class="p">{</span>
                                                <span class="k">let</span> <span class="nv">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">string</span> <span class="k">as</span> <span class="kt">NSString</span><span class="p">)</span><span class="o">.</span><span class="nf">substring</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="nf">range</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">numberOfRanges</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
                                                <span class="n">localizedStrings</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                                            <span class="p">}</span>
                <span class="p">})</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">var</span> <span class="nv">masterKeys</span> <span class="o">=</span> <span class="kt">Set</span><span class="p">(</span><span class="n">masterLocalizationFile</span><span class="o">.</span><span class="n">keyValue</span><span class="o">.</span><span class="n">keys</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">usedKeys</span> <span class="o">=</span> <span class="kt">Set</span><span class="p">(</span><span class="n">localizedStrings</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">ignored</span> <span class="o">=</span> <span class="kt">Set</span><span class="p">(</span><span class="n">ignoredFromUnusedKeys</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">unused</span> <span class="o">=</span> <span class="n">masterKeys</span><span class="o">.</span><span class="nf">subtracting</span><span class="p">(</span><span class="n">usedKeys</span><span class="p">)</span><span class="o">.</span><span class="nf">subtracting</span><span class="p">(</span><span class="n">ignored</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">untranslated</span> <span class="o">=</span> <span class="n">usedKeys</span><span class="o">.</span><span class="nf">subtracting</span><span class="p">(</span><span class="n">masterKeys</span><span class="p">)</span>

<span class="c1">// Here generate Xcode regex Find and replace script to remove dead keys all at once!</span>
<span class="k">var</span> <span class="nv">replaceCommand</span> <span class="o">=</span> <span class="s">"</span><span class="se">\"</span><span class="s">("</span>
<span class="k">var</span> <span class="nv">counter</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">v</span> <span class="k">in</span> <span class="n">unused</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">str</span> <span class="o">=</span> <span class="s">"</span><span class="se">\(</span><span class="n">path</span><span class="se">)</span><span class="s">/</span><span class="se">\(</span><span class="n">masterLocalizationFile</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">.lproj/Localizable.strings:</span><span class="se">\(</span><span class="n">masterLocalizationFile</span><span class="o">.</span><span class="n">linesNumbers</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">!</span><span class="se">)</span><span class="s">: "</span>
    <span class="n">str</span> <span class="o">+=</span> <span class="s">"error: [Unused Key] </span><span class="se">\"\(</span><span class="n">v</span><span class="se">)\"</span><span class="s"> is never used"</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
    <span class="n">numberOfErrors</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">counter</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">{</span>
        <span class="n">replaceCommand</span> <span class="o">+=</span> <span class="s">"</span><span class="se">\\</span><span class="s">|"</span>
    <span class="p">}</span>
    <span class="n">replaceCommand</span> <span class="o">+=</span> <span class="n">v</span>
    <span class="k">if</span> <span class="n">counter</span> <span class="o">==</span> <span class="n">unused</span><span class="o">.</span><span class="n">count</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="n">replaceCommand</span> <span class="o">+=</span> <span class="s">")</span><span class="se">\"</span><span class="s"> = </span><span class="se">\"</span><span class="s">.*</span><span class="se">\"</span><span class="s">;"</span>
    <span class="p">}</span>
    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="p">}</span>

<span class="nf">print</span><span class="p">(</span><span class="n">replaceCommand</span><span class="p">)</span>

<span class="c1">// MARK: - Compare each translation file against master (en)</span>

<span class="k">for</span> <span class="n">file</span> <span class="k">in</span> <span class="n">localizationFiles</span> <span class="p">{</span>
    <span class="k">for</span> <span class="n">k</span> <span class="k">in</span> <span class="n">masterLocalizationFile</span><span class="o">.</span><span class="n">keyValue</span><span class="o">.</span><span class="n">keys</span> <span class="p">{</span>
        <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">keyValue</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="k">var</span> <span class="nv">str</span> <span class="o">=</span> <span class="s">"</span><span class="se">\(</span><span class="n">path</span><span class="se">)</span><span class="s">/</span><span class="se">\(</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">.lproj/Localizable.strings:</span><span class="se">\(</span><span class="n">masterLocalizationFile</span><span class="o">.</span><span class="n">linesNumbers</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">!</span><span class="se">)</span><span class="s">: "</span>
            <span class="n">str</span> <span class="o">+=</span> <span class="s">"error: [Missing] </span><span class="se">\"\(</span><span class="n">k</span><span class="se">)\"</span><span class="s"> missing from </span><span class="se">\(</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="nf">uppercased</span><span class="p">()</span><span class="se">)</span><span class="s"> file"</span>
            <span class="nf">print</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
            <span class="n">numberOfErrors</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">redundantKeys</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">keyValue</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">filter</span> <span class="p">{</span> <span class="o">!</span><span class="n">masterLocalizationFile</span><span class="o">.</span><span class="n">keyValue</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="nf">contains</span><span class="p">(</span><span class="nv">$0</span><span class="p">)</span> <span class="p">}</span>

    <span class="k">for</span> <span class="n">k</span> <span class="k">in</span> <span class="n">redundantKeys</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">str</span> <span class="o">=</span> <span class="s">"</span><span class="se">\(</span><span class="n">path</span><span class="se">)</span><span class="s">/</span><span class="se">\(</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">.lproj/Localizable.strings:</span><span class="se">\(</span><span class="n">file</span><span class="o">.</span><span class="n">linesNumbers</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">!</span><span class="se">)</span><span class="s">: "</span>
            <span class="o">+</span> <span class="s">"error: [Redundant key] </span><span class="se">\"\(</span><span class="n">k</span><span class="se">)\"</span><span class="s"> redundant in </span><span class="se">\(</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="nf">uppercased</span><span class="p">()</span><span class="se">)</span><span class="s"> file"</span>

        <span class="nf">print</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">if</span> <span class="n">checkForUntranslated</span> <span class="p">{</span>
    <span class="k">for</span> <span class="n">key</span> <span class="k">in</span> <span class="n">untranslated</span> <span class="p">{</span>
        <span class="k">var</span> <span class="nv">str</span> <span class="o">=</span> <span class="s">"</span><span class="se">\(</span><span class="n">path</span><span class="se">)</span><span class="s">/</span><span class="se">\(</span><span class="n">masterLocalizationFile</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">.lproj/Localizable.strings:1: "</span>
        <span class="n">str</span> <span class="o">+=</span> <span class="s">"error: [Missing Translation] </span><span class="se">\(</span><span class="n">key</span><span class="se">)</span><span class="s"> is not translated"</span>

        <span class="nf">print</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
        <span class="n">numberOfErrors</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nf">print</span><span class="p">(</span><span class="s">"Number of warnings : </span><span class="se">\(</span><span class="n">numberOfWarnings</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="s">"Number of errors : </span><span class="se">\(</span><span class="n">numberOfErrors</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">numberOfErrors</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">{</span>
    <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">shell</span><span class="p">(</span><span class="n">_</span> <span class="nv">command</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">String</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">task</span> <span class="o">=</span> <span class="kt">Process</span><span class="p">()</span>
    <span class="k">let</span> <span class="nv">pipe</span> <span class="o">=</span> <span class="kt">Pipe</span><span class="p">()</span>

    <span class="n">task</span><span class="o">.</span><span class="n">standardOutput</span> <span class="o">=</span> <span class="n">pipe</span>
    <span class="n">task</span><span class="o">.</span><span class="n">arguments</span> <span class="o">=</span> <span class="p">[</span><span class="s">"-c"</span><span class="p">,</span> <span class="n">command</span><span class="p">]</span>
    <span class="n">task</span><span class="o">.</span><span class="n">launchPath</span> <span class="o">=</span> <span class="s">"/bin/bash"</span>
    <span class="n">task</span><span class="o">.</span><span class="nf">launch</span><span class="p">()</span>

    <span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">fileHandleForReading</span><span class="o">.</span><span class="nf">readDataToEndOfFile</span><span class="p">()</span>
    <span class="k">let</span> <span class="nv">output</span> <span class="o">=</span> <span class="kt">String</span><span class="p">(</span><span class="nv">data</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span> <span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span><span class="o">!</span>

    <span class="k">return</span> <span class="n">output</span>
<span class="p">}</span>
</pre></table></code></div></div><blockquote><p><strong><em>最后最后，还没结束！</em></strong></p></blockquote><p>当我们的 swift 检查工具脚本都调试完成之后，要将其 <strong>compile 成执行档减少 build 花费时间</strong> ，否则每次 build 都要重新 compile 一次（约能减少 90% 的时间）。</p><p>打开 terminal ，前往专案中检查工具脚本所在目录下执行：</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>swiftc <span class="nt">-o</span> Localize Localize.swift
</pre></table></code></div></div><p><a href="/assets/41c49a75a743/1*rwq_KZIDW-Lvtpd2xmgjDw.webp" class="popup img-link blur"><img data-src="/assets/41c49a75a743/1*rwq_KZIDW-Lvtpd2xmgjDw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NzIiIGhlaWdodD0iNTkiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p><a href="/assets/41c49a75a743/1*BCKtqshZxHH17j3nBGtNlg.webp" class="popup img-link blur"><img data-src="/assets/41c49a75a743/1*BCKtqshZxHH17j3nBGtNlg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MiIgaGVpZ2h0PSIxMDAiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>然后再回头到 Build Phases 更改 Script 内容路径成执行档</p><p>EX: <code class="language-plaintext highlighter-rouge">${SRCROOT}/Localize</code></p><p><a href="/assets/41c49a75a743/1*ewhCXzXNuS0MCTMCuINWng.webp" class="popup img-link blur"><img data-src="/assets/41c49a75a743/1*ewhCXzXNuS0MCTMCuINWng.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5NjAiIGhlaWdodD0iMjczIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><strong>完工！</strong></p><h4 id="工具-2-asset-checker--图片资源检查工具"><span class="me-2">工具 2. <a href="https://github.com/s4cha/AssetChecker" target="_blank"><strong>Asset Checker 👮</strong></a> <strong>图片资源检查工具</strong></span><a href="#工具-2-asset-checker--图片资源检查工具" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><strong>功能：</strong></p><ul><li><p>build 时自动检查</p><li><p>检查图片缺漏：名称有呼叫，但图片资源目录内没有出现</p><li><p>检查图片多余：名称未使用，但图片资源目录存在的</p></ul><p><strong>安装方法：</strong></p><ol><li><p><a href="https://github.com/freshOS/AssetChecker/blob/master/Classes/main.swift" target="_blank">下载工具的 Swift Script 档案</a></p><li><p>放到专案目录下 EX: <code class="language-plaintext highlighter-rouge">${SRCROOT}/AssetChecker.swift</code></p><li><p>打开专案设定 → iOS Target → Build Phases →左上角「+」 → New Run Script Phases → 在 Script 内容贴上路径</p></ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">${</span><span class="nv">SRCROOT</span><span class="k">}</span>/AssetChecker.swift <span class="k">${</span><span class="nv">SRCROOT</span><span class="k">}</span>/专案目录 <span class="k">${</span><span class="nv">SRCROOT</span><span class="k">}</span>/Resources/Images.xcassets
//<span class="k">${</span><span class="nv">SRCROOT</span><span class="k">}</span>/Resources/Images.xcassets <span class="o">=</span> 你 .xcassets 的位置
</pre></table></code></div></div><p><a href="/assets/41c49a75a743/1*TPLS60W1iQiGFzU-inf3aA.webp" class="popup img-link blur"><img data-src="/assets/41c49a75a743/1*TPLS60W1iQiGFzU-inf3aA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDY1IiBoZWlnaHQ9IjMzNCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>可直接将设定参数带在路径上，参数1:专案目录位置、参数2:图片资源目录位置；或跟语系检查工具一样编辑 <code class="language-plaintext highlighter-rouge">AssetChecker.swift</code> 顶部参数设定区块：</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="c1">// Configure me \o/</span>

<span class="c1">// 专案目录位置（用来搜索图片有没有在程式码中使用到）</span>
<span class="k">var</span> <span class="nv">sourcePathOption</span><span class="p">:</span><span class="kt">String</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>

<span class="c1">// .xcassets 目录位置</span>
<span class="k">var</span> <span class="nv">assetCatalogPathOption</span><span class="p">:</span><span class="kt">String</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>

<span class="c1">// Unused 警告忽略项目</span>
<span class="k">let</span> <span class="nv">ignoredUnusedNames</span> <span class="o">=</span> <span class="p">[</span><span class="kt">String</span><span class="p">]()</span>
</pre></table></code></div></div><ol><li>Build！ 成功！</ol><p><strong>检查结果提示类型：</strong></p><ul><li><strong>Build Error</strong> ❌ <strong>：</strong><ul><li>[Asset Missing] 项目在程式内有呼叫使用，但图片资源目录内没有出现</ul><li><strong>Build Warning</strong> ⚠️ <strong>：</strong><ul><li>[Asset Unused] 项目在程式内未使用，但图片资源目录内有出现 <em>p.s 假设图片是动态变数提供，检查工具将无法识别，可将其加入 <code class="language-plaintext highlighter-rouge">ignoredUnusedNames</code> 中设为例外。</em></ul></ul><p>其他操作同语系检查工具，这边就不做赘述；最重要的事是也要 <strong>记得调适完后要 compile 成执行档，并更改 run script 内容为执行档！</strong></p><h4 id="开发自己的工具"><span class="me-2">开发自己的工具！</span><a href="#开发自己的工具" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><blockquote><p><strong><em>我们可以参考图片资源检查工具脚本：</em></strong></p></blockquote><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
</pre><td class="rouge-code"><pre><span class="cp">#!/usr/bin/env xcrun --sdk macosx swift</span>

<span class="kd">import</span> <span class="kt">Foundation</span>

<span class="c1">// Configure me \o/</span>
<span class="k">var</span> <span class="nv">sourcePathOption</span><span class="p">:</span><span class="kt">String</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">assetCatalogPathOption</span><span class="p">:</span><span class="kt">String</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">let</span> <span class="nv">ignoredUnusedNames</span> <span class="o">=</span> <span class="p">[</span><span class="kt">String</span><span class="p">]()</span>

<span class="k">for</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span> <span class="k">in</span> <span class="kt">CommandLine</span><span class="o">.</span><span class="n">arguments</span><span class="o">.</span><span class="nf">enumerated</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">switch</span> <span class="n">index</span> <span class="p">{</span>
    <span class="k">case</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">sourcePathOption</span> <span class="o">=</span> <span class="n">arg</span>
    <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">assetCatalogPathOption</span> <span class="o">=</span> <span class="n">arg</span>
    <span class="k">default</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">guard</span> <span class="k">let</span> <span class="nv">sourcePath</span> <span class="o">=</span> <span class="n">sourcePathOption</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"AssetChecker:: error: Source path was missing!"</span><span class="p">)</span>
    <span class="nf">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">guard</span> <span class="k">let</span> <span class="nv">assetCatalogAbsolutePath</span> <span class="o">=</span> <span class="n">assetCatalogPathOption</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"AssetChecker:: error: Asset Catalog path was missing!"</span><span class="p">)</span>
    <span class="nf">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">print</span><span class="p">(</span><span class="s">"Searching sources in </span><span class="se">\(</span><span class="n">sourcePath</span><span class="se">)</span><span class="s"> for assets in </span><span class="se">\(</span><span class="n">assetCatalogAbsolutePath</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>

<span class="cm">/* Put here the asset generating false positives, 
 For instance whne you build asset names at runtime
let ignoredUnusedNames = [
    "IconArticle",
    "IconMedia",
    "voteEN",
    "voteES",
    "voteFR"
] 
*/</span>


<span class="c1">// MARK : - End Of Configurable Section</span>
<span class="kd">func</span> <span class="nf">elementsInEnumerator</span><span class="p">(</span><span class="n">_</span> <span class="nv">enumerator</span><span class="p">:</span> <span class="kt">FileManager</span><span class="o">.</span><span class="kt">DirectoryEnumerator</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">elements</span> <span class="o">=</span> <span class="p">[</span><span class="kt">String</span><span class="p">]()</span>
    <span class="k">while</span> <span class="k">let</span> <span class="nv">e</span> <span class="o">=</span> <span class="n">enumerator</span><span class="p">?</span><span class="o">.</span><span class="nf">nextObject</span><span class="p">()</span> <span class="k">as?</span> <span class="kt">String</span> <span class="p">{</span>
        <span class="n">elements</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">elements</span>
<span class="p">}</span>


<span class="c1">// MARK: - List Assets</span>
<span class="kd">func</span> <span class="nf">listAssets</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">extensionName</span> <span class="o">=</span> <span class="s">"imageset"</span>
    <span class="k">let</span> <span class="nv">enumerator</span> <span class="o">=</span> <span class="kt">FileManager</span><span class="o">.</span><span class="k">default</span><span class="o">.</span><span class="nf">enumerator</span><span class="p">(</span><span class="nv">atPath</span><span class="p">:</span> <span class="n">assetCatalogAbsolutePath</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">elementsInEnumerator</span><span class="p">(</span><span class="n">enumerator</span><span class="p">)</span>
        <span class="o">.</span><span class="n">filter</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="n">extensionName</span><span class="p">)</span> <span class="p">}</span>                             <span class="c1">// Is Asset</span>
        <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">replacingOccurrences</span><span class="p">(</span><span class="nv">of</span><span class="p">:</span> <span class="s">".</span><span class="se">\(</span><span class="n">extensionName</span><span class="se">)</span><span class="s">"</span><span class="p">,</span> <span class="nv">with</span><span class="p">:</span> <span class="s">""</span><span class="p">)</span> <span class="p">}</span> <span class="c1">// Remove extension</span>
        <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">components</span><span class="p">(</span><span class="nv">separatedBy</span><span class="p">:</span> <span class="s">"/"</span><span class="p">)</span><span class="o">.</span><span class="n">last</span> <span class="p">??</span> <span class="nv">$0</span> <span class="p">}</span>                 <span class="c1">// Remove folder path</span>
<span class="p">}</span>


<span class="c1">// MARK: - List Used Assets in the codebase</span>
<span class="kd">func</span> <span class="nf">localizedStrings</span><span class="p">(</span><span class="nv">inStringFile</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">localizedStrings</span> <span class="o">=</span> <span class="p">[</span><span class="kt">String</span><span class="p">]()</span>
    <span class="k">let</span> <span class="nv">namePattern</span> <span class="o">=</span> <span class="s">"([</span><span class="se">\\</span><span class="s">w-]+)"</span>
    <span class="k">let</span> <span class="nv">patterns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s">"#imageLiteral</span><span class="se">\\</span><span class="s">(resourceName: </span><span class="se">\"\(</span><span class="n">namePattern</span><span class="se">)\"\\</span><span class="s">)"</span><span class="p">,</span> <span class="c1">// Image Literal</span>
        <span class="s">"UIImage</span><span class="se">\\</span><span class="s">(named:</span><span class="se">\\</span><span class="s">s*</span><span class="se">\"\(</span><span class="n">namePattern</span><span class="se">)\"\\</span><span class="s">)"</span><span class="p">,</span> <span class="c1">// Default UIImage call (Swift)</span>
        <span class="s">"UIImage imageNamed:</span><span class="se">\\</span><span class="s">s*</span><span class="se">\\</span><span class="s">@</span><span class="se">\"\(</span><span class="n">namePattern</span><span class="se">)\"</span><span class="s">"</span><span class="p">,</span> <span class="c1">// Default UIImage call </span>
        <span class="s">"</span><span class="se">\\</span><span class="s">&lt;image name=</span><span class="se">\"\(</span><span class="n">namePattern</span><span class="se">)\"</span><span class="s">.*"</span><span class="p">,</span> <span class="c1">// Storyboard resources</span>
        <span class="s">"R.image.</span><span class="se">\(</span><span class="n">namePattern</span><span class="se">)\\</span><span class="s">(</span><span class="se">\\</span><span class="s">)"</span> <span class="c1">//R.swift support</span>
    <span class="p">]</span>
    <span class="k">for</span> <span class="n">p</span> <span class="k">in</span> <span class="n">patterns</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">regex</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="kt">NSRegularExpression</span><span class="p">(</span><span class="nv">pattern</span><span class="p">:</span> <span class="n">p</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[])</span>
        <span class="k">let</span> <span class="nv">range</span> <span class="o">=</span> <span class="kt">NSRange</span><span class="p">(</span><span class="nv">location</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="nv">length</span><span class="p">:(</span><span class="n">inStringFile</span> <span class="k">as</span> <span class="kt">NSString</span><span class="p">)</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
        <span class="n">regex</span><span class="p">?</span><span class="o">.</span><span class="nf">enumerateMatches</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="n">inStringFile</span><span class="p">,</span><span class="nv">options</span><span class="p">:</span> <span class="p">[],</span> <span class="nv">range</span><span class="p">:</span> <span class="n">range</span><span class="p">)</span> <span class="p">{</span> <span class="n">result</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="k">in</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">r</span> <span class="o">=</span> <span class="n">result</span> <span class="p">{</span>
                <span class="k">let</span> <span class="nv">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">inStringFile</span> <span class="k">as</span> <span class="kt">NSString</span><span class="p">)</span><span class="o">.</span><span class="nf">substring</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span><span class="n">r</span><span class="o">.</span><span class="nf">range</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="mi">1</span><span class="p">))</span>
                <span class="n">localizedStrings</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">localizedStrings</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">listUsedAssetLiterals</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">enumerator</span> <span class="o">=</span> <span class="kt">FileManager</span><span class="o">.</span><span class="k">default</span><span class="o">.</span><span class="nf">enumerator</span><span class="p">(</span><span class="nv">atPath</span><span class="p">:</span><span class="n">sourcePath</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">sourcePath</span><span class="p">)</span>
    
    <span class="cp">#if swift(&gt;=4.1)</span>
        <span class="k">return</span> <span class="nf">elementsInEnumerator</span><span class="p">(</span><span class="n">enumerator</span><span class="p">)</span>
            <span class="o">.</span><span class="n">filter</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="s">".m"</span><span class="p">)</span> <span class="p">\\</span><span class="o">|</span><span class="p">\\</span><span class="o">|</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="s">".swift"</span><span class="p">)</span> <span class="p">\\</span><span class="o">|</span><span class="p">\\</span><span class="o">|</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="s">".xib"</span><span class="p">)</span> <span class="p">\\</span><span class="o">|</span><span class="p">\\</span><span class="o">|</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="s">".storyboard"</span><span class="p">)</span> <span class="p">}</span>    <span class="c1">// Only Swift and Obj-C files</span>
            <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="s">"</span><span class="se">\(</span><span class="n">sourcePath</span><span class="se">)</span><span class="s">/</span><span class="se">\(</span><span class="nv">$0</span><span class="se">)</span><span class="s">"</span> <span class="p">}</span>                              <span class="c1">// Build file paths</span>
            <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="k">try</span><span class="p">?</span> <span class="kt">String</span><span class="p">(</span><span class="nv">contentsOfFile</span><span class="p">:</span> <span class="nv">$0</span><span class="p">,</span> <span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)}</span>    <span class="c1">// Get file contents</span>
            <span class="o">.</span><span class="n">compactMap</span><span class="p">{</span><span class="nv">$0</span><span class="p">}</span>
            <span class="o">.</span><span class="n">compactMap</span><span class="p">{</span><span class="nv">$0</span><span class="p">}</span>                                             <span class="c1">// Remove nil entries</span>
            <span class="o">.</span><span class="nf">map</span><span class="p">(</span><span class="n">localizedStrings</span><span class="p">)</span>                                      <span class="c1">// Find localizedStrings ocurrences</span>
            <span class="o">.</span><span class="n">flatMap</span><span class="p">{</span><span class="nv">$0</span><span class="p">}</span>                                                <span class="c1">// Flatten</span>
    <span class="cp">#else</span>
        <span class="k">return</span> <span class="nf">elementsInEnumerator</span><span class="p">(</span><span class="n">enumerator</span><span class="p">)</span>
            <span class="o">.</span><span class="n">filter</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="s">".m"</span><span class="p">)</span> <span class="p">\\</span><span class="o">|</span><span class="p">\\</span><span class="o">|</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="s">".swift"</span><span class="p">)</span> <span class="p">\\</span><span class="o">|</span><span class="p">\\</span><span class="o">|</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="s">".xib"</span><span class="p">)</span> <span class="p">\\</span><span class="o">|</span><span class="p">\\</span><span class="o">|</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="s">".storyboard"</span><span class="p">)</span> <span class="p">}</span>    <span class="c1">// Only Swift and Obj-C files</span>
            <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="s">"</span><span class="se">\(</span><span class="n">sourcePath</span><span class="se">)</span><span class="s">/</span><span class="se">\(</span><span class="nv">$0</span><span class="se">)</span><span class="s">"</span> <span class="p">}</span>                              <span class="c1">// Build file paths</span>
            <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="k">try</span><span class="p">?</span> <span class="kt">String</span><span class="p">(</span><span class="nv">contentsOfFile</span><span class="p">:</span> <span class="nv">$0</span><span class="p">,</span> <span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)}</span>    <span class="c1">// Get file contents</span>
            <span class="o">.</span><span class="n">flatMap</span><span class="p">{</span><span class="nv">$0</span><span class="p">}</span>
            <span class="o">.</span><span class="n">flatMap</span><span class="p">{</span><span class="nv">$0</span><span class="p">}</span>                                                <span class="c1">// Remove nil entries</span>
            <span class="o">.</span><span class="nf">map</span><span class="p">(</span><span class="n">localizedStrings</span><span class="p">)</span>                                      <span class="c1">// Find localizedStrings ocurrences</span>
            <span class="o">.</span><span class="n">flatMap</span><span class="p">{</span><span class="nv">$0</span><span class="p">}</span>                                                <span class="c1">// Flatten</span>
    <span class="cp">#endif</span>
<span class="p">}</span>


<span class="c1">// MARK: - Begining of script</span>
<span class="k">let</span> <span class="nv">assets</span> <span class="o">=</span> <span class="kt">Set</span><span class="p">(</span><span class="nf">listAssets</span><span class="p">())</span>
<span class="k">let</span> <span class="nv">used</span> <span class="o">=</span> <span class="kt">Set</span><span class="p">(</span><span class="nf">listUsedAssetLiterals</span><span class="p">()</span> <span class="o">+</span> <span class="n">ignoredUnusedNames</span><span class="p">)</span>


<span class="c1">// Generate Warnings for Unused Assets</span>
<span class="k">let</span> <span class="nv">unused</span> <span class="o">=</span> <span class="n">assets</span><span class="o">.</span><span class="nf">subtracting</span><span class="p">(</span><span class="n">used</span><span class="p">)</span>
<span class="n">unused</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span> <span class="nf">print</span><span class="p">(</span><span class="s">"</span><span class="se">\(</span><span class="n">assetCatalogAbsolutePath</span><span class="se">)</span><span class="s">:: warning: [Asset Unused] </span><span class="se">\(</span><span class="nv">$0</span><span class="se">)</span><span class="s">"</span><span class="p">)</span> <span class="p">}</span>


<span class="c1">// Generate Error for broken Assets</span>
<span class="k">let</span> <span class="nv">broken</span> <span class="o">=</span> <span class="n">used</span><span class="o">.</span><span class="nf">subtracting</span><span class="p">(</span><span class="n">assets</span><span class="p">)</span>
<span class="n">broken</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span> <span class="nf">print</span><span class="p">(</span><span class="s">"</span><span class="se">\(</span><span class="n">assetCatalogAbsolutePath</span><span class="se">)</span><span class="s">:: error: [Asset Missing] </span><span class="se">\(</span><span class="nv">$0</span><span class="se">)</span><span class="s">"</span><span class="p">)</span> <span class="p">}</span>

<span class="k">if</span> <span class="n">broken</span><span class="o">.</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">{</span>
    <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><p>相较于语系检查脚本，这个脚本简洁且重要的功能都有，很有参考价值！</p><p><em>P.S 可以看到程式码出现 <code class="language-plaintext highlighter-rouge">localizedStrings()</code> 命名，怀疑作者是从语系检查工具的逻辑搬来用，忘了改方法名称ＸＤ</em></p><p><strong>例如：</strong></p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span> <span class="k">in</span> <span class="kt">CommandLine</span><span class="o">.</span><span class="n">arguments</span><span class="o">.</span><span class="nf">enumerated</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">switch</span> <span class="n">index</span> <span class="p">{</span>
    <span class="k">case</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1">//参数1</span>
    <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1">//参数2</span>
    <span class="k">default</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>^接收外部参数的方法</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">elementsInEnumerator</span><span class="p">(</span><span class="n">_</span> <span class="nv">enumerator</span><span class="p">:</span> <span class="kt">FileManager</span><span class="o">.</span><span class="kt">DirectoryEnumerator</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">elements</span> <span class="o">=</span> <span class="p">[</span><span class="kt">String</span><span class="p">]()</span>
    <span class="k">while</span> <span class="k">let</span> <span class="nv">e</span> <span class="o">=</span> <span class="n">enumerator</span><span class="p">?</span><span class="o">.</span><span class="nf">nextObject</span><span class="p">()</span> <span class="k">as?</span> <span class="kt">String</span> <span class="p">{</span>
        <span class="n">elements</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">elements</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">localizedStrings</span><span class="p">(</span><span class="nv">inStringFile</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">localizedStrings</span> <span class="o">=</span> <span class="p">[</span><span class="kt">String</span><span class="p">]()</span>
    <span class="k">let</span> <span class="nv">namePattern</span> <span class="o">=</span> <span class="s">"([</span><span class="se">\\</span><span class="s">w-]+)"</span>
    <span class="k">let</span> <span class="nv">patterns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s">"#imageLiteral</span><span class="se">\\</span><span class="s">(resourceName: </span><span class="se">\"\(</span><span class="n">namePattern</span><span class="se">)\"\\</span><span class="s">)"</span><span class="p">,</span> <span class="c1">// Image Literal</span>
        <span class="s">"UIImage</span><span class="se">\\</span><span class="s">(named:</span><span class="se">\\</span><span class="s">s*</span><span class="se">\"\(</span><span class="n">namePattern</span><span class="se">)\"\\</span><span class="s">)"</span><span class="p">,</span> <span class="c1">// Default UIImage call (Swift)</span>
        <span class="s">"UIImage imageNamed:</span><span class="se">\\</span><span class="s">s*</span><span class="se">\\</span><span class="s">@</span><span class="se">\"\(</span><span class="n">namePattern</span><span class="se">)\"</span><span class="s">"</span><span class="p">,</span> <span class="c1">// Default UIImage call </span>
        <span class="s">"</span><span class="se">\\</span><span class="s">&lt;image name=</span><span class="se">\"\(</span><span class="n">namePattern</span><span class="se">)\"</span><span class="s">.*"</span><span class="p">,</span> <span class="c1">// Storyboard resources</span>
        <span class="s">"R.image.</span><span class="se">\(</span><span class="n">namePattern</span><span class="se">)\\</span><span class="s">(</span><span class="se">\\</span><span class="s">)"</span> <span class="c1">//R.swift support</span>
    <span class="p">]</span>
    <span class="k">for</span> <span class="n">p</span> <span class="k">in</span> <span class="n">patterns</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">regex</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="kt">NSRegularExpression</span><span class="p">(</span><span class="nv">pattern</span><span class="p">:</span> <span class="n">p</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[])</span>
        <span class="k">let</span> <span class="nv">range</span> <span class="o">=</span> <span class="kt">NSRange</span><span class="p">(</span><span class="nv">location</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="nv">length</span><span class="p">:(</span><span class="n">inStringFile</span> <span class="k">as</span> <span class="kt">NSString</span><span class="p">)</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
        <span class="n">regex</span><span class="p">?</span><span class="o">.</span><span class="nf">enumerateMatches</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="n">inStringFile</span><span class="p">,</span><span class="nv">options</span><span class="p">:</span> <span class="p">[],</span> <span class="nv">range</span><span class="p">:</span> <span class="n">range</span><span class="p">)</span> <span class="p">{</span> <span class="n">result</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="k">in</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">r</span> <span class="o">=</span> <span class="n">result</span> <span class="p">{</span>
                <span class="k">let</span> <span class="nv">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">inStringFile</span> <span class="k">as</span> <span class="kt">NSString</span><span class="p">)</span><span class="o">.</span><span class="nf">substring</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span><span class="n">r</span><span class="o">.</span><span class="nf">range</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="mi">1</span><span class="p">))</span>
                <span class="n">localizedStrings</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">localizedStrings</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">listUsedAssetLiterals</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">enumerator</span> <span class="o">=</span> <span class="kt">FileManager</span><span class="o">.</span><span class="k">default</span><span class="o">.</span><span class="nf">enumerator</span><span class="p">(</span><span class="nv">atPath</span><span class="p">:</span><span class="n">sourcePath</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">sourcePath</span><span class="p">)</span>
    
    <span class="cp">#if swift(&gt;=4.1)</span>
        <span class="k">return</span> <span class="nf">elementsInEnumerator</span><span class="p">(</span><span class="n">enumerator</span><span class="p">)</span>
            <span class="o">.</span><span class="n">filter</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="s">".m"</span><span class="p">)</span> <span class="p">\\</span><span class="o">|</span><span class="p">\\</span><span class="o">|</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="s">".swift"</span><span class="p">)</span> <span class="p">\\</span><span class="o">|</span><span class="p">\\</span><span class="o">|</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="s">".xib"</span><span class="p">)</span> <span class="p">\\</span><span class="o">|</span><span class="p">\\</span><span class="o">|</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="s">".storyboard"</span><span class="p">)</span> <span class="p">}</span>    <span class="c1">// Only Swift and Obj-C files</span>
            <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="s">"</span><span class="se">\(</span><span class="n">sourcePath</span><span class="se">)</span><span class="s">/</span><span class="se">\(</span><span class="nv">$0</span><span class="se">)</span><span class="s">"</span> <span class="p">}</span>                              <span class="c1">// Build file paths</span>
            <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="k">try</span><span class="p">?</span> <span class="kt">String</span><span class="p">(</span><span class="nv">contentsOfFile</span><span class="p">:</span> <span class="nv">$0</span><span class="p">,</span> <span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)}</span>    <span class="c1">// Get file contents</span>
            <span class="o">.</span><span class="n">compactMap</span><span class="p">{</span><span class="nv">$0</span><span class="p">}</span>
            <span class="o">.</span><span class="n">compactMap</span><span class="p">{</span><span class="nv">$0</span><span class="p">}</span>                                             <span class="c1">// Remove nil entries</span>
            <span class="o">.</span><span class="nf">map</span><span class="p">(</span><span class="n">localizedStrings</span><span class="p">)</span>                                      <span class="c1">// Find localizedStrings ocurrences</span>
            <span class="o">.</span><span class="n">flatMap</span><span class="p">{</span><span class="nv">$0</span><span class="p">}</span>                                                <span class="c1">// Flatten</span>
    <span class="cp">#else</span>
        <span class="k">return</span> <span class="nf">elementsInEnumerator</span><span class="p">(</span><span class="n">enumerator</span><span class="p">)</span>
            <span class="o">.</span><span class="n">filter</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="s">".m"</span><span class="p">)</span> <span class="p">\\</span><span class="o">|</span><span class="p">\\</span><span class="o">|</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="s">".swift"</span><span class="p">)</span> <span class="p">\\</span><span class="o">|</span><span class="p">\\</span><span class="o">|</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="s">".xib"</span><span class="p">)</span> <span class="p">\\</span><span class="o">|</span><span class="p">\\</span><span class="o">|</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">hasSuffix</span><span class="p">(</span><span class="s">".storyboard"</span><span class="p">)</span> <span class="p">}</span>    <span class="c1">// Only Swift and Obj-C files</span>
            <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="s">"</span><span class="se">\(</span><span class="n">sourcePath</span><span class="se">)</span><span class="s">/</span><span class="se">\(</span><span class="nv">$0</span><span class="se">)</span><span class="s">"</span> <span class="p">}</span>                              <span class="c1">// Build file paths</span>
            <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="k">try</span><span class="p">?</span> <span class="kt">String</span><span class="p">(</span><span class="nv">contentsOfFile</span><span class="p">:</span> <span class="nv">$0</span><span class="p">,</span> <span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)}</span>    <span class="c1">// Get file contents</span>
            <span class="o">.</span><span class="n">flatMap</span><span class="p">{</span><span class="nv">$0</span><span class="p">}</span>
            <span class="o">.</span><span class="n">flatMap</span><span class="p">{</span><span class="nv">$0</span><span class="p">}</span>                                                <span class="c1">// Remove nil entries</span>
            <span class="o">.</span><span class="nf">map</span><span class="p">(</span><span class="n">localizedStrings</span><span class="p">)</span>                                      <span class="c1">// Find localizedStrings ocurrences</span>
            <span class="o">.</span><span class="n">flatMap</span><span class="p">{</span><span class="nv">$0</span><span class="p">}</span>                                                <span class="c1">// Flatten</span>
    <span class="cp">#endif</span>
<span class="p">}</span>
</pre></table></code></div></div><p>^遍历所有专案档案并进行正则匹配的方法</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c1">//要让 build 时出现 Error ❌：</span>
<span class="nf">print</span><span class="p">(</span><span class="s">"Project档案.lproj"</span> <span class="o">+</span> <span class="s">"/档案:行: "</span> <span class="o">+</span> <span class="s">"error: 错误讯息"</span><span class="p">)</span>
<span class="c1">//要让 build 时出现 Warning ⚠️：</span>
<span class="nf">print</span><span class="p">(</span><span class="s">"Project档案.lproj"</span> <span class="o">+</span> <span class="s">"/档案:行: "</span> <span class="o">+</span> <span class="s">"warning: 警告讯息"</span><span class="p">)</span>
</pre></table></code></div></div><p>^print error or warning</p><p>可以综合参考以上的程式方法，自己打造想要的工具。</p><h3 id="总结"><span class="me-2">总结</span><a href="#总结" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>这两个检查工具导入之后，我们在开发上就能更安心、更有效率并且减少冗余；也因为这次经验大开眼界，日后如果有什么新的 build run script 需求都能直接使用最熟悉的语言 swift 来进行制作！</p><p>有任何问题及指教欢迎 <a href="https://www.zhgchg.li/contact" target="_blank">与我联络</a> 。</p><hr /><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=🍺&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a><br /></p><blockquote class="prompt-info"><p>本文首次发表于 Medium (<a href="https://medium.com/p/41c49a75a743" target="_blank"><strong>点击查看原始版本</strong></a>)，由 <a href="/posts/tools/medium-to-jekyll/" target="_blank">ZMediumToMarkdown</a> 提供自动转换与同步技术。</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/zh-cn/zmediumtomarkdown/2020-09-17-41c49a75a743.md" target="_blank">Improve this page on Github.</a></p></blockquote><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1K+ Followers</span></a></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-dev/">ZRealm Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/simplified-chinese/" class="post-tag no-text-decoration" >simplified-chinese</a> <a href="/tags/ios/" class="post-tag no-text-decoration" >ios</a> <a href="/tags/shell-script/" class="post-tag no-text-decoration" >shell-script</a> <a href="/tags/xcode/" class="post-tag no-text-decoration" >xcode</a> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/toolkit/" class="post-tag no-text-decoration" >toolkit</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Xcode%20Swift%20Run%20Script%EF%BD%9C%E8%87%AA%E5%8A%A8%E6%A3%80%E6%9F%A5%E5%A4%9A%E8%AF%AD%E7%B3%BB%E4%B8%8E%E5%9B%BE%E7%89%87%E8%B5%84%E6%BA%90%E7%BC%BA%E6%BC%8F%E6%8F%90%E5%8D%87%E5%BC%80%E5%8F%91%E6%95%88%E7%8E%87%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fxcode-swift-run-script-%25E8%2587%25AA%25E5%258A%25A8%25E6%25A3%2580%25E6%259F%25A5%25E5%25A4%259A%25E8%25AF%25AD%25E7%25B3%25BB%25E4%25B8%258E%25E5%259B%25BE%25E7%2589%2587%25E8%25B5%2584%25E6%25BA%2590%25E7%25BC%25BA%25E6%25BC%258F%25E6%258F%2590%25E5%258D%2587%25E5%25BC%2580%25E5%258F%2591%25E6%2595%2588%25E7%258E%2587-41c49a75a743%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Xcode%20Swift%20Run%20Script%EF%BD%9C%E8%87%AA%E5%8A%A8%E6%A3%80%E6%9F%A5%E5%A4%9A%E8%AF%AD%E7%B3%BB%E4%B8%8E%E5%9B%BE%E7%89%87%E8%B5%84%E6%BA%90%E7%BC%BA%E6%BC%8F%E6%8F%90%E5%8D%87%E5%BC%80%E5%8F%91%E6%95%88%E7%8E%87%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fxcode-swift-run-script-%25E8%2587%25AA%25E5%258A%25A8%25E6%25A3%2580%25E6%259F%25A5%25E5%25A4%259A%25E8%25AF%25AD%25E7%25B3%25BB%25E4%25B8%258E%25E5%259B%25BE%25E7%2589%2587%25E8%25B5%2584%25E6%25BA%2590%25E7%25BC%25BA%25E6%25BC%258F%25E6%258F%2590%25E5%258D%2587%25E5%25BC%2580%25E5%258F%2591%25E6%2595%2588%25E7%258E%2587-41c49a75a743%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fxcode-swift-run-script-%25E8%2587%25AA%25E5%258A%25A8%25E6%25A3%2580%25E6%259F%25A5%25E5%25A4%259A%25E8%25AF%25AD%25E7%25B3%25BB%25E4%25B8%258E%25E5%259B%25BE%25E7%2589%2587%25E8%25B5%2584%25E6%25BA%2590%25E7%25BC%25BA%25E6%25BC%258F%25E6%258F%2590%25E5%258D%2587%25E5%25BC%2580%25E5%258F%2591%25E6%2595%2588%25E7%258E%2587-41c49a75a743%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/en/apple-watch-stainless-steel-milanese-loop-unboxing-premium-44mm-graphite-band-review-c0f99f987d9c/">Apple Watch Stainless Steel Milanese Loop Unboxing｜Premium 44mm Graphite Band Review</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/zh-cn/apple-watch-%E7%B1%B3%E5%85%B0%E8%A1%A8%E5%B8%A6%E5%BC%80%E7%AE%B1-%E5%8E%9F%E5%8E%82%E4%B8%8D%E9%94%88%E9%92%A2%E7%9F%B3%E5%A2%A8%E8%89%B2%E4%BC%98%E7%BC%BA%E7%82%B9%E5%85%A8%E8%A7%A3%E6%9E%90-c0f99f987d9c/">Apple Watch 原厂不锈钢米兰表带开箱</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/apple-watch-%E7%B1%B3%E8%98%AD%E9%8C%B6%E5%B8%B6%E9%96%8B%E7%AE%B1-%E5%8E%9F%E5%BB%A0%E4%B8%8D%E9%8F%BD%E9%8B%BC%E7%9F%B3%E5%A2%A8%E8%89%B2%E5%84%AA%E7%BC%BA%E9%BB%9E%E5%85%A8%E8%A7%A3%E6%9E%90-c0f99f987d9c/">Apple Watch 原廠不鏽鋼米蘭錶帶開箱</a><li class="text-truncate lh-lg"> <a href="/posts/travel-journals/en/busan-travel-guide-8-day-itinerary-with-visit-busan-pass-for-seamless-exploration-8ace34a1a3d8/">Busan Travel Guide｜8-Day Itinerary with VISIT BUSAN PASS for Seamless Exploration</a><li class="text-truncate lh-lg"> <a href="/posts/z-%E5%BA%A6%E6%97%85%E8%A1%8C%E9%81%8A%E8%A8%98/zh-cn/%E9%87%9C%E5%B1%B1%E8%87%AA%E7%94%B1%E8%A1%8C%E6%94%BB%E7%95%A5-8%E5%A4%A97%E5%A4%9C%E5%BF%85%E5%8E%BB%E6%99%AF%E7%82%B9-%E7%BE%8E%E9%A3%9F%E4%B8%8E%E4%BA%A4%E9%80%9A%E5%85%A8%E8%A7%A3%E6%9E%90-%E9%87%9C%E5%B1%B1%E9%80%9A%E8%A1%8C%E8%AF%81%E7%9C%81%E9%92%B1%E7%A7%98%E8%AF%80-8ace34a1a3d8/">游记 2025 韩国釜山 8 天 7 夜自由行</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">章節 (Chapters)🔖</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-dev/xcode-swift-run-script-%E8%87%AA%E5%8B%95%E6%AA%A2%E6%9F%A5%E5%A4%9A%E8%AA%9E%E7%B3%BB%E8%88%87%E5%9C%96%E7%89%87%E8%B3%87%E6%BA%90%E7%BC%BA%E6%BC%8F%E6%8F%90%E5%8D%87%E9%96%8B%E7%99%BC%E6%95%88%E7%8E%87-41c49a75a743/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1600358000" data-df="ll" > Sep 17, 2020 </time><h4 class="pt-0 my-2">Xcode 直接使用 Swift 撰寫 Run Script！</h4><div class="text-muted"><p>導入 Localization 多語系及 Image Assets 缺漏檢查、使用 Swift 打造 Run Script 腳本</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/en/swift-run-script-in-xcode-localization-image-asset-checks-automated-41c49a75a743/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1600358000" data-df="ll" > Sep 17, 2020 </time><h4 class="pt-0 my-2">Swift Run Script in Xcode｜Localization & Image Asset Checks Automated</h4><div class="text-muted"><p>Developers facing localization and image asset omissions can automate detection using Swift-based Run Scripts in Xcode, streamlining project integrity and reducing manual errors effectively.</p></div></div></a></article><article class="col"> <a href="/posts/zh-cn/avplayer-%E8%BE%B9%E6%92%AD%E8%BE%B9-cache-%E6%8A%80%E6%9C%AF%E5%AE%9E%E6%88%98-ios-%E6%9C%AC%E5%9C%B0%E7%BC%93%E5%AD%98%E4%BC%98%E5%8C%96%E6%94%BB%E7%95%A5-ee47f8f1e2d2/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1609856872" data-df="ll" > Jan 5, 2021 </time><h4 class="pt-0 my-2">AVPlayer 边播边 Cache 实战</h4><div class="text-muted"><p>AVPlayer/AVQueuePlayer with AVURLAsset 实作 AVAssetResourceLoaderDelegate 达成边播放音乐/影片边缓存</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-dev/en/swift-run-script-in-xcode-localization-image-asset-checks-automated-41c49a75a743/" class="btn btn-outline-primary" aria-label="Older" ><p>Swift Run Script in Xcode｜Localization & Image Asset Checks Automated</p></a> <a href="/posts/zrealm-dev/xcode-swift-run-script-%E8%87%AA%E5%8B%95%E6%AA%A2%E6%9F%A5%E5%A4%9A%E8%AA%9E%E7%B3%BB%E8%88%87%E5%9C%96%E7%89%87%E8%B3%87%E6%BA%90%E7%BC%BA%E6%BC%8F%E6%8F%90%E5%8D%87%E9%96%8B%E7%99%BC%E6%95%88%E7%8E%87-41c49a75a743/" class="btn btn-outline-primary" aria-label="Newer" ><p>Xcode 直接使用 Swift 撰寫 Run Script！</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span> <a href="/">中文</a>|<a href="/tags/simplified-chinese">简中</a>|<a href="/tags/english/">English</a></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a> <br/></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
