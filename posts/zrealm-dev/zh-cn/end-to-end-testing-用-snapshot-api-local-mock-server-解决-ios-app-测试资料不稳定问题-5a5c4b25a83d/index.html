<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="End-to-End Testingï½œç”¨ Snapshot API Local Mock Server è§£å†³ iOS App æµ‹è¯•èµ„æ–™ä¸ç¨³å®šé—®é¢˜" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="é’ˆå¯¹ iOS App åŠç°æœ‰ API æ— æ³•è½»æ˜“è¡¥è¶³å•å…ƒæµ‹è¯•çš„ç—›ç‚¹ï¼Œé€è¿‡ Snapshot API Local Mock Server å®ç° API Request &amp; Response å½•åˆ¶ä¸å›æ”¾ï¼Œç¨³å®šæ¨¡æ‹Ÿæµ‹è¯•ç¯å¢ƒï¼Œé™ä½æµ‹è¯•è¯¯æŠ¥ç‡ï¼Œæå‡è‡ªåŠ¨åŒ– E2E æµ‹è¯•å¯é åº¦ä¸å¼€å‘æ•ˆç‡ã€‚" /><meta property="og:description" content="é’ˆå¯¹ iOS App åŠç°æœ‰ API æ— æ³•è½»æ˜“è¡¥è¶³å•å…ƒæµ‹è¯•çš„ç—›ç‚¹ï¼Œé€è¿‡ Snapshot API Local Mock Server å®ç° API Request &amp; Response å½•åˆ¶ä¸å›æ”¾ï¼Œç¨³å®šæ¨¡æ‹Ÿæµ‹è¯•ç¯å¢ƒï¼Œé™ä½æµ‹è¯•è¯¯æŠ¥ç‡ï¼Œæå‡è‡ªåŠ¨åŒ– E2E æµ‹è¯•å¯é åº¦ä¸å¼€å‘æ•ˆç‡ã€‚" /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-dev/zh-cn/end-to-end-testing-%E7%94%A8-snapshot-api-local-mock-server-%E8%A7%A3%E5%86%B3-ios-app-%E6%B5%8B%E8%AF%95%E8%B5%84%E6%96%99%E4%B8%8D%E7%A8%B3%E5%AE%9A%E9%97%AE%E9%A2%98-5a5c4b25a83d/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-dev/zh-cn/end-to-end-testing-%E7%94%A8-snapshot-api-local-mock-server-%E8%A7%A3%E5%86%B3-ios-app-%E6%B5%8B%E8%AF%95%E8%B5%84%E6%96%99%E4%B8%8D%E7%A8%B3%E5%AE%9A%E9%97%AE%E9%A2%98-5a5c4b25a83d/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/5a5c4b25a83d/1*L-FE2o3LRQQZSLZQx96urw.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-08-28T22:53:27+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/5a5c4b25a83d/1*L-FE2o3LRQQZSLZQx96urw.webp" /><meta property="twitter:title" content="End-to-End Testingï½œç”¨ Snapshot API Local Mock Server è§£å†³ iOS App æµ‹è¯•èµ„æ–™ä¸ç¨³å®šé—®é¢˜" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://medium.com/@zhgchgli/"},"dateModified":"2023-09-04T22:32:47+08:00","datePublished":"2023-08-28T22:53:27+08:00","description":"é’ˆå¯¹ iOS App åŠç°æœ‰ API æ— æ³•è½»æ˜“è¡¥è¶³å•å…ƒæµ‹è¯•çš„ç—›ç‚¹ï¼Œé€è¿‡ Snapshot API Local Mock Server å®ç° API Request &amp; Response å½•åˆ¶ä¸å›æ”¾ï¼Œç¨³å®šæ¨¡æ‹Ÿæµ‹è¯•ç¯å¢ƒï¼Œé™ä½æµ‹è¯•è¯¯æŠ¥ç‡ï¼Œæå‡è‡ªåŠ¨åŒ– E2E æµ‹è¯•å¯é åº¦ä¸å¼€å‘æ•ˆç‡ã€‚","headline":"End-to-End Testingï½œç”¨ Snapshot API Local Mock Server è§£å†³ iOS App æµ‹è¯•èµ„æ–™ä¸ç¨³å®šé—®é¢˜","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+","url":"https://zhgchg.li/assets/5a5c4b25a83d/1*L-FE2o3LRQQZSLZQx96urw.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-dev/zh-cn/end-to-end-testing-%E7%94%A8-snapshot-api-local-mock-server-%E8%A7%A3%E5%86%B3-ios-app-%E6%B5%8B%E8%AF%95%E8%B5%84%E6%96%99%E4%B8%8D%E7%A8%B3%E5%AE%9A%E9%97%AE%E9%A2%98-5a5c4b25a83d/"},"url":"https://zhgchg.li/posts/zrealm-dev/zh-cn/end-to-end-testing-%E7%94%A8-snapshot-api-local-mock-server-%E8%A7%A3%E5%86%B3-ios-app-%E6%B5%8B%E8%AF%95%E8%B5%84%E6%96%99%E4%B8%8D%E7%A8%B3%E5%AE%9A%E9%97%AE%E9%A2%98-5a5c4b25a83d/"}</script><title>End-to-End Testingï½œç”¨ Snapshot API Local Mock Server è§£å†³ iOS App æµ‹è¯•èµ„æ–™ä¸ç¨³å®šé—®é¢˜ | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script><link rel="alternate" hreflang="en" href="/posts/zrealm-dev/en/poc-app-e2e-testing-local-snapshot-api-mock-server-for-reliable-validation-5a5c4b25a83d/"><link rel="alternate" hreflang="zh-Hant" href="/posts/zrealm-dev/end-to-end-testing-%E7%94%A8-snapshot-api-local-mock-server-%E8%A7%A3%E6%B1%BA-ios-app-%E6%B8%AC%E8%A9%A6%E8%B3%87%E6%96%99%E4%B8%8D%E7%A9%A9%E5%AE%9A%E5%95%8F%E9%A1%8C-5a5c4b25a83d/"><link rel="alternate" hreflang="zh-Hans" href="/posts/zrealm-dev/zh-cn/end-to-end-testing-%E7%94%A8-snapshot-api-local-mock-server-%E8%A7%A3%E5%86%B3-ios-app-%E6%B5%8B%E8%AF%95%E8%B5%84%E6%96%99%E4%B8%8D%E7%A8%B3%E5%AE%9A%E9%97%AE%E9%A2%98-5a5c4b25a83d/"><link rel="alternate" hreflang="x-default" href="/posts/zrealm-dev/zh-cn/end-to-end-testing-%E7%94%A8-snapshot-api-local-mock-server-%E8%A7%A3%E5%86%B3-ios-app-%E6%B5%8B%E8%AF%95%E8%B5%84%E6%96%99%E4%B8%8D%E7%A8%B3%E5%AE%9A%E9%97%AE%E9%A2%98-5a5c4b25a83d/"><link rel="stylesheet" href="/assets/css/post-toc.css"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0">An iOS, web, and automation developer from Taiwan ğŸ‡¹ğŸ‡¼ who also loves sharing, traveling, and writing.</p><a href="https://medium.com/@zhgchgli" target="_blank" style="display: block;text-align: center;font-style: normal;/* text-decoration: underline; */font-size: 1.2em;color: var(--heading-color);">1K+ Followers on Medium</a></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/english/" class="nav-link"> <i class="fa-fw fa fa-solid fa-language"></i> <span>ENGLISH POSTS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>End-to-End Testingï½œç”¨ Snapshot API Local Mock Server è§£å†³ iOS App æµ‹è¯•èµ„æ–™ä¸ç¨³å®šé—®é¢˜</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>End-to-End Testingï½œç”¨ Snapshot API Local Mock Server è§£å†³ iOS App æµ‹è¯•èµ„æ–™ä¸ç¨³å®šé—®é¢˜</h1><p class="post-desc fw-light mb-4">é’ˆå¯¹ iOS App åŠç°æœ‰ API æ— æ³•è½»æ˜“è¡¥è¶³å•å…ƒæµ‹è¯•çš„ç—›ç‚¹ï¼Œé€è¿‡ Snapshot API Local Mock Server å®ç° API Request & Response å½•åˆ¶ä¸å›æ”¾ï¼Œç¨³å®šæ¨¡æ‹Ÿæµ‹è¯•ç¯å¢ƒï¼Œé™ä½æµ‹è¯•è¯¯æŠ¥ç‡ï¼Œæå‡è‡ªåŠ¨åŒ– E2E æµ‹è¯•å¯é åº¦ä¸å¼€å‘æ•ˆç‡ã€‚</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1693234407" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Aug 28, 2023 </time> </span> <span> Updated <time data-ts="1693837967" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Sep 4, 2023 </time> </span><div class="mt-3 mb-3"> <a href="/assets/5a5c4b25a83d/1*L-FE2o3LRQQZSLZQx96urw.webp" class="popup img-link preview-img blur"><img data-src="/assets/5a5c4b25a83d/1*L-FE2o3LRQQZSLZQx96urw.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></div><div class="d-flex justify-content-between"> <span style="display: inline-flex; align-items: center; gap: 4px;"> By <em> <a href="https://medium.com/@zhgchgli/">ZhgChgLi</a> </em> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" style="display: block; "><path fill="#007bff" d="M271.2 56C265.1 49.8 256.2 47.3 247.8 49.6C239.4 51.9 232.9 58.4 230.8 66.8L215.5 127C214.4 131.4 209.9 134 205.6 132.7L145.8 115.9C137.4 113.5 128.4 115.9 122.3 122C116.2 128.1 113.8 137.1 116.2 145.5L133.1 205.3C134.3 209.6 131.7 214.1 127.4 215.2L67.1 230.5C58.7 232.6 52.1 239.2 49.8 247.6C47.5 256 50 264.9 56.2 271L100.7 314.3C103.9 317.4 103.9 322.6 100.7 325.8L56.3 369.1C50.1 375.2 47.6 384.1 49.9 392.5C52.2 400.9 58.8 407.4 67.2 409.6L127.4 424.9C131.8 426 134.4 430.5 133.1 434.8L116.2 494.5C113.8 502.9 116.2 511.9 122.3 518C128.4 524.1 137.4 526.5 145.8 524.1L205.6 507.2C209.9 506 214.4 508.6 215.5 512.9L230.8 573.1C232.9 581.5 239.5 588.1 247.9 590.4C256.3 592.7 265.2 590.2 271.3 584L314.6 539.5C317.7 536.3 322.9 536.3 326.1 539.5L369.3 584C375.4 590.2 384.3 592.7 392.7 590.4C401.1 588.1 407.6 581.5 409.8 573.1L425.1 513C426.2 508.6 430.7 506 435 507.3L494.8 524.2C503.2 526.6 512.2 524.2 518.3 518.1C524.4 512 526.8 503 524.4 494.6L507.5 434.8C506.3 430.5 508.9 426 513.2 424.9L573.4 409.6C581.8 407.5 588.4 400.9 590.7 392.5C593 384.1 590.5 375.1 584.3 369.1L539.8 325.8C536.6 322.7 536.6 317.5 539.8 314.3L584.3 271C590.5 264.9 593 256 590.7 247.6C588.4 239.2 581.8 232.7 573.4 230.5L513.2 215.2C508.8 214.1 506.2 209.6 507.5 205.3L524.4 145.5C526.8 137.1 524.4 128.1 518.3 122C512.2 115.9 503.2 113.5 494.8 115.9L435 132.8C430.7 134 426.2 131.4 425.1 127.1L409.8 66.8C407.7 58.4 401.1 51.8 392.7 49.5C384.3 47.2 375.4 49.7 369.3 55.9L326 100.5C322.9 103.7 317.7 103.7 314.5 100.5L271.2 56z"/><path d="M250 330 l60 60 100 -140" stroke="#ffffff" stroke-width="40" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="5135 words" > <em>28 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">End-to-End Testingï½œç”¨ Snapshot API Local Mock Server è§£å†³ iOS App æµ‹è¯•èµ„æ–™ä¸ç¨³å®šé—®é¢˜</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">ç« ç¯€ (Chapters)ğŸ”–</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">End-to-End Testingï½œç”¨ Snapshot API Local Mock Server è§£å†³ iOS App æµ‹è¯•èµ„æ–™ä¸ç¨³å®šé—®é¢˜</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/en/poc-app-e2e-testing-local-snapshot-api-mock-server-for-reliable-validation-5a5c4b25a83d/"><strong>Click here</strong></a> to view the English version of this article.</p></blockquote><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/end-to-end-testing-%E7%94%A8-snapshot-api-local-mock-server-%E8%A7%A3%E6%B1%BA-ios-app-%E6%B8%AC%E8%A9%A6%E8%B3%87%E6%96%99%E4%B8%8D%E7%A9%A9%E5%AE%9A%E5%95%8F%E9%A1%8C-5a5c4b25a83d/"><strong>é»æ“Šé€™è£¡</strong></a>æŸ¥çœ‹æœ¬æ–‡ç« æ­£é«”ä¸­æ–‡ç‰ˆæœ¬ã€‚</p></blockquote><blockquote class="prompt-info"><p>åŸºäº SEO è€ƒé‡ï¼Œæœ¬æ–‡æ ‡é¢˜ä¸æè¿°ç» AI è°ƒæ•´ï¼ŒåŸå§‹ç‰ˆæœ¬è¯·å‚è€ƒå†…æ–‡ã€‚</p></blockquote><hr /><h3 id="poc-app-end-to-end-testing-local-snapshot-api-mock-server"><span class="me-2">[POC] App End-to-End Testing Local Snapshot API Mock Server</span><a href="#poc-app-end-to-end-testing-local-snapshot-api-mock-server" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>ä¸ºç°æˆ App åŠç°æœ‰ API æ¶æ„å®ç° E2E Testing çš„å¯èƒ½æ€§éªŒè¯</p><p><a href="/assets/5a5c4b25a83d/1*L-FE2o3LRQQZSLZQx96urw.webp" class="popup img-link blur"><img data-src="/assets/5a5c4b25a83d/1*L-FE2o3LRQQZSLZQx96urw.webp" alt="Photo by [freestocks](https://unsplash.com/@freestocks?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjkzMyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Photo by <a href="https://unsplash.com/@freestocks?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank">freestocks</a></p><h3 id="å‰è¨€"><span class="me-2">å‰è¨€</span><a href="#å‰è¨€" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>ä½œä¸ºä¸€ä¸ªå·²åœ¨çº¿ä¸Šè¿ä½œå¤šå¹´çš„ä¸“æ¡ˆï¼Œå¦‚ä½•æŒç»­æå‡ç¨³å®šæ€§æ˜¯ä¸€ä»¶æå…·æŒ‘æˆ˜çš„é—®é¢˜ã€‚</p><h4 id="unit-testing"><span class="me-2">Unit Testing</span><a href="#unit-testing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/5a5c4b25a83d/1*QAuldnLTydk33IgAdkXR-w.webp" class="popup img-link blur"><img data-src="/assets/5a5c4b25a83d/1*QAuldnLTydk33IgAdkXR-w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MDAiIGhlaWdodD0iMTY4OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>App å› å¼€å‘è¯­è¨€ Swift/Kotlin é™æ€+ç¼–è¯‘+å¼ºå‹åˆ« æˆ– Objective-C to Swift åŠ¨æ€è½¬é™æ€ï¼Œåœ¨å¼€å‘æ—¶æ²¡è€ƒè™‘åˆ°å¯æµ‹è¯•æ€§æŠŠä»‹é¢ä¾èµ–åˆ‡å¹²å‡€ï¼Œåé¢è¦è¡¥ Unit Testing å‡ ä¹ä¸å¯èƒ½ï¼›ä½†åœ¨é‡æ„çš„è¿‡ç¨‹ä¹Ÿä¼šå¸¦æ¥ä¸ç¨³å®šå› ç´ ï¼Œä¼šé™·å…¥ä¸€ä¸ªé¸¡ç”Ÿè›‹è›‹ç”Ÿé¸¡é—®é¢˜ã€‚</p><h4 id="ui-testing"><span class="me-2">UI Testing</span><a href="#ui-testing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>å¯¹ UI äº¤äº’ã€æŒ‰é’®æµ‹è¯•ï¼›æ–°å¼€å‘æˆ–æ—§æœ‰çš„ç”»é¢ç¨å¾®è§£è€¦èµ„æ–™ä¾èµ–å°±å¯ä»¥å®ç°ã€‚</p><h4 id="snapshot-testing"><span class="me-2">SnapShot Testing</span><a href="#snapshot-testing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>éªŒè¯è°ƒæ•´å‰åçš„ UI æ˜¾ç¤ºå†…å®¹ã€æ ·å¼æ˜¯å¦ä¸€è‡´ï¼›åŒ UI Testingï¼Œæ–°å¼€å‘æˆ–æ—§æœ‰çš„ç”»é¢ç¨å¾®è§£è€¦èµ„æ–™ä¾èµ–å°±å¯ä»¥å®ç°ã€‚</p><p>ç”¨åœ¨ Storyboard/XIB è½¬ Code Layout or UIView from OC to Swift å¾ˆå®ç”¨ï¼›å¯ä»¥ç›´æ¥å¯¼å…¥ <a href="https://github.com/pointfreeco" target="_blank">pointfreeco</a> / <a href="https://github.com/pointfreeco/swift-snapshot-testing" target="_blank">swift-snapshot-testing</a> å¿«é€Ÿå®ç°ã€‚</p><p><a href="https://github.com/pointfreeco/swift-snapshot-testing" target="_blank" class="img-link shimmer" ><img src="https://opengraph.githubassets.com/b3cc52a5b949767e4cb0af82145ed6474334d3235bd785ee1f7891c6b65fd69a/pointfreeco/swift-snapshot-testing" alt="" loading="lazy"></a></p><p>è™½ç„¶æˆ‘ä»¬å¯ä»¥åæœŸè¡¥ä¸Š UI Testingã€SnapShot Testingï¼Œä½†èƒ½æ¶µç›–çš„æµ‹è¯•èŒƒå›´å¾ˆæœ‰é™ï¼›å› ä¸ºå¤šåŠçš„é”™è¯¯ä¸ä¼šæ˜¯ UI æ ·å¼ï¼Œè€Œæ˜¯æµç¨‹æˆ–æ˜¯é€»è¾‘é—®é¢˜ï¼Œå¯¼è‡´ä½¿ç”¨è€…ä¸­æ–­æ“ä½œï¼Œ <strong>å¦‚æœå‡ºç°åœ¨ç»“å¸æµç¨‹ï¼Œç‰µæ¶‰åˆ°è¥æ”¶ï¼Œé—®é¢˜å±‚çº§å°±å¾ˆä¸¥é‡</strong> ã€‚</p><h3 id="end-to-end-testing"><span class="me-2">End-to-End Testing</span><a href="#end-to-end-testing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>å¦‚å‰è¿°ï¼Œæ— æ³•åœ¨ç°è¡Œä¸“æ¡ˆç®€æ˜“çš„è¡¥ä¸Šå•å…ƒæµ‹è¯•ä¹Ÿæ— æ³•èšæ‹¢å•å…ƒåšæ•´åˆæµ‹è¯•ï¼Œå¯¹äºé€»è¾‘ã€æµç¨‹çš„é˜²æŠ¤ï¼Œè¿˜å‰©ä¸‹ä»å¤–éƒ¨åš End-to-End é»‘ç®±æµ‹è¯•çš„æ–¹æ³•ï¼Œç›´æ¥ä»¥ä½¿ç”¨è€…è§’åº¦å‡ºå‘ï¼Œæ“ä½œæµç¨‹æ£€æŸ¥é‡è¦çš„æµç¨‹(æ³¨å†Œ/ç»“å¸â€¦)æ˜¯å¦æ­£å¸¸ã€‚</p><blockquote><p>å¯¹é‡å¤§åŠŸèƒ½çš„é‡æ„ä¹Ÿèƒ½å…ˆå»ºç«‹é‡æ„å‰çš„æµç¨‹æµ‹è¯•ï¼Œé‡æ„åé‡æ–°éªŒè¯ï¼Œç¡®ä¿é‡æ„ååŠŸèƒ½å¦‚é¢„æœŸã€‚</p></blockquote><blockquote><p>é‡æ„ä¸­ä¸€å¹¶è¡¥ä¸Š Unit Testingã€Integration Testing å¢åŠ ç¨³å®šæ€§ï¼Œæ‰“ç ´é¸¡ç”Ÿè›‹è›‹ç”Ÿé¸¡çš„é—®é¢˜ã€‚</p></blockquote><h4 id="qa-team"><span class="me-2">QA Team</span><a href="#qa-team" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>End-to-End Testing æœ€ç›´æ¥æš´åŠ›çš„æ–¹å¼å°±æ˜¯è¯·ä¸€ç»„ QA Team ä¾ç…§ Test Plan è¿›è¡Œæ‰‹åŠ¨æµ‹è¯•ï¼Œç„¶åå†æŒç»­ä¼˜åŒ–æˆ–å¼•å…¥è‡ªåŠ¨åŒ–æ“ä½œï¼›è®¡ç®—äº†ä¸€ä¸‹æˆæœ¬è‡³å°‘éœ€è¦ 2 ä½å·¥ç¨‹å¸ˆ + 1 ä½ Leader èŠ±è´¹è‡³å°‘åŠå¹´ä¸€å¹´æ—¶é—´æ‰èƒ½çœ‹åˆ°æˆæœã€‚</p><p>è¯„ä¼°æ—¶é—´ä¸æˆæœ¬ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆæ˜¯ç°å†µæˆ‘ä»¬èƒ½åšçš„æˆ–æ˜¯èƒ½ä¸ºæœªæ¥ QA Team åšå¥½å‡†å¤‡ï¼Œå½“æœ‰ QA Team æ—¶èƒ½ç›´æ¥è·³åˆ°ä¼˜åŒ–ä¸è‡ªåŠ¨åŒ–æ“ä½œç”šè‡³å¯¼å…¥ AI(?)ã€‚</p><h4 id="automation"><span class="me-2">Automation</span><a href="#automation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>ç°é˜¶æ®µä»¥å¯¼å…¥è‡ªåŠ¨åŒ– End-to-End Testing ä¸ºç›®æ ‡ï¼Œæ”¾åœ¨ CI/CD ç¯èŠ‚è‡ªåŠ¨æ£€æŸ¥ï¼Œæµ‹è¯•å†…å®¹å¯ä»¥ä¸ç”¨å¤ªå®Œæ•´ã€åªè¦èƒ½é˜²æ­¢é‡å¤§æµç¨‹é—®é¢˜å°±å·²ç»å¾ˆæœ‰ä»·å€¼äº†ï¼›åé¢å†æ…¢æ…¢è¿­ä»£ Test Plan é€æ­¥è¡¥é½å®ˆå¤‡èŒƒå›´ã€‚</p><h3 id="end-to-end-testing-æŠ€æœ¯éš¾ç‚¹"><span class="me-2">End-to-End Testing â€”æŠ€æœ¯éš¾ç‚¹</span><a href="#end-to-end-testing-æŠ€æœ¯éš¾ç‚¹" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="ui-æ“ä½œé—®é¢˜"><span class="me-2">UI æ“ä½œé—®é¢˜</span><a href="#ui-æ“ä½œé—®é¢˜" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>App çš„åŸç†æ¯”è¾ƒåƒæ˜¯é€è¿‡å¦ä¸€ä¸ªæµ‹è¯• App å»æ“ä½œæˆ‘ä»¬çš„è¢«æµ‹è¯• Appï¼Œç„¶åä» View Hierarchy å»æ‰¾å¯»ç›®æ ‡ç‰©ä»¶ï¼›å¹¶ä¸”åœ¨æµ‹è¯•æ—¶æ— æ³•å–å¾—è¢«æµ‹è¯• App çš„ Log æˆ– Outputï¼Œå› ä¸ºæœ¬è´¨ä¸Šå°±æ˜¯ä¸¤ä¸ªä¸åŒ Appã€‚</p><p>iOS éœ€è¦å®Œå–„ View Accessibility Identifier å¢åŠ æ•ˆç‡ä¸å‡†ç¡®æ€§è¿˜æœ‰è¦å¤„ç† Alert (e.g. æ¨æ’­è¯·æ±‚)ã€‚</p><p>Android åœ¨ä¹‹å‰çš„å®ä½œä¸Šæœ‰é‡åˆ°æ··ç”¨ Compose ä¸ Fragment æ—¶ä¼šæ‰¾ä¸åˆ°ç›®æ ‡ç‰©ä»¶çš„é—®é¢˜ï¼Œä½†æ® Teammate è¡¨ç¤ºï¼Œæ–°ç‰ˆçš„ Compose å·²ç»è§£å†³ã€‚</p><p>é™¤ä»¥ä¸Šä¼ ç»Ÿå¸¸è§é—®é¢˜å¤–ï¼Œæ›´å¤§çš„é—®é¢˜æ˜¯åŒå¹³å°éš¾ä»¥æ•´åˆ(å†™ä¸€ä¸ªæµ‹è¯•è·‘ä¸¤ä¸ªå¹³å°)ï¼›ç›®å‰æˆ‘ä»¬åœ¨å°è¯•ä½¿ç”¨æ–°çš„æµ‹è¯•å·¥å…· <a href="https://github.com/mobile-dev-inc" target="_blank">mobile-dev-inc</a> / <a href="https://github.com/mobile-dev-inc/maestro" target="_blank">maestro</a> ï¼š</p><p><a href="https://github.com/mobile-dev-inc/maestro" target="_blank" class="img-link shimmer" ><img src="https://opengraph.githubassets.com/d9e6bc8b1cb6b3db5f52dd9bfa04fe2661ed172d7be82155b8f3e4b6c874f821/mobile-dev-inc/maestro" alt="" loading="lazy"></a></p><p>å¯ä»¥ç”¨ YAML å†™ Test Plan ç„¶ååœ¨åŒå¹³å°æ‰§è¡Œæµ‹è¯•ï¼Œç»†èŠ‚ä½¿ç”¨æ–¹å¼ã€è¯•ç”¨å¿ƒå¾—ï¼Œé™å¾…å¦ä¸€ä½ Teammate çš„æ–‡ç« åˆ†äº« ccâ€™ed <a href="https://medium.com/u/1139df7a27f3" target="_blank">Alejandra Ts.</a> ğŸ˜ã€‚</p><h4 id="api-èµ„æ–™é—®é¢˜"><span class="me-2">API èµ„æ–™é—®é¢˜</span><a href="#api-èµ„æ–™é—®é¢˜" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>å¯¹äº App E2E Testing æœ€å¤§çš„æµ‹è¯•å˜é‡å°±æ˜¯ API èµ„æ–™ï¼Œå¦‚æœæ— æ³•æä¾›ä¿è¯ç¡®å®šçš„èµ„æ–™ï¼Œä¼šå¢åŠ æµ‹è¯•çš„ä¸ç¨³å®šæ€§ï¼Œå¯¼è‡´è¯¯æŠ¥ï¼Œæœ€åå¤§å®¶å¯¹ Test Plan ä¹Ÿä¸å†æœ‰ä¿¡å¿ƒäº†ã€‚</p><p>ä¾‹å¦‚æµ‹è¯•ç»“å¸æµç¨‹ï¼Œå¦‚æœå•†å“æœ‰å¯èƒ½è¢«ä¸‹æ¶æˆ–æ¶ˆå¤±ï¼Œä¸”è¿™äº›çŠ¶æ€æ”¹å˜ä¸æ˜¯ App å¯æ§çš„å°±å¾ˆæœ‰å¯èƒ½å‡ºç°ä»¥ä¸ŠçŠ¶å†µã€‚</p><p>è§£å†³èµ„æ–™é—®é¢˜çš„æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œå¯ä»¥å»ºç«‹å¹²å‡€çš„ Staging æˆ– Testing ç¯å¢ƒï¼›æˆ–æ˜¯åŸºäº Open API çš„ Auto-Gen Mock API Serverï¼›ä½†éƒ½éœ€è¦ä¾èµ–åç«¯ã€ä¾èµ– API çš„å¤–éƒ¨å› ç´ ï¼ŒåŠ ä¸Šåç«¯ API åŒ App ä¸€æ ·æ˜¯åœ¨çº¿ä¸Šè¿ä½œå¤šå¹´çš„ä¸“æ¡ˆï¼Œéƒ¨ä»½è§„æ ¼ä¹Ÿè¿˜åœ¨é‡æ„ Migrate æš‚æ—¶æ— æ³•æœ‰ Mock Serverã€‚</p><p>åŸºäºä»¥ä¸Šå› ç´ ï¼Œå¦‚æœå°±å¡åœ¨è¿™ï¼Œé‚£é—®é¢˜ä¸€æ ·ä¸ä¼šæ”¹å˜ã€é¸¡ç”Ÿè›‹è›‹ç”Ÿé¸¡é—®é¢˜ä¹Ÿæ— æ³•çªç ´ï¼ŒçœŸçš„å°±åªèƒ½ã€ŒæŒºè€Œèµ°é™©ã€çš„ç›´æ¥å…ˆæ”¹ã€å‡ºé—®é¢˜å†è¯´äº†ã€‚</p><h4 id="snapshot-api-local-mock-server"><span class="me-2">Snapshot API Local Mock Server</span><a href="#snapshot-api-local-mock-server" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><blockquote><p>ã€Œåªè¦æ€æƒ³ä¸æ»‘å¡ï¼Œæ–¹æ³•æ€»æ¯”å›°éš¾å¤šã€</p></blockquote><p>æˆ‘ä»¬å¯ä»¥æ¢ä¸€ä¸ªæƒ³æ³•ï¼Œå¦‚æœ UI å¯ä»¥ç”¨ Snapshot å¿«ç…§æˆå›¾ç‰‡ä¸‹æ¥ Replay è¿›è¡ŒéªŒè¯æµ‹è¯•ï¼Œé‚£ API æ˜¯å¦ä¹Ÿå¯ä»¥ï¼Ÿ æˆ‘ä»¬æ˜¯å¦å¯ä»¥æŠŠ API Request &amp; Response å­˜ä¸‹æ¥ï¼Œåœ¨åç»­ Replay è¿›è¡ŒéªŒè¯æµ‹è¯•ï¼Ÿ</p><p><strong>å€Ÿæ­¤å¼•å…¥æœ¬ç¯‡æ–‡ç« çš„é‡ç‚¹ï¼šå»ºç«‹ã€ŒSnapshot API Local Mock Serverã€Record API Request &amp; Replay Response å‰¥ç¦»ä¸ API èµ„æ–™çš„ä¾èµ–ã€‚</strong></p><blockquote><p>æœ¬æ–‡åªåšäº† POC æ¦‚å¿µéªŒè¯ï¼Œè¿˜æ²¡æœ‰çœŸæ­£å…¨é¢å®ç°é«˜è¦†ç›–ç‡çš„ End To End Testingï¼Œå› æ­¤åšæ³•ä»…ä¾›å‚è€ƒï¼Œ <strong>å¸Œæœ›å¯¹å¤§å®¶åœ¨ç°æœ‰ç¯å¢ƒä¸‹æœ‰æ–°çš„å¯å‘</strong> ã€‚</p></blockquote><h3 id="snapshot-api-local-mock-server-1"><span class="me-2">Snapshot API Local Mock Server</span><a href="#snapshot-api-local-mock-server-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="æ ¸å¿ƒæ¦‚å¿µ--record--replay-api-data"><span class="me-2">æ ¸å¿ƒæ¦‚å¿µ â€” Record &amp; Replay API Data</span><a href="#æ ¸å¿ƒæ¦‚å¿µ--record--replay-api-data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><strong>[Record]</strong> â€” End-to-End Testing Test Case å¼€å‘å®Œæˆåï¼Œæ‰“å¼€å½•åˆ¶å‚æ•°ï¼Œæ‰§è¡Œä¸€æ¬¡æµ‹è¯•ï¼Œè¿‡ç¨‹ä¸­æ‰€æœ‰ API Request &amp; Response ä¼šå­˜ä¸‹æ¥æ”¾åœ¨å„ä¸ª Test Case ç›®å½•å†…ã€‚</p><p><strong>[Replay]</strong> â€” åé¢åœ¨è·‘ Test Case æ—¶ï¼Œä¾ç…§è¯·æ±‚ä» Test Case ç›®å½•ä¸­æ‰¾åˆ°å¯¹åº”å½•åˆ¶ä¸‹æ¥çš„ Response Dataï¼Œå®Œæˆæµ‹è¯•æµç¨‹ã€‚</p><h4 id="ç¤ºæ„å›¾"><span class="me-2">ç¤ºæ„å›¾</span><a href="#ç¤ºæ„å›¾" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>å‡è®¾æˆ‘ä»¬è¦æµ‹è¯•åŠ å…¥è´­ä¹°æµç¨‹ï¼Œä½¿ç”¨è€…æ‰“å¼€ App ååœ¨é¦–é¡µç‚¹å‡»å•†å“å¡è¿›å…¥å•†å“è¯¦ç»†é¡µï¼ŒæŒ‰åº•éƒ¨è´­ä¹°ï¼Œè·³å‡ºç™»å…¥åŒ¡å®Œæˆç™»å…¥ï¼Œå®Œæˆè´­ä¹°ï¼Œè·³å‡ºè´­ä¹°æˆåŠŸæç¤ºï¼š</p><p><a href="/assets/5a5c4b25a83d/1*VtCOkH7iply6RQPs9zxJrw.webp" class="popup img-link blur"><img data-src="/assets/5a5c4b25a83d/1*VtCOkH7iply6RQPs9zxJrw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjExMjAiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>UI Testing å¦‚ä½•æ§åˆ¶æŒ‰é’®ç‚¹å‡»ã€è¾“å…¥åŒ¡è¾“å…¥â€¦ç­‰ç­‰ï¼Œä¸æ˜¯æœ¬æ–‡ä¸»è¦ç ”ç©¶é‡ç‚¹ï¼›å¯å‚è€ƒç°æœ‰çš„æµ‹è¯•æ¡†æ¶ç›´æ¥ä½¿ç”¨ã€‚</p><h4 id="regular-proxy-or-reverse-proxy"><span class="me-2">Regular Proxy or Reverse Proxy</span><a href="#regular-proxy-or-reverse-proxy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>è¦è¾¾æˆ Record &amp; Replay API éœ€è¦åœ¨ App ä¸ API ä¹‹é—´åŠ ä¸Š Proxy åšä¸­é—´äººæ”»å‡»ï¼Œå¯å‚è€ƒæˆ‘æ—©æœŸçš„æ–‡ç« ã€Œ <a href="/posts/zrealm-dev/zh-cn/app-https%E4%BC%A0%E8%BE%93%E4%BB%8D%E9%81%AD%E7%AA%83%E5%8F%96-mitmproxy%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB%E5%AE%9E%E6%88%98%E6%95%99%E5%AD%A6%E4%B8%8E%E9%98%B2%E8%8C%83%E6%8A%80%E5%B7%A7-46410aaada00/">APPæœ‰ç”¨HTTPSä¼ è¾“ï¼Œä½†èµ„æ–™è¿˜æ˜¯è¢«å·äº†ã€‚</a> ã€</p><p>ç®€å•æ¥è¯´å°±æ˜¯åœ¨ App ä¸ API ä¹‹é—´å¤šäº†ä¸€ä¸ªä»£ç†çš„ä¼ é€’è€…ï¼Œå¦‚åŒä¼ çº¸æ¡ä¸€æ ·ï¼ŒåŒæ–¹ä¼ é€’çš„è¯·æ±‚ä¸å›åº”éƒ½ä¼šç»è¿‡ä»–ï¼Œä»–å¯ä»¥æ‰“å¼€æ¥çº¸æ¡çš„å†…å®¹ï¼Œä¹Ÿå¯ä»¥ä¼ªé€ çº¸æ¡å†…å®¹ç»™å½¼æ­¤ï¼ŒåŒæ–¹ä¸ä¼šå¯Ÿè§‰ä½ ä»ä¸­åšæ¢—ã€‚</p><p><strong>æ­£å‘ä»£ç† Regular Proxyï¼š</strong></p><p>æ­£å‘ä»£ç†æ˜¯å®¢æˆ·ç«¯å‘ä»£ç†ä¼ºæœå™¨å‘é€è¯·æ±‚ï¼Œä»£ç†ä¼ºæœå™¨å†å°†è¯·æ±‚è½¬å‘ç»™ç›®æ ‡ä¼ºæœå™¨ï¼Œå¹¶å°†ç›®æ ‡ä¼ºæœå™¨çš„å›åº”è¿”å›ç»™å®¢æˆ·ç«¯ã€‚åœ¨æ­£å‘ä»£ç†æ¨¡å¼ä¸‹ï¼Œä»£ç†ä¼ºæœå™¨ä»£è¡¨å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ã€‚å®¢æˆ·ç«¯éœ€è¦æ˜ç¡®æŒ‡å®šä»£ç†ä¼ºæœå™¨çš„ä½å€å’ŒåŸ å·ï¼Œå¹¶å°†è¯·æ±‚å‘é€ç»™ä»£ç†ä¼ºæœå™¨ã€‚</p><p><strong>åå‘ä»£ç† Reverse Proxyï¼š</strong></p><p>åå‘ä»£ç†ä¸æ­£å‘ä»£ç†ç›¸åï¼Œå®ƒä½äºç›®æ ‡ä¼ºæœå™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´ã€‚å®¢æˆ·ç«¯å‘åå‘ä»£ç†ä¼ºæœå™¨å‘é€è¯·æ±‚ï¼Œåå‘ä»£ç†ä¼ºæœå™¨æ ¹æ®ä¸€å®šçš„è§„åˆ™å°†è¯·æ±‚è½¬å‘ç»™åç«¯çš„ç›®æ ‡ä¼ºæœå™¨ï¼Œå¹¶å°†ç›®æ ‡ä¼ºæœå™¨çš„å›åº”è¿”å›ç»™å®¢æˆ·ç«¯ã€‚å¯¹äºå®¢æˆ·ç«¯æ¥è¯´ï¼Œç›®æ ‡ä¼ºæœå™¨çœ‹èµ·æ¥å°±åƒæ˜¯åå‘ä»£ç†ä¼ºæœå™¨ï¼Œå®¢æˆ·ç«¯ä¸éœ€è¦çŸ¥é“ç›®æ ‡ä¼ºæœå™¨çš„çœŸå®ä½å€ã€‚</p><p>å¯¹æˆ‘ä»¬çš„éœ€æ±‚æ¥è¯´æ­£å‘æˆ–åå‘éƒ½å¯ä»¥è¾¾æˆç›®çš„ï¼Œå”¯ä¸€è¦è€ƒè™‘çš„äº‹æ˜¯ä»£ç†è®¾ç½®çš„æ–¹å¼ï¼š</p><p><strong>æ­£å‘ä»£ç†éœ€è¦åœ¨ç”µè„‘ä¸Šæˆ–æ‰‹æœºã€æ¨¡æ‹Ÿèµ·çš„ç½‘è·¯è®¾ç½®ä¸­æŒ‚ä¸Š Proxy ä»£ç†ï¼š</strong></p><ul><li><p>Android èƒ½åœ¨æ¨¡æ‹Ÿå™¨ä¸­ä¸ªåˆ«ç›´æ¥è®¾ç½® Proxy ä»£ç†</p><li><p>iOS Simulator åŒç”µè„‘çš„ç½‘è·¯ç¯å¢ƒï¼Œæ— æ³•ä¸ªè®¾ç½® Proxyï¼Œå˜æˆè¦å»æ”¹ç”µè„‘çš„è®¾ç½®æ‰èƒ½æŒ‚ä¸Š Proxyï¼Œç”µè„‘çš„æ‰€æœ‰æµé‡ä¹Ÿéƒ½ä¼šç»è¿‡è¿™ä¸ª Proxy å¹¶ä¸”å¦‚æœåŒæ—¶å¼€å¯ Proxyman æˆ– Charles ç­‰ç­‰å…¶ä»–ç½‘è·¯å·¥å…·ï¼Œæœ‰æœºä¼šä¼šå¼ºåˆ¶æ›´æ”¹ Proxy è®¾ç½®æˆè¯¥è½¯ä½“çš„ï¼Œå¯¼è‡´å¤±æ•ˆã€‚</p></ul><p><strong>åå‘ä»£ç†éœ€è¦æ”¹ Codebase ä¸­çš„ API Host å¹¶ä¸”è¦å®£å‘Šè¦ä»£ç†çš„æ‰€æœ‰ API Domainsï¼š</strong></p><ul><li><p>Codebase ä¸­çš„ API Host è¦åœ¨æµ‹è¯•æ—¶æ›¿æ¢æˆ Proxy Server IP</p><li><p>åœ¨å¯ç”¨ Reverse Proxy æ—¶è¦å®£å‘Šå“ªäº› Domain è¦æŒ‚ä¸Š Proxy</p><li><p>åªæœ‰å®£å‘Šçš„ Domain æ‰ä¼šèµ° Proxyï¼Œæ²¡å®£å‘Šçš„ä¼šç›´é€šå‡ºå»</p></ul><blockquote><p>é…åˆ iOS Appï¼Œä»¥ä¸‹ä»¥ iOS &amp; ä½¿ç”¨ Reverse Proxy åå‘ä»£ç†ä¸ºä¾‹åš POCï¼ŒAndroid ä¸€æ ·å¯ä»¥ä½¿ç”¨ã€‚</p></blockquote><h4 id="è®©-ios-app-çŸ¥é“ç°åœ¨æ­£åœ¨è·‘-end-to-end-testing"><span class="me-2">è®© iOS App çŸ¥é“ç°åœ¨æ­£åœ¨è·‘ End-to-End Testing</span><a href="#è®©-ios-app-çŸ¥é“ç°åœ¨æ­£åœ¨è·‘-end-to-end-testing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>æˆ‘ä»¬éœ€è¦è®© App çŸ¥é“ç°åœ¨æ­£åœ¨è·‘ End-to-End Testing æ‰èƒ½åœ¨ App ç¨‹å¼é‡ŒåŠ ä¸Š API Host æ›¿æ¢é€»è¾‘ï¼š</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>// UI Testing Target:
let app = XCUIApplication()
app.launchArguments = ["duringE2ETesting"]
app.launch()
</pre></table></code></div></div><p>æˆ‘ä»¬åœ¨ Network å±‚åšåˆ¤æ–­æŠ½æ¢ã€‚</p><blockquote><p>è¿™æ˜¯ä¸å¾—å·²çš„è°ƒæ•´ï¼Œå°½é‡è¿˜æ˜¯ä¸è¦ä¸ºäº†æµ‹è¯•è€Œå»æ”¹ App çš„ Codeã€‚</p></blockquote><h3 id="ä½¿ç”¨-mitmproxy-å®ç°-reverse-proxy-server"><span class="me-2">ä½¿ç”¨ MITMProxy å®ç° Reverse Proxy Server</span><a href="#ä½¿ç”¨-mitmproxy-å®ç°-reverse-proxy-server" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote><p>äº¦å¯ä½¿ç”¨ Swift è‡ªè¡Œå¼€å‘ Swift Server è¾¾æˆï¼Œæœ¬æ–‡åªæ˜¯ POC å› æ­¤ç›´æ¥ä½¿ç”¨ MITMProxy å·¥å…·ã€‚</p></blockquote><h4 id="20230904-update-mitmproxy-rodo-å·²å¼€æº"><span class="me-2">[2023â€“09â€“04 Update] Mitmproxy-rodo å·²å¼€æº</span><a href="#20230904-update-mitmproxy-rodo-å·²å¼€æº" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>ä»¥ä¸‹å®ä½œå†…å®¹å·²ç»å¼€æºåˆ° <a href="https://github.com/ZhgChgLi/mitmproxy-rodo/tree/main" target="_blank">mitmproxy-rodo</a> ä¸“æ¡ˆï¼Œæ¬¢è¿ç›´æ¥å‰å¾€å¯¹ç…§ä½¿ç”¨ã€‚</p><p><a href="https://github.com/ZhgChgLi/mitmproxy-rodo/tree/main" target="_blank" class="img-link shimmer" ><img src="https://repository-images.githubusercontent.com/686628812/44cf2ec7-4de1-4a10-b213-bf7dd30748a4" alt="" loading="lazy"></a></p><p>éƒ¨ä»½ç»“æ„ä¸æœ¬æ–‡ç« å†…å®¹æœ‰æ‰€è°ƒæ•´ï¼Œå¼€æºæ—¶åç»­è°ƒæ•´äº†ï¼š</p><ul><li><p>å‚¨å­˜ç›®å½•çš„ç»“æ„ï¼Œæ”¹ä¸º <code class="language-plaintext highlighter-rouge">host / requestPath / method / hash</code></p><li><p>ä¿®æ­£ Header èµ„è®¯å‚¨å­˜ï¼Œåº”è¯¥ä¸º Bytes Data è€Œéçº¯ JSON String</p><li><p>ä¿®æ­£éƒ¨ä»½é”™è¯¯</p><li><p>å¢åŠ è‡ªåŠ¨å»¶é•¿ Set-Cookie æ—¶æ•ˆåŠŸèƒ½</p></ul><blockquote><p><strong>âš ï¸ ä»¥ä¸‹è„šæœ¬ä»…å…± Demo å‚è€ƒï¼Œåç»­è„šæœ¬è°ƒæ•´å°†ç§»è‡³å¼€æºä¸“æ¡ˆç»´æŠ¤ã€‚</strong></p></blockquote><blockquote><p><strong>âš ï¸ ä»¥ä¸‹è„šæœ¬ä»…å…± Demo å‚è€ƒï¼Œåç»­è„šæœ¬è°ƒæ•´å°†ç§»è‡³å¼€æºä¸“æ¡ˆç»´æŠ¤ã€‚</strong></p></blockquote><blockquote><p><strong>âš ï¸ ä»¥ä¸‹è„šæœ¬ä»…å…± Demo å‚è€ƒï¼Œåç»­è„šæœ¬è°ƒæ•´å°†ç§»è‡³å¼€æºä¸“æ¡ˆç»´æŠ¤ã€‚</strong></p></blockquote><blockquote><p><strong>âš ï¸ ä»¥ä¸‹è„šæœ¬ä»…å…± Demo å‚è€ƒï¼Œåç»­è„šæœ¬è°ƒæ•´å°†ç§»è‡³å¼€æºä¸“æ¡ˆç»´æŠ¤ã€‚</strong></p></blockquote><blockquote><p><strong>âš ï¸ ä»¥ä¸‹è„šæœ¬ä»…å…± Demo å‚è€ƒï¼Œåç»­è„šæœ¬è°ƒæ•´å°†ç§»è‡³å¼€æºä¸“æ¡ˆç»´æŠ¤ã€‚</strong></p></blockquote><h4 id="mitmproxy"><span class="me-2"><a href="https://mitmproxy.org" target="_blank">MITMProxy</a></span><a href="#mitmproxy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>ç…§è‘— <a href="https://mitmproxy.org" target="_blank">MITMProxy å®˜ç½‘</a> å®Œæˆå®‰è£…ï¼š</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>brew <span class="nb">install </span>mitmproxy
</pre></table></code></div></div><p>MITMProxy ç»†èŠ‚ç”¨æ³•å¯å‚è€ƒæˆ‘æ—©æœŸçš„æ–‡ç« ã€Œ <a href="/posts/zrealm-dev/zh-cn/app-https%E4%BC%A0%E8%BE%93%E4%BB%8D%E9%81%AD%E7%AA%83%E5%8F%96-mitmproxy%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB%E5%AE%9E%E6%88%98%E6%95%99%E5%AD%A6%E4%B8%8E%E9%98%B2%E8%8C%83%E6%8A%80%E5%B7%A7-46410aaada00/">APPæœ‰ç”¨HTTPSä¼ è¾“ï¼Œä½†èµ„æ–™è¿˜æ˜¯è¢«å·äº†ã€‚</a> ã€</p><ul><li><p><code class="language-plaintext highlighter-rouge">mitmproxy</code> æä¾›ä¸€ä¸ªäº’åŠ¨å¼çš„å‘½ä»¤è¡Œç•Œé¢ã€‚</p><li><p><code class="language-plaintext highlighter-rouge">mitmweb</code> æä¾›åŸºäºæµè§ˆå™¨çš„å›¾å½¢ç”¨æˆ·ç•Œé¢ã€‚</p><li><p><code class="language-plaintext highlighter-rouge">mitmdump</code> æä¾›éäº’åŠ¨çš„ç»ˆç«¯è¾“å‡ºã€‚</p></ul><h4 id="å®ç°-record--replay"><span class="me-2">å®ç° Record &amp; Replay</span><a href="#å®ç°-record--replay" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>å›  MITMProxy Reverse Proxy åŸç”Ÿæ²¡æœ‰ Record (or dump) request &amp; Mapping Request Replay çš„åŠŸèƒ½ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è‡ªè¡Œæ’°å†™è„šæœ¬å®ç°æ­¤åŠŸèƒ½ã€‚</p><p><code class="language-plaintext highlighter-rouge">mock.py</code> :</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
</pre><td class="rouge-code"><pre><span class="sh">"""</span><span class="s">
Example:
    Record: mitmdump -m reverse:https://yourapihost.com -s mock.py --set record=true --set dumper_folder=loginFlow --set config_file=config.json
    Replay: mitmdump -m reverse:https://yourapihost.com -s mock.py --set dumper_folder=loginFlow --set config_file=config.json
</span><span class="sh">"""</span>

<span class="kn">import</span> <span class="n">re</span>
<span class="kn">import</span> <span class="n">logging</span>
<span class="kn">import</span> <span class="n">mimetypes</span>
<span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">import</span> <span class="n">hashlib</span>

<span class="kn">from</span> <span class="n">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="n">mitmproxy</span> <span class="kn">import</span> <span class="n">ctx</span>
<span class="kn">from</span> <span class="n">mitmproxy</span> <span class="kn">import</span> <span class="n">http</span>

<span class="k">class</span> <span class="nc">MockServerHandler</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">loader</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">readHistory</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">configuration</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">loader</span><span class="p">.</span><span class="nf">add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">dumper_folder</span><span class="sh">"</span><span class="p">,</span>
            <span class="n">typespec</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="sh">"</span><span class="s">dump</span><span class="sh">"</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="sh">"</span><span class="s">Response Dump ç›®å½•ï¼Œå¯ä»¥ by Test Case Name å»ºç«‹</span><span class="sh">"</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">loader</span><span class="p">.</span><span class="nf">add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">network_restricted</span><span class="sh">"</span><span class="p">,</span>
            <span class="n">typespec</span><span class="o">=</span><span class="nb">bool</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="sh">"</span><span class="s">æœ¬åœ°æ²¡æœ‰ Mapping èµ„æ–™...è®¾ç½® true ä¼š return 404ã€false ä¼šå»æ‰“çœŸå®è¯·æ±‚æ‹¿èµ„æ–™ã€‚</span><span class="sh">"</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">loader</span><span class="p">.</span><span class="nf">add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">record</span><span class="sh">"</span><span class="p">,</span>
            <span class="n">typespec</span><span class="o">=</span><span class="nb">bool</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="sh">"</span><span class="s">è®¾ç½® true å½•åˆ¶ Request</span><span class="sh">'</span><span class="s">s Response</span><span class="sh">"</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">loader</span><span class="p">.</span><span class="nf">add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">config_file</span><span class="sh">"</span><span class="p">,</span>
            <span class="n">typespec</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="sh">""</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="sh">"</span><span class="s">è®¾ç½®æ¡£æ¡ˆè·¯å¾„ï¼ŒèŒƒä¾‹æ¡£æ¡ˆåœ¨ä¸‹é¢</span><span class="sh">"</span><span class="p">,</span>
        <span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">updated</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">loadConfig</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">loadConfig</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">configFile</span> <span class="o">=</span> <span class="nc">Path</span><span class="p">(</span><span class="n">ctx</span><span class="p">.</span><span class="n">options</span><span class="p">.</span><span class="n">config_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ctx</span><span class="p">.</span><span class="n">options</span><span class="p">.</span><span class="n">config_file</span> <span class="o">==</span> <span class="sh">""</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">configFile</span><span class="p">.</span><span class="nf">exists</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="n">self</span><span class="p">.</span><span class="n">configuration</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="nf">open</span><span class="p">(</span><span class="n">configFile</span><span class="p">,</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span><span class="p">).</span><span class="nf">read</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">hash</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="n">query</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">query</span>
        <span class="n">requestPath</span> <span class="o">=</span> <span class="sh">"</span><span class="s">-</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">path_components</span><span class="p">)</span>

        <span class="n">ignoredQueryParameterByPaths</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">configuration</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">ignored</span><span class="sh">"</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">paths</span><span class="sh">"</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">host</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="n">requestPath</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">method</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">queryParamters</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">ignoredQueryParameterGlobal</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">configuration</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">ignored</span><span class="sh">"</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">global</span><span class="sh">"</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">queryParamters</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])</span>

        <span class="n">filteredQuery</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">query</span><span class="p">:</span>
            <span class="n">filteredQuery</span> <span class="o">=</span> <span class="p">[(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">query</span><span class="p">.</span><span class="nf">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignoredQueryParameterByPaths</span> <span class="o">+</span> <span class="n">ignoredQueryParameterGlobal</span><span class="p">]</span>
        
        <span class="n">formData</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="nf">get_content</span><span class="p">()</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">request</span><span class="p">.</span><span class="nf">get_content</span><span class="p">()</span> <span class="o">!=</span> <span class="sa">b</span><span class="sh">''</span><span class="p">:</span>
            <span class="n">formData</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="nf">get_content</span><span class="p">())</span>
        
        <span class="c1"># or just formData = request.urlencoded_form
</span>        <span class="c1"># or just formData = request.multipart_form
</span>        <span class="c1"># depends on your api design
</span>
        <span class="n">ignoredFormDataParametersByPaths</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">configuration</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">ignored</span><span class="sh">"</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">paths</span><span class="sh">"</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">host</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="n">requestPath</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">method</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">formDataParameters</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">ignoredFormDataParametersGlobal</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">configuration</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">ignored</span><span class="sh">"</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">global</span><span class="sh">"</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">formDataParameters</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])</span>

        <span class="n">filteredFormData</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">formData</span><span class="p">:</span>
            <span class="n">filteredFormData</span> <span class="o">=</span> <span class="p">[(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">formData</span><span class="p">.</span><span class="nf">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignoredFormDataParametersByPaths</span> <span class="o">+</span> <span class="n">ignoredFormDataParametersGlobal</span><span class="p">]</span>
        
        <span class="c1"># Serialize the dictionary to a JSON string
</span>        <span class="n">hashData</span> <span class="o">=</span> <span class="p">{</span><span class="sh">"</span><span class="s">query</span><span class="sh">"</span><span class="p">:</span><span class="nf">sorted</span><span class="p">(</span><span class="n">filteredQuery</span><span class="p">),</span> <span class="sh">"</span><span class="s">form</span><span class="sh">"</span><span class="p">:</span> <span class="nf">sorted</span><span class="p">(</span><span class="n">filteredFormData</span><span class="p">)}</span>
        <span class="n">json_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">hashData</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="c1"># Apply SHA-256 hash function
</span>        <span class="n">hash_object</span> <span class="o">=</span> <span class="n">hashlib</span><span class="p">.</span><span class="nf">sha256</span><span class="p">(</span><span class="n">json_str</span><span class="p">.</span><span class="nf">encode</span><span class="p">())</span>
        <span class="n">hash_string</span> <span class="o">=</span> <span class="n">hash_object</span><span class="p">.</span><span class="nf">hexdigest</span><span class="p">()</span>
        
        <span class="k">return</span> <span class="n">hash_string</span>

    <span class="k">def</span> <span class="nf">readFromFile</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="n">host</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">host</span>
        <span class="n">method</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span>
        <span class="nb">hash</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">hash</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
        <span class="n">requestPath</span> <span class="o">=</span> <span class="sh">"</span><span class="s">-</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">path_components</span><span class="p">)</span>

        <span class="n">folder</span> <span class="o">=</span> <span class="nc">Path</span><span class="p">(</span><span class="n">ctx</span><span class="p">.</span><span class="n">options</span><span class="p">.</span><span class="n">dumper_folder</span><span class="p">)</span> <span class="o">/</span> <span class="n">host</span> <span class="o">/</span> <span class="n">method</span> <span class="o">/</span> <span class="n">requestPath</span> <span class="o">/</span> <span class="nb">hash</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">folder</span><span class="p">.</span><span class="nf">exists</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="n">content_type</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">headers</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">content-type</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">).</span><span class="nf">split</span><span class="p">(</span><span class="sh">"</span><span class="s">;</span><span class="sh">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">mimetypes</span><span class="p">.</span><span class="nf">guess_extension</span><span class="p">(</span><span class="n">content_type</span><span class="p">)</span> <span class="ow">or</span> <span class="sh">"</span><span class="s">.json</span><span class="sh">"</span>


        <span class="n">count</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">readHistory</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="n">requestPath</span><span class="p">,</span> <span class="p">{})</span> <span class="ow">or</span> <span class="mi">0</span>

        <span class="n">filepath</span> <span class="o">=</span> <span class="n">folder</span> <span class="o">/</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Content-</span><span class="si">{</span><span class="nf">str</span><span class="p">(</span><span class="n">count</span><span class="p">)</span><span class="si">}{</span><span class="n">ext</span><span class="si">}</span><span class="sh">"</span>

        <span class="k">while</span> <span class="ow">not</span> <span class="n">filepath</span><span class="p">.</span><span class="nf">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">filepath</span> <span class="o">=</span> <span class="n">folder</span> <span class="o">/</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Content-</span><span class="si">{</span><span class="nf">str</span><span class="p">(</span><span class="n">count</span><span class="p">)</span><span class="si">}{</span><span class="n">ext</span><span class="si">}</span><span class="sh">"</span>

        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">readHistory</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">host</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">readHistory</span><span class="p">[</span><span class="n">host</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">readHistory</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">host</span><span class="p">).</span><span class="nf">get</span><span class="p">(</span><span class="n">method</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">readHistory</span><span class="p">[</span><span class="n">host</span><span class="p">][</span><span class="n">method</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">readHistory</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">host</span><span class="p">).</span><span class="nf">get</span><span class="p">(</span><span class="n">method</span><span class="p">).</span><span class="nf">get</span><span class="p">(</span><span class="n">requestPath</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">readHistory</span><span class="p">[</span><span class="n">host</span><span class="p">][</span><span class="n">method</span><span class="p">][</span><span class="n">requestPath</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">filepath</span><span class="p">.</span><span class="nf">exists</span><span class="p">():</span>
            <span class="n">headerFilePath</span> <span class="o">=</span> <span class="n">folder</span> <span class="o">/</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Header-</span><span class="si">{</span><span class="nf">str</span><span class="p">(</span><span class="n">count</span><span class="p">)</span><span class="si">}</span><span class="s">.json</span><span class="sh">"</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">headerFilePath</span><span class="p">.</span><span class="nf">exists</span><span class="p">():</span>
                <span class="n">headerFilePath</span> <span class="o">=</span> <span class="bp">None</span>
            
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">self</span><span class="p">.</span><span class="n">readHistory</span><span class="p">[</span><span class="n">host</span><span class="p">][</span><span class="n">method</span><span class="p">][</span><span class="n">requestPath</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span>

            <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">content</span><span class="sh">"</span><span class="p">:</span> <span class="n">filepath</span><span class="p">,</span> <span class="sh">"</span><span class="s">header</span><span class="sh">"</span><span class="p">:</span> <span class="n">headerFilePath</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>


    <span class="k">def</span> <span class="nf">saveToFile</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
        <span class="n">host</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">host</span>
        <span class="n">method</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span>
        <span class="nb">hash</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">hash</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
        <span class="n">requestPath</span> <span class="o">=</span> <span class="sh">"</span><span class="s">-</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">path_components</span><span class="p">)</span>

        <span class="n">iterable</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">configuration</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">ignored</span><span class="sh">"</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">paths</span><span class="sh">"</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">host</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="n">requestPath</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">method</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">iterable</span><span class="sh">"</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
        
        <span class="n">folder</span> <span class="o">=</span> <span class="nc">Path</span><span class="p">(</span><span class="n">ctx</span><span class="p">.</span><span class="n">options</span><span class="p">.</span><span class="n">dumper_folder</span><span class="p">)</span> <span class="o">/</span> <span class="n">host</span> <span class="o">/</span> <span class="n">method</span> <span class="o">/</span> <span class="n">requestPath</span> <span class="o">/</span> <span class="nb">hash</span>

        <span class="c1"># create dir if not exists
</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">folder</span><span class="p">.</span><span class="nf">exists</span><span class="p">():</span>
            <span class="n">os</span><span class="p">.</span><span class="nf">makedirs</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>

        <span class="n">content_type</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">headers</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">content-type</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">).</span><span class="nf">split</span><span class="p">(</span><span class="sh">"</span><span class="s">;</span><span class="sh">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">mimetypes</span><span class="p">.</span><span class="nf">guess_extension</span><span class="p">(</span><span class="n">content_type</span><span class="p">)</span> <span class="ow">or</span> <span class="sh">"</span><span class="s">.json</span><span class="sh">"</span>

        <span class="n">repeatNumber</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="n">folder</span> <span class="o">/</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Content-</span><span class="si">{</span><span class="nf">str</span><span class="p">(</span><span class="n">repeatNumber</span><span class="p">)</span><span class="si">}{</span><span class="n">ext</span><span class="si">}</span><span class="sh">"</span>
        <span class="k">while</span> <span class="n">filepath</span><span class="p">.</span><span class="nf">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="n">iterable</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">repeatNumber</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">filepath</span> <span class="o">=</span> <span class="n">folder</span> <span class="o">/</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Content-</span><span class="si">{</span><span class="nf">str</span><span class="p">(</span><span class="n">repeatNumber</span><span class="p">)</span><span class="si">}{</span><span class="n">ext</span><span class="si">}</span><span class="sh">"</span>
        
        <span class="c1"># dump to file
</span>        <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="sh">"</span><span class="s">wb</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">content</span> <span class="ow">or</span> <span class="sa">b</span><span class="sh">''</span><span class="p">)</span>
            
        
        <span class="n">headerFilepath</span> <span class="o">=</span> <span class="n">folder</span> <span class="o">/</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Header-</span><span class="si">{</span><span class="nf">str</span><span class="p">(</span><span class="n">repeatNumber</span><span class="p">)</span><span class="si">}</span><span class="s">.json</span><span class="sh">"</span>
        <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">headerFilepath</span><span class="p">,</span> <span class="sh">"</span><span class="s">wb</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">responseDict</span> <span class="o">=</span> <span class="nf">dict</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">headers</span><span class="p">.</span><span class="nf">items</span><span class="p">())</span>
            <span class="n">responseDict</span><span class="p">[</span><span class="sh">'</span><span class="s">_status_code</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span>
            <span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">responseDict</span><span class="p">).</span><span class="nf">encode</span><span class="p">(</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">))</span>

        <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">content</span><span class="sh">"</span><span class="p">:</span> <span class="n">filepath</span><span class="p">,</span> <span class="sh">"</span><span class="s">header</span><span class="sh">"</span><span class="p">:</span> <span class="n">headerFilepath</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">request</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">flow</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ctx</span><span class="p">.</span><span class="n">options</span><span class="p">.</span><span class="n">record</span> <span class="o">!=</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">host</span> <span class="o">=</span> <span class="n">flow</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">host</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">flow</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">path</span>

            <span class="n">result</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">readFromFile</span><span class="p">(</span><span class="n">flow</span><span class="p">.</span><span class="n">request</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">content</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">''</span>
                <span class="n">headers</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">statusCode</span> <span class="o">=</span> <span class="mi">200</span>

                <span class="k">if</span> <span class="n">result</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">content</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">],</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span><span class="p">).</span><span class="nf">read</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">result</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">header</span><span class="sh">'</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">headers</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="nf">open</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="sh">'</span><span class="s">header</span><span class="sh">'</span><span class="p">],</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span><span class="p">).</span><span class="nf">read</span><span class="p">())</span>
                    <span class="n">statusCode</span> <span class="o">=</span> <span class="n">headers</span><span class="p">[</span><span class="sh">'</span><span class="s">_status_code</span><span class="sh">'</span><span class="p">]</span>
                    <span class="k">del</span> <span class="n">headers</span><span class="p">[</span><span class="sh">'</span><span class="s">_status_code</span><span class="sh">'</span><span class="p">]</span>

                
                <span class="n">headers</span><span class="p">[</span><span class="sh">'</span><span class="s">_responseFromMitmproxy</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">1</span><span class="sh">'</span>
                <span class="n">flow</span><span class="p">.</span><span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="nf">make</span><span class="p">(</span><span class="n">statusCode</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span>
                <span class="n">logging</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Fullfill response from local with </span><span class="sh">"</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">]))</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="n">ctx</span><span class="p">.</span><span class="n">options</span><span class="p">.</span><span class="n">network_restricted</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">flow</span><span class="p">.</span><span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="nf">make</span><span class="p">(</span><span class="mi">404</span><span class="p">,</span> <span class="sa">b</span><span class="sh">''</span><span class="p">,</span> <span class="p">{</span><span class="sh">'</span><span class="s">_responseFromMitmproxy</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">1</span><span class="sh">'</span><span class="p">})</span>
        
    <span class="k">def</span> <span class="nf">response</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">flow</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ctx</span><span class="p">.</span><span class="n">options</span><span class="p">.</span><span class="n">record</span> <span class="o">==</span> <span class="bp">True</span> <span class="ow">and</span> <span class="n">flow</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">headers</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">_responseFromMitmproxy</span><span class="sh">'</span><span class="p">)</span> <span class="o">!=</span> <span class="sh">'</span><span class="s">1</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">saveToFile</span><span class="p">(</span><span class="n">flow</span><span class="p">.</span><span class="n">request</span><span class="p">,</span> <span class="n">flow</span><span class="p">.</span><span class="n">response</span><span class="p">)</span>
            <span class="n">logging</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Save response to local with </span><span class="sh">"</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">]))</span>

<span class="n">addons</span> <span class="o">=</span> <span class="p">[</span><span class="nc">MockServerHandler</span><span class="p">()]</span>
</pre></table></code></div></div><p>å¯ä»¥è‡ªè¡Œå‚è€ƒ <a href="https://docs.mitmproxy.org/stable/api/events.html" target="_blank">å®˜æ–¹æ–‡ä»¶</a> ï¼Œä¾ç…§éœ€æ±‚è°ƒæ•´è„šæœ¬å†…å®¹ã€‚</p><p><strong>æ­¤è„šæœ¬è®¾è®¡é€»è¾‘å¦‚ä¸‹ï¼š</strong></p><ul><li><p>æ¡£æ¡ˆè·¯å¾„é€»è¾‘ï¼š <code class="language-plaintext highlighter-rouge">dumper_folder(a.k.a Test Case Name)</code> / <code class="language-plaintext highlighter-rouge">Reverse's api host</code> / <code class="language-plaintext highlighter-rouge">HTTP Method</code> / <code class="language-plaintext highlighter-rouge">Path join with -</code> (e.g. <code class="language-plaintext highlighter-rouge">app/launch</code> -&gt; <code class="language-plaintext highlighter-rouge">app-launch</code> ) / <code class="language-plaintext highlighter-rouge">Hash(Get Query &amp; Post Content)</code> /</p><li><p>æ¡£æ¡ˆé€»è¾‘ï¼šå›åº”çš„å†…å®¹ï¼š <code class="language-plaintext highlighter-rouge">Content-0.xxx</code> ã€ <code class="language-plaintext highlighter-rouge">Content-1.xxx</code> (åŒä¸ªè¯·æ±‚æ‰“ç¬¬äºŒæ¬¡)â€¦ä»¥æ­¤ç±»æ¨ï¼›å›åº”çš„ Header èµ„è®¯ï¼š <code class="language-plaintext highlighter-rouge">Header-0.json</code> (åŒ <code class="language-plaintext highlighter-rouge">Content-x</code> é€»è¾‘)</p></ul><p><a href="/assets/5a5c4b25a83d/1*Lud_shSJYv4LSUfpfALGFA.webp" class="popup img-link blur"><img data-src="/assets/5a5c4b25a83d/1*Lud_shSJYv4LSUfpfALGFA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMTAiIGhlaWdodD0iMjQxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li><p>å‚¨å­˜æ—¶ä¼šä¾ç…§è·¯å¾„ã€æ¡£æ¡ˆé€»è¾‘ä¾åºå‚¨å­˜ï¼›åœ¨ Replay æ—¶åŒæ ·ä¾åºå–å‡º</p><li><p>å¦‚æœæ¬¡æ•°ä¸åŒ¹é…ï¼Œä¾‹å¦‚ Replay æ—¶åŒä¸ªè·¯å¾„æ‰“äº† 3 æ¬¡ï¼Œä½† Record å‚¨å­˜çš„èµ„æ–™åªå­˜åˆ°ç¬¬ 2 æ¬¡ï¼›åˆ™è¿˜æ˜¯ä¼šæŒç»­å›åº”ç¬¬ 2 æ¬¡ï¼Œä¹Ÿå°±æ˜¯æœ€åä¸€æ¬¡çš„ç»“æœ</p><li><p><code class="language-plaintext highlighter-rouge">record</code> ä¸º <code class="language-plaintext highlighter-rouge">True</code> æ—¶ï¼Œä¼šå»æ‰“ç›®æ ‡ Server å–å¾—å›åº”å¹¶ä¾ç…§ä¸Šè¿°é€»è¾‘å‚¨å­˜ä¸‹æ¥ï¼› <code class="language-plaintext highlighter-rouge">False</code> æ—¶åˆ™åªä¼šä»æœ¬åœ°è¯»èµ„æ–™ (ç­‰äº Replay Mode)</p><li><p><code class="language-plaintext highlighter-rouge">network_restricted</code> ä¸º <code class="language-plaintext highlighter-rouge">False</code> æ—¶ï¼Œæœ¬åœ°æ²¡ Mapping èµ„æ–™ä¼šç›´æ¥å›åº” <code class="language-plaintext highlighter-rouge">404</code> ï¼›ä¸º <code class="language-plaintext highlighter-rouge">True</code> æ—¶ä¼šå»æ‰“ç›®æ ‡ Server æ‹¿èµ„æ–™ã€‚</p><li><p><code class="language-plaintext highlighter-rouge">_responseFromMitmproxy</code> ç”¨äºå‘ŠçŸ¥ Response Method å½“å‰å›åº”æ¥è‡ª Localï¼Œå¯ä»¥å¿½ç•¥ä¸ç®¡ã€ <code class="language-plaintext highlighter-rouge">_status_code</code> å€Ÿç”¨ Header.json æ ä½å‚¨å­˜ HTTP Response çŠ¶æ€ç ã€‚</p></ul><p><code class="language-plaintext highlighter-rouge">config_file.json</code> <strong>è®¾ç½®æ¡£æ¡ˆé€»è¾‘è®¾è®¡å¦‚ä¸‹ï¼š</strong></p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"ignored"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"yourapihost.com"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"add-to-cart"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"POST"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"queryParamters"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
              </span><span class="s2">"created_timestamp"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"formDataParameters"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"api-status-checker"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"GET"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"iterable"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"global"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"queryParamters"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"timestamp"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"formDataParameters"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">queryParamters</code> <strong>&amp; <code class="language-plaintext highlighter-rouge">formDataParameters</code> :</strong></p><p>å› éƒ¨åˆ† API å‚æ•°å¯èƒ½ä¼šéšå‘¼å«æ”¹å˜ï¼Œä¾‹å¦‚æœ‰çš„ Endpoint ä¼šå¸¦ä¸Šæ—¶é—´å‚æ•°ï¼Œæ­¤æ—¶ä¾ç…§ Server çš„è®¾è®¡ï¼Œ <code class="language-plaintext highlighter-rouge">Hash(Query Parameter &amp; Body Content)</code> çš„å€¼å°±ä¼šåœ¨ Replay Request æ—¶ä¸ä¸€æ ·ï¼Œå¯¼è‡´ Mapping ä¸åˆ° Local Responseï¼Œå› æ­¤å¤šå¼€äº†ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">config.json</code> å¤„ç†è¿™ä¸ªæƒ…å†µï¼Œå¯ä»¥ by Endpoint Path or Global è®¾å®šæŸä¸ªå‚æ•°åº”è¯¥åœ¨æ’é™¤ Hash æ—¶æ’é™¤ï¼Œå°±èƒ½å–å¾—åŒæ ·çš„ Mapping ç»“æœã€‚</p><p><code class="language-plaintext highlighter-rouge">iterable</code> <strong>:</strong></p><p>å› éƒ¨åˆ†è½®è¯¢æ£€æŸ¥çš„ API å¯èƒ½ä¼šé‡å¤å®šæ—¶ä¸æ–­å‘¼å«ï¼Œç…§ Server çš„è®¾è®¡ä¼šäº§å‡ºå¾ˆå¤š <code class="language-plaintext highlighter-rouge">Content-x.xxx</code> &amp; <code class="language-plaintext highlighter-rouge">Header-x.json</code> æ¡£æ¡ˆï¼›ä½†å‡è®¾æˆ‘ä»¬ä¸åœ¨æ„åˆ™å¯è®¾å®šä¸º <code class="language-plaintext highlighter-rouge">True</code> ï¼ŒResponse ä¼šæŒç»­å‚¨å­˜è¦†ç›–åˆ° <code class="language-plaintext highlighter-rouge">Content-0.xxx</code> &amp; <code class="language-plaintext highlighter-rouge">Header-0.json</code> ç¬¬ä¸€ä¸ªæ¡£æ¡ˆå†…ã€‚</p><p><strong>å¯ç”¨ Reverse Proxy Record Modeï¼š</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>mitmdump <span class="nt">-m</span> reverse:https://yourapihost.com <span class="nt">-s</span> mock.py <span class="nt">--set</span> <span class="nv">record</span><span class="o">=</span><span class="nb">true</span> <span class="nt">--set</span> <span class="nv">dumper_folder</span><span class="o">=</span>loginFlow <span class="nt">--set</span> <span class="nv">config_file</span><span class="o">=</span>config.json
</pre></table></code></div></div><p><strong>å¯ç”¨ Reverse Proxy Replay Modeï¼š</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>mitmdump <span class="nt">-m</span> reverse:https://yourapihost.com <span class="nt">-s</span> mock.py <span class="nt">--set</span> <span class="nv">dumper_folder</span><span class="o">=</span>loginFlow <span class="nt">--set</span> <span class="nv">config_file</span><span class="o">=</span>config.json
</pre></table></code></div></div><h3 id="ç»„è£…--proof-of-concept"><span class="me-2">ç»„è£… &amp; Proof Of Concept</span><a href="#ç»„è£…--proof-of-concept" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="0-å®Œæˆ-codebase-ä¸­-host-çš„æŠ½æ¢"><span class="me-2">0. å®Œæˆ Codebase ä¸­ Host çš„æŠ½æ¢</span><a href="#0-å®Œæˆ-codebase-ä¸­-host-çš„æŠ½æ¢" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>å¹¶ç¡®è®¤åœ¨è·‘æµ‹è¯•æ—¶ï¼ŒAPI å·²æ”¹ç”¨ <code class="language-plaintext highlighter-rouge">http://127.0.0.1:8080</code></p><h4 id="1-å¯åŠ¨-snapshot-api-local-mock-server-aka-reverse-proxy-server-record-mode"><span class="me-2">1. å¯åŠ¨ Snapshot API Local Mock Server (a.k.a Reverse Proxy Server) Record Mode</span><a href="#1-å¯åŠ¨-snapshot-api-local-mock-server-aka-reverse-proxy-server-record-mode" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>mitmdump <span class="nt">-m</span> reverse:https://yourapihost.com <span class="nt">-s</span> mock.py <span class="nt">--set</span> <span class="nv">record</span><span class="o">=</span><span class="nb">true</span> <span class="nt">--set</span> <span class="nv">dumper_folder</span><span class="o">=</span>addCart <span class="nt">--set</span> <span class="nv">config_file</span><span class="o">=</span>config.json
</pre></table></code></div></div><h4 id="2-æ‰§è¡Œ-e2e-testing-ui-æ“ä½œ"><span class="me-2">2. æ‰§è¡Œ E2E Testing UI æ“ä½œ</span><a href="#2-æ‰§è¡Œ-e2e-testing-ui-æ“ä½œ" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>ä»¥ <a href="https://apps.apple.com/tw/app/pinkoi-%E4%BA%9E%E6%B4%B2%E9%A0%98%E5%85%88%E8%B7%A8%E5%A2%83%E8%A8%AD%E8%A8%88%E8%B3%BC%E7%89%A9%E7%B6%B2%E7%AB%99/id557252416" target="_blank">Pinkoi iOS App</a> ä¸ºä¾‹ï¼Œæµ‹è¯•ä»¥ä¸‹æµç¨‹ï¼š</p><blockquote><p>Launch App -&gt; Home -&gt; Scroll Down -&gt; Similar to Wish List Items Section -&gt; First Product -&gt; Click First Product -&gt; Enter Product Page -&gt; Click Add to Cart -&gt; UI Response Added to Cart -&gt; Test Successful âœ…</p></blockquote><p><a href="/assets/5a5c4b25a83d/1*aLaMSaG-DFWzYy9RcwCfag.webp" class="popup img-link blur"><img data-src="/assets/5a5c4b25a83d/1*aLaMSaG-DFWzYy9RcwCfag.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjQ2NSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>UI è‡ªåŠ¨åŒ–æ“ä½œæ–¹å¼å‰é¢æœ‰æåˆ°ï¼Œè¿™è¾¹å…ˆæ‰‹åŠ¨æµ‹è¯•ç›¸åŒçš„æµç¨‹éªŒè¯ç»“æœã€‚</p><h4 id="3-å–å¾—-record-ç»“æœ"><span class="me-2">3. å–å¾— Record ç»“æœ</span><a href="#3-å–å¾—-record-ç»“æœ" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>æ“ä½œå®Œæˆåå¯ä»¥ä¸‹ <code class="language-plaintext highlighter-rouge">^ + C</code> ç»ˆæ­¢ Snapshot API Mock Serverï¼Œåˆ°æ¡£æ¡ˆç›®å½•æŸ¥çœ‹å½•åˆ¶ç»“æœï¼š</p><p><a href="/assets/5a5c4b25a83d/1*YO957r5CGMOlsPrm26GbcA.webp" class="popup img-link blur"><img data-src="/assets/5a5c4b25a83d/1*YO957r5CGMOlsPrm26GbcA.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NTciIGhlaWdodD0iNTUwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><h4 id="4-replay-éªŒè¯åŒä¸ªæµç¨‹å¯åŠ¨-server--using-replay-mode"><span class="me-2">4. Replay éªŒè¯åŒä¸ªæµç¨‹ï¼Œå¯åŠ¨ Server &amp; Using Replay Mode</span><a href="#4-replay-éªŒè¯åŒä¸ªæµç¨‹å¯åŠ¨-server--using-replay-mode" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>mitmdump <span class="nt">-m</span> reverse:https://yourapihost.com <span class="nt">-s</span> mock.py <span class="nt">--set</span> <span class="nv">dumper_folder</span><span class="o">=</span>addCart <span class="nt">--set</span> <span class="nv">config_file</span><span class="o">=</span>config.json
</pre></table></code></div></div><h4 id="5-å†æ¬¡æ‰§è¡Œåˆšåˆšçš„-ui-æ“ä½œéªŒè¯ç»“æœ"><span class="me-2">5. å†æ¬¡æ‰§è¡Œåˆšåˆšçš„ UI æ“ä½œéªŒè¯ç»“æœ</span><a href="#5-å†æ¬¡æ‰§è¡Œåˆšåˆšçš„-ui-æ“ä½œéªŒè¯ç»“æœ" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/5a5c4b25a83d/1*70qzxOiM9uJVcvyhKdosVg.webp" class="popup img-link blur"><img data-src="/assets/5a5c4b25a83d/1*70qzxOiM9uJVcvyhKdosVg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NDQiIGhlaWdodD0iODkyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><ul><li><p>å·¦ï¼šTest Successful âœ…</p><li><p>å³ï¼šæµ‹è¯•ç‚¹å‡»å½•åˆ¶ä»¥å¤–çš„å•†å“ï¼Œæ­¤æ—¶ä¼šå‡ºç° Error (å› æœ¬åœ°æ²¡èµ„æ–™ + <code class="language-plaintext highlighter-rouge">network_restricted</code> é¢„è®¾æ˜¯ <code class="language-plaintext highlighter-rouge">False</code> æœ¬åœ°æ²¡èµ„æ–™ç›´æ¥ä¼  404ï¼Œä¸ä¼šä»ç½‘è·¯æ‹¿èµ„æ–™)</p></ul><h4 id="6-proof-of-concept-"><span class="me-2">6. Proof Of Concept âœ…</span><a href="#6-proof-of-concept-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>æ¦‚å¿µéªŒè¯é€šè¿‡ï¼Œæˆ‘ä»¬ç¡®å®èƒ½é€è¿‡å®ç° Reverse Proxy Server æ¥è‡ªè¡Œå‚¨å­˜ API Request &amp; Response å¹¶ä½œä¸º Mock API Server åœ¨æµ‹è¯•æ—¶å›åº”èµ„æ–™ç»™ App ğŸ‰ğŸ‰ğŸ‰ã€‚</p><h3 id="20230904-mitmproxy-rodo-å·²å¼€æº"><span class="me-2">[2023â€“09â€“04] mitmproxy-rodo å·²å¼€æº</span><a href="#20230904-mitmproxy-rodo-å·²å¼€æº" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="https://github.com/ZhgChgLi/mitmproxy-rodo/tree/main" target="_blank" class="img-link shimmer" ><img src="https://repository-images.githubusercontent.com/686628812/44cf2ec7-4de1-4a10-b213-bf7dd30748a4" alt="" loading="lazy"></a></p><h3 id="åç»­å’Œæ‚è®°"><span class="me-2">åç»­å’Œæ‚è®°</span><a href="#åç»­å’Œæ‚è®°" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>æœ¬æ–‡åªæ¢è®¨äº†æ¦‚å¿µéªŒè¯ï¼Œåç»­è¿˜æœ‰è®¸å¤šåœ°æ–¹è¦è¡¥é½ä¹Ÿè¿˜æœ‰æ›´å¤šåŠŸèƒ½å¯ä»¥å®ç°ã€‚</p><ol><li><p>ä¸ <a href="https://github.com/mobile-dev-inc/maestro" target="_blank">maestro</a> UI Testinga å·¥å…·æ•´åˆ</p><li><p>CI/CD æµç¨‹æ•´åˆè®¾è®¡ (æ€ä¹ˆè‡ªåŠ¨èµ· Reverse Proxy? èµ·åœ¨å“ªé‡Œ? )</p><li><p>æ€ä¹ˆæŠŠ MITMProxy å°è£…åœ¨å¼€å‘å·¥å…·å†…?</p><li><p>éªŒè¯æ›´å¤æ‚çš„æµ‹è¯•åœºæ™¯</p><li><p><strong>é’ˆå¯¹å‘é€çš„ Tracking Request åšéªŒè¯ï¼Œéœ€å¤šå®ç°å­˜ Request Bodyï¼Œç„¶åä»ä¸­å–å¾—æ‰“äº†å“ªäº› Tracking Event Dataã€æ˜¯å¦ç¬¦åˆæµç¨‹è¯¥é€çš„äº‹ä»¶</strong></p></ol><h4 id="cookie-é—®é¢˜"><span class="me-2">Cookie é—®é¢˜</span><a href="#cookie-é—®é¢˜" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c1">#...
</span>    <span class="k">def</span> <span class="nf">response</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">flow</span><span class="p">):</span>
        <span class="n">setCookies</span> <span class="o">=</span> <span class="n">flow</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">headers</span><span class="p">.</span><span class="nf">get_all</span><span class="p">(</span><span class="sh">"</span><span class="s">set-cookie</span><span class="sh">"</span><span class="p">)</span>
        <span class="c1"># setCookies = ['ad=0; Domain=.xxx.com; expires=Wed, 23 Aug 2023 04:59:07 GMT; Max-Age=1800; Path=/', 'sessionid=xxxx; Secure; HttpOnly; Domain=.xxx.com; expires=Wed, 23 Aug 2023 04:59:07 GMT; Max-Age=1800; Path=/']
</span>        
        <span class="c1"># OR Replace Cookie Domain From .xxx.com To 127.0.0.1
</span>        <span class="n">setCookies</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="p">.</span><span class="nf">sub</span><span class="p">(</span><span class="sa">r</span><span class="sh">"</span><span class="s">\s*\.xxx\.com\s*</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">127.0.0.1</span><span class="sh">"</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">setCookies</span><span class="p">]</span>

        <span class="c1"># AND ç§»é™¤å®‰å…¨æ€§ç›¸å…³é™åˆ¶
</span>        <span class="n">setCookies</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="p">.</span><span class="nf">sub</span><span class="p">(</span><span class="sa">r</span><span class="sh">"</span><span class="s">;\s*Secure\s*</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">setCookies</span><span class="p">]</span>
        <span class="n">setCookies</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="p">.</span><span class="nf">sub</span><span class="p">(</span><span class="sa">r</span><span class="sh">"</span><span class="s">;\s*HttpOnly;\s*</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">setCookies</span><span class="p">]</span>

        <span class="n">flow</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">headers</span><span class="p">.</span><span class="nf">set_all</span><span class="p">(</span><span class="sh">"</span><span class="s">Set-Cookie</span><span class="sh">"</span><span class="p">,</span> <span class="n">setCookies</span><span class="p">)</span>

        <span class="c1">#...
</span></pre></table></code></div></div><p>å¦‚æœæœ‰é‡åˆ° Cookie æ–¹é¢çš„é—®é¢˜ï¼Œä¾‹å¦‚ API æœ‰å›åº” Cookie ä½† App æ²¡æ¥åˆ°ï¼Œå¯å‚è€ƒä»¥ä¸Šçš„è°ƒæ•´ã€‚</p><h4 id="åœ¨-pinkoi-çš„æœ€åä¸€ç¯‡æ–‡ç« "><span class="me-2">åœ¨ Pinkoi çš„æœ€åä¸€ç¯‡æ–‡ç« </span><a href="#åœ¨-pinkoi-çš„æœ€åä¸€ç¯‡æ–‡ç« " class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>åœ¨ Pinkoi 900 å¤šå¤©çš„æ—¥å­é‡Œï¼Œå®ç°äº†è®¸å¤šæˆ‘èŒæ¶¯ä¸Šè¿˜æœ‰ iOS / App å¼€å‘ã€æµç¨‹çš„æƒ³åƒï¼Œæ„Ÿè°¢æ‰€æœ‰é˜Ÿå‹ï¼Œä¸€èµ·èµ°è¿‡ç–«æƒ…ã€ç»å†é£é›¨ï¼›å‘Šåˆ«çš„å‹‡æ°”å¦‚åŒå½“åˆè¿½å¯»æ¢¦æƒ³å…¥èŒçš„å‹‡æ°”ã€‚</p><blockquote><p><a href="http://resume.zhgchg.li/" target="_blank"><strong>æ­£åœ¨å¯èˆªæ‰¾å¯»æ–°çš„äººç”ŸæŒ‘æˆ˜(åŒ…æ‹¬ä½†ä¸é™äºå·¥ç¨‹)ï¼Œå¦‚æœæ‚¨æœ‰åˆé€‚çš„æœºä¼šï¼ˆiOS or å·¥ç¨‹ç®¡ç† or æ–°åˆ›äº§å“ï¼‰æ¬¢è¿ä¸æˆ‘è”ç»œã€‚</strong></a> ğŸ™ğŸ™ğŸ™</p></blockquote><p>æœ‰ä»»ä½•é—®é¢˜åŠæŒ‡æ•™æ¬¢è¿ <a href="https://www.zhgchg.li/contact" target="_blank">ä¸æˆ‘è”ç»œ</a> ã€‚</p><hr /><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=ğŸº&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a><br /></p><blockquote class="prompt-info"><p>æœ¬æ–‡é¦–æ¬¡å‘è¡¨äº Medium (<a href="https://medium.com/p/5a5c4b25a83d" target="_blank"><strong>ç‚¹å‡»æŸ¥çœ‹åŸå§‹ç‰ˆæœ¬</strong></a>)ï¼Œç”± <a href="/posts/tools/medium-to-jekyll/" target="_blank">ZMediumToMarkdown</a> æä¾›è‡ªåŠ¨è½¬æ¢ä¸åŒæ­¥æŠ€æœ¯ã€‚</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/zh-cn/zmediumtomarkdown/2023-08-28-5a5c4b25a83d.md" target="_blank">Improve this page on Github.</a></p></blockquote><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1K+ Followers</span></a></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-dev/">ZRealm Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/simplified-chinese/" class="post-tag no-text-decoration" >simplified-chinese</a> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/end-to-end-testing/" class="post-tag no-text-decoration" >end-to-end-testing</a> <a href="/tags/ui-testing/" class="post-tag no-text-decoration" >ui-testing</a> <a href="/tags/automation-testing/" class="post-tag no-text-decoration" >automation-testing</a> <a href="/tags/ios/" class="post-tag no-text-decoration" >ios</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=End-to-End%20Testing%EF%BD%9C%E7%94%A8%20Snapshot%20API%20Local%20Mock%20Server%20%E8%A7%A3%E5%86%B3%20iOS%20App%20%E6%B5%8B%E8%AF%95%E8%B5%84%E6%96%99%E4%B8%8D%E7%A8%B3%E5%AE%9A%E9%97%AE%E9%A2%98%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fend-to-end-testing-%25E7%2594%25A8-snapshot-api-local-mock-server-%25E8%25A7%25A3%25E5%2586%25B3-ios-app-%25E6%25B5%258B%25E8%25AF%2595%25E8%25B5%2584%25E6%2596%2599%25E4%25B8%258D%25E7%25A8%25B3%25E5%25AE%259A%25E9%2597%25AE%25E9%25A2%2598-5a5c4b25a83d%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=End-to-End%20Testing%EF%BD%9C%E7%94%A8%20Snapshot%20API%20Local%20Mock%20Server%20%E8%A7%A3%E5%86%B3%20iOS%20App%20%E6%B5%8B%E8%AF%95%E8%B5%84%E6%96%99%E4%B8%8D%E7%A8%B3%E5%AE%9A%E9%97%AE%E9%A2%98%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fend-to-end-testing-%25E7%2594%25A8-snapshot-api-local-mock-server-%25E8%25A7%25A3%25E5%2586%25B3-ios-app-%25E6%25B5%258B%25E8%25AF%2595%25E8%25B5%2584%25E6%2596%2599%25E4%25B8%258D%25E7%25A8%25B3%25E5%25AE%259A%25E9%2597%25AE%25E9%25A2%2598-5a5c4b25a83d%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fend-to-end-testing-%25E7%2594%25A8-snapshot-api-local-mock-server-%25E8%25A7%25A3%25E5%2586%25B3-ios-app-%25E6%25B5%258B%25E8%25AF%2595%25E8%25B5%2584%25E6%2596%2599%25E4%25B8%258D%25E7%25A8%25B3%25E5%25AE%259A%25E9%2597%25AE%25E9%25A2%2598-5a5c4b25a83d%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/zrealm-robotic-process-automation/en/ios-shortcut-automation-auto-forward-sms-create-reminder-tasks-effortlessly-309d0302877b/">iOS Shortcut Automationï½œAuto-Forward SMS & Create Reminder Tasks Effortlessly</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-robotic-process-automation/zh-cn/ios-%E6%8D%B7%E5%BE%84%E8%87%AA%E5%8A%A8%E5%8C%96-3-%E6%8B%9B%E8%87%AA%E5%8A%A8%E8%BD%AC%E5%8F%91%E7%AE%80%E8%AE%AF%E4%B8%8E%E5%BB%BA%E7%AB%8B%E6%8F%90%E9%86%92%E5%BE%85%E5%8A%9E%E4%BA%8B%E9%A1%B9%E6%95%99%E5%AD%A6-309d0302877b/">iOS æ·å¾„è‡ªåŠ¨åŒ–åº”ç”¨åœºæ™¯â€Šâ€”â€Šè‡ªåŠ¨è½¬å‘ç®€è®¯ä¸è‡ªåŠ¨å»ºç«‹æé†’å¾…åŠäº‹é¡¹</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-robotic-process-automation/ios-%E6%8D%B7%E5%BE%91%E8%87%AA%E5%8B%95%E5%8C%96-3-%E6%8B%9B%E8%87%AA%E5%8B%95%E8%BD%89%E7%99%BC%E7%B0%A1%E8%A8%8A%E8%88%87%E5%BB%BA%E7%AB%8B%E6%8F%90%E9%86%92%E5%BE%85%E8%BE%A6%E4%BA%8B%E9%A0%85%E6%95%99%E5%AD%B8-309d0302877b/">iOS æ·å¾‘è‡ªå‹•åŒ–æ‡‰ç”¨å ´æ™¯â€Šâ€”â€Šè‡ªå‹•è½‰ç™¼ç°¡è¨Šèˆ‡è‡ªå‹•å»ºç«‹æé†’å¾…è¾¦äº‹é …</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/en/apple-watch-stainless-steel-milanese-loop-unboxing-premium-44mm-graphite-band-review-c0f99f987d9c/">Apple Watch Stainless Steel Milanese Loop Unboxingï½œPremium 44mm Graphite Band Review</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/zh-cn/apple-watch-%E7%B1%B3%E5%85%B0%E8%A1%A8%E5%B8%A6%E5%BC%80%E7%AE%B1-%E5%8E%9F%E5%8E%82%E4%B8%8D%E9%94%88%E9%92%A2%E7%9F%B3%E5%A2%A8%E8%89%B2%E4%BC%98%E7%BC%BA%E7%82%B9%E5%85%A8%E8%A7%A3%E6%9E%90-c0f99f987d9c/">Apple Watch åŸå‚ä¸é”ˆé’¢ç±³å…°è¡¨å¸¦å¼€ç®±</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">ç”Ÿæ´»</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">ç« ç¯€ (Chapters)ğŸ”–</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-dev/end-to-end-testing-%E7%94%A8-snapshot-api-local-mock-server-%E8%A7%A3%E6%B1%BA-ios-app-%E6%B8%AC%E8%A9%A6%E8%B3%87%E6%96%99%E4%B8%8D%E7%A9%A9%E5%AE%9A%E5%95%8F%E9%A1%8C-5a5c4b25a83d/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1693234407" data-df="ll" > Aug 28, 2023 </time><h4 class="pt-0 my-2">POC App End-to-End Testing Local Snapshot API Mock Server</h4><div class="text-muted"><p>ç‚ºç¾æˆ App åŠç¾æœ‰ API æ¶æ§‹å¯¦ç¾ E2E Testing çš„å¯èƒ½æ€§é©—è­‰</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/en/poc-app-e2e-testing-local-snapshot-api-mock-server-for-reliable-validation-5a5c4b25a83d/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1693234407" data-df="ll" > Aug 28, 2023 </time><h4 class="pt-0 my-2">POC App E2E Testingï½œLocal Snapshot API Mock Server for Reliable Validation</h4><div class="text-muted"><p>Developers facing challenges in end-to-end testing for existing apps and APIs can implement a local snapshot API mock server to simulate real interactions, ensuring thorough validation and faster d...</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-robotic-process-automation/zh-cn/ios-%E6%8D%B7%E5%BE%84%E8%87%AA%E5%8A%A8%E5%8C%96-3-%E6%8B%9B%E8%87%AA%E5%8A%A8%E8%BD%AC%E5%8F%91%E7%AE%80%E8%AE%AF%E4%B8%8E%E5%BB%BA%E7%AB%8B%E6%8F%90%E9%86%92%E5%BE%85%E5%8A%9E%E4%BA%8B%E9%A1%B9%E6%95%99%E5%AD%A6-309d0302877b/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1724083008" data-df="ll" > Aug 19, 2024 </time><h4 class="pt-0 my-2">iOS æ·å¾„è‡ªåŠ¨åŒ–åº”ç”¨åœºæ™¯â€Šâ€”â€Šè‡ªåŠ¨è½¬å‘ç®€è®¯ä¸è‡ªåŠ¨å»ºç«‹æé†’å¾…åŠäº‹é¡¹</h4><div class="text-muted"><p>iOS ä½¿ç”¨ æ·å¾„ Shortcut ç®€å•å‡ ä¸ªæ­¥éª¤è‡ªåŠ¨è½¬å‘ç‰¹å®šç®€è®¯ç»™å®¶é•¿å’Œè‡ªåŠ¨åˆ›å»ºåŒ…è£¹åˆ°è´§é¢†å–ä¸ä¿¡ç”¨å¡ç¼´è´¹æé†’ä»£åŠäº‹é¡¹</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-dev/en/poc-app-e2e-testing-local-snapshot-api-mock-server-for-reliable-validation-5a5c4b25a83d/" class="btn btn-outline-primary" aria-label="Older" ><p>POC App E2E Testingï½œLocal Snapshot API Mock Server for Reliable Validation</p></a> <a href="/posts/zrealm-dev/end-to-end-testing-%E7%94%A8-snapshot-api-local-mock-server-%E8%A7%A3%E6%B1%BA-ios-app-%E6%B8%AC%E8%A9%A6%E8%B3%87%E6%96%99%E4%B8%8D%E7%A9%A9%E5%AE%9A%E5%95%8F%E9%A1%8C-5a5c4b25a83d/" class="btn btn-outline-primary" aria-label="Newer" ><p>POC App End-to-End Testing Local Snapshot API Mock Server</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>Â© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span> <a href="/">ä¸­æ–‡</a>|<a href="/tags/simplified-chinese">ç®€ä¸­</a>|<a href="/tags/english/">English</a></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a> <br/></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">ç”Ÿæ´»</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
