<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="APP HTTPS传输仍遭窃取｜mitmproxy中间人攻击实战教学与防范技巧" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="iOS与MacOS环境下，利用mitmproxy实现中间人攻击，成功嗅探APP API资料传输，揭露HTTPS传输漏洞；并解析SSL Pinning与资料加密两大防护策略，提升APP资料安全，阻挡90%爬虫与攻击威胁。" /><meta property="og:description" content="iOS与MacOS环境下，利用mitmproxy实现中间人攻击，成功嗅探APP API资料传输，揭露HTTPS传输漏洞；并解析SSL Pinning与资料加密两大防护策略，提升APP资料安全，阻挡90%爬虫与攻击威胁。" /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-dev/zh-cn/app-https%E4%BC%A0%E8%BE%93%E4%BB%8D%E9%81%AD%E7%AA%83%E5%8F%96-mitmproxy%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB%E5%AE%9E%E6%88%98%E6%95%99%E5%AD%A6%E4%B8%8E%E9%98%B2%E8%8C%83%E6%8A%80%E5%B7%A7-46410aaada00/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-dev/zh-cn/app-https%E4%BC%A0%E8%BE%93%E4%BB%8D%E9%81%AD%E7%AA%83%E5%8F%96-mitmproxy%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB%E5%AE%9E%E6%88%98%E6%95%99%E5%AD%A6%E4%B8%8E%E9%98%B2%E8%8C%83%E6%8A%80%E5%B7%A7-46410aaada00/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/46410aaada00/1*VTtl6EUMOTV4oRNUjRQHNg.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-09-20T18:01:01+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/46410aaada00/1*VTtl6EUMOTV4oRNUjRQHNg.webp" /><meta property="twitter:title" content="APP HTTPS传输仍遭窃取｜mitmproxy中间人攻击实战教学与防范技巧" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://medium.com/@zhgchgli/"},"dateModified":"2024-04-13T15:56:08+08:00","datePublished":"2019-09-20T18:01:01+08:00","description":"iOS与MacOS环境下，利用mitmproxy实现中间人攻击，成功嗅探APP API资料传输，揭露HTTPS传输漏洞；并解析SSL Pinning与资料加密两大防护策略，提升APP资料安全，阻挡90%爬虫与攻击威胁。","headline":"APP HTTPS传输仍遭窃取｜mitmproxy中间人攻击实战教学与防范技巧","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+","url":"https://zhgchg.li/assets/46410aaada00/1*VTtl6EUMOTV4oRNUjRQHNg.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-dev/zh-cn/app-https%E4%BC%A0%E8%BE%93%E4%BB%8D%E9%81%AD%E7%AA%83%E5%8F%96-mitmproxy%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB%E5%AE%9E%E6%88%98%E6%95%99%E5%AD%A6%E4%B8%8E%E9%98%B2%E8%8C%83%E6%8A%80%E5%B7%A7-46410aaada00/"},"url":"https://zhgchg.li/posts/zrealm-dev/zh-cn/app-https%E4%BC%A0%E8%BE%93%E4%BB%8D%E9%81%AD%E7%AA%83%E5%8F%96-mitmproxy%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB%E5%AE%9E%E6%88%98%E6%95%99%E5%AD%A6%E4%B8%8E%E9%98%B2%E8%8C%83%E6%8A%80%E5%B7%A7-46410aaada00/"}</script><title>APP HTTPS传输仍遭窃取｜mitmproxy中间人攻击实战教学与防范技巧 | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script><link rel="alternate" hreflang="en" href="/posts/zrealm-dev/en/https-data-theft-in-ios-macos-apps-mitmproxy-man-in-the-middle-attack-explained-46410aaada00/"><link rel="alternate" hreflang="zh-Hant" href="/posts/zrealm-dev/app-https%E5%82%B3%E8%BC%B8%E4%BB%8D%E9%81%AD%E7%AB%8A%E5%8F%96-mitmproxy%E4%B8%AD%E9%96%93%E4%BA%BA%E6%94%BB%E6%93%8A%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8%E8%88%87%E9%98%B2%E7%AF%84%E6%8A%80%E5%B7%A7-46410aaada00/"><link rel="alternate" hreflang="zh-Hans" href="/posts/zrealm-dev/zh-cn/app-https%E4%BC%A0%E8%BE%93%E4%BB%8D%E9%81%AD%E7%AA%83%E5%8F%96-mitmproxy%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB%E5%AE%9E%E6%88%98%E6%95%99%E5%AD%A6%E4%B8%8E%E9%98%B2%E8%8C%83%E6%8A%80%E5%B7%A7-46410aaada00/"><link rel="alternate" hreflang="x-default" href="/posts/zrealm-dev/zh-cn/app-https%E4%BC%A0%E8%BE%93%E4%BB%8D%E9%81%AD%E7%AA%83%E5%8F%96-mitmproxy%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB%E5%AE%9E%E6%88%98%E6%95%99%E5%AD%A6%E4%B8%8E%E9%98%B2%E8%8C%83%E6%8A%80%E5%B7%A7-46410aaada00/"><link rel="stylesheet" href="/assets/css/post-toc.css"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0">An iOS, web, and automation developer from Taiwan 🇹🇼 who also loves sharing, traveling, and writing.</p><a href="https://medium.com/@zhgchgli" target="_blank" style="display: block;text-align: center;font-style: normal;/* text-decoration: underline; */font-size: 1.2em;color: var(--heading-color);">1K+ Followers on Medium</a></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/english/" class="nav-link"> <i class="fa-fw fa fa-solid fa-language"></i> <span>ENGLISH POSTS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>APP HTTPS传输仍遭窃取｜mitmproxy中间人攻击实战教学与防范技巧</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>APP HTTPS传输仍遭窃取｜mitmproxy中间人攻击实战教学与防范技巧</h1><p class="post-desc fw-light mb-4">iOS与MacOS环境下，利用mitmproxy实现中间人攻击，成功嗅探APP API资料传输，揭露HTTPS传输漏洞；并解析SSL Pinning与资料加密两大防护策略，提升APP资料安全，阻挡90%爬虫与攻击威胁。</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1568973661" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Sep 20, 2019 </time> </span> <span> Updated <time data-ts="1712994968" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 13, 2024 </time> </span><div class="mt-3 mb-3"> <a href="/assets/46410aaada00/1*VTtl6EUMOTV4oRNUjRQHNg.webp" class="popup img-link preview-img blur"><img data-src="/assets/46410aaada00/1*VTtl6EUMOTV4oRNUjRQHNg.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></div><div class="d-flex justify-content-between"> <span style="display: inline-flex; align-items: center; gap: 4px;"> By <em> <a href="https://medium.com/@zhgchgli/">ZhgChgLi</a> </em> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" style="display: block; "><path fill="#007bff" d="M271.2 56C265.1 49.8 256.2 47.3 247.8 49.6C239.4 51.9 232.9 58.4 230.8 66.8L215.5 127C214.4 131.4 209.9 134 205.6 132.7L145.8 115.9C137.4 113.5 128.4 115.9 122.3 122C116.2 128.1 113.8 137.1 116.2 145.5L133.1 205.3C134.3 209.6 131.7 214.1 127.4 215.2L67.1 230.5C58.7 232.6 52.1 239.2 49.8 247.6C47.5 256 50 264.9 56.2 271L100.7 314.3C103.9 317.4 103.9 322.6 100.7 325.8L56.3 369.1C50.1 375.2 47.6 384.1 49.9 392.5C52.2 400.9 58.8 407.4 67.2 409.6L127.4 424.9C131.8 426 134.4 430.5 133.1 434.8L116.2 494.5C113.8 502.9 116.2 511.9 122.3 518C128.4 524.1 137.4 526.5 145.8 524.1L205.6 507.2C209.9 506 214.4 508.6 215.5 512.9L230.8 573.1C232.9 581.5 239.5 588.1 247.9 590.4C256.3 592.7 265.2 590.2 271.3 584L314.6 539.5C317.7 536.3 322.9 536.3 326.1 539.5L369.3 584C375.4 590.2 384.3 592.7 392.7 590.4C401.1 588.1 407.6 581.5 409.8 573.1L425.1 513C426.2 508.6 430.7 506 435 507.3L494.8 524.2C503.2 526.6 512.2 524.2 518.3 518.1C524.4 512 526.8 503 524.4 494.6L507.5 434.8C506.3 430.5 508.9 426 513.2 424.9L573.4 409.6C581.8 407.5 588.4 400.9 590.7 392.5C593 384.1 590.5 375.1 584.3 369.1L539.8 325.8C536.6 322.7 536.6 317.5 539.8 314.3L584.3 271C590.5 264.9 593 256 590.7 247.6C588.4 239.2 581.8 232.7 573.4 230.5L513.2 215.2C508.8 214.1 506.2 209.6 507.5 205.3L524.4 145.5C526.8 137.1 524.4 128.1 518.3 122C512.2 115.9 503.2 113.5 494.8 115.9L435 132.8C430.7 134 426.2 131.4 425.1 127.1L409.8 66.8C407.7 58.4 401.1 51.8 392.7 49.5C384.3 47.2 375.4 49.7 369.3 55.9L326 100.5C322.9 103.7 317.7 103.7 314.5 100.5L271.2 56z"/><path d="M250 330 l60 60 100 -140" stroke="#ffffff" stroke-width="40" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="2745 words" > <em>15 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">APP HTTPS传输仍遭窃取｜mitmproxy中间人攻击实战教学与防范技巧</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">章節 (Chapters)🔖</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">APP HTTPS传输仍遭窃取｜mitmproxy中间人攻击实战教学与防范技巧</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/en/https-data-theft-in-ios-macos-apps-mitmproxy-man-in-the-middle-attack-explained-46410aaada00/"><strong>Click here</strong></a> to view the English version of this article.</p></blockquote><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/app-https%E5%82%B3%E8%BC%B8%E4%BB%8D%E9%81%AD%E7%AB%8A%E5%8F%96-mitmproxy%E4%B8%AD%E9%96%93%E4%BA%BA%E6%94%BB%E6%93%8A%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8%E8%88%87%E9%98%B2%E7%AF%84%E6%8A%80%E5%B7%A7-46410aaada00/"><strong>點擊這裡</strong></a>查看本文章正體中文版本。</p></blockquote><blockquote class="prompt-info"><p>基于 SEO 考量，本文标题与描述经 AI 调整，原始版本请参考内文。</p></blockquote><h4 id="zhgchgli-table-of-contents">文章目录</h4><nav class="zhgchgli-toc"><ul class="zhgchgli-toc-list"><li><a href="#app有用https传输但资料还是被偷了">APP有用HTTPS传输，但资料还是被偷了。</a></li><li><a href="#前言">前言</a></li><li class="has-children"><details><summary>实际操作 <a href="#实际操作">#</a></summary><ul><li><a href="#安装-mitmproxy">安装 mitmproxy</a></li><li><a href="#mitmproxy-使用">mitmproxy 使用</a></li><li><a href="#让手机跟mac在同个区域网路内取得mac的ip位址">让手机跟Mac在同个区域网路内&取得Mac的IP位址</a></li><li><a href="#手机网路设置wifi--proxy伺服器资讯">手机网路设置WiFi — Proxy伺服器资讯</a></li><li><a href="#安装-mitmproxy-自订-https-凭证">安装 mitmproxy 自订 https 凭证</a></li><li><a href="#回到mac-上操作-mitmproxy">回到Mac 上操作 mitmproxy</a></li><li><a href="#常用操作按键集">常用操作按键集</a></li><li><a href="#不习惯cli-没关系可以改用-web-gui-">不习惯CLI? 没关系，可以改用 Web GUI !</a></li><li><a href="#重头戏嗅探app资料">重头戏，嗅探APP资料</a></li></ul></details></li><li class="has-children"><details><summary>APP 该如何自保？ <a href="#app-该如何自保">#</a></summary><ul><li><a href="#不过">不过….</a></li><li><a href="#还是那句话">还是那句话</a></li></ul></details></li><li><a href="#mitmproxy-的更多玩法">mitmproxy 的更多玩法</a></li><li><a href="#补个坑">补个坑</a></li><li><a href="#延伸阅读">延伸阅读</a></li><li><a href="#后记">后记</a></li></ul></nav><hr /><h3 id="app有用https传输但资料还是被偷了"><span class="me-2">APP有用HTTPS传输，但资料还是被偷了。</span><a href="#app有用https传输但资料还是被偷了" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>iOS+MacOS 使用 mitmproxy 进行中间人攻击(Man-in-the-middle attack) 嗅探API传输资料教学及如何防范？</p><h3 id="前言"><span class="me-2">前言</span><a href="#前言" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>前阵子刚在公司办完一场内部的 <a href="/posts/zrealm-dev/zh-cn/%E6%89%93%E9%80%A0%E6%9C%89%E8%B6%A3%E5%B7%A5%E7%A8%8Bctf%E7%AB%9E%E8%B5%9B-%E7%B3%BB%E7%BB%9F%E5%BB%BA%E7%BD%AE%E4%B8%8E%E8%B7%A8%E9%A2%86%E5%9F%9F%E9%A2%98%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%94%BB%E7%95%A5-729d7b6817a4/">CTF竞赛</a> ，在发想题目时回想起大学时候还在做后端(PHP)时经手的专案，一个集点的APP，大概就是有个任务列表，然后触发条件完成就Call API获得点数；老板认为Call API有经过HTTPS加密传输资料就很安全了 — 直到我向他展示中间人攻击，直接嗅探传输资料，伪造API呼叫获得点数….</p><p>再加上最近几年大数据崛起，网路爬虫满天飞；爬虫攻防战日渐白热化， <a href="https://coolcao.com/2018/06/09/tips-of-anti-spider-in-fe/" target="_blank">爬取与防爬之间花招百出</a> ，只能说道高一尺魔高一丈啊！</p><p>爬虫的另一条下手对象就是APP的API，如果没有任何防范几乎等于门户大开；不但好操作而且格式也干净，更不容易被识别阻挡；所以如果网页端已经费尽全力阻挡，资料还是不段被爬，不妨检查一下APP的API有无漏洞。</p><p>因为这个议题我不知道该如何出在 CTF比赛中 ，所以就单拉出一篇文章作为纪录 ；本篇只是粗浅给个概念 — <a href="http://www.aqee.net/post/man-in-the-middle-attack.html" target="_blank">HTTPS能透过凭证替换进行传输内容解密</a> 、如何加强安全性防止；实际网路理论不是我的强项也都还给老师了，如果已经有这方面概念的朋友就不用花时间看这篇，或拉到底看APP该如果保护！</p><h3 id="实际操作"><span class="me-2">实际操作</span><a href="#实际操作" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>环境: MacOS + iOS</p><blockquote><p><em>Android 使用者可以直接下载 <a href="https://play.google.com/store/apps/details?id=app.greyshirts.sslcapture&amp;hl=en" target="_blank">Packet Capture</a> (免费)、iOS 用户可使用 <a href="https://apps.apple.com/us/app/surge-3/id1442620678" target="_blank">Surge 4</a> 这套软体( <strong>付费)</strong> 解锁中间人攻击功能、MacOS也可以使用另一套付费软体Charles。</em></p></blockquote><blockquote><p><em>本文章主要讲解iOS使用 <strong>免费</strong> 的 mitmproxy 进行操作，如果您有上述的环境就不用这么麻烦啦，直接APP打开在手机上挂载VPN替换掉凭证就能进行中间人攻击！(ㄧ样请直接下拉到底看该如何保护！)</em></p></blockquote><p><strong>[2021/02/25 更新]：</strong> Mac 有新的免费图形化介面程式 ( <a href="https://proxyman.io/" target="_blank">Proxyman</a> ) 可以用，可搭配 <a href="/posts/zrealm-dev/zh-cn/python-%E6%90%AD%E9%85%8D-google-cloud-platform-%E4%B8%8E-line-bot-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E8%87%AA%E5%8A%A8%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%E4%B8%8E%E6%8E%92%E7%A8%8B-70a1409b149a/">参考此篇文章</a> 的第一部分。</p><h4 id="安装-mitmproxy"><span class="me-2">安装 <a href="https://mitmproxy.org" target="_blank">mitmproxy</a></span><a href="#安装-mitmproxy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><strong>直接使用 brew 安装</strong> ：</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>brew <span class="nb">install </span>mitmproxy
</pre></table></code></div></div><p><strong>安装完成!</strong></p><p><em>p.s 如果你出现 brew: command not found 请先安装 <a href="https://brew.sh/index_zh-tw" target="_blank">brew</a> 套件管理工具</em> ：</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/usr/bin/ruby <span class="nt">-e</span> <span class="s2">"</span><span class="si">$(</span>curl <span class="nt">-fsSL</span> https://raw.githubusercontent.com/Homebrew/install/master/install<span class="si">)</span><span class="s2">"</span>
</pre></table></code></div></div><h4 id="mitmproxy-使用"><span class="me-2">mitmproxy 使用</span><a href="#mitmproxy-使用" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>安装完成后，在 Terminal 输入以下指令启用：</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>mitmproxy
</pre></table></code></div></div><p><a href="/assets/46410aaada00/1*VTtl6EUMOTV4oRNUjRQHNg.webp" class="popup img-link blur"><img data-src="/assets/46410aaada00/1*VTtl6EUMOTV4oRNUjRQHNg.webp" alt="启动成功" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2ODIiIGhlaWdodD0iNDc3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>启动成功</p><h4 id="让手机跟mac在同个区域网路内取得mac的ip位址"><span class="me-2">让手机跟Mac在同个区域网路内&amp;取得Mac的IP位址</span><a href="#让手机跟mac在同个区域网路内取得mac的ip位址" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>方法(1) Mac 连接 WiFi、手机也使用同个 WiFi <strong>Mac的IP位址 =</strong> 「系统偏好设定」-&gt;「网路」-&gt;「Wi-Fi」-&gt;「IP Address」</p><p>方法(2) Mac 使用有线网路，开启网路分享；手机连上该热点网路:</p><p><a href="/assets/46410aaada00/1*R9fthpHlrWzTh4R3fEwO5Q.gif" class="popup img-link blur"><img data-src="/assets/46410aaada00/1*R9fthpHlrWzTh4R3fEwO5Q.gif" alt="「系统偏好设定」-&gt; 「共享」-&gt;选择「乙太网路」-&gt;「Wi-Fi」打勾-&gt; 「Internet 共享」启用" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NjgiIGhlaWdodD0iNDg0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>「系统偏好设定」-&gt; 「共享」-&gt;选择「乙太网路」-&gt;「Wi-Fi」打勾-&gt; 「Internet 共享」启用</p><p><strong>Mac的IP位址 = 192.168.2.1</strong> （️️注意⚠️ 不是乙太网路网路的IP，是Mac用做网路分享基地台的IP)</p><h4 id="手机网路设置wifi--proxy伺服器资讯"><span class="me-2">手机网路设置WiFi — Proxy伺服器资讯</span><a href="#手机网路设置wifi--proxy伺服器资讯" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/46410aaada00/1*ziIFrGQaMr2kYrQHwLYNJg.webp" class="popup img-link blur"><img data-src="/assets/46410aaada00/1*ziIFrGQaMr2kYrQHwLYNJg.webp" alt="「设定」-&gt; 「WiFi」-&gt; 「HTTP 代理伺服器」-&gt; 「手动」-&gt; 「伺服器输入 **Mac的IP位址** 」-&gt; 「连接埠输入 **8080** 」-&gt; 「储存」" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjEwNjUiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>「设定」-&gt; 「WiFi」-&gt; 「HTTP 代理伺服器」-&gt; 「手动」-&gt; 「伺服器输入 <strong>Mac的IP位址</strong> 」-&gt; 「连接埠输入 <strong>8080</strong> 」-&gt; 「储存」</p><blockquote><p><em>这时网页打不开、出现凭证错误是正常的；我们继续往下做…</em></p></blockquote><h4 id="安装-mitmproxy-自订-https-凭证"><span class="me-2">安装 mitmproxy 自订 https 凭证</span><a href="#安装-mitmproxy-自订-https-凭证" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>如同上述所说，中间人攻击的实现方式就是在通讯之中使用自己的凭证做抽换加解密资料；所以我们也要在手机上安装这个自订的凭证。</p><p><strong>1.用手机safari打开 <a href="http://mitm.it" target="_blank">http://mitm.it</a></strong></p><p><a href="/assets/46410aaada00/1*BuvCYx9WRzG0ECO3H_BS0A.webp" class="popup img-link blur"><img data-src="/assets/46410aaada00/1*BuvCYx9WRzG0ECO3H_BS0A.webp" alt="出现左边-&gt;Proxy设定✅/ 出现右边代表 Proxy设定有误🚫" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjEyNDMiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>出现左边-&gt;Proxy设定✅/ 出现右边代表 Proxy设定有误🚫</p><p><a href="/assets/46410aaada00/1*qKDHxi9HxUP41oDJahBfBA.webp" class="popup img-link blur"><img data-src="/assets/46410aaada00/1*qKDHxi9HxUP41oDJahBfBA.webp" alt="「Apple」-&gt;「安装描述档」-&gt;「安装」" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjYyNCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>「Apple」-&gt;「安装描述档」-&gt;「安装」</p><blockquote><p><em>⚠️到这里还没结束，我们还要去关于里启用描述档</em></p></blockquote><p><a href="/assets/46410aaada00/1*mOijblpQepazFPIwob4r8Q.webp" class="popup img-link blur"><img data-src="/assets/46410aaada00/1*mOijblpQepazFPIwob4r8Q.webp" alt="「一般」-&gt;「关于」-&gt;「凭证信任设定」-&gt;「mitmproxy」启用" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjEyNDMiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p>「一般」-&gt;「关于」-&gt;「凭证信任设定」-&gt;「mitmproxy」启用</p><p><strong>完成！这时我们再回去浏览器就能正常浏览网页了。</strong></p><h4 id="回到mac-上操作-mitmproxy"><span class="me-2">回到Mac 上操作 mitmproxy</span><a href="#回到mac-上操作-mitmproxy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/46410aaada00/1*kiEPaTm5bhnFLBfQngQPgA.webp" class="popup img-link blur"><img data-src="/assets/46410aaada00/1*kiEPaTm5bhnFLBfQngQPgA.webp" alt="可以在mitmproxy Terminal上看到刚手机的资料传输纪录" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2ODIiIGhlaWdodD0iNDc3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>可以在mitmproxy Terminal上看到刚手机的资料传输纪录</p><p><a href="/assets/46410aaada00/1*5I6l9cO3LeXfcwGLpWGKPQ.gif" class="popup img-link blur"><img data-src="/assets/46410aaada00/1*5I6l9cO3LeXfcwGLpWGKPQ.gif" alt="找到想嗅探的纪录进入查看Request(送出哪些参数)/Response(回传了什么内容)" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MzgiIGhlaWdodD0iNTAyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>找到想嗅探的纪录进入查看Request(送出哪些参数)/Response(回传了什么内容)</p><h4 id="常用操作按键集"><span class="me-2">常用操作按键集：</span><a href="#常用操作按键集" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>「 ? 」= 查看按键操作集文档
「 k 」/「⬆」= 上 
「 j 」/「⬇」= 下 
「 h 」/「⬅」= 左 
「 l 」/「➡️」️= 右 
「 space 」= 下一页
「 enter 」= 进入查看详情
「 q 」= 返回上一页/退出
「 b 」= 汇出response body到指定path文字档 
「 f 」= 筛选纪录条件
「 z 」= 清除所有纪录
「 e 」= 编辑Request(cookie、headers、params...)
「 r 」= 重新发送Request
</pre></table></code></div></div><h4 id="不习惯cli-没关系可以改用-web-gui-"><span class="me-2">不习惯CLI? 没关系，可以改用 Web GUI !</span><a href="#不习惯cli-没关系可以改用-web-gui-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>除了 mitmproxy 启用方式之外，我们可以改下：</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>mitmweb
</pre></table></code></div></div><p>就能使用新的 Web GUI 进行操作观察</p><p><a href="/assets/46410aaada00/1*Stbf8gUk8iXwNkozOKyOjA.webp" class="popup img-link blur"><img data-src="/assets/46410aaada00/1*Stbf8gUk8iXwNkozOKyOjA.webp" alt="mitmweb" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjMzIiBoZWlnaHQ9Ijg5MCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>mitmweb</p><h4 id="重头戏嗅探app资料"><span class="me-2">重头戏，嗅探APP资料：</span><a href="#重头戏嗅探app资料" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>上述环境都建置完成也熟悉之后，就可以进入我们的重头戏；嗅探APP API的资料传输内容！</p><blockquote><p><em>这边以某房屋APP作为范例，无恶意纯学术交流使用!</em></p></blockquote><blockquote><p><em>我们想知道物件列表的API是如何请求和回传什么内容!</em></p></blockquote><p><a href="/assets/46410aaada00/1*HKppSomeMK5U3Z0kbaRvkQ.webp" class="popup img-link blur"><img data-src="/assets/46410aaada00/1*HKppSomeMK5U3Z0kbaRvkQ.webp" alt="首先先按「z」清除所有纪录(避免搞乱)" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NzEiIGhlaWdodD0iNjMxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>首先先按「z」清除所有纪录(避免搞乱)</p><p><a href="/assets/46410aaada00/1*mpNLXzUwb7-jiikrHkoTcA.webp" class="popup img-link blur"><img data-src="/assets/46410aaada00/1*mpNLXzUwb7-jiikrHkoTcA.webp" alt="开启目标 APP" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NzUiIGhlaWdodD0iMTIwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>开启目标 APP</p><p>开启目标 APP 尝试「下拉重整」或触发「载入下一页」的动作。</p><blockquote><p><strong><em>🛑若你的目标APP打不开、连不上；那抱歉了，代表APP有做防范无法用这招嗅探，请直接下拉到如何保护的章节🛑</em></strong></p></blockquote><p><a href="/assets/46410aaada00/1*KOkJugn95bcUCPl-dZEaRA.webp" class="popup img-link blur"><img data-src="/assets/46410aaada00/1*KOkJugn95bcUCPl-dZEaRA.webp" alt="mitmproxy 纪录" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NzEiIGhlaWdodD0iNjMxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>mitmproxy 纪录</p><p>回到 mitmproxy 查看纪录，发挥侦探的精神猜测哪个API请求纪录是我们想要的并进入查看详细！</p><p><a href="/assets/46410aaada00/1*n6mUgej-2_U8PRUbQo_j1g.webp" class="popup img-link blur"><img data-src="/assets/46410aaada00/1*n6mUgej-2_U8PRUbQo_j1g.webp" alt="Request" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MjciIGhlaWdodD0iNTg3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Request</p><p>Request 部分可以看到 请求传递了哪些参数</p><p>搭配「e」编辑与「r」重新发送，并观察 Response 就可以猜到每个参数的用途啰！</p><p><a href="/assets/46410aaada00/1*zxdLiXMP-KapoEYou_TlZg.webp" class="popup img-link blur"><img data-src="/assets/46410aaada00/1*zxdLiXMP-KapoEYou_TlZg.webp" alt="Response" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NzEiIGhlaWdodD0iNjMxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>Response</p><p>Response 也能直接获得原始回传内容。</p><blockquote><p><strong><em>🛑若Response内容是一堆编码；那也抱歉了，代表APP可能有自己再做一次加解密无法用这招嗅探，请直接下拉到如何保护的章节🛑</em></strong></p></blockquote><p>很难阅读？中文乱码？没关系，这边可以用「b」汇出成文字档到桌面，再将内容复制到 <a href="https://jsoneditoronline.org/" target="_blank">Json Editor Online</a> 解析即可!</p><p><a href="/assets/46410aaada00/1*7qOTLAIQHH6V782OnvFVFQ.webp" class="popup img-link blur"><img data-src="/assets/46410aaada00/1*7qOTLAIQHH6V782OnvFVFQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9Ijk2OSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><blockquote><p><strong>**或是直接使用 mitmweb 使用 web gui 直接浏览、操作</strong>*</p></blockquote><p><a href="/assets/46410aaada00/1*ujOlDBdjp8tECeAwRzWRPw.webp" class="popup img-link blur"><img data-src="/assets/46410aaada00/1*ujOlDBdjp8tECeAwRzWRPw.webp" alt="mitmweb" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjM1IiBoZWlnaHQ9Ijg4MiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>mitmweb</p><p>经过嗅探、观察、过滤、测试之后就能知道APP API的运作方式，借此就能利用，用爬虫爬取资料。</p><blockquote><p><em>*搜集完所需资讯记得关闭mitmproxy、手机网路Proxy代理伺服器改回自动，才能正常使用网路。</em></p></blockquote><h3 id="app-该如何自保"><span class="me-2">APP 该如何自保？</span><a href="#app-该如何自保" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>若挂上 mitmproxy 之后发现APP不能用、回传内容是编码，代表APP有做保护。</p><p><strong>做法(1):</strong></p><p>大略是将凭证资讯放一份到APP中，若当前HTTPS使用的凭证与APP中的资讯不符则拒绝访问，详细可以 <a href="https://www.anquanke.com/post/id/147090" target="_blank">看此</a> 或找 <a href="https://medium.com/@dzungnguyen.hcm/ios-ssl-pinning-bffd2ee9efc" target="_blank">SSL Pinning</a> 相关资源。缺点可能就是要注意凭证有效期的问题吧！</p><p><a href="/assets/46410aaada00/1*31rODDIlYPidTP3L8W_C7A.webp" class="popup img-link blur"><img data-src="/assets/46410aaada00/1*31rODDIlYPidTP3L8W_C7A.webp" alt="&lt;https://medium.com/@dzungnguyen.hcm/ios-ssl-pinning-bffd2ee9efc&gt;{:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMTYwIiBoZWlnaHQ9IjEyMDAiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9ImdyZXkiLz48L3N2Zz4="></a></p><p><a href="https://medium.com/@dzungnguyen.hcm/ios-ssl-pinning-bffd2ee9efc" target="_blank">https://medium.com/@dzungnguyen.hcm/ios-ssl-pinning-bffd2ee9efc</a></p><p><strong>作法(2):</strong></p><p>APP端在资料要传输前先进行编码加密，API后端收到后解密取得原始请求内容；API回传内容一样先进行编码加密，APP端收到资料后解密取得回传内容；步骤很烦琐也耗效能，但的确是个方法；据我所知好像某数字银行就是用这招进行保护!</p><h4 id="不过"><span class="me-2">不过….</span><a href="#不过" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>作法1，依然有破解方法： <a href="https://www.anquanke.com/post/id/179514" target="_blank">如何在iOS 12上绕过SSL Pinning</a></p><p>作法2，透过反编译工程也能获得编码加密用的密钥</p><p><strong>⚠️没有100%的安全⚠️</strong></p><p><code class="language-plaintext highlighter-rouge">或是干脆挖个洞让它爬，边搜集各种证据，再用法务解决（？</code></p><h4 id="还是那句话"><span class="me-2">还是那句话：</span><a href="#还是那句话" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><blockquote><p>「 NEVER TRUST THE CLIENT」</p></blockquote><h3 id="mitmproxy-的更多玩法"><span class="me-2">mitmproxy 的更多玩法：</span><a href="#mitmproxy-的更多玩法" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><strong>1.使用mitmdump</strong></p><p>除 <code class="language-plaintext highlighter-rouge">mitmproxy</code> 、 <code class="language-plaintext highlighter-rouge">mitmweb</code> ， <code class="language-plaintext highlighter-rouge">mitmdump</code> 可直接将所有纪录汇出到文字档中</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>mitmdump <span class="nt">-w</span> /log.txt
</pre></table></code></div></div><p>并且能使用 <strong>玩法(2)</strong> python程式，设定、筛选流量:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>mitmdump <span class="nt">-ns</span> examples/filter.py <span class="nt">-r</span> /log.txt <span class="nt">-w</span> /result.txt
</pre></table></code></div></div><p><strong>2.搭配python程式做请求参数设定、访问控制、转址：</strong></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">mitmproxy</span> <span class="kn">import</span> <span class="n">http</span>

<span class="k">def</span> <span class="nf">request</span><span class="p">(</span><span class="n">flow</span><span class="p">:</span> <span class="n">http</span><span class="p">.</span><span class="n">HTTPFlow</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="c1"># pretty_host takes the "Host" header of the request into account,
</span>    <span class="c1"># which is useful in transparent mode where we usually only have the IP
</span>    <span class="c1"># otherwise.
</span>    
    <span class="c1"># 请求参数设定 Example:
</span>    <span class="n">flow</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">headers</span><span class="p">[</span><span class="sh">'</span><span class="s">User-Agent</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">MitmProxy</span><span class="sh">'</span>
    
    <span class="k">if</span> <span class="n">flow</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">pretty_host</span> <span class="o">==</span> <span class="sh">"</span><span class="s">123.com.tw</span><span class="sh">"</span><span class="p">:</span>
        <span class="n">flow</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">host</span> <span class="o">=</span> <span class="sh">"</span><span class="s">456.com.tw</span><span class="sh">"</span>
    <span class="c1"># 将123.com.tw的访问全导到456.com.tw
</span></pre></table></code></div></div><p>转址范例</p><p>启用mitmproxy时加上参数：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>mitmproxy -s /redirect.py
or
mitmweb -s /redirect.py
or
mitmdump -s /redirect.py
</pre></table></code></div></div><h3 id="补个坑"><span class="me-2">补个坑</span><a href="#补个坑" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>在使用 mitmproxy 观察使用 HTTP 1.1 及 Accept-Ranges: bytes、 Content-Range 长连接片段持续拿取资源的请求时，会等到 response 全部回来才会显示，而不是显示分段、使用持久连接接续下载！</p><p><a href="/posts/zh-cn/avplayer-%E8%BE%B9%E6%92%AD%E8%BE%B9-cache-%E6%8A%80%E6%9C%AF%E5%AE%9E%E6%88%98-ios-%E6%9C%AC%E5%9C%B0%E7%BC%93%E5%AD%98%E4%BC%98%E5%8C%96%E6%94%BB%E7%95%A5-ee47f8f1e2d2/">踩坑在这</a> 。</p><h3 id="延伸阅读"><span class="me-2">延伸阅读</span><a href="#延伸阅读" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p><a href="/posts/zrealm-dev/zh-cn/python-%E6%90%AD%E9%85%8D-google-cloud-platform-%E4%B8%8E-line-bot-%E6%89%93%E9%80%A0%E6%AF%8F%E6%97%A5%E8%87%AA%E5%8A%A8%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%E4%B8%8E%E6%8E%92%E7%A8%8B-70a1409b149a/">以签到奖励 APP 为例，打造每日自动签到脚本</a></p><li><p><a href="/posts/zrealm-dev/zh-cn/%E6%89%93%E9%80%A0%E6%9C%89%E8%B6%A3%E5%B7%A5%E7%A8%8Bctf%E7%AB%9E%E8%B5%9B-%E7%B3%BB%E7%BB%9F%E5%BB%BA%E7%BD%AE%E4%B8%8E%E8%B7%A8%E9%A2%86%E5%9F%9F%E9%A2%98%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%94%BB%E7%95%A5-729d7b6817a4/">如何打造一场有趣的工程CTF竞赛</a></p><li><p><a href="/posts/zrealm-dev/zh-cn/%E7%BD%91%E7%AB%99%E6%BC%8F%E6%B4%9E%E8%A7%A3%E6%9E%90-%E5%A4%9A%E9%87%8D%E8%B5%84%E5%AE%89%E7%BC%BA%E9%99%B7%E5%AF%BC%E8%87%B4%E5%AF%86%E7%A0%81%E9%87%8D%E8%AE%BE%E6%9C%BA%E5%88%B6%E8%A2%AB%E6%94%BB%E7%A0%B4-142244e5f07a/">揭露一个几年前发现的巧妙网站漏洞</a></p><li><p><a href="https://medium.com/zrealm-ios-dev/ios-15-macos-monterey-safari-%E5%B0%87%E8%83%BD%E9%9A%B1%E8%97%8F%E7%9C%9F%E5%AF%A6-ip-755a8b6acc35" target="_blank">iOS 15 / MacOS Monterey Safari 将能隐藏真实 IP</a></p></ul><h3 id="后记"><span class="me-2">后记</span><a href="#后记" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>因为我没有网域权限无法取得ssl凭证资讯，所以也无法实作；看程式码感觉并不困难，虽然没有100%安全的方法，但多一道防护至少能更安全一些，再继续攻需要花费很多时间研究，应该能劝退90%的爬虫了！</p><p>这篇文章可能有点含金量太低，medium荒废了一阵子(跑去玩单眼)，主要为本周六日(2019/09/21–2019/09/22)的 <a href="https://iplayground.io/2019/" target="_blank">iPlayground 2019</a> 提前热热写文手感；期待今年的议程🤩，希望回来后能吸收产出更多精品文章！</p><blockquote><p><strong><em>[2019/02/22 更新文章] <a href="/posts/zrealm-dev/zh-cn/iplayground-2019-%E5%8F%B0%E5%A4%A7%E5%8D%9A%E9%9B%85%E9%A6%86%E6%8A%80%E6%9C%AF%E7%9B%9B%E4%BC%9A%E5%85%A8%E7%BA%AA%E5%BD%95%E4%B8%8Eswiftui-app%E5%AE%89%E5%85%A8%E7%B2%BE%E5%8D%8E%E8%A7%A3%E6%9E%90-4079036c85c2/">iPlayground 2019 是怎么样的体验？</a></em></strong></p></blockquote><p>有任何问题及指教欢迎 <a href="https://www.zhgchg.li/contact" target="_blank">与我联络</a> 。</p><hr /><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=🍺&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a><br /></p><blockquote class="prompt-info"><p>本文首次发表于 Medium (<a href="https://medium.com/p/46410aaada00" target="_blank"><strong>点击查看原始版本</strong></a>)，由 <a href="/posts/tools/medium-to-jekyll/" target="_blank">ZMediumToMarkdown</a> 提供自动转换与同步技术。</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/zh-cn/zmediumtomarkdown/2019-09-20-46410aaada00.md" target="_blank">Improve this page on Github.</a></p></blockquote><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1K+ Followers</span></a></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-dev/">ZRealm Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/simplified-chinese/" class="post-tag no-text-decoration" >simplified-chinese</a> <a href="/tags/mitmproxy/" class="post-tag no-text-decoration" >mitmproxy</a> <a href="/tags/man-in-the-middle/" class="post-tag no-text-decoration" >man-in-the-middle</a> <a href="/tags/ios/" class="post-tag no-text-decoration" >ios</a> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/hacking/" class="post-tag no-text-decoration" >hacking</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=APP%20HTTPS%E4%BC%A0%E8%BE%93%E4%BB%8D%E9%81%AD%E7%AA%83%E5%8F%96%EF%BD%9Cmitmproxy%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB%E5%AE%9E%E6%88%98%E6%95%99%E5%AD%A6%E4%B8%8E%E9%98%B2%E8%8C%83%E6%8A%80%E5%B7%A7%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fapp-https%25E4%25BC%25A0%25E8%25BE%2593%25E4%25BB%258D%25E9%2581%25AD%25E7%25AA%2583%25E5%258F%2596-mitmproxy%25E4%25B8%25AD%25E9%2597%25B4%25E4%25BA%25BA%25E6%2594%25BB%25E5%2587%25BB%25E5%25AE%259E%25E6%2588%2598%25E6%2595%2599%25E5%25AD%25A6%25E4%25B8%258E%25E9%2598%25B2%25E8%258C%2583%25E6%258A%2580%25E5%25B7%25A7-46410aaada00%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=APP%20HTTPS%E4%BC%A0%E8%BE%93%E4%BB%8D%E9%81%AD%E7%AA%83%E5%8F%96%EF%BD%9Cmitmproxy%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB%E5%AE%9E%E6%88%98%E6%95%99%E5%AD%A6%E4%B8%8E%E9%98%B2%E8%8C%83%E6%8A%80%E5%B7%A7%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fapp-https%25E4%25BC%25A0%25E8%25BE%2593%25E4%25BB%258D%25E9%2581%25AD%25E7%25AA%2583%25E5%258F%2596-mitmproxy%25E4%25B8%25AD%25E9%2597%25B4%25E4%25BA%25BA%25E6%2594%25BB%25E5%2587%25BB%25E5%25AE%259E%25E6%2588%2598%25E6%2595%2599%25E5%25AD%25A6%25E4%25B8%258E%25E9%2598%25B2%25E8%258C%2583%25E6%258A%2580%25E5%25B7%25A7-46410aaada00%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2Fapp-https%25E4%25BC%25A0%25E8%25BE%2593%25E4%25BB%258D%25E9%2581%25AD%25E7%25AA%2583%25E5%258F%2596-mitmproxy%25E4%25B8%25AD%25E9%2597%25B4%25E4%25BA%25BA%25E6%2594%25BB%25E5%2587%25BB%25E5%25AE%259E%25E6%2588%2598%25E6%2595%2599%25E5%25AD%25A6%25E4%25B8%258E%25E9%2598%25B2%25E8%258C%2583%25E6%258A%2580%25E5%25B7%25A7-46410aaada00%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/en/ios-timer-vs-dispatchsourcetimer-safe-usage-with-finite-state-machine-design-patterns-62f68ebeecd3/">iOS Timer vs DispatchSourceTimer｜Safe Usage with Finite State Machine & Design Patterns</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/zh-cn/ios-timer-%E4%B8%8E-dispatchsourcetimer-%E9%80%89%E6%8B%A9%E4%B8%8E%E5%AE%89%E5%85%A8%E5%B0%81%E8%A3%85%E6%8A%80%E5%B7%A7-%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA%E9%98%B2%E6%AD%A2%E9%97%AA%E9%80%80-62f68ebeecd3/">iOS Timer 与 DispatchSourceTimer 如何选择与安全的使用?</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/ios-timer-%E8%88%87-dispatchsourcetimer-%E9%81%B8%E6%93%87%E8%88%87%E5%AE%89%E5%85%A8%E5%B0%81%E8%A3%9D%E6%8A%80%E5%B7%A7-%E6%9C%89%E9%99%90%E7%8B%80%E6%85%8B%E6%A9%9F%E9%98%B2%E6%AD%A2%E9%96%83%E9%80%80-62f68ebeecd3/">iOS Timer 與 DispatchSourceTimer 如何選擇與安全的使用?</a><li class="text-truncate lh-lg"> <a href="/posts/pinkoi-engineering/en/design-patterns-practical-solutions-for-socket-io-client-library-challenges-78507a8de6a5/">Design Patterns｜Practical Solutions for Socket.IO Client Library Challenges</a><li class="text-truncate lh-lg"> <a href="/posts/pinkoi-engineering/zh-cn/design-patterns-%E5%AE%9E%E6%88%98%E5%BA%94%E7%94%A8-%E5%B0%81%E8%A3%85-socket-io-%E5%8D%B3%E6%97%B6%E9%80%9A%E8%AE%AF%E6%9E%B6%E6%9E%84%E4%B8%8E%E4%B8%83%E5%A4%A7%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E8%A7%A3%E6%9E%90-78507a8de6a5/">Design Patterns 的实战应用纪录</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">章節 (Chapters)🔖</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-dev/app-https%E5%82%B3%E8%BC%B8%E4%BB%8D%E9%81%AD%E7%AB%8A%E5%8F%96-mitmproxy%E4%B8%AD%E9%96%93%E4%BA%BA%E6%94%BB%E6%93%8A%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8%E8%88%87%E9%98%B2%E7%AF%84%E6%8A%80%E5%B7%A7-46410aaada00/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1568973661" data-df="ll" > Sep 20, 2019 </time><h4 class="pt-0 my-2">APP有用HTTPS傳輸，但資料還是被偷了。</h4><div class="text-muted"><p>iOS+MacOS 使用 mitmproxy 進行中間人攻擊(Man-in-the-middle attack) 嗅探API傳輸資料</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/en/https-data-theft-in-ios-macos-apps-mitmproxy-man-in-the-middle-attack-explained-46410aaada00/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1568973661" data-df="ll" > Sep 20, 2019 </time><h4 class="pt-0 my-2">HTTPS Data Theft in iOS & MacOS Apps｜Mitmproxy Man-in-the-Middle Attack Explained</h4><div class="text-muted"><p>Discover how iOS and MacOS apps using HTTPS still risk data theft via mitmproxy man-in-the-middle attacks. Learn to identify vulnerabilities in API transmissions and implement effective defenses to...</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/zh-cn/ios-14-%E5%89%AA%E8%B4%B4%E7%B0%BF%E9%9A%90%E7%A7%81%E9%97%AE%E9%A2%98-%E6%8F%AD%E9%9C%B2-app-%E8%AF%BB%E5%8F%96%E5%8E%9F%E5%9B%A0%E4%B8%8E%E5%AE%89%E5%85%A8%E9%A3%8E%E9%99%A9%E8%A7%A3%E6%9E%90-8a04443024e2/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1593697896" data-df="ll" > Jul 2, 2020 </time><h4 class="pt-0 my-2">iOS 14 剪贴簿窃资恐慌，隐私与便利的两难</h4><div class="text-muted"><p>为何那么多 iOS APP 会读取你的剪贴簿？</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-dev/en/https-data-theft-in-ios-macos-apps-mitmproxy-man-in-the-middle-attack-explained-46410aaada00/" class="btn btn-outline-primary" aria-label="Older" ><p>HTTPS Data Theft in iOS & MacOS Apps｜Mitmproxy Man-in-the-Middle Attack Explained</p></a> <a href="/posts/zrealm-dev/app-https%E5%82%B3%E8%BC%B8%E4%BB%8D%E9%81%AD%E7%AB%8A%E5%8F%96-mitmproxy%E4%B8%AD%E9%96%93%E4%BA%BA%E6%94%BB%E6%93%8A%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8%E8%88%87%E9%98%B2%E7%AF%84%E6%8A%80%E5%B7%A7-46410aaada00/" class="btn btn-outline-primary" aria-label="Newer" ><p>APP有用HTTPS傳輸，但資料還是被偷了。</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span> <a href="/">中文</a>|<a href="/tags/simplified-chinese">简中</a>|<a href="/tags/english/">English</a></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a> <br/></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
