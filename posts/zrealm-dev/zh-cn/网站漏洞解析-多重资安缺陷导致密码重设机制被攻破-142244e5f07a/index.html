<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="网站漏洞解析｜多重资安缺陷导致密码重设机制被攻破" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="揭露一个结合多项设计缺陷的网站漏洞，透过预测重设密码令牌与后端验证不足，让攻击者轻易重设他人密码并登入帐号，教你如何避免流水号令牌、加密滥用及缺乏二阶段验证的资安风险，强化网站防护效果。" /><meta property="og:description" content="揭露一个结合多项设计缺陷的网站漏洞，透过预测重设密码令牌与后端验证不足，让攻击者轻易重设他人密码并登入帐号，教你如何避免流水号令牌、加密滥用及缺乏二阶段验证的资安风险，强化网站防护效果。" /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-dev/zh-cn/%E7%BD%91%E7%AB%99%E6%BC%8F%E6%B4%9E%E8%A7%A3%E6%9E%90-%E5%A4%9A%E9%87%8D%E8%B5%84%E5%AE%89%E7%BC%BA%E9%99%B7%E5%AF%BC%E8%87%B4%E5%AF%86%E7%A0%81%E9%87%8D%E8%AE%BE%E6%9C%BA%E5%88%B6%E8%A2%AB%E6%94%BB%E7%A0%B4-142244e5f07a/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-dev/zh-cn/%E7%BD%91%E7%AB%99%E6%BC%8F%E6%B4%9E%E8%A7%A3%E6%9E%90-%E5%A4%9A%E9%87%8D%E8%B5%84%E5%AE%89%E7%BC%BA%E9%99%B7%E5%AF%BC%E8%87%B4%E5%AF%86%E7%A0%81%E9%87%8D%E8%AE%BE%E6%9C%BA%E5%88%B6%E8%A2%AB%E6%94%BB%E7%A0%B4-142244e5f07a/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/142244e5f07a/1*EQPani1J-PTO-ccp588gBg.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-02-22T21:27:06+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/142244e5f07a/1*EQPani1J-PTO-ccp588gBg.webp" /><meta property="twitter:title" content="网站漏洞解析｜多重资安缺陷导致密码重设机制被攻破" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://www.linkedin.com/in/zhgchgli"},"dateModified":"2023-08-06T00:45:45+08:00","datePublished":"2021-02-22T21:27:06+08:00","description":"揭露一个结合多项设计缺陷的网站漏洞，透过预测重设密码令牌与后端验证不足，让攻击者轻易重设他人密码并登入帐号，教你如何避免流水号令牌、加密滥用及缺乏二阶段验证的资安风险，强化网站防护效果。","headline":"网站漏洞解析｜多重资安缺陷导致密码重设机制被攻破","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+","url":"https://zhgchg.li/assets/142244e5f07a/1*EQPani1J-PTO-ccp588gBg.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-dev/zh-cn/%E7%BD%91%E7%AB%99%E6%BC%8F%E6%B4%9E%E8%A7%A3%E6%9E%90-%E5%A4%9A%E9%87%8D%E8%B5%84%E5%AE%89%E7%BC%BA%E9%99%B7%E5%AF%BC%E8%87%B4%E5%AF%86%E7%A0%81%E9%87%8D%E8%AE%BE%E6%9C%BA%E5%88%B6%E8%A2%AB%E6%94%BB%E7%A0%B4-142244e5f07a/"},"url":"https://zhgchg.li/posts/zrealm-dev/zh-cn/%E7%BD%91%E7%AB%99%E6%BC%8F%E6%B4%9E%E8%A7%A3%E6%9E%90-%E5%A4%9A%E9%87%8D%E8%B5%84%E5%AE%89%E7%BC%BA%E9%99%B7%E5%AF%BC%E8%87%B4%E5%AF%86%E7%A0%81%E9%87%8D%E8%AE%BE%E6%9C%BA%E5%88%B6%E8%A2%AB%E6%94%BB%E7%A0%B4-142244e5f07a/"}</script><title>网站漏洞解析｜多重资安缺陷导致密码重设机制被攻破 | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=false" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script><link rel="alternate" hreflang="en" href="/posts/zrealm-dev/en/website-security-flaws-exposed-how-combined-vulnerabilities-compromise-protection-142244e5f07a/"><link rel="alternate" hreflang="zh-Hant" href="/posts/zrealm-dev/%E7%B6%B2%E7%AB%99%E6%BC%8F%E6%B4%9E%E8%A7%A3%E6%9E%90-%E5%A4%9A%E9%87%8D%E8%B3%87%E5%AE%89%E7%BC%BA%E9%99%B7%E5%B0%8E%E8%87%B4%E5%AF%86%E7%A2%BC%E9%87%8D%E8%A8%AD%E6%A9%9F%E5%88%B6%E8%A2%AB%E6%94%BB%E7%A0%B4-142244e5f07a/"><link rel="alternate" hreflang="zh-Hans" href="/posts/zrealm-dev/zh-cn/%E7%BD%91%E7%AB%99%E6%BC%8F%E6%B4%9E%E8%A7%A3%E6%9E%90-%E5%A4%9A%E9%87%8D%E8%B5%84%E5%AE%89%E7%BC%BA%E9%99%B7%E5%AF%BC%E8%87%B4%E5%AF%86%E7%A0%81%E9%87%8D%E8%AE%BE%E6%9C%BA%E5%88%B6%E8%A2%AB%E6%94%BB%E7%A0%B4-142244e5f07a/"><link rel="alternate" hreflang="x-default" href="/posts/zrealm-dev/zh-cn/%E7%BD%91%E7%AB%99%E6%BC%8F%E6%B4%9E%E8%A7%A3%E6%9E%90-%E5%A4%9A%E9%87%8D%E8%B5%84%E5%AE%89%E7%BC%BA%E9%99%B7%E5%AF%BC%E8%87%B4%E5%AF%86%E7%A0%81%E9%87%8D%E8%AE%BE%E6%9C%BA%E5%88%B6%E8%A2%AB%E6%94%BB%E7%A0%B4-142244e5f07a/"><link rel="stylesheet" href="/assets/css/post-toc.css"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0">An iOS, web, and automation developer from Taiwan 🇹🇼 who also loves sharing, traveling, and writing.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="https://medium.com/@zhgchgli" class="nav-link" target="_blank" style="background: #EDF4FF; color: #0A84FF;"> <i class="fa-brands fa-medium"></i> <span>Follow Me!<br/><strong>1,049+</strong> Followers</span> </a><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/english/" class="nav-link"> <i class="fa-fw fa fa-solid fa-language"></i> <span>ENGLISH POSTS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>网站漏洞解析｜多重资安缺陷导致密码重设机制被攻破</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>网站漏洞解析｜多重资安缺陷导致密码重设机制被攻破</h1><p class="post-desc fw-light mb-4">揭露一个结合多项设计缺陷的网站漏洞，透过预测重设密码令牌与后端验证不足，让攻击者轻易重设他人密码并登入帐号，教你如何避免流水号令牌、加密滥用及缺乏二阶段验证的资安风险，强化网站防护效果。</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1614000426" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Feb 22, 2021 </time> </span> <span> Updated <time data-ts="1691253945" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Aug 5, 2023 </time> </span><div class="mt-3 mb-3"> <a href="/assets/142244e5f07a/1*EQPani1J-PTO-ccp588gBg.webp" class="popup img-link preview-img blur"><img data-src="/assets/142244e5f07a/1*EQPani1J-PTO-ccp588gBg.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></div><div class="d-flex justify-content-between"> <span style="display: inline-flex; align-items: center; gap: 4px;"> By <em> <a href="https://www.linkedin.com/in/zhgchgli">ZhgChgLi</a> </em> | <em><a href="https://www.linkedin.com/in/zhgchgli" target="_blank">Senior Software Engineer</a></em><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" style="display: block; "><path fill="#007bff" d="M271.2 56C265.1 49.8 256.2 47.3 247.8 49.6C239.4 51.9 232.9 58.4 230.8 66.8L215.5 127C214.4 131.4 209.9 134 205.6 132.7L145.8 115.9C137.4 113.5 128.4 115.9 122.3 122C116.2 128.1 113.8 137.1 116.2 145.5L133.1 205.3C134.3 209.6 131.7 214.1 127.4 215.2L67.1 230.5C58.7 232.6 52.1 239.2 49.8 247.6C47.5 256 50 264.9 56.2 271L100.7 314.3C103.9 317.4 103.9 322.6 100.7 325.8L56.3 369.1C50.1 375.2 47.6 384.1 49.9 392.5C52.2 400.9 58.8 407.4 67.2 409.6L127.4 424.9C131.8 426 134.4 430.5 133.1 434.8L116.2 494.5C113.8 502.9 116.2 511.9 122.3 518C128.4 524.1 137.4 526.5 145.8 524.1L205.6 507.2C209.9 506 214.4 508.6 215.5 512.9L230.8 573.1C232.9 581.5 239.5 588.1 247.9 590.4C256.3 592.7 265.2 590.2 271.3 584L314.6 539.5C317.7 536.3 322.9 536.3 326.1 539.5L369.3 584C375.4 590.2 384.3 592.7 392.7 590.4C401.1 588.1 407.6 581.5 409.8 573.1L425.1 513C426.2 508.6 430.7 506 435 507.3L494.8 524.2C503.2 526.6 512.2 524.2 518.3 518.1C524.4 512 526.8 503 524.4 494.6L507.5 434.8C506.3 430.5 508.9 426 513.2 424.9L573.4 409.6C581.8 407.5 588.4 400.9 590.7 392.5C593 384.1 590.5 375.1 584.3 369.1L539.8 325.8C536.6 322.7 536.6 317.5 539.8 314.3L584.3 271C590.5 264.9 593 256 590.7 247.6C588.4 239.2 581.8 232.7 573.4 230.5L513.2 215.2C508.8 214.1 506.2 209.6 507.5 205.3L524.4 145.5C526.8 137.1 524.4 128.1 518.3 122C512.2 115.9 503.2 113.5 494.8 115.9L435 132.8C430.7 134 426.2 131.4 425.1 127.1L409.8 66.8C407.7 58.4 401.1 51.8 392.7 49.5C384.3 47.2 375.4 49.7 369.3 55.9L326 100.5C322.9 103.7 317.7 103.7 314.5 100.5L271.2 56z"/><path d="M250 330 l60 60 100 -140" stroke="#ffffff" stroke-width="40" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1862 words" > <em>10 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">网站漏洞解析｜多重资安缺陷导致密码重设机制被攻破</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Chapters 🔖</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">网站漏洞解析｜多重资安缺陷导致密码重设机制被攻破</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/en/website-security-flaws-exposed-how-combined-vulnerabilities-compromise-protection-142244e5f07a/"><strong>Click here</strong></a> to view the English version of this article.</p></blockquote><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/%E7%B6%B2%E7%AB%99%E6%BC%8F%E6%B4%9E%E8%A7%A3%E6%9E%90-%E5%A4%9A%E9%87%8D%E8%B3%87%E5%AE%89%E7%BC%BA%E9%99%B7%E5%B0%8E%E8%87%B4%E5%AF%86%E7%A2%BC%E9%87%8D%E8%A8%AD%E6%A9%9F%E5%88%B6%E8%A2%AB%E6%94%BB%E7%A0%B4-142244e5f07a/"><strong>點擊這裡</strong></a>查看本文章正體中文版本。</p></blockquote><blockquote class="prompt-info"><p>基于 SEO 考量，本文标题与描述经 AI 调整，原始版本请参考内文。</p></blockquote><h4 id="zhgchgli-table-of-contents">文章目录</h4><nav class="zhgchgli-toc"><ul class="zhgchgli-toc-list"><li><a href="#揭露一个几年前发现的巧妙网站漏洞">揭露一个几年前发现的巧妙网站漏洞</a></li><li><a href="#前言">前言</a></li><li><a href="#找到的漏洞">找到的漏洞</a></li><li><a href="#漏洞现况">漏洞现况</a></li><li><a href="#漏洞后果">漏洞后果</a></li><li><a href="#漏洞主因">漏洞主因</a></li><li class="has-children"><details><summary>漏洞重现方式 <a href="#漏洞重现方式">#</a></summary><ul><li><a href="#反解出重设密码令牌发现是数字之后">反解出重设密码令牌，发现是数字之后</a></li><li><a href="#好巧不巧又发现个问题">好巧不巧又发现个问题</a></li></ul></details></li><li class="has-children"><details><summary>事出有因 <a href="#事出有因">#</a></summary><ul><li><a href="#修正方式">修正方式</a></li></ul></details></li><li><a href="#总结">总结</a></li><li><a href="#延伸阅读">延伸阅读</a></li></ul></nav><hr /><h3 id="揭露一个几年前发现的巧妙网站漏洞"><span class="me-2">揭露一个几年前发现的巧妙网站漏洞</span><a href="#揭露一个几年前发现的巧妙网站漏洞" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>多个漏洞合并引起的网站资安问题</p><p><a href="/assets/142244e5f07a/1*EQPani1J-PTO-ccp588gBg.webp" class="popup img-link blur"><img data-src="/assets/142244e5f07a/1*EQPani1J-PTO-ccp588gBg.webp" alt="Photo by [Tarik Haiga](https://unsplash.com/@tar1k?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjgwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p>Photo by <a href="https://unsplash.com/@tar1k?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank">Tarik Haiga</a></p><h3 id="前言"><span class="me-2">前言</span><a href="#前言" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>几年前还有在边支援网页开发的时候；被指派任务要为公司内部工程组举办 CTF 竞赛；一开始初想是依照公司产品分组互相攻防入侵，但身为主办，为了想先了解掌握程度就先对公司旗下各产品进行入侵测试；看看我自己能找到几个漏洞，确保活动流程不会出问题。</p><blockquote><p><em>但最后因为比赛时间有限、工程区别差异太大；所以最后以工程共通基础知识及有趣的方向出题，有兴趣的朋友可参考我之前的文章「 <a href="/posts/zrealm-dev/zh-cn/%E6%89%93%E9%80%A0%E6%9C%89%E8%B6%A3%E5%B7%A5%E7%A8%8Bctf%E7%AB%9E%E8%B5%9B-%E7%B3%BB%E7%BB%9F%E5%BB%BA%E7%BD%AE%E4%B8%8E%E8%B7%A8%E9%A2%86%E5%9F%9F%E9%A2%98%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%94%BB%E7%95%A5-729d7b6817a4/"><strong>如何打造一场有趣的工程CTF竞赛</strong></a> 」；里面有很多脑洞大开的题目！</em></p></blockquote><h3 id="找到的漏洞"><span class="me-2">找到的漏洞</span><a href="#找到的漏洞" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>一共在三个产品中找到四个漏洞，除了本文准备提及的问题之外还有以下三个常见网站漏洞被我发现：</p><ol><li><p><strong>Never Trust The Client!</strong> 问题很入门，就是前端直接将 ID 送给后端，而且后端还直接认了；这边应该要改成认 Token。</p><li><p><strong>重设密码设计缺陷</strong> 实际有点忘了，只记得是程式设计有缺陷；导致重设密码步骤可以绕过信箱验证。</p><li><p><strong>XSS 问题</strong></p><li><p><strong>本文将介绍的漏洞</strong></p></ol><p>查找方式一律以黑箱测试，其中只有发现 XSS 问题的产品是我有参与过程式开发，其他都没有也没看过程式码。</p><h3 id="漏洞现况"><span class="me-2">漏洞现况</span><a href="#漏洞现况" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>身为白帽骇客，所有找到的问题都已在第一时间回报工程团队和修复了；目前也过了两年，想想是时候可以公开了；但顾及前公司立场，本文不会提到是哪个产品出现此漏洞，大家就只要参考这个漏洞发现的历程及原因就好！</p><h3 id="漏洞后果"><span class="me-2">漏洞后果</span><a href="#漏洞后果" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>此漏洞可让入侵者随意变更目标使用者密码，并使用新密码登入目标使用者帐号，盗取个人资料、从事非法操作。</p><h3 id="漏洞主因"><span class="me-2">漏洞主因</span><a href="#漏洞主因" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>如同标题所述，此漏洞是由多个原因组合触发；包含以下因素：</p><ul><li><p>帐号登入未支援两阶段验证、设备绑定</p><li><p>重设密码验证使用流水号</p><li><p>网站资料加密功能存在解密漏洞</p><li><p>加解密功能滥用</p><li><p>验证令牌设计错误</p><li><p>后端未二次验证栏位正确性</p><li><p>平台上使用者信箱为公开资讯</p></ul><h3 id="漏洞重现方式"><span class="me-2">漏洞重现方式</span><a href="#漏洞重现方式" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/142244e5f07a/1*ILb0VdnkAvgH5aW7qos_lg.webp" class="popup img-link blur"><img data-src="/assets/142244e5f07a/1*ILb0VdnkAvgH5aW7qos_lg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MDAiIGhlaWdodD0iMzU0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>因平台上使用者信箱为公开资讯，所以我们先在平台上浏览目标入侵帐号；知道信箱后前往重设密码页。</p><ul><li><p>首先先输入自己的信箱进行重设密码操作</p><li><p>再输入想入侵帐号的信箱，一样进行重设密码操作</p></ul><p>以上两个操作都会寄出重设密码验证信。</p><p><a href="/assets/142244e5f07a/1*sPNp2NfoykG8-m3vWociQQ.webp" class="popup img-link blur"><img data-src="/assets/142244e5f07a/1*sPNp2NfoykG8-m3vWociQQ.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NTEiIGhlaWdodD0iNTk3Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>进到自己的信箱去收自己那一封重设密码验证信。</p><p><strong>变更密码连结为以下网址格式：</strong></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://zhgchg.li/resetPassword.php?auth=PvrrbQWBGDQ3LeSBByd
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">PvrrbQWBGDQ3LeSBByd</code> 就是此次重设密码操作的验证令牌。</p><p>但我在观察网站上验证码图片时发现验证码图片的连结格式也是类似：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://zhgchg.li/captchaImage.php?auth=6EqfSZLqDc
</pre></table></code></div></div><p><a href="/assets/142244e5f07a/1*nfAhh3QasOLCDxdxH5jEQg.webp" class="popup img-link blur"><img data-src="/assets/142244e5f07a/1*nfAhh3QasOLCDxdxH5jEQg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5NiIgaGVpZ2h0PSI1MCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><code class="language-plaintext highlighter-rouge">6EqfSZLqDc</code> 显示出 <code class="language-plaintext highlighter-rouge">5136</code> 。</p><p>那把我们的密码重设 Token 塞进去会怎样？管他的！ <strong>塞塞看！</strong></p><p><a href="/assets/142244e5f07a/1*9BccKKQMxdqgtqlad13Ghg.webp" class="popup img-link blur"><img data-src="/assets/142244e5f07a/1*9BccKKQMxdqgtqlad13Ghg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5NiIgaGVpZ2h0PSI2MSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><blockquote><p>Bingo!</p></blockquote><p>但验证码图片太小，无法得到完整的资讯。</p><p><strong>我们继续找可利用的点…</strong></p><p>刚好网站为了防止爬虫侵扰，会将用户的公开个人资料信箱，用 <strong>图片呈现</strong> ，关键字： <strong>图片呈现！图片呈现！图片呈现！</strong></p><p>立刻打开来看看：</p><p><a href="/assets/142244e5f07a/1*VLoCTluycBbW70QplV50Lw.webp" class="popup img-link blur"><img data-src="/assets/142244e5f07a/1*VLoCTluycBbW70QplV50Lw.webp" alt="个人资料页" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NTMiIGhlaWdodD0iMzI1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>个人资料页</p><p><a href="/assets/142244e5f07a/1*cb0Rpz_Zuto5e6WTPsA_Tw.webp" class="popup img-link blur"><img data-src="/assets/142244e5f07a/1*cb0Rpz_Zuto5e6WTPsA_Tw.webp" alt="网页原始码部分" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3ODUiIGhlaWdodD0iMTQyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>网页原始码部分</p><p>我们也得到了类似的网址格式结果：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://zhgchg.li/mailImage.php?mail=V3sDblZgDGdUOOBlBjpRblMTDGwMbwFmUT10bFN6DDlVbAVt
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">V3sDblZgDGdUOOBlBjpRblMTDGwMbwFmUT10bFN6DDlVbAVt</code> 显示出 <code class="language-plaintext highlighter-rouge">zhgchgli@gmail.com</code></p><p><strong>一样管他的！塞爆！</strong></p><p><a href="/assets/142244e5f07a/1*mQVMT-D8avyeYSYp5VBU8w.webp" class="popup img-link blur"><img data-src="/assets/142244e5f07a/1*mQVMT-D8avyeYSYp5VBU8w.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NDQiIGhlaWdodD0iNDM2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><blockquote><p>Bingo!🥳🥳🥳</p></blockquote><blockquote><p><code class="language-plaintext highlighter-rouge">PvrrbQWBGDQ3LeSBByd</code> <em>= <code class="language-plaintext highlighter-rouge">2395656</code></em></p></blockquote><h4 id="反解出重设密码令牌发现是数字之后"><span class="me-2"><strong>反解出重设密码令牌，发现是数字之后</strong></span><a href="#反解出重设密码令牌发现是数字之后" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>我想了该不会是流水号吧。。。</p><p>于是再输入一次信箱请求重设密码，将新收到的信的 Token 解出来，得到 <code class="language-plaintext highlighter-rouge">2395657</code> … what the fxck…还真的是</p><p>知道是流水后之后就好办事了，所以一开始的操作才会是先请求自己帐号的重设密码信，再请求要入侵的目标；因为已经可以预测到下一个请求密码的 id 了。</p><blockquote><p><strong><em>再来只需要想办法将 <code class="language-plaintext highlighter-rouge">2395657</code> 换回 Token 令牌即可！</em></strong></p></blockquote><h4 id="好巧不巧又发现个问题"><span class="me-2">好巧不巧又发现个问题</span><a href="#好巧不巧又发现个问题" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><blockquote><p><strong><em>网站在编辑资料时的信箱格式验证只有前端验证，后端并未二次验证格式是否正确…</em></strong></p></blockquote><p>绕过前端验证后，将信箱改为下一位目标</p><p><a href="/assets/142244e5f07a/1*tdqRy5N0k8WS85l8u8CbKw.webp" class="popup img-link blur"><img data-src="/assets/142244e5f07a/1*tdqRy5N0k8WS85l8u8CbKw.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNjYiIGhlaWdodD0iMTk5Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p><a href="/assets/142244e5f07a/1*PRTZJZuv7DG11CoUn5OHQg.webp" class="popup img-link blur"><img data-src="/assets/142244e5f07a/1*PRTZJZuv7DG11CoUn5OHQg.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MTciIGhlaWdodD0iMTA5Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><blockquote><p>Fire in the hole!</p></blockquote><p><strong>我们得到：</strong></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://zhgchg.li/mailImage.php?mail=UTVRZwZuDjMNPLZhBGI
</pre></table></code></div></div><p><strong>这时候将此密码重设令牌，带回密码重设页面：</strong></p><p><a href="/assets/142244e5f07a/1*1kZp5LQ1yT6m7IBJLoYj9Q.webp" class="popup img-link blur"><img data-src="/assets/142244e5f07a/1*1kZp5LQ1yT6m7IBJLoYj9Q.webp" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MDAiIGhlaWdodD0iMzU1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><blockquote><p>入侵成功！绕过验证重设他人密码！</p></blockquote><p>最后因为没有二阶段登入保护、设备绑定功能；所以密码被覆盖掉之后就能直接登入冒用了。</p><h3 id="事出有因"><span class="me-2">事出有因</span><a href="#事出有因" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>重新梳理一下整件事的流程。</p><ul><li><p>一开始我们要重设密码，但发现重设密码的令牌实际上是一个流水号，而非真正的唯一识别 Token</p><li><p>网站滥用加解密功能，没有区分功能使用；全站几乎都用同一组</p><li><p>网站存在线上任意加解密入口（等于密钥报废）</p><li><p>后端未二次验证使用者输入</p><li><p>没有二阶段登入保护、设备绑定功能</p></ul><h4 id="修正方式"><span class="me-2">修正方式</span><a href="#修正方式" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><p>最根本的是重设密码的令牌应该要是随机产生的唯一识别 Token</p><li><p>网站加解密部分，应该区分功能使用不同密钥</p><li><p>避免外部可以任意操作资料加解密</p><li><p>后端应该要验证使用者输入</p><li><p>以防万一，增加二阶段登入保护、设备绑定功能</p></ul><h3 id="总结"><span class="me-2">总结</span><a href="#总结" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>整个漏洞发现之路令我惊讶，因为很多都是基本的设计问题；虽然功能上单看来说是可以运作，有小洞洞也还算安全；但多个破洞组合起来就会变成一个大洞，在开发上真的要小心谨慎为妙。</p><h3 id="延伸阅读"><span class="me-2">延伸阅读</span><a href="#延伸阅读" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p><a href="/posts/zrealm-dev/zh-cn/%E6%89%93%E9%80%A0%E6%9C%89%E8%B6%A3%E5%B7%A5%E7%A8%8Bctf%E7%AB%9E%E8%B5%9B-%E7%B3%BB%E7%BB%9F%E5%BB%BA%E7%BD%AE%E4%B8%8E%E8%B7%A8%E9%A2%86%E5%9F%9F%E9%A2%98%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%94%BB%E7%95%A5-729d7b6817a4/">如何打造一场有趣的工程CTF竞赛</a></p><li><p><a href="/posts/zrealm-dev/zh-cn/app-https%E4%BC%A0%E8%BE%93%E4%BB%8D%E9%81%AD%E7%AA%83%E5%8F%96-mitmproxy%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB%E5%AE%9E%E6%88%98%E6%95%99%E5%AD%A6%E4%B8%8E%E9%98%B2%E8%8C%83%E6%8A%80%E5%B7%A7-46410aaada00/">APP有用HTTPS传输，但资料还是被偷了</a></p><li><p><a href="/posts/zrealm-dev/zh-cn/%E7%AE%80%E8%AE%AF%E9%AA%8C%E8%AF%81%E7%A0%81%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E-%E7%A0%B4%E8%A7%A3%E9%A3%8E%E9%99%A9%E4%B8%8E%E5%BC%BA%E5%8C%96%E6%89%BE%E5%9B%9E%E5%AF%86%E7%A0%81%E6%9C%BA%E5%88%B6%E8%A7%A3%E6%9E%90-99a6cef90190/">找回密码之简讯验证码强度安全问题</a></p></ul><p>有任何问题及指教欢迎 <a href="https://www.zhgchg.li/contact" target="_blank">与我联络</a> 。</p><script src="/assets/clipboard.min.js"></script><div style=" display:flex; align-items:center; gap:10px; border:1px solid #e5e7eb; background:#f9fafb; padding:12px 16px; border-radius:12px; margin:18px 0; box-shadow:0 3px 8px rgba(0,0,0,0.05); width: auto;"> <input id="share-url" value="https://zhgchg.li/posts/zh-cn/142244e5f07a/" readonly="" style=" flex:1; border:1px solid #d1d5db; border-radius:8px; padding:10px 12px; font-size:0.9rem; background:#ffffff; color:#111827; outline:none; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; " /> <button class="btn" data-clipboard-target="#share-url" id="copy-btn" style=" border:none; background:#3b82f6; color:white; padding:10px 16px; border-radius:10px; cursor:pointer; font-size:0.85rem; font-weight:600; display:flex; align-items:center; gap:6px; transition:all .15s ease; box-shadow:0 2px 5px rgba(59,130,246,0.35); " onmouseover="this.style.opacity='0.92';" onmouseout="this.style.opacity='1';"> <span style="font-size:1rem;">🔗</span> <span id="copy-btn-text">Copy link to share!</span> </button></div><script> new ClipboardJS('.btn'); var btn = document.getElementById("copy-btn"); var text = document.getElementById("copy-btn-text"); btn.addEventListener("click", function () { text.textContent = "Copied!"; btn.style.background = "#16a34a"; btn.style.boxShadow = "0 2px 6px rgba(22,163,74,0.35)"; setTimeout(() => { text.textContent = "Copy link to share!"; btn.style.background = "#3b82f6"; btn.style.boxShadow = "0 2px 5px rgba(59,130,246,0.35)"; }, 1500); });</script><hr /><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=🍺&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a></p><blockquote class="prompt-info"><p>本文首次发表于 Medium (<a href="https://medium.com/p/142244e5f07a" target="_blank"><strong>点击查看原始版本</strong></a>)，由 <a href="/posts/tools/medium-to-jekyll/" target="_blank">ZMediumToMarkdown</a> 提供自动转换与同步技术。</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/zh-cn/zmediumtomarkdown/2021-02-22-142244e5f07a.md" target="_blank">Improve this page on Github.</a></p></blockquote><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1,049+ Followers</span></a></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-dev/">ZRealm Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/simplified-chinese/" class="post-tag no-text-decoration" >simplified-chinese</a> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/hacker/" class="post-tag no-text-decoration" >hacker</a> <a href="/tags/web-security/" class="post-tag no-text-decoration" >web-security</a> <a href="/tags/website-security-test/" class="post-tag no-text-decoration" >website-security-test</a> <a href="/tags/capture-the-flag/" class="post-tag no-text-decoration" >capture-the-flag</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%E7%BD%91%E7%AB%99%E6%BC%8F%E6%B4%9E%E8%A7%A3%E6%9E%90%EF%BD%9C%E5%A4%9A%E9%87%8D%E8%B5%84%E5%AE%89%E7%BC%BA%E9%99%B7%E5%AF%BC%E8%87%B4%E5%AF%86%E7%A0%81%E9%87%8D%E8%AE%BE%E6%9C%BA%E5%88%B6%E8%A2%AB%E6%94%BB%E7%A0%B4%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2F%25E7%25BD%2591%25E7%25AB%2599%25E6%25BC%258F%25E6%25B4%259E%25E8%25A7%25A3%25E6%259E%2590-%25E5%25A4%259A%25E9%2587%258D%25E8%25B5%2584%25E5%25AE%2589%25E7%25BC%25BA%25E9%2599%25B7%25E5%25AF%25BC%25E8%2587%25B4%25E5%25AF%2586%25E7%25A0%2581%25E9%2587%258D%25E8%25AE%25BE%25E6%259C%25BA%25E5%2588%25B6%25E8%25A2%25AB%25E6%2594%25BB%25E7%25A0%25B4-142244e5f07a%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%E7%BD%91%E7%AB%99%E6%BC%8F%E6%B4%9E%E8%A7%A3%E6%9E%90%EF%BD%9C%E5%A4%9A%E9%87%8D%E8%B5%84%E5%AE%89%E7%BC%BA%E9%99%B7%E5%AF%BC%E8%87%B4%E5%AF%86%E7%A0%81%E9%87%8D%E8%AE%BE%E6%9C%BA%E5%88%B6%E8%A2%AB%E6%94%BB%E7%A0%B4%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2F%25E7%25BD%2591%25E7%25AB%2599%25E6%25BC%258F%25E6%25B4%259E%25E8%25A7%25A3%25E6%259E%2590-%25E5%25A4%259A%25E9%2587%258D%25E8%25B5%2584%25E5%25AE%2589%25E7%25BC%25BA%25E9%2599%25B7%25E5%25AF%25BC%25E8%2587%25B4%25E5%25AF%2586%25E7%25A0%2581%25E9%2587%258D%25E8%25AE%25BE%25E6%259C%25BA%25E5%2588%25B6%25E8%25A2%25AB%25E6%2594%25BB%25E7%25A0%25B4-142244e5f07a%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzh-cn%2F%25E7%25BD%2591%25E7%25AB%2599%25E6%25BC%258F%25E6%25B4%259E%25E8%25A7%25A3%25E6%259E%2590-%25E5%25A4%259A%25E9%2587%258D%25E8%25B5%2584%25E5%25AE%2589%25E7%25BC%25BA%25E9%2599%25B7%25E5%25AF%25BC%25E8%2587%25B4%25E5%25AF%2586%25E7%25A0%2581%25E9%2587%258D%25E8%25AE%25BE%25E6%259C%25BA%25E5%2588%25B6%25E8%25A2%25AB%25E6%2594%25BB%25E7%25A0%25B4-142244e5f07a%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/en/ci-cd-explained-boost-ios-app-development-stability-and-efficiency-tool-selection-guide-c008a9e8ceca/">CI/CD Explained: Boost iOS App Development Stability and Efficiency｜Tool Selection Guide</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/zh-cn/ci-cd-%E6%98%AF%E4%BB%80%E4%B9%88-%E6%89%93%E9%80%A0%E9%AB%98%E6%95%88%E7%A8%B3%E5%AE%9A%E5%BC%80%E5%8F%91%E5%9B%A2%E9%98%9F%E7%9A%84%E5%85%B3%E9%94%AE%E6%B5%81%E7%A8%8B%E4%B8%8E%E5%B7%A5%E5%85%B7%E9%80%89%E6%8B%A9-c008a9e8ceca/">CI/CD 实战指南（一）：CI/CD 是什么？如何透过 CI/CD 打造稳定高效的开发团队？工具选择？</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/ci-cd-%E6%98%AF%E4%BB%80%E9%BA%BC-%E6%89%93%E9%80%A0%E9%AB%98%E6%95%88%E7%A9%A9%E5%AE%9A%E9%96%8B%E7%99%BC%E5%9C%98%E9%9A%8A%E7%9A%84%E9%97%9C%E9%8D%B5%E6%B5%81%E7%A8%8B%E8%88%87%E5%B7%A5%E5%85%B7%E9%81%B8%E6%93%87-c008a9e8ceca/">CI/CD 實戰指南（一）：CI/CD 是什麼？如何透過 CI/CD 打造穩定高效的開發團隊？工具選擇？</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/en/google-apps-script-web-app-integrate-forms-with-github-actions-ci-cd-for-streamlined-workflows-4cb4437818f2/">Google Apps Script Web App｜Integrate Forms with GitHub Actions CI/CD for Streamlined Workflows</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-dev/zh-cn/google-apps-script-web-app-%E6%89%93%E9%80%A0-github-action-ci-cd-%E8%87%AA%E8%AE%A2%E8%A1%A8%E5%8D%95%E6%8F%90%E5%8D%87%E5%BC%80%E5%8F%91%E6%95%88%E7%8E%87-4cb4437818f2/">使用 Google Apps Script Web App 表单串接 Github Action CI/CD 工作</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Chapters 🔖</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-dev/%E7%B6%B2%E7%AB%99%E6%BC%8F%E6%B4%9E%E8%A7%A3%E6%9E%90-%E5%A4%9A%E9%87%8D%E8%B3%87%E5%AE%89%E7%BC%BA%E9%99%B7%E5%B0%8E%E8%87%B4%E5%AF%86%E7%A2%BC%E9%87%8D%E8%A8%AD%E6%A9%9F%E5%88%B6%E8%A2%AB%E6%94%BB%E7%A0%B4-142244e5f07a/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1614000426" data-df="ll" > Feb 22, 2021 </time><h4 class="pt-0 my-2">揭露一個幾年前發現的巧妙網站漏洞</h4><div class="text-muted"><p>多個漏洞合併引起的網站資安問題</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/en/website-security-flaws-exposed-how-combined-vulnerabilities-compromise-protection-142244e5f07a/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1614000426" data-df="ll" > Feb 22, 2021 </time><h4 class="pt-0 my-2">Website Security Flaws Exposed｜How Combined Vulnerabilities Compromise Protection</h4><div class="text-muted"><p>Discover how multiple merged vulnerabilities create critical website security risks and learn effective strategies to identify and mitigate these threats, enhancing your site&#39;s defense against atta...</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/zh-cn/%E7%AE%80%E8%AE%AF%E9%AA%8C%E8%AF%81%E7%A0%81%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E-%E7%A0%B4%E8%A7%A3%E9%A3%8E%E9%99%A9%E4%B8%8E%E5%BC%BA%E5%8C%96%E6%89%BE%E5%9B%9E%E5%AF%86%E7%A0%81%E6%9C%BA%E5%88%B6%E8%A7%A3%E6%9E%90-99a6cef90190/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1615737458" data-df="ll" > Mar 14, 2021 </time><h4 class="pt-0 my-2">找回密码之简讯验证码强度安全问题</h4><div class="text-muted"><p>使用 Python 展示暴力破解的严重性</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-dev/en/website-security-flaws-exposed-how-combined-vulnerabilities-compromise-protection-142244e5f07a/" class="btn btn-outline-primary" aria-label="Older" ><p>Website Security Flaws Exposed｜How Combined Vulnerabilities Compromise Protection</p></a> <a href="/posts/zrealm-dev/%E7%B6%B2%E7%AB%99%E6%BC%8F%E6%B4%9E%E8%A7%A3%E6%9E%90-%E5%A4%9A%E9%87%8D%E8%B3%87%E5%AE%89%E7%BC%BA%E9%99%B7%E5%B0%8E%E8%87%B4%E5%AF%86%E7%A2%BC%E9%87%8D%E8%A8%AD%E6%A9%9F%E5%88%B6%E8%A2%AB%E6%94%BB%E7%A0%B4-142244e5f07a/" class="btn btn-outline-primary" aria-label="Newer" ><p>揭露一個幾年前發現的巧妙網站漏洞</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span> <a href="/">正體中文</a> | <a href="/tags/simplified-chinese">简体中文</a> | <a href="/tags/english/">English</a> <br/> Last updated: 2025-12-21 01:32:18 +08:00</p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
