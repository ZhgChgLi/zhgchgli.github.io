<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="ZMarkupParser｜Swift HTML String 轉 NSAttributedString 工具，支援客製樣式與高效能渲染" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="針對 iOS/macOS 開發者，提供純 Swift 實作的 HTML String 轉 NSAttributedString 工具，支援自動修正錯誤標籤、客製樣式設定與多種 HTML Tag，提升渲染效能並避免長字串閃退，助你打造流暢又穩定的文字顯示效果。" /><meta property="og:description" content="針對 iOS/macOS 開發者，提供純 Swift 實作的 HTML String 轉 NSAttributedString 工具，支援自動修正錯誤標籤、客製樣式設定與多種 HTML Tag，提升渲染效能並避免長字串閃退，助你打造流暢又穩定的文字顯示效果。" /><link rel="canonical" href="https://zhgchg.li/posts/zrealm-dev/zmarkupparser-swift-html-string-%E8%BD%89-nsattributedstring-%E5%B7%A5%E5%85%B7-%E6%94%AF%E6%8F%B4%E5%AE%A2%E8%A3%BD%E6%A8%A3%E5%BC%8F%E8%88%87%E9%AB%98%E6%95%88%E8%83%BD%E6%B8%B2%E6%9F%93-a5643de271e4/" /><meta property="og:url" content="https://zhgchg.li/posts/zrealm-dev/zmarkupparser-swift-html-string-%E8%BD%89-nsattributedstring-%E5%B7%A5%E5%85%B7-%E6%94%AF%E6%8F%B4%E5%AE%A2%E8%A3%BD%E6%A8%A3%E5%BC%8F%E8%88%87%E9%AB%98%E6%95%88%E8%83%BD%E6%B8%B2%E6%9F%93-a5643de271e4/" /><meta property="og:site_name" content="ZhgChgLi (Harry Li)" /><meta property="og:image" content="https://zhgchg.li/assets/a5643de271e4/1*A0yXupXW9-F9ZWe4gp2ObA.webp" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-02-26T17:03:07+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zhgchg.li/assets/a5643de271e4/1*A0yXupXW9-F9ZWe4gp2ObA.webp" /><meta property="twitter:title" content="ZMarkupParser｜Swift HTML String 轉 NSAttributedString 工具，支援客製樣式與高效能渲染" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@zhgchgli" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi","url":"https://medium.com/@zhgchgli/"},"dateModified":"2023-08-06T00:16:21+08:00","datePublished":"2023-02-26T17:03:07+08:00","description":"針對 iOS/macOS 開發者，提供純 Swift 實作的 HTML String 轉 NSAttributedString 工具，支援自動修正錯誤標籤、客製樣式設定與多種 HTML Tag，提升渲染效能並避免長字串閃退，助你打造流暢又穩定的文字顯示效果。","headline":"ZMarkupParser｜Swift HTML String 轉 NSAttributedString 工具，支援客製樣式與高效能渲染","image":{"lqip":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+","url":"https://zhgchg.li/assets/a5643de271e4/1*A0yXupXW9-F9ZWe4gp2ObA.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhgchg.li/posts/zrealm-dev/zmarkupparser-swift-html-string-%E8%BD%89-nsattributedstring-%E5%B7%A5%E5%85%B7-%E6%94%AF%E6%8F%B4%E5%AE%A2%E8%A3%BD%E6%A8%A3%E5%BC%8F%E8%88%87%E9%AB%98%E6%95%88%E8%83%BD%E6%B8%B2%E6%9F%93-a5643de271e4/"},"url":"https://zhgchg.li/posts/zrealm-dev/zmarkupparser-swift-html-string-%E8%BD%89-nsattributedstring-%E5%B7%A5%E5%85%B7-%E6%94%AF%E6%8F%B4%E5%AE%A2%E8%A3%BD%E6%A8%A3%E5%BC%8F%E8%88%87%E9%AB%98%E6%95%88%E8%83%BD%E6%B8%B2%E6%9F%93-a5643de271e4/"}</script><title>ZMarkupParser｜Swift HTML String 轉 NSAttributedString 工具，支援客製樣式與高效能渲染 | ZhgChgLi (Harry Li)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi (Harry Li)"><meta name="application-name" content="ZhgChgLi (Harry Li)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZJENT8WR"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6WZJENT8WR'); }); </script><link rel="alternate" hreflang="en" href="/posts/zrealm-dev/en/zmarkupparser-convert-html-string-to-nsattributedstring-with-custom-style-keys-a5643de271e4/"><link rel="alternate" hreflang="zh-Hans" href="/posts/zrealm-dev/zh-cn/zmarkupparser-swift-html-string-%E8%BD%AC-nsattributedstring-%E5%B7%A5%E5%85%B7-%E6%94%AF%E6%8F%B4%E5%AE%A2%E5%88%B6%E6%A0%B7%E5%BC%8F%E4%B8%8E%E9%AB%98%E6%95%88%E8%83%BD%E6%B8%B2%E6%9F%93-a5643de271e4/"><link rel="alternate" hreflang="zh-Hant" href="/posts/zrealm-dev/zmarkupparser-swift-html-string-%E8%BD%89-nsattributedstring-%E5%B7%A5%E5%85%B7-%E6%94%AF%E6%8F%B4%E5%AE%A2%E8%A3%BD%E6%A8%A3%E5%BC%8F%E8%88%87%E9%AB%98%E6%95%88%E8%83%BD%E6%B8%B2%E6%9F%93-a5643de271e4/"><link rel="alternate" hreflang="x-default" href="/posts/zrealm-dev/zmarkupparser-swift-html-string-%E8%BD%89-nsattributedstring-%E5%B7%A5%E5%85%B7-%E6%94%AF%E6%8F%B4%E5%AE%A2%E8%A3%BD%E6%A8%A3%E5%BC%8F%E8%88%87%E9%AB%98%E6%95%88%E8%83%BD%E6%B8%B2%E6%9F%93-a5643de271e4/"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ZhgChgLi (Harry Li)</a><p class="site-subtitle fst-italic mb-0">An iOS, web, and automation developer from Taiwan 🇹🇼 who also loves sharing, traveling, and writing.</p><a href="https://medium.com/@zhgchgli" target="_blank" style="display: block;text-align: center;font-style: normal;/* text-decoration: underline; */font-size: 1.2em;color: var(--heading-color);">1K+ Followers on Medium</a></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/english/" class="nav-link"> <i class="fa-fw fa fa-solid fa-language"></i> <span>ENGLISH POSTS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>ZMarkupParser｜Swift HTML String 轉 NSAttributedString 工具，支援客製樣式與高效能渲染</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>ZMarkupParser｜Swift HTML String 轉 NSAttributedString 工具，支援客製樣式與高效能渲染</h1><p class="post-desc fw-light mb-4">針對 iOS/macOS 開發者，提供純 Swift 實作的 HTML String 轉 NSAttributedString 工具，支援自動修正錯誤標籤、客製樣式設定與多種 HTML Tag，提升渲染效能並避免長字串閃退，助你打造流暢又穩定的文字顯示效果。</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1677402187" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Feb 26, 2023 </time> </span> <span> Updated <time data-ts="1691252181" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Aug 5, 2023 </time> </span><div class="mt-3 mb-3"> <a href="/assets/a5643de271e4/1*A0yXupXW9-F9ZWe4gp2ObA.webp" class="popup img-link preview-img blur"><img data-src="/assets/a5643de271e4/1*A0yXupXW9-F9ZWe4gp2ObA.webp" alt="Preview Image" width="1200" height="630" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNjAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></div><div class="d-flex justify-content-between"> <span style="display: inline-flex; align-items: center; gap: 4px;"> By <em> <a href="https://medium.com/@zhgchgli/">ZhgChgLi</a> </em> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" style="display: block; "><path fill="#007bff" d="M271.2 56C265.1 49.8 256.2 47.3 247.8 49.6C239.4 51.9 232.9 58.4 230.8 66.8L215.5 127C214.4 131.4 209.9 134 205.6 132.7L145.8 115.9C137.4 113.5 128.4 115.9 122.3 122C116.2 128.1 113.8 137.1 116.2 145.5L133.1 205.3C134.3 209.6 131.7 214.1 127.4 215.2L67.1 230.5C58.7 232.6 52.1 239.2 49.8 247.6C47.5 256 50 264.9 56.2 271L100.7 314.3C103.9 317.4 103.9 322.6 100.7 325.8L56.3 369.1C50.1 375.2 47.6 384.1 49.9 392.5C52.2 400.9 58.8 407.4 67.2 409.6L127.4 424.9C131.8 426 134.4 430.5 133.1 434.8L116.2 494.5C113.8 502.9 116.2 511.9 122.3 518C128.4 524.1 137.4 526.5 145.8 524.1L205.6 507.2C209.9 506 214.4 508.6 215.5 512.9L230.8 573.1C232.9 581.5 239.5 588.1 247.9 590.4C256.3 592.7 265.2 590.2 271.3 584L314.6 539.5C317.7 536.3 322.9 536.3 326.1 539.5L369.3 584C375.4 590.2 384.3 592.7 392.7 590.4C401.1 588.1 407.6 581.5 409.8 573.1L425.1 513C426.2 508.6 430.7 506 435 507.3L494.8 524.2C503.2 526.6 512.2 524.2 518.3 518.1C524.4 512 526.8 503 524.4 494.6L507.5 434.8C506.3 430.5 508.9 426 513.2 424.9L573.4 409.6C581.8 407.5 588.4 400.9 590.7 392.5C593 384.1 590.5 375.1 584.3 369.1L539.8 325.8C536.6 322.7 536.6 317.5 539.8 314.3L584.3 271C590.5 264.9 593 256 590.7 247.6C588.4 239.2 581.8 232.7 573.4 230.5L513.2 215.2C508.8 214.1 506.2 209.6 507.5 205.3L524.4 145.5C526.8 137.1 524.4 128.1 518.3 122C512.2 115.9 503.2 113.5 494.8 115.9L435 132.8C430.7 134 426.2 131.4 425.1 127.1L409.8 66.8C407.7 58.4 401.1 51.8 392.7 49.5C384.3 47.2 375.4 49.7 369.3 55.9L326 100.5C322.9 103.7 317.7 103.7 314.5 100.5L271.2 56z"/><path d="M250 330 l60 60 100 -140" stroke="#ffffff" stroke-width="40" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1303 words" > <em>7 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">ZMarkupParser｜Swift HTML String 轉 NSAttributedString 工具，支援客製樣式與高效能渲染</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">章節 (Chapters)🔖</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">ZMarkupParser｜Swift HTML String 轉 NSAttributedString 工具，支援客製樣式與高效能渲染</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/en/zmarkupparser-convert-html-string-to-nsattributedstring-with-custom-style-keys-a5643de271e4/"><strong>Click here</strong></a> to view the English version of this article.</p></blockquote><blockquote class="prompt-tip"><p><a href="/posts/zrealm-dev/zh-cn/zmarkupparser-swift-html-string-%E8%BD%AC-nsattributedstring-%E5%B7%A5%E5%85%B7-%E6%94%AF%E6%8F%B4%E5%AE%A2%E5%88%B6%E6%A0%B7%E5%BC%8F%E4%B8%8E%E9%AB%98%E6%95%88%E8%83%BD%E6%B8%B2%E6%9F%93-a5643de271e4/"><strong>点击这里</strong></a>查看本文章简体中文版本。</p></blockquote><blockquote class="prompt-info"><p>基於 SEO 考量，本文標題與描述經 AI 調整，原始版本請參考內文。</p></blockquote><hr /><h3 id="zmarkupparser-html-string-轉換-nsattributedstring-工具"><span class="me-2">ZMarkupParser HTML String 轉換 NSAttributedString 工具</span><a href="#zmarkupparser-html-string-轉換-nsattributedstring-工具" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>轉換 HTML String 成 NSAttributedString 對應 Key 樣式設定</p><h4 id="zhgchgli--zmarkupparser"><span class="me-2"><a href="https://github.com/ZhgChgLi" target="_blank">ZhgChgLi</a> / <a href="https://github.com/ZhgChgLi/ZMarkupParser" target="_blank">ZMarkupParser</a></span><a href="#zhgchgli--zmarkupparser" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/a5643de271e4/1*A0yXupXW9-F9ZWe4gp2ObA.webp" class="popup img-link blur"><img data-src="/assets/a5643de271e4/1*A0yXupXW9-F9ZWe4gp2ObA.webp" alt="[ZhgChgLi](https://github.com/ZhgChgLi){:target=&quot;_blank&quot;} [ZMarkupParser](https://github.com/ZhgChgLi/ZMarkupParser){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjgwIiBoZWlnaHQ9IjY0MCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="https://github.com/ZhgChgLi" target="_blank">ZhgChgLi</a> / <a href="https://github.com/ZhgChgLi/ZMarkupParser" target="_blank">ZMarkupParser</a></p><p><a href="https://github.com/ZhgChgLi/ZMarkupParser" target="_blank" class="img-link shimmer" ><img src="https://repository-images.githubusercontent.com/602927147/57ce75c1-8548-449c-b44a-f4b0451ed5ea" alt="" loading="lazy"></a></p><h4 id="功能"><span class="me-2">功能</span><a href="#功能" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>使用純 Swift 開發，透過 Regex 剖析出 HTML Tag 並經過 Tokenization，分析修正 Tag 正確性(修正沒有 end 的 tag &amp; 錯位 tag)，再轉換成 abstract syntax tree，最終使用 Visitor Pattern 將 HTML Tag 與抽象樣式對應，得到最終 NSAttributedString 結果；其中不依賴任何 Parser Lib。<li>支援 HTML Render (to NSAttributedString) / Stripper (剝離 HTML Tag) / Selector 功能<li>自動分析修正 Tag 正確性(修正沒有 end 的 tag &amp; 錯位 tag) <code class="language-plaintext highlighter-rouge">&lt;br&gt;</code> -&gt; <code class="language-plaintext highlighter-rouge">&lt;br/&gt;</code> <code class="language-plaintext highlighter-rouge">&lt;b&gt;Bold&lt;i&gt;Bold+Italic&lt;/b&gt;Italic&lt;/i&gt;</code> -&gt; <code class="language-plaintext highlighter-rouge">&lt;b&gt;Bold&lt;i&gt;Bold+Italic&lt;/i&gt;&lt;/b&gt;&lt;i&gt;Italic&lt;/i&gt;</code> <code class="language-plaintext highlighter-rouge">&lt;Congratulation!&gt;</code> -&gt; <code class="language-plaintext highlighter-rouge">&lt;Congratulation!&gt;</code> (treat as String)<li>支援客製化樣式指定 e.g. <code class="language-plaintext highlighter-rouge">&lt;b&gt;&lt;/b&gt;</code> -&gt; <code class="language-plaintext highlighter-rouge">weight: .semilbold &amp; underline: 1</code><li>支援自行擴充 HTML Tag 解析 e.g. 解析 <code class="language-plaintext highlighter-rouge">&lt;zhgchgli&gt;&lt;/zhgchgli&gt;</code> 成想要的樣式<li>包含架構設計，方便對 HTML Tag 進行擴充 目前純了支援基本的樣式之外還支援 ul/ol/li 列表及 hr 分隔線渲染，未來要擴充支援其他 HTML Tag 也能快速支援<li>支援從 <code class="language-plaintext highlighter-rouge">style</code> HTML Attribute 擴充解析樣式 HTML 可以從 style 指定文字樣式，同樣的，此套件也能支援從 <code class="language-plaintext highlighter-rouge">style</code> 中指定樣式 e.g. <code class="language-plaintext highlighter-rouge">&lt;b style=”font-size: 20px”&gt;&lt;/b&gt;</code> -&gt; <code class="language-plaintext highlighter-rouge">粗體+字型 20 px</code><li>支援 iOS/macOS<li>支援 HTML Color Name to UIColor/NSColor<li>Test Coverage: 80%+<li>支援 <code class="language-plaintext highlighter-rouge">&lt;img&gt;</code> 圖片、 <code class="language-plaintext highlighter-rouge">&lt;ul&gt;</code> 項目清單、 <code class="language-plaintext highlighter-rouge">&lt;table&gt;</code> 表格…等等 HTMLTag 解析<li>比 <code class="language-plaintext highlighter-rouge">NSAttributedString.DocumentType.html</code> 更高的效能</ul><h4 id="效能分析"><span class="me-2">效能分析</span><a href="#效能分析" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/a5643de271e4/1*UPkmp2XsUjlVe_TmOur_3A.webp" class="popup img-link blur"><img data-src="/assets/a5643de271e4/1*UPkmp2XsUjlVe_TmOur_3A.webp" alt="[Performance Benchmark](https://quickchart.io/chart-maker/view/zm-73887470-e667-4ca3-8df0-fe3563832b0b){:target=&quot;_blank&quot;}" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMzc4IiBoZWlnaHQ9IjY4OSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iZ3JleSIvPjwvc3ZnPg=="></a></p><p><a href="https://quickchart.io/chart-maker/view/zm-73887470-e667-4ca3-8df0-fe3563832b0b" target="_blank">Performance Benchmark</a></p><ul><li>測試環境：2022/M2/24GB Memory/macOS 13.2/XCode 14.1<li>X 軸：HTML 字數<li>Y 軸：渲染所花時間(秒)</ul><p>*另外 <code class="language-plaintext highlighter-rouge">NSAttributedString.DocumentType.html</code> 超過 54,600+ 長度字串就會閃退 (EXC_BAD_ACCESS)。</p><h4 id="試玩"><span class="me-2">試玩</span><a href="#試玩" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/a5643de271e4/1*PzYcnSkW7qKeJBkaiNTKjQ.gif" class="popup img-link blur"><img data-src="/assets/a5643de271e4/1*PzYcnSkW7qKeJBkaiNTKjQ.gif" alt="" data-lqip="true" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyOTUiIGhlaWdodD0iNjQwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmV5Ii8+PC9zdmc+"></a></p><p>可直接下載專案打開 <code class="language-plaintext highlighter-rouge">ZMarkupParser.xcworkspace</code> 選擇 <code class="language-plaintext highlighter-rouge">ZMarkupParser-Demo</code> Target Build &amp; Run 直接測試效果。</p><h4 id="安裝"><span class="me-2">安裝</span><a href="#安裝" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>支援 SPM/Cocoapods ，請參考 <a href="https://github.com/ZhgChgLi/ZMarkupParser#installation" target="_blank">Readme</a> 。</p><h3 id="使用方式"><span class="me-2">使用方式</span><a href="#使用方式" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="樣式宣告"><span class="me-2">樣式宣告</span><a href="#樣式宣告" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>MarkupStyle/MarkupStyleColor/MarkupStyleParagraphStyle，對應 NSAttributedString.Key 的封裝。</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="k">var</span> <span class="nv">font</span><span class="p">:</span><span class="kt">MarkupStyleFont</span>
<span class="k">var</span> <span class="nv">paragraphStyle</span><span class="p">:</span><span class="kt">MarkupStyleParagraphStyle</span>
<span class="k">var</span> <span class="nv">foregroundColor</span><span class="p">:</span><span class="kt">MarkupStyleColor</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">backgroundColor</span><span class="p">:</span><span class="kt">MarkupStyleColor</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">ligature</span><span class="p">:</span><span class="kt">NSNumber</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">kern</span><span class="p">:</span><span class="kt">NSNumber</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">tracking</span><span class="p">:</span><span class="kt">NSNumber</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">strikethroughStyle</span><span class="p">:</span><span class="kt">NSUnderlineStyle</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">underlineStyle</span><span class="p">:</span><span class="kt">NSUnderlineStyle</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">strokeColor</span><span class="p">:</span><span class="kt">MarkupStyleColor</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">strokeWidth</span><span class="p">:</span><span class="kt">NSNumber</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">shadow</span><span class="p">:</span><span class="kt">NSShadow</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">textEffect</span><span class="p">:</span><span class="kt">String</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">attachment</span><span class="p">:</span><span class="kt">NSTextAttachment</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">link</span><span class="p">:</span><span class="kt">URL</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">baselineOffset</span><span class="p">:</span><span class="kt">NSNumber</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">underlineColor</span><span class="p">:</span><span class="kt">MarkupStyleColor</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">strikethroughColor</span><span class="p">:</span><span class="kt">MarkupStyleColor</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">obliqueness</span><span class="p">:</span><span class="kt">NSNumber</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">expansion</span><span class="p">:</span><span class="kt">NSNumber</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">writingDirection</span><span class="p">:</span><span class="kt">NSNumber</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="k">var</span> <span class="nv">verticalGlyphForm</span><span class="p">:</span><span class="kt">NSNumber</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="o">...</span>
</pre></table></code></div></div><p>可依照自己想套用到 HTML Tag 上對應的樣式自行宣告：</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">myStyle</span> <span class="o">=</span> <span class="kt">MarkupStyle</span><span class="p">(</span><span class="nv">font</span><span class="p">:</span> <span class="kt">MarkupStyleFont</span><span class="p">(</span><span class="nv">size</span><span class="p">:</span> <span class="mi">13</span><span class="p">),</span> <span class="nv">backgroundColor</span><span class="p">:</span> <span class="kt">MarkupStyleColor</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="o">.</span><span class="n">aquamarine</span><span class="p">))</span>
</pre></table></code></div></div><h4 id="html-tag"><span class="me-2">HTML Tag</span><a href="#html-tag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>宣告要渲染的 HTML Tag 與對應的 Markup Style，目前預定義的 HTML Tag Name 如下：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>A_HTMLTagName(), // &lt;a&gt;&lt;/a&gt;
B_HTMLTagName(), // &lt;b&gt;&lt;/b&gt;
BR_HTMLTagName(), // &lt;br&gt;&lt;/br&gt;
DIV_HTMLTagName(), // &lt;div&gt;&lt;/div&gt;
HR_HTMLTagName(), // &lt;hr&gt;&lt;/hr&gt;
I_HTMLTagName(), // &lt;i&gt;&lt;/i&gt;
LI_HTMLTagName(), // &lt;li&gt;&lt;/li&gt;
OL_HTMLTagName(), // &lt;ol&gt;&lt;/ol&gt;
P_HTMLTagName(), // &lt;p&gt;&lt;/p&gt;
SPAN_HTMLTagName(), // &lt;span&gt;&lt;/span&gt;
STRONG_HTMLTagName(), // &lt;strong&gt;&lt;/strong&gt;
U_HTMLTagName(), // &lt;u&gt;&lt;/u&gt;
UL_HTMLTagName(), // &lt;ul&gt;&lt;/ul&gt;
DEL_HTMLTagName(), // &lt;del&gt;&lt;/del&gt;
IMG_HTMLTagName(handler: ZNSTextAttachmentHandler), // &lt;img&gt; and image downloader
TR_HTMLTagName(), // &lt;tr&gt;
TD_HTMLTagName(), // &lt;td&gt;
TH_HTMLTagName(), // &lt;th&gt;
...and more
...
</pre></table></code></div></div><p>這樣解析 <code class="language-plaintext highlighter-rouge">&lt;a&gt;</code> Tag 時就會套用到指定的 MarkupStyle。</p><p>擴充 HTMLTagName：</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">zhgchgli</span> <span class="o">=</span> <span class="kt">ExtendTagName</span><span class="p">(</span><span class="s">"zhgchgli"</span><span class="p">)</span>
</pre></table></code></div></div><h4 id="html-style-attribute"><span class="me-2">HTML Style Attribute</span><a href="#html-style-attribute" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>如同前述，HTML 支援從 Style Attribute 指定樣式，這邊也抽象出來可指定支援的樣式跟擴充，目前預定義的 HTML Style Attribute 如下：</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kt">ColorHTMLTagStyleAttribute</span><span class="p">(),</span> <span class="c1">// color</span>
<span class="kt">BackgroundColorHTMLTagStyleAttribute</span><span class="p">(),</span> <span class="c1">// background-color</span>
<span class="kt">FontSizeHTMLTagStyleAttribute</span><span class="p">(),</span> <span class="c1">// font-size</span>
<span class="kt">FontWeightHTMLTagStyleAttribute</span><span class="p">(),</span> <span class="c1">// font-weight</span>
<span class="kt">LineHeightHTMLTagStyleAttribute</span><span class="p">(),</span> <span class="c1">// line-height</span>
<span class="kt">WordSpacingHTMLTagStyleAttribute</span><span class="p">(),</span> <span class="c1">// word-spacing</span>
<span class="o">...</span>
</pre></table></code></div></div><p>擴充 Style Attribute:</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="kt">ExtendHTMLTagStyleAttribute</span><span class="p">(</span><span class="nv">styleName</span><span class="p">:</span> <span class="s">"text-decoration"</span><span class="p">,</span> <span class="nv">render</span><span class="p">:</span> <span class="p">{</span> <span class="n">value</span> <span class="k">in</span>
  <span class="k">var</span> <span class="nv">newStyle</span> <span class="o">=</span> <span class="kt">MarkupStyle</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s">"underline"</span> <span class="p">{</span>
    <span class="n">newStyle</span><span class="o">.</span><span class="n">underline</span> <span class="o">=</span> <span class="kt">NSUnderlineStyle</span><span class="o">.</span><span class="n">single</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// ...  </span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">newStyle</span>
<span class="p">})</span>
</pre></table></code></div></div><h3 id="使用"><span class="me-2">使用</span><a href="#使用" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">import</span> <span class="kt">ZMarkupParser</span>

<span class="k">let</span> <span class="nv">parser</span> <span class="o">=</span> <span class="kt">ZHTMLParserBuilder</span><span class="o">.</span><span class="nf">initWithDefault</span><span class="p">()</span><span class="o">.</span><span class="nf">set</span><span class="p">(</span><span class="nv">rootStyle</span><span class="p">:</span> <span class="kt">MarkupStyle</span><span class="p">(</span><span class="nv">font</span><span class="p">:</span> <span class="kt">MarkupStyleFont</span><span class="p">(</span><span class="nv">size</span><span class="p">:</span> <span class="mi">13</span><span class="p">))</span><span class="o">.</span><span class="nf">build</span><span class="p">()</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">initWithDefault</code> 會自動加入預先定義的 HTML Tag Name &amp; 預設對應的 MarkupStyle 還有預先定義的 Style Attribute。</p><p><code class="language-plaintext highlighter-rouge">set(rootStyle:)</code> 可指定整個字串的預設樣式，也可不指定。</p><h4 id="客製化"><span class="me-2">客製化</span><a href="#客製化" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">parser</span> <span class="o">=</span> <span class="kt">ZHTMLParserBuilder</span><span class="o">.</span><span class="nf">initWithDefault</span><span class="p">()</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="kt">ExtendTagName</span><span class="p">(</span><span class="s">"zhgchgli"</span><span class="p">),</span> <span class="nv">withCustomStyle</span><span class="p">:</span> <span class="kt">MarkupStyle</span><span class="p">(</span><span class="nv">backgroundColor</span><span class="p">:</span> <span class="kt">MarkupStyleColor</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="o">.</span><span class="n">aquamarine</span><span class="p">)))</span><span class="o">.</span><span class="nf">build</span><span class="p">()</span> <span class="c1">// will use markupstyle you specify to render extend html tag &lt;zhgchgli&gt;&lt;/zhgchgli&gt;</span>
<span class="k">let</span> <span class="nv">parser</span> <span class="o">=</span> <span class="kt">ZHTMLParserBuilder</span><span class="o">.</span><span class="nf">initWithDefault</span><span class="p">()</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="kt">B_HTMLTagName</span><span class="p">(),</span> <span class="nv">withCustomStyle</span><span class="p">:</span> <span class="kt">MarkupStyle</span><span class="p">(</span><span class="nv">font</span><span class="p">:</span> <span class="kt">MarkupStyleFont</span><span class="p">(</span><span class="nv">size</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="nv">weight</span><span class="p">:</span> <span class="o">.</span><span class="nf">style</span><span class="p">(</span><span class="o">.</span><span class="n">semibold</span><span class="p">))))</span><span class="o">.</span><span class="nf">build</span><span class="p">()</span> <span class="c1">// will use markupstyle you specify to render &lt;b&gt;&lt;/b&gt; instead of default bold markup style</span>
</pre></table></code></div></div><h4 id="html-render"><span class="me-2">HTML Render</span><a href="#html-render" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">attributedString</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="nf">render</span><span class="p">(</span><span class="n">htmlString</span><span class="p">)</span> <span class="c1">// NSAttributedString</span>

<span class="c1">// work with UITextView</span>
<span class="n">textView</span><span class="o">.</span><span class="nf">setHtmlString</span><span class="p">(</span><span class="n">htmlString</span><span class="p">)</span>
<span class="c1">// work with UILabel</span>
<span class="n">label</span><span class="o">.</span><span class="nf">setHtmlString</span><span class="p">(</span><span class="n">htmlString</span><span class="p">)</span>
</pre></table></code></div></div><h4 id="html-stripper"><span class="me-2">HTML Stripper</span><a href="#html-stripper" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">parser</span><span class="o">.</span><span class="nf">stripper</span><span class="p">(</span><span class="n">htmlString</span><span class="p">)</span>
</pre></table></code></div></div><h4 id="selector-html-string"><span class="me-2">Selector HTML String</span><a href="#selector-html-string" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="nv">selector</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="nf">selector</span><span class="p">(</span><span class="n">htmlString</span><span class="p">)</span> <span class="c1">// HTMLSelector e.g. input: &lt;a&gt;&lt;b&gt;Test&lt;/b&gt;Link&lt;/a&gt;</span>
<span class="n">selector</span><span class="o">.</span><span class="nf">first</span><span class="p">(</span><span class="s">"a"</span><span class="p">)?</span><span class="o">.</span><span class="nf">first</span><span class="p">(</span><span class="s">"b"</span><span class="p">)</span><span class="o">.</span><span class="n">attributedString</span> <span class="c1">// will return Test</span>
<span class="n">selector</span><span class="o">.</span><span class="nf">filter</span><span class="p">(</span><span class="s">"a"</span><span class="p">)</span><span class="o">.</span><span class="n">attributedString</span> <span class="c1">// will return Test Link</span>

<span class="c1">// render from selector result</span>
<span class="k">let</span> <span class="nv">selector</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="nf">selector</span><span class="p">(</span><span class="n">htmlString</span><span class="p">)</span> <span class="c1">// HTMLSelector e.g. input: &lt;a&gt;&lt;b&gt;Test&lt;/b&gt;Link&lt;/a&gt;</span>
<span class="n">parser</span><span class="o">.</span><span class="nf">render</span><span class="p">(</span><span class="n">selector</span><span class="o">.</span><span class="nf">first</span><span class="p">(</span><span class="s">"a"</span><span class="p">)?</span><span class="o">.</span><span class="nf">first</span><span class="p">(</span><span class="s">"b"</span><span class="p">))</span>
</pre></table></code></div></div><h4 id="async"><span class="me-2">Async</span><a href="#async" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>另外如果要渲染長字串，可改用 async 方法，防止卡 UI。</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">parser</span><span class="o">.</span><span class="nf">render</span><span class="p">(</span><span class="kt">String</span><span class="p">)</span> <span class="p">{</span> <span class="n">_</span> <span class="k">in</span> <span class="p">}</span><span class="o">...</span>
<span class="n">parser</span><span class="o">.</span><span class="nf">stripper</span><span class="p">(</span><span class="kt">String</span><span class="p">)</span> <span class="p">{</span> <span class="n">_</span> <span class="k">in</span> <span class="p">}</span><span class="o">...</span>
<span class="n">parser</span><span class="o">.</span><span class="nf">selector</span><span class="p">(</span><span class="kt">String</span><span class="p">)</span> <span class="p">{</span> <span class="n">_</span> <span class="k">in</span> <span class="p">}</span><span class="o">...</span>
</pre></table></code></div></div><h3 id="know-how"><span class="me-2">Know-how</span><a href="#know-how" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>UITextView 中的超連結樣式是看 linkTextAttributes，所以會出現 NSAttributedString.key 明明有設定但卻沒出現效果的情況。<li>UILabel 不支援指定 URL 樣式，所以會出現 NSAttributedString.key 明明有設定但卻沒出現效果的情況。<li>如果要渲染複雜的 HTML，還是需要使用 WKWebView (包含 JS/表格. .渲染)。</ul><h4 id="技術原理及開發故事-手工打造-html-解析器的那些事-"><span class="me-2">技術原理及開發故事：「 <a href="/posts/zrealm-dev/%E6%89%8B%E5%B7%A5%E6%89%93%E9%80%A0%E9%AB%98%E6%95%88-html-%E8%A7%A3%E6%9E%90%E5%99%A8-swift-%E8%BD%89%E6%8F%9B-html-%E5%AD%97%E4%B8%B2%E6%88%90-nsattributedstring-%E6%8A%80%E8%A1%93%E8%A9%B3%E8%A7%A3-2724f02f6e7/">手工打造 HTML 解析器的那些事</a> 」</span><a href="#技術原理及開發故事-手工打造-html-解析器的那些事-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><h3 id="歡迎貢獻及提出-issue-將盡快修正"><span class="me-2">歡迎貢獻及提出 Issue 將盡快修正</span><a href="#歡迎貢獻及提出-issue-將盡快修正" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="https://github.com/ZhgChgLi/ZMarkupParser" target="_blank" class="img-link shimmer" ><img src="https://repository-images.githubusercontent.com/602927147/57ce75c1-8548-449c-b44a-f4b0451ed5ea" alt="" loading="lazy"></a></p><p>有任何問題及指教歡迎 <a href="https://www.zhgchg.li/contact" target="_blank">與我聯絡</a> 。</p><hr /><p><a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" style="display:block !important;" class="img-link shimmer" ><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer&amp;emoji=🍺&amp;slug=zhgchgli&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Bree&amp;outline_colour=000000&amp;coffee_colour=ffffff" alt="Buy me a beer" loading="lazy"></a><br /></p><blockquote class="prompt-info"><p>本文首次發表於 Medium (<a href="https://medium.com/p/a5643de271e4" target="_blank"><strong>點此查看原始版本</strong></a>)，由 <a href="/posts/tools/medium-to-jekyll/" target="_blank">ZMediumToMarkdown</a> 提供自動轉換與同步技術。</p></blockquote><blockquote class="prompt-info"><p><a href="https://github.com/ZhgChgLi/zhgchgli.github.io/blob/main/_posts/zh-tw/zmediumtomarkdown/2023-02-26-a5643de271e4.md" target="_blank">Improve this page on Github.</a></p></blockquote><widgetic id="64ce71d5ecb2a165598b4567" resize="fill-width" height="50" autoscale="on"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><div onclick="this.style.position='';" style="text-align: center; position: -webkit-sticky; position: sticky; bottom: 0; z-index: 1; margin: 0 -1rem; padding: 5px; background: var(--main-bg); transition: all .2s ease-in-out;"><a href="https://medium.com/@zhgchgli" target="_blank" style="display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 20px;font-size:16px;font-weight:bold;color:#ffffff;background-color:#00ab6c;border-radius:5px;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.backgroundColor='#008f5a';this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 10px rgba(0,0,0,0.15)';" onmouseout="this.style.backgroundColor='#00ab6c';this.style.transform='translateY(0)';this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">Follow Me on Medium <span style="font-size:14px;color:rgba(255,255,255,0.9);font-weight:normal;opacity:0.9;">1K+ Followers</span></a></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/zrealm-dev/">ZRealm Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/html-parser/" class="post-tag no-text-decoration" >html-parser</a> <a href="/tags/nsattributedstring/" class="post-tag no-text-decoration" >nsattributedstring</a> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/html/" class="post-tag no-text-decoration" >html</a> <a href="/tags/markdown/" class="post-tag no-text-decoration" >markdown</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=ZMarkupParser%EF%BD%9CSwift%20HTML%20String%20%E8%BD%89%20NSAttributedString%20%E5%B7%A5%E5%85%B7%EF%BC%8C%E6%94%AF%E6%8F%B4%E5%AE%A2%E8%A3%BD%E6%A8%A3%E5%BC%8F%E8%88%87%E9%AB%98%E6%95%88%E8%83%BD%E6%B8%B2%E6%9F%93%20-%20ZhgChgLi%20(Harry%20Li)&url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzmarkupparser-swift-html-string-%25E8%25BD%2589-nsattributedstring-%25E5%25B7%25A5%25E5%2585%25B7-%25E6%2594%25AF%25E6%258F%25B4%25E5%25AE%25A2%25E8%25A3%25BD%25E6%25A8%25A3%25E5%25BC%258F%25E8%2588%2587%25E9%25AB%2598%25E6%2595%2588%25E8%2583%25BD%25E6%25B8%25B2%25E6%259F%2593-a5643de271e4%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=ZMarkupParser%EF%BD%9CSwift%20HTML%20String%20%E8%BD%89%20NSAttributedString%20%E5%B7%A5%E5%85%B7%EF%BC%8C%E6%94%AF%E6%8F%B4%E5%AE%A2%E8%A3%BD%E6%A8%A3%E5%BC%8F%E8%88%87%E9%AB%98%E6%95%88%E8%83%BD%E6%B8%B2%E6%9F%93%20-%20ZhgChgLi%20(Harry%20Li)&u=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzmarkupparser-swift-html-string-%25E8%25BD%2589-nsattributedstring-%25E5%25B7%25A5%25E5%2585%25B7-%25E6%2594%25AF%25E6%258F%25B4%25E5%25AE%25A2%25E8%25A3%25BD%25E6%25A8%25A3%25E5%25BC%258F%25E8%2588%2587%25E9%25AB%2598%25E6%2595%2588%25E8%2583%25BD%25E6%25B8%25B2%25E6%259F%2593-a5643de271e4%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fzhgchg.li%2Fposts%2Fzrealm-dev%2Fzmarkupparser-swift-html-string-%25E8%25BD%2589-nsattributedstring-%25E5%25B7%25A5%25E5%2585%25B7-%25E6%2594%25AF%25E6%258F%25B4%25E5%25AE%25A2%25E8%25A3%25BD%25E6%25A8%25A3%25E5%25BC%258F%25E8%2588%2587%25E9%25AB%2598%25E6%2595%2588%25E8%2583%25BD%25E6%25B8%25B2%25E6%259F%2593-a5643de271e4%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/zrealm-robotic-process-automation/ios-%E6%8D%B7%E5%BE%91%E8%87%AA%E5%8B%95%E5%8C%96-3-%E6%8B%9B%E8%87%AA%E5%8B%95%E8%BD%89%E7%99%BC%E7%B0%A1%E8%A8%8A%E8%88%87%E5%BB%BA%E7%AB%8B%E6%8F%90%E9%86%92%E5%BE%85%E8%BE%A6%E4%BA%8B%E9%A0%85%E6%95%99%E5%AD%B8-309d0302877b/">iOS 捷徑自動化應用場景 — 自動轉發簡訊與自動建立提醒待辦事項</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/en/apple-watch-stainless-steel-milanese-loop-unboxing-premium-44mm-graphite-band-review-c0f99f987d9c/">Apple Watch Stainless Steel Milanese Loop Unboxing｜Premium 44mm Graphite Band Review</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/zh-cn/apple-watch-%E7%B1%B3%E5%85%B0%E8%A1%A8%E5%B8%A6%E5%BC%80%E7%AE%B1-%E5%8E%9F%E5%8E%82%E4%B8%8D%E9%94%88%E9%92%A2%E7%9F%B3%E5%A2%A8%E8%89%B2%E4%BC%98%E7%BC%BA%E7%82%B9%E5%85%A8%E8%A7%A3%E6%9E%90-c0f99f987d9c/">Apple Watch 原厂不锈钢米兰表带开箱</a><li class="text-truncate lh-lg"> <a href="/posts/zrealm-life/apple-watch-%E7%B1%B3%E8%98%AD%E9%8C%B6%E5%B8%B6%E9%96%8B%E7%AE%B1-%E5%8E%9F%E5%BB%A0%E4%B8%8D%E9%8F%BD%E9%8B%BC%E7%9F%B3%E5%A2%A8%E8%89%B2%E5%84%AA%E7%BC%BA%E9%BB%9E%E5%85%A8%E8%A7%A3%E6%9E%90-c0f99f987d9c/">Apple Watch 原廠不鏽鋼米蘭錶帶開箱</a><li class="text-truncate lh-lg"> <a href="/posts/travel-journals/en/busan-travel-guide-8-day-itinerary-with-visit-busan-pass-for-seamless-exploration-8ace34a1a3d8/">Busan Travel Guide｜8-Day Itinerary with VISIT BUSAN PASS for Seamless Exploration</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">章節 (Chapters)🔖</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/zrealm-dev/zh-cn/zmarkupparser-swift-html-string-%E8%BD%AC-nsattributedstring-%E5%B7%A5%E5%85%B7-%E6%94%AF%E6%8F%B4%E5%AE%A2%E5%88%B6%E6%A0%B7%E5%BC%8F%E4%B8%8E%E9%AB%98%E6%95%88%E8%83%BD%E6%B8%B2%E6%9F%93-a5643de271e4/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1677402187" data-df="ll" > Feb 26, 2023 </time><h4 class="pt-0 my-2">ZMarkupParser｜Swift HTML String 转 NSAttributedString 工具，支援客制样式与高效能渲染</h4><div class="text-muted"><p>针对 iOS/macOS 开发者，提供纯 Swift 实作的 HTML String 转 NSAttributedString 工具，支援自动修正错误标签、客制样式设定与多种 HTML Tag，提升渲染效能并避免长字串闪退，助你打造流畅又稳定的文字显示效果。</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/en/zmarkupparser-convert-html-string-to-nsattributedstring-with-custom-style-keys-a5643de271e4/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1677402187" data-df="ll" > Feb 26, 2023 </time><h4 class="pt-0 my-2">ZMarkupParser｜Convert HTML String to NSAttributedString with Custom Style Keys</h4><div class="text-muted"><p>Developers facing challenges in converting HTML strings to NSAttributedString can utilize ZMarkupParser to apply precise style key mappings, ensuring accurate and customizable text rendering in iOS...</p></div></div></a></article><article class="col"> <a href="/posts/zrealm-dev/ios-nsattributedstring-html-render-%E8%87%AA%E8%A1%8C%E5%AF%A6%E7%8F%BE-%E8%A7%A3%E6%B1%BA%E9%96%83%E9%80%80%E8%88%87%E6%95%88%E8%83%BD%E7%93%B6%E9%A0%B8-a8c2d26cc734/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1654791119" data-df="ll" > Jun 10, 2022 </time><h4 class="pt-0 my-2">iOS NSAttributedString HTML Render 自行實現｜解決閃退與效能瓶頸</h4><div class="text-muted"><p>針對 iOS NSAttributedString HTML 解析閃退與效能差問題，提供純 Swift XMLParser 自行實現 HTML Render 技術，避免主線程阻塞，提升渲染速度達 5~20 倍，並支援自訂標籤樣式與擴充，確保穩定且可維護的文字渲染體驗。</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/zrealm-dev/zh-cn/zmarkupparser-swift-html-string-%E8%BD%AC-nsattributedstring-%E5%B7%A5%E5%85%B7-%E6%94%AF%E6%8F%B4%E5%AE%A2%E5%88%B6%E6%A0%B7%E5%BC%8F%E4%B8%8E%E9%AB%98%E6%95%88%E8%83%BD%E6%B8%B2%E6%9F%93-a5643de271e4/" class="btn btn-outline-primary" aria-label="Older" ><p>ZMarkupParser｜Swift HTML String 转 NSAttributedString 工具，支援客制样式与高效能渲染</p></a> <a href="/posts/zrealm-dev/en/html-parsing-techniques-build-custom-parsers-for-nsattributedstring-rendering-2724f02f6e7/" class="btn btn-outline-primary" aria-label="Newer" ><p>HTML Parsing Techniques｜Build Custom Parsers for NSAttributedString Rendering</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span> <a href="/">中文</a>|<a href="/tags/simplified-chinese">简中</a>|<a href="/tags/english/">English</a></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. <br/> Medium articles were converted using <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown.</a> <br/></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/english/">english</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai-translation/">ai-translation</a> <a class="post-tag btn btn-outline-primary" href="/tags/simplified-chinese/">simplified-chinese</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-apps-script/">google-apps-script</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
